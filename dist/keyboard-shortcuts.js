var p7=Object.defineProperty;var w4=(X,$)=>{for(var Q in $)p7(X,Q,{get:$[Q],enumerable:!0,configurable:!0,set:(H)=>$[Q]=()=>H})};function B(X){return X}function O(X){return function(){return X}}function w0(X){return function(){var $=[];for(var Q=0;Q<arguments.length;Q++)$[Q]=arguments[Q];if($.length>1)return X($[1],$[0]);return function(H){return X(H)($[0])}}}function G(X,$,Q,H,Y,V,J,Z,C){switch(arguments.length){case 1:return X;case 2:return function(){return $(X.apply(this,arguments))};case 3:return function(){return Q($(X.apply(this,arguments)))};case 4:return function(){return H(Q($(X.apply(this,arguments))))};case 5:return function(){return Y(H(Q($(X.apply(this,arguments)))))};case 6:return function(){return V(Y(H(Q($(X.apply(this,arguments))))))};case 7:return function(){return J(V(Y(H(Q($(X.apply(this,arguments)))))))};case 8:return function(){return Z(J(V(Y(H(Q($(X.apply(this,arguments))))))))};case 9:return function(){return C(Z(J(V(Y(H(Q($(X.apply(this,arguments)))))))))}}return}function B4(X){return function($){return X.apply(void 0,$)}}function j(X,$,Q,H,Y,V,J,Z,C){switch(arguments.length){case 1:return X;case 2:return $(X);case 3:return Q($(X));case 4:return H(Q($(X)));case 5:return Y(H(Q($(X))));case 6:return V(Y(H(Q($(X)))));case 7:return J(V(Y(H(Q($(X))))));case 8:return Z(J(V(Y(H(Q($(X)))))));case 9:return C(Z(J(V(Y(H(Q($(X))))))));default:{var D=arguments[0];for(var g=1;g<arguments.length;g++)D=arguments[g](D);return D}}}var o7=function(X,$,Q){if(Q||arguments.length===2){for(var H=0,Y=$.length,V;H<Y;H++)if(V||!(H in $)){if(!V)V=Array.prototype.slice.call($,0,H);V[H]=$[H]}}return X.concat(V||Array.prototype.slice.call($))};var U=function(X,$){var Q=typeof X==="number"?function(H){return H.length>=X}:X;return function(){var H=Array.from(arguments);if(Q(arguments))return $.apply(this,H);return function(Y){return $.apply(void 0,o7([Y],H,!1))}}};var n7=function(X,$,Q){if(Q||arguments.length===2){for(var H=0,Y=$.length,V;H<Y;H++)if(V||!(H in $)){if(!V)V=Array.prototype.slice.call($,0,H);V[H]=$[H]}}return X.concat(V||Array.prototype.slice.call($))},c0=function(X){return X._tag==="None"},E=function(X){return X._tag==="Some"},z={_tag:"None"},K=function(X){return{_tag:"Some",value:X}},Q0=function(X){return X._tag==="Left"};var _0=function(X){return X.length>0},d0=function(X){return X[0]},T4=function(X){return X.slice(1)};var m={};var r0=function(X){return n7([X[0]],X.slice(1),!0)};function c(X){return function($){return function(Q){return X.ap(X.map(Q,function(H){return function(){return H}}),$)}}}function _(X){return function($){return function(Q){return X.ap(X.map(Q,function(){return function(H){return H}}),$)}}}function d(X){return function($,Q){return function(H){return X.ap(X.map(H,function(Y){return function(V){var J;return Object.assign({},Y,(J={},J[$]=V,J))}}),Q)}}}function H0(X){return function($){return function(Q){return X.map(Q,function(H){return H($)})}}}function I(X){return function($){return function(Q){return X.map(Q,function(H){var Y;return Y={},Y[$]=H,Y})}}}var F=function(X){return function($,Q){return function(H){return X.map(H,function(Y){var V;return Object.assign({},Y,(V={},V[$]=Q(Y),V))})}}};function p0(X){return function($,Q){return X.map($,function(){return Q})}}function U4(X){var $=p0(X);return function(Q){return $(Q,void 0)}}var N={};w4(N,{zipWith:()=>{{return r5}},zip:()=>{{return E1}},zero:()=>{{return i}},wither:()=>{{return t9}},wilt:()=>{{return s9}},updateAt:()=>{{return M9}},unzip:()=>{{return b9}},unsafeUpdateAt:()=>{{return a1}},unsafeInsertAt:()=>{{return U7}},unsafeDeleteAt:()=>{{return X4}},uniq:()=>{{return m9}},union:()=>{{return I1}},unfold:()=>{{return o1}},traverseWithIndex:()=>{{return p1}},traverse:()=>{{return D7}},takeRight:()=>{{return u5}},takeLeftWhile:()=>{{return b5}},takeLeft:()=>{{return h5}},tail:()=>{{return O9}},splitAt:()=>{{return o5}},spanLeft:()=>{{return R9}},sortBy:()=>{{return l9}},sort:()=>{{return d5}},some:()=>{{return v7}},snoc:()=>{{return MX}},size:()=>{{return F5}},sequence:()=>{{return G0}},separate:()=>{{return y}},scanRight:()=>{{return A9}},scanLeft:()=>{{return v9}},rotate:()=>{{return y9}},rights:()=>{{return h9}},reverse:()=>{{return _5}},replicate:()=>{{return q9}},reduceWithIndex:()=>{{return r1}},reduceRightWithIndex:()=>{{return P7}},reduceRight:()=>{{return G7}},reduce:()=>{{return d1}},range:()=>{{return IX}},prependW:()=>{{return L9}},prependToAll:()=>{{return hX}},prependAll:()=>{{return p5}},prepend:()=>{{return K9}},partitionWithIndex:()=>{{return m1}},partitionMapWithIndex:()=>{{return l1}},partitionMap:()=>{{return V7}},partition:()=>{{return H7}},of:()=>{{return x}},modifyAt:()=>{{return c5}},matchW:()=>{{return R5}},matchRightW:()=>{{return g5}},matchRight:()=>{{return E5}},matchLeftW:()=>{{return W5}},matchLeft:()=>{{return k5}},match:()=>{{return B9}},mapWithIndex:()=>{{return Q7}},map:()=>{{return F0}},makeBy:()=>{{return N5}},lookup:()=>{{return W1}},let:()=>{{return kX}},lefts:()=>{{return u9}},last:()=>{{return N9}},isOutOfBound:()=>{{return f}},isNonEmpty:()=>{{return L}},isEmpty:()=>{{return S}},intersperse:()=>{{return x9}},intersection:()=>{{return F1}},intercalate:()=>{{return SX}},insertAt:()=>{{return k1}},init:()=>{{return S9}},head:()=>{{return M5}},guard:()=>{{return DX}},getUnionSemigroup:()=>{{return C7}},getUnionMonoid:()=>{{return a9}},getShow:()=>{{return i9}},getSemigroup:()=>{{return z7}},getOrd:()=>{{return e9}},getMonoid:()=>{{return K7}},getIntersectionSemigroup:()=>{{return XX}},getEq:()=>{{return L7}},getDifferenceMagma:()=>{{return $X}},fromPredicate:()=>{{return w9}},fromOptionK:()=>{{return d9}},fromOption:()=>{{return O5}},fromEitherK:()=>{{return NX}},fromEither:()=>{{return S5}},foldRight:()=>{{return U9}},foldMapWithIndex:()=>{{return Z7}},foldMap:()=>{{return J7}},foldLeft:()=>{{return T9}},flatten:()=>{{return n9}},flatMap:()=>{{return A}},flap:()=>{{return QX}},findLastMap:()=>{{return I9}},findLastIndex:()=>{{return F9}},findLast:()=>{{return E9}},findIndex:()=>{{return l5}},findFirstMap:()=>{{return g9}},findFirst:()=>{{return k9}},filterWithIndex:()=>{{return c1}},filterMapWithIndex:()=>{{return x1}},filterMap:()=>{{return M0}},filterE:()=>{{return AX}},filter:()=>{{return y1}},extend:()=>{{return _1}},exists:()=>{{return OX}},every:()=>{{return $4}},empty:()=>{{return N7}},elem:()=>{{return O0}},duplicate:()=>{{return f9}},dropRight:()=>{{return W9}},dropLeftWhile:()=>{{return m5}},dropLeft:()=>{{return y5}},difference:()=>{{return S0}},deleteAt:()=>{{return g1}},copy:()=>{{return q}},cons:()=>{{return FX}},concatW:()=>{{return n5}},concat:()=>{{return f5}},comprehension:()=>{{return r9}},compact:()=>{{return e}},chunksOf:()=>{{return _9}},chop:()=>{{return c9}},chainWithIndex:()=>{{return I5}},chainRecDepthFirst:()=>{{return BX}},chainRecBreadthFirst:()=>{{return UX}},chainFirst:()=>{{return JX}},chain:()=>{{return A7}},bindTo:()=>{{return WX}},bind:()=>{{return gX}},array:()=>{{return uX}},appendW:()=>{{return C9}},append:()=>{{return Z0}},apSecond:()=>{{return YX}},apS:()=>{{return EX}},apFirst:()=>{{return VX}},ap:()=>{{return $7}},altW:()=>{{return Y7}},alt:()=>{{return j7}},Zero:()=>{{return w7}},Witherable:()=>{{return e1}},Unfoldable:()=>{{return GX}},URI:()=>{{return P}},TraversableWithIndex:()=>{{return wX}},Traversable:()=>{{return t1}},Pointed:()=>{{return q7}},Monad:()=>{{return ZX}},FunctorWithIndex:()=>{{return HX}},Functor:()=>{{return h0}},FromEither:()=>{{return T7}},FoldableWithIndex:()=>{{return qX}},Foldable:()=>{{return B7}},FilterableWithIndex:()=>{{return CX}},Filterable:()=>{{return LX}},Extend:()=>{{return KX}},Do:()=>{{return RX}},Compactable:()=>{{return f1}},ChainRecDepthFirst:()=>{{return TX}},ChainRecBreadthFirst:()=>{{return vX}},Chain:()=>{{return n1}},Apply:()=>{{return u0}},Applicative:()=>{{return jX}},Alternative:()=>{{return zX}},Alt:()=>{{return PX}}});function B0(X){var $=V0(X);return function(Q){return function(H){return $(H,Q)}}}function V0(X){return function($,Q){return X.chain($,function(H){return X.map(Q(H),function(){return H})})}}function M(X){return function($,Q){return function(H){return X.chain(H,function(Y){return X.map(Q(Y),function(V){var J;return Object.assign({},Y,(J={},J[$]=V,J))})})}}}function T0(X){return function($){return G($,X.fromEither)}}function v4(X,$){var Q=T0(X),H=V0($);return function(Y,V){return H(Y,Q(V))}}var A4=function(X){return{equals:function($,Q){return $===Q||X($,Q)}}};var o0={equals:function(X,$){return X===$}};var O$=o0.equals;var i7=function(X,$){return X<$?-1:X>$?1:0},t7=function(X){return function($,Q){return $===Q||X($,Q)===0}},U0=function(X){return{equals:t7(X),compare:function($,Q){return $===Q?0:X($,Q)}}};var s7=function(){return{concat:function(X,$){return U0(function(Q,H){var Y=X.compare(Q,H);return Y!==0?Y:$.compare(Q,H)})}}},N4=function(){return{concat:s7().concat,empty:U0(function(){return 0})}};var n0=function(X){return function($,Q){return $===Q||X.compare($,Q)<1?$:Q}},f0=function(X){return function($,Q){return $===Q||X.compare($,Q)>-1?$:Q}},O4=function(X){var $=n0(X),Q=f0(X);return function(H,Y){return function(V){return Q($(V,Y),H)}}};var W$={equals:o0.equals,compare:i7};var S4=function(X){return function($){return function(Q){return Q.reduce(function(H,Y){return X.concat(H,Y)},$)}}};var t0=function(X){return{concat:n0(X)}},s0=function(X){return{concat:f0(X)}},X9=function(X){return{concat:function(){return X}}};var R4=S4,W4=X9(void 0);var k4={concat:function(X,$){return X&&$}},g4={concat:function(X,$){return X||$}};var E4={concat:function(X,$){return X+$}},I4={concat:function(X,$){return X+$}},F4={concat:function(X,$){return X*$}};var V9=function(X,$,Q){if(Q||arguments.length===2){for(var H=0,Y=$.length,V;H<Y;H++)if(V||!(H in $)){if(!V)V=Array.prototype.slice.call($,0,H);V[H]=$[H]}}return X.concat(V||Array.prototype.slice.call($))};var i0=_0,M4=function(X,$){return X<0||X>=$.length},h4=function(X){return function($){return V9([X],$,!0)}},u4=h4;var b4=function(X){return function($){var Q=[X,$[0]];for(var H=1;H<$.length;H++)Q.push(X,$[H]);return Q}},x4=function(X){return function($){var Q=y4($);return i0(Q)?j(Q,b4(X),u4(h($))):$}};var Y9=d0;var h=Y9,y4=T4,v0=function(X){return X[X.length-1]};var m4=function(X){return function($){return $.reduce(X.concat)}};var e0=function(X){var $=m4(X);return function(Q){return G(x4(Q),$)}};function p4(X,$){return $?X.concat($):function(Q){return Q.concat(X)}}function s4(X,$){return $===void 0?r(X):j($,r(X))}var X1=function(X,$,Q){if(Q||arguments.length===2){for(var H=0,Y=$.length,V;H<Y;H++)if(V||!(H in $)){if(!V)V=Array.prototype.slice.call($,0,H);V[H]=$[H]}}return X.concat(V||Array.prototype.slice.call($))},p=function(X){return X.length>0},$1=function(X,$){return X<0||X>=$.length},Q1=function(X){return function($){return X1([X],$,!0)}},r=Q1,H1=function(X){return function($){return X1(X1([],$,!0),[X],!1)}},V1=H1,l4=function(X,$,Q){if(p(Q)){var H=J1(Q);return H.splice(X,0,$),H}return[$]},c4=function(X,$,Q){var H=J1(Q);return H[X]=$,H},Y1=function(X){return function($){if($.length===1)return Y0($);var Q=[u($)],H=o($),Y=function(C){if(Q.every(function(D){return!X.equals(D,C)}))Q.push(C)};for(var V=0,J=H;V<J.length;V++){var Z=J[V];Y(Z)}return Q}},_4=function(X){if(p(X)){var $=N4();return G1(X.reduce($.concat,$.empty))}return Y0},d4=function(X){var $=Y1(X);return function(Q){return function(H){return $(j(H,p4(Q)))}}},j1=function(X){return function($){var Q=$.length,H=Math.round(X)%Q;if($1(Math.abs(H),$)||H===0)return Y0($);if(H<0){var Y=A0(-H)($),V=Y[0],J=Y[1];return j(J,p4(V))}else return j1(H-Q)($)}},J1=r0;var Z1=function(X){return function($){var Q=Math.max(0,Math.floor($)),H=[X(0)];for(var Y=1;Y<Q;Y++)H.push(X(Y));return H}};var r4=function(X,$){return X<=$?Z1(function(Q){return X+Q})($-X+1):[X]};var G1=function(X){return function($){return $.slice().sort(X.compare)}};var Y0=J1,o4=function(X){return[X]};var P1=function(X){return function($){var Q=[X,$[0]];for(var H=1;H<$.length;H++)Q.push(X,$[H]);return Q}},n4=function(X){return function($){var Q=o($);return p(Q)?j(Q,P1(X),r(u($))):Y0($)}};var D1=function(X){return function($){var Q=X($),H=Q[0],Y=Q[1],V=[H],J=Y;while(p(J)){var Z=X(J),C=Z[0],D=Z[1];V.push(C),J=D}return V}},A0=function(X){return function($){var Q=Math.max(1,X);return Q>=$.length?[Y0($),[]]:[j($.slice(1,Q),r(u($))),$.slice(Q)]}},f4=function(X){return D1(A0(X))};var u=h,o=function(X){return X.slice(1)},t4=v0,z1=function(X){return X.slice(0,-1)};var K1=function(X){return function($){return $.reduce(X.concat)}};var i4=function(X,$){return j(X,V1($))};var j0={};w4(j0,{isNumber:()=>{{return j9}},Show:()=>{{return J9}},SemigroupSum:()=>{{return q1}},SemigroupProduct:()=>{{return w1}},Ord:()=>{{return n}},MonoidSum:()=>{{return B1}},MonoidProduct:()=>{{return T1}},MagmaSub:()=>{{return a4}},Field:()=>{{return Z9}},Eq:()=>{{return L1}},Bounded:()=>{{return C1}}});var j9=function(X){return typeof X==="number"},L1={equals:function(X,$){return X===$}},n={equals:L1.equals,compare:function(X,$){return X<$?-1:X>$?1:0}},C1={equals:L1.equals,compare:n.compare,top:Infinity,bottom:(-Infinity)},J9={show:function(X){return JSON.stringify(X)}},a4={concat:function(X,$){return X-$}},q1={concat:function(X,$){return X+$}},w1={concat:function(X,$){return X*$}},B1={concat:q1.concat,empty:0},T1={concat:w1.concat,empty:1},Z9={add:q1.concat,zero:0,mul:w1.concat,one:1,sub:a4.concat,degree:function(X){return 1},div:function(X,$){return X/$},mod:function(X,$){return X%$}};var N0=function(X,$){return{left:X,right:$}};function X5(X,$){return function(Q){var H=X.traverse(Q);return function(Y,V){return Q.map(H(Y,V),$.separate)}}}function $5(X,$){return function(Q){var H=X.traverse(Q);return function(Y,V){return Q.map(H(Y,V),$.compact)}}}function Q5(X){return function($){var Q=X.wither($);return function(H){return function(Y){return Q(Y,function(V){return $.map(H(V),function(J){return J?K(V):z})})}}}}function H5(X,$){return function(Q){return Q?$.of(void 0):X.zero()}}function U1(X,$){return $===void 0?function(Q){return U1(X,Q)}:z9(X,$)?z:K($[X])}function J5(X){return function($){for(var Q=0;Q<$.length;Q++)if(X($[Q]))return K($[Q]);return z}}function G5(X){return function($){for(var Q=$.length-1;Q>=0;Q--)if(X($[Q]))return K($[Q]);return z}}function v1(X){return function($,Q){if(Q===void 0){var H=v1(X);return function(J){return H($,J)}}var Y=function(J){return X.equals(J,$)},V=0;for(;V<Q.length;V++)if(Y(Q[V]))return!0;return!1}}function U5(X){return function($){return $.every(X)}}var G9=function(X,$,Q){if(Q||arguments.length===2){for(var H=0,Y=$.length,V;H<Y;H++)if(V||!(H in $)){if(!V)V=Array.prototype.slice.call($,0,H);V[H]=$[H]}}return X.concat(V||Array.prototype.slice.call($))};var J0=i0;var P9=function(X,$){return function(Q){return J0(Q)?$(Q):X()}},D9=P9;var z9=M4,V5=function(X){return J0(X)?K(h(X)):z},Y5=function(X){return J0(X)?K(v0(X)):z};var j5=function(X){return function($){for(var Q=0;Q<$.length;Q++)if(X($[Q]))return K(Q);return z}},Z5=function(X){return function($){for(var Q=0;Q<$.length;Q++){var H=X($[Q]);if(E(H))return H}return z}},P5=function(X){return function($){for(var Q=$.length-1;Q>=0;Q--){var H=X($[Q]);if(E(H))return H}return z}},D5=function(X){return function($){for(var Q=$.length-1;Q>=0;Q--)if(X($[Q]))return K(Q);return z}};var z5=function(X,$){return j(X,S1($))},K5=function(X,$){return j(X,R1($))};var A1=function(X){return function($){return function(Q){return Q.reduce(function(H,Y,V){return X.concat(H,$(V,Y))},X.empty)}}},L5=function(X,$){return N1(X,function(Q,H,Y){return $(H,Y)})},C5=function(X){var $=A1(X);return function(Q){return $(function(H,Y){return Q(Y)})}},N1=function(X,$){return function(Q){var H=Q.length,Y=X;for(var V=0;V<H;V++)Y=$(V,Y,Q[V]);return Y}},q5=function(X,$){return O1(X,function(Q,H,Y){return $(H,Y)})},O1=function(X,$){return function(Q){return Q.reduceRight(function(H,Y,V){return $(V,Y,H)},X)}};var w5=function(X){return{show:function($){return"[".concat($.map(X.show).join(", "),"]")}}};var B5=function(X){return A4(function($,Q){return $.length===Q.length&&$.every(function(H,Y){return X.equals(H,Q[Y])})})},T5=function(X){return U0(function($,Q){var H=$.length,Y=Q.length,V=Math.min(H,Y);for(var J=0;J<V;J++){var Z=X.compare($[J],Q[J]);if(Z!==0)return Z}return n.compare(H,Y)})};var S1=function(X){return function($){var Q=G9([],X($),!0),H=[];while(Q.length>0){var Y=Q.shift();if(Q0(Y))Q.unshift.apply(Q,X(Y.left));else H.push(Y.right)}return H}};var R1=function(X){return function($){var Q=X($),H=[],Y=[];function V(D){if(Q0(D))X(D.left).forEach(function(g){return H.push(g)});else Y.push(D.right)}for(var J=0,Z=Q;J<Z.length;J++){var C=Z[J];V(C)}while(H.length>0)V(H.shift());return Y}};var v5=function(X){var $=e0(X);return function(Q){return D9(function(){return X.empty},$(Q))}};function w9(X){return function($){return X($)?[$]:[]}}function b5(X){return function($){var Q=[];for(var H=0,Y=$;H<Y.length;H++){var V=Y[H];if(!X(V))break;Q.push(V)}return Q}}function R9(X){return function($){var Q=o5(x5($,X))($),H=Q[0],Y=Q[1];return{init:H,rest:Y}}}function m5(X){return function($){return $.slice(x5($,X))}}function k9(X){return J5(X)}function E9(X){return G5(X)}function E1(X,$){if($===void 0)return function(Q){return E1(Q,X)};return r5(X,$,function(Q,H){return[Q,H]})}function r9(X,$,Q){if(Q===void 0)Q=function(){return!0};var H=function(Y,V){return L(V)?A(u(V),function(J){return H(j(Y,Z0(J)),o(V))}):Q.apply(void 0,Y)?[$.apply(void 0,Y)]:[]};return H([],X)}function I1(X){var $=d4(X);return function(Q,H){if(H===void 0){var Y=I1(X);return function(V){return Y(V,Q)}}return L(Q)&&L(H)?$(H)(Q):L(Q)?q(Q):q(H)}}function F1(X){var $=O0(X);return function(Q,H){if(H===void 0){var Y=F1(X);return function(V){return Y(V,Q)}}return Q.filter(function(V){return $(V,H)})}}function S0(X){var $=O0(X);return function(Q,H){if(H===void 0){var Y=S0(X);return function(V){return Y(V,Q)}}return Q.filter(function(V){return!$(V,H)})}}var S=function(X){return X.length===0},L=p,K9=r,L9=Q1,Z0=V1,C9=H1,N5=function(X,$){return X<=0?[]:Z1($)(X)},q9=function(X,$){return N5(X,function(){return $})},O5=function(X){return c0(X)?[]:[X.value]},S5=function(X){return Q0(X)?[]:[X.right]},R5=function(X,$){return function(Q){return L(Q)?$(Q):X()}},B9=R5,W5=function(X,$){return function(Q){return L(Q)?$(u(Q),o(Q)):X()}},k5=W5,T9=k5,g5=function(X,$){return function(Q){return L(Q)?$(z1(Q),t4(Q)):X()}},E5=g5,U9=E5,I5=function(X){return function($){var Q=[];for(var H=0;H<$.length;H++)Q.push.apply(Q,X(H,$[H]));return Q}},v9=function(X,$){return function(Q){var H=Q.length,Y=new Array(H+1);Y[0]=X;for(var V=0;V<H;V++)Y[V+1]=$(Y[V],Q[V]);return Y}},A9=function(X,$){return function(Q){var H=Q.length,Y=new Array(H+1);Y[H]=X;for(var V=H-1;V>=0;V--)Y[V]=$(Q[V],Y[V+1]);return Y}},F5=function(X){return X.length},f=$1,W1=U1,M5=V5,N9=Y5,O9=function(X){return L(X)?K(o(X)):z},S9=function(X){return L(X)?K(z1(X)):z},h5=function(X){return function($){return f(X,$)?q($):$.slice(0,X)}},u5=function(X){return function($){return f(X,$)?q($):X===0?[]:$.slice(-X)}},x5=function(X,$){var Q=X.length,H=0;for(;H<Q;H++)if(!$(X[H]))break;return H},y5=function(X){return function($){return X<=0||S($)?q($):X>=$.length?[]:$.slice(X,$.length)}},W9=function(X){return function($){return X<=0||S($)?q($):X>=$.length?[]:$.slice(0,$.length-X)}},l5=j5,g9=Z5,I9=P5,F9=D5,q=function(X){return X.slice()},k1=function(X,$){return function(Q){return X<0||X>Q.length?z:K(U7(X,$,Q))}},M9=function(X,$){return c5(X,function(){return $})},g1=function(X){return function($){return f(X,$)?z:K(X4(X,$))}},c5=function(X,$){return function(Q){return f(X,Q)?z:K(a1(X,$(Q[X]),Q))}},_5=function(X){return S(X)?[]:X.slice().reverse()},h9=function(X){var $=[];for(var Q=0;Q<X.length;Q++){var H=X[Q];if(H._tag==="Right")$.push(H.right)}return $},u9=function(X){var $=[];for(var Q=0;Q<X.length;Q++){var H=X[Q];if(H._tag==="Left")$.push(H.left)}return $},d5=function(X){return function($){return $.length<=1?q($):$.slice().sort(X.compare)}},r5=function(X,$,Q){var H=[],Y=Math.min(X.length,$.length);for(var V=0;V<Y;V++)H[V]=Q(X[V],$[V]);return H},b9=function(X){var $=[],Q=[];for(var H=0;H<X.length;H++)$[H]=X[H][0],Q[H]=X[H][1];return[$,Q]},p5=function(X){var $=P1(X);return function(Q){return L(Q)?$(Q):[]}},x9=function(X){var $=n4(X);return function(Q){return L(Q)?$(Q):q(Q)}},y9=function(X){var $=j1(X);return function(Q){return L(Q)?$(Q):q(Q)}},O0=v1,m9=function(X){var $=Y1(X);return function(Q){return L(Q)?$(Q):q(Q)}},l9=function(X){var $=_4(X);return function(Q){return L(Q)?$(Q):q(Q)}},c9=function(X){var $=D1(X);return function(Q){return L(Q)?$(Q):[]}},o5=function(X){return function($){return X>=1&&L($)?A0(X)($):S($)?[q($),[]]:[[],q($)]}},_9=function(X){var $=f4(X);return function(Q){return L(Q)?$(Q):[]}},d9=function(X){return function(){var $=[];for(var Q=0;Q<arguments.length;Q++)$[Q]=arguments[Q];return O5(X.apply(void 0,$))}},n5=function(X){return function($){return S($)?q(X):S(X)?q($):$.concat(X)}},f5=n5,w=function(X,$){return j(X,F0($))},R0=function(X,$){return j(X,Q7($))},R=function(X,$){return j(X,$7($))},W0=function(X,$){return j(X,y1($))},k0=function(X,$){return j(X,M0($))},g0=function(X,$){return j(X,H7($))},E0=function(X,$){return j(X,V7($))},t5=function(X,$){return j(X,m1($))},s5=function(X,$){return j(X,l1($))},M1=function(X,$){return j(X,j7($))},b=function(X,$,Q){return j(X,d1($,Q))},t=function(X){var $=J7(X);return function(Q,H){return j(Q,$(H))}},s=function(X,$,Q){return j(X,G7($,Q))},h1=function(X,$,Q){return j(X,r1($,Q))},u1=function(X){var $=Z7(X);return function(Q,H){return j(Q,$(H))}},b1=function(X,$,Q){return j(X,P7($,Q))},i5=function(X,$){return j(X,x1($))},e5=function(X,$){return j(X,c1($))},a5=function(X,$){return j(X,_1($))},I0=function(X){var $=D7(X);return function(Q,H){return j(Q,$(H))}},X7=function(X){var $=p1(X);return function(Q,H){return j(Q,$(H))}},p9=z5,o9=K5,x=o4,i=function(){return[]},F0=function(X){return function($){return $.map(function(Q){return X(Q)})}},$7=function(X){return A(function($){return j(X,F0($))})},A=U(2,function(X,$){return j(X,I5(function(Q,H){return $(H,Q)}))}),n9=A(B),Q7=function(X){return function($){return $.map(function(Q,H){return X(H,Q)})}},x1=function(X){return function($){var Q=[];for(var H=0;H<$.length;H++){var Y=X(H,$[H]);if(E(Y))Q.push(Y.value)}return Q}},M0=function(X){return x1(function($,Q){return X(Q)})},e=M0(B),y=function(X){var $=[],Q=[];for(var H=0,Y=X;H<Y.length;H++){var V=Y[H];if(V._tag==="Left")$.push(V.left);else Q.push(V.right)}return N0($,Q)},y1=function(X){return function($){return $.filter(X)}},H7=function(X){return m1(function($,Q){return X(Q)})},m1=function(X){return function($){var Q=[],H=[];for(var Y=0;Y<$.length;Y++){var V=$[Y];if(X(Y,V))H.push(V);else Q.push(V)}return N0(Q,H)}},V7=function(X){return l1(function($,Q){return X(Q)})},l1=function(X){return function($){var Q=[],H=[];for(var Y=0;Y<$.length;Y++){var V=X(Y,$[Y]);if(V._tag==="Left")Q.push(V.left);else H.push(V.right)}return N0(Q,H)}},Y7=function(X){return function($){return $.concat(X())}},j7=Y7,c1=function(X){return function($){return $.filter(function(Q,H){return X(H,Q)})}},_1=function(X){return function($){return $.map(function(Q,H){return X($.slice(H))})}},f9=_1(B),J7=C5,Z7=A1,d1=L5,r1=N1,G7=q5,P7=O1,D7=function(X){var $=p1(X);return function(Q){return $(function(H,Y){return Q(Y)})}},G0=function(X){return function($){return b($,X.of(i()),function(Q,H){return X.ap(X.map(Q,function(Y){return function(V){return j(Y,Z0(V))}}),H)})}},p1=function(X){return function($){return r1(X.of(i()),function(Q,H,Y){return X.ap(X.map(H,function(V){return function(J){return j(V,Z0(J))}}),$(Q,Y))})}},t9=function(X){var $=s1(X);return function(Q){return function(H){return $(H,Q)}}},s9=function(X){var $=i1(X);return function(Q){return function(H){return $(H,Q)}}},o1=function(X,$){var Q=[],H=X;while(!0){var Y=$(H);if(E(Y)){var V=Y.value,J=V[0],Z=V[1];Q.push(J),H=Z}else break}return Q},P="Array",i9=w5,z7=function(){return{concat:function(X,$){return X.concat($)}}},K7=function(){return{concat:z7().concat,empty:[]}},L7=B5,e9=T5,C7=function(X){var $=I1(X);return{concat:function(Q,H){return $(H)(Q)}}},a9=function(X){return{concat:C7(X).concat,empty:[]}},XX=function(X){var $=F1(X);return{concat:function(Q,H){return $(H)(Q)}}},$X=function(X){var $=S0(X);return{concat:function(Q,H){return $(H)(Q)}}},h0={URI:P,map:w},QX=H0(h0),q7={URI:P,of:x},HX={URI:P,map:w,mapWithIndex:R0},u0={URI:P,map:w,ap:R},VX=c(u0),YX=_(u0),jX={URI:P,map:w,ap:R,of:x},n1={URI:P,map:w,ap:R,chain:A},JX=B0(n1),ZX={URI:P,map:w,ap:R,of:x,chain:A},GX={URI:P,unfold:o1},PX={URI:P,map:w,alt:M1},w7={URI:P,zero:i},DX=H5(w7,q7),zX={URI:P,map:w,ap:R,of:x,alt:M1,zero:i},KX={URI:P,map:w,extend:a5},f1={URI:P,compact:e,separate:y},LX={URI:P,map:w,compact:e,separate:y,filter:W0,filterMap:k0,partition:g0,partitionMap:E0},CX={URI:P,map:w,mapWithIndex:R0,compact:e,separate:y,filter:W0,filterMap:k0,partition:g0,partitionMap:E0,partitionMapWithIndex:s5,partitionWithIndex:t5,filterMapWithIndex:i5,filterWithIndex:e5},B7={URI:P,reduce:b,foldMap:t,reduceRight:s},qX={URI:P,reduce:b,foldMap:t,reduceRight:s,reduceWithIndex:h1,foldMapWithIndex:u1,reduceRightWithIndex:b1},t1={URI:P,map:w,reduce:b,foldMap:t,reduceRight:s,traverse:I0,sequence:G0},wX={URI:P,map:w,mapWithIndex:R0,reduce:b,foldMap:t,reduceRight:s,reduceWithIndex:h1,foldMapWithIndex:u1,reduceRightWithIndex:b1,traverse:I0,sequence:G0,traverseWithIndex:X7},s1=$5(t1,f1),i1=X5(t1,f1),e1={URI:P,map:w,compact:e,separate:y,filter:W0,filterMap:k0,partition:g0,partitionMap:E0,reduce:b,foldMap:t,reduceRight:s,traverse:I0,sequence:G0,wither:s1,wilt:i1},BX=S1,TX={URI:P,map:w,ap:R,chain:A,chainRec:p9},UX=R1,vX={URI:P,map:w,ap:R,chain:A,chainRec:o9},AX=Q5(e1),T7={URI:P,fromEither:S5},NX=T0(T7),U7=l4,a1=function(X,$,Q){return L(Q)?c4(X,$,Q):[]},X4=function(X,$){var Q=$.slice();return Q.splice(X,1),Q},$4=U5,v7=function(X){return function($){return $.some(X)}},OX=v7,SX=v5,RX=x(m),WX=I(h0),kX=F(h0);var gX=M(n1),EX=d(u0),A7=A,IX=r4,N7=[],FX=s4,MX=i4,hX=p5,uX={URI:P,compact:e,separate:y,map:w,ap:R,of:x,chain:A,filter:W0,filterMap:k0,partition:g0,partitionMap:E0,mapWithIndex:R0,partitionMapWithIndex:s5,partitionWithIndex:t5,filterMapWithIndex:i5,filterWithIndex:e5,alt:M1,zero:i,unfold:o1,reduce:b,foldMap:t,reduceRight:s,traverse:I0,sequence:G0,reduceWithIndex:h1,foldMapWithIndex:u1,reduceRightWithIndex:b1,traverseWithIndex:X7,extend:a5,wither:s1,wilt:i1};var a=function(X){return function($){return!X($)}};var Q4=function(X){return function($){return function(Q){return $(Q)&&X(Q)}}};function D0(X){return function($){return X($)?k($):W}}var W=z,k=K;var bX=function(X){return X._tag==="Left"?W:k(X.right)},O7=function(X,$){return j(X,z0($))},xX=function(X,$){return j(X,yX($))};var H4="Option";var z0=function(X){return function($){return P0($)?W:k(X($.value))}},S7={URI:H4,map:O7},gQ=U(2,p0(S7)),EQ=U4(S7);var yX=function(X){return function($){return P0($)?W:P0(X)?W:k($.value(X.value))}};var R7=U(2,function(X,$){return P0(X)?W:$(X.value)}),W7={URI:H4,map:O7,ap:xX,chain:R7};var IQ=U(2,function(X,$){return P0(X)?$():X});var mX=bX,lX={URI:H4,fromEither:mX};var P0=function(X){return X._tag==="None"};var FQ=U(2,V0(W7)),MQ=U(2,v4(lX,W7));var V4=R7;var cX=function(){return{concat:function(X,$){return G(X,$)}}},g7=function(){return{concat:cX().concat,empty:B}};var K0=function(X){return R4(X)(X.empty)},mQ={concat:W4.concat,empty:void 0};var lQ={concat:k4.concat,empty:!0},cQ={concat:g4.concat,empty:!1};var _Q={concat:E4.concat,empty:""},dQ={concat:I4.concat,empty:0},rQ={concat:F4.concat,empty:1};var _X="Function",dX=(X)=>($)=>G($,X),Y4={URI:_X,map:(X,$)=>dX($)(X)},E7=O,rX=(X)=>($)=>(Q)=>$(Q)(X(Q)),b0={...Y4,of:E7,ap:(X,$)=>rX($)(X)},Q6=c(b0),H6=_(b0),pX=(X)=>($)=>(Q)=>X($(Q))(Q);var oX={...b0,chain:(X,$)=>pX($)(X)},V6=E7({}),Y6=I(Y4),j6=M(oX),J6=d(b0),Z6=F(Y4);var x0=B4;var j4=(X)=>($)=>(Q)=>X(Q)?Q:$(Q),G6=G(a,j4);var nX=(X)=>($)=>(Q)=>Q[X](...$),P6=w0(nX)([]);var fX=(X)=>($)=>(Q)=>X([$,Q]),D6=G(x0,fX),tX=(X)=>($)=>(Q)=>(H)=>X([$,Q,H]),z6=G(x0,tX),sX=(X)=>($)=>(Q)=>(H)=>(Y)=>X([$,Q,H,Y]),K6=G(x0,sX),iX=(X)=>($)=>(Q)=>(H)=>(Y)=>(V)=>X([$,Q,H,Y,V]),L6=G(x0,iX);var C6=K0(g7());var k6=G(a,(X)=>$4(X));var eX=K0(B1),g6=K0(T1),J4=(X)=>eX(X)/X.length,E6=G(G1(n),(X)=>{const $=X.length/2;return $%1===0?(X[$-1]+X[$])/2:X[Math.floor($)]});var aX=(X)=>($)=>(Q)=>X>=Q.length||$>=Q.length?W:X===$?k(Q):j(Q,W1(X),V4((H)=>j(g1(X)(Q),V4(k1($,H))))),I6=w0(aX);var F6=G(t0,K1),M6=G(s0,K1);var h6=Array.from;var Z4=Spicetify.Mousetrap(),L0="abcdefghijklmnopqrstuvwxyz".split(""),I7=()=>Array.from(v.getElementsByClassName("sneak-key")),X$=(X)=>{if(X.length===0)return!1;return v.remove(),j(X,N.map(($)=>$.remove())),document.body.append(v),!0},F7=G(I7,X$),M7=()=>{if(v.style.display="block",F7())return;const X=(V)=>V.checkVisibility({checkOpacity:!0,checkVisibilityCSS:!0}),$=(V)=>{const J=document.body,Z=V.getBoundingClientRect(),C=(D,g)=>(q4)=>q4===O4(j0.Ord)(D,g)(q4);return j(J4([Z.top,Z.bottom]),C(0,J.clientHeight))&&j(J4([Z.left,Z.right]),C(0,J.clientWidth))},Q=(V,J,Z,C)=>{const D=document.createElement("span");return D.classList.add("sneak-key"),D.innerText=J,D.style.top=Z+"px",D.style.left=C+"px",D.target=V,D},H=document.createDocumentFragment(),Y='.Root__top-container [href]:not(link),.Root__top-container button,.Root__top-container [role="button"]';if(y0=j(document.querySelectorAll(Y),(V)=>Array.from(V),N.filter(X),N.filter($),N.reduce([0,0],([V,J],Z)=>{const{x:C,y:D}=Z.getBoundingClientRect();return H.append(Q(Z,L0[V]+L0[J++],D,C)),J>=L0.length?[++V,0]:[V,J]}),([V,J])=>V+J>0),y0)v.append(H)},C0=()=>{v.style.display="none",F7(),q0=!1},h7=({key:X})=>{if(!q0){if(y0)y0=!1,q0=!0;return}const $=I7();if($.length===0)return void C0();if(v.remove(),$.map((Q)=>{const[H,...Y]=Q.innerText.toLowerCase();if(H!==X)return void Q.remove();if(Y.length===0)Q.target.click(),C0();else Q.innerText=Y.join("")}),document.body.append(v),v.childNodes.length===1)C0()},y0=!1,q0=!1,v=document.createElement("div");v.id="sneak-overlay";document.body.append(v);var G4="Lazy",P4=(X,$)=>()=>$(X()),u7=(X,$)=>()=>X()($()),b7=(X,$)=>$(X());var m0=O,$$=(X)=>($)=>b7($,X);var p6=$$(B),D4={URI:G4,map:P4},o6=H0(D4);var z4={URI:G4,map:P4,ap:u7},n6=c(z4),f6=_(z4);var x7={URI:G4,map:P4,ap:u7,chain:b7};var t6=B0(x7);var s6=m0({}),i6=I(D4),e6=M(x7),a6=d(z4),X8=F(D4);var Q$=m0([]),H$=(X)=>($)=>()=>{const Q=[X(0,h($))()];for(let H=1;H<$.length;H++)Q.push(X(H,$[H])());return Q},V$=(X)=>{const $=H$(X);return(Q)=>J0(Q)?$(Q):Q$};var Y$=(X)=>V$(($,Q)=>X(Q)),$8=Y$(B);var y7=a(Number.isNaN),J$=(X)=>($)=>j(Number.parseInt($,X),D0(y7)),j8=J$(10),J8=G(Number.parseFloat,D0(y7)),Z$=(X)=>X+1,G$=(X)=>X-1;var m7=(X)=>($)=>($%X+X)%X;var P$=(X)=>Math.abs(X)!==Infinity,Z8=j4(P$)((X)=>Math.sign(X)*Number.MAX_SAFE_INTEGER);var D$={...C1,top:Number.MAX_SAFE_INTEGER,bottom:Number.MIN_SAFE_INTEGER},G8={...D$,succ:G(D0(Q4((X)=>X<Number.MAX_SAFE_INTEGER)(Number.isInteger)),z0(Z$)),pred:G(D0(Q4((X)=>X>Number.MIN_SAFE_INTEGER)(Number.isInteger)),z0(G$)),toEnum:k,fromEnum:B,cardinality:m0(Infinity)};var K$=25,l7=()=>document.querySelector(".Root__main-view .os-viewport"),K4=(X)=>{const $=l7(),Q=setInterval(()=>$.scrollTop+=X*K$,10);document.addEventListener("keyup",()=>clearInterval(Q))},L4=(X)=>l7().scroll(0,X),c7=(X)=>Spicetify.Platform.History.push({pathname:X}),C4=(X)=>{const $=Array.from(document.querySelectorAll(".main-yourLibraryX-navLink").values());j(document.querySelector(".main-yourLibraryX-navLinkActive"),(Q)=>$.findIndex((H)=>H===Q),(Q)=>j(Q===-1&&X<=0?X:Q+X,m7($.length)),(Q)=>$[Q].click())};class T{X;$;ctrl=!1;shift=!1;alt=!1;constructor(X,$){this.key=X;this.callback=$}setCtrl=(X)=>(this.ctrl=X,this);setShift=(X)=>(this.shift=X,this);setAlt=(X)=>(this.alt=X,this);register=()=>Spicetify.Keyboard.registerShortcut({key:this.key,ctrl:this.ctrl,shift:this.shift,alt:this.alt},(X)=>void(!q0&&this.callback(X)))}var _7;(function(l0){let X;(function(X0){X0.start=O({before:"start"}),X0.fromUri=(V)=>({before:{uri:V}}),X0.fromUid=(V)=>({before:{uid:V}})})(X=l0.before||(l0.before={}));let $;(function($0){$0.end=O({after:"end"}),$0.fromUri=(V)=>({before:{uri:V}}),$0.fromUid=(V)=>({before:{uid:V}})})($=l0.after||(l0.after={}))})(_7||(_7={}));//! Does location actually point to document.body?
var L$=(X)=>Spicetify.Platform.LibraryAPI.contains(...X),d7=(X,$)=>Spicetify.Platform.LibraryAPI[$?"add":"remove"](...X),r7=async(X)=>{const $=await L$(X);return await j(X,N.reduceWithIndex([[],[]],(Q,H,Y)=>(H[Number($[Q])].push(Y),H)),([Q,H])=>{const Y=[];if(Q.length)Y.push(d7(Q,!0));if(H.length)Y.push(d7(H,!1));return Promise.all(Y)})};(async()=>{if(!document.getElementById("QL9DDk7W4Cvd3SZxYVftCFUYJ34OOOMYJhq3PLAu-LA")){const $=document.createElement("style");$.id="QL9DDk7W4Cvd3SZxYVftCFUYJ34OOOMYJhq3PLAu-LA",$.textContent="#sneak-overlay {\n  z-index: 100000;\n  position: absolute;\n  width: 100%;\n  height: 100%;\n  display: none;\n}\n#sneak-overlay > .sneak-key {\n  position: fixed;\n  padding: 3px 6px;\n  background-color: black;\n  border-radius: 3px;\n  border: solid 2px white;\n  color: white;\n  text-transform: lowercase;\n  line-height: normal;\n  font-size: 14px;\n  font-weight: 500;\n}",document.head.appendChild($)}})();var{KEYS:C$}=Spicetify.Keyboard,q$=[new T("s",M7),new T("s",async()=>{await(Spicetify.Platform.UserAPI._product_state||Spicetify.Platform.UserAPI._product_state_service).putValues({pairs:{"app-developer":"2"}}),Spicetify.Platform.UpdateAPI.applyUpdate()}).setShift(!0),new T("tab",()=>C4(1)),new T("tab",()=>C4(-1)).setShift(!0),new T("h",Spicetify.Platform.History.goBack).setShift(!0),new T("l",Spicetify.Platform.History.goForward).setShift(!0),new T("j",()=>K4(1)),new T("k",()=>K4(-1)),new T("g",()=>L4(0)),new T("g",()=>L4(Number.MAX_SAFE_INTEGER)).setShift(!0),new T("m",()=>r7([Spicetify.Player.data.item.uri])),new T("/",(X)=>{X.preventDefault(),c7("/search")})];q$.map((X)=>X.register());Z4.bind(L0,h7,"keypress");Z4.bind(C$.ESCAPE,C0);

//# debugId=9A6342D15DB1FBEC64756e2164756e21
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsiLi4vbm9kZV9tb2R1bGVzL2ZwLXRzL2VzNi9mdW5jdGlvbi5qcyIsICIuLi9ub2RlX21vZHVsZXMvZnAtdHMvZXM2L2Z1bmN0aW9uLmpzIiwgIi4uL25vZGVfbW9kdWxlcy9mcC10cy9lczYvZnVuY3Rpb24uanMiLCAiLi4vbm9kZV9tb2R1bGVzL2ZwLXRzL2VzNi9mdW5jdGlvbi5qcyIsICIuLi9ub2RlX21vZHVsZXMvZnAtdHMvZXM2L2Z1bmN0aW9uLmpzIiwgIi4uL25vZGVfbW9kdWxlcy9mcC10cy9lczYvaW50ZXJuYWwuanMiLCAiLi4vbm9kZV9tb2R1bGVzL2ZwLXRzL2VzNi9pbnRlcm5hbC5qcyIsICIuLi9ub2RlX21vZHVsZXMvZnAtdHMvZXM2L2ludGVybmFsLmpzIiwgIi4uL25vZGVfbW9kdWxlcy9mcC10cy9lczYvaW50ZXJuYWwuanMiLCAiLi4vbm9kZV9tb2R1bGVzL2ZwLXRzL2VzNi9BcHBseS5qcyIsICIuLi9ub2RlX21vZHVsZXMvZnAtdHMvZXM2L0Z1bmN0b3IuanMiLCAiLi4vbm9kZV9tb2R1bGVzL2ZwLXRzL2VzNi9GdW5jdG9yLmpzIiwgIi4uL25vZGVfbW9kdWxlcy9mcC10cy9lczYvQ2hhaW4uanMiLCAiLi4vbm9kZV9tb2R1bGVzL2ZwLXRzL2VzNi9Gcm9tRWl0aGVyLmpzIiwgIi4uL25vZGVfbW9kdWxlcy9mcC10cy9lczYvRnJvbUVpdGhlci5qcyIsICIuLi9ub2RlX21vZHVsZXMvZnAtdHMvZXM2L0VxLmpzIiwgIi4uL25vZGVfbW9kdWxlcy9mcC10cy9lczYvRXEuanMiLCAiLi4vbm9kZV9tb2R1bGVzL2ZwLXRzL2VzNi9FcS5qcyIsICIuLi9ub2RlX21vZHVsZXMvZnAtdHMvZXM2L09yZC5qcyIsICIuLi9ub2RlX21vZHVsZXMvZnAtdHMvZXM2L09yZC5qcyIsICIuLi9ub2RlX21vZHVsZXMvZnAtdHMvZXM2L09yZC5qcyIsICIuLi9ub2RlX21vZHVsZXMvZnAtdHMvZXM2L09yZC5qcyIsICIuLi9ub2RlX21vZHVsZXMvZnAtdHMvZXM2L01hZ21hLmpzIiwgIi4uL25vZGVfbW9kdWxlcy9mcC10cy9lczYvU2VtaWdyb3VwLmpzIiwgIi4uL25vZGVfbW9kdWxlcy9mcC10cy9lczYvU2VtaWdyb3VwLmpzIiwgIi4uL25vZGVfbW9kdWxlcy9mcC10cy9lczYvU2VtaWdyb3VwLmpzIiwgIi4uL25vZGVfbW9kdWxlcy9mcC10cy9lczYvU2VtaWdyb3VwLmpzIiwgIi4uL25vZGVfbW9kdWxlcy9mcC10cy9lczYvUmVhZG9ubHlOb25FbXB0eUFycmF5LmpzIiwgIi4uL25vZGVfbW9kdWxlcy9mcC10cy9lczYvUmVhZG9ubHlOb25FbXB0eUFycmF5LmpzIiwgIi4uL25vZGVfbW9kdWxlcy9mcC10cy9lczYvUmVhZG9ubHlOb25FbXB0eUFycmF5LmpzIiwgIi4uL25vZGVfbW9kdWxlcy9mcC10cy9lczYvUmVhZG9ubHlOb25FbXB0eUFycmF5LmpzIiwgIi4uL25vZGVfbW9kdWxlcy9mcC10cy9lczYvUmVhZG9ubHlOb25FbXB0eUFycmF5LmpzIiwgIi4uL25vZGVfbW9kdWxlcy9mcC10cy9lczYvUmVhZG9ubHlOb25FbXB0eUFycmF5LmpzIiwgIi4uL25vZGVfbW9kdWxlcy9mcC10cy9lczYvUmVhZG9ubHlOb25FbXB0eUFycmF5LmpzIiwgIi4uL25vZGVfbW9kdWxlcy9mcC10cy9lczYvTm9uRW1wdHlBcnJheS5qcyIsICIuLi9ub2RlX21vZHVsZXMvZnAtdHMvZXM2L05vbkVtcHR5QXJyYXkuanMiLCAiLi4vbm9kZV9tb2R1bGVzL2ZwLXRzL2VzNi9Ob25FbXB0eUFycmF5LmpzIiwgIi4uL25vZGVfbW9kdWxlcy9mcC10cy9lczYvTm9uRW1wdHlBcnJheS5qcyIsICIuLi9ub2RlX21vZHVsZXMvZnAtdHMvZXM2L05vbkVtcHR5QXJyYXkuanMiLCAiLi4vbm9kZV9tb2R1bGVzL2ZwLXRzL2VzNi9Ob25FbXB0eUFycmF5LmpzIiwgIi4uL25vZGVfbW9kdWxlcy9mcC10cy9lczYvTm9uRW1wdHlBcnJheS5qcyIsICIuLi9ub2RlX21vZHVsZXMvZnAtdHMvZXM2L05vbkVtcHR5QXJyYXkuanMiLCAiLi4vbm9kZV9tb2R1bGVzL2ZwLXRzL2VzNi9Ob25FbXB0eUFycmF5LmpzIiwgIi4uL25vZGVfbW9kdWxlcy9mcC10cy9lczYvTm9uRW1wdHlBcnJheS5qcyIsICIuLi9ub2RlX21vZHVsZXMvZnAtdHMvZXM2L05vbkVtcHR5QXJyYXkuanMiLCAiLi4vbm9kZV9tb2R1bGVzL2ZwLXRzL2VzNi9udW1iZXIuanMiLCAiLi4vbm9kZV9tb2R1bGVzL2ZwLXRzL2VzNi9TZXBhcmF0ZWQuanMiLCAiLi4vbm9kZV9tb2R1bGVzL2ZwLXRzL2VzNi9XaXRoZXJhYmxlLmpzIiwgIi4uL25vZGVfbW9kdWxlcy9mcC10cy9lczYvWmVyby5qcyIsICIuLi9ub2RlX21vZHVsZXMvZnAtdHMvZXM2L1JlYWRvbmx5QXJyYXkuanMiLCAiLi4vbm9kZV9tb2R1bGVzL2ZwLXRzL2VzNi9SZWFkb25seUFycmF5LmpzIiwgIi4uL25vZGVfbW9kdWxlcy9mcC10cy9lczYvUmVhZG9ubHlBcnJheS5qcyIsICIuLi9ub2RlX21vZHVsZXMvZnAtdHMvZXM2L1JlYWRvbmx5QXJyYXkuanMiLCAiLi4vbm9kZV9tb2R1bGVzL2ZwLXRzL2VzNi9SZWFkb25seUFycmF5LmpzIiwgIi4uL25vZGVfbW9kdWxlcy9mcC10cy9lczYvUmVhZG9ubHlBcnJheS5qcyIsICIuLi9ub2RlX21vZHVsZXMvZnAtdHMvZXM2L1JlYWRvbmx5QXJyYXkuanMiLCAiLi4vbm9kZV9tb2R1bGVzL2ZwLXRzL2VzNi9SZWFkb25seUFycmF5LmpzIiwgIi4uL25vZGVfbW9kdWxlcy9mcC10cy9lczYvUmVhZG9ubHlBcnJheS5qcyIsICIuLi9ub2RlX21vZHVsZXMvZnAtdHMvZXM2L1JlYWRvbmx5QXJyYXkuanMiLCAiLi4vbm9kZV9tb2R1bGVzL2ZwLXRzL2VzNi9SZWFkb25seUFycmF5LmpzIiwgIi4uL25vZGVfbW9kdWxlcy9mcC10cy9lczYvUmVhZG9ubHlBcnJheS5qcyIsICIuLi9ub2RlX21vZHVsZXMvZnAtdHMvZXM2L1JlYWRvbmx5QXJyYXkuanMiLCAiLi4vbm9kZV9tb2R1bGVzL2ZwLXRzL2VzNi9SZWFkb25seUFycmF5LmpzIiwgIi4uL25vZGVfbW9kdWxlcy9mcC10cy9lczYvUmVhZG9ubHlBcnJheS5qcyIsICIuLi9ub2RlX21vZHVsZXMvZnAtdHMvZXM2L0FycmF5LmpzIiwgIi4uL25vZGVfbW9kdWxlcy9mcC10cy9lczYvQXJyYXkuanMiLCAiLi4vbm9kZV9tb2R1bGVzL2ZwLXRzL2VzNi9QcmVkaWNhdGUuanMiLCAiLi4vbm9kZV9tb2R1bGVzL2ZwLXRzL2VzNi9QcmVkaWNhdGUuanMiLCAiLi4vbm9kZV9tb2R1bGVzL2ZwLXRzL2VzNi9PcHRpb24uanMiLCAiLi4vbm9kZV9tb2R1bGVzL2ZwLXRzL2VzNi9PcHRpb24uanMiLCAiLi4vbm9kZV9tb2R1bGVzL2ZwLXRzL2VzNi9PcHRpb24uanMiLCAiLi4vbm9kZV9tb2R1bGVzL2ZwLXRzL2VzNi9PcHRpb24uanMiLCAiLi4vbm9kZV9tb2R1bGVzL2ZwLXRzL2VzNi9PcHRpb24uanMiLCAiLi4vbm9kZV9tb2R1bGVzL2ZwLXRzL2VzNi9PcHRpb24uanMiLCAiLi4vbm9kZV9tb2R1bGVzL2ZwLXRzL2VzNi9PcHRpb24uanMiLCAiLi4vbm9kZV9tb2R1bGVzL2ZwLXRzL2VzNi9PcHRpb24uanMiLCAiLi4vbm9kZV9tb2R1bGVzL2ZwLXRzL2VzNi9PcHRpb24uanMiLCAiLi4vbm9kZV9tb2R1bGVzL2ZwLXRzL2VzNi9PcHRpb24uanMiLCAiLi4vbm9kZV9tb2R1bGVzL2ZwLXRzL2VzNi9PcHRpb24uanMiLCAiLi4vbm9kZV9tb2R1bGVzL2ZwLXRzL2VzNi9PcHRpb24uanMiLCAiLi4vbm9kZV9tb2R1bGVzL2ZwLXRzL2VzNi9FbmRvbW9ycGhpc20uanMiLCAiLi4vbm9kZV9tb2R1bGVzL2ZwLXRzL2VzNi9Nb25vaWQuanMiLCAiLi4vbm9kZV9tb2R1bGVzL2ZwLXRzL2VzNi9Nb25vaWQuanMiLCAiLi4vbm9kZV9tb2R1bGVzL2ZwLXRzL2VzNi9Nb25vaWQuanMiLCAiLi4vbm9kZV9tb2R1bGVzL2ZwLXRzLXN0ZC9kaXN0L2VzbS9GdW5jdGlvbi5qcyIsICIuLi9ub2RlX21vZHVsZXMvZnAtdHMtc3RkL2Rpc3QvZXNtL0Z1bmN0aW9uLmpzIiwgIi4uL25vZGVfbW9kdWxlcy9mcC10cy1zdGQvZGlzdC9lc20vRnVuY3Rpb24uanMiLCAiLi4vbm9kZV9tb2R1bGVzL2ZwLXRzLXN0ZC9kaXN0L2VzbS9GdW5jdGlvbi5qcyIsICIuLi9ub2RlX21vZHVsZXMvZnAtdHMtc3RkL2Rpc3QvZXNtL0Z1bmN0aW9uLmpzIiwgIi4uL25vZGVfbW9kdWxlcy9mcC10cy1zdGQvZGlzdC9lc20vRnVuY3Rpb24uanMiLCAiLi4vbm9kZV9tb2R1bGVzL2ZwLXRzLXN0ZC9kaXN0L2VzbS9GdW5jdGlvbi5qcyIsICIuLi9ub2RlX21vZHVsZXMvZnAtdHMtc3RkL2Rpc3QvZXNtL0FycmF5LmpzIiwgIi4uL25vZGVfbW9kdWxlcy9mcC10cy1zdGQvZGlzdC9lc20vQXJyYXkuanMiLCAiLi4vbm9kZV9tb2R1bGVzL2ZwLXRzLXN0ZC9kaXN0L2VzbS9BcnJheS5qcyIsICIuLi9ub2RlX21vZHVsZXMvZnAtdHMtc3RkL2Rpc3QvZXNtL0FycmF5LmpzIiwgIi4uL25vZGVfbW9kdWxlcy9mcC10cy1zdGQvZGlzdC9lc20vQXJyYXkuanMiLCAiLi4vZXh0ZW5zaW9ucy9rZXlib2FyZC1zaG9ydGN1dHMvc25lYWsudHN4IiwgIi4uL25vZGVfbW9kdWxlcy9mcC10cy1zdGQvZGlzdC9lc20vTGF6eS5qcyIsICIuLi9ub2RlX21vZHVsZXMvZnAtdHMtc3RkL2Rpc3QvZXNtL0xhenkuanMiLCAiLi4vbm9kZV9tb2R1bGVzL2ZwLXRzLXN0ZC9kaXN0L2VzbS9MYXp5LmpzIiwgIi4uL25vZGVfbW9kdWxlcy9mcC10cy1zdGQvZGlzdC9lc20vTGF6eS5qcyIsICIuLi9ub2RlX21vZHVsZXMvZnAtdHMtc3RkL2Rpc3QvZXNtL0xhenkuanMiLCAiLi4vbm9kZV9tb2R1bGVzL2ZwLXRzLXN0ZC9kaXN0L2VzbS9MYXp5LmpzIiwgIi4uL25vZGVfbW9kdWxlcy9mcC10cy1zdGQvZGlzdC9lc20vTGF6eS5qcyIsICIuLi9ub2RlX21vZHVsZXMvZnAtdHMtc3RkL2Rpc3QvZXNtL0xhenkuanMiLCAiLi4vbm9kZV9tb2R1bGVzL2ZwLXRzLXN0ZC9kaXN0L2VzbS9MYXp5LmpzIiwgIi4uL25vZGVfbW9kdWxlcy9mcC10cy1zdGQvZGlzdC9lc20vTnVtYmVyLmpzIiwgIi4uL25vZGVfbW9kdWxlcy9mcC10cy1zdGQvZGlzdC9lc20vTnVtYmVyLmpzIiwgIi4uL25vZGVfbW9kdWxlcy9mcC10cy1zdGQvZGlzdC9lc20vTnVtYmVyLmpzIiwgIi4uL25vZGVfbW9kdWxlcy9mcC10cy1zdGQvZGlzdC9lc20vTnVtYmVyLmpzIiwgIi4uL2V4dGVuc2lvbnMva2V5Ym9hcmQtc2hvcnRjdXRzL3V0aWwudHN4IiwgIi4uL2V4dGVuc2lvbnMva2V5Ym9hcmQtc2hvcnRjdXRzL3V0aWwudHN4IiwgIi4uL3NoYXJlZC91dGlsLnRzeCIsICIuLi9zaGFyZWQvdXRpbC50c3giLCAiLi4vc2hhcmVkL3V0aWwudHN4IiwgIi9ob21lL2RlbHVzb2lyZS9kZXYvc3BpY2V0aWZ5LWV4dGVuc2lvbnMvZXh0ZW5zaW9ucy9rZXlib2FyZC1zaG9ydGN1dHMvYXNzZXRzL3N0eWxlcy5zY3NzIiwgIi4uL2V4dGVuc2lvbnMva2V5Ym9hcmQtc2hvcnRjdXRzL2FwcC50c3giXSwKICAic291cmNlc0NvbnRlbnQiOiBbCiAgICAidmFyIF9fc3ByZWFkQXJyYXkgPSAodGhpcyAmJiB0aGlzLl9fc3ByZWFkQXJyYXkpIHx8IGZ1bmN0aW9uICh0bywgZnJvbSwgcGFjaykge1xuICAgIGlmIChwYWNrIHx8IGFyZ3VtZW50cy5sZW5ndGggPT09IDIpIGZvciAodmFyIGkgPSAwLCBsID0gZnJvbS5sZW5ndGgsIGFyOyBpIDwgbDsgaSsrKSB7XG4gICAgICAgIGlmIChhciB8fCAhKGkgaW4gZnJvbSkpIHtcbiAgICAgICAgICAgIGlmICghYXIpIGFyID0gQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoZnJvbSwgMCwgaSk7XG4gICAgICAgICAgICBhcltpXSA9IGZyb21baV07XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHRvLmNvbmNhdChhciB8fCBBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChmcm9tKSk7XG59O1xuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLy8gaW5zdGFuY2VzXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjEwLjBcbiAqL1xuZXhwb3J0IHZhciBnZXRCb29sZWFuQWxnZWJyYSA9IGZ1bmN0aW9uIChCKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uICgpIHsgcmV0dXJuICh7XG4gICAgICAgIG1lZXQ6IGZ1bmN0aW9uICh4LCB5KSB7IHJldHVybiBmdW5jdGlvbiAoYSkgeyByZXR1cm4gQi5tZWV0KHgoYSksIHkoYSkpOyB9OyB9LFxuICAgICAgICBqb2luOiBmdW5jdGlvbiAoeCwgeSkgeyByZXR1cm4gZnVuY3Rpb24gKGEpIHsgcmV0dXJuIEIuam9pbih4KGEpLCB5KGEpKTsgfTsgfSxcbiAgICAgICAgemVybzogZnVuY3Rpb24gKCkgeyByZXR1cm4gQi56ZXJvOyB9LFxuICAgICAgICBvbmU6IGZ1bmN0aW9uICgpIHsgcmV0dXJuIEIub25lOyB9LFxuICAgICAgICBpbXBsaWVzOiBmdW5jdGlvbiAoeCwgeSkgeyByZXR1cm4gZnVuY3Rpb24gKGEpIHsgcmV0dXJuIEIuaW1wbGllcyh4KGEpLCB5KGEpKTsgfTsgfSxcbiAgICAgICAgbm90OiBmdW5jdGlvbiAoeCkgeyByZXR1cm4gZnVuY3Rpb24gKGEpIHsgcmV0dXJuIEIubm90KHgoYSkpOyB9OyB9XG4gICAgfSk7IH07XG59O1xuLyoqXG4gKiBVbmFyeSBmdW5jdGlvbnMgZm9ybSBhIHNlbWlncm91cCBhcyBsb25nIGFzIHlvdSBjYW4gcHJvdmlkZSBhIHNlbWlncm91cCBmb3IgdGhlIGNvZG9tYWluLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBQcmVkaWNhdGUsIGdldFNlbWlncm91cCB9IGZyb20gJ2ZwLXRzL2Z1bmN0aW9uJ1xuICogaW1wb3J0ICogYXMgQiBmcm9tICdmcC10cy9ib29sZWFuJ1xuICpcbiAqIGNvbnN0IGY6IFByZWRpY2F0ZTxudW1iZXI+ID0gKG4pID0+IG4gPD0gMlxuICogY29uc3QgZzogUHJlZGljYXRlPG51bWJlcj4gPSAobikgPT4gbiA+PSAwXG4gKlxuICogY29uc3QgUzEgPSBnZXRTZW1pZ3JvdXAoQi5TZW1pZ3JvdXBBbGwpPG51bWJlcj4oKVxuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoUzEuY29uY2F0KGYsIGcpKDEpLCB0cnVlKVxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChTMS5jb25jYXQoZiwgZykoMyksIGZhbHNlKVxuICpcbiAqIGNvbnN0IFMyID0gZ2V0U2VtaWdyb3VwKEIuU2VtaWdyb3VwQW55KTxudW1iZXI+KClcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKFMyLmNvbmNhdChmLCBnKSgxKSwgdHJ1ZSlcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoUzIuY29uY2F0KGYsIGcpKDMpLCB0cnVlKVxuICpcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjEwLjBcbiAqL1xuZXhwb3J0IHZhciBnZXRTZW1pZ3JvdXAgPSBmdW5jdGlvbiAoUykge1xuICAgIHJldHVybiBmdW5jdGlvbiAoKSB7IHJldHVybiAoe1xuICAgICAgICBjb25jYXQ6IGZ1bmN0aW9uIChmLCBnKSB7IHJldHVybiBmdW5jdGlvbiAoYSkgeyByZXR1cm4gUy5jb25jYXQoZihhKSwgZyhhKSk7IH07IH1cbiAgICB9KTsgfTtcbn07XG4vKipcbiAqIFVuYXJ5IGZ1bmN0aW9ucyBmb3JtIGEgbW9ub2lkIGFzIGxvbmcgYXMgeW91IGNhbiBwcm92aWRlIGEgbW9ub2lkIGZvciB0aGUgY29kb21haW4uXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IFByZWRpY2F0ZSB9IGZyb20gJ2ZwLXRzL1ByZWRpY2F0ZSdcbiAqIGltcG9ydCB7IGdldE1vbm9pZCB9IGZyb20gJ2ZwLXRzL2Z1bmN0aW9uJ1xuICogaW1wb3J0ICogYXMgQiBmcm9tICdmcC10cy9ib29sZWFuJ1xuICpcbiAqIGNvbnN0IGY6IFByZWRpY2F0ZTxudW1iZXI+ID0gKG4pID0+IG4gPD0gMlxuICogY29uc3QgZzogUHJlZGljYXRlPG51bWJlcj4gPSAobikgPT4gbiA+PSAwXG4gKlxuICogY29uc3QgTTEgPSBnZXRNb25vaWQoQi5Nb25vaWRBbGwpPG51bWJlcj4oKVxuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoTTEuY29uY2F0KGYsIGcpKDEpLCB0cnVlKVxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChNMS5jb25jYXQoZiwgZykoMyksIGZhbHNlKVxuICpcbiAqIGNvbnN0IE0yID0gZ2V0TW9ub2lkKEIuTW9ub2lkQW55KTxudW1iZXI+KClcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKE0yLmNvbmNhdChmLCBnKSgxKSwgdHJ1ZSlcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoTTIuY29uY2F0KGYsIGcpKDMpLCB0cnVlKVxuICpcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjEwLjBcbiAqL1xuZXhwb3J0IHZhciBnZXRNb25vaWQgPSBmdW5jdGlvbiAoTSkge1xuICAgIHZhciBnZXRTZW1pZ3JvdXBNID0gZ2V0U2VtaWdyb3VwKE0pO1xuICAgIHJldHVybiBmdW5jdGlvbiAoKSB7IHJldHVybiAoe1xuICAgICAgICBjb25jYXQ6IGdldFNlbWlncm91cE0oKS5jb25jYXQsXG4gICAgICAgIGVtcHR5OiBmdW5jdGlvbiAoKSB7IHJldHVybiBNLmVtcHR5OyB9XG4gICAgfSk7IH07XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi4xMC4wXG4gKi9cbmV4cG9ydCB2YXIgZ2V0U2VtaXJpbmcgPSBmdW5jdGlvbiAoUykgeyByZXR1cm4gKHtcbiAgICBhZGQ6IGZ1bmN0aW9uIChmLCBnKSB7IHJldHVybiBmdW5jdGlvbiAoeCkgeyByZXR1cm4gUy5hZGQoZih4KSwgZyh4KSk7IH07IH0sXG4gICAgemVybzogZnVuY3Rpb24gKCkgeyByZXR1cm4gUy56ZXJvOyB9LFxuICAgIG11bDogZnVuY3Rpb24gKGYsIGcpIHsgcmV0dXJuIGZ1bmN0aW9uICh4KSB7IHJldHVybiBTLm11bChmKHgpLCBnKHgpKTsgfTsgfSxcbiAgICBvbmU6IGZ1bmN0aW9uICgpIHsgcmV0dXJuIFMub25lOyB9XG59KTsgfTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuMTAuMFxuICovXG5leHBvcnQgdmFyIGdldFJpbmcgPSBmdW5jdGlvbiAoUikge1xuICAgIHZhciBTID0gZ2V0U2VtaXJpbmcoUik7XG4gICAgcmV0dXJuIHtcbiAgICAgICAgYWRkOiBTLmFkZCxcbiAgICAgICAgbXVsOiBTLm11bCxcbiAgICAgICAgb25lOiBTLm9uZSxcbiAgICAgICAgemVybzogUy56ZXJvLFxuICAgICAgICBzdWI6IGZ1bmN0aW9uIChmLCBnKSB7IHJldHVybiBmdW5jdGlvbiAoeCkgeyByZXR1cm4gUi5zdWIoZih4KSwgZyh4KSk7IH07IH1cbiAgICB9O1xufTtcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8vIHV0aWxzXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vKipcbiAqIEBzaW5jZSAyLjExLjBcbiAqL1xuZXhwb3J0IHZhciBhcHBseSA9IGZ1bmN0aW9uIChhKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChmKSB7XG4gICAgICAgIHJldHVybiBmKGEpO1xuICAgIH07XG59O1xuLyoqXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGlkZW50aXR5KGEpIHtcbiAgICByZXR1cm4gYTtcbn1cbi8qKlxuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgdW5zYWZlQ29lcmNlID0gaWRlbnRpdHk7XG4vKipcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgZnVuY3Rpb24gY29uc3RhbnQoYSkge1xuICAgIHJldHVybiBmdW5jdGlvbiAoKSB7IHJldHVybiBhOyB9O1xufVxuLyoqXG4gKiBBIHRodW5rIHRoYXQgcmV0dXJucyBhbHdheXMgYHRydWVgLlxuICpcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIGNvbnN0VHJ1ZSA9IC8qI19fUFVSRV9fKi8gY29uc3RhbnQodHJ1ZSk7XG4vKipcbiAqIEEgdGh1bmsgdGhhdCByZXR1cm5zIGFsd2F5cyBgZmFsc2VgLlxuICpcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIGNvbnN0RmFsc2UgPSAvKiNfX1BVUkVfXyovIGNvbnN0YW50KGZhbHNlKTtcbi8qKlxuICogQSB0aHVuayB0aGF0IHJldHVybnMgYWx3YXlzIGBudWxsYC5cbiAqXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciBjb25zdE51bGwgPSAvKiNfX1BVUkVfXyovIGNvbnN0YW50KG51bGwpO1xuLyoqXG4gKiBBIHRodW5rIHRoYXQgcmV0dXJucyBhbHdheXMgYHVuZGVmaW5lZGAuXG4gKlxuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgY29uc3RVbmRlZmluZWQgPSAvKiNfX1BVUkVfXyovIGNvbnN0YW50KHVuZGVmaW5lZCk7XG4vKipcbiAqIEEgdGh1bmsgdGhhdCByZXR1cm5zIGFsd2F5cyBgdm9pZGAuXG4gKlxuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgY29uc3RWb2lkID0gY29uc3RVbmRlZmluZWQ7XG5leHBvcnQgZnVuY3Rpb24gZmxpcChmKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIGFyZ3MgPSBbXTtcbiAgICAgICAgZm9yICh2YXIgX2kgPSAwOyBfaSA8IGFyZ3VtZW50cy5sZW5ndGg7IF9pKyspIHtcbiAgICAgICAgICAgIGFyZ3NbX2ldID0gYXJndW1lbnRzW19pXTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoYXJncy5sZW5ndGggPiAxKSB7XG4gICAgICAgICAgICByZXR1cm4gZihhcmdzWzFdLCBhcmdzWzBdKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gZnVuY3Rpb24gKGEpIHsgcmV0dXJuIGYoYSkoYXJnc1swXSk7IH07XG4gICAgfTtcbn1cbmV4cG9ydCBmdW5jdGlvbiBmbG93KGFiLCBiYywgY2QsIGRlLCBlZiwgZmcsIGdoLCBoaSwgaWopIHtcbiAgICBzd2l0Y2ggKGFyZ3VtZW50cy5sZW5ndGgpIHtcbiAgICAgICAgY2FzZSAxOlxuICAgICAgICAgICAgcmV0dXJuIGFiO1xuICAgICAgICBjYXNlIDI6XG4gICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBiYyhhYi5hcHBseSh0aGlzLCBhcmd1bWVudHMpKTtcbiAgICAgICAgICAgIH07XG4gICAgICAgIGNhc2UgMzpcbiAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGNkKGJjKGFiLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykpKTtcbiAgICAgICAgICAgIH07XG4gICAgICAgIGNhc2UgNDpcbiAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGRlKGNkKGJjKGFiLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykpKSk7XG4gICAgICAgICAgICB9O1xuICAgICAgICBjYXNlIDU6XG4gICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBlZihkZShjZChiYyhhYi5hcHBseSh0aGlzLCBhcmd1bWVudHMpKSkpKTtcbiAgICAgICAgICAgIH07XG4gICAgICAgIGNhc2UgNjpcbiAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZnKGVmKGRlKGNkKGJjKGFiLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykpKSkpKTtcbiAgICAgICAgICAgIH07XG4gICAgICAgIGNhc2UgNzpcbiAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGdoKGZnKGVmKGRlKGNkKGJjKGFiLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykpKSkpKSk7XG4gICAgICAgICAgICB9O1xuICAgICAgICBjYXNlIDg6XG4gICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBoaShnaChmZyhlZihkZShjZChiYyhhYi5hcHBseSh0aGlzLCBhcmd1bWVudHMpKSkpKSkpKTtcbiAgICAgICAgICAgIH07XG4gICAgICAgIGNhc2UgOTpcbiAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGlqKGhpKGdoKGZnKGVmKGRlKGNkKGJjKGFiLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykpKSkpKSkpKTtcbiAgICAgICAgICAgIH07XG4gICAgfVxuICAgIHJldHVybjtcbn1cbi8qKlxuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiB0dXBsZSgpIHtcbiAgICB2YXIgdCA9IFtdO1xuICAgIGZvciAodmFyIF9pID0gMDsgX2kgPCBhcmd1bWVudHMubGVuZ3RoOyBfaSsrKSB7XG4gICAgICAgIHRbX2ldID0gYXJndW1lbnRzW19pXTtcbiAgICB9XG4gICAgcmV0dXJuIHQ7XG59XG4vKipcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgZnVuY3Rpb24gaW5jcmVtZW50KG4pIHtcbiAgICByZXR1cm4gbiArIDE7XG59XG4vKipcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgZnVuY3Rpb24gZGVjcmVtZW50KG4pIHtcbiAgICByZXR1cm4gbiAtIDE7XG59XG4vKipcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgZnVuY3Rpb24gYWJzdXJkKF8pIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ0NhbGxlZCBgYWJzdXJkYCBmdW5jdGlvbiB3aGljaCBzaG91bGQgYmUgdW5jYWxsYWJsZScpO1xufVxuLyoqXG4gKiBDcmVhdGVzIGEgdHVwbGVkIHZlcnNpb24gb2YgdGhpcyBmdW5jdGlvbjogaW5zdGVhZCBvZiBgbmAgYXJndW1lbnRzLCBpdCBhY2NlcHRzIGEgc2luZ2xlIHR1cGxlIGFyZ3VtZW50LlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyB0dXBsZWQgfSBmcm9tICdmcC10cy9mdW5jdGlvbidcbiAqXG4gKiBjb25zdCBhZGQgPSB0dXBsZWQoKHg6IG51bWJlciwgeTogbnVtYmVyKTogbnVtYmVyID0+IHggKyB5KVxuICpcbiAqIGFzc2VydC5zdHJpY3RFcXVhbChhZGQoWzEsIDJdKSwgMylcbiAqXG4gKiBAc2luY2UgMi40LjBcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHR1cGxlZChmKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhKSB7IHJldHVybiBmLmFwcGx5KHZvaWQgMCwgYSk7IH07XG59XG4vKipcbiAqIEludmVyc2UgZnVuY3Rpb24gb2YgYHR1cGxlZGBcbiAqXG4gKiBAc2luY2UgMi40LjBcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHVudHVwbGVkKGYpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgYSA9IFtdO1xuICAgICAgICBmb3IgKHZhciBfaSA9IDA7IF9pIDwgYXJndW1lbnRzLmxlbmd0aDsgX2krKykge1xuICAgICAgICAgICAgYVtfaV0gPSBhcmd1bWVudHNbX2ldO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBmKGEpO1xuICAgIH07XG59XG5leHBvcnQgZnVuY3Rpb24gcGlwZShhLCBhYiwgYmMsIGNkLCBkZSwgZWYsIGZnLCBnaCwgaGkpIHtcbiAgICBzd2l0Y2ggKGFyZ3VtZW50cy5sZW5ndGgpIHtcbiAgICAgICAgY2FzZSAxOlxuICAgICAgICAgICAgcmV0dXJuIGE7XG4gICAgICAgIGNhc2UgMjpcbiAgICAgICAgICAgIHJldHVybiBhYihhKTtcbiAgICAgICAgY2FzZSAzOlxuICAgICAgICAgICAgcmV0dXJuIGJjKGFiKGEpKTtcbiAgICAgICAgY2FzZSA0OlxuICAgICAgICAgICAgcmV0dXJuIGNkKGJjKGFiKGEpKSk7XG4gICAgICAgIGNhc2UgNTpcbiAgICAgICAgICAgIHJldHVybiBkZShjZChiYyhhYihhKSkpKTtcbiAgICAgICAgY2FzZSA2OlxuICAgICAgICAgICAgcmV0dXJuIGVmKGRlKGNkKGJjKGFiKGEpKSkpKTtcbiAgICAgICAgY2FzZSA3OlxuICAgICAgICAgICAgcmV0dXJuIGZnKGVmKGRlKGNkKGJjKGFiKGEpKSkpKSk7XG4gICAgICAgIGNhc2UgODpcbiAgICAgICAgICAgIHJldHVybiBnaChmZyhlZihkZShjZChiYyhhYihhKSkpKSkpKTtcbiAgICAgICAgY2FzZSA5OlxuICAgICAgICAgICAgcmV0dXJuIGhpKGdoKGZnKGVmKGRlKGNkKGJjKGFiKGEpKSkpKSkpKTtcbiAgICAgICAgZGVmYXVsdDoge1xuICAgICAgICAgICAgdmFyIHJldCA9IGFyZ3VtZW50c1swXTtcbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAxOyBpIDwgYXJndW1lbnRzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgcmV0ID0gYXJndW1lbnRzW2ldKHJldCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gcmV0O1xuICAgICAgICB9XG4gICAgfVxufVxuLyoqXG4gKiBUeXBlIGhvbGUgc2ltdWxhdGlvblxuICpcbiAqIEBzaW5jZSAyLjcuMFxuICovXG5leHBvcnQgdmFyIGhvbGUgPSBhYnN1cmQ7XG4vKipcbiAqIEBzaW5jZSAyLjExLjBcbiAqL1xuZXhwb3J0IHZhciBTSyA9IGZ1bmN0aW9uIChfLCBiKSB7IHJldHVybiBiOyB9O1xuLyoqXG4gKiBVc2UgYFByZWRpY2F0ZWAgbW9kdWxlIGluc3RlYWQuXG4gKlxuICogQGNhdGVnb3J5IHpvbmUgb2YgZGVhdGhcbiAqIEBzaW5jZSAyLjAuMFxuICogQGRlcHJlY2F0ZWRcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIG5vdChwcmVkaWNhdGUpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGEpIHsgcmV0dXJuICFwcmVkaWNhdGUoYSk7IH07XG59XG4vKipcbiAqIFVzZSBgRW5kb21vcnBoaXNtYCBtb2R1bGUgaW5zdGVhZC5cbiAqXG4gKiBAY2F0ZWdvcnkgem9uZSBvZiBkZWF0aFxuICogQHNpbmNlIDIuMTAuMFxuICogQGRlcHJlY2F0ZWRcbiAqL1xuZXhwb3J0IHZhciBnZXRFbmRvbW9ycGhpc21Nb25vaWQgPSBmdW5jdGlvbiAoKSB7IHJldHVybiAoe1xuICAgIGNvbmNhdDogZnVuY3Rpb24gKGZpcnN0LCBzZWNvbmQpIHsgcmV0dXJuIGZsb3coZmlyc3QsIHNlY29uZCk7IH0sXG4gICAgZW1wdHk6IGlkZW50aXR5XG59KTsgfTtcbi8qKiBAaW50ZXJuYWwgKi9cbmV4cG9ydCB2YXIgZHVhbCA9IGZ1bmN0aW9uIChhcml0eSwgYm9keSkge1xuICAgIHZhciBpc0RhdGFGaXJzdCA9IHR5cGVvZiBhcml0eSA9PT0gJ251bWJlcicgPyBmdW5jdGlvbiAoYXJncykgeyByZXR1cm4gYXJncy5sZW5ndGggPj0gYXJpdHk7IH0gOiBhcml0eTtcbiAgICByZXR1cm4gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgYXJncyA9IEFycmF5LmZyb20oYXJndW1lbnRzKTtcbiAgICAgICAgaWYgKGlzRGF0YUZpcnN0KGFyZ3VtZW50cykpIHtcbiAgICAgICAgICAgIHJldHVybiBib2R5LmFwcGx5KHRoaXMsIGFyZ3MpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBmdW5jdGlvbiAoc2VsZikgeyByZXR1cm4gYm9keS5hcHBseSh2b2lkIDAsIF9fc3ByZWFkQXJyYXkoW3NlbGZdLCBhcmdzLCBmYWxzZSkpOyB9O1xuICAgIH07XG59O1xuIiwKICAidmFyIF9fc3ByZWFkQXJyYXkgPSAodGhpcyAmJiB0aGlzLl9fc3ByZWFkQXJyYXkpIHx8IGZ1bmN0aW9uICh0bywgZnJvbSwgcGFjaykge1xuICAgIGlmIChwYWNrIHx8IGFyZ3VtZW50cy5sZW5ndGggPT09IDIpIGZvciAodmFyIGkgPSAwLCBsID0gZnJvbS5sZW5ndGgsIGFyOyBpIDwgbDsgaSsrKSB7XG4gICAgICAgIGlmIChhciB8fCAhKGkgaW4gZnJvbSkpIHtcbiAgICAgICAgICAgIGlmICghYXIpIGFyID0gQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoZnJvbSwgMCwgaSk7XG4gICAgICAgICAgICBhcltpXSA9IGZyb21baV07XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHRvLmNvbmNhdChhciB8fCBBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChmcm9tKSk7XG59O1xuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLy8gaW5zdGFuY2VzXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjEwLjBcbiAqL1xuZXhwb3J0IHZhciBnZXRCb29sZWFuQWxnZWJyYSA9IGZ1bmN0aW9uIChCKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uICgpIHsgcmV0dXJuICh7XG4gICAgICAgIG1lZXQ6IGZ1bmN0aW9uICh4LCB5KSB7IHJldHVybiBmdW5jdGlvbiAoYSkgeyByZXR1cm4gQi5tZWV0KHgoYSksIHkoYSkpOyB9OyB9LFxuICAgICAgICBqb2luOiBmdW5jdGlvbiAoeCwgeSkgeyByZXR1cm4gZnVuY3Rpb24gKGEpIHsgcmV0dXJuIEIuam9pbih4KGEpLCB5KGEpKTsgfTsgfSxcbiAgICAgICAgemVybzogZnVuY3Rpb24gKCkgeyByZXR1cm4gQi56ZXJvOyB9LFxuICAgICAgICBvbmU6IGZ1bmN0aW9uICgpIHsgcmV0dXJuIEIub25lOyB9LFxuICAgICAgICBpbXBsaWVzOiBmdW5jdGlvbiAoeCwgeSkgeyByZXR1cm4gZnVuY3Rpb24gKGEpIHsgcmV0dXJuIEIuaW1wbGllcyh4KGEpLCB5KGEpKTsgfTsgfSxcbiAgICAgICAgbm90OiBmdW5jdGlvbiAoeCkgeyByZXR1cm4gZnVuY3Rpb24gKGEpIHsgcmV0dXJuIEIubm90KHgoYSkpOyB9OyB9XG4gICAgfSk7IH07XG59O1xuLyoqXG4gKiBVbmFyeSBmdW5jdGlvbnMgZm9ybSBhIHNlbWlncm91cCBhcyBsb25nIGFzIHlvdSBjYW4gcHJvdmlkZSBhIHNlbWlncm91cCBmb3IgdGhlIGNvZG9tYWluLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBQcmVkaWNhdGUsIGdldFNlbWlncm91cCB9IGZyb20gJ2ZwLXRzL2Z1bmN0aW9uJ1xuICogaW1wb3J0ICogYXMgQiBmcm9tICdmcC10cy9ib29sZWFuJ1xuICpcbiAqIGNvbnN0IGY6IFByZWRpY2F0ZTxudW1iZXI+ID0gKG4pID0+IG4gPD0gMlxuICogY29uc3QgZzogUHJlZGljYXRlPG51bWJlcj4gPSAobikgPT4gbiA+PSAwXG4gKlxuICogY29uc3QgUzEgPSBnZXRTZW1pZ3JvdXAoQi5TZW1pZ3JvdXBBbGwpPG51bWJlcj4oKVxuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoUzEuY29uY2F0KGYsIGcpKDEpLCB0cnVlKVxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChTMS5jb25jYXQoZiwgZykoMyksIGZhbHNlKVxuICpcbiAqIGNvbnN0IFMyID0gZ2V0U2VtaWdyb3VwKEIuU2VtaWdyb3VwQW55KTxudW1iZXI+KClcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKFMyLmNvbmNhdChmLCBnKSgxKSwgdHJ1ZSlcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoUzIuY29uY2F0KGYsIGcpKDMpLCB0cnVlKVxuICpcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjEwLjBcbiAqL1xuZXhwb3J0IHZhciBnZXRTZW1pZ3JvdXAgPSBmdW5jdGlvbiAoUykge1xuICAgIHJldHVybiBmdW5jdGlvbiAoKSB7IHJldHVybiAoe1xuICAgICAgICBjb25jYXQ6IGZ1bmN0aW9uIChmLCBnKSB7IHJldHVybiBmdW5jdGlvbiAoYSkgeyByZXR1cm4gUy5jb25jYXQoZihhKSwgZyhhKSk7IH07IH1cbiAgICB9KTsgfTtcbn07XG4vKipcbiAqIFVuYXJ5IGZ1bmN0aW9ucyBmb3JtIGEgbW9ub2lkIGFzIGxvbmcgYXMgeW91IGNhbiBwcm92aWRlIGEgbW9ub2lkIGZvciB0aGUgY29kb21haW4uXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IFByZWRpY2F0ZSB9IGZyb20gJ2ZwLXRzL1ByZWRpY2F0ZSdcbiAqIGltcG9ydCB7IGdldE1vbm9pZCB9IGZyb20gJ2ZwLXRzL2Z1bmN0aW9uJ1xuICogaW1wb3J0ICogYXMgQiBmcm9tICdmcC10cy9ib29sZWFuJ1xuICpcbiAqIGNvbnN0IGY6IFByZWRpY2F0ZTxudW1iZXI+ID0gKG4pID0+IG4gPD0gMlxuICogY29uc3QgZzogUHJlZGljYXRlPG51bWJlcj4gPSAobikgPT4gbiA+PSAwXG4gKlxuICogY29uc3QgTTEgPSBnZXRNb25vaWQoQi5Nb25vaWRBbGwpPG51bWJlcj4oKVxuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoTTEuY29uY2F0KGYsIGcpKDEpLCB0cnVlKVxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChNMS5jb25jYXQoZiwgZykoMyksIGZhbHNlKVxuICpcbiAqIGNvbnN0IE0yID0gZ2V0TW9ub2lkKEIuTW9ub2lkQW55KTxudW1iZXI+KClcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKE0yLmNvbmNhdChmLCBnKSgxKSwgdHJ1ZSlcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoTTIuY29uY2F0KGYsIGcpKDMpLCB0cnVlKVxuICpcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjEwLjBcbiAqL1xuZXhwb3J0IHZhciBnZXRNb25vaWQgPSBmdW5jdGlvbiAoTSkge1xuICAgIHZhciBnZXRTZW1pZ3JvdXBNID0gZ2V0U2VtaWdyb3VwKE0pO1xuICAgIHJldHVybiBmdW5jdGlvbiAoKSB7IHJldHVybiAoe1xuICAgICAgICBjb25jYXQ6IGdldFNlbWlncm91cE0oKS5jb25jYXQsXG4gICAgICAgIGVtcHR5OiBmdW5jdGlvbiAoKSB7IHJldHVybiBNLmVtcHR5OyB9XG4gICAgfSk7IH07XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi4xMC4wXG4gKi9cbmV4cG9ydCB2YXIgZ2V0U2VtaXJpbmcgPSBmdW5jdGlvbiAoUykgeyByZXR1cm4gKHtcbiAgICBhZGQ6IGZ1bmN0aW9uIChmLCBnKSB7IHJldHVybiBmdW5jdGlvbiAoeCkgeyByZXR1cm4gUy5hZGQoZih4KSwgZyh4KSk7IH07IH0sXG4gICAgemVybzogZnVuY3Rpb24gKCkgeyByZXR1cm4gUy56ZXJvOyB9LFxuICAgIG11bDogZnVuY3Rpb24gKGYsIGcpIHsgcmV0dXJuIGZ1bmN0aW9uICh4KSB7IHJldHVybiBTLm11bChmKHgpLCBnKHgpKTsgfTsgfSxcbiAgICBvbmU6IGZ1bmN0aW9uICgpIHsgcmV0dXJuIFMub25lOyB9XG59KTsgfTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuMTAuMFxuICovXG5leHBvcnQgdmFyIGdldFJpbmcgPSBmdW5jdGlvbiAoUikge1xuICAgIHZhciBTID0gZ2V0U2VtaXJpbmcoUik7XG4gICAgcmV0dXJuIHtcbiAgICAgICAgYWRkOiBTLmFkZCxcbiAgICAgICAgbXVsOiBTLm11bCxcbiAgICAgICAgb25lOiBTLm9uZSxcbiAgICAgICAgemVybzogUy56ZXJvLFxuICAgICAgICBzdWI6IGZ1bmN0aW9uIChmLCBnKSB7IHJldHVybiBmdW5jdGlvbiAoeCkgeyByZXR1cm4gUi5zdWIoZih4KSwgZyh4KSk7IH07IH1cbiAgICB9O1xufTtcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8vIHV0aWxzXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vKipcbiAqIEBzaW5jZSAyLjExLjBcbiAqL1xuZXhwb3J0IHZhciBhcHBseSA9IGZ1bmN0aW9uIChhKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChmKSB7XG4gICAgICAgIHJldHVybiBmKGEpO1xuICAgIH07XG59O1xuLyoqXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGlkZW50aXR5KGEpIHtcbiAgICByZXR1cm4gYTtcbn1cbi8qKlxuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgdW5zYWZlQ29lcmNlID0gaWRlbnRpdHk7XG4vKipcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgZnVuY3Rpb24gY29uc3RhbnQoYSkge1xuICAgIHJldHVybiBmdW5jdGlvbiAoKSB7IHJldHVybiBhOyB9O1xufVxuLyoqXG4gKiBBIHRodW5rIHRoYXQgcmV0dXJucyBhbHdheXMgYHRydWVgLlxuICpcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIGNvbnN0VHJ1ZSA9IC8qI19fUFVSRV9fKi8gY29uc3RhbnQodHJ1ZSk7XG4vKipcbiAqIEEgdGh1bmsgdGhhdCByZXR1cm5zIGFsd2F5cyBgZmFsc2VgLlxuICpcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIGNvbnN0RmFsc2UgPSAvKiNfX1BVUkVfXyovIGNvbnN0YW50KGZhbHNlKTtcbi8qKlxuICogQSB0aHVuayB0aGF0IHJldHVybnMgYWx3YXlzIGBudWxsYC5cbiAqXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciBjb25zdE51bGwgPSAvKiNfX1BVUkVfXyovIGNvbnN0YW50KG51bGwpO1xuLyoqXG4gKiBBIHRodW5rIHRoYXQgcmV0dXJucyBhbHdheXMgYHVuZGVmaW5lZGAuXG4gKlxuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgY29uc3RVbmRlZmluZWQgPSAvKiNfX1BVUkVfXyovIGNvbnN0YW50KHVuZGVmaW5lZCk7XG4vKipcbiAqIEEgdGh1bmsgdGhhdCByZXR1cm5zIGFsd2F5cyBgdm9pZGAuXG4gKlxuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgY29uc3RWb2lkID0gY29uc3RVbmRlZmluZWQ7XG5leHBvcnQgZnVuY3Rpb24gZmxpcChmKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIGFyZ3MgPSBbXTtcbiAgICAgICAgZm9yICh2YXIgX2kgPSAwOyBfaSA8IGFyZ3VtZW50cy5sZW5ndGg7IF9pKyspIHtcbiAgICAgICAgICAgIGFyZ3NbX2ldID0gYXJndW1lbnRzW19pXTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoYXJncy5sZW5ndGggPiAxKSB7XG4gICAgICAgICAgICByZXR1cm4gZihhcmdzWzFdLCBhcmdzWzBdKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gZnVuY3Rpb24gKGEpIHsgcmV0dXJuIGYoYSkoYXJnc1swXSk7IH07XG4gICAgfTtcbn1cbmV4cG9ydCBmdW5jdGlvbiBmbG93KGFiLCBiYywgY2QsIGRlLCBlZiwgZmcsIGdoLCBoaSwgaWopIHtcbiAgICBzd2l0Y2ggKGFyZ3VtZW50cy5sZW5ndGgpIHtcbiAgICAgICAgY2FzZSAxOlxuICAgICAgICAgICAgcmV0dXJuIGFiO1xuICAgICAgICBjYXNlIDI6XG4gICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBiYyhhYi5hcHBseSh0aGlzLCBhcmd1bWVudHMpKTtcbiAgICAgICAgICAgIH07XG4gICAgICAgIGNhc2UgMzpcbiAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGNkKGJjKGFiLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykpKTtcbiAgICAgICAgICAgIH07XG4gICAgICAgIGNhc2UgNDpcbiAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGRlKGNkKGJjKGFiLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykpKSk7XG4gICAgICAgICAgICB9O1xuICAgICAgICBjYXNlIDU6XG4gICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBlZihkZShjZChiYyhhYi5hcHBseSh0aGlzLCBhcmd1bWVudHMpKSkpKTtcbiAgICAgICAgICAgIH07XG4gICAgICAgIGNhc2UgNjpcbiAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZnKGVmKGRlKGNkKGJjKGFiLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykpKSkpKTtcbiAgICAgICAgICAgIH07XG4gICAgICAgIGNhc2UgNzpcbiAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGdoKGZnKGVmKGRlKGNkKGJjKGFiLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykpKSkpKSk7XG4gICAgICAgICAgICB9O1xuICAgICAgICBjYXNlIDg6XG4gICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBoaShnaChmZyhlZihkZShjZChiYyhhYi5hcHBseSh0aGlzLCBhcmd1bWVudHMpKSkpKSkpKTtcbiAgICAgICAgICAgIH07XG4gICAgICAgIGNhc2UgOTpcbiAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGlqKGhpKGdoKGZnKGVmKGRlKGNkKGJjKGFiLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykpKSkpKSkpKTtcbiAgICAgICAgICAgIH07XG4gICAgfVxuICAgIHJldHVybjtcbn1cbi8qKlxuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiB0dXBsZSgpIHtcbiAgICB2YXIgdCA9IFtdO1xuICAgIGZvciAodmFyIF9pID0gMDsgX2kgPCBhcmd1bWVudHMubGVuZ3RoOyBfaSsrKSB7XG4gICAgICAgIHRbX2ldID0gYXJndW1lbnRzW19pXTtcbiAgICB9XG4gICAgcmV0dXJuIHQ7XG59XG4vKipcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgZnVuY3Rpb24gaW5jcmVtZW50KG4pIHtcbiAgICByZXR1cm4gbiArIDE7XG59XG4vKipcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgZnVuY3Rpb24gZGVjcmVtZW50KG4pIHtcbiAgICByZXR1cm4gbiAtIDE7XG59XG4vKipcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgZnVuY3Rpb24gYWJzdXJkKF8pIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ0NhbGxlZCBgYWJzdXJkYCBmdW5jdGlvbiB3aGljaCBzaG91bGQgYmUgdW5jYWxsYWJsZScpO1xufVxuLyoqXG4gKiBDcmVhdGVzIGEgdHVwbGVkIHZlcnNpb24gb2YgdGhpcyBmdW5jdGlvbjogaW5zdGVhZCBvZiBgbmAgYXJndW1lbnRzLCBpdCBhY2NlcHRzIGEgc2luZ2xlIHR1cGxlIGFyZ3VtZW50LlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyB0dXBsZWQgfSBmcm9tICdmcC10cy9mdW5jdGlvbidcbiAqXG4gKiBjb25zdCBhZGQgPSB0dXBsZWQoKHg6IG51bWJlciwgeTogbnVtYmVyKTogbnVtYmVyID0+IHggKyB5KVxuICpcbiAqIGFzc2VydC5zdHJpY3RFcXVhbChhZGQoWzEsIDJdKSwgMylcbiAqXG4gKiBAc2luY2UgMi40LjBcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHR1cGxlZChmKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhKSB7IHJldHVybiBmLmFwcGx5KHZvaWQgMCwgYSk7IH07XG59XG4vKipcbiAqIEludmVyc2UgZnVuY3Rpb24gb2YgYHR1cGxlZGBcbiAqXG4gKiBAc2luY2UgMi40LjBcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHVudHVwbGVkKGYpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgYSA9IFtdO1xuICAgICAgICBmb3IgKHZhciBfaSA9IDA7IF9pIDwgYXJndW1lbnRzLmxlbmd0aDsgX2krKykge1xuICAgICAgICAgICAgYVtfaV0gPSBhcmd1bWVudHNbX2ldO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBmKGEpO1xuICAgIH07XG59XG5leHBvcnQgZnVuY3Rpb24gcGlwZShhLCBhYiwgYmMsIGNkLCBkZSwgZWYsIGZnLCBnaCwgaGkpIHtcbiAgICBzd2l0Y2ggKGFyZ3VtZW50cy5sZW5ndGgpIHtcbiAgICAgICAgY2FzZSAxOlxuICAgICAgICAgICAgcmV0dXJuIGE7XG4gICAgICAgIGNhc2UgMjpcbiAgICAgICAgICAgIHJldHVybiBhYihhKTtcbiAgICAgICAgY2FzZSAzOlxuICAgICAgICAgICAgcmV0dXJuIGJjKGFiKGEpKTtcbiAgICAgICAgY2FzZSA0OlxuICAgICAgICAgICAgcmV0dXJuIGNkKGJjKGFiKGEpKSk7XG4gICAgICAgIGNhc2UgNTpcbiAgICAgICAgICAgIHJldHVybiBkZShjZChiYyhhYihhKSkpKTtcbiAgICAgICAgY2FzZSA2OlxuICAgICAgICAgICAgcmV0dXJuIGVmKGRlKGNkKGJjKGFiKGEpKSkpKTtcbiAgICAgICAgY2FzZSA3OlxuICAgICAgICAgICAgcmV0dXJuIGZnKGVmKGRlKGNkKGJjKGFiKGEpKSkpKSk7XG4gICAgICAgIGNhc2UgODpcbiAgICAgICAgICAgIHJldHVybiBnaChmZyhlZihkZShjZChiYyhhYihhKSkpKSkpKTtcbiAgICAgICAgY2FzZSA5OlxuICAgICAgICAgICAgcmV0dXJuIGhpKGdoKGZnKGVmKGRlKGNkKGJjKGFiKGEpKSkpKSkpKTtcbiAgICAgICAgZGVmYXVsdDoge1xuICAgICAgICAgICAgdmFyIHJldCA9IGFyZ3VtZW50c1swXTtcbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAxOyBpIDwgYXJndW1lbnRzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgcmV0ID0gYXJndW1lbnRzW2ldKHJldCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gcmV0O1xuICAgICAgICB9XG4gICAgfVxufVxuLyoqXG4gKiBUeXBlIGhvbGUgc2ltdWxhdGlvblxuICpcbiAqIEBzaW5jZSAyLjcuMFxuICovXG5leHBvcnQgdmFyIGhvbGUgPSBhYnN1cmQ7XG4vKipcbiAqIEBzaW5jZSAyLjExLjBcbiAqL1xuZXhwb3J0IHZhciBTSyA9IGZ1bmN0aW9uIChfLCBiKSB7IHJldHVybiBiOyB9O1xuLyoqXG4gKiBVc2UgYFByZWRpY2F0ZWAgbW9kdWxlIGluc3RlYWQuXG4gKlxuICogQGNhdGVnb3J5IHpvbmUgb2YgZGVhdGhcbiAqIEBzaW5jZSAyLjAuMFxuICogQGRlcHJlY2F0ZWRcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIG5vdChwcmVkaWNhdGUpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGEpIHsgcmV0dXJuICFwcmVkaWNhdGUoYSk7IH07XG59XG4vKipcbiAqIFVzZSBgRW5kb21vcnBoaXNtYCBtb2R1bGUgaW5zdGVhZC5cbiAqXG4gKiBAY2F0ZWdvcnkgem9uZSBvZiBkZWF0aFxuICogQHNpbmNlIDIuMTAuMFxuICogQGRlcHJlY2F0ZWRcbiAqL1xuZXhwb3J0IHZhciBnZXRFbmRvbW9ycGhpc21Nb25vaWQgPSBmdW5jdGlvbiAoKSB7IHJldHVybiAoe1xuICAgIGNvbmNhdDogZnVuY3Rpb24gKGZpcnN0LCBzZWNvbmQpIHsgcmV0dXJuIGZsb3coZmlyc3QsIHNlY29uZCk7IH0sXG4gICAgZW1wdHk6IGlkZW50aXR5XG59KTsgfTtcbi8qKiBAaW50ZXJuYWwgKi9cbmV4cG9ydCB2YXIgZHVhbCA9IGZ1bmN0aW9uIChhcml0eSwgYm9keSkge1xuICAgIHZhciBpc0RhdGFGaXJzdCA9IHR5cGVvZiBhcml0eSA9PT0gJ251bWJlcicgPyBmdW5jdGlvbiAoYXJncykgeyByZXR1cm4gYXJncy5sZW5ndGggPj0gYXJpdHk7IH0gOiBhcml0eTtcbiAgICByZXR1cm4gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgYXJncyA9IEFycmF5LmZyb20oYXJndW1lbnRzKTtcbiAgICAgICAgaWYgKGlzRGF0YUZpcnN0KGFyZ3VtZW50cykpIHtcbiAgICAgICAgICAgIHJldHVybiBib2R5LmFwcGx5KHRoaXMsIGFyZ3MpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBmdW5jdGlvbiAoc2VsZikgeyByZXR1cm4gYm9keS5hcHBseSh2b2lkIDAsIF9fc3ByZWFkQXJyYXkoW3NlbGZdLCBhcmdzLCBmYWxzZSkpOyB9O1xuICAgIH07XG59O1xuIiwKICAidmFyIF9fc3ByZWFkQXJyYXkgPSAodGhpcyAmJiB0aGlzLl9fc3ByZWFkQXJyYXkpIHx8IGZ1bmN0aW9uICh0bywgZnJvbSwgcGFjaykge1xuICAgIGlmIChwYWNrIHx8IGFyZ3VtZW50cy5sZW5ndGggPT09IDIpIGZvciAodmFyIGkgPSAwLCBsID0gZnJvbS5sZW5ndGgsIGFyOyBpIDwgbDsgaSsrKSB7XG4gICAgICAgIGlmIChhciB8fCAhKGkgaW4gZnJvbSkpIHtcbiAgICAgICAgICAgIGlmICghYXIpIGFyID0gQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoZnJvbSwgMCwgaSk7XG4gICAgICAgICAgICBhcltpXSA9IGZyb21baV07XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHRvLmNvbmNhdChhciB8fCBBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChmcm9tKSk7XG59O1xuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLy8gaW5zdGFuY2VzXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjEwLjBcbiAqL1xuZXhwb3J0IHZhciBnZXRCb29sZWFuQWxnZWJyYSA9IGZ1bmN0aW9uIChCKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uICgpIHsgcmV0dXJuICh7XG4gICAgICAgIG1lZXQ6IGZ1bmN0aW9uICh4LCB5KSB7IHJldHVybiBmdW5jdGlvbiAoYSkgeyByZXR1cm4gQi5tZWV0KHgoYSksIHkoYSkpOyB9OyB9LFxuICAgICAgICBqb2luOiBmdW5jdGlvbiAoeCwgeSkgeyByZXR1cm4gZnVuY3Rpb24gKGEpIHsgcmV0dXJuIEIuam9pbih4KGEpLCB5KGEpKTsgfTsgfSxcbiAgICAgICAgemVybzogZnVuY3Rpb24gKCkgeyByZXR1cm4gQi56ZXJvOyB9LFxuICAgICAgICBvbmU6IGZ1bmN0aW9uICgpIHsgcmV0dXJuIEIub25lOyB9LFxuICAgICAgICBpbXBsaWVzOiBmdW5jdGlvbiAoeCwgeSkgeyByZXR1cm4gZnVuY3Rpb24gKGEpIHsgcmV0dXJuIEIuaW1wbGllcyh4KGEpLCB5KGEpKTsgfTsgfSxcbiAgICAgICAgbm90OiBmdW5jdGlvbiAoeCkgeyByZXR1cm4gZnVuY3Rpb24gKGEpIHsgcmV0dXJuIEIubm90KHgoYSkpOyB9OyB9XG4gICAgfSk7IH07XG59O1xuLyoqXG4gKiBVbmFyeSBmdW5jdGlvbnMgZm9ybSBhIHNlbWlncm91cCBhcyBsb25nIGFzIHlvdSBjYW4gcHJvdmlkZSBhIHNlbWlncm91cCBmb3IgdGhlIGNvZG9tYWluLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBQcmVkaWNhdGUsIGdldFNlbWlncm91cCB9IGZyb20gJ2ZwLXRzL2Z1bmN0aW9uJ1xuICogaW1wb3J0ICogYXMgQiBmcm9tICdmcC10cy9ib29sZWFuJ1xuICpcbiAqIGNvbnN0IGY6IFByZWRpY2F0ZTxudW1iZXI+ID0gKG4pID0+IG4gPD0gMlxuICogY29uc3QgZzogUHJlZGljYXRlPG51bWJlcj4gPSAobikgPT4gbiA+PSAwXG4gKlxuICogY29uc3QgUzEgPSBnZXRTZW1pZ3JvdXAoQi5TZW1pZ3JvdXBBbGwpPG51bWJlcj4oKVxuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoUzEuY29uY2F0KGYsIGcpKDEpLCB0cnVlKVxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChTMS5jb25jYXQoZiwgZykoMyksIGZhbHNlKVxuICpcbiAqIGNvbnN0IFMyID0gZ2V0U2VtaWdyb3VwKEIuU2VtaWdyb3VwQW55KTxudW1iZXI+KClcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKFMyLmNvbmNhdChmLCBnKSgxKSwgdHJ1ZSlcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoUzIuY29uY2F0KGYsIGcpKDMpLCB0cnVlKVxuICpcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjEwLjBcbiAqL1xuZXhwb3J0IHZhciBnZXRTZW1pZ3JvdXAgPSBmdW5jdGlvbiAoUykge1xuICAgIHJldHVybiBmdW5jdGlvbiAoKSB7IHJldHVybiAoe1xuICAgICAgICBjb25jYXQ6IGZ1bmN0aW9uIChmLCBnKSB7IHJldHVybiBmdW5jdGlvbiAoYSkgeyByZXR1cm4gUy5jb25jYXQoZihhKSwgZyhhKSk7IH07IH1cbiAgICB9KTsgfTtcbn07XG4vKipcbiAqIFVuYXJ5IGZ1bmN0aW9ucyBmb3JtIGEgbW9ub2lkIGFzIGxvbmcgYXMgeW91IGNhbiBwcm92aWRlIGEgbW9ub2lkIGZvciB0aGUgY29kb21haW4uXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IFByZWRpY2F0ZSB9IGZyb20gJ2ZwLXRzL1ByZWRpY2F0ZSdcbiAqIGltcG9ydCB7IGdldE1vbm9pZCB9IGZyb20gJ2ZwLXRzL2Z1bmN0aW9uJ1xuICogaW1wb3J0ICogYXMgQiBmcm9tICdmcC10cy9ib29sZWFuJ1xuICpcbiAqIGNvbnN0IGY6IFByZWRpY2F0ZTxudW1iZXI+ID0gKG4pID0+IG4gPD0gMlxuICogY29uc3QgZzogUHJlZGljYXRlPG51bWJlcj4gPSAobikgPT4gbiA+PSAwXG4gKlxuICogY29uc3QgTTEgPSBnZXRNb25vaWQoQi5Nb25vaWRBbGwpPG51bWJlcj4oKVxuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoTTEuY29uY2F0KGYsIGcpKDEpLCB0cnVlKVxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChNMS5jb25jYXQoZiwgZykoMyksIGZhbHNlKVxuICpcbiAqIGNvbnN0IE0yID0gZ2V0TW9ub2lkKEIuTW9ub2lkQW55KTxudW1iZXI+KClcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKE0yLmNvbmNhdChmLCBnKSgxKSwgdHJ1ZSlcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoTTIuY29uY2F0KGYsIGcpKDMpLCB0cnVlKVxuICpcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjEwLjBcbiAqL1xuZXhwb3J0IHZhciBnZXRNb25vaWQgPSBmdW5jdGlvbiAoTSkge1xuICAgIHZhciBnZXRTZW1pZ3JvdXBNID0gZ2V0U2VtaWdyb3VwKE0pO1xuICAgIHJldHVybiBmdW5jdGlvbiAoKSB7IHJldHVybiAoe1xuICAgICAgICBjb25jYXQ6IGdldFNlbWlncm91cE0oKS5jb25jYXQsXG4gICAgICAgIGVtcHR5OiBmdW5jdGlvbiAoKSB7IHJldHVybiBNLmVtcHR5OyB9XG4gICAgfSk7IH07XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi4xMC4wXG4gKi9cbmV4cG9ydCB2YXIgZ2V0U2VtaXJpbmcgPSBmdW5jdGlvbiAoUykgeyByZXR1cm4gKHtcbiAgICBhZGQ6IGZ1bmN0aW9uIChmLCBnKSB7IHJldHVybiBmdW5jdGlvbiAoeCkgeyByZXR1cm4gUy5hZGQoZih4KSwgZyh4KSk7IH07IH0sXG4gICAgemVybzogZnVuY3Rpb24gKCkgeyByZXR1cm4gUy56ZXJvOyB9LFxuICAgIG11bDogZnVuY3Rpb24gKGYsIGcpIHsgcmV0dXJuIGZ1bmN0aW9uICh4KSB7IHJldHVybiBTLm11bChmKHgpLCBnKHgpKTsgfTsgfSxcbiAgICBvbmU6IGZ1bmN0aW9uICgpIHsgcmV0dXJuIFMub25lOyB9XG59KTsgfTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuMTAuMFxuICovXG5leHBvcnQgdmFyIGdldFJpbmcgPSBmdW5jdGlvbiAoUikge1xuICAgIHZhciBTID0gZ2V0U2VtaXJpbmcoUik7XG4gICAgcmV0dXJuIHtcbiAgICAgICAgYWRkOiBTLmFkZCxcbiAgICAgICAgbXVsOiBTLm11bCxcbiAgICAgICAgb25lOiBTLm9uZSxcbiAgICAgICAgemVybzogUy56ZXJvLFxuICAgICAgICBzdWI6IGZ1bmN0aW9uIChmLCBnKSB7IHJldHVybiBmdW5jdGlvbiAoeCkgeyByZXR1cm4gUi5zdWIoZih4KSwgZyh4KSk7IH07IH1cbiAgICB9O1xufTtcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8vIHV0aWxzXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vKipcbiAqIEBzaW5jZSAyLjExLjBcbiAqL1xuZXhwb3J0IHZhciBhcHBseSA9IGZ1bmN0aW9uIChhKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChmKSB7XG4gICAgICAgIHJldHVybiBmKGEpO1xuICAgIH07XG59O1xuLyoqXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGlkZW50aXR5KGEpIHtcbiAgICByZXR1cm4gYTtcbn1cbi8qKlxuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgdW5zYWZlQ29lcmNlID0gaWRlbnRpdHk7XG4vKipcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgZnVuY3Rpb24gY29uc3RhbnQoYSkge1xuICAgIHJldHVybiBmdW5jdGlvbiAoKSB7IHJldHVybiBhOyB9O1xufVxuLyoqXG4gKiBBIHRodW5rIHRoYXQgcmV0dXJucyBhbHdheXMgYHRydWVgLlxuICpcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIGNvbnN0VHJ1ZSA9IC8qI19fUFVSRV9fKi8gY29uc3RhbnQodHJ1ZSk7XG4vKipcbiAqIEEgdGh1bmsgdGhhdCByZXR1cm5zIGFsd2F5cyBgZmFsc2VgLlxuICpcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIGNvbnN0RmFsc2UgPSAvKiNfX1BVUkVfXyovIGNvbnN0YW50KGZhbHNlKTtcbi8qKlxuICogQSB0aHVuayB0aGF0IHJldHVybnMgYWx3YXlzIGBudWxsYC5cbiAqXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciBjb25zdE51bGwgPSAvKiNfX1BVUkVfXyovIGNvbnN0YW50KG51bGwpO1xuLyoqXG4gKiBBIHRodW5rIHRoYXQgcmV0dXJucyBhbHdheXMgYHVuZGVmaW5lZGAuXG4gKlxuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgY29uc3RVbmRlZmluZWQgPSAvKiNfX1BVUkVfXyovIGNvbnN0YW50KHVuZGVmaW5lZCk7XG4vKipcbiAqIEEgdGh1bmsgdGhhdCByZXR1cm5zIGFsd2F5cyBgdm9pZGAuXG4gKlxuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgY29uc3RWb2lkID0gY29uc3RVbmRlZmluZWQ7XG5leHBvcnQgZnVuY3Rpb24gZmxpcChmKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIGFyZ3MgPSBbXTtcbiAgICAgICAgZm9yICh2YXIgX2kgPSAwOyBfaSA8IGFyZ3VtZW50cy5sZW5ndGg7IF9pKyspIHtcbiAgICAgICAgICAgIGFyZ3NbX2ldID0gYXJndW1lbnRzW19pXTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoYXJncy5sZW5ndGggPiAxKSB7XG4gICAgICAgICAgICByZXR1cm4gZihhcmdzWzFdLCBhcmdzWzBdKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gZnVuY3Rpb24gKGEpIHsgcmV0dXJuIGYoYSkoYXJnc1swXSk7IH07XG4gICAgfTtcbn1cbmV4cG9ydCBmdW5jdGlvbiBmbG93KGFiLCBiYywgY2QsIGRlLCBlZiwgZmcsIGdoLCBoaSwgaWopIHtcbiAgICBzd2l0Y2ggKGFyZ3VtZW50cy5sZW5ndGgpIHtcbiAgICAgICAgY2FzZSAxOlxuICAgICAgICAgICAgcmV0dXJuIGFiO1xuICAgICAgICBjYXNlIDI6XG4gICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBiYyhhYi5hcHBseSh0aGlzLCBhcmd1bWVudHMpKTtcbiAgICAgICAgICAgIH07XG4gICAgICAgIGNhc2UgMzpcbiAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGNkKGJjKGFiLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykpKTtcbiAgICAgICAgICAgIH07XG4gICAgICAgIGNhc2UgNDpcbiAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGRlKGNkKGJjKGFiLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykpKSk7XG4gICAgICAgICAgICB9O1xuICAgICAgICBjYXNlIDU6XG4gICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBlZihkZShjZChiYyhhYi5hcHBseSh0aGlzLCBhcmd1bWVudHMpKSkpKTtcbiAgICAgICAgICAgIH07XG4gICAgICAgIGNhc2UgNjpcbiAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZnKGVmKGRlKGNkKGJjKGFiLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykpKSkpKTtcbiAgICAgICAgICAgIH07XG4gICAgICAgIGNhc2UgNzpcbiAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGdoKGZnKGVmKGRlKGNkKGJjKGFiLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykpKSkpKSk7XG4gICAgICAgICAgICB9O1xuICAgICAgICBjYXNlIDg6XG4gICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBoaShnaChmZyhlZihkZShjZChiYyhhYi5hcHBseSh0aGlzLCBhcmd1bWVudHMpKSkpKSkpKTtcbiAgICAgICAgICAgIH07XG4gICAgICAgIGNhc2UgOTpcbiAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGlqKGhpKGdoKGZnKGVmKGRlKGNkKGJjKGFiLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykpKSkpKSkpKTtcbiAgICAgICAgICAgIH07XG4gICAgfVxuICAgIHJldHVybjtcbn1cbi8qKlxuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiB0dXBsZSgpIHtcbiAgICB2YXIgdCA9IFtdO1xuICAgIGZvciAodmFyIF9pID0gMDsgX2kgPCBhcmd1bWVudHMubGVuZ3RoOyBfaSsrKSB7XG4gICAgICAgIHRbX2ldID0gYXJndW1lbnRzW19pXTtcbiAgICB9XG4gICAgcmV0dXJuIHQ7XG59XG4vKipcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgZnVuY3Rpb24gaW5jcmVtZW50KG4pIHtcbiAgICByZXR1cm4gbiArIDE7XG59XG4vKipcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgZnVuY3Rpb24gZGVjcmVtZW50KG4pIHtcbiAgICByZXR1cm4gbiAtIDE7XG59XG4vKipcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgZnVuY3Rpb24gYWJzdXJkKF8pIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ0NhbGxlZCBgYWJzdXJkYCBmdW5jdGlvbiB3aGljaCBzaG91bGQgYmUgdW5jYWxsYWJsZScpO1xufVxuLyoqXG4gKiBDcmVhdGVzIGEgdHVwbGVkIHZlcnNpb24gb2YgdGhpcyBmdW5jdGlvbjogaW5zdGVhZCBvZiBgbmAgYXJndW1lbnRzLCBpdCBhY2NlcHRzIGEgc2luZ2xlIHR1cGxlIGFyZ3VtZW50LlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyB0dXBsZWQgfSBmcm9tICdmcC10cy9mdW5jdGlvbidcbiAqXG4gKiBjb25zdCBhZGQgPSB0dXBsZWQoKHg6IG51bWJlciwgeTogbnVtYmVyKTogbnVtYmVyID0+IHggKyB5KVxuICpcbiAqIGFzc2VydC5zdHJpY3RFcXVhbChhZGQoWzEsIDJdKSwgMylcbiAqXG4gKiBAc2luY2UgMi40LjBcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHR1cGxlZChmKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhKSB7IHJldHVybiBmLmFwcGx5KHZvaWQgMCwgYSk7IH07XG59XG4vKipcbiAqIEludmVyc2UgZnVuY3Rpb24gb2YgYHR1cGxlZGBcbiAqXG4gKiBAc2luY2UgMi40LjBcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHVudHVwbGVkKGYpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgYSA9IFtdO1xuICAgICAgICBmb3IgKHZhciBfaSA9IDA7IF9pIDwgYXJndW1lbnRzLmxlbmd0aDsgX2krKykge1xuICAgICAgICAgICAgYVtfaV0gPSBhcmd1bWVudHNbX2ldO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBmKGEpO1xuICAgIH07XG59XG5leHBvcnQgZnVuY3Rpb24gcGlwZShhLCBhYiwgYmMsIGNkLCBkZSwgZWYsIGZnLCBnaCwgaGkpIHtcbiAgICBzd2l0Y2ggKGFyZ3VtZW50cy5sZW5ndGgpIHtcbiAgICAgICAgY2FzZSAxOlxuICAgICAgICAgICAgcmV0dXJuIGE7XG4gICAgICAgIGNhc2UgMjpcbiAgICAgICAgICAgIHJldHVybiBhYihhKTtcbiAgICAgICAgY2FzZSAzOlxuICAgICAgICAgICAgcmV0dXJuIGJjKGFiKGEpKTtcbiAgICAgICAgY2FzZSA0OlxuICAgICAgICAgICAgcmV0dXJuIGNkKGJjKGFiKGEpKSk7XG4gICAgICAgIGNhc2UgNTpcbiAgICAgICAgICAgIHJldHVybiBkZShjZChiYyhhYihhKSkpKTtcbiAgICAgICAgY2FzZSA2OlxuICAgICAgICAgICAgcmV0dXJuIGVmKGRlKGNkKGJjKGFiKGEpKSkpKTtcbiAgICAgICAgY2FzZSA3OlxuICAgICAgICAgICAgcmV0dXJuIGZnKGVmKGRlKGNkKGJjKGFiKGEpKSkpKSk7XG4gICAgICAgIGNhc2UgODpcbiAgICAgICAgICAgIHJldHVybiBnaChmZyhlZihkZShjZChiYyhhYihhKSkpKSkpKTtcbiAgICAgICAgY2FzZSA5OlxuICAgICAgICAgICAgcmV0dXJuIGhpKGdoKGZnKGVmKGRlKGNkKGJjKGFiKGEpKSkpKSkpKTtcbiAgICAgICAgZGVmYXVsdDoge1xuICAgICAgICAgICAgdmFyIHJldCA9IGFyZ3VtZW50c1swXTtcbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAxOyBpIDwgYXJndW1lbnRzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgcmV0ID0gYXJndW1lbnRzW2ldKHJldCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gcmV0O1xuICAgICAgICB9XG4gICAgfVxufVxuLyoqXG4gKiBUeXBlIGhvbGUgc2ltdWxhdGlvblxuICpcbiAqIEBzaW5jZSAyLjcuMFxuICovXG5leHBvcnQgdmFyIGhvbGUgPSBhYnN1cmQ7XG4vKipcbiAqIEBzaW5jZSAyLjExLjBcbiAqL1xuZXhwb3J0IHZhciBTSyA9IGZ1bmN0aW9uIChfLCBiKSB7IHJldHVybiBiOyB9O1xuLyoqXG4gKiBVc2UgYFByZWRpY2F0ZWAgbW9kdWxlIGluc3RlYWQuXG4gKlxuICogQGNhdGVnb3J5IHpvbmUgb2YgZGVhdGhcbiAqIEBzaW5jZSAyLjAuMFxuICogQGRlcHJlY2F0ZWRcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIG5vdChwcmVkaWNhdGUpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGEpIHsgcmV0dXJuICFwcmVkaWNhdGUoYSk7IH07XG59XG4vKipcbiAqIFVzZSBgRW5kb21vcnBoaXNtYCBtb2R1bGUgaW5zdGVhZC5cbiAqXG4gKiBAY2F0ZWdvcnkgem9uZSBvZiBkZWF0aFxuICogQHNpbmNlIDIuMTAuMFxuICogQGRlcHJlY2F0ZWRcbiAqL1xuZXhwb3J0IHZhciBnZXRFbmRvbW9ycGhpc21Nb25vaWQgPSBmdW5jdGlvbiAoKSB7IHJldHVybiAoe1xuICAgIGNvbmNhdDogZnVuY3Rpb24gKGZpcnN0LCBzZWNvbmQpIHsgcmV0dXJuIGZsb3coZmlyc3QsIHNlY29uZCk7IH0sXG4gICAgZW1wdHk6IGlkZW50aXR5XG59KTsgfTtcbi8qKiBAaW50ZXJuYWwgKi9cbmV4cG9ydCB2YXIgZHVhbCA9IGZ1bmN0aW9uIChhcml0eSwgYm9keSkge1xuICAgIHZhciBpc0RhdGFGaXJzdCA9IHR5cGVvZiBhcml0eSA9PT0gJ251bWJlcicgPyBmdW5jdGlvbiAoYXJncykgeyByZXR1cm4gYXJncy5sZW5ndGggPj0gYXJpdHk7IH0gOiBhcml0eTtcbiAgICByZXR1cm4gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgYXJncyA9IEFycmF5LmZyb20oYXJndW1lbnRzKTtcbiAgICAgICAgaWYgKGlzRGF0YUZpcnN0KGFyZ3VtZW50cykpIHtcbiAgICAgICAgICAgIHJldHVybiBib2R5LmFwcGx5KHRoaXMsIGFyZ3MpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBmdW5jdGlvbiAoc2VsZikgeyByZXR1cm4gYm9keS5hcHBseSh2b2lkIDAsIF9fc3ByZWFkQXJyYXkoW3NlbGZdLCBhcmdzLCBmYWxzZSkpOyB9O1xuICAgIH07XG59O1xuIiwKICAidmFyIF9fc3ByZWFkQXJyYXkgPSAodGhpcyAmJiB0aGlzLl9fc3ByZWFkQXJyYXkpIHx8IGZ1bmN0aW9uICh0bywgZnJvbSwgcGFjaykge1xuICAgIGlmIChwYWNrIHx8IGFyZ3VtZW50cy5sZW5ndGggPT09IDIpIGZvciAodmFyIGkgPSAwLCBsID0gZnJvbS5sZW5ndGgsIGFyOyBpIDwgbDsgaSsrKSB7XG4gICAgICAgIGlmIChhciB8fCAhKGkgaW4gZnJvbSkpIHtcbiAgICAgICAgICAgIGlmICghYXIpIGFyID0gQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoZnJvbSwgMCwgaSk7XG4gICAgICAgICAgICBhcltpXSA9IGZyb21baV07XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHRvLmNvbmNhdChhciB8fCBBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChmcm9tKSk7XG59O1xuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLy8gaW5zdGFuY2VzXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjEwLjBcbiAqL1xuZXhwb3J0IHZhciBnZXRCb29sZWFuQWxnZWJyYSA9IGZ1bmN0aW9uIChCKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uICgpIHsgcmV0dXJuICh7XG4gICAgICAgIG1lZXQ6IGZ1bmN0aW9uICh4LCB5KSB7IHJldHVybiBmdW5jdGlvbiAoYSkgeyByZXR1cm4gQi5tZWV0KHgoYSksIHkoYSkpOyB9OyB9LFxuICAgICAgICBqb2luOiBmdW5jdGlvbiAoeCwgeSkgeyByZXR1cm4gZnVuY3Rpb24gKGEpIHsgcmV0dXJuIEIuam9pbih4KGEpLCB5KGEpKTsgfTsgfSxcbiAgICAgICAgemVybzogZnVuY3Rpb24gKCkgeyByZXR1cm4gQi56ZXJvOyB9LFxuICAgICAgICBvbmU6IGZ1bmN0aW9uICgpIHsgcmV0dXJuIEIub25lOyB9LFxuICAgICAgICBpbXBsaWVzOiBmdW5jdGlvbiAoeCwgeSkgeyByZXR1cm4gZnVuY3Rpb24gKGEpIHsgcmV0dXJuIEIuaW1wbGllcyh4KGEpLCB5KGEpKTsgfTsgfSxcbiAgICAgICAgbm90OiBmdW5jdGlvbiAoeCkgeyByZXR1cm4gZnVuY3Rpb24gKGEpIHsgcmV0dXJuIEIubm90KHgoYSkpOyB9OyB9XG4gICAgfSk7IH07XG59O1xuLyoqXG4gKiBVbmFyeSBmdW5jdGlvbnMgZm9ybSBhIHNlbWlncm91cCBhcyBsb25nIGFzIHlvdSBjYW4gcHJvdmlkZSBhIHNlbWlncm91cCBmb3IgdGhlIGNvZG9tYWluLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBQcmVkaWNhdGUsIGdldFNlbWlncm91cCB9IGZyb20gJ2ZwLXRzL2Z1bmN0aW9uJ1xuICogaW1wb3J0ICogYXMgQiBmcm9tICdmcC10cy9ib29sZWFuJ1xuICpcbiAqIGNvbnN0IGY6IFByZWRpY2F0ZTxudW1iZXI+ID0gKG4pID0+IG4gPD0gMlxuICogY29uc3QgZzogUHJlZGljYXRlPG51bWJlcj4gPSAobikgPT4gbiA+PSAwXG4gKlxuICogY29uc3QgUzEgPSBnZXRTZW1pZ3JvdXAoQi5TZW1pZ3JvdXBBbGwpPG51bWJlcj4oKVxuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoUzEuY29uY2F0KGYsIGcpKDEpLCB0cnVlKVxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChTMS5jb25jYXQoZiwgZykoMyksIGZhbHNlKVxuICpcbiAqIGNvbnN0IFMyID0gZ2V0U2VtaWdyb3VwKEIuU2VtaWdyb3VwQW55KTxudW1iZXI+KClcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKFMyLmNvbmNhdChmLCBnKSgxKSwgdHJ1ZSlcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoUzIuY29uY2F0KGYsIGcpKDMpLCB0cnVlKVxuICpcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjEwLjBcbiAqL1xuZXhwb3J0IHZhciBnZXRTZW1pZ3JvdXAgPSBmdW5jdGlvbiAoUykge1xuICAgIHJldHVybiBmdW5jdGlvbiAoKSB7IHJldHVybiAoe1xuICAgICAgICBjb25jYXQ6IGZ1bmN0aW9uIChmLCBnKSB7IHJldHVybiBmdW5jdGlvbiAoYSkgeyByZXR1cm4gUy5jb25jYXQoZihhKSwgZyhhKSk7IH07IH1cbiAgICB9KTsgfTtcbn07XG4vKipcbiAqIFVuYXJ5IGZ1bmN0aW9ucyBmb3JtIGEgbW9ub2lkIGFzIGxvbmcgYXMgeW91IGNhbiBwcm92aWRlIGEgbW9ub2lkIGZvciB0aGUgY29kb21haW4uXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IFByZWRpY2F0ZSB9IGZyb20gJ2ZwLXRzL1ByZWRpY2F0ZSdcbiAqIGltcG9ydCB7IGdldE1vbm9pZCB9IGZyb20gJ2ZwLXRzL2Z1bmN0aW9uJ1xuICogaW1wb3J0ICogYXMgQiBmcm9tICdmcC10cy9ib29sZWFuJ1xuICpcbiAqIGNvbnN0IGY6IFByZWRpY2F0ZTxudW1iZXI+ID0gKG4pID0+IG4gPD0gMlxuICogY29uc3QgZzogUHJlZGljYXRlPG51bWJlcj4gPSAobikgPT4gbiA+PSAwXG4gKlxuICogY29uc3QgTTEgPSBnZXRNb25vaWQoQi5Nb25vaWRBbGwpPG51bWJlcj4oKVxuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoTTEuY29uY2F0KGYsIGcpKDEpLCB0cnVlKVxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChNMS5jb25jYXQoZiwgZykoMyksIGZhbHNlKVxuICpcbiAqIGNvbnN0IE0yID0gZ2V0TW9ub2lkKEIuTW9ub2lkQW55KTxudW1iZXI+KClcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKE0yLmNvbmNhdChmLCBnKSgxKSwgdHJ1ZSlcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoTTIuY29uY2F0KGYsIGcpKDMpLCB0cnVlKVxuICpcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjEwLjBcbiAqL1xuZXhwb3J0IHZhciBnZXRNb25vaWQgPSBmdW5jdGlvbiAoTSkge1xuICAgIHZhciBnZXRTZW1pZ3JvdXBNID0gZ2V0U2VtaWdyb3VwKE0pO1xuICAgIHJldHVybiBmdW5jdGlvbiAoKSB7IHJldHVybiAoe1xuICAgICAgICBjb25jYXQ6IGdldFNlbWlncm91cE0oKS5jb25jYXQsXG4gICAgICAgIGVtcHR5OiBmdW5jdGlvbiAoKSB7IHJldHVybiBNLmVtcHR5OyB9XG4gICAgfSk7IH07XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi4xMC4wXG4gKi9cbmV4cG9ydCB2YXIgZ2V0U2VtaXJpbmcgPSBmdW5jdGlvbiAoUykgeyByZXR1cm4gKHtcbiAgICBhZGQ6IGZ1bmN0aW9uIChmLCBnKSB7IHJldHVybiBmdW5jdGlvbiAoeCkgeyByZXR1cm4gUy5hZGQoZih4KSwgZyh4KSk7IH07IH0sXG4gICAgemVybzogZnVuY3Rpb24gKCkgeyByZXR1cm4gUy56ZXJvOyB9LFxuICAgIG11bDogZnVuY3Rpb24gKGYsIGcpIHsgcmV0dXJuIGZ1bmN0aW9uICh4KSB7IHJldHVybiBTLm11bChmKHgpLCBnKHgpKTsgfTsgfSxcbiAgICBvbmU6IGZ1bmN0aW9uICgpIHsgcmV0dXJuIFMub25lOyB9XG59KTsgfTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuMTAuMFxuICovXG5leHBvcnQgdmFyIGdldFJpbmcgPSBmdW5jdGlvbiAoUikge1xuICAgIHZhciBTID0gZ2V0U2VtaXJpbmcoUik7XG4gICAgcmV0dXJuIHtcbiAgICAgICAgYWRkOiBTLmFkZCxcbiAgICAgICAgbXVsOiBTLm11bCxcbiAgICAgICAgb25lOiBTLm9uZSxcbiAgICAgICAgemVybzogUy56ZXJvLFxuICAgICAgICBzdWI6IGZ1bmN0aW9uIChmLCBnKSB7IHJldHVybiBmdW5jdGlvbiAoeCkgeyByZXR1cm4gUi5zdWIoZih4KSwgZyh4KSk7IH07IH1cbiAgICB9O1xufTtcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8vIHV0aWxzXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vKipcbiAqIEBzaW5jZSAyLjExLjBcbiAqL1xuZXhwb3J0IHZhciBhcHBseSA9IGZ1bmN0aW9uIChhKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChmKSB7XG4gICAgICAgIHJldHVybiBmKGEpO1xuICAgIH07XG59O1xuLyoqXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGlkZW50aXR5KGEpIHtcbiAgICByZXR1cm4gYTtcbn1cbi8qKlxuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgdW5zYWZlQ29lcmNlID0gaWRlbnRpdHk7XG4vKipcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgZnVuY3Rpb24gY29uc3RhbnQoYSkge1xuICAgIHJldHVybiBmdW5jdGlvbiAoKSB7IHJldHVybiBhOyB9O1xufVxuLyoqXG4gKiBBIHRodW5rIHRoYXQgcmV0dXJucyBhbHdheXMgYHRydWVgLlxuICpcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIGNvbnN0VHJ1ZSA9IC8qI19fUFVSRV9fKi8gY29uc3RhbnQodHJ1ZSk7XG4vKipcbiAqIEEgdGh1bmsgdGhhdCByZXR1cm5zIGFsd2F5cyBgZmFsc2VgLlxuICpcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIGNvbnN0RmFsc2UgPSAvKiNfX1BVUkVfXyovIGNvbnN0YW50KGZhbHNlKTtcbi8qKlxuICogQSB0aHVuayB0aGF0IHJldHVybnMgYWx3YXlzIGBudWxsYC5cbiAqXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciBjb25zdE51bGwgPSAvKiNfX1BVUkVfXyovIGNvbnN0YW50KG51bGwpO1xuLyoqXG4gKiBBIHRodW5rIHRoYXQgcmV0dXJucyBhbHdheXMgYHVuZGVmaW5lZGAuXG4gKlxuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgY29uc3RVbmRlZmluZWQgPSAvKiNfX1BVUkVfXyovIGNvbnN0YW50KHVuZGVmaW5lZCk7XG4vKipcbiAqIEEgdGh1bmsgdGhhdCByZXR1cm5zIGFsd2F5cyBgdm9pZGAuXG4gKlxuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgY29uc3RWb2lkID0gY29uc3RVbmRlZmluZWQ7XG5leHBvcnQgZnVuY3Rpb24gZmxpcChmKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIGFyZ3MgPSBbXTtcbiAgICAgICAgZm9yICh2YXIgX2kgPSAwOyBfaSA8IGFyZ3VtZW50cy5sZW5ndGg7IF9pKyspIHtcbiAgICAgICAgICAgIGFyZ3NbX2ldID0gYXJndW1lbnRzW19pXTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoYXJncy5sZW5ndGggPiAxKSB7XG4gICAgICAgICAgICByZXR1cm4gZihhcmdzWzFdLCBhcmdzWzBdKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gZnVuY3Rpb24gKGEpIHsgcmV0dXJuIGYoYSkoYXJnc1swXSk7IH07XG4gICAgfTtcbn1cbmV4cG9ydCBmdW5jdGlvbiBmbG93KGFiLCBiYywgY2QsIGRlLCBlZiwgZmcsIGdoLCBoaSwgaWopIHtcbiAgICBzd2l0Y2ggKGFyZ3VtZW50cy5sZW5ndGgpIHtcbiAgICAgICAgY2FzZSAxOlxuICAgICAgICAgICAgcmV0dXJuIGFiO1xuICAgICAgICBjYXNlIDI6XG4gICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBiYyhhYi5hcHBseSh0aGlzLCBhcmd1bWVudHMpKTtcbiAgICAgICAgICAgIH07XG4gICAgICAgIGNhc2UgMzpcbiAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGNkKGJjKGFiLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykpKTtcbiAgICAgICAgICAgIH07XG4gICAgICAgIGNhc2UgNDpcbiAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGRlKGNkKGJjKGFiLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykpKSk7XG4gICAgICAgICAgICB9O1xuICAgICAgICBjYXNlIDU6XG4gICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBlZihkZShjZChiYyhhYi5hcHBseSh0aGlzLCBhcmd1bWVudHMpKSkpKTtcbiAgICAgICAgICAgIH07XG4gICAgICAgIGNhc2UgNjpcbiAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZnKGVmKGRlKGNkKGJjKGFiLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykpKSkpKTtcbiAgICAgICAgICAgIH07XG4gICAgICAgIGNhc2UgNzpcbiAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGdoKGZnKGVmKGRlKGNkKGJjKGFiLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykpKSkpKSk7XG4gICAgICAgICAgICB9O1xuICAgICAgICBjYXNlIDg6XG4gICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBoaShnaChmZyhlZihkZShjZChiYyhhYi5hcHBseSh0aGlzLCBhcmd1bWVudHMpKSkpKSkpKTtcbiAgICAgICAgICAgIH07XG4gICAgICAgIGNhc2UgOTpcbiAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGlqKGhpKGdoKGZnKGVmKGRlKGNkKGJjKGFiLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykpKSkpKSkpKTtcbiAgICAgICAgICAgIH07XG4gICAgfVxuICAgIHJldHVybjtcbn1cbi8qKlxuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiB0dXBsZSgpIHtcbiAgICB2YXIgdCA9IFtdO1xuICAgIGZvciAodmFyIF9pID0gMDsgX2kgPCBhcmd1bWVudHMubGVuZ3RoOyBfaSsrKSB7XG4gICAgICAgIHRbX2ldID0gYXJndW1lbnRzW19pXTtcbiAgICB9XG4gICAgcmV0dXJuIHQ7XG59XG4vKipcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgZnVuY3Rpb24gaW5jcmVtZW50KG4pIHtcbiAgICByZXR1cm4gbiArIDE7XG59XG4vKipcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgZnVuY3Rpb24gZGVjcmVtZW50KG4pIHtcbiAgICByZXR1cm4gbiAtIDE7XG59XG4vKipcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgZnVuY3Rpb24gYWJzdXJkKF8pIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ0NhbGxlZCBgYWJzdXJkYCBmdW5jdGlvbiB3aGljaCBzaG91bGQgYmUgdW5jYWxsYWJsZScpO1xufVxuLyoqXG4gKiBDcmVhdGVzIGEgdHVwbGVkIHZlcnNpb24gb2YgdGhpcyBmdW5jdGlvbjogaW5zdGVhZCBvZiBgbmAgYXJndW1lbnRzLCBpdCBhY2NlcHRzIGEgc2luZ2xlIHR1cGxlIGFyZ3VtZW50LlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyB0dXBsZWQgfSBmcm9tICdmcC10cy9mdW5jdGlvbidcbiAqXG4gKiBjb25zdCBhZGQgPSB0dXBsZWQoKHg6IG51bWJlciwgeTogbnVtYmVyKTogbnVtYmVyID0+IHggKyB5KVxuICpcbiAqIGFzc2VydC5zdHJpY3RFcXVhbChhZGQoWzEsIDJdKSwgMylcbiAqXG4gKiBAc2luY2UgMi40LjBcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHR1cGxlZChmKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhKSB7IHJldHVybiBmLmFwcGx5KHZvaWQgMCwgYSk7IH07XG59XG4vKipcbiAqIEludmVyc2UgZnVuY3Rpb24gb2YgYHR1cGxlZGBcbiAqXG4gKiBAc2luY2UgMi40LjBcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHVudHVwbGVkKGYpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgYSA9IFtdO1xuICAgICAgICBmb3IgKHZhciBfaSA9IDA7IF9pIDwgYXJndW1lbnRzLmxlbmd0aDsgX2krKykge1xuICAgICAgICAgICAgYVtfaV0gPSBhcmd1bWVudHNbX2ldO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBmKGEpO1xuICAgIH07XG59XG5leHBvcnQgZnVuY3Rpb24gcGlwZShhLCBhYiwgYmMsIGNkLCBkZSwgZWYsIGZnLCBnaCwgaGkpIHtcbiAgICBzd2l0Y2ggKGFyZ3VtZW50cy5sZW5ndGgpIHtcbiAgICAgICAgY2FzZSAxOlxuICAgICAgICAgICAgcmV0dXJuIGE7XG4gICAgICAgIGNhc2UgMjpcbiAgICAgICAgICAgIHJldHVybiBhYihhKTtcbiAgICAgICAgY2FzZSAzOlxuICAgICAgICAgICAgcmV0dXJuIGJjKGFiKGEpKTtcbiAgICAgICAgY2FzZSA0OlxuICAgICAgICAgICAgcmV0dXJuIGNkKGJjKGFiKGEpKSk7XG4gICAgICAgIGNhc2UgNTpcbiAgICAgICAgICAgIHJldHVybiBkZShjZChiYyhhYihhKSkpKTtcbiAgICAgICAgY2FzZSA2OlxuICAgICAgICAgICAgcmV0dXJuIGVmKGRlKGNkKGJjKGFiKGEpKSkpKTtcbiAgICAgICAgY2FzZSA3OlxuICAgICAgICAgICAgcmV0dXJuIGZnKGVmKGRlKGNkKGJjKGFiKGEpKSkpKSk7XG4gICAgICAgIGNhc2UgODpcbiAgICAgICAgICAgIHJldHVybiBnaChmZyhlZihkZShjZChiYyhhYihhKSkpKSkpKTtcbiAgICAgICAgY2FzZSA5OlxuICAgICAgICAgICAgcmV0dXJuIGhpKGdoKGZnKGVmKGRlKGNkKGJjKGFiKGEpKSkpKSkpKTtcbiAgICAgICAgZGVmYXVsdDoge1xuICAgICAgICAgICAgdmFyIHJldCA9IGFyZ3VtZW50c1swXTtcbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAxOyBpIDwgYXJndW1lbnRzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgcmV0ID0gYXJndW1lbnRzW2ldKHJldCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gcmV0O1xuICAgICAgICB9XG4gICAgfVxufVxuLyoqXG4gKiBUeXBlIGhvbGUgc2ltdWxhdGlvblxuICpcbiAqIEBzaW5jZSAyLjcuMFxuICovXG5leHBvcnQgdmFyIGhvbGUgPSBhYnN1cmQ7XG4vKipcbiAqIEBzaW5jZSAyLjExLjBcbiAqL1xuZXhwb3J0IHZhciBTSyA9IGZ1bmN0aW9uIChfLCBiKSB7IHJldHVybiBiOyB9O1xuLyoqXG4gKiBVc2UgYFByZWRpY2F0ZWAgbW9kdWxlIGluc3RlYWQuXG4gKlxuICogQGNhdGVnb3J5IHpvbmUgb2YgZGVhdGhcbiAqIEBzaW5jZSAyLjAuMFxuICogQGRlcHJlY2F0ZWRcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIG5vdChwcmVkaWNhdGUpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGEpIHsgcmV0dXJuICFwcmVkaWNhdGUoYSk7IH07XG59XG4vKipcbiAqIFVzZSBgRW5kb21vcnBoaXNtYCBtb2R1bGUgaW5zdGVhZC5cbiAqXG4gKiBAY2F0ZWdvcnkgem9uZSBvZiBkZWF0aFxuICogQHNpbmNlIDIuMTAuMFxuICogQGRlcHJlY2F0ZWRcbiAqL1xuZXhwb3J0IHZhciBnZXRFbmRvbW9ycGhpc21Nb25vaWQgPSBmdW5jdGlvbiAoKSB7IHJldHVybiAoe1xuICAgIGNvbmNhdDogZnVuY3Rpb24gKGZpcnN0LCBzZWNvbmQpIHsgcmV0dXJuIGZsb3coZmlyc3QsIHNlY29uZCk7IH0sXG4gICAgZW1wdHk6IGlkZW50aXR5XG59KTsgfTtcbi8qKiBAaW50ZXJuYWwgKi9cbmV4cG9ydCB2YXIgZHVhbCA9IGZ1bmN0aW9uIChhcml0eSwgYm9keSkge1xuICAgIHZhciBpc0RhdGFGaXJzdCA9IHR5cGVvZiBhcml0eSA9PT0gJ251bWJlcicgPyBmdW5jdGlvbiAoYXJncykgeyByZXR1cm4gYXJncy5sZW5ndGggPj0gYXJpdHk7IH0gOiBhcml0eTtcbiAgICByZXR1cm4gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgYXJncyA9IEFycmF5LmZyb20oYXJndW1lbnRzKTtcbiAgICAgICAgaWYgKGlzRGF0YUZpcnN0KGFyZ3VtZW50cykpIHtcbiAgICAgICAgICAgIHJldHVybiBib2R5LmFwcGx5KHRoaXMsIGFyZ3MpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBmdW5jdGlvbiAoc2VsZikgeyByZXR1cm4gYm9keS5hcHBseSh2b2lkIDAsIF9fc3ByZWFkQXJyYXkoW3NlbGZdLCBhcmdzLCBmYWxzZSkpOyB9O1xuICAgIH07XG59O1xuIiwKICAidmFyIF9fc3ByZWFkQXJyYXkgPSAodGhpcyAmJiB0aGlzLl9fc3ByZWFkQXJyYXkpIHx8IGZ1bmN0aW9uICh0bywgZnJvbSwgcGFjaykge1xuICAgIGlmIChwYWNrIHx8IGFyZ3VtZW50cy5sZW5ndGggPT09IDIpIGZvciAodmFyIGkgPSAwLCBsID0gZnJvbS5sZW5ndGgsIGFyOyBpIDwgbDsgaSsrKSB7XG4gICAgICAgIGlmIChhciB8fCAhKGkgaW4gZnJvbSkpIHtcbiAgICAgICAgICAgIGlmICghYXIpIGFyID0gQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoZnJvbSwgMCwgaSk7XG4gICAgICAgICAgICBhcltpXSA9IGZyb21baV07XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHRvLmNvbmNhdChhciB8fCBBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChmcm9tKSk7XG59O1xuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLy8gaW5zdGFuY2VzXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjEwLjBcbiAqL1xuZXhwb3J0IHZhciBnZXRCb29sZWFuQWxnZWJyYSA9IGZ1bmN0aW9uIChCKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uICgpIHsgcmV0dXJuICh7XG4gICAgICAgIG1lZXQ6IGZ1bmN0aW9uICh4LCB5KSB7IHJldHVybiBmdW5jdGlvbiAoYSkgeyByZXR1cm4gQi5tZWV0KHgoYSksIHkoYSkpOyB9OyB9LFxuICAgICAgICBqb2luOiBmdW5jdGlvbiAoeCwgeSkgeyByZXR1cm4gZnVuY3Rpb24gKGEpIHsgcmV0dXJuIEIuam9pbih4KGEpLCB5KGEpKTsgfTsgfSxcbiAgICAgICAgemVybzogZnVuY3Rpb24gKCkgeyByZXR1cm4gQi56ZXJvOyB9LFxuICAgICAgICBvbmU6IGZ1bmN0aW9uICgpIHsgcmV0dXJuIEIub25lOyB9LFxuICAgICAgICBpbXBsaWVzOiBmdW5jdGlvbiAoeCwgeSkgeyByZXR1cm4gZnVuY3Rpb24gKGEpIHsgcmV0dXJuIEIuaW1wbGllcyh4KGEpLCB5KGEpKTsgfTsgfSxcbiAgICAgICAgbm90OiBmdW5jdGlvbiAoeCkgeyByZXR1cm4gZnVuY3Rpb24gKGEpIHsgcmV0dXJuIEIubm90KHgoYSkpOyB9OyB9XG4gICAgfSk7IH07XG59O1xuLyoqXG4gKiBVbmFyeSBmdW5jdGlvbnMgZm9ybSBhIHNlbWlncm91cCBhcyBsb25nIGFzIHlvdSBjYW4gcHJvdmlkZSBhIHNlbWlncm91cCBmb3IgdGhlIGNvZG9tYWluLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBQcmVkaWNhdGUsIGdldFNlbWlncm91cCB9IGZyb20gJ2ZwLXRzL2Z1bmN0aW9uJ1xuICogaW1wb3J0ICogYXMgQiBmcm9tICdmcC10cy9ib29sZWFuJ1xuICpcbiAqIGNvbnN0IGY6IFByZWRpY2F0ZTxudW1iZXI+ID0gKG4pID0+IG4gPD0gMlxuICogY29uc3QgZzogUHJlZGljYXRlPG51bWJlcj4gPSAobikgPT4gbiA+PSAwXG4gKlxuICogY29uc3QgUzEgPSBnZXRTZW1pZ3JvdXAoQi5TZW1pZ3JvdXBBbGwpPG51bWJlcj4oKVxuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoUzEuY29uY2F0KGYsIGcpKDEpLCB0cnVlKVxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChTMS5jb25jYXQoZiwgZykoMyksIGZhbHNlKVxuICpcbiAqIGNvbnN0IFMyID0gZ2V0U2VtaWdyb3VwKEIuU2VtaWdyb3VwQW55KTxudW1iZXI+KClcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKFMyLmNvbmNhdChmLCBnKSgxKSwgdHJ1ZSlcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoUzIuY29uY2F0KGYsIGcpKDMpLCB0cnVlKVxuICpcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjEwLjBcbiAqL1xuZXhwb3J0IHZhciBnZXRTZW1pZ3JvdXAgPSBmdW5jdGlvbiAoUykge1xuICAgIHJldHVybiBmdW5jdGlvbiAoKSB7IHJldHVybiAoe1xuICAgICAgICBjb25jYXQ6IGZ1bmN0aW9uIChmLCBnKSB7IHJldHVybiBmdW5jdGlvbiAoYSkgeyByZXR1cm4gUy5jb25jYXQoZihhKSwgZyhhKSk7IH07IH1cbiAgICB9KTsgfTtcbn07XG4vKipcbiAqIFVuYXJ5IGZ1bmN0aW9ucyBmb3JtIGEgbW9ub2lkIGFzIGxvbmcgYXMgeW91IGNhbiBwcm92aWRlIGEgbW9ub2lkIGZvciB0aGUgY29kb21haW4uXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IFByZWRpY2F0ZSB9IGZyb20gJ2ZwLXRzL1ByZWRpY2F0ZSdcbiAqIGltcG9ydCB7IGdldE1vbm9pZCB9IGZyb20gJ2ZwLXRzL2Z1bmN0aW9uJ1xuICogaW1wb3J0ICogYXMgQiBmcm9tICdmcC10cy9ib29sZWFuJ1xuICpcbiAqIGNvbnN0IGY6IFByZWRpY2F0ZTxudW1iZXI+ID0gKG4pID0+IG4gPD0gMlxuICogY29uc3QgZzogUHJlZGljYXRlPG51bWJlcj4gPSAobikgPT4gbiA+PSAwXG4gKlxuICogY29uc3QgTTEgPSBnZXRNb25vaWQoQi5Nb25vaWRBbGwpPG51bWJlcj4oKVxuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoTTEuY29uY2F0KGYsIGcpKDEpLCB0cnVlKVxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChNMS5jb25jYXQoZiwgZykoMyksIGZhbHNlKVxuICpcbiAqIGNvbnN0IE0yID0gZ2V0TW9ub2lkKEIuTW9ub2lkQW55KTxudW1iZXI+KClcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKE0yLmNvbmNhdChmLCBnKSgxKSwgdHJ1ZSlcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoTTIuY29uY2F0KGYsIGcpKDMpLCB0cnVlKVxuICpcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjEwLjBcbiAqL1xuZXhwb3J0IHZhciBnZXRNb25vaWQgPSBmdW5jdGlvbiAoTSkge1xuICAgIHZhciBnZXRTZW1pZ3JvdXBNID0gZ2V0U2VtaWdyb3VwKE0pO1xuICAgIHJldHVybiBmdW5jdGlvbiAoKSB7IHJldHVybiAoe1xuICAgICAgICBjb25jYXQ6IGdldFNlbWlncm91cE0oKS5jb25jYXQsXG4gICAgICAgIGVtcHR5OiBmdW5jdGlvbiAoKSB7IHJldHVybiBNLmVtcHR5OyB9XG4gICAgfSk7IH07XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi4xMC4wXG4gKi9cbmV4cG9ydCB2YXIgZ2V0U2VtaXJpbmcgPSBmdW5jdGlvbiAoUykgeyByZXR1cm4gKHtcbiAgICBhZGQ6IGZ1bmN0aW9uIChmLCBnKSB7IHJldHVybiBmdW5jdGlvbiAoeCkgeyByZXR1cm4gUy5hZGQoZih4KSwgZyh4KSk7IH07IH0sXG4gICAgemVybzogZnVuY3Rpb24gKCkgeyByZXR1cm4gUy56ZXJvOyB9LFxuICAgIG11bDogZnVuY3Rpb24gKGYsIGcpIHsgcmV0dXJuIGZ1bmN0aW9uICh4KSB7IHJldHVybiBTLm11bChmKHgpLCBnKHgpKTsgfTsgfSxcbiAgICBvbmU6IGZ1bmN0aW9uICgpIHsgcmV0dXJuIFMub25lOyB9XG59KTsgfTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuMTAuMFxuICovXG5leHBvcnQgdmFyIGdldFJpbmcgPSBmdW5jdGlvbiAoUikge1xuICAgIHZhciBTID0gZ2V0U2VtaXJpbmcoUik7XG4gICAgcmV0dXJuIHtcbiAgICAgICAgYWRkOiBTLmFkZCxcbiAgICAgICAgbXVsOiBTLm11bCxcbiAgICAgICAgb25lOiBTLm9uZSxcbiAgICAgICAgemVybzogUy56ZXJvLFxuICAgICAgICBzdWI6IGZ1bmN0aW9uIChmLCBnKSB7IHJldHVybiBmdW5jdGlvbiAoeCkgeyByZXR1cm4gUi5zdWIoZih4KSwgZyh4KSk7IH07IH1cbiAgICB9O1xufTtcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8vIHV0aWxzXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vKipcbiAqIEBzaW5jZSAyLjExLjBcbiAqL1xuZXhwb3J0IHZhciBhcHBseSA9IGZ1bmN0aW9uIChhKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChmKSB7XG4gICAgICAgIHJldHVybiBmKGEpO1xuICAgIH07XG59O1xuLyoqXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGlkZW50aXR5KGEpIHtcbiAgICByZXR1cm4gYTtcbn1cbi8qKlxuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgdW5zYWZlQ29lcmNlID0gaWRlbnRpdHk7XG4vKipcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgZnVuY3Rpb24gY29uc3RhbnQoYSkge1xuICAgIHJldHVybiBmdW5jdGlvbiAoKSB7IHJldHVybiBhOyB9O1xufVxuLyoqXG4gKiBBIHRodW5rIHRoYXQgcmV0dXJucyBhbHdheXMgYHRydWVgLlxuICpcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIGNvbnN0VHJ1ZSA9IC8qI19fUFVSRV9fKi8gY29uc3RhbnQodHJ1ZSk7XG4vKipcbiAqIEEgdGh1bmsgdGhhdCByZXR1cm5zIGFsd2F5cyBgZmFsc2VgLlxuICpcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIGNvbnN0RmFsc2UgPSAvKiNfX1BVUkVfXyovIGNvbnN0YW50KGZhbHNlKTtcbi8qKlxuICogQSB0aHVuayB0aGF0IHJldHVybnMgYWx3YXlzIGBudWxsYC5cbiAqXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciBjb25zdE51bGwgPSAvKiNfX1BVUkVfXyovIGNvbnN0YW50KG51bGwpO1xuLyoqXG4gKiBBIHRodW5rIHRoYXQgcmV0dXJucyBhbHdheXMgYHVuZGVmaW5lZGAuXG4gKlxuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgY29uc3RVbmRlZmluZWQgPSAvKiNfX1BVUkVfXyovIGNvbnN0YW50KHVuZGVmaW5lZCk7XG4vKipcbiAqIEEgdGh1bmsgdGhhdCByZXR1cm5zIGFsd2F5cyBgdm9pZGAuXG4gKlxuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgY29uc3RWb2lkID0gY29uc3RVbmRlZmluZWQ7XG5leHBvcnQgZnVuY3Rpb24gZmxpcChmKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIGFyZ3MgPSBbXTtcbiAgICAgICAgZm9yICh2YXIgX2kgPSAwOyBfaSA8IGFyZ3VtZW50cy5sZW5ndGg7IF9pKyspIHtcbiAgICAgICAgICAgIGFyZ3NbX2ldID0gYXJndW1lbnRzW19pXTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoYXJncy5sZW5ndGggPiAxKSB7XG4gICAgICAgICAgICByZXR1cm4gZihhcmdzWzFdLCBhcmdzWzBdKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gZnVuY3Rpb24gKGEpIHsgcmV0dXJuIGYoYSkoYXJnc1swXSk7IH07XG4gICAgfTtcbn1cbmV4cG9ydCBmdW5jdGlvbiBmbG93KGFiLCBiYywgY2QsIGRlLCBlZiwgZmcsIGdoLCBoaSwgaWopIHtcbiAgICBzd2l0Y2ggKGFyZ3VtZW50cy5sZW5ndGgpIHtcbiAgICAgICAgY2FzZSAxOlxuICAgICAgICAgICAgcmV0dXJuIGFiO1xuICAgICAgICBjYXNlIDI6XG4gICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBiYyhhYi5hcHBseSh0aGlzLCBhcmd1bWVudHMpKTtcbiAgICAgICAgICAgIH07XG4gICAgICAgIGNhc2UgMzpcbiAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGNkKGJjKGFiLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykpKTtcbiAgICAgICAgICAgIH07XG4gICAgICAgIGNhc2UgNDpcbiAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGRlKGNkKGJjKGFiLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykpKSk7XG4gICAgICAgICAgICB9O1xuICAgICAgICBjYXNlIDU6XG4gICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBlZihkZShjZChiYyhhYi5hcHBseSh0aGlzLCBhcmd1bWVudHMpKSkpKTtcbiAgICAgICAgICAgIH07XG4gICAgICAgIGNhc2UgNjpcbiAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZnKGVmKGRlKGNkKGJjKGFiLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykpKSkpKTtcbiAgICAgICAgICAgIH07XG4gICAgICAgIGNhc2UgNzpcbiAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGdoKGZnKGVmKGRlKGNkKGJjKGFiLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykpKSkpKSk7XG4gICAgICAgICAgICB9O1xuICAgICAgICBjYXNlIDg6XG4gICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBoaShnaChmZyhlZihkZShjZChiYyhhYi5hcHBseSh0aGlzLCBhcmd1bWVudHMpKSkpKSkpKTtcbiAgICAgICAgICAgIH07XG4gICAgICAgIGNhc2UgOTpcbiAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGlqKGhpKGdoKGZnKGVmKGRlKGNkKGJjKGFiLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykpKSkpKSkpKTtcbiAgICAgICAgICAgIH07XG4gICAgfVxuICAgIHJldHVybjtcbn1cbi8qKlxuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiB0dXBsZSgpIHtcbiAgICB2YXIgdCA9IFtdO1xuICAgIGZvciAodmFyIF9pID0gMDsgX2kgPCBhcmd1bWVudHMubGVuZ3RoOyBfaSsrKSB7XG4gICAgICAgIHRbX2ldID0gYXJndW1lbnRzW19pXTtcbiAgICB9XG4gICAgcmV0dXJuIHQ7XG59XG4vKipcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgZnVuY3Rpb24gaW5jcmVtZW50KG4pIHtcbiAgICByZXR1cm4gbiArIDE7XG59XG4vKipcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgZnVuY3Rpb24gZGVjcmVtZW50KG4pIHtcbiAgICByZXR1cm4gbiAtIDE7XG59XG4vKipcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgZnVuY3Rpb24gYWJzdXJkKF8pIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ0NhbGxlZCBgYWJzdXJkYCBmdW5jdGlvbiB3aGljaCBzaG91bGQgYmUgdW5jYWxsYWJsZScpO1xufVxuLyoqXG4gKiBDcmVhdGVzIGEgdHVwbGVkIHZlcnNpb24gb2YgdGhpcyBmdW5jdGlvbjogaW5zdGVhZCBvZiBgbmAgYXJndW1lbnRzLCBpdCBhY2NlcHRzIGEgc2luZ2xlIHR1cGxlIGFyZ3VtZW50LlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyB0dXBsZWQgfSBmcm9tICdmcC10cy9mdW5jdGlvbidcbiAqXG4gKiBjb25zdCBhZGQgPSB0dXBsZWQoKHg6IG51bWJlciwgeTogbnVtYmVyKTogbnVtYmVyID0+IHggKyB5KVxuICpcbiAqIGFzc2VydC5zdHJpY3RFcXVhbChhZGQoWzEsIDJdKSwgMylcbiAqXG4gKiBAc2luY2UgMi40LjBcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHR1cGxlZChmKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhKSB7IHJldHVybiBmLmFwcGx5KHZvaWQgMCwgYSk7IH07XG59XG4vKipcbiAqIEludmVyc2UgZnVuY3Rpb24gb2YgYHR1cGxlZGBcbiAqXG4gKiBAc2luY2UgMi40LjBcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHVudHVwbGVkKGYpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgYSA9IFtdO1xuICAgICAgICBmb3IgKHZhciBfaSA9IDA7IF9pIDwgYXJndW1lbnRzLmxlbmd0aDsgX2krKykge1xuICAgICAgICAgICAgYVtfaV0gPSBhcmd1bWVudHNbX2ldO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBmKGEpO1xuICAgIH07XG59XG5leHBvcnQgZnVuY3Rpb24gcGlwZShhLCBhYiwgYmMsIGNkLCBkZSwgZWYsIGZnLCBnaCwgaGkpIHtcbiAgICBzd2l0Y2ggKGFyZ3VtZW50cy5sZW5ndGgpIHtcbiAgICAgICAgY2FzZSAxOlxuICAgICAgICAgICAgcmV0dXJuIGE7XG4gICAgICAgIGNhc2UgMjpcbiAgICAgICAgICAgIHJldHVybiBhYihhKTtcbiAgICAgICAgY2FzZSAzOlxuICAgICAgICAgICAgcmV0dXJuIGJjKGFiKGEpKTtcbiAgICAgICAgY2FzZSA0OlxuICAgICAgICAgICAgcmV0dXJuIGNkKGJjKGFiKGEpKSk7XG4gICAgICAgIGNhc2UgNTpcbiAgICAgICAgICAgIHJldHVybiBkZShjZChiYyhhYihhKSkpKTtcbiAgICAgICAgY2FzZSA2OlxuICAgICAgICAgICAgcmV0dXJuIGVmKGRlKGNkKGJjKGFiKGEpKSkpKTtcbiAgICAgICAgY2FzZSA3OlxuICAgICAgICAgICAgcmV0dXJuIGZnKGVmKGRlKGNkKGJjKGFiKGEpKSkpKSk7XG4gICAgICAgIGNhc2UgODpcbiAgICAgICAgICAgIHJldHVybiBnaChmZyhlZihkZShjZChiYyhhYihhKSkpKSkpKTtcbiAgICAgICAgY2FzZSA5OlxuICAgICAgICAgICAgcmV0dXJuIGhpKGdoKGZnKGVmKGRlKGNkKGJjKGFiKGEpKSkpKSkpKTtcbiAgICAgICAgZGVmYXVsdDoge1xuICAgICAgICAgICAgdmFyIHJldCA9IGFyZ3VtZW50c1swXTtcbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAxOyBpIDwgYXJndW1lbnRzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgcmV0ID0gYXJndW1lbnRzW2ldKHJldCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gcmV0O1xuICAgICAgICB9XG4gICAgfVxufVxuLyoqXG4gKiBUeXBlIGhvbGUgc2ltdWxhdGlvblxuICpcbiAqIEBzaW5jZSAyLjcuMFxuICovXG5leHBvcnQgdmFyIGhvbGUgPSBhYnN1cmQ7XG4vKipcbiAqIEBzaW5jZSAyLjExLjBcbiAqL1xuZXhwb3J0IHZhciBTSyA9IGZ1bmN0aW9uIChfLCBiKSB7IHJldHVybiBiOyB9O1xuLyoqXG4gKiBVc2UgYFByZWRpY2F0ZWAgbW9kdWxlIGluc3RlYWQuXG4gKlxuICogQGNhdGVnb3J5IHpvbmUgb2YgZGVhdGhcbiAqIEBzaW5jZSAyLjAuMFxuICogQGRlcHJlY2F0ZWRcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIG5vdChwcmVkaWNhdGUpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGEpIHsgcmV0dXJuICFwcmVkaWNhdGUoYSk7IH07XG59XG4vKipcbiAqIFVzZSBgRW5kb21vcnBoaXNtYCBtb2R1bGUgaW5zdGVhZC5cbiAqXG4gKiBAY2F0ZWdvcnkgem9uZSBvZiBkZWF0aFxuICogQHNpbmNlIDIuMTAuMFxuICogQGRlcHJlY2F0ZWRcbiAqL1xuZXhwb3J0IHZhciBnZXRFbmRvbW9ycGhpc21Nb25vaWQgPSBmdW5jdGlvbiAoKSB7IHJldHVybiAoe1xuICAgIGNvbmNhdDogZnVuY3Rpb24gKGZpcnN0LCBzZWNvbmQpIHsgcmV0dXJuIGZsb3coZmlyc3QsIHNlY29uZCk7IH0sXG4gICAgZW1wdHk6IGlkZW50aXR5XG59KTsgfTtcbi8qKiBAaW50ZXJuYWwgKi9cbmV4cG9ydCB2YXIgZHVhbCA9IGZ1bmN0aW9uIChhcml0eSwgYm9keSkge1xuICAgIHZhciBpc0RhdGFGaXJzdCA9IHR5cGVvZiBhcml0eSA9PT0gJ251bWJlcicgPyBmdW5jdGlvbiAoYXJncykgeyByZXR1cm4gYXJncy5sZW5ndGggPj0gYXJpdHk7IH0gOiBhcml0eTtcbiAgICByZXR1cm4gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgYXJncyA9IEFycmF5LmZyb20oYXJndW1lbnRzKTtcbiAgICAgICAgaWYgKGlzRGF0YUZpcnN0KGFyZ3VtZW50cykpIHtcbiAgICAgICAgICAgIHJldHVybiBib2R5LmFwcGx5KHRoaXMsIGFyZ3MpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBmdW5jdGlvbiAoc2VsZikgeyByZXR1cm4gYm9keS5hcHBseSh2b2lkIDAsIF9fc3ByZWFkQXJyYXkoW3NlbGZdLCBhcmdzLCBmYWxzZSkpOyB9O1xuICAgIH07XG59O1xuIiwKICAidmFyIF9fc3ByZWFkQXJyYXkgPSAodGhpcyAmJiB0aGlzLl9fc3ByZWFkQXJyYXkpIHx8IGZ1bmN0aW9uICh0bywgZnJvbSwgcGFjaykge1xuICAgIGlmIChwYWNrIHx8IGFyZ3VtZW50cy5sZW5ndGggPT09IDIpIGZvciAodmFyIGkgPSAwLCBsID0gZnJvbS5sZW5ndGgsIGFyOyBpIDwgbDsgaSsrKSB7XG4gICAgICAgIGlmIChhciB8fCAhKGkgaW4gZnJvbSkpIHtcbiAgICAgICAgICAgIGlmICghYXIpIGFyID0gQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoZnJvbSwgMCwgaSk7XG4gICAgICAgICAgICBhcltpXSA9IGZyb21baV07XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHRvLmNvbmNhdChhciB8fCBBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChmcm9tKSk7XG59O1xuaW1wb3J0IHsgZHVhbCB9IGZyb20gJy4vZnVuY3Rpb24nO1xuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLy8gT3B0aW9uXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vKiogQGludGVybmFsICovXG5leHBvcnQgdmFyIGlzTm9uZSA9IGZ1bmN0aW9uIChmYSkgeyByZXR1cm4gZmEuX3RhZyA9PT0gJ05vbmUnOyB9O1xuLyoqIEBpbnRlcm5hbCAqL1xuZXhwb3J0IHZhciBpc1NvbWUgPSBmdW5jdGlvbiAoZmEpIHsgcmV0dXJuIGZhLl90YWcgPT09ICdTb21lJzsgfTtcbi8qKiBAaW50ZXJuYWwgKi9cbmV4cG9ydCB2YXIgbm9uZSA9IHsgX3RhZzogJ05vbmUnIH07XG4vKiogQGludGVybmFsICovXG5leHBvcnQgdmFyIHNvbWUgPSBmdW5jdGlvbiAoYSkgeyByZXR1cm4gKHsgX3RhZzogJ1NvbWUnLCB2YWx1ZTogYSB9KTsgfTtcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8vIEVpdGhlclxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLyoqIEBpbnRlcm5hbCAqL1xuZXhwb3J0IHZhciBpc0xlZnQgPSBmdW5jdGlvbiAobWEpIHsgcmV0dXJuIG1hLl90YWcgPT09ICdMZWZ0JzsgfTtcbi8qKiBAaW50ZXJuYWwgKi9cbmV4cG9ydCB2YXIgaXNSaWdodCA9IGZ1bmN0aW9uIChtYSkgeyByZXR1cm4gbWEuX3RhZyA9PT0gJ1JpZ2h0JzsgfTtcbi8qKiBAaW50ZXJuYWwgKi9cbmV4cG9ydCB2YXIgbGVmdCA9IGZ1bmN0aW9uIChlKSB7IHJldHVybiAoeyBfdGFnOiAnTGVmdCcsIGxlZnQ6IGUgfSk7IH07XG4vKiogQGludGVybmFsICovXG5leHBvcnQgdmFyIHJpZ2h0ID0gZnVuY3Rpb24gKGEpIHsgcmV0dXJuICh7IF90YWc6ICdSaWdodCcsIHJpZ2h0OiBhIH0pOyB9O1xuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLy8gUmVhZG9ubHlOb25FbXB0eUFycmF5XG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vKiogQGludGVybmFsICovXG5leHBvcnQgdmFyIHNpbmdsZXRvbiA9IGZ1bmN0aW9uIChhKSB7IHJldHVybiBbYV07IH07XG4vKiogQGludGVybmFsICovXG5leHBvcnQgdmFyIGlzTm9uRW1wdHkgPSBmdW5jdGlvbiAoYXMpIHsgcmV0dXJuIGFzLmxlbmd0aCA+IDA7IH07XG4vKiogQGludGVybmFsICovXG5leHBvcnQgdmFyIGhlYWQgPSBmdW5jdGlvbiAoYXMpIHsgcmV0dXJuIGFzWzBdOyB9O1xuLyoqIEBpbnRlcm5hbCAqL1xuZXhwb3J0IHZhciB0YWlsID0gZnVuY3Rpb24gKGFzKSB7IHJldHVybiBhcy5zbGljZSgxKTsgfTtcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8vIGVtcHR5XG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vKiogQGludGVybmFsICovXG5leHBvcnQgdmFyIGVtcHR5UmVhZG9ubHlBcnJheSA9IFtdO1xuLyoqIEBpbnRlcm5hbCAqL1xuZXhwb3J0IHZhciBlbXB0eVJlY29yZCA9IHt9O1xuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLy8gUmVjb3JkXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vKiogQGludGVybmFsICovXG5leHBvcnQgdmFyIGhhcyA9IE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHk7XG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vLyBOb25FbXB0eUFycmF5XG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vKiogQGludGVybmFsICovXG5leHBvcnQgdmFyIGZyb21SZWFkb25seU5vbkVtcHR5QXJyYXkgPSBmdW5jdGlvbiAoYXMpIHsgcmV0dXJuIF9fc3ByZWFkQXJyYXkoW2FzWzBdXSwgYXMuc2xpY2UoMSksIHRydWUpOyB9O1xuLyoqIEBpbnRlcm5hbCAqL1xuZXhwb3J0IHZhciBsaWZ0TnVsbGFibGUgPSBmdW5jdGlvbiAoRikge1xuICAgIHJldHVybiBmdW5jdGlvbiAoZiwgb25OdWxsYWJsZSkge1xuICAgICAgICByZXR1cm4gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIGEgPSBbXTtcbiAgICAgICAgICAgIGZvciAodmFyIF9pID0gMDsgX2kgPCBhcmd1bWVudHMubGVuZ3RoOyBfaSsrKSB7XG4gICAgICAgICAgICAgICAgYVtfaV0gPSBhcmd1bWVudHNbX2ldO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIG8gPSBmLmFwcGx5KHZvaWQgMCwgYSk7XG4gICAgICAgICAgICByZXR1cm4gRi5mcm9tRWl0aGVyKG8gPT0gbnVsbCA/IGxlZnQob25OdWxsYWJsZS5hcHBseSh2b2lkIDAsIGEpKSA6IHJpZ2h0KG8pKTtcbiAgICAgICAgfTtcbiAgICB9O1xufTtcbi8qKiBAaW50ZXJuYWwgKi9cbmV4cG9ydCB2YXIgbGlmdE9wdGlvbiA9IGZ1bmN0aW9uIChGKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChmLCBvbk5vbmUpIHtcbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhciBhID0gW107XG4gICAgICAgICAgICBmb3IgKHZhciBfaSA9IDA7IF9pIDwgYXJndW1lbnRzLmxlbmd0aDsgX2krKykge1xuICAgICAgICAgICAgICAgIGFbX2ldID0gYXJndW1lbnRzW19pXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciBvID0gZi5hcHBseSh2b2lkIDAsIGEpO1xuICAgICAgICAgICAgcmV0dXJuIEYuZnJvbUVpdGhlcihpc05vbmUobykgPyBsZWZ0KG9uTm9uZS5hcHBseSh2b2lkIDAsIGEpKSA6IHJpZ2h0KG8udmFsdWUpKTtcbiAgICAgICAgfTtcbiAgICB9O1xufTtcbi8qKiBAaW50ZXJuYWwgKi9cbmV4cG9ydCB2YXIgZmxhdE1hcE51bGxhYmxlID0gZnVuY3Rpb24gKEYsIE0pIHtcbiAgICAvKiNfX1BVUkVfXyovIHJldHVybiBkdWFsKDMsIGZ1bmN0aW9uIChzZWxmLCBmLCBvbk51bGxhYmxlKSB7XG4gICAgICAgIHJldHVybiBNLmZsYXRNYXAoc2VsZiwgbGlmdE51bGxhYmxlKEYpKGYsIG9uTnVsbGFibGUpKTtcbiAgICB9KTtcbn07XG4vKiogQGludGVybmFsICovXG5leHBvcnQgdmFyIGZsYXRNYXBPcHRpb24gPSBmdW5jdGlvbiAoRiwgTSkge1xuICAgIC8qI19fUFVSRV9fKi8gcmV0dXJuIGR1YWwoMywgZnVuY3Rpb24gKHNlbGYsIGYsIG9uTm9uZSkgeyByZXR1cm4gTS5mbGF0TWFwKHNlbGYsIGxpZnRPcHRpb24oRikoZiwgb25Ob25lKSk7IH0pO1xufTtcbi8qKiBAaW50ZXJuYWwgKi9cbmV4cG9ydCB2YXIgZmxhdE1hcEVpdGhlciA9IGZ1bmN0aW9uIChGLCBNKSB7XG4gICAgLyojX19QVVJFX18qLyByZXR1cm4gZHVhbCgyLCBmdW5jdGlvbiAoc2VsZiwgZikge1xuICAgICAgICByZXR1cm4gTS5mbGF0TWFwKHNlbGYsIGZ1bmN0aW9uIChhKSB7IHJldHVybiBGLmZyb21FaXRoZXIoZihhKSk7IH0pO1xuICAgIH0pO1xufTtcbi8qKiBAaW50ZXJuYWwgKi9cbmV4cG9ydCB2YXIgZmxhdE1hcElPID0gZnVuY3Rpb24gKEYsIE0pIHtcbiAgICAvKiNfX1BVUkVfXyovIHJldHVybiBkdWFsKDIsIGZ1bmN0aW9uIChzZWxmLCBmKSB7XG4gICAgICAgIHJldHVybiBNLmZsYXRNYXAoc2VsZiwgZnVuY3Rpb24gKGEpIHsgcmV0dXJuIEYuZnJvbUlPKGYoYSkpOyB9KTtcbiAgICB9KTtcbn07XG4vKiogQGludGVybmFsICovXG5leHBvcnQgdmFyIGZsYXRNYXBUYXNrID0gZnVuY3Rpb24gKEYsIE0pIHtcbiAgICAvKiNfX1BVUkVfXyovIHJldHVybiBkdWFsKDIsIGZ1bmN0aW9uIChzZWxmLCBmKSB7XG4gICAgICAgIHJldHVybiBNLmZsYXRNYXAoc2VsZiwgZnVuY3Rpb24gKGEpIHsgcmV0dXJuIEYuZnJvbVRhc2soZihhKSk7IH0pO1xuICAgIH0pO1xufTtcbi8qKiBAaW50ZXJuYWwgKi9cbmV4cG9ydCB2YXIgZmxhdE1hcFJlYWRlciA9IGZ1bmN0aW9uIChGLCBNKSB7XG4gICAgLyojX19QVVJFX18qLyByZXR1cm4gZHVhbCgyLCBmdW5jdGlvbiAoc2VsZiwgZikge1xuICAgICAgICByZXR1cm4gTS5mbGF0TWFwKHNlbGYsIGZ1bmN0aW9uIChhKSB7IHJldHVybiBGLmZyb21SZWFkZXIoZihhKSk7IH0pO1xuICAgIH0pO1xufTtcbiIsCiAgInZhciBfX3NwcmVhZEFycmF5ID0gKHRoaXMgJiYgdGhpcy5fX3NwcmVhZEFycmF5KSB8fCBmdW5jdGlvbiAodG8sIGZyb20sIHBhY2spIHtcbiAgICBpZiAocGFjayB8fCBhcmd1bWVudHMubGVuZ3RoID09PSAyKSBmb3IgKHZhciBpID0gMCwgbCA9IGZyb20ubGVuZ3RoLCBhcjsgaSA8IGw7IGkrKykge1xuICAgICAgICBpZiAoYXIgfHwgIShpIGluIGZyb20pKSB7XG4gICAgICAgICAgICBpZiAoIWFyKSBhciA9IEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGZyb20sIDAsIGkpO1xuICAgICAgICAgICAgYXJbaV0gPSBmcm9tW2ldO1xuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiB0by5jb25jYXQoYXIgfHwgQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoZnJvbSkpO1xufTtcbmltcG9ydCB7IGR1YWwgfSBmcm9tICcuL2Z1bmN0aW9uJztcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8vIE9wdGlvblxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLyoqIEBpbnRlcm5hbCAqL1xuZXhwb3J0IHZhciBpc05vbmUgPSBmdW5jdGlvbiAoZmEpIHsgcmV0dXJuIGZhLl90YWcgPT09ICdOb25lJzsgfTtcbi8qKiBAaW50ZXJuYWwgKi9cbmV4cG9ydCB2YXIgaXNTb21lID0gZnVuY3Rpb24gKGZhKSB7IHJldHVybiBmYS5fdGFnID09PSAnU29tZSc7IH07XG4vKiogQGludGVybmFsICovXG5leHBvcnQgdmFyIG5vbmUgPSB7IF90YWc6ICdOb25lJyB9O1xuLyoqIEBpbnRlcm5hbCAqL1xuZXhwb3J0IHZhciBzb21lID0gZnVuY3Rpb24gKGEpIHsgcmV0dXJuICh7IF90YWc6ICdTb21lJywgdmFsdWU6IGEgfSk7IH07XG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vLyBFaXRoZXJcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8qKiBAaW50ZXJuYWwgKi9cbmV4cG9ydCB2YXIgaXNMZWZ0ID0gZnVuY3Rpb24gKG1hKSB7IHJldHVybiBtYS5fdGFnID09PSAnTGVmdCc7IH07XG4vKiogQGludGVybmFsICovXG5leHBvcnQgdmFyIGlzUmlnaHQgPSBmdW5jdGlvbiAobWEpIHsgcmV0dXJuIG1hLl90YWcgPT09ICdSaWdodCc7IH07XG4vKiogQGludGVybmFsICovXG5leHBvcnQgdmFyIGxlZnQgPSBmdW5jdGlvbiAoZSkgeyByZXR1cm4gKHsgX3RhZzogJ0xlZnQnLCBsZWZ0OiBlIH0pOyB9O1xuLyoqIEBpbnRlcm5hbCAqL1xuZXhwb3J0IHZhciByaWdodCA9IGZ1bmN0aW9uIChhKSB7IHJldHVybiAoeyBfdGFnOiAnUmlnaHQnLCByaWdodDogYSB9KTsgfTtcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8vIFJlYWRvbmx5Tm9uRW1wdHlBcnJheVxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLyoqIEBpbnRlcm5hbCAqL1xuZXhwb3J0IHZhciBzaW5nbGV0b24gPSBmdW5jdGlvbiAoYSkgeyByZXR1cm4gW2FdOyB9O1xuLyoqIEBpbnRlcm5hbCAqL1xuZXhwb3J0IHZhciBpc05vbkVtcHR5ID0gZnVuY3Rpb24gKGFzKSB7IHJldHVybiBhcy5sZW5ndGggPiAwOyB9O1xuLyoqIEBpbnRlcm5hbCAqL1xuZXhwb3J0IHZhciBoZWFkID0gZnVuY3Rpb24gKGFzKSB7IHJldHVybiBhc1swXTsgfTtcbi8qKiBAaW50ZXJuYWwgKi9cbmV4cG9ydCB2YXIgdGFpbCA9IGZ1bmN0aW9uIChhcykgeyByZXR1cm4gYXMuc2xpY2UoMSk7IH07XG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vLyBlbXB0eVxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLyoqIEBpbnRlcm5hbCAqL1xuZXhwb3J0IHZhciBlbXB0eVJlYWRvbmx5QXJyYXkgPSBbXTtcbi8qKiBAaW50ZXJuYWwgKi9cbmV4cG9ydCB2YXIgZW1wdHlSZWNvcmQgPSB7fTtcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8vIFJlY29yZFxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLyoqIEBpbnRlcm5hbCAqL1xuZXhwb3J0IHZhciBoYXMgPSBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5O1xuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLy8gTm9uRW1wdHlBcnJheVxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLyoqIEBpbnRlcm5hbCAqL1xuZXhwb3J0IHZhciBmcm9tUmVhZG9ubHlOb25FbXB0eUFycmF5ID0gZnVuY3Rpb24gKGFzKSB7IHJldHVybiBfX3NwcmVhZEFycmF5KFthc1swXV0sIGFzLnNsaWNlKDEpLCB0cnVlKTsgfTtcbi8qKiBAaW50ZXJuYWwgKi9cbmV4cG9ydCB2YXIgbGlmdE51bGxhYmxlID0gZnVuY3Rpb24gKEYpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGYsIG9uTnVsbGFibGUpIHtcbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhciBhID0gW107XG4gICAgICAgICAgICBmb3IgKHZhciBfaSA9IDA7IF9pIDwgYXJndW1lbnRzLmxlbmd0aDsgX2krKykge1xuICAgICAgICAgICAgICAgIGFbX2ldID0gYXJndW1lbnRzW19pXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciBvID0gZi5hcHBseSh2b2lkIDAsIGEpO1xuICAgICAgICAgICAgcmV0dXJuIEYuZnJvbUVpdGhlcihvID09IG51bGwgPyBsZWZ0KG9uTnVsbGFibGUuYXBwbHkodm9pZCAwLCBhKSkgOiByaWdodChvKSk7XG4gICAgICAgIH07XG4gICAgfTtcbn07XG4vKiogQGludGVybmFsICovXG5leHBvcnQgdmFyIGxpZnRPcHRpb24gPSBmdW5jdGlvbiAoRikge1xuICAgIHJldHVybiBmdW5jdGlvbiAoZiwgb25Ob25lKSB7XG4gICAgICAgIHJldHVybiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB2YXIgYSA9IFtdO1xuICAgICAgICAgICAgZm9yICh2YXIgX2kgPSAwOyBfaSA8IGFyZ3VtZW50cy5sZW5ndGg7IF9pKyspIHtcbiAgICAgICAgICAgICAgICBhW19pXSA9IGFyZ3VtZW50c1tfaV07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgbyA9IGYuYXBwbHkodm9pZCAwLCBhKTtcbiAgICAgICAgICAgIHJldHVybiBGLmZyb21FaXRoZXIoaXNOb25lKG8pID8gbGVmdChvbk5vbmUuYXBwbHkodm9pZCAwLCBhKSkgOiByaWdodChvLnZhbHVlKSk7XG4gICAgICAgIH07XG4gICAgfTtcbn07XG4vKiogQGludGVybmFsICovXG5leHBvcnQgdmFyIGZsYXRNYXBOdWxsYWJsZSA9IGZ1bmN0aW9uIChGLCBNKSB7XG4gICAgLyojX19QVVJFX18qLyByZXR1cm4gZHVhbCgzLCBmdW5jdGlvbiAoc2VsZiwgZiwgb25OdWxsYWJsZSkge1xuICAgICAgICByZXR1cm4gTS5mbGF0TWFwKHNlbGYsIGxpZnROdWxsYWJsZShGKShmLCBvbk51bGxhYmxlKSk7XG4gICAgfSk7XG59O1xuLyoqIEBpbnRlcm5hbCAqL1xuZXhwb3J0IHZhciBmbGF0TWFwT3B0aW9uID0gZnVuY3Rpb24gKEYsIE0pIHtcbiAgICAvKiNfX1BVUkVfXyovIHJldHVybiBkdWFsKDMsIGZ1bmN0aW9uIChzZWxmLCBmLCBvbk5vbmUpIHsgcmV0dXJuIE0uZmxhdE1hcChzZWxmLCBsaWZ0T3B0aW9uKEYpKGYsIG9uTm9uZSkpOyB9KTtcbn07XG4vKiogQGludGVybmFsICovXG5leHBvcnQgdmFyIGZsYXRNYXBFaXRoZXIgPSBmdW5jdGlvbiAoRiwgTSkge1xuICAgIC8qI19fUFVSRV9fKi8gcmV0dXJuIGR1YWwoMiwgZnVuY3Rpb24gKHNlbGYsIGYpIHtcbiAgICAgICAgcmV0dXJuIE0uZmxhdE1hcChzZWxmLCBmdW5jdGlvbiAoYSkgeyByZXR1cm4gRi5mcm9tRWl0aGVyKGYoYSkpOyB9KTtcbiAgICB9KTtcbn07XG4vKiogQGludGVybmFsICovXG5leHBvcnQgdmFyIGZsYXRNYXBJTyA9IGZ1bmN0aW9uIChGLCBNKSB7XG4gICAgLyojX19QVVJFX18qLyByZXR1cm4gZHVhbCgyLCBmdW5jdGlvbiAoc2VsZiwgZikge1xuICAgICAgICByZXR1cm4gTS5mbGF0TWFwKHNlbGYsIGZ1bmN0aW9uIChhKSB7IHJldHVybiBGLmZyb21JTyhmKGEpKTsgfSk7XG4gICAgfSk7XG59O1xuLyoqIEBpbnRlcm5hbCAqL1xuZXhwb3J0IHZhciBmbGF0TWFwVGFzayA9IGZ1bmN0aW9uIChGLCBNKSB7XG4gICAgLyojX19QVVJFX18qLyByZXR1cm4gZHVhbCgyLCBmdW5jdGlvbiAoc2VsZiwgZikge1xuICAgICAgICByZXR1cm4gTS5mbGF0TWFwKHNlbGYsIGZ1bmN0aW9uIChhKSB7IHJldHVybiBGLmZyb21UYXNrKGYoYSkpOyB9KTtcbiAgICB9KTtcbn07XG4vKiogQGludGVybmFsICovXG5leHBvcnQgdmFyIGZsYXRNYXBSZWFkZXIgPSBmdW5jdGlvbiAoRiwgTSkge1xuICAgIC8qI19fUFVSRV9fKi8gcmV0dXJuIGR1YWwoMiwgZnVuY3Rpb24gKHNlbGYsIGYpIHtcbiAgICAgICAgcmV0dXJuIE0uZmxhdE1hcChzZWxmLCBmdW5jdGlvbiAoYSkgeyByZXR1cm4gRi5mcm9tUmVhZGVyKGYoYSkpOyB9KTtcbiAgICB9KTtcbn07XG4iLAogICJ2YXIgX19zcHJlYWRBcnJheSA9ICh0aGlzICYmIHRoaXMuX19zcHJlYWRBcnJheSkgfHwgZnVuY3Rpb24gKHRvLCBmcm9tLCBwYWNrKSB7XG4gICAgaWYgKHBhY2sgfHwgYXJndW1lbnRzLmxlbmd0aCA9PT0gMikgZm9yICh2YXIgaSA9IDAsIGwgPSBmcm9tLmxlbmd0aCwgYXI7IGkgPCBsOyBpKyspIHtcbiAgICAgICAgaWYgKGFyIHx8ICEoaSBpbiBmcm9tKSkge1xuICAgICAgICAgICAgaWYgKCFhcikgYXIgPSBBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChmcm9tLCAwLCBpKTtcbiAgICAgICAgICAgIGFyW2ldID0gZnJvbVtpXTtcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gdG8uY29uY2F0KGFyIHx8IEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGZyb20pKTtcbn07XG5pbXBvcnQgeyBkdWFsIH0gZnJvbSAnLi9mdW5jdGlvbic7XG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vLyBPcHRpb25cbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8qKiBAaW50ZXJuYWwgKi9cbmV4cG9ydCB2YXIgaXNOb25lID0gZnVuY3Rpb24gKGZhKSB7IHJldHVybiBmYS5fdGFnID09PSAnTm9uZSc7IH07XG4vKiogQGludGVybmFsICovXG5leHBvcnQgdmFyIGlzU29tZSA9IGZ1bmN0aW9uIChmYSkgeyByZXR1cm4gZmEuX3RhZyA9PT0gJ1NvbWUnOyB9O1xuLyoqIEBpbnRlcm5hbCAqL1xuZXhwb3J0IHZhciBub25lID0geyBfdGFnOiAnTm9uZScgfTtcbi8qKiBAaW50ZXJuYWwgKi9cbmV4cG9ydCB2YXIgc29tZSA9IGZ1bmN0aW9uIChhKSB7IHJldHVybiAoeyBfdGFnOiAnU29tZScsIHZhbHVlOiBhIH0pOyB9O1xuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLy8gRWl0aGVyXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vKiogQGludGVybmFsICovXG5leHBvcnQgdmFyIGlzTGVmdCA9IGZ1bmN0aW9uIChtYSkgeyByZXR1cm4gbWEuX3RhZyA9PT0gJ0xlZnQnOyB9O1xuLyoqIEBpbnRlcm5hbCAqL1xuZXhwb3J0IHZhciBpc1JpZ2h0ID0gZnVuY3Rpb24gKG1hKSB7IHJldHVybiBtYS5fdGFnID09PSAnUmlnaHQnOyB9O1xuLyoqIEBpbnRlcm5hbCAqL1xuZXhwb3J0IHZhciBsZWZ0ID0gZnVuY3Rpb24gKGUpIHsgcmV0dXJuICh7IF90YWc6ICdMZWZ0JywgbGVmdDogZSB9KTsgfTtcbi8qKiBAaW50ZXJuYWwgKi9cbmV4cG9ydCB2YXIgcmlnaHQgPSBmdW5jdGlvbiAoYSkgeyByZXR1cm4gKHsgX3RhZzogJ1JpZ2h0JywgcmlnaHQ6IGEgfSk7IH07XG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vLyBSZWFkb25seU5vbkVtcHR5QXJyYXlcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8qKiBAaW50ZXJuYWwgKi9cbmV4cG9ydCB2YXIgc2luZ2xldG9uID0gZnVuY3Rpb24gKGEpIHsgcmV0dXJuIFthXTsgfTtcbi8qKiBAaW50ZXJuYWwgKi9cbmV4cG9ydCB2YXIgaXNOb25FbXB0eSA9IGZ1bmN0aW9uIChhcykgeyByZXR1cm4gYXMubGVuZ3RoID4gMDsgfTtcbi8qKiBAaW50ZXJuYWwgKi9cbmV4cG9ydCB2YXIgaGVhZCA9IGZ1bmN0aW9uIChhcykgeyByZXR1cm4gYXNbMF07IH07XG4vKiogQGludGVybmFsICovXG5leHBvcnQgdmFyIHRhaWwgPSBmdW5jdGlvbiAoYXMpIHsgcmV0dXJuIGFzLnNsaWNlKDEpOyB9O1xuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLy8gZW1wdHlcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8qKiBAaW50ZXJuYWwgKi9cbmV4cG9ydCB2YXIgZW1wdHlSZWFkb25seUFycmF5ID0gW107XG4vKiogQGludGVybmFsICovXG5leHBvcnQgdmFyIGVtcHR5UmVjb3JkID0ge307XG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vLyBSZWNvcmRcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8qKiBAaW50ZXJuYWwgKi9cbmV4cG9ydCB2YXIgaGFzID0gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eTtcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8vIE5vbkVtcHR5QXJyYXlcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8qKiBAaW50ZXJuYWwgKi9cbmV4cG9ydCB2YXIgZnJvbVJlYWRvbmx5Tm9uRW1wdHlBcnJheSA9IGZ1bmN0aW9uIChhcykgeyByZXR1cm4gX19zcHJlYWRBcnJheShbYXNbMF1dLCBhcy5zbGljZSgxKSwgdHJ1ZSk7IH07XG4vKiogQGludGVybmFsICovXG5leHBvcnQgdmFyIGxpZnROdWxsYWJsZSA9IGZ1bmN0aW9uIChGKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChmLCBvbk51bGxhYmxlKSB7XG4gICAgICAgIHJldHVybiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB2YXIgYSA9IFtdO1xuICAgICAgICAgICAgZm9yICh2YXIgX2kgPSAwOyBfaSA8IGFyZ3VtZW50cy5sZW5ndGg7IF9pKyspIHtcbiAgICAgICAgICAgICAgICBhW19pXSA9IGFyZ3VtZW50c1tfaV07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgbyA9IGYuYXBwbHkodm9pZCAwLCBhKTtcbiAgICAgICAgICAgIHJldHVybiBGLmZyb21FaXRoZXIobyA9PSBudWxsID8gbGVmdChvbk51bGxhYmxlLmFwcGx5KHZvaWQgMCwgYSkpIDogcmlnaHQobykpO1xuICAgICAgICB9O1xuICAgIH07XG59O1xuLyoqIEBpbnRlcm5hbCAqL1xuZXhwb3J0IHZhciBsaWZ0T3B0aW9uID0gZnVuY3Rpb24gKEYpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGYsIG9uTm9uZSkge1xuICAgICAgICByZXR1cm4gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIGEgPSBbXTtcbiAgICAgICAgICAgIGZvciAodmFyIF9pID0gMDsgX2kgPCBhcmd1bWVudHMubGVuZ3RoOyBfaSsrKSB7XG4gICAgICAgICAgICAgICAgYVtfaV0gPSBhcmd1bWVudHNbX2ldO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIG8gPSBmLmFwcGx5KHZvaWQgMCwgYSk7XG4gICAgICAgICAgICByZXR1cm4gRi5mcm9tRWl0aGVyKGlzTm9uZShvKSA/IGxlZnQob25Ob25lLmFwcGx5KHZvaWQgMCwgYSkpIDogcmlnaHQoby52YWx1ZSkpO1xuICAgICAgICB9O1xuICAgIH07XG59O1xuLyoqIEBpbnRlcm5hbCAqL1xuZXhwb3J0IHZhciBmbGF0TWFwTnVsbGFibGUgPSBmdW5jdGlvbiAoRiwgTSkge1xuICAgIC8qI19fUFVSRV9fKi8gcmV0dXJuIGR1YWwoMywgZnVuY3Rpb24gKHNlbGYsIGYsIG9uTnVsbGFibGUpIHtcbiAgICAgICAgcmV0dXJuIE0uZmxhdE1hcChzZWxmLCBsaWZ0TnVsbGFibGUoRikoZiwgb25OdWxsYWJsZSkpO1xuICAgIH0pO1xufTtcbi8qKiBAaW50ZXJuYWwgKi9cbmV4cG9ydCB2YXIgZmxhdE1hcE9wdGlvbiA9IGZ1bmN0aW9uIChGLCBNKSB7XG4gICAgLyojX19QVVJFX18qLyByZXR1cm4gZHVhbCgzLCBmdW5jdGlvbiAoc2VsZiwgZiwgb25Ob25lKSB7IHJldHVybiBNLmZsYXRNYXAoc2VsZiwgbGlmdE9wdGlvbihGKShmLCBvbk5vbmUpKTsgfSk7XG59O1xuLyoqIEBpbnRlcm5hbCAqL1xuZXhwb3J0IHZhciBmbGF0TWFwRWl0aGVyID0gZnVuY3Rpb24gKEYsIE0pIHtcbiAgICAvKiNfX1BVUkVfXyovIHJldHVybiBkdWFsKDIsIGZ1bmN0aW9uIChzZWxmLCBmKSB7XG4gICAgICAgIHJldHVybiBNLmZsYXRNYXAoc2VsZiwgZnVuY3Rpb24gKGEpIHsgcmV0dXJuIEYuZnJvbUVpdGhlcihmKGEpKTsgfSk7XG4gICAgfSk7XG59O1xuLyoqIEBpbnRlcm5hbCAqL1xuZXhwb3J0IHZhciBmbGF0TWFwSU8gPSBmdW5jdGlvbiAoRiwgTSkge1xuICAgIC8qI19fUFVSRV9fKi8gcmV0dXJuIGR1YWwoMiwgZnVuY3Rpb24gKHNlbGYsIGYpIHtcbiAgICAgICAgcmV0dXJuIE0uZmxhdE1hcChzZWxmLCBmdW5jdGlvbiAoYSkgeyByZXR1cm4gRi5mcm9tSU8oZihhKSk7IH0pO1xuICAgIH0pO1xufTtcbi8qKiBAaW50ZXJuYWwgKi9cbmV4cG9ydCB2YXIgZmxhdE1hcFRhc2sgPSBmdW5jdGlvbiAoRiwgTSkge1xuICAgIC8qI19fUFVSRV9fKi8gcmV0dXJuIGR1YWwoMiwgZnVuY3Rpb24gKHNlbGYsIGYpIHtcbiAgICAgICAgcmV0dXJuIE0uZmxhdE1hcChzZWxmLCBmdW5jdGlvbiAoYSkgeyByZXR1cm4gRi5mcm9tVGFzayhmKGEpKTsgfSk7XG4gICAgfSk7XG59O1xuLyoqIEBpbnRlcm5hbCAqL1xuZXhwb3J0IHZhciBmbGF0TWFwUmVhZGVyID0gZnVuY3Rpb24gKEYsIE0pIHtcbiAgICAvKiNfX1BVUkVfXyovIHJldHVybiBkdWFsKDIsIGZ1bmN0aW9uIChzZWxmLCBmKSB7XG4gICAgICAgIHJldHVybiBNLmZsYXRNYXAoc2VsZiwgZnVuY3Rpb24gKGEpIHsgcmV0dXJuIEYuZnJvbVJlYWRlcihmKGEpKTsgfSk7XG4gICAgfSk7XG59O1xuIiwKICAidmFyIF9fc3ByZWFkQXJyYXkgPSAodGhpcyAmJiB0aGlzLl9fc3ByZWFkQXJyYXkpIHx8IGZ1bmN0aW9uICh0bywgZnJvbSwgcGFjaykge1xuICAgIGlmIChwYWNrIHx8IGFyZ3VtZW50cy5sZW5ndGggPT09IDIpIGZvciAodmFyIGkgPSAwLCBsID0gZnJvbS5sZW5ndGgsIGFyOyBpIDwgbDsgaSsrKSB7XG4gICAgICAgIGlmIChhciB8fCAhKGkgaW4gZnJvbSkpIHtcbiAgICAgICAgICAgIGlmICghYXIpIGFyID0gQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoZnJvbSwgMCwgaSk7XG4gICAgICAgICAgICBhcltpXSA9IGZyb21baV07XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHRvLmNvbmNhdChhciB8fCBBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChmcm9tKSk7XG59O1xuaW1wb3J0IHsgZHVhbCB9IGZyb20gJy4vZnVuY3Rpb24nO1xuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLy8gT3B0aW9uXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vKiogQGludGVybmFsICovXG5leHBvcnQgdmFyIGlzTm9uZSA9IGZ1bmN0aW9uIChmYSkgeyByZXR1cm4gZmEuX3RhZyA9PT0gJ05vbmUnOyB9O1xuLyoqIEBpbnRlcm5hbCAqL1xuZXhwb3J0IHZhciBpc1NvbWUgPSBmdW5jdGlvbiAoZmEpIHsgcmV0dXJuIGZhLl90YWcgPT09ICdTb21lJzsgfTtcbi8qKiBAaW50ZXJuYWwgKi9cbmV4cG9ydCB2YXIgbm9uZSA9IHsgX3RhZzogJ05vbmUnIH07XG4vKiogQGludGVybmFsICovXG5leHBvcnQgdmFyIHNvbWUgPSBmdW5jdGlvbiAoYSkgeyByZXR1cm4gKHsgX3RhZzogJ1NvbWUnLCB2YWx1ZTogYSB9KTsgfTtcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8vIEVpdGhlclxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLyoqIEBpbnRlcm5hbCAqL1xuZXhwb3J0IHZhciBpc0xlZnQgPSBmdW5jdGlvbiAobWEpIHsgcmV0dXJuIG1hLl90YWcgPT09ICdMZWZ0JzsgfTtcbi8qKiBAaW50ZXJuYWwgKi9cbmV4cG9ydCB2YXIgaXNSaWdodCA9IGZ1bmN0aW9uIChtYSkgeyByZXR1cm4gbWEuX3RhZyA9PT0gJ1JpZ2h0JzsgfTtcbi8qKiBAaW50ZXJuYWwgKi9cbmV4cG9ydCB2YXIgbGVmdCA9IGZ1bmN0aW9uIChlKSB7IHJldHVybiAoeyBfdGFnOiAnTGVmdCcsIGxlZnQ6IGUgfSk7IH07XG4vKiogQGludGVybmFsICovXG5leHBvcnQgdmFyIHJpZ2h0ID0gZnVuY3Rpb24gKGEpIHsgcmV0dXJuICh7IF90YWc6ICdSaWdodCcsIHJpZ2h0OiBhIH0pOyB9O1xuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLy8gUmVhZG9ubHlOb25FbXB0eUFycmF5XG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vKiogQGludGVybmFsICovXG5leHBvcnQgdmFyIHNpbmdsZXRvbiA9IGZ1bmN0aW9uIChhKSB7IHJldHVybiBbYV07IH07XG4vKiogQGludGVybmFsICovXG5leHBvcnQgdmFyIGlzTm9uRW1wdHkgPSBmdW5jdGlvbiAoYXMpIHsgcmV0dXJuIGFzLmxlbmd0aCA+IDA7IH07XG4vKiogQGludGVybmFsICovXG5leHBvcnQgdmFyIGhlYWQgPSBmdW5jdGlvbiAoYXMpIHsgcmV0dXJuIGFzWzBdOyB9O1xuLyoqIEBpbnRlcm5hbCAqL1xuZXhwb3J0IHZhciB0YWlsID0gZnVuY3Rpb24gKGFzKSB7IHJldHVybiBhcy5zbGljZSgxKTsgfTtcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8vIGVtcHR5XG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vKiogQGludGVybmFsICovXG5leHBvcnQgdmFyIGVtcHR5UmVhZG9ubHlBcnJheSA9IFtdO1xuLyoqIEBpbnRlcm5hbCAqL1xuZXhwb3J0IHZhciBlbXB0eVJlY29yZCA9IHt9O1xuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLy8gUmVjb3JkXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vKiogQGludGVybmFsICovXG5leHBvcnQgdmFyIGhhcyA9IE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHk7XG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vLyBOb25FbXB0eUFycmF5XG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vKiogQGludGVybmFsICovXG5leHBvcnQgdmFyIGZyb21SZWFkb25seU5vbkVtcHR5QXJyYXkgPSBmdW5jdGlvbiAoYXMpIHsgcmV0dXJuIF9fc3ByZWFkQXJyYXkoW2FzWzBdXSwgYXMuc2xpY2UoMSksIHRydWUpOyB9O1xuLyoqIEBpbnRlcm5hbCAqL1xuZXhwb3J0IHZhciBsaWZ0TnVsbGFibGUgPSBmdW5jdGlvbiAoRikge1xuICAgIHJldHVybiBmdW5jdGlvbiAoZiwgb25OdWxsYWJsZSkge1xuICAgICAgICByZXR1cm4gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIGEgPSBbXTtcbiAgICAgICAgICAgIGZvciAodmFyIF9pID0gMDsgX2kgPCBhcmd1bWVudHMubGVuZ3RoOyBfaSsrKSB7XG4gICAgICAgICAgICAgICAgYVtfaV0gPSBhcmd1bWVudHNbX2ldO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIG8gPSBmLmFwcGx5KHZvaWQgMCwgYSk7XG4gICAgICAgICAgICByZXR1cm4gRi5mcm9tRWl0aGVyKG8gPT0gbnVsbCA/IGxlZnQob25OdWxsYWJsZS5hcHBseSh2b2lkIDAsIGEpKSA6IHJpZ2h0KG8pKTtcbiAgICAgICAgfTtcbiAgICB9O1xufTtcbi8qKiBAaW50ZXJuYWwgKi9cbmV4cG9ydCB2YXIgbGlmdE9wdGlvbiA9IGZ1bmN0aW9uIChGKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChmLCBvbk5vbmUpIHtcbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhciBhID0gW107XG4gICAgICAgICAgICBmb3IgKHZhciBfaSA9IDA7IF9pIDwgYXJndW1lbnRzLmxlbmd0aDsgX2krKykge1xuICAgICAgICAgICAgICAgIGFbX2ldID0gYXJndW1lbnRzW19pXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciBvID0gZi5hcHBseSh2b2lkIDAsIGEpO1xuICAgICAgICAgICAgcmV0dXJuIEYuZnJvbUVpdGhlcihpc05vbmUobykgPyBsZWZ0KG9uTm9uZS5hcHBseSh2b2lkIDAsIGEpKSA6IHJpZ2h0KG8udmFsdWUpKTtcbiAgICAgICAgfTtcbiAgICB9O1xufTtcbi8qKiBAaW50ZXJuYWwgKi9cbmV4cG9ydCB2YXIgZmxhdE1hcE51bGxhYmxlID0gZnVuY3Rpb24gKEYsIE0pIHtcbiAgICAvKiNfX1BVUkVfXyovIHJldHVybiBkdWFsKDMsIGZ1bmN0aW9uIChzZWxmLCBmLCBvbk51bGxhYmxlKSB7XG4gICAgICAgIHJldHVybiBNLmZsYXRNYXAoc2VsZiwgbGlmdE51bGxhYmxlKEYpKGYsIG9uTnVsbGFibGUpKTtcbiAgICB9KTtcbn07XG4vKiogQGludGVybmFsICovXG5leHBvcnQgdmFyIGZsYXRNYXBPcHRpb24gPSBmdW5jdGlvbiAoRiwgTSkge1xuICAgIC8qI19fUFVSRV9fKi8gcmV0dXJuIGR1YWwoMywgZnVuY3Rpb24gKHNlbGYsIGYsIG9uTm9uZSkgeyByZXR1cm4gTS5mbGF0TWFwKHNlbGYsIGxpZnRPcHRpb24oRikoZiwgb25Ob25lKSk7IH0pO1xufTtcbi8qKiBAaW50ZXJuYWwgKi9cbmV4cG9ydCB2YXIgZmxhdE1hcEVpdGhlciA9IGZ1bmN0aW9uIChGLCBNKSB7XG4gICAgLyojX19QVVJFX18qLyByZXR1cm4gZHVhbCgyLCBmdW5jdGlvbiAoc2VsZiwgZikge1xuICAgICAgICByZXR1cm4gTS5mbGF0TWFwKHNlbGYsIGZ1bmN0aW9uIChhKSB7IHJldHVybiBGLmZyb21FaXRoZXIoZihhKSk7IH0pO1xuICAgIH0pO1xufTtcbi8qKiBAaW50ZXJuYWwgKi9cbmV4cG9ydCB2YXIgZmxhdE1hcElPID0gZnVuY3Rpb24gKEYsIE0pIHtcbiAgICAvKiNfX1BVUkVfXyovIHJldHVybiBkdWFsKDIsIGZ1bmN0aW9uIChzZWxmLCBmKSB7XG4gICAgICAgIHJldHVybiBNLmZsYXRNYXAoc2VsZiwgZnVuY3Rpb24gKGEpIHsgcmV0dXJuIEYuZnJvbUlPKGYoYSkpOyB9KTtcbiAgICB9KTtcbn07XG4vKiogQGludGVybmFsICovXG5leHBvcnQgdmFyIGZsYXRNYXBUYXNrID0gZnVuY3Rpb24gKEYsIE0pIHtcbiAgICAvKiNfX1BVUkVfXyovIHJldHVybiBkdWFsKDIsIGZ1bmN0aW9uIChzZWxmLCBmKSB7XG4gICAgICAgIHJldHVybiBNLmZsYXRNYXAoc2VsZiwgZnVuY3Rpb24gKGEpIHsgcmV0dXJuIEYuZnJvbVRhc2soZihhKSk7IH0pO1xuICAgIH0pO1xufTtcbi8qKiBAaW50ZXJuYWwgKi9cbmV4cG9ydCB2YXIgZmxhdE1hcFJlYWRlciA9IGZ1bmN0aW9uIChGLCBNKSB7XG4gICAgLyojX19QVVJFX18qLyByZXR1cm4gZHVhbCgyLCBmdW5jdGlvbiAoc2VsZiwgZikge1xuICAgICAgICByZXR1cm4gTS5mbGF0TWFwKHNlbGYsIGZ1bmN0aW9uIChhKSB7IHJldHVybiBGLmZyb21SZWFkZXIoZihhKSk7IH0pO1xuICAgIH0pO1xufTtcbiIsCiAgIi8qKlxuICogVGhlIGBBcHBseWAgY2xhc3MgcHJvdmlkZXMgdGhlIGBhcGAgd2hpY2ggaXMgdXNlZCB0byBhcHBseSBhIGZ1bmN0aW9uIHRvIGFuIGFyZ3VtZW50IHVuZGVyIGEgdHlwZSBjb25zdHJ1Y3Rvci5cbiAqXG4gKiBgQXBwbHlgIGNhbiBiZSB1c2VkIHRvIGxpZnQgZnVuY3Rpb25zIG9mIHR3byBvciBtb3JlIGFyZ3VtZW50cyB0byB3b3JrIG9uIHZhbHVlcyB3cmFwcGVkIHdpdGggdGhlIHR5cGUgY29uc3RydWN0b3JcbiAqIGBmYC5cbiAqXG4gKiBJbnN0YW5jZXMgbXVzdCBzYXRpc2Z5IHRoZSBmb2xsb3dpbmcgbGF3IGluIGFkZGl0aW9uIHRvIHRoZSBgRnVuY3RvcmAgbGF3czpcbiAqXG4gKiAxLiBBc3NvY2lhdGl2ZSBjb21wb3NpdGlvbjogYEYuYXAoRi5hcChGLm1hcChmYmMsIGJjID0+IGFiID0+IGEgPT4gYmMoYWIoYSkpKSwgZmFiKSwgZmEpIDwtPiBGLmFwKGZiYywgRi5hcChmYWIsIGZhKSlgXG4gKlxuICogRm9ybWFsbHksIGBBcHBseWAgcmVwcmVzZW50cyBhIHN0cm9uZyBsYXggc2VtaS1tb25vaWRhbCBlbmRvZnVuY3Rvci5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0ICogYXMgTyBmcm9tICdmcC10cy9PcHRpb24nXG4gKiBpbXBvcnQgeyBwaXBlIH0gZnJvbSAnZnAtdHMvZnVuY3Rpb24nXG4gKlxuICogY29uc3QgZiA9IChhOiBzdHJpbmcpID0+IChiOiBudW1iZXIpID0+IChjOiBib29sZWFuKSA9PiBhICsgU3RyaW5nKGIpICsgU3RyaW5nKGMpXG4gKiBjb25zdCBmYTogTy5PcHRpb248c3RyaW5nPiA9IE8uc29tZSgncycpXG4gKiBjb25zdCBmYjogTy5PcHRpb248bnVtYmVyPiA9IE8uc29tZSgxKVxuICogY29uc3QgZmM6IE8uT3B0aW9uPGJvb2xlYW4+ID0gTy5zb21lKHRydWUpXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChcbiAqICAgcGlwZShcbiAqICAgICAvLyBsaWZ0IGEgZnVuY3Rpb25cbiAqICAgICBPLnNvbWUoZiksXG4gKiAgICAgLy8gYXBwbHkgdGhlIGZpcnN0IGFyZ3VtZW50XG4gKiAgICAgTy5hcChmYSksXG4gKiAgICAgLy8gYXBwbHkgdGhlIHNlY29uZCBhcmd1bWVudFxuICogICAgIE8uYXAoZmIpLFxuICogICAgIC8vIGFwcGx5IHRoZSB0aGlyZCBhcmd1bWVudFxuICogICAgIE8uYXAoZmMpXG4gKiAgICksXG4gKiAgIE8uc29tZSgnczF0cnVlJylcbiAqIClcbiAqXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuaW1wb3J0IHsgdHVwbGUgfSBmcm9tICcuL2Z1bmN0aW9uJztcbmltcG9ydCAqIGFzIF8gZnJvbSAnLi9pbnRlcm5hbCc7XG5leHBvcnQgZnVuY3Rpb24gYXAoRiwgRykge1xuICAgIHJldHVybiBmdW5jdGlvbiAoZmEpIHtcbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIChmYWIpIHtcbiAgICAgICAgICAgIHJldHVybiBGLmFwKEYubWFwKGZhYiwgZnVuY3Rpb24gKGdhYikgeyByZXR1cm4gZnVuY3Rpb24gKGdhKSB7IHJldHVybiBHLmFwKGdhYiwgZ2EpOyB9OyB9KSwgZmEpO1xuICAgICAgICB9O1xuICAgIH07XG59XG5leHBvcnQgZnVuY3Rpb24gYXBGaXJzdChBKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChzZWNvbmQpIHsgcmV0dXJuIGZ1bmN0aW9uIChmaXJzdCkge1xuICAgICAgICByZXR1cm4gQS5hcChBLm1hcChmaXJzdCwgZnVuY3Rpb24gKGEpIHsgcmV0dXJuIGZ1bmN0aW9uICgpIHsgcmV0dXJuIGE7IH07IH0pLCBzZWNvbmQpO1xuICAgIH07IH07XG59XG5leHBvcnQgZnVuY3Rpb24gYXBTZWNvbmQoQSkge1xuICAgIHJldHVybiBmdW5jdGlvbiAoc2Vjb25kKSB7XG4gICAgICAgIHJldHVybiBmdW5jdGlvbiAoZmlyc3QpIHtcbiAgICAgICAgICAgIHJldHVybiBBLmFwKEEubWFwKGZpcnN0LCBmdW5jdGlvbiAoKSB7IHJldHVybiBmdW5jdGlvbiAoYikgeyByZXR1cm4gYjsgfTsgfSksIHNlY29uZCk7XG4gICAgICAgIH07XG4gICAgfTtcbn1cbmV4cG9ydCBmdW5jdGlvbiBhcFMoRikge1xuICAgIHJldHVybiBmdW5jdGlvbiAobmFtZSwgZmIpIHtcbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIChmYSkge1xuICAgICAgICAgICAgcmV0dXJuIEYuYXAoRi5tYXAoZmEsIGZ1bmN0aW9uIChhKSB7IHJldHVybiBmdW5jdGlvbiAoYikge1xuICAgICAgICAgICAgICAgIHZhciBfYTtcbiAgICAgICAgICAgICAgICByZXR1cm4gT2JqZWN0LmFzc2lnbih7fSwgYSwgKF9hID0ge30sIF9hW25hbWVdID0gYiwgX2EpKTtcbiAgICAgICAgICAgIH07IH0pLCBmYik7XG4gICAgICAgIH07XG4gICAgfTtcbn1cbmV4cG9ydCBmdW5jdGlvbiBnZXRBcHBseVNlbWlncm91cChGKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChTKSB7IHJldHVybiAoe1xuICAgICAgICBjb25jYXQ6IGZ1bmN0aW9uIChmaXJzdCwgc2Vjb25kKSB7XG4gICAgICAgICAgICByZXR1cm4gRi5hcChGLm1hcChmaXJzdCwgZnVuY3Rpb24gKHgpIHsgcmV0dXJuIGZ1bmN0aW9uICh5KSB7IHJldHVybiBTLmNvbmNhdCh4LCB5KTsgfTsgfSksIHNlY29uZCk7XG4gICAgICAgIH1cbiAgICB9KTsgfTtcbn1cbmZ1bmN0aW9uIGN1cnJpZWQoZiwgbiwgYWNjKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uICh4KSB7XG4gICAgICAgIHZhciBjb21iaW5lZCA9IEFycmF5KGFjYy5sZW5ndGggKyAxKTtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBhY2MubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIGNvbWJpbmVkW2ldID0gYWNjW2ldO1xuICAgICAgICB9XG4gICAgICAgIGNvbWJpbmVkW2FjYy5sZW5ndGhdID0geDtcbiAgICAgICAgcmV0dXJuIG4gPT09IDAgPyBmLmFwcGx5KG51bGwsIGNvbWJpbmVkKSA6IGN1cnJpZWQoZiwgbiAtIDEsIGNvbWJpbmVkKTtcbiAgICB9O1xufVxudmFyIHR1cGxlQ29uc3RydWN0b3JzID0ge1xuICAgIDE6IGZ1bmN0aW9uIChhKSB7IHJldHVybiBbYV07IH0sXG4gICAgMjogZnVuY3Rpb24gKGEpIHsgcmV0dXJuIGZ1bmN0aW9uIChiKSB7IHJldHVybiBbYSwgYl07IH07IH0sXG4gICAgMzogZnVuY3Rpb24gKGEpIHsgcmV0dXJuIGZ1bmN0aW9uIChiKSB7IHJldHVybiBmdW5jdGlvbiAoYykgeyByZXR1cm4gW2EsIGIsIGNdOyB9OyB9OyB9LFxuICAgIDQ6IGZ1bmN0aW9uIChhKSB7IHJldHVybiBmdW5jdGlvbiAoYikgeyByZXR1cm4gZnVuY3Rpb24gKGMpIHsgcmV0dXJuIGZ1bmN0aW9uIChkKSB7IHJldHVybiBbYSwgYiwgYywgZF07IH07IH07IH07IH0sXG4gICAgNTogZnVuY3Rpb24gKGEpIHsgcmV0dXJuIGZ1bmN0aW9uIChiKSB7IHJldHVybiBmdW5jdGlvbiAoYykgeyByZXR1cm4gZnVuY3Rpb24gKGQpIHsgcmV0dXJuIGZ1bmN0aW9uIChlKSB7IHJldHVybiBbYSwgYiwgYywgZCwgZV07IH07IH07IH07IH07IH1cbn07XG5mdW5jdGlvbiBnZXRUdXBsZUNvbnN0cnVjdG9yKGxlbikge1xuICAgIGlmICghXy5oYXMuY2FsbCh0dXBsZUNvbnN0cnVjdG9ycywgbGVuKSkge1xuICAgICAgICB0dXBsZUNvbnN0cnVjdG9yc1tsZW5dID0gY3VycmllZCh0dXBsZSwgbGVuIC0gMSwgW10pO1xuICAgIH1cbiAgICByZXR1cm4gdHVwbGVDb25zdHJ1Y3RvcnNbbGVuXTtcbn1cbmV4cG9ydCBmdW5jdGlvbiBzZXF1ZW5jZVQoRikge1xuICAgIHJldHVybiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBhcmdzID0gW107XG4gICAgICAgIGZvciAodmFyIF9pID0gMDsgX2kgPCBhcmd1bWVudHMubGVuZ3RoOyBfaSsrKSB7XG4gICAgICAgICAgICBhcmdzW19pXSA9IGFyZ3VtZW50c1tfaV07XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGxlbiA9IGFyZ3MubGVuZ3RoO1xuICAgICAgICB2YXIgZiA9IGdldFR1cGxlQ29uc3RydWN0b3IobGVuKTtcbiAgICAgICAgdmFyIGZhcyA9IEYubWFwKGFyZ3NbMF0sIGYpO1xuICAgICAgICBmb3IgKHZhciBpID0gMTsgaSA8IGxlbjsgaSsrKSB7XG4gICAgICAgICAgICBmYXMgPSBGLmFwKGZhcywgYXJnc1tpXSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGZhcztcbiAgICB9O1xufVxuZnVuY3Rpb24gZ2V0UmVjb3JkQ29uc3RydWN0b3Ioa2V5cykge1xuICAgIHZhciBsZW4gPSBrZXlzLmxlbmd0aDtcbiAgICBzd2l0Y2ggKGxlbikge1xuICAgICAgICBjYXNlIDE6XG4gICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24gKGEpIHtcbiAgICAgICAgICAgICAgICB2YXIgX2E7XG4gICAgICAgICAgICAgICAgcmV0dXJuIChfYSA9IHt9LCBfYVtrZXlzWzBdXSA9IGEsIF9hKTtcbiAgICAgICAgICAgIH07XG4gICAgICAgIGNhc2UgMjpcbiAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbiAoYSkgeyByZXR1cm4gZnVuY3Rpb24gKGIpIHtcbiAgICAgICAgICAgICAgICB2YXIgX2E7XG4gICAgICAgICAgICAgICAgcmV0dXJuIChfYSA9IHt9LCBfYVtrZXlzWzBdXSA9IGEsIF9hW2tleXNbMV1dID0gYiwgX2EpO1xuICAgICAgICAgICAgfTsgfTtcbiAgICAgICAgY2FzZSAzOlxuICAgICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIChhKSB7IHJldHVybiBmdW5jdGlvbiAoYikgeyByZXR1cm4gZnVuY3Rpb24gKGMpIHtcbiAgICAgICAgICAgICAgICB2YXIgX2E7XG4gICAgICAgICAgICAgICAgcmV0dXJuIChfYSA9IHt9LCBfYVtrZXlzWzBdXSA9IGEsIF9hW2tleXNbMV1dID0gYiwgX2Fba2V5c1syXV0gPSBjLCBfYSk7XG4gICAgICAgICAgICB9OyB9OyB9O1xuICAgICAgICBjYXNlIDQ6XG4gICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24gKGEpIHsgcmV0dXJuIGZ1bmN0aW9uIChiKSB7IHJldHVybiBmdW5jdGlvbiAoYykgeyByZXR1cm4gZnVuY3Rpb24gKGQpIHtcbiAgICAgICAgICAgICAgICB2YXIgX2E7XG4gICAgICAgICAgICAgICAgcmV0dXJuIChfYSA9IHt9LFxuICAgICAgICAgICAgICAgICAgICBfYVtrZXlzWzBdXSA9IGEsXG4gICAgICAgICAgICAgICAgICAgIF9hW2tleXNbMV1dID0gYixcbiAgICAgICAgICAgICAgICAgICAgX2Fba2V5c1syXV0gPSBjLFxuICAgICAgICAgICAgICAgICAgICBfYVtrZXlzWzNdXSA9IGQsXG4gICAgICAgICAgICAgICAgICAgIF9hKTtcbiAgICAgICAgICAgIH07IH07IH07IH07XG4gICAgICAgIGNhc2UgNTpcbiAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbiAoYSkgeyByZXR1cm4gZnVuY3Rpb24gKGIpIHsgcmV0dXJuIGZ1bmN0aW9uIChjKSB7IHJldHVybiBmdW5jdGlvbiAoZCkgeyByZXR1cm4gZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgICAgICAgICB2YXIgX2E7XG4gICAgICAgICAgICAgICAgcmV0dXJuIChfYSA9IHt9LFxuICAgICAgICAgICAgICAgICAgICBfYVtrZXlzWzBdXSA9IGEsXG4gICAgICAgICAgICAgICAgICAgIF9hW2tleXNbMV1dID0gYixcbiAgICAgICAgICAgICAgICAgICAgX2Fba2V5c1syXV0gPSBjLFxuICAgICAgICAgICAgICAgICAgICBfYVtrZXlzWzNdXSA9IGQsXG4gICAgICAgICAgICAgICAgICAgIF9hW2tleXNbNF1dID0gZSxcbiAgICAgICAgICAgICAgICAgICAgX2EpO1xuICAgICAgICAgICAgfTsgfTsgfTsgfTsgfTtcbiAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgIHJldHVybiBjdXJyaWVkKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICB2YXIgYXJncyA9IFtdO1xuICAgICAgICAgICAgICAgIGZvciAodmFyIF9pID0gMDsgX2kgPCBhcmd1bWVudHMubGVuZ3RoOyBfaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgIGFyZ3NbX2ldID0gYXJndW1lbnRzW19pXTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdmFyIHIgPSB7fTtcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGxlbjsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgIHJba2V5c1tpXV0gPSBhcmdzW2ldO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByZXR1cm4gcjtcbiAgICAgICAgICAgIH0sIGxlbiAtIDEsIFtdKTtcbiAgICB9XG59XG5leHBvcnQgZnVuY3Rpb24gc2VxdWVuY2VTKEYpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKHIpIHtcbiAgICAgICAgdmFyIGtleXMgPSBPYmplY3Qua2V5cyhyKTtcbiAgICAgICAgdmFyIGxlbiA9IGtleXMubGVuZ3RoO1xuICAgICAgICB2YXIgZiA9IGdldFJlY29yZENvbnN0cnVjdG9yKGtleXMpO1xuICAgICAgICB2YXIgZnIgPSBGLm1hcChyW2tleXNbMF1dLCBmKTtcbiAgICAgICAgZm9yICh2YXIgaSA9IDE7IGkgPCBsZW47IGkrKykge1xuICAgICAgICAgICAgZnIgPSBGLmFwKGZyLCByW2tleXNbaV1dKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gZnI7XG4gICAgfTtcbn1cbiIsCiAgIi8qKlxuICogQSBgRnVuY3RvcmAgaXMgYSB0eXBlIGNvbnN0cnVjdG9yIHdoaWNoIHN1cHBvcnRzIGEgbWFwcGluZyBvcGVyYXRpb24gYG1hcGAuXG4gKlxuICogYG1hcGAgY2FuIGJlIHVzZWQgdG8gdHVybiBmdW5jdGlvbnMgYGEgLT4gYmAgaW50byBmdW5jdGlvbnMgYGYgYSAtPiBmIGJgIHdob3NlIGFyZ3VtZW50IGFuZCByZXR1cm4gdHlwZXMgdXNlIHRoZSB0eXBlXG4gKiBjb25zdHJ1Y3RvciBgZmAgdG8gcmVwcmVzZW50IHNvbWUgY29tcHV0YXRpb25hbCBjb250ZXh0LlxuICpcbiAqIEluc3RhbmNlcyBtdXN0IHNhdGlzZnkgdGhlIGZvbGxvd2luZyBsYXdzOlxuICpcbiAqIDEuIElkZW50aXR5OiBgRi5tYXAoZmEsIGEgPT4gYSkgPC0+IGZhYFxuICogMi4gQ29tcG9zaXRpb246IGBGLm1hcChmYSwgYSA9PiBiYyhhYihhKSkpIDwtPiBGLm1hcChGLm1hcChmYSwgYWIpLCBiYylgXG4gKlxuICogQHNpbmNlIDIuMC4wXG4gKi9cbmltcG9ydCB7IHBpcGUgfSBmcm9tICcuL2Z1bmN0aW9uJztcbmV4cG9ydCBmdW5jdGlvbiBtYXAoRiwgRykge1xuICAgIHJldHVybiBmdW5jdGlvbiAoZikgeyByZXR1cm4gZnVuY3Rpb24gKGZhKSB7IHJldHVybiBGLm1hcChmYSwgZnVuY3Rpb24gKGdhKSB7IHJldHVybiBHLm1hcChnYSwgZik7IH0pOyB9OyB9O1xufVxuZXhwb3J0IGZ1bmN0aW9uIGZsYXAoRikge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYSkgeyByZXR1cm4gZnVuY3Rpb24gKGZhYikgeyByZXR1cm4gRi5tYXAoZmFiLCBmdW5jdGlvbiAoZikgeyByZXR1cm4gZihhKTsgfSk7IH07IH07XG59XG5leHBvcnQgZnVuY3Rpb24gYmluZFRvKEYpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKG5hbWUpIHsgcmV0dXJuIGZ1bmN0aW9uIChmYSkgeyByZXR1cm4gRi5tYXAoZmEsIGZ1bmN0aW9uIChhKSB7XG4gICAgICAgIHZhciBfYTtcbiAgICAgICAgcmV0dXJuIChfYSA9IHt9LCBfYVtuYW1lXSA9IGEsIF9hKTtcbiAgICB9KTsgfTsgfTtcbn1cbmZ1bmN0aW9uIGxldF8oRikge1xuICAgIHJldHVybiBmdW5jdGlvbiAobmFtZSwgZikgeyByZXR1cm4gZnVuY3Rpb24gKGZhKSB7IHJldHVybiBGLm1hcChmYSwgZnVuY3Rpb24gKGEpIHtcbiAgICAgICAgdmFyIF9hO1xuICAgICAgICByZXR1cm4gT2JqZWN0LmFzc2lnbih7fSwgYSwgKF9hID0ge30sIF9hW25hbWVdID0gZihhKSwgX2EpKTtcbiAgICB9KTsgfTsgfTtcbn1cbmV4cG9ydCB7IFxuLyoqXG4gKiBAc2luY2UgMi4xMy4wXG4gKi9cbmxldF8gYXMgbGV0IH07XG4vKiogQGRlcHJlY2F0ZWQgKi9cbmV4cG9ydCBmdW5jdGlvbiBnZXRGdW5jdG9yQ29tcG9zaXRpb24oRiwgRykge1xuICAgIHZhciBfbWFwID0gbWFwKEYsIEcpO1xuICAgIHJldHVybiB7XG4gICAgICAgIG1hcDogZnVuY3Rpb24gKGZnYSwgZikgeyByZXR1cm4gcGlwZShmZ2EsIF9tYXAoZikpOyB9XG4gICAgfTtcbn1cbi8qKiBAaW50ZXJuYWwgKi9cbmV4cG9ydCBmdW5jdGlvbiBhcyhGKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChzZWxmLCBiKSB7IHJldHVybiBGLm1hcChzZWxmLCBmdW5jdGlvbiAoKSB7IHJldHVybiBiOyB9KTsgfTtcbn1cbi8qKiBAaW50ZXJuYWwgKi9cbmV4cG9ydCBmdW5jdGlvbiBhc1VuaXQoRikge1xuICAgIHZhciBhc00gPSBhcyhGKTtcbiAgICByZXR1cm4gZnVuY3Rpb24gKHNlbGYpIHsgcmV0dXJuIGFzTShzZWxmLCB1bmRlZmluZWQpOyB9O1xufVxuIiwKICAiLyoqXG4gKiBBIGBGdW5jdG9yYCBpcyBhIHR5cGUgY29uc3RydWN0b3Igd2hpY2ggc3VwcG9ydHMgYSBtYXBwaW5nIG9wZXJhdGlvbiBgbWFwYC5cbiAqXG4gKiBgbWFwYCBjYW4gYmUgdXNlZCB0byB0dXJuIGZ1bmN0aW9ucyBgYSAtPiBiYCBpbnRvIGZ1bmN0aW9ucyBgZiBhIC0+IGYgYmAgd2hvc2UgYXJndW1lbnQgYW5kIHJldHVybiB0eXBlcyB1c2UgdGhlIHR5cGVcbiAqIGNvbnN0cnVjdG9yIGBmYCB0byByZXByZXNlbnQgc29tZSBjb21wdXRhdGlvbmFsIGNvbnRleHQuXG4gKlxuICogSW5zdGFuY2VzIG11c3Qgc2F0aXNmeSB0aGUgZm9sbG93aW5nIGxhd3M6XG4gKlxuICogMS4gSWRlbnRpdHk6IGBGLm1hcChmYSwgYSA9PiBhKSA8LT4gZmFgXG4gKiAyLiBDb21wb3NpdGlvbjogYEYubWFwKGZhLCBhID0+IGJjKGFiKGEpKSkgPC0+IEYubWFwKEYubWFwKGZhLCBhYiksIGJjKWBcbiAqXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuaW1wb3J0IHsgcGlwZSB9IGZyb20gJy4vZnVuY3Rpb24nO1xuZXhwb3J0IGZ1bmN0aW9uIG1hcChGLCBHKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChmKSB7IHJldHVybiBmdW5jdGlvbiAoZmEpIHsgcmV0dXJuIEYubWFwKGZhLCBmdW5jdGlvbiAoZ2EpIHsgcmV0dXJuIEcubWFwKGdhLCBmKTsgfSk7IH07IH07XG59XG5leHBvcnQgZnVuY3Rpb24gZmxhcChGKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhKSB7IHJldHVybiBmdW5jdGlvbiAoZmFiKSB7IHJldHVybiBGLm1hcChmYWIsIGZ1bmN0aW9uIChmKSB7IHJldHVybiBmKGEpOyB9KTsgfTsgfTtcbn1cbmV4cG9ydCBmdW5jdGlvbiBiaW5kVG8oRikge1xuICAgIHJldHVybiBmdW5jdGlvbiAobmFtZSkgeyByZXR1cm4gZnVuY3Rpb24gKGZhKSB7IHJldHVybiBGLm1hcChmYSwgZnVuY3Rpb24gKGEpIHtcbiAgICAgICAgdmFyIF9hO1xuICAgICAgICByZXR1cm4gKF9hID0ge30sIF9hW25hbWVdID0gYSwgX2EpO1xuICAgIH0pOyB9OyB9O1xufVxuZnVuY3Rpb24gbGV0XyhGKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChuYW1lLCBmKSB7IHJldHVybiBmdW5jdGlvbiAoZmEpIHsgcmV0dXJuIEYubWFwKGZhLCBmdW5jdGlvbiAoYSkge1xuICAgICAgICB2YXIgX2E7XG4gICAgICAgIHJldHVybiBPYmplY3QuYXNzaWduKHt9LCBhLCAoX2EgPSB7fSwgX2FbbmFtZV0gPSBmKGEpLCBfYSkpO1xuICAgIH0pOyB9OyB9O1xufVxuZXhwb3J0IHsgXG4vKipcbiAqIEBzaW5jZSAyLjEzLjBcbiAqL1xubGV0XyBhcyBsZXQgfTtcbi8qKiBAZGVwcmVjYXRlZCAqL1xuZXhwb3J0IGZ1bmN0aW9uIGdldEZ1bmN0b3JDb21wb3NpdGlvbihGLCBHKSB7XG4gICAgdmFyIF9tYXAgPSBtYXAoRiwgRyk7XG4gICAgcmV0dXJuIHtcbiAgICAgICAgbWFwOiBmdW5jdGlvbiAoZmdhLCBmKSB7IHJldHVybiBwaXBlKGZnYSwgX21hcChmKSk7IH1cbiAgICB9O1xufVxuLyoqIEBpbnRlcm5hbCAqL1xuZXhwb3J0IGZ1bmN0aW9uIGFzKEYpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKHNlbGYsIGIpIHsgcmV0dXJuIEYubWFwKHNlbGYsIGZ1bmN0aW9uICgpIHsgcmV0dXJuIGI7IH0pOyB9O1xufVxuLyoqIEBpbnRlcm5hbCAqL1xuZXhwb3J0IGZ1bmN0aW9uIGFzVW5pdChGKSB7XG4gICAgdmFyIGFzTSA9IGFzKEYpO1xuICAgIHJldHVybiBmdW5jdGlvbiAoc2VsZikgeyByZXR1cm4gYXNNKHNlbGYsIHVuZGVmaW5lZCk7IH07XG59XG4iLAogICJleHBvcnQgZnVuY3Rpb24gY2hhaW5GaXJzdChNKSB7XG4gICAgdmFyIHRhcE0gPSB0YXAoTSk7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChmKSB7IHJldHVybiBmdW5jdGlvbiAoZmlyc3QpIHsgcmV0dXJuIHRhcE0oZmlyc3QsIGYpOyB9OyB9O1xufVxuLyoqIEBpbnRlcm5hbCAqL1xuZXhwb3J0IGZ1bmN0aW9uIHRhcChNKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChmaXJzdCwgZikgeyByZXR1cm4gTS5jaGFpbihmaXJzdCwgZnVuY3Rpb24gKGEpIHsgcmV0dXJuIE0ubWFwKGYoYSksIGZ1bmN0aW9uICgpIHsgcmV0dXJuIGE7IH0pOyB9KTsgfTtcbn1cbmV4cG9ydCBmdW5jdGlvbiBiaW5kKE0pIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKG5hbWUsIGYpIHsgcmV0dXJuIGZ1bmN0aW9uIChtYSkgeyByZXR1cm4gTS5jaGFpbihtYSwgZnVuY3Rpb24gKGEpIHsgcmV0dXJuIE0ubWFwKGYoYSksIGZ1bmN0aW9uIChiKSB7XG4gICAgICAgIHZhciBfYTtcbiAgICAgICAgcmV0dXJuIE9iamVjdC5hc3NpZ24oe30sIGEsIChfYSA9IHt9LCBfYVtuYW1lXSA9IGIsIF9hKSk7XG4gICAgfSk7IH0pOyB9OyB9O1xufVxuIiwKICAiLyoqXG4gKiBUaGUgYEZyb21FaXRoZXJgIHR5cGUgY2xhc3MgcmVwcmVzZW50cyB0aG9zZSBkYXRhIHR5cGVzIHdoaWNoIHN1cHBvcnQgZXJyb3JzLlxuICpcbiAqIEBzaW5jZSAyLjEwLjBcbiAqL1xuaW1wb3J0IHsgdGFwIH0gZnJvbSAnLi9DaGFpbic7XG5pbXBvcnQgeyBmbG93IH0gZnJvbSAnLi9mdW5jdGlvbic7XG5pbXBvcnQgKiBhcyBfIGZyb20gJy4vaW50ZXJuYWwnO1xuZXhwb3J0IGZ1bmN0aW9uIGZyb21PcHRpb24oRikge1xuICAgIHJldHVybiBmdW5jdGlvbiAob25Ob25lKSB7IHJldHVybiBmdW5jdGlvbiAobWEpIHsgcmV0dXJuIEYuZnJvbUVpdGhlcihfLmlzTm9uZShtYSkgPyBfLmxlZnQob25Ob25lKCkpIDogXy5yaWdodChtYS52YWx1ZSkpOyB9OyB9O1xufVxuZXhwb3J0IGZ1bmN0aW9uIGZyb21QcmVkaWNhdGUoRikge1xuICAgIHJldHVybiBmdW5jdGlvbiAocHJlZGljYXRlLCBvbkZhbHNlKSB7XG4gICAgICAgIHJldHVybiBmdW5jdGlvbiAoYSkge1xuICAgICAgICAgICAgcmV0dXJuIEYuZnJvbUVpdGhlcihwcmVkaWNhdGUoYSkgPyBfLnJpZ2h0KGEpIDogXy5sZWZ0KG9uRmFsc2UoYSkpKTtcbiAgICAgICAgfTtcbiAgICB9O1xufVxuZXhwb3J0IGZ1bmN0aW9uIGZyb21PcHRpb25LKEYpIHtcbiAgICB2YXIgZnJvbU9wdGlvbkYgPSBmcm9tT3B0aW9uKEYpO1xuICAgIHJldHVybiBmdW5jdGlvbiAob25Ob25lKSB7XG4gICAgICAgIHZhciBmcm9tID0gZnJvbU9wdGlvbkYob25Ob25lKTtcbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIChmKSB7IHJldHVybiBmbG93KGYsIGZyb20pOyB9O1xuICAgIH07XG59XG5leHBvcnQgZnVuY3Rpb24gY2hhaW5PcHRpb25LKEYsIE0pIHtcbiAgICB2YXIgZnJvbU9wdGlvbktGID0gZnJvbU9wdGlvbksoRik7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChvbk5vbmUpIHtcbiAgICAgICAgdmFyIGZyb20gPSBmcm9tT3B0aW9uS0Yob25Ob25lKTtcbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIChmKSB7IHJldHVybiBmdW5jdGlvbiAobWEpIHsgcmV0dXJuIE0uY2hhaW4obWEsIGZyb20oZikpOyB9OyB9O1xuICAgIH07XG59XG5leHBvcnQgZnVuY3Rpb24gZnJvbUVpdGhlcksoRikge1xuICAgIHJldHVybiBmdW5jdGlvbiAoZikgeyByZXR1cm4gZmxvdyhmLCBGLmZyb21FaXRoZXIpOyB9O1xufVxuZXhwb3J0IGZ1bmN0aW9uIGNoYWluRWl0aGVySyhGLCBNKSB7XG4gICAgdmFyIGZyb21FaXRoZXJLRiA9IGZyb21FaXRoZXJLKEYpO1xuICAgIHJldHVybiBmdW5jdGlvbiAoZikgeyByZXR1cm4gZnVuY3Rpb24gKG1hKSB7IHJldHVybiBNLmNoYWluKG1hLCBmcm9tRWl0aGVyS0YoZikpOyB9OyB9O1xufVxuZXhwb3J0IGZ1bmN0aW9uIGNoYWluRmlyc3RFaXRoZXJLKEYsIE0pIHtcbiAgICB2YXIgdGFwRWl0aGVyTSA9IHRhcEVpdGhlcihGLCBNKTtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGYpIHsgcmV0dXJuIGZ1bmN0aW9uIChtYSkgeyByZXR1cm4gdGFwRWl0aGVyTShtYSwgZik7IH07IH07XG59XG5leHBvcnQgZnVuY3Rpb24gZmlsdGVyT3JFbHNlKEYsIE0pIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKHByZWRpY2F0ZSwgb25GYWxzZSkge1xuICAgICAgICByZXR1cm4gZnVuY3Rpb24gKG1hKSB7XG4gICAgICAgICAgICByZXR1cm4gTS5jaGFpbihtYSwgZnVuY3Rpb24gKGEpIHsgcmV0dXJuIEYuZnJvbUVpdGhlcihwcmVkaWNhdGUoYSkgPyBfLnJpZ2h0KGEpIDogXy5sZWZ0KG9uRmFsc2UoYSkpKTsgfSk7XG4gICAgICAgIH07XG4gICAgfTtcbn1cbi8qKiBAaW50ZXJuYWwgKi9cbmV4cG9ydCBmdW5jdGlvbiB0YXBFaXRoZXIoRiwgTSkge1xuICAgIHZhciBmcm9tRWl0aGVyID0gZnJvbUVpdGhlcksoRik7XG4gICAgdmFyIHRhcE0gPSB0YXAoTSk7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChzZWxmLCBmKSB7IHJldHVybiB0YXBNKHNlbGYsIGZyb21FaXRoZXIoZikpOyB9O1xufVxuIiwKICAiLyoqXG4gKiBUaGUgYEZyb21FaXRoZXJgIHR5cGUgY2xhc3MgcmVwcmVzZW50cyB0aG9zZSBkYXRhIHR5cGVzIHdoaWNoIHN1cHBvcnQgZXJyb3JzLlxuICpcbiAqIEBzaW5jZSAyLjEwLjBcbiAqL1xuaW1wb3J0IHsgdGFwIH0gZnJvbSAnLi9DaGFpbic7XG5pbXBvcnQgeyBmbG93IH0gZnJvbSAnLi9mdW5jdGlvbic7XG5pbXBvcnQgKiBhcyBfIGZyb20gJy4vaW50ZXJuYWwnO1xuZXhwb3J0IGZ1bmN0aW9uIGZyb21PcHRpb24oRikge1xuICAgIHJldHVybiBmdW5jdGlvbiAob25Ob25lKSB7IHJldHVybiBmdW5jdGlvbiAobWEpIHsgcmV0dXJuIEYuZnJvbUVpdGhlcihfLmlzTm9uZShtYSkgPyBfLmxlZnQob25Ob25lKCkpIDogXy5yaWdodChtYS52YWx1ZSkpOyB9OyB9O1xufVxuZXhwb3J0IGZ1bmN0aW9uIGZyb21QcmVkaWNhdGUoRikge1xuICAgIHJldHVybiBmdW5jdGlvbiAocHJlZGljYXRlLCBvbkZhbHNlKSB7XG4gICAgICAgIHJldHVybiBmdW5jdGlvbiAoYSkge1xuICAgICAgICAgICAgcmV0dXJuIEYuZnJvbUVpdGhlcihwcmVkaWNhdGUoYSkgPyBfLnJpZ2h0KGEpIDogXy5sZWZ0KG9uRmFsc2UoYSkpKTtcbiAgICAgICAgfTtcbiAgICB9O1xufVxuZXhwb3J0IGZ1bmN0aW9uIGZyb21PcHRpb25LKEYpIHtcbiAgICB2YXIgZnJvbU9wdGlvbkYgPSBmcm9tT3B0aW9uKEYpO1xuICAgIHJldHVybiBmdW5jdGlvbiAob25Ob25lKSB7XG4gICAgICAgIHZhciBmcm9tID0gZnJvbU9wdGlvbkYob25Ob25lKTtcbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIChmKSB7IHJldHVybiBmbG93KGYsIGZyb20pOyB9O1xuICAgIH07XG59XG5leHBvcnQgZnVuY3Rpb24gY2hhaW5PcHRpb25LKEYsIE0pIHtcbiAgICB2YXIgZnJvbU9wdGlvbktGID0gZnJvbU9wdGlvbksoRik7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChvbk5vbmUpIHtcbiAgICAgICAgdmFyIGZyb20gPSBmcm9tT3B0aW9uS0Yob25Ob25lKTtcbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIChmKSB7IHJldHVybiBmdW5jdGlvbiAobWEpIHsgcmV0dXJuIE0uY2hhaW4obWEsIGZyb20oZikpOyB9OyB9O1xuICAgIH07XG59XG5leHBvcnQgZnVuY3Rpb24gZnJvbUVpdGhlcksoRikge1xuICAgIHJldHVybiBmdW5jdGlvbiAoZikgeyByZXR1cm4gZmxvdyhmLCBGLmZyb21FaXRoZXIpOyB9O1xufVxuZXhwb3J0IGZ1bmN0aW9uIGNoYWluRWl0aGVySyhGLCBNKSB7XG4gICAgdmFyIGZyb21FaXRoZXJLRiA9IGZyb21FaXRoZXJLKEYpO1xuICAgIHJldHVybiBmdW5jdGlvbiAoZikgeyByZXR1cm4gZnVuY3Rpb24gKG1hKSB7IHJldHVybiBNLmNoYWluKG1hLCBmcm9tRWl0aGVyS0YoZikpOyB9OyB9O1xufVxuZXhwb3J0IGZ1bmN0aW9uIGNoYWluRmlyc3RFaXRoZXJLKEYsIE0pIHtcbiAgICB2YXIgdGFwRWl0aGVyTSA9IHRhcEVpdGhlcihGLCBNKTtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGYpIHsgcmV0dXJuIGZ1bmN0aW9uIChtYSkgeyByZXR1cm4gdGFwRWl0aGVyTShtYSwgZik7IH07IH07XG59XG5leHBvcnQgZnVuY3Rpb24gZmlsdGVyT3JFbHNlKEYsIE0pIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKHByZWRpY2F0ZSwgb25GYWxzZSkge1xuICAgICAgICByZXR1cm4gZnVuY3Rpb24gKG1hKSB7XG4gICAgICAgICAgICByZXR1cm4gTS5jaGFpbihtYSwgZnVuY3Rpb24gKGEpIHsgcmV0dXJuIEYuZnJvbUVpdGhlcihwcmVkaWNhdGUoYSkgPyBfLnJpZ2h0KGEpIDogXy5sZWZ0KG9uRmFsc2UoYSkpKTsgfSk7XG4gICAgICAgIH07XG4gICAgfTtcbn1cbi8qKiBAaW50ZXJuYWwgKi9cbmV4cG9ydCBmdW5jdGlvbiB0YXBFaXRoZXIoRiwgTSkge1xuICAgIHZhciBmcm9tRWl0aGVyID0gZnJvbUVpdGhlcksoRik7XG4gICAgdmFyIHRhcE0gPSB0YXAoTSk7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChzZWxmLCBmKSB7IHJldHVybiB0YXBNKHNlbGYsIGZyb21FaXRoZXIoZikpOyB9O1xufVxuIiwKICAiaW1wb3J0IHsgcGlwZSB9IGZyb20gJy4vZnVuY3Rpb24nO1xuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLy8gY29uc3RydWN0b3JzXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vKipcbiAqIEBjYXRlZ29yeSBjb25zdHJ1Y3RvcnNcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIGZyb21FcXVhbHMgPSBmdW5jdGlvbiAoZXF1YWxzKSB7IHJldHVybiAoe1xuICAgIGVxdWFsczogZnVuY3Rpb24gKHgsIHkpIHsgcmV0dXJuIHggPT09IHkgfHwgZXF1YWxzKHgsIHkpOyB9XG59KTsgfTtcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8vIGNvbWJpbmF0b3JzXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vKipcbiAqIEBzaW5jZSAyLjEwLjBcbiAqL1xuZXhwb3J0IHZhciBzdHJ1Y3QgPSBmdW5jdGlvbiAoZXFzKSB7XG4gICAgcmV0dXJuIGZyb21FcXVhbHMoZnVuY3Rpb24gKGZpcnN0LCBzZWNvbmQpIHtcbiAgICAgICAgZm9yICh2YXIga2V5IGluIGVxcykge1xuICAgICAgICAgICAgaWYgKCFlcXNba2V5XS5lcXVhbHMoZmlyc3Rba2V5XSwgc2Vjb25kW2tleV0pKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgIH0pO1xufTtcbi8qKlxuICogR2l2ZW4gYSB0dXBsZSBvZiBgRXFgcyByZXR1cm5zIGEgYEVxYCBmb3IgdGhlIHR1cGxlXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IHR1cGxlIH0gZnJvbSAnZnAtdHMvRXEnXG4gKiBpbXBvcnQgKiBhcyBTIGZyb20gJ2ZwLXRzL3N0cmluZydcbiAqIGltcG9ydCAqIGFzIE4gZnJvbSAnZnAtdHMvbnVtYmVyJ1xuICogaW1wb3J0ICogYXMgQiBmcm9tICdmcC10cy9ib29sZWFuJ1xuICpcbiAqIGNvbnN0IEUgPSB0dXBsZShTLkVxLCBOLkVxLCBCLkVxKVxuICogYXNzZXJ0LnN0cmljdEVxdWFsKEUuZXF1YWxzKFsnYScsIDEsIHRydWVdLCBbJ2EnLCAxLCB0cnVlXSksIHRydWUpXG4gKiBhc3NlcnQuc3RyaWN0RXF1YWwoRS5lcXVhbHMoWydhJywgMSwgdHJ1ZV0sIFsnYicsIDEsIHRydWVdKSwgZmFsc2UpXG4gKiBhc3NlcnQuc3RyaWN0RXF1YWwoRS5lcXVhbHMoWydhJywgMSwgdHJ1ZV0sIFsnYScsIDIsIHRydWVdKSwgZmFsc2UpXG4gKiBhc3NlcnQuc3RyaWN0RXF1YWwoRS5lcXVhbHMoWydhJywgMSwgdHJ1ZV0sIFsnYScsIDEsIGZhbHNlXSksIGZhbHNlKVxuICpcbiAqIEBzaW5jZSAyLjEwLjBcbiAqL1xuZXhwb3J0IHZhciB0dXBsZSA9IGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgZXFzID0gW107XG4gICAgZm9yICh2YXIgX2kgPSAwOyBfaSA8IGFyZ3VtZW50cy5sZW5ndGg7IF9pKyspIHtcbiAgICAgICAgZXFzW19pXSA9IGFyZ3VtZW50c1tfaV07XG4gICAgfVxuICAgIHJldHVybiBmcm9tRXF1YWxzKGZ1bmN0aW9uIChmaXJzdCwgc2Vjb25kKSB7IHJldHVybiBlcXMuZXZlcnkoZnVuY3Rpb24gKEUsIGkpIHsgcmV0dXJuIEUuZXF1YWxzKGZpcnN0W2ldLCBzZWNvbmRbaV0pOyB9KTsgfSk7XG59O1xuLyogaXN0YW5idWwgaWdub3JlIG5leHQgKi9cbnZhciBjb250cmFtYXBfID0gZnVuY3Rpb24gKGZhLCBmKSB7IHJldHVybiBwaXBlKGZhLCBjb250cmFtYXAoZikpOyB9O1xuLyoqXG4gKiBBIHR5cGljYWwgdXNlIGNhc2UgZm9yIGBjb250cmFtYXBgIHdvdWxkIGJlIGxpa2UsIGdpdmVuIHNvbWUgYFVzZXJgIHR5cGUsIHRvIGNvbnN0cnVjdCBhbiBgRXE8VXNlcj5gLlxuICpcbiAqIFdlIGNhbiBkbyBzbyB3aXRoIGEgZnVuY3Rpb24gZnJvbSBgVXNlciAtPiBYYCB3aGVyZSBgWGAgaXMgc29tZSB2YWx1ZSB0aGF0IHdlIGtub3cgaG93IHRvIGNvbXBhcmVcbiAqIGZvciBlcXVhbGl0eSAobWVhbmluZyB3ZSBoYXZlIGFuIGBFcTxYPmApXG4gKlxuICogRm9yIGV4YW1wbGUsIGdpdmVuIHRoZSBmb2xsb3dpbmcgYFVzZXJgIHR5cGUsIHdlIHdhbnQgdG8gY29uc3RydWN0IGFuIGBFcTxVc2VyPmAgdGhhdCBqdXN0IGxvb2tzIGF0IHRoZSBga2V5YCBmaWVsZFxuICogZm9yIGVhY2ggdXNlciAoc2luY2UgaXQncyBrbm93biB0byBiZSB1bmlxdWUpLlxuICpcbiAqIElmIHdlIGhhdmUgYSB3YXkgb2YgY29tcGFyaW5nIGBVVUlEYHMgZm9yIGVxdWFsaXR5IChgZXFVVUlEOiBFcTxVVUlEPmApIGFuZCB3ZSBrbm93IGhvdyB0byBnbyBmcm9tIGBVc2VyIC0+IFVVSURgLFxuICogdXNpbmcgYGNvbnRyYW1hcGAgd2UgY2FuIGRvIHRoaXNcbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgY29udHJhbWFwLCBFcSB9IGZyb20gJ2ZwLXRzL0VxJ1xuICogaW1wb3J0IHsgcGlwZSB9IGZyb20gJ2ZwLXRzL2Z1bmN0aW9uJ1xuICogaW1wb3J0ICogYXMgUyBmcm9tICdmcC10cy9zdHJpbmcnXG4gKlxuICogdHlwZSBVVUlEID0gc3RyaW5nXG4gKlxuICogaW50ZXJmYWNlIFVzZXIge1xuICogICByZWFkb25seSBrZXk6IFVVSURcbiAqICAgcmVhZG9ubHkgZmlyc3ROYW1lOiBzdHJpbmdcbiAqICAgcmVhZG9ubHkgbGFzdE5hbWU6IHN0cmluZ1xuICogfVxuICpcbiAqIGNvbnN0IGVxVVVJRDogRXE8VVVJRD4gPSBTLkVxXG4gKlxuICogY29uc3QgZXFVc2VyQnlLZXk6IEVxPFVzZXI+ID0gcGlwZShcbiAqICAgZXFVVUlELFxuICogICBjb250cmFtYXAoKHVzZXIpID0+IHVzZXIua2V5KVxuICogKVxuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoXG4gKiAgIGVxVXNlckJ5S2V5LmVxdWFscyhcbiAqICAgICB7IGtleTogJ2sxJywgZmlyc3ROYW1lOiAnYTEnLCBsYXN0TmFtZTogJ2IxJyB9LFxuICogICAgIHsga2V5OiAnazInLCBmaXJzdE5hbWU6ICdhMScsIGxhc3ROYW1lOiAnYjEnIH1cbiAqICAgKSxcbiAqICAgZmFsc2VcbiAqIClcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoXG4gKiAgIGVxVXNlckJ5S2V5LmVxdWFscyhcbiAqICAgICB7IGtleTogJ2sxJywgZmlyc3ROYW1lOiAnYTEnLCBsYXN0TmFtZTogJ2IxJyB9LFxuICogICAgIHsga2V5OiAnazEnLCBmaXJzdE5hbWU6ICdhMicsIGxhc3ROYW1lOiAnYjEnIH1cbiAqICAgKSxcbiAqICAgdHJ1ZVxuICogKVxuICpcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIGNvbnRyYW1hcCA9IGZ1bmN0aW9uIChmKSB7IHJldHVybiBmdW5jdGlvbiAoZmEpIHtcbiAgICByZXR1cm4gZnJvbUVxdWFscyhmdW5jdGlvbiAoeCwgeSkgeyByZXR1cm4gZmEuZXF1YWxzKGYoeCksIGYoeSkpOyB9KTtcbn07IH07XG4vKipcbiAqIEBjYXRlZ29yeSB0eXBlIGxhbWJkYXNcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIFVSSSA9ICdFcSc7XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIGVxU3RyaWN0ID0ge1xuICAgIGVxdWFsczogZnVuY3Rpb24gKGEsIGIpIHsgcmV0dXJuIGEgPT09IGI7IH1cbn07XG52YXIgZW1wdHkgPSB7XG4gICAgZXF1YWxzOiBmdW5jdGlvbiAoKSB7IHJldHVybiB0cnVlOyB9XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi4xMC4wXG4gKi9cbmV4cG9ydCB2YXIgZ2V0U2VtaWdyb3VwID0gZnVuY3Rpb24gKCkgeyByZXR1cm4gKHtcbiAgICBjb25jYXQ6IGZ1bmN0aW9uICh4LCB5KSB7IHJldHVybiBmcm9tRXF1YWxzKGZ1bmN0aW9uIChhLCBiKSB7IHJldHVybiB4LmVxdWFscyhhLCBiKSAmJiB5LmVxdWFscyhhLCBiKTsgfSk7IH1cbn0pOyB9O1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi42LjBcbiAqL1xuZXhwb3J0IHZhciBnZXRNb25vaWQgPSBmdW5jdGlvbiAoKSB7IHJldHVybiAoe1xuICAgIGNvbmNhdDogZ2V0U2VtaWdyb3VwKCkuY29uY2F0LFxuICAgIGVtcHR5OiBlbXB0eVxufSk7IH07XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjcuMFxuICovXG5leHBvcnQgdmFyIENvbnRyYXZhcmlhbnQgPSB7XG4gICAgVVJJOiBVUkksXG4gICAgY29udHJhbWFwOiBjb250cmFtYXBfXG59O1xuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLy8gZGVwcmVjYXRlZFxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLyoqXG4gKiBVc2UgW2B0dXBsZWBdKCN0dXBsZSkgaW5zdGVhZC5cbiAqXG4gKiBAY2F0ZWdvcnkgem9uZSBvZiBkZWF0aFxuICogQHNpbmNlIDIuMC4wXG4gKiBAZGVwcmVjYXRlZFxuICovXG5leHBvcnQgdmFyIGdldFR1cGxlRXEgPSB0dXBsZTtcbi8qKlxuICogVXNlIFtgc3RydWN0YF0oI3N0cnVjdCkgaW5zdGVhZC5cbiAqXG4gKiBAY2F0ZWdvcnkgem9uZSBvZiBkZWF0aFxuICogQHNpbmNlIDIuMC4wXG4gKiBAZGVwcmVjYXRlZFxuICovXG5leHBvcnQgdmFyIGdldFN0cnVjdEVxID0gc3RydWN0O1xuLyoqXG4gKiBVc2UgW2BlcVN0cmljdGBdKCNlcXN0cmljdCkgaW5zdGVhZFxuICpcbiAqIEBjYXRlZ29yeSB6b25lIG9mIGRlYXRoXG4gKiBAc2luY2UgMi4wLjBcbiAqIEBkZXByZWNhdGVkXG4gKi9cbmV4cG9ydCB2YXIgc3RyaWN0RXF1YWwgPSBlcVN0cmljdC5lcXVhbHM7XG4vKipcbiAqIFRoaXMgaW5zdGFuY2UgaXMgZGVwcmVjYXRlZCwgdXNlIHNtYWxsLCBzcGVjaWZpYyBpbnN0YW5jZXMgaW5zdGVhZC5cbiAqIEZvciBleGFtcGxlIGlmIGEgZnVuY3Rpb24gbmVlZHMgYSBgQ29udHJhdmFyaWFudGAgaW5zdGFuY2UsIHBhc3MgYEUuQ29udHJhdmFyaWFudGAgaW5zdGVhZCBvZiBgRS5lcWBcbiAqICh3aGVyZSBgRWAgaXMgZnJvbSBgaW1wb3J0IEUgZnJvbSAnZnAtdHMvRXEnYClcbiAqXG4gKiBAY2F0ZWdvcnkgem9uZSBvZiBkZWF0aFxuICogQHNpbmNlIDIuMC4wXG4gKiBAZGVwcmVjYXRlZFxuICovXG5leHBvcnQgdmFyIGVxID0gQ29udHJhdmFyaWFudDtcbi8qKlxuICogVXNlIFtgRXFgXSguL2Jvb2xlYW4udHMuaHRtbCNlcSkgaW5zdGVhZC5cbiAqXG4gKiBAY2F0ZWdvcnkgem9uZSBvZiBkZWF0aFxuICogQHNpbmNlIDIuMC4wXG4gKiBAZGVwcmVjYXRlZFxuICovXG5leHBvcnQgdmFyIGVxQm9vbGVhbiA9IGVxU3RyaWN0O1xuLyoqXG4gKiBVc2UgW2BFcWBdKC4vc3RyaW5nLnRzLmh0bWwjZXEpIGluc3RlYWQuXG4gKlxuICogQGNhdGVnb3J5IHpvbmUgb2YgZGVhdGhcbiAqIEBzaW5jZSAyLjAuMFxuICogQGRlcHJlY2F0ZWRcbiAqL1xuZXhwb3J0IHZhciBlcVN0cmluZyA9IGVxU3RyaWN0O1xuLyoqXG4gKiBVc2UgW2BFcWBdKC4vbnVtYmVyLnRzLmh0bWwjZXEpIGluc3RlYWQuXG4gKlxuICogQGNhdGVnb3J5IHpvbmUgb2YgZGVhdGhcbiAqIEBzaW5jZSAyLjAuMFxuICogQGRlcHJlY2F0ZWRcbiAqL1xuZXhwb3J0IHZhciBlcU51bWJlciA9IGVxU3RyaWN0O1xuLyoqXG4gKiBVc2UgW2BFcWBdKC4vRGF0ZS50cy5odG1sI2VxKSBpbnN0ZWFkLlxuICpcbiAqIEBjYXRlZ29yeSB6b25lIG9mIGRlYXRoXG4gKiBAc2luY2UgMi4wLjBcbiAqIEBkZXByZWNhdGVkXG4gKi9cbmV4cG9ydCB2YXIgZXFEYXRlID0ge1xuICAgIGVxdWFsczogZnVuY3Rpb24gKGZpcnN0LCBzZWNvbmQpIHsgcmV0dXJuIGZpcnN0LnZhbHVlT2YoKSA9PT0gc2Vjb25kLnZhbHVlT2YoKTsgfVxufTtcbiIsCiAgImltcG9ydCB7IHBpcGUgfSBmcm9tICcuL2Z1bmN0aW9uJztcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8vIGNvbnN0cnVjdG9yc1xuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLyoqXG4gKiBAY2F0ZWdvcnkgY29uc3RydWN0b3JzXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciBmcm9tRXF1YWxzID0gZnVuY3Rpb24gKGVxdWFscykgeyByZXR1cm4gKHtcbiAgICBlcXVhbHM6IGZ1bmN0aW9uICh4LCB5KSB7IHJldHVybiB4ID09PSB5IHx8IGVxdWFscyh4LCB5KTsgfVxufSk7IH07XG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vLyBjb21iaW5hdG9yc1xuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLyoqXG4gKiBAc2luY2UgMi4xMC4wXG4gKi9cbmV4cG9ydCB2YXIgc3RydWN0ID0gZnVuY3Rpb24gKGVxcykge1xuICAgIHJldHVybiBmcm9tRXF1YWxzKGZ1bmN0aW9uIChmaXJzdCwgc2Vjb25kKSB7XG4gICAgICAgIGZvciAodmFyIGtleSBpbiBlcXMpIHtcbiAgICAgICAgICAgIGlmICghZXFzW2tleV0uZXF1YWxzKGZpcnN0W2tleV0sIHNlY29uZFtrZXldKSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9KTtcbn07XG4vKipcbiAqIEdpdmVuIGEgdHVwbGUgb2YgYEVxYHMgcmV0dXJucyBhIGBFcWAgZm9yIHRoZSB0dXBsZVxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyB0dXBsZSB9IGZyb20gJ2ZwLXRzL0VxJ1xuICogaW1wb3J0ICogYXMgUyBmcm9tICdmcC10cy9zdHJpbmcnXG4gKiBpbXBvcnQgKiBhcyBOIGZyb20gJ2ZwLXRzL251bWJlcidcbiAqIGltcG9ydCAqIGFzIEIgZnJvbSAnZnAtdHMvYm9vbGVhbidcbiAqXG4gKiBjb25zdCBFID0gdHVwbGUoUy5FcSwgTi5FcSwgQi5FcSlcbiAqIGFzc2VydC5zdHJpY3RFcXVhbChFLmVxdWFscyhbJ2EnLCAxLCB0cnVlXSwgWydhJywgMSwgdHJ1ZV0pLCB0cnVlKVxuICogYXNzZXJ0LnN0cmljdEVxdWFsKEUuZXF1YWxzKFsnYScsIDEsIHRydWVdLCBbJ2InLCAxLCB0cnVlXSksIGZhbHNlKVxuICogYXNzZXJ0LnN0cmljdEVxdWFsKEUuZXF1YWxzKFsnYScsIDEsIHRydWVdLCBbJ2EnLCAyLCB0cnVlXSksIGZhbHNlKVxuICogYXNzZXJ0LnN0cmljdEVxdWFsKEUuZXF1YWxzKFsnYScsIDEsIHRydWVdLCBbJ2EnLCAxLCBmYWxzZV0pLCBmYWxzZSlcbiAqXG4gKiBAc2luY2UgMi4xMC4wXG4gKi9cbmV4cG9ydCB2YXIgdHVwbGUgPSBmdW5jdGlvbiAoKSB7XG4gICAgdmFyIGVxcyA9IFtdO1xuICAgIGZvciAodmFyIF9pID0gMDsgX2kgPCBhcmd1bWVudHMubGVuZ3RoOyBfaSsrKSB7XG4gICAgICAgIGVxc1tfaV0gPSBhcmd1bWVudHNbX2ldO1xuICAgIH1cbiAgICByZXR1cm4gZnJvbUVxdWFscyhmdW5jdGlvbiAoZmlyc3QsIHNlY29uZCkgeyByZXR1cm4gZXFzLmV2ZXJ5KGZ1bmN0aW9uIChFLCBpKSB7IHJldHVybiBFLmVxdWFscyhmaXJzdFtpXSwgc2Vjb25kW2ldKTsgfSk7IH0pO1xufTtcbi8qIGlzdGFuYnVsIGlnbm9yZSBuZXh0ICovXG52YXIgY29udHJhbWFwXyA9IGZ1bmN0aW9uIChmYSwgZikgeyByZXR1cm4gcGlwZShmYSwgY29udHJhbWFwKGYpKTsgfTtcbi8qKlxuICogQSB0eXBpY2FsIHVzZSBjYXNlIGZvciBgY29udHJhbWFwYCB3b3VsZCBiZSBsaWtlLCBnaXZlbiBzb21lIGBVc2VyYCB0eXBlLCB0byBjb25zdHJ1Y3QgYW4gYEVxPFVzZXI+YC5cbiAqXG4gKiBXZSBjYW4gZG8gc28gd2l0aCBhIGZ1bmN0aW9uIGZyb20gYFVzZXIgLT4gWGAgd2hlcmUgYFhgIGlzIHNvbWUgdmFsdWUgdGhhdCB3ZSBrbm93IGhvdyB0byBjb21wYXJlXG4gKiBmb3IgZXF1YWxpdHkgKG1lYW5pbmcgd2UgaGF2ZSBhbiBgRXE8WD5gKVxuICpcbiAqIEZvciBleGFtcGxlLCBnaXZlbiB0aGUgZm9sbG93aW5nIGBVc2VyYCB0eXBlLCB3ZSB3YW50IHRvIGNvbnN0cnVjdCBhbiBgRXE8VXNlcj5gIHRoYXQganVzdCBsb29rcyBhdCB0aGUgYGtleWAgZmllbGRcbiAqIGZvciBlYWNoIHVzZXIgKHNpbmNlIGl0J3Mga25vd24gdG8gYmUgdW5pcXVlKS5cbiAqXG4gKiBJZiB3ZSBoYXZlIGEgd2F5IG9mIGNvbXBhcmluZyBgVVVJRGBzIGZvciBlcXVhbGl0eSAoYGVxVVVJRDogRXE8VVVJRD5gKSBhbmQgd2Uga25vdyBob3cgdG8gZ28gZnJvbSBgVXNlciAtPiBVVUlEYCxcbiAqIHVzaW5nIGBjb250cmFtYXBgIHdlIGNhbiBkbyB0aGlzXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IGNvbnRyYW1hcCwgRXEgfSBmcm9tICdmcC10cy9FcSdcbiAqIGltcG9ydCB7IHBpcGUgfSBmcm9tICdmcC10cy9mdW5jdGlvbidcbiAqIGltcG9ydCAqIGFzIFMgZnJvbSAnZnAtdHMvc3RyaW5nJ1xuICpcbiAqIHR5cGUgVVVJRCA9IHN0cmluZ1xuICpcbiAqIGludGVyZmFjZSBVc2VyIHtcbiAqICAgcmVhZG9ubHkga2V5OiBVVUlEXG4gKiAgIHJlYWRvbmx5IGZpcnN0TmFtZTogc3RyaW5nXG4gKiAgIHJlYWRvbmx5IGxhc3ROYW1lOiBzdHJpbmdcbiAqIH1cbiAqXG4gKiBjb25zdCBlcVVVSUQ6IEVxPFVVSUQ+ID0gUy5FcVxuICpcbiAqIGNvbnN0IGVxVXNlckJ5S2V5OiBFcTxVc2VyPiA9IHBpcGUoXG4gKiAgIGVxVVVJRCxcbiAqICAgY29udHJhbWFwKCh1c2VyKSA9PiB1c2VyLmtleSlcbiAqIClcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKFxuICogICBlcVVzZXJCeUtleS5lcXVhbHMoXG4gKiAgICAgeyBrZXk6ICdrMScsIGZpcnN0TmFtZTogJ2ExJywgbGFzdE5hbWU6ICdiMScgfSxcbiAqICAgICB7IGtleTogJ2syJywgZmlyc3ROYW1lOiAnYTEnLCBsYXN0TmFtZTogJ2IxJyB9XG4gKiAgICksXG4gKiAgIGZhbHNlXG4gKiApXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKFxuICogICBlcVVzZXJCeUtleS5lcXVhbHMoXG4gKiAgICAgeyBrZXk6ICdrMScsIGZpcnN0TmFtZTogJ2ExJywgbGFzdE5hbWU6ICdiMScgfSxcbiAqICAgICB7IGtleTogJ2sxJywgZmlyc3ROYW1lOiAnYTInLCBsYXN0TmFtZTogJ2IxJyB9XG4gKiAgICksXG4gKiAgIHRydWVcbiAqIClcbiAqXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciBjb250cmFtYXAgPSBmdW5jdGlvbiAoZikgeyByZXR1cm4gZnVuY3Rpb24gKGZhKSB7XG4gICAgcmV0dXJuIGZyb21FcXVhbHMoZnVuY3Rpb24gKHgsIHkpIHsgcmV0dXJuIGZhLmVxdWFscyhmKHgpLCBmKHkpKTsgfSk7XG59OyB9O1xuLyoqXG4gKiBAY2F0ZWdvcnkgdHlwZSBsYW1iZGFzXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciBVUkkgPSAnRXEnO1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBlcVN0cmljdCA9IHtcbiAgICBlcXVhbHM6IGZ1bmN0aW9uIChhLCBiKSB7IHJldHVybiBhID09PSBiOyB9XG59O1xudmFyIGVtcHR5ID0ge1xuICAgIGVxdWFsczogZnVuY3Rpb24gKCkgeyByZXR1cm4gdHJ1ZTsgfVxufTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuMTAuMFxuICovXG5leHBvcnQgdmFyIGdldFNlbWlncm91cCA9IGZ1bmN0aW9uICgpIHsgcmV0dXJuICh7XG4gICAgY29uY2F0OiBmdW5jdGlvbiAoeCwgeSkgeyByZXR1cm4gZnJvbUVxdWFscyhmdW5jdGlvbiAoYSwgYikgeyByZXR1cm4geC5lcXVhbHMoYSwgYikgJiYgeS5lcXVhbHMoYSwgYik7IH0pOyB9XG59KTsgfTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuNi4wXG4gKi9cbmV4cG9ydCB2YXIgZ2V0TW9ub2lkID0gZnVuY3Rpb24gKCkgeyByZXR1cm4gKHtcbiAgICBjb25jYXQ6IGdldFNlbWlncm91cCgpLmNvbmNhdCxcbiAgICBlbXB0eTogZW1wdHlcbn0pOyB9O1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi43LjBcbiAqL1xuZXhwb3J0IHZhciBDb250cmF2YXJpYW50ID0ge1xuICAgIFVSSTogVVJJLFxuICAgIGNvbnRyYW1hcDogY29udHJhbWFwX1xufTtcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8vIGRlcHJlY2F0ZWRcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8qKlxuICogVXNlIFtgdHVwbGVgXSgjdHVwbGUpIGluc3RlYWQuXG4gKlxuICogQGNhdGVnb3J5IHpvbmUgb2YgZGVhdGhcbiAqIEBzaW5jZSAyLjAuMFxuICogQGRlcHJlY2F0ZWRcbiAqL1xuZXhwb3J0IHZhciBnZXRUdXBsZUVxID0gdHVwbGU7XG4vKipcbiAqIFVzZSBbYHN0cnVjdGBdKCNzdHJ1Y3QpIGluc3RlYWQuXG4gKlxuICogQGNhdGVnb3J5IHpvbmUgb2YgZGVhdGhcbiAqIEBzaW5jZSAyLjAuMFxuICogQGRlcHJlY2F0ZWRcbiAqL1xuZXhwb3J0IHZhciBnZXRTdHJ1Y3RFcSA9IHN0cnVjdDtcbi8qKlxuICogVXNlIFtgZXFTdHJpY3RgXSgjZXFzdHJpY3QpIGluc3RlYWRcbiAqXG4gKiBAY2F0ZWdvcnkgem9uZSBvZiBkZWF0aFxuICogQHNpbmNlIDIuMC4wXG4gKiBAZGVwcmVjYXRlZFxuICovXG5leHBvcnQgdmFyIHN0cmljdEVxdWFsID0gZXFTdHJpY3QuZXF1YWxzO1xuLyoqXG4gKiBUaGlzIGluc3RhbmNlIGlzIGRlcHJlY2F0ZWQsIHVzZSBzbWFsbCwgc3BlY2lmaWMgaW5zdGFuY2VzIGluc3RlYWQuXG4gKiBGb3IgZXhhbXBsZSBpZiBhIGZ1bmN0aW9uIG5lZWRzIGEgYENvbnRyYXZhcmlhbnRgIGluc3RhbmNlLCBwYXNzIGBFLkNvbnRyYXZhcmlhbnRgIGluc3RlYWQgb2YgYEUuZXFgXG4gKiAod2hlcmUgYEVgIGlzIGZyb20gYGltcG9ydCBFIGZyb20gJ2ZwLXRzL0VxJ2ApXG4gKlxuICogQGNhdGVnb3J5IHpvbmUgb2YgZGVhdGhcbiAqIEBzaW5jZSAyLjAuMFxuICogQGRlcHJlY2F0ZWRcbiAqL1xuZXhwb3J0IHZhciBlcSA9IENvbnRyYXZhcmlhbnQ7XG4vKipcbiAqIFVzZSBbYEVxYF0oLi9ib29sZWFuLnRzLmh0bWwjZXEpIGluc3RlYWQuXG4gKlxuICogQGNhdGVnb3J5IHpvbmUgb2YgZGVhdGhcbiAqIEBzaW5jZSAyLjAuMFxuICogQGRlcHJlY2F0ZWRcbiAqL1xuZXhwb3J0IHZhciBlcUJvb2xlYW4gPSBlcVN0cmljdDtcbi8qKlxuICogVXNlIFtgRXFgXSguL3N0cmluZy50cy5odG1sI2VxKSBpbnN0ZWFkLlxuICpcbiAqIEBjYXRlZ29yeSB6b25lIG9mIGRlYXRoXG4gKiBAc2luY2UgMi4wLjBcbiAqIEBkZXByZWNhdGVkXG4gKi9cbmV4cG9ydCB2YXIgZXFTdHJpbmcgPSBlcVN0cmljdDtcbi8qKlxuICogVXNlIFtgRXFgXSguL251bWJlci50cy5odG1sI2VxKSBpbnN0ZWFkLlxuICpcbiAqIEBjYXRlZ29yeSB6b25lIG9mIGRlYXRoXG4gKiBAc2luY2UgMi4wLjBcbiAqIEBkZXByZWNhdGVkXG4gKi9cbmV4cG9ydCB2YXIgZXFOdW1iZXIgPSBlcVN0cmljdDtcbi8qKlxuICogVXNlIFtgRXFgXSguL0RhdGUudHMuaHRtbCNlcSkgaW5zdGVhZC5cbiAqXG4gKiBAY2F0ZWdvcnkgem9uZSBvZiBkZWF0aFxuICogQHNpbmNlIDIuMC4wXG4gKiBAZGVwcmVjYXRlZFxuICovXG5leHBvcnQgdmFyIGVxRGF0ZSA9IHtcbiAgICBlcXVhbHM6IGZ1bmN0aW9uIChmaXJzdCwgc2Vjb25kKSB7IHJldHVybiBmaXJzdC52YWx1ZU9mKCkgPT09IHNlY29uZC52YWx1ZU9mKCk7IH1cbn07XG4iLAogICJpbXBvcnQgeyBwaXBlIH0gZnJvbSAnLi9mdW5jdGlvbic7XG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vLyBjb25zdHJ1Y3RvcnNcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8qKlxuICogQGNhdGVnb3J5IGNvbnN0cnVjdG9yc1xuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgZnJvbUVxdWFscyA9IGZ1bmN0aW9uIChlcXVhbHMpIHsgcmV0dXJuICh7XG4gICAgZXF1YWxzOiBmdW5jdGlvbiAoeCwgeSkgeyByZXR1cm4geCA9PT0geSB8fCBlcXVhbHMoeCwgeSk7IH1cbn0pOyB9O1xuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLy8gY29tYmluYXRvcnNcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8qKlxuICogQHNpbmNlIDIuMTAuMFxuICovXG5leHBvcnQgdmFyIHN0cnVjdCA9IGZ1bmN0aW9uIChlcXMpIHtcbiAgICByZXR1cm4gZnJvbUVxdWFscyhmdW5jdGlvbiAoZmlyc3QsIHNlY29uZCkge1xuICAgICAgICBmb3IgKHZhciBrZXkgaW4gZXFzKSB7XG4gICAgICAgICAgICBpZiAoIWVxc1trZXldLmVxdWFscyhmaXJzdFtrZXldLCBzZWNvbmRba2V5XSkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgfSk7XG59O1xuLyoqXG4gKiBHaXZlbiBhIHR1cGxlIG9mIGBFcWBzIHJldHVybnMgYSBgRXFgIGZvciB0aGUgdHVwbGVcbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgdHVwbGUgfSBmcm9tICdmcC10cy9FcSdcbiAqIGltcG9ydCAqIGFzIFMgZnJvbSAnZnAtdHMvc3RyaW5nJ1xuICogaW1wb3J0ICogYXMgTiBmcm9tICdmcC10cy9udW1iZXInXG4gKiBpbXBvcnQgKiBhcyBCIGZyb20gJ2ZwLXRzL2Jvb2xlYW4nXG4gKlxuICogY29uc3QgRSA9IHR1cGxlKFMuRXEsIE4uRXEsIEIuRXEpXG4gKiBhc3NlcnQuc3RyaWN0RXF1YWwoRS5lcXVhbHMoWydhJywgMSwgdHJ1ZV0sIFsnYScsIDEsIHRydWVdKSwgdHJ1ZSlcbiAqIGFzc2VydC5zdHJpY3RFcXVhbChFLmVxdWFscyhbJ2EnLCAxLCB0cnVlXSwgWydiJywgMSwgdHJ1ZV0pLCBmYWxzZSlcbiAqIGFzc2VydC5zdHJpY3RFcXVhbChFLmVxdWFscyhbJ2EnLCAxLCB0cnVlXSwgWydhJywgMiwgdHJ1ZV0pLCBmYWxzZSlcbiAqIGFzc2VydC5zdHJpY3RFcXVhbChFLmVxdWFscyhbJ2EnLCAxLCB0cnVlXSwgWydhJywgMSwgZmFsc2VdKSwgZmFsc2UpXG4gKlxuICogQHNpbmNlIDIuMTAuMFxuICovXG5leHBvcnQgdmFyIHR1cGxlID0gZnVuY3Rpb24gKCkge1xuICAgIHZhciBlcXMgPSBbXTtcbiAgICBmb3IgKHZhciBfaSA9IDA7IF9pIDwgYXJndW1lbnRzLmxlbmd0aDsgX2krKykge1xuICAgICAgICBlcXNbX2ldID0gYXJndW1lbnRzW19pXTtcbiAgICB9XG4gICAgcmV0dXJuIGZyb21FcXVhbHMoZnVuY3Rpb24gKGZpcnN0LCBzZWNvbmQpIHsgcmV0dXJuIGVxcy5ldmVyeShmdW5jdGlvbiAoRSwgaSkgeyByZXR1cm4gRS5lcXVhbHMoZmlyc3RbaV0sIHNlY29uZFtpXSk7IH0pOyB9KTtcbn07XG4vKiBpc3RhbmJ1bCBpZ25vcmUgbmV4dCAqL1xudmFyIGNvbnRyYW1hcF8gPSBmdW5jdGlvbiAoZmEsIGYpIHsgcmV0dXJuIHBpcGUoZmEsIGNvbnRyYW1hcChmKSk7IH07XG4vKipcbiAqIEEgdHlwaWNhbCB1c2UgY2FzZSBmb3IgYGNvbnRyYW1hcGAgd291bGQgYmUgbGlrZSwgZ2l2ZW4gc29tZSBgVXNlcmAgdHlwZSwgdG8gY29uc3RydWN0IGFuIGBFcTxVc2VyPmAuXG4gKlxuICogV2UgY2FuIGRvIHNvIHdpdGggYSBmdW5jdGlvbiBmcm9tIGBVc2VyIC0+IFhgIHdoZXJlIGBYYCBpcyBzb21lIHZhbHVlIHRoYXQgd2Uga25vdyBob3cgdG8gY29tcGFyZVxuICogZm9yIGVxdWFsaXR5IChtZWFuaW5nIHdlIGhhdmUgYW4gYEVxPFg+YClcbiAqXG4gKiBGb3IgZXhhbXBsZSwgZ2l2ZW4gdGhlIGZvbGxvd2luZyBgVXNlcmAgdHlwZSwgd2Ugd2FudCB0byBjb25zdHJ1Y3QgYW4gYEVxPFVzZXI+YCB0aGF0IGp1c3QgbG9va3MgYXQgdGhlIGBrZXlgIGZpZWxkXG4gKiBmb3IgZWFjaCB1c2VyIChzaW5jZSBpdCdzIGtub3duIHRvIGJlIHVuaXF1ZSkuXG4gKlxuICogSWYgd2UgaGF2ZSBhIHdheSBvZiBjb21wYXJpbmcgYFVVSURgcyBmb3IgZXF1YWxpdHkgKGBlcVVVSUQ6IEVxPFVVSUQ+YCkgYW5kIHdlIGtub3cgaG93IHRvIGdvIGZyb20gYFVzZXIgLT4gVVVJRGAsXG4gKiB1c2luZyBgY29udHJhbWFwYCB3ZSBjYW4gZG8gdGhpc1xuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBjb250cmFtYXAsIEVxIH0gZnJvbSAnZnAtdHMvRXEnXG4gKiBpbXBvcnQgeyBwaXBlIH0gZnJvbSAnZnAtdHMvZnVuY3Rpb24nXG4gKiBpbXBvcnQgKiBhcyBTIGZyb20gJ2ZwLXRzL3N0cmluZydcbiAqXG4gKiB0eXBlIFVVSUQgPSBzdHJpbmdcbiAqXG4gKiBpbnRlcmZhY2UgVXNlciB7XG4gKiAgIHJlYWRvbmx5IGtleTogVVVJRFxuICogICByZWFkb25seSBmaXJzdE5hbWU6IHN0cmluZ1xuICogICByZWFkb25seSBsYXN0TmFtZTogc3RyaW5nXG4gKiB9XG4gKlxuICogY29uc3QgZXFVVUlEOiBFcTxVVUlEPiA9IFMuRXFcbiAqXG4gKiBjb25zdCBlcVVzZXJCeUtleTogRXE8VXNlcj4gPSBwaXBlKFxuICogICBlcVVVSUQsXG4gKiAgIGNvbnRyYW1hcCgodXNlcikgPT4gdXNlci5rZXkpXG4gKiApXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChcbiAqICAgZXFVc2VyQnlLZXkuZXF1YWxzKFxuICogICAgIHsga2V5OiAnazEnLCBmaXJzdE5hbWU6ICdhMScsIGxhc3ROYW1lOiAnYjEnIH0sXG4gKiAgICAgeyBrZXk6ICdrMicsIGZpcnN0TmFtZTogJ2ExJywgbGFzdE5hbWU6ICdiMScgfVxuICogICApLFxuICogICBmYWxzZVxuICogKVxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChcbiAqICAgZXFVc2VyQnlLZXkuZXF1YWxzKFxuICogICAgIHsga2V5OiAnazEnLCBmaXJzdE5hbWU6ICdhMScsIGxhc3ROYW1lOiAnYjEnIH0sXG4gKiAgICAgeyBrZXk6ICdrMScsIGZpcnN0TmFtZTogJ2EyJywgbGFzdE5hbWU6ICdiMScgfVxuICogICApLFxuICogICB0cnVlXG4gKiApXG4gKlxuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgY29udHJhbWFwID0gZnVuY3Rpb24gKGYpIHsgcmV0dXJuIGZ1bmN0aW9uIChmYSkge1xuICAgIHJldHVybiBmcm9tRXF1YWxzKGZ1bmN0aW9uICh4LCB5KSB7IHJldHVybiBmYS5lcXVhbHMoZih4KSwgZih5KSk7IH0pO1xufTsgfTtcbi8qKlxuICogQGNhdGVnb3J5IHR5cGUgbGFtYmRhc1xuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgVVJJID0gJ0VxJztcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgZXFTdHJpY3QgPSB7XG4gICAgZXF1YWxzOiBmdW5jdGlvbiAoYSwgYikgeyByZXR1cm4gYSA9PT0gYjsgfVxufTtcbnZhciBlbXB0eSA9IHtcbiAgICBlcXVhbHM6IGZ1bmN0aW9uICgpIHsgcmV0dXJuIHRydWU7IH1cbn07XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjEwLjBcbiAqL1xuZXhwb3J0IHZhciBnZXRTZW1pZ3JvdXAgPSBmdW5jdGlvbiAoKSB7IHJldHVybiAoe1xuICAgIGNvbmNhdDogZnVuY3Rpb24gKHgsIHkpIHsgcmV0dXJuIGZyb21FcXVhbHMoZnVuY3Rpb24gKGEsIGIpIHsgcmV0dXJuIHguZXF1YWxzKGEsIGIpICYmIHkuZXF1YWxzKGEsIGIpOyB9KTsgfVxufSk7IH07XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjYuMFxuICovXG5leHBvcnQgdmFyIGdldE1vbm9pZCA9IGZ1bmN0aW9uICgpIHsgcmV0dXJuICh7XG4gICAgY29uY2F0OiBnZXRTZW1pZ3JvdXAoKS5jb25jYXQsXG4gICAgZW1wdHk6IGVtcHR5XG59KTsgfTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuNy4wXG4gKi9cbmV4cG9ydCB2YXIgQ29udHJhdmFyaWFudCA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICBjb250cmFtYXA6IGNvbnRyYW1hcF9cbn07XG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vLyBkZXByZWNhdGVkXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vKipcbiAqIFVzZSBbYHR1cGxlYF0oI3R1cGxlKSBpbnN0ZWFkLlxuICpcbiAqIEBjYXRlZ29yeSB6b25lIG9mIGRlYXRoXG4gKiBAc2luY2UgMi4wLjBcbiAqIEBkZXByZWNhdGVkXG4gKi9cbmV4cG9ydCB2YXIgZ2V0VHVwbGVFcSA9IHR1cGxlO1xuLyoqXG4gKiBVc2UgW2BzdHJ1Y3RgXSgjc3RydWN0KSBpbnN0ZWFkLlxuICpcbiAqIEBjYXRlZ29yeSB6b25lIG9mIGRlYXRoXG4gKiBAc2luY2UgMi4wLjBcbiAqIEBkZXByZWNhdGVkXG4gKi9cbmV4cG9ydCB2YXIgZ2V0U3RydWN0RXEgPSBzdHJ1Y3Q7XG4vKipcbiAqIFVzZSBbYGVxU3RyaWN0YF0oI2Vxc3RyaWN0KSBpbnN0ZWFkXG4gKlxuICogQGNhdGVnb3J5IHpvbmUgb2YgZGVhdGhcbiAqIEBzaW5jZSAyLjAuMFxuICogQGRlcHJlY2F0ZWRcbiAqL1xuZXhwb3J0IHZhciBzdHJpY3RFcXVhbCA9IGVxU3RyaWN0LmVxdWFscztcbi8qKlxuICogVGhpcyBpbnN0YW5jZSBpcyBkZXByZWNhdGVkLCB1c2Ugc21hbGwsIHNwZWNpZmljIGluc3RhbmNlcyBpbnN0ZWFkLlxuICogRm9yIGV4YW1wbGUgaWYgYSBmdW5jdGlvbiBuZWVkcyBhIGBDb250cmF2YXJpYW50YCBpbnN0YW5jZSwgcGFzcyBgRS5Db250cmF2YXJpYW50YCBpbnN0ZWFkIG9mIGBFLmVxYFxuICogKHdoZXJlIGBFYCBpcyBmcm9tIGBpbXBvcnQgRSBmcm9tICdmcC10cy9FcSdgKVxuICpcbiAqIEBjYXRlZ29yeSB6b25lIG9mIGRlYXRoXG4gKiBAc2luY2UgMi4wLjBcbiAqIEBkZXByZWNhdGVkXG4gKi9cbmV4cG9ydCB2YXIgZXEgPSBDb250cmF2YXJpYW50O1xuLyoqXG4gKiBVc2UgW2BFcWBdKC4vYm9vbGVhbi50cy5odG1sI2VxKSBpbnN0ZWFkLlxuICpcbiAqIEBjYXRlZ29yeSB6b25lIG9mIGRlYXRoXG4gKiBAc2luY2UgMi4wLjBcbiAqIEBkZXByZWNhdGVkXG4gKi9cbmV4cG9ydCB2YXIgZXFCb29sZWFuID0gZXFTdHJpY3Q7XG4vKipcbiAqIFVzZSBbYEVxYF0oLi9zdHJpbmcudHMuaHRtbCNlcSkgaW5zdGVhZC5cbiAqXG4gKiBAY2F0ZWdvcnkgem9uZSBvZiBkZWF0aFxuICogQHNpbmNlIDIuMC4wXG4gKiBAZGVwcmVjYXRlZFxuICovXG5leHBvcnQgdmFyIGVxU3RyaW5nID0gZXFTdHJpY3Q7XG4vKipcbiAqIFVzZSBbYEVxYF0oLi9udW1iZXIudHMuaHRtbCNlcSkgaW5zdGVhZC5cbiAqXG4gKiBAY2F0ZWdvcnkgem9uZSBvZiBkZWF0aFxuICogQHNpbmNlIDIuMC4wXG4gKiBAZGVwcmVjYXRlZFxuICovXG5leHBvcnQgdmFyIGVxTnVtYmVyID0gZXFTdHJpY3Q7XG4vKipcbiAqIFVzZSBbYEVxYF0oLi9EYXRlLnRzLmh0bWwjZXEpIGluc3RlYWQuXG4gKlxuICogQGNhdGVnb3J5IHpvbmUgb2YgZGVhdGhcbiAqIEBzaW5jZSAyLjAuMFxuICogQGRlcHJlY2F0ZWRcbiAqL1xuZXhwb3J0IHZhciBlcURhdGUgPSB7XG4gICAgZXF1YWxzOiBmdW5jdGlvbiAoZmlyc3QsIHNlY29uZCkgeyByZXR1cm4gZmlyc3QudmFsdWVPZigpID09PSBzZWNvbmQudmFsdWVPZigpOyB9XG59O1xuIiwKICAiaW1wb3J0IHsgZXFTdHJpY3QgfSBmcm9tICcuL0VxJztcbmltcG9ydCB7IGNvbnN0YW50LCBjb25zdFRydWUsIHBpcGUgfSBmcm9tICcuL2Z1bmN0aW9uJztcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8vIGRlZmF1bHRzXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vKipcbiAqIEBjYXRlZ29yeSBkZWZhdWx0c1xuICogQHNpbmNlIDIuMTAuMFxuICovXG5leHBvcnQgdmFyIGVxdWFsc0RlZmF1bHQgPSBmdW5jdGlvbiAoY29tcGFyZSkge1xuICAgIHJldHVybiBmdW5jdGlvbiAoZmlyc3QsIHNlY29uZCkge1xuICAgICAgICByZXR1cm4gZmlyc3QgPT09IHNlY29uZCB8fCBjb21wYXJlKGZpcnN0LCBzZWNvbmQpID09PSAwO1xuICAgIH07XG59O1xuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLy8gY29uc3RydWN0b3JzXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vKipcbiAqIEBjYXRlZ29yeSBjb25zdHJ1Y3RvcnNcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIGZyb21Db21wYXJlID0gZnVuY3Rpb24gKGNvbXBhcmUpIHsgcmV0dXJuICh7XG4gICAgZXF1YWxzOiBlcXVhbHNEZWZhdWx0KGNvbXBhcmUpLFxuICAgIGNvbXBhcmU6IGZ1bmN0aW9uIChmaXJzdCwgc2Vjb25kKSB7IHJldHVybiAoZmlyc3QgPT09IHNlY29uZCA/IDAgOiBjb21wYXJlKGZpcnN0LCBzZWNvbmQpKTsgfVxufSk7IH07XG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vLyBjb21iaW5hdG9yc1xuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLyoqXG4gKiBHaXZlbiBhIHR1cGxlIG9mIGBPcmRgcyByZXR1cm5zIGFuIGBPcmRgIGZvciB0aGUgdHVwbGUuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IHR1cGxlIH0gZnJvbSAnZnAtdHMvT3JkJ1xuICogaW1wb3J0ICogYXMgQiBmcm9tICdmcC10cy9ib29sZWFuJ1xuICogaW1wb3J0ICogYXMgUyBmcm9tICdmcC10cy9zdHJpbmcnXG4gKiBpbXBvcnQgKiBhcyBOIGZyb20gJ2ZwLXRzL251bWJlcidcbiAqXG4gKiBjb25zdCBPID0gdHVwbGUoUy5PcmQsIE4uT3JkLCBCLk9yZClcbiAqIGFzc2VydC5zdHJpY3RFcXVhbChPLmNvbXBhcmUoWydhJywgMSwgdHJ1ZV0sIFsnYicsIDIsIHRydWVdKSwgLTEpXG4gKiBhc3NlcnQuc3RyaWN0RXF1YWwoTy5jb21wYXJlKFsnYScsIDEsIHRydWVdLCBbJ2EnLCAyLCB0cnVlXSksIC0xKVxuICogYXNzZXJ0LnN0cmljdEVxdWFsKE8uY29tcGFyZShbJ2EnLCAxLCB0cnVlXSwgWydhJywgMSwgZmFsc2VdKSwgMSlcbiAqXG4gKiBAc2luY2UgMi4xMC4wXG4gKi9cbmV4cG9ydCB2YXIgdHVwbGUgPSBmdW5jdGlvbiAoKSB7XG4gICAgdmFyIG9yZHMgPSBbXTtcbiAgICBmb3IgKHZhciBfaSA9IDA7IF9pIDwgYXJndW1lbnRzLmxlbmd0aDsgX2krKykge1xuICAgICAgICBvcmRzW19pXSA9IGFyZ3VtZW50c1tfaV07XG4gICAgfVxuICAgIHJldHVybiBmcm9tQ29tcGFyZShmdW5jdGlvbiAoZmlyc3QsIHNlY29uZCkge1xuICAgICAgICB2YXIgaSA9IDA7XG4gICAgICAgIGZvciAoOyBpIDwgb3Jkcy5sZW5ndGggLSAxOyBpKyspIHtcbiAgICAgICAgICAgIHZhciByID0gb3Jkc1tpXS5jb21wYXJlKGZpcnN0W2ldLCBzZWNvbmRbaV0pO1xuICAgICAgICAgICAgaWYgKHIgIT09IDApIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gcjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gb3Jkc1tpXS5jb21wYXJlKGZpcnN0W2ldLCBzZWNvbmRbaV0pO1xuICAgIH0pO1xufTtcbi8qKlxuICogQHNpbmNlIDIuMTAuMFxuICovXG5leHBvcnQgdmFyIHJldmVyc2UgPSBmdW5jdGlvbiAoTykgeyByZXR1cm4gZnJvbUNvbXBhcmUoZnVuY3Rpb24gKGZpcnN0LCBzZWNvbmQpIHsgcmV0dXJuIE8uY29tcGFyZShzZWNvbmQsIGZpcnN0KTsgfSk7IH07XG4vKiBpc3RhbmJ1bCBpZ25vcmUgbmV4dCAqL1xudmFyIGNvbnRyYW1hcF8gPSBmdW5jdGlvbiAoZmEsIGYpIHsgcmV0dXJuIHBpcGUoZmEsIGNvbnRyYW1hcChmKSk7IH07XG4vKipcbiAqIEEgdHlwaWNhbCB1c2UgY2FzZSBmb3IgYGNvbnRyYW1hcGAgd291bGQgYmUgbGlrZSwgZ2l2ZW4gc29tZSBgVXNlcmAgdHlwZSwgdG8gY29uc3RydWN0IGFuIGBPcmQ8VXNlcj5gLlxuICpcbiAqIFdlIGNhbiBkbyBzbyB3aXRoIGEgZnVuY3Rpb24gZnJvbSBgVXNlciAtPiBYYCB3aGVyZSBgWGAgaXMgc29tZSB2YWx1ZSB0aGF0IHdlIGtub3cgaG93IHRvIGNvbXBhcmVcbiAqIGZvciBvcmRlcmluZyAobWVhbmluZyB3ZSBoYXZlIGFuIGBPcmQ8WD5gKVxuICpcbiAqIEZvciBleGFtcGxlLCBnaXZlbiB0aGUgZm9sbG93aW5nIGBVc2VyYCB0eXBlLCB0aGVyZSBhcmUgbG90cyBvZiBwb3NzaWJsZSBjaG9pY2VzIGZvciBgWGAsXG4gKiBidXQgbGV0J3Mgc2F5IHdlIHdhbnQgdG8gc29ydCBhIGxpc3Qgb2YgdXNlcnMgYnkgYGxhc3ROYW1lYC5cbiAqXG4gKiBJZiB3ZSBoYXZlIGEgd2F5IG9mIGNvbXBhcmluZyBgbGFzdE5hbWVgcyBmb3Igb3JkZXJpbmcgKGBvcmRMYXN0TmFtZTogT3JkPHN0cmluZz5gKSBhbmQgd2Uga25vdyBob3cgdG8gZ28gZnJvbSBgVXNlciAtPiBzdHJpbmdgLFxuICogdXNpbmcgYGNvbnRyYW1hcGAgd2UgY2FuIGRvIHRoaXNcbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgcGlwZSB9IGZyb20gJ2ZwLXRzL2Z1bmN0aW9uJ1xuICogaW1wb3J0IHsgY29udHJhbWFwLCBPcmQgfSBmcm9tICdmcC10cy9PcmQnXG4gKiBpbXBvcnQgKiBhcyBSQSBmcm9tICdmcC10cy9SZWFkb25seUFycmF5J1xuICogaW1wb3J0ICogYXMgUyBmcm9tICdmcC10cy9zdHJpbmcnXG4gKlxuICogaW50ZXJmYWNlIFVzZXIge1xuICogICByZWFkb25seSBmaXJzdE5hbWU6IHN0cmluZ1xuICogICByZWFkb25seSBsYXN0TmFtZTogc3RyaW5nXG4gKiB9XG4gKlxuICogY29uc3Qgb3JkTGFzdE5hbWU6IE9yZDxzdHJpbmc+ID0gUy5PcmRcbiAqXG4gKiBjb25zdCBvcmRCeUxhc3ROYW1lOiBPcmQ8VXNlcj4gPSBwaXBlKFxuICogICBvcmRMYXN0TmFtZSxcbiAqICAgY29udHJhbWFwKCh1c2VyKSA9PiB1c2VyLmxhc3ROYW1lKVxuICogKVxuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoXG4gKiAgIFJBLnNvcnQob3JkQnlMYXN0TmFtZSkoW1xuICogICAgIHsgZmlyc3ROYW1lOiAnYScsIGxhc3ROYW1lOiAnZCcgfSxcbiAqICAgICB7IGZpcnN0TmFtZTogJ2MnLCBsYXN0TmFtZTogJ2InIH1cbiAqICAgXSksXG4gKiAgIFtcbiAqICAgICB7IGZpcnN0TmFtZTogJ2MnLCBsYXN0TmFtZTogJ2InIH0sXG4gKiAgICAgeyBmaXJzdE5hbWU6ICdhJywgbGFzdE5hbWU6ICdkJyB9XG4gKiAgIF1cbiAqIClcbiAqXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciBjb250cmFtYXAgPSBmdW5jdGlvbiAoZikgeyByZXR1cm4gZnVuY3Rpb24gKGZhKSB7XG4gICAgcmV0dXJuIGZyb21Db21wYXJlKGZ1bmN0aW9uIChmaXJzdCwgc2Vjb25kKSB7IHJldHVybiBmYS5jb21wYXJlKGYoZmlyc3QpLCBmKHNlY29uZCkpOyB9KTtcbn07IH07XG4vKipcbiAqIEBjYXRlZ29yeSB0eXBlIGxhbWJkYXNcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIFVSSSA9ICdPcmQnO1xuLyoqXG4gKiBBIHR5cGljYWwgdXNlIGNhc2UgZm9yIHRoZSBgU2VtaWdyb3VwYCBpbnN0YW5jZSBvZiBgT3JkYCBpcyBtZXJnaW5nIHR3byBvciBtb3JlIG9yZGVyaW5ncy5cbiAqXG4gKiBGb3IgZXhhbXBsZSB0aGUgZm9sbG93aW5nIHNuaXBwZXQgYnVpbGRzIGFuIGBPcmRgIGZvciBhIHR5cGUgYFVzZXJgIHdoaWNoXG4gKiBzb3J0cyBieSBgY3JlYXRlZGAgZGF0ZSBkZXNjZW5kaW5nLCBhbmQgKip0aGVuKiogYGxhc3ROYW1lYFxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgKiBhcyBEIGZyb20gJ2ZwLXRzL0RhdGUnXG4gKiBpbXBvcnQgeyBwaXBlIH0gZnJvbSAnZnAtdHMvZnVuY3Rpb24nXG4gKiBpbXBvcnQgeyBjb250cmFtYXAsIGdldFNlbWlncm91cCwgT3JkLCByZXZlcnNlIH0gZnJvbSAnZnAtdHMvT3JkJ1xuICogaW1wb3J0ICogYXMgUkEgZnJvbSAnZnAtdHMvUmVhZG9ubHlBcnJheSdcbiAqIGltcG9ydCAqIGFzIFMgZnJvbSAnZnAtdHMvc3RyaW5nJ1xuICpcbiAqIGludGVyZmFjZSBVc2VyIHtcbiAqICAgcmVhZG9ubHkgaWQ6IHN0cmluZ1xuICogICByZWFkb25seSBsYXN0TmFtZTogc3RyaW5nXG4gKiAgIHJlYWRvbmx5IGNyZWF0ZWQ6IERhdGVcbiAqIH1cbiAqXG4gKiBjb25zdCBvcmRCeUxhc3ROYW1lOiBPcmQ8VXNlcj4gPSBwaXBlKFxuICogICBTLk9yZCxcbiAqICAgY29udHJhbWFwKCh1c2VyKSA9PiB1c2VyLmxhc3ROYW1lKVxuICogKVxuICpcbiAqIGNvbnN0IG9yZEJ5Q3JlYXRlZDogT3JkPFVzZXI+ID0gcGlwZShcbiAqICAgRC5PcmQsXG4gKiAgIGNvbnRyYW1hcCgodXNlcikgPT4gdXNlci5jcmVhdGVkKVxuICogKVxuICpcbiAqIGNvbnN0IG9yZFVzZXJCeUNyZWF0ZWREZXNjVGhlbkxhc3ROYW1lID0gZ2V0U2VtaWdyb3VwPFVzZXI+KCkuY29uY2F0KFxuICogICByZXZlcnNlKG9yZEJ5Q3JlYXRlZCksXG4gKiAgIG9yZEJ5TGFzdE5hbWVcbiAqIClcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKFxuICogICBSQS5zb3J0KG9yZFVzZXJCeUNyZWF0ZWREZXNjVGhlbkxhc3ROYW1lKShbXG4gKiAgICAgeyBpZDogJ2MnLCBsYXN0TmFtZTogJ2QnLCBjcmVhdGVkOiBuZXcgRGF0ZSgxOTczLCAxMCwgMzApIH0sXG4gKiAgICAgeyBpZDogJ2EnLCBsYXN0TmFtZTogJ2InLCBjcmVhdGVkOiBuZXcgRGF0ZSgxOTczLCAxMCwgMzApIH0sXG4gKiAgICAgeyBpZDogJ2UnLCBsYXN0TmFtZTogJ2YnLCBjcmVhdGVkOiBuZXcgRGF0ZSgxOTgwLCAxMCwgMzApIH1cbiAqICAgXSksXG4gKiAgIFtcbiAqICAgICB7IGlkOiAnZScsIGxhc3ROYW1lOiAnZicsIGNyZWF0ZWQ6IG5ldyBEYXRlKDE5ODAsIDEwLCAzMCkgfSxcbiAqICAgICB7IGlkOiAnYScsIGxhc3ROYW1lOiAnYicsIGNyZWF0ZWQ6IG5ldyBEYXRlKDE5NzMsIDEwLCAzMCkgfSxcbiAqICAgICB7IGlkOiAnYycsIGxhc3ROYW1lOiAnZCcsIGNyZWF0ZWQ6IG5ldyBEYXRlKDE5NzMsIDEwLCAzMCkgfVxuICogICBdXG4gKiApXG4gKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgZ2V0U2VtaWdyb3VwID0gZnVuY3Rpb24gKCkgeyByZXR1cm4gKHtcbiAgICBjb25jYXQ6IGZ1bmN0aW9uIChmaXJzdCwgc2Vjb25kKSB7XG4gICAgICAgIHJldHVybiBmcm9tQ29tcGFyZShmdW5jdGlvbiAoYSwgYikge1xuICAgICAgICAgICAgdmFyIG94ID0gZmlyc3QuY29tcGFyZShhLCBiKTtcbiAgICAgICAgICAgIHJldHVybiBveCAhPT0gMCA/IG94IDogc2Vjb25kLmNvbXBhcmUoYSwgYik7XG4gICAgICAgIH0pO1xuICAgIH1cbn0pOyB9O1xuLyoqXG4gKiBSZXR1cm5zIGEgYE1vbm9pZGAgc3VjaCB0aGF0OlxuICpcbiAqIC0gaXRzIGBjb25jYXQob3JkMSwgb3JkMilgIG9wZXJhdGlvbiB3aWxsIG9yZGVyIGZpcnN0IGJ5IGBvcmQxYCwgYW5kIHRoZW4gYnkgYG9yZDJgXG4gKiAtIGl0cyBgZW1wdHlgIHZhbHVlIGlzIGFuIGBPcmRgIHRoYXQgYWx3YXlzIGNvbnNpZGVycyBjb21wYXJlZCBlbGVtZW50cyBlcXVhbFxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBzb3J0IH0gZnJvbSAnZnAtdHMvQXJyYXknXG4gKiBpbXBvcnQgeyBjb250cmFtYXAsIHJldmVyc2UsIGdldE1vbm9pZCB9IGZyb20gJ2ZwLXRzL09yZCdcbiAqIGltcG9ydCAqIGFzIFMgZnJvbSAnZnAtdHMvc3RyaW5nJ1xuICogaW1wb3J0ICogYXMgQiBmcm9tICdmcC10cy9ib29sZWFuJ1xuICogaW1wb3J0IHsgcGlwZSB9IGZyb20gJ2ZwLXRzL2Z1bmN0aW9uJ1xuICogaW1wb3J0IHsgY29uY2F0QWxsIH0gZnJvbSAnZnAtdHMvTW9ub2lkJ1xuICogaW1wb3J0ICogYXMgTiBmcm9tICdmcC10cy9udW1iZXInXG4gKlxuICogaW50ZXJmYWNlIFVzZXIge1xuICogICByZWFkb25seSBpZDogbnVtYmVyXG4gKiAgIHJlYWRvbmx5IG5hbWU6IHN0cmluZ1xuICogICByZWFkb25seSBhZ2U6IG51bWJlclxuICogICByZWFkb25seSByZW1lbWJlck1lOiBib29sZWFuXG4gKiB9XG4gKlxuICogY29uc3QgYnlOYW1lID0gcGlwZShcbiAqICAgUy5PcmQsXG4gKiAgIGNvbnRyYW1hcCgocDogVXNlcikgPT4gcC5uYW1lKVxuICogKVxuICpcbiAqIGNvbnN0IGJ5QWdlID0gcGlwZShcbiAqICAgTi5PcmQsXG4gKiAgIGNvbnRyYW1hcCgocDogVXNlcikgPT4gcC5hZ2UpXG4gKiApXG4gKlxuICogY29uc3QgYnlSZW1lbWJlck1lID0gcGlwZShcbiAqICAgQi5PcmQsXG4gKiAgIGNvbnRyYW1hcCgocDogVXNlcikgPT4gcC5yZW1lbWJlck1lKVxuICogKVxuICpcbiAqIGNvbnN0IE0gPSBnZXRNb25vaWQ8VXNlcj4oKVxuICpcbiAqIGNvbnN0IHVzZXJzOiBBcnJheTxVc2VyPiA9IFtcbiAqICAgeyBpZDogMSwgbmFtZTogJ0d1aWRvJywgYWdlOiA0NywgcmVtZW1iZXJNZTogZmFsc2UgfSxcbiAqICAgeyBpZDogMiwgbmFtZTogJ0d1aWRvJywgYWdlOiA0NiwgcmVtZW1iZXJNZTogdHJ1ZSB9LFxuICogICB7IGlkOiAzLCBuYW1lOiAnR2l1bGlvJywgYWdlOiA0NCwgcmVtZW1iZXJNZTogZmFsc2UgfSxcbiAqICAgeyBpZDogNCwgbmFtZTogJ0dpdWxpbycsIGFnZTogNDQsIHJlbWVtYmVyTWU6IHRydWUgfVxuICogXVxuICpcbiAqIC8vIHNvcnQgYnkgbmFtZSwgdGhlbiBieSBhZ2UsIHRoZW4gYnkgYHJlbWVtYmVyTWVgXG4gKiBjb25zdCBPMSA9IGNvbmNhdEFsbChNKShbYnlOYW1lLCBieUFnZSwgYnlSZW1lbWJlck1lXSlcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoc29ydChPMSkodXNlcnMpLCBbXG4gKiAgIHsgaWQ6IDMsIG5hbWU6ICdHaXVsaW8nLCBhZ2U6IDQ0LCByZW1lbWJlck1lOiBmYWxzZSB9LFxuICogICB7IGlkOiA0LCBuYW1lOiAnR2l1bGlvJywgYWdlOiA0NCwgcmVtZW1iZXJNZTogdHJ1ZSB9LFxuICogICB7IGlkOiAyLCBuYW1lOiAnR3VpZG8nLCBhZ2U6IDQ2LCByZW1lbWJlck1lOiB0cnVlIH0sXG4gKiAgIHsgaWQ6IDEsIG5hbWU6ICdHdWlkbycsIGFnZTogNDcsIHJlbWVtYmVyTWU6IGZhbHNlIH1cbiAqIF0pXG4gKlxuICogLy8gbm93IGByZW1lbWJlck1lID0gdHJ1ZWAgZmlyc3QsIHRoZW4gYnkgbmFtZSwgdGhlbiBieSBhZ2VcbiAqIGNvbnN0IE8yID0gY29uY2F0QWxsKE0pKFtyZXZlcnNlKGJ5UmVtZW1iZXJNZSksIGJ5TmFtZSwgYnlBZ2VdKVxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChzb3J0KE8yKSh1c2VycyksIFtcbiAqICAgeyBpZDogNCwgbmFtZTogJ0dpdWxpbycsIGFnZTogNDQsIHJlbWVtYmVyTWU6IHRydWUgfSxcbiAqICAgeyBpZDogMiwgbmFtZTogJ0d1aWRvJywgYWdlOiA0NiwgcmVtZW1iZXJNZTogdHJ1ZSB9LFxuICogICB7IGlkOiAzLCBuYW1lOiAnR2l1bGlvJywgYWdlOiA0NCwgcmVtZW1iZXJNZTogZmFsc2UgfSxcbiAqICAgeyBpZDogMSwgbmFtZTogJ0d1aWRvJywgYWdlOiA0NywgcmVtZW1iZXJNZTogZmFsc2UgfVxuICogXSlcbiAqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi40LjBcbiAqL1xuZXhwb3J0IHZhciBnZXRNb25vaWQgPSBmdW5jdGlvbiAoKSB7IHJldHVybiAoe1xuICAgIGNvbmNhdDogZ2V0U2VtaWdyb3VwKCkuY29uY2F0LFxuICAgIGVtcHR5OiBmcm9tQ29tcGFyZShmdW5jdGlvbiAoKSB7IHJldHVybiAwOyB9KVxufSk7IH07XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjcuMFxuICovXG5leHBvcnQgdmFyIENvbnRyYXZhcmlhbnQgPSB7XG4gICAgVVJJOiBVUkksXG4gICAgY29udHJhbWFwOiBjb250cmFtYXBfXG59O1xuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLy8gdXRpbHNcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8qKlxuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIHRyaXZpYWwgPSB7XG4gICAgZXF1YWxzOiBjb25zdFRydWUsXG4gICAgY29tcGFyZTogLyojX19QVVJFX18qLyBjb25zdGFudCgwKVxufTtcbi8qKlxuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIGVxdWFscyA9IGZ1bmN0aW9uIChPKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChzZWNvbmQpIHtcbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIChmaXJzdCkge1xuICAgICAgICAgICAgcmV0dXJuIGZpcnN0ID09PSBzZWNvbmQgfHwgTy5jb21wYXJlKGZpcnN0LCBzZWNvbmQpID09PSAwO1xuICAgICAgICB9O1xuICAgIH07XG59O1xuLy8gVE9ETzogY3VycnkgaW4gdjNcbi8qKlxuICogVGVzdCB3aGV0aGVyIG9uZSB2YWx1ZSBpcyBfc3RyaWN0bHkgbGVzcyB0aGFuXyBhbm90aGVyXG4gKlxuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgbHQgPSBmdW5jdGlvbiAoTykge1xuICAgIHJldHVybiBmdW5jdGlvbiAoZmlyc3QsIHNlY29uZCkge1xuICAgICAgICByZXR1cm4gTy5jb21wYXJlKGZpcnN0LCBzZWNvbmQpID09PSAtMTtcbiAgICB9O1xufTtcbi8vIFRPRE86IGN1cnJ5IGluIHYzXG4vKipcbiAqIFRlc3Qgd2hldGhlciBvbmUgdmFsdWUgaXMgX3N0cmljdGx5IGdyZWF0ZXIgdGhhbl8gYW5vdGhlclxuICpcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIGd0ID0gZnVuY3Rpb24gKE8pIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGZpcnN0LCBzZWNvbmQpIHtcbiAgICAgICAgcmV0dXJuIE8uY29tcGFyZShmaXJzdCwgc2Vjb25kKSA9PT0gMTtcbiAgICB9O1xufTtcbi8vIFRPRE86IGN1cnJ5IGluIHYzXG4vKipcbiAqIFRlc3Qgd2hldGhlciBvbmUgdmFsdWUgaXMgX25vbi1zdHJpY3RseSBsZXNzIHRoYW5fIGFub3RoZXJcbiAqXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciBsZXEgPSBmdW5jdGlvbiAoTykge1xuICAgIHJldHVybiBmdW5jdGlvbiAoZmlyc3QsIHNlY29uZCkge1xuICAgICAgICByZXR1cm4gTy5jb21wYXJlKGZpcnN0LCBzZWNvbmQpICE9PSAxO1xuICAgIH07XG59O1xuLy8gVE9ETzogY3VycnkgaW4gdjNcbi8qKlxuICogVGVzdCB3aGV0aGVyIG9uZSB2YWx1ZSBpcyBfbm9uLXN0cmljdGx5IGdyZWF0ZXIgdGhhbl8gYW5vdGhlclxuICpcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIGdlcSA9IGZ1bmN0aW9uIChPKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChmaXJzdCwgc2Vjb25kKSB7XG4gICAgICAgIHJldHVybiBPLmNvbXBhcmUoZmlyc3QsIHNlY29uZCkgIT09IC0xO1xuICAgIH07XG59O1xuLy8gVE9ETzogY3VycnkgaW4gdjNcbi8qKlxuICogVGFrZSB0aGUgbWluaW11bSBvZiB0d28gdmFsdWVzLiBJZiB0aGV5IGFyZSBjb25zaWRlcmVkIGVxdWFsLCB0aGUgZmlyc3QgYXJndW1lbnQgaXMgY2hvc2VuXG4gKlxuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgbWluID0gZnVuY3Rpb24gKE8pIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGZpcnN0LCBzZWNvbmQpIHtcbiAgICAgICAgcmV0dXJuIGZpcnN0ID09PSBzZWNvbmQgfHwgTy5jb21wYXJlKGZpcnN0LCBzZWNvbmQpIDwgMSA/IGZpcnN0IDogc2Vjb25kO1xuICAgIH07XG59O1xuLy8gVE9ETzogY3VycnkgaW4gdjNcbi8qKlxuICogVGFrZSB0aGUgbWF4aW11bSBvZiB0d28gdmFsdWVzLiBJZiB0aGV5IGFyZSBjb25zaWRlcmVkIGVxdWFsLCB0aGUgZmlyc3QgYXJndW1lbnQgaXMgY2hvc2VuXG4gKlxuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgbWF4ID0gZnVuY3Rpb24gKE8pIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGZpcnN0LCBzZWNvbmQpIHtcbiAgICAgICAgcmV0dXJuIGZpcnN0ID09PSBzZWNvbmQgfHwgTy5jb21wYXJlKGZpcnN0LCBzZWNvbmQpID4gLTEgPyBmaXJzdCA6IHNlY29uZDtcbiAgICB9O1xufTtcbi8qKlxuICogQ2xhbXAgYSB2YWx1ZSBiZXR3ZWVuIGEgbWluaW11bSBhbmQgYSBtYXhpbXVtXG4gKlxuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgY2xhbXAgPSBmdW5jdGlvbiAoTykge1xuICAgIHZhciBtaW5PID0gbWluKE8pO1xuICAgIHZhciBtYXhPID0gbWF4KE8pO1xuICAgIHJldHVybiBmdW5jdGlvbiAobG93LCBoaSkgeyByZXR1cm4gZnVuY3Rpb24gKGEpIHsgcmV0dXJuIG1heE8obWluTyhhLCBoaSksIGxvdyk7IH07IH07XG59O1xuLyoqXG4gKiBUZXN0IHdoZXRoZXIgYSB2YWx1ZSBpcyBiZXR3ZWVuIGEgbWluaW11bSBhbmQgYSBtYXhpbXVtIChpbmNsdXNpdmUpXG4gKlxuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgYmV0d2VlbiA9IGZ1bmN0aW9uIChPKSB7XG4gICAgdmFyIGx0TyA9IGx0KE8pO1xuICAgIHZhciBndE8gPSBndChPKTtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGxvdywgaGkpIHsgcmV0dXJuIGZ1bmN0aW9uIChhKSB7IHJldHVybiBsdE8oYSwgbG93KSB8fCBndE8oYSwgaGkpID8gZmFsc2UgOiB0cnVlOyB9OyB9O1xufTtcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8vIGRlcHJlY2F0ZWRcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8qKlxuICogVXNlIFtgdHVwbGVgXSgjdHVwbGUpIGluc3RlYWQuXG4gKlxuICogQGNhdGVnb3J5IHpvbmUgb2YgZGVhdGhcbiAqIEBzaW5jZSAyLjAuMFxuICogQGRlcHJlY2F0ZWRcbiAqL1xuZXhwb3J0IHZhciBnZXRUdXBsZU9yZCA9IHR1cGxlO1xuLyoqXG4gKiBVc2UgW2ByZXZlcnNlYF0oI3JldmVyc2UpIGluc3RlYWQuXG4gKlxuICogQGNhdGVnb3J5IHpvbmUgb2YgZGVhdGhcbiAqIEBzaW5jZSAyLjAuMFxuICogQGRlcHJlY2F0ZWRcbiAqL1xuZXhwb3J0IHZhciBnZXREdWFsT3JkID0gcmV2ZXJzZTtcbi8qKlxuICogVXNlIFtgQ29udHJhdmFyaWFudGBdKCNjb250cmF2YXJpYW50KSBpbnN0ZWFkLlxuICpcbiAqIEBjYXRlZ29yeSB6b25lIG9mIGRlYXRoXG4gKiBAc2luY2UgMi4wLjBcbiAqIEBkZXByZWNhdGVkXG4gKi9cbmV4cG9ydCB2YXIgb3JkID0gQ29udHJhdmFyaWFudDtcbi8vIGRlZmF1bHQgY29tcGFyZSBmb3IgcHJpbWl0aXZlIHR5cGVzXG5mdW5jdGlvbiBjb21wYXJlKGZpcnN0LCBzZWNvbmQpIHtcbiAgICByZXR1cm4gZmlyc3QgPCBzZWNvbmQgPyAtMSA6IGZpcnN0ID4gc2Vjb25kID8gMSA6IDA7XG59XG52YXIgc3RyaWN0T3JkID0ge1xuICAgIGVxdWFsczogZXFTdHJpY3QuZXF1YWxzLFxuICAgIGNvbXBhcmU6IGNvbXBhcmVcbn07XG4vKipcbiAqIFVzZSBbYE9yZGBdKC4vYm9vbGVhbi50cy5odG1sI29yZCkgaW5zdGVhZC5cbiAqXG4gKiBAY2F0ZWdvcnkgem9uZSBvZiBkZWF0aFxuICogQHNpbmNlIDIuMC4wXG4gKiBAZGVwcmVjYXRlZFxuICovXG5leHBvcnQgdmFyIG9yZEJvb2xlYW4gPSBzdHJpY3RPcmQ7XG4vKipcbiAqIFVzZSBbYE9yZGBdKC4vc3RyaW5nLnRzLmh0bWwjb3JkKSBpbnN0ZWFkLlxuICpcbiAqIEBjYXRlZ29yeSB6b25lIG9mIGRlYXRoXG4gKiBAc2luY2UgMi4wLjBcbiAqIEBkZXByZWNhdGVkXG4gKi9cbmV4cG9ydCB2YXIgb3JkU3RyaW5nID0gc3RyaWN0T3JkO1xuLyoqXG4gKiBVc2UgW2BPcmRgXSguL251bWJlci50cy5odG1sI29yZCkgaW5zdGVhZC5cbiAqXG4gKiBAY2F0ZWdvcnkgem9uZSBvZiBkZWF0aFxuICogQHNpbmNlIDIuMC4wXG4gKiBAZGVwcmVjYXRlZFxuICovXG5leHBvcnQgdmFyIG9yZE51bWJlciA9IHN0cmljdE9yZDtcbi8qKlxuICogVXNlIFtgT3JkYF0oLi9EYXRlLnRzLmh0bWwjb3JkKSBpbnN0ZWFkLlxuICpcbiAqIEBjYXRlZ29yeSB6b25lIG9mIGRlYXRoXG4gKiBAc2luY2UgMi4wLjBcbiAqIEBkZXByZWNhdGVkXG4gKi9cbmV4cG9ydCB2YXIgb3JkRGF0ZSA9IC8qI19fUFVSRV9fKi8gcGlwZShvcmROdW1iZXIsIFxuLyojX19QVVJFX18qL1xuY29udHJhbWFwKGZ1bmN0aW9uIChkYXRlKSB7IHJldHVybiBkYXRlLnZhbHVlT2YoKTsgfSkpO1xuIiwKICAiaW1wb3J0IHsgZXFTdHJpY3QgfSBmcm9tICcuL0VxJztcbmltcG9ydCB7IGNvbnN0YW50LCBjb25zdFRydWUsIHBpcGUgfSBmcm9tICcuL2Z1bmN0aW9uJztcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8vIGRlZmF1bHRzXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vKipcbiAqIEBjYXRlZ29yeSBkZWZhdWx0c1xuICogQHNpbmNlIDIuMTAuMFxuICovXG5leHBvcnQgdmFyIGVxdWFsc0RlZmF1bHQgPSBmdW5jdGlvbiAoY29tcGFyZSkge1xuICAgIHJldHVybiBmdW5jdGlvbiAoZmlyc3QsIHNlY29uZCkge1xuICAgICAgICByZXR1cm4gZmlyc3QgPT09IHNlY29uZCB8fCBjb21wYXJlKGZpcnN0LCBzZWNvbmQpID09PSAwO1xuICAgIH07XG59O1xuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLy8gY29uc3RydWN0b3JzXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vKipcbiAqIEBjYXRlZ29yeSBjb25zdHJ1Y3RvcnNcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIGZyb21Db21wYXJlID0gZnVuY3Rpb24gKGNvbXBhcmUpIHsgcmV0dXJuICh7XG4gICAgZXF1YWxzOiBlcXVhbHNEZWZhdWx0KGNvbXBhcmUpLFxuICAgIGNvbXBhcmU6IGZ1bmN0aW9uIChmaXJzdCwgc2Vjb25kKSB7IHJldHVybiAoZmlyc3QgPT09IHNlY29uZCA/IDAgOiBjb21wYXJlKGZpcnN0LCBzZWNvbmQpKTsgfVxufSk7IH07XG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vLyBjb21iaW5hdG9yc1xuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLyoqXG4gKiBHaXZlbiBhIHR1cGxlIG9mIGBPcmRgcyByZXR1cm5zIGFuIGBPcmRgIGZvciB0aGUgdHVwbGUuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IHR1cGxlIH0gZnJvbSAnZnAtdHMvT3JkJ1xuICogaW1wb3J0ICogYXMgQiBmcm9tICdmcC10cy9ib29sZWFuJ1xuICogaW1wb3J0ICogYXMgUyBmcm9tICdmcC10cy9zdHJpbmcnXG4gKiBpbXBvcnQgKiBhcyBOIGZyb20gJ2ZwLXRzL251bWJlcidcbiAqXG4gKiBjb25zdCBPID0gdHVwbGUoUy5PcmQsIE4uT3JkLCBCLk9yZClcbiAqIGFzc2VydC5zdHJpY3RFcXVhbChPLmNvbXBhcmUoWydhJywgMSwgdHJ1ZV0sIFsnYicsIDIsIHRydWVdKSwgLTEpXG4gKiBhc3NlcnQuc3RyaWN0RXF1YWwoTy5jb21wYXJlKFsnYScsIDEsIHRydWVdLCBbJ2EnLCAyLCB0cnVlXSksIC0xKVxuICogYXNzZXJ0LnN0cmljdEVxdWFsKE8uY29tcGFyZShbJ2EnLCAxLCB0cnVlXSwgWydhJywgMSwgZmFsc2VdKSwgMSlcbiAqXG4gKiBAc2luY2UgMi4xMC4wXG4gKi9cbmV4cG9ydCB2YXIgdHVwbGUgPSBmdW5jdGlvbiAoKSB7XG4gICAgdmFyIG9yZHMgPSBbXTtcbiAgICBmb3IgKHZhciBfaSA9IDA7IF9pIDwgYXJndW1lbnRzLmxlbmd0aDsgX2krKykge1xuICAgICAgICBvcmRzW19pXSA9IGFyZ3VtZW50c1tfaV07XG4gICAgfVxuICAgIHJldHVybiBmcm9tQ29tcGFyZShmdW5jdGlvbiAoZmlyc3QsIHNlY29uZCkge1xuICAgICAgICB2YXIgaSA9IDA7XG4gICAgICAgIGZvciAoOyBpIDwgb3Jkcy5sZW5ndGggLSAxOyBpKyspIHtcbiAgICAgICAgICAgIHZhciByID0gb3Jkc1tpXS5jb21wYXJlKGZpcnN0W2ldLCBzZWNvbmRbaV0pO1xuICAgICAgICAgICAgaWYgKHIgIT09IDApIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gcjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gb3Jkc1tpXS5jb21wYXJlKGZpcnN0W2ldLCBzZWNvbmRbaV0pO1xuICAgIH0pO1xufTtcbi8qKlxuICogQHNpbmNlIDIuMTAuMFxuICovXG5leHBvcnQgdmFyIHJldmVyc2UgPSBmdW5jdGlvbiAoTykgeyByZXR1cm4gZnJvbUNvbXBhcmUoZnVuY3Rpb24gKGZpcnN0LCBzZWNvbmQpIHsgcmV0dXJuIE8uY29tcGFyZShzZWNvbmQsIGZpcnN0KTsgfSk7IH07XG4vKiBpc3RhbmJ1bCBpZ25vcmUgbmV4dCAqL1xudmFyIGNvbnRyYW1hcF8gPSBmdW5jdGlvbiAoZmEsIGYpIHsgcmV0dXJuIHBpcGUoZmEsIGNvbnRyYW1hcChmKSk7IH07XG4vKipcbiAqIEEgdHlwaWNhbCB1c2UgY2FzZSBmb3IgYGNvbnRyYW1hcGAgd291bGQgYmUgbGlrZSwgZ2l2ZW4gc29tZSBgVXNlcmAgdHlwZSwgdG8gY29uc3RydWN0IGFuIGBPcmQ8VXNlcj5gLlxuICpcbiAqIFdlIGNhbiBkbyBzbyB3aXRoIGEgZnVuY3Rpb24gZnJvbSBgVXNlciAtPiBYYCB3aGVyZSBgWGAgaXMgc29tZSB2YWx1ZSB0aGF0IHdlIGtub3cgaG93IHRvIGNvbXBhcmVcbiAqIGZvciBvcmRlcmluZyAobWVhbmluZyB3ZSBoYXZlIGFuIGBPcmQ8WD5gKVxuICpcbiAqIEZvciBleGFtcGxlLCBnaXZlbiB0aGUgZm9sbG93aW5nIGBVc2VyYCB0eXBlLCB0aGVyZSBhcmUgbG90cyBvZiBwb3NzaWJsZSBjaG9pY2VzIGZvciBgWGAsXG4gKiBidXQgbGV0J3Mgc2F5IHdlIHdhbnQgdG8gc29ydCBhIGxpc3Qgb2YgdXNlcnMgYnkgYGxhc3ROYW1lYC5cbiAqXG4gKiBJZiB3ZSBoYXZlIGEgd2F5IG9mIGNvbXBhcmluZyBgbGFzdE5hbWVgcyBmb3Igb3JkZXJpbmcgKGBvcmRMYXN0TmFtZTogT3JkPHN0cmluZz5gKSBhbmQgd2Uga25vdyBob3cgdG8gZ28gZnJvbSBgVXNlciAtPiBzdHJpbmdgLFxuICogdXNpbmcgYGNvbnRyYW1hcGAgd2UgY2FuIGRvIHRoaXNcbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgcGlwZSB9IGZyb20gJ2ZwLXRzL2Z1bmN0aW9uJ1xuICogaW1wb3J0IHsgY29udHJhbWFwLCBPcmQgfSBmcm9tICdmcC10cy9PcmQnXG4gKiBpbXBvcnQgKiBhcyBSQSBmcm9tICdmcC10cy9SZWFkb25seUFycmF5J1xuICogaW1wb3J0ICogYXMgUyBmcm9tICdmcC10cy9zdHJpbmcnXG4gKlxuICogaW50ZXJmYWNlIFVzZXIge1xuICogICByZWFkb25seSBmaXJzdE5hbWU6IHN0cmluZ1xuICogICByZWFkb25seSBsYXN0TmFtZTogc3RyaW5nXG4gKiB9XG4gKlxuICogY29uc3Qgb3JkTGFzdE5hbWU6IE9yZDxzdHJpbmc+ID0gUy5PcmRcbiAqXG4gKiBjb25zdCBvcmRCeUxhc3ROYW1lOiBPcmQ8VXNlcj4gPSBwaXBlKFxuICogICBvcmRMYXN0TmFtZSxcbiAqICAgY29udHJhbWFwKCh1c2VyKSA9PiB1c2VyLmxhc3ROYW1lKVxuICogKVxuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoXG4gKiAgIFJBLnNvcnQob3JkQnlMYXN0TmFtZSkoW1xuICogICAgIHsgZmlyc3ROYW1lOiAnYScsIGxhc3ROYW1lOiAnZCcgfSxcbiAqICAgICB7IGZpcnN0TmFtZTogJ2MnLCBsYXN0TmFtZTogJ2InIH1cbiAqICAgXSksXG4gKiAgIFtcbiAqICAgICB7IGZpcnN0TmFtZTogJ2MnLCBsYXN0TmFtZTogJ2InIH0sXG4gKiAgICAgeyBmaXJzdE5hbWU6ICdhJywgbGFzdE5hbWU6ICdkJyB9XG4gKiAgIF1cbiAqIClcbiAqXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciBjb250cmFtYXAgPSBmdW5jdGlvbiAoZikgeyByZXR1cm4gZnVuY3Rpb24gKGZhKSB7XG4gICAgcmV0dXJuIGZyb21Db21wYXJlKGZ1bmN0aW9uIChmaXJzdCwgc2Vjb25kKSB7IHJldHVybiBmYS5jb21wYXJlKGYoZmlyc3QpLCBmKHNlY29uZCkpOyB9KTtcbn07IH07XG4vKipcbiAqIEBjYXRlZ29yeSB0eXBlIGxhbWJkYXNcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIFVSSSA9ICdPcmQnO1xuLyoqXG4gKiBBIHR5cGljYWwgdXNlIGNhc2UgZm9yIHRoZSBgU2VtaWdyb3VwYCBpbnN0YW5jZSBvZiBgT3JkYCBpcyBtZXJnaW5nIHR3byBvciBtb3JlIG9yZGVyaW5ncy5cbiAqXG4gKiBGb3IgZXhhbXBsZSB0aGUgZm9sbG93aW5nIHNuaXBwZXQgYnVpbGRzIGFuIGBPcmRgIGZvciBhIHR5cGUgYFVzZXJgIHdoaWNoXG4gKiBzb3J0cyBieSBgY3JlYXRlZGAgZGF0ZSBkZXNjZW5kaW5nLCBhbmQgKip0aGVuKiogYGxhc3ROYW1lYFxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgKiBhcyBEIGZyb20gJ2ZwLXRzL0RhdGUnXG4gKiBpbXBvcnQgeyBwaXBlIH0gZnJvbSAnZnAtdHMvZnVuY3Rpb24nXG4gKiBpbXBvcnQgeyBjb250cmFtYXAsIGdldFNlbWlncm91cCwgT3JkLCByZXZlcnNlIH0gZnJvbSAnZnAtdHMvT3JkJ1xuICogaW1wb3J0ICogYXMgUkEgZnJvbSAnZnAtdHMvUmVhZG9ubHlBcnJheSdcbiAqIGltcG9ydCAqIGFzIFMgZnJvbSAnZnAtdHMvc3RyaW5nJ1xuICpcbiAqIGludGVyZmFjZSBVc2VyIHtcbiAqICAgcmVhZG9ubHkgaWQ6IHN0cmluZ1xuICogICByZWFkb25seSBsYXN0TmFtZTogc3RyaW5nXG4gKiAgIHJlYWRvbmx5IGNyZWF0ZWQ6IERhdGVcbiAqIH1cbiAqXG4gKiBjb25zdCBvcmRCeUxhc3ROYW1lOiBPcmQ8VXNlcj4gPSBwaXBlKFxuICogICBTLk9yZCxcbiAqICAgY29udHJhbWFwKCh1c2VyKSA9PiB1c2VyLmxhc3ROYW1lKVxuICogKVxuICpcbiAqIGNvbnN0IG9yZEJ5Q3JlYXRlZDogT3JkPFVzZXI+ID0gcGlwZShcbiAqICAgRC5PcmQsXG4gKiAgIGNvbnRyYW1hcCgodXNlcikgPT4gdXNlci5jcmVhdGVkKVxuICogKVxuICpcbiAqIGNvbnN0IG9yZFVzZXJCeUNyZWF0ZWREZXNjVGhlbkxhc3ROYW1lID0gZ2V0U2VtaWdyb3VwPFVzZXI+KCkuY29uY2F0KFxuICogICByZXZlcnNlKG9yZEJ5Q3JlYXRlZCksXG4gKiAgIG9yZEJ5TGFzdE5hbWVcbiAqIClcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKFxuICogICBSQS5zb3J0KG9yZFVzZXJCeUNyZWF0ZWREZXNjVGhlbkxhc3ROYW1lKShbXG4gKiAgICAgeyBpZDogJ2MnLCBsYXN0TmFtZTogJ2QnLCBjcmVhdGVkOiBuZXcgRGF0ZSgxOTczLCAxMCwgMzApIH0sXG4gKiAgICAgeyBpZDogJ2EnLCBsYXN0TmFtZTogJ2InLCBjcmVhdGVkOiBuZXcgRGF0ZSgxOTczLCAxMCwgMzApIH0sXG4gKiAgICAgeyBpZDogJ2UnLCBsYXN0TmFtZTogJ2YnLCBjcmVhdGVkOiBuZXcgRGF0ZSgxOTgwLCAxMCwgMzApIH1cbiAqICAgXSksXG4gKiAgIFtcbiAqICAgICB7IGlkOiAnZScsIGxhc3ROYW1lOiAnZicsIGNyZWF0ZWQ6IG5ldyBEYXRlKDE5ODAsIDEwLCAzMCkgfSxcbiAqICAgICB7IGlkOiAnYScsIGxhc3ROYW1lOiAnYicsIGNyZWF0ZWQ6IG5ldyBEYXRlKDE5NzMsIDEwLCAzMCkgfSxcbiAqICAgICB7IGlkOiAnYycsIGxhc3ROYW1lOiAnZCcsIGNyZWF0ZWQ6IG5ldyBEYXRlKDE5NzMsIDEwLCAzMCkgfVxuICogICBdXG4gKiApXG4gKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgZ2V0U2VtaWdyb3VwID0gZnVuY3Rpb24gKCkgeyByZXR1cm4gKHtcbiAgICBjb25jYXQ6IGZ1bmN0aW9uIChmaXJzdCwgc2Vjb25kKSB7XG4gICAgICAgIHJldHVybiBmcm9tQ29tcGFyZShmdW5jdGlvbiAoYSwgYikge1xuICAgICAgICAgICAgdmFyIG94ID0gZmlyc3QuY29tcGFyZShhLCBiKTtcbiAgICAgICAgICAgIHJldHVybiBveCAhPT0gMCA/IG94IDogc2Vjb25kLmNvbXBhcmUoYSwgYik7XG4gICAgICAgIH0pO1xuICAgIH1cbn0pOyB9O1xuLyoqXG4gKiBSZXR1cm5zIGEgYE1vbm9pZGAgc3VjaCB0aGF0OlxuICpcbiAqIC0gaXRzIGBjb25jYXQob3JkMSwgb3JkMilgIG9wZXJhdGlvbiB3aWxsIG9yZGVyIGZpcnN0IGJ5IGBvcmQxYCwgYW5kIHRoZW4gYnkgYG9yZDJgXG4gKiAtIGl0cyBgZW1wdHlgIHZhbHVlIGlzIGFuIGBPcmRgIHRoYXQgYWx3YXlzIGNvbnNpZGVycyBjb21wYXJlZCBlbGVtZW50cyBlcXVhbFxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBzb3J0IH0gZnJvbSAnZnAtdHMvQXJyYXknXG4gKiBpbXBvcnQgeyBjb250cmFtYXAsIHJldmVyc2UsIGdldE1vbm9pZCB9IGZyb20gJ2ZwLXRzL09yZCdcbiAqIGltcG9ydCAqIGFzIFMgZnJvbSAnZnAtdHMvc3RyaW5nJ1xuICogaW1wb3J0ICogYXMgQiBmcm9tICdmcC10cy9ib29sZWFuJ1xuICogaW1wb3J0IHsgcGlwZSB9IGZyb20gJ2ZwLXRzL2Z1bmN0aW9uJ1xuICogaW1wb3J0IHsgY29uY2F0QWxsIH0gZnJvbSAnZnAtdHMvTW9ub2lkJ1xuICogaW1wb3J0ICogYXMgTiBmcm9tICdmcC10cy9udW1iZXInXG4gKlxuICogaW50ZXJmYWNlIFVzZXIge1xuICogICByZWFkb25seSBpZDogbnVtYmVyXG4gKiAgIHJlYWRvbmx5IG5hbWU6IHN0cmluZ1xuICogICByZWFkb25seSBhZ2U6IG51bWJlclxuICogICByZWFkb25seSByZW1lbWJlck1lOiBib29sZWFuXG4gKiB9XG4gKlxuICogY29uc3QgYnlOYW1lID0gcGlwZShcbiAqICAgUy5PcmQsXG4gKiAgIGNvbnRyYW1hcCgocDogVXNlcikgPT4gcC5uYW1lKVxuICogKVxuICpcbiAqIGNvbnN0IGJ5QWdlID0gcGlwZShcbiAqICAgTi5PcmQsXG4gKiAgIGNvbnRyYW1hcCgocDogVXNlcikgPT4gcC5hZ2UpXG4gKiApXG4gKlxuICogY29uc3QgYnlSZW1lbWJlck1lID0gcGlwZShcbiAqICAgQi5PcmQsXG4gKiAgIGNvbnRyYW1hcCgocDogVXNlcikgPT4gcC5yZW1lbWJlck1lKVxuICogKVxuICpcbiAqIGNvbnN0IE0gPSBnZXRNb25vaWQ8VXNlcj4oKVxuICpcbiAqIGNvbnN0IHVzZXJzOiBBcnJheTxVc2VyPiA9IFtcbiAqICAgeyBpZDogMSwgbmFtZTogJ0d1aWRvJywgYWdlOiA0NywgcmVtZW1iZXJNZTogZmFsc2UgfSxcbiAqICAgeyBpZDogMiwgbmFtZTogJ0d1aWRvJywgYWdlOiA0NiwgcmVtZW1iZXJNZTogdHJ1ZSB9LFxuICogICB7IGlkOiAzLCBuYW1lOiAnR2l1bGlvJywgYWdlOiA0NCwgcmVtZW1iZXJNZTogZmFsc2UgfSxcbiAqICAgeyBpZDogNCwgbmFtZTogJ0dpdWxpbycsIGFnZTogNDQsIHJlbWVtYmVyTWU6IHRydWUgfVxuICogXVxuICpcbiAqIC8vIHNvcnQgYnkgbmFtZSwgdGhlbiBieSBhZ2UsIHRoZW4gYnkgYHJlbWVtYmVyTWVgXG4gKiBjb25zdCBPMSA9IGNvbmNhdEFsbChNKShbYnlOYW1lLCBieUFnZSwgYnlSZW1lbWJlck1lXSlcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoc29ydChPMSkodXNlcnMpLCBbXG4gKiAgIHsgaWQ6IDMsIG5hbWU6ICdHaXVsaW8nLCBhZ2U6IDQ0LCByZW1lbWJlck1lOiBmYWxzZSB9LFxuICogICB7IGlkOiA0LCBuYW1lOiAnR2l1bGlvJywgYWdlOiA0NCwgcmVtZW1iZXJNZTogdHJ1ZSB9LFxuICogICB7IGlkOiAyLCBuYW1lOiAnR3VpZG8nLCBhZ2U6IDQ2LCByZW1lbWJlck1lOiB0cnVlIH0sXG4gKiAgIHsgaWQ6IDEsIG5hbWU6ICdHdWlkbycsIGFnZTogNDcsIHJlbWVtYmVyTWU6IGZhbHNlIH1cbiAqIF0pXG4gKlxuICogLy8gbm93IGByZW1lbWJlck1lID0gdHJ1ZWAgZmlyc3QsIHRoZW4gYnkgbmFtZSwgdGhlbiBieSBhZ2VcbiAqIGNvbnN0IE8yID0gY29uY2F0QWxsKE0pKFtyZXZlcnNlKGJ5UmVtZW1iZXJNZSksIGJ5TmFtZSwgYnlBZ2VdKVxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChzb3J0KE8yKSh1c2VycyksIFtcbiAqICAgeyBpZDogNCwgbmFtZTogJ0dpdWxpbycsIGFnZTogNDQsIHJlbWVtYmVyTWU6IHRydWUgfSxcbiAqICAgeyBpZDogMiwgbmFtZTogJ0d1aWRvJywgYWdlOiA0NiwgcmVtZW1iZXJNZTogdHJ1ZSB9LFxuICogICB7IGlkOiAzLCBuYW1lOiAnR2l1bGlvJywgYWdlOiA0NCwgcmVtZW1iZXJNZTogZmFsc2UgfSxcbiAqICAgeyBpZDogMSwgbmFtZTogJ0d1aWRvJywgYWdlOiA0NywgcmVtZW1iZXJNZTogZmFsc2UgfVxuICogXSlcbiAqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi40LjBcbiAqL1xuZXhwb3J0IHZhciBnZXRNb25vaWQgPSBmdW5jdGlvbiAoKSB7IHJldHVybiAoe1xuICAgIGNvbmNhdDogZ2V0U2VtaWdyb3VwKCkuY29uY2F0LFxuICAgIGVtcHR5OiBmcm9tQ29tcGFyZShmdW5jdGlvbiAoKSB7IHJldHVybiAwOyB9KVxufSk7IH07XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjcuMFxuICovXG5leHBvcnQgdmFyIENvbnRyYXZhcmlhbnQgPSB7XG4gICAgVVJJOiBVUkksXG4gICAgY29udHJhbWFwOiBjb250cmFtYXBfXG59O1xuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLy8gdXRpbHNcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8qKlxuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIHRyaXZpYWwgPSB7XG4gICAgZXF1YWxzOiBjb25zdFRydWUsXG4gICAgY29tcGFyZTogLyojX19QVVJFX18qLyBjb25zdGFudCgwKVxufTtcbi8qKlxuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIGVxdWFscyA9IGZ1bmN0aW9uIChPKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChzZWNvbmQpIHtcbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIChmaXJzdCkge1xuICAgICAgICAgICAgcmV0dXJuIGZpcnN0ID09PSBzZWNvbmQgfHwgTy5jb21wYXJlKGZpcnN0LCBzZWNvbmQpID09PSAwO1xuICAgICAgICB9O1xuICAgIH07XG59O1xuLy8gVE9ETzogY3VycnkgaW4gdjNcbi8qKlxuICogVGVzdCB3aGV0aGVyIG9uZSB2YWx1ZSBpcyBfc3RyaWN0bHkgbGVzcyB0aGFuXyBhbm90aGVyXG4gKlxuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgbHQgPSBmdW5jdGlvbiAoTykge1xuICAgIHJldHVybiBmdW5jdGlvbiAoZmlyc3QsIHNlY29uZCkge1xuICAgICAgICByZXR1cm4gTy5jb21wYXJlKGZpcnN0LCBzZWNvbmQpID09PSAtMTtcbiAgICB9O1xufTtcbi8vIFRPRE86IGN1cnJ5IGluIHYzXG4vKipcbiAqIFRlc3Qgd2hldGhlciBvbmUgdmFsdWUgaXMgX3N0cmljdGx5IGdyZWF0ZXIgdGhhbl8gYW5vdGhlclxuICpcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIGd0ID0gZnVuY3Rpb24gKE8pIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGZpcnN0LCBzZWNvbmQpIHtcbiAgICAgICAgcmV0dXJuIE8uY29tcGFyZShmaXJzdCwgc2Vjb25kKSA9PT0gMTtcbiAgICB9O1xufTtcbi8vIFRPRE86IGN1cnJ5IGluIHYzXG4vKipcbiAqIFRlc3Qgd2hldGhlciBvbmUgdmFsdWUgaXMgX25vbi1zdHJpY3RseSBsZXNzIHRoYW5fIGFub3RoZXJcbiAqXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciBsZXEgPSBmdW5jdGlvbiAoTykge1xuICAgIHJldHVybiBmdW5jdGlvbiAoZmlyc3QsIHNlY29uZCkge1xuICAgICAgICByZXR1cm4gTy5jb21wYXJlKGZpcnN0LCBzZWNvbmQpICE9PSAxO1xuICAgIH07XG59O1xuLy8gVE9ETzogY3VycnkgaW4gdjNcbi8qKlxuICogVGVzdCB3aGV0aGVyIG9uZSB2YWx1ZSBpcyBfbm9uLXN0cmljdGx5IGdyZWF0ZXIgdGhhbl8gYW5vdGhlclxuICpcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIGdlcSA9IGZ1bmN0aW9uIChPKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChmaXJzdCwgc2Vjb25kKSB7XG4gICAgICAgIHJldHVybiBPLmNvbXBhcmUoZmlyc3QsIHNlY29uZCkgIT09IC0xO1xuICAgIH07XG59O1xuLy8gVE9ETzogY3VycnkgaW4gdjNcbi8qKlxuICogVGFrZSB0aGUgbWluaW11bSBvZiB0d28gdmFsdWVzLiBJZiB0aGV5IGFyZSBjb25zaWRlcmVkIGVxdWFsLCB0aGUgZmlyc3QgYXJndW1lbnQgaXMgY2hvc2VuXG4gKlxuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgbWluID0gZnVuY3Rpb24gKE8pIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGZpcnN0LCBzZWNvbmQpIHtcbiAgICAgICAgcmV0dXJuIGZpcnN0ID09PSBzZWNvbmQgfHwgTy5jb21wYXJlKGZpcnN0LCBzZWNvbmQpIDwgMSA/IGZpcnN0IDogc2Vjb25kO1xuICAgIH07XG59O1xuLy8gVE9ETzogY3VycnkgaW4gdjNcbi8qKlxuICogVGFrZSB0aGUgbWF4aW11bSBvZiB0d28gdmFsdWVzLiBJZiB0aGV5IGFyZSBjb25zaWRlcmVkIGVxdWFsLCB0aGUgZmlyc3QgYXJndW1lbnQgaXMgY2hvc2VuXG4gKlxuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgbWF4ID0gZnVuY3Rpb24gKE8pIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGZpcnN0LCBzZWNvbmQpIHtcbiAgICAgICAgcmV0dXJuIGZpcnN0ID09PSBzZWNvbmQgfHwgTy5jb21wYXJlKGZpcnN0LCBzZWNvbmQpID4gLTEgPyBmaXJzdCA6IHNlY29uZDtcbiAgICB9O1xufTtcbi8qKlxuICogQ2xhbXAgYSB2YWx1ZSBiZXR3ZWVuIGEgbWluaW11bSBhbmQgYSBtYXhpbXVtXG4gKlxuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgY2xhbXAgPSBmdW5jdGlvbiAoTykge1xuICAgIHZhciBtaW5PID0gbWluKE8pO1xuICAgIHZhciBtYXhPID0gbWF4KE8pO1xuICAgIHJldHVybiBmdW5jdGlvbiAobG93LCBoaSkgeyByZXR1cm4gZnVuY3Rpb24gKGEpIHsgcmV0dXJuIG1heE8obWluTyhhLCBoaSksIGxvdyk7IH07IH07XG59O1xuLyoqXG4gKiBUZXN0IHdoZXRoZXIgYSB2YWx1ZSBpcyBiZXR3ZWVuIGEgbWluaW11bSBhbmQgYSBtYXhpbXVtIChpbmNsdXNpdmUpXG4gKlxuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgYmV0d2VlbiA9IGZ1bmN0aW9uIChPKSB7XG4gICAgdmFyIGx0TyA9IGx0KE8pO1xuICAgIHZhciBndE8gPSBndChPKTtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGxvdywgaGkpIHsgcmV0dXJuIGZ1bmN0aW9uIChhKSB7IHJldHVybiBsdE8oYSwgbG93KSB8fCBndE8oYSwgaGkpID8gZmFsc2UgOiB0cnVlOyB9OyB9O1xufTtcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8vIGRlcHJlY2F0ZWRcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8qKlxuICogVXNlIFtgdHVwbGVgXSgjdHVwbGUpIGluc3RlYWQuXG4gKlxuICogQGNhdGVnb3J5IHpvbmUgb2YgZGVhdGhcbiAqIEBzaW5jZSAyLjAuMFxuICogQGRlcHJlY2F0ZWRcbiAqL1xuZXhwb3J0IHZhciBnZXRUdXBsZU9yZCA9IHR1cGxlO1xuLyoqXG4gKiBVc2UgW2ByZXZlcnNlYF0oI3JldmVyc2UpIGluc3RlYWQuXG4gKlxuICogQGNhdGVnb3J5IHpvbmUgb2YgZGVhdGhcbiAqIEBzaW5jZSAyLjAuMFxuICogQGRlcHJlY2F0ZWRcbiAqL1xuZXhwb3J0IHZhciBnZXREdWFsT3JkID0gcmV2ZXJzZTtcbi8qKlxuICogVXNlIFtgQ29udHJhdmFyaWFudGBdKCNjb250cmF2YXJpYW50KSBpbnN0ZWFkLlxuICpcbiAqIEBjYXRlZ29yeSB6b25lIG9mIGRlYXRoXG4gKiBAc2luY2UgMi4wLjBcbiAqIEBkZXByZWNhdGVkXG4gKi9cbmV4cG9ydCB2YXIgb3JkID0gQ29udHJhdmFyaWFudDtcbi8vIGRlZmF1bHQgY29tcGFyZSBmb3IgcHJpbWl0aXZlIHR5cGVzXG5mdW5jdGlvbiBjb21wYXJlKGZpcnN0LCBzZWNvbmQpIHtcbiAgICByZXR1cm4gZmlyc3QgPCBzZWNvbmQgPyAtMSA6IGZpcnN0ID4gc2Vjb25kID8gMSA6IDA7XG59XG52YXIgc3RyaWN0T3JkID0ge1xuICAgIGVxdWFsczogZXFTdHJpY3QuZXF1YWxzLFxuICAgIGNvbXBhcmU6IGNvbXBhcmVcbn07XG4vKipcbiAqIFVzZSBbYE9yZGBdKC4vYm9vbGVhbi50cy5odG1sI29yZCkgaW5zdGVhZC5cbiAqXG4gKiBAY2F0ZWdvcnkgem9uZSBvZiBkZWF0aFxuICogQHNpbmNlIDIuMC4wXG4gKiBAZGVwcmVjYXRlZFxuICovXG5leHBvcnQgdmFyIG9yZEJvb2xlYW4gPSBzdHJpY3RPcmQ7XG4vKipcbiAqIFVzZSBbYE9yZGBdKC4vc3RyaW5nLnRzLmh0bWwjb3JkKSBpbnN0ZWFkLlxuICpcbiAqIEBjYXRlZ29yeSB6b25lIG9mIGRlYXRoXG4gKiBAc2luY2UgMi4wLjBcbiAqIEBkZXByZWNhdGVkXG4gKi9cbmV4cG9ydCB2YXIgb3JkU3RyaW5nID0gc3RyaWN0T3JkO1xuLyoqXG4gKiBVc2UgW2BPcmRgXSguL251bWJlci50cy5odG1sI29yZCkgaW5zdGVhZC5cbiAqXG4gKiBAY2F0ZWdvcnkgem9uZSBvZiBkZWF0aFxuICogQHNpbmNlIDIuMC4wXG4gKiBAZGVwcmVjYXRlZFxuICovXG5leHBvcnQgdmFyIG9yZE51bWJlciA9IHN0cmljdE9yZDtcbi8qKlxuICogVXNlIFtgT3JkYF0oLi9EYXRlLnRzLmh0bWwjb3JkKSBpbnN0ZWFkLlxuICpcbiAqIEBjYXRlZ29yeSB6b25lIG9mIGRlYXRoXG4gKiBAc2luY2UgMi4wLjBcbiAqIEBkZXByZWNhdGVkXG4gKi9cbmV4cG9ydCB2YXIgb3JkRGF0ZSA9IC8qI19fUFVSRV9fKi8gcGlwZShvcmROdW1iZXIsIFxuLyojX19QVVJFX18qL1xuY29udHJhbWFwKGZ1bmN0aW9uIChkYXRlKSB7IHJldHVybiBkYXRlLnZhbHVlT2YoKTsgfSkpO1xuIiwKICAiaW1wb3J0IHsgZXFTdHJpY3QgfSBmcm9tICcuL0VxJztcbmltcG9ydCB7IGNvbnN0YW50LCBjb25zdFRydWUsIHBpcGUgfSBmcm9tICcuL2Z1bmN0aW9uJztcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8vIGRlZmF1bHRzXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vKipcbiAqIEBjYXRlZ29yeSBkZWZhdWx0c1xuICogQHNpbmNlIDIuMTAuMFxuICovXG5leHBvcnQgdmFyIGVxdWFsc0RlZmF1bHQgPSBmdW5jdGlvbiAoY29tcGFyZSkge1xuICAgIHJldHVybiBmdW5jdGlvbiAoZmlyc3QsIHNlY29uZCkge1xuICAgICAgICByZXR1cm4gZmlyc3QgPT09IHNlY29uZCB8fCBjb21wYXJlKGZpcnN0LCBzZWNvbmQpID09PSAwO1xuICAgIH07XG59O1xuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLy8gY29uc3RydWN0b3JzXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vKipcbiAqIEBjYXRlZ29yeSBjb25zdHJ1Y3RvcnNcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIGZyb21Db21wYXJlID0gZnVuY3Rpb24gKGNvbXBhcmUpIHsgcmV0dXJuICh7XG4gICAgZXF1YWxzOiBlcXVhbHNEZWZhdWx0KGNvbXBhcmUpLFxuICAgIGNvbXBhcmU6IGZ1bmN0aW9uIChmaXJzdCwgc2Vjb25kKSB7IHJldHVybiAoZmlyc3QgPT09IHNlY29uZCA/IDAgOiBjb21wYXJlKGZpcnN0LCBzZWNvbmQpKTsgfVxufSk7IH07XG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vLyBjb21iaW5hdG9yc1xuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLyoqXG4gKiBHaXZlbiBhIHR1cGxlIG9mIGBPcmRgcyByZXR1cm5zIGFuIGBPcmRgIGZvciB0aGUgdHVwbGUuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IHR1cGxlIH0gZnJvbSAnZnAtdHMvT3JkJ1xuICogaW1wb3J0ICogYXMgQiBmcm9tICdmcC10cy9ib29sZWFuJ1xuICogaW1wb3J0ICogYXMgUyBmcm9tICdmcC10cy9zdHJpbmcnXG4gKiBpbXBvcnQgKiBhcyBOIGZyb20gJ2ZwLXRzL251bWJlcidcbiAqXG4gKiBjb25zdCBPID0gdHVwbGUoUy5PcmQsIE4uT3JkLCBCLk9yZClcbiAqIGFzc2VydC5zdHJpY3RFcXVhbChPLmNvbXBhcmUoWydhJywgMSwgdHJ1ZV0sIFsnYicsIDIsIHRydWVdKSwgLTEpXG4gKiBhc3NlcnQuc3RyaWN0RXF1YWwoTy5jb21wYXJlKFsnYScsIDEsIHRydWVdLCBbJ2EnLCAyLCB0cnVlXSksIC0xKVxuICogYXNzZXJ0LnN0cmljdEVxdWFsKE8uY29tcGFyZShbJ2EnLCAxLCB0cnVlXSwgWydhJywgMSwgZmFsc2VdKSwgMSlcbiAqXG4gKiBAc2luY2UgMi4xMC4wXG4gKi9cbmV4cG9ydCB2YXIgdHVwbGUgPSBmdW5jdGlvbiAoKSB7XG4gICAgdmFyIG9yZHMgPSBbXTtcbiAgICBmb3IgKHZhciBfaSA9IDA7IF9pIDwgYXJndW1lbnRzLmxlbmd0aDsgX2krKykge1xuICAgICAgICBvcmRzW19pXSA9IGFyZ3VtZW50c1tfaV07XG4gICAgfVxuICAgIHJldHVybiBmcm9tQ29tcGFyZShmdW5jdGlvbiAoZmlyc3QsIHNlY29uZCkge1xuICAgICAgICB2YXIgaSA9IDA7XG4gICAgICAgIGZvciAoOyBpIDwgb3Jkcy5sZW5ndGggLSAxOyBpKyspIHtcbiAgICAgICAgICAgIHZhciByID0gb3Jkc1tpXS5jb21wYXJlKGZpcnN0W2ldLCBzZWNvbmRbaV0pO1xuICAgICAgICAgICAgaWYgKHIgIT09IDApIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gcjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gb3Jkc1tpXS5jb21wYXJlKGZpcnN0W2ldLCBzZWNvbmRbaV0pO1xuICAgIH0pO1xufTtcbi8qKlxuICogQHNpbmNlIDIuMTAuMFxuICovXG5leHBvcnQgdmFyIHJldmVyc2UgPSBmdW5jdGlvbiAoTykgeyByZXR1cm4gZnJvbUNvbXBhcmUoZnVuY3Rpb24gKGZpcnN0LCBzZWNvbmQpIHsgcmV0dXJuIE8uY29tcGFyZShzZWNvbmQsIGZpcnN0KTsgfSk7IH07XG4vKiBpc3RhbmJ1bCBpZ25vcmUgbmV4dCAqL1xudmFyIGNvbnRyYW1hcF8gPSBmdW5jdGlvbiAoZmEsIGYpIHsgcmV0dXJuIHBpcGUoZmEsIGNvbnRyYW1hcChmKSk7IH07XG4vKipcbiAqIEEgdHlwaWNhbCB1c2UgY2FzZSBmb3IgYGNvbnRyYW1hcGAgd291bGQgYmUgbGlrZSwgZ2l2ZW4gc29tZSBgVXNlcmAgdHlwZSwgdG8gY29uc3RydWN0IGFuIGBPcmQ8VXNlcj5gLlxuICpcbiAqIFdlIGNhbiBkbyBzbyB3aXRoIGEgZnVuY3Rpb24gZnJvbSBgVXNlciAtPiBYYCB3aGVyZSBgWGAgaXMgc29tZSB2YWx1ZSB0aGF0IHdlIGtub3cgaG93IHRvIGNvbXBhcmVcbiAqIGZvciBvcmRlcmluZyAobWVhbmluZyB3ZSBoYXZlIGFuIGBPcmQ8WD5gKVxuICpcbiAqIEZvciBleGFtcGxlLCBnaXZlbiB0aGUgZm9sbG93aW5nIGBVc2VyYCB0eXBlLCB0aGVyZSBhcmUgbG90cyBvZiBwb3NzaWJsZSBjaG9pY2VzIGZvciBgWGAsXG4gKiBidXQgbGV0J3Mgc2F5IHdlIHdhbnQgdG8gc29ydCBhIGxpc3Qgb2YgdXNlcnMgYnkgYGxhc3ROYW1lYC5cbiAqXG4gKiBJZiB3ZSBoYXZlIGEgd2F5IG9mIGNvbXBhcmluZyBgbGFzdE5hbWVgcyBmb3Igb3JkZXJpbmcgKGBvcmRMYXN0TmFtZTogT3JkPHN0cmluZz5gKSBhbmQgd2Uga25vdyBob3cgdG8gZ28gZnJvbSBgVXNlciAtPiBzdHJpbmdgLFxuICogdXNpbmcgYGNvbnRyYW1hcGAgd2UgY2FuIGRvIHRoaXNcbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgcGlwZSB9IGZyb20gJ2ZwLXRzL2Z1bmN0aW9uJ1xuICogaW1wb3J0IHsgY29udHJhbWFwLCBPcmQgfSBmcm9tICdmcC10cy9PcmQnXG4gKiBpbXBvcnQgKiBhcyBSQSBmcm9tICdmcC10cy9SZWFkb25seUFycmF5J1xuICogaW1wb3J0ICogYXMgUyBmcm9tICdmcC10cy9zdHJpbmcnXG4gKlxuICogaW50ZXJmYWNlIFVzZXIge1xuICogICByZWFkb25seSBmaXJzdE5hbWU6IHN0cmluZ1xuICogICByZWFkb25seSBsYXN0TmFtZTogc3RyaW5nXG4gKiB9XG4gKlxuICogY29uc3Qgb3JkTGFzdE5hbWU6IE9yZDxzdHJpbmc+ID0gUy5PcmRcbiAqXG4gKiBjb25zdCBvcmRCeUxhc3ROYW1lOiBPcmQ8VXNlcj4gPSBwaXBlKFxuICogICBvcmRMYXN0TmFtZSxcbiAqICAgY29udHJhbWFwKCh1c2VyKSA9PiB1c2VyLmxhc3ROYW1lKVxuICogKVxuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoXG4gKiAgIFJBLnNvcnQob3JkQnlMYXN0TmFtZSkoW1xuICogICAgIHsgZmlyc3ROYW1lOiAnYScsIGxhc3ROYW1lOiAnZCcgfSxcbiAqICAgICB7IGZpcnN0TmFtZTogJ2MnLCBsYXN0TmFtZTogJ2InIH1cbiAqICAgXSksXG4gKiAgIFtcbiAqICAgICB7IGZpcnN0TmFtZTogJ2MnLCBsYXN0TmFtZTogJ2InIH0sXG4gKiAgICAgeyBmaXJzdE5hbWU6ICdhJywgbGFzdE5hbWU6ICdkJyB9XG4gKiAgIF1cbiAqIClcbiAqXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciBjb250cmFtYXAgPSBmdW5jdGlvbiAoZikgeyByZXR1cm4gZnVuY3Rpb24gKGZhKSB7XG4gICAgcmV0dXJuIGZyb21Db21wYXJlKGZ1bmN0aW9uIChmaXJzdCwgc2Vjb25kKSB7IHJldHVybiBmYS5jb21wYXJlKGYoZmlyc3QpLCBmKHNlY29uZCkpOyB9KTtcbn07IH07XG4vKipcbiAqIEBjYXRlZ29yeSB0eXBlIGxhbWJkYXNcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIFVSSSA9ICdPcmQnO1xuLyoqXG4gKiBBIHR5cGljYWwgdXNlIGNhc2UgZm9yIHRoZSBgU2VtaWdyb3VwYCBpbnN0YW5jZSBvZiBgT3JkYCBpcyBtZXJnaW5nIHR3byBvciBtb3JlIG9yZGVyaW5ncy5cbiAqXG4gKiBGb3IgZXhhbXBsZSB0aGUgZm9sbG93aW5nIHNuaXBwZXQgYnVpbGRzIGFuIGBPcmRgIGZvciBhIHR5cGUgYFVzZXJgIHdoaWNoXG4gKiBzb3J0cyBieSBgY3JlYXRlZGAgZGF0ZSBkZXNjZW5kaW5nLCBhbmQgKip0aGVuKiogYGxhc3ROYW1lYFxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgKiBhcyBEIGZyb20gJ2ZwLXRzL0RhdGUnXG4gKiBpbXBvcnQgeyBwaXBlIH0gZnJvbSAnZnAtdHMvZnVuY3Rpb24nXG4gKiBpbXBvcnQgeyBjb250cmFtYXAsIGdldFNlbWlncm91cCwgT3JkLCByZXZlcnNlIH0gZnJvbSAnZnAtdHMvT3JkJ1xuICogaW1wb3J0ICogYXMgUkEgZnJvbSAnZnAtdHMvUmVhZG9ubHlBcnJheSdcbiAqIGltcG9ydCAqIGFzIFMgZnJvbSAnZnAtdHMvc3RyaW5nJ1xuICpcbiAqIGludGVyZmFjZSBVc2VyIHtcbiAqICAgcmVhZG9ubHkgaWQ6IHN0cmluZ1xuICogICByZWFkb25seSBsYXN0TmFtZTogc3RyaW5nXG4gKiAgIHJlYWRvbmx5IGNyZWF0ZWQ6IERhdGVcbiAqIH1cbiAqXG4gKiBjb25zdCBvcmRCeUxhc3ROYW1lOiBPcmQ8VXNlcj4gPSBwaXBlKFxuICogICBTLk9yZCxcbiAqICAgY29udHJhbWFwKCh1c2VyKSA9PiB1c2VyLmxhc3ROYW1lKVxuICogKVxuICpcbiAqIGNvbnN0IG9yZEJ5Q3JlYXRlZDogT3JkPFVzZXI+ID0gcGlwZShcbiAqICAgRC5PcmQsXG4gKiAgIGNvbnRyYW1hcCgodXNlcikgPT4gdXNlci5jcmVhdGVkKVxuICogKVxuICpcbiAqIGNvbnN0IG9yZFVzZXJCeUNyZWF0ZWREZXNjVGhlbkxhc3ROYW1lID0gZ2V0U2VtaWdyb3VwPFVzZXI+KCkuY29uY2F0KFxuICogICByZXZlcnNlKG9yZEJ5Q3JlYXRlZCksXG4gKiAgIG9yZEJ5TGFzdE5hbWVcbiAqIClcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKFxuICogICBSQS5zb3J0KG9yZFVzZXJCeUNyZWF0ZWREZXNjVGhlbkxhc3ROYW1lKShbXG4gKiAgICAgeyBpZDogJ2MnLCBsYXN0TmFtZTogJ2QnLCBjcmVhdGVkOiBuZXcgRGF0ZSgxOTczLCAxMCwgMzApIH0sXG4gKiAgICAgeyBpZDogJ2EnLCBsYXN0TmFtZTogJ2InLCBjcmVhdGVkOiBuZXcgRGF0ZSgxOTczLCAxMCwgMzApIH0sXG4gKiAgICAgeyBpZDogJ2UnLCBsYXN0TmFtZTogJ2YnLCBjcmVhdGVkOiBuZXcgRGF0ZSgxOTgwLCAxMCwgMzApIH1cbiAqICAgXSksXG4gKiAgIFtcbiAqICAgICB7IGlkOiAnZScsIGxhc3ROYW1lOiAnZicsIGNyZWF0ZWQ6IG5ldyBEYXRlKDE5ODAsIDEwLCAzMCkgfSxcbiAqICAgICB7IGlkOiAnYScsIGxhc3ROYW1lOiAnYicsIGNyZWF0ZWQ6IG5ldyBEYXRlKDE5NzMsIDEwLCAzMCkgfSxcbiAqICAgICB7IGlkOiAnYycsIGxhc3ROYW1lOiAnZCcsIGNyZWF0ZWQ6IG5ldyBEYXRlKDE5NzMsIDEwLCAzMCkgfVxuICogICBdXG4gKiApXG4gKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgZ2V0U2VtaWdyb3VwID0gZnVuY3Rpb24gKCkgeyByZXR1cm4gKHtcbiAgICBjb25jYXQ6IGZ1bmN0aW9uIChmaXJzdCwgc2Vjb25kKSB7XG4gICAgICAgIHJldHVybiBmcm9tQ29tcGFyZShmdW5jdGlvbiAoYSwgYikge1xuICAgICAgICAgICAgdmFyIG94ID0gZmlyc3QuY29tcGFyZShhLCBiKTtcbiAgICAgICAgICAgIHJldHVybiBveCAhPT0gMCA/IG94IDogc2Vjb25kLmNvbXBhcmUoYSwgYik7XG4gICAgICAgIH0pO1xuICAgIH1cbn0pOyB9O1xuLyoqXG4gKiBSZXR1cm5zIGEgYE1vbm9pZGAgc3VjaCB0aGF0OlxuICpcbiAqIC0gaXRzIGBjb25jYXQob3JkMSwgb3JkMilgIG9wZXJhdGlvbiB3aWxsIG9yZGVyIGZpcnN0IGJ5IGBvcmQxYCwgYW5kIHRoZW4gYnkgYG9yZDJgXG4gKiAtIGl0cyBgZW1wdHlgIHZhbHVlIGlzIGFuIGBPcmRgIHRoYXQgYWx3YXlzIGNvbnNpZGVycyBjb21wYXJlZCBlbGVtZW50cyBlcXVhbFxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBzb3J0IH0gZnJvbSAnZnAtdHMvQXJyYXknXG4gKiBpbXBvcnQgeyBjb250cmFtYXAsIHJldmVyc2UsIGdldE1vbm9pZCB9IGZyb20gJ2ZwLXRzL09yZCdcbiAqIGltcG9ydCAqIGFzIFMgZnJvbSAnZnAtdHMvc3RyaW5nJ1xuICogaW1wb3J0ICogYXMgQiBmcm9tICdmcC10cy9ib29sZWFuJ1xuICogaW1wb3J0IHsgcGlwZSB9IGZyb20gJ2ZwLXRzL2Z1bmN0aW9uJ1xuICogaW1wb3J0IHsgY29uY2F0QWxsIH0gZnJvbSAnZnAtdHMvTW9ub2lkJ1xuICogaW1wb3J0ICogYXMgTiBmcm9tICdmcC10cy9udW1iZXInXG4gKlxuICogaW50ZXJmYWNlIFVzZXIge1xuICogICByZWFkb25seSBpZDogbnVtYmVyXG4gKiAgIHJlYWRvbmx5IG5hbWU6IHN0cmluZ1xuICogICByZWFkb25seSBhZ2U6IG51bWJlclxuICogICByZWFkb25seSByZW1lbWJlck1lOiBib29sZWFuXG4gKiB9XG4gKlxuICogY29uc3QgYnlOYW1lID0gcGlwZShcbiAqICAgUy5PcmQsXG4gKiAgIGNvbnRyYW1hcCgocDogVXNlcikgPT4gcC5uYW1lKVxuICogKVxuICpcbiAqIGNvbnN0IGJ5QWdlID0gcGlwZShcbiAqICAgTi5PcmQsXG4gKiAgIGNvbnRyYW1hcCgocDogVXNlcikgPT4gcC5hZ2UpXG4gKiApXG4gKlxuICogY29uc3QgYnlSZW1lbWJlck1lID0gcGlwZShcbiAqICAgQi5PcmQsXG4gKiAgIGNvbnRyYW1hcCgocDogVXNlcikgPT4gcC5yZW1lbWJlck1lKVxuICogKVxuICpcbiAqIGNvbnN0IE0gPSBnZXRNb25vaWQ8VXNlcj4oKVxuICpcbiAqIGNvbnN0IHVzZXJzOiBBcnJheTxVc2VyPiA9IFtcbiAqICAgeyBpZDogMSwgbmFtZTogJ0d1aWRvJywgYWdlOiA0NywgcmVtZW1iZXJNZTogZmFsc2UgfSxcbiAqICAgeyBpZDogMiwgbmFtZTogJ0d1aWRvJywgYWdlOiA0NiwgcmVtZW1iZXJNZTogdHJ1ZSB9LFxuICogICB7IGlkOiAzLCBuYW1lOiAnR2l1bGlvJywgYWdlOiA0NCwgcmVtZW1iZXJNZTogZmFsc2UgfSxcbiAqICAgeyBpZDogNCwgbmFtZTogJ0dpdWxpbycsIGFnZTogNDQsIHJlbWVtYmVyTWU6IHRydWUgfVxuICogXVxuICpcbiAqIC8vIHNvcnQgYnkgbmFtZSwgdGhlbiBieSBhZ2UsIHRoZW4gYnkgYHJlbWVtYmVyTWVgXG4gKiBjb25zdCBPMSA9IGNvbmNhdEFsbChNKShbYnlOYW1lLCBieUFnZSwgYnlSZW1lbWJlck1lXSlcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoc29ydChPMSkodXNlcnMpLCBbXG4gKiAgIHsgaWQ6IDMsIG5hbWU6ICdHaXVsaW8nLCBhZ2U6IDQ0LCByZW1lbWJlck1lOiBmYWxzZSB9LFxuICogICB7IGlkOiA0LCBuYW1lOiAnR2l1bGlvJywgYWdlOiA0NCwgcmVtZW1iZXJNZTogdHJ1ZSB9LFxuICogICB7IGlkOiAyLCBuYW1lOiAnR3VpZG8nLCBhZ2U6IDQ2LCByZW1lbWJlck1lOiB0cnVlIH0sXG4gKiAgIHsgaWQ6IDEsIG5hbWU6ICdHdWlkbycsIGFnZTogNDcsIHJlbWVtYmVyTWU6IGZhbHNlIH1cbiAqIF0pXG4gKlxuICogLy8gbm93IGByZW1lbWJlck1lID0gdHJ1ZWAgZmlyc3QsIHRoZW4gYnkgbmFtZSwgdGhlbiBieSBhZ2VcbiAqIGNvbnN0IE8yID0gY29uY2F0QWxsKE0pKFtyZXZlcnNlKGJ5UmVtZW1iZXJNZSksIGJ5TmFtZSwgYnlBZ2VdKVxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChzb3J0KE8yKSh1c2VycyksIFtcbiAqICAgeyBpZDogNCwgbmFtZTogJ0dpdWxpbycsIGFnZTogNDQsIHJlbWVtYmVyTWU6IHRydWUgfSxcbiAqICAgeyBpZDogMiwgbmFtZTogJ0d1aWRvJywgYWdlOiA0NiwgcmVtZW1iZXJNZTogdHJ1ZSB9LFxuICogICB7IGlkOiAzLCBuYW1lOiAnR2l1bGlvJywgYWdlOiA0NCwgcmVtZW1iZXJNZTogZmFsc2UgfSxcbiAqICAgeyBpZDogMSwgbmFtZTogJ0d1aWRvJywgYWdlOiA0NywgcmVtZW1iZXJNZTogZmFsc2UgfVxuICogXSlcbiAqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi40LjBcbiAqL1xuZXhwb3J0IHZhciBnZXRNb25vaWQgPSBmdW5jdGlvbiAoKSB7IHJldHVybiAoe1xuICAgIGNvbmNhdDogZ2V0U2VtaWdyb3VwKCkuY29uY2F0LFxuICAgIGVtcHR5OiBmcm9tQ29tcGFyZShmdW5jdGlvbiAoKSB7IHJldHVybiAwOyB9KVxufSk7IH07XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjcuMFxuICovXG5leHBvcnQgdmFyIENvbnRyYXZhcmlhbnQgPSB7XG4gICAgVVJJOiBVUkksXG4gICAgY29udHJhbWFwOiBjb250cmFtYXBfXG59O1xuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLy8gdXRpbHNcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8qKlxuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIHRyaXZpYWwgPSB7XG4gICAgZXF1YWxzOiBjb25zdFRydWUsXG4gICAgY29tcGFyZTogLyojX19QVVJFX18qLyBjb25zdGFudCgwKVxufTtcbi8qKlxuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIGVxdWFscyA9IGZ1bmN0aW9uIChPKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChzZWNvbmQpIHtcbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIChmaXJzdCkge1xuICAgICAgICAgICAgcmV0dXJuIGZpcnN0ID09PSBzZWNvbmQgfHwgTy5jb21wYXJlKGZpcnN0LCBzZWNvbmQpID09PSAwO1xuICAgICAgICB9O1xuICAgIH07XG59O1xuLy8gVE9ETzogY3VycnkgaW4gdjNcbi8qKlxuICogVGVzdCB3aGV0aGVyIG9uZSB2YWx1ZSBpcyBfc3RyaWN0bHkgbGVzcyB0aGFuXyBhbm90aGVyXG4gKlxuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgbHQgPSBmdW5jdGlvbiAoTykge1xuICAgIHJldHVybiBmdW5jdGlvbiAoZmlyc3QsIHNlY29uZCkge1xuICAgICAgICByZXR1cm4gTy5jb21wYXJlKGZpcnN0LCBzZWNvbmQpID09PSAtMTtcbiAgICB9O1xufTtcbi8vIFRPRE86IGN1cnJ5IGluIHYzXG4vKipcbiAqIFRlc3Qgd2hldGhlciBvbmUgdmFsdWUgaXMgX3N0cmljdGx5IGdyZWF0ZXIgdGhhbl8gYW5vdGhlclxuICpcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIGd0ID0gZnVuY3Rpb24gKE8pIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGZpcnN0LCBzZWNvbmQpIHtcbiAgICAgICAgcmV0dXJuIE8uY29tcGFyZShmaXJzdCwgc2Vjb25kKSA9PT0gMTtcbiAgICB9O1xufTtcbi8vIFRPRE86IGN1cnJ5IGluIHYzXG4vKipcbiAqIFRlc3Qgd2hldGhlciBvbmUgdmFsdWUgaXMgX25vbi1zdHJpY3RseSBsZXNzIHRoYW5fIGFub3RoZXJcbiAqXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciBsZXEgPSBmdW5jdGlvbiAoTykge1xuICAgIHJldHVybiBmdW5jdGlvbiAoZmlyc3QsIHNlY29uZCkge1xuICAgICAgICByZXR1cm4gTy5jb21wYXJlKGZpcnN0LCBzZWNvbmQpICE9PSAxO1xuICAgIH07XG59O1xuLy8gVE9ETzogY3VycnkgaW4gdjNcbi8qKlxuICogVGVzdCB3aGV0aGVyIG9uZSB2YWx1ZSBpcyBfbm9uLXN0cmljdGx5IGdyZWF0ZXIgdGhhbl8gYW5vdGhlclxuICpcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIGdlcSA9IGZ1bmN0aW9uIChPKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChmaXJzdCwgc2Vjb25kKSB7XG4gICAgICAgIHJldHVybiBPLmNvbXBhcmUoZmlyc3QsIHNlY29uZCkgIT09IC0xO1xuICAgIH07XG59O1xuLy8gVE9ETzogY3VycnkgaW4gdjNcbi8qKlxuICogVGFrZSB0aGUgbWluaW11bSBvZiB0d28gdmFsdWVzLiBJZiB0aGV5IGFyZSBjb25zaWRlcmVkIGVxdWFsLCB0aGUgZmlyc3QgYXJndW1lbnQgaXMgY2hvc2VuXG4gKlxuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgbWluID0gZnVuY3Rpb24gKE8pIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGZpcnN0LCBzZWNvbmQpIHtcbiAgICAgICAgcmV0dXJuIGZpcnN0ID09PSBzZWNvbmQgfHwgTy5jb21wYXJlKGZpcnN0LCBzZWNvbmQpIDwgMSA/IGZpcnN0IDogc2Vjb25kO1xuICAgIH07XG59O1xuLy8gVE9ETzogY3VycnkgaW4gdjNcbi8qKlxuICogVGFrZSB0aGUgbWF4aW11bSBvZiB0d28gdmFsdWVzLiBJZiB0aGV5IGFyZSBjb25zaWRlcmVkIGVxdWFsLCB0aGUgZmlyc3QgYXJndW1lbnQgaXMgY2hvc2VuXG4gKlxuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgbWF4ID0gZnVuY3Rpb24gKE8pIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGZpcnN0LCBzZWNvbmQpIHtcbiAgICAgICAgcmV0dXJuIGZpcnN0ID09PSBzZWNvbmQgfHwgTy5jb21wYXJlKGZpcnN0LCBzZWNvbmQpID4gLTEgPyBmaXJzdCA6IHNlY29uZDtcbiAgICB9O1xufTtcbi8qKlxuICogQ2xhbXAgYSB2YWx1ZSBiZXR3ZWVuIGEgbWluaW11bSBhbmQgYSBtYXhpbXVtXG4gKlxuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgY2xhbXAgPSBmdW5jdGlvbiAoTykge1xuICAgIHZhciBtaW5PID0gbWluKE8pO1xuICAgIHZhciBtYXhPID0gbWF4KE8pO1xuICAgIHJldHVybiBmdW5jdGlvbiAobG93LCBoaSkgeyByZXR1cm4gZnVuY3Rpb24gKGEpIHsgcmV0dXJuIG1heE8obWluTyhhLCBoaSksIGxvdyk7IH07IH07XG59O1xuLyoqXG4gKiBUZXN0IHdoZXRoZXIgYSB2YWx1ZSBpcyBiZXR3ZWVuIGEgbWluaW11bSBhbmQgYSBtYXhpbXVtIChpbmNsdXNpdmUpXG4gKlxuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgYmV0d2VlbiA9IGZ1bmN0aW9uIChPKSB7XG4gICAgdmFyIGx0TyA9IGx0KE8pO1xuICAgIHZhciBndE8gPSBndChPKTtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGxvdywgaGkpIHsgcmV0dXJuIGZ1bmN0aW9uIChhKSB7IHJldHVybiBsdE8oYSwgbG93KSB8fCBndE8oYSwgaGkpID8gZmFsc2UgOiB0cnVlOyB9OyB9O1xufTtcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8vIGRlcHJlY2F0ZWRcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8qKlxuICogVXNlIFtgdHVwbGVgXSgjdHVwbGUpIGluc3RlYWQuXG4gKlxuICogQGNhdGVnb3J5IHpvbmUgb2YgZGVhdGhcbiAqIEBzaW5jZSAyLjAuMFxuICogQGRlcHJlY2F0ZWRcbiAqL1xuZXhwb3J0IHZhciBnZXRUdXBsZU9yZCA9IHR1cGxlO1xuLyoqXG4gKiBVc2UgW2ByZXZlcnNlYF0oI3JldmVyc2UpIGluc3RlYWQuXG4gKlxuICogQGNhdGVnb3J5IHpvbmUgb2YgZGVhdGhcbiAqIEBzaW5jZSAyLjAuMFxuICogQGRlcHJlY2F0ZWRcbiAqL1xuZXhwb3J0IHZhciBnZXREdWFsT3JkID0gcmV2ZXJzZTtcbi8qKlxuICogVXNlIFtgQ29udHJhdmFyaWFudGBdKCNjb250cmF2YXJpYW50KSBpbnN0ZWFkLlxuICpcbiAqIEBjYXRlZ29yeSB6b25lIG9mIGRlYXRoXG4gKiBAc2luY2UgMi4wLjBcbiAqIEBkZXByZWNhdGVkXG4gKi9cbmV4cG9ydCB2YXIgb3JkID0gQ29udHJhdmFyaWFudDtcbi8vIGRlZmF1bHQgY29tcGFyZSBmb3IgcHJpbWl0aXZlIHR5cGVzXG5mdW5jdGlvbiBjb21wYXJlKGZpcnN0LCBzZWNvbmQpIHtcbiAgICByZXR1cm4gZmlyc3QgPCBzZWNvbmQgPyAtMSA6IGZpcnN0ID4gc2Vjb25kID8gMSA6IDA7XG59XG52YXIgc3RyaWN0T3JkID0ge1xuICAgIGVxdWFsczogZXFTdHJpY3QuZXF1YWxzLFxuICAgIGNvbXBhcmU6IGNvbXBhcmVcbn07XG4vKipcbiAqIFVzZSBbYE9yZGBdKC4vYm9vbGVhbi50cy5odG1sI29yZCkgaW5zdGVhZC5cbiAqXG4gKiBAY2F0ZWdvcnkgem9uZSBvZiBkZWF0aFxuICogQHNpbmNlIDIuMC4wXG4gKiBAZGVwcmVjYXRlZFxuICovXG5leHBvcnQgdmFyIG9yZEJvb2xlYW4gPSBzdHJpY3RPcmQ7XG4vKipcbiAqIFVzZSBbYE9yZGBdKC4vc3RyaW5nLnRzLmh0bWwjb3JkKSBpbnN0ZWFkLlxuICpcbiAqIEBjYXRlZ29yeSB6b25lIG9mIGRlYXRoXG4gKiBAc2luY2UgMi4wLjBcbiAqIEBkZXByZWNhdGVkXG4gKi9cbmV4cG9ydCB2YXIgb3JkU3RyaW5nID0gc3RyaWN0T3JkO1xuLyoqXG4gKiBVc2UgW2BPcmRgXSguL251bWJlci50cy5odG1sI29yZCkgaW5zdGVhZC5cbiAqXG4gKiBAY2F0ZWdvcnkgem9uZSBvZiBkZWF0aFxuICogQHNpbmNlIDIuMC4wXG4gKiBAZGVwcmVjYXRlZFxuICovXG5leHBvcnQgdmFyIG9yZE51bWJlciA9IHN0cmljdE9yZDtcbi8qKlxuICogVXNlIFtgT3JkYF0oLi9EYXRlLnRzLmh0bWwjb3JkKSBpbnN0ZWFkLlxuICpcbiAqIEBjYXRlZ29yeSB6b25lIG9mIGRlYXRoXG4gKiBAc2luY2UgMi4wLjBcbiAqIEBkZXByZWNhdGVkXG4gKi9cbmV4cG9ydCB2YXIgb3JkRGF0ZSA9IC8qI19fUFVSRV9fKi8gcGlwZShvcmROdW1iZXIsIFxuLyojX19QVVJFX18qL1xuY29udHJhbWFwKGZ1bmN0aW9uIChkYXRlKSB7IHJldHVybiBkYXRlLnZhbHVlT2YoKTsgfSkpO1xuIiwKICAiaW1wb3J0IHsgZXFTdHJpY3QgfSBmcm9tICcuL0VxJztcbmltcG9ydCB7IGNvbnN0YW50LCBjb25zdFRydWUsIHBpcGUgfSBmcm9tICcuL2Z1bmN0aW9uJztcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8vIGRlZmF1bHRzXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vKipcbiAqIEBjYXRlZ29yeSBkZWZhdWx0c1xuICogQHNpbmNlIDIuMTAuMFxuICovXG5leHBvcnQgdmFyIGVxdWFsc0RlZmF1bHQgPSBmdW5jdGlvbiAoY29tcGFyZSkge1xuICAgIHJldHVybiBmdW5jdGlvbiAoZmlyc3QsIHNlY29uZCkge1xuICAgICAgICByZXR1cm4gZmlyc3QgPT09IHNlY29uZCB8fCBjb21wYXJlKGZpcnN0LCBzZWNvbmQpID09PSAwO1xuICAgIH07XG59O1xuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLy8gY29uc3RydWN0b3JzXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vKipcbiAqIEBjYXRlZ29yeSBjb25zdHJ1Y3RvcnNcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIGZyb21Db21wYXJlID0gZnVuY3Rpb24gKGNvbXBhcmUpIHsgcmV0dXJuICh7XG4gICAgZXF1YWxzOiBlcXVhbHNEZWZhdWx0KGNvbXBhcmUpLFxuICAgIGNvbXBhcmU6IGZ1bmN0aW9uIChmaXJzdCwgc2Vjb25kKSB7IHJldHVybiAoZmlyc3QgPT09IHNlY29uZCA/IDAgOiBjb21wYXJlKGZpcnN0LCBzZWNvbmQpKTsgfVxufSk7IH07XG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vLyBjb21iaW5hdG9yc1xuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLyoqXG4gKiBHaXZlbiBhIHR1cGxlIG9mIGBPcmRgcyByZXR1cm5zIGFuIGBPcmRgIGZvciB0aGUgdHVwbGUuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IHR1cGxlIH0gZnJvbSAnZnAtdHMvT3JkJ1xuICogaW1wb3J0ICogYXMgQiBmcm9tICdmcC10cy9ib29sZWFuJ1xuICogaW1wb3J0ICogYXMgUyBmcm9tICdmcC10cy9zdHJpbmcnXG4gKiBpbXBvcnQgKiBhcyBOIGZyb20gJ2ZwLXRzL251bWJlcidcbiAqXG4gKiBjb25zdCBPID0gdHVwbGUoUy5PcmQsIE4uT3JkLCBCLk9yZClcbiAqIGFzc2VydC5zdHJpY3RFcXVhbChPLmNvbXBhcmUoWydhJywgMSwgdHJ1ZV0sIFsnYicsIDIsIHRydWVdKSwgLTEpXG4gKiBhc3NlcnQuc3RyaWN0RXF1YWwoTy5jb21wYXJlKFsnYScsIDEsIHRydWVdLCBbJ2EnLCAyLCB0cnVlXSksIC0xKVxuICogYXNzZXJ0LnN0cmljdEVxdWFsKE8uY29tcGFyZShbJ2EnLCAxLCB0cnVlXSwgWydhJywgMSwgZmFsc2VdKSwgMSlcbiAqXG4gKiBAc2luY2UgMi4xMC4wXG4gKi9cbmV4cG9ydCB2YXIgdHVwbGUgPSBmdW5jdGlvbiAoKSB7XG4gICAgdmFyIG9yZHMgPSBbXTtcbiAgICBmb3IgKHZhciBfaSA9IDA7IF9pIDwgYXJndW1lbnRzLmxlbmd0aDsgX2krKykge1xuICAgICAgICBvcmRzW19pXSA9IGFyZ3VtZW50c1tfaV07XG4gICAgfVxuICAgIHJldHVybiBmcm9tQ29tcGFyZShmdW5jdGlvbiAoZmlyc3QsIHNlY29uZCkge1xuICAgICAgICB2YXIgaSA9IDA7XG4gICAgICAgIGZvciAoOyBpIDwgb3Jkcy5sZW5ndGggLSAxOyBpKyspIHtcbiAgICAgICAgICAgIHZhciByID0gb3Jkc1tpXS5jb21wYXJlKGZpcnN0W2ldLCBzZWNvbmRbaV0pO1xuICAgICAgICAgICAgaWYgKHIgIT09IDApIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gcjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gb3Jkc1tpXS5jb21wYXJlKGZpcnN0W2ldLCBzZWNvbmRbaV0pO1xuICAgIH0pO1xufTtcbi8qKlxuICogQHNpbmNlIDIuMTAuMFxuICovXG5leHBvcnQgdmFyIHJldmVyc2UgPSBmdW5jdGlvbiAoTykgeyByZXR1cm4gZnJvbUNvbXBhcmUoZnVuY3Rpb24gKGZpcnN0LCBzZWNvbmQpIHsgcmV0dXJuIE8uY29tcGFyZShzZWNvbmQsIGZpcnN0KTsgfSk7IH07XG4vKiBpc3RhbmJ1bCBpZ25vcmUgbmV4dCAqL1xudmFyIGNvbnRyYW1hcF8gPSBmdW5jdGlvbiAoZmEsIGYpIHsgcmV0dXJuIHBpcGUoZmEsIGNvbnRyYW1hcChmKSk7IH07XG4vKipcbiAqIEEgdHlwaWNhbCB1c2UgY2FzZSBmb3IgYGNvbnRyYW1hcGAgd291bGQgYmUgbGlrZSwgZ2l2ZW4gc29tZSBgVXNlcmAgdHlwZSwgdG8gY29uc3RydWN0IGFuIGBPcmQ8VXNlcj5gLlxuICpcbiAqIFdlIGNhbiBkbyBzbyB3aXRoIGEgZnVuY3Rpb24gZnJvbSBgVXNlciAtPiBYYCB3aGVyZSBgWGAgaXMgc29tZSB2YWx1ZSB0aGF0IHdlIGtub3cgaG93IHRvIGNvbXBhcmVcbiAqIGZvciBvcmRlcmluZyAobWVhbmluZyB3ZSBoYXZlIGFuIGBPcmQ8WD5gKVxuICpcbiAqIEZvciBleGFtcGxlLCBnaXZlbiB0aGUgZm9sbG93aW5nIGBVc2VyYCB0eXBlLCB0aGVyZSBhcmUgbG90cyBvZiBwb3NzaWJsZSBjaG9pY2VzIGZvciBgWGAsXG4gKiBidXQgbGV0J3Mgc2F5IHdlIHdhbnQgdG8gc29ydCBhIGxpc3Qgb2YgdXNlcnMgYnkgYGxhc3ROYW1lYC5cbiAqXG4gKiBJZiB3ZSBoYXZlIGEgd2F5IG9mIGNvbXBhcmluZyBgbGFzdE5hbWVgcyBmb3Igb3JkZXJpbmcgKGBvcmRMYXN0TmFtZTogT3JkPHN0cmluZz5gKSBhbmQgd2Uga25vdyBob3cgdG8gZ28gZnJvbSBgVXNlciAtPiBzdHJpbmdgLFxuICogdXNpbmcgYGNvbnRyYW1hcGAgd2UgY2FuIGRvIHRoaXNcbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgcGlwZSB9IGZyb20gJ2ZwLXRzL2Z1bmN0aW9uJ1xuICogaW1wb3J0IHsgY29udHJhbWFwLCBPcmQgfSBmcm9tICdmcC10cy9PcmQnXG4gKiBpbXBvcnQgKiBhcyBSQSBmcm9tICdmcC10cy9SZWFkb25seUFycmF5J1xuICogaW1wb3J0ICogYXMgUyBmcm9tICdmcC10cy9zdHJpbmcnXG4gKlxuICogaW50ZXJmYWNlIFVzZXIge1xuICogICByZWFkb25seSBmaXJzdE5hbWU6IHN0cmluZ1xuICogICByZWFkb25seSBsYXN0TmFtZTogc3RyaW5nXG4gKiB9XG4gKlxuICogY29uc3Qgb3JkTGFzdE5hbWU6IE9yZDxzdHJpbmc+ID0gUy5PcmRcbiAqXG4gKiBjb25zdCBvcmRCeUxhc3ROYW1lOiBPcmQ8VXNlcj4gPSBwaXBlKFxuICogICBvcmRMYXN0TmFtZSxcbiAqICAgY29udHJhbWFwKCh1c2VyKSA9PiB1c2VyLmxhc3ROYW1lKVxuICogKVxuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoXG4gKiAgIFJBLnNvcnQob3JkQnlMYXN0TmFtZSkoW1xuICogICAgIHsgZmlyc3ROYW1lOiAnYScsIGxhc3ROYW1lOiAnZCcgfSxcbiAqICAgICB7IGZpcnN0TmFtZTogJ2MnLCBsYXN0TmFtZTogJ2InIH1cbiAqICAgXSksXG4gKiAgIFtcbiAqICAgICB7IGZpcnN0TmFtZTogJ2MnLCBsYXN0TmFtZTogJ2InIH0sXG4gKiAgICAgeyBmaXJzdE5hbWU6ICdhJywgbGFzdE5hbWU6ICdkJyB9XG4gKiAgIF1cbiAqIClcbiAqXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciBjb250cmFtYXAgPSBmdW5jdGlvbiAoZikgeyByZXR1cm4gZnVuY3Rpb24gKGZhKSB7XG4gICAgcmV0dXJuIGZyb21Db21wYXJlKGZ1bmN0aW9uIChmaXJzdCwgc2Vjb25kKSB7IHJldHVybiBmYS5jb21wYXJlKGYoZmlyc3QpLCBmKHNlY29uZCkpOyB9KTtcbn07IH07XG4vKipcbiAqIEBjYXRlZ29yeSB0eXBlIGxhbWJkYXNcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIFVSSSA9ICdPcmQnO1xuLyoqXG4gKiBBIHR5cGljYWwgdXNlIGNhc2UgZm9yIHRoZSBgU2VtaWdyb3VwYCBpbnN0YW5jZSBvZiBgT3JkYCBpcyBtZXJnaW5nIHR3byBvciBtb3JlIG9yZGVyaW5ncy5cbiAqXG4gKiBGb3IgZXhhbXBsZSB0aGUgZm9sbG93aW5nIHNuaXBwZXQgYnVpbGRzIGFuIGBPcmRgIGZvciBhIHR5cGUgYFVzZXJgIHdoaWNoXG4gKiBzb3J0cyBieSBgY3JlYXRlZGAgZGF0ZSBkZXNjZW5kaW5nLCBhbmQgKip0aGVuKiogYGxhc3ROYW1lYFxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgKiBhcyBEIGZyb20gJ2ZwLXRzL0RhdGUnXG4gKiBpbXBvcnQgeyBwaXBlIH0gZnJvbSAnZnAtdHMvZnVuY3Rpb24nXG4gKiBpbXBvcnQgeyBjb250cmFtYXAsIGdldFNlbWlncm91cCwgT3JkLCByZXZlcnNlIH0gZnJvbSAnZnAtdHMvT3JkJ1xuICogaW1wb3J0ICogYXMgUkEgZnJvbSAnZnAtdHMvUmVhZG9ubHlBcnJheSdcbiAqIGltcG9ydCAqIGFzIFMgZnJvbSAnZnAtdHMvc3RyaW5nJ1xuICpcbiAqIGludGVyZmFjZSBVc2VyIHtcbiAqICAgcmVhZG9ubHkgaWQ6IHN0cmluZ1xuICogICByZWFkb25seSBsYXN0TmFtZTogc3RyaW5nXG4gKiAgIHJlYWRvbmx5IGNyZWF0ZWQ6IERhdGVcbiAqIH1cbiAqXG4gKiBjb25zdCBvcmRCeUxhc3ROYW1lOiBPcmQ8VXNlcj4gPSBwaXBlKFxuICogICBTLk9yZCxcbiAqICAgY29udHJhbWFwKCh1c2VyKSA9PiB1c2VyLmxhc3ROYW1lKVxuICogKVxuICpcbiAqIGNvbnN0IG9yZEJ5Q3JlYXRlZDogT3JkPFVzZXI+ID0gcGlwZShcbiAqICAgRC5PcmQsXG4gKiAgIGNvbnRyYW1hcCgodXNlcikgPT4gdXNlci5jcmVhdGVkKVxuICogKVxuICpcbiAqIGNvbnN0IG9yZFVzZXJCeUNyZWF0ZWREZXNjVGhlbkxhc3ROYW1lID0gZ2V0U2VtaWdyb3VwPFVzZXI+KCkuY29uY2F0KFxuICogICByZXZlcnNlKG9yZEJ5Q3JlYXRlZCksXG4gKiAgIG9yZEJ5TGFzdE5hbWVcbiAqIClcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKFxuICogICBSQS5zb3J0KG9yZFVzZXJCeUNyZWF0ZWREZXNjVGhlbkxhc3ROYW1lKShbXG4gKiAgICAgeyBpZDogJ2MnLCBsYXN0TmFtZTogJ2QnLCBjcmVhdGVkOiBuZXcgRGF0ZSgxOTczLCAxMCwgMzApIH0sXG4gKiAgICAgeyBpZDogJ2EnLCBsYXN0TmFtZTogJ2InLCBjcmVhdGVkOiBuZXcgRGF0ZSgxOTczLCAxMCwgMzApIH0sXG4gKiAgICAgeyBpZDogJ2UnLCBsYXN0TmFtZTogJ2YnLCBjcmVhdGVkOiBuZXcgRGF0ZSgxOTgwLCAxMCwgMzApIH1cbiAqICAgXSksXG4gKiAgIFtcbiAqICAgICB7IGlkOiAnZScsIGxhc3ROYW1lOiAnZicsIGNyZWF0ZWQ6IG5ldyBEYXRlKDE5ODAsIDEwLCAzMCkgfSxcbiAqICAgICB7IGlkOiAnYScsIGxhc3ROYW1lOiAnYicsIGNyZWF0ZWQ6IG5ldyBEYXRlKDE5NzMsIDEwLCAzMCkgfSxcbiAqICAgICB7IGlkOiAnYycsIGxhc3ROYW1lOiAnZCcsIGNyZWF0ZWQ6IG5ldyBEYXRlKDE5NzMsIDEwLCAzMCkgfVxuICogICBdXG4gKiApXG4gKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgZ2V0U2VtaWdyb3VwID0gZnVuY3Rpb24gKCkgeyByZXR1cm4gKHtcbiAgICBjb25jYXQ6IGZ1bmN0aW9uIChmaXJzdCwgc2Vjb25kKSB7XG4gICAgICAgIHJldHVybiBmcm9tQ29tcGFyZShmdW5jdGlvbiAoYSwgYikge1xuICAgICAgICAgICAgdmFyIG94ID0gZmlyc3QuY29tcGFyZShhLCBiKTtcbiAgICAgICAgICAgIHJldHVybiBveCAhPT0gMCA/IG94IDogc2Vjb25kLmNvbXBhcmUoYSwgYik7XG4gICAgICAgIH0pO1xuICAgIH1cbn0pOyB9O1xuLyoqXG4gKiBSZXR1cm5zIGEgYE1vbm9pZGAgc3VjaCB0aGF0OlxuICpcbiAqIC0gaXRzIGBjb25jYXQob3JkMSwgb3JkMilgIG9wZXJhdGlvbiB3aWxsIG9yZGVyIGZpcnN0IGJ5IGBvcmQxYCwgYW5kIHRoZW4gYnkgYG9yZDJgXG4gKiAtIGl0cyBgZW1wdHlgIHZhbHVlIGlzIGFuIGBPcmRgIHRoYXQgYWx3YXlzIGNvbnNpZGVycyBjb21wYXJlZCBlbGVtZW50cyBlcXVhbFxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBzb3J0IH0gZnJvbSAnZnAtdHMvQXJyYXknXG4gKiBpbXBvcnQgeyBjb250cmFtYXAsIHJldmVyc2UsIGdldE1vbm9pZCB9IGZyb20gJ2ZwLXRzL09yZCdcbiAqIGltcG9ydCAqIGFzIFMgZnJvbSAnZnAtdHMvc3RyaW5nJ1xuICogaW1wb3J0ICogYXMgQiBmcm9tICdmcC10cy9ib29sZWFuJ1xuICogaW1wb3J0IHsgcGlwZSB9IGZyb20gJ2ZwLXRzL2Z1bmN0aW9uJ1xuICogaW1wb3J0IHsgY29uY2F0QWxsIH0gZnJvbSAnZnAtdHMvTW9ub2lkJ1xuICogaW1wb3J0ICogYXMgTiBmcm9tICdmcC10cy9udW1iZXInXG4gKlxuICogaW50ZXJmYWNlIFVzZXIge1xuICogICByZWFkb25seSBpZDogbnVtYmVyXG4gKiAgIHJlYWRvbmx5IG5hbWU6IHN0cmluZ1xuICogICByZWFkb25seSBhZ2U6IG51bWJlclxuICogICByZWFkb25seSByZW1lbWJlck1lOiBib29sZWFuXG4gKiB9XG4gKlxuICogY29uc3QgYnlOYW1lID0gcGlwZShcbiAqICAgUy5PcmQsXG4gKiAgIGNvbnRyYW1hcCgocDogVXNlcikgPT4gcC5uYW1lKVxuICogKVxuICpcbiAqIGNvbnN0IGJ5QWdlID0gcGlwZShcbiAqICAgTi5PcmQsXG4gKiAgIGNvbnRyYW1hcCgocDogVXNlcikgPT4gcC5hZ2UpXG4gKiApXG4gKlxuICogY29uc3QgYnlSZW1lbWJlck1lID0gcGlwZShcbiAqICAgQi5PcmQsXG4gKiAgIGNvbnRyYW1hcCgocDogVXNlcikgPT4gcC5yZW1lbWJlck1lKVxuICogKVxuICpcbiAqIGNvbnN0IE0gPSBnZXRNb25vaWQ8VXNlcj4oKVxuICpcbiAqIGNvbnN0IHVzZXJzOiBBcnJheTxVc2VyPiA9IFtcbiAqICAgeyBpZDogMSwgbmFtZTogJ0d1aWRvJywgYWdlOiA0NywgcmVtZW1iZXJNZTogZmFsc2UgfSxcbiAqICAgeyBpZDogMiwgbmFtZTogJ0d1aWRvJywgYWdlOiA0NiwgcmVtZW1iZXJNZTogdHJ1ZSB9LFxuICogICB7IGlkOiAzLCBuYW1lOiAnR2l1bGlvJywgYWdlOiA0NCwgcmVtZW1iZXJNZTogZmFsc2UgfSxcbiAqICAgeyBpZDogNCwgbmFtZTogJ0dpdWxpbycsIGFnZTogNDQsIHJlbWVtYmVyTWU6IHRydWUgfVxuICogXVxuICpcbiAqIC8vIHNvcnQgYnkgbmFtZSwgdGhlbiBieSBhZ2UsIHRoZW4gYnkgYHJlbWVtYmVyTWVgXG4gKiBjb25zdCBPMSA9IGNvbmNhdEFsbChNKShbYnlOYW1lLCBieUFnZSwgYnlSZW1lbWJlck1lXSlcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoc29ydChPMSkodXNlcnMpLCBbXG4gKiAgIHsgaWQ6IDMsIG5hbWU6ICdHaXVsaW8nLCBhZ2U6IDQ0LCByZW1lbWJlck1lOiBmYWxzZSB9LFxuICogICB7IGlkOiA0LCBuYW1lOiAnR2l1bGlvJywgYWdlOiA0NCwgcmVtZW1iZXJNZTogdHJ1ZSB9LFxuICogICB7IGlkOiAyLCBuYW1lOiAnR3VpZG8nLCBhZ2U6IDQ2LCByZW1lbWJlck1lOiB0cnVlIH0sXG4gKiAgIHsgaWQ6IDEsIG5hbWU6ICdHdWlkbycsIGFnZTogNDcsIHJlbWVtYmVyTWU6IGZhbHNlIH1cbiAqIF0pXG4gKlxuICogLy8gbm93IGByZW1lbWJlck1lID0gdHJ1ZWAgZmlyc3QsIHRoZW4gYnkgbmFtZSwgdGhlbiBieSBhZ2VcbiAqIGNvbnN0IE8yID0gY29uY2F0QWxsKE0pKFtyZXZlcnNlKGJ5UmVtZW1iZXJNZSksIGJ5TmFtZSwgYnlBZ2VdKVxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChzb3J0KE8yKSh1c2VycyksIFtcbiAqICAgeyBpZDogNCwgbmFtZTogJ0dpdWxpbycsIGFnZTogNDQsIHJlbWVtYmVyTWU6IHRydWUgfSxcbiAqICAgeyBpZDogMiwgbmFtZTogJ0d1aWRvJywgYWdlOiA0NiwgcmVtZW1iZXJNZTogdHJ1ZSB9LFxuICogICB7IGlkOiAzLCBuYW1lOiAnR2l1bGlvJywgYWdlOiA0NCwgcmVtZW1iZXJNZTogZmFsc2UgfSxcbiAqICAgeyBpZDogMSwgbmFtZTogJ0d1aWRvJywgYWdlOiA0NywgcmVtZW1iZXJNZTogZmFsc2UgfVxuICogXSlcbiAqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi40LjBcbiAqL1xuZXhwb3J0IHZhciBnZXRNb25vaWQgPSBmdW5jdGlvbiAoKSB7IHJldHVybiAoe1xuICAgIGNvbmNhdDogZ2V0U2VtaWdyb3VwKCkuY29uY2F0LFxuICAgIGVtcHR5OiBmcm9tQ29tcGFyZShmdW5jdGlvbiAoKSB7IHJldHVybiAwOyB9KVxufSk7IH07XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjcuMFxuICovXG5leHBvcnQgdmFyIENvbnRyYXZhcmlhbnQgPSB7XG4gICAgVVJJOiBVUkksXG4gICAgY29udHJhbWFwOiBjb250cmFtYXBfXG59O1xuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLy8gdXRpbHNcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8qKlxuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIHRyaXZpYWwgPSB7XG4gICAgZXF1YWxzOiBjb25zdFRydWUsXG4gICAgY29tcGFyZTogLyojX19QVVJFX18qLyBjb25zdGFudCgwKVxufTtcbi8qKlxuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIGVxdWFscyA9IGZ1bmN0aW9uIChPKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChzZWNvbmQpIHtcbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIChmaXJzdCkge1xuICAgICAgICAgICAgcmV0dXJuIGZpcnN0ID09PSBzZWNvbmQgfHwgTy5jb21wYXJlKGZpcnN0LCBzZWNvbmQpID09PSAwO1xuICAgICAgICB9O1xuICAgIH07XG59O1xuLy8gVE9ETzogY3VycnkgaW4gdjNcbi8qKlxuICogVGVzdCB3aGV0aGVyIG9uZSB2YWx1ZSBpcyBfc3RyaWN0bHkgbGVzcyB0aGFuXyBhbm90aGVyXG4gKlxuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgbHQgPSBmdW5jdGlvbiAoTykge1xuICAgIHJldHVybiBmdW5jdGlvbiAoZmlyc3QsIHNlY29uZCkge1xuICAgICAgICByZXR1cm4gTy5jb21wYXJlKGZpcnN0LCBzZWNvbmQpID09PSAtMTtcbiAgICB9O1xufTtcbi8vIFRPRE86IGN1cnJ5IGluIHYzXG4vKipcbiAqIFRlc3Qgd2hldGhlciBvbmUgdmFsdWUgaXMgX3N0cmljdGx5IGdyZWF0ZXIgdGhhbl8gYW5vdGhlclxuICpcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIGd0ID0gZnVuY3Rpb24gKE8pIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGZpcnN0LCBzZWNvbmQpIHtcbiAgICAgICAgcmV0dXJuIE8uY29tcGFyZShmaXJzdCwgc2Vjb25kKSA9PT0gMTtcbiAgICB9O1xufTtcbi8vIFRPRE86IGN1cnJ5IGluIHYzXG4vKipcbiAqIFRlc3Qgd2hldGhlciBvbmUgdmFsdWUgaXMgX25vbi1zdHJpY3RseSBsZXNzIHRoYW5fIGFub3RoZXJcbiAqXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciBsZXEgPSBmdW5jdGlvbiAoTykge1xuICAgIHJldHVybiBmdW5jdGlvbiAoZmlyc3QsIHNlY29uZCkge1xuICAgICAgICByZXR1cm4gTy5jb21wYXJlKGZpcnN0LCBzZWNvbmQpICE9PSAxO1xuICAgIH07XG59O1xuLy8gVE9ETzogY3VycnkgaW4gdjNcbi8qKlxuICogVGVzdCB3aGV0aGVyIG9uZSB2YWx1ZSBpcyBfbm9uLXN0cmljdGx5IGdyZWF0ZXIgdGhhbl8gYW5vdGhlclxuICpcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIGdlcSA9IGZ1bmN0aW9uIChPKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChmaXJzdCwgc2Vjb25kKSB7XG4gICAgICAgIHJldHVybiBPLmNvbXBhcmUoZmlyc3QsIHNlY29uZCkgIT09IC0xO1xuICAgIH07XG59O1xuLy8gVE9ETzogY3VycnkgaW4gdjNcbi8qKlxuICogVGFrZSB0aGUgbWluaW11bSBvZiB0d28gdmFsdWVzLiBJZiB0aGV5IGFyZSBjb25zaWRlcmVkIGVxdWFsLCB0aGUgZmlyc3QgYXJndW1lbnQgaXMgY2hvc2VuXG4gKlxuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgbWluID0gZnVuY3Rpb24gKE8pIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGZpcnN0LCBzZWNvbmQpIHtcbiAgICAgICAgcmV0dXJuIGZpcnN0ID09PSBzZWNvbmQgfHwgTy5jb21wYXJlKGZpcnN0LCBzZWNvbmQpIDwgMSA/IGZpcnN0IDogc2Vjb25kO1xuICAgIH07XG59O1xuLy8gVE9ETzogY3VycnkgaW4gdjNcbi8qKlxuICogVGFrZSB0aGUgbWF4aW11bSBvZiB0d28gdmFsdWVzLiBJZiB0aGV5IGFyZSBjb25zaWRlcmVkIGVxdWFsLCB0aGUgZmlyc3QgYXJndW1lbnQgaXMgY2hvc2VuXG4gKlxuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgbWF4ID0gZnVuY3Rpb24gKE8pIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGZpcnN0LCBzZWNvbmQpIHtcbiAgICAgICAgcmV0dXJuIGZpcnN0ID09PSBzZWNvbmQgfHwgTy5jb21wYXJlKGZpcnN0LCBzZWNvbmQpID4gLTEgPyBmaXJzdCA6IHNlY29uZDtcbiAgICB9O1xufTtcbi8qKlxuICogQ2xhbXAgYSB2YWx1ZSBiZXR3ZWVuIGEgbWluaW11bSBhbmQgYSBtYXhpbXVtXG4gKlxuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgY2xhbXAgPSBmdW5jdGlvbiAoTykge1xuICAgIHZhciBtaW5PID0gbWluKE8pO1xuICAgIHZhciBtYXhPID0gbWF4KE8pO1xuICAgIHJldHVybiBmdW5jdGlvbiAobG93LCBoaSkgeyByZXR1cm4gZnVuY3Rpb24gKGEpIHsgcmV0dXJuIG1heE8obWluTyhhLCBoaSksIGxvdyk7IH07IH07XG59O1xuLyoqXG4gKiBUZXN0IHdoZXRoZXIgYSB2YWx1ZSBpcyBiZXR3ZWVuIGEgbWluaW11bSBhbmQgYSBtYXhpbXVtIChpbmNsdXNpdmUpXG4gKlxuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgYmV0d2VlbiA9IGZ1bmN0aW9uIChPKSB7XG4gICAgdmFyIGx0TyA9IGx0KE8pO1xuICAgIHZhciBndE8gPSBndChPKTtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGxvdywgaGkpIHsgcmV0dXJuIGZ1bmN0aW9uIChhKSB7IHJldHVybiBsdE8oYSwgbG93KSB8fCBndE8oYSwgaGkpID8gZmFsc2UgOiB0cnVlOyB9OyB9O1xufTtcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8vIGRlcHJlY2F0ZWRcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8qKlxuICogVXNlIFtgdHVwbGVgXSgjdHVwbGUpIGluc3RlYWQuXG4gKlxuICogQGNhdGVnb3J5IHpvbmUgb2YgZGVhdGhcbiAqIEBzaW5jZSAyLjAuMFxuICogQGRlcHJlY2F0ZWRcbiAqL1xuZXhwb3J0IHZhciBnZXRUdXBsZU9yZCA9IHR1cGxlO1xuLyoqXG4gKiBVc2UgW2ByZXZlcnNlYF0oI3JldmVyc2UpIGluc3RlYWQuXG4gKlxuICogQGNhdGVnb3J5IHpvbmUgb2YgZGVhdGhcbiAqIEBzaW5jZSAyLjAuMFxuICogQGRlcHJlY2F0ZWRcbiAqL1xuZXhwb3J0IHZhciBnZXREdWFsT3JkID0gcmV2ZXJzZTtcbi8qKlxuICogVXNlIFtgQ29udHJhdmFyaWFudGBdKCNjb250cmF2YXJpYW50KSBpbnN0ZWFkLlxuICpcbiAqIEBjYXRlZ29yeSB6b25lIG9mIGRlYXRoXG4gKiBAc2luY2UgMi4wLjBcbiAqIEBkZXByZWNhdGVkXG4gKi9cbmV4cG9ydCB2YXIgb3JkID0gQ29udHJhdmFyaWFudDtcbi8vIGRlZmF1bHQgY29tcGFyZSBmb3IgcHJpbWl0aXZlIHR5cGVzXG5mdW5jdGlvbiBjb21wYXJlKGZpcnN0LCBzZWNvbmQpIHtcbiAgICByZXR1cm4gZmlyc3QgPCBzZWNvbmQgPyAtMSA6IGZpcnN0ID4gc2Vjb25kID8gMSA6IDA7XG59XG52YXIgc3RyaWN0T3JkID0ge1xuICAgIGVxdWFsczogZXFTdHJpY3QuZXF1YWxzLFxuICAgIGNvbXBhcmU6IGNvbXBhcmVcbn07XG4vKipcbiAqIFVzZSBbYE9yZGBdKC4vYm9vbGVhbi50cy5odG1sI29yZCkgaW5zdGVhZC5cbiAqXG4gKiBAY2F0ZWdvcnkgem9uZSBvZiBkZWF0aFxuICogQHNpbmNlIDIuMC4wXG4gKiBAZGVwcmVjYXRlZFxuICovXG5leHBvcnQgdmFyIG9yZEJvb2xlYW4gPSBzdHJpY3RPcmQ7XG4vKipcbiAqIFVzZSBbYE9yZGBdKC4vc3RyaW5nLnRzLmh0bWwjb3JkKSBpbnN0ZWFkLlxuICpcbiAqIEBjYXRlZ29yeSB6b25lIG9mIGRlYXRoXG4gKiBAc2luY2UgMi4wLjBcbiAqIEBkZXByZWNhdGVkXG4gKi9cbmV4cG9ydCB2YXIgb3JkU3RyaW5nID0gc3RyaWN0T3JkO1xuLyoqXG4gKiBVc2UgW2BPcmRgXSguL251bWJlci50cy5odG1sI29yZCkgaW5zdGVhZC5cbiAqXG4gKiBAY2F0ZWdvcnkgem9uZSBvZiBkZWF0aFxuICogQHNpbmNlIDIuMC4wXG4gKiBAZGVwcmVjYXRlZFxuICovXG5leHBvcnQgdmFyIG9yZE51bWJlciA9IHN0cmljdE9yZDtcbi8qKlxuICogVXNlIFtgT3JkYF0oLi9EYXRlLnRzLmh0bWwjb3JkKSBpbnN0ZWFkLlxuICpcbiAqIEBjYXRlZ29yeSB6b25lIG9mIGRlYXRoXG4gKiBAc2luY2UgMi4wLjBcbiAqIEBkZXByZWNhdGVkXG4gKi9cbmV4cG9ydCB2YXIgb3JkRGF0ZSA9IC8qI19fUFVSRV9fKi8gcGlwZShvcmROdW1iZXIsIFxuLyojX19QVVJFX18qL1xuY29udHJhbWFwKGZ1bmN0aW9uIChkYXRlKSB7IHJldHVybiBkYXRlLnZhbHVlT2YoKTsgfSkpO1xuIiwKICAiLyoqXG4gKiBBIGBNYWdtYWAgaXMgYSBwYWlyIGAoQSwgY29uY2F0KWAgaW4gd2hpY2ggYEFgIGlzIGEgbm9uLWVtcHR5IHNldCBhbmQgYGNvbmNhdGAgaXMgYSBiaW5hcnkgb3BlcmF0aW9uIG9uIGBBYFxuICpcbiAqIFNlZSBbU2VtaWdyb3VwXShodHRwczovL2djYW50aS5naXRodWIuaW8vZnAtdHMvbW9kdWxlcy9TZW1pZ3JvdXAudHMuaHRtbCkgZm9yIHNvbWUgaW5zdGFuY2VzLlxuICpcbiAqIEBzaW5jZSAyLjAuMFxuICovXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vLyBjb21iaW5hdG9yc1xuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLyoqXG4gKiBUaGUgZHVhbCBvZiBhIGBNYWdtYWAsIG9idGFpbmVkIGJ5IHN3YXBwaW5nIHRoZSBhcmd1bWVudHMgb2YgYGNvbmNhdGAuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IHJldmVyc2UsIGNvbmNhdEFsbCB9IGZyb20gJ2ZwLXRzL01hZ21hJ1xuICogaW1wb3J0ICogYXMgTiBmcm9tICdmcC10cy9udW1iZXInXG4gKlxuICogY29uc3Qgc3ViQWxsID0gY29uY2F0QWxsKHJldmVyc2UoTi5NYWdtYVN1YikpKDApXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChzdWJBbGwoWzEsIDIsIDNdKSwgMilcbiAqXG4gKiBAc2luY2UgMi4xMS4wXG4gKi9cbmV4cG9ydCB2YXIgcmV2ZXJzZSA9IGZ1bmN0aW9uIChNKSB7IHJldHVybiAoe1xuICAgIGNvbmNhdDogZnVuY3Rpb24gKGZpcnN0LCBzZWNvbmQpIHsgcmV0dXJuIE0uY29uY2F0KHNlY29uZCwgZmlyc3QpOyB9XG59KTsgfTtcbi8qKlxuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIGZpbHRlckZpcnN0ID0gZnVuY3Rpb24gKHByZWRpY2F0ZSkge1xuICAgIHJldHVybiBmdW5jdGlvbiAoTSkgeyByZXR1cm4gKHtcbiAgICAgICAgY29uY2F0OiBmdW5jdGlvbiAoZmlyc3QsIHNlY29uZCkgeyByZXR1cm4gKHByZWRpY2F0ZShmaXJzdCkgPyBNLmNvbmNhdChmaXJzdCwgc2Vjb25kKSA6IHNlY29uZCk7IH1cbiAgICB9KTsgfTtcbn07XG4vKipcbiAqIEBzaW5jZSAyLjExLjBcbiAqL1xuZXhwb3J0IHZhciBmaWx0ZXJTZWNvbmQgPSBmdW5jdGlvbiAocHJlZGljYXRlKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChNKSB7IHJldHVybiAoe1xuICAgICAgICBjb25jYXQ6IGZ1bmN0aW9uIChmaXJzdCwgc2Vjb25kKSB7IHJldHVybiAocHJlZGljYXRlKHNlY29uZCkgPyBNLmNvbmNhdChmaXJzdCwgc2Vjb25kKSA6IGZpcnN0KTsgfVxuICAgIH0pOyB9O1xufTtcbi8qKlxuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIGVuZG8gPSBmdW5jdGlvbiAoZikge1xuICAgIHJldHVybiBmdW5jdGlvbiAoTSkgeyByZXR1cm4gKHtcbiAgICAgICAgY29uY2F0OiBmdW5jdGlvbiAoZmlyc3QsIHNlY29uZCkgeyByZXR1cm4gTS5jb25jYXQoZihmaXJzdCksIGYoc2Vjb25kKSk7IH1cbiAgICB9KTsgfTtcbn07XG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vLyB1dGlsc1xuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLyoqXG4gKiBHaXZlbiBhIHNlcXVlbmNlIG9mIGBhc2AsIGNvbmNhdCB0aGVtIGFuZCByZXR1cm4gdGhlIHRvdGFsLlxuICpcbiAqIElmIGBhc2AgaXMgZW1wdHksIHJldHVybiB0aGUgcHJvdmlkZWQgYHN0YXJ0V2l0aGAgdmFsdWUuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IGNvbmNhdEFsbCB9IGZyb20gJ2ZwLXRzL01hZ21hJ1xuICogaW1wb3J0ICogYXMgTiBmcm9tICdmcC10cy9udW1iZXInXG4gKlxuICogY29uc3Qgc3ViQWxsID0gY29uY2F0QWxsKE4uTWFnbWFTdWIpKDApXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChzdWJBbGwoWzEsIDIsIDNdKSwgLTYpXG4gKlxuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIGNvbmNhdEFsbCA9IGZ1bmN0aW9uIChNKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChzdGFydFdpdGgpIHtcbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIChhcykge1xuICAgICAgICAgICAgcmV0dXJuIGFzLnJlZHVjZShmdW5jdGlvbiAoYSwgYWNjKSB7IHJldHVybiBNLmNvbmNhdChhLCBhY2MpOyB9LCBzdGFydFdpdGgpO1xuICAgICAgICB9O1xuICAgIH07XG59O1xuIiwKICAiLyoqXG4gKiBJZiBhIHR5cGUgYEFgIGNhbiBmb3JtIGEgYFNlbWlncm91cGAgaXQgaGFzIGFuICoqYXNzb2NpYXRpdmUqKiBiaW5hcnkgb3BlcmF0aW9uLlxuICpcbiAqIGBgYHRzXG4gKiBpbnRlcmZhY2UgU2VtaWdyb3VwPEE+IHtcbiAqICAgcmVhZG9ubHkgY29uY2F0OiAoeDogQSwgeTogQSkgPT4gQVxuICogfVxuICogYGBgXG4gKlxuICogQXNzb2NpYXRpdml0eSBtZWFucyB0aGUgZm9sbG93aW5nIGVxdWFsaXR5IG11c3QgaG9sZCBmb3IgYW55IGNob2ljZSBvZiBgeGAsIGB5YCwgYW5kIGB6YC5cbiAqXG4gKiBgYGB0c1xuICogY29uY2F0KHgsIGNvbmNhdCh5LCB6KSkgPSBjb25jYXQoY29uY2F0KHgsIHkpLCB6KVxuICogYGBgXG4gKlxuICogQSBjb21tb24gZXhhbXBsZSBvZiBhIHNlbWlncm91cCBpcyB0aGUgdHlwZSBgc3RyaW5nYCB3aXRoIHRoZSBvcGVyYXRpb24gYCtgLlxuICpcbiAqIGBgYHRzXG4gKiBpbXBvcnQgeyBTZW1pZ3JvdXAgfSBmcm9tICdmcC10cy9TZW1pZ3JvdXAnXG4gKlxuICogY29uc3Qgc2VtaWdyb3VwU3RyaW5nOiBTZW1pZ3JvdXA8c3RyaW5nPiA9IHtcbiAqICAgY29uY2F0OiAoeCwgeSkgPT4geCArIHlcbiAqIH1cbiAqXG4gKiBjb25zdCB4ID0gJ3gnXG4gKiBjb25zdCB5ID0gJ3knXG4gKiBjb25zdCB6ID0gJ3onXG4gKlxuICogc2VtaWdyb3VwU3RyaW5nLmNvbmNhdCh4LCB5KSAvLyAneHknXG4gKlxuICogc2VtaWdyb3VwU3RyaW5nLmNvbmNhdCh4LCBzZW1pZ3JvdXBTdHJpbmcuY29uY2F0KHksIHopKSAvLyAneHl6J1xuICpcbiAqIHNlbWlncm91cFN0cmluZy5jb25jYXQoc2VtaWdyb3VwU3RyaW5nLmNvbmNhdCh4LCB5KSwgeikgLy8gJ3h5eidcbiAqIGBgYFxuICpcbiAqICpBZGFwdGVkIGZyb20gaHR0cHM6Ly90eXBlbGV2ZWwub3JnL2NhdHMqXG4gKlxuICogQHNpbmNlIDIuMC4wXG4gKi9cbmltcG9ydCB7IGdldFNlbWlncm91cCwgaWRlbnRpdHkgfSBmcm9tICcuL2Z1bmN0aW9uJztcbmltcG9ydCAqIGFzIF8gZnJvbSAnLi9pbnRlcm5hbCc7XG5pbXBvcnQgKiBhcyBNIGZyb20gJy4vTWFnbWEnO1xuaW1wb3J0ICogYXMgT3IgZnJvbSAnLi9PcmQnO1xuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLy8gY29uc3RydWN0b3JzXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vKipcbiAqIEdldCBhIHNlbWlncm91cCB3aGVyZSBgY29uY2F0YCB3aWxsIHJldHVybiB0aGUgbWluaW11bSwgYmFzZWQgb24gdGhlIHByb3ZpZGVkIG9yZGVyLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgKiBhcyBOIGZyb20gJ2ZwLXRzL251bWJlcidcbiAqIGltcG9ydCAqIGFzIFMgZnJvbSAnZnAtdHMvU2VtaWdyb3VwJ1xuICpcbiAqIGNvbnN0IFMxID0gUy5taW4oTi5PcmQpXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChTMS5jb25jYXQoMSwgMiksIDEpXG4gKlxuICogQGNhdGVnb3J5IGNvbnN0cnVjdG9yc1xuICogQHNpbmNlIDIuMTAuMFxuICovXG5leHBvcnQgdmFyIG1pbiA9IGZ1bmN0aW9uIChPKSB7IHJldHVybiAoe1xuICAgIGNvbmNhdDogT3IubWluKE8pXG59KTsgfTtcbi8qKlxuICogR2V0IGEgc2VtaWdyb3VwIHdoZXJlIGBjb25jYXRgIHdpbGwgcmV0dXJuIHRoZSBtYXhpbXVtLCBiYXNlZCBvbiB0aGUgcHJvdmlkZWQgb3JkZXIuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCAqIGFzIE4gZnJvbSAnZnAtdHMvbnVtYmVyJ1xuICogaW1wb3J0ICogYXMgUyBmcm9tICdmcC10cy9TZW1pZ3JvdXAnXG4gKlxuICogY29uc3QgUzEgPSBTLm1heChOLk9yZClcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKFMxLmNvbmNhdCgxLCAyKSwgMilcbiAqXG4gKiBAY2F0ZWdvcnkgY29uc3RydWN0b3JzXG4gKiBAc2luY2UgMi4xMC4wXG4gKi9cbmV4cG9ydCB2YXIgbWF4ID0gZnVuY3Rpb24gKE8pIHsgcmV0dXJuICh7XG4gICAgY29uY2F0OiBPci5tYXgoTylcbn0pOyB9O1xuLyoqXG4gKiBAY2F0ZWdvcnkgY29uc3RydWN0b3JzXG4gKiBAc2luY2UgMi4xMC4wXG4gKi9cbmV4cG9ydCB2YXIgY29uc3RhbnQgPSBmdW5jdGlvbiAoYSkgeyByZXR1cm4gKHtcbiAgICBjb25jYXQ6IGZ1bmN0aW9uICgpIHsgcmV0dXJuIGE7IH1cbn0pOyB9O1xuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLy8gY29tYmluYXRvcnNcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8qKlxuICogVGhlIGR1YWwgb2YgYSBgU2VtaWdyb3VwYCwgb2J0YWluZWQgYnkgc3dhcHBpbmcgdGhlIGFyZ3VtZW50cyBvZiBgY29uY2F0YC5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgcmV2ZXJzZSB9IGZyb20gJ2ZwLXRzL1NlbWlncm91cCdcbiAqIGltcG9ydCAqIGFzIFMgZnJvbSAnZnAtdHMvc3RyaW5nJ1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwocmV2ZXJzZShTLlNlbWlncm91cCkuY29uY2F0KCdhJywgJ2InKSwgJ2JhJylcbiAqXG4gKiBAc2luY2UgMi4xMC4wXG4gKi9cbmV4cG9ydCB2YXIgcmV2ZXJzZSA9IE0ucmV2ZXJzZTtcbi8qKlxuICogR2l2ZW4gYSBzdHJ1Y3Qgb2Ygc2VtaWdyb3VwcyByZXR1cm5zIGEgc2VtaWdyb3VwIGZvciB0aGUgc3RydWN0LlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBzdHJ1Y3QgfSBmcm9tICdmcC10cy9TZW1pZ3JvdXAnXG4gKiBpbXBvcnQgKiBhcyBOIGZyb20gJ2ZwLXRzL251bWJlcidcbiAqXG4gKiBpbnRlcmZhY2UgUG9pbnQge1xuICogICByZWFkb25seSB4OiBudW1iZXJcbiAqICAgcmVhZG9ubHkgeTogbnVtYmVyXG4gKiB9XG4gKlxuICogY29uc3QgUyA9IHN0cnVjdDxQb2ludD4oe1xuICogICB4OiBOLlNlbWlncm91cFN1bSxcbiAqICAgeTogTi5TZW1pZ3JvdXBTdW1cbiAqIH0pXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChTLmNvbmNhdCh7IHg6IDEsIHk6IDIgfSwgeyB4OiAzLCB5OiA0IH0pLCB7IHg6IDQsIHk6IDYgfSlcbiAqXG4gKiBAc2luY2UgMi4xMC4wXG4gKi9cbmV4cG9ydCB2YXIgc3RydWN0ID0gZnVuY3Rpb24gKHNlbWlncm91cHMpIHsgcmV0dXJuICh7XG4gICAgY29uY2F0OiBmdW5jdGlvbiAoZmlyc3QsIHNlY29uZCkge1xuICAgICAgICB2YXIgciA9IHt9O1xuICAgICAgICBmb3IgKHZhciBrIGluIHNlbWlncm91cHMpIHtcbiAgICAgICAgICAgIGlmIChfLmhhcy5jYWxsKHNlbWlncm91cHMsIGspKSB7XG4gICAgICAgICAgICAgICAgcltrXSA9IHNlbWlncm91cHNba10uY29uY2F0KGZpcnN0W2tdLCBzZWNvbmRba10pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiByO1xuICAgIH1cbn0pOyB9O1xuLyoqXG4gKiBHaXZlbiBhIHR1cGxlIG9mIHNlbWlncm91cHMgcmV0dXJucyBhIHNlbWlncm91cCBmb3IgdGhlIHR1cGxlLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyB0dXBsZSB9IGZyb20gJ2ZwLXRzL1NlbWlncm91cCdcbiAqIGltcG9ydCAqIGFzIEIgZnJvbSAnZnAtdHMvYm9vbGVhbidcbiAqIGltcG9ydCAqIGFzIE4gZnJvbSAnZnAtdHMvbnVtYmVyJ1xuICogaW1wb3J0ICogYXMgUyBmcm9tICdmcC10cy9zdHJpbmcnXG4gKlxuICogY29uc3QgUzEgPSB0dXBsZShTLlNlbWlncm91cCwgTi5TZW1pZ3JvdXBTdW0pXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKFMxLmNvbmNhdChbJ2EnLCAxXSwgWydiJywgMl0pLCBbJ2FiJywgM10pXG4gKlxuICogY29uc3QgUzIgPSB0dXBsZShTLlNlbWlncm91cCwgTi5TZW1pZ3JvdXBTdW0sIEIuU2VtaWdyb3VwQWxsKVxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChTMi5jb25jYXQoWydhJywgMSwgdHJ1ZV0sIFsnYicsIDIsIGZhbHNlXSksIFsnYWInLCAzLCBmYWxzZV0pXG4gKlxuICogQHNpbmNlIDIuMTAuMFxuICovXG5leHBvcnQgdmFyIHR1cGxlID0gZnVuY3Rpb24gKCkge1xuICAgIHZhciBzZW1pZ3JvdXBzID0gW107XG4gICAgZm9yICh2YXIgX2kgPSAwOyBfaSA8IGFyZ3VtZW50cy5sZW5ndGg7IF9pKyspIHtcbiAgICAgICAgc2VtaWdyb3Vwc1tfaV0gPSBhcmd1bWVudHNbX2ldO1xuICAgIH1cbiAgICByZXR1cm4gKHtcbiAgICAgICAgY29uY2F0OiBmdW5jdGlvbiAoZmlyc3QsIHNlY29uZCkgeyByZXR1cm4gc2VtaWdyb3Vwcy5tYXAoZnVuY3Rpb24gKHMsIGkpIHsgcmV0dXJuIHMuY29uY2F0KGZpcnN0W2ldLCBzZWNvbmRbaV0pOyB9KTsgfVxuICAgIH0pO1xufTtcbi8qKlxuICogQmV0d2VlbiBlYWNoIHBhaXIgb2YgZWxlbWVudHMgaW5zZXJ0IGBtaWRkbGVgLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBpbnRlcmNhbGF0ZSB9IGZyb20gJ2ZwLXRzL1NlbWlncm91cCdcbiAqIGltcG9ydCAqIGFzIFMgZnJvbSAnZnAtdHMvc3RyaW5nJ1xuICogaW1wb3J0IHsgcGlwZSB9IGZyb20gJ2ZwLXRzL2Z1bmN0aW9uJ1xuICpcbiAqIGNvbnN0IFMxID0gcGlwZShTLlNlbWlncm91cCwgaW50ZXJjYWxhdGUoJyArICcpKVxuICpcbiAqIGFzc2VydC5zdHJpY3RFcXVhbChTMS5jb25jYXQoJ2EnLCAnYicpLCAnYSArIGInKVxuICpcbiAqIEBzaW5jZSAyLjEwLjBcbiAqL1xuZXhwb3J0IHZhciBpbnRlcmNhbGF0ZSA9IGZ1bmN0aW9uIChtaWRkbGUpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKFMpIHsgcmV0dXJuICh7XG4gICAgICAgIGNvbmNhdDogZnVuY3Rpb24gKHgsIHkpIHsgcmV0dXJuIFMuY29uY2F0KHgsIFMuY29uY2F0KG1pZGRsZSwgeSkpOyB9XG4gICAgfSk7IH07XG59O1xuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLy8gaW5zdGFuY2VzXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vKipcbiAqIEFsd2F5cyByZXR1cm4gdGhlIGZpcnN0IGFyZ3VtZW50LlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgKiBhcyBTIGZyb20gJ2ZwLXRzL1NlbWlncm91cCdcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKFMuZmlyc3Q8bnVtYmVyPigpLmNvbmNhdCgxLCAyKSwgMSlcbiAqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi4xMC4wXG4gKi9cbmV4cG9ydCB2YXIgZmlyc3QgPSBmdW5jdGlvbiAoKSB7IHJldHVybiAoeyBjb25jYXQ6IGlkZW50aXR5IH0pOyB9O1xuLyoqXG4gKiBBbHdheXMgcmV0dXJuIHRoZSBsYXN0IGFyZ3VtZW50LlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgKiBhcyBTIGZyb20gJ2ZwLXRzL1NlbWlncm91cCdcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKFMubGFzdDxudW1iZXI+KCkuY29uY2F0KDEsIDIpLCAyKVxuICpcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjEwLjBcbiAqL1xuZXhwb3J0IHZhciBsYXN0ID0gZnVuY3Rpb24gKCkgeyByZXR1cm4gKHsgY29uY2F0OiBmdW5jdGlvbiAoXywgeSkgeyByZXR1cm4geTsgfSB9KTsgfTtcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8vIHV0aWxzXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vKipcbiAqIEdpdmVuIGEgc2VxdWVuY2Ugb2YgYGFzYCwgY29uY2F0IHRoZW0gYW5kIHJldHVybiB0aGUgdG90YWwuXG4gKlxuICogSWYgYGFzYCBpcyBlbXB0eSwgcmV0dXJuIHRoZSBwcm92aWRlZCBgc3RhcnRXaXRoYCB2YWx1ZS5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgY29uY2F0QWxsIH0gZnJvbSAnZnAtdHMvU2VtaWdyb3VwJ1xuICogaW1wb3J0ICogYXMgTiBmcm9tICdmcC10cy9udW1iZXInXG4gKlxuICogY29uc3Qgc3VtID0gY29uY2F0QWxsKE4uU2VtaWdyb3VwU3VtKSgwKVxuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoc3VtKFsxLCAyLCAzXSksIDYpXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKHN1bShbXSksIDApXG4gKlxuICogQHNpbmNlIDIuMTAuMFxuICovXG5leHBvcnQgdmFyIGNvbmNhdEFsbCA9IE0uY29uY2F0QWxsO1xuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLy8gZGVwcmVjYXRlZFxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLyoqXG4gKiBVc2UgYHZvaWRgIG1vZHVsZSBpbnN0ZWFkLlxuICpcbiAqIEBjYXRlZ29yeSB6b25lIG9mIGRlYXRoXG4gKiBAc2luY2UgMi4wLjBcbiAqIEBkZXByZWNhdGVkXG4gKi9cbmV4cG9ydCB2YXIgc2VtaWdyb3VwVm9pZCA9IGNvbnN0YW50KHVuZGVmaW5lZCk7XG4vKipcbiAqIFVzZSBbYGdldEFzc2lnblNlbWlncm91cGBdKC4vc3RydWN0LnRzLmh0bWwjZ2V0QXNzaWduU2VtaWdyb3VwKSBpbnN0ZWFkLlxuICpcbiAqIEBjYXRlZ29yeSB6b25lIG9mIGRlYXRoXG4gKiBAc2luY2UgMi4wLjBcbiAqIEBkZXByZWNhdGVkXG4gKi9cbmV4cG9ydCB2YXIgZ2V0T2JqZWN0U2VtaWdyb3VwID0gZnVuY3Rpb24gKCkgeyByZXR1cm4gKHtcbiAgICBjb25jYXQ6IGZ1bmN0aW9uIChmaXJzdCwgc2Vjb25kKSB7IHJldHVybiBPYmplY3QuYXNzaWduKHt9LCBmaXJzdCwgc2Vjb25kKTsgfVxufSk7IH07XG4vKipcbiAqIFVzZSBbYGxhc3RgXSgjbGFzdCkgaW5zdGVhZC5cbiAqXG4gKiBAY2F0ZWdvcnkgem9uZSBvZiBkZWF0aFxuICogQHNpbmNlIDIuMC4wXG4gKiBAZGVwcmVjYXRlZFxuICovXG5leHBvcnQgdmFyIGdldExhc3RTZW1pZ3JvdXAgPSBsYXN0O1xuLyoqXG4gKiBVc2UgW2BmaXJzdGBdKCNmaXJzdCkgaW5zdGVhZC5cbiAqXG4gKiBAY2F0ZWdvcnkgem9uZSBvZiBkZWF0aFxuICogQHNpbmNlIDIuMC4wXG4gKiBAZGVwcmVjYXRlZFxuICovXG5leHBvcnQgdmFyIGdldEZpcnN0U2VtaWdyb3VwID0gZmlyc3Q7XG4vKipcbiAqIFVzZSBbYHR1cGxlYF0oI3R1cGxlKSBpbnN0ZWFkLlxuICpcbiAqIEBjYXRlZ29yeSB6b25lIG9mIGRlYXRoXG4gKiBAc2luY2UgMi4wLjBcbiAqIEBkZXByZWNhdGVkXG4gKi9cbmV4cG9ydCB2YXIgZ2V0VHVwbGVTZW1pZ3JvdXAgPSB0dXBsZTtcbi8qKlxuICogVXNlIFtgc3RydWN0YF0oI3N0cnVjdCkgaW5zdGVhZC5cbiAqXG4gKiBAY2F0ZWdvcnkgem9uZSBvZiBkZWF0aFxuICogQHNpbmNlIDIuMC4wXG4gKiBAZGVwcmVjYXRlZFxuICovXG5leHBvcnQgdmFyIGdldFN0cnVjdFNlbWlncm91cCA9IHN0cnVjdDtcbi8qKlxuICogVXNlIFtgcmV2ZXJzZWBdKCNyZXZlcnNlKSBpbnN0ZWFkLlxuICpcbiAqIEBjYXRlZ29yeSB6b25lIG9mIGRlYXRoXG4gKiBAc2luY2UgMi4wLjBcbiAqIEBkZXByZWNhdGVkXG4gKi9cbmV4cG9ydCB2YXIgZ2V0RHVhbFNlbWlncm91cCA9IHJldmVyc2U7XG4vKipcbiAqIFVzZSBbYG1heGBdKCNtYXgpIGluc3RlYWQuXG4gKlxuICogQGNhdGVnb3J5IHpvbmUgb2YgZGVhdGhcbiAqIEBzaW5jZSAyLjAuMFxuICogQGRlcHJlY2F0ZWRcbiAqL1xuZXhwb3J0IHZhciBnZXRKb2luU2VtaWdyb3VwID0gbWF4O1xuLyoqXG4gKiBVc2UgW2BtaW5gXSgjbWluKSBpbnN0ZWFkLlxuICpcbiAqIEBjYXRlZ29yeSB6b25lIG9mIGRlYXRoXG4gKiBAc2luY2UgMi4wLjBcbiAqIEBkZXByZWNhdGVkXG4gKi9cbmV4cG9ydCB2YXIgZ2V0TWVldFNlbWlncm91cCA9IG1pbjtcbi8qKlxuICogVXNlIFtgaW50ZXJjYWxhdGVgXSgjaW50ZXJjYWxhdGUpIGluc3RlYWQuXG4gKlxuICogQGNhdGVnb3J5IHpvbmUgb2YgZGVhdGhcbiAqIEBzaW5jZSAyLjUuMFxuICogQGRlcHJlY2F0ZWRcbiAqL1xuZXhwb3J0IHZhciBnZXRJbnRlcmNhbGF0ZVNlbWlncm91cCA9IGludGVyY2FsYXRlO1xuZXhwb3J0IGZ1bmN0aW9uIGZvbGQoUykge1xuICAgIHZhciBjb25jYXRBbGxTID0gY29uY2F0QWxsKFMpO1xuICAgIHJldHVybiBmdW5jdGlvbiAoc3RhcnRXaXRoLCBhcykgeyByZXR1cm4gKGFzID09PSB1bmRlZmluZWQgPyBjb25jYXRBbGxTKHN0YXJ0V2l0aCkgOiBjb25jYXRBbGxTKHN0YXJ0V2l0aCkoYXMpKTsgfTtcbn1cbi8qKlxuICogVXNlIFtgU2VtaWdyb3VwQWxsYF0oLi9ib29sZWFuLnRzLmh0bWwjU2VtaWdyb3VwQWxsKSBpbnN0ZWFkLlxuICpcbiAqIEBjYXRlZ29yeSB6b25lIG9mIGRlYXRoXG4gKiBAc2luY2UgMi4wLjBcbiAqIEBkZXByZWNhdGVkXG4gKi9cbmV4cG9ydCB2YXIgc2VtaWdyb3VwQWxsID0ge1xuICAgIGNvbmNhdDogZnVuY3Rpb24gKHgsIHkpIHsgcmV0dXJuIHggJiYgeTsgfVxufTtcbi8qKlxuICogVXNlIFtgU2VtaWdyb3VwQW55YF0oLi9ib29sZWFuLnRzLmh0bWwjU2VtaWdyb3VwQW55KSBpbnN0ZWFkLlxuICpcbiAqIEBjYXRlZ29yeSB6b25lIG9mIGRlYXRoXG4gKiBAc2luY2UgMi4wLjBcbiAqIEBkZXByZWNhdGVkXG4gKi9cbmV4cG9ydCB2YXIgc2VtaWdyb3VwQW55ID0ge1xuICAgIGNvbmNhdDogZnVuY3Rpb24gKHgsIHkpIHsgcmV0dXJuIHggfHwgeTsgfVxufTtcbi8qKlxuICogVXNlIFtgZ2V0U2VtaWdyb3VwYF0oLi9mdW5jdGlvbi50cy5odG1sI2dldFNlbWlncm91cCkgaW5zdGVhZC5cbiAqXG4gKiBAY2F0ZWdvcnkgem9uZSBvZiBkZWF0aFxuICogQHNpbmNlIDIuMC4wXG4gKiBAZGVwcmVjYXRlZFxuICovXG5leHBvcnQgdmFyIGdldEZ1bmN0aW9uU2VtaWdyb3VwID0gZ2V0U2VtaWdyb3VwO1xuLyoqXG4gKiBVc2UgW2BTZW1pZ3JvdXBgXSguL3N0cmluZy50cy5odG1sI1NlbWlncm91cCkgaW5zdGVhZC5cbiAqXG4gKiBAY2F0ZWdvcnkgem9uZSBvZiBkZWF0aFxuICogQHNpbmNlIDIuMC4wXG4gKiBAZGVwcmVjYXRlZFxuICovXG5leHBvcnQgdmFyIHNlbWlncm91cFN0cmluZyA9IHtcbiAgICBjb25jYXQ6IGZ1bmN0aW9uICh4LCB5KSB7IHJldHVybiB4ICsgeTsgfVxufTtcbi8qKlxuICogVXNlIFtgU2VtaWdyb3VwU3VtYF0oLi9udW1iZXIudHMuaHRtbCNTZW1pZ3JvdXBTdW0pIGluc3RlYWQuXG4gKlxuICogQGNhdGVnb3J5IHpvbmUgb2YgZGVhdGhcbiAqIEBzaW5jZSAyLjAuMFxuICogQGRlcHJlY2F0ZWRcbiAqL1xuZXhwb3J0IHZhciBzZW1pZ3JvdXBTdW0gPSB7XG4gICAgY29uY2F0OiBmdW5jdGlvbiAoeCwgeSkgeyByZXR1cm4geCArIHk7IH1cbn07XG4vKipcbiAqIFVzZSBbYFNlbWlncm91cFByb2R1Y3RgXSguL251bWJlci50cy5odG1sI1NlbWlncm91cFByb2R1Y3QpIGluc3RlYWQuXG4gKlxuICogQGNhdGVnb3J5IHpvbmUgb2YgZGVhdGhcbiAqIEBzaW5jZSAyLjAuMFxuICogQGRlcHJlY2F0ZWRcbiAqL1xuZXhwb3J0IHZhciBzZW1pZ3JvdXBQcm9kdWN0ID0ge1xuICAgIGNvbmNhdDogZnVuY3Rpb24gKHgsIHkpIHsgcmV0dXJuIHggKiB5OyB9XG59O1xuIiwKICAiLyoqXG4gKiBJZiBhIHR5cGUgYEFgIGNhbiBmb3JtIGEgYFNlbWlncm91cGAgaXQgaGFzIGFuICoqYXNzb2NpYXRpdmUqKiBiaW5hcnkgb3BlcmF0aW9uLlxuICpcbiAqIGBgYHRzXG4gKiBpbnRlcmZhY2UgU2VtaWdyb3VwPEE+IHtcbiAqICAgcmVhZG9ubHkgY29uY2F0OiAoeDogQSwgeTogQSkgPT4gQVxuICogfVxuICogYGBgXG4gKlxuICogQXNzb2NpYXRpdml0eSBtZWFucyB0aGUgZm9sbG93aW5nIGVxdWFsaXR5IG11c3QgaG9sZCBmb3IgYW55IGNob2ljZSBvZiBgeGAsIGB5YCwgYW5kIGB6YC5cbiAqXG4gKiBgYGB0c1xuICogY29uY2F0KHgsIGNvbmNhdCh5LCB6KSkgPSBjb25jYXQoY29uY2F0KHgsIHkpLCB6KVxuICogYGBgXG4gKlxuICogQSBjb21tb24gZXhhbXBsZSBvZiBhIHNlbWlncm91cCBpcyB0aGUgdHlwZSBgc3RyaW5nYCB3aXRoIHRoZSBvcGVyYXRpb24gYCtgLlxuICpcbiAqIGBgYHRzXG4gKiBpbXBvcnQgeyBTZW1pZ3JvdXAgfSBmcm9tICdmcC10cy9TZW1pZ3JvdXAnXG4gKlxuICogY29uc3Qgc2VtaWdyb3VwU3RyaW5nOiBTZW1pZ3JvdXA8c3RyaW5nPiA9IHtcbiAqICAgY29uY2F0OiAoeCwgeSkgPT4geCArIHlcbiAqIH1cbiAqXG4gKiBjb25zdCB4ID0gJ3gnXG4gKiBjb25zdCB5ID0gJ3knXG4gKiBjb25zdCB6ID0gJ3onXG4gKlxuICogc2VtaWdyb3VwU3RyaW5nLmNvbmNhdCh4LCB5KSAvLyAneHknXG4gKlxuICogc2VtaWdyb3VwU3RyaW5nLmNvbmNhdCh4LCBzZW1pZ3JvdXBTdHJpbmcuY29uY2F0KHksIHopKSAvLyAneHl6J1xuICpcbiAqIHNlbWlncm91cFN0cmluZy5jb25jYXQoc2VtaWdyb3VwU3RyaW5nLmNvbmNhdCh4LCB5KSwgeikgLy8gJ3h5eidcbiAqIGBgYFxuICpcbiAqICpBZGFwdGVkIGZyb20gaHR0cHM6Ly90eXBlbGV2ZWwub3JnL2NhdHMqXG4gKlxuICogQHNpbmNlIDIuMC4wXG4gKi9cbmltcG9ydCB7IGdldFNlbWlncm91cCwgaWRlbnRpdHkgfSBmcm9tICcuL2Z1bmN0aW9uJztcbmltcG9ydCAqIGFzIF8gZnJvbSAnLi9pbnRlcm5hbCc7XG5pbXBvcnQgKiBhcyBNIGZyb20gJy4vTWFnbWEnO1xuaW1wb3J0ICogYXMgT3IgZnJvbSAnLi9PcmQnO1xuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLy8gY29uc3RydWN0b3JzXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vKipcbiAqIEdldCBhIHNlbWlncm91cCB3aGVyZSBgY29uY2F0YCB3aWxsIHJldHVybiB0aGUgbWluaW11bSwgYmFzZWQgb24gdGhlIHByb3ZpZGVkIG9yZGVyLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgKiBhcyBOIGZyb20gJ2ZwLXRzL251bWJlcidcbiAqIGltcG9ydCAqIGFzIFMgZnJvbSAnZnAtdHMvU2VtaWdyb3VwJ1xuICpcbiAqIGNvbnN0IFMxID0gUy5taW4oTi5PcmQpXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChTMS5jb25jYXQoMSwgMiksIDEpXG4gKlxuICogQGNhdGVnb3J5IGNvbnN0cnVjdG9yc1xuICogQHNpbmNlIDIuMTAuMFxuICovXG5leHBvcnQgdmFyIG1pbiA9IGZ1bmN0aW9uIChPKSB7IHJldHVybiAoe1xuICAgIGNvbmNhdDogT3IubWluKE8pXG59KTsgfTtcbi8qKlxuICogR2V0IGEgc2VtaWdyb3VwIHdoZXJlIGBjb25jYXRgIHdpbGwgcmV0dXJuIHRoZSBtYXhpbXVtLCBiYXNlZCBvbiB0aGUgcHJvdmlkZWQgb3JkZXIuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCAqIGFzIE4gZnJvbSAnZnAtdHMvbnVtYmVyJ1xuICogaW1wb3J0ICogYXMgUyBmcm9tICdmcC10cy9TZW1pZ3JvdXAnXG4gKlxuICogY29uc3QgUzEgPSBTLm1heChOLk9yZClcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKFMxLmNvbmNhdCgxLCAyKSwgMilcbiAqXG4gKiBAY2F0ZWdvcnkgY29uc3RydWN0b3JzXG4gKiBAc2luY2UgMi4xMC4wXG4gKi9cbmV4cG9ydCB2YXIgbWF4ID0gZnVuY3Rpb24gKE8pIHsgcmV0dXJuICh7XG4gICAgY29uY2F0OiBPci5tYXgoTylcbn0pOyB9O1xuLyoqXG4gKiBAY2F0ZWdvcnkgY29uc3RydWN0b3JzXG4gKiBAc2luY2UgMi4xMC4wXG4gKi9cbmV4cG9ydCB2YXIgY29uc3RhbnQgPSBmdW5jdGlvbiAoYSkgeyByZXR1cm4gKHtcbiAgICBjb25jYXQ6IGZ1bmN0aW9uICgpIHsgcmV0dXJuIGE7IH1cbn0pOyB9O1xuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLy8gY29tYmluYXRvcnNcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8qKlxuICogVGhlIGR1YWwgb2YgYSBgU2VtaWdyb3VwYCwgb2J0YWluZWQgYnkgc3dhcHBpbmcgdGhlIGFyZ3VtZW50cyBvZiBgY29uY2F0YC5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgcmV2ZXJzZSB9IGZyb20gJ2ZwLXRzL1NlbWlncm91cCdcbiAqIGltcG9ydCAqIGFzIFMgZnJvbSAnZnAtdHMvc3RyaW5nJ1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwocmV2ZXJzZShTLlNlbWlncm91cCkuY29uY2F0KCdhJywgJ2InKSwgJ2JhJylcbiAqXG4gKiBAc2luY2UgMi4xMC4wXG4gKi9cbmV4cG9ydCB2YXIgcmV2ZXJzZSA9IE0ucmV2ZXJzZTtcbi8qKlxuICogR2l2ZW4gYSBzdHJ1Y3Qgb2Ygc2VtaWdyb3VwcyByZXR1cm5zIGEgc2VtaWdyb3VwIGZvciB0aGUgc3RydWN0LlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBzdHJ1Y3QgfSBmcm9tICdmcC10cy9TZW1pZ3JvdXAnXG4gKiBpbXBvcnQgKiBhcyBOIGZyb20gJ2ZwLXRzL251bWJlcidcbiAqXG4gKiBpbnRlcmZhY2UgUG9pbnQge1xuICogICByZWFkb25seSB4OiBudW1iZXJcbiAqICAgcmVhZG9ubHkgeTogbnVtYmVyXG4gKiB9XG4gKlxuICogY29uc3QgUyA9IHN0cnVjdDxQb2ludD4oe1xuICogICB4OiBOLlNlbWlncm91cFN1bSxcbiAqICAgeTogTi5TZW1pZ3JvdXBTdW1cbiAqIH0pXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChTLmNvbmNhdCh7IHg6IDEsIHk6IDIgfSwgeyB4OiAzLCB5OiA0IH0pLCB7IHg6IDQsIHk6IDYgfSlcbiAqXG4gKiBAc2luY2UgMi4xMC4wXG4gKi9cbmV4cG9ydCB2YXIgc3RydWN0ID0gZnVuY3Rpb24gKHNlbWlncm91cHMpIHsgcmV0dXJuICh7XG4gICAgY29uY2F0OiBmdW5jdGlvbiAoZmlyc3QsIHNlY29uZCkge1xuICAgICAgICB2YXIgciA9IHt9O1xuICAgICAgICBmb3IgKHZhciBrIGluIHNlbWlncm91cHMpIHtcbiAgICAgICAgICAgIGlmIChfLmhhcy5jYWxsKHNlbWlncm91cHMsIGspKSB7XG4gICAgICAgICAgICAgICAgcltrXSA9IHNlbWlncm91cHNba10uY29uY2F0KGZpcnN0W2tdLCBzZWNvbmRba10pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiByO1xuICAgIH1cbn0pOyB9O1xuLyoqXG4gKiBHaXZlbiBhIHR1cGxlIG9mIHNlbWlncm91cHMgcmV0dXJucyBhIHNlbWlncm91cCBmb3IgdGhlIHR1cGxlLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyB0dXBsZSB9IGZyb20gJ2ZwLXRzL1NlbWlncm91cCdcbiAqIGltcG9ydCAqIGFzIEIgZnJvbSAnZnAtdHMvYm9vbGVhbidcbiAqIGltcG9ydCAqIGFzIE4gZnJvbSAnZnAtdHMvbnVtYmVyJ1xuICogaW1wb3J0ICogYXMgUyBmcm9tICdmcC10cy9zdHJpbmcnXG4gKlxuICogY29uc3QgUzEgPSB0dXBsZShTLlNlbWlncm91cCwgTi5TZW1pZ3JvdXBTdW0pXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKFMxLmNvbmNhdChbJ2EnLCAxXSwgWydiJywgMl0pLCBbJ2FiJywgM10pXG4gKlxuICogY29uc3QgUzIgPSB0dXBsZShTLlNlbWlncm91cCwgTi5TZW1pZ3JvdXBTdW0sIEIuU2VtaWdyb3VwQWxsKVxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChTMi5jb25jYXQoWydhJywgMSwgdHJ1ZV0sIFsnYicsIDIsIGZhbHNlXSksIFsnYWInLCAzLCBmYWxzZV0pXG4gKlxuICogQHNpbmNlIDIuMTAuMFxuICovXG5leHBvcnQgdmFyIHR1cGxlID0gZnVuY3Rpb24gKCkge1xuICAgIHZhciBzZW1pZ3JvdXBzID0gW107XG4gICAgZm9yICh2YXIgX2kgPSAwOyBfaSA8IGFyZ3VtZW50cy5sZW5ndGg7IF9pKyspIHtcbiAgICAgICAgc2VtaWdyb3Vwc1tfaV0gPSBhcmd1bWVudHNbX2ldO1xuICAgIH1cbiAgICByZXR1cm4gKHtcbiAgICAgICAgY29uY2F0OiBmdW5jdGlvbiAoZmlyc3QsIHNlY29uZCkgeyByZXR1cm4gc2VtaWdyb3Vwcy5tYXAoZnVuY3Rpb24gKHMsIGkpIHsgcmV0dXJuIHMuY29uY2F0KGZpcnN0W2ldLCBzZWNvbmRbaV0pOyB9KTsgfVxuICAgIH0pO1xufTtcbi8qKlxuICogQmV0d2VlbiBlYWNoIHBhaXIgb2YgZWxlbWVudHMgaW5zZXJ0IGBtaWRkbGVgLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBpbnRlcmNhbGF0ZSB9IGZyb20gJ2ZwLXRzL1NlbWlncm91cCdcbiAqIGltcG9ydCAqIGFzIFMgZnJvbSAnZnAtdHMvc3RyaW5nJ1xuICogaW1wb3J0IHsgcGlwZSB9IGZyb20gJ2ZwLXRzL2Z1bmN0aW9uJ1xuICpcbiAqIGNvbnN0IFMxID0gcGlwZShTLlNlbWlncm91cCwgaW50ZXJjYWxhdGUoJyArICcpKVxuICpcbiAqIGFzc2VydC5zdHJpY3RFcXVhbChTMS5jb25jYXQoJ2EnLCAnYicpLCAnYSArIGInKVxuICpcbiAqIEBzaW5jZSAyLjEwLjBcbiAqL1xuZXhwb3J0IHZhciBpbnRlcmNhbGF0ZSA9IGZ1bmN0aW9uIChtaWRkbGUpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKFMpIHsgcmV0dXJuICh7XG4gICAgICAgIGNvbmNhdDogZnVuY3Rpb24gKHgsIHkpIHsgcmV0dXJuIFMuY29uY2F0KHgsIFMuY29uY2F0KG1pZGRsZSwgeSkpOyB9XG4gICAgfSk7IH07XG59O1xuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLy8gaW5zdGFuY2VzXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vKipcbiAqIEFsd2F5cyByZXR1cm4gdGhlIGZpcnN0IGFyZ3VtZW50LlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgKiBhcyBTIGZyb20gJ2ZwLXRzL1NlbWlncm91cCdcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKFMuZmlyc3Q8bnVtYmVyPigpLmNvbmNhdCgxLCAyKSwgMSlcbiAqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi4xMC4wXG4gKi9cbmV4cG9ydCB2YXIgZmlyc3QgPSBmdW5jdGlvbiAoKSB7IHJldHVybiAoeyBjb25jYXQ6IGlkZW50aXR5IH0pOyB9O1xuLyoqXG4gKiBBbHdheXMgcmV0dXJuIHRoZSBsYXN0IGFyZ3VtZW50LlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgKiBhcyBTIGZyb20gJ2ZwLXRzL1NlbWlncm91cCdcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKFMubGFzdDxudW1iZXI+KCkuY29uY2F0KDEsIDIpLCAyKVxuICpcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjEwLjBcbiAqL1xuZXhwb3J0IHZhciBsYXN0ID0gZnVuY3Rpb24gKCkgeyByZXR1cm4gKHsgY29uY2F0OiBmdW5jdGlvbiAoXywgeSkgeyByZXR1cm4geTsgfSB9KTsgfTtcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8vIHV0aWxzXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vKipcbiAqIEdpdmVuIGEgc2VxdWVuY2Ugb2YgYGFzYCwgY29uY2F0IHRoZW0gYW5kIHJldHVybiB0aGUgdG90YWwuXG4gKlxuICogSWYgYGFzYCBpcyBlbXB0eSwgcmV0dXJuIHRoZSBwcm92aWRlZCBgc3RhcnRXaXRoYCB2YWx1ZS5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgY29uY2F0QWxsIH0gZnJvbSAnZnAtdHMvU2VtaWdyb3VwJ1xuICogaW1wb3J0ICogYXMgTiBmcm9tICdmcC10cy9udW1iZXInXG4gKlxuICogY29uc3Qgc3VtID0gY29uY2F0QWxsKE4uU2VtaWdyb3VwU3VtKSgwKVxuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoc3VtKFsxLCAyLCAzXSksIDYpXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKHN1bShbXSksIDApXG4gKlxuICogQHNpbmNlIDIuMTAuMFxuICovXG5leHBvcnQgdmFyIGNvbmNhdEFsbCA9IE0uY29uY2F0QWxsO1xuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLy8gZGVwcmVjYXRlZFxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLyoqXG4gKiBVc2UgYHZvaWRgIG1vZHVsZSBpbnN0ZWFkLlxuICpcbiAqIEBjYXRlZ29yeSB6b25lIG9mIGRlYXRoXG4gKiBAc2luY2UgMi4wLjBcbiAqIEBkZXByZWNhdGVkXG4gKi9cbmV4cG9ydCB2YXIgc2VtaWdyb3VwVm9pZCA9IGNvbnN0YW50KHVuZGVmaW5lZCk7XG4vKipcbiAqIFVzZSBbYGdldEFzc2lnblNlbWlncm91cGBdKC4vc3RydWN0LnRzLmh0bWwjZ2V0QXNzaWduU2VtaWdyb3VwKSBpbnN0ZWFkLlxuICpcbiAqIEBjYXRlZ29yeSB6b25lIG9mIGRlYXRoXG4gKiBAc2luY2UgMi4wLjBcbiAqIEBkZXByZWNhdGVkXG4gKi9cbmV4cG9ydCB2YXIgZ2V0T2JqZWN0U2VtaWdyb3VwID0gZnVuY3Rpb24gKCkgeyByZXR1cm4gKHtcbiAgICBjb25jYXQ6IGZ1bmN0aW9uIChmaXJzdCwgc2Vjb25kKSB7IHJldHVybiBPYmplY3QuYXNzaWduKHt9LCBmaXJzdCwgc2Vjb25kKTsgfVxufSk7IH07XG4vKipcbiAqIFVzZSBbYGxhc3RgXSgjbGFzdCkgaW5zdGVhZC5cbiAqXG4gKiBAY2F0ZWdvcnkgem9uZSBvZiBkZWF0aFxuICogQHNpbmNlIDIuMC4wXG4gKiBAZGVwcmVjYXRlZFxuICovXG5leHBvcnQgdmFyIGdldExhc3RTZW1pZ3JvdXAgPSBsYXN0O1xuLyoqXG4gKiBVc2UgW2BmaXJzdGBdKCNmaXJzdCkgaW5zdGVhZC5cbiAqXG4gKiBAY2F0ZWdvcnkgem9uZSBvZiBkZWF0aFxuICogQHNpbmNlIDIuMC4wXG4gKiBAZGVwcmVjYXRlZFxuICovXG5leHBvcnQgdmFyIGdldEZpcnN0U2VtaWdyb3VwID0gZmlyc3Q7XG4vKipcbiAqIFVzZSBbYHR1cGxlYF0oI3R1cGxlKSBpbnN0ZWFkLlxuICpcbiAqIEBjYXRlZ29yeSB6b25lIG9mIGRlYXRoXG4gKiBAc2luY2UgMi4wLjBcbiAqIEBkZXByZWNhdGVkXG4gKi9cbmV4cG9ydCB2YXIgZ2V0VHVwbGVTZW1pZ3JvdXAgPSB0dXBsZTtcbi8qKlxuICogVXNlIFtgc3RydWN0YF0oI3N0cnVjdCkgaW5zdGVhZC5cbiAqXG4gKiBAY2F0ZWdvcnkgem9uZSBvZiBkZWF0aFxuICogQHNpbmNlIDIuMC4wXG4gKiBAZGVwcmVjYXRlZFxuICovXG5leHBvcnQgdmFyIGdldFN0cnVjdFNlbWlncm91cCA9IHN0cnVjdDtcbi8qKlxuICogVXNlIFtgcmV2ZXJzZWBdKCNyZXZlcnNlKSBpbnN0ZWFkLlxuICpcbiAqIEBjYXRlZ29yeSB6b25lIG9mIGRlYXRoXG4gKiBAc2luY2UgMi4wLjBcbiAqIEBkZXByZWNhdGVkXG4gKi9cbmV4cG9ydCB2YXIgZ2V0RHVhbFNlbWlncm91cCA9IHJldmVyc2U7XG4vKipcbiAqIFVzZSBbYG1heGBdKCNtYXgpIGluc3RlYWQuXG4gKlxuICogQGNhdGVnb3J5IHpvbmUgb2YgZGVhdGhcbiAqIEBzaW5jZSAyLjAuMFxuICogQGRlcHJlY2F0ZWRcbiAqL1xuZXhwb3J0IHZhciBnZXRKb2luU2VtaWdyb3VwID0gbWF4O1xuLyoqXG4gKiBVc2UgW2BtaW5gXSgjbWluKSBpbnN0ZWFkLlxuICpcbiAqIEBjYXRlZ29yeSB6b25lIG9mIGRlYXRoXG4gKiBAc2luY2UgMi4wLjBcbiAqIEBkZXByZWNhdGVkXG4gKi9cbmV4cG9ydCB2YXIgZ2V0TWVldFNlbWlncm91cCA9IG1pbjtcbi8qKlxuICogVXNlIFtgaW50ZXJjYWxhdGVgXSgjaW50ZXJjYWxhdGUpIGluc3RlYWQuXG4gKlxuICogQGNhdGVnb3J5IHpvbmUgb2YgZGVhdGhcbiAqIEBzaW5jZSAyLjUuMFxuICogQGRlcHJlY2F0ZWRcbiAqL1xuZXhwb3J0IHZhciBnZXRJbnRlcmNhbGF0ZVNlbWlncm91cCA9IGludGVyY2FsYXRlO1xuZXhwb3J0IGZ1bmN0aW9uIGZvbGQoUykge1xuICAgIHZhciBjb25jYXRBbGxTID0gY29uY2F0QWxsKFMpO1xuICAgIHJldHVybiBmdW5jdGlvbiAoc3RhcnRXaXRoLCBhcykgeyByZXR1cm4gKGFzID09PSB1bmRlZmluZWQgPyBjb25jYXRBbGxTKHN0YXJ0V2l0aCkgOiBjb25jYXRBbGxTKHN0YXJ0V2l0aCkoYXMpKTsgfTtcbn1cbi8qKlxuICogVXNlIFtgU2VtaWdyb3VwQWxsYF0oLi9ib29sZWFuLnRzLmh0bWwjU2VtaWdyb3VwQWxsKSBpbnN0ZWFkLlxuICpcbiAqIEBjYXRlZ29yeSB6b25lIG9mIGRlYXRoXG4gKiBAc2luY2UgMi4wLjBcbiAqIEBkZXByZWNhdGVkXG4gKi9cbmV4cG9ydCB2YXIgc2VtaWdyb3VwQWxsID0ge1xuICAgIGNvbmNhdDogZnVuY3Rpb24gKHgsIHkpIHsgcmV0dXJuIHggJiYgeTsgfVxufTtcbi8qKlxuICogVXNlIFtgU2VtaWdyb3VwQW55YF0oLi9ib29sZWFuLnRzLmh0bWwjU2VtaWdyb3VwQW55KSBpbnN0ZWFkLlxuICpcbiAqIEBjYXRlZ29yeSB6b25lIG9mIGRlYXRoXG4gKiBAc2luY2UgMi4wLjBcbiAqIEBkZXByZWNhdGVkXG4gKi9cbmV4cG9ydCB2YXIgc2VtaWdyb3VwQW55ID0ge1xuICAgIGNvbmNhdDogZnVuY3Rpb24gKHgsIHkpIHsgcmV0dXJuIHggfHwgeTsgfVxufTtcbi8qKlxuICogVXNlIFtgZ2V0U2VtaWdyb3VwYF0oLi9mdW5jdGlvbi50cy5odG1sI2dldFNlbWlncm91cCkgaW5zdGVhZC5cbiAqXG4gKiBAY2F0ZWdvcnkgem9uZSBvZiBkZWF0aFxuICogQHNpbmNlIDIuMC4wXG4gKiBAZGVwcmVjYXRlZFxuICovXG5leHBvcnQgdmFyIGdldEZ1bmN0aW9uU2VtaWdyb3VwID0gZ2V0U2VtaWdyb3VwO1xuLyoqXG4gKiBVc2UgW2BTZW1pZ3JvdXBgXSguL3N0cmluZy50cy5odG1sI1NlbWlncm91cCkgaW5zdGVhZC5cbiAqXG4gKiBAY2F0ZWdvcnkgem9uZSBvZiBkZWF0aFxuICogQHNpbmNlIDIuMC4wXG4gKiBAZGVwcmVjYXRlZFxuICovXG5leHBvcnQgdmFyIHNlbWlncm91cFN0cmluZyA9IHtcbiAgICBjb25jYXQ6IGZ1bmN0aW9uICh4LCB5KSB7IHJldHVybiB4ICsgeTsgfVxufTtcbi8qKlxuICogVXNlIFtgU2VtaWdyb3VwU3VtYF0oLi9udW1iZXIudHMuaHRtbCNTZW1pZ3JvdXBTdW0pIGluc3RlYWQuXG4gKlxuICogQGNhdGVnb3J5IHpvbmUgb2YgZGVhdGhcbiAqIEBzaW5jZSAyLjAuMFxuICogQGRlcHJlY2F0ZWRcbiAqL1xuZXhwb3J0IHZhciBzZW1pZ3JvdXBTdW0gPSB7XG4gICAgY29uY2F0OiBmdW5jdGlvbiAoeCwgeSkgeyByZXR1cm4geCArIHk7IH1cbn07XG4vKipcbiAqIFVzZSBbYFNlbWlncm91cFByb2R1Y3RgXSguL251bWJlci50cy5odG1sI1NlbWlncm91cFByb2R1Y3QpIGluc3RlYWQuXG4gKlxuICogQGNhdGVnb3J5IHpvbmUgb2YgZGVhdGhcbiAqIEBzaW5jZSAyLjAuMFxuICogQGRlcHJlY2F0ZWRcbiAqL1xuZXhwb3J0IHZhciBzZW1pZ3JvdXBQcm9kdWN0ID0ge1xuICAgIGNvbmNhdDogZnVuY3Rpb24gKHgsIHkpIHsgcmV0dXJuIHggKiB5OyB9XG59O1xuIiwKICAiLyoqXG4gKiBJZiBhIHR5cGUgYEFgIGNhbiBmb3JtIGEgYFNlbWlncm91cGAgaXQgaGFzIGFuICoqYXNzb2NpYXRpdmUqKiBiaW5hcnkgb3BlcmF0aW9uLlxuICpcbiAqIGBgYHRzXG4gKiBpbnRlcmZhY2UgU2VtaWdyb3VwPEE+IHtcbiAqICAgcmVhZG9ubHkgY29uY2F0OiAoeDogQSwgeTogQSkgPT4gQVxuICogfVxuICogYGBgXG4gKlxuICogQXNzb2NpYXRpdml0eSBtZWFucyB0aGUgZm9sbG93aW5nIGVxdWFsaXR5IG11c3QgaG9sZCBmb3IgYW55IGNob2ljZSBvZiBgeGAsIGB5YCwgYW5kIGB6YC5cbiAqXG4gKiBgYGB0c1xuICogY29uY2F0KHgsIGNvbmNhdCh5LCB6KSkgPSBjb25jYXQoY29uY2F0KHgsIHkpLCB6KVxuICogYGBgXG4gKlxuICogQSBjb21tb24gZXhhbXBsZSBvZiBhIHNlbWlncm91cCBpcyB0aGUgdHlwZSBgc3RyaW5nYCB3aXRoIHRoZSBvcGVyYXRpb24gYCtgLlxuICpcbiAqIGBgYHRzXG4gKiBpbXBvcnQgeyBTZW1pZ3JvdXAgfSBmcm9tICdmcC10cy9TZW1pZ3JvdXAnXG4gKlxuICogY29uc3Qgc2VtaWdyb3VwU3RyaW5nOiBTZW1pZ3JvdXA8c3RyaW5nPiA9IHtcbiAqICAgY29uY2F0OiAoeCwgeSkgPT4geCArIHlcbiAqIH1cbiAqXG4gKiBjb25zdCB4ID0gJ3gnXG4gKiBjb25zdCB5ID0gJ3knXG4gKiBjb25zdCB6ID0gJ3onXG4gKlxuICogc2VtaWdyb3VwU3RyaW5nLmNvbmNhdCh4LCB5KSAvLyAneHknXG4gKlxuICogc2VtaWdyb3VwU3RyaW5nLmNvbmNhdCh4LCBzZW1pZ3JvdXBTdHJpbmcuY29uY2F0KHksIHopKSAvLyAneHl6J1xuICpcbiAqIHNlbWlncm91cFN0cmluZy5jb25jYXQoc2VtaWdyb3VwU3RyaW5nLmNvbmNhdCh4LCB5KSwgeikgLy8gJ3h5eidcbiAqIGBgYFxuICpcbiAqICpBZGFwdGVkIGZyb20gaHR0cHM6Ly90eXBlbGV2ZWwub3JnL2NhdHMqXG4gKlxuICogQHNpbmNlIDIuMC4wXG4gKi9cbmltcG9ydCB7IGdldFNlbWlncm91cCwgaWRlbnRpdHkgfSBmcm9tICcuL2Z1bmN0aW9uJztcbmltcG9ydCAqIGFzIF8gZnJvbSAnLi9pbnRlcm5hbCc7XG5pbXBvcnQgKiBhcyBNIGZyb20gJy4vTWFnbWEnO1xuaW1wb3J0ICogYXMgT3IgZnJvbSAnLi9PcmQnO1xuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLy8gY29uc3RydWN0b3JzXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vKipcbiAqIEdldCBhIHNlbWlncm91cCB3aGVyZSBgY29uY2F0YCB3aWxsIHJldHVybiB0aGUgbWluaW11bSwgYmFzZWQgb24gdGhlIHByb3ZpZGVkIG9yZGVyLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgKiBhcyBOIGZyb20gJ2ZwLXRzL251bWJlcidcbiAqIGltcG9ydCAqIGFzIFMgZnJvbSAnZnAtdHMvU2VtaWdyb3VwJ1xuICpcbiAqIGNvbnN0IFMxID0gUy5taW4oTi5PcmQpXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChTMS5jb25jYXQoMSwgMiksIDEpXG4gKlxuICogQGNhdGVnb3J5IGNvbnN0cnVjdG9yc1xuICogQHNpbmNlIDIuMTAuMFxuICovXG5leHBvcnQgdmFyIG1pbiA9IGZ1bmN0aW9uIChPKSB7IHJldHVybiAoe1xuICAgIGNvbmNhdDogT3IubWluKE8pXG59KTsgfTtcbi8qKlxuICogR2V0IGEgc2VtaWdyb3VwIHdoZXJlIGBjb25jYXRgIHdpbGwgcmV0dXJuIHRoZSBtYXhpbXVtLCBiYXNlZCBvbiB0aGUgcHJvdmlkZWQgb3JkZXIuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCAqIGFzIE4gZnJvbSAnZnAtdHMvbnVtYmVyJ1xuICogaW1wb3J0ICogYXMgUyBmcm9tICdmcC10cy9TZW1pZ3JvdXAnXG4gKlxuICogY29uc3QgUzEgPSBTLm1heChOLk9yZClcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKFMxLmNvbmNhdCgxLCAyKSwgMilcbiAqXG4gKiBAY2F0ZWdvcnkgY29uc3RydWN0b3JzXG4gKiBAc2luY2UgMi4xMC4wXG4gKi9cbmV4cG9ydCB2YXIgbWF4ID0gZnVuY3Rpb24gKE8pIHsgcmV0dXJuICh7XG4gICAgY29uY2F0OiBPci5tYXgoTylcbn0pOyB9O1xuLyoqXG4gKiBAY2F0ZWdvcnkgY29uc3RydWN0b3JzXG4gKiBAc2luY2UgMi4xMC4wXG4gKi9cbmV4cG9ydCB2YXIgY29uc3RhbnQgPSBmdW5jdGlvbiAoYSkgeyByZXR1cm4gKHtcbiAgICBjb25jYXQ6IGZ1bmN0aW9uICgpIHsgcmV0dXJuIGE7IH1cbn0pOyB9O1xuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLy8gY29tYmluYXRvcnNcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8qKlxuICogVGhlIGR1YWwgb2YgYSBgU2VtaWdyb3VwYCwgb2J0YWluZWQgYnkgc3dhcHBpbmcgdGhlIGFyZ3VtZW50cyBvZiBgY29uY2F0YC5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgcmV2ZXJzZSB9IGZyb20gJ2ZwLXRzL1NlbWlncm91cCdcbiAqIGltcG9ydCAqIGFzIFMgZnJvbSAnZnAtdHMvc3RyaW5nJ1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwocmV2ZXJzZShTLlNlbWlncm91cCkuY29uY2F0KCdhJywgJ2InKSwgJ2JhJylcbiAqXG4gKiBAc2luY2UgMi4xMC4wXG4gKi9cbmV4cG9ydCB2YXIgcmV2ZXJzZSA9IE0ucmV2ZXJzZTtcbi8qKlxuICogR2l2ZW4gYSBzdHJ1Y3Qgb2Ygc2VtaWdyb3VwcyByZXR1cm5zIGEgc2VtaWdyb3VwIGZvciB0aGUgc3RydWN0LlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBzdHJ1Y3QgfSBmcm9tICdmcC10cy9TZW1pZ3JvdXAnXG4gKiBpbXBvcnQgKiBhcyBOIGZyb20gJ2ZwLXRzL251bWJlcidcbiAqXG4gKiBpbnRlcmZhY2UgUG9pbnQge1xuICogICByZWFkb25seSB4OiBudW1iZXJcbiAqICAgcmVhZG9ubHkgeTogbnVtYmVyXG4gKiB9XG4gKlxuICogY29uc3QgUyA9IHN0cnVjdDxQb2ludD4oe1xuICogICB4OiBOLlNlbWlncm91cFN1bSxcbiAqICAgeTogTi5TZW1pZ3JvdXBTdW1cbiAqIH0pXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChTLmNvbmNhdCh7IHg6IDEsIHk6IDIgfSwgeyB4OiAzLCB5OiA0IH0pLCB7IHg6IDQsIHk6IDYgfSlcbiAqXG4gKiBAc2luY2UgMi4xMC4wXG4gKi9cbmV4cG9ydCB2YXIgc3RydWN0ID0gZnVuY3Rpb24gKHNlbWlncm91cHMpIHsgcmV0dXJuICh7XG4gICAgY29uY2F0OiBmdW5jdGlvbiAoZmlyc3QsIHNlY29uZCkge1xuICAgICAgICB2YXIgciA9IHt9O1xuICAgICAgICBmb3IgKHZhciBrIGluIHNlbWlncm91cHMpIHtcbiAgICAgICAgICAgIGlmIChfLmhhcy5jYWxsKHNlbWlncm91cHMsIGspKSB7XG4gICAgICAgICAgICAgICAgcltrXSA9IHNlbWlncm91cHNba10uY29uY2F0KGZpcnN0W2tdLCBzZWNvbmRba10pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiByO1xuICAgIH1cbn0pOyB9O1xuLyoqXG4gKiBHaXZlbiBhIHR1cGxlIG9mIHNlbWlncm91cHMgcmV0dXJucyBhIHNlbWlncm91cCBmb3IgdGhlIHR1cGxlLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyB0dXBsZSB9IGZyb20gJ2ZwLXRzL1NlbWlncm91cCdcbiAqIGltcG9ydCAqIGFzIEIgZnJvbSAnZnAtdHMvYm9vbGVhbidcbiAqIGltcG9ydCAqIGFzIE4gZnJvbSAnZnAtdHMvbnVtYmVyJ1xuICogaW1wb3J0ICogYXMgUyBmcm9tICdmcC10cy9zdHJpbmcnXG4gKlxuICogY29uc3QgUzEgPSB0dXBsZShTLlNlbWlncm91cCwgTi5TZW1pZ3JvdXBTdW0pXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKFMxLmNvbmNhdChbJ2EnLCAxXSwgWydiJywgMl0pLCBbJ2FiJywgM10pXG4gKlxuICogY29uc3QgUzIgPSB0dXBsZShTLlNlbWlncm91cCwgTi5TZW1pZ3JvdXBTdW0sIEIuU2VtaWdyb3VwQWxsKVxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChTMi5jb25jYXQoWydhJywgMSwgdHJ1ZV0sIFsnYicsIDIsIGZhbHNlXSksIFsnYWInLCAzLCBmYWxzZV0pXG4gKlxuICogQHNpbmNlIDIuMTAuMFxuICovXG5leHBvcnQgdmFyIHR1cGxlID0gZnVuY3Rpb24gKCkge1xuICAgIHZhciBzZW1pZ3JvdXBzID0gW107XG4gICAgZm9yICh2YXIgX2kgPSAwOyBfaSA8IGFyZ3VtZW50cy5sZW5ndGg7IF9pKyspIHtcbiAgICAgICAgc2VtaWdyb3Vwc1tfaV0gPSBhcmd1bWVudHNbX2ldO1xuICAgIH1cbiAgICByZXR1cm4gKHtcbiAgICAgICAgY29uY2F0OiBmdW5jdGlvbiAoZmlyc3QsIHNlY29uZCkgeyByZXR1cm4gc2VtaWdyb3Vwcy5tYXAoZnVuY3Rpb24gKHMsIGkpIHsgcmV0dXJuIHMuY29uY2F0KGZpcnN0W2ldLCBzZWNvbmRbaV0pOyB9KTsgfVxuICAgIH0pO1xufTtcbi8qKlxuICogQmV0d2VlbiBlYWNoIHBhaXIgb2YgZWxlbWVudHMgaW5zZXJ0IGBtaWRkbGVgLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBpbnRlcmNhbGF0ZSB9IGZyb20gJ2ZwLXRzL1NlbWlncm91cCdcbiAqIGltcG9ydCAqIGFzIFMgZnJvbSAnZnAtdHMvc3RyaW5nJ1xuICogaW1wb3J0IHsgcGlwZSB9IGZyb20gJ2ZwLXRzL2Z1bmN0aW9uJ1xuICpcbiAqIGNvbnN0IFMxID0gcGlwZShTLlNlbWlncm91cCwgaW50ZXJjYWxhdGUoJyArICcpKVxuICpcbiAqIGFzc2VydC5zdHJpY3RFcXVhbChTMS5jb25jYXQoJ2EnLCAnYicpLCAnYSArIGInKVxuICpcbiAqIEBzaW5jZSAyLjEwLjBcbiAqL1xuZXhwb3J0IHZhciBpbnRlcmNhbGF0ZSA9IGZ1bmN0aW9uIChtaWRkbGUpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKFMpIHsgcmV0dXJuICh7XG4gICAgICAgIGNvbmNhdDogZnVuY3Rpb24gKHgsIHkpIHsgcmV0dXJuIFMuY29uY2F0KHgsIFMuY29uY2F0KG1pZGRsZSwgeSkpOyB9XG4gICAgfSk7IH07XG59O1xuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLy8gaW5zdGFuY2VzXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vKipcbiAqIEFsd2F5cyByZXR1cm4gdGhlIGZpcnN0IGFyZ3VtZW50LlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgKiBhcyBTIGZyb20gJ2ZwLXRzL1NlbWlncm91cCdcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKFMuZmlyc3Q8bnVtYmVyPigpLmNvbmNhdCgxLCAyKSwgMSlcbiAqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi4xMC4wXG4gKi9cbmV4cG9ydCB2YXIgZmlyc3QgPSBmdW5jdGlvbiAoKSB7IHJldHVybiAoeyBjb25jYXQ6IGlkZW50aXR5IH0pOyB9O1xuLyoqXG4gKiBBbHdheXMgcmV0dXJuIHRoZSBsYXN0IGFyZ3VtZW50LlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgKiBhcyBTIGZyb20gJ2ZwLXRzL1NlbWlncm91cCdcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKFMubGFzdDxudW1iZXI+KCkuY29uY2F0KDEsIDIpLCAyKVxuICpcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjEwLjBcbiAqL1xuZXhwb3J0IHZhciBsYXN0ID0gZnVuY3Rpb24gKCkgeyByZXR1cm4gKHsgY29uY2F0OiBmdW5jdGlvbiAoXywgeSkgeyByZXR1cm4geTsgfSB9KTsgfTtcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8vIHV0aWxzXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vKipcbiAqIEdpdmVuIGEgc2VxdWVuY2Ugb2YgYGFzYCwgY29uY2F0IHRoZW0gYW5kIHJldHVybiB0aGUgdG90YWwuXG4gKlxuICogSWYgYGFzYCBpcyBlbXB0eSwgcmV0dXJuIHRoZSBwcm92aWRlZCBgc3RhcnRXaXRoYCB2YWx1ZS5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgY29uY2F0QWxsIH0gZnJvbSAnZnAtdHMvU2VtaWdyb3VwJ1xuICogaW1wb3J0ICogYXMgTiBmcm9tICdmcC10cy9udW1iZXInXG4gKlxuICogY29uc3Qgc3VtID0gY29uY2F0QWxsKE4uU2VtaWdyb3VwU3VtKSgwKVxuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoc3VtKFsxLCAyLCAzXSksIDYpXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKHN1bShbXSksIDApXG4gKlxuICogQHNpbmNlIDIuMTAuMFxuICovXG5leHBvcnQgdmFyIGNvbmNhdEFsbCA9IE0uY29uY2F0QWxsO1xuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLy8gZGVwcmVjYXRlZFxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLyoqXG4gKiBVc2UgYHZvaWRgIG1vZHVsZSBpbnN0ZWFkLlxuICpcbiAqIEBjYXRlZ29yeSB6b25lIG9mIGRlYXRoXG4gKiBAc2luY2UgMi4wLjBcbiAqIEBkZXByZWNhdGVkXG4gKi9cbmV4cG9ydCB2YXIgc2VtaWdyb3VwVm9pZCA9IGNvbnN0YW50KHVuZGVmaW5lZCk7XG4vKipcbiAqIFVzZSBbYGdldEFzc2lnblNlbWlncm91cGBdKC4vc3RydWN0LnRzLmh0bWwjZ2V0QXNzaWduU2VtaWdyb3VwKSBpbnN0ZWFkLlxuICpcbiAqIEBjYXRlZ29yeSB6b25lIG9mIGRlYXRoXG4gKiBAc2luY2UgMi4wLjBcbiAqIEBkZXByZWNhdGVkXG4gKi9cbmV4cG9ydCB2YXIgZ2V0T2JqZWN0U2VtaWdyb3VwID0gZnVuY3Rpb24gKCkgeyByZXR1cm4gKHtcbiAgICBjb25jYXQ6IGZ1bmN0aW9uIChmaXJzdCwgc2Vjb25kKSB7IHJldHVybiBPYmplY3QuYXNzaWduKHt9LCBmaXJzdCwgc2Vjb25kKTsgfVxufSk7IH07XG4vKipcbiAqIFVzZSBbYGxhc3RgXSgjbGFzdCkgaW5zdGVhZC5cbiAqXG4gKiBAY2F0ZWdvcnkgem9uZSBvZiBkZWF0aFxuICogQHNpbmNlIDIuMC4wXG4gKiBAZGVwcmVjYXRlZFxuICovXG5leHBvcnQgdmFyIGdldExhc3RTZW1pZ3JvdXAgPSBsYXN0O1xuLyoqXG4gKiBVc2UgW2BmaXJzdGBdKCNmaXJzdCkgaW5zdGVhZC5cbiAqXG4gKiBAY2F0ZWdvcnkgem9uZSBvZiBkZWF0aFxuICogQHNpbmNlIDIuMC4wXG4gKiBAZGVwcmVjYXRlZFxuICovXG5leHBvcnQgdmFyIGdldEZpcnN0U2VtaWdyb3VwID0gZmlyc3Q7XG4vKipcbiAqIFVzZSBbYHR1cGxlYF0oI3R1cGxlKSBpbnN0ZWFkLlxuICpcbiAqIEBjYXRlZ29yeSB6b25lIG9mIGRlYXRoXG4gKiBAc2luY2UgMi4wLjBcbiAqIEBkZXByZWNhdGVkXG4gKi9cbmV4cG9ydCB2YXIgZ2V0VHVwbGVTZW1pZ3JvdXAgPSB0dXBsZTtcbi8qKlxuICogVXNlIFtgc3RydWN0YF0oI3N0cnVjdCkgaW5zdGVhZC5cbiAqXG4gKiBAY2F0ZWdvcnkgem9uZSBvZiBkZWF0aFxuICogQHNpbmNlIDIuMC4wXG4gKiBAZGVwcmVjYXRlZFxuICovXG5leHBvcnQgdmFyIGdldFN0cnVjdFNlbWlncm91cCA9IHN0cnVjdDtcbi8qKlxuICogVXNlIFtgcmV2ZXJzZWBdKCNyZXZlcnNlKSBpbnN0ZWFkLlxuICpcbiAqIEBjYXRlZ29yeSB6b25lIG9mIGRlYXRoXG4gKiBAc2luY2UgMi4wLjBcbiAqIEBkZXByZWNhdGVkXG4gKi9cbmV4cG9ydCB2YXIgZ2V0RHVhbFNlbWlncm91cCA9IHJldmVyc2U7XG4vKipcbiAqIFVzZSBbYG1heGBdKCNtYXgpIGluc3RlYWQuXG4gKlxuICogQGNhdGVnb3J5IHpvbmUgb2YgZGVhdGhcbiAqIEBzaW5jZSAyLjAuMFxuICogQGRlcHJlY2F0ZWRcbiAqL1xuZXhwb3J0IHZhciBnZXRKb2luU2VtaWdyb3VwID0gbWF4O1xuLyoqXG4gKiBVc2UgW2BtaW5gXSgjbWluKSBpbnN0ZWFkLlxuICpcbiAqIEBjYXRlZ29yeSB6b25lIG9mIGRlYXRoXG4gKiBAc2luY2UgMi4wLjBcbiAqIEBkZXByZWNhdGVkXG4gKi9cbmV4cG9ydCB2YXIgZ2V0TWVldFNlbWlncm91cCA9IG1pbjtcbi8qKlxuICogVXNlIFtgaW50ZXJjYWxhdGVgXSgjaW50ZXJjYWxhdGUpIGluc3RlYWQuXG4gKlxuICogQGNhdGVnb3J5IHpvbmUgb2YgZGVhdGhcbiAqIEBzaW5jZSAyLjUuMFxuICogQGRlcHJlY2F0ZWRcbiAqL1xuZXhwb3J0IHZhciBnZXRJbnRlcmNhbGF0ZVNlbWlncm91cCA9IGludGVyY2FsYXRlO1xuZXhwb3J0IGZ1bmN0aW9uIGZvbGQoUykge1xuICAgIHZhciBjb25jYXRBbGxTID0gY29uY2F0QWxsKFMpO1xuICAgIHJldHVybiBmdW5jdGlvbiAoc3RhcnRXaXRoLCBhcykgeyByZXR1cm4gKGFzID09PSB1bmRlZmluZWQgPyBjb25jYXRBbGxTKHN0YXJ0V2l0aCkgOiBjb25jYXRBbGxTKHN0YXJ0V2l0aCkoYXMpKTsgfTtcbn1cbi8qKlxuICogVXNlIFtgU2VtaWdyb3VwQWxsYF0oLi9ib29sZWFuLnRzLmh0bWwjU2VtaWdyb3VwQWxsKSBpbnN0ZWFkLlxuICpcbiAqIEBjYXRlZ29yeSB6b25lIG9mIGRlYXRoXG4gKiBAc2luY2UgMi4wLjBcbiAqIEBkZXByZWNhdGVkXG4gKi9cbmV4cG9ydCB2YXIgc2VtaWdyb3VwQWxsID0ge1xuICAgIGNvbmNhdDogZnVuY3Rpb24gKHgsIHkpIHsgcmV0dXJuIHggJiYgeTsgfVxufTtcbi8qKlxuICogVXNlIFtgU2VtaWdyb3VwQW55YF0oLi9ib29sZWFuLnRzLmh0bWwjU2VtaWdyb3VwQW55KSBpbnN0ZWFkLlxuICpcbiAqIEBjYXRlZ29yeSB6b25lIG9mIGRlYXRoXG4gKiBAc2luY2UgMi4wLjBcbiAqIEBkZXByZWNhdGVkXG4gKi9cbmV4cG9ydCB2YXIgc2VtaWdyb3VwQW55ID0ge1xuICAgIGNvbmNhdDogZnVuY3Rpb24gKHgsIHkpIHsgcmV0dXJuIHggfHwgeTsgfVxufTtcbi8qKlxuICogVXNlIFtgZ2V0U2VtaWdyb3VwYF0oLi9mdW5jdGlvbi50cy5odG1sI2dldFNlbWlncm91cCkgaW5zdGVhZC5cbiAqXG4gKiBAY2F0ZWdvcnkgem9uZSBvZiBkZWF0aFxuICogQHNpbmNlIDIuMC4wXG4gKiBAZGVwcmVjYXRlZFxuICovXG5leHBvcnQgdmFyIGdldEZ1bmN0aW9uU2VtaWdyb3VwID0gZ2V0U2VtaWdyb3VwO1xuLyoqXG4gKiBVc2UgW2BTZW1pZ3JvdXBgXSguL3N0cmluZy50cy5odG1sI1NlbWlncm91cCkgaW5zdGVhZC5cbiAqXG4gKiBAY2F0ZWdvcnkgem9uZSBvZiBkZWF0aFxuICogQHNpbmNlIDIuMC4wXG4gKiBAZGVwcmVjYXRlZFxuICovXG5leHBvcnQgdmFyIHNlbWlncm91cFN0cmluZyA9IHtcbiAgICBjb25jYXQ6IGZ1bmN0aW9uICh4LCB5KSB7IHJldHVybiB4ICsgeTsgfVxufTtcbi8qKlxuICogVXNlIFtgU2VtaWdyb3VwU3VtYF0oLi9udW1iZXIudHMuaHRtbCNTZW1pZ3JvdXBTdW0pIGluc3RlYWQuXG4gKlxuICogQGNhdGVnb3J5IHpvbmUgb2YgZGVhdGhcbiAqIEBzaW5jZSAyLjAuMFxuICogQGRlcHJlY2F0ZWRcbiAqL1xuZXhwb3J0IHZhciBzZW1pZ3JvdXBTdW0gPSB7XG4gICAgY29uY2F0OiBmdW5jdGlvbiAoeCwgeSkgeyByZXR1cm4geCArIHk7IH1cbn07XG4vKipcbiAqIFVzZSBbYFNlbWlncm91cFByb2R1Y3RgXSguL251bWJlci50cy5odG1sI1NlbWlncm91cFByb2R1Y3QpIGluc3RlYWQuXG4gKlxuICogQGNhdGVnb3J5IHpvbmUgb2YgZGVhdGhcbiAqIEBzaW5jZSAyLjAuMFxuICogQGRlcHJlY2F0ZWRcbiAqL1xuZXhwb3J0IHZhciBzZW1pZ3JvdXBQcm9kdWN0ID0ge1xuICAgIGNvbmNhdDogZnVuY3Rpb24gKHgsIHkpIHsgcmV0dXJuIHggKiB5OyB9XG59O1xuIiwKICAiLyoqXG4gKiBJZiBhIHR5cGUgYEFgIGNhbiBmb3JtIGEgYFNlbWlncm91cGAgaXQgaGFzIGFuICoqYXNzb2NpYXRpdmUqKiBiaW5hcnkgb3BlcmF0aW9uLlxuICpcbiAqIGBgYHRzXG4gKiBpbnRlcmZhY2UgU2VtaWdyb3VwPEE+IHtcbiAqICAgcmVhZG9ubHkgY29uY2F0OiAoeDogQSwgeTogQSkgPT4gQVxuICogfVxuICogYGBgXG4gKlxuICogQXNzb2NpYXRpdml0eSBtZWFucyB0aGUgZm9sbG93aW5nIGVxdWFsaXR5IG11c3QgaG9sZCBmb3IgYW55IGNob2ljZSBvZiBgeGAsIGB5YCwgYW5kIGB6YC5cbiAqXG4gKiBgYGB0c1xuICogY29uY2F0KHgsIGNvbmNhdCh5LCB6KSkgPSBjb25jYXQoY29uY2F0KHgsIHkpLCB6KVxuICogYGBgXG4gKlxuICogQSBjb21tb24gZXhhbXBsZSBvZiBhIHNlbWlncm91cCBpcyB0aGUgdHlwZSBgc3RyaW5nYCB3aXRoIHRoZSBvcGVyYXRpb24gYCtgLlxuICpcbiAqIGBgYHRzXG4gKiBpbXBvcnQgeyBTZW1pZ3JvdXAgfSBmcm9tICdmcC10cy9TZW1pZ3JvdXAnXG4gKlxuICogY29uc3Qgc2VtaWdyb3VwU3RyaW5nOiBTZW1pZ3JvdXA8c3RyaW5nPiA9IHtcbiAqICAgY29uY2F0OiAoeCwgeSkgPT4geCArIHlcbiAqIH1cbiAqXG4gKiBjb25zdCB4ID0gJ3gnXG4gKiBjb25zdCB5ID0gJ3knXG4gKiBjb25zdCB6ID0gJ3onXG4gKlxuICogc2VtaWdyb3VwU3RyaW5nLmNvbmNhdCh4LCB5KSAvLyAneHknXG4gKlxuICogc2VtaWdyb3VwU3RyaW5nLmNvbmNhdCh4LCBzZW1pZ3JvdXBTdHJpbmcuY29uY2F0KHksIHopKSAvLyAneHl6J1xuICpcbiAqIHNlbWlncm91cFN0cmluZy5jb25jYXQoc2VtaWdyb3VwU3RyaW5nLmNvbmNhdCh4LCB5KSwgeikgLy8gJ3h5eidcbiAqIGBgYFxuICpcbiAqICpBZGFwdGVkIGZyb20gaHR0cHM6Ly90eXBlbGV2ZWwub3JnL2NhdHMqXG4gKlxuICogQHNpbmNlIDIuMC4wXG4gKi9cbmltcG9ydCB7IGdldFNlbWlncm91cCwgaWRlbnRpdHkgfSBmcm9tICcuL2Z1bmN0aW9uJztcbmltcG9ydCAqIGFzIF8gZnJvbSAnLi9pbnRlcm5hbCc7XG5pbXBvcnQgKiBhcyBNIGZyb20gJy4vTWFnbWEnO1xuaW1wb3J0ICogYXMgT3IgZnJvbSAnLi9PcmQnO1xuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLy8gY29uc3RydWN0b3JzXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vKipcbiAqIEdldCBhIHNlbWlncm91cCB3aGVyZSBgY29uY2F0YCB3aWxsIHJldHVybiB0aGUgbWluaW11bSwgYmFzZWQgb24gdGhlIHByb3ZpZGVkIG9yZGVyLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgKiBhcyBOIGZyb20gJ2ZwLXRzL251bWJlcidcbiAqIGltcG9ydCAqIGFzIFMgZnJvbSAnZnAtdHMvU2VtaWdyb3VwJ1xuICpcbiAqIGNvbnN0IFMxID0gUy5taW4oTi5PcmQpXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChTMS5jb25jYXQoMSwgMiksIDEpXG4gKlxuICogQGNhdGVnb3J5IGNvbnN0cnVjdG9yc1xuICogQHNpbmNlIDIuMTAuMFxuICovXG5leHBvcnQgdmFyIG1pbiA9IGZ1bmN0aW9uIChPKSB7IHJldHVybiAoe1xuICAgIGNvbmNhdDogT3IubWluKE8pXG59KTsgfTtcbi8qKlxuICogR2V0IGEgc2VtaWdyb3VwIHdoZXJlIGBjb25jYXRgIHdpbGwgcmV0dXJuIHRoZSBtYXhpbXVtLCBiYXNlZCBvbiB0aGUgcHJvdmlkZWQgb3JkZXIuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCAqIGFzIE4gZnJvbSAnZnAtdHMvbnVtYmVyJ1xuICogaW1wb3J0ICogYXMgUyBmcm9tICdmcC10cy9TZW1pZ3JvdXAnXG4gKlxuICogY29uc3QgUzEgPSBTLm1heChOLk9yZClcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKFMxLmNvbmNhdCgxLCAyKSwgMilcbiAqXG4gKiBAY2F0ZWdvcnkgY29uc3RydWN0b3JzXG4gKiBAc2luY2UgMi4xMC4wXG4gKi9cbmV4cG9ydCB2YXIgbWF4ID0gZnVuY3Rpb24gKE8pIHsgcmV0dXJuICh7XG4gICAgY29uY2F0OiBPci5tYXgoTylcbn0pOyB9O1xuLyoqXG4gKiBAY2F0ZWdvcnkgY29uc3RydWN0b3JzXG4gKiBAc2luY2UgMi4xMC4wXG4gKi9cbmV4cG9ydCB2YXIgY29uc3RhbnQgPSBmdW5jdGlvbiAoYSkgeyByZXR1cm4gKHtcbiAgICBjb25jYXQ6IGZ1bmN0aW9uICgpIHsgcmV0dXJuIGE7IH1cbn0pOyB9O1xuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLy8gY29tYmluYXRvcnNcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8qKlxuICogVGhlIGR1YWwgb2YgYSBgU2VtaWdyb3VwYCwgb2J0YWluZWQgYnkgc3dhcHBpbmcgdGhlIGFyZ3VtZW50cyBvZiBgY29uY2F0YC5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgcmV2ZXJzZSB9IGZyb20gJ2ZwLXRzL1NlbWlncm91cCdcbiAqIGltcG9ydCAqIGFzIFMgZnJvbSAnZnAtdHMvc3RyaW5nJ1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwocmV2ZXJzZShTLlNlbWlncm91cCkuY29uY2F0KCdhJywgJ2InKSwgJ2JhJylcbiAqXG4gKiBAc2luY2UgMi4xMC4wXG4gKi9cbmV4cG9ydCB2YXIgcmV2ZXJzZSA9IE0ucmV2ZXJzZTtcbi8qKlxuICogR2l2ZW4gYSBzdHJ1Y3Qgb2Ygc2VtaWdyb3VwcyByZXR1cm5zIGEgc2VtaWdyb3VwIGZvciB0aGUgc3RydWN0LlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBzdHJ1Y3QgfSBmcm9tICdmcC10cy9TZW1pZ3JvdXAnXG4gKiBpbXBvcnQgKiBhcyBOIGZyb20gJ2ZwLXRzL251bWJlcidcbiAqXG4gKiBpbnRlcmZhY2UgUG9pbnQge1xuICogICByZWFkb25seSB4OiBudW1iZXJcbiAqICAgcmVhZG9ubHkgeTogbnVtYmVyXG4gKiB9XG4gKlxuICogY29uc3QgUyA9IHN0cnVjdDxQb2ludD4oe1xuICogICB4OiBOLlNlbWlncm91cFN1bSxcbiAqICAgeTogTi5TZW1pZ3JvdXBTdW1cbiAqIH0pXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChTLmNvbmNhdCh7IHg6IDEsIHk6IDIgfSwgeyB4OiAzLCB5OiA0IH0pLCB7IHg6IDQsIHk6IDYgfSlcbiAqXG4gKiBAc2luY2UgMi4xMC4wXG4gKi9cbmV4cG9ydCB2YXIgc3RydWN0ID0gZnVuY3Rpb24gKHNlbWlncm91cHMpIHsgcmV0dXJuICh7XG4gICAgY29uY2F0OiBmdW5jdGlvbiAoZmlyc3QsIHNlY29uZCkge1xuICAgICAgICB2YXIgciA9IHt9O1xuICAgICAgICBmb3IgKHZhciBrIGluIHNlbWlncm91cHMpIHtcbiAgICAgICAgICAgIGlmIChfLmhhcy5jYWxsKHNlbWlncm91cHMsIGspKSB7XG4gICAgICAgICAgICAgICAgcltrXSA9IHNlbWlncm91cHNba10uY29uY2F0KGZpcnN0W2tdLCBzZWNvbmRba10pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiByO1xuICAgIH1cbn0pOyB9O1xuLyoqXG4gKiBHaXZlbiBhIHR1cGxlIG9mIHNlbWlncm91cHMgcmV0dXJucyBhIHNlbWlncm91cCBmb3IgdGhlIHR1cGxlLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyB0dXBsZSB9IGZyb20gJ2ZwLXRzL1NlbWlncm91cCdcbiAqIGltcG9ydCAqIGFzIEIgZnJvbSAnZnAtdHMvYm9vbGVhbidcbiAqIGltcG9ydCAqIGFzIE4gZnJvbSAnZnAtdHMvbnVtYmVyJ1xuICogaW1wb3J0ICogYXMgUyBmcm9tICdmcC10cy9zdHJpbmcnXG4gKlxuICogY29uc3QgUzEgPSB0dXBsZShTLlNlbWlncm91cCwgTi5TZW1pZ3JvdXBTdW0pXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKFMxLmNvbmNhdChbJ2EnLCAxXSwgWydiJywgMl0pLCBbJ2FiJywgM10pXG4gKlxuICogY29uc3QgUzIgPSB0dXBsZShTLlNlbWlncm91cCwgTi5TZW1pZ3JvdXBTdW0sIEIuU2VtaWdyb3VwQWxsKVxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChTMi5jb25jYXQoWydhJywgMSwgdHJ1ZV0sIFsnYicsIDIsIGZhbHNlXSksIFsnYWInLCAzLCBmYWxzZV0pXG4gKlxuICogQHNpbmNlIDIuMTAuMFxuICovXG5leHBvcnQgdmFyIHR1cGxlID0gZnVuY3Rpb24gKCkge1xuICAgIHZhciBzZW1pZ3JvdXBzID0gW107XG4gICAgZm9yICh2YXIgX2kgPSAwOyBfaSA8IGFyZ3VtZW50cy5sZW5ndGg7IF9pKyspIHtcbiAgICAgICAgc2VtaWdyb3Vwc1tfaV0gPSBhcmd1bWVudHNbX2ldO1xuICAgIH1cbiAgICByZXR1cm4gKHtcbiAgICAgICAgY29uY2F0OiBmdW5jdGlvbiAoZmlyc3QsIHNlY29uZCkgeyByZXR1cm4gc2VtaWdyb3Vwcy5tYXAoZnVuY3Rpb24gKHMsIGkpIHsgcmV0dXJuIHMuY29uY2F0KGZpcnN0W2ldLCBzZWNvbmRbaV0pOyB9KTsgfVxuICAgIH0pO1xufTtcbi8qKlxuICogQmV0d2VlbiBlYWNoIHBhaXIgb2YgZWxlbWVudHMgaW5zZXJ0IGBtaWRkbGVgLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBpbnRlcmNhbGF0ZSB9IGZyb20gJ2ZwLXRzL1NlbWlncm91cCdcbiAqIGltcG9ydCAqIGFzIFMgZnJvbSAnZnAtdHMvc3RyaW5nJ1xuICogaW1wb3J0IHsgcGlwZSB9IGZyb20gJ2ZwLXRzL2Z1bmN0aW9uJ1xuICpcbiAqIGNvbnN0IFMxID0gcGlwZShTLlNlbWlncm91cCwgaW50ZXJjYWxhdGUoJyArICcpKVxuICpcbiAqIGFzc2VydC5zdHJpY3RFcXVhbChTMS5jb25jYXQoJ2EnLCAnYicpLCAnYSArIGInKVxuICpcbiAqIEBzaW5jZSAyLjEwLjBcbiAqL1xuZXhwb3J0IHZhciBpbnRlcmNhbGF0ZSA9IGZ1bmN0aW9uIChtaWRkbGUpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKFMpIHsgcmV0dXJuICh7XG4gICAgICAgIGNvbmNhdDogZnVuY3Rpb24gKHgsIHkpIHsgcmV0dXJuIFMuY29uY2F0KHgsIFMuY29uY2F0KG1pZGRsZSwgeSkpOyB9XG4gICAgfSk7IH07XG59O1xuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLy8gaW5zdGFuY2VzXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vKipcbiAqIEFsd2F5cyByZXR1cm4gdGhlIGZpcnN0IGFyZ3VtZW50LlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgKiBhcyBTIGZyb20gJ2ZwLXRzL1NlbWlncm91cCdcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKFMuZmlyc3Q8bnVtYmVyPigpLmNvbmNhdCgxLCAyKSwgMSlcbiAqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi4xMC4wXG4gKi9cbmV4cG9ydCB2YXIgZmlyc3QgPSBmdW5jdGlvbiAoKSB7IHJldHVybiAoeyBjb25jYXQ6IGlkZW50aXR5IH0pOyB9O1xuLyoqXG4gKiBBbHdheXMgcmV0dXJuIHRoZSBsYXN0IGFyZ3VtZW50LlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgKiBhcyBTIGZyb20gJ2ZwLXRzL1NlbWlncm91cCdcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKFMubGFzdDxudW1iZXI+KCkuY29uY2F0KDEsIDIpLCAyKVxuICpcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjEwLjBcbiAqL1xuZXhwb3J0IHZhciBsYXN0ID0gZnVuY3Rpb24gKCkgeyByZXR1cm4gKHsgY29uY2F0OiBmdW5jdGlvbiAoXywgeSkgeyByZXR1cm4geTsgfSB9KTsgfTtcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8vIHV0aWxzXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vKipcbiAqIEdpdmVuIGEgc2VxdWVuY2Ugb2YgYGFzYCwgY29uY2F0IHRoZW0gYW5kIHJldHVybiB0aGUgdG90YWwuXG4gKlxuICogSWYgYGFzYCBpcyBlbXB0eSwgcmV0dXJuIHRoZSBwcm92aWRlZCBgc3RhcnRXaXRoYCB2YWx1ZS5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgY29uY2F0QWxsIH0gZnJvbSAnZnAtdHMvU2VtaWdyb3VwJ1xuICogaW1wb3J0ICogYXMgTiBmcm9tICdmcC10cy9udW1iZXInXG4gKlxuICogY29uc3Qgc3VtID0gY29uY2F0QWxsKE4uU2VtaWdyb3VwU3VtKSgwKVxuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoc3VtKFsxLCAyLCAzXSksIDYpXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKHN1bShbXSksIDApXG4gKlxuICogQHNpbmNlIDIuMTAuMFxuICovXG5leHBvcnQgdmFyIGNvbmNhdEFsbCA9IE0uY29uY2F0QWxsO1xuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLy8gZGVwcmVjYXRlZFxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLyoqXG4gKiBVc2UgYHZvaWRgIG1vZHVsZSBpbnN0ZWFkLlxuICpcbiAqIEBjYXRlZ29yeSB6b25lIG9mIGRlYXRoXG4gKiBAc2luY2UgMi4wLjBcbiAqIEBkZXByZWNhdGVkXG4gKi9cbmV4cG9ydCB2YXIgc2VtaWdyb3VwVm9pZCA9IGNvbnN0YW50KHVuZGVmaW5lZCk7XG4vKipcbiAqIFVzZSBbYGdldEFzc2lnblNlbWlncm91cGBdKC4vc3RydWN0LnRzLmh0bWwjZ2V0QXNzaWduU2VtaWdyb3VwKSBpbnN0ZWFkLlxuICpcbiAqIEBjYXRlZ29yeSB6b25lIG9mIGRlYXRoXG4gKiBAc2luY2UgMi4wLjBcbiAqIEBkZXByZWNhdGVkXG4gKi9cbmV4cG9ydCB2YXIgZ2V0T2JqZWN0U2VtaWdyb3VwID0gZnVuY3Rpb24gKCkgeyByZXR1cm4gKHtcbiAgICBjb25jYXQ6IGZ1bmN0aW9uIChmaXJzdCwgc2Vjb25kKSB7IHJldHVybiBPYmplY3QuYXNzaWduKHt9LCBmaXJzdCwgc2Vjb25kKTsgfVxufSk7IH07XG4vKipcbiAqIFVzZSBbYGxhc3RgXSgjbGFzdCkgaW5zdGVhZC5cbiAqXG4gKiBAY2F0ZWdvcnkgem9uZSBvZiBkZWF0aFxuICogQHNpbmNlIDIuMC4wXG4gKiBAZGVwcmVjYXRlZFxuICovXG5leHBvcnQgdmFyIGdldExhc3RTZW1pZ3JvdXAgPSBsYXN0O1xuLyoqXG4gKiBVc2UgW2BmaXJzdGBdKCNmaXJzdCkgaW5zdGVhZC5cbiAqXG4gKiBAY2F0ZWdvcnkgem9uZSBvZiBkZWF0aFxuICogQHNpbmNlIDIuMC4wXG4gKiBAZGVwcmVjYXRlZFxuICovXG5leHBvcnQgdmFyIGdldEZpcnN0U2VtaWdyb3VwID0gZmlyc3Q7XG4vKipcbiAqIFVzZSBbYHR1cGxlYF0oI3R1cGxlKSBpbnN0ZWFkLlxuICpcbiAqIEBjYXRlZ29yeSB6b25lIG9mIGRlYXRoXG4gKiBAc2luY2UgMi4wLjBcbiAqIEBkZXByZWNhdGVkXG4gKi9cbmV4cG9ydCB2YXIgZ2V0VHVwbGVTZW1pZ3JvdXAgPSB0dXBsZTtcbi8qKlxuICogVXNlIFtgc3RydWN0YF0oI3N0cnVjdCkgaW5zdGVhZC5cbiAqXG4gKiBAY2F0ZWdvcnkgem9uZSBvZiBkZWF0aFxuICogQHNpbmNlIDIuMC4wXG4gKiBAZGVwcmVjYXRlZFxuICovXG5leHBvcnQgdmFyIGdldFN0cnVjdFNlbWlncm91cCA9IHN0cnVjdDtcbi8qKlxuICogVXNlIFtgcmV2ZXJzZWBdKCNyZXZlcnNlKSBpbnN0ZWFkLlxuICpcbiAqIEBjYXRlZ29yeSB6b25lIG9mIGRlYXRoXG4gKiBAc2luY2UgMi4wLjBcbiAqIEBkZXByZWNhdGVkXG4gKi9cbmV4cG9ydCB2YXIgZ2V0RHVhbFNlbWlncm91cCA9IHJldmVyc2U7XG4vKipcbiAqIFVzZSBbYG1heGBdKCNtYXgpIGluc3RlYWQuXG4gKlxuICogQGNhdGVnb3J5IHpvbmUgb2YgZGVhdGhcbiAqIEBzaW5jZSAyLjAuMFxuICogQGRlcHJlY2F0ZWRcbiAqL1xuZXhwb3J0IHZhciBnZXRKb2luU2VtaWdyb3VwID0gbWF4O1xuLyoqXG4gKiBVc2UgW2BtaW5gXSgjbWluKSBpbnN0ZWFkLlxuICpcbiAqIEBjYXRlZ29yeSB6b25lIG9mIGRlYXRoXG4gKiBAc2luY2UgMi4wLjBcbiAqIEBkZXByZWNhdGVkXG4gKi9cbmV4cG9ydCB2YXIgZ2V0TWVldFNlbWlncm91cCA9IG1pbjtcbi8qKlxuICogVXNlIFtgaW50ZXJjYWxhdGVgXSgjaW50ZXJjYWxhdGUpIGluc3RlYWQuXG4gKlxuICogQGNhdGVnb3J5IHpvbmUgb2YgZGVhdGhcbiAqIEBzaW5jZSAyLjUuMFxuICogQGRlcHJlY2F0ZWRcbiAqL1xuZXhwb3J0IHZhciBnZXRJbnRlcmNhbGF0ZVNlbWlncm91cCA9IGludGVyY2FsYXRlO1xuZXhwb3J0IGZ1bmN0aW9uIGZvbGQoUykge1xuICAgIHZhciBjb25jYXRBbGxTID0gY29uY2F0QWxsKFMpO1xuICAgIHJldHVybiBmdW5jdGlvbiAoc3RhcnRXaXRoLCBhcykgeyByZXR1cm4gKGFzID09PSB1bmRlZmluZWQgPyBjb25jYXRBbGxTKHN0YXJ0V2l0aCkgOiBjb25jYXRBbGxTKHN0YXJ0V2l0aCkoYXMpKTsgfTtcbn1cbi8qKlxuICogVXNlIFtgU2VtaWdyb3VwQWxsYF0oLi9ib29sZWFuLnRzLmh0bWwjU2VtaWdyb3VwQWxsKSBpbnN0ZWFkLlxuICpcbiAqIEBjYXRlZ29yeSB6b25lIG9mIGRlYXRoXG4gKiBAc2luY2UgMi4wLjBcbiAqIEBkZXByZWNhdGVkXG4gKi9cbmV4cG9ydCB2YXIgc2VtaWdyb3VwQWxsID0ge1xuICAgIGNvbmNhdDogZnVuY3Rpb24gKHgsIHkpIHsgcmV0dXJuIHggJiYgeTsgfVxufTtcbi8qKlxuICogVXNlIFtgU2VtaWdyb3VwQW55YF0oLi9ib29sZWFuLnRzLmh0bWwjU2VtaWdyb3VwQW55KSBpbnN0ZWFkLlxuICpcbiAqIEBjYXRlZ29yeSB6b25lIG9mIGRlYXRoXG4gKiBAc2luY2UgMi4wLjBcbiAqIEBkZXByZWNhdGVkXG4gKi9cbmV4cG9ydCB2YXIgc2VtaWdyb3VwQW55ID0ge1xuICAgIGNvbmNhdDogZnVuY3Rpb24gKHgsIHkpIHsgcmV0dXJuIHggfHwgeTsgfVxufTtcbi8qKlxuICogVXNlIFtgZ2V0U2VtaWdyb3VwYF0oLi9mdW5jdGlvbi50cy5odG1sI2dldFNlbWlncm91cCkgaW5zdGVhZC5cbiAqXG4gKiBAY2F0ZWdvcnkgem9uZSBvZiBkZWF0aFxuICogQHNpbmNlIDIuMC4wXG4gKiBAZGVwcmVjYXRlZFxuICovXG5leHBvcnQgdmFyIGdldEZ1bmN0aW9uU2VtaWdyb3VwID0gZ2V0U2VtaWdyb3VwO1xuLyoqXG4gKiBVc2UgW2BTZW1pZ3JvdXBgXSguL3N0cmluZy50cy5odG1sI1NlbWlncm91cCkgaW5zdGVhZC5cbiAqXG4gKiBAY2F0ZWdvcnkgem9uZSBvZiBkZWF0aFxuICogQHNpbmNlIDIuMC4wXG4gKiBAZGVwcmVjYXRlZFxuICovXG5leHBvcnQgdmFyIHNlbWlncm91cFN0cmluZyA9IHtcbiAgICBjb25jYXQ6IGZ1bmN0aW9uICh4LCB5KSB7IHJldHVybiB4ICsgeTsgfVxufTtcbi8qKlxuICogVXNlIFtgU2VtaWdyb3VwU3VtYF0oLi9udW1iZXIudHMuaHRtbCNTZW1pZ3JvdXBTdW0pIGluc3RlYWQuXG4gKlxuICogQGNhdGVnb3J5IHpvbmUgb2YgZGVhdGhcbiAqIEBzaW5jZSAyLjAuMFxuICogQGRlcHJlY2F0ZWRcbiAqL1xuZXhwb3J0IHZhciBzZW1pZ3JvdXBTdW0gPSB7XG4gICAgY29uY2F0OiBmdW5jdGlvbiAoeCwgeSkgeyByZXR1cm4geCArIHk7IH1cbn07XG4vKipcbiAqIFVzZSBbYFNlbWlncm91cFByb2R1Y3RgXSguL251bWJlci50cy5odG1sI1NlbWlncm91cFByb2R1Y3QpIGluc3RlYWQuXG4gKlxuICogQGNhdGVnb3J5IHpvbmUgb2YgZGVhdGhcbiAqIEBzaW5jZSAyLjAuMFxuICogQGRlcHJlY2F0ZWRcbiAqL1xuZXhwb3J0IHZhciBzZW1pZ3JvdXBQcm9kdWN0ID0ge1xuICAgIGNvbmNhdDogZnVuY3Rpb24gKHgsIHkpIHsgcmV0dXJuIHggKiB5OyB9XG59O1xuIiwKICAidmFyIF9fc3ByZWFkQXJyYXkgPSAodGhpcyAmJiB0aGlzLl9fc3ByZWFkQXJyYXkpIHx8IGZ1bmN0aW9uICh0bywgZnJvbSwgcGFjaykge1xuICAgIGlmIChwYWNrIHx8IGFyZ3VtZW50cy5sZW5ndGggPT09IDIpIGZvciAodmFyIGkgPSAwLCBsID0gZnJvbS5sZW5ndGgsIGFyOyBpIDwgbDsgaSsrKSB7XG4gICAgICAgIGlmIChhciB8fCAhKGkgaW4gZnJvbSkpIHtcbiAgICAgICAgICAgIGlmICghYXIpIGFyID0gQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoZnJvbSwgMCwgaSk7XG4gICAgICAgICAgICBhcltpXSA9IGZyb21baV07XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHRvLmNvbmNhdChhciB8fCBBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChmcm9tKSk7XG59O1xuaW1wb3J0IHsgYXBGaXJzdCBhcyBhcEZpcnN0XywgYXBTIGFzIGFwU18sIGFwU2Vjb25kIGFzIGFwU2Vjb25kXyB9IGZyb20gJy4vQXBwbHknO1xuaW1wb3J0IHsgYmluZCBhcyBiaW5kXywgY2hhaW5GaXJzdCBhcyBjaGFpbkZpcnN0XyB9IGZyb20gJy4vQ2hhaW4nO1xuaW1wb3J0IHsgZnJvbUVxdWFscyB9IGZyb20gJy4vRXEnO1xuaW1wb3J0IHsgZHVhbCwgZmxvdywgaWRlbnRpdHksIHBpcGUsIFNLIH0gZnJvbSAnLi9mdW5jdGlvbic7XG5pbXBvcnQgeyBiaW5kVG8gYXMgYmluZFRvXywgZmxhcCBhcyBmbGFwXywgbGV0IGFzIGxldF9fIH0gZnJvbSAnLi9GdW5jdG9yJztcbmltcG9ydCAqIGFzIF8gZnJvbSAnLi9pbnRlcm5hbCc7XG5pbXBvcnQgeyBnZXRNb25vaWQgfSBmcm9tICcuL09yZCc7XG5pbXBvcnQgKiBhcyBTZSBmcm9tICcuL1NlbWlncm91cCc7XG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vLyBpbnRlcm5hbFxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLyoqXG4gKiBAaW50ZXJuYWxcbiAqL1xuZXhwb3J0IHZhciBlbXB0eSA9IF8uZW1wdHlSZWFkb25seUFycmF5O1xuLyoqXG4gKiBAaW50ZXJuYWxcbiAqL1xuZXhwb3J0IHZhciBpc05vbkVtcHR5ID0gXy5pc05vbkVtcHR5O1xuLyoqXG4gKiBAaW50ZXJuYWxcbiAqL1xuZXhwb3J0IHZhciBpc091dE9mQm91bmQgPSBmdW5jdGlvbiAoaSwgYXMpIHsgcmV0dXJuIGkgPCAwIHx8IGkgPj0gYXMubGVuZ3RoOyB9O1xuLyoqXG4gKiBAaW50ZXJuYWxcbiAqL1xuZXhwb3J0IHZhciBwcmVwZW5kVyA9IGZ1bmN0aW9uIChoZWFkKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uICh0YWlsKSB7XG4gICAgICAgIHJldHVybiBfX3NwcmVhZEFycmF5KFtoZWFkXSwgdGFpbCwgdHJ1ZSk7XG4gICAgfTtcbn07XG4vKipcbiAqIEBpbnRlcm5hbFxuICovXG5leHBvcnQgdmFyIHByZXBlbmQgPSBwcmVwZW5kVztcbi8qKlxuICogQGludGVybmFsXG4gKi9cbmV4cG9ydCB2YXIgYXBwZW5kVyA9IGZ1bmN0aW9uIChlbmQpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGluaXQpIHtcbiAgICAgICAgcmV0dXJuIF9fc3ByZWFkQXJyYXkoX19zcHJlYWRBcnJheShbXSwgaW5pdCwgdHJ1ZSksIFtlbmRdLCBmYWxzZSk7XG4gICAgfTtcbn07XG4vKipcbiAqIEBpbnRlcm5hbFxuICovXG5leHBvcnQgdmFyIGFwcGVuZCA9IGFwcGVuZFc7XG4vKipcbiAqIEBpbnRlcm5hbFxuICovXG5leHBvcnQgdmFyIHVuc2FmZUluc2VydEF0ID0gZnVuY3Rpb24gKGksIGEsIGFzKSB7XG4gICAgaWYgKGlzTm9uRW1wdHkoYXMpKSB7XG4gICAgICAgIHZhciB4cyA9IF8uZnJvbVJlYWRvbmx5Tm9uRW1wdHlBcnJheShhcyk7XG4gICAgICAgIHhzLnNwbGljZShpLCAwLCBhKTtcbiAgICAgICAgcmV0dXJuIHhzO1xuICAgIH1cbiAgICByZXR1cm4gW2FdO1xufTtcbi8qKlxuICogQGludGVybmFsXG4gKi9cbmV4cG9ydCB2YXIgdW5zYWZlVXBkYXRlQXQgPSBmdW5jdGlvbiAoaSwgYSwgYXMpIHtcbiAgICBpZiAoYXNbaV0gPT09IGEpIHtcbiAgICAgICAgcmV0dXJuIGFzO1xuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgICAgdmFyIHhzID0gXy5mcm9tUmVhZG9ubHlOb25FbXB0eUFycmF5KGFzKTtcbiAgICAgICAgeHNbaV0gPSBhO1xuICAgICAgICByZXR1cm4geHM7XG4gICAgfVxufTtcbi8qKlxuICogUmVtb3ZlIGR1cGxpY2F0ZXMgZnJvbSBhIGBSZWFkb25seU5vbkVtcHR5QXJyYXlgLCBrZWVwaW5nIHRoZSBmaXJzdCBvY2N1cnJlbmNlIG9mIGFuIGVsZW1lbnQuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IHVuaXEgfSBmcm9tICdmcC10cy9SZWFkb25seU5vbkVtcHR5QXJyYXknXG4gKiBpbXBvcnQgKiBhcyBOIGZyb20gJ2ZwLXRzL251bWJlcidcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKHVuaXEoTi5FcSkoWzEsIDIsIDFdKSwgWzEsIDJdKVxuICpcbiAqIEBzaW5jZSAyLjExLjBcbiAqL1xuZXhwb3J0IHZhciB1bmlxID0gZnVuY3Rpb24gKEUpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIGlmIChhcy5sZW5ndGggPT09IDEpIHtcbiAgICAgICAgICAgIHJldHVybiBhcztcbiAgICAgICAgfVxuICAgICAgICB2YXIgb3V0ID0gW2hlYWQoYXMpXTtcbiAgICAgICAgdmFyIHJlc3QgPSB0YWlsKGFzKTtcbiAgICAgICAgdmFyIF9sb29wXzEgPSBmdW5jdGlvbiAoYSkge1xuICAgICAgICAgICAgaWYgKG91dC5ldmVyeShmdW5jdGlvbiAobykgeyByZXR1cm4gIUUuZXF1YWxzKG8sIGEpOyB9KSkge1xuICAgICAgICAgICAgICAgIG91dC5wdXNoKGEpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICBmb3IgKHZhciBfaSA9IDAsIHJlc3RfMSA9IHJlc3Q7IF9pIDwgcmVzdF8xLmxlbmd0aDsgX2krKykge1xuICAgICAgICAgICAgdmFyIGEgPSByZXN0XzFbX2ldO1xuICAgICAgICAgICAgX2xvb3BfMShhKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gb3V0O1xuICAgIH07XG59O1xuLyoqXG4gKiBTb3J0IHRoZSBlbGVtZW50cyBvZiBhIGBSZWFkb25seU5vbkVtcHR5QXJyYXlgIGluIGluY3JlYXNpbmcgb3JkZXIsIHdoZXJlIGVsZW1lbnRzIGFyZSBjb21wYXJlZCB1c2luZyBmaXJzdCBgb3Jkc1swXWAsIHRoZW4gYG9yZHNbMV1gLFxuICogZXRjLi4uXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCAqIGFzIFJORUEgZnJvbSAnZnAtdHMvUmVhZG9ubHlOb25FbXB0eUFycmF5J1xuICogaW1wb3J0IHsgY29udHJhbWFwIH0gZnJvbSAnZnAtdHMvT3JkJ1xuICogaW1wb3J0ICogYXMgUyBmcm9tICdmcC10cy9zdHJpbmcnXG4gKiBpbXBvcnQgKiBhcyBOIGZyb20gJ2ZwLXRzL251bWJlcidcbiAqIGltcG9ydCB7IHBpcGUgfSBmcm9tICdmcC10cy9mdW5jdGlvbidcbiAqXG4gKiBpbnRlcmZhY2UgUGVyc29uIHtcbiAqICAgbmFtZTogc3RyaW5nXG4gKiAgIGFnZTogbnVtYmVyXG4gKiB9XG4gKlxuICogY29uc3QgYnlOYW1lID0gcGlwZShTLk9yZCwgY29udHJhbWFwKChwOiBQZXJzb24pID0+IHAubmFtZSkpXG4gKlxuICogY29uc3QgYnlBZ2UgPSBwaXBlKE4uT3JkLCBjb250cmFtYXAoKHA6IFBlcnNvbikgPT4gcC5hZ2UpKVxuICpcbiAqIGNvbnN0IHNvcnRCeU5hbWVCeUFnZSA9IFJORUEuc29ydEJ5KFtieU5hbWUsIGJ5QWdlXSlcbiAqXG4gKiBjb25zdCBwZXJzb25zOiBSTkVBLlJlYWRvbmx5Tm9uRW1wdHlBcnJheTxQZXJzb24+ID0gW1xuICogICB7IG5hbWU6ICdhJywgYWdlOiAxIH0sXG4gKiAgIHsgbmFtZTogJ2InLCBhZ2U6IDMgfSxcbiAqICAgeyBuYW1lOiAnYycsIGFnZTogMiB9LFxuICogICB7IG5hbWU6ICdiJywgYWdlOiAyIH1cbiAqIF1cbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKHNvcnRCeU5hbWVCeUFnZShwZXJzb25zKSwgW1xuICogICB7IG5hbWU6ICdhJywgYWdlOiAxIH0sXG4gKiAgIHsgbmFtZTogJ2InLCBhZ2U6IDIgfSxcbiAqICAgeyBuYW1lOiAnYicsIGFnZTogMyB9LFxuICogICB7IG5hbWU6ICdjJywgYWdlOiAyIH1cbiAqIF0pXG4gKlxuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIHNvcnRCeSA9IGZ1bmN0aW9uIChvcmRzKSB7XG4gICAgaWYgKGlzTm9uRW1wdHkob3JkcykpIHtcbiAgICAgICAgdmFyIE0gPSBnZXRNb25vaWQoKTtcbiAgICAgICAgcmV0dXJuIHNvcnQob3Jkcy5yZWR1Y2UoTS5jb25jYXQsIE0uZW1wdHkpKTtcbiAgICB9XG4gICAgcmV0dXJuIGlkZW50aXR5O1xufTtcbi8qKlxuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIHVuaW9uID0gZnVuY3Rpb24gKEUpIHtcbiAgICB2YXIgdW5pcUUgPSB1bmlxKEUpO1xuICAgIHJldHVybiBmdW5jdGlvbiAoc2Vjb25kKSB7IHJldHVybiBmdW5jdGlvbiAoZmlyc3QpIHsgcmV0dXJuIHVuaXFFKHBpcGUoZmlyc3QsIGNvbmNhdChzZWNvbmQpKSk7IH07IH07XG59O1xuLyoqXG4gKiBSb3RhdGUgYSBgUmVhZG9ubHlOb25FbXB0eUFycmF5YCBieSBgbmAgc3RlcHMuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IHJvdGF0ZSB9IGZyb20gJ2ZwLXRzL1JlYWRvbmx5Tm9uRW1wdHlBcnJheSdcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKHJvdGF0ZSgyKShbMSwgMiwgMywgNCwgNV0pLCBbNCwgNSwgMSwgMiwgM10pXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKHJvdGF0ZSgtMikoWzEsIDIsIDMsIDQsIDVdKSwgWzMsIDQsIDUsIDEsIDJdKVxuICpcbiAqIEBzaW5jZSAyLjExLjBcbiAqL1xuZXhwb3J0IHZhciByb3RhdGUgPSBmdW5jdGlvbiAobikge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgdmFyIGxlbiA9IGFzLmxlbmd0aDtcbiAgICAgICAgdmFyIG0gPSBNYXRoLnJvdW5kKG4pICUgbGVuO1xuICAgICAgICBpZiAoaXNPdXRPZkJvdW5kKE1hdGguYWJzKG0pLCBhcykgfHwgbSA9PT0gMCkge1xuICAgICAgICAgICAgcmV0dXJuIGFzO1xuICAgICAgICB9XG4gICAgICAgIGlmIChtIDwgMCkge1xuICAgICAgICAgICAgdmFyIF9hID0gc3BsaXRBdCgtbSkoYXMpLCBmID0gX2FbMF0sIHMgPSBfYVsxXTtcbiAgICAgICAgICAgIHJldHVybiBwaXBlKHMsIGNvbmNhdChmKSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gcm90YXRlKG0gLSBsZW4pKGFzKTtcbiAgICAgICAgfVxuICAgIH07XG59O1xuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLy8gY29uc3RydWN0b3JzXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vKipcbiAqIFJldHVybiBhIGBSZWFkb25seU5vbkVtcHR5QXJyYXlgIGZyb20gYSBgUmVhZG9ubHlBcnJheWAgcmV0dXJuaW5nIGBub25lYCBpZiB0aGUgaW5wdXQgaXMgZW1wdHkuXG4gKlxuICogQGNhdGVnb3J5IGNvbnZlcnNpb25zXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBmcm9tUmVhZG9ubHlBcnJheSA9IGZ1bmN0aW9uIChhcykge1xuICAgIHJldHVybiBpc05vbkVtcHR5KGFzKSA/IF8uc29tZShhcykgOiBfLm5vbmU7XG59O1xuLyoqXG4gKiBSZXR1cm4gYSBgUmVhZG9ubHlOb25FbXB0eUFycmF5YCBvZiBsZW5ndGggYG5gIHdpdGggZWxlbWVudCBgaWAgaW5pdGlhbGl6ZWQgd2l0aCBgZihpKWAuXG4gKlxuICogKipOb3RlKiouIGBuYCBpcyBub3JtYWxpemVkIHRvIGEgbmF0dXJhbCBudW1iZXIuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IG1ha2VCeSB9IGZyb20gJ2ZwLXRzL1JlYWRvbmx5Tm9uRW1wdHlBcnJheSdcbiAqIGltcG9ydCB7IHBpcGUgfSBmcm9tICdmcC10cy9mdW5jdGlvbidcbiAqXG4gKiBjb25zdCBkb3VibGUgPSAobjogbnVtYmVyKTogbnVtYmVyID0+IG4gKiAyXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKHBpcGUoNSwgbWFrZUJ5KGRvdWJsZSkpLCBbMCwgMiwgNCwgNiwgOF0pXG4gKlxuICogQGNhdGVnb3J5IGNvbnN0cnVjdG9yc1xuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIG1ha2VCeSA9IGZ1bmN0aW9uIChmKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChuKSB7XG4gICAgICAgIHZhciBqID0gTWF0aC5tYXgoMCwgTWF0aC5mbG9vcihuKSk7XG4gICAgICAgIHZhciBvdXQgPSBbZigwKV07XG4gICAgICAgIGZvciAodmFyIGkgPSAxOyBpIDwgajsgaSsrKSB7XG4gICAgICAgICAgICBvdXQucHVzaChmKGkpKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gb3V0O1xuICAgIH07XG59O1xuLyoqXG4gKiBDcmVhdGUgYSBgUmVhZG9ubHlOb25FbXB0eUFycmF5YCBjb250YWluaW5nIGEgdmFsdWUgcmVwZWF0ZWQgdGhlIHNwZWNpZmllZCBudW1iZXIgb2YgdGltZXMuXG4gKlxuICogKipOb3RlKiouIGBuYCBpcyBub3JtYWxpemVkIHRvIGEgbmF0dXJhbCBudW1iZXIuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IHJlcGxpY2F0ZSB9IGZyb20gJ2ZwLXRzL1JlYWRvbmx5Tm9uRW1wdHlBcnJheSdcbiAqIGltcG9ydCB7IHBpcGUgfSBmcm9tICdmcC10cy9mdW5jdGlvbidcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKHBpcGUoMywgcmVwbGljYXRlKCdhJykpLCBbJ2EnLCAnYScsICdhJ10pXG4gKlxuICogQGNhdGVnb3J5IGNvbnN0cnVjdG9yc1xuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIHJlcGxpY2F0ZSA9IGZ1bmN0aW9uIChhKSB7IHJldHVybiBtYWtlQnkoZnVuY3Rpb24gKCkgeyByZXR1cm4gYTsgfSk7IH07XG4vKipcbiAqIENyZWF0ZSBhIGBSZWFkb25seU5vbkVtcHR5QXJyYXlgIGNvbnRhaW5pbmcgYSByYW5nZSBvZiBpbnRlZ2VycywgaW5jbHVkaW5nIGJvdGggZW5kcG9pbnRzLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyByYW5nZSB9IGZyb20gJ2ZwLXRzL1JlYWRvbmx5Tm9uRW1wdHlBcnJheSdcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKHJhbmdlKDEsIDUpLCBbMSwgMiwgMywgNCwgNV0pXG4gKlxuICogQGNhdGVnb3J5IGNvbnN0cnVjdG9yc1xuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIHJhbmdlID0gZnVuY3Rpb24gKHN0YXJ0LCBlbmQpIHtcbiAgICByZXR1cm4gc3RhcnQgPD0gZW5kID8gbWFrZUJ5KGZ1bmN0aW9uIChpKSB7IHJldHVybiBzdGFydCArIGk7IH0pKGVuZCAtIHN0YXJ0ICsgMSkgOiBbc3RhcnRdO1xufTtcbi8qKlxuICogUmV0dXJuIHRoZSB0dXBsZSBvZiB0aGUgYGhlYWRgIGFuZCB0aGUgYHRhaWxgLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyB1bnByZXBlbmQgfSBmcm9tICdmcC10cy9SZWFkb25seU5vbkVtcHR5QXJyYXknXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbCh1bnByZXBlbmQoWzEsIDIsIDMsIDRdKSwgWzEsIFsyLCAzLCA0XV0pXG4gKlxuICogQHNpbmNlIDIuOS4wXG4gKi9cbmV4cG9ydCB2YXIgdW5wcmVwZW5kID0gZnVuY3Rpb24gKGFzKSB7IHJldHVybiBbaGVhZChhcyksIHRhaWwoYXMpXTsgfTtcbi8qKlxuICogUmV0dXJuIHRoZSB0dXBsZSBvZiB0aGUgYGluaXRgIGFuZCB0aGUgYGxhc3RgLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyB1bmFwcGVuZCB9IGZyb20gJ2ZwLXRzL1JlYWRvbmx5Tm9uRW1wdHlBcnJheSdcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKHVuYXBwZW5kKFsxLCAyLCAzLCA0XSksIFtbMSwgMiwgM10sIDRdKVxuICpcbiAqIEBzaW5jZSAyLjkuMFxuICovXG5leHBvcnQgdmFyIHVuYXBwZW5kID0gZnVuY3Rpb24gKGFzKSB7IHJldHVybiBbaW5pdChhcyksIGxhc3QoYXMpXTsgfTtcbi8qKlxuICogQGNhdGVnb3J5IGNvbnZlcnNpb25zXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBmcm9tQXJyYXkgPSBmdW5jdGlvbiAoYXMpIHsgcmV0dXJuIGZyb21SZWFkb25seUFycmF5KGFzLnNsaWNlKCkpOyB9O1xuZXhwb3J0IGZ1bmN0aW9uIGNvbmNhdFcoc2Vjb25kKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChmaXJzdCkgeyByZXR1cm4gZmlyc3QuY29uY2F0KHNlY29uZCk7IH07XG59XG5leHBvcnQgZnVuY3Rpb24gY29uY2F0KHgsIHkpIHtcbiAgICByZXR1cm4geSA/IHguY29uY2F0KHkpIDogZnVuY3Rpb24gKHkpIHsgcmV0dXJuIHkuY29uY2F0KHgpOyB9O1xufVxuLyoqXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciByZXZlcnNlID0gZnVuY3Rpb24gKGFzKSB7XG4gICAgcmV0dXJuIGFzLmxlbmd0aCA9PT0gMSA/IGFzIDogX19zcHJlYWRBcnJheShbbGFzdChhcyldLCBhcy5zbGljZSgwLCAtMSkucmV2ZXJzZSgpLCB0cnVlKTtcbn07XG5leHBvcnQgZnVuY3Rpb24gZ3JvdXAoRSkge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgdmFyIGxlbiA9IGFzLmxlbmd0aDtcbiAgICAgICAgaWYgKGxlbiA9PT0gMCkge1xuICAgICAgICAgICAgcmV0dXJuIGVtcHR5O1xuICAgICAgICB9XG4gICAgICAgIHZhciBvdXQgPSBbXTtcbiAgICAgICAgdmFyIGhlYWQgPSBhc1swXTtcbiAgICAgICAgdmFyIG5lYSA9IFtoZWFkXTtcbiAgICAgICAgZm9yICh2YXIgaSA9IDE7IGkgPCBsZW47IGkrKykge1xuICAgICAgICAgICAgdmFyIGEgPSBhc1tpXTtcbiAgICAgICAgICAgIGlmIChFLmVxdWFscyhhLCBoZWFkKSkge1xuICAgICAgICAgICAgICAgIG5lYS5wdXNoKGEpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgb3V0LnB1c2gobmVhKTtcbiAgICAgICAgICAgICAgICBoZWFkID0gYTtcbiAgICAgICAgICAgICAgICBuZWEgPSBbaGVhZF07XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgb3V0LnB1c2gobmVhKTtcbiAgICAgICAgcmV0dXJuIG91dDtcbiAgICB9O1xufVxuLyoqXG4gKiBTcGxpdHMgYW4gYXJyYXkgaW50byBzdWItbm9uLWVtcHR5LWFycmF5cyBzdG9yZWQgaW4gYW4gb2JqZWN0LCBiYXNlZCBvbiB0aGUgcmVzdWx0IG9mIGNhbGxpbmcgYSBgc3RyaW5nYC1yZXR1cm5pbmdcbiAqIGZ1bmN0aW9uIG9uIGVhY2ggZWxlbWVudCwgYW5kIGdyb3VwaW5nIHRoZSByZXN1bHRzIGFjY29yZGluZyB0byB2YWx1ZXMgcmV0dXJuZWRcbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgZ3JvdXBCeSB9IGZyb20gJ2ZwLXRzL1JlYWRvbmx5Tm9uRW1wdHlBcnJheSdcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKGdyb3VwQnkoKHM6IHN0cmluZykgPT4gU3RyaW5nKHMubGVuZ3RoKSkoWydhJywgJ2InLCAnYWInXSksIHtcbiAqICAgJzEnOiBbJ2EnLCAnYiddLFxuICogICAnMic6IFsnYWInXVxuICogfSlcbiAqXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBncm91cEJ5ID0gZnVuY3Rpb24gKGYpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIHZhciBvdXQgPSB7fTtcbiAgICAgICAgZm9yICh2YXIgX2kgPSAwLCBhc18xID0gYXM7IF9pIDwgYXNfMS5sZW5ndGg7IF9pKyspIHtcbiAgICAgICAgICAgIHZhciBhID0gYXNfMVtfaV07XG4gICAgICAgICAgICB2YXIgayA9IGYoYSk7XG4gICAgICAgICAgICBpZiAoXy5oYXMuY2FsbChvdXQsIGspKSB7XG4gICAgICAgICAgICAgICAgb3V0W2tdLnB1c2goYSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBvdXRba10gPSBbYV07XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG91dDtcbiAgICB9O1xufTtcbi8qKlxuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgc29ydCA9IGZ1bmN0aW9uIChPKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykge1xuICAgICAgICByZXR1cm4gYXMubGVuZ3RoID09PSAxID8gYXMgOiBhcy5zbGljZSgpLnNvcnQoTy5jb21wYXJlKTtcbiAgICB9O1xufTtcbi8qKlxuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgdXBkYXRlQXQgPSBmdW5jdGlvbiAoaSwgYSkge1xuICAgIHJldHVybiBtb2RpZnlBdChpLCBmdW5jdGlvbiAoKSB7IHJldHVybiBhOyB9KTtcbn07XG4vKipcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIG1vZGlmeUF0ID0gZnVuY3Rpb24gKGksIGYpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIHJldHVybiBpc091dE9mQm91bmQoaSwgYXMpID8gXy5ub25lIDogXy5zb21lKHVuc2FmZVVwZGF0ZUF0KGksIGYoYXNbaV0pLCBhcykpO1xuICAgIH07XG59O1xuLyoqXG4gKiBAc2luY2UgMi41LjFcbiAqL1xuZXhwb3J0IHZhciB6aXBXaXRoID0gZnVuY3Rpb24gKGFzLCBicywgZikge1xuICAgIHZhciBjcyA9IFtmKGFzWzBdLCBic1swXSldO1xuICAgIHZhciBsZW4gPSBNYXRoLm1pbihhcy5sZW5ndGgsIGJzLmxlbmd0aCk7XG4gICAgZm9yICh2YXIgaSA9IDE7IGkgPCBsZW47IGkrKykge1xuICAgICAgICBjc1tpXSA9IGYoYXNbaV0sIGJzW2ldKTtcbiAgICB9XG4gICAgcmV0dXJuIGNzO1xufTtcbmV4cG9ydCBmdW5jdGlvbiB6aXAoYXMsIGJzKSB7XG4gICAgaWYgKGJzID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIChicykgeyByZXR1cm4gemlwKGJzLCBhcyk7IH07XG4gICAgfVxuICAgIHJldHVybiB6aXBXaXRoKGFzLCBicywgZnVuY3Rpb24gKGEsIGIpIHsgcmV0dXJuIFthLCBiXTsgfSk7XG59XG4vKipcbiAqIEBzaW5jZSAyLjUuMVxuICovXG5leHBvcnQgdmFyIHVuemlwID0gZnVuY3Rpb24gKGFicykge1xuICAgIHZhciBmYSA9IFthYnNbMF1bMF1dO1xuICAgIHZhciBmYiA9IFthYnNbMF1bMV1dO1xuICAgIGZvciAodmFyIGkgPSAxOyBpIDwgYWJzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIGZhW2ldID0gYWJzW2ldWzBdO1xuICAgICAgICBmYltpXSA9IGFic1tpXVsxXTtcbiAgICB9XG4gICAgcmV0dXJuIFtmYSwgZmJdO1xufTtcbi8qKlxuICogUHJlcGVuZCBhbiBlbGVtZW50IHRvIGV2ZXJ5IG1lbWJlciBvZiBhIGBSZWFkb25seU5vbkVtcHR5QXJyYXlgLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBwcmVwZW5kQWxsIH0gZnJvbSAnZnAtdHMvUmVhZG9ubHlOb25FbXB0eUFycmF5J1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwocHJlcGVuZEFsbCg5KShbMSwgMiwgMywgNF0pLCBbOSwgMSwgOSwgMiwgOSwgMywgOSwgNF0pXG4gKlxuICogQHNpbmNlIDIuMTAuMFxuICovXG5leHBvcnQgdmFyIHByZXBlbmRBbGwgPSBmdW5jdGlvbiAobWlkZGxlKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykge1xuICAgICAgICB2YXIgb3V0ID0gW21pZGRsZSwgYXNbMF1dO1xuICAgICAgICBmb3IgKHZhciBpID0gMTsgaSA8IGFzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICBvdXQucHVzaChtaWRkbGUsIGFzW2ldKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gb3V0O1xuICAgIH07XG59O1xuLyoqXG4gKiBQbGFjZXMgYW4gZWxlbWVudCBpbiBiZXR3ZWVuIG1lbWJlcnMgb2YgYSBgUmVhZG9ubHlOb25FbXB0eUFycmF5YC5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgaW50ZXJzcGVyc2UgfSBmcm9tICdmcC10cy9SZWFkb25seU5vbkVtcHR5QXJyYXknXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChpbnRlcnNwZXJzZSg5KShbMSwgMiwgMywgNF0pLCBbMSwgOSwgMiwgOSwgMywgOSwgNF0pXG4gKlxuICogQHNpbmNlIDIuOS4wXG4gKi9cbmV4cG9ydCB2YXIgaW50ZXJzcGVyc2UgPSBmdW5jdGlvbiAobWlkZGxlKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykge1xuICAgICAgICB2YXIgcmVzdCA9IHRhaWwoYXMpO1xuICAgICAgICByZXR1cm4gaXNOb25FbXB0eShyZXN0KSA/IHBpcGUocmVzdCwgcHJlcGVuZEFsbChtaWRkbGUpLCBwcmVwZW5kKGhlYWQoYXMpKSkgOiBhcztcbiAgICB9O1xufTtcbi8qKlxuICogQGNhdGVnb3J5IHNlcXVlbmNpbmdcbiAqIEBzaW5jZSAyLjEwLjBcbiAqL1xuZXhwb3J0IHZhciBjaGFpbldpdGhJbmRleCA9IGZ1bmN0aW9uIChmKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykge1xuICAgICAgICB2YXIgb3V0ID0gXy5mcm9tUmVhZG9ubHlOb25FbXB0eUFycmF5KGYoMCwgaGVhZChhcykpKTtcbiAgICAgICAgZm9yICh2YXIgaSA9IDE7IGkgPCBhcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgb3V0LnB1c2guYXBwbHkob3V0LCBmKGksIGFzW2ldKSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG91dDtcbiAgICB9O1xufTtcbi8qKlxuICogQSB1c2VmdWwgcmVjdXJzaW9uIHBhdHRlcm4gZm9yIHByb2Nlc3NpbmcgYSBgUmVhZG9ubHlOb25FbXB0eUFycmF5YCB0byBwcm9kdWNlIGEgbmV3IGBSZWFkb25seU5vbkVtcHR5QXJyYXlgLCBvZnRlbiB1c2VkIGZvciBcImNob3BwaW5nXCIgdXAgdGhlIGlucHV0XG4gKiBgUmVhZG9ubHlOb25FbXB0eUFycmF5YC4gVHlwaWNhbGx5IGBjaG9wYCBpcyBjYWxsZWQgd2l0aCBzb21lIGZ1bmN0aW9uIHRoYXQgd2lsbCBjb25zdW1lIGFuIGluaXRpYWwgcHJlZml4IG9mIHRoZSBgUmVhZG9ubHlOb25FbXB0eUFycmF5YCBhbmQgcHJvZHVjZSBhXG4gKiB2YWx1ZSBhbmQgdGhlIHRhaWwgb2YgdGhlIGBSZWFkb25seU5vbkVtcHR5QXJyYXlgLlxuICpcbiAqIEBzaW5jZSAyLjEwLjBcbiAqL1xuZXhwb3J0IHZhciBjaG9wID0gZnVuY3Rpb24gKGYpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIHZhciBfYSA9IGYoYXMpLCBiID0gX2FbMF0sIHJlc3QgPSBfYVsxXTtcbiAgICAgICAgdmFyIG91dCA9IFtiXTtcbiAgICAgICAgdmFyIG5leHQgPSByZXN0O1xuICAgICAgICB3aGlsZSAoaXNOb25FbXB0eShuZXh0KSkge1xuICAgICAgICAgICAgdmFyIF9iID0gZihuZXh0KSwgYl8xID0gX2JbMF0sIHJlc3RfMiA9IF9iWzFdO1xuICAgICAgICAgICAgb3V0LnB1c2goYl8xKTtcbiAgICAgICAgICAgIG5leHQgPSByZXN0XzI7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG91dDtcbiAgICB9O1xufTtcbi8qKlxuICogU3BsaXRzIGEgYFJlYWRvbmx5Tm9uRW1wdHlBcnJheWAgaW50byB0d28gcGllY2VzLCB0aGUgZmlyc3QgcGllY2UgaGFzIG1heCBgbmAgZWxlbWVudHMuXG4gKlxuICogQHNpbmNlIDIuMTAuMFxuICovXG5leHBvcnQgdmFyIHNwbGl0QXQgPSBmdW5jdGlvbiAobikge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgdmFyIG0gPSBNYXRoLm1heCgxLCBuKTtcbiAgICAgICAgcmV0dXJuIG0gPj0gYXMubGVuZ3RoID8gW2FzLCBlbXB0eV0gOiBbcGlwZShhcy5zbGljZSgxLCBtKSwgcHJlcGVuZChoZWFkKGFzKSkpLCBhcy5zbGljZShtKV07XG4gICAgfTtcbn07XG4vKipcbiAqIFNwbGl0cyBhIGBSZWFkb25seU5vbkVtcHR5QXJyYXlgIGludG8gbGVuZ3RoLWBuYCBwaWVjZXMuIFRoZSBsYXN0IHBpZWNlIHdpbGwgYmUgc2hvcnRlciBpZiBgbmAgZG9lcyBub3QgZXZlbmx5IGRpdmlkZSB0aGUgbGVuZ3RoIG9mXG4gKiB0aGUgYFJlYWRvbmx5Tm9uRW1wdHlBcnJheWAuXG4gKlxuICogQHNpbmNlIDIuMTAuMFxuICovXG5leHBvcnQgdmFyIGNodW5rc09mID0gZnVuY3Rpb24gKG4pIHsgcmV0dXJuIGNob3Aoc3BsaXRBdChuKSk7IH07XG52YXIgX21hcCA9IGZ1bmN0aW9uIChmYSwgZikgeyByZXR1cm4gcGlwZShmYSwgbWFwKGYpKTsgfTtcbi8qIGlzdGFuYnVsIGlnbm9yZSBuZXh0ICovXG52YXIgX21hcFdpdGhJbmRleCA9IGZ1bmN0aW9uIChmYSwgZikgeyByZXR1cm4gcGlwZShmYSwgbWFwV2l0aEluZGV4KGYpKTsgfTtcbnZhciBfYXAgPSBmdW5jdGlvbiAoZmFiLCBmYSkgeyByZXR1cm4gcGlwZShmYWIsIGFwKGZhKSk7IH07XG4vKiBpc3RhbmJ1bCBpZ25vcmUgbmV4dCAqL1xudmFyIF9leHRlbmQgPSBmdW5jdGlvbiAod2EsIGYpIHsgcmV0dXJuIHBpcGUod2EsIGV4dGVuZChmKSk7IH07XG4vKiBpc3RhbmJ1bCBpZ25vcmUgbmV4dCAqL1xudmFyIF9yZWR1Y2UgPSBmdW5jdGlvbiAoZmEsIGIsIGYpIHsgcmV0dXJuIHBpcGUoZmEsIHJlZHVjZShiLCBmKSk7IH07XG4vKiBpc3RhbmJ1bCBpZ25vcmUgbmV4dCAqL1xudmFyIF9mb2xkTWFwID0gZnVuY3Rpb24gKE0pIHtcbiAgICB2YXIgZm9sZE1hcE0gPSBmb2xkTWFwKE0pO1xuICAgIHJldHVybiBmdW5jdGlvbiAoZmEsIGYpIHsgcmV0dXJuIHBpcGUoZmEsIGZvbGRNYXBNKGYpKTsgfTtcbn07XG4vKiBpc3RhbmJ1bCBpZ25vcmUgbmV4dCAqL1xudmFyIF9yZWR1Y2VSaWdodCA9IGZ1bmN0aW9uIChmYSwgYiwgZikgeyByZXR1cm4gcGlwZShmYSwgcmVkdWNlUmlnaHQoYiwgZikpOyB9O1xuLyogaXN0YW5idWwgaWdub3JlIG5leHQgKi9cbnZhciBfdHJhdmVyc2UgPSBmdW5jdGlvbiAoRikge1xuICAgIHZhciB0cmF2ZXJzZUYgPSB0cmF2ZXJzZShGKTtcbiAgICByZXR1cm4gZnVuY3Rpb24gKHRhLCBmKSB7IHJldHVybiBwaXBlKHRhLCB0cmF2ZXJzZUYoZikpOyB9O1xufTtcbi8qIGlzdGFuYnVsIGlnbm9yZSBuZXh0ICovXG52YXIgX2FsdCA9IGZ1bmN0aW9uIChmYSwgdGhhdCkgeyByZXR1cm4gcGlwZShmYSwgYWx0KHRoYXQpKTsgfTtcbi8qIGlzdGFuYnVsIGlnbm9yZSBuZXh0ICovXG52YXIgX3JlZHVjZVdpdGhJbmRleCA9IGZ1bmN0aW9uIChmYSwgYiwgZikge1xuICAgIHJldHVybiBwaXBlKGZhLCByZWR1Y2VXaXRoSW5kZXgoYiwgZikpO1xufTtcbi8qIGlzdGFuYnVsIGlnbm9yZSBuZXh0ICovXG52YXIgX2ZvbGRNYXBXaXRoSW5kZXggPSBmdW5jdGlvbiAoTSkge1xuICAgIHZhciBmb2xkTWFwV2l0aEluZGV4TSA9IGZvbGRNYXBXaXRoSW5kZXgoTSk7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChmYSwgZikgeyByZXR1cm4gcGlwZShmYSwgZm9sZE1hcFdpdGhJbmRleE0oZikpOyB9O1xufTtcbi8qIGlzdGFuYnVsIGlnbm9yZSBuZXh0ICovXG52YXIgX3JlZHVjZVJpZ2h0V2l0aEluZGV4ID0gZnVuY3Rpb24gKGZhLCBiLCBmKSB7XG4gICAgcmV0dXJuIHBpcGUoZmEsIHJlZHVjZVJpZ2h0V2l0aEluZGV4KGIsIGYpKTtcbn07XG4vKiBpc3RhbmJ1bCBpZ25vcmUgbmV4dCAqL1xudmFyIF90cmF2ZXJzZVdpdGhJbmRleCA9IGZ1bmN0aW9uIChGKSB7XG4gICAgdmFyIHRyYXZlcnNlV2l0aEluZGV4RiA9IHRyYXZlcnNlV2l0aEluZGV4KEYpO1xuICAgIHJldHVybiBmdW5jdGlvbiAodGEsIGYpIHsgcmV0dXJuIHBpcGUodGEsIHRyYXZlcnNlV2l0aEluZGV4RihmKSk7IH07XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgY29uc3RydWN0b3JzXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBvZiA9IF8uc2luZ2xldG9uO1xuLyoqXG4gKiBMZXNzIHN0cmljdCB2ZXJzaW9uIG9mIFtgYWx0YF0oI2FsdCkuXG4gKlxuICogVGhlIGBXYCBzdWZmaXggKHNob3J0IGZvciAqKlcqKmlkZW5pbmcpIG1lYW5zIHRoYXQgdGhlIHJldHVybiB0eXBlcyB3aWxsIGJlIG1lcmdlZC5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0ICogYXMgUk5FQSBmcm9tICdmcC10cy9SZWFkb25seU5vbkVtcHR5QXJyYXknXG4gKiBpbXBvcnQgeyBwaXBlIH0gZnJvbSAnZnAtdHMvZnVuY3Rpb24nXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChcbiAqICAgcGlwZShcbiAqICAgICBbMSwgMiwgM10gYXMgUk5FQS5SZWFkb25seU5vbkVtcHR5QXJyYXk8bnVtYmVyPixcbiAqICAgICBSTkVBLmFsdFcoKCkgPT4gWydhJywgJ2InXSlcbiAqICAgKSxcbiAqICAgWzEsIDIsIDMsICdhJywgJ2InXVxuICogKVxuICpcbiAqIEBjYXRlZ29yeSBlcnJvciBoYW5kbGluZ1xuICogQHNpbmNlIDIuOS4wXG4gKi9cbmV4cG9ydCB2YXIgYWx0VyA9IGZ1bmN0aW9uICh0aGF0KSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykge1xuICAgICAgICByZXR1cm4gcGlwZShhcywgY29uY2F0Vyh0aGF0KCkpKTtcbiAgICB9O1xufTtcbi8qKlxuICogSWRlbnRpZmllcyBhbiBhc3NvY2lhdGl2ZSBvcGVyYXRpb24gb24gYSB0eXBlIGNvbnN0cnVjdG9yLiBJdCBpcyBzaW1pbGFyIHRvIGBTZW1pZ3JvdXBgLCBleGNlcHQgdGhhdCBpdCBhcHBsaWVzIHRvXG4gKiB0eXBlcyBvZiBraW5kIGAqIC0+ICpgLlxuICpcbiAqIEluIGNhc2Ugb2YgYFJlYWRvbmx5Tm9uRW1wdHlBcnJheWAgY29uY2F0ZW5hdGVzIHRoZSBpbnB1dHMgaW50byBhIHNpbmdsZSBhcnJheS5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0ICogYXMgUk5FQSBmcm9tICdmcC10cy9SZWFkb25seU5vbkVtcHR5QXJyYXknXG4gKiBpbXBvcnQgeyBwaXBlIH0gZnJvbSAnZnAtdHMvZnVuY3Rpb24nXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChcbiAqICAgcGlwZShcbiAqICAgICBbMSwgMiwgM10sXG4gKiAgICAgUk5FQS5hbHQoKCkgPT4gWzQsIDVdKVxuICogICApLFxuICogICBbMSwgMiwgMywgNCwgNV1cbiAqIClcbiAqXG4gKiBAY2F0ZWdvcnkgZXJyb3IgaGFuZGxpbmdcbiAqIEBzaW5jZSAyLjYuMlxuICovXG5leHBvcnQgdmFyIGFsdCA9IGFsdFc7XG4vKipcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIGFwID0gZnVuY3Rpb24gKGFzKSB7IHJldHVybiBmbGF0TWFwKGZ1bmN0aW9uIChmKSB7IHJldHVybiBwaXBlKGFzLCBtYXAoZikpOyB9KTsgfTtcbi8qKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCAqIGFzIFJORUEgZnJvbSAnZnAtdHMvUmVhZG9ubHlOb25FbXB0eUFycmF5J1xuICogaW1wb3J0IHsgcGlwZSB9IGZyb20gJ2ZwLXRzL2Z1bmN0aW9uJ1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoXG4gKiAgIHBpcGUoXG4gKiAgICAgWzEsIDIsIDNdLFxuICogICAgIFJORUEuZmxhdE1hcCgobikgPT4gW2BhJHtufWAsIGBiJHtufWBdKVxuICogICApLFxuICogICBbJ2ExJywgJ2IxJywgJ2EyJywgJ2IyJywgJ2EzJywgJ2IzJ11cbiAqIClcbiAqXG4gKiBAY2F0ZWdvcnkgc2VxdWVuY2luZ1xuICogQHNpbmNlIDIuMTQuMFxuICovXG5leHBvcnQgdmFyIGZsYXRNYXAgPSAvKiNfX1BVUkVfXyovIGR1YWwoMiwgZnVuY3Rpb24gKG1hLCBmKSB7XG4gICAgcmV0dXJuIHBpcGUobWEsIGNoYWluV2l0aEluZGV4KGZ1bmN0aW9uIChpLCBhKSB7IHJldHVybiBmKGEsIGkpOyB9KSk7XG59KTtcbi8qKlxuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgZXh0ZW5kID0gZnVuY3Rpb24gKGYpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIHZhciBuZXh0ID0gdGFpbChhcyk7XG4gICAgICAgIHZhciBvdXQgPSBbZihhcyldO1xuICAgICAgICB3aGlsZSAoaXNOb25FbXB0eShuZXh0KSkge1xuICAgICAgICAgICAgb3V0LnB1c2goZihuZXh0KSk7XG4gICAgICAgICAgICBuZXh0ID0gdGFpbChuZXh0KTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gb3V0O1xuICAgIH07XG59O1xuLyoqXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBkdXBsaWNhdGUgPSBcbi8qI19fUFVSRV9fKi8gZXh0ZW5kKGlkZW50aXR5KTtcbi8qKlxuICogQGNhdGVnb3J5IHNlcXVlbmNpbmdcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIGZsYXR0ZW4gPSBcbi8qI19fUFVSRV9fKi8gZmxhdE1hcChpZGVudGl0eSk7XG4vKipcbiAqIGBtYXBgIGNhbiBiZSB1c2VkIHRvIHR1cm4gZnVuY3Rpb25zIGAoYTogQSkgPT4gQmAgaW50byBmdW5jdGlvbnMgYChmYTogRjxBPikgPT4gRjxCPmAgd2hvc2UgYXJndW1lbnQgYW5kIHJldHVybiB0eXBlc1xuICogdXNlIHRoZSB0eXBlIGNvbnN0cnVjdG9yIGBGYCB0byByZXByZXNlbnQgc29tZSBjb21wdXRhdGlvbmFsIGNvbnRleHQuXG4gKlxuICogQGNhdGVnb3J5IG1hcHBpbmdcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIG1hcCA9IGZ1bmN0aW9uIChmKSB7XG4gICAgcmV0dXJuIG1hcFdpdGhJbmRleChmdW5jdGlvbiAoXywgYSkgeyByZXR1cm4gZihhKTsgfSk7XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgbWFwcGluZ1xuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgbWFwV2l0aEluZGV4ID0gZnVuY3Rpb24gKGYpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIHZhciBvdXQgPSBbZigwLCBoZWFkKGFzKSldO1xuICAgICAgICBmb3IgKHZhciBpID0gMTsgaSA8IGFzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICBvdXQucHVzaChmKGksIGFzW2ldKSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG91dDtcbiAgICB9O1xufTtcbi8qKlxuICogQGNhdGVnb3J5IGZvbGRpbmdcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIHJlZHVjZSA9IGZ1bmN0aW9uIChiLCBmKSB7XG4gICAgcmV0dXJuIHJlZHVjZVdpdGhJbmRleChiLCBmdW5jdGlvbiAoXywgYiwgYSkgeyByZXR1cm4gZihiLCBhKTsgfSk7XG59O1xuLyoqXG4gKiAqKk5vdGUqKi4gVGhlIGNvbnN0cmFpbnQgaXMgcmVsYXhlZDogYSBgU2VtaWdyb3VwYCBpbnN0ZWFkIG9mIGEgYE1vbm9pZGAuXG4gKlxuICogQGNhdGVnb3J5IGZvbGRpbmdcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIGZvbGRNYXAgPSBmdW5jdGlvbiAoUykge1xuICAgIHJldHVybiBmdW5jdGlvbiAoZikge1xuICAgICAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgICAgICByZXR1cm4gYXMuc2xpY2UoMSkucmVkdWNlKGZ1bmN0aW9uIChzLCBhKSB7IHJldHVybiBTLmNvbmNhdChzLCBmKGEpKTsgfSwgZihhc1swXSkpO1xuICAgICAgICB9O1xuICAgIH07XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgZm9sZGluZ1xuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgcmVkdWNlUmlnaHQgPSBmdW5jdGlvbiAoYiwgZikge1xuICAgIHJldHVybiByZWR1Y2VSaWdodFdpdGhJbmRleChiLCBmdW5jdGlvbiAoXywgYiwgYSkgeyByZXR1cm4gZihiLCBhKTsgfSk7XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgZm9sZGluZ1xuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgcmVkdWNlV2l0aEluZGV4ID0gZnVuY3Rpb24gKGIsIGYpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIHJldHVybiBhcy5yZWR1Y2UoZnVuY3Rpb24gKGIsIGEsIGkpIHsgcmV0dXJuIGYoaSwgYiwgYSk7IH0sIGIpO1xuICAgIH07XG59O1xuLyoqXG4gKiAqKk5vdGUqKi4gVGhlIGNvbnN0cmFpbnQgaXMgcmVsYXhlZDogYSBgU2VtaWdyb3VwYCBpbnN0ZWFkIG9mIGEgYE1vbm9pZGAuXG4gKlxuICogQGNhdGVnb3J5IGZvbGRpbmdcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIGZvbGRNYXBXaXRoSW5kZXggPSBmdW5jdGlvbiAoUykge1xuICAgIHJldHVybiBmdW5jdGlvbiAoZikge1xuICAgICAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgICAgICByZXR1cm4gYXMuc2xpY2UoMSkucmVkdWNlKGZ1bmN0aW9uIChzLCBhLCBpKSB7IHJldHVybiBTLmNvbmNhdChzLCBmKGkgKyAxLCBhKSk7IH0sIGYoMCwgYXNbMF0pKTtcbiAgICAgICAgfTtcbiAgICB9O1xufTtcbi8qKlxuICogQGNhdGVnb3J5IGZvbGRpbmdcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIHJlZHVjZVJpZ2h0V2l0aEluZGV4ID0gZnVuY3Rpb24gKGIsIGYpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIHJldHVybiBhcy5yZWR1Y2VSaWdodChmdW5jdGlvbiAoYiwgYSwgaSkgeyByZXR1cm4gZihpLCBhLCBiKTsgfSwgYik7XG4gICAgfTtcbn07XG4vKipcbiAqIEBjYXRlZ29yeSB0cmF2ZXJzaW5nXG4gKiBAc2luY2UgMi42LjNcbiAqL1xuZXhwb3J0IHZhciB0cmF2ZXJzZSA9IGZ1bmN0aW9uIChGKSB7XG4gICAgdmFyIHRyYXZlcnNlV2l0aEluZGV4RiA9IHRyYXZlcnNlV2l0aEluZGV4KEYpO1xuICAgIHJldHVybiBmdW5jdGlvbiAoZikgeyByZXR1cm4gdHJhdmVyc2VXaXRoSW5kZXhGKGZ1bmN0aW9uIChfLCBhKSB7IHJldHVybiBmKGEpOyB9KTsgfTtcbn07XG4vKipcbiAqIEBjYXRlZ29yeSB0cmF2ZXJzaW5nXG4gKiBAc2luY2UgMi42LjNcbiAqL1xuZXhwb3J0IHZhciBzZXF1ZW5jZSA9IGZ1bmN0aW9uIChGKSB7IHJldHVybiB0cmF2ZXJzZVdpdGhJbmRleChGKShTSyk7IH07XG4vKipcbiAqIEBjYXRlZ29yeSBzZXF1ZW5jaW5nXG4gKiBAc2luY2UgMi42LjNcbiAqL1xuZXhwb3J0IHZhciB0cmF2ZXJzZVdpdGhJbmRleCA9IGZ1bmN0aW9uIChGKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChmKSB7XG4gICAgICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgICAgIHZhciBvdXQgPSBGLm1hcChmKDAsIGhlYWQoYXMpKSwgb2YpO1xuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDE7IGkgPCBhcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgIG91dCA9IEYuYXAoRi5tYXAob3V0LCBmdW5jdGlvbiAoYnMpIHsgcmV0dXJuIGZ1bmN0aW9uIChiKSB7IHJldHVybiBwaXBlKGJzLCBhcHBlbmQoYikpOyB9OyB9KSwgZihpLCBhc1tpXSkpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIG91dDtcbiAgICAgICAgfTtcbiAgICB9O1xufTtcbi8qKlxuICogQGNhdGVnb3J5IENvbW9uYWRcbiAqIEBzaW5jZSAyLjYuM1xuICovXG5leHBvcnQgdmFyIGV4dHJhY3QgPSBfLmhlYWQ7XG4vKipcbiAqIEBjYXRlZ29yeSB0eXBlIGxhbWJkYXNcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIFVSSSA9ICdSZWFkb25seU5vbkVtcHR5QXJyYXknO1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBnZXRTaG93ID0gZnVuY3Rpb24gKFMpIHsgcmV0dXJuICh7XG4gICAgc2hvdzogZnVuY3Rpb24gKGFzKSB7IHJldHVybiBcIltcIi5jb25jYXQoYXMubWFwKFMuc2hvdykuam9pbignLCAnKSwgXCJdXCIpOyB9XG59KTsgfTtcbi8qKlxuICogQnVpbGRzIGEgYFNlbWlncm91cGAgaW5zdGFuY2UgZm9yIGBSZWFkb25seU5vbkVtcHR5QXJyYXlgXG4gKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgZ2V0U2VtaWdyb3VwID0gZnVuY3Rpb24gKCkgeyByZXR1cm4gKHtcbiAgICBjb25jYXQ6IGNvbmNhdFxufSk7IH07XG4vKipcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBnZXRFcSB9IGZyb20gJ2ZwLXRzL1JlYWRvbmx5Tm9uRW1wdHlBcnJheSdcbiAqIGltcG9ydCAqIGFzIE4gZnJvbSAnZnAtdHMvbnVtYmVyJ1xuICpcbiAqIGNvbnN0IEUgPSBnZXRFcShOLkVxKVxuICogYXNzZXJ0LnN0cmljdEVxdWFsKEUuZXF1YWxzKFsxLCAyXSwgWzEsIDJdKSwgdHJ1ZSlcbiAqIGFzc2VydC5zdHJpY3RFcXVhbChFLmVxdWFscyhbMSwgMl0sIFsxLCAzXSksIGZhbHNlKVxuICpcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIGdldEVxID0gZnVuY3Rpb24gKEUpIHtcbiAgICByZXR1cm4gZnJvbUVxdWFscyhmdW5jdGlvbiAoeHMsIHlzKSB7IHJldHVybiB4cy5sZW5ndGggPT09IHlzLmxlbmd0aCAmJiB4cy5ldmVyeShmdW5jdGlvbiAoeCwgaSkgeyByZXR1cm4gRS5lcXVhbHMoeCwgeXNbaV0pOyB9KTsgfSk7XG59O1xuLyoqXG4gKiBAc2luY2UgMi4xMS4wXG4gKi9cbmV4cG9ydCB2YXIgZ2V0VW5pb25TZW1pZ3JvdXAgPSBmdW5jdGlvbiAoRSkge1xuICAgIHZhciB1bmlvbkUgPSB1bmlvbihFKTtcbiAgICByZXR1cm4ge1xuICAgICAgICBjb25jYXQ6IGZ1bmN0aW9uIChmaXJzdCwgc2Vjb25kKSB7IHJldHVybiB1bmlvbkUoc2Vjb25kKShmaXJzdCk7IH1cbiAgICB9O1xufTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuNy4wXG4gKi9cbmV4cG9ydCB2YXIgRnVuY3RvciA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICBtYXA6IF9tYXBcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBtYXBwaW5nXG4gKiBAc2luY2UgMi4xMC4wXG4gKi9cbmV4cG9ydCB2YXIgZmxhcCA9IC8qI19fUFVSRV9fKi8gZmxhcF8oRnVuY3Rvcik7XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjEwLjBcbiAqL1xuZXhwb3J0IHZhciBQb2ludGVkID0ge1xuICAgIFVSSTogVVJJLFxuICAgIG9mOiBvZlxufTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuNy4wXG4gKi9cbmV4cG9ydCB2YXIgRnVuY3RvcldpdGhJbmRleCA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICBtYXA6IF9tYXAsXG4gICAgbWFwV2l0aEluZGV4OiBfbWFwV2l0aEluZGV4XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi4xMC4wXG4gKi9cbmV4cG9ydCB2YXIgQXBwbHkgPSB7XG4gICAgVVJJOiBVUkksXG4gICAgbWFwOiBfbWFwLFxuICAgIGFwOiBfYXBcbn07XG4vKipcbiAqIENvbWJpbmUgdHdvIGVmZmVjdGZ1bCBhY3Rpb25zLCBrZWVwaW5nIG9ubHkgdGhlIHJlc3VsdCBvZiB0aGUgZmlyc3QuXG4gKlxuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgYXBGaXJzdCA9IC8qI19fUFVSRV9fKi8gYXBGaXJzdF8oQXBwbHkpO1xuLyoqXG4gKiBDb21iaW5lIHR3byBlZmZlY3RmdWwgYWN0aW9ucywga2VlcGluZyBvbmx5IHRoZSByZXN1bHQgb2YgdGhlIHNlY29uZC5cbiAqXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBhcFNlY29uZCA9IC8qI19fUFVSRV9fKi8gYXBTZWNvbmRfKEFwcGx5KTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuNy4wXG4gKi9cbmV4cG9ydCB2YXIgQXBwbGljYXRpdmUgPSB7XG4gICAgVVJJOiBVUkksXG4gICAgbWFwOiBfbWFwLFxuICAgIGFwOiBfYXAsXG4gICAgb2Y6IG9mXG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi4xMC4wXG4gKi9cbmV4cG9ydCB2YXIgQ2hhaW4gPSB7XG4gICAgVVJJOiBVUkksXG4gICAgbWFwOiBfbWFwLFxuICAgIGFwOiBfYXAsXG4gICAgY2hhaW46IGZsYXRNYXBcbn07XG4vKipcbiAqIENvbXBvc2VzIGNvbXB1dGF0aW9ucyBpbiBzZXF1ZW5jZSwgdXNpbmcgdGhlIHJldHVybiB2YWx1ZSBvZiBvbmUgY29tcHV0YXRpb24gdG8gZGV0ZXJtaW5lIHRoZSBuZXh0IGNvbXB1dGF0aW9uIGFuZFxuICoga2VlcGluZyBvbmx5IHRoZSByZXN1bHQgb2YgdGhlIGZpcnN0LlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgKiBhcyBSQSBmcm9tICdmcC10cy9SZWFkb25seUFycmF5J1xuICogaW1wb3J0IHsgcGlwZSB9IGZyb20gJ2ZwLXRzL2Z1bmN0aW9uJ1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoXG4gKiAgIHBpcGUoXG4gKiAgICAgWzEsIDIsIDNdLFxuICogICAgIFJBLmNoYWluRmlyc3QoKCkgPT4gWydhJywgJ2InXSlcbiAqICAgKSxcbiAqICAgWzEsIDEsIDIsIDIsIDMsIDNdXG4gKiApXG4gKlxuICogQGNhdGVnb3J5IHNlcXVlbmNpbmdcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIGNoYWluRmlyc3QgPSAvKiNfX1BVUkVfXyovIGNoYWluRmlyc3RfKENoYWluKTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuNy4wXG4gKi9cbmV4cG9ydCB2YXIgTW9uYWQgPSB7XG4gICAgVVJJOiBVUkksXG4gICAgbWFwOiBfbWFwLFxuICAgIGFwOiBfYXAsXG4gICAgb2Y6IG9mLFxuICAgIGNoYWluOiBmbGF0TWFwXG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi43LjBcbiAqL1xuZXhwb3J0IHZhciBGb2xkYWJsZSA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICByZWR1Y2U6IF9yZWR1Y2UsXG4gICAgZm9sZE1hcDogX2ZvbGRNYXAsXG4gICAgcmVkdWNlUmlnaHQ6IF9yZWR1Y2VSaWdodFxufTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuNy4wXG4gKi9cbmV4cG9ydCB2YXIgRm9sZGFibGVXaXRoSW5kZXggPSB7XG4gICAgVVJJOiBVUkksXG4gICAgcmVkdWNlOiBfcmVkdWNlLFxuICAgIGZvbGRNYXA6IF9mb2xkTWFwLFxuICAgIHJlZHVjZVJpZ2h0OiBfcmVkdWNlUmlnaHQsXG4gICAgcmVkdWNlV2l0aEluZGV4OiBfcmVkdWNlV2l0aEluZGV4LFxuICAgIGZvbGRNYXBXaXRoSW5kZXg6IF9mb2xkTWFwV2l0aEluZGV4LFxuICAgIHJlZHVjZVJpZ2h0V2l0aEluZGV4OiBfcmVkdWNlUmlnaHRXaXRoSW5kZXhcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjcuMFxuICovXG5leHBvcnQgdmFyIFRyYXZlcnNhYmxlID0ge1xuICAgIFVSSTogVVJJLFxuICAgIG1hcDogX21hcCxcbiAgICByZWR1Y2U6IF9yZWR1Y2UsXG4gICAgZm9sZE1hcDogX2ZvbGRNYXAsXG4gICAgcmVkdWNlUmlnaHQ6IF9yZWR1Y2VSaWdodCxcbiAgICB0cmF2ZXJzZTogX3RyYXZlcnNlLFxuICAgIHNlcXVlbmNlOiBzZXF1ZW5jZVxufTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuNy4wXG4gKi9cbmV4cG9ydCB2YXIgVHJhdmVyc2FibGVXaXRoSW5kZXggPSB7XG4gICAgVVJJOiBVUkksXG4gICAgbWFwOiBfbWFwLFxuICAgIG1hcFdpdGhJbmRleDogX21hcFdpdGhJbmRleCxcbiAgICByZWR1Y2U6IF9yZWR1Y2UsXG4gICAgZm9sZE1hcDogX2ZvbGRNYXAsXG4gICAgcmVkdWNlUmlnaHQ6IF9yZWR1Y2VSaWdodCxcbiAgICB0cmF2ZXJzZTogX3RyYXZlcnNlLFxuICAgIHNlcXVlbmNlOiBzZXF1ZW5jZSxcbiAgICByZWR1Y2VXaXRoSW5kZXg6IF9yZWR1Y2VXaXRoSW5kZXgsXG4gICAgZm9sZE1hcFdpdGhJbmRleDogX2ZvbGRNYXBXaXRoSW5kZXgsXG4gICAgcmVkdWNlUmlnaHRXaXRoSW5kZXg6IF9yZWR1Y2VSaWdodFdpdGhJbmRleCxcbiAgICB0cmF2ZXJzZVdpdGhJbmRleDogX3RyYXZlcnNlV2l0aEluZGV4XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi43LjBcbiAqL1xuZXhwb3J0IHZhciBBbHQgPSB7XG4gICAgVVJJOiBVUkksXG4gICAgbWFwOiBfbWFwLFxuICAgIGFsdDogX2FsdFxufTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuNy4wXG4gKi9cbmV4cG9ydCB2YXIgQ29tb25hZCA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICBtYXA6IF9tYXAsXG4gICAgZXh0ZW5kOiBfZXh0ZW5kLFxuICAgIGV4dHJhY3Q6IGV4dHJhY3Rcbn07XG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vLyBkbyBub3RhdGlvblxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLyoqXG4gKiBAY2F0ZWdvcnkgZG8gbm90YXRpb25cbiAqIEBzaW5jZSAyLjkuMFxuICovXG5leHBvcnQgdmFyIERvID0gLyojX19QVVJFX18qLyBvZihfLmVtcHR5UmVjb3JkKTtcbi8qKlxuICogQGNhdGVnb3J5IGRvIG5vdGF0aW9uXG4gKiBAc2luY2UgMi44LjBcbiAqL1xuZXhwb3J0IHZhciBiaW5kVG8gPSAvKiNfX1BVUkVfXyovIGJpbmRUb18oRnVuY3Rvcik7XG52YXIgbGV0XyA9IC8qI19fUFVSRV9fKi8gbGV0X18oRnVuY3Rvcik7XG5leHBvcnQgeyBcbi8qKlxuICogQGNhdGVnb3J5IGRvIG5vdGF0aW9uXG4gKiBAc2luY2UgMi4xMy4wXG4gKi9cbmxldF8gYXMgbGV0IH07XG4vKipcbiAqIEBjYXRlZ29yeSBkbyBub3RhdGlvblxuICogQHNpbmNlIDIuOC4wXG4gKi9cbmV4cG9ydCB2YXIgYmluZCA9IC8qI19fUFVSRV9fKi8gYmluZF8oQ2hhaW4pO1xuLyoqXG4gKiBAY2F0ZWdvcnkgZG8gbm90YXRpb25cbiAqIEBzaW5jZSAyLjguMFxuICovXG5leHBvcnQgdmFyIGFwUyA9IC8qI19fUFVSRV9fKi8gYXBTXyhBcHBseSk7XG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vLyB1dGlsc1xuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLyoqXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBoZWFkID0gZXh0cmFjdDtcbi8qKlxuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgdGFpbCA9IF8udGFpbDtcbi8qKlxuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgbGFzdCA9IGZ1bmN0aW9uIChhcykgeyByZXR1cm4gYXNbYXMubGVuZ3RoIC0gMV07IH07XG4vKipcbiAqIEdldCBhbGwgYnV0IHRoZSBsYXN0IGVsZW1lbnQgb2YgYSBub24gZW1wdHkgYXJyYXksIGNyZWF0aW5nIGEgbmV3IGFycmF5LlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBpbml0IH0gZnJvbSAnZnAtdHMvUmVhZG9ubHlOb25FbXB0eUFycmF5J1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoaW5pdChbMSwgMiwgM10pLCBbMSwgMl0pXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKGluaXQoWzFdKSwgW10pXG4gKlxuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgaW5pdCA9IGZ1bmN0aW9uIChhcykgeyByZXR1cm4gYXMuc2xpY2UoMCwgLTEpOyB9O1xuLyoqXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBtaW4gPSBmdW5jdGlvbiAoTykge1xuICAgIHZhciBTID0gU2UubWluKE8pO1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHsgcmV0dXJuIGFzLnJlZHVjZShTLmNvbmNhdCk7IH07XG59O1xuLyoqXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBtYXggPSBmdW5jdGlvbiAoTykge1xuICAgIHZhciBTID0gU2UubWF4KE8pO1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHsgcmV0dXJuIGFzLnJlZHVjZShTLmNvbmNhdCk7IH07XG59O1xuLyoqXG4gKiBAc2luY2UgMi4xMC4wXG4gKi9cbmV4cG9ydCB2YXIgY29uY2F0QWxsID0gZnVuY3Rpb24gKFMpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIHJldHVybiBhcy5yZWR1Y2UoUy5jb25jYXQpO1xuICAgIH07XG59O1xuLyoqXG4gKiBCcmVhayBhIGBSZWFkb25seUFycmF5YCBpbnRvIGl0cyBmaXJzdCBlbGVtZW50IGFuZCByZW1haW5pbmcgZWxlbWVudHMuXG4gKlxuICogQGNhdGVnb3J5IHBhdHRlcm4gbWF0Y2hpbmdcbiAqIEBzaW5jZSAyLjExLjBcbiAqL1xuZXhwb3J0IHZhciBtYXRjaExlZnQgPSBmdW5jdGlvbiAoZikge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgcmV0dXJuIGYoaGVhZChhcyksIHRhaWwoYXMpKTtcbiAgICB9O1xufTtcbi8qKlxuICogQnJlYWsgYSBgUmVhZG9ubHlBcnJheWAgaW50byBpdHMgaW5pdGlhbCBlbGVtZW50cyBhbmQgdGhlIGxhc3QgZWxlbWVudC5cbiAqXG4gKiBAY2F0ZWdvcnkgcGF0dGVybiBtYXRjaGluZ1xuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIG1hdGNoUmlnaHQgPSBmdW5jdGlvbiAoZikge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgcmV0dXJuIGYoaW5pdChhcyksIGxhc3QoYXMpKTtcbiAgICB9O1xufTtcbi8qKlxuICogQXBwbHkgYSBmdW5jdGlvbiB0byB0aGUgaGVhZCwgY3JlYXRpbmcgYSBuZXcgYFJlYWRvbmx5Tm9uRW1wdHlBcnJheWAuXG4gKlxuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIG1vZGlmeUhlYWQgPSBmdW5jdGlvbiAoZikge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgcmV0dXJuIF9fc3ByZWFkQXJyYXkoW2YoaGVhZChhcykpXSwgdGFpbChhcyksIHRydWUpO1xuICAgIH07XG59O1xuLyoqXG4gKiBDaGFuZ2UgdGhlIGhlYWQsIGNyZWF0aW5nIGEgbmV3IGBSZWFkb25seU5vbkVtcHR5QXJyYXlgLlxuICpcbiAqIEBzaW5jZSAyLjExLjBcbiAqL1xuZXhwb3J0IHZhciB1cGRhdGVIZWFkID0gZnVuY3Rpb24gKGEpIHsgcmV0dXJuIG1vZGlmeUhlYWQoZnVuY3Rpb24gKCkgeyByZXR1cm4gYTsgfSk7IH07XG4vKipcbiAqIEFwcGx5IGEgZnVuY3Rpb24gdG8gdGhlIGxhc3QgZWxlbWVudCwgY3JlYXRpbmcgYSBuZXcgYFJlYWRvbmx5Tm9uRW1wdHlBcnJheWAuXG4gKlxuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIG1vZGlmeUxhc3QgPSBmdW5jdGlvbiAoZikge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgcmV0dXJuIHBpcGUoaW5pdChhcyksIGFwcGVuZChmKGxhc3QoYXMpKSkpO1xuICAgIH07XG59O1xuLyoqXG4gKiBDaGFuZ2UgdGhlIGxhc3QgZWxlbWVudCwgY3JlYXRpbmcgYSBuZXcgYFJlYWRvbmx5Tm9uRW1wdHlBcnJheWAuXG4gKlxuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIHVwZGF0ZUxhc3QgPSBmdW5jdGlvbiAoYSkgeyByZXR1cm4gbW9kaWZ5TGFzdChmdW5jdGlvbiAoKSB7IHJldHVybiBhOyB9KTsgfTtcbi8qKlxuICogUGxhY2VzIGFuIGVsZW1lbnQgaW4gYmV0d2VlbiBtZW1iZXJzIG9mIGEgYFJlYWRvbmx5Tm9uRW1wdHlBcnJheWAsIHRoZW4gZm9sZHMgdGhlIHJlc3VsdHMgdXNpbmcgdGhlIHByb3ZpZGVkIGBTZW1pZ3JvdXBgLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgKiBhcyBTIGZyb20gJ2ZwLXRzL3N0cmluZydcbiAqIGltcG9ydCB7IGludGVyY2FsYXRlIH0gZnJvbSAnZnAtdHMvUmVhZG9ubHlOb25FbXB0eUFycmF5J1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoaW50ZXJjYWxhdGUoUy5TZW1pZ3JvdXApKCctJykoWydhJywgJ2InLCAnYyddKSwgJ2EtYi1jJylcbiAqXG4gKiBAc2luY2UgMi4xMi4wXG4gKi9cbmV4cG9ydCB2YXIgaW50ZXJjYWxhdGUgPSBmdW5jdGlvbiAoUykge1xuICAgIHZhciBjb25jYXRBbGxTID0gY29uY2F0QWxsKFMpO1xuICAgIHJldHVybiBmdW5jdGlvbiAobWlkZGxlKSB7IHJldHVybiBmbG93KGludGVyc3BlcnNlKG1pZGRsZSksIGNvbmNhdEFsbFMpOyB9O1xufTtcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8vIGxlZ2FjeVxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLyoqXG4gKiBBbGlhcyBvZiBgZmxhdE1hcGAuXG4gKlxuICogQGNhdGVnb3J5IGxlZ2FjeVxuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgY2hhaW4gPSBmbGF0TWFwO1xuZXhwb3J0IGZ1bmN0aW9uIGdyb3VwU29ydChPKSB7XG4gICAgdmFyIHNvcnRPID0gc29ydChPKTtcbiAgICB2YXIgZ3JvdXBPID0gZ3JvdXAoTyk7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykgeyByZXR1cm4gKGlzTm9uRW1wdHkoYXMpID8gZ3JvdXBPKHNvcnRPKGFzKSkgOiBlbXB0eSk7IH07XG59XG5leHBvcnQgZnVuY3Rpb24gZmlsdGVyKHByZWRpY2F0ZSkge1xuICAgIHJldHVybiBmaWx0ZXJXaXRoSW5kZXgoZnVuY3Rpb24gKF8sIGEpIHsgcmV0dXJuIHByZWRpY2F0ZShhKTsgfSk7XG59XG4vKipcbiAqIFVzZSBbYGZpbHRlcldpdGhJbmRleGBdKC4vUmVhZG9ubHlBcnJheS50cy5odG1sI2ZpbHRlcndpdGhpbmRleCkgaW5zdGVhZC5cbiAqXG4gKiBAY2F0ZWdvcnkgem9uZSBvZiBkZWF0aFxuICogQHNpbmNlIDIuNS4wXG4gKiBAZGVwcmVjYXRlZFxuICovXG5leHBvcnQgdmFyIGZpbHRlcldpdGhJbmRleCA9IGZ1bmN0aW9uIChwcmVkaWNhdGUpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIHJldHVybiBmcm9tUmVhZG9ubHlBcnJheShhcy5maWx0ZXIoZnVuY3Rpb24gKGEsIGkpIHsgcmV0dXJuIHByZWRpY2F0ZShpLCBhKTsgfSkpO1xuICAgIH07XG59O1xuLyoqXG4gKiBVc2UgW2B1bnByZXBlbmRgXSgjdW5wcmVwZW5kKSBpbnN0ZWFkLlxuICpcbiAqIEBjYXRlZ29yeSB6b25lIG9mIGRlYXRoXG4gKiBAc2luY2UgMi4xMC4wXG4gKiBAZGVwcmVjYXRlZFxuICovXG5leHBvcnQgdmFyIHVuY29ucyA9IHVucHJlcGVuZDtcbi8qKlxuICogVXNlIFtgdW5hcHBlbmRgXSgjdW5hcHBlbmQpIGluc3RlYWQuXG4gKlxuICogQGNhdGVnb3J5IHpvbmUgb2YgZGVhdGhcbiAqIEBzaW5jZSAyLjEwLjBcbiAqIEBkZXByZWNhdGVkXG4gKi9cbmV4cG9ydCB2YXIgdW5zbm9jID0gdW5hcHBlbmQ7XG5leHBvcnQgZnVuY3Rpb24gY29ucyhoZWFkLCB0YWlsKSB7XG4gICAgcmV0dXJuIHRhaWwgPT09IHVuZGVmaW5lZCA/IHByZXBlbmQoaGVhZCkgOiBwaXBlKHRhaWwsIHByZXBlbmQoaGVhZCkpO1xufVxuLyoqXG4gKiBVc2UgW2BhcHBlbmRgXSguL1JlYWRvbmx5QXJyYXkudHMuaHRtbCNhcHBlbmQpIGluc3RlYWQuXG4gKlxuICogQGNhdGVnb3J5IHpvbmUgb2YgZGVhdGhcbiAqIEBzaW5jZSAyLjUuMFxuICogQGRlcHJlY2F0ZWRcbiAqL1xuZXhwb3J0IHZhciBzbm9jID0gZnVuY3Rpb24gKGluaXQsIGVuZCkgeyByZXR1cm4gcGlwZShpbml0LCBjb25jYXQoW2VuZF0pKTsgfTtcbi8qKlxuICogVXNlIFtgaW5zZXJ0QXRgXSguL1JlYWRvbmx5QXJyYXkudHMuaHRtbCNpbnNlcnRhdCkgaW5zdGVhZC5cbiAqXG4gKiBAY2F0ZWdvcnkgem9uZSBvZiBkZWF0aFxuICogQHNpbmNlIDIuNS4wXG4gKiBAZGVwcmVjYXRlZFxuICovXG5leHBvcnQgdmFyIGluc2VydEF0ID0gZnVuY3Rpb24gKGksIGEpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIHJldHVybiBpIDwgMCB8fCBpID4gYXMubGVuZ3RoID8gXy5ub25lIDogXy5zb21lKHVuc2FmZUluc2VydEF0KGksIGEsIGFzKSk7XG4gICAgfTtcbn07XG4vKipcbiAqIFVzZSBbYHByZXBlbmRBbGxgXSgjcHJlcGVuZGFsbCkgaW5zdGVhZC5cbiAqXG4gKiBAY2F0ZWdvcnkgem9uZSBvZiBkZWF0aFxuICogQHNpbmNlIDIuOS4wXG4gKiBAZGVwcmVjYXRlZFxuICovXG5leHBvcnQgdmFyIHByZXBlbmRUb0FsbCA9IHByZXBlbmRBbGw7XG4vKipcbiAqIFVzZSBbYGNvbmNhdEFsbGBdKCNjb25jYXRhbGwpIGluc3RlYWQuXG4gKlxuICogQGNhdGVnb3J5IHpvbmUgb2YgZGVhdGhcbiAqIEBzaW5jZSAyLjUuMFxuICogQGRlcHJlY2F0ZWRcbiAqL1xuZXhwb3J0IHZhciBmb2xkID0gY29uY2F0QWxsO1xuLyoqXG4gKiBUaGlzIGluc3RhbmNlIGlzIGRlcHJlY2F0ZWQsIHVzZSBzbWFsbCwgc3BlY2lmaWMgaW5zdGFuY2VzIGluc3RlYWQuXG4gKiBGb3IgZXhhbXBsZSBpZiBhIGZ1bmN0aW9uIG5lZWRzIGEgYEZ1bmN0b3JgIGluc3RhbmNlLCBwYXNzIGBSTkVBLkZ1bmN0b3JgIGluc3RlYWQgb2YgYFJORUEucmVhZG9ubHlOb25FbXB0eUFycmF5YFxuICogKHdoZXJlIGBSTkVBYCBpcyBmcm9tIGBpbXBvcnQgUk5FQSBmcm9tICdmcC10cy9SZWFkb25seU5vbkVtcHR5QXJyYXknYClcbiAqXG4gKiBAY2F0ZWdvcnkgem9uZSBvZiBkZWF0aFxuICogQHNpbmNlIDIuNS4wXG4gKiBAZGVwcmVjYXRlZFxuICovXG5leHBvcnQgdmFyIHJlYWRvbmx5Tm9uRW1wdHlBcnJheSA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICBvZjogb2YsXG4gICAgbWFwOiBfbWFwLFxuICAgIG1hcFdpdGhJbmRleDogX21hcFdpdGhJbmRleCxcbiAgICBhcDogX2FwLFxuICAgIGNoYWluOiBmbGF0TWFwLFxuICAgIGV4dGVuZDogX2V4dGVuZCxcbiAgICBleHRyYWN0OiBleHRyYWN0LFxuICAgIHJlZHVjZTogX3JlZHVjZSxcbiAgICBmb2xkTWFwOiBfZm9sZE1hcCxcbiAgICByZWR1Y2VSaWdodDogX3JlZHVjZVJpZ2h0LFxuICAgIHRyYXZlcnNlOiBfdHJhdmVyc2UsXG4gICAgc2VxdWVuY2U6IHNlcXVlbmNlLFxuICAgIHJlZHVjZVdpdGhJbmRleDogX3JlZHVjZVdpdGhJbmRleCxcbiAgICBmb2xkTWFwV2l0aEluZGV4OiBfZm9sZE1hcFdpdGhJbmRleCxcbiAgICByZWR1Y2VSaWdodFdpdGhJbmRleDogX3JlZHVjZVJpZ2h0V2l0aEluZGV4LFxuICAgIHRyYXZlcnNlV2l0aEluZGV4OiBfdHJhdmVyc2VXaXRoSW5kZXgsXG4gICAgYWx0OiBfYWx0XG59O1xuIiwKICAidmFyIF9fc3ByZWFkQXJyYXkgPSAodGhpcyAmJiB0aGlzLl9fc3ByZWFkQXJyYXkpIHx8IGZ1bmN0aW9uICh0bywgZnJvbSwgcGFjaykge1xuICAgIGlmIChwYWNrIHx8IGFyZ3VtZW50cy5sZW5ndGggPT09IDIpIGZvciAodmFyIGkgPSAwLCBsID0gZnJvbS5sZW5ndGgsIGFyOyBpIDwgbDsgaSsrKSB7XG4gICAgICAgIGlmIChhciB8fCAhKGkgaW4gZnJvbSkpIHtcbiAgICAgICAgICAgIGlmICghYXIpIGFyID0gQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoZnJvbSwgMCwgaSk7XG4gICAgICAgICAgICBhcltpXSA9IGZyb21baV07XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHRvLmNvbmNhdChhciB8fCBBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChmcm9tKSk7XG59O1xuaW1wb3J0IHsgYXBGaXJzdCBhcyBhcEZpcnN0XywgYXBTIGFzIGFwU18sIGFwU2Vjb25kIGFzIGFwU2Vjb25kXyB9IGZyb20gJy4vQXBwbHknO1xuaW1wb3J0IHsgYmluZCBhcyBiaW5kXywgY2hhaW5GaXJzdCBhcyBjaGFpbkZpcnN0XyB9IGZyb20gJy4vQ2hhaW4nO1xuaW1wb3J0IHsgZnJvbUVxdWFscyB9IGZyb20gJy4vRXEnO1xuaW1wb3J0IHsgZHVhbCwgZmxvdywgaWRlbnRpdHksIHBpcGUsIFNLIH0gZnJvbSAnLi9mdW5jdGlvbic7XG5pbXBvcnQgeyBiaW5kVG8gYXMgYmluZFRvXywgZmxhcCBhcyBmbGFwXywgbGV0IGFzIGxldF9fIH0gZnJvbSAnLi9GdW5jdG9yJztcbmltcG9ydCAqIGFzIF8gZnJvbSAnLi9pbnRlcm5hbCc7XG5pbXBvcnQgeyBnZXRNb25vaWQgfSBmcm9tICcuL09yZCc7XG5pbXBvcnQgKiBhcyBTZSBmcm9tICcuL1NlbWlncm91cCc7XG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vLyBpbnRlcm5hbFxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLyoqXG4gKiBAaW50ZXJuYWxcbiAqL1xuZXhwb3J0IHZhciBlbXB0eSA9IF8uZW1wdHlSZWFkb25seUFycmF5O1xuLyoqXG4gKiBAaW50ZXJuYWxcbiAqL1xuZXhwb3J0IHZhciBpc05vbkVtcHR5ID0gXy5pc05vbkVtcHR5O1xuLyoqXG4gKiBAaW50ZXJuYWxcbiAqL1xuZXhwb3J0IHZhciBpc091dE9mQm91bmQgPSBmdW5jdGlvbiAoaSwgYXMpIHsgcmV0dXJuIGkgPCAwIHx8IGkgPj0gYXMubGVuZ3RoOyB9O1xuLyoqXG4gKiBAaW50ZXJuYWxcbiAqL1xuZXhwb3J0IHZhciBwcmVwZW5kVyA9IGZ1bmN0aW9uIChoZWFkKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uICh0YWlsKSB7XG4gICAgICAgIHJldHVybiBfX3NwcmVhZEFycmF5KFtoZWFkXSwgdGFpbCwgdHJ1ZSk7XG4gICAgfTtcbn07XG4vKipcbiAqIEBpbnRlcm5hbFxuICovXG5leHBvcnQgdmFyIHByZXBlbmQgPSBwcmVwZW5kVztcbi8qKlxuICogQGludGVybmFsXG4gKi9cbmV4cG9ydCB2YXIgYXBwZW5kVyA9IGZ1bmN0aW9uIChlbmQpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGluaXQpIHtcbiAgICAgICAgcmV0dXJuIF9fc3ByZWFkQXJyYXkoX19zcHJlYWRBcnJheShbXSwgaW5pdCwgdHJ1ZSksIFtlbmRdLCBmYWxzZSk7XG4gICAgfTtcbn07XG4vKipcbiAqIEBpbnRlcm5hbFxuICovXG5leHBvcnQgdmFyIGFwcGVuZCA9IGFwcGVuZFc7XG4vKipcbiAqIEBpbnRlcm5hbFxuICovXG5leHBvcnQgdmFyIHVuc2FmZUluc2VydEF0ID0gZnVuY3Rpb24gKGksIGEsIGFzKSB7XG4gICAgaWYgKGlzTm9uRW1wdHkoYXMpKSB7XG4gICAgICAgIHZhciB4cyA9IF8uZnJvbVJlYWRvbmx5Tm9uRW1wdHlBcnJheShhcyk7XG4gICAgICAgIHhzLnNwbGljZShpLCAwLCBhKTtcbiAgICAgICAgcmV0dXJuIHhzO1xuICAgIH1cbiAgICByZXR1cm4gW2FdO1xufTtcbi8qKlxuICogQGludGVybmFsXG4gKi9cbmV4cG9ydCB2YXIgdW5zYWZlVXBkYXRlQXQgPSBmdW5jdGlvbiAoaSwgYSwgYXMpIHtcbiAgICBpZiAoYXNbaV0gPT09IGEpIHtcbiAgICAgICAgcmV0dXJuIGFzO1xuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgICAgdmFyIHhzID0gXy5mcm9tUmVhZG9ubHlOb25FbXB0eUFycmF5KGFzKTtcbiAgICAgICAgeHNbaV0gPSBhO1xuICAgICAgICByZXR1cm4geHM7XG4gICAgfVxufTtcbi8qKlxuICogUmVtb3ZlIGR1cGxpY2F0ZXMgZnJvbSBhIGBSZWFkb25seU5vbkVtcHR5QXJyYXlgLCBrZWVwaW5nIHRoZSBmaXJzdCBvY2N1cnJlbmNlIG9mIGFuIGVsZW1lbnQuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IHVuaXEgfSBmcm9tICdmcC10cy9SZWFkb25seU5vbkVtcHR5QXJyYXknXG4gKiBpbXBvcnQgKiBhcyBOIGZyb20gJ2ZwLXRzL251bWJlcidcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKHVuaXEoTi5FcSkoWzEsIDIsIDFdKSwgWzEsIDJdKVxuICpcbiAqIEBzaW5jZSAyLjExLjBcbiAqL1xuZXhwb3J0IHZhciB1bmlxID0gZnVuY3Rpb24gKEUpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIGlmIChhcy5sZW5ndGggPT09IDEpIHtcbiAgICAgICAgICAgIHJldHVybiBhcztcbiAgICAgICAgfVxuICAgICAgICB2YXIgb3V0ID0gW2hlYWQoYXMpXTtcbiAgICAgICAgdmFyIHJlc3QgPSB0YWlsKGFzKTtcbiAgICAgICAgdmFyIF9sb29wXzEgPSBmdW5jdGlvbiAoYSkge1xuICAgICAgICAgICAgaWYgKG91dC5ldmVyeShmdW5jdGlvbiAobykgeyByZXR1cm4gIUUuZXF1YWxzKG8sIGEpOyB9KSkge1xuICAgICAgICAgICAgICAgIG91dC5wdXNoKGEpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICBmb3IgKHZhciBfaSA9IDAsIHJlc3RfMSA9IHJlc3Q7IF9pIDwgcmVzdF8xLmxlbmd0aDsgX2krKykge1xuICAgICAgICAgICAgdmFyIGEgPSByZXN0XzFbX2ldO1xuICAgICAgICAgICAgX2xvb3BfMShhKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gb3V0O1xuICAgIH07XG59O1xuLyoqXG4gKiBTb3J0IHRoZSBlbGVtZW50cyBvZiBhIGBSZWFkb25seU5vbkVtcHR5QXJyYXlgIGluIGluY3JlYXNpbmcgb3JkZXIsIHdoZXJlIGVsZW1lbnRzIGFyZSBjb21wYXJlZCB1c2luZyBmaXJzdCBgb3Jkc1swXWAsIHRoZW4gYG9yZHNbMV1gLFxuICogZXRjLi4uXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCAqIGFzIFJORUEgZnJvbSAnZnAtdHMvUmVhZG9ubHlOb25FbXB0eUFycmF5J1xuICogaW1wb3J0IHsgY29udHJhbWFwIH0gZnJvbSAnZnAtdHMvT3JkJ1xuICogaW1wb3J0ICogYXMgUyBmcm9tICdmcC10cy9zdHJpbmcnXG4gKiBpbXBvcnQgKiBhcyBOIGZyb20gJ2ZwLXRzL251bWJlcidcbiAqIGltcG9ydCB7IHBpcGUgfSBmcm9tICdmcC10cy9mdW5jdGlvbidcbiAqXG4gKiBpbnRlcmZhY2UgUGVyc29uIHtcbiAqICAgbmFtZTogc3RyaW5nXG4gKiAgIGFnZTogbnVtYmVyXG4gKiB9XG4gKlxuICogY29uc3QgYnlOYW1lID0gcGlwZShTLk9yZCwgY29udHJhbWFwKChwOiBQZXJzb24pID0+IHAubmFtZSkpXG4gKlxuICogY29uc3QgYnlBZ2UgPSBwaXBlKE4uT3JkLCBjb250cmFtYXAoKHA6IFBlcnNvbikgPT4gcC5hZ2UpKVxuICpcbiAqIGNvbnN0IHNvcnRCeU5hbWVCeUFnZSA9IFJORUEuc29ydEJ5KFtieU5hbWUsIGJ5QWdlXSlcbiAqXG4gKiBjb25zdCBwZXJzb25zOiBSTkVBLlJlYWRvbmx5Tm9uRW1wdHlBcnJheTxQZXJzb24+ID0gW1xuICogICB7IG5hbWU6ICdhJywgYWdlOiAxIH0sXG4gKiAgIHsgbmFtZTogJ2InLCBhZ2U6IDMgfSxcbiAqICAgeyBuYW1lOiAnYycsIGFnZTogMiB9LFxuICogICB7IG5hbWU6ICdiJywgYWdlOiAyIH1cbiAqIF1cbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKHNvcnRCeU5hbWVCeUFnZShwZXJzb25zKSwgW1xuICogICB7IG5hbWU6ICdhJywgYWdlOiAxIH0sXG4gKiAgIHsgbmFtZTogJ2InLCBhZ2U6IDIgfSxcbiAqICAgeyBuYW1lOiAnYicsIGFnZTogMyB9LFxuICogICB7IG5hbWU6ICdjJywgYWdlOiAyIH1cbiAqIF0pXG4gKlxuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIHNvcnRCeSA9IGZ1bmN0aW9uIChvcmRzKSB7XG4gICAgaWYgKGlzTm9uRW1wdHkob3JkcykpIHtcbiAgICAgICAgdmFyIE0gPSBnZXRNb25vaWQoKTtcbiAgICAgICAgcmV0dXJuIHNvcnQob3Jkcy5yZWR1Y2UoTS5jb25jYXQsIE0uZW1wdHkpKTtcbiAgICB9XG4gICAgcmV0dXJuIGlkZW50aXR5O1xufTtcbi8qKlxuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIHVuaW9uID0gZnVuY3Rpb24gKEUpIHtcbiAgICB2YXIgdW5pcUUgPSB1bmlxKEUpO1xuICAgIHJldHVybiBmdW5jdGlvbiAoc2Vjb25kKSB7IHJldHVybiBmdW5jdGlvbiAoZmlyc3QpIHsgcmV0dXJuIHVuaXFFKHBpcGUoZmlyc3QsIGNvbmNhdChzZWNvbmQpKSk7IH07IH07XG59O1xuLyoqXG4gKiBSb3RhdGUgYSBgUmVhZG9ubHlOb25FbXB0eUFycmF5YCBieSBgbmAgc3RlcHMuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IHJvdGF0ZSB9IGZyb20gJ2ZwLXRzL1JlYWRvbmx5Tm9uRW1wdHlBcnJheSdcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKHJvdGF0ZSgyKShbMSwgMiwgMywgNCwgNV0pLCBbNCwgNSwgMSwgMiwgM10pXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKHJvdGF0ZSgtMikoWzEsIDIsIDMsIDQsIDVdKSwgWzMsIDQsIDUsIDEsIDJdKVxuICpcbiAqIEBzaW5jZSAyLjExLjBcbiAqL1xuZXhwb3J0IHZhciByb3RhdGUgPSBmdW5jdGlvbiAobikge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgdmFyIGxlbiA9IGFzLmxlbmd0aDtcbiAgICAgICAgdmFyIG0gPSBNYXRoLnJvdW5kKG4pICUgbGVuO1xuICAgICAgICBpZiAoaXNPdXRPZkJvdW5kKE1hdGguYWJzKG0pLCBhcykgfHwgbSA9PT0gMCkge1xuICAgICAgICAgICAgcmV0dXJuIGFzO1xuICAgICAgICB9XG4gICAgICAgIGlmIChtIDwgMCkge1xuICAgICAgICAgICAgdmFyIF9hID0gc3BsaXRBdCgtbSkoYXMpLCBmID0gX2FbMF0sIHMgPSBfYVsxXTtcbiAgICAgICAgICAgIHJldHVybiBwaXBlKHMsIGNvbmNhdChmKSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gcm90YXRlKG0gLSBsZW4pKGFzKTtcbiAgICAgICAgfVxuICAgIH07XG59O1xuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLy8gY29uc3RydWN0b3JzXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vKipcbiAqIFJldHVybiBhIGBSZWFkb25seU5vbkVtcHR5QXJyYXlgIGZyb20gYSBgUmVhZG9ubHlBcnJheWAgcmV0dXJuaW5nIGBub25lYCBpZiB0aGUgaW5wdXQgaXMgZW1wdHkuXG4gKlxuICogQGNhdGVnb3J5IGNvbnZlcnNpb25zXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBmcm9tUmVhZG9ubHlBcnJheSA9IGZ1bmN0aW9uIChhcykge1xuICAgIHJldHVybiBpc05vbkVtcHR5KGFzKSA/IF8uc29tZShhcykgOiBfLm5vbmU7XG59O1xuLyoqXG4gKiBSZXR1cm4gYSBgUmVhZG9ubHlOb25FbXB0eUFycmF5YCBvZiBsZW5ndGggYG5gIHdpdGggZWxlbWVudCBgaWAgaW5pdGlhbGl6ZWQgd2l0aCBgZihpKWAuXG4gKlxuICogKipOb3RlKiouIGBuYCBpcyBub3JtYWxpemVkIHRvIGEgbmF0dXJhbCBudW1iZXIuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IG1ha2VCeSB9IGZyb20gJ2ZwLXRzL1JlYWRvbmx5Tm9uRW1wdHlBcnJheSdcbiAqIGltcG9ydCB7IHBpcGUgfSBmcm9tICdmcC10cy9mdW5jdGlvbidcbiAqXG4gKiBjb25zdCBkb3VibGUgPSAobjogbnVtYmVyKTogbnVtYmVyID0+IG4gKiAyXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKHBpcGUoNSwgbWFrZUJ5KGRvdWJsZSkpLCBbMCwgMiwgNCwgNiwgOF0pXG4gKlxuICogQGNhdGVnb3J5IGNvbnN0cnVjdG9yc1xuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIG1ha2VCeSA9IGZ1bmN0aW9uIChmKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChuKSB7XG4gICAgICAgIHZhciBqID0gTWF0aC5tYXgoMCwgTWF0aC5mbG9vcihuKSk7XG4gICAgICAgIHZhciBvdXQgPSBbZigwKV07XG4gICAgICAgIGZvciAodmFyIGkgPSAxOyBpIDwgajsgaSsrKSB7XG4gICAgICAgICAgICBvdXQucHVzaChmKGkpKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gb3V0O1xuICAgIH07XG59O1xuLyoqXG4gKiBDcmVhdGUgYSBgUmVhZG9ubHlOb25FbXB0eUFycmF5YCBjb250YWluaW5nIGEgdmFsdWUgcmVwZWF0ZWQgdGhlIHNwZWNpZmllZCBudW1iZXIgb2YgdGltZXMuXG4gKlxuICogKipOb3RlKiouIGBuYCBpcyBub3JtYWxpemVkIHRvIGEgbmF0dXJhbCBudW1iZXIuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IHJlcGxpY2F0ZSB9IGZyb20gJ2ZwLXRzL1JlYWRvbmx5Tm9uRW1wdHlBcnJheSdcbiAqIGltcG9ydCB7IHBpcGUgfSBmcm9tICdmcC10cy9mdW5jdGlvbidcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKHBpcGUoMywgcmVwbGljYXRlKCdhJykpLCBbJ2EnLCAnYScsICdhJ10pXG4gKlxuICogQGNhdGVnb3J5IGNvbnN0cnVjdG9yc1xuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIHJlcGxpY2F0ZSA9IGZ1bmN0aW9uIChhKSB7IHJldHVybiBtYWtlQnkoZnVuY3Rpb24gKCkgeyByZXR1cm4gYTsgfSk7IH07XG4vKipcbiAqIENyZWF0ZSBhIGBSZWFkb25seU5vbkVtcHR5QXJyYXlgIGNvbnRhaW5pbmcgYSByYW5nZSBvZiBpbnRlZ2VycywgaW5jbHVkaW5nIGJvdGggZW5kcG9pbnRzLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyByYW5nZSB9IGZyb20gJ2ZwLXRzL1JlYWRvbmx5Tm9uRW1wdHlBcnJheSdcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKHJhbmdlKDEsIDUpLCBbMSwgMiwgMywgNCwgNV0pXG4gKlxuICogQGNhdGVnb3J5IGNvbnN0cnVjdG9yc1xuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIHJhbmdlID0gZnVuY3Rpb24gKHN0YXJ0LCBlbmQpIHtcbiAgICByZXR1cm4gc3RhcnQgPD0gZW5kID8gbWFrZUJ5KGZ1bmN0aW9uIChpKSB7IHJldHVybiBzdGFydCArIGk7IH0pKGVuZCAtIHN0YXJ0ICsgMSkgOiBbc3RhcnRdO1xufTtcbi8qKlxuICogUmV0dXJuIHRoZSB0dXBsZSBvZiB0aGUgYGhlYWRgIGFuZCB0aGUgYHRhaWxgLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyB1bnByZXBlbmQgfSBmcm9tICdmcC10cy9SZWFkb25seU5vbkVtcHR5QXJyYXknXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbCh1bnByZXBlbmQoWzEsIDIsIDMsIDRdKSwgWzEsIFsyLCAzLCA0XV0pXG4gKlxuICogQHNpbmNlIDIuOS4wXG4gKi9cbmV4cG9ydCB2YXIgdW5wcmVwZW5kID0gZnVuY3Rpb24gKGFzKSB7IHJldHVybiBbaGVhZChhcyksIHRhaWwoYXMpXTsgfTtcbi8qKlxuICogUmV0dXJuIHRoZSB0dXBsZSBvZiB0aGUgYGluaXRgIGFuZCB0aGUgYGxhc3RgLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyB1bmFwcGVuZCB9IGZyb20gJ2ZwLXRzL1JlYWRvbmx5Tm9uRW1wdHlBcnJheSdcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKHVuYXBwZW5kKFsxLCAyLCAzLCA0XSksIFtbMSwgMiwgM10sIDRdKVxuICpcbiAqIEBzaW5jZSAyLjkuMFxuICovXG5leHBvcnQgdmFyIHVuYXBwZW5kID0gZnVuY3Rpb24gKGFzKSB7IHJldHVybiBbaW5pdChhcyksIGxhc3QoYXMpXTsgfTtcbi8qKlxuICogQGNhdGVnb3J5IGNvbnZlcnNpb25zXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBmcm9tQXJyYXkgPSBmdW5jdGlvbiAoYXMpIHsgcmV0dXJuIGZyb21SZWFkb25seUFycmF5KGFzLnNsaWNlKCkpOyB9O1xuZXhwb3J0IGZ1bmN0aW9uIGNvbmNhdFcoc2Vjb25kKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChmaXJzdCkgeyByZXR1cm4gZmlyc3QuY29uY2F0KHNlY29uZCk7IH07XG59XG5leHBvcnQgZnVuY3Rpb24gY29uY2F0KHgsIHkpIHtcbiAgICByZXR1cm4geSA/IHguY29uY2F0KHkpIDogZnVuY3Rpb24gKHkpIHsgcmV0dXJuIHkuY29uY2F0KHgpOyB9O1xufVxuLyoqXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciByZXZlcnNlID0gZnVuY3Rpb24gKGFzKSB7XG4gICAgcmV0dXJuIGFzLmxlbmd0aCA9PT0gMSA/IGFzIDogX19zcHJlYWRBcnJheShbbGFzdChhcyldLCBhcy5zbGljZSgwLCAtMSkucmV2ZXJzZSgpLCB0cnVlKTtcbn07XG5leHBvcnQgZnVuY3Rpb24gZ3JvdXAoRSkge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgdmFyIGxlbiA9IGFzLmxlbmd0aDtcbiAgICAgICAgaWYgKGxlbiA9PT0gMCkge1xuICAgICAgICAgICAgcmV0dXJuIGVtcHR5O1xuICAgICAgICB9XG4gICAgICAgIHZhciBvdXQgPSBbXTtcbiAgICAgICAgdmFyIGhlYWQgPSBhc1swXTtcbiAgICAgICAgdmFyIG5lYSA9IFtoZWFkXTtcbiAgICAgICAgZm9yICh2YXIgaSA9IDE7IGkgPCBsZW47IGkrKykge1xuICAgICAgICAgICAgdmFyIGEgPSBhc1tpXTtcbiAgICAgICAgICAgIGlmIChFLmVxdWFscyhhLCBoZWFkKSkge1xuICAgICAgICAgICAgICAgIG5lYS5wdXNoKGEpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgb3V0LnB1c2gobmVhKTtcbiAgICAgICAgICAgICAgICBoZWFkID0gYTtcbiAgICAgICAgICAgICAgICBuZWEgPSBbaGVhZF07XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgb3V0LnB1c2gobmVhKTtcbiAgICAgICAgcmV0dXJuIG91dDtcbiAgICB9O1xufVxuLyoqXG4gKiBTcGxpdHMgYW4gYXJyYXkgaW50byBzdWItbm9uLWVtcHR5LWFycmF5cyBzdG9yZWQgaW4gYW4gb2JqZWN0LCBiYXNlZCBvbiB0aGUgcmVzdWx0IG9mIGNhbGxpbmcgYSBgc3RyaW5nYC1yZXR1cm5pbmdcbiAqIGZ1bmN0aW9uIG9uIGVhY2ggZWxlbWVudCwgYW5kIGdyb3VwaW5nIHRoZSByZXN1bHRzIGFjY29yZGluZyB0byB2YWx1ZXMgcmV0dXJuZWRcbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgZ3JvdXBCeSB9IGZyb20gJ2ZwLXRzL1JlYWRvbmx5Tm9uRW1wdHlBcnJheSdcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKGdyb3VwQnkoKHM6IHN0cmluZykgPT4gU3RyaW5nKHMubGVuZ3RoKSkoWydhJywgJ2InLCAnYWInXSksIHtcbiAqICAgJzEnOiBbJ2EnLCAnYiddLFxuICogICAnMic6IFsnYWInXVxuICogfSlcbiAqXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBncm91cEJ5ID0gZnVuY3Rpb24gKGYpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIHZhciBvdXQgPSB7fTtcbiAgICAgICAgZm9yICh2YXIgX2kgPSAwLCBhc18xID0gYXM7IF9pIDwgYXNfMS5sZW5ndGg7IF9pKyspIHtcbiAgICAgICAgICAgIHZhciBhID0gYXNfMVtfaV07XG4gICAgICAgICAgICB2YXIgayA9IGYoYSk7XG4gICAgICAgICAgICBpZiAoXy5oYXMuY2FsbChvdXQsIGspKSB7XG4gICAgICAgICAgICAgICAgb3V0W2tdLnB1c2goYSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBvdXRba10gPSBbYV07XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG91dDtcbiAgICB9O1xufTtcbi8qKlxuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgc29ydCA9IGZ1bmN0aW9uIChPKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykge1xuICAgICAgICByZXR1cm4gYXMubGVuZ3RoID09PSAxID8gYXMgOiBhcy5zbGljZSgpLnNvcnQoTy5jb21wYXJlKTtcbiAgICB9O1xufTtcbi8qKlxuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgdXBkYXRlQXQgPSBmdW5jdGlvbiAoaSwgYSkge1xuICAgIHJldHVybiBtb2RpZnlBdChpLCBmdW5jdGlvbiAoKSB7IHJldHVybiBhOyB9KTtcbn07XG4vKipcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIG1vZGlmeUF0ID0gZnVuY3Rpb24gKGksIGYpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIHJldHVybiBpc091dE9mQm91bmQoaSwgYXMpID8gXy5ub25lIDogXy5zb21lKHVuc2FmZVVwZGF0ZUF0KGksIGYoYXNbaV0pLCBhcykpO1xuICAgIH07XG59O1xuLyoqXG4gKiBAc2luY2UgMi41LjFcbiAqL1xuZXhwb3J0IHZhciB6aXBXaXRoID0gZnVuY3Rpb24gKGFzLCBicywgZikge1xuICAgIHZhciBjcyA9IFtmKGFzWzBdLCBic1swXSldO1xuICAgIHZhciBsZW4gPSBNYXRoLm1pbihhcy5sZW5ndGgsIGJzLmxlbmd0aCk7XG4gICAgZm9yICh2YXIgaSA9IDE7IGkgPCBsZW47IGkrKykge1xuICAgICAgICBjc1tpXSA9IGYoYXNbaV0sIGJzW2ldKTtcbiAgICB9XG4gICAgcmV0dXJuIGNzO1xufTtcbmV4cG9ydCBmdW5jdGlvbiB6aXAoYXMsIGJzKSB7XG4gICAgaWYgKGJzID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIChicykgeyByZXR1cm4gemlwKGJzLCBhcyk7IH07XG4gICAgfVxuICAgIHJldHVybiB6aXBXaXRoKGFzLCBicywgZnVuY3Rpb24gKGEsIGIpIHsgcmV0dXJuIFthLCBiXTsgfSk7XG59XG4vKipcbiAqIEBzaW5jZSAyLjUuMVxuICovXG5leHBvcnQgdmFyIHVuemlwID0gZnVuY3Rpb24gKGFicykge1xuICAgIHZhciBmYSA9IFthYnNbMF1bMF1dO1xuICAgIHZhciBmYiA9IFthYnNbMF1bMV1dO1xuICAgIGZvciAodmFyIGkgPSAxOyBpIDwgYWJzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIGZhW2ldID0gYWJzW2ldWzBdO1xuICAgICAgICBmYltpXSA9IGFic1tpXVsxXTtcbiAgICB9XG4gICAgcmV0dXJuIFtmYSwgZmJdO1xufTtcbi8qKlxuICogUHJlcGVuZCBhbiBlbGVtZW50IHRvIGV2ZXJ5IG1lbWJlciBvZiBhIGBSZWFkb25seU5vbkVtcHR5QXJyYXlgLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBwcmVwZW5kQWxsIH0gZnJvbSAnZnAtdHMvUmVhZG9ubHlOb25FbXB0eUFycmF5J1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwocHJlcGVuZEFsbCg5KShbMSwgMiwgMywgNF0pLCBbOSwgMSwgOSwgMiwgOSwgMywgOSwgNF0pXG4gKlxuICogQHNpbmNlIDIuMTAuMFxuICovXG5leHBvcnQgdmFyIHByZXBlbmRBbGwgPSBmdW5jdGlvbiAobWlkZGxlKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykge1xuICAgICAgICB2YXIgb3V0ID0gW21pZGRsZSwgYXNbMF1dO1xuICAgICAgICBmb3IgKHZhciBpID0gMTsgaSA8IGFzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICBvdXQucHVzaChtaWRkbGUsIGFzW2ldKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gb3V0O1xuICAgIH07XG59O1xuLyoqXG4gKiBQbGFjZXMgYW4gZWxlbWVudCBpbiBiZXR3ZWVuIG1lbWJlcnMgb2YgYSBgUmVhZG9ubHlOb25FbXB0eUFycmF5YC5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgaW50ZXJzcGVyc2UgfSBmcm9tICdmcC10cy9SZWFkb25seU5vbkVtcHR5QXJyYXknXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChpbnRlcnNwZXJzZSg5KShbMSwgMiwgMywgNF0pLCBbMSwgOSwgMiwgOSwgMywgOSwgNF0pXG4gKlxuICogQHNpbmNlIDIuOS4wXG4gKi9cbmV4cG9ydCB2YXIgaW50ZXJzcGVyc2UgPSBmdW5jdGlvbiAobWlkZGxlKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykge1xuICAgICAgICB2YXIgcmVzdCA9IHRhaWwoYXMpO1xuICAgICAgICByZXR1cm4gaXNOb25FbXB0eShyZXN0KSA/IHBpcGUocmVzdCwgcHJlcGVuZEFsbChtaWRkbGUpLCBwcmVwZW5kKGhlYWQoYXMpKSkgOiBhcztcbiAgICB9O1xufTtcbi8qKlxuICogQGNhdGVnb3J5IHNlcXVlbmNpbmdcbiAqIEBzaW5jZSAyLjEwLjBcbiAqL1xuZXhwb3J0IHZhciBjaGFpbldpdGhJbmRleCA9IGZ1bmN0aW9uIChmKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykge1xuICAgICAgICB2YXIgb3V0ID0gXy5mcm9tUmVhZG9ubHlOb25FbXB0eUFycmF5KGYoMCwgaGVhZChhcykpKTtcbiAgICAgICAgZm9yICh2YXIgaSA9IDE7IGkgPCBhcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgb3V0LnB1c2guYXBwbHkob3V0LCBmKGksIGFzW2ldKSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG91dDtcbiAgICB9O1xufTtcbi8qKlxuICogQSB1c2VmdWwgcmVjdXJzaW9uIHBhdHRlcm4gZm9yIHByb2Nlc3NpbmcgYSBgUmVhZG9ubHlOb25FbXB0eUFycmF5YCB0byBwcm9kdWNlIGEgbmV3IGBSZWFkb25seU5vbkVtcHR5QXJyYXlgLCBvZnRlbiB1c2VkIGZvciBcImNob3BwaW5nXCIgdXAgdGhlIGlucHV0XG4gKiBgUmVhZG9ubHlOb25FbXB0eUFycmF5YC4gVHlwaWNhbGx5IGBjaG9wYCBpcyBjYWxsZWQgd2l0aCBzb21lIGZ1bmN0aW9uIHRoYXQgd2lsbCBjb25zdW1lIGFuIGluaXRpYWwgcHJlZml4IG9mIHRoZSBgUmVhZG9ubHlOb25FbXB0eUFycmF5YCBhbmQgcHJvZHVjZSBhXG4gKiB2YWx1ZSBhbmQgdGhlIHRhaWwgb2YgdGhlIGBSZWFkb25seU5vbkVtcHR5QXJyYXlgLlxuICpcbiAqIEBzaW5jZSAyLjEwLjBcbiAqL1xuZXhwb3J0IHZhciBjaG9wID0gZnVuY3Rpb24gKGYpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIHZhciBfYSA9IGYoYXMpLCBiID0gX2FbMF0sIHJlc3QgPSBfYVsxXTtcbiAgICAgICAgdmFyIG91dCA9IFtiXTtcbiAgICAgICAgdmFyIG5leHQgPSByZXN0O1xuICAgICAgICB3aGlsZSAoaXNOb25FbXB0eShuZXh0KSkge1xuICAgICAgICAgICAgdmFyIF9iID0gZihuZXh0KSwgYl8xID0gX2JbMF0sIHJlc3RfMiA9IF9iWzFdO1xuICAgICAgICAgICAgb3V0LnB1c2goYl8xKTtcbiAgICAgICAgICAgIG5leHQgPSByZXN0XzI7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG91dDtcbiAgICB9O1xufTtcbi8qKlxuICogU3BsaXRzIGEgYFJlYWRvbmx5Tm9uRW1wdHlBcnJheWAgaW50byB0d28gcGllY2VzLCB0aGUgZmlyc3QgcGllY2UgaGFzIG1heCBgbmAgZWxlbWVudHMuXG4gKlxuICogQHNpbmNlIDIuMTAuMFxuICovXG5leHBvcnQgdmFyIHNwbGl0QXQgPSBmdW5jdGlvbiAobikge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgdmFyIG0gPSBNYXRoLm1heCgxLCBuKTtcbiAgICAgICAgcmV0dXJuIG0gPj0gYXMubGVuZ3RoID8gW2FzLCBlbXB0eV0gOiBbcGlwZShhcy5zbGljZSgxLCBtKSwgcHJlcGVuZChoZWFkKGFzKSkpLCBhcy5zbGljZShtKV07XG4gICAgfTtcbn07XG4vKipcbiAqIFNwbGl0cyBhIGBSZWFkb25seU5vbkVtcHR5QXJyYXlgIGludG8gbGVuZ3RoLWBuYCBwaWVjZXMuIFRoZSBsYXN0IHBpZWNlIHdpbGwgYmUgc2hvcnRlciBpZiBgbmAgZG9lcyBub3QgZXZlbmx5IGRpdmlkZSB0aGUgbGVuZ3RoIG9mXG4gKiB0aGUgYFJlYWRvbmx5Tm9uRW1wdHlBcnJheWAuXG4gKlxuICogQHNpbmNlIDIuMTAuMFxuICovXG5leHBvcnQgdmFyIGNodW5rc09mID0gZnVuY3Rpb24gKG4pIHsgcmV0dXJuIGNob3Aoc3BsaXRBdChuKSk7IH07XG52YXIgX21hcCA9IGZ1bmN0aW9uIChmYSwgZikgeyByZXR1cm4gcGlwZShmYSwgbWFwKGYpKTsgfTtcbi8qIGlzdGFuYnVsIGlnbm9yZSBuZXh0ICovXG52YXIgX21hcFdpdGhJbmRleCA9IGZ1bmN0aW9uIChmYSwgZikgeyByZXR1cm4gcGlwZShmYSwgbWFwV2l0aEluZGV4KGYpKTsgfTtcbnZhciBfYXAgPSBmdW5jdGlvbiAoZmFiLCBmYSkgeyByZXR1cm4gcGlwZShmYWIsIGFwKGZhKSk7IH07XG4vKiBpc3RhbmJ1bCBpZ25vcmUgbmV4dCAqL1xudmFyIF9leHRlbmQgPSBmdW5jdGlvbiAod2EsIGYpIHsgcmV0dXJuIHBpcGUod2EsIGV4dGVuZChmKSk7IH07XG4vKiBpc3RhbmJ1bCBpZ25vcmUgbmV4dCAqL1xudmFyIF9yZWR1Y2UgPSBmdW5jdGlvbiAoZmEsIGIsIGYpIHsgcmV0dXJuIHBpcGUoZmEsIHJlZHVjZShiLCBmKSk7IH07XG4vKiBpc3RhbmJ1bCBpZ25vcmUgbmV4dCAqL1xudmFyIF9mb2xkTWFwID0gZnVuY3Rpb24gKE0pIHtcbiAgICB2YXIgZm9sZE1hcE0gPSBmb2xkTWFwKE0pO1xuICAgIHJldHVybiBmdW5jdGlvbiAoZmEsIGYpIHsgcmV0dXJuIHBpcGUoZmEsIGZvbGRNYXBNKGYpKTsgfTtcbn07XG4vKiBpc3RhbmJ1bCBpZ25vcmUgbmV4dCAqL1xudmFyIF9yZWR1Y2VSaWdodCA9IGZ1bmN0aW9uIChmYSwgYiwgZikgeyByZXR1cm4gcGlwZShmYSwgcmVkdWNlUmlnaHQoYiwgZikpOyB9O1xuLyogaXN0YW5idWwgaWdub3JlIG5leHQgKi9cbnZhciBfdHJhdmVyc2UgPSBmdW5jdGlvbiAoRikge1xuICAgIHZhciB0cmF2ZXJzZUYgPSB0cmF2ZXJzZShGKTtcbiAgICByZXR1cm4gZnVuY3Rpb24gKHRhLCBmKSB7IHJldHVybiBwaXBlKHRhLCB0cmF2ZXJzZUYoZikpOyB9O1xufTtcbi8qIGlzdGFuYnVsIGlnbm9yZSBuZXh0ICovXG52YXIgX2FsdCA9IGZ1bmN0aW9uIChmYSwgdGhhdCkgeyByZXR1cm4gcGlwZShmYSwgYWx0KHRoYXQpKTsgfTtcbi8qIGlzdGFuYnVsIGlnbm9yZSBuZXh0ICovXG52YXIgX3JlZHVjZVdpdGhJbmRleCA9IGZ1bmN0aW9uIChmYSwgYiwgZikge1xuICAgIHJldHVybiBwaXBlKGZhLCByZWR1Y2VXaXRoSW5kZXgoYiwgZikpO1xufTtcbi8qIGlzdGFuYnVsIGlnbm9yZSBuZXh0ICovXG52YXIgX2ZvbGRNYXBXaXRoSW5kZXggPSBmdW5jdGlvbiAoTSkge1xuICAgIHZhciBmb2xkTWFwV2l0aEluZGV4TSA9IGZvbGRNYXBXaXRoSW5kZXgoTSk7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChmYSwgZikgeyByZXR1cm4gcGlwZShmYSwgZm9sZE1hcFdpdGhJbmRleE0oZikpOyB9O1xufTtcbi8qIGlzdGFuYnVsIGlnbm9yZSBuZXh0ICovXG52YXIgX3JlZHVjZVJpZ2h0V2l0aEluZGV4ID0gZnVuY3Rpb24gKGZhLCBiLCBmKSB7XG4gICAgcmV0dXJuIHBpcGUoZmEsIHJlZHVjZVJpZ2h0V2l0aEluZGV4KGIsIGYpKTtcbn07XG4vKiBpc3RhbmJ1bCBpZ25vcmUgbmV4dCAqL1xudmFyIF90cmF2ZXJzZVdpdGhJbmRleCA9IGZ1bmN0aW9uIChGKSB7XG4gICAgdmFyIHRyYXZlcnNlV2l0aEluZGV4RiA9IHRyYXZlcnNlV2l0aEluZGV4KEYpO1xuICAgIHJldHVybiBmdW5jdGlvbiAodGEsIGYpIHsgcmV0dXJuIHBpcGUodGEsIHRyYXZlcnNlV2l0aEluZGV4RihmKSk7IH07XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgY29uc3RydWN0b3JzXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBvZiA9IF8uc2luZ2xldG9uO1xuLyoqXG4gKiBMZXNzIHN0cmljdCB2ZXJzaW9uIG9mIFtgYWx0YF0oI2FsdCkuXG4gKlxuICogVGhlIGBXYCBzdWZmaXggKHNob3J0IGZvciAqKlcqKmlkZW5pbmcpIG1lYW5zIHRoYXQgdGhlIHJldHVybiB0eXBlcyB3aWxsIGJlIG1lcmdlZC5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0ICogYXMgUk5FQSBmcm9tICdmcC10cy9SZWFkb25seU5vbkVtcHR5QXJyYXknXG4gKiBpbXBvcnQgeyBwaXBlIH0gZnJvbSAnZnAtdHMvZnVuY3Rpb24nXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChcbiAqICAgcGlwZShcbiAqICAgICBbMSwgMiwgM10gYXMgUk5FQS5SZWFkb25seU5vbkVtcHR5QXJyYXk8bnVtYmVyPixcbiAqICAgICBSTkVBLmFsdFcoKCkgPT4gWydhJywgJ2InXSlcbiAqICAgKSxcbiAqICAgWzEsIDIsIDMsICdhJywgJ2InXVxuICogKVxuICpcbiAqIEBjYXRlZ29yeSBlcnJvciBoYW5kbGluZ1xuICogQHNpbmNlIDIuOS4wXG4gKi9cbmV4cG9ydCB2YXIgYWx0VyA9IGZ1bmN0aW9uICh0aGF0KSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykge1xuICAgICAgICByZXR1cm4gcGlwZShhcywgY29uY2F0Vyh0aGF0KCkpKTtcbiAgICB9O1xufTtcbi8qKlxuICogSWRlbnRpZmllcyBhbiBhc3NvY2lhdGl2ZSBvcGVyYXRpb24gb24gYSB0eXBlIGNvbnN0cnVjdG9yLiBJdCBpcyBzaW1pbGFyIHRvIGBTZW1pZ3JvdXBgLCBleGNlcHQgdGhhdCBpdCBhcHBsaWVzIHRvXG4gKiB0eXBlcyBvZiBraW5kIGAqIC0+ICpgLlxuICpcbiAqIEluIGNhc2Ugb2YgYFJlYWRvbmx5Tm9uRW1wdHlBcnJheWAgY29uY2F0ZW5hdGVzIHRoZSBpbnB1dHMgaW50byBhIHNpbmdsZSBhcnJheS5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0ICogYXMgUk5FQSBmcm9tICdmcC10cy9SZWFkb25seU5vbkVtcHR5QXJyYXknXG4gKiBpbXBvcnQgeyBwaXBlIH0gZnJvbSAnZnAtdHMvZnVuY3Rpb24nXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChcbiAqICAgcGlwZShcbiAqICAgICBbMSwgMiwgM10sXG4gKiAgICAgUk5FQS5hbHQoKCkgPT4gWzQsIDVdKVxuICogICApLFxuICogICBbMSwgMiwgMywgNCwgNV1cbiAqIClcbiAqXG4gKiBAY2F0ZWdvcnkgZXJyb3IgaGFuZGxpbmdcbiAqIEBzaW5jZSAyLjYuMlxuICovXG5leHBvcnQgdmFyIGFsdCA9IGFsdFc7XG4vKipcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIGFwID0gZnVuY3Rpb24gKGFzKSB7IHJldHVybiBmbGF0TWFwKGZ1bmN0aW9uIChmKSB7IHJldHVybiBwaXBlKGFzLCBtYXAoZikpOyB9KTsgfTtcbi8qKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCAqIGFzIFJORUEgZnJvbSAnZnAtdHMvUmVhZG9ubHlOb25FbXB0eUFycmF5J1xuICogaW1wb3J0IHsgcGlwZSB9IGZyb20gJ2ZwLXRzL2Z1bmN0aW9uJ1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoXG4gKiAgIHBpcGUoXG4gKiAgICAgWzEsIDIsIDNdLFxuICogICAgIFJORUEuZmxhdE1hcCgobikgPT4gW2BhJHtufWAsIGBiJHtufWBdKVxuICogICApLFxuICogICBbJ2ExJywgJ2IxJywgJ2EyJywgJ2IyJywgJ2EzJywgJ2IzJ11cbiAqIClcbiAqXG4gKiBAY2F0ZWdvcnkgc2VxdWVuY2luZ1xuICogQHNpbmNlIDIuMTQuMFxuICovXG5leHBvcnQgdmFyIGZsYXRNYXAgPSAvKiNfX1BVUkVfXyovIGR1YWwoMiwgZnVuY3Rpb24gKG1hLCBmKSB7XG4gICAgcmV0dXJuIHBpcGUobWEsIGNoYWluV2l0aEluZGV4KGZ1bmN0aW9uIChpLCBhKSB7IHJldHVybiBmKGEsIGkpOyB9KSk7XG59KTtcbi8qKlxuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgZXh0ZW5kID0gZnVuY3Rpb24gKGYpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIHZhciBuZXh0ID0gdGFpbChhcyk7XG4gICAgICAgIHZhciBvdXQgPSBbZihhcyldO1xuICAgICAgICB3aGlsZSAoaXNOb25FbXB0eShuZXh0KSkge1xuICAgICAgICAgICAgb3V0LnB1c2goZihuZXh0KSk7XG4gICAgICAgICAgICBuZXh0ID0gdGFpbChuZXh0KTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gb3V0O1xuICAgIH07XG59O1xuLyoqXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBkdXBsaWNhdGUgPSBcbi8qI19fUFVSRV9fKi8gZXh0ZW5kKGlkZW50aXR5KTtcbi8qKlxuICogQGNhdGVnb3J5IHNlcXVlbmNpbmdcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIGZsYXR0ZW4gPSBcbi8qI19fUFVSRV9fKi8gZmxhdE1hcChpZGVudGl0eSk7XG4vKipcbiAqIGBtYXBgIGNhbiBiZSB1c2VkIHRvIHR1cm4gZnVuY3Rpb25zIGAoYTogQSkgPT4gQmAgaW50byBmdW5jdGlvbnMgYChmYTogRjxBPikgPT4gRjxCPmAgd2hvc2UgYXJndW1lbnQgYW5kIHJldHVybiB0eXBlc1xuICogdXNlIHRoZSB0eXBlIGNvbnN0cnVjdG9yIGBGYCB0byByZXByZXNlbnQgc29tZSBjb21wdXRhdGlvbmFsIGNvbnRleHQuXG4gKlxuICogQGNhdGVnb3J5IG1hcHBpbmdcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIG1hcCA9IGZ1bmN0aW9uIChmKSB7XG4gICAgcmV0dXJuIG1hcFdpdGhJbmRleChmdW5jdGlvbiAoXywgYSkgeyByZXR1cm4gZihhKTsgfSk7XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgbWFwcGluZ1xuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgbWFwV2l0aEluZGV4ID0gZnVuY3Rpb24gKGYpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIHZhciBvdXQgPSBbZigwLCBoZWFkKGFzKSldO1xuICAgICAgICBmb3IgKHZhciBpID0gMTsgaSA8IGFzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICBvdXQucHVzaChmKGksIGFzW2ldKSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG91dDtcbiAgICB9O1xufTtcbi8qKlxuICogQGNhdGVnb3J5IGZvbGRpbmdcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIHJlZHVjZSA9IGZ1bmN0aW9uIChiLCBmKSB7XG4gICAgcmV0dXJuIHJlZHVjZVdpdGhJbmRleChiLCBmdW5jdGlvbiAoXywgYiwgYSkgeyByZXR1cm4gZihiLCBhKTsgfSk7XG59O1xuLyoqXG4gKiAqKk5vdGUqKi4gVGhlIGNvbnN0cmFpbnQgaXMgcmVsYXhlZDogYSBgU2VtaWdyb3VwYCBpbnN0ZWFkIG9mIGEgYE1vbm9pZGAuXG4gKlxuICogQGNhdGVnb3J5IGZvbGRpbmdcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIGZvbGRNYXAgPSBmdW5jdGlvbiAoUykge1xuICAgIHJldHVybiBmdW5jdGlvbiAoZikge1xuICAgICAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgICAgICByZXR1cm4gYXMuc2xpY2UoMSkucmVkdWNlKGZ1bmN0aW9uIChzLCBhKSB7IHJldHVybiBTLmNvbmNhdChzLCBmKGEpKTsgfSwgZihhc1swXSkpO1xuICAgICAgICB9O1xuICAgIH07XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgZm9sZGluZ1xuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgcmVkdWNlUmlnaHQgPSBmdW5jdGlvbiAoYiwgZikge1xuICAgIHJldHVybiByZWR1Y2VSaWdodFdpdGhJbmRleChiLCBmdW5jdGlvbiAoXywgYiwgYSkgeyByZXR1cm4gZihiLCBhKTsgfSk7XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgZm9sZGluZ1xuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgcmVkdWNlV2l0aEluZGV4ID0gZnVuY3Rpb24gKGIsIGYpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIHJldHVybiBhcy5yZWR1Y2UoZnVuY3Rpb24gKGIsIGEsIGkpIHsgcmV0dXJuIGYoaSwgYiwgYSk7IH0sIGIpO1xuICAgIH07XG59O1xuLyoqXG4gKiAqKk5vdGUqKi4gVGhlIGNvbnN0cmFpbnQgaXMgcmVsYXhlZDogYSBgU2VtaWdyb3VwYCBpbnN0ZWFkIG9mIGEgYE1vbm9pZGAuXG4gKlxuICogQGNhdGVnb3J5IGZvbGRpbmdcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIGZvbGRNYXBXaXRoSW5kZXggPSBmdW5jdGlvbiAoUykge1xuICAgIHJldHVybiBmdW5jdGlvbiAoZikge1xuICAgICAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgICAgICByZXR1cm4gYXMuc2xpY2UoMSkucmVkdWNlKGZ1bmN0aW9uIChzLCBhLCBpKSB7IHJldHVybiBTLmNvbmNhdChzLCBmKGkgKyAxLCBhKSk7IH0sIGYoMCwgYXNbMF0pKTtcbiAgICAgICAgfTtcbiAgICB9O1xufTtcbi8qKlxuICogQGNhdGVnb3J5IGZvbGRpbmdcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIHJlZHVjZVJpZ2h0V2l0aEluZGV4ID0gZnVuY3Rpb24gKGIsIGYpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIHJldHVybiBhcy5yZWR1Y2VSaWdodChmdW5jdGlvbiAoYiwgYSwgaSkgeyByZXR1cm4gZihpLCBhLCBiKTsgfSwgYik7XG4gICAgfTtcbn07XG4vKipcbiAqIEBjYXRlZ29yeSB0cmF2ZXJzaW5nXG4gKiBAc2luY2UgMi42LjNcbiAqL1xuZXhwb3J0IHZhciB0cmF2ZXJzZSA9IGZ1bmN0aW9uIChGKSB7XG4gICAgdmFyIHRyYXZlcnNlV2l0aEluZGV4RiA9IHRyYXZlcnNlV2l0aEluZGV4KEYpO1xuICAgIHJldHVybiBmdW5jdGlvbiAoZikgeyByZXR1cm4gdHJhdmVyc2VXaXRoSW5kZXhGKGZ1bmN0aW9uIChfLCBhKSB7IHJldHVybiBmKGEpOyB9KTsgfTtcbn07XG4vKipcbiAqIEBjYXRlZ29yeSB0cmF2ZXJzaW5nXG4gKiBAc2luY2UgMi42LjNcbiAqL1xuZXhwb3J0IHZhciBzZXF1ZW5jZSA9IGZ1bmN0aW9uIChGKSB7IHJldHVybiB0cmF2ZXJzZVdpdGhJbmRleChGKShTSyk7IH07XG4vKipcbiAqIEBjYXRlZ29yeSBzZXF1ZW5jaW5nXG4gKiBAc2luY2UgMi42LjNcbiAqL1xuZXhwb3J0IHZhciB0cmF2ZXJzZVdpdGhJbmRleCA9IGZ1bmN0aW9uIChGKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChmKSB7XG4gICAgICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgICAgIHZhciBvdXQgPSBGLm1hcChmKDAsIGhlYWQoYXMpKSwgb2YpO1xuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDE7IGkgPCBhcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgIG91dCA9IEYuYXAoRi5tYXAob3V0LCBmdW5jdGlvbiAoYnMpIHsgcmV0dXJuIGZ1bmN0aW9uIChiKSB7IHJldHVybiBwaXBlKGJzLCBhcHBlbmQoYikpOyB9OyB9KSwgZihpLCBhc1tpXSkpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIG91dDtcbiAgICAgICAgfTtcbiAgICB9O1xufTtcbi8qKlxuICogQGNhdGVnb3J5IENvbW9uYWRcbiAqIEBzaW5jZSAyLjYuM1xuICovXG5leHBvcnQgdmFyIGV4dHJhY3QgPSBfLmhlYWQ7XG4vKipcbiAqIEBjYXRlZ29yeSB0eXBlIGxhbWJkYXNcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIFVSSSA9ICdSZWFkb25seU5vbkVtcHR5QXJyYXknO1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBnZXRTaG93ID0gZnVuY3Rpb24gKFMpIHsgcmV0dXJuICh7XG4gICAgc2hvdzogZnVuY3Rpb24gKGFzKSB7IHJldHVybiBcIltcIi5jb25jYXQoYXMubWFwKFMuc2hvdykuam9pbignLCAnKSwgXCJdXCIpOyB9XG59KTsgfTtcbi8qKlxuICogQnVpbGRzIGEgYFNlbWlncm91cGAgaW5zdGFuY2UgZm9yIGBSZWFkb25seU5vbkVtcHR5QXJyYXlgXG4gKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgZ2V0U2VtaWdyb3VwID0gZnVuY3Rpb24gKCkgeyByZXR1cm4gKHtcbiAgICBjb25jYXQ6IGNvbmNhdFxufSk7IH07XG4vKipcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBnZXRFcSB9IGZyb20gJ2ZwLXRzL1JlYWRvbmx5Tm9uRW1wdHlBcnJheSdcbiAqIGltcG9ydCAqIGFzIE4gZnJvbSAnZnAtdHMvbnVtYmVyJ1xuICpcbiAqIGNvbnN0IEUgPSBnZXRFcShOLkVxKVxuICogYXNzZXJ0LnN0cmljdEVxdWFsKEUuZXF1YWxzKFsxLCAyXSwgWzEsIDJdKSwgdHJ1ZSlcbiAqIGFzc2VydC5zdHJpY3RFcXVhbChFLmVxdWFscyhbMSwgMl0sIFsxLCAzXSksIGZhbHNlKVxuICpcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIGdldEVxID0gZnVuY3Rpb24gKEUpIHtcbiAgICByZXR1cm4gZnJvbUVxdWFscyhmdW5jdGlvbiAoeHMsIHlzKSB7IHJldHVybiB4cy5sZW5ndGggPT09IHlzLmxlbmd0aCAmJiB4cy5ldmVyeShmdW5jdGlvbiAoeCwgaSkgeyByZXR1cm4gRS5lcXVhbHMoeCwgeXNbaV0pOyB9KTsgfSk7XG59O1xuLyoqXG4gKiBAc2luY2UgMi4xMS4wXG4gKi9cbmV4cG9ydCB2YXIgZ2V0VW5pb25TZW1pZ3JvdXAgPSBmdW5jdGlvbiAoRSkge1xuICAgIHZhciB1bmlvbkUgPSB1bmlvbihFKTtcbiAgICByZXR1cm4ge1xuICAgICAgICBjb25jYXQ6IGZ1bmN0aW9uIChmaXJzdCwgc2Vjb25kKSB7IHJldHVybiB1bmlvbkUoc2Vjb25kKShmaXJzdCk7IH1cbiAgICB9O1xufTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuNy4wXG4gKi9cbmV4cG9ydCB2YXIgRnVuY3RvciA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICBtYXA6IF9tYXBcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBtYXBwaW5nXG4gKiBAc2luY2UgMi4xMC4wXG4gKi9cbmV4cG9ydCB2YXIgZmxhcCA9IC8qI19fUFVSRV9fKi8gZmxhcF8oRnVuY3Rvcik7XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjEwLjBcbiAqL1xuZXhwb3J0IHZhciBQb2ludGVkID0ge1xuICAgIFVSSTogVVJJLFxuICAgIG9mOiBvZlxufTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuNy4wXG4gKi9cbmV4cG9ydCB2YXIgRnVuY3RvcldpdGhJbmRleCA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICBtYXA6IF9tYXAsXG4gICAgbWFwV2l0aEluZGV4OiBfbWFwV2l0aEluZGV4XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi4xMC4wXG4gKi9cbmV4cG9ydCB2YXIgQXBwbHkgPSB7XG4gICAgVVJJOiBVUkksXG4gICAgbWFwOiBfbWFwLFxuICAgIGFwOiBfYXBcbn07XG4vKipcbiAqIENvbWJpbmUgdHdvIGVmZmVjdGZ1bCBhY3Rpb25zLCBrZWVwaW5nIG9ubHkgdGhlIHJlc3VsdCBvZiB0aGUgZmlyc3QuXG4gKlxuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgYXBGaXJzdCA9IC8qI19fUFVSRV9fKi8gYXBGaXJzdF8oQXBwbHkpO1xuLyoqXG4gKiBDb21iaW5lIHR3byBlZmZlY3RmdWwgYWN0aW9ucywga2VlcGluZyBvbmx5IHRoZSByZXN1bHQgb2YgdGhlIHNlY29uZC5cbiAqXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBhcFNlY29uZCA9IC8qI19fUFVSRV9fKi8gYXBTZWNvbmRfKEFwcGx5KTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuNy4wXG4gKi9cbmV4cG9ydCB2YXIgQXBwbGljYXRpdmUgPSB7XG4gICAgVVJJOiBVUkksXG4gICAgbWFwOiBfbWFwLFxuICAgIGFwOiBfYXAsXG4gICAgb2Y6IG9mXG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi4xMC4wXG4gKi9cbmV4cG9ydCB2YXIgQ2hhaW4gPSB7XG4gICAgVVJJOiBVUkksXG4gICAgbWFwOiBfbWFwLFxuICAgIGFwOiBfYXAsXG4gICAgY2hhaW46IGZsYXRNYXBcbn07XG4vKipcbiAqIENvbXBvc2VzIGNvbXB1dGF0aW9ucyBpbiBzZXF1ZW5jZSwgdXNpbmcgdGhlIHJldHVybiB2YWx1ZSBvZiBvbmUgY29tcHV0YXRpb24gdG8gZGV0ZXJtaW5lIHRoZSBuZXh0IGNvbXB1dGF0aW9uIGFuZFxuICoga2VlcGluZyBvbmx5IHRoZSByZXN1bHQgb2YgdGhlIGZpcnN0LlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgKiBhcyBSQSBmcm9tICdmcC10cy9SZWFkb25seUFycmF5J1xuICogaW1wb3J0IHsgcGlwZSB9IGZyb20gJ2ZwLXRzL2Z1bmN0aW9uJ1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoXG4gKiAgIHBpcGUoXG4gKiAgICAgWzEsIDIsIDNdLFxuICogICAgIFJBLmNoYWluRmlyc3QoKCkgPT4gWydhJywgJ2InXSlcbiAqICAgKSxcbiAqICAgWzEsIDEsIDIsIDIsIDMsIDNdXG4gKiApXG4gKlxuICogQGNhdGVnb3J5IHNlcXVlbmNpbmdcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIGNoYWluRmlyc3QgPSAvKiNfX1BVUkVfXyovIGNoYWluRmlyc3RfKENoYWluKTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuNy4wXG4gKi9cbmV4cG9ydCB2YXIgTW9uYWQgPSB7XG4gICAgVVJJOiBVUkksXG4gICAgbWFwOiBfbWFwLFxuICAgIGFwOiBfYXAsXG4gICAgb2Y6IG9mLFxuICAgIGNoYWluOiBmbGF0TWFwXG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi43LjBcbiAqL1xuZXhwb3J0IHZhciBGb2xkYWJsZSA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICByZWR1Y2U6IF9yZWR1Y2UsXG4gICAgZm9sZE1hcDogX2ZvbGRNYXAsXG4gICAgcmVkdWNlUmlnaHQ6IF9yZWR1Y2VSaWdodFxufTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuNy4wXG4gKi9cbmV4cG9ydCB2YXIgRm9sZGFibGVXaXRoSW5kZXggPSB7XG4gICAgVVJJOiBVUkksXG4gICAgcmVkdWNlOiBfcmVkdWNlLFxuICAgIGZvbGRNYXA6IF9mb2xkTWFwLFxuICAgIHJlZHVjZVJpZ2h0OiBfcmVkdWNlUmlnaHQsXG4gICAgcmVkdWNlV2l0aEluZGV4OiBfcmVkdWNlV2l0aEluZGV4LFxuICAgIGZvbGRNYXBXaXRoSW5kZXg6IF9mb2xkTWFwV2l0aEluZGV4LFxuICAgIHJlZHVjZVJpZ2h0V2l0aEluZGV4OiBfcmVkdWNlUmlnaHRXaXRoSW5kZXhcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjcuMFxuICovXG5leHBvcnQgdmFyIFRyYXZlcnNhYmxlID0ge1xuICAgIFVSSTogVVJJLFxuICAgIG1hcDogX21hcCxcbiAgICByZWR1Y2U6IF9yZWR1Y2UsXG4gICAgZm9sZE1hcDogX2ZvbGRNYXAsXG4gICAgcmVkdWNlUmlnaHQ6IF9yZWR1Y2VSaWdodCxcbiAgICB0cmF2ZXJzZTogX3RyYXZlcnNlLFxuICAgIHNlcXVlbmNlOiBzZXF1ZW5jZVxufTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuNy4wXG4gKi9cbmV4cG9ydCB2YXIgVHJhdmVyc2FibGVXaXRoSW5kZXggPSB7XG4gICAgVVJJOiBVUkksXG4gICAgbWFwOiBfbWFwLFxuICAgIG1hcFdpdGhJbmRleDogX21hcFdpdGhJbmRleCxcbiAgICByZWR1Y2U6IF9yZWR1Y2UsXG4gICAgZm9sZE1hcDogX2ZvbGRNYXAsXG4gICAgcmVkdWNlUmlnaHQ6IF9yZWR1Y2VSaWdodCxcbiAgICB0cmF2ZXJzZTogX3RyYXZlcnNlLFxuICAgIHNlcXVlbmNlOiBzZXF1ZW5jZSxcbiAgICByZWR1Y2VXaXRoSW5kZXg6IF9yZWR1Y2VXaXRoSW5kZXgsXG4gICAgZm9sZE1hcFdpdGhJbmRleDogX2ZvbGRNYXBXaXRoSW5kZXgsXG4gICAgcmVkdWNlUmlnaHRXaXRoSW5kZXg6IF9yZWR1Y2VSaWdodFdpdGhJbmRleCxcbiAgICB0cmF2ZXJzZVdpdGhJbmRleDogX3RyYXZlcnNlV2l0aEluZGV4XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi43LjBcbiAqL1xuZXhwb3J0IHZhciBBbHQgPSB7XG4gICAgVVJJOiBVUkksXG4gICAgbWFwOiBfbWFwLFxuICAgIGFsdDogX2FsdFxufTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuNy4wXG4gKi9cbmV4cG9ydCB2YXIgQ29tb25hZCA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICBtYXA6IF9tYXAsXG4gICAgZXh0ZW5kOiBfZXh0ZW5kLFxuICAgIGV4dHJhY3Q6IGV4dHJhY3Rcbn07XG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vLyBkbyBub3RhdGlvblxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLyoqXG4gKiBAY2F0ZWdvcnkgZG8gbm90YXRpb25cbiAqIEBzaW5jZSAyLjkuMFxuICovXG5leHBvcnQgdmFyIERvID0gLyojX19QVVJFX18qLyBvZihfLmVtcHR5UmVjb3JkKTtcbi8qKlxuICogQGNhdGVnb3J5IGRvIG5vdGF0aW9uXG4gKiBAc2luY2UgMi44LjBcbiAqL1xuZXhwb3J0IHZhciBiaW5kVG8gPSAvKiNfX1BVUkVfXyovIGJpbmRUb18oRnVuY3Rvcik7XG52YXIgbGV0XyA9IC8qI19fUFVSRV9fKi8gbGV0X18oRnVuY3Rvcik7XG5leHBvcnQgeyBcbi8qKlxuICogQGNhdGVnb3J5IGRvIG5vdGF0aW9uXG4gKiBAc2luY2UgMi4xMy4wXG4gKi9cbmxldF8gYXMgbGV0IH07XG4vKipcbiAqIEBjYXRlZ29yeSBkbyBub3RhdGlvblxuICogQHNpbmNlIDIuOC4wXG4gKi9cbmV4cG9ydCB2YXIgYmluZCA9IC8qI19fUFVSRV9fKi8gYmluZF8oQ2hhaW4pO1xuLyoqXG4gKiBAY2F0ZWdvcnkgZG8gbm90YXRpb25cbiAqIEBzaW5jZSAyLjguMFxuICovXG5leHBvcnQgdmFyIGFwUyA9IC8qI19fUFVSRV9fKi8gYXBTXyhBcHBseSk7XG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vLyB1dGlsc1xuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLyoqXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBoZWFkID0gZXh0cmFjdDtcbi8qKlxuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgdGFpbCA9IF8udGFpbDtcbi8qKlxuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgbGFzdCA9IGZ1bmN0aW9uIChhcykgeyByZXR1cm4gYXNbYXMubGVuZ3RoIC0gMV07IH07XG4vKipcbiAqIEdldCBhbGwgYnV0IHRoZSBsYXN0IGVsZW1lbnQgb2YgYSBub24gZW1wdHkgYXJyYXksIGNyZWF0aW5nIGEgbmV3IGFycmF5LlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBpbml0IH0gZnJvbSAnZnAtdHMvUmVhZG9ubHlOb25FbXB0eUFycmF5J1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoaW5pdChbMSwgMiwgM10pLCBbMSwgMl0pXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKGluaXQoWzFdKSwgW10pXG4gKlxuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgaW5pdCA9IGZ1bmN0aW9uIChhcykgeyByZXR1cm4gYXMuc2xpY2UoMCwgLTEpOyB9O1xuLyoqXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBtaW4gPSBmdW5jdGlvbiAoTykge1xuICAgIHZhciBTID0gU2UubWluKE8pO1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHsgcmV0dXJuIGFzLnJlZHVjZShTLmNvbmNhdCk7IH07XG59O1xuLyoqXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBtYXggPSBmdW5jdGlvbiAoTykge1xuICAgIHZhciBTID0gU2UubWF4KE8pO1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHsgcmV0dXJuIGFzLnJlZHVjZShTLmNvbmNhdCk7IH07XG59O1xuLyoqXG4gKiBAc2luY2UgMi4xMC4wXG4gKi9cbmV4cG9ydCB2YXIgY29uY2F0QWxsID0gZnVuY3Rpb24gKFMpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIHJldHVybiBhcy5yZWR1Y2UoUy5jb25jYXQpO1xuICAgIH07XG59O1xuLyoqXG4gKiBCcmVhayBhIGBSZWFkb25seUFycmF5YCBpbnRvIGl0cyBmaXJzdCBlbGVtZW50IGFuZCByZW1haW5pbmcgZWxlbWVudHMuXG4gKlxuICogQGNhdGVnb3J5IHBhdHRlcm4gbWF0Y2hpbmdcbiAqIEBzaW5jZSAyLjExLjBcbiAqL1xuZXhwb3J0IHZhciBtYXRjaExlZnQgPSBmdW5jdGlvbiAoZikge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgcmV0dXJuIGYoaGVhZChhcyksIHRhaWwoYXMpKTtcbiAgICB9O1xufTtcbi8qKlxuICogQnJlYWsgYSBgUmVhZG9ubHlBcnJheWAgaW50byBpdHMgaW5pdGlhbCBlbGVtZW50cyBhbmQgdGhlIGxhc3QgZWxlbWVudC5cbiAqXG4gKiBAY2F0ZWdvcnkgcGF0dGVybiBtYXRjaGluZ1xuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIG1hdGNoUmlnaHQgPSBmdW5jdGlvbiAoZikge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgcmV0dXJuIGYoaW5pdChhcyksIGxhc3QoYXMpKTtcbiAgICB9O1xufTtcbi8qKlxuICogQXBwbHkgYSBmdW5jdGlvbiB0byB0aGUgaGVhZCwgY3JlYXRpbmcgYSBuZXcgYFJlYWRvbmx5Tm9uRW1wdHlBcnJheWAuXG4gKlxuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIG1vZGlmeUhlYWQgPSBmdW5jdGlvbiAoZikge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgcmV0dXJuIF9fc3ByZWFkQXJyYXkoW2YoaGVhZChhcykpXSwgdGFpbChhcyksIHRydWUpO1xuICAgIH07XG59O1xuLyoqXG4gKiBDaGFuZ2UgdGhlIGhlYWQsIGNyZWF0aW5nIGEgbmV3IGBSZWFkb25seU5vbkVtcHR5QXJyYXlgLlxuICpcbiAqIEBzaW5jZSAyLjExLjBcbiAqL1xuZXhwb3J0IHZhciB1cGRhdGVIZWFkID0gZnVuY3Rpb24gKGEpIHsgcmV0dXJuIG1vZGlmeUhlYWQoZnVuY3Rpb24gKCkgeyByZXR1cm4gYTsgfSk7IH07XG4vKipcbiAqIEFwcGx5IGEgZnVuY3Rpb24gdG8gdGhlIGxhc3QgZWxlbWVudCwgY3JlYXRpbmcgYSBuZXcgYFJlYWRvbmx5Tm9uRW1wdHlBcnJheWAuXG4gKlxuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIG1vZGlmeUxhc3QgPSBmdW5jdGlvbiAoZikge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgcmV0dXJuIHBpcGUoaW5pdChhcyksIGFwcGVuZChmKGxhc3QoYXMpKSkpO1xuICAgIH07XG59O1xuLyoqXG4gKiBDaGFuZ2UgdGhlIGxhc3QgZWxlbWVudCwgY3JlYXRpbmcgYSBuZXcgYFJlYWRvbmx5Tm9uRW1wdHlBcnJheWAuXG4gKlxuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIHVwZGF0ZUxhc3QgPSBmdW5jdGlvbiAoYSkgeyByZXR1cm4gbW9kaWZ5TGFzdChmdW5jdGlvbiAoKSB7IHJldHVybiBhOyB9KTsgfTtcbi8qKlxuICogUGxhY2VzIGFuIGVsZW1lbnQgaW4gYmV0d2VlbiBtZW1iZXJzIG9mIGEgYFJlYWRvbmx5Tm9uRW1wdHlBcnJheWAsIHRoZW4gZm9sZHMgdGhlIHJlc3VsdHMgdXNpbmcgdGhlIHByb3ZpZGVkIGBTZW1pZ3JvdXBgLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgKiBhcyBTIGZyb20gJ2ZwLXRzL3N0cmluZydcbiAqIGltcG9ydCB7IGludGVyY2FsYXRlIH0gZnJvbSAnZnAtdHMvUmVhZG9ubHlOb25FbXB0eUFycmF5J1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoaW50ZXJjYWxhdGUoUy5TZW1pZ3JvdXApKCctJykoWydhJywgJ2InLCAnYyddKSwgJ2EtYi1jJylcbiAqXG4gKiBAc2luY2UgMi4xMi4wXG4gKi9cbmV4cG9ydCB2YXIgaW50ZXJjYWxhdGUgPSBmdW5jdGlvbiAoUykge1xuICAgIHZhciBjb25jYXRBbGxTID0gY29uY2F0QWxsKFMpO1xuICAgIHJldHVybiBmdW5jdGlvbiAobWlkZGxlKSB7IHJldHVybiBmbG93KGludGVyc3BlcnNlKG1pZGRsZSksIGNvbmNhdEFsbFMpOyB9O1xufTtcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8vIGxlZ2FjeVxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLyoqXG4gKiBBbGlhcyBvZiBgZmxhdE1hcGAuXG4gKlxuICogQGNhdGVnb3J5IGxlZ2FjeVxuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgY2hhaW4gPSBmbGF0TWFwO1xuZXhwb3J0IGZ1bmN0aW9uIGdyb3VwU29ydChPKSB7XG4gICAgdmFyIHNvcnRPID0gc29ydChPKTtcbiAgICB2YXIgZ3JvdXBPID0gZ3JvdXAoTyk7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykgeyByZXR1cm4gKGlzTm9uRW1wdHkoYXMpID8gZ3JvdXBPKHNvcnRPKGFzKSkgOiBlbXB0eSk7IH07XG59XG5leHBvcnQgZnVuY3Rpb24gZmlsdGVyKHByZWRpY2F0ZSkge1xuICAgIHJldHVybiBmaWx0ZXJXaXRoSW5kZXgoZnVuY3Rpb24gKF8sIGEpIHsgcmV0dXJuIHByZWRpY2F0ZShhKTsgfSk7XG59XG4vKipcbiAqIFVzZSBbYGZpbHRlcldpdGhJbmRleGBdKC4vUmVhZG9ubHlBcnJheS50cy5odG1sI2ZpbHRlcndpdGhpbmRleCkgaW5zdGVhZC5cbiAqXG4gKiBAY2F0ZWdvcnkgem9uZSBvZiBkZWF0aFxuICogQHNpbmNlIDIuNS4wXG4gKiBAZGVwcmVjYXRlZFxuICovXG5leHBvcnQgdmFyIGZpbHRlcldpdGhJbmRleCA9IGZ1bmN0aW9uIChwcmVkaWNhdGUpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIHJldHVybiBmcm9tUmVhZG9ubHlBcnJheShhcy5maWx0ZXIoZnVuY3Rpb24gKGEsIGkpIHsgcmV0dXJuIHByZWRpY2F0ZShpLCBhKTsgfSkpO1xuICAgIH07XG59O1xuLyoqXG4gKiBVc2UgW2B1bnByZXBlbmRgXSgjdW5wcmVwZW5kKSBpbnN0ZWFkLlxuICpcbiAqIEBjYXRlZ29yeSB6b25lIG9mIGRlYXRoXG4gKiBAc2luY2UgMi4xMC4wXG4gKiBAZGVwcmVjYXRlZFxuICovXG5leHBvcnQgdmFyIHVuY29ucyA9IHVucHJlcGVuZDtcbi8qKlxuICogVXNlIFtgdW5hcHBlbmRgXSgjdW5hcHBlbmQpIGluc3RlYWQuXG4gKlxuICogQGNhdGVnb3J5IHpvbmUgb2YgZGVhdGhcbiAqIEBzaW5jZSAyLjEwLjBcbiAqIEBkZXByZWNhdGVkXG4gKi9cbmV4cG9ydCB2YXIgdW5zbm9jID0gdW5hcHBlbmQ7XG5leHBvcnQgZnVuY3Rpb24gY29ucyhoZWFkLCB0YWlsKSB7XG4gICAgcmV0dXJuIHRhaWwgPT09IHVuZGVmaW5lZCA/IHByZXBlbmQoaGVhZCkgOiBwaXBlKHRhaWwsIHByZXBlbmQoaGVhZCkpO1xufVxuLyoqXG4gKiBVc2UgW2BhcHBlbmRgXSguL1JlYWRvbmx5QXJyYXkudHMuaHRtbCNhcHBlbmQpIGluc3RlYWQuXG4gKlxuICogQGNhdGVnb3J5IHpvbmUgb2YgZGVhdGhcbiAqIEBzaW5jZSAyLjUuMFxuICogQGRlcHJlY2F0ZWRcbiAqL1xuZXhwb3J0IHZhciBzbm9jID0gZnVuY3Rpb24gKGluaXQsIGVuZCkgeyByZXR1cm4gcGlwZShpbml0LCBjb25jYXQoW2VuZF0pKTsgfTtcbi8qKlxuICogVXNlIFtgaW5zZXJ0QXRgXSguL1JlYWRvbmx5QXJyYXkudHMuaHRtbCNpbnNlcnRhdCkgaW5zdGVhZC5cbiAqXG4gKiBAY2F0ZWdvcnkgem9uZSBvZiBkZWF0aFxuICogQHNpbmNlIDIuNS4wXG4gKiBAZGVwcmVjYXRlZFxuICovXG5leHBvcnQgdmFyIGluc2VydEF0ID0gZnVuY3Rpb24gKGksIGEpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIHJldHVybiBpIDwgMCB8fCBpID4gYXMubGVuZ3RoID8gXy5ub25lIDogXy5zb21lKHVuc2FmZUluc2VydEF0KGksIGEsIGFzKSk7XG4gICAgfTtcbn07XG4vKipcbiAqIFVzZSBbYHByZXBlbmRBbGxgXSgjcHJlcGVuZGFsbCkgaW5zdGVhZC5cbiAqXG4gKiBAY2F0ZWdvcnkgem9uZSBvZiBkZWF0aFxuICogQHNpbmNlIDIuOS4wXG4gKiBAZGVwcmVjYXRlZFxuICovXG5leHBvcnQgdmFyIHByZXBlbmRUb0FsbCA9IHByZXBlbmRBbGw7XG4vKipcbiAqIFVzZSBbYGNvbmNhdEFsbGBdKCNjb25jYXRhbGwpIGluc3RlYWQuXG4gKlxuICogQGNhdGVnb3J5IHpvbmUgb2YgZGVhdGhcbiAqIEBzaW5jZSAyLjUuMFxuICogQGRlcHJlY2F0ZWRcbiAqL1xuZXhwb3J0IHZhciBmb2xkID0gY29uY2F0QWxsO1xuLyoqXG4gKiBUaGlzIGluc3RhbmNlIGlzIGRlcHJlY2F0ZWQsIHVzZSBzbWFsbCwgc3BlY2lmaWMgaW5zdGFuY2VzIGluc3RlYWQuXG4gKiBGb3IgZXhhbXBsZSBpZiBhIGZ1bmN0aW9uIG5lZWRzIGEgYEZ1bmN0b3JgIGluc3RhbmNlLCBwYXNzIGBSTkVBLkZ1bmN0b3JgIGluc3RlYWQgb2YgYFJORUEucmVhZG9ubHlOb25FbXB0eUFycmF5YFxuICogKHdoZXJlIGBSTkVBYCBpcyBmcm9tIGBpbXBvcnQgUk5FQSBmcm9tICdmcC10cy9SZWFkb25seU5vbkVtcHR5QXJyYXknYClcbiAqXG4gKiBAY2F0ZWdvcnkgem9uZSBvZiBkZWF0aFxuICogQHNpbmNlIDIuNS4wXG4gKiBAZGVwcmVjYXRlZFxuICovXG5leHBvcnQgdmFyIHJlYWRvbmx5Tm9uRW1wdHlBcnJheSA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICBvZjogb2YsXG4gICAgbWFwOiBfbWFwLFxuICAgIG1hcFdpdGhJbmRleDogX21hcFdpdGhJbmRleCxcbiAgICBhcDogX2FwLFxuICAgIGNoYWluOiBmbGF0TWFwLFxuICAgIGV4dGVuZDogX2V4dGVuZCxcbiAgICBleHRyYWN0OiBleHRyYWN0LFxuICAgIHJlZHVjZTogX3JlZHVjZSxcbiAgICBmb2xkTWFwOiBfZm9sZE1hcCxcbiAgICByZWR1Y2VSaWdodDogX3JlZHVjZVJpZ2h0LFxuICAgIHRyYXZlcnNlOiBfdHJhdmVyc2UsXG4gICAgc2VxdWVuY2U6IHNlcXVlbmNlLFxuICAgIHJlZHVjZVdpdGhJbmRleDogX3JlZHVjZVdpdGhJbmRleCxcbiAgICBmb2xkTWFwV2l0aEluZGV4OiBfZm9sZE1hcFdpdGhJbmRleCxcbiAgICByZWR1Y2VSaWdodFdpdGhJbmRleDogX3JlZHVjZVJpZ2h0V2l0aEluZGV4LFxuICAgIHRyYXZlcnNlV2l0aEluZGV4OiBfdHJhdmVyc2VXaXRoSW5kZXgsXG4gICAgYWx0OiBfYWx0XG59O1xuIiwKICAidmFyIF9fc3ByZWFkQXJyYXkgPSAodGhpcyAmJiB0aGlzLl9fc3ByZWFkQXJyYXkpIHx8IGZ1bmN0aW9uICh0bywgZnJvbSwgcGFjaykge1xuICAgIGlmIChwYWNrIHx8IGFyZ3VtZW50cy5sZW5ndGggPT09IDIpIGZvciAodmFyIGkgPSAwLCBsID0gZnJvbS5sZW5ndGgsIGFyOyBpIDwgbDsgaSsrKSB7XG4gICAgICAgIGlmIChhciB8fCAhKGkgaW4gZnJvbSkpIHtcbiAgICAgICAgICAgIGlmICghYXIpIGFyID0gQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoZnJvbSwgMCwgaSk7XG4gICAgICAgICAgICBhcltpXSA9IGZyb21baV07XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHRvLmNvbmNhdChhciB8fCBBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChmcm9tKSk7XG59O1xuaW1wb3J0IHsgYXBGaXJzdCBhcyBhcEZpcnN0XywgYXBTIGFzIGFwU18sIGFwU2Vjb25kIGFzIGFwU2Vjb25kXyB9IGZyb20gJy4vQXBwbHknO1xuaW1wb3J0IHsgYmluZCBhcyBiaW5kXywgY2hhaW5GaXJzdCBhcyBjaGFpbkZpcnN0XyB9IGZyb20gJy4vQ2hhaW4nO1xuaW1wb3J0IHsgZnJvbUVxdWFscyB9IGZyb20gJy4vRXEnO1xuaW1wb3J0IHsgZHVhbCwgZmxvdywgaWRlbnRpdHksIHBpcGUsIFNLIH0gZnJvbSAnLi9mdW5jdGlvbic7XG5pbXBvcnQgeyBiaW5kVG8gYXMgYmluZFRvXywgZmxhcCBhcyBmbGFwXywgbGV0IGFzIGxldF9fIH0gZnJvbSAnLi9GdW5jdG9yJztcbmltcG9ydCAqIGFzIF8gZnJvbSAnLi9pbnRlcm5hbCc7XG5pbXBvcnQgeyBnZXRNb25vaWQgfSBmcm9tICcuL09yZCc7XG5pbXBvcnQgKiBhcyBTZSBmcm9tICcuL1NlbWlncm91cCc7XG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vLyBpbnRlcm5hbFxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLyoqXG4gKiBAaW50ZXJuYWxcbiAqL1xuZXhwb3J0IHZhciBlbXB0eSA9IF8uZW1wdHlSZWFkb25seUFycmF5O1xuLyoqXG4gKiBAaW50ZXJuYWxcbiAqL1xuZXhwb3J0IHZhciBpc05vbkVtcHR5ID0gXy5pc05vbkVtcHR5O1xuLyoqXG4gKiBAaW50ZXJuYWxcbiAqL1xuZXhwb3J0IHZhciBpc091dE9mQm91bmQgPSBmdW5jdGlvbiAoaSwgYXMpIHsgcmV0dXJuIGkgPCAwIHx8IGkgPj0gYXMubGVuZ3RoOyB9O1xuLyoqXG4gKiBAaW50ZXJuYWxcbiAqL1xuZXhwb3J0IHZhciBwcmVwZW5kVyA9IGZ1bmN0aW9uIChoZWFkKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uICh0YWlsKSB7XG4gICAgICAgIHJldHVybiBfX3NwcmVhZEFycmF5KFtoZWFkXSwgdGFpbCwgdHJ1ZSk7XG4gICAgfTtcbn07XG4vKipcbiAqIEBpbnRlcm5hbFxuICovXG5leHBvcnQgdmFyIHByZXBlbmQgPSBwcmVwZW5kVztcbi8qKlxuICogQGludGVybmFsXG4gKi9cbmV4cG9ydCB2YXIgYXBwZW5kVyA9IGZ1bmN0aW9uIChlbmQpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGluaXQpIHtcbiAgICAgICAgcmV0dXJuIF9fc3ByZWFkQXJyYXkoX19zcHJlYWRBcnJheShbXSwgaW5pdCwgdHJ1ZSksIFtlbmRdLCBmYWxzZSk7XG4gICAgfTtcbn07XG4vKipcbiAqIEBpbnRlcm5hbFxuICovXG5leHBvcnQgdmFyIGFwcGVuZCA9IGFwcGVuZFc7XG4vKipcbiAqIEBpbnRlcm5hbFxuICovXG5leHBvcnQgdmFyIHVuc2FmZUluc2VydEF0ID0gZnVuY3Rpb24gKGksIGEsIGFzKSB7XG4gICAgaWYgKGlzTm9uRW1wdHkoYXMpKSB7XG4gICAgICAgIHZhciB4cyA9IF8uZnJvbVJlYWRvbmx5Tm9uRW1wdHlBcnJheShhcyk7XG4gICAgICAgIHhzLnNwbGljZShpLCAwLCBhKTtcbiAgICAgICAgcmV0dXJuIHhzO1xuICAgIH1cbiAgICByZXR1cm4gW2FdO1xufTtcbi8qKlxuICogQGludGVybmFsXG4gKi9cbmV4cG9ydCB2YXIgdW5zYWZlVXBkYXRlQXQgPSBmdW5jdGlvbiAoaSwgYSwgYXMpIHtcbiAgICBpZiAoYXNbaV0gPT09IGEpIHtcbiAgICAgICAgcmV0dXJuIGFzO1xuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgICAgdmFyIHhzID0gXy5mcm9tUmVhZG9ubHlOb25FbXB0eUFycmF5KGFzKTtcbiAgICAgICAgeHNbaV0gPSBhO1xuICAgICAgICByZXR1cm4geHM7XG4gICAgfVxufTtcbi8qKlxuICogUmVtb3ZlIGR1cGxpY2F0ZXMgZnJvbSBhIGBSZWFkb25seU5vbkVtcHR5QXJyYXlgLCBrZWVwaW5nIHRoZSBmaXJzdCBvY2N1cnJlbmNlIG9mIGFuIGVsZW1lbnQuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IHVuaXEgfSBmcm9tICdmcC10cy9SZWFkb25seU5vbkVtcHR5QXJyYXknXG4gKiBpbXBvcnQgKiBhcyBOIGZyb20gJ2ZwLXRzL251bWJlcidcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKHVuaXEoTi5FcSkoWzEsIDIsIDFdKSwgWzEsIDJdKVxuICpcbiAqIEBzaW5jZSAyLjExLjBcbiAqL1xuZXhwb3J0IHZhciB1bmlxID0gZnVuY3Rpb24gKEUpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIGlmIChhcy5sZW5ndGggPT09IDEpIHtcbiAgICAgICAgICAgIHJldHVybiBhcztcbiAgICAgICAgfVxuICAgICAgICB2YXIgb3V0ID0gW2hlYWQoYXMpXTtcbiAgICAgICAgdmFyIHJlc3QgPSB0YWlsKGFzKTtcbiAgICAgICAgdmFyIF9sb29wXzEgPSBmdW5jdGlvbiAoYSkge1xuICAgICAgICAgICAgaWYgKG91dC5ldmVyeShmdW5jdGlvbiAobykgeyByZXR1cm4gIUUuZXF1YWxzKG8sIGEpOyB9KSkge1xuICAgICAgICAgICAgICAgIG91dC5wdXNoKGEpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICBmb3IgKHZhciBfaSA9IDAsIHJlc3RfMSA9IHJlc3Q7IF9pIDwgcmVzdF8xLmxlbmd0aDsgX2krKykge1xuICAgICAgICAgICAgdmFyIGEgPSByZXN0XzFbX2ldO1xuICAgICAgICAgICAgX2xvb3BfMShhKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gb3V0O1xuICAgIH07XG59O1xuLyoqXG4gKiBTb3J0IHRoZSBlbGVtZW50cyBvZiBhIGBSZWFkb25seU5vbkVtcHR5QXJyYXlgIGluIGluY3JlYXNpbmcgb3JkZXIsIHdoZXJlIGVsZW1lbnRzIGFyZSBjb21wYXJlZCB1c2luZyBmaXJzdCBgb3Jkc1swXWAsIHRoZW4gYG9yZHNbMV1gLFxuICogZXRjLi4uXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCAqIGFzIFJORUEgZnJvbSAnZnAtdHMvUmVhZG9ubHlOb25FbXB0eUFycmF5J1xuICogaW1wb3J0IHsgY29udHJhbWFwIH0gZnJvbSAnZnAtdHMvT3JkJ1xuICogaW1wb3J0ICogYXMgUyBmcm9tICdmcC10cy9zdHJpbmcnXG4gKiBpbXBvcnQgKiBhcyBOIGZyb20gJ2ZwLXRzL251bWJlcidcbiAqIGltcG9ydCB7IHBpcGUgfSBmcm9tICdmcC10cy9mdW5jdGlvbidcbiAqXG4gKiBpbnRlcmZhY2UgUGVyc29uIHtcbiAqICAgbmFtZTogc3RyaW5nXG4gKiAgIGFnZTogbnVtYmVyXG4gKiB9XG4gKlxuICogY29uc3QgYnlOYW1lID0gcGlwZShTLk9yZCwgY29udHJhbWFwKChwOiBQZXJzb24pID0+IHAubmFtZSkpXG4gKlxuICogY29uc3QgYnlBZ2UgPSBwaXBlKE4uT3JkLCBjb250cmFtYXAoKHA6IFBlcnNvbikgPT4gcC5hZ2UpKVxuICpcbiAqIGNvbnN0IHNvcnRCeU5hbWVCeUFnZSA9IFJORUEuc29ydEJ5KFtieU5hbWUsIGJ5QWdlXSlcbiAqXG4gKiBjb25zdCBwZXJzb25zOiBSTkVBLlJlYWRvbmx5Tm9uRW1wdHlBcnJheTxQZXJzb24+ID0gW1xuICogICB7IG5hbWU6ICdhJywgYWdlOiAxIH0sXG4gKiAgIHsgbmFtZTogJ2InLCBhZ2U6IDMgfSxcbiAqICAgeyBuYW1lOiAnYycsIGFnZTogMiB9LFxuICogICB7IG5hbWU6ICdiJywgYWdlOiAyIH1cbiAqIF1cbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKHNvcnRCeU5hbWVCeUFnZShwZXJzb25zKSwgW1xuICogICB7IG5hbWU6ICdhJywgYWdlOiAxIH0sXG4gKiAgIHsgbmFtZTogJ2InLCBhZ2U6IDIgfSxcbiAqICAgeyBuYW1lOiAnYicsIGFnZTogMyB9LFxuICogICB7IG5hbWU6ICdjJywgYWdlOiAyIH1cbiAqIF0pXG4gKlxuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIHNvcnRCeSA9IGZ1bmN0aW9uIChvcmRzKSB7XG4gICAgaWYgKGlzTm9uRW1wdHkob3JkcykpIHtcbiAgICAgICAgdmFyIE0gPSBnZXRNb25vaWQoKTtcbiAgICAgICAgcmV0dXJuIHNvcnQob3Jkcy5yZWR1Y2UoTS5jb25jYXQsIE0uZW1wdHkpKTtcbiAgICB9XG4gICAgcmV0dXJuIGlkZW50aXR5O1xufTtcbi8qKlxuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIHVuaW9uID0gZnVuY3Rpb24gKEUpIHtcbiAgICB2YXIgdW5pcUUgPSB1bmlxKEUpO1xuICAgIHJldHVybiBmdW5jdGlvbiAoc2Vjb25kKSB7IHJldHVybiBmdW5jdGlvbiAoZmlyc3QpIHsgcmV0dXJuIHVuaXFFKHBpcGUoZmlyc3QsIGNvbmNhdChzZWNvbmQpKSk7IH07IH07XG59O1xuLyoqXG4gKiBSb3RhdGUgYSBgUmVhZG9ubHlOb25FbXB0eUFycmF5YCBieSBgbmAgc3RlcHMuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IHJvdGF0ZSB9IGZyb20gJ2ZwLXRzL1JlYWRvbmx5Tm9uRW1wdHlBcnJheSdcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKHJvdGF0ZSgyKShbMSwgMiwgMywgNCwgNV0pLCBbNCwgNSwgMSwgMiwgM10pXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKHJvdGF0ZSgtMikoWzEsIDIsIDMsIDQsIDVdKSwgWzMsIDQsIDUsIDEsIDJdKVxuICpcbiAqIEBzaW5jZSAyLjExLjBcbiAqL1xuZXhwb3J0IHZhciByb3RhdGUgPSBmdW5jdGlvbiAobikge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgdmFyIGxlbiA9IGFzLmxlbmd0aDtcbiAgICAgICAgdmFyIG0gPSBNYXRoLnJvdW5kKG4pICUgbGVuO1xuICAgICAgICBpZiAoaXNPdXRPZkJvdW5kKE1hdGguYWJzKG0pLCBhcykgfHwgbSA9PT0gMCkge1xuICAgICAgICAgICAgcmV0dXJuIGFzO1xuICAgICAgICB9XG4gICAgICAgIGlmIChtIDwgMCkge1xuICAgICAgICAgICAgdmFyIF9hID0gc3BsaXRBdCgtbSkoYXMpLCBmID0gX2FbMF0sIHMgPSBfYVsxXTtcbiAgICAgICAgICAgIHJldHVybiBwaXBlKHMsIGNvbmNhdChmKSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gcm90YXRlKG0gLSBsZW4pKGFzKTtcbiAgICAgICAgfVxuICAgIH07XG59O1xuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLy8gY29uc3RydWN0b3JzXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vKipcbiAqIFJldHVybiBhIGBSZWFkb25seU5vbkVtcHR5QXJyYXlgIGZyb20gYSBgUmVhZG9ubHlBcnJheWAgcmV0dXJuaW5nIGBub25lYCBpZiB0aGUgaW5wdXQgaXMgZW1wdHkuXG4gKlxuICogQGNhdGVnb3J5IGNvbnZlcnNpb25zXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBmcm9tUmVhZG9ubHlBcnJheSA9IGZ1bmN0aW9uIChhcykge1xuICAgIHJldHVybiBpc05vbkVtcHR5KGFzKSA/IF8uc29tZShhcykgOiBfLm5vbmU7XG59O1xuLyoqXG4gKiBSZXR1cm4gYSBgUmVhZG9ubHlOb25FbXB0eUFycmF5YCBvZiBsZW5ndGggYG5gIHdpdGggZWxlbWVudCBgaWAgaW5pdGlhbGl6ZWQgd2l0aCBgZihpKWAuXG4gKlxuICogKipOb3RlKiouIGBuYCBpcyBub3JtYWxpemVkIHRvIGEgbmF0dXJhbCBudW1iZXIuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IG1ha2VCeSB9IGZyb20gJ2ZwLXRzL1JlYWRvbmx5Tm9uRW1wdHlBcnJheSdcbiAqIGltcG9ydCB7IHBpcGUgfSBmcm9tICdmcC10cy9mdW5jdGlvbidcbiAqXG4gKiBjb25zdCBkb3VibGUgPSAobjogbnVtYmVyKTogbnVtYmVyID0+IG4gKiAyXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKHBpcGUoNSwgbWFrZUJ5KGRvdWJsZSkpLCBbMCwgMiwgNCwgNiwgOF0pXG4gKlxuICogQGNhdGVnb3J5IGNvbnN0cnVjdG9yc1xuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIG1ha2VCeSA9IGZ1bmN0aW9uIChmKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChuKSB7XG4gICAgICAgIHZhciBqID0gTWF0aC5tYXgoMCwgTWF0aC5mbG9vcihuKSk7XG4gICAgICAgIHZhciBvdXQgPSBbZigwKV07XG4gICAgICAgIGZvciAodmFyIGkgPSAxOyBpIDwgajsgaSsrKSB7XG4gICAgICAgICAgICBvdXQucHVzaChmKGkpKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gb3V0O1xuICAgIH07XG59O1xuLyoqXG4gKiBDcmVhdGUgYSBgUmVhZG9ubHlOb25FbXB0eUFycmF5YCBjb250YWluaW5nIGEgdmFsdWUgcmVwZWF0ZWQgdGhlIHNwZWNpZmllZCBudW1iZXIgb2YgdGltZXMuXG4gKlxuICogKipOb3RlKiouIGBuYCBpcyBub3JtYWxpemVkIHRvIGEgbmF0dXJhbCBudW1iZXIuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IHJlcGxpY2F0ZSB9IGZyb20gJ2ZwLXRzL1JlYWRvbmx5Tm9uRW1wdHlBcnJheSdcbiAqIGltcG9ydCB7IHBpcGUgfSBmcm9tICdmcC10cy9mdW5jdGlvbidcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKHBpcGUoMywgcmVwbGljYXRlKCdhJykpLCBbJ2EnLCAnYScsICdhJ10pXG4gKlxuICogQGNhdGVnb3J5IGNvbnN0cnVjdG9yc1xuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIHJlcGxpY2F0ZSA9IGZ1bmN0aW9uIChhKSB7IHJldHVybiBtYWtlQnkoZnVuY3Rpb24gKCkgeyByZXR1cm4gYTsgfSk7IH07XG4vKipcbiAqIENyZWF0ZSBhIGBSZWFkb25seU5vbkVtcHR5QXJyYXlgIGNvbnRhaW5pbmcgYSByYW5nZSBvZiBpbnRlZ2VycywgaW5jbHVkaW5nIGJvdGggZW5kcG9pbnRzLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyByYW5nZSB9IGZyb20gJ2ZwLXRzL1JlYWRvbmx5Tm9uRW1wdHlBcnJheSdcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKHJhbmdlKDEsIDUpLCBbMSwgMiwgMywgNCwgNV0pXG4gKlxuICogQGNhdGVnb3J5IGNvbnN0cnVjdG9yc1xuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIHJhbmdlID0gZnVuY3Rpb24gKHN0YXJ0LCBlbmQpIHtcbiAgICByZXR1cm4gc3RhcnQgPD0gZW5kID8gbWFrZUJ5KGZ1bmN0aW9uIChpKSB7IHJldHVybiBzdGFydCArIGk7IH0pKGVuZCAtIHN0YXJ0ICsgMSkgOiBbc3RhcnRdO1xufTtcbi8qKlxuICogUmV0dXJuIHRoZSB0dXBsZSBvZiB0aGUgYGhlYWRgIGFuZCB0aGUgYHRhaWxgLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyB1bnByZXBlbmQgfSBmcm9tICdmcC10cy9SZWFkb25seU5vbkVtcHR5QXJyYXknXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbCh1bnByZXBlbmQoWzEsIDIsIDMsIDRdKSwgWzEsIFsyLCAzLCA0XV0pXG4gKlxuICogQHNpbmNlIDIuOS4wXG4gKi9cbmV4cG9ydCB2YXIgdW5wcmVwZW5kID0gZnVuY3Rpb24gKGFzKSB7IHJldHVybiBbaGVhZChhcyksIHRhaWwoYXMpXTsgfTtcbi8qKlxuICogUmV0dXJuIHRoZSB0dXBsZSBvZiB0aGUgYGluaXRgIGFuZCB0aGUgYGxhc3RgLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyB1bmFwcGVuZCB9IGZyb20gJ2ZwLXRzL1JlYWRvbmx5Tm9uRW1wdHlBcnJheSdcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKHVuYXBwZW5kKFsxLCAyLCAzLCA0XSksIFtbMSwgMiwgM10sIDRdKVxuICpcbiAqIEBzaW5jZSAyLjkuMFxuICovXG5leHBvcnQgdmFyIHVuYXBwZW5kID0gZnVuY3Rpb24gKGFzKSB7IHJldHVybiBbaW5pdChhcyksIGxhc3QoYXMpXTsgfTtcbi8qKlxuICogQGNhdGVnb3J5IGNvbnZlcnNpb25zXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBmcm9tQXJyYXkgPSBmdW5jdGlvbiAoYXMpIHsgcmV0dXJuIGZyb21SZWFkb25seUFycmF5KGFzLnNsaWNlKCkpOyB9O1xuZXhwb3J0IGZ1bmN0aW9uIGNvbmNhdFcoc2Vjb25kKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChmaXJzdCkgeyByZXR1cm4gZmlyc3QuY29uY2F0KHNlY29uZCk7IH07XG59XG5leHBvcnQgZnVuY3Rpb24gY29uY2F0KHgsIHkpIHtcbiAgICByZXR1cm4geSA/IHguY29uY2F0KHkpIDogZnVuY3Rpb24gKHkpIHsgcmV0dXJuIHkuY29uY2F0KHgpOyB9O1xufVxuLyoqXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciByZXZlcnNlID0gZnVuY3Rpb24gKGFzKSB7XG4gICAgcmV0dXJuIGFzLmxlbmd0aCA9PT0gMSA/IGFzIDogX19zcHJlYWRBcnJheShbbGFzdChhcyldLCBhcy5zbGljZSgwLCAtMSkucmV2ZXJzZSgpLCB0cnVlKTtcbn07XG5leHBvcnQgZnVuY3Rpb24gZ3JvdXAoRSkge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgdmFyIGxlbiA9IGFzLmxlbmd0aDtcbiAgICAgICAgaWYgKGxlbiA9PT0gMCkge1xuICAgICAgICAgICAgcmV0dXJuIGVtcHR5O1xuICAgICAgICB9XG4gICAgICAgIHZhciBvdXQgPSBbXTtcbiAgICAgICAgdmFyIGhlYWQgPSBhc1swXTtcbiAgICAgICAgdmFyIG5lYSA9IFtoZWFkXTtcbiAgICAgICAgZm9yICh2YXIgaSA9IDE7IGkgPCBsZW47IGkrKykge1xuICAgICAgICAgICAgdmFyIGEgPSBhc1tpXTtcbiAgICAgICAgICAgIGlmIChFLmVxdWFscyhhLCBoZWFkKSkge1xuICAgICAgICAgICAgICAgIG5lYS5wdXNoKGEpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgb3V0LnB1c2gobmVhKTtcbiAgICAgICAgICAgICAgICBoZWFkID0gYTtcbiAgICAgICAgICAgICAgICBuZWEgPSBbaGVhZF07XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgb3V0LnB1c2gobmVhKTtcbiAgICAgICAgcmV0dXJuIG91dDtcbiAgICB9O1xufVxuLyoqXG4gKiBTcGxpdHMgYW4gYXJyYXkgaW50byBzdWItbm9uLWVtcHR5LWFycmF5cyBzdG9yZWQgaW4gYW4gb2JqZWN0LCBiYXNlZCBvbiB0aGUgcmVzdWx0IG9mIGNhbGxpbmcgYSBgc3RyaW5nYC1yZXR1cm5pbmdcbiAqIGZ1bmN0aW9uIG9uIGVhY2ggZWxlbWVudCwgYW5kIGdyb3VwaW5nIHRoZSByZXN1bHRzIGFjY29yZGluZyB0byB2YWx1ZXMgcmV0dXJuZWRcbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgZ3JvdXBCeSB9IGZyb20gJ2ZwLXRzL1JlYWRvbmx5Tm9uRW1wdHlBcnJheSdcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKGdyb3VwQnkoKHM6IHN0cmluZykgPT4gU3RyaW5nKHMubGVuZ3RoKSkoWydhJywgJ2InLCAnYWInXSksIHtcbiAqICAgJzEnOiBbJ2EnLCAnYiddLFxuICogICAnMic6IFsnYWInXVxuICogfSlcbiAqXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBncm91cEJ5ID0gZnVuY3Rpb24gKGYpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIHZhciBvdXQgPSB7fTtcbiAgICAgICAgZm9yICh2YXIgX2kgPSAwLCBhc18xID0gYXM7IF9pIDwgYXNfMS5sZW5ndGg7IF9pKyspIHtcbiAgICAgICAgICAgIHZhciBhID0gYXNfMVtfaV07XG4gICAgICAgICAgICB2YXIgayA9IGYoYSk7XG4gICAgICAgICAgICBpZiAoXy5oYXMuY2FsbChvdXQsIGspKSB7XG4gICAgICAgICAgICAgICAgb3V0W2tdLnB1c2goYSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBvdXRba10gPSBbYV07XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG91dDtcbiAgICB9O1xufTtcbi8qKlxuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgc29ydCA9IGZ1bmN0aW9uIChPKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykge1xuICAgICAgICByZXR1cm4gYXMubGVuZ3RoID09PSAxID8gYXMgOiBhcy5zbGljZSgpLnNvcnQoTy5jb21wYXJlKTtcbiAgICB9O1xufTtcbi8qKlxuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgdXBkYXRlQXQgPSBmdW5jdGlvbiAoaSwgYSkge1xuICAgIHJldHVybiBtb2RpZnlBdChpLCBmdW5jdGlvbiAoKSB7IHJldHVybiBhOyB9KTtcbn07XG4vKipcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIG1vZGlmeUF0ID0gZnVuY3Rpb24gKGksIGYpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIHJldHVybiBpc091dE9mQm91bmQoaSwgYXMpID8gXy5ub25lIDogXy5zb21lKHVuc2FmZVVwZGF0ZUF0KGksIGYoYXNbaV0pLCBhcykpO1xuICAgIH07XG59O1xuLyoqXG4gKiBAc2luY2UgMi41LjFcbiAqL1xuZXhwb3J0IHZhciB6aXBXaXRoID0gZnVuY3Rpb24gKGFzLCBicywgZikge1xuICAgIHZhciBjcyA9IFtmKGFzWzBdLCBic1swXSldO1xuICAgIHZhciBsZW4gPSBNYXRoLm1pbihhcy5sZW5ndGgsIGJzLmxlbmd0aCk7XG4gICAgZm9yICh2YXIgaSA9IDE7IGkgPCBsZW47IGkrKykge1xuICAgICAgICBjc1tpXSA9IGYoYXNbaV0sIGJzW2ldKTtcbiAgICB9XG4gICAgcmV0dXJuIGNzO1xufTtcbmV4cG9ydCBmdW5jdGlvbiB6aXAoYXMsIGJzKSB7XG4gICAgaWYgKGJzID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIChicykgeyByZXR1cm4gemlwKGJzLCBhcyk7IH07XG4gICAgfVxuICAgIHJldHVybiB6aXBXaXRoKGFzLCBicywgZnVuY3Rpb24gKGEsIGIpIHsgcmV0dXJuIFthLCBiXTsgfSk7XG59XG4vKipcbiAqIEBzaW5jZSAyLjUuMVxuICovXG5leHBvcnQgdmFyIHVuemlwID0gZnVuY3Rpb24gKGFicykge1xuICAgIHZhciBmYSA9IFthYnNbMF1bMF1dO1xuICAgIHZhciBmYiA9IFthYnNbMF1bMV1dO1xuICAgIGZvciAodmFyIGkgPSAxOyBpIDwgYWJzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIGZhW2ldID0gYWJzW2ldWzBdO1xuICAgICAgICBmYltpXSA9IGFic1tpXVsxXTtcbiAgICB9XG4gICAgcmV0dXJuIFtmYSwgZmJdO1xufTtcbi8qKlxuICogUHJlcGVuZCBhbiBlbGVtZW50IHRvIGV2ZXJ5IG1lbWJlciBvZiBhIGBSZWFkb25seU5vbkVtcHR5QXJyYXlgLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBwcmVwZW5kQWxsIH0gZnJvbSAnZnAtdHMvUmVhZG9ubHlOb25FbXB0eUFycmF5J1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwocHJlcGVuZEFsbCg5KShbMSwgMiwgMywgNF0pLCBbOSwgMSwgOSwgMiwgOSwgMywgOSwgNF0pXG4gKlxuICogQHNpbmNlIDIuMTAuMFxuICovXG5leHBvcnQgdmFyIHByZXBlbmRBbGwgPSBmdW5jdGlvbiAobWlkZGxlKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykge1xuICAgICAgICB2YXIgb3V0ID0gW21pZGRsZSwgYXNbMF1dO1xuICAgICAgICBmb3IgKHZhciBpID0gMTsgaSA8IGFzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICBvdXQucHVzaChtaWRkbGUsIGFzW2ldKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gb3V0O1xuICAgIH07XG59O1xuLyoqXG4gKiBQbGFjZXMgYW4gZWxlbWVudCBpbiBiZXR3ZWVuIG1lbWJlcnMgb2YgYSBgUmVhZG9ubHlOb25FbXB0eUFycmF5YC5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgaW50ZXJzcGVyc2UgfSBmcm9tICdmcC10cy9SZWFkb25seU5vbkVtcHR5QXJyYXknXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChpbnRlcnNwZXJzZSg5KShbMSwgMiwgMywgNF0pLCBbMSwgOSwgMiwgOSwgMywgOSwgNF0pXG4gKlxuICogQHNpbmNlIDIuOS4wXG4gKi9cbmV4cG9ydCB2YXIgaW50ZXJzcGVyc2UgPSBmdW5jdGlvbiAobWlkZGxlKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykge1xuICAgICAgICB2YXIgcmVzdCA9IHRhaWwoYXMpO1xuICAgICAgICByZXR1cm4gaXNOb25FbXB0eShyZXN0KSA/IHBpcGUocmVzdCwgcHJlcGVuZEFsbChtaWRkbGUpLCBwcmVwZW5kKGhlYWQoYXMpKSkgOiBhcztcbiAgICB9O1xufTtcbi8qKlxuICogQGNhdGVnb3J5IHNlcXVlbmNpbmdcbiAqIEBzaW5jZSAyLjEwLjBcbiAqL1xuZXhwb3J0IHZhciBjaGFpbldpdGhJbmRleCA9IGZ1bmN0aW9uIChmKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykge1xuICAgICAgICB2YXIgb3V0ID0gXy5mcm9tUmVhZG9ubHlOb25FbXB0eUFycmF5KGYoMCwgaGVhZChhcykpKTtcbiAgICAgICAgZm9yICh2YXIgaSA9IDE7IGkgPCBhcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgb3V0LnB1c2guYXBwbHkob3V0LCBmKGksIGFzW2ldKSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG91dDtcbiAgICB9O1xufTtcbi8qKlxuICogQSB1c2VmdWwgcmVjdXJzaW9uIHBhdHRlcm4gZm9yIHByb2Nlc3NpbmcgYSBgUmVhZG9ubHlOb25FbXB0eUFycmF5YCB0byBwcm9kdWNlIGEgbmV3IGBSZWFkb25seU5vbkVtcHR5QXJyYXlgLCBvZnRlbiB1c2VkIGZvciBcImNob3BwaW5nXCIgdXAgdGhlIGlucHV0XG4gKiBgUmVhZG9ubHlOb25FbXB0eUFycmF5YC4gVHlwaWNhbGx5IGBjaG9wYCBpcyBjYWxsZWQgd2l0aCBzb21lIGZ1bmN0aW9uIHRoYXQgd2lsbCBjb25zdW1lIGFuIGluaXRpYWwgcHJlZml4IG9mIHRoZSBgUmVhZG9ubHlOb25FbXB0eUFycmF5YCBhbmQgcHJvZHVjZSBhXG4gKiB2YWx1ZSBhbmQgdGhlIHRhaWwgb2YgdGhlIGBSZWFkb25seU5vbkVtcHR5QXJyYXlgLlxuICpcbiAqIEBzaW5jZSAyLjEwLjBcbiAqL1xuZXhwb3J0IHZhciBjaG9wID0gZnVuY3Rpb24gKGYpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIHZhciBfYSA9IGYoYXMpLCBiID0gX2FbMF0sIHJlc3QgPSBfYVsxXTtcbiAgICAgICAgdmFyIG91dCA9IFtiXTtcbiAgICAgICAgdmFyIG5leHQgPSByZXN0O1xuICAgICAgICB3aGlsZSAoaXNOb25FbXB0eShuZXh0KSkge1xuICAgICAgICAgICAgdmFyIF9iID0gZihuZXh0KSwgYl8xID0gX2JbMF0sIHJlc3RfMiA9IF9iWzFdO1xuICAgICAgICAgICAgb3V0LnB1c2goYl8xKTtcbiAgICAgICAgICAgIG5leHQgPSByZXN0XzI7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG91dDtcbiAgICB9O1xufTtcbi8qKlxuICogU3BsaXRzIGEgYFJlYWRvbmx5Tm9uRW1wdHlBcnJheWAgaW50byB0d28gcGllY2VzLCB0aGUgZmlyc3QgcGllY2UgaGFzIG1heCBgbmAgZWxlbWVudHMuXG4gKlxuICogQHNpbmNlIDIuMTAuMFxuICovXG5leHBvcnQgdmFyIHNwbGl0QXQgPSBmdW5jdGlvbiAobikge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgdmFyIG0gPSBNYXRoLm1heCgxLCBuKTtcbiAgICAgICAgcmV0dXJuIG0gPj0gYXMubGVuZ3RoID8gW2FzLCBlbXB0eV0gOiBbcGlwZShhcy5zbGljZSgxLCBtKSwgcHJlcGVuZChoZWFkKGFzKSkpLCBhcy5zbGljZShtKV07XG4gICAgfTtcbn07XG4vKipcbiAqIFNwbGl0cyBhIGBSZWFkb25seU5vbkVtcHR5QXJyYXlgIGludG8gbGVuZ3RoLWBuYCBwaWVjZXMuIFRoZSBsYXN0IHBpZWNlIHdpbGwgYmUgc2hvcnRlciBpZiBgbmAgZG9lcyBub3QgZXZlbmx5IGRpdmlkZSB0aGUgbGVuZ3RoIG9mXG4gKiB0aGUgYFJlYWRvbmx5Tm9uRW1wdHlBcnJheWAuXG4gKlxuICogQHNpbmNlIDIuMTAuMFxuICovXG5leHBvcnQgdmFyIGNodW5rc09mID0gZnVuY3Rpb24gKG4pIHsgcmV0dXJuIGNob3Aoc3BsaXRBdChuKSk7IH07XG52YXIgX21hcCA9IGZ1bmN0aW9uIChmYSwgZikgeyByZXR1cm4gcGlwZShmYSwgbWFwKGYpKTsgfTtcbi8qIGlzdGFuYnVsIGlnbm9yZSBuZXh0ICovXG52YXIgX21hcFdpdGhJbmRleCA9IGZ1bmN0aW9uIChmYSwgZikgeyByZXR1cm4gcGlwZShmYSwgbWFwV2l0aEluZGV4KGYpKTsgfTtcbnZhciBfYXAgPSBmdW5jdGlvbiAoZmFiLCBmYSkgeyByZXR1cm4gcGlwZShmYWIsIGFwKGZhKSk7IH07XG4vKiBpc3RhbmJ1bCBpZ25vcmUgbmV4dCAqL1xudmFyIF9leHRlbmQgPSBmdW5jdGlvbiAod2EsIGYpIHsgcmV0dXJuIHBpcGUod2EsIGV4dGVuZChmKSk7IH07XG4vKiBpc3RhbmJ1bCBpZ25vcmUgbmV4dCAqL1xudmFyIF9yZWR1Y2UgPSBmdW5jdGlvbiAoZmEsIGIsIGYpIHsgcmV0dXJuIHBpcGUoZmEsIHJlZHVjZShiLCBmKSk7IH07XG4vKiBpc3RhbmJ1bCBpZ25vcmUgbmV4dCAqL1xudmFyIF9mb2xkTWFwID0gZnVuY3Rpb24gKE0pIHtcbiAgICB2YXIgZm9sZE1hcE0gPSBmb2xkTWFwKE0pO1xuICAgIHJldHVybiBmdW5jdGlvbiAoZmEsIGYpIHsgcmV0dXJuIHBpcGUoZmEsIGZvbGRNYXBNKGYpKTsgfTtcbn07XG4vKiBpc3RhbmJ1bCBpZ25vcmUgbmV4dCAqL1xudmFyIF9yZWR1Y2VSaWdodCA9IGZ1bmN0aW9uIChmYSwgYiwgZikgeyByZXR1cm4gcGlwZShmYSwgcmVkdWNlUmlnaHQoYiwgZikpOyB9O1xuLyogaXN0YW5idWwgaWdub3JlIG5leHQgKi9cbnZhciBfdHJhdmVyc2UgPSBmdW5jdGlvbiAoRikge1xuICAgIHZhciB0cmF2ZXJzZUYgPSB0cmF2ZXJzZShGKTtcbiAgICByZXR1cm4gZnVuY3Rpb24gKHRhLCBmKSB7IHJldHVybiBwaXBlKHRhLCB0cmF2ZXJzZUYoZikpOyB9O1xufTtcbi8qIGlzdGFuYnVsIGlnbm9yZSBuZXh0ICovXG52YXIgX2FsdCA9IGZ1bmN0aW9uIChmYSwgdGhhdCkgeyByZXR1cm4gcGlwZShmYSwgYWx0KHRoYXQpKTsgfTtcbi8qIGlzdGFuYnVsIGlnbm9yZSBuZXh0ICovXG52YXIgX3JlZHVjZVdpdGhJbmRleCA9IGZ1bmN0aW9uIChmYSwgYiwgZikge1xuICAgIHJldHVybiBwaXBlKGZhLCByZWR1Y2VXaXRoSW5kZXgoYiwgZikpO1xufTtcbi8qIGlzdGFuYnVsIGlnbm9yZSBuZXh0ICovXG52YXIgX2ZvbGRNYXBXaXRoSW5kZXggPSBmdW5jdGlvbiAoTSkge1xuICAgIHZhciBmb2xkTWFwV2l0aEluZGV4TSA9IGZvbGRNYXBXaXRoSW5kZXgoTSk7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChmYSwgZikgeyByZXR1cm4gcGlwZShmYSwgZm9sZE1hcFdpdGhJbmRleE0oZikpOyB9O1xufTtcbi8qIGlzdGFuYnVsIGlnbm9yZSBuZXh0ICovXG52YXIgX3JlZHVjZVJpZ2h0V2l0aEluZGV4ID0gZnVuY3Rpb24gKGZhLCBiLCBmKSB7XG4gICAgcmV0dXJuIHBpcGUoZmEsIHJlZHVjZVJpZ2h0V2l0aEluZGV4KGIsIGYpKTtcbn07XG4vKiBpc3RhbmJ1bCBpZ25vcmUgbmV4dCAqL1xudmFyIF90cmF2ZXJzZVdpdGhJbmRleCA9IGZ1bmN0aW9uIChGKSB7XG4gICAgdmFyIHRyYXZlcnNlV2l0aEluZGV4RiA9IHRyYXZlcnNlV2l0aEluZGV4KEYpO1xuICAgIHJldHVybiBmdW5jdGlvbiAodGEsIGYpIHsgcmV0dXJuIHBpcGUodGEsIHRyYXZlcnNlV2l0aEluZGV4RihmKSk7IH07XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgY29uc3RydWN0b3JzXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBvZiA9IF8uc2luZ2xldG9uO1xuLyoqXG4gKiBMZXNzIHN0cmljdCB2ZXJzaW9uIG9mIFtgYWx0YF0oI2FsdCkuXG4gKlxuICogVGhlIGBXYCBzdWZmaXggKHNob3J0IGZvciAqKlcqKmlkZW5pbmcpIG1lYW5zIHRoYXQgdGhlIHJldHVybiB0eXBlcyB3aWxsIGJlIG1lcmdlZC5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0ICogYXMgUk5FQSBmcm9tICdmcC10cy9SZWFkb25seU5vbkVtcHR5QXJyYXknXG4gKiBpbXBvcnQgeyBwaXBlIH0gZnJvbSAnZnAtdHMvZnVuY3Rpb24nXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChcbiAqICAgcGlwZShcbiAqICAgICBbMSwgMiwgM10gYXMgUk5FQS5SZWFkb25seU5vbkVtcHR5QXJyYXk8bnVtYmVyPixcbiAqICAgICBSTkVBLmFsdFcoKCkgPT4gWydhJywgJ2InXSlcbiAqICAgKSxcbiAqICAgWzEsIDIsIDMsICdhJywgJ2InXVxuICogKVxuICpcbiAqIEBjYXRlZ29yeSBlcnJvciBoYW5kbGluZ1xuICogQHNpbmNlIDIuOS4wXG4gKi9cbmV4cG9ydCB2YXIgYWx0VyA9IGZ1bmN0aW9uICh0aGF0KSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykge1xuICAgICAgICByZXR1cm4gcGlwZShhcywgY29uY2F0Vyh0aGF0KCkpKTtcbiAgICB9O1xufTtcbi8qKlxuICogSWRlbnRpZmllcyBhbiBhc3NvY2lhdGl2ZSBvcGVyYXRpb24gb24gYSB0eXBlIGNvbnN0cnVjdG9yLiBJdCBpcyBzaW1pbGFyIHRvIGBTZW1pZ3JvdXBgLCBleGNlcHQgdGhhdCBpdCBhcHBsaWVzIHRvXG4gKiB0eXBlcyBvZiBraW5kIGAqIC0+ICpgLlxuICpcbiAqIEluIGNhc2Ugb2YgYFJlYWRvbmx5Tm9uRW1wdHlBcnJheWAgY29uY2F0ZW5hdGVzIHRoZSBpbnB1dHMgaW50byBhIHNpbmdsZSBhcnJheS5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0ICogYXMgUk5FQSBmcm9tICdmcC10cy9SZWFkb25seU5vbkVtcHR5QXJyYXknXG4gKiBpbXBvcnQgeyBwaXBlIH0gZnJvbSAnZnAtdHMvZnVuY3Rpb24nXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChcbiAqICAgcGlwZShcbiAqICAgICBbMSwgMiwgM10sXG4gKiAgICAgUk5FQS5hbHQoKCkgPT4gWzQsIDVdKVxuICogICApLFxuICogICBbMSwgMiwgMywgNCwgNV1cbiAqIClcbiAqXG4gKiBAY2F0ZWdvcnkgZXJyb3IgaGFuZGxpbmdcbiAqIEBzaW5jZSAyLjYuMlxuICovXG5leHBvcnQgdmFyIGFsdCA9IGFsdFc7XG4vKipcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIGFwID0gZnVuY3Rpb24gKGFzKSB7IHJldHVybiBmbGF0TWFwKGZ1bmN0aW9uIChmKSB7IHJldHVybiBwaXBlKGFzLCBtYXAoZikpOyB9KTsgfTtcbi8qKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCAqIGFzIFJORUEgZnJvbSAnZnAtdHMvUmVhZG9ubHlOb25FbXB0eUFycmF5J1xuICogaW1wb3J0IHsgcGlwZSB9IGZyb20gJ2ZwLXRzL2Z1bmN0aW9uJ1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoXG4gKiAgIHBpcGUoXG4gKiAgICAgWzEsIDIsIDNdLFxuICogICAgIFJORUEuZmxhdE1hcCgobikgPT4gW2BhJHtufWAsIGBiJHtufWBdKVxuICogICApLFxuICogICBbJ2ExJywgJ2IxJywgJ2EyJywgJ2IyJywgJ2EzJywgJ2IzJ11cbiAqIClcbiAqXG4gKiBAY2F0ZWdvcnkgc2VxdWVuY2luZ1xuICogQHNpbmNlIDIuMTQuMFxuICovXG5leHBvcnQgdmFyIGZsYXRNYXAgPSAvKiNfX1BVUkVfXyovIGR1YWwoMiwgZnVuY3Rpb24gKG1hLCBmKSB7XG4gICAgcmV0dXJuIHBpcGUobWEsIGNoYWluV2l0aEluZGV4KGZ1bmN0aW9uIChpLCBhKSB7IHJldHVybiBmKGEsIGkpOyB9KSk7XG59KTtcbi8qKlxuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgZXh0ZW5kID0gZnVuY3Rpb24gKGYpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIHZhciBuZXh0ID0gdGFpbChhcyk7XG4gICAgICAgIHZhciBvdXQgPSBbZihhcyldO1xuICAgICAgICB3aGlsZSAoaXNOb25FbXB0eShuZXh0KSkge1xuICAgICAgICAgICAgb3V0LnB1c2goZihuZXh0KSk7XG4gICAgICAgICAgICBuZXh0ID0gdGFpbChuZXh0KTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gb3V0O1xuICAgIH07XG59O1xuLyoqXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBkdXBsaWNhdGUgPSBcbi8qI19fUFVSRV9fKi8gZXh0ZW5kKGlkZW50aXR5KTtcbi8qKlxuICogQGNhdGVnb3J5IHNlcXVlbmNpbmdcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIGZsYXR0ZW4gPSBcbi8qI19fUFVSRV9fKi8gZmxhdE1hcChpZGVudGl0eSk7XG4vKipcbiAqIGBtYXBgIGNhbiBiZSB1c2VkIHRvIHR1cm4gZnVuY3Rpb25zIGAoYTogQSkgPT4gQmAgaW50byBmdW5jdGlvbnMgYChmYTogRjxBPikgPT4gRjxCPmAgd2hvc2UgYXJndW1lbnQgYW5kIHJldHVybiB0eXBlc1xuICogdXNlIHRoZSB0eXBlIGNvbnN0cnVjdG9yIGBGYCB0byByZXByZXNlbnQgc29tZSBjb21wdXRhdGlvbmFsIGNvbnRleHQuXG4gKlxuICogQGNhdGVnb3J5IG1hcHBpbmdcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIG1hcCA9IGZ1bmN0aW9uIChmKSB7XG4gICAgcmV0dXJuIG1hcFdpdGhJbmRleChmdW5jdGlvbiAoXywgYSkgeyByZXR1cm4gZihhKTsgfSk7XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgbWFwcGluZ1xuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgbWFwV2l0aEluZGV4ID0gZnVuY3Rpb24gKGYpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIHZhciBvdXQgPSBbZigwLCBoZWFkKGFzKSldO1xuICAgICAgICBmb3IgKHZhciBpID0gMTsgaSA8IGFzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICBvdXQucHVzaChmKGksIGFzW2ldKSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG91dDtcbiAgICB9O1xufTtcbi8qKlxuICogQGNhdGVnb3J5IGZvbGRpbmdcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIHJlZHVjZSA9IGZ1bmN0aW9uIChiLCBmKSB7XG4gICAgcmV0dXJuIHJlZHVjZVdpdGhJbmRleChiLCBmdW5jdGlvbiAoXywgYiwgYSkgeyByZXR1cm4gZihiLCBhKTsgfSk7XG59O1xuLyoqXG4gKiAqKk5vdGUqKi4gVGhlIGNvbnN0cmFpbnQgaXMgcmVsYXhlZDogYSBgU2VtaWdyb3VwYCBpbnN0ZWFkIG9mIGEgYE1vbm9pZGAuXG4gKlxuICogQGNhdGVnb3J5IGZvbGRpbmdcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIGZvbGRNYXAgPSBmdW5jdGlvbiAoUykge1xuICAgIHJldHVybiBmdW5jdGlvbiAoZikge1xuICAgICAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgICAgICByZXR1cm4gYXMuc2xpY2UoMSkucmVkdWNlKGZ1bmN0aW9uIChzLCBhKSB7IHJldHVybiBTLmNvbmNhdChzLCBmKGEpKTsgfSwgZihhc1swXSkpO1xuICAgICAgICB9O1xuICAgIH07XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgZm9sZGluZ1xuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgcmVkdWNlUmlnaHQgPSBmdW5jdGlvbiAoYiwgZikge1xuICAgIHJldHVybiByZWR1Y2VSaWdodFdpdGhJbmRleChiLCBmdW5jdGlvbiAoXywgYiwgYSkgeyByZXR1cm4gZihiLCBhKTsgfSk7XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgZm9sZGluZ1xuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgcmVkdWNlV2l0aEluZGV4ID0gZnVuY3Rpb24gKGIsIGYpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIHJldHVybiBhcy5yZWR1Y2UoZnVuY3Rpb24gKGIsIGEsIGkpIHsgcmV0dXJuIGYoaSwgYiwgYSk7IH0sIGIpO1xuICAgIH07XG59O1xuLyoqXG4gKiAqKk5vdGUqKi4gVGhlIGNvbnN0cmFpbnQgaXMgcmVsYXhlZDogYSBgU2VtaWdyb3VwYCBpbnN0ZWFkIG9mIGEgYE1vbm9pZGAuXG4gKlxuICogQGNhdGVnb3J5IGZvbGRpbmdcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIGZvbGRNYXBXaXRoSW5kZXggPSBmdW5jdGlvbiAoUykge1xuICAgIHJldHVybiBmdW5jdGlvbiAoZikge1xuICAgICAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgICAgICByZXR1cm4gYXMuc2xpY2UoMSkucmVkdWNlKGZ1bmN0aW9uIChzLCBhLCBpKSB7IHJldHVybiBTLmNvbmNhdChzLCBmKGkgKyAxLCBhKSk7IH0sIGYoMCwgYXNbMF0pKTtcbiAgICAgICAgfTtcbiAgICB9O1xufTtcbi8qKlxuICogQGNhdGVnb3J5IGZvbGRpbmdcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIHJlZHVjZVJpZ2h0V2l0aEluZGV4ID0gZnVuY3Rpb24gKGIsIGYpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIHJldHVybiBhcy5yZWR1Y2VSaWdodChmdW5jdGlvbiAoYiwgYSwgaSkgeyByZXR1cm4gZihpLCBhLCBiKTsgfSwgYik7XG4gICAgfTtcbn07XG4vKipcbiAqIEBjYXRlZ29yeSB0cmF2ZXJzaW5nXG4gKiBAc2luY2UgMi42LjNcbiAqL1xuZXhwb3J0IHZhciB0cmF2ZXJzZSA9IGZ1bmN0aW9uIChGKSB7XG4gICAgdmFyIHRyYXZlcnNlV2l0aEluZGV4RiA9IHRyYXZlcnNlV2l0aEluZGV4KEYpO1xuICAgIHJldHVybiBmdW5jdGlvbiAoZikgeyByZXR1cm4gdHJhdmVyc2VXaXRoSW5kZXhGKGZ1bmN0aW9uIChfLCBhKSB7IHJldHVybiBmKGEpOyB9KTsgfTtcbn07XG4vKipcbiAqIEBjYXRlZ29yeSB0cmF2ZXJzaW5nXG4gKiBAc2luY2UgMi42LjNcbiAqL1xuZXhwb3J0IHZhciBzZXF1ZW5jZSA9IGZ1bmN0aW9uIChGKSB7IHJldHVybiB0cmF2ZXJzZVdpdGhJbmRleChGKShTSyk7IH07XG4vKipcbiAqIEBjYXRlZ29yeSBzZXF1ZW5jaW5nXG4gKiBAc2luY2UgMi42LjNcbiAqL1xuZXhwb3J0IHZhciB0cmF2ZXJzZVdpdGhJbmRleCA9IGZ1bmN0aW9uIChGKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChmKSB7XG4gICAgICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgICAgIHZhciBvdXQgPSBGLm1hcChmKDAsIGhlYWQoYXMpKSwgb2YpO1xuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDE7IGkgPCBhcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgIG91dCA9IEYuYXAoRi5tYXAob3V0LCBmdW5jdGlvbiAoYnMpIHsgcmV0dXJuIGZ1bmN0aW9uIChiKSB7IHJldHVybiBwaXBlKGJzLCBhcHBlbmQoYikpOyB9OyB9KSwgZihpLCBhc1tpXSkpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIG91dDtcbiAgICAgICAgfTtcbiAgICB9O1xufTtcbi8qKlxuICogQGNhdGVnb3J5IENvbW9uYWRcbiAqIEBzaW5jZSAyLjYuM1xuICovXG5leHBvcnQgdmFyIGV4dHJhY3QgPSBfLmhlYWQ7XG4vKipcbiAqIEBjYXRlZ29yeSB0eXBlIGxhbWJkYXNcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIFVSSSA9ICdSZWFkb25seU5vbkVtcHR5QXJyYXknO1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBnZXRTaG93ID0gZnVuY3Rpb24gKFMpIHsgcmV0dXJuICh7XG4gICAgc2hvdzogZnVuY3Rpb24gKGFzKSB7IHJldHVybiBcIltcIi5jb25jYXQoYXMubWFwKFMuc2hvdykuam9pbignLCAnKSwgXCJdXCIpOyB9XG59KTsgfTtcbi8qKlxuICogQnVpbGRzIGEgYFNlbWlncm91cGAgaW5zdGFuY2UgZm9yIGBSZWFkb25seU5vbkVtcHR5QXJyYXlgXG4gKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgZ2V0U2VtaWdyb3VwID0gZnVuY3Rpb24gKCkgeyByZXR1cm4gKHtcbiAgICBjb25jYXQ6IGNvbmNhdFxufSk7IH07XG4vKipcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBnZXRFcSB9IGZyb20gJ2ZwLXRzL1JlYWRvbmx5Tm9uRW1wdHlBcnJheSdcbiAqIGltcG9ydCAqIGFzIE4gZnJvbSAnZnAtdHMvbnVtYmVyJ1xuICpcbiAqIGNvbnN0IEUgPSBnZXRFcShOLkVxKVxuICogYXNzZXJ0LnN0cmljdEVxdWFsKEUuZXF1YWxzKFsxLCAyXSwgWzEsIDJdKSwgdHJ1ZSlcbiAqIGFzc2VydC5zdHJpY3RFcXVhbChFLmVxdWFscyhbMSwgMl0sIFsxLCAzXSksIGZhbHNlKVxuICpcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIGdldEVxID0gZnVuY3Rpb24gKEUpIHtcbiAgICByZXR1cm4gZnJvbUVxdWFscyhmdW5jdGlvbiAoeHMsIHlzKSB7IHJldHVybiB4cy5sZW5ndGggPT09IHlzLmxlbmd0aCAmJiB4cy5ldmVyeShmdW5jdGlvbiAoeCwgaSkgeyByZXR1cm4gRS5lcXVhbHMoeCwgeXNbaV0pOyB9KTsgfSk7XG59O1xuLyoqXG4gKiBAc2luY2UgMi4xMS4wXG4gKi9cbmV4cG9ydCB2YXIgZ2V0VW5pb25TZW1pZ3JvdXAgPSBmdW5jdGlvbiAoRSkge1xuICAgIHZhciB1bmlvbkUgPSB1bmlvbihFKTtcbiAgICByZXR1cm4ge1xuICAgICAgICBjb25jYXQ6IGZ1bmN0aW9uIChmaXJzdCwgc2Vjb25kKSB7IHJldHVybiB1bmlvbkUoc2Vjb25kKShmaXJzdCk7IH1cbiAgICB9O1xufTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuNy4wXG4gKi9cbmV4cG9ydCB2YXIgRnVuY3RvciA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICBtYXA6IF9tYXBcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBtYXBwaW5nXG4gKiBAc2luY2UgMi4xMC4wXG4gKi9cbmV4cG9ydCB2YXIgZmxhcCA9IC8qI19fUFVSRV9fKi8gZmxhcF8oRnVuY3Rvcik7XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjEwLjBcbiAqL1xuZXhwb3J0IHZhciBQb2ludGVkID0ge1xuICAgIFVSSTogVVJJLFxuICAgIG9mOiBvZlxufTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuNy4wXG4gKi9cbmV4cG9ydCB2YXIgRnVuY3RvcldpdGhJbmRleCA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICBtYXA6IF9tYXAsXG4gICAgbWFwV2l0aEluZGV4OiBfbWFwV2l0aEluZGV4XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi4xMC4wXG4gKi9cbmV4cG9ydCB2YXIgQXBwbHkgPSB7XG4gICAgVVJJOiBVUkksXG4gICAgbWFwOiBfbWFwLFxuICAgIGFwOiBfYXBcbn07XG4vKipcbiAqIENvbWJpbmUgdHdvIGVmZmVjdGZ1bCBhY3Rpb25zLCBrZWVwaW5nIG9ubHkgdGhlIHJlc3VsdCBvZiB0aGUgZmlyc3QuXG4gKlxuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgYXBGaXJzdCA9IC8qI19fUFVSRV9fKi8gYXBGaXJzdF8oQXBwbHkpO1xuLyoqXG4gKiBDb21iaW5lIHR3byBlZmZlY3RmdWwgYWN0aW9ucywga2VlcGluZyBvbmx5IHRoZSByZXN1bHQgb2YgdGhlIHNlY29uZC5cbiAqXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBhcFNlY29uZCA9IC8qI19fUFVSRV9fKi8gYXBTZWNvbmRfKEFwcGx5KTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuNy4wXG4gKi9cbmV4cG9ydCB2YXIgQXBwbGljYXRpdmUgPSB7XG4gICAgVVJJOiBVUkksXG4gICAgbWFwOiBfbWFwLFxuICAgIGFwOiBfYXAsXG4gICAgb2Y6IG9mXG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi4xMC4wXG4gKi9cbmV4cG9ydCB2YXIgQ2hhaW4gPSB7XG4gICAgVVJJOiBVUkksXG4gICAgbWFwOiBfbWFwLFxuICAgIGFwOiBfYXAsXG4gICAgY2hhaW46IGZsYXRNYXBcbn07XG4vKipcbiAqIENvbXBvc2VzIGNvbXB1dGF0aW9ucyBpbiBzZXF1ZW5jZSwgdXNpbmcgdGhlIHJldHVybiB2YWx1ZSBvZiBvbmUgY29tcHV0YXRpb24gdG8gZGV0ZXJtaW5lIHRoZSBuZXh0IGNvbXB1dGF0aW9uIGFuZFxuICoga2VlcGluZyBvbmx5IHRoZSByZXN1bHQgb2YgdGhlIGZpcnN0LlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgKiBhcyBSQSBmcm9tICdmcC10cy9SZWFkb25seUFycmF5J1xuICogaW1wb3J0IHsgcGlwZSB9IGZyb20gJ2ZwLXRzL2Z1bmN0aW9uJ1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoXG4gKiAgIHBpcGUoXG4gKiAgICAgWzEsIDIsIDNdLFxuICogICAgIFJBLmNoYWluRmlyc3QoKCkgPT4gWydhJywgJ2InXSlcbiAqICAgKSxcbiAqICAgWzEsIDEsIDIsIDIsIDMsIDNdXG4gKiApXG4gKlxuICogQGNhdGVnb3J5IHNlcXVlbmNpbmdcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIGNoYWluRmlyc3QgPSAvKiNfX1BVUkVfXyovIGNoYWluRmlyc3RfKENoYWluKTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuNy4wXG4gKi9cbmV4cG9ydCB2YXIgTW9uYWQgPSB7XG4gICAgVVJJOiBVUkksXG4gICAgbWFwOiBfbWFwLFxuICAgIGFwOiBfYXAsXG4gICAgb2Y6IG9mLFxuICAgIGNoYWluOiBmbGF0TWFwXG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi43LjBcbiAqL1xuZXhwb3J0IHZhciBGb2xkYWJsZSA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICByZWR1Y2U6IF9yZWR1Y2UsXG4gICAgZm9sZE1hcDogX2ZvbGRNYXAsXG4gICAgcmVkdWNlUmlnaHQ6IF9yZWR1Y2VSaWdodFxufTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuNy4wXG4gKi9cbmV4cG9ydCB2YXIgRm9sZGFibGVXaXRoSW5kZXggPSB7XG4gICAgVVJJOiBVUkksXG4gICAgcmVkdWNlOiBfcmVkdWNlLFxuICAgIGZvbGRNYXA6IF9mb2xkTWFwLFxuICAgIHJlZHVjZVJpZ2h0OiBfcmVkdWNlUmlnaHQsXG4gICAgcmVkdWNlV2l0aEluZGV4OiBfcmVkdWNlV2l0aEluZGV4LFxuICAgIGZvbGRNYXBXaXRoSW5kZXg6IF9mb2xkTWFwV2l0aEluZGV4LFxuICAgIHJlZHVjZVJpZ2h0V2l0aEluZGV4OiBfcmVkdWNlUmlnaHRXaXRoSW5kZXhcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjcuMFxuICovXG5leHBvcnQgdmFyIFRyYXZlcnNhYmxlID0ge1xuICAgIFVSSTogVVJJLFxuICAgIG1hcDogX21hcCxcbiAgICByZWR1Y2U6IF9yZWR1Y2UsXG4gICAgZm9sZE1hcDogX2ZvbGRNYXAsXG4gICAgcmVkdWNlUmlnaHQ6IF9yZWR1Y2VSaWdodCxcbiAgICB0cmF2ZXJzZTogX3RyYXZlcnNlLFxuICAgIHNlcXVlbmNlOiBzZXF1ZW5jZVxufTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuNy4wXG4gKi9cbmV4cG9ydCB2YXIgVHJhdmVyc2FibGVXaXRoSW5kZXggPSB7XG4gICAgVVJJOiBVUkksXG4gICAgbWFwOiBfbWFwLFxuICAgIG1hcFdpdGhJbmRleDogX21hcFdpdGhJbmRleCxcbiAgICByZWR1Y2U6IF9yZWR1Y2UsXG4gICAgZm9sZE1hcDogX2ZvbGRNYXAsXG4gICAgcmVkdWNlUmlnaHQ6IF9yZWR1Y2VSaWdodCxcbiAgICB0cmF2ZXJzZTogX3RyYXZlcnNlLFxuICAgIHNlcXVlbmNlOiBzZXF1ZW5jZSxcbiAgICByZWR1Y2VXaXRoSW5kZXg6IF9yZWR1Y2VXaXRoSW5kZXgsXG4gICAgZm9sZE1hcFdpdGhJbmRleDogX2ZvbGRNYXBXaXRoSW5kZXgsXG4gICAgcmVkdWNlUmlnaHRXaXRoSW5kZXg6IF9yZWR1Y2VSaWdodFdpdGhJbmRleCxcbiAgICB0cmF2ZXJzZVdpdGhJbmRleDogX3RyYXZlcnNlV2l0aEluZGV4XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi43LjBcbiAqL1xuZXhwb3J0IHZhciBBbHQgPSB7XG4gICAgVVJJOiBVUkksXG4gICAgbWFwOiBfbWFwLFxuICAgIGFsdDogX2FsdFxufTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuNy4wXG4gKi9cbmV4cG9ydCB2YXIgQ29tb25hZCA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICBtYXA6IF9tYXAsXG4gICAgZXh0ZW5kOiBfZXh0ZW5kLFxuICAgIGV4dHJhY3Q6IGV4dHJhY3Rcbn07XG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vLyBkbyBub3RhdGlvblxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLyoqXG4gKiBAY2F0ZWdvcnkgZG8gbm90YXRpb25cbiAqIEBzaW5jZSAyLjkuMFxuICovXG5leHBvcnQgdmFyIERvID0gLyojX19QVVJFX18qLyBvZihfLmVtcHR5UmVjb3JkKTtcbi8qKlxuICogQGNhdGVnb3J5IGRvIG5vdGF0aW9uXG4gKiBAc2luY2UgMi44LjBcbiAqL1xuZXhwb3J0IHZhciBiaW5kVG8gPSAvKiNfX1BVUkVfXyovIGJpbmRUb18oRnVuY3Rvcik7XG52YXIgbGV0XyA9IC8qI19fUFVSRV9fKi8gbGV0X18oRnVuY3Rvcik7XG5leHBvcnQgeyBcbi8qKlxuICogQGNhdGVnb3J5IGRvIG5vdGF0aW9uXG4gKiBAc2luY2UgMi4xMy4wXG4gKi9cbmxldF8gYXMgbGV0IH07XG4vKipcbiAqIEBjYXRlZ29yeSBkbyBub3RhdGlvblxuICogQHNpbmNlIDIuOC4wXG4gKi9cbmV4cG9ydCB2YXIgYmluZCA9IC8qI19fUFVSRV9fKi8gYmluZF8oQ2hhaW4pO1xuLyoqXG4gKiBAY2F0ZWdvcnkgZG8gbm90YXRpb25cbiAqIEBzaW5jZSAyLjguMFxuICovXG5leHBvcnQgdmFyIGFwUyA9IC8qI19fUFVSRV9fKi8gYXBTXyhBcHBseSk7XG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vLyB1dGlsc1xuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLyoqXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBoZWFkID0gZXh0cmFjdDtcbi8qKlxuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgdGFpbCA9IF8udGFpbDtcbi8qKlxuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgbGFzdCA9IGZ1bmN0aW9uIChhcykgeyByZXR1cm4gYXNbYXMubGVuZ3RoIC0gMV07IH07XG4vKipcbiAqIEdldCBhbGwgYnV0IHRoZSBsYXN0IGVsZW1lbnQgb2YgYSBub24gZW1wdHkgYXJyYXksIGNyZWF0aW5nIGEgbmV3IGFycmF5LlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBpbml0IH0gZnJvbSAnZnAtdHMvUmVhZG9ubHlOb25FbXB0eUFycmF5J1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoaW5pdChbMSwgMiwgM10pLCBbMSwgMl0pXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKGluaXQoWzFdKSwgW10pXG4gKlxuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgaW5pdCA9IGZ1bmN0aW9uIChhcykgeyByZXR1cm4gYXMuc2xpY2UoMCwgLTEpOyB9O1xuLyoqXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBtaW4gPSBmdW5jdGlvbiAoTykge1xuICAgIHZhciBTID0gU2UubWluKE8pO1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHsgcmV0dXJuIGFzLnJlZHVjZShTLmNvbmNhdCk7IH07XG59O1xuLyoqXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBtYXggPSBmdW5jdGlvbiAoTykge1xuICAgIHZhciBTID0gU2UubWF4KE8pO1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHsgcmV0dXJuIGFzLnJlZHVjZShTLmNvbmNhdCk7IH07XG59O1xuLyoqXG4gKiBAc2luY2UgMi4xMC4wXG4gKi9cbmV4cG9ydCB2YXIgY29uY2F0QWxsID0gZnVuY3Rpb24gKFMpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIHJldHVybiBhcy5yZWR1Y2UoUy5jb25jYXQpO1xuICAgIH07XG59O1xuLyoqXG4gKiBCcmVhayBhIGBSZWFkb25seUFycmF5YCBpbnRvIGl0cyBmaXJzdCBlbGVtZW50IGFuZCByZW1haW5pbmcgZWxlbWVudHMuXG4gKlxuICogQGNhdGVnb3J5IHBhdHRlcm4gbWF0Y2hpbmdcbiAqIEBzaW5jZSAyLjExLjBcbiAqL1xuZXhwb3J0IHZhciBtYXRjaExlZnQgPSBmdW5jdGlvbiAoZikge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgcmV0dXJuIGYoaGVhZChhcyksIHRhaWwoYXMpKTtcbiAgICB9O1xufTtcbi8qKlxuICogQnJlYWsgYSBgUmVhZG9ubHlBcnJheWAgaW50byBpdHMgaW5pdGlhbCBlbGVtZW50cyBhbmQgdGhlIGxhc3QgZWxlbWVudC5cbiAqXG4gKiBAY2F0ZWdvcnkgcGF0dGVybiBtYXRjaGluZ1xuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIG1hdGNoUmlnaHQgPSBmdW5jdGlvbiAoZikge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgcmV0dXJuIGYoaW5pdChhcyksIGxhc3QoYXMpKTtcbiAgICB9O1xufTtcbi8qKlxuICogQXBwbHkgYSBmdW5jdGlvbiB0byB0aGUgaGVhZCwgY3JlYXRpbmcgYSBuZXcgYFJlYWRvbmx5Tm9uRW1wdHlBcnJheWAuXG4gKlxuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIG1vZGlmeUhlYWQgPSBmdW5jdGlvbiAoZikge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgcmV0dXJuIF9fc3ByZWFkQXJyYXkoW2YoaGVhZChhcykpXSwgdGFpbChhcyksIHRydWUpO1xuICAgIH07XG59O1xuLyoqXG4gKiBDaGFuZ2UgdGhlIGhlYWQsIGNyZWF0aW5nIGEgbmV3IGBSZWFkb25seU5vbkVtcHR5QXJyYXlgLlxuICpcbiAqIEBzaW5jZSAyLjExLjBcbiAqL1xuZXhwb3J0IHZhciB1cGRhdGVIZWFkID0gZnVuY3Rpb24gKGEpIHsgcmV0dXJuIG1vZGlmeUhlYWQoZnVuY3Rpb24gKCkgeyByZXR1cm4gYTsgfSk7IH07XG4vKipcbiAqIEFwcGx5IGEgZnVuY3Rpb24gdG8gdGhlIGxhc3QgZWxlbWVudCwgY3JlYXRpbmcgYSBuZXcgYFJlYWRvbmx5Tm9uRW1wdHlBcnJheWAuXG4gKlxuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIG1vZGlmeUxhc3QgPSBmdW5jdGlvbiAoZikge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgcmV0dXJuIHBpcGUoaW5pdChhcyksIGFwcGVuZChmKGxhc3QoYXMpKSkpO1xuICAgIH07XG59O1xuLyoqXG4gKiBDaGFuZ2UgdGhlIGxhc3QgZWxlbWVudCwgY3JlYXRpbmcgYSBuZXcgYFJlYWRvbmx5Tm9uRW1wdHlBcnJheWAuXG4gKlxuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIHVwZGF0ZUxhc3QgPSBmdW5jdGlvbiAoYSkgeyByZXR1cm4gbW9kaWZ5TGFzdChmdW5jdGlvbiAoKSB7IHJldHVybiBhOyB9KTsgfTtcbi8qKlxuICogUGxhY2VzIGFuIGVsZW1lbnQgaW4gYmV0d2VlbiBtZW1iZXJzIG9mIGEgYFJlYWRvbmx5Tm9uRW1wdHlBcnJheWAsIHRoZW4gZm9sZHMgdGhlIHJlc3VsdHMgdXNpbmcgdGhlIHByb3ZpZGVkIGBTZW1pZ3JvdXBgLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgKiBhcyBTIGZyb20gJ2ZwLXRzL3N0cmluZydcbiAqIGltcG9ydCB7IGludGVyY2FsYXRlIH0gZnJvbSAnZnAtdHMvUmVhZG9ubHlOb25FbXB0eUFycmF5J1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoaW50ZXJjYWxhdGUoUy5TZW1pZ3JvdXApKCctJykoWydhJywgJ2InLCAnYyddKSwgJ2EtYi1jJylcbiAqXG4gKiBAc2luY2UgMi4xMi4wXG4gKi9cbmV4cG9ydCB2YXIgaW50ZXJjYWxhdGUgPSBmdW5jdGlvbiAoUykge1xuICAgIHZhciBjb25jYXRBbGxTID0gY29uY2F0QWxsKFMpO1xuICAgIHJldHVybiBmdW5jdGlvbiAobWlkZGxlKSB7IHJldHVybiBmbG93KGludGVyc3BlcnNlKG1pZGRsZSksIGNvbmNhdEFsbFMpOyB9O1xufTtcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8vIGxlZ2FjeVxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLyoqXG4gKiBBbGlhcyBvZiBgZmxhdE1hcGAuXG4gKlxuICogQGNhdGVnb3J5IGxlZ2FjeVxuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgY2hhaW4gPSBmbGF0TWFwO1xuZXhwb3J0IGZ1bmN0aW9uIGdyb3VwU29ydChPKSB7XG4gICAgdmFyIHNvcnRPID0gc29ydChPKTtcbiAgICB2YXIgZ3JvdXBPID0gZ3JvdXAoTyk7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykgeyByZXR1cm4gKGlzTm9uRW1wdHkoYXMpID8gZ3JvdXBPKHNvcnRPKGFzKSkgOiBlbXB0eSk7IH07XG59XG5leHBvcnQgZnVuY3Rpb24gZmlsdGVyKHByZWRpY2F0ZSkge1xuICAgIHJldHVybiBmaWx0ZXJXaXRoSW5kZXgoZnVuY3Rpb24gKF8sIGEpIHsgcmV0dXJuIHByZWRpY2F0ZShhKTsgfSk7XG59XG4vKipcbiAqIFVzZSBbYGZpbHRlcldpdGhJbmRleGBdKC4vUmVhZG9ubHlBcnJheS50cy5odG1sI2ZpbHRlcndpdGhpbmRleCkgaW5zdGVhZC5cbiAqXG4gKiBAY2F0ZWdvcnkgem9uZSBvZiBkZWF0aFxuICogQHNpbmNlIDIuNS4wXG4gKiBAZGVwcmVjYXRlZFxuICovXG5leHBvcnQgdmFyIGZpbHRlcldpdGhJbmRleCA9IGZ1bmN0aW9uIChwcmVkaWNhdGUpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIHJldHVybiBmcm9tUmVhZG9ubHlBcnJheShhcy5maWx0ZXIoZnVuY3Rpb24gKGEsIGkpIHsgcmV0dXJuIHByZWRpY2F0ZShpLCBhKTsgfSkpO1xuICAgIH07XG59O1xuLyoqXG4gKiBVc2UgW2B1bnByZXBlbmRgXSgjdW5wcmVwZW5kKSBpbnN0ZWFkLlxuICpcbiAqIEBjYXRlZ29yeSB6b25lIG9mIGRlYXRoXG4gKiBAc2luY2UgMi4xMC4wXG4gKiBAZGVwcmVjYXRlZFxuICovXG5leHBvcnQgdmFyIHVuY29ucyA9IHVucHJlcGVuZDtcbi8qKlxuICogVXNlIFtgdW5hcHBlbmRgXSgjdW5hcHBlbmQpIGluc3RlYWQuXG4gKlxuICogQGNhdGVnb3J5IHpvbmUgb2YgZGVhdGhcbiAqIEBzaW5jZSAyLjEwLjBcbiAqIEBkZXByZWNhdGVkXG4gKi9cbmV4cG9ydCB2YXIgdW5zbm9jID0gdW5hcHBlbmQ7XG5leHBvcnQgZnVuY3Rpb24gY29ucyhoZWFkLCB0YWlsKSB7XG4gICAgcmV0dXJuIHRhaWwgPT09IHVuZGVmaW5lZCA/IHByZXBlbmQoaGVhZCkgOiBwaXBlKHRhaWwsIHByZXBlbmQoaGVhZCkpO1xufVxuLyoqXG4gKiBVc2UgW2BhcHBlbmRgXSguL1JlYWRvbmx5QXJyYXkudHMuaHRtbCNhcHBlbmQpIGluc3RlYWQuXG4gKlxuICogQGNhdGVnb3J5IHpvbmUgb2YgZGVhdGhcbiAqIEBzaW5jZSAyLjUuMFxuICogQGRlcHJlY2F0ZWRcbiAqL1xuZXhwb3J0IHZhciBzbm9jID0gZnVuY3Rpb24gKGluaXQsIGVuZCkgeyByZXR1cm4gcGlwZShpbml0LCBjb25jYXQoW2VuZF0pKTsgfTtcbi8qKlxuICogVXNlIFtgaW5zZXJ0QXRgXSguL1JlYWRvbmx5QXJyYXkudHMuaHRtbCNpbnNlcnRhdCkgaW5zdGVhZC5cbiAqXG4gKiBAY2F0ZWdvcnkgem9uZSBvZiBkZWF0aFxuICogQHNpbmNlIDIuNS4wXG4gKiBAZGVwcmVjYXRlZFxuICovXG5leHBvcnQgdmFyIGluc2VydEF0ID0gZnVuY3Rpb24gKGksIGEpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIHJldHVybiBpIDwgMCB8fCBpID4gYXMubGVuZ3RoID8gXy5ub25lIDogXy5zb21lKHVuc2FmZUluc2VydEF0KGksIGEsIGFzKSk7XG4gICAgfTtcbn07XG4vKipcbiAqIFVzZSBbYHByZXBlbmRBbGxgXSgjcHJlcGVuZGFsbCkgaW5zdGVhZC5cbiAqXG4gKiBAY2F0ZWdvcnkgem9uZSBvZiBkZWF0aFxuICogQHNpbmNlIDIuOS4wXG4gKiBAZGVwcmVjYXRlZFxuICovXG5leHBvcnQgdmFyIHByZXBlbmRUb0FsbCA9IHByZXBlbmRBbGw7XG4vKipcbiAqIFVzZSBbYGNvbmNhdEFsbGBdKCNjb25jYXRhbGwpIGluc3RlYWQuXG4gKlxuICogQGNhdGVnb3J5IHpvbmUgb2YgZGVhdGhcbiAqIEBzaW5jZSAyLjUuMFxuICogQGRlcHJlY2F0ZWRcbiAqL1xuZXhwb3J0IHZhciBmb2xkID0gY29uY2F0QWxsO1xuLyoqXG4gKiBUaGlzIGluc3RhbmNlIGlzIGRlcHJlY2F0ZWQsIHVzZSBzbWFsbCwgc3BlY2lmaWMgaW5zdGFuY2VzIGluc3RlYWQuXG4gKiBGb3IgZXhhbXBsZSBpZiBhIGZ1bmN0aW9uIG5lZWRzIGEgYEZ1bmN0b3JgIGluc3RhbmNlLCBwYXNzIGBSTkVBLkZ1bmN0b3JgIGluc3RlYWQgb2YgYFJORUEucmVhZG9ubHlOb25FbXB0eUFycmF5YFxuICogKHdoZXJlIGBSTkVBYCBpcyBmcm9tIGBpbXBvcnQgUk5FQSBmcm9tICdmcC10cy9SZWFkb25seU5vbkVtcHR5QXJyYXknYClcbiAqXG4gKiBAY2F0ZWdvcnkgem9uZSBvZiBkZWF0aFxuICogQHNpbmNlIDIuNS4wXG4gKiBAZGVwcmVjYXRlZFxuICovXG5leHBvcnQgdmFyIHJlYWRvbmx5Tm9uRW1wdHlBcnJheSA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICBvZjogb2YsXG4gICAgbWFwOiBfbWFwLFxuICAgIG1hcFdpdGhJbmRleDogX21hcFdpdGhJbmRleCxcbiAgICBhcDogX2FwLFxuICAgIGNoYWluOiBmbGF0TWFwLFxuICAgIGV4dGVuZDogX2V4dGVuZCxcbiAgICBleHRyYWN0OiBleHRyYWN0LFxuICAgIHJlZHVjZTogX3JlZHVjZSxcbiAgICBmb2xkTWFwOiBfZm9sZE1hcCxcbiAgICByZWR1Y2VSaWdodDogX3JlZHVjZVJpZ2h0LFxuICAgIHRyYXZlcnNlOiBfdHJhdmVyc2UsXG4gICAgc2VxdWVuY2U6IHNlcXVlbmNlLFxuICAgIHJlZHVjZVdpdGhJbmRleDogX3JlZHVjZVdpdGhJbmRleCxcbiAgICBmb2xkTWFwV2l0aEluZGV4OiBfZm9sZE1hcFdpdGhJbmRleCxcbiAgICByZWR1Y2VSaWdodFdpdGhJbmRleDogX3JlZHVjZVJpZ2h0V2l0aEluZGV4LFxuICAgIHRyYXZlcnNlV2l0aEluZGV4OiBfdHJhdmVyc2VXaXRoSW5kZXgsXG4gICAgYWx0OiBfYWx0XG59O1xuIiwKICAidmFyIF9fc3ByZWFkQXJyYXkgPSAodGhpcyAmJiB0aGlzLl9fc3ByZWFkQXJyYXkpIHx8IGZ1bmN0aW9uICh0bywgZnJvbSwgcGFjaykge1xuICAgIGlmIChwYWNrIHx8IGFyZ3VtZW50cy5sZW5ndGggPT09IDIpIGZvciAodmFyIGkgPSAwLCBsID0gZnJvbS5sZW5ndGgsIGFyOyBpIDwgbDsgaSsrKSB7XG4gICAgICAgIGlmIChhciB8fCAhKGkgaW4gZnJvbSkpIHtcbiAgICAgICAgICAgIGlmICghYXIpIGFyID0gQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoZnJvbSwgMCwgaSk7XG4gICAgICAgICAgICBhcltpXSA9IGZyb21baV07XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHRvLmNvbmNhdChhciB8fCBBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChmcm9tKSk7XG59O1xuaW1wb3J0IHsgYXBGaXJzdCBhcyBhcEZpcnN0XywgYXBTIGFzIGFwU18sIGFwU2Vjb25kIGFzIGFwU2Vjb25kXyB9IGZyb20gJy4vQXBwbHknO1xuaW1wb3J0IHsgYmluZCBhcyBiaW5kXywgY2hhaW5GaXJzdCBhcyBjaGFpbkZpcnN0XyB9IGZyb20gJy4vQ2hhaW4nO1xuaW1wb3J0IHsgZnJvbUVxdWFscyB9IGZyb20gJy4vRXEnO1xuaW1wb3J0IHsgZHVhbCwgZmxvdywgaWRlbnRpdHksIHBpcGUsIFNLIH0gZnJvbSAnLi9mdW5jdGlvbic7XG5pbXBvcnQgeyBiaW5kVG8gYXMgYmluZFRvXywgZmxhcCBhcyBmbGFwXywgbGV0IGFzIGxldF9fIH0gZnJvbSAnLi9GdW5jdG9yJztcbmltcG9ydCAqIGFzIF8gZnJvbSAnLi9pbnRlcm5hbCc7XG5pbXBvcnQgeyBnZXRNb25vaWQgfSBmcm9tICcuL09yZCc7XG5pbXBvcnQgKiBhcyBTZSBmcm9tICcuL1NlbWlncm91cCc7XG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vLyBpbnRlcm5hbFxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLyoqXG4gKiBAaW50ZXJuYWxcbiAqL1xuZXhwb3J0IHZhciBlbXB0eSA9IF8uZW1wdHlSZWFkb25seUFycmF5O1xuLyoqXG4gKiBAaW50ZXJuYWxcbiAqL1xuZXhwb3J0IHZhciBpc05vbkVtcHR5ID0gXy5pc05vbkVtcHR5O1xuLyoqXG4gKiBAaW50ZXJuYWxcbiAqL1xuZXhwb3J0IHZhciBpc091dE9mQm91bmQgPSBmdW5jdGlvbiAoaSwgYXMpIHsgcmV0dXJuIGkgPCAwIHx8IGkgPj0gYXMubGVuZ3RoOyB9O1xuLyoqXG4gKiBAaW50ZXJuYWxcbiAqL1xuZXhwb3J0IHZhciBwcmVwZW5kVyA9IGZ1bmN0aW9uIChoZWFkKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uICh0YWlsKSB7XG4gICAgICAgIHJldHVybiBfX3NwcmVhZEFycmF5KFtoZWFkXSwgdGFpbCwgdHJ1ZSk7XG4gICAgfTtcbn07XG4vKipcbiAqIEBpbnRlcm5hbFxuICovXG5leHBvcnQgdmFyIHByZXBlbmQgPSBwcmVwZW5kVztcbi8qKlxuICogQGludGVybmFsXG4gKi9cbmV4cG9ydCB2YXIgYXBwZW5kVyA9IGZ1bmN0aW9uIChlbmQpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGluaXQpIHtcbiAgICAgICAgcmV0dXJuIF9fc3ByZWFkQXJyYXkoX19zcHJlYWRBcnJheShbXSwgaW5pdCwgdHJ1ZSksIFtlbmRdLCBmYWxzZSk7XG4gICAgfTtcbn07XG4vKipcbiAqIEBpbnRlcm5hbFxuICovXG5leHBvcnQgdmFyIGFwcGVuZCA9IGFwcGVuZFc7XG4vKipcbiAqIEBpbnRlcm5hbFxuICovXG5leHBvcnQgdmFyIHVuc2FmZUluc2VydEF0ID0gZnVuY3Rpb24gKGksIGEsIGFzKSB7XG4gICAgaWYgKGlzTm9uRW1wdHkoYXMpKSB7XG4gICAgICAgIHZhciB4cyA9IF8uZnJvbVJlYWRvbmx5Tm9uRW1wdHlBcnJheShhcyk7XG4gICAgICAgIHhzLnNwbGljZShpLCAwLCBhKTtcbiAgICAgICAgcmV0dXJuIHhzO1xuICAgIH1cbiAgICByZXR1cm4gW2FdO1xufTtcbi8qKlxuICogQGludGVybmFsXG4gKi9cbmV4cG9ydCB2YXIgdW5zYWZlVXBkYXRlQXQgPSBmdW5jdGlvbiAoaSwgYSwgYXMpIHtcbiAgICBpZiAoYXNbaV0gPT09IGEpIHtcbiAgICAgICAgcmV0dXJuIGFzO1xuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgICAgdmFyIHhzID0gXy5mcm9tUmVhZG9ubHlOb25FbXB0eUFycmF5KGFzKTtcbiAgICAgICAgeHNbaV0gPSBhO1xuICAgICAgICByZXR1cm4geHM7XG4gICAgfVxufTtcbi8qKlxuICogUmVtb3ZlIGR1cGxpY2F0ZXMgZnJvbSBhIGBSZWFkb25seU5vbkVtcHR5QXJyYXlgLCBrZWVwaW5nIHRoZSBmaXJzdCBvY2N1cnJlbmNlIG9mIGFuIGVsZW1lbnQuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IHVuaXEgfSBmcm9tICdmcC10cy9SZWFkb25seU5vbkVtcHR5QXJyYXknXG4gKiBpbXBvcnQgKiBhcyBOIGZyb20gJ2ZwLXRzL251bWJlcidcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKHVuaXEoTi5FcSkoWzEsIDIsIDFdKSwgWzEsIDJdKVxuICpcbiAqIEBzaW5jZSAyLjExLjBcbiAqL1xuZXhwb3J0IHZhciB1bmlxID0gZnVuY3Rpb24gKEUpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIGlmIChhcy5sZW5ndGggPT09IDEpIHtcbiAgICAgICAgICAgIHJldHVybiBhcztcbiAgICAgICAgfVxuICAgICAgICB2YXIgb3V0ID0gW2hlYWQoYXMpXTtcbiAgICAgICAgdmFyIHJlc3QgPSB0YWlsKGFzKTtcbiAgICAgICAgdmFyIF9sb29wXzEgPSBmdW5jdGlvbiAoYSkge1xuICAgICAgICAgICAgaWYgKG91dC5ldmVyeShmdW5jdGlvbiAobykgeyByZXR1cm4gIUUuZXF1YWxzKG8sIGEpOyB9KSkge1xuICAgICAgICAgICAgICAgIG91dC5wdXNoKGEpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICBmb3IgKHZhciBfaSA9IDAsIHJlc3RfMSA9IHJlc3Q7IF9pIDwgcmVzdF8xLmxlbmd0aDsgX2krKykge1xuICAgICAgICAgICAgdmFyIGEgPSByZXN0XzFbX2ldO1xuICAgICAgICAgICAgX2xvb3BfMShhKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gb3V0O1xuICAgIH07XG59O1xuLyoqXG4gKiBTb3J0IHRoZSBlbGVtZW50cyBvZiBhIGBSZWFkb25seU5vbkVtcHR5QXJyYXlgIGluIGluY3JlYXNpbmcgb3JkZXIsIHdoZXJlIGVsZW1lbnRzIGFyZSBjb21wYXJlZCB1c2luZyBmaXJzdCBgb3Jkc1swXWAsIHRoZW4gYG9yZHNbMV1gLFxuICogZXRjLi4uXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCAqIGFzIFJORUEgZnJvbSAnZnAtdHMvUmVhZG9ubHlOb25FbXB0eUFycmF5J1xuICogaW1wb3J0IHsgY29udHJhbWFwIH0gZnJvbSAnZnAtdHMvT3JkJ1xuICogaW1wb3J0ICogYXMgUyBmcm9tICdmcC10cy9zdHJpbmcnXG4gKiBpbXBvcnQgKiBhcyBOIGZyb20gJ2ZwLXRzL251bWJlcidcbiAqIGltcG9ydCB7IHBpcGUgfSBmcm9tICdmcC10cy9mdW5jdGlvbidcbiAqXG4gKiBpbnRlcmZhY2UgUGVyc29uIHtcbiAqICAgbmFtZTogc3RyaW5nXG4gKiAgIGFnZTogbnVtYmVyXG4gKiB9XG4gKlxuICogY29uc3QgYnlOYW1lID0gcGlwZShTLk9yZCwgY29udHJhbWFwKChwOiBQZXJzb24pID0+IHAubmFtZSkpXG4gKlxuICogY29uc3QgYnlBZ2UgPSBwaXBlKE4uT3JkLCBjb250cmFtYXAoKHA6IFBlcnNvbikgPT4gcC5hZ2UpKVxuICpcbiAqIGNvbnN0IHNvcnRCeU5hbWVCeUFnZSA9IFJORUEuc29ydEJ5KFtieU5hbWUsIGJ5QWdlXSlcbiAqXG4gKiBjb25zdCBwZXJzb25zOiBSTkVBLlJlYWRvbmx5Tm9uRW1wdHlBcnJheTxQZXJzb24+ID0gW1xuICogICB7IG5hbWU6ICdhJywgYWdlOiAxIH0sXG4gKiAgIHsgbmFtZTogJ2InLCBhZ2U6IDMgfSxcbiAqICAgeyBuYW1lOiAnYycsIGFnZTogMiB9LFxuICogICB7IG5hbWU6ICdiJywgYWdlOiAyIH1cbiAqIF1cbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKHNvcnRCeU5hbWVCeUFnZShwZXJzb25zKSwgW1xuICogICB7IG5hbWU6ICdhJywgYWdlOiAxIH0sXG4gKiAgIHsgbmFtZTogJ2InLCBhZ2U6IDIgfSxcbiAqICAgeyBuYW1lOiAnYicsIGFnZTogMyB9LFxuICogICB7IG5hbWU6ICdjJywgYWdlOiAyIH1cbiAqIF0pXG4gKlxuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIHNvcnRCeSA9IGZ1bmN0aW9uIChvcmRzKSB7XG4gICAgaWYgKGlzTm9uRW1wdHkob3JkcykpIHtcbiAgICAgICAgdmFyIE0gPSBnZXRNb25vaWQoKTtcbiAgICAgICAgcmV0dXJuIHNvcnQob3Jkcy5yZWR1Y2UoTS5jb25jYXQsIE0uZW1wdHkpKTtcbiAgICB9XG4gICAgcmV0dXJuIGlkZW50aXR5O1xufTtcbi8qKlxuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIHVuaW9uID0gZnVuY3Rpb24gKEUpIHtcbiAgICB2YXIgdW5pcUUgPSB1bmlxKEUpO1xuICAgIHJldHVybiBmdW5jdGlvbiAoc2Vjb25kKSB7IHJldHVybiBmdW5jdGlvbiAoZmlyc3QpIHsgcmV0dXJuIHVuaXFFKHBpcGUoZmlyc3QsIGNvbmNhdChzZWNvbmQpKSk7IH07IH07XG59O1xuLyoqXG4gKiBSb3RhdGUgYSBgUmVhZG9ubHlOb25FbXB0eUFycmF5YCBieSBgbmAgc3RlcHMuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IHJvdGF0ZSB9IGZyb20gJ2ZwLXRzL1JlYWRvbmx5Tm9uRW1wdHlBcnJheSdcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKHJvdGF0ZSgyKShbMSwgMiwgMywgNCwgNV0pLCBbNCwgNSwgMSwgMiwgM10pXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKHJvdGF0ZSgtMikoWzEsIDIsIDMsIDQsIDVdKSwgWzMsIDQsIDUsIDEsIDJdKVxuICpcbiAqIEBzaW5jZSAyLjExLjBcbiAqL1xuZXhwb3J0IHZhciByb3RhdGUgPSBmdW5jdGlvbiAobikge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgdmFyIGxlbiA9IGFzLmxlbmd0aDtcbiAgICAgICAgdmFyIG0gPSBNYXRoLnJvdW5kKG4pICUgbGVuO1xuICAgICAgICBpZiAoaXNPdXRPZkJvdW5kKE1hdGguYWJzKG0pLCBhcykgfHwgbSA9PT0gMCkge1xuICAgICAgICAgICAgcmV0dXJuIGFzO1xuICAgICAgICB9XG4gICAgICAgIGlmIChtIDwgMCkge1xuICAgICAgICAgICAgdmFyIF9hID0gc3BsaXRBdCgtbSkoYXMpLCBmID0gX2FbMF0sIHMgPSBfYVsxXTtcbiAgICAgICAgICAgIHJldHVybiBwaXBlKHMsIGNvbmNhdChmKSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gcm90YXRlKG0gLSBsZW4pKGFzKTtcbiAgICAgICAgfVxuICAgIH07XG59O1xuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLy8gY29uc3RydWN0b3JzXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vKipcbiAqIFJldHVybiBhIGBSZWFkb25seU5vbkVtcHR5QXJyYXlgIGZyb20gYSBgUmVhZG9ubHlBcnJheWAgcmV0dXJuaW5nIGBub25lYCBpZiB0aGUgaW5wdXQgaXMgZW1wdHkuXG4gKlxuICogQGNhdGVnb3J5IGNvbnZlcnNpb25zXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBmcm9tUmVhZG9ubHlBcnJheSA9IGZ1bmN0aW9uIChhcykge1xuICAgIHJldHVybiBpc05vbkVtcHR5KGFzKSA/IF8uc29tZShhcykgOiBfLm5vbmU7XG59O1xuLyoqXG4gKiBSZXR1cm4gYSBgUmVhZG9ubHlOb25FbXB0eUFycmF5YCBvZiBsZW5ndGggYG5gIHdpdGggZWxlbWVudCBgaWAgaW5pdGlhbGl6ZWQgd2l0aCBgZihpKWAuXG4gKlxuICogKipOb3RlKiouIGBuYCBpcyBub3JtYWxpemVkIHRvIGEgbmF0dXJhbCBudW1iZXIuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IG1ha2VCeSB9IGZyb20gJ2ZwLXRzL1JlYWRvbmx5Tm9uRW1wdHlBcnJheSdcbiAqIGltcG9ydCB7IHBpcGUgfSBmcm9tICdmcC10cy9mdW5jdGlvbidcbiAqXG4gKiBjb25zdCBkb3VibGUgPSAobjogbnVtYmVyKTogbnVtYmVyID0+IG4gKiAyXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKHBpcGUoNSwgbWFrZUJ5KGRvdWJsZSkpLCBbMCwgMiwgNCwgNiwgOF0pXG4gKlxuICogQGNhdGVnb3J5IGNvbnN0cnVjdG9yc1xuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIG1ha2VCeSA9IGZ1bmN0aW9uIChmKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChuKSB7XG4gICAgICAgIHZhciBqID0gTWF0aC5tYXgoMCwgTWF0aC5mbG9vcihuKSk7XG4gICAgICAgIHZhciBvdXQgPSBbZigwKV07XG4gICAgICAgIGZvciAodmFyIGkgPSAxOyBpIDwgajsgaSsrKSB7XG4gICAgICAgICAgICBvdXQucHVzaChmKGkpKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gb3V0O1xuICAgIH07XG59O1xuLyoqXG4gKiBDcmVhdGUgYSBgUmVhZG9ubHlOb25FbXB0eUFycmF5YCBjb250YWluaW5nIGEgdmFsdWUgcmVwZWF0ZWQgdGhlIHNwZWNpZmllZCBudW1iZXIgb2YgdGltZXMuXG4gKlxuICogKipOb3RlKiouIGBuYCBpcyBub3JtYWxpemVkIHRvIGEgbmF0dXJhbCBudW1iZXIuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IHJlcGxpY2F0ZSB9IGZyb20gJ2ZwLXRzL1JlYWRvbmx5Tm9uRW1wdHlBcnJheSdcbiAqIGltcG9ydCB7IHBpcGUgfSBmcm9tICdmcC10cy9mdW5jdGlvbidcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKHBpcGUoMywgcmVwbGljYXRlKCdhJykpLCBbJ2EnLCAnYScsICdhJ10pXG4gKlxuICogQGNhdGVnb3J5IGNvbnN0cnVjdG9yc1xuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIHJlcGxpY2F0ZSA9IGZ1bmN0aW9uIChhKSB7IHJldHVybiBtYWtlQnkoZnVuY3Rpb24gKCkgeyByZXR1cm4gYTsgfSk7IH07XG4vKipcbiAqIENyZWF0ZSBhIGBSZWFkb25seU5vbkVtcHR5QXJyYXlgIGNvbnRhaW5pbmcgYSByYW5nZSBvZiBpbnRlZ2VycywgaW5jbHVkaW5nIGJvdGggZW5kcG9pbnRzLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyByYW5nZSB9IGZyb20gJ2ZwLXRzL1JlYWRvbmx5Tm9uRW1wdHlBcnJheSdcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKHJhbmdlKDEsIDUpLCBbMSwgMiwgMywgNCwgNV0pXG4gKlxuICogQGNhdGVnb3J5IGNvbnN0cnVjdG9yc1xuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIHJhbmdlID0gZnVuY3Rpb24gKHN0YXJ0LCBlbmQpIHtcbiAgICByZXR1cm4gc3RhcnQgPD0gZW5kID8gbWFrZUJ5KGZ1bmN0aW9uIChpKSB7IHJldHVybiBzdGFydCArIGk7IH0pKGVuZCAtIHN0YXJ0ICsgMSkgOiBbc3RhcnRdO1xufTtcbi8qKlxuICogUmV0dXJuIHRoZSB0dXBsZSBvZiB0aGUgYGhlYWRgIGFuZCB0aGUgYHRhaWxgLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyB1bnByZXBlbmQgfSBmcm9tICdmcC10cy9SZWFkb25seU5vbkVtcHR5QXJyYXknXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbCh1bnByZXBlbmQoWzEsIDIsIDMsIDRdKSwgWzEsIFsyLCAzLCA0XV0pXG4gKlxuICogQHNpbmNlIDIuOS4wXG4gKi9cbmV4cG9ydCB2YXIgdW5wcmVwZW5kID0gZnVuY3Rpb24gKGFzKSB7IHJldHVybiBbaGVhZChhcyksIHRhaWwoYXMpXTsgfTtcbi8qKlxuICogUmV0dXJuIHRoZSB0dXBsZSBvZiB0aGUgYGluaXRgIGFuZCB0aGUgYGxhc3RgLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyB1bmFwcGVuZCB9IGZyb20gJ2ZwLXRzL1JlYWRvbmx5Tm9uRW1wdHlBcnJheSdcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKHVuYXBwZW5kKFsxLCAyLCAzLCA0XSksIFtbMSwgMiwgM10sIDRdKVxuICpcbiAqIEBzaW5jZSAyLjkuMFxuICovXG5leHBvcnQgdmFyIHVuYXBwZW5kID0gZnVuY3Rpb24gKGFzKSB7IHJldHVybiBbaW5pdChhcyksIGxhc3QoYXMpXTsgfTtcbi8qKlxuICogQGNhdGVnb3J5IGNvbnZlcnNpb25zXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBmcm9tQXJyYXkgPSBmdW5jdGlvbiAoYXMpIHsgcmV0dXJuIGZyb21SZWFkb25seUFycmF5KGFzLnNsaWNlKCkpOyB9O1xuZXhwb3J0IGZ1bmN0aW9uIGNvbmNhdFcoc2Vjb25kKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChmaXJzdCkgeyByZXR1cm4gZmlyc3QuY29uY2F0KHNlY29uZCk7IH07XG59XG5leHBvcnQgZnVuY3Rpb24gY29uY2F0KHgsIHkpIHtcbiAgICByZXR1cm4geSA/IHguY29uY2F0KHkpIDogZnVuY3Rpb24gKHkpIHsgcmV0dXJuIHkuY29uY2F0KHgpOyB9O1xufVxuLyoqXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciByZXZlcnNlID0gZnVuY3Rpb24gKGFzKSB7XG4gICAgcmV0dXJuIGFzLmxlbmd0aCA9PT0gMSA/IGFzIDogX19zcHJlYWRBcnJheShbbGFzdChhcyldLCBhcy5zbGljZSgwLCAtMSkucmV2ZXJzZSgpLCB0cnVlKTtcbn07XG5leHBvcnQgZnVuY3Rpb24gZ3JvdXAoRSkge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgdmFyIGxlbiA9IGFzLmxlbmd0aDtcbiAgICAgICAgaWYgKGxlbiA9PT0gMCkge1xuICAgICAgICAgICAgcmV0dXJuIGVtcHR5O1xuICAgICAgICB9XG4gICAgICAgIHZhciBvdXQgPSBbXTtcbiAgICAgICAgdmFyIGhlYWQgPSBhc1swXTtcbiAgICAgICAgdmFyIG5lYSA9IFtoZWFkXTtcbiAgICAgICAgZm9yICh2YXIgaSA9IDE7IGkgPCBsZW47IGkrKykge1xuICAgICAgICAgICAgdmFyIGEgPSBhc1tpXTtcbiAgICAgICAgICAgIGlmIChFLmVxdWFscyhhLCBoZWFkKSkge1xuICAgICAgICAgICAgICAgIG5lYS5wdXNoKGEpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgb3V0LnB1c2gobmVhKTtcbiAgICAgICAgICAgICAgICBoZWFkID0gYTtcbiAgICAgICAgICAgICAgICBuZWEgPSBbaGVhZF07XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgb3V0LnB1c2gobmVhKTtcbiAgICAgICAgcmV0dXJuIG91dDtcbiAgICB9O1xufVxuLyoqXG4gKiBTcGxpdHMgYW4gYXJyYXkgaW50byBzdWItbm9uLWVtcHR5LWFycmF5cyBzdG9yZWQgaW4gYW4gb2JqZWN0LCBiYXNlZCBvbiB0aGUgcmVzdWx0IG9mIGNhbGxpbmcgYSBgc3RyaW5nYC1yZXR1cm5pbmdcbiAqIGZ1bmN0aW9uIG9uIGVhY2ggZWxlbWVudCwgYW5kIGdyb3VwaW5nIHRoZSByZXN1bHRzIGFjY29yZGluZyB0byB2YWx1ZXMgcmV0dXJuZWRcbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgZ3JvdXBCeSB9IGZyb20gJ2ZwLXRzL1JlYWRvbmx5Tm9uRW1wdHlBcnJheSdcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKGdyb3VwQnkoKHM6IHN0cmluZykgPT4gU3RyaW5nKHMubGVuZ3RoKSkoWydhJywgJ2InLCAnYWInXSksIHtcbiAqICAgJzEnOiBbJ2EnLCAnYiddLFxuICogICAnMic6IFsnYWInXVxuICogfSlcbiAqXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBncm91cEJ5ID0gZnVuY3Rpb24gKGYpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIHZhciBvdXQgPSB7fTtcbiAgICAgICAgZm9yICh2YXIgX2kgPSAwLCBhc18xID0gYXM7IF9pIDwgYXNfMS5sZW5ndGg7IF9pKyspIHtcbiAgICAgICAgICAgIHZhciBhID0gYXNfMVtfaV07XG4gICAgICAgICAgICB2YXIgayA9IGYoYSk7XG4gICAgICAgICAgICBpZiAoXy5oYXMuY2FsbChvdXQsIGspKSB7XG4gICAgICAgICAgICAgICAgb3V0W2tdLnB1c2goYSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBvdXRba10gPSBbYV07XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG91dDtcbiAgICB9O1xufTtcbi8qKlxuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgc29ydCA9IGZ1bmN0aW9uIChPKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykge1xuICAgICAgICByZXR1cm4gYXMubGVuZ3RoID09PSAxID8gYXMgOiBhcy5zbGljZSgpLnNvcnQoTy5jb21wYXJlKTtcbiAgICB9O1xufTtcbi8qKlxuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgdXBkYXRlQXQgPSBmdW5jdGlvbiAoaSwgYSkge1xuICAgIHJldHVybiBtb2RpZnlBdChpLCBmdW5jdGlvbiAoKSB7IHJldHVybiBhOyB9KTtcbn07XG4vKipcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIG1vZGlmeUF0ID0gZnVuY3Rpb24gKGksIGYpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIHJldHVybiBpc091dE9mQm91bmQoaSwgYXMpID8gXy5ub25lIDogXy5zb21lKHVuc2FmZVVwZGF0ZUF0KGksIGYoYXNbaV0pLCBhcykpO1xuICAgIH07XG59O1xuLyoqXG4gKiBAc2luY2UgMi41LjFcbiAqL1xuZXhwb3J0IHZhciB6aXBXaXRoID0gZnVuY3Rpb24gKGFzLCBicywgZikge1xuICAgIHZhciBjcyA9IFtmKGFzWzBdLCBic1swXSldO1xuICAgIHZhciBsZW4gPSBNYXRoLm1pbihhcy5sZW5ndGgsIGJzLmxlbmd0aCk7XG4gICAgZm9yICh2YXIgaSA9IDE7IGkgPCBsZW47IGkrKykge1xuICAgICAgICBjc1tpXSA9IGYoYXNbaV0sIGJzW2ldKTtcbiAgICB9XG4gICAgcmV0dXJuIGNzO1xufTtcbmV4cG9ydCBmdW5jdGlvbiB6aXAoYXMsIGJzKSB7XG4gICAgaWYgKGJzID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIChicykgeyByZXR1cm4gemlwKGJzLCBhcyk7IH07XG4gICAgfVxuICAgIHJldHVybiB6aXBXaXRoKGFzLCBicywgZnVuY3Rpb24gKGEsIGIpIHsgcmV0dXJuIFthLCBiXTsgfSk7XG59XG4vKipcbiAqIEBzaW5jZSAyLjUuMVxuICovXG5leHBvcnQgdmFyIHVuemlwID0gZnVuY3Rpb24gKGFicykge1xuICAgIHZhciBmYSA9IFthYnNbMF1bMF1dO1xuICAgIHZhciBmYiA9IFthYnNbMF1bMV1dO1xuICAgIGZvciAodmFyIGkgPSAxOyBpIDwgYWJzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIGZhW2ldID0gYWJzW2ldWzBdO1xuICAgICAgICBmYltpXSA9IGFic1tpXVsxXTtcbiAgICB9XG4gICAgcmV0dXJuIFtmYSwgZmJdO1xufTtcbi8qKlxuICogUHJlcGVuZCBhbiBlbGVtZW50IHRvIGV2ZXJ5IG1lbWJlciBvZiBhIGBSZWFkb25seU5vbkVtcHR5QXJyYXlgLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBwcmVwZW5kQWxsIH0gZnJvbSAnZnAtdHMvUmVhZG9ubHlOb25FbXB0eUFycmF5J1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwocHJlcGVuZEFsbCg5KShbMSwgMiwgMywgNF0pLCBbOSwgMSwgOSwgMiwgOSwgMywgOSwgNF0pXG4gKlxuICogQHNpbmNlIDIuMTAuMFxuICovXG5leHBvcnQgdmFyIHByZXBlbmRBbGwgPSBmdW5jdGlvbiAobWlkZGxlKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykge1xuICAgICAgICB2YXIgb3V0ID0gW21pZGRsZSwgYXNbMF1dO1xuICAgICAgICBmb3IgKHZhciBpID0gMTsgaSA8IGFzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICBvdXQucHVzaChtaWRkbGUsIGFzW2ldKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gb3V0O1xuICAgIH07XG59O1xuLyoqXG4gKiBQbGFjZXMgYW4gZWxlbWVudCBpbiBiZXR3ZWVuIG1lbWJlcnMgb2YgYSBgUmVhZG9ubHlOb25FbXB0eUFycmF5YC5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgaW50ZXJzcGVyc2UgfSBmcm9tICdmcC10cy9SZWFkb25seU5vbkVtcHR5QXJyYXknXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChpbnRlcnNwZXJzZSg5KShbMSwgMiwgMywgNF0pLCBbMSwgOSwgMiwgOSwgMywgOSwgNF0pXG4gKlxuICogQHNpbmNlIDIuOS4wXG4gKi9cbmV4cG9ydCB2YXIgaW50ZXJzcGVyc2UgPSBmdW5jdGlvbiAobWlkZGxlKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykge1xuICAgICAgICB2YXIgcmVzdCA9IHRhaWwoYXMpO1xuICAgICAgICByZXR1cm4gaXNOb25FbXB0eShyZXN0KSA/IHBpcGUocmVzdCwgcHJlcGVuZEFsbChtaWRkbGUpLCBwcmVwZW5kKGhlYWQoYXMpKSkgOiBhcztcbiAgICB9O1xufTtcbi8qKlxuICogQGNhdGVnb3J5IHNlcXVlbmNpbmdcbiAqIEBzaW5jZSAyLjEwLjBcbiAqL1xuZXhwb3J0IHZhciBjaGFpbldpdGhJbmRleCA9IGZ1bmN0aW9uIChmKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykge1xuICAgICAgICB2YXIgb3V0ID0gXy5mcm9tUmVhZG9ubHlOb25FbXB0eUFycmF5KGYoMCwgaGVhZChhcykpKTtcbiAgICAgICAgZm9yICh2YXIgaSA9IDE7IGkgPCBhcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgb3V0LnB1c2guYXBwbHkob3V0LCBmKGksIGFzW2ldKSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG91dDtcbiAgICB9O1xufTtcbi8qKlxuICogQSB1c2VmdWwgcmVjdXJzaW9uIHBhdHRlcm4gZm9yIHByb2Nlc3NpbmcgYSBgUmVhZG9ubHlOb25FbXB0eUFycmF5YCB0byBwcm9kdWNlIGEgbmV3IGBSZWFkb25seU5vbkVtcHR5QXJyYXlgLCBvZnRlbiB1c2VkIGZvciBcImNob3BwaW5nXCIgdXAgdGhlIGlucHV0XG4gKiBgUmVhZG9ubHlOb25FbXB0eUFycmF5YC4gVHlwaWNhbGx5IGBjaG9wYCBpcyBjYWxsZWQgd2l0aCBzb21lIGZ1bmN0aW9uIHRoYXQgd2lsbCBjb25zdW1lIGFuIGluaXRpYWwgcHJlZml4IG9mIHRoZSBgUmVhZG9ubHlOb25FbXB0eUFycmF5YCBhbmQgcHJvZHVjZSBhXG4gKiB2YWx1ZSBhbmQgdGhlIHRhaWwgb2YgdGhlIGBSZWFkb25seU5vbkVtcHR5QXJyYXlgLlxuICpcbiAqIEBzaW5jZSAyLjEwLjBcbiAqL1xuZXhwb3J0IHZhciBjaG9wID0gZnVuY3Rpb24gKGYpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIHZhciBfYSA9IGYoYXMpLCBiID0gX2FbMF0sIHJlc3QgPSBfYVsxXTtcbiAgICAgICAgdmFyIG91dCA9IFtiXTtcbiAgICAgICAgdmFyIG5leHQgPSByZXN0O1xuICAgICAgICB3aGlsZSAoaXNOb25FbXB0eShuZXh0KSkge1xuICAgICAgICAgICAgdmFyIF9iID0gZihuZXh0KSwgYl8xID0gX2JbMF0sIHJlc3RfMiA9IF9iWzFdO1xuICAgICAgICAgICAgb3V0LnB1c2goYl8xKTtcbiAgICAgICAgICAgIG5leHQgPSByZXN0XzI7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG91dDtcbiAgICB9O1xufTtcbi8qKlxuICogU3BsaXRzIGEgYFJlYWRvbmx5Tm9uRW1wdHlBcnJheWAgaW50byB0d28gcGllY2VzLCB0aGUgZmlyc3QgcGllY2UgaGFzIG1heCBgbmAgZWxlbWVudHMuXG4gKlxuICogQHNpbmNlIDIuMTAuMFxuICovXG5leHBvcnQgdmFyIHNwbGl0QXQgPSBmdW5jdGlvbiAobikge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgdmFyIG0gPSBNYXRoLm1heCgxLCBuKTtcbiAgICAgICAgcmV0dXJuIG0gPj0gYXMubGVuZ3RoID8gW2FzLCBlbXB0eV0gOiBbcGlwZShhcy5zbGljZSgxLCBtKSwgcHJlcGVuZChoZWFkKGFzKSkpLCBhcy5zbGljZShtKV07XG4gICAgfTtcbn07XG4vKipcbiAqIFNwbGl0cyBhIGBSZWFkb25seU5vbkVtcHR5QXJyYXlgIGludG8gbGVuZ3RoLWBuYCBwaWVjZXMuIFRoZSBsYXN0IHBpZWNlIHdpbGwgYmUgc2hvcnRlciBpZiBgbmAgZG9lcyBub3QgZXZlbmx5IGRpdmlkZSB0aGUgbGVuZ3RoIG9mXG4gKiB0aGUgYFJlYWRvbmx5Tm9uRW1wdHlBcnJheWAuXG4gKlxuICogQHNpbmNlIDIuMTAuMFxuICovXG5leHBvcnQgdmFyIGNodW5rc09mID0gZnVuY3Rpb24gKG4pIHsgcmV0dXJuIGNob3Aoc3BsaXRBdChuKSk7IH07XG52YXIgX21hcCA9IGZ1bmN0aW9uIChmYSwgZikgeyByZXR1cm4gcGlwZShmYSwgbWFwKGYpKTsgfTtcbi8qIGlzdGFuYnVsIGlnbm9yZSBuZXh0ICovXG52YXIgX21hcFdpdGhJbmRleCA9IGZ1bmN0aW9uIChmYSwgZikgeyByZXR1cm4gcGlwZShmYSwgbWFwV2l0aEluZGV4KGYpKTsgfTtcbnZhciBfYXAgPSBmdW5jdGlvbiAoZmFiLCBmYSkgeyByZXR1cm4gcGlwZShmYWIsIGFwKGZhKSk7IH07XG4vKiBpc3RhbmJ1bCBpZ25vcmUgbmV4dCAqL1xudmFyIF9leHRlbmQgPSBmdW5jdGlvbiAod2EsIGYpIHsgcmV0dXJuIHBpcGUod2EsIGV4dGVuZChmKSk7IH07XG4vKiBpc3RhbmJ1bCBpZ25vcmUgbmV4dCAqL1xudmFyIF9yZWR1Y2UgPSBmdW5jdGlvbiAoZmEsIGIsIGYpIHsgcmV0dXJuIHBpcGUoZmEsIHJlZHVjZShiLCBmKSk7IH07XG4vKiBpc3RhbmJ1bCBpZ25vcmUgbmV4dCAqL1xudmFyIF9mb2xkTWFwID0gZnVuY3Rpb24gKE0pIHtcbiAgICB2YXIgZm9sZE1hcE0gPSBmb2xkTWFwKE0pO1xuICAgIHJldHVybiBmdW5jdGlvbiAoZmEsIGYpIHsgcmV0dXJuIHBpcGUoZmEsIGZvbGRNYXBNKGYpKTsgfTtcbn07XG4vKiBpc3RhbmJ1bCBpZ25vcmUgbmV4dCAqL1xudmFyIF9yZWR1Y2VSaWdodCA9IGZ1bmN0aW9uIChmYSwgYiwgZikgeyByZXR1cm4gcGlwZShmYSwgcmVkdWNlUmlnaHQoYiwgZikpOyB9O1xuLyogaXN0YW5idWwgaWdub3JlIG5leHQgKi9cbnZhciBfdHJhdmVyc2UgPSBmdW5jdGlvbiAoRikge1xuICAgIHZhciB0cmF2ZXJzZUYgPSB0cmF2ZXJzZShGKTtcbiAgICByZXR1cm4gZnVuY3Rpb24gKHRhLCBmKSB7IHJldHVybiBwaXBlKHRhLCB0cmF2ZXJzZUYoZikpOyB9O1xufTtcbi8qIGlzdGFuYnVsIGlnbm9yZSBuZXh0ICovXG52YXIgX2FsdCA9IGZ1bmN0aW9uIChmYSwgdGhhdCkgeyByZXR1cm4gcGlwZShmYSwgYWx0KHRoYXQpKTsgfTtcbi8qIGlzdGFuYnVsIGlnbm9yZSBuZXh0ICovXG52YXIgX3JlZHVjZVdpdGhJbmRleCA9IGZ1bmN0aW9uIChmYSwgYiwgZikge1xuICAgIHJldHVybiBwaXBlKGZhLCByZWR1Y2VXaXRoSW5kZXgoYiwgZikpO1xufTtcbi8qIGlzdGFuYnVsIGlnbm9yZSBuZXh0ICovXG52YXIgX2ZvbGRNYXBXaXRoSW5kZXggPSBmdW5jdGlvbiAoTSkge1xuICAgIHZhciBmb2xkTWFwV2l0aEluZGV4TSA9IGZvbGRNYXBXaXRoSW5kZXgoTSk7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChmYSwgZikgeyByZXR1cm4gcGlwZShmYSwgZm9sZE1hcFdpdGhJbmRleE0oZikpOyB9O1xufTtcbi8qIGlzdGFuYnVsIGlnbm9yZSBuZXh0ICovXG52YXIgX3JlZHVjZVJpZ2h0V2l0aEluZGV4ID0gZnVuY3Rpb24gKGZhLCBiLCBmKSB7XG4gICAgcmV0dXJuIHBpcGUoZmEsIHJlZHVjZVJpZ2h0V2l0aEluZGV4KGIsIGYpKTtcbn07XG4vKiBpc3RhbmJ1bCBpZ25vcmUgbmV4dCAqL1xudmFyIF90cmF2ZXJzZVdpdGhJbmRleCA9IGZ1bmN0aW9uIChGKSB7XG4gICAgdmFyIHRyYXZlcnNlV2l0aEluZGV4RiA9IHRyYXZlcnNlV2l0aEluZGV4KEYpO1xuICAgIHJldHVybiBmdW5jdGlvbiAodGEsIGYpIHsgcmV0dXJuIHBpcGUodGEsIHRyYXZlcnNlV2l0aEluZGV4RihmKSk7IH07XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgY29uc3RydWN0b3JzXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBvZiA9IF8uc2luZ2xldG9uO1xuLyoqXG4gKiBMZXNzIHN0cmljdCB2ZXJzaW9uIG9mIFtgYWx0YF0oI2FsdCkuXG4gKlxuICogVGhlIGBXYCBzdWZmaXggKHNob3J0IGZvciAqKlcqKmlkZW5pbmcpIG1lYW5zIHRoYXQgdGhlIHJldHVybiB0eXBlcyB3aWxsIGJlIG1lcmdlZC5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0ICogYXMgUk5FQSBmcm9tICdmcC10cy9SZWFkb25seU5vbkVtcHR5QXJyYXknXG4gKiBpbXBvcnQgeyBwaXBlIH0gZnJvbSAnZnAtdHMvZnVuY3Rpb24nXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChcbiAqICAgcGlwZShcbiAqICAgICBbMSwgMiwgM10gYXMgUk5FQS5SZWFkb25seU5vbkVtcHR5QXJyYXk8bnVtYmVyPixcbiAqICAgICBSTkVBLmFsdFcoKCkgPT4gWydhJywgJ2InXSlcbiAqICAgKSxcbiAqICAgWzEsIDIsIDMsICdhJywgJ2InXVxuICogKVxuICpcbiAqIEBjYXRlZ29yeSBlcnJvciBoYW5kbGluZ1xuICogQHNpbmNlIDIuOS4wXG4gKi9cbmV4cG9ydCB2YXIgYWx0VyA9IGZ1bmN0aW9uICh0aGF0KSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykge1xuICAgICAgICByZXR1cm4gcGlwZShhcywgY29uY2F0Vyh0aGF0KCkpKTtcbiAgICB9O1xufTtcbi8qKlxuICogSWRlbnRpZmllcyBhbiBhc3NvY2lhdGl2ZSBvcGVyYXRpb24gb24gYSB0eXBlIGNvbnN0cnVjdG9yLiBJdCBpcyBzaW1pbGFyIHRvIGBTZW1pZ3JvdXBgLCBleGNlcHQgdGhhdCBpdCBhcHBsaWVzIHRvXG4gKiB0eXBlcyBvZiBraW5kIGAqIC0+ICpgLlxuICpcbiAqIEluIGNhc2Ugb2YgYFJlYWRvbmx5Tm9uRW1wdHlBcnJheWAgY29uY2F0ZW5hdGVzIHRoZSBpbnB1dHMgaW50byBhIHNpbmdsZSBhcnJheS5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0ICogYXMgUk5FQSBmcm9tICdmcC10cy9SZWFkb25seU5vbkVtcHR5QXJyYXknXG4gKiBpbXBvcnQgeyBwaXBlIH0gZnJvbSAnZnAtdHMvZnVuY3Rpb24nXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChcbiAqICAgcGlwZShcbiAqICAgICBbMSwgMiwgM10sXG4gKiAgICAgUk5FQS5hbHQoKCkgPT4gWzQsIDVdKVxuICogICApLFxuICogICBbMSwgMiwgMywgNCwgNV1cbiAqIClcbiAqXG4gKiBAY2F0ZWdvcnkgZXJyb3IgaGFuZGxpbmdcbiAqIEBzaW5jZSAyLjYuMlxuICovXG5leHBvcnQgdmFyIGFsdCA9IGFsdFc7XG4vKipcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIGFwID0gZnVuY3Rpb24gKGFzKSB7IHJldHVybiBmbGF0TWFwKGZ1bmN0aW9uIChmKSB7IHJldHVybiBwaXBlKGFzLCBtYXAoZikpOyB9KTsgfTtcbi8qKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCAqIGFzIFJORUEgZnJvbSAnZnAtdHMvUmVhZG9ubHlOb25FbXB0eUFycmF5J1xuICogaW1wb3J0IHsgcGlwZSB9IGZyb20gJ2ZwLXRzL2Z1bmN0aW9uJ1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoXG4gKiAgIHBpcGUoXG4gKiAgICAgWzEsIDIsIDNdLFxuICogICAgIFJORUEuZmxhdE1hcCgobikgPT4gW2BhJHtufWAsIGBiJHtufWBdKVxuICogICApLFxuICogICBbJ2ExJywgJ2IxJywgJ2EyJywgJ2IyJywgJ2EzJywgJ2IzJ11cbiAqIClcbiAqXG4gKiBAY2F0ZWdvcnkgc2VxdWVuY2luZ1xuICogQHNpbmNlIDIuMTQuMFxuICovXG5leHBvcnQgdmFyIGZsYXRNYXAgPSAvKiNfX1BVUkVfXyovIGR1YWwoMiwgZnVuY3Rpb24gKG1hLCBmKSB7XG4gICAgcmV0dXJuIHBpcGUobWEsIGNoYWluV2l0aEluZGV4KGZ1bmN0aW9uIChpLCBhKSB7IHJldHVybiBmKGEsIGkpOyB9KSk7XG59KTtcbi8qKlxuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgZXh0ZW5kID0gZnVuY3Rpb24gKGYpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIHZhciBuZXh0ID0gdGFpbChhcyk7XG4gICAgICAgIHZhciBvdXQgPSBbZihhcyldO1xuICAgICAgICB3aGlsZSAoaXNOb25FbXB0eShuZXh0KSkge1xuICAgICAgICAgICAgb3V0LnB1c2goZihuZXh0KSk7XG4gICAgICAgICAgICBuZXh0ID0gdGFpbChuZXh0KTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gb3V0O1xuICAgIH07XG59O1xuLyoqXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBkdXBsaWNhdGUgPSBcbi8qI19fUFVSRV9fKi8gZXh0ZW5kKGlkZW50aXR5KTtcbi8qKlxuICogQGNhdGVnb3J5IHNlcXVlbmNpbmdcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIGZsYXR0ZW4gPSBcbi8qI19fUFVSRV9fKi8gZmxhdE1hcChpZGVudGl0eSk7XG4vKipcbiAqIGBtYXBgIGNhbiBiZSB1c2VkIHRvIHR1cm4gZnVuY3Rpb25zIGAoYTogQSkgPT4gQmAgaW50byBmdW5jdGlvbnMgYChmYTogRjxBPikgPT4gRjxCPmAgd2hvc2UgYXJndW1lbnQgYW5kIHJldHVybiB0eXBlc1xuICogdXNlIHRoZSB0eXBlIGNvbnN0cnVjdG9yIGBGYCB0byByZXByZXNlbnQgc29tZSBjb21wdXRhdGlvbmFsIGNvbnRleHQuXG4gKlxuICogQGNhdGVnb3J5IG1hcHBpbmdcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIG1hcCA9IGZ1bmN0aW9uIChmKSB7XG4gICAgcmV0dXJuIG1hcFdpdGhJbmRleChmdW5jdGlvbiAoXywgYSkgeyByZXR1cm4gZihhKTsgfSk7XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgbWFwcGluZ1xuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgbWFwV2l0aEluZGV4ID0gZnVuY3Rpb24gKGYpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIHZhciBvdXQgPSBbZigwLCBoZWFkKGFzKSldO1xuICAgICAgICBmb3IgKHZhciBpID0gMTsgaSA8IGFzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICBvdXQucHVzaChmKGksIGFzW2ldKSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG91dDtcbiAgICB9O1xufTtcbi8qKlxuICogQGNhdGVnb3J5IGZvbGRpbmdcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIHJlZHVjZSA9IGZ1bmN0aW9uIChiLCBmKSB7XG4gICAgcmV0dXJuIHJlZHVjZVdpdGhJbmRleChiLCBmdW5jdGlvbiAoXywgYiwgYSkgeyByZXR1cm4gZihiLCBhKTsgfSk7XG59O1xuLyoqXG4gKiAqKk5vdGUqKi4gVGhlIGNvbnN0cmFpbnQgaXMgcmVsYXhlZDogYSBgU2VtaWdyb3VwYCBpbnN0ZWFkIG9mIGEgYE1vbm9pZGAuXG4gKlxuICogQGNhdGVnb3J5IGZvbGRpbmdcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIGZvbGRNYXAgPSBmdW5jdGlvbiAoUykge1xuICAgIHJldHVybiBmdW5jdGlvbiAoZikge1xuICAgICAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgICAgICByZXR1cm4gYXMuc2xpY2UoMSkucmVkdWNlKGZ1bmN0aW9uIChzLCBhKSB7IHJldHVybiBTLmNvbmNhdChzLCBmKGEpKTsgfSwgZihhc1swXSkpO1xuICAgICAgICB9O1xuICAgIH07XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgZm9sZGluZ1xuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgcmVkdWNlUmlnaHQgPSBmdW5jdGlvbiAoYiwgZikge1xuICAgIHJldHVybiByZWR1Y2VSaWdodFdpdGhJbmRleChiLCBmdW5jdGlvbiAoXywgYiwgYSkgeyByZXR1cm4gZihiLCBhKTsgfSk7XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgZm9sZGluZ1xuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgcmVkdWNlV2l0aEluZGV4ID0gZnVuY3Rpb24gKGIsIGYpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIHJldHVybiBhcy5yZWR1Y2UoZnVuY3Rpb24gKGIsIGEsIGkpIHsgcmV0dXJuIGYoaSwgYiwgYSk7IH0sIGIpO1xuICAgIH07XG59O1xuLyoqXG4gKiAqKk5vdGUqKi4gVGhlIGNvbnN0cmFpbnQgaXMgcmVsYXhlZDogYSBgU2VtaWdyb3VwYCBpbnN0ZWFkIG9mIGEgYE1vbm9pZGAuXG4gKlxuICogQGNhdGVnb3J5IGZvbGRpbmdcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIGZvbGRNYXBXaXRoSW5kZXggPSBmdW5jdGlvbiAoUykge1xuICAgIHJldHVybiBmdW5jdGlvbiAoZikge1xuICAgICAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgICAgICByZXR1cm4gYXMuc2xpY2UoMSkucmVkdWNlKGZ1bmN0aW9uIChzLCBhLCBpKSB7IHJldHVybiBTLmNvbmNhdChzLCBmKGkgKyAxLCBhKSk7IH0sIGYoMCwgYXNbMF0pKTtcbiAgICAgICAgfTtcbiAgICB9O1xufTtcbi8qKlxuICogQGNhdGVnb3J5IGZvbGRpbmdcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIHJlZHVjZVJpZ2h0V2l0aEluZGV4ID0gZnVuY3Rpb24gKGIsIGYpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIHJldHVybiBhcy5yZWR1Y2VSaWdodChmdW5jdGlvbiAoYiwgYSwgaSkgeyByZXR1cm4gZihpLCBhLCBiKTsgfSwgYik7XG4gICAgfTtcbn07XG4vKipcbiAqIEBjYXRlZ29yeSB0cmF2ZXJzaW5nXG4gKiBAc2luY2UgMi42LjNcbiAqL1xuZXhwb3J0IHZhciB0cmF2ZXJzZSA9IGZ1bmN0aW9uIChGKSB7XG4gICAgdmFyIHRyYXZlcnNlV2l0aEluZGV4RiA9IHRyYXZlcnNlV2l0aEluZGV4KEYpO1xuICAgIHJldHVybiBmdW5jdGlvbiAoZikgeyByZXR1cm4gdHJhdmVyc2VXaXRoSW5kZXhGKGZ1bmN0aW9uIChfLCBhKSB7IHJldHVybiBmKGEpOyB9KTsgfTtcbn07XG4vKipcbiAqIEBjYXRlZ29yeSB0cmF2ZXJzaW5nXG4gKiBAc2luY2UgMi42LjNcbiAqL1xuZXhwb3J0IHZhciBzZXF1ZW5jZSA9IGZ1bmN0aW9uIChGKSB7IHJldHVybiB0cmF2ZXJzZVdpdGhJbmRleChGKShTSyk7IH07XG4vKipcbiAqIEBjYXRlZ29yeSBzZXF1ZW5jaW5nXG4gKiBAc2luY2UgMi42LjNcbiAqL1xuZXhwb3J0IHZhciB0cmF2ZXJzZVdpdGhJbmRleCA9IGZ1bmN0aW9uIChGKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChmKSB7XG4gICAgICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgICAgIHZhciBvdXQgPSBGLm1hcChmKDAsIGhlYWQoYXMpKSwgb2YpO1xuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDE7IGkgPCBhcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgIG91dCA9IEYuYXAoRi5tYXAob3V0LCBmdW5jdGlvbiAoYnMpIHsgcmV0dXJuIGZ1bmN0aW9uIChiKSB7IHJldHVybiBwaXBlKGJzLCBhcHBlbmQoYikpOyB9OyB9KSwgZihpLCBhc1tpXSkpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIG91dDtcbiAgICAgICAgfTtcbiAgICB9O1xufTtcbi8qKlxuICogQGNhdGVnb3J5IENvbW9uYWRcbiAqIEBzaW5jZSAyLjYuM1xuICovXG5leHBvcnQgdmFyIGV4dHJhY3QgPSBfLmhlYWQ7XG4vKipcbiAqIEBjYXRlZ29yeSB0eXBlIGxhbWJkYXNcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIFVSSSA9ICdSZWFkb25seU5vbkVtcHR5QXJyYXknO1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBnZXRTaG93ID0gZnVuY3Rpb24gKFMpIHsgcmV0dXJuICh7XG4gICAgc2hvdzogZnVuY3Rpb24gKGFzKSB7IHJldHVybiBcIltcIi5jb25jYXQoYXMubWFwKFMuc2hvdykuam9pbignLCAnKSwgXCJdXCIpOyB9XG59KTsgfTtcbi8qKlxuICogQnVpbGRzIGEgYFNlbWlncm91cGAgaW5zdGFuY2UgZm9yIGBSZWFkb25seU5vbkVtcHR5QXJyYXlgXG4gKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgZ2V0U2VtaWdyb3VwID0gZnVuY3Rpb24gKCkgeyByZXR1cm4gKHtcbiAgICBjb25jYXQ6IGNvbmNhdFxufSk7IH07XG4vKipcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBnZXRFcSB9IGZyb20gJ2ZwLXRzL1JlYWRvbmx5Tm9uRW1wdHlBcnJheSdcbiAqIGltcG9ydCAqIGFzIE4gZnJvbSAnZnAtdHMvbnVtYmVyJ1xuICpcbiAqIGNvbnN0IEUgPSBnZXRFcShOLkVxKVxuICogYXNzZXJ0LnN0cmljdEVxdWFsKEUuZXF1YWxzKFsxLCAyXSwgWzEsIDJdKSwgdHJ1ZSlcbiAqIGFzc2VydC5zdHJpY3RFcXVhbChFLmVxdWFscyhbMSwgMl0sIFsxLCAzXSksIGZhbHNlKVxuICpcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIGdldEVxID0gZnVuY3Rpb24gKEUpIHtcbiAgICByZXR1cm4gZnJvbUVxdWFscyhmdW5jdGlvbiAoeHMsIHlzKSB7IHJldHVybiB4cy5sZW5ndGggPT09IHlzLmxlbmd0aCAmJiB4cy5ldmVyeShmdW5jdGlvbiAoeCwgaSkgeyByZXR1cm4gRS5lcXVhbHMoeCwgeXNbaV0pOyB9KTsgfSk7XG59O1xuLyoqXG4gKiBAc2luY2UgMi4xMS4wXG4gKi9cbmV4cG9ydCB2YXIgZ2V0VW5pb25TZW1pZ3JvdXAgPSBmdW5jdGlvbiAoRSkge1xuICAgIHZhciB1bmlvbkUgPSB1bmlvbihFKTtcbiAgICByZXR1cm4ge1xuICAgICAgICBjb25jYXQ6IGZ1bmN0aW9uIChmaXJzdCwgc2Vjb25kKSB7IHJldHVybiB1bmlvbkUoc2Vjb25kKShmaXJzdCk7IH1cbiAgICB9O1xufTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuNy4wXG4gKi9cbmV4cG9ydCB2YXIgRnVuY3RvciA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICBtYXA6IF9tYXBcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBtYXBwaW5nXG4gKiBAc2luY2UgMi4xMC4wXG4gKi9cbmV4cG9ydCB2YXIgZmxhcCA9IC8qI19fUFVSRV9fKi8gZmxhcF8oRnVuY3Rvcik7XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjEwLjBcbiAqL1xuZXhwb3J0IHZhciBQb2ludGVkID0ge1xuICAgIFVSSTogVVJJLFxuICAgIG9mOiBvZlxufTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuNy4wXG4gKi9cbmV4cG9ydCB2YXIgRnVuY3RvcldpdGhJbmRleCA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICBtYXA6IF9tYXAsXG4gICAgbWFwV2l0aEluZGV4OiBfbWFwV2l0aEluZGV4XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi4xMC4wXG4gKi9cbmV4cG9ydCB2YXIgQXBwbHkgPSB7XG4gICAgVVJJOiBVUkksXG4gICAgbWFwOiBfbWFwLFxuICAgIGFwOiBfYXBcbn07XG4vKipcbiAqIENvbWJpbmUgdHdvIGVmZmVjdGZ1bCBhY3Rpb25zLCBrZWVwaW5nIG9ubHkgdGhlIHJlc3VsdCBvZiB0aGUgZmlyc3QuXG4gKlxuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgYXBGaXJzdCA9IC8qI19fUFVSRV9fKi8gYXBGaXJzdF8oQXBwbHkpO1xuLyoqXG4gKiBDb21iaW5lIHR3byBlZmZlY3RmdWwgYWN0aW9ucywga2VlcGluZyBvbmx5IHRoZSByZXN1bHQgb2YgdGhlIHNlY29uZC5cbiAqXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBhcFNlY29uZCA9IC8qI19fUFVSRV9fKi8gYXBTZWNvbmRfKEFwcGx5KTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuNy4wXG4gKi9cbmV4cG9ydCB2YXIgQXBwbGljYXRpdmUgPSB7XG4gICAgVVJJOiBVUkksXG4gICAgbWFwOiBfbWFwLFxuICAgIGFwOiBfYXAsXG4gICAgb2Y6IG9mXG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi4xMC4wXG4gKi9cbmV4cG9ydCB2YXIgQ2hhaW4gPSB7XG4gICAgVVJJOiBVUkksXG4gICAgbWFwOiBfbWFwLFxuICAgIGFwOiBfYXAsXG4gICAgY2hhaW46IGZsYXRNYXBcbn07XG4vKipcbiAqIENvbXBvc2VzIGNvbXB1dGF0aW9ucyBpbiBzZXF1ZW5jZSwgdXNpbmcgdGhlIHJldHVybiB2YWx1ZSBvZiBvbmUgY29tcHV0YXRpb24gdG8gZGV0ZXJtaW5lIHRoZSBuZXh0IGNvbXB1dGF0aW9uIGFuZFxuICoga2VlcGluZyBvbmx5IHRoZSByZXN1bHQgb2YgdGhlIGZpcnN0LlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgKiBhcyBSQSBmcm9tICdmcC10cy9SZWFkb25seUFycmF5J1xuICogaW1wb3J0IHsgcGlwZSB9IGZyb20gJ2ZwLXRzL2Z1bmN0aW9uJ1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoXG4gKiAgIHBpcGUoXG4gKiAgICAgWzEsIDIsIDNdLFxuICogICAgIFJBLmNoYWluRmlyc3QoKCkgPT4gWydhJywgJ2InXSlcbiAqICAgKSxcbiAqICAgWzEsIDEsIDIsIDIsIDMsIDNdXG4gKiApXG4gKlxuICogQGNhdGVnb3J5IHNlcXVlbmNpbmdcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIGNoYWluRmlyc3QgPSAvKiNfX1BVUkVfXyovIGNoYWluRmlyc3RfKENoYWluKTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuNy4wXG4gKi9cbmV4cG9ydCB2YXIgTW9uYWQgPSB7XG4gICAgVVJJOiBVUkksXG4gICAgbWFwOiBfbWFwLFxuICAgIGFwOiBfYXAsXG4gICAgb2Y6IG9mLFxuICAgIGNoYWluOiBmbGF0TWFwXG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi43LjBcbiAqL1xuZXhwb3J0IHZhciBGb2xkYWJsZSA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICByZWR1Y2U6IF9yZWR1Y2UsXG4gICAgZm9sZE1hcDogX2ZvbGRNYXAsXG4gICAgcmVkdWNlUmlnaHQ6IF9yZWR1Y2VSaWdodFxufTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuNy4wXG4gKi9cbmV4cG9ydCB2YXIgRm9sZGFibGVXaXRoSW5kZXggPSB7XG4gICAgVVJJOiBVUkksXG4gICAgcmVkdWNlOiBfcmVkdWNlLFxuICAgIGZvbGRNYXA6IF9mb2xkTWFwLFxuICAgIHJlZHVjZVJpZ2h0OiBfcmVkdWNlUmlnaHQsXG4gICAgcmVkdWNlV2l0aEluZGV4OiBfcmVkdWNlV2l0aEluZGV4LFxuICAgIGZvbGRNYXBXaXRoSW5kZXg6IF9mb2xkTWFwV2l0aEluZGV4LFxuICAgIHJlZHVjZVJpZ2h0V2l0aEluZGV4OiBfcmVkdWNlUmlnaHRXaXRoSW5kZXhcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjcuMFxuICovXG5leHBvcnQgdmFyIFRyYXZlcnNhYmxlID0ge1xuICAgIFVSSTogVVJJLFxuICAgIG1hcDogX21hcCxcbiAgICByZWR1Y2U6IF9yZWR1Y2UsXG4gICAgZm9sZE1hcDogX2ZvbGRNYXAsXG4gICAgcmVkdWNlUmlnaHQ6IF9yZWR1Y2VSaWdodCxcbiAgICB0cmF2ZXJzZTogX3RyYXZlcnNlLFxuICAgIHNlcXVlbmNlOiBzZXF1ZW5jZVxufTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuNy4wXG4gKi9cbmV4cG9ydCB2YXIgVHJhdmVyc2FibGVXaXRoSW5kZXggPSB7XG4gICAgVVJJOiBVUkksXG4gICAgbWFwOiBfbWFwLFxuICAgIG1hcFdpdGhJbmRleDogX21hcFdpdGhJbmRleCxcbiAgICByZWR1Y2U6IF9yZWR1Y2UsXG4gICAgZm9sZE1hcDogX2ZvbGRNYXAsXG4gICAgcmVkdWNlUmlnaHQ6IF9yZWR1Y2VSaWdodCxcbiAgICB0cmF2ZXJzZTogX3RyYXZlcnNlLFxuICAgIHNlcXVlbmNlOiBzZXF1ZW5jZSxcbiAgICByZWR1Y2VXaXRoSW5kZXg6IF9yZWR1Y2VXaXRoSW5kZXgsXG4gICAgZm9sZE1hcFdpdGhJbmRleDogX2ZvbGRNYXBXaXRoSW5kZXgsXG4gICAgcmVkdWNlUmlnaHRXaXRoSW5kZXg6IF9yZWR1Y2VSaWdodFdpdGhJbmRleCxcbiAgICB0cmF2ZXJzZVdpdGhJbmRleDogX3RyYXZlcnNlV2l0aEluZGV4XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi43LjBcbiAqL1xuZXhwb3J0IHZhciBBbHQgPSB7XG4gICAgVVJJOiBVUkksXG4gICAgbWFwOiBfbWFwLFxuICAgIGFsdDogX2FsdFxufTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuNy4wXG4gKi9cbmV4cG9ydCB2YXIgQ29tb25hZCA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICBtYXA6IF9tYXAsXG4gICAgZXh0ZW5kOiBfZXh0ZW5kLFxuICAgIGV4dHJhY3Q6IGV4dHJhY3Rcbn07XG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vLyBkbyBub3RhdGlvblxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLyoqXG4gKiBAY2F0ZWdvcnkgZG8gbm90YXRpb25cbiAqIEBzaW5jZSAyLjkuMFxuICovXG5leHBvcnQgdmFyIERvID0gLyojX19QVVJFX18qLyBvZihfLmVtcHR5UmVjb3JkKTtcbi8qKlxuICogQGNhdGVnb3J5IGRvIG5vdGF0aW9uXG4gKiBAc2luY2UgMi44LjBcbiAqL1xuZXhwb3J0IHZhciBiaW5kVG8gPSAvKiNfX1BVUkVfXyovIGJpbmRUb18oRnVuY3Rvcik7XG52YXIgbGV0XyA9IC8qI19fUFVSRV9fKi8gbGV0X18oRnVuY3Rvcik7XG5leHBvcnQgeyBcbi8qKlxuICogQGNhdGVnb3J5IGRvIG5vdGF0aW9uXG4gKiBAc2luY2UgMi4xMy4wXG4gKi9cbmxldF8gYXMgbGV0IH07XG4vKipcbiAqIEBjYXRlZ29yeSBkbyBub3RhdGlvblxuICogQHNpbmNlIDIuOC4wXG4gKi9cbmV4cG9ydCB2YXIgYmluZCA9IC8qI19fUFVSRV9fKi8gYmluZF8oQ2hhaW4pO1xuLyoqXG4gKiBAY2F0ZWdvcnkgZG8gbm90YXRpb25cbiAqIEBzaW5jZSAyLjguMFxuICovXG5leHBvcnQgdmFyIGFwUyA9IC8qI19fUFVSRV9fKi8gYXBTXyhBcHBseSk7XG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vLyB1dGlsc1xuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLyoqXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBoZWFkID0gZXh0cmFjdDtcbi8qKlxuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgdGFpbCA9IF8udGFpbDtcbi8qKlxuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgbGFzdCA9IGZ1bmN0aW9uIChhcykgeyByZXR1cm4gYXNbYXMubGVuZ3RoIC0gMV07IH07XG4vKipcbiAqIEdldCBhbGwgYnV0IHRoZSBsYXN0IGVsZW1lbnQgb2YgYSBub24gZW1wdHkgYXJyYXksIGNyZWF0aW5nIGEgbmV3IGFycmF5LlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBpbml0IH0gZnJvbSAnZnAtdHMvUmVhZG9ubHlOb25FbXB0eUFycmF5J1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoaW5pdChbMSwgMiwgM10pLCBbMSwgMl0pXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKGluaXQoWzFdKSwgW10pXG4gKlxuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgaW5pdCA9IGZ1bmN0aW9uIChhcykgeyByZXR1cm4gYXMuc2xpY2UoMCwgLTEpOyB9O1xuLyoqXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBtaW4gPSBmdW5jdGlvbiAoTykge1xuICAgIHZhciBTID0gU2UubWluKE8pO1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHsgcmV0dXJuIGFzLnJlZHVjZShTLmNvbmNhdCk7IH07XG59O1xuLyoqXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBtYXggPSBmdW5jdGlvbiAoTykge1xuICAgIHZhciBTID0gU2UubWF4KE8pO1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHsgcmV0dXJuIGFzLnJlZHVjZShTLmNvbmNhdCk7IH07XG59O1xuLyoqXG4gKiBAc2luY2UgMi4xMC4wXG4gKi9cbmV4cG9ydCB2YXIgY29uY2F0QWxsID0gZnVuY3Rpb24gKFMpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIHJldHVybiBhcy5yZWR1Y2UoUy5jb25jYXQpO1xuICAgIH07XG59O1xuLyoqXG4gKiBCcmVhayBhIGBSZWFkb25seUFycmF5YCBpbnRvIGl0cyBmaXJzdCBlbGVtZW50IGFuZCByZW1haW5pbmcgZWxlbWVudHMuXG4gKlxuICogQGNhdGVnb3J5IHBhdHRlcm4gbWF0Y2hpbmdcbiAqIEBzaW5jZSAyLjExLjBcbiAqL1xuZXhwb3J0IHZhciBtYXRjaExlZnQgPSBmdW5jdGlvbiAoZikge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgcmV0dXJuIGYoaGVhZChhcyksIHRhaWwoYXMpKTtcbiAgICB9O1xufTtcbi8qKlxuICogQnJlYWsgYSBgUmVhZG9ubHlBcnJheWAgaW50byBpdHMgaW5pdGlhbCBlbGVtZW50cyBhbmQgdGhlIGxhc3QgZWxlbWVudC5cbiAqXG4gKiBAY2F0ZWdvcnkgcGF0dGVybiBtYXRjaGluZ1xuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIG1hdGNoUmlnaHQgPSBmdW5jdGlvbiAoZikge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgcmV0dXJuIGYoaW5pdChhcyksIGxhc3QoYXMpKTtcbiAgICB9O1xufTtcbi8qKlxuICogQXBwbHkgYSBmdW5jdGlvbiB0byB0aGUgaGVhZCwgY3JlYXRpbmcgYSBuZXcgYFJlYWRvbmx5Tm9uRW1wdHlBcnJheWAuXG4gKlxuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIG1vZGlmeUhlYWQgPSBmdW5jdGlvbiAoZikge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgcmV0dXJuIF9fc3ByZWFkQXJyYXkoW2YoaGVhZChhcykpXSwgdGFpbChhcyksIHRydWUpO1xuICAgIH07XG59O1xuLyoqXG4gKiBDaGFuZ2UgdGhlIGhlYWQsIGNyZWF0aW5nIGEgbmV3IGBSZWFkb25seU5vbkVtcHR5QXJyYXlgLlxuICpcbiAqIEBzaW5jZSAyLjExLjBcbiAqL1xuZXhwb3J0IHZhciB1cGRhdGVIZWFkID0gZnVuY3Rpb24gKGEpIHsgcmV0dXJuIG1vZGlmeUhlYWQoZnVuY3Rpb24gKCkgeyByZXR1cm4gYTsgfSk7IH07XG4vKipcbiAqIEFwcGx5IGEgZnVuY3Rpb24gdG8gdGhlIGxhc3QgZWxlbWVudCwgY3JlYXRpbmcgYSBuZXcgYFJlYWRvbmx5Tm9uRW1wdHlBcnJheWAuXG4gKlxuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIG1vZGlmeUxhc3QgPSBmdW5jdGlvbiAoZikge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgcmV0dXJuIHBpcGUoaW5pdChhcyksIGFwcGVuZChmKGxhc3QoYXMpKSkpO1xuICAgIH07XG59O1xuLyoqXG4gKiBDaGFuZ2UgdGhlIGxhc3QgZWxlbWVudCwgY3JlYXRpbmcgYSBuZXcgYFJlYWRvbmx5Tm9uRW1wdHlBcnJheWAuXG4gKlxuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIHVwZGF0ZUxhc3QgPSBmdW5jdGlvbiAoYSkgeyByZXR1cm4gbW9kaWZ5TGFzdChmdW5jdGlvbiAoKSB7IHJldHVybiBhOyB9KTsgfTtcbi8qKlxuICogUGxhY2VzIGFuIGVsZW1lbnQgaW4gYmV0d2VlbiBtZW1iZXJzIG9mIGEgYFJlYWRvbmx5Tm9uRW1wdHlBcnJheWAsIHRoZW4gZm9sZHMgdGhlIHJlc3VsdHMgdXNpbmcgdGhlIHByb3ZpZGVkIGBTZW1pZ3JvdXBgLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgKiBhcyBTIGZyb20gJ2ZwLXRzL3N0cmluZydcbiAqIGltcG9ydCB7IGludGVyY2FsYXRlIH0gZnJvbSAnZnAtdHMvUmVhZG9ubHlOb25FbXB0eUFycmF5J1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoaW50ZXJjYWxhdGUoUy5TZW1pZ3JvdXApKCctJykoWydhJywgJ2InLCAnYyddKSwgJ2EtYi1jJylcbiAqXG4gKiBAc2luY2UgMi4xMi4wXG4gKi9cbmV4cG9ydCB2YXIgaW50ZXJjYWxhdGUgPSBmdW5jdGlvbiAoUykge1xuICAgIHZhciBjb25jYXRBbGxTID0gY29uY2F0QWxsKFMpO1xuICAgIHJldHVybiBmdW5jdGlvbiAobWlkZGxlKSB7IHJldHVybiBmbG93KGludGVyc3BlcnNlKG1pZGRsZSksIGNvbmNhdEFsbFMpOyB9O1xufTtcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8vIGxlZ2FjeVxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLyoqXG4gKiBBbGlhcyBvZiBgZmxhdE1hcGAuXG4gKlxuICogQGNhdGVnb3J5IGxlZ2FjeVxuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgY2hhaW4gPSBmbGF0TWFwO1xuZXhwb3J0IGZ1bmN0aW9uIGdyb3VwU29ydChPKSB7XG4gICAgdmFyIHNvcnRPID0gc29ydChPKTtcbiAgICB2YXIgZ3JvdXBPID0gZ3JvdXAoTyk7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykgeyByZXR1cm4gKGlzTm9uRW1wdHkoYXMpID8gZ3JvdXBPKHNvcnRPKGFzKSkgOiBlbXB0eSk7IH07XG59XG5leHBvcnQgZnVuY3Rpb24gZmlsdGVyKHByZWRpY2F0ZSkge1xuICAgIHJldHVybiBmaWx0ZXJXaXRoSW5kZXgoZnVuY3Rpb24gKF8sIGEpIHsgcmV0dXJuIHByZWRpY2F0ZShhKTsgfSk7XG59XG4vKipcbiAqIFVzZSBbYGZpbHRlcldpdGhJbmRleGBdKC4vUmVhZG9ubHlBcnJheS50cy5odG1sI2ZpbHRlcndpdGhpbmRleCkgaW5zdGVhZC5cbiAqXG4gKiBAY2F0ZWdvcnkgem9uZSBvZiBkZWF0aFxuICogQHNpbmNlIDIuNS4wXG4gKiBAZGVwcmVjYXRlZFxuICovXG5leHBvcnQgdmFyIGZpbHRlcldpdGhJbmRleCA9IGZ1bmN0aW9uIChwcmVkaWNhdGUpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIHJldHVybiBmcm9tUmVhZG9ubHlBcnJheShhcy5maWx0ZXIoZnVuY3Rpb24gKGEsIGkpIHsgcmV0dXJuIHByZWRpY2F0ZShpLCBhKTsgfSkpO1xuICAgIH07XG59O1xuLyoqXG4gKiBVc2UgW2B1bnByZXBlbmRgXSgjdW5wcmVwZW5kKSBpbnN0ZWFkLlxuICpcbiAqIEBjYXRlZ29yeSB6b25lIG9mIGRlYXRoXG4gKiBAc2luY2UgMi4xMC4wXG4gKiBAZGVwcmVjYXRlZFxuICovXG5leHBvcnQgdmFyIHVuY29ucyA9IHVucHJlcGVuZDtcbi8qKlxuICogVXNlIFtgdW5hcHBlbmRgXSgjdW5hcHBlbmQpIGluc3RlYWQuXG4gKlxuICogQGNhdGVnb3J5IHpvbmUgb2YgZGVhdGhcbiAqIEBzaW5jZSAyLjEwLjBcbiAqIEBkZXByZWNhdGVkXG4gKi9cbmV4cG9ydCB2YXIgdW5zbm9jID0gdW5hcHBlbmQ7XG5leHBvcnQgZnVuY3Rpb24gY29ucyhoZWFkLCB0YWlsKSB7XG4gICAgcmV0dXJuIHRhaWwgPT09IHVuZGVmaW5lZCA/IHByZXBlbmQoaGVhZCkgOiBwaXBlKHRhaWwsIHByZXBlbmQoaGVhZCkpO1xufVxuLyoqXG4gKiBVc2UgW2BhcHBlbmRgXSguL1JlYWRvbmx5QXJyYXkudHMuaHRtbCNhcHBlbmQpIGluc3RlYWQuXG4gKlxuICogQGNhdGVnb3J5IHpvbmUgb2YgZGVhdGhcbiAqIEBzaW5jZSAyLjUuMFxuICogQGRlcHJlY2F0ZWRcbiAqL1xuZXhwb3J0IHZhciBzbm9jID0gZnVuY3Rpb24gKGluaXQsIGVuZCkgeyByZXR1cm4gcGlwZShpbml0LCBjb25jYXQoW2VuZF0pKTsgfTtcbi8qKlxuICogVXNlIFtgaW5zZXJ0QXRgXSguL1JlYWRvbmx5QXJyYXkudHMuaHRtbCNpbnNlcnRhdCkgaW5zdGVhZC5cbiAqXG4gKiBAY2F0ZWdvcnkgem9uZSBvZiBkZWF0aFxuICogQHNpbmNlIDIuNS4wXG4gKiBAZGVwcmVjYXRlZFxuICovXG5leHBvcnQgdmFyIGluc2VydEF0ID0gZnVuY3Rpb24gKGksIGEpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIHJldHVybiBpIDwgMCB8fCBpID4gYXMubGVuZ3RoID8gXy5ub25lIDogXy5zb21lKHVuc2FmZUluc2VydEF0KGksIGEsIGFzKSk7XG4gICAgfTtcbn07XG4vKipcbiAqIFVzZSBbYHByZXBlbmRBbGxgXSgjcHJlcGVuZGFsbCkgaW5zdGVhZC5cbiAqXG4gKiBAY2F0ZWdvcnkgem9uZSBvZiBkZWF0aFxuICogQHNpbmNlIDIuOS4wXG4gKiBAZGVwcmVjYXRlZFxuICovXG5leHBvcnQgdmFyIHByZXBlbmRUb0FsbCA9IHByZXBlbmRBbGw7XG4vKipcbiAqIFVzZSBbYGNvbmNhdEFsbGBdKCNjb25jYXRhbGwpIGluc3RlYWQuXG4gKlxuICogQGNhdGVnb3J5IHpvbmUgb2YgZGVhdGhcbiAqIEBzaW5jZSAyLjUuMFxuICogQGRlcHJlY2F0ZWRcbiAqL1xuZXhwb3J0IHZhciBmb2xkID0gY29uY2F0QWxsO1xuLyoqXG4gKiBUaGlzIGluc3RhbmNlIGlzIGRlcHJlY2F0ZWQsIHVzZSBzbWFsbCwgc3BlY2lmaWMgaW5zdGFuY2VzIGluc3RlYWQuXG4gKiBGb3IgZXhhbXBsZSBpZiBhIGZ1bmN0aW9uIG5lZWRzIGEgYEZ1bmN0b3JgIGluc3RhbmNlLCBwYXNzIGBSTkVBLkZ1bmN0b3JgIGluc3RlYWQgb2YgYFJORUEucmVhZG9ubHlOb25FbXB0eUFycmF5YFxuICogKHdoZXJlIGBSTkVBYCBpcyBmcm9tIGBpbXBvcnQgUk5FQSBmcm9tICdmcC10cy9SZWFkb25seU5vbkVtcHR5QXJyYXknYClcbiAqXG4gKiBAY2F0ZWdvcnkgem9uZSBvZiBkZWF0aFxuICogQHNpbmNlIDIuNS4wXG4gKiBAZGVwcmVjYXRlZFxuICovXG5leHBvcnQgdmFyIHJlYWRvbmx5Tm9uRW1wdHlBcnJheSA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICBvZjogb2YsXG4gICAgbWFwOiBfbWFwLFxuICAgIG1hcFdpdGhJbmRleDogX21hcFdpdGhJbmRleCxcbiAgICBhcDogX2FwLFxuICAgIGNoYWluOiBmbGF0TWFwLFxuICAgIGV4dGVuZDogX2V4dGVuZCxcbiAgICBleHRyYWN0OiBleHRyYWN0LFxuICAgIHJlZHVjZTogX3JlZHVjZSxcbiAgICBmb2xkTWFwOiBfZm9sZE1hcCxcbiAgICByZWR1Y2VSaWdodDogX3JlZHVjZVJpZ2h0LFxuICAgIHRyYXZlcnNlOiBfdHJhdmVyc2UsXG4gICAgc2VxdWVuY2U6IHNlcXVlbmNlLFxuICAgIHJlZHVjZVdpdGhJbmRleDogX3JlZHVjZVdpdGhJbmRleCxcbiAgICBmb2xkTWFwV2l0aEluZGV4OiBfZm9sZE1hcFdpdGhJbmRleCxcbiAgICByZWR1Y2VSaWdodFdpdGhJbmRleDogX3JlZHVjZVJpZ2h0V2l0aEluZGV4LFxuICAgIHRyYXZlcnNlV2l0aEluZGV4OiBfdHJhdmVyc2VXaXRoSW5kZXgsXG4gICAgYWx0OiBfYWx0XG59O1xuIiwKICAidmFyIF9fc3ByZWFkQXJyYXkgPSAodGhpcyAmJiB0aGlzLl9fc3ByZWFkQXJyYXkpIHx8IGZ1bmN0aW9uICh0bywgZnJvbSwgcGFjaykge1xuICAgIGlmIChwYWNrIHx8IGFyZ3VtZW50cy5sZW5ndGggPT09IDIpIGZvciAodmFyIGkgPSAwLCBsID0gZnJvbS5sZW5ndGgsIGFyOyBpIDwgbDsgaSsrKSB7XG4gICAgICAgIGlmIChhciB8fCAhKGkgaW4gZnJvbSkpIHtcbiAgICAgICAgICAgIGlmICghYXIpIGFyID0gQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoZnJvbSwgMCwgaSk7XG4gICAgICAgICAgICBhcltpXSA9IGZyb21baV07XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHRvLmNvbmNhdChhciB8fCBBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChmcm9tKSk7XG59O1xuaW1wb3J0IHsgYXBGaXJzdCBhcyBhcEZpcnN0XywgYXBTIGFzIGFwU18sIGFwU2Vjb25kIGFzIGFwU2Vjb25kXyB9IGZyb20gJy4vQXBwbHknO1xuaW1wb3J0IHsgYmluZCBhcyBiaW5kXywgY2hhaW5GaXJzdCBhcyBjaGFpbkZpcnN0XyB9IGZyb20gJy4vQ2hhaW4nO1xuaW1wb3J0IHsgZnJvbUVxdWFscyB9IGZyb20gJy4vRXEnO1xuaW1wb3J0IHsgZHVhbCwgZmxvdywgaWRlbnRpdHksIHBpcGUsIFNLIH0gZnJvbSAnLi9mdW5jdGlvbic7XG5pbXBvcnQgeyBiaW5kVG8gYXMgYmluZFRvXywgZmxhcCBhcyBmbGFwXywgbGV0IGFzIGxldF9fIH0gZnJvbSAnLi9GdW5jdG9yJztcbmltcG9ydCAqIGFzIF8gZnJvbSAnLi9pbnRlcm5hbCc7XG5pbXBvcnQgeyBnZXRNb25vaWQgfSBmcm9tICcuL09yZCc7XG5pbXBvcnQgKiBhcyBTZSBmcm9tICcuL1NlbWlncm91cCc7XG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vLyBpbnRlcm5hbFxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLyoqXG4gKiBAaW50ZXJuYWxcbiAqL1xuZXhwb3J0IHZhciBlbXB0eSA9IF8uZW1wdHlSZWFkb25seUFycmF5O1xuLyoqXG4gKiBAaW50ZXJuYWxcbiAqL1xuZXhwb3J0IHZhciBpc05vbkVtcHR5ID0gXy5pc05vbkVtcHR5O1xuLyoqXG4gKiBAaW50ZXJuYWxcbiAqL1xuZXhwb3J0IHZhciBpc091dE9mQm91bmQgPSBmdW5jdGlvbiAoaSwgYXMpIHsgcmV0dXJuIGkgPCAwIHx8IGkgPj0gYXMubGVuZ3RoOyB9O1xuLyoqXG4gKiBAaW50ZXJuYWxcbiAqL1xuZXhwb3J0IHZhciBwcmVwZW5kVyA9IGZ1bmN0aW9uIChoZWFkKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uICh0YWlsKSB7XG4gICAgICAgIHJldHVybiBfX3NwcmVhZEFycmF5KFtoZWFkXSwgdGFpbCwgdHJ1ZSk7XG4gICAgfTtcbn07XG4vKipcbiAqIEBpbnRlcm5hbFxuICovXG5leHBvcnQgdmFyIHByZXBlbmQgPSBwcmVwZW5kVztcbi8qKlxuICogQGludGVybmFsXG4gKi9cbmV4cG9ydCB2YXIgYXBwZW5kVyA9IGZ1bmN0aW9uIChlbmQpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGluaXQpIHtcbiAgICAgICAgcmV0dXJuIF9fc3ByZWFkQXJyYXkoX19zcHJlYWRBcnJheShbXSwgaW5pdCwgdHJ1ZSksIFtlbmRdLCBmYWxzZSk7XG4gICAgfTtcbn07XG4vKipcbiAqIEBpbnRlcm5hbFxuICovXG5leHBvcnQgdmFyIGFwcGVuZCA9IGFwcGVuZFc7XG4vKipcbiAqIEBpbnRlcm5hbFxuICovXG5leHBvcnQgdmFyIHVuc2FmZUluc2VydEF0ID0gZnVuY3Rpb24gKGksIGEsIGFzKSB7XG4gICAgaWYgKGlzTm9uRW1wdHkoYXMpKSB7XG4gICAgICAgIHZhciB4cyA9IF8uZnJvbVJlYWRvbmx5Tm9uRW1wdHlBcnJheShhcyk7XG4gICAgICAgIHhzLnNwbGljZShpLCAwLCBhKTtcbiAgICAgICAgcmV0dXJuIHhzO1xuICAgIH1cbiAgICByZXR1cm4gW2FdO1xufTtcbi8qKlxuICogQGludGVybmFsXG4gKi9cbmV4cG9ydCB2YXIgdW5zYWZlVXBkYXRlQXQgPSBmdW5jdGlvbiAoaSwgYSwgYXMpIHtcbiAgICBpZiAoYXNbaV0gPT09IGEpIHtcbiAgICAgICAgcmV0dXJuIGFzO1xuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgICAgdmFyIHhzID0gXy5mcm9tUmVhZG9ubHlOb25FbXB0eUFycmF5KGFzKTtcbiAgICAgICAgeHNbaV0gPSBhO1xuICAgICAgICByZXR1cm4geHM7XG4gICAgfVxufTtcbi8qKlxuICogUmVtb3ZlIGR1cGxpY2F0ZXMgZnJvbSBhIGBSZWFkb25seU5vbkVtcHR5QXJyYXlgLCBrZWVwaW5nIHRoZSBmaXJzdCBvY2N1cnJlbmNlIG9mIGFuIGVsZW1lbnQuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IHVuaXEgfSBmcm9tICdmcC10cy9SZWFkb25seU5vbkVtcHR5QXJyYXknXG4gKiBpbXBvcnQgKiBhcyBOIGZyb20gJ2ZwLXRzL251bWJlcidcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKHVuaXEoTi5FcSkoWzEsIDIsIDFdKSwgWzEsIDJdKVxuICpcbiAqIEBzaW5jZSAyLjExLjBcbiAqL1xuZXhwb3J0IHZhciB1bmlxID0gZnVuY3Rpb24gKEUpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIGlmIChhcy5sZW5ndGggPT09IDEpIHtcbiAgICAgICAgICAgIHJldHVybiBhcztcbiAgICAgICAgfVxuICAgICAgICB2YXIgb3V0ID0gW2hlYWQoYXMpXTtcbiAgICAgICAgdmFyIHJlc3QgPSB0YWlsKGFzKTtcbiAgICAgICAgdmFyIF9sb29wXzEgPSBmdW5jdGlvbiAoYSkge1xuICAgICAgICAgICAgaWYgKG91dC5ldmVyeShmdW5jdGlvbiAobykgeyByZXR1cm4gIUUuZXF1YWxzKG8sIGEpOyB9KSkge1xuICAgICAgICAgICAgICAgIG91dC5wdXNoKGEpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICBmb3IgKHZhciBfaSA9IDAsIHJlc3RfMSA9IHJlc3Q7IF9pIDwgcmVzdF8xLmxlbmd0aDsgX2krKykge1xuICAgICAgICAgICAgdmFyIGEgPSByZXN0XzFbX2ldO1xuICAgICAgICAgICAgX2xvb3BfMShhKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gb3V0O1xuICAgIH07XG59O1xuLyoqXG4gKiBTb3J0IHRoZSBlbGVtZW50cyBvZiBhIGBSZWFkb25seU5vbkVtcHR5QXJyYXlgIGluIGluY3JlYXNpbmcgb3JkZXIsIHdoZXJlIGVsZW1lbnRzIGFyZSBjb21wYXJlZCB1c2luZyBmaXJzdCBgb3Jkc1swXWAsIHRoZW4gYG9yZHNbMV1gLFxuICogZXRjLi4uXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCAqIGFzIFJORUEgZnJvbSAnZnAtdHMvUmVhZG9ubHlOb25FbXB0eUFycmF5J1xuICogaW1wb3J0IHsgY29udHJhbWFwIH0gZnJvbSAnZnAtdHMvT3JkJ1xuICogaW1wb3J0ICogYXMgUyBmcm9tICdmcC10cy9zdHJpbmcnXG4gKiBpbXBvcnQgKiBhcyBOIGZyb20gJ2ZwLXRzL251bWJlcidcbiAqIGltcG9ydCB7IHBpcGUgfSBmcm9tICdmcC10cy9mdW5jdGlvbidcbiAqXG4gKiBpbnRlcmZhY2UgUGVyc29uIHtcbiAqICAgbmFtZTogc3RyaW5nXG4gKiAgIGFnZTogbnVtYmVyXG4gKiB9XG4gKlxuICogY29uc3QgYnlOYW1lID0gcGlwZShTLk9yZCwgY29udHJhbWFwKChwOiBQZXJzb24pID0+IHAubmFtZSkpXG4gKlxuICogY29uc3QgYnlBZ2UgPSBwaXBlKE4uT3JkLCBjb250cmFtYXAoKHA6IFBlcnNvbikgPT4gcC5hZ2UpKVxuICpcbiAqIGNvbnN0IHNvcnRCeU5hbWVCeUFnZSA9IFJORUEuc29ydEJ5KFtieU5hbWUsIGJ5QWdlXSlcbiAqXG4gKiBjb25zdCBwZXJzb25zOiBSTkVBLlJlYWRvbmx5Tm9uRW1wdHlBcnJheTxQZXJzb24+ID0gW1xuICogICB7IG5hbWU6ICdhJywgYWdlOiAxIH0sXG4gKiAgIHsgbmFtZTogJ2InLCBhZ2U6IDMgfSxcbiAqICAgeyBuYW1lOiAnYycsIGFnZTogMiB9LFxuICogICB7IG5hbWU6ICdiJywgYWdlOiAyIH1cbiAqIF1cbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKHNvcnRCeU5hbWVCeUFnZShwZXJzb25zKSwgW1xuICogICB7IG5hbWU6ICdhJywgYWdlOiAxIH0sXG4gKiAgIHsgbmFtZTogJ2InLCBhZ2U6IDIgfSxcbiAqICAgeyBuYW1lOiAnYicsIGFnZTogMyB9LFxuICogICB7IG5hbWU6ICdjJywgYWdlOiAyIH1cbiAqIF0pXG4gKlxuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIHNvcnRCeSA9IGZ1bmN0aW9uIChvcmRzKSB7XG4gICAgaWYgKGlzTm9uRW1wdHkob3JkcykpIHtcbiAgICAgICAgdmFyIE0gPSBnZXRNb25vaWQoKTtcbiAgICAgICAgcmV0dXJuIHNvcnQob3Jkcy5yZWR1Y2UoTS5jb25jYXQsIE0uZW1wdHkpKTtcbiAgICB9XG4gICAgcmV0dXJuIGlkZW50aXR5O1xufTtcbi8qKlxuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIHVuaW9uID0gZnVuY3Rpb24gKEUpIHtcbiAgICB2YXIgdW5pcUUgPSB1bmlxKEUpO1xuICAgIHJldHVybiBmdW5jdGlvbiAoc2Vjb25kKSB7IHJldHVybiBmdW5jdGlvbiAoZmlyc3QpIHsgcmV0dXJuIHVuaXFFKHBpcGUoZmlyc3QsIGNvbmNhdChzZWNvbmQpKSk7IH07IH07XG59O1xuLyoqXG4gKiBSb3RhdGUgYSBgUmVhZG9ubHlOb25FbXB0eUFycmF5YCBieSBgbmAgc3RlcHMuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IHJvdGF0ZSB9IGZyb20gJ2ZwLXRzL1JlYWRvbmx5Tm9uRW1wdHlBcnJheSdcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKHJvdGF0ZSgyKShbMSwgMiwgMywgNCwgNV0pLCBbNCwgNSwgMSwgMiwgM10pXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKHJvdGF0ZSgtMikoWzEsIDIsIDMsIDQsIDVdKSwgWzMsIDQsIDUsIDEsIDJdKVxuICpcbiAqIEBzaW5jZSAyLjExLjBcbiAqL1xuZXhwb3J0IHZhciByb3RhdGUgPSBmdW5jdGlvbiAobikge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgdmFyIGxlbiA9IGFzLmxlbmd0aDtcbiAgICAgICAgdmFyIG0gPSBNYXRoLnJvdW5kKG4pICUgbGVuO1xuICAgICAgICBpZiAoaXNPdXRPZkJvdW5kKE1hdGguYWJzKG0pLCBhcykgfHwgbSA9PT0gMCkge1xuICAgICAgICAgICAgcmV0dXJuIGFzO1xuICAgICAgICB9XG4gICAgICAgIGlmIChtIDwgMCkge1xuICAgICAgICAgICAgdmFyIF9hID0gc3BsaXRBdCgtbSkoYXMpLCBmID0gX2FbMF0sIHMgPSBfYVsxXTtcbiAgICAgICAgICAgIHJldHVybiBwaXBlKHMsIGNvbmNhdChmKSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gcm90YXRlKG0gLSBsZW4pKGFzKTtcbiAgICAgICAgfVxuICAgIH07XG59O1xuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLy8gY29uc3RydWN0b3JzXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vKipcbiAqIFJldHVybiBhIGBSZWFkb25seU5vbkVtcHR5QXJyYXlgIGZyb20gYSBgUmVhZG9ubHlBcnJheWAgcmV0dXJuaW5nIGBub25lYCBpZiB0aGUgaW5wdXQgaXMgZW1wdHkuXG4gKlxuICogQGNhdGVnb3J5IGNvbnZlcnNpb25zXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBmcm9tUmVhZG9ubHlBcnJheSA9IGZ1bmN0aW9uIChhcykge1xuICAgIHJldHVybiBpc05vbkVtcHR5KGFzKSA/IF8uc29tZShhcykgOiBfLm5vbmU7XG59O1xuLyoqXG4gKiBSZXR1cm4gYSBgUmVhZG9ubHlOb25FbXB0eUFycmF5YCBvZiBsZW5ndGggYG5gIHdpdGggZWxlbWVudCBgaWAgaW5pdGlhbGl6ZWQgd2l0aCBgZihpKWAuXG4gKlxuICogKipOb3RlKiouIGBuYCBpcyBub3JtYWxpemVkIHRvIGEgbmF0dXJhbCBudW1iZXIuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IG1ha2VCeSB9IGZyb20gJ2ZwLXRzL1JlYWRvbmx5Tm9uRW1wdHlBcnJheSdcbiAqIGltcG9ydCB7IHBpcGUgfSBmcm9tICdmcC10cy9mdW5jdGlvbidcbiAqXG4gKiBjb25zdCBkb3VibGUgPSAobjogbnVtYmVyKTogbnVtYmVyID0+IG4gKiAyXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKHBpcGUoNSwgbWFrZUJ5KGRvdWJsZSkpLCBbMCwgMiwgNCwgNiwgOF0pXG4gKlxuICogQGNhdGVnb3J5IGNvbnN0cnVjdG9yc1xuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIG1ha2VCeSA9IGZ1bmN0aW9uIChmKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChuKSB7XG4gICAgICAgIHZhciBqID0gTWF0aC5tYXgoMCwgTWF0aC5mbG9vcihuKSk7XG4gICAgICAgIHZhciBvdXQgPSBbZigwKV07XG4gICAgICAgIGZvciAodmFyIGkgPSAxOyBpIDwgajsgaSsrKSB7XG4gICAgICAgICAgICBvdXQucHVzaChmKGkpKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gb3V0O1xuICAgIH07XG59O1xuLyoqXG4gKiBDcmVhdGUgYSBgUmVhZG9ubHlOb25FbXB0eUFycmF5YCBjb250YWluaW5nIGEgdmFsdWUgcmVwZWF0ZWQgdGhlIHNwZWNpZmllZCBudW1iZXIgb2YgdGltZXMuXG4gKlxuICogKipOb3RlKiouIGBuYCBpcyBub3JtYWxpemVkIHRvIGEgbmF0dXJhbCBudW1iZXIuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IHJlcGxpY2F0ZSB9IGZyb20gJ2ZwLXRzL1JlYWRvbmx5Tm9uRW1wdHlBcnJheSdcbiAqIGltcG9ydCB7IHBpcGUgfSBmcm9tICdmcC10cy9mdW5jdGlvbidcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKHBpcGUoMywgcmVwbGljYXRlKCdhJykpLCBbJ2EnLCAnYScsICdhJ10pXG4gKlxuICogQGNhdGVnb3J5IGNvbnN0cnVjdG9yc1xuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIHJlcGxpY2F0ZSA9IGZ1bmN0aW9uIChhKSB7IHJldHVybiBtYWtlQnkoZnVuY3Rpb24gKCkgeyByZXR1cm4gYTsgfSk7IH07XG4vKipcbiAqIENyZWF0ZSBhIGBSZWFkb25seU5vbkVtcHR5QXJyYXlgIGNvbnRhaW5pbmcgYSByYW5nZSBvZiBpbnRlZ2VycywgaW5jbHVkaW5nIGJvdGggZW5kcG9pbnRzLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyByYW5nZSB9IGZyb20gJ2ZwLXRzL1JlYWRvbmx5Tm9uRW1wdHlBcnJheSdcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKHJhbmdlKDEsIDUpLCBbMSwgMiwgMywgNCwgNV0pXG4gKlxuICogQGNhdGVnb3J5IGNvbnN0cnVjdG9yc1xuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIHJhbmdlID0gZnVuY3Rpb24gKHN0YXJ0LCBlbmQpIHtcbiAgICByZXR1cm4gc3RhcnQgPD0gZW5kID8gbWFrZUJ5KGZ1bmN0aW9uIChpKSB7IHJldHVybiBzdGFydCArIGk7IH0pKGVuZCAtIHN0YXJ0ICsgMSkgOiBbc3RhcnRdO1xufTtcbi8qKlxuICogUmV0dXJuIHRoZSB0dXBsZSBvZiB0aGUgYGhlYWRgIGFuZCB0aGUgYHRhaWxgLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyB1bnByZXBlbmQgfSBmcm9tICdmcC10cy9SZWFkb25seU5vbkVtcHR5QXJyYXknXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbCh1bnByZXBlbmQoWzEsIDIsIDMsIDRdKSwgWzEsIFsyLCAzLCA0XV0pXG4gKlxuICogQHNpbmNlIDIuOS4wXG4gKi9cbmV4cG9ydCB2YXIgdW5wcmVwZW5kID0gZnVuY3Rpb24gKGFzKSB7IHJldHVybiBbaGVhZChhcyksIHRhaWwoYXMpXTsgfTtcbi8qKlxuICogUmV0dXJuIHRoZSB0dXBsZSBvZiB0aGUgYGluaXRgIGFuZCB0aGUgYGxhc3RgLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyB1bmFwcGVuZCB9IGZyb20gJ2ZwLXRzL1JlYWRvbmx5Tm9uRW1wdHlBcnJheSdcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKHVuYXBwZW5kKFsxLCAyLCAzLCA0XSksIFtbMSwgMiwgM10sIDRdKVxuICpcbiAqIEBzaW5jZSAyLjkuMFxuICovXG5leHBvcnQgdmFyIHVuYXBwZW5kID0gZnVuY3Rpb24gKGFzKSB7IHJldHVybiBbaW5pdChhcyksIGxhc3QoYXMpXTsgfTtcbi8qKlxuICogQGNhdGVnb3J5IGNvbnZlcnNpb25zXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBmcm9tQXJyYXkgPSBmdW5jdGlvbiAoYXMpIHsgcmV0dXJuIGZyb21SZWFkb25seUFycmF5KGFzLnNsaWNlKCkpOyB9O1xuZXhwb3J0IGZ1bmN0aW9uIGNvbmNhdFcoc2Vjb25kKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChmaXJzdCkgeyByZXR1cm4gZmlyc3QuY29uY2F0KHNlY29uZCk7IH07XG59XG5leHBvcnQgZnVuY3Rpb24gY29uY2F0KHgsIHkpIHtcbiAgICByZXR1cm4geSA/IHguY29uY2F0KHkpIDogZnVuY3Rpb24gKHkpIHsgcmV0dXJuIHkuY29uY2F0KHgpOyB9O1xufVxuLyoqXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciByZXZlcnNlID0gZnVuY3Rpb24gKGFzKSB7XG4gICAgcmV0dXJuIGFzLmxlbmd0aCA9PT0gMSA/IGFzIDogX19zcHJlYWRBcnJheShbbGFzdChhcyldLCBhcy5zbGljZSgwLCAtMSkucmV2ZXJzZSgpLCB0cnVlKTtcbn07XG5leHBvcnQgZnVuY3Rpb24gZ3JvdXAoRSkge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgdmFyIGxlbiA9IGFzLmxlbmd0aDtcbiAgICAgICAgaWYgKGxlbiA9PT0gMCkge1xuICAgICAgICAgICAgcmV0dXJuIGVtcHR5O1xuICAgICAgICB9XG4gICAgICAgIHZhciBvdXQgPSBbXTtcbiAgICAgICAgdmFyIGhlYWQgPSBhc1swXTtcbiAgICAgICAgdmFyIG5lYSA9IFtoZWFkXTtcbiAgICAgICAgZm9yICh2YXIgaSA9IDE7IGkgPCBsZW47IGkrKykge1xuICAgICAgICAgICAgdmFyIGEgPSBhc1tpXTtcbiAgICAgICAgICAgIGlmIChFLmVxdWFscyhhLCBoZWFkKSkge1xuICAgICAgICAgICAgICAgIG5lYS5wdXNoKGEpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgb3V0LnB1c2gobmVhKTtcbiAgICAgICAgICAgICAgICBoZWFkID0gYTtcbiAgICAgICAgICAgICAgICBuZWEgPSBbaGVhZF07XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgb3V0LnB1c2gobmVhKTtcbiAgICAgICAgcmV0dXJuIG91dDtcbiAgICB9O1xufVxuLyoqXG4gKiBTcGxpdHMgYW4gYXJyYXkgaW50byBzdWItbm9uLWVtcHR5LWFycmF5cyBzdG9yZWQgaW4gYW4gb2JqZWN0LCBiYXNlZCBvbiB0aGUgcmVzdWx0IG9mIGNhbGxpbmcgYSBgc3RyaW5nYC1yZXR1cm5pbmdcbiAqIGZ1bmN0aW9uIG9uIGVhY2ggZWxlbWVudCwgYW5kIGdyb3VwaW5nIHRoZSByZXN1bHRzIGFjY29yZGluZyB0byB2YWx1ZXMgcmV0dXJuZWRcbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgZ3JvdXBCeSB9IGZyb20gJ2ZwLXRzL1JlYWRvbmx5Tm9uRW1wdHlBcnJheSdcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKGdyb3VwQnkoKHM6IHN0cmluZykgPT4gU3RyaW5nKHMubGVuZ3RoKSkoWydhJywgJ2InLCAnYWInXSksIHtcbiAqICAgJzEnOiBbJ2EnLCAnYiddLFxuICogICAnMic6IFsnYWInXVxuICogfSlcbiAqXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBncm91cEJ5ID0gZnVuY3Rpb24gKGYpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIHZhciBvdXQgPSB7fTtcbiAgICAgICAgZm9yICh2YXIgX2kgPSAwLCBhc18xID0gYXM7IF9pIDwgYXNfMS5sZW5ndGg7IF9pKyspIHtcbiAgICAgICAgICAgIHZhciBhID0gYXNfMVtfaV07XG4gICAgICAgICAgICB2YXIgayA9IGYoYSk7XG4gICAgICAgICAgICBpZiAoXy5oYXMuY2FsbChvdXQsIGspKSB7XG4gICAgICAgICAgICAgICAgb3V0W2tdLnB1c2goYSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBvdXRba10gPSBbYV07XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG91dDtcbiAgICB9O1xufTtcbi8qKlxuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgc29ydCA9IGZ1bmN0aW9uIChPKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykge1xuICAgICAgICByZXR1cm4gYXMubGVuZ3RoID09PSAxID8gYXMgOiBhcy5zbGljZSgpLnNvcnQoTy5jb21wYXJlKTtcbiAgICB9O1xufTtcbi8qKlxuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgdXBkYXRlQXQgPSBmdW5jdGlvbiAoaSwgYSkge1xuICAgIHJldHVybiBtb2RpZnlBdChpLCBmdW5jdGlvbiAoKSB7IHJldHVybiBhOyB9KTtcbn07XG4vKipcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIG1vZGlmeUF0ID0gZnVuY3Rpb24gKGksIGYpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIHJldHVybiBpc091dE9mQm91bmQoaSwgYXMpID8gXy5ub25lIDogXy5zb21lKHVuc2FmZVVwZGF0ZUF0KGksIGYoYXNbaV0pLCBhcykpO1xuICAgIH07XG59O1xuLyoqXG4gKiBAc2luY2UgMi41LjFcbiAqL1xuZXhwb3J0IHZhciB6aXBXaXRoID0gZnVuY3Rpb24gKGFzLCBicywgZikge1xuICAgIHZhciBjcyA9IFtmKGFzWzBdLCBic1swXSldO1xuICAgIHZhciBsZW4gPSBNYXRoLm1pbihhcy5sZW5ndGgsIGJzLmxlbmd0aCk7XG4gICAgZm9yICh2YXIgaSA9IDE7IGkgPCBsZW47IGkrKykge1xuICAgICAgICBjc1tpXSA9IGYoYXNbaV0sIGJzW2ldKTtcbiAgICB9XG4gICAgcmV0dXJuIGNzO1xufTtcbmV4cG9ydCBmdW5jdGlvbiB6aXAoYXMsIGJzKSB7XG4gICAgaWYgKGJzID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIChicykgeyByZXR1cm4gemlwKGJzLCBhcyk7IH07XG4gICAgfVxuICAgIHJldHVybiB6aXBXaXRoKGFzLCBicywgZnVuY3Rpb24gKGEsIGIpIHsgcmV0dXJuIFthLCBiXTsgfSk7XG59XG4vKipcbiAqIEBzaW5jZSAyLjUuMVxuICovXG5leHBvcnQgdmFyIHVuemlwID0gZnVuY3Rpb24gKGFicykge1xuICAgIHZhciBmYSA9IFthYnNbMF1bMF1dO1xuICAgIHZhciBmYiA9IFthYnNbMF1bMV1dO1xuICAgIGZvciAodmFyIGkgPSAxOyBpIDwgYWJzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIGZhW2ldID0gYWJzW2ldWzBdO1xuICAgICAgICBmYltpXSA9IGFic1tpXVsxXTtcbiAgICB9XG4gICAgcmV0dXJuIFtmYSwgZmJdO1xufTtcbi8qKlxuICogUHJlcGVuZCBhbiBlbGVtZW50IHRvIGV2ZXJ5IG1lbWJlciBvZiBhIGBSZWFkb25seU5vbkVtcHR5QXJyYXlgLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBwcmVwZW5kQWxsIH0gZnJvbSAnZnAtdHMvUmVhZG9ubHlOb25FbXB0eUFycmF5J1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwocHJlcGVuZEFsbCg5KShbMSwgMiwgMywgNF0pLCBbOSwgMSwgOSwgMiwgOSwgMywgOSwgNF0pXG4gKlxuICogQHNpbmNlIDIuMTAuMFxuICovXG5leHBvcnQgdmFyIHByZXBlbmRBbGwgPSBmdW5jdGlvbiAobWlkZGxlKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykge1xuICAgICAgICB2YXIgb3V0ID0gW21pZGRsZSwgYXNbMF1dO1xuICAgICAgICBmb3IgKHZhciBpID0gMTsgaSA8IGFzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICBvdXQucHVzaChtaWRkbGUsIGFzW2ldKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gb3V0O1xuICAgIH07XG59O1xuLyoqXG4gKiBQbGFjZXMgYW4gZWxlbWVudCBpbiBiZXR3ZWVuIG1lbWJlcnMgb2YgYSBgUmVhZG9ubHlOb25FbXB0eUFycmF5YC5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgaW50ZXJzcGVyc2UgfSBmcm9tICdmcC10cy9SZWFkb25seU5vbkVtcHR5QXJyYXknXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChpbnRlcnNwZXJzZSg5KShbMSwgMiwgMywgNF0pLCBbMSwgOSwgMiwgOSwgMywgOSwgNF0pXG4gKlxuICogQHNpbmNlIDIuOS4wXG4gKi9cbmV4cG9ydCB2YXIgaW50ZXJzcGVyc2UgPSBmdW5jdGlvbiAobWlkZGxlKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykge1xuICAgICAgICB2YXIgcmVzdCA9IHRhaWwoYXMpO1xuICAgICAgICByZXR1cm4gaXNOb25FbXB0eShyZXN0KSA/IHBpcGUocmVzdCwgcHJlcGVuZEFsbChtaWRkbGUpLCBwcmVwZW5kKGhlYWQoYXMpKSkgOiBhcztcbiAgICB9O1xufTtcbi8qKlxuICogQGNhdGVnb3J5IHNlcXVlbmNpbmdcbiAqIEBzaW5jZSAyLjEwLjBcbiAqL1xuZXhwb3J0IHZhciBjaGFpbldpdGhJbmRleCA9IGZ1bmN0aW9uIChmKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykge1xuICAgICAgICB2YXIgb3V0ID0gXy5mcm9tUmVhZG9ubHlOb25FbXB0eUFycmF5KGYoMCwgaGVhZChhcykpKTtcbiAgICAgICAgZm9yICh2YXIgaSA9IDE7IGkgPCBhcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgb3V0LnB1c2guYXBwbHkob3V0LCBmKGksIGFzW2ldKSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG91dDtcbiAgICB9O1xufTtcbi8qKlxuICogQSB1c2VmdWwgcmVjdXJzaW9uIHBhdHRlcm4gZm9yIHByb2Nlc3NpbmcgYSBgUmVhZG9ubHlOb25FbXB0eUFycmF5YCB0byBwcm9kdWNlIGEgbmV3IGBSZWFkb25seU5vbkVtcHR5QXJyYXlgLCBvZnRlbiB1c2VkIGZvciBcImNob3BwaW5nXCIgdXAgdGhlIGlucHV0XG4gKiBgUmVhZG9ubHlOb25FbXB0eUFycmF5YC4gVHlwaWNhbGx5IGBjaG9wYCBpcyBjYWxsZWQgd2l0aCBzb21lIGZ1bmN0aW9uIHRoYXQgd2lsbCBjb25zdW1lIGFuIGluaXRpYWwgcHJlZml4IG9mIHRoZSBgUmVhZG9ubHlOb25FbXB0eUFycmF5YCBhbmQgcHJvZHVjZSBhXG4gKiB2YWx1ZSBhbmQgdGhlIHRhaWwgb2YgdGhlIGBSZWFkb25seU5vbkVtcHR5QXJyYXlgLlxuICpcbiAqIEBzaW5jZSAyLjEwLjBcbiAqL1xuZXhwb3J0IHZhciBjaG9wID0gZnVuY3Rpb24gKGYpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIHZhciBfYSA9IGYoYXMpLCBiID0gX2FbMF0sIHJlc3QgPSBfYVsxXTtcbiAgICAgICAgdmFyIG91dCA9IFtiXTtcbiAgICAgICAgdmFyIG5leHQgPSByZXN0O1xuICAgICAgICB3aGlsZSAoaXNOb25FbXB0eShuZXh0KSkge1xuICAgICAgICAgICAgdmFyIF9iID0gZihuZXh0KSwgYl8xID0gX2JbMF0sIHJlc3RfMiA9IF9iWzFdO1xuICAgICAgICAgICAgb3V0LnB1c2goYl8xKTtcbiAgICAgICAgICAgIG5leHQgPSByZXN0XzI7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG91dDtcbiAgICB9O1xufTtcbi8qKlxuICogU3BsaXRzIGEgYFJlYWRvbmx5Tm9uRW1wdHlBcnJheWAgaW50byB0d28gcGllY2VzLCB0aGUgZmlyc3QgcGllY2UgaGFzIG1heCBgbmAgZWxlbWVudHMuXG4gKlxuICogQHNpbmNlIDIuMTAuMFxuICovXG5leHBvcnQgdmFyIHNwbGl0QXQgPSBmdW5jdGlvbiAobikge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgdmFyIG0gPSBNYXRoLm1heCgxLCBuKTtcbiAgICAgICAgcmV0dXJuIG0gPj0gYXMubGVuZ3RoID8gW2FzLCBlbXB0eV0gOiBbcGlwZShhcy5zbGljZSgxLCBtKSwgcHJlcGVuZChoZWFkKGFzKSkpLCBhcy5zbGljZShtKV07XG4gICAgfTtcbn07XG4vKipcbiAqIFNwbGl0cyBhIGBSZWFkb25seU5vbkVtcHR5QXJyYXlgIGludG8gbGVuZ3RoLWBuYCBwaWVjZXMuIFRoZSBsYXN0IHBpZWNlIHdpbGwgYmUgc2hvcnRlciBpZiBgbmAgZG9lcyBub3QgZXZlbmx5IGRpdmlkZSB0aGUgbGVuZ3RoIG9mXG4gKiB0aGUgYFJlYWRvbmx5Tm9uRW1wdHlBcnJheWAuXG4gKlxuICogQHNpbmNlIDIuMTAuMFxuICovXG5leHBvcnQgdmFyIGNodW5rc09mID0gZnVuY3Rpb24gKG4pIHsgcmV0dXJuIGNob3Aoc3BsaXRBdChuKSk7IH07XG52YXIgX21hcCA9IGZ1bmN0aW9uIChmYSwgZikgeyByZXR1cm4gcGlwZShmYSwgbWFwKGYpKTsgfTtcbi8qIGlzdGFuYnVsIGlnbm9yZSBuZXh0ICovXG52YXIgX21hcFdpdGhJbmRleCA9IGZ1bmN0aW9uIChmYSwgZikgeyByZXR1cm4gcGlwZShmYSwgbWFwV2l0aEluZGV4KGYpKTsgfTtcbnZhciBfYXAgPSBmdW5jdGlvbiAoZmFiLCBmYSkgeyByZXR1cm4gcGlwZShmYWIsIGFwKGZhKSk7IH07XG4vKiBpc3RhbmJ1bCBpZ25vcmUgbmV4dCAqL1xudmFyIF9leHRlbmQgPSBmdW5jdGlvbiAod2EsIGYpIHsgcmV0dXJuIHBpcGUod2EsIGV4dGVuZChmKSk7IH07XG4vKiBpc3RhbmJ1bCBpZ25vcmUgbmV4dCAqL1xudmFyIF9yZWR1Y2UgPSBmdW5jdGlvbiAoZmEsIGIsIGYpIHsgcmV0dXJuIHBpcGUoZmEsIHJlZHVjZShiLCBmKSk7IH07XG4vKiBpc3RhbmJ1bCBpZ25vcmUgbmV4dCAqL1xudmFyIF9mb2xkTWFwID0gZnVuY3Rpb24gKE0pIHtcbiAgICB2YXIgZm9sZE1hcE0gPSBmb2xkTWFwKE0pO1xuICAgIHJldHVybiBmdW5jdGlvbiAoZmEsIGYpIHsgcmV0dXJuIHBpcGUoZmEsIGZvbGRNYXBNKGYpKTsgfTtcbn07XG4vKiBpc3RhbmJ1bCBpZ25vcmUgbmV4dCAqL1xudmFyIF9yZWR1Y2VSaWdodCA9IGZ1bmN0aW9uIChmYSwgYiwgZikgeyByZXR1cm4gcGlwZShmYSwgcmVkdWNlUmlnaHQoYiwgZikpOyB9O1xuLyogaXN0YW5idWwgaWdub3JlIG5leHQgKi9cbnZhciBfdHJhdmVyc2UgPSBmdW5jdGlvbiAoRikge1xuICAgIHZhciB0cmF2ZXJzZUYgPSB0cmF2ZXJzZShGKTtcbiAgICByZXR1cm4gZnVuY3Rpb24gKHRhLCBmKSB7IHJldHVybiBwaXBlKHRhLCB0cmF2ZXJzZUYoZikpOyB9O1xufTtcbi8qIGlzdGFuYnVsIGlnbm9yZSBuZXh0ICovXG52YXIgX2FsdCA9IGZ1bmN0aW9uIChmYSwgdGhhdCkgeyByZXR1cm4gcGlwZShmYSwgYWx0KHRoYXQpKTsgfTtcbi8qIGlzdGFuYnVsIGlnbm9yZSBuZXh0ICovXG52YXIgX3JlZHVjZVdpdGhJbmRleCA9IGZ1bmN0aW9uIChmYSwgYiwgZikge1xuICAgIHJldHVybiBwaXBlKGZhLCByZWR1Y2VXaXRoSW5kZXgoYiwgZikpO1xufTtcbi8qIGlzdGFuYnVsIGlnbm9yZSBuZXh0ICovXG52YXIgX2ZvbGRNYXBXaXRoSW5kZXggPSBmdW5jdGlvbiAoTSkge1xuICAgIHZhciBmb2xkTWFwV2l0aEluZGV4TSA9IGZvbGRNYXBXaXRoSW5kZXgoTSk7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChmYSwgZikgeyByZXR1cm4gcGlwZShmYSwgZm9sZE1hcFdpdGhJbmRleE0oZikpOyB9O1xufTtcbi8qIGlzdGFuYnVsIGlnbm9yZSBuZXh0ICovXG52YXIgX3JlZHVjZVJpZ2h0V2l0aEluZGV4ID0gZnVuY3Rpb24gKGZhLCBiLCBmKSB7XG4gICAgcmV0dXJuIHBpcGUoZmEsIHJlZHVjZVJpZ2h0V2l0aEluZGV4KGIsIGYpKTtcbn07XG4vKiBpc3RhbmJ1bCBpZ25vcmUgbmV4dCAqL1xudmFyIF90cmF2ZXJzZVdpdGhJbmRleCA9IGZ1bmN0aW9uIChGKSB7XG4gICAgdmFyIHRyYXZlcnNlV2l0aEluZGV4RiA9IHRyYXZlcnNlV2l0aEluZGV4KEYpO1xuICAgIHJldHVybiBmdW5jdGlvbiAodGEsIGYpIHsgcmV0dXJuIHBpcGUodGEsIHRyYXZlcnNlV2l0aEluZGV4RihmKSk7IH07XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgY29uc3RydWN0b3JzXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBvZiA9IF8uc2luZ2xldG9uO1xuLyoqXG4gKiBMZXNzIHN0cmljdCB2ZXJzaW9uIG9mIFtgYWx0YF0oI2FsdCkuXG4gKlxuICogVGhlIGBXYCBzdWZmaXggKHNob3J0IGZvciAqKlcqKmlkZW5pbmcpIG1lYW5zIHRoYXQgdGhlIHJldHVybiB0eXBlcyB3aWxsIGJlIG1lcmdlZC5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0ICogYXMgUk5FQSBmcm9tICdmcC10cy9SZWFkb25seU5vbkVtcHR5QXJyYXknXG4gKiBpbXBvcnQgeyBwaXBlIH0gZnJvbSAnZnAtdHMvZnVuY3Rpb24nXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChcbiAqICAgcGlwZShcbiAqICAgICBbMSwgMiwgM10gYXMgUk5FQS5SZWFkb25seU5vbkVtcHR5QXJyYXk8bnVtYmVyPixcbiAqICAgICBSTkVBLmFsdFcoKCkgPT4gWydhJywgJ2InXSlcbiAqICAgKSxcbiAqICAgWzEsIDIsIDMsICdhJywgJ2InXVxuICogKVxuICpcbiAqIEBjYXRlZ29yeSBlcnJvciBoYW5kbGluZ1xuICogQHNpbmNlIDIuOS4wXG4gKi9cbmV4cG9ydCB2YXIgYWx0VyA9IGZ1bmN0aW9uICh0aGF0KSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykge1xuICAgICAgICByZXR1cm4gcGlwZShhcywgY29uY2F0Vyh0aGF0KCkpKTtcbiAgICB9O1xufTtcbi8qKlxuICogSWRlbnRpZmllcyBhbiBhc3NvY2lhdGl2ZSBvcGVyYXRpb24gb24gYSB0eXBlIGNvbnN0cnVjdG9yLiBJdCBpcyBzaW1pbGFyIHRvIGBTZW1pZ3JvdXBgLCBleGNlcHQgdGhhdCBpdCBhcHBsaWVzIHRvXG4gKiB0eXBlcyBvZiBraW5kIGAqIC0+ICpgLlxuICpcbiAqIEluIGNhc2Ugb2YgYFJlYWRvbmx5Tm9uRW1wdHlBcnJheWAgY29uY2F0ZW5hdGVzIHRoZSBpbnB1dHMgaW50byBhIHNpbmdsZSBhcnJheS5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0ICogYXMgUk5FQSBmcm9tICdmcC10cy9SZWFkb25seU5vbkVtcHR5QXJyYXknXG4gKiBpbXBvcnQgeyBwaXBlIH0gZnJvbSAnZnAtdHMvZnVuY3Rpb24nXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChcbiAqICAgcGlwZShcbiAqICAgICBbMSwgMiwgM10sXG4gKiAgICAgUk5FQS5hbHQoKCkgPT4gWzQsIDVdKVxuICogICApLFxuICogICBbMSwgMiwgMywgNCwgNV1cbiAqIClcbiAqXG4gKiBAY2F0ZWdvcnkgZXJyb3IgaGFuZGxpbmdcbiAqIEBzaW5jZSAyLjYuMlxuICovXG5leHBvcnQgdmFyIGFsdCA9IGFsdFc7XG4vKipcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIGFwID0gZnVuY3Rpb24gKGFzKSB7IHJldHVybiBmbGF0TWFwKGZ1bmN0aW9uIChmKSB7IHJldHVybiBwaXBlKGFzLCBtYXAoZikpOyB9KTsgfTtcbi8qKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCAqIGFzIFJORUEgZnJvbSAnZnAtdHMvUmVhZG9ubHlOb25FbXB0eUFycmF5J1xuICogaW1wb3J0IHsgcGlwZSB9IGZyb20gJ2ZwLXRzL2Z1bmN0aW9uJ1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoXG4gKiAgIHBpcGUoXG4gKiAgICAgWzEsIDIsIDNdLFxuICogICAgIFJORUEuZmxhdE1hcCgobikgPT4gW2BhJHtufWAsIGBiJHtufWBdKVxuICogICApLFxuICogICBbJ2ExJywgJ2IxJywgJ2EyJywgJ2IyJywgJ2EzJywgJ2IzJ11cbiAqIClcbiAqXG4gKiBAY2F0ZWdvcnkgc2VxdWVuY2luZ1xuICogQHNpbmNlIDIuMTQuMFxuICovXG5leHBvcnQgdmFyIGZsYXRNYXAgPSAvKiNfX1BVUkVfXyovIGR1YWwoMiwgZnVuY3Rpb24gKG1hLCBmKSB7XG4gICAgcmV0dXJuIHBpcGUobWEsIGNoYWluV2l0aEluZGV4KGZ1bmN0aW9uIChpLCBhKSB7IHJldHVybiBmKGEsIGkpOyB9KSk7XG59KTtcbi8qKlxuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgZXh0ZW5kID0gZnVuY3Rpb24gKGYpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIHZhciBuZXh0ID0gdGFpbChhcyk7XG4gICAgICAgIHZhciBvdXQgPSBbZihhcyldO1xuICAgICAgICB3aGlsZSAoaXNOb25FbXB0eShuZXh0KSkge1xuICAgICAgICAgICAgb3V0LnB1c2goZihuZXh0KSk7XG4gICAgICAgICAgICBuZXh0ID0gdGFpbChuZXh0KTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gb3V0O1xuICAgIH07XG59O1xuLyoqXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBkdXBsaWNhdGUgPSBcbi8qI19fUFVSRV9fKi8gZXh0ZW5kKGlkZW50aXR5KTtcbi8qKlxuICogQGNhdGVnb3J5IHNlcXVlbmNpbmdcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIGZsYXR0ZW4gPSBcbi8qI19fUFVSRV9fKi8gZmxhdE1hcChpZGVudGl0eSk7XG4vKipcbiAqIGBtYXBgIGNhbiBiZSB1c2VkIHRvIHR1cm4gZnVuY3Rpb25zIGAoYTogQSkgPT4gQmAgaW50byBmdW5jdGlvbnMgYChmYTogRjxBPikgPT4gRjxCPmAgd2hvc2UgYXJndW1lbnQgYW5kIHJldHVybiB0eXBlc1xuICogdXNlIHRoZSB0eXBlIGNvbnN0cnVjdG9yIGBGYCB0byByZXByZXNlbnQgc29tZSBjb21wdXRhdGlvbmFsIGNvbnRleHQuXG4gKlxuICogQGNhdGVnb3J5IG1hcHBpbmdcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIG1hcCA9IGZ1bmN0aW9uIChmKSB7XG4gICAgcmV0dXJuIG1hcFdpdGhJbmRleChmdW5jdGlvbiAoXywgYSkgeyByZXR1cm4gZihhKTsgfSk7XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgbWFwcGluZ1xuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgbWFwV2l0aEluZGV4ID0gZnVuY3Rpb24gKGYpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIHZhciBvdXQgPSBbZigwLCBoZWFkKGFzKSldO1xuICAgICAgICBmb3IgKHZhciBpID0gMTsgaSA8IGFzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICBvdXQucHVzaChmKGksIGFzW2ldKSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG91dDtcbiAgICB9O1xufTtcbi8qKlxuICogQGNhdGVnb3J5IGZvbGRpbmdcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIHJlZHVjZSA9IGZ1bmN0aW9uIChiLCBmKSB7XG4gICAgcmV0dXJuIHJlZHVjZVdpdGhJbmRleChiLCBmdW5jdGlvbiAoXywgYiwgYSkgeyByZXR1cm4gZihiLCBhKTsgfSk7XG59O1xuLyoqXG4gKiAqKk5vdGUqKi4gVGhlIGNvbnN0cmFpbnQgaXMgcmVsYXhlZDogYSBgU2VtaWdyb3VwYCBpbnN0ZWFkIG9mIGEgYE1vbm9pZGAuXG4gKlxuICogQGNhdGVnb3J5IGZvbGRpbmdcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIGZvbGRNYXAgPSBmdW5jdGlvbiAoUykge1xuICAgIHJldHVybiBmdW5jdGlvbiAoZikge1xuICAgICAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgICAgICByZXR1cm4gYXMuc2xpY2UoMSkucmVkdWNlKGZ1bmN0aW9uIChzLCBhKSB7IHJldHVybiBTLmNvbmNhdChzLCBmKGEpKTsgfSwgZihhc1swXSkpO1xuICAgICAgICB9O1xuICAgIH07XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgZm9sZGluZ1xuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgcmVkdWNlUmlnaHQgPSBmdW5jdGlvbiAoYiwgZikge1xuICAgIHJldHVybiByZWR1Y2VSaWdodFdpdGhJbmRleChiLCBmdW5jdGlvbiAoXywgYiwgYSkgeyByZXR1cm4gZihiLCBhKTsgfSk7XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgZm9sZGluZ1xuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgcmVkdWNlV2l0aEluZGV4ID0gZnVuY3Rpb24gKGIsIGYpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIHJldHVybiBhcy5yZWR1Y2UoZnVuY3Rpb24gKGIsIGEsIGkpIHsgcmV0dXJuIGYoaSwgYiwgYSk7IH0sIGIpO1xuICAgIH07XG59O1xuLyoqXG4gKiAqKk5vdGUqKi4gVGhlIGNvbnN0cmFpbnQgaXMgcmVsYXhlZDogYSBgU2VtaWdyb3VwYCBpbnN0ZWFkIG9mIGEgYE1vbm9pZGAuXG4gKlxuICogQGNhdGVnb3J5IGZvbGRpbmdcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIGZvbGRNYXBXaXRoSW5kZXggPSBmdW5jdGlvbiAoUykge1xuICAgIHJldHVybiBmdW5jdGlvbiAoZikge1xuICAgICAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgICAgICByZXR1cm4gYXMuc2xpY2UoMSkucmVkdWNlKGZ1bmN0aW9uIChzLCBhLCBpKSB7IHJldHVybiBTLmNvbmNhdChzLCBmKGkgKyAxLCBhKSk7IH0sIGYoMCwgYXNbMF0pKTtcbiAgICAgICAgfTtcbiAgICB9O1xufTtcbi8qKlxuICogQGNhdGVnb3J5IGZvbGRpbmdcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIHJlZHVjZVJpZ2h0V2l0aEluZGV4ID0gZnVuY3Rpb24gKGIsIGYpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIHJldHVybiBhcy5yZWR1Y2VSaWdodChmdW5jdGlvbiAoYiwgYSwgaSkgeyByZXR1cm4gZihpLCBhLCBiKTsgfSwgYik7XG4gICAgfTtcbn07XG4vKipcbiAqIEBjYXRlZ29yeSB0cmF2ZXJzaW5nXG4gKiBAc2luY2UgMi42LjNcbiAqL1xuZXhwb3J0IHZhciB0cmF2ZXJzZSA9IGZ1bmN0aW9uIChGKSB7XG4gICAgdmFyIHRyYXZlcnNlV2l0aEluZGV4RiA9IHRyYXZlcnNlV2l0aEluZGV4KEYpO1xuICAgIHJldHVybiBmdW5jdGlvbiAoZikgeyByZXR1cm4gdHJhdmVyc2VXaXRoSW5kZXhGKGZ1bmN0aW9uIChfLCBhKSB7IHJldHVybiBmKGEpOyB9KTsgfTtcbn07XG4vKipcbiAqIEBjYXRlZ29yeSB0cmF2ZXJzaW5nXG4gKiBAc2luY2UgMi42LjNcbiAqL1xuZXhwb3J0IHZhciBzZXF1ZW5jZSA9IGZ1bmN0aW9uIChGKSB7IHJldHVybiB0cmF2ZXJzZVdpdGhJbmRleChGKShTSyk7IH07XG4vKipcbiAqIEBjYXRlZ29yeSBzZXF1ZW5jaW5nXG4gKiBAc2luY2UgMi42LjNcbiAqL1xuZXhwb3J0IHZhciB0cmF2ZXJzZVdpdGhJbmRleCA9IGZ1bmN0aW9uIChGKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChmKSB7XG4gICAgICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgICAgIHZhciBvdXQgPSBGLm1hcChmKDAsIGhlYWQoYXMpKSwgb2YpO1xuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDE7IGkgPCBhcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgIG91dCA9IEYuYXAoRi5tYXAob3V0LCBmdW5jdGlvbiAoYnMpIHsgcmV0dXJuIGZ1bmN0aW9uIChiKSB7IHJldHVybiBwaXBlKGJzLCBhcHBlbmQoYikpOyB9OyB9KSwgZihpLCBhc1tpXSkpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIG91dDtcbiAgICAgICAgfTtcbiAgICB9O1xufTtcbi8qKlxuICogQGNhdGVnb3J5IENvbW9uYWRcbiAqIEBzaW5jZSAyLjYuM1xuICovXG5leHBvcnQgdmFyIGV4dHJhY3QgPSBfLmhlYWQ7XG4vKipcbiAqIEBjYXRlZ29yeSB0eXBlIGxhbWJkYXNcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIFVSSSA9ICdSZWFkb25seU5vbkVtcHR5QXJyYXknO1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBnZXRTaG93ID0gZnVuY3Rpb24gKFMpIHsgcmV0dXJuICh7XG4gICAgc2hvdzogZnVuY3Rpb24gKGFzKSB7IHJldHVybiBcIltcIi5jb25jYXQoYXMubWFwKFMuc2hvdykuam9pbignLCAnKSwgXCJdXCIpOyB9XG59KTsgfTtcbi8qKlxuICogQnVpbGRzIGEgYFNlbWlncm91cGAgaW5zdGFuY2UgZm9yIGBSZWFkb25seU5vbkVtcHR5QXJyYXlgXG4gKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgZ2V0U2VtaWdyb3VwID0gZnVuY3Rpb24gKCkgeyByZXR1cm4gKHtcbiAgICBjb25jYXQ6IGNvbmNhdFxufSk7IH07XG4vKipcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBnZXRFcSB9IGZyb20gJ2ZwLXRzL1JlYWRvbmx5Tm9uRW1wdHlBcnJheSdcbiAqIGltcG9ydCAqIGFzIE4gZnJvbSAnZnAtdHMvbnVtYmVyJ1xuICpcbiAqIGNvbnN0IEUgPSBnZXRFcShOLkVxKVxuICogYXNzZXJ0LnN0cmljdEVxdWFsKEUuZXF1YWxzKFsxLCAyXSwgWzEsIDJdKSwgdHJ1ZSlcbiAqIGFzc2VydC5zdHJpY3RFcXVhbChFLmVxdWFscyhbMSwgMl0sIFsxLCAzXSksIGZhbHNlKVxuICpcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIGdldEVxID0gZnVuY3Rpb24gKEUpIHtcbiAgICByZXR1cm4gZnJvbUVxdWFscyhmdW5jdGlvbiAoeHMsIHlzKSB7IHJldHVybiB4cy5sZW5ndGggPT09IHlzLmxlbmd0aCAmJiB4cy5ldmVyeShmdW5jdGlvbiAoeCwgaSkgeyByZXR1cm4gRS5lcXVhbHMoeCwgeXNbaV0pOyB9KTsgfSk7XG59O1xuLyoqXG4gKiBAc2luY2UgMi4xMS4wXG4gKi9cbmV4cG9ydCB2YXIgZ2V0VW5pb25TZW1pZ3JvdXAgPSBmdW5jdGlvbiAoRSkge1xuICAgIHZhciB1bmlvbkUgPSB1bmlvbihFKTtcbiAgICByZXR1cm4ge1xuICAgICAgICBjb25jYXQ6IGZ1bmN0aW9uIChmaXJzdCwgc2Vjb25kKSB7IHJldHVybiB1bmlvbkUoc2Vjb25kKShmaXJzdCk7IH1cbiAgICB9O1xufTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuNy4wXG4gKi9cbmV4cG9ydCB2YXIgRnVuY3RvciA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICBtYXA6IF9tYXBcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBtYXBwaW5nXG4gKiBAc2luY2UgMi4xMC4wXG4gKi9cbmV4cG9ydCB2YXIgZmxhcCA9IC8qI19fUFVSRV9fKi8gZmxhcF8oRnVuY3Rvcik7XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjEwLjBcbiAqL1xuZXhwb3J0IHZhciBQb2ludGVkID0ge1xuICAgIFVSSTogVVJJLFxuICAgIG9mOiBvZlxufTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuNy4wXG4gKi9cbmV4cG9ydCB2YXIgRnVuY3RvcldpdGhJbmRleCA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICBtYXA6IF9tYXAsXG4gICAgbWFwV2l0aEluZGV4OiBfbWFwV2l0aEluZGV4XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi4xMC4wXG4gKi9cbmV4cG9ydCB2YXIgQXBwbHkgPSB7XG4gICAgVVJJOiBVUkksXG4gICAgbWFwOiBfbWFwLFxuICAgIGFwOiBfYXBcbn07XG4vKipcbiAqIENvbWJpbmUgdHdvIGVmZmVjdGZ1bCBhY3Rpb25zLCBrZWVwaW5nIG9ubHkgdGhlIHJlc3VsdCBvZiB0aGUgZmlyc3QuXG4gKlxuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgYXBGaXJzdCA9IC8qI19fUFVSRV9fKi8gYXBGaXJzdF8oQXBwbHkpO1xuLyoqXG4gKiBDb21iaW5lIHR3byBlZmZlY3RmdWwgYWN0aW9ucywga2VlcGluZyBvbmx5IHRoZSByZXN1bHQgb2YgdGhlIHNlY29uZC5cbiAqXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBhcFNlY29uZCA9IC8qI19fUFVSRV9fKi8gYXBTZWNvbmRfKEFwcGx5KTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuNy4wXG4gKi9cbmV4cG9ydCB2YXIgQXBwbGljYXRpdmUgPSB7XG4gICAgVVJJOiBVUkksXG4gICAgbWFwOiBfbWFwLFxuICAgIGFwOiBfYXAsXG4gICAgb2Y6IG9mXG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi4xMC4wXG4gKi9cbmV4cG9ydCB2YXIgQ2hhaW4gPSB7XG4gICAgVVJJOiBVUkksXG4gICAgbWFwOiBfbWFwLFxuICAgIGFwOiBfYXAsXG4gICAgY2hhaW46IGZsYXRNYXBcbn07XG4vKipcbiAqIENvbXBvc2VzIGNvbXB1dGF0aW9ucyBpbiBzZXF1ZW5jZSwgdXNpbmcgdGhlIHJldHVybiB2YWx1ZSBvZiBvbmUgY29tcHV0YXRpb24gdG8gZGV0ZXJtaW5lIHRoZSBuZXh0IGNvbXB1dGF0aW9uIGFuZFxuICoga2VlcGluZyBvbmx5IHRoZSByZXN1bHQgb2YgdGhlIGZpcnN0LlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgKiBhcyBSQSBmcm9tICdmcC10cy9SZWFkb25seUFycmF5J1xuICogaW1wb3J0IHsgcGlwZSB9IGZyb20gJ2ZwLXRzL2Z1bmN0aW9uJ1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoXG4gKiAgIHBpcGUoXG4gKiAgICAgWzEsIDIsIDNdLFxuICogICAgIFJBLmNoYWluRmlyc3QoKCkgPT4gWydhJywgJ2InXSlcbiAqICAgKSxcbiAqICAgWzEsIDEsIDIsIDIsIDMsIDNdXG4gKiApXG4gKlxuICogQGNhdGVnb3J5IHNlcXVlbmNpbmdcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIGNoYWluRmlyc3QgPSAvKiNfX1BVUkVfXyovIGNoYWluRmlyc3RfKENoYWluKTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuNy4wXG4gKi9cbmV4cG9ydCB2YXIgTW9uYWQgPSB7XG4gICAgVVJJOiBVUkksXG4gICAgbWFwOiBfbWFwLFxuICAgIGFwOiBfYXAsXG4gICAgb2Y6IG9mLFxuICAgIGNoYWluOiBmbGF0TWFwXG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi43LjBcbiAqL1xuZXhwb3J0IHZhciBGb2xkYWJsZSA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICByZWR1Y2U6IF9yZWR1Y2UsXG4gICAgZm9sZE1hcDogX2ZvbGRNYXAsXG4gICAgcmVkdWNlUmlnaHQ6IF9yZWR1Y2VSaWdodFxufTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuNy4wXG4gKi9cbmV4cG9ydCB2YXIgRm9sZGFibGVXaXRoSW5kZXggPSB7XG4gICAgVVJJOiBVUkksXG4gICAgcmVkdWNlOiBfcmVkdWNlLFxuICAgIGZvbGRNYXA6IF9mb2xkTWFwLFxuICAgIHJlZHVjZVJpZ2h0OiBfcmVkdWNlUmlnaHQsXG4gICAgcmVkdWNlV2l0aEluZGV4OiBfcmVkdWNlV2l0aEluZGV4LFxuICAgIGZvbGRNYXBXaXRoSW5kZXg6IF9mb2xkTWFwV2l0aEluZGV4LFxuICAgIHJlZHVjZVJpZ2h0V2l0aEluZGV4OiBfcmVkdWNlUmlnaHRXaXRoSW5kZXhcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjcuMFxuICovXG5leHBvcnQgdmFyIFRyYXZlcnNhYmxlID0ge1xuICAgIFVSSTogVVJJLFxuICAgIG1hcDogX21hcCxcbiAgICByZWR1Y2U6IF9yZWR1Y2UsXG4gICAgZm9sZE1hcDogX2ZvbGRNYXAsXG4gICAgcmVkdWNlUmlnaHQ6IF9yZWR1Y2VSaWdodCxcbiAgICB0cmF2ZXJzZTogX3RyYXZlcnNlLFxuICAgIHNlcXVlbmNlOiBzZXF1ZW5jZVxufTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuNy4wXG4gKi9cbmV4cG9ydCB2YXIgVHJhdmVyc2FibGVXaXRoSW5kZXggPSB7XG4gICAgVVJJOiBVUkksXG4gICAgbWFwOiBfbWFwLFxuICAgIG1hcFdpdGhJbmRleDogX21hcFdpdGhJbmRleCxcbiAgICByZWR1Y2U6IF9yZWR1Y2UsXG4gICAgZm9sZE1hcDogX2ZvbGRNYXAsXG4gICAgcmVkdWNlUmlnaHQ6IF9yZWR1Y2VSaWdodCxcbiAgICB0cmF2ZXJzZTogX3RyYXZlcnNlLFxuICAgIHNlcXVlbmNlOiBzZXF1ZW5jZSxcbiAgICByZWR1Y2VXaXRoSW5kZXg6IF9yZWR1Y2VXaXRoSW5kZXgsXG4gICAgZm9sZE1hcFdpdGhJbmRleDogX2ZvbGRNYXBXaXRoSW5kZXgsXG4gICAgcmVkdWNlUmlnaHRXaXRoSW5kZXg6IF9yZWR1Y2VSaWdodFdpdGhJbmRleCxcbiAgICB0cmF2ZXJzZVdpdGhJbmRleDogX3RyYXZlcnNlV2l0aEluZGV4XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi43LjBcbiAqL1xuZXhwb3J0IHZhciBBbHQgPSB7XG4gICAgVVJJOiBVUkksXG4gICAgbWFwOiBfbWFwLFxuICAgIGFsdDogX2FsdFxufTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuNy4wXG4gKi9cbmV4cG9ydCB2YXIgQ29tb25hZCA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICBtYXA6IF9tYXAsXG4gICAgZXh0ZW5kOiBfZXh0ZW5kLFxuICAgIGV4dHJhY3Q6IGV4dHJhY3Rcbn07XG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vLyBkbyBub3RhdGlvblxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLyoqXG4gKiBAY2F0ZWdvcnkgZG8gbm90YXRpb25cbiAqIEBzaW5jZSAyLjkuMFxuICovXG5leHBvcnQgdmFyIERvID0gLyojX19QVVJFX18qLyBvZihfLmVtcHR5UmVjb3JkKTtcbi8qKlxuICogQGNhdGVnb3J5IGRvIG5vdGF0aW9uXG4gKiBAc2luY2UgMi44LjBcbiAqL1xuZXhwb3J0IHZhciBiaW5kVG8gPSAvKiNfX1BVUkVfXyovIGJpbmRUb18oRnVuY3Rvcik7XG52YXIgbGV0XyA9IC8qI19fUFVSRV9fKi8gbGV0X18oRnVuY3Rvcik7XG5leHBvcnQgeyBcbi8qKlxuICogQGNhdGVnb3J5IGRvIG5vdGF0aW9uXG4gKiBAc2luY2UgMi4xMy4wXG4gKi9cbmxldF8gYXMgbGV0IH07XG4vKipcbiAqIEBjYXRlZ29yeSBkbyBub3RhdGlvblxuICogQHNpbmNlIDIuOC4wXG4gKi9cbmV4cG9ydCB2YXIgYmluZCA9IC8qI19fUFVSRV9fKi8gYmluZF8oQ2hhaW4pO1xuLyoqXG4gKiBAY2F0ZWdvcnkgZG8gbm90YXRpb25cbiAqIEBzaW5jZSAyLjguMFxuICovXG5leHBvcnQgdmFyIGFwUyA9IC8qI19fUFVSRV9fKi8gYXBTXyhBcHBseSk7XG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vLyB1dGlsc1xuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLyoqXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBoZWFkID0gZXh0cmFjdDtcbi8qKlxuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgdGFpbCA9IF8udGFpbDtcbi8qKlxuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgbGFzdCA9IGZ1bmN0aW9uIChhcykgeyByZXR1cm4gYXNbYXMubGVuZ3RoIC0gMV07IH07XG4vKipcbiAqIEdldCBhbGwgYnV0IHRoZSBsYXN0IGVsZW1lbnQgb2YgYSBub24gZW1wdHkgYXJyYXksIGNyZWF0aW5nIGEgbmV3IGFycmF5LlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBpbml0IH0gZnJvbSAnZnAtdHMvUmVhZG9ubHlOb25FbXB0eUFycmF5J1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoaW5pdChbMSwgMiwgM10pLCBbMSwgMl0pXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKGluaXQoWzFdKSwgW10pXG4gKlxuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgaW5pdCA9IGZ1bmN0aW9uIChhcykgeyByZXR1cm4gYXMuc2xpY2UoMCwgLTEpOyB9O1xuLyoqXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBtaW4gPSBmdW5jdGlvbiAoTykge1xuICAgIHZhciBTID0gU2UubWluKE8pO1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHsgcmV0dXJuIGFzLnJlZHVjZShTLmNvbmNhdCk7IH07XG59O1xuLyoqXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBtYXggPSBmdW5jdGlvbiAoTykge1xuICAgIHZhciBTID0gU2UubWF4KE8pO1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHsgcmV0dXJuIGFzLnJlZHVjZShTLmNvbmNhdCk7IH07XG59O1xuLyoqXG4gKiBAc2luY2UgMi4xMC4wXG4gKi9cbmV4cG9ydCB2YXIgY29uY2F0QWxsID0gZnVuY3Rpb24gKFMpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIHJldHVybiBhcy5yZWR1Y2UoUy5jb25jYXQpO1xuICAgIH07XG59O1xuLyoqXG4gKiBCcmVhayBhIGBSZWFkb25seUFycmF5YCBpbnRvIGl0cyBmaXJzdCBlbGVtZW50IGFuZCByZW1haW5pbmcgZWxlbWVudHMuXG4gKlxuICogQGNhdGVnb3J5IHBhdHRlcm4gbWF0Y2hpbmdcbiAqIEBzaW5jZSAyLjExLjBcbiAqL1xuZXhwb3J0IHZhciBtYXRjaExlZnQgPSBmdW5jdGlvbiAoZikge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgcmV0dXJuIGYoaGVhZChhcyksIHRhaWwoYXMpKTtcbiAgICB9O1xufTtcbi8qKlxuICogQnJlYWsgYSBgUmVhZG9ubHlBcnJheWAgaW50byBpdHMgaW5pdGlhbCBlbGVtZW50cyBhbmQgdGhlIGxhc3QgZWxlbWVudC5cbiAqXG4gKiBAY2F0ZWdvcnkgcGF0dGVybiBtYXRjaGluZ1xuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIG1hdGNoUmlnaHQgPSBmdW5jdGlvbiAoZikge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgcmV0dXJuIGYoaW5pdChhcyksIGxhc3QoYXMpKTtcbiAgICB9O1xufTtcbi8qKlxuICogQXBwbHkgYSBmdW5jdGlvbiB0byB0aGUgaGVhZCwgY3JlYXRpbmcgYSBuZXcgYFJlYWRvbmx5Tm9uRW1wdHlBcnJheWAuXG4gKlxuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIG1vZGlmeUhlYWQgPSBmdW5jdGlvbiAoZikge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgcmV0dXJuIF9fc3ByZWFkQXJyYXkoW2YoaGVhZChhcykpXSwgdGFpbChhcyksIHRydWUpO1xuICAgIH07XG59O1xuLyoqXG4gKiBDaGFuZ2UgdGhlIGhlYWQsIGNyZWF0aW5nIGEgbmV3IGBSZWFkb25seU5vbkVtcHR5QXJyYXlgLlxuICpcbiAqIEBzaW5jZSAyLjExLjBcbiAqL1xuZXhwb3J0IHZhciB1cGRhdGVIZWFkID0gZnVuY3Rpb24gKGEpIHsgcmV0dXJuIG1vZGlmeUhlYWQoZnVuY3Rpb24gKCkgeyByZXR1cm4gYTsgfSk7IH07XG4vKipcbiAqIEFwcGx5IGEgZnVuY3Rpb24gdG8gdGhlIGxhc3QgZWxlbWVudCwgY3JlYXRpbmcgYSBuZXcgYFJlYWRvbmx5Tm9uRW1wdHlBcnJheWAuXG4gKlxuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIG1vZGlmeUxhc3QgPSBmdW5jdGlvbiAoZikge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgcmV0dXJuIHBpcGUoaW5pdChhcyksIGFwcGVuZChmKGxhc3QoYXMpKSkpO1xuICAgIH07XG59O1xuLyoqXG4gKiBDaGFuZ2UgdGhlIGxhc3QgZWxlbWVudCwgY3JlYXRpbmcgYSBuZXcgYFJlYWRvbmx5Tm9uRW1wdHlBcnJheWAuXG4gKlxuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIHVwZGF0ZUxhc3QgPSBmdW5jdGlvbiAoYSkgeyByZXR1cm4gbW9kaWZ5TGFzdChmdW5jdGlvbiAoKSB7IHJldHVybiBhOyB9KTsgfTtcbi8qKlxuICogUGxhY2VzIGFuIGVsZW1lbnQgaW4gYmV0d2VlbiBtZW1iZXJzIG9mIGEgYFJlYWRvbmx5Tm9uRW1wdHlBcnJheWAsIHRoZW4gZm9sZHMgdGhlIHJlc3VsdHMgdXNpbmcgdGhlIHByb3ZpZGVkIGBTZW1pZ3JvdXBgLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgKiBhcyBTIGZyb20gJ2ZwLXRzL3N0cmluZydcbiAqIGltcG9ydCB7IGludGVyY2FsYXRlIH0gZnJvbSAnZnAtdHMvUmVhZG9ubHlOb25FbXB0eUFycmF5J1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoaW50ZXJjYWxhdGUoUy5TZW1pZ3JvdXApKCctJykoWydhJywgJ2InLCAnYyddKSwgJ2EtYi1jJylcbiAqXG4gKiBAc2luY2UgMi4xMi4wXG4gKi9cbmV4cG9ydCB2YXIgaW50ZXJjYWxhdGUgPSBmdW5jdGlvbiAoUykge1xuICAgIHZhciBjb25jYXRBbGxTID0gY29uY2F0QWxsKFMpO1xuICAgIHJldHVybiBmdW5jdGlvbiAobWlkZGxlKSB7IHJldHVybiBmbG93KGludGVyc3BlcnNlKG1pZGRsZSksIGNvbmNhdEFsbFMpOyB9O1xufTtcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8vIGxlZ2FjeVxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLyoqXG4gKiBBbGlhcyBvZiBgZmxhdE1hcGAuXG4gKlxuICogQGNhdGVnb3J5IGxlZ2FjeVxuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgY2hhaW4gPSBmbGF0TWFwO1xuZXhwb3J0IGZ1bmN0aW9uIGdyb3VwU29ydChPKSB7XG4gICAgdmFyIHNvcnRPID0gc29ydChPKTtcbiAgICB2YXIgZ3JvdXBPID0gZ3JvdXAoTyk7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykgeyByZXR1cm4gKGlzTm9uRW1wdHkoYXMpID8gZ3JvdXBPKHNvcnRPKGFzKSkgOiBlbXB0eSk7IH07XG59XG5leHBvcnQgZnVuY3Rpb24gZmlsdGVyKHByZWRpY2F0ZSkge1xuICAgIHJldHVybiBmaWx0ZXJXaXRoSW5kZXgoZnVuY3Rpb24gKF8sIGEpIHsgcmV0dXJuIHByZWRpY2F0ZShhKTsgfSk7XG59XG4vKipcbiAqIFVzZSBbYGZpbHRlcldpdGhJbmRleGBdKC4vUmVhZG9ubHlBcnJheS50cy5odG1sI2ZpbHRlcndpdGhpbmRleCkgaW5zdGVhZC5cbiAqXG4gKiBAY2F0ZWdvcnkgem9uZSBvZiBkZWF0aFxuICogQHNpbmNlIDIuNS4wXG4gKiBAZGVwcmVjYXRlZFxuICovXG5leHBvcnQgdmFyIGZpbHRlcldpdGhJbmRleCA9IGZ1bmN0aW9uIChwcmVkaWNhdGUpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIHJldHVybiBmcm9tUmVhZG9ubHlBcnJheShhcy5maWx0ZXIoZnVuY3Rpb24gKGEsIGkpIHsgcmV0dXJuIHByZWRpY2F0ZShpLCBhKTsgfSkpO1xuICAgIH07XG59O1xuLyoqXG4gKiBVc2UgW2B1bnByZXBlbmRgXSgjdW5wcmVwZW5kKSBpbnN0ZWFkLlxuICpcbiAqIEBjYXRlZ29yeSB6b25lIG9mIGRlYXRoXG4gKiBAc2luY2UgMi4xMC4wXG4gKiBAZGVwcmVjYXRlZFxuICovXG5leHBvcnQgdmFyIHVuY29ucyA9IHVucHJlcGVuZDtcbi8qKlxuICogVXNlIFtgdW5hcHBlbmRgXSgjdW5hcHBlbmQpIGluc3RlYWQuXG4gKlxuICogQGNhdGVnb3J5IHpvbmUgb2YgZGVhdGhcbiAqIEBzaW5jZSAyLjEwLjBcbiAqIEBkZXByZWNhdGVkXG4gKi9cbmV4cG9ydCB2YXIgdW5zbm9jID0gdW5hcHBlbmQ7XG5leHBvcnQgZnVuY3Rpb24gY29ucyhoZWFkLCB0YWlsKSB7XG4gICAgcmV0dXJuIHRhaWwgPT09IHVuZGVmaW5lZCA/IHByZXBlbmQoaGVhZCkgOiBwaXBlKHRhaWwsIHByZXBlbmQoaGVhZCkpO1xufVxuLyoqXG4gKiBVc2UgW2BhcHBlbmRgXSguL1JlYWRvbmx5QXJyYXkudHMuaHRtbCNhcHBlbmQpIGluc3RlYWQuXG4gKlxuICogQGNhdGVnb3J5IHpvbmUgb2YgZGVhdGhcbiAqIEBzaW5jZSAyLjUuMFxuICogQGRlcHJlY2F0ZWRcbiAqL1xuZXhwb3J0IHZhciBzbm9jID0gZnVuY3Rpb24gKGluaXQsIGVuZCkgeyByZXR1cm4gcGlwZShpbml0LCBjb25jYXQoW2VuZF0pKTsgfTtcbi8qKlxuICogVXNlIFtgaW5zZXJ0QXRgXSguL1JlYWRvbmx5QXJyYXkudHMuaHRtbCNpbnNlcnRhdCkgaW5zdGVhZC5cbiAqXG4gKiBAY2F0ZWdvcnkgem9uZSBvZiBkZWF0aFxuICogQHNpbmNlIDIuNS4wXG4gKiBAZGVwcmVjYXRlZFxuICovXG5leHBvcnQgdmFyIGluc2VydEF0ID0gZnVuY3Rpb24gKGksIGEpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIHJldHVybiBpIDwgMCB8fCBpID4gYXMubGVuZ3RoID8gXy5ub25lIDogXy5zb21lKHVuc2FmZUluc2VydEF0KGksIGEsIGFzKSk7XG4gICAgfTtcbn07XG4vKipcbiAqIFVzZSBbYHByZXBlbmRBbGxgXSgjcHJlcGVuZGFsbCkgaW5zdGVhZC5cbiAqXG4gKiBAY2F0ZWdvcnkgem9uZSBvZiBkZWF0aFxuICogQHNpbmNlIDIuOS4wXG4gKiBAZGVwcmVjYXRlZFxuICovXG5leHBvcnQgdmFyIHByZXBlbmRUb0FsbCA9IHByZXBlbmRBbGw7XG4vKipcbiAqIFVzZSBbYGNvbmNhdEFsbGBdKCNjb25jYXRhbGwpIGluc3RlYWQuXG4gKlxuICogQGNhdGVnb3J5IHpvbmUgb2YgZGVhdGhcbiAqIEBzaW5jZSAyLjUuMFxuICogQGRlcHJlY2F0ZWRcbiAqL1xuZXhwb3J0IHZhciBmb2xkID0gY29uY2F0QWxsO1xuLyoqXG4gKiBUaGlzIGluc3RhbmNlIGlzIGRlcHJlY2F0ZWQsIHVzZSBzbWFsbCwgc3BlY2lmaWMgaW5zdGFuY2VzIGluc3RlYWQuXG4gKiBGb3IgZXhhbXBsZSBpZiBhIGZ1bmN0aW9uIG5lZWRzIGEgYEZ1bmN0b3JgIGluc3RhbmNlLCBwYXNzIGBSTkVBLkZ1bmN0b3JgIGluc3RlYWQgb2YgYFJORUEucmVhZG9ubHlOb25FbXB0eUFycmF5YFxuICogKHdoZXJlIGBSTkVBYCBpcyBmcm9tIGBpbXBvcnQgUk5FQSBmcm9tICdmcC10cy9SZWFkb25seU5vbkVtcHR5QXJyYXknYClcbiAqXG4gKiBAY2F0ZWdvcnkgem9uZSBvZiBkZWF0aFxuICogQHNpbmNlIDIuNS4wXG4gKiBAZGVwcmVjYXRlZFxuICovXG5leHBvcnQgdmFyIHJlYWRvbmx5Tm9uRW1wdHlBcnJheSA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICBvZjogb2YsXG4gICAgbWFwOiBfbWFwLFxuICAgIG1hcFdpdGhJbmRleDogX21hcFdpdGhJbmRleCxcbiAgICBhcDogX2FwLFxuICAgIGNoYWluOiBmbGF0TWFwLFxuICAgIGV4dGVuZDogX2V4dGVuZCxcbiAgICBleHRyYWN0OiBleHRyYWN0LFxuICAgIHJlZHVjZTogX3JlZHVjZSxcbiAgICBmb2xkTWFwOiBfZm9sZE1hcCxcbiAgICByZWR1Y2VSaWdodDogX3JlZHVjZVJpZ2h0LFxuICAgIHRyYXZlcnNlOiBfdHJhdmVyc2UsXG4gICAgc2VxdWVuY2U6IHNlcXVlbmNlLFxuICAgIHJlZHVjZVdpdGhJbmRleDogX3JlZHVjZVdpdGhJbmRleCxcbiAgICBmb2xkTWFwV2l0aEluZGV4OiBfZm9sZE1hcFdpdGhJbmRleCxcbiAgICByZWR1Y2VSaWdodFdpdGhJbmRleDogX3JlZHVjZVJpZ2h0V2l0aEluZGV4LFxuICAgIHRyYXZlcnNlV2l0aEluZGV4OiBfdHJhdmVyc2VXaXRoSW5kZXgsXG4gICAgYWx0OiBfYWx0XG59O1xuIiwKICAidmFyIF9fc3ByZWFkQXJyYXkgPSAodGhpcyAmJiB0aGlzLl9fc3ByZWFkQXJyYXkpIHx8IGZ1bmN0aW9uICh0bywgZnJvbSwgcGFjaykge1xuICAgIGlmIChwYWNrIHx8IGFyZ3VtZW50cy5sZW5ndGggPT09IDIpIGZvciAodmFyIGkgPSAwLCBsID0gZnJvbS5sZW5ndGgsIGFyOyBpIDwgbDsgaSsrKSB7XG4gICAgICAgIGlmIChhciB8fCAhKGkgaW4gZnJvbSkpIHtcbiAgICAgICAgICAgIGlmICghYXIpIGFyID0gQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoZnJvbSwgMCwgaSk7XG4gICAgICAgICAgICBhcltpXSA9IGZyb21baV07XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHRvLmNvbmNhdChhciB8fCBBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChmcm9tKSk7XG59O1xuaW1wb3J0IHsgYXBGaXJzdCBhcyBhcEZpcnN0XywgYXBTIGFzIGFwU18sIGFwU2Vjb25kIGFzIGFwU2Vjb25kXyB9IGZyb20gJy4vQXBwbHknO1xuaW1wb3J0IHsgYmluZCBhcyBiaW5kXywgY2hhaW5GaXJzdCBhcyBjaGFpbkZpcnN0XyB9IGZyb20gJy4vQ2hhaW4nO1xuaW1wb3J0IHsgZnJvbUVxdWFscyB9IGZyb20gJy4vRXEnO1xuaW1wb3J0IHsgZHVhbCwgZmxvdywgaWRlbnRpdHksIHBpcGUsIFNLIH0gZnJvbSAnLi9mdW5jdGlvbic7XG5pbXBvcnQgeyBiaW5kVG8gYXMgYmluZFRvXywgZmxhcCBhcyBmbGFwXywgbGV0IGFzIGxldF9fIH0gZnJvbSAnLi9GdW5jdG9yJztcbmltcG9ydCAqIGFzIF8gZnJvbSAnLi9pbnRlcm5hbCc7XG5pbXBvcnQgeyBnZXRNb25vaWQgfSBmcm9tICcuL09yZCc7XG5pbXBvcnQgKiBhcyBTZSBmcm9tICcuL1NlbWlncm91cCc7XG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vLyBpbnRlcm5hbFxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLyoqXG4gKiBAaW50ZXJuYWxcbiAqL1xuZXhwb3J0IHZhciBlbXB0eSA9IF8uZW1wdHlSZWFkb25seUFycmF5O1xuLyoqXG4gKiBAaW50ZXJuYWxcbiAqL1xuZXhwb3J0IHZhciBpc05vbkVtcHR5ID0gXy5pc05vbkVtcHR5O1xuLyoqXG4gKiBAaW50ZXJuYWxcbiAqL1xuZXhwb3J0IHZhciBpc091dE9mQm91bmQgPSBmdW5jdGlvbiAoaSwgYXMpIHsgcmV0dXJuIGkgPCAwIHx8IGkgPj0gYXMubGVuZ3RoOyB9O1xuLyoqXG4gKiBAaW50ZXJuYWxcbiAqL1xuZXhwb3J0IHZhciBwcmVwZW5kVyA9IGZ1bmN0aW9uIChoZWFkKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uICh0YWlsKSB7XG4gICAgICAgIHJldHVybiBfX3NwcmVhZEFycmF5KFtoZWFkXSwgdGFpbCwgdHJ1ZSk7XG4gICAgfTtcbn07XG4vKipcbiAqIEBpbnRlcm5hbFxuICovXG5leHBvcnQgdmFyIHByZXBlbmQgPSBwcmVwZW5kVztcbi8qKlxuICogQGludGVybmFsXG4gKi9cbmV4cG9ydCB2YXIgYXBwZW5kVyA9IGZ1bmN0aW9uIChlbmQpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGluaXQpIHtcbiAgICAgICAgcmV0dXJuIF9fc3ByZWFkQXJyYXkoX19zcHJlYWRBcnJheShbXSwgaW5pdCwgdHJ1ZSksIFtlbmRdLCBmYWxzZSk7XG4gICAgfTtcbn07XG4vKipcbiAqIEBpbnRlcm5hbFxuICovXG5leHBvcnQgdmFyIGFwcGVuZCA9IGFwcGVuZFc7XG4vKipcbiAqIEBpbnRlcm5hbFxuICovXG5leHBvcnQgdmFyIHVuc2FmZUluc2VydEF0ID0gZnVuY3Rpb24gKGksIGEsIGFzKSB7XG4gICAgaWYgKGlzTm9uRW1wdHkoYXMpKSB7XG4gICAgICAgIHZhciB4cyA9IF8uZnJvbVJlYWRvbmx5Tm9uRW1wdHlBcnJheShhcyk7XG4gICAgICAgIHhzLnNwbGljZShpLCAwLCBhKTtcbiAgICAgICAgcmV0dXJuIHhzO1xuICAgIH1cbiAgICByZXR1cm4gW2FdO1xufTtcbi8qKlxuICogQGludGVybmFsXG4gKi9cbmV4cG9ydCB2YXIgdW5zYWZlVXBkYXRlQXQgPSBmdW5jdGlvbiAoaSwgYSwgYXMpIHtcbiAgICBpZiAoYXNbaV0gPT09IGEpIHtcbiAgICAgICAgcmV0dXJuIGFzO1xuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgICAgdmFyIHhzID0gXy5mcm9tUmVhZG9ubHlOb25FbXB0eUFycmF5KGFzKTtcbiAgICAgICAgeHNbaV0gPSBhO1xuICAgICAgICByZXR1cm4geHM7XG4gICAgfVxufTtcbi8qKlxuICogUmVtb3ZlIGR1cGxpY2F0ZXMgZnJvbSBhIGBSZWFkb25seU5vbkVtcHR5QXJyYXlgLCBrZWVwaW5nIHRoZSBmaXJzdCBvY2N1cnJlbmNlIG9mIGFuIGVsZW1lbnQuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IHVuaXEgfSBmcm9tICdmcC10cy9SZWFkb25seU5vbkVtcHR5QXJyYXknXG4gKiBpbXBvcnQgKiBhcyBOIGZyb20gJ2ZwLXRzL251bWJlcidcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKHVuaXEoTi5FcSkoWzEsIDIsIDFdKSwgWzEsIDJdKVxuICpcbiAqIEBzaW5jZSAyLjExLjBcbiAqL1xuZXhwb3J0IHZhciB1bmlxID0gZnVuY3Rpb24gKEUpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIGlmIChhcy5sZW5ndGggPT09IDEpIHtcbiAgICAgICAgICAgIHJldHVybiBhcztcbiAgICAgICAgfVxuICAgICAgICB2YXIgb3V0ID0gW2hlYWQoYXMpXTtcbiAgICAgICAgdmFyIHJlc3QgPSB0YWlsKGFzKTtcbiAgICAgICAgdmFyIF9sb29wXzEgPSBmdW5jdGlvbiAoYSkge1xuICAgICAgICAgICAgaWYgKG91dC5ldmVyeShmdW5jdGlvbiAobykgeyByZXR1cm4gIUUuZXF1YWxzKG8sIGEpOyB9KSkge1xuICAgICAgICAgICAgICAgIG91dC5wdXNoKGEpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICBmb3IgKHZhciBfaSA9IDAsIHJlc3RfMSA9IHJlc3Q7IF9pIDwgcmVzdF8xLmxlbmd0aDsgX2krKykge1xuICAgICAgICAgICAgdmFyIGEgPSByZXN0XzFbX2ldO1xuICAgICAgICAgICAgX2xvb3BfMShhKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gb3V0O1xuICAgIH07XG59O1xuLyoqXG4gKiBTb3J0IHRoZSBlbGVtZW50cyBvZiBhIGBSZWFkb25seU5vbkVtcHR5QXJyYXlgIGluIGluY3JlYXNpbmcgb3JkZXIsIHdoZXJlIGVsZW1lbnRzIGFyZSBjb21wYXJlZCB1c2luZyBmaXJzdCBgb3Jkc1swXWAsIHRoZW4gYG9yZHNbMV1gLFxuICogZXRjLi4uXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCAqIGFzIFJORUEgZnJvbSAnZnAtdHMvUmVhZG9ubHlOb25FbXB0eUFycmF5J1xuICogaW1wb3J0IHsgY29udHJhbWFwIH0gZnJvbSAnZnAtdHMvT3JkJ1xuICogaW1wb3J0ICogYXMgUyBmcm9tICdmcC10cy9zdHJpbmcnXG4gKiBpbXBvcnQgKiBhcyBOIGZyb20gJ2ZwLXRzL251bWJlcidcbiAqIGltcG9ydCB7IHBpcGUgfSBmcm9tICdmcC10cy9mdW5jdGlvbidcbiAqXG4gKiBpbnRlcmZhY2UgUGVyc29uIHtcbiAqICAgbmFtZTogc3RyaW5nXG4gKiAgIGFnZTogbnVtYmVyXG4gKiB9XG4gKlxuICogY29uc3QgYnlOYW1lID0gcGlwZShTLk9yZCwgY29udHJhbWFwKChwOiBQZXJzb24pID0+IHAubmFtZSkpXG4gKlxuICogY29uc3QgYnlBZ2UgPSBwaXBlKE4uT3JkLCBjb250cmFtYXAoKHA6IFBlcnNvbikgPT4gcC5hZ2UpKVxuICpcbiAqIGNvbnN0IHNvcnRCeU5hbWVCeUFnZSA9IFJORUEuc29ydEJ5KFtieU5hbWUsIGJ5QWdlXSlcbiAqXG4gKiBjb25zdCBwZXJzb25zOiBSTkVBLlJlYWRvbmx5Tm9uRW1wdHlBcnJheTxQZXJzb24+ID0gW1xuICogICB7IG5hbWU6ICdhJywgYWdlOiAxIH0sXG4gKiAgIHsgbmFtZTogJ2InLCBhZ2U6IDMgfSxcbiAqICAgeyBuYW1lOiAnYycsIGFnZTogMiB9LFxuICogICB7IG5hbWU6ICdiJywgYWdlOiAyIH1cbiAqIF1cbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKHNvcnRCeU5hbWVCeUFnZShwZXJzb25zKSwgW1xuICogICB7IG5hbWU6ICdhJywgYWdlOiAxIH0sXG4gKiAgIHsgbmFtZTogJ2InLCBhZ2U6IDIgfSxcbiAqICAgeyBuYW1lOiAnYicsIGFnZTogMyB9LFxuICogICB7IG5hbWU6ICdjJywgYWdlOiAyIH1cbiAqIF0pXG4gKlxuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIHNvcnRCeSA9IGZ1bmN0aW9uIChvcmRzKSB7XG4gICAgaWYgKGlzTm9uRW1wdHkob3JkcykpIHtcbiAgICAgICAgdmFyIE0gPSBnZXRNb25vaWQoKTtcbiAgICAgICAgcmV0dXJuIHNvcnQob3Jkcy5yZWR1Y2UoTS5jb25jYXQsIE0uZW1wdHkpKTtcbiAgICB9XG4gICAgcmV0dXJuIGlkZW50aXR5O1xufTtcbi8qKlxuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIHVuaW9uID0gZnVuY3Rpb24gKEUpIHtcbiAgICB2YXIgdW5pcUUgPSB1bmlxKEUpO1xuICAgIHJldHVybiBmdW5jdGlvbiAoc2Vjb25kKSB7IHJldHVybiBmdW5jdGlvbiAoZmlyc3QpIHsgcmV0dXJuIHVuaXFFKHBpcGUoZmlyc3QsIGNvbmNhdChzZWNvbmQpKSk7IH07IH07XG59O1xuLyoqXG4gKiBSb3RhdGUgYSBgUmVhZG9ubHlOb25FbXB0eUFycmF5YCBieSBgbmAgc3RlcHMuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IHJvdGF0ZSB9IGZyb20gJ2ZwLXRzL1JlYWRvbmx5Tm9uRW1wdHlBcnJheSdcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKHJvdGF0ZSgyKShbMSwgMiwgMywgNCwgNV0pLCBbNCwgNSwgMSwgMiwgM10pXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKHJvdGF0ZSgtMikoWzEsIDIsIDMsIDQsIDVdKSwgWzMsIDQsIDUsIDEsIDJdKVxuICpcbiAqIEBzaW5jZSAyLjExLjBcbiAqL1xuZXhwb3J0IHZhciByb3RhdGUgPSBmdW5jdGlvbiAobikge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgdmFyIGxlbiA9IGFzLmxlbmd0aDtcbiAgICAgICAgdmFyIG0gPSBNYXRoLnJvdW5kKG4pICUgbGVuO1xuICAgICAgICBpZiAoaXNPdXRPZkJvdW5kKE1hdGguYWJzKG0pLCBhcykgfHwgbSA9PT0gMCkge1xuICAgICAgICAgICAgcmV0dXJuIGFzO1xuICAgICAgICB9XG4gICAgICAgIGlmIChtIDwgMCkge1xuICAgICAgICAgICAgdmFyIF9hID0gc3BsaXRBdCgtbSkoYXMpLCBmID0gX2FbMF0sIHMgPSBfYVsxXTtcbiAgICAgICAgICAgIHJldHVybiBwaXBlKHMsIGNvbmNhdChmKSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gcm90YXRlKG0gLSBsZW4pKGFzKTtcbiAgICAgICAgfVxuICAgIH07XG59O1xuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLy8gY29uc3RydWN0b3JzXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vKipcbiAqIFJldHVybiBhIGBSZWFkb25seU5vbkVtcHR5QXJyYXlgIGZyb20gYSBgUmVhZG9ubHlBcnJheWAgcmV0dXJuaW5nIGBub25lYCBpZiB0aGUgaW5wdXQgaXMgZW1wdHkuXG4gKlxuICogQGNhdGVnb3J5IGNvbnZlcnNpb25zXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBmcm9tUmVhZG9ubHlBcnJheSA9IGZ1bmN0aW9uIChhcykge1xuICAgIHJldHVybiBpc05vbkVtcHR5KGFzKSA/IF8uc29tZShhcykgOiBfLm5vbmU7XG59O1xuLyoqXG4gKiBSZXR1cm4gYSBgUmVhZG9ubHlOb25FbXB0eUFycmF5YCBvZiBsZW5ndGggYG5gIHdpdGggZWxlbWVudCBgaWAgaW5pdGlhbGl6ZWQgd2l0aCBgZihpKWAuXG4gKlxuICogKipOb3RlKiouIGBuYCBpcyBub3JtYWxpemVkIHRvIGEgbmF0dXJhbCBudW1iZXIuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IG1ha2VCeSB9IGZyb20gJ2ZwLXRzL1JlYWRvbmx5Tm9uRW1wdHlBcnJheSdcbiAqIGltcG9ydCB7IHBpcGUgfSBmcm9tICdmcC10cy9mdW5jdGlvbidcbiAqXG4gKiBjb25zdCBkb3VibGUgPSAobjogbnVtYmVyKTogbnVtYmVyID0+IG4gKiAyXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKHBpcGUoNSwgbWFrZUJ5KGRvdWJsZSkpLCBbMCwgMiwgNCwgNiwgOF0pXG4gKlxuICogQGNhdGVnb3J5IGNvbnN0cnVjdG9yc1xuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIG1ha2VCeSA9IGZ1bmN0aW9uIChmKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChuKSB7XG4gICAgICAgIHZhciBqID0gTWF0aC5tYXgoMCwgTWF0aC5mbG9vcihuKSk7XG4gICAgICAgIHZhciBvdXQgPSBbZigwKV07XG4gICAgICAgIGZvciAodmFyIGkgPSAxOyBpIDwgajsgaSsrKSB7XG4gICAgICAgICAgICBvdXQucHVzaChmKGkpKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gb3V0O1xuICAgIH07XG59O1xuLyoqXG4gKiBDcmVhdGUgYSBgUmVhZG9ubHlOb25FbXB0eUFycmF5YCBjb250YWluaW5nIGEgdmFsdWUgcmVwZWF0ZWQgdGhlIHNwZWNpZmllZCBudW1iZXIgb2YgdGltZXMuXG4gKlxuICogKipOb3RlKiouIGBuYCBpcyBub3JtYWxpemVkIHRvIGEgbmF0dXJhbCBudW1iZXIuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IHJlcGxpY2F0ZSB9IGZyb20gJ2ZwLXRzL1JlYWRvbmx5Tm9uRW1wdHlBcnJheSdcbiAqIGltcG9ydCB7IHBpcGUgfSBmcm9tICdmcC10cy9mdW5jdGlvbidcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKHBpcGUoMywgcmVwbGljYXRlKCdhJykpLCBbJ2EnLCAnYScsICdhJ10pXG4gKlxuICogQGNhdGVnb3J5IGNvbnN0cnVjdG9yc1xuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIHJlcGxpY2F0ZSA9IGZ1bmN0aW9uIChhKSB7IHJldHVybiBtYWtlQnkoZnVuY3Rpb24gKCkgeyByZXR1cm4gYTsgfSk7IH07XG4vKipcbiAqIENyZWF0ZSBhIGBSZWFkb25seU5vbkVtcHR5QXJyYXlgIGNvbnRhaW5pbmcgYSByYW5nZSBvZiBpbnRlZ2VycywgaW5jbHVkaW5nIGJvdGggZW5kcG9pbnRzLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyByYW5nZSB9IGZyb20gJ2ZwLXRzL1JlYWRvbmx5Tm9uRW1wdHlBcnJheSdcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKHJhbmdlKDEsIDUpLCBbMSwgMiwgMywgNCwgNV0pXG4gKlxuICogQGNhdGVnb3J5IGNvbnN0cnVjdG9yc1xuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIHJhbmdlID0gZnVuY3Rpb24gKHN0YXJ0LCBlbmQpIHtcbiAgICByZXR1cm4gc3RhcnQgPD0gZW5kID8gbWFrZUJ5KGZ1bmN0aW9uIChpKSB7IHJldHVybiBzdGFydCArIGk7IH0pKGVuZCAtIHN0YXJ0ICsgMSkgOiBbc3RhcnRdO1xufTtcbi8qKlxuICogUmV0dXJuIHRoZSB0dXBsZSBvZiB0aGUgYGhlYWRgIGFuZCB0aGUgYHRhaWxgLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyB1bnByZXBlbmQgfSBmcm9tICdmcC10cy9SZWFkb25seU5vbkVtcHR5QXJyYXknXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbCh1bnByZXBlbmQoWzEsIDIsIDMsIDRdKSwgWzEsIFsyLCAzLCA0XV0pXG4gKlxuICogQHNpbmNlIDIuOS4wXG4gKi9cbmV4cG9ydCB2YXIgdW5wcmVwZW5kID0gZnVuY3Rpb24gKGFzKSB7IHJldHVybiBbaGVhZChhcyksIHRhaWwoYXMpXTsgfTtcbi8qKlxuICogUmV0dXJuIHRoZSB0dXBsZSBvZiB0aGUgYGluaXRgIGFuZCB0aGUgYGxhc3RgLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyB1bmFwcGVuZCB9IGZyb20gJ2ZwLXRzL1JlYWRvbmx5Tm9uRW1wdHlBcnJheSdcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKHVuYXBwZW5kKFsxLCAyLCAzLCA0XSksIFtbMSwgMiwgM10sIDRdKVxuICpcbiAqIEBzaW5jZSAyLjkuMFxuICovXG5leHBvcnQgdmFyIHVuYXBwZW5kID0gZnVuY3Rpb24gKGFzKSB7IHJldHVybiBbaW5pdChhcyksIGxhc3QoYXMpXTsgfTtcbi8qKlxuICogQGNhdGVnb3J5IGNvbnZlcnNpb25zXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBmcm9tQXJyYXkgPSBmdW5jdGlvbiAoYXMpIHsgcmV0dXJuIGZyb21SZWFkb25seUFycmF5KGFzLnNsaWNlKCkpOyB9O1xuZXhwb3J0IGZ1bmN0aW9uIGNvbmNhdFcoc2Vjb25kKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChmaXJzdCkgeyByZXR1cm4gZmlyc3QuY29uY2F0KHNlY29uZCk7IH07XG59XG5leHBvcnQgZnVuY3Rpb24gY29uY2F0KHgsIHkpIHtcbiAgICByZXR1cm4geSA/IHguY29uY2F0KHkpIDogZnVuY3Rpb24gKHkpIHsgcmV0dXJuIHkuY29uY2F0KHgpOyB9O1xufVxuLyoqXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciByZXZlcnNlID0gZnVuY3Rpb24gKGFzKSB7XG4gICAgcmV0dXJuIGFzLmxlbmd0aCA9PT0gMSA/IGFzIDogX19zcHJlYWRBcnJheShbbGFzdChhcyldLCBhcy5zbGljZSgwLCAtMSkucmV2ZXJzZSgpLCB0cnVlKTtcbn07XG5leHBvcnQgZnVuY3Rpb24gZ3JvdXAoRSkge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgdmFyIGxlbiA9IGFzLmxlbmd0aDtcbiAgICAgICAgaWYgKGxlbiA9PT0gMCkge1xuICAgICAgICAgICAgcmV0dXJuIGVtcHR5O1xuICAgICAgICB9XG4gICAgICAgIHZhciBvdXQgPSBbXTtcbiAgICAgICAgdmFyIGhlYWQgPSBhc1swXTtcbiAgICAgICAgdmFyIG5lYSA9IFtoZWFkXTtcbiAgICAgICAgZm9yICh2YXIgaSA9IDE7IGkgPCBsZW47IGkrKykge1xuICAgICAgICAgICAgdmFyIGEgPSBhc1tpXTtcbiAgICAgICAgICAgIGlmIChFLmVxdWFscyhhLCBoZWFkKSkge1xuICAgICAgICAgICAgICAgIG5lYS5wdXNoKGEpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgb3V0LnB1c2gobmVhKTtcbiAgICAgICAgICAgICAgICBoZWFkID0gYTtcbiAgICAgICAgICAgICAgICBuZWEgPSBbaGVhZF07XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgb3V0LnB1c2gobmVhKTtcbiAgICAgICAgcmV0dXJuIG91dDtcbiAgICB9O1xufVxuLyoqXG4gKiBTcGxpdHMgYW4gYXJyYXkgaW50byBzdWItbm9uLWVtcHR5LWFycmF5cyBzdG9yZWQgaW4gYW4gb2JqZWN0LCBiYXNlZCBvbiB0aGUgcmVzdWx0IG9mIGNhbGxpbmcgYSBgc3RyaW5nYC1yZXR1cm5pbmdcbiAqIGZ1bmN0aW9uIG9uIGVhY2ggZWxlbWVudCwgYW5kIGdyb3VwaW5nIHRoZSByZXN1bHRzIGFjY29yZGluZyB0byB2YWx1ZXMgcmV0dXJuZWRcbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgZ3JvdXBCeSB9IGZyb20gJ2ZwLXRzL1JlYWRvbmx5Tm9uRW1wdHlBcnJheSdcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKGdyb3VwQnkoKHM6IHN0cmluZykgPT4gU3RyaW5nKHMubGVuZ3RoKSkoWydhJywgJ2InLCAnYWInXSksIHtcbiAqICAgJzEnOiBbJ2EnLCAnYiddLFxuICogICAnMic6IFsnYWInXVxuICogfSlcbiAqXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBncm91cEJ5ID0gZnVuY3Rpb24gKGYpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIHZhciBvdXQgPSB7fTtcbiAgICAgICAgZm9yICh2YXIgX2kgPSAwLCBhc18xID0gYXM7IF9pIDwgYXNfMS5sZW5ndGg7IF9pKyspIHtcbiAgICAgICAgICAgIHZhciBhID0gYXNfMVtfaV07XG4gICAgICAgICAgICB2YXIgayA9IGYoYSk7XG4gICAgICAgICAgICBpZiAoXy5oYXMuY2FsbChvdXQsIGspKSB7XG4gICAgICAgICAgICAgICAgb3V0W2tdLnB1c2goYSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBvdXRba10gPSBbYV07XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG91dDtcbiAgICB9O1xufTtcbi8qKlxuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgc29ydCA9IGZ1bmN0aW9uIChPKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykge1xuICAgICAgICByZXR1cm4gYXMubGVuZ3RoID09PSAxID8gYXMgOiBhcy5zbGljZSgpLnNvcnQoTy5jb21wYXJlKTtcbiAgICB9O1xufTtcbi8qKlxuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgdXBkYXRlQXQgPSBmdW5jdGlvbiAoaSwgYSkge1xuICAgIHJldHVybiBtb2RpZnlBdChpLCBmdW5jdGlvbiAoKSB7IHJldHVybiBhOyB9KTtcbn07XG4vKipcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIG1vZGlmeUF0ID0gZnVuY3Rpb24gKGksIGYpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIHJldHVybiBpc091dE9mQm91bmQoaSwgYXMpID8gXy5ub25lIDogXy5zb21lKHVuc2FmZVVwZGF0ZUF0KGksIGYoYXNbaV0pLCBhcykpO1xuICAgIH07XG59O1xuLyoqXG4gKiBAc2luY2UgMi41LjFcbiAqL1xuZXhwb3J0IHZhciB6aXBXaXRoID0gZnVuY3Rpb24gKGFzLCBicywgZikge1xuICAgIHZhciBjcyA9IFtmKGFzWzBdLCBic1swXSldO1xuICAgIHZhciBsZW4gPSBNYXRoLm1pbihhcy5sZW5ndGgsIGJzLmxlbmd0aCk7XG4gICAgZm9yICh2YXIgaSA9IDE7IGkgPCBsZW47IGkrKykge1xuICAgICAgICBjc1tpXSA9IGYoYXNbaV0sIGJzW2ldKTtcbiAgICB9XG4gICAgcmV0dXJuIGNzO1xufTtcbmV4cG9ydCBmdW5jdGlvbiB6aXAoYXMsIGJzKSB7XG4gICAgaWYgKGJzID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIChicykgeyByZXR1cm4gemlwKGJzLCBhcyk7IH07XG4gICAgfVxuICAgIHJldHVybiB6aXBXaXRoKGFzLCBicywgZnVuY3Rpb24gKGEsIGIpIHsgcmV0dXJuIFthLCBiXTsgfSk7XG59XG4vKipcbiAqIEBzaW5jZSAyLjUuMVxuICovXG5leHBvcnQgdmFyIHVuemlwID0gZnVuY3Rpb24gKGFicykge1xuICAgIHZhciBmYSA9IFthYnNbMF1bMF1dO1xuICAgIHZhciBmYiA9IFthYnNbMF1bMV1dO1xuICAgIGZvciAodmFyIGkgPSAxOyBpIDwgYWJzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIGZhW2ldID0gYWJzW2ldWzBdO1xuICAgICAgICBmYltpXSA9IGFic1tpXVsxXTtcbiAgICB9XG4gICAgcmV0dXJuIFtmYSwgZmJdO1xufTtcbi8qKlxuICogUHJlcGVuZCBhbiBlbGVtZW50IHRvIGV2ZXJ5IG1lbWJlciBvZiBhIGBSZWFkb25seU5vbkVtcHR5QXJyYXlgLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBwcmVwZW5kQWxsIH0gZnJvbSAnZnAtdHMvUmVhZG9ubHlOb25FbXB0eUFycmF5J1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwocHJlcGVuZEFsbCg5KShbMSwgMiwgMywgNF0pLCBbOSwgMSwgOSwgMiwgOSwgMywgOSwgNF0pXG4gKlxuICogQHNpbmNlIDIuMTAuMFxuICovXG5leHBvcnQgdmFyIHByZXBlbmRBbGwgPSBmdW5jdGlvbiAobWlkZGxlKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykge1xuICAgICAgICB2YXIgb3V0ID0gW21pZGRsZSwgYXNbMF1dO1xuICAgICAgICBmb3IgKHZhciBpID0gMTsgaSA8IGFzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICBvdXQucHVzaChtaWRkbGUsIGFzW2ldKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gb3V0O1xuICAgIH07XG59O1xuLyoqXG4gKiBQbGFjZXMgYW4gZWxlbWVudCBpbiBiZXR3ZWVuIG1lbWJlcnMgb2YgYSBgUmVhZG9ubHlOb25FbXB0eUFycmF5YC5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgaW50ZXJzcGVyc2UgfSBmcm9tICdmcC10cy9SZWFkb25seU5vbkVtcHR5QXJyYXknXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChpbnRlcnNwZXJzZSg5KShbMSwgMiwgMywgNF0pLCBbMSwgOSwgMiwgOSwgMywgOSwgNF0pXG4gKlxuICogQHNpbmNlIDIuOS4wXG4gKi9cbmV4cG9ydCB2YXIgaW50ZXJzcGVyc2UgPSBmdW5jdGlvbiAobWlkZGxlKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykge1xuICAgICAgICB2YXIgcmVzdCA9IHRhaWwoYXMpO1xuICAgICAgICByZXR1cm4gaXNOb25FbXB0eShyZXN0KSA/IHBpcGUocmVzdCwgcHJlcGVuZEFsbChtaWRkbGUpLCBwcmVwZW5kKGhlYWQoYXMpKSkgOiBhcztcbiAgICB9O1xufTtcbi8qKlxuICogQGNhdGVnb3J5IHNlcXVlbmNpbmdcbiAqIEBzaW5jZSAyLjEwLjBcbiAqL1xuZXhwb3J0IHZhciBjaGFpbldpdGhJbmRleCA9IGZ1bmN0aW9uIChmKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykge1xuICAgICAgICB2YXIgb3V0ID0gXy5mcm9tUmVhZG9ubHlOb25FbXB0eUFycmF5KGYoMCwgaGVhZChhcykpKTtcbiAgICAgICAgZm9yICh2YXIgaSA9IDE7IGkgPCBhcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgb3V0LnB1c2guYXBwbHkob3V0LCBmKGksIGFzW2ldKSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG91dDtcbiAgICB9O1xufTtcbi8qKlxuICogQSB1c2VmdWwgcmVjdXJzaW9uIHBhdHRlcm4gZm9yIHByb2Nlc3NpbmcgYSBgUmVhZG9ubHlOb25FbXB0eUFycmF5YCB0byBwcm9kdWNlIGEgbmV3IGBSZWFkb25seU5vbkVtcHR5QXJyYXlgLCBvZnRlbiB1c2VkIGZvciBcImNob3BwaW5nXCIgdXAgdGhlIGlucHV0XG4gKiBgUmVhZG9ubHlOb25FbXB0eUFycmF5YC4gVHlwaWNhbGx5IGBjaG9wYCBpcyBjYWxsZWQgd2l0aCBzb21lIGZ1bmN0aW9uIHRoYXQgd2lsbCBjb25zdW1lIGFuIGluaXRpYWwgcHJlZml4IG9mIHRoZSBgUmVhZG9ubHlOb25FbXB0eUFycmF5YCBhbmQgcHJvZHVjZSBhXG4gKiB2YWx1ZSBhbmQgdGhlIHRhaWwgb2YgdGhlIGBSZWFkb25seU5vbkVtcHR5QXJyYXlgLlxuICpcbiAqIEBzaW5jZSAyLjEwLjBcbiAqL1xuZXhwb3J0IHZhciBjaG9wID0gZnVuY3Rpb24gKGYpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIHZhciBfYSA9IGYoYXMpLCBiID0gX2FbMF0sIHJlc3QgPSBfYVsxXTtcbiAgICAgICAgdmFyIG91dCA9IFtiXTtcbiAgICAgICAgdmFyIG5leHQgPSByZXN0O1xuICAgICAgICB3aGlsZSAoaXNOb25FbXB0eShuZXh0KSkge1xuICAgICAgICAgICAgdmFyIF9iID0gZihuZXh0KSwgYl8xID0gX2JbMF0sIHJlc3RfMiA9IF9iWzFdO1xuICAgICAgICAgICAgb3V0LnB1c2goYl8xKTtcbiAgICAgICAgICAgIG5leHQgPSByZXN0XzI7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG91dDtcbiAgICB9O1xufTtcbi8qKlxuICogU3BsaXRzIGEgYFJlYWRvbmx5Tm9uRW1wdHlBcnJheWAgaW50byB0d28gcGllY2VzLCB0aGUgZmlyc3QgcGllY2UgaGFzIG1heCBgbmAgZWxlbWVudHMuXG4gKlxuICogQHNpbmNlIDIuMTAuMFxuICovXG5leHBvcnQgdmFyIHNwbGl0QXQgPSBmdW5jdGlvbiAobikge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgdmFyIG0gPSBNYXRoLm1heCgxLCBuKTtcbiAgICAgICAgcmV0dXJuIG0gPj0gYXMubGVuZ3RoID8gW2FzLCBlbXB0eV0gOiBbcGlwZShhcy5zbGljZSgxLCBtKSwgcHJlcGVuZChoZWFkKGFzKSkpLCBhcy5zbGljZShtKV07XG4gICAgfTtcbn07XG4vKipcbiAqIFNwbGl0cyBhIGBSZWFkb25seU5vbkVtcHR5QXJyYXlgIGludG8gbGVuZ3RoLWBuYCBwaWVjZXMuIFRoZSBsYXN0IHBpZWNlIHdpbGwgYmUgc2hvcnRlciBpZiBgbmAgZG9lcyBub3QgZXZlbmx5IGRpdmlkZSB0aGUgbGVuZ3RoIG9mXG4gKiB0aGUgYFJlYWRvbmx5Tm9uRW1wdHlBcnJheWAuXG4gKlxuICogQHNpbmNlIDIuMTAuMFxuICovXG5leHBvcnQgdmFyIGNodW5rc09mID0gZnVuY3Rpb24gKG4pIHsgcmV0dXJuIGNob3Aoc3BsaXRBdChuKSk7IH07XG52YXIgX21hcCA9IGZ1bmN0aW9uIChmYSwgZikgeyByZXR1cm4gcGlwZShmYSwgbWFwKGYpKTsgfTtcbi8qIGlzdGFuYnVsIGlnbm9yZSBuZXh0ICovXG52YXIgX21hcFdpdGhJbmRleCA9IGZ1bmN0aW9uIChmYSwgZikgeyByZXR1cm4gcGlwZShmYSwgbWFwV2l0aEluZGV4KGYpKTsgfTtcbnZhciBfYXAgPSBmdW5jdGlvbiAoZmFiLCBmYSkgeyByZXR1cm4gcGlwZShmYWIsIGFwKGZhKSk7IH07XG4vKiBpc3RhbmJ1bCBpZ25vcmUgbmV4dCAqL1xudmFyIF9leHRlbmQgPSBmdW5jdGlvbiAod2EsIGYpIHsgcmV0dXJuIHBpcGUod2EsIGV4dGVuZChmKSk7IH07XG4vKiBpc3RhbmJ1bCBpZ25vcmUgbmV4dCAqL1xudmFyIF9yZWR1Y2UgPSBmdW5jdGlvbiAoZmEsIGIsIGYpIHsgcmV0dXJuIHBpcGUoZmEsIHJlZHVjZShiLCBmKSk7IH07XG4vKiBpc3RhbmJ1bCBpZ25vcmUgbmV4dCAqL1xudmFyIF9mb2xkTWFwID0gZnVuY3Rpb24gKE0pIHtcbiAgICB2YXIgZm9sZE1hcE0gPSBmb2xkTWFwKE0pO1xuICAgIHJldHVybiBmdW5jdGlvbiAoZmEsIGYpIHsgcmV0dXJuIHBpcGUoZmEsIGZvbGRNYXBNKGYpKTsgfTtcbn07XG4vKiBpc3RhbmJ1bCBpZ25vcmUgbmV4dCAqL1xudmFyIF9yZWR1Y2VSaWdodCA9IGZ1bmN0aW9uIChmYSwgYiwgZikgeyByZXR1cm4gcGlwZShmYSwgcmVkdWNlUmlnaHQoYiwgZikpOyB9O1xuLyogaXN0YW5idWwgaWdub3JlIG5leHQgKi9cbnZhciBfdHJhdmVyc2UgPSBmdW5jdGlvbiAoRikge1xuICAgIHZhciB0cmF2ZXJzZUYgPSB0cmF2ZXJzZShGKTtcbiAgICByZXR1cm4gZnVuY3Rpb24gKHRhLCBmKSB7IHJldHVybiBwaXBlKHRhLCB0cmF2ZXJzZUYoZikpOyB9O1xufTtcbi8qIGlzdGFuYnVsIGlnbm9yZSBuZXh0ICovXG52YXIgX2FsdCA9IGZ1bmN0aW9uIChmYSwgdGhhdCkgeyByZXR1cm4gcGlwZShmYSwgYWx0KHRoYXQpKTsgfTtcbi8qIGlzdGFuYnVsIGlnbm9yZSBuZXh0ICovXG52YXIgX3JlZHVjZVdpdGhJbmRleCA9IGZ1bmN0aW9uIChmYSwgYiwgZikge1xuICAgIHJldHVybiBwaXBlKGZhLCByZWR1Y2VXaXRoSW5kZXgoYiwgZikpO1xufTtcbi8qIGlzdGFuYnVsIGlnbm9yZSBuZXh0ICovXG52YXIgX2ZvbGRNYXBXaXRoSW5kZXggPSBmdW5jdGlvbiAoTSkge1xuICAgIHZhciBmb2xkTWFwV2l0aEluZGV4TSA9IGZvbGRNYXBXaXRoSW5kZXgoTSk7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChmYSwgZikgeyByZXR1cm4gcGlwZShmYSwgZm9sZE1hcFdpdGhJbmRleE0oZikpOyB9O1xufTtcbi8qIGlzdGFuYnVsIGlnbm9yZSBuZXh0ICovXG52YXIgX3JlZHVjZVJpZ2h0V2l0aEluZGV4ID0gZnVuY3Rpb24gKGZhLCBiLCBmKSB7XG4gICAgcmV0dXJuIHBpcGUoZmEsIHJlZHVjZVJpZ2h0V2l0aEluZGV4KGIsIGYpKTtcbn07XG4vKiBpc3RhbmJ1bCBpZ25vcmUgbmV4dCAqL1xudmFyIF90cmF2ZXJzZVdpdGhJbmRleCA9IGZ1bmN0aW9uIChGKSB7XG4gICAgdmFyIHRyYXZlcnNlV2l0aEluZGV4RiA9IHRyYXZlcnNlV2l0aEluZGV4KEYpO1xuICAgIHJldHVybiBmdW5jdGlvbiAodGEsIGYpIHsgcmV0dXJuIHBpcGUodGEsIHRyYXZlcnNlV2l0aEluZGV4RihmKSk7IH07XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgY29uc3RydWN0b3JzXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBvZiA9IF8uc2luZ2xldG9uO1xuLyoqXG4gKiBMZXNzIHN0cmljdCB2ZXJzaW9uIG9mIFtgYWx0YF0oI2FsdCkuXG4gKlxuICogVGhlIGBXYCBzdWZmaXggKHNob3J0IGZvciAqKlcqKmlkZW5pbmcpIG1lYW5zIHRoYXQgdGhlIHJldHVybiB0eXBlcyB3aWxsIGJlIG1lcmdlZC5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0ICogYXMgUk5FQSBmcm9tICdmcC10cy9SZWFkb25seU5vbkVtcHR5QXJyYXknXG4gKiBpbXBvcnQgeyBwaXBlIH0gZnJvbSAnZnAtdHMvZnVuY3Rpb24nXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChcbiAqICAgcGlwZShcbiAqICAgICBbMSwgMiwgM10gYXMgUk5FQS5SZWFkb25seU5vbkVtcHR5QXJyYXk8bnVtYmVyPixcbiAqICAgICBSTkVBLmFsdFcoKCkgPT4gWydhJywgJ2InXSlcbiAqICAgKSxcbiAqICAgWzEsIDIsIDMsICdhJywgJ2InXVxuICogKVxuICpcbiAqIEBjYXRlZ29yeSBlcnJvciBoYW5kbGluZ1xuICogQHNpbmNlIDIuOS4wXG4gKi9cbmV4cG9ydCB2YXIgYWx0VyA9IGZ1bmN0aW9uICh0aGF0KSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykge1xuICAgICAgICByZXR1cm4gcGlwZShhcywgY29uY2F0Vyh0aGF0KCkpKTtcbiAgICB9O1xufTtcbi8qKlxuICogSWRlbnRpZmllcyBhbiBhc3NvY2lhdGl2ZSBvcGVyYXRpb24gb24gYSB0eXBlIGNvbnN0cnVjdG9yLiBJdCBpcyBzaW1pbGFyIHRvIGBTZW1pZ3JvdXBgLCBleGNlcHQgdGhhdCBpdCBhcHBsaWVzIHRvXG4gKiB0eXBlcyBvZiBraW5kIGAqIC0+ICpgLlxuICpcbiAqIEluIGNhc2Ugb2YgYFJlYWRvbmx5Tm9uRW1wdHlBcnJheWAgY29uY2F0ZW5hdGVzIHRoZSBpbnB1dHMgaW50byBhIHNpbmdsZSBhcnJheS5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0ICogYXMgUk5FQSBmcm9tICdmcC10cy9SZWFkb25seU5vbkVtcHR5QXJyYXknXG4gKiBpbXBvcnQgeyBwaXBlIH0gZnJvbSAnZnAtdHMvZnVuY3Rpb24nXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChcbiAqICAgcGlwZShcbiAqICAgICBbMSwgMiwgM10sXG4gKiAgICAgUk5FQS5hbHQoKCkgPT4gWzQsIDVdKVxuICogICApLFxuICogICBbMSwgMiwgMywgNCwgNV1cbiAqIClcbiAqXG4gKiBAY2F0ZWdvcnkgZXJyb3IgaGFuZGxpbmdcbiAqIEBzaW5jZSAyLjYuMlxuICovXG5leHBvcnQgdmFyIGFsdCA9IGFsdFc7XG4vKipcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIGFwID0gZnVuY3Rpb24gKGFzKSB7IHJldHVybiBmbGF0TWFwKGZ1bmN0aW9uIChmKSB7IHJldHVybiBwaXBlKGFzLCBtYXAoZikpOyB9KTsgfTtcbi8qKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCAqIGFzIFJORUEgZnJvbSAnZnAtdHMvUmVhZG9ubHlOb25FbXB0eUFycmF5J1xuICogaW1wb3J0IHsgcGlwZSB9IGZyb20gJ2ZwLXRzL2Z1bmN0aW9uJ1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoXG4gKiAgIHBpcGUoXG4gKiAgICAgWzEsIDIsIDNdLFxuICogICAgIFJORUEuZmxhdE1hcCgobikgPT4gW2BhJHtufWAsIGBiJHtufWBdKVxuICogICApLFxuICogICBbJ2ExJywgJ2IxJywgJ2EyJywgJ2IyJywgJ2EzJywgJ2IzJ11cbiAqIClcbiAqXG4gKiBAY2F0ZWdvcnkgc2VxdWVuY2luZ1xuICogQHNpbmNlIDIuMTQuMFxuICovXG5leHBvcnQgdmFyIGZsYXRNYXAgPSAvKiNfX1BVUkVfXyovIGR1YWwoMiwgZnVuY3Rpb24gKG1hLCBmKSB7XG4gICAgcmV0dXJuIHBpcGUobWEsIGNoYWluV2l0aEluZGV4KGZ1bmN0aW9uIChpLCBhKSB7IHJldHVybiBmKGEsIGkpOyB9KSk7XG59KTtcbi8qKlxuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgZXh0ZW5kID0gZnVuY3Rpb24gKGYpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIHZhciBuZXh0ID0gdGFpbChhcyk7XG4gICAgICAgIHZhciBvdXQgPSBbZihhcyldO1xuICAgICAgICB3aGlsZSAoaXNOb25FbXB0eShuZXh0KSkge1xuICAgICAgICAgICAgb3V0LnB1c2goZihuZXh0KSk7XG4gICAgICAgICAgICBuZXh0ID0gdGFpbChuZXh0KTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gb3V0O1xuICAgIH07XG59O1xuLyoqXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBkdXBsaWNhdGUgPSBcbi8qI19fUFVSRV9fKi8gZXh0ZW5kKGlkZW50aXR5KTtcbi8qKlxuICogQGNhdGVnb3J5IHNlcXVlbmNpbmdcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIGZsYXR0ZW4gPSBcbi8qI19fUFVSRV9fKi8gZmxhdE1hcChpZGVudGl0eSk7XG4vKipcbiAqIGBtYXBgIGNhbiBiZSB1c2VkIHRvIHR1cm4gZnVuY3Rpb25zIGAoYTogQSkgPT4gQmAgaW50byBmdW5jdGlvbnMgYChmYTogRjxBPikgPT4gRjxCPmAgd2hvc2UgYXJndW1lbnQgYW5kIHJldHVybiB0eXBlc1xuICogdXNlIHRoZSB0eXBlIGNvbnN0cnVjdG9yIGBGYCB0byByZXByZXNlbnQgc29tZSBjb21wdXRhdGlvbmFsIGNvbnRleHQuXG4gKlxuICogQGNhdGVnb3J5IG1hcHBpbmdcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIG1hcCA9IGZ1bmN0aW9uIChmKSB7XG4gICAgcmV0dXJuIG1hcFdpdGhJbmRleChmdW5jdGlvbiAoXywgYSkgeyByZXR1cm4gZihhKTsgfSk7XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgbWFwcGluZ1xuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgbWFwV2l0aEluZGV4ID0gZnVuY3Rpb24gKGYpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIHZhciBvdXQgPSBbZigwLCBoZWFkKGFzKSldO1xuICAgICAgICBmb3IgKHZhciBpID0gMTsgaSA8IGFzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICBvdXQucHVzaChmKGksIGFzW2ldKSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG91dDtcbiAgICB9O1xufTtcbi8qKlxuICogQGNhdGVnb3J5IGZvbGRpbmdcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIHJlZHVjZSA9IGZ1bmN0aW9uIChiLCBmKSB7XG4gICAgcmV0dXJuIHJlZHVjZVdpdGhJbmRleChiLCBmdW5jdGlvbiAoXywgYiwgYSkgeyByZXR1cm4gZihiLCBhKTsgfSk7XG59O1xuLyoqXG4gKiAqKk5vdGUqKi4gVGhlIGNvbnN0cmFpbnQgaXMgcmVsYXhlZDogYSBgU2VtaWdyb3VwYCBpbnN0ZWFkIG9mIGEgYE1vbm9pZGAuXG4gKlxuICogQGNhdGVnb3J5IGZvbGRpbmdcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIGZvbGRNYXAgPSBmdW5jdGlvbiAoUykge1xuICAgIHJldHVybiBmdW5jdGlvbiAoZikge1xuICAgICAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgICAgICByZXR1cm4gYXMuc2xpY2UoMSkucmVkdWNlKGZ1bmN0aW9uIChzLCBhKSB7IHJldHVybiBTLmNvbmNhdChzLCBmKGEpKTsgfSwgZihhc1swXSkpO1xuICAgICAgICB9O1xuICAgIH07XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgZm9sZGluZ1xuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgcmVkdWNlUmlnaHQgPSBmdW5jdGlvbiAoYiwgZikge1xuICAgIHJldHVybiByZWR1Y2VSaWdodFdpdGhJbmRleChiLCBmdW5jdGlvbiAoXywgYiwgYSkgeyByZXR1cm4gZihiLCBhKTsgfSk7XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgZm9sZGluZ1xuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgcmVkdWNlV2l0aEluZGV4ID0gZnVuY3Rpb24gKGIsIGYpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIHJldHVybiBhcy5yZWR1Y2UoZnVuY3Rpb24gKGIsIGEsIGkpIHsgcmV0dXJuIGYoaSwgYiwgYSk7IH0sIGIpO1xuICAgIH07XG59O1xuLyoqXG4gKiAqKk5vdGUqKi4gVGhlIGNvbnN0cmFpbnQgaXMgcmVsYXhlZDogYSBgU2VtaWdyb3VwYCBpbnN0ZWFkIG9mIGEgYE1vbm9pZGAuXG4gKlxuICogQGNhdGVnb3J5IGZvbGRpbmdcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIGZvbGRNYXBXaXRoSW5kZXggPSBmdW5jdGlvbiAoUykge1xuICAgIHJldHVybiBmdW5jdGlvbiAoZikge1xuICAgICAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgICAgICByZXR1cm4gYXMuc2xpY2UoMSkucmVkdWNlKGZ1bmN0aW9uIChzLCBhLCBpKSB7IHJldHVybiBTLmNvbmNhdChzLCBmKGkgKyAxLCBhKSk7IH0sIGYoMCwgYXNbMF0pKTtcbiAgICAgICAgfTtcbiAgICB9O1xufTtcbi8qKlxuICogQGNhdGVnb3J5IGZvbGRpbmdcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIHJlZHVjZVJpZ2h0V2l0aEluZGV4ID0gZnVuY3Rpb24gKGIsIGYpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIHJldHVybiBhcy5yZWR1Y2VSaWdodChmdW5jdGlvbiAoYiwgYSwgaSkgeyByZXR1cm4gZihpLCBhLCBiKTsgfSwgYik7XG4gICAgfTtcbn07XG4vKipcbiAqIEBjYXRlZ29yeSB0cmF2ZXJzaW5nXG4gKiBAc2luY2UgMi42LjNcbiAqL1xuZXhwb3J0IHZhciB0cmF2ZXJzZSA9IGZ1bmN0aW9uIChGKSB7XG4gICAgdmFyIHRyYXZlcnNlV2l0aEluZGV4RiA9IHRyYXZlcnNlV2l0aEluZGV4KEYpO1xuICAgIHJldHVybiBmdW5jdGlvbiAoZikgeyByZXR1cm4gdHJhdmVyc2VXaXRoSW5kZXhGKGZ1bmN0aW9uIChfLCBhKSB7IHJldHVybiBmKGEpOyB9KTsgfTtcbn07XG4vKipcbiAqIEBjYXRlZ29yeSB0cmF2ZXJzaW5nXG4gKiBAc2luY2UgMi42LjNcbiAqL1xuZXhwb3J0IHZhciBzZXF1ZW5jZSA9IGZ1bmN0aW9uIChGKSB7IHJldHVybiB0cmF2ZXJzZVdpdGhJbmRleChGKShTSyk7IH07XG4vKipcbiAqIEBjYXRlZ29yeSBzZXF1ZW5jaW5nXG4gKiBAc2luY2UgMi42LjNcbiAqL1xuZXhwb3J0IHZhciB0cmF2ZXJzZVdpdGhJbmRleCA9IGZ1bmN0aW9uIChGKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChmKSB7XG4gICAgICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgICAgIHZhciBvdXQgPSBGLm1hcChmKDAsIGhlYWQoYXMpKSwgb2YpO1xuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDE7IGkgPCBhcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgIG91dCA9IEYuYXAoRi5tYXAob3V0LCBmdW5jdGlvbiAoYnMpIHsgcmV0dXJuIGZ1bmN0aW9uIChiKSB7IHJldHVybiBwaXBlKGJzLCBhcHBlbmQoYikpOyB9OyB9KSwgZihpLCBhc1tpXSkpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIG91dDtcbiAgICAgICAgfTtcbiAgICB9O1xufTtcbi8qKlxuICogQGNhdGVnb3J5IENvbW9uYWRcbiAqIEBzaW5jZSAyLjYuM1xuICovXG5leHBvcnQgdmFyIGV4dHJhY3QgPSBfLmhlYWQ7XG4vKipcbiAqIEBjYXRlZ29yeSB0eXBlIGxhbWJkYXNcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIFVSSSA9ICdSZWFkb25seU5vbkVtcHR5QXJyYXknO1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBnZXRTaG93ID0gZnVuY3Rpb24gKFMpIHsgcmV0dXJuICh7XG4gICAgc2hvdzogZnVuY3Rpb24gKGFzKSB7IHJldHVybiBcIltcIi5jb25jYXQoYXMubWFwKFMuc2hvdykuam9pbignLCAnKSwgXCJdXCIpOyB9XG59KTsgfTtcbi8qKlxuICogQnVpbGRzIGEgYFNlbWlncm91cGAgaW5zdGFuY2UgZm9yIGBSZWFkb25seU5vbkVtcHR5QXJyYXlgXG4gKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgZ2V0U2VtaWdyb3VwID0gZnVuY3Rpb24gKCkgeyByZXR1cm4gKHtcbiAgICBjb25jYXQ6IGNvbmNhdFxufSk7IH07XG4vKipcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBnZXRFcSB9IGZyb20gJ2ZwLXRzL1JlYWRvbmx5Tm9uRW1wdHlBcnJheSdcbiAqIGltcG9ydCAqIGFzIE4gZnJvbSAnZnAtdHMvbnVtYmVyJ1xuICpcbiAqIGNvbnN0IEUgPSBnZXRFcShOLkVxKVxuICogYXNzZXJ0LnN0cmljdEVxdWFsKEUuZXF1YWxzKFsxLCAyXSwgWzEsIDJdKSwgdHJ1ZSlcbiAqIGFzc2VydC5zdHJpY3RFcXVhbChFLmVxdWFscyhbMSwgMl0sIFsxLCAzXSksIGZhbHNlKVxuICpcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIGdldEVxID0gZnVuY3Rpb24gKEUpIHtcbiAgICByZXR1cm4gZnJvbUVxdWFscyhmdW5jdGlvbiAoeHMsIHlzKSB7IHJldHVybiB4cy5sZW5ndGggPT09IHlzLmxlbmd0aCAmJiB4cy5ldmVyeShmdW5jdGlvbiAoeCwgaSkgeyByZXR1cm4gRS5lcXVhbHMoeCwgeXNbaV0pOyB9KTsgfSk7XG59O1xuLyoqXG4gKiBAc2luY2UgMi4xMS4wXG4gKi9cbmV4cG9ydCB2YXIgZ2V0VW5pb25TZW1pZ3JvdXAgPSBmdW5jdGlvbiAoRSkge1xuICAgIHZhciB1bmlvbkUgPSB1bmlvbihFKTtcbiAgICByZXR1cm4ge1xuICAgICAgICBjb25jYXQ6IGZ1bmN0aW9uIChmaXJzdCwgc2Vjb25kKSB7IHJldHVybiB1bmlvbkUoc2Vjb25kKShmaXJzdCk7IH1cbiAgICB9O1xufTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuNy4wXG4gKi9cbmV4cG9ydCB2YXIgRnVuY3RvciA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICBtYXA6IF9tYXBcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBtYXBwaW5nXG4gKiBAc2luY2UgMi4xMC4wXG4gKi9cbmV4cG9ydCB2YXIgZmxhcCA9IC8qI19fUFVSRV9fKi8gZmxhcF8oRnVuY3Rvcik7XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjEwLjBcbiAqL1xuZXhwb3J0IHZhciBQb2ludGVkID0ge1xuICAgIFVSSTogVVJJLFxuICAgIG9mOiBvZlxufTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuNy4wXG4gKi9cbmV4cG9ydCB2YXIgRnVuY3RvcldpdGhJbmRleCA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICBtYXA6IF9tYXAsXG4gICAgbWFwV2l0aEluZGV4OiBfbWFwV2l0aEluZGV4XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi4xMC4wXG4gKi9cbmV4cG9ydCB2YXIgQXBwbHkgPSB7XG4gICAgVVJJOiBVUkksXG4gICAgbWFwOiBfbWFwLFxuICAgIGFwOiBfYXBcbn07XG4vKipcbiAqIENvbWJpbmUgdHdvIGVmZmVjdGZ1bCBhY3Rpb25zLCBrZWVwaW5nIG9ubHkgdGhlIHJlc3VsdCBvZiB0aGUgZmlyc3QuXG4gKlxuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgYXBGaXJzdCA9IC8qI19fUFVSRV9fKi8gYXBGaXJzdF8oQXBwbHkpO1xuLyoqXG4gKiBDb21iaW5lIHR3byBlZmZlY3RmdWwgYWN0aW9ucywga2VlcGluZyBvbmx5IHRoZSByZXN1bHQgb2YgdGhlIHNlY29uZC5cbiAqXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBhcFNlY29uZCA9IC8qI19fUFVSRV9fKi8gYXBTZWNvbmRfKEFwcGx5KTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuNy4wXG4gKi9cbmV4cG9ydCB2YXIgQXBwbGljYXRpdmUgPSB7XG4gICAgVVJJOiBVUkksXG4gICAgbWFwOiBfbWFwLFxuICAgIGFwOiBfYXAsXG4gICAgb2Y6IG9mXG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi4xMC4wXG4gKi9cbmV4cG9ydCB2YXIgQ2hhaW4gPSB7XG4gICAgVVJJOiBVUkksXG4gICAgbWFwOiBfbWFwLFxuICAgIGFwOiBfYXAsXG4gICAgY2hhaW46IGZsYXRNYXBcbn07XG4vKipcbiAqIENvbXBvc2VzIGNvbXB1dGF0aW9ucyBpbiBzZXF1ZW5jZSwgdXNpbmcgdGhlIHJldHVybiB2YWx1ZSBvZiBvbmUgY29tcHV0YXRpb24gdG8gZGV0ZXJtaW5lIHRoZSBuZXh0IGNvbXB1dGF0aW9uIGFuZFxuICoga2VlcGluZyBvbmx5IHRoZSByZXN1bHQgb2YgdGhlIGZpcnN0LlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgKiBhcyBSQSBmcm9tICdmcC10cy9SZWFkb25seUFycmF5J1xuICogaW1wb3J0IHsgcGlwZSB9IGZyb20gJ2ZwLXRzL2Z1bmN0aW9uJ1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoXG4gKiAgIHBpcGUoXG4gKiAgICAgWzEsIDIsIDNdLFxuICogICAgIFJBLmNoYWluRmlyc3QoKCkgPT4gWydhJywgJ2InXSlcbiAqICAgKSxcbiAqICAgWzEsIDEsIDIsIDIsIDMsIDNdXG4gKiApXG4gKlxuICogQGNhdGVnb3J5IHNlcXVlbmNpbmdcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIGNoYWluRmlyc3QgPSAvKiNfX1BVUkVfXyovIGNoYWluRmlyc3RfKENoYWluKTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuNy4wXG4gKi9cbmV4cG9ydCB2YXIgTW9uYWQgPSB7XG4gICAgVVJJOiBVUkksXG4gICAgbWFwOiBfbWFwLFxuICAgIGFwOiBfYXAsXG4gICAgb2Y6IG9mLFxuICAgIGNoYWluOiBmbGF0TWFwXG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi43LjBcbiAqL1xuZXhwb3J0IHZhciBGb2xkYWJsZSA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICByZWR1Y2U6IF9yZWR1Y2UsXG4gICAgZm9sZE1hcDogX2ZvbGRNYXAsXG4gICAgcmVkdWNlUmlnaHQ6IF9yZWR1Y2VSaWdodFxufTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuNy4wXG4gKi9cbmV4cG9ydCB2YXIgRm9sZGFibGVXaXRoSW5kZXggPSB7XG4gICAgVVJJOiBVUkksXG4gICAgcmVkdWNlOiBfcmVkdWNlLFxuICAgIGZvbGRNYXA6IF9mb2xkTWFwLFxuICAgIHJlZHVjZVJpZ2h0OiBfcmVkdWNlUmlnaHQsXG4gICAgcmVkdWNlV2l0aEluZGV4OiBfcmVkdWNlV2l0aEluZGV4LFxuICAgIGZvbGRNYXBXaXRoSW5kZXg6IF9mb2xkTWFwV2l0aEluZGV4LFxuICAgIHJlZHVjZVJpZ2h0V2l0aEluZGV4OiBfcmVkdWNlUmlnaHRXaXRoSW5kZXhcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjcuMFxuICovXG5leHBvcnQgdmFyIFRyYXZlcnNhYmxlID0ge1xuICAgIFVSSTogVVJJLFxuICAgIG1hcDogX21hcCxcbiAgICByZWR1Y2U6IF9yZWR1Y2UsXG4gICAgZm9sZE1hcDogX2ZvbGRNYXAsXG4gICAgcmVkdWNlUmlnaHQ6IF9yZWR1Y2VSaWdodCxcbiAgICB0cmF2ZXJzZTogX3RyYXZlcnNlLFxuICAgIHNlcXVlbmNlOiBzZXF1ZW5jZVxufTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuNy4wXG4gKi9cbmV4cG9ydCB2YXIgVHJhdmVyc2FibGVXaXRoSW5kZXggPSB7XG4gICAgVVJJOiBVUkksXG4gICAgbWFwOiBfbWFwLFxuICAgIG1hcFdpdGhJbmRleDogX21hcFdpdGhJbmRleCxcbiAgICByZWR1Y2U6IF9yZWR1Y2UsXG4gICAgZm9sZE1hcDogX2ZvbGRNYXAsXG4gICAgcmVkdWNlUmlnaHQ6IF9yZWR1Y2VSaWdodCxcbiAgICB0cmF2ZXJzZTogX3RyYXZlcnNlLFxuICAgIHNlcXVlbmNlOiBzZXF1ZW5jZSxcbiAgICByZWR1Y2VXaXRoSW5kZXg6IF9yZWR1Y2VXaXRoSW5kZXgsXG4gICAgZm9sZE1hcFdpdGhJbmRleDogX2ZvbGRNYXBXaXRoSW5kZXgsXG4gICAgcmVkdWNlUmlnaHRXaXRoSW5kZXg6IF9yZWR1Y2VSaWdodFdpdGhJbmRleCxcbiAgICB0cmF2ZXJzZVdpdGhJbmRleDogX3RyYXZlcnNlV2l0aEluZGV4XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi43LjBcbiAqL1xuZXhwb3J0IHZhciBBbHQgPSB7XG4gICAgVVJJOiBVUkksXG4gICAgbWFwOiBfbWFwLFxuICAgIGFsdDogX2FsdFxufTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuNy4wXG4gKi9cbmV4cG9ydCB2YXIgQ29tb25hZCA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICBtYXA6IF9tYXAsXG4gICAgZXh0ZW5kOiBfZXh0ZW5kLFxuICAgIGV4dHJhY3Q6IGV4dHJhY3Rcbn07XG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vLyBkbyBub3RhdGlvblxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLyoqXG4gKiBAY2F0ZWdvcnkgZG8gbm90YXRpb25cbiAqIEBzaW5jZSAyLjkuMFxuICovXG5leHBvcnQgdmFyIERvID0gLyojX19QVVJFX18qLyBvZihfLmVtcHR5UmVjb3JkKTtcbi8qKlxuICogQGNhdGVnb3J5IGRvIG5vdGF0aW9uXG4gKiBAc2luY2UgMi44LjBcbiAqL1xuZXhwb3J0IHZhciBiaW5kVG8gPSAvKiNfX1BVUkVfXyovIGJpbmRUb18oRnVuY3Rvcik7XG52YXIgbGV0XyA9IC8qI19fUFVSRV9fKi8gbGV0X18oRnVuY3Rvcik7XG5leHBvcnQgeyBcbi8qKlxuICogQGNhdGVnb3J5IGRvIG5vdGF0aW9uXG4gKiBAc2luY2UgMi4xMy4wXG4gKi9cbmxldF8gYXMgbGV0IH07XG4vKipcbiAqIEBjYXRlZ29yeSBkbyBub3RhdGlvblxuICogQHNpbmNlIDIuOC4wXG4gKi9cbmV4cG9ydCB2YXIgYmluZCA9IC8qI19fUFVSRV9fKi8gYmluZF8oQ2hhaW4pO1xuLyoqXG4gKiBAY2F0ZWdvcnkgZG8gbm90YXRpb25cbiAqIEBzaW5jZSAyLjguMFxuICovXG5leHBvcnQgdmFyIGFwUyA9IC8qI19fUFVSRV9fKi8gYXBTXyhBcHBseSk7XG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vLyB1dGlsc1xuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLyoqXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBoZWFkID0gZXh0cmFjdDtcbi8qKlxuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgdGFpbCA9IF8udGFpbDtcbi8qKlxuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgbGFzdCA9IGZ1bmN0aW9uIChhcykgeyByZXR1cm4gYXNbYXMubGVuZ3RoIC0gMV07IH07XG4vKipcbiAqIEdldCBhbGwgYnV0IHRoZSBsYXN0IGVsZW1lbnQgb2YgYSBub24gZW1wdHkgYXJyYXksIGNyZWF0aW5nIGEgbmV3IGFycmF5LlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBpbml0IH0gZnJvbSAnZnAtdHMvUmVhZG9ubHlOb25FbXB0eUFycmF5J1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoaW5pdChbMSwgMiwgM10pLCBbMSwgMl0pXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKGluaXQoWzFdKSwgW10pXG4gKlxuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgaW5pdCA9IGZ1bmN0aW9uIChhcykgeyByZXR1cm4gYXMuc2xpY2UoMCwgLTEpOyB9O1xuLyoqXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBtaW4gPSBmdW5jdGlvbiAoTykge1xuICAgIHZhciBTID0gU2UubWluKE8pO1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHsgcmV0dXJuIGFzLnJlZHVjZShTLmNvbmNhdCk7IH07XG59O1xuLyoqXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBtYXggPSBmdW5jdGlvbiAoTykge1xuICAgIHZhciBTID0gU2UubWF4KE8pO1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHsgcmV0dXJuIGFzLnJlZHVjZShTLmNvbmNhdCk7IH07XG59O1xuLyoqXG4gKiBAc2luY2UgMi4xMC4wXG4gKi9cbmV4cG9ydCB2YXIgY29uY2F0QWxsID0gZnVuY3Rpb24gKFMpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIHJldHVybiBhcy5yZWR1Y2UoUy5jb25jYXQpO1xuICAgIH07XG59O1xuLyoqXG4gKiBCcmVhayBhIGBSZWFkb25seUFycmF5YCBpbnRvIGl0cyBmaXJzdCBlbGVtZW50IGFuZCByZW1haW5pbmcgZWxlbWVudHMuXG4gKlxuICogQGNhdGVnb3J5IHBhdHRlcm4gbWF0Y2hpbmdcbiAqIEBzaW5jZSAyLjExLjBcbiAqL1xuZXhwb3J0IHZhciBtYXRjaExlZnQgPSBmdW5jdGlvbiAoZikge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgcmV0dXJuIGYoaGVhZChhcyksIHRhaWwoYXMpKTtcbiAgICB9O1xufTtcbi8qKlxuICogQnJlYWsgYSBgUmVhZG9ubHlBcnJheWAgaW50byBpdHMgaW5pdGlhbCBlbGVtZW50cyBhbmQgdGhlIGxhc3QgZWxlbWVudC5cbiAqXG4gKiBAY2F0ZWdvcnkgcGF0dGVybiBtYXRjaGluZ1xuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIG1hdGNoUmlnaHQgPSBmdW5jdGlvbiAoZikge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgcmV0dXJuIGYoaW5pdChhcyksIGxhc3QoYXMpKTtcbiAgICB9O1xufTtcbi8qKlxuICogQXBwbHkgYSBmdW5jdGlvbiB0byB0aGUgaGVhZCwgY3JlYXRpbmcgYSBuZXcgYFJlYWRvbmx5Tm9uRW1wdHlBcnJheWAuXG4gKlxuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIG1vZGlmeUhlYWQgPSBmdW5jdGlvbiAoZikge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgcmV0dXJuIF9fc3ByZWFkQXJyYXkoW2YoaGVhZChhcykpXSwgdGFpbChhcyksIHRydWUpO1xuICAgIH07XG59O1xuLyoqXG4gKiBDaGFuZ2UgdGhlIGhlYWQsIGNyZWF0aW5nIGEgbmV3IGBSZWFkb25seU5vbkVtcHR5QXJyYXlgLlxuICpcbiAqIEBzaW5jZSAyLjExLjBcbiAqL1xuZXhwb3J0IHZhciB1cGRhdGVIZWFkID0gZnVuY3Rpb24gKGEpIHsgcmV0dXJuIG1vZGlmeUhlYWQoZnVuY3Rpb24gKCkgeyByZXR1cm4gYTsgfSk7IH07XG4vKipcbiAqIEFwcGx5IGEgZnVuY3Rpb24gdG8gdGhlIGxhc3QgZWxlbWVudCwgY3JlYXRpbmcgYSBuZXcgYFJlYWRvbmx5Tm9uRW1wdHlBcnJheWAuXG4gKlxuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIG1vZGlmeUxhc3QgPSBmdW5jdGlvbiAoZikge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgcmV0dXJuIHBpcGUoaW5pdChhcyksIGFwcGVuZChmKGxhc3QoYXMpKSkpO1xuICAgIH07XG59O1xuLyoqXG4gKiBDaGFuZ2UgdGhlIGxhc3QgZWxlbWVudCwgY3JlYXRpbmcgYSBuZXcgYFJlYWRvbmx5Tm9uRW1wdHlBcnJheWAuXG4gKlxuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIHVwZGF0ZUxhc3QgPSBmdW5jdGlvbiAoYSkgeyByZXR1cm4gbW9kaWZ5TGFzdChmdW5jdGlvbiAoKSB7IHJldHVybiBhOyB9KTsgfTtcbi8qKlxuICogUGxhY2VzIGFuIGVsZW1lbnQgaW4gYmV0d2VlbiBtZW1iZXJzIG9mIGEgYFJlYWRvbmx5Tm9uRW1wdHlBcnJheWAsIHRoZW4gZm9sZHMgdGhlIHJlc3VsdHMgdXNpbmcgdGhlIHByb3ZpZGVkIGBTZW1pZ3JvdXBgLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgKiBhcyBTIGZyb20gJ2ZwLXRzL3N0cmluZydcbiAqIGltcG9ydCB7IGludGVyY2FsYXRlIH0gZnJvbSAnZnAtdHMvUmVhZG9ubHlOb25FbXB0eUFycmF5J1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoaW50ZXJjYWxhdGUoUy5TZW1pZ3JvdXApKCctJykoWydhJywgJ2InLCAnYyddKSwgJ2EtYi1jJylcbiAqXG4gKiBAc2luY2UgMi4xMi4wXG4gKi9cbmV4cG9ydCB2YXIgaW50ZXJjYWxhdGUgPSBmdW5jdGlvbiAoUykge1xuICAgIHZhciBjb25jYXRBbGxTID0gY29uY2F0QWxsKFMpO1xuICAgIHJldHVybiBmdW5jdGlvbiAobWlkZGxlKSB7IHJldHVybiBmbG93KGludGVyc3BlcnNlKG1pZGRsZSksIGNvbmNhdEFsbFMpOyB9O1xufTtcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8vIGxlZ2FjeVxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLyoqXG4gKiBBbGlhcyBvZiBgZmxhdE1hcGAuXG4gKlxuICogQGNhdGVnb3J5IGxlZ2FjeVxuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgY2hhaW4gPSBmbGF0TWFwO1xuZXhwb3J0IGZ1bmN0aW9uIGdyb3VwU29ydChPKSB7XG4gICAgdmFyIHNvcnRPID0gc29ydChPKTtcbiAgICB2YXIgZ3JvdXBPID0gZ3JvdXAoTyk7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykgeyByZXR1cm4gKGlzTm9uRW1wdHkoYXMpID8gZ3JvdXBPKHNvcnRPKGFzKSkgOiBlbXB0eSk7IH07XG59XG5leHBvcnQgZnVuY3Rpb24gZmlsdGVyKHByZWRpY2F0ZSkge1xuICAgIHJldHVybiBmaWx0ZXJXaXRoSW5kZXgoZnVuY3Rpb24gKF8sIGEpIHsgcmV0dXJuIHByZWRpY2F0ZShhKTsgfSk7XG59XG4vKipcbiAqIFVzZSBbYGZpbHRlcldpdGhJbmRleGBdKC4vUmVhZG9ubHlBcnJheS50cy5odG1sI2ZpbHRlcndpdGhpbmRleCkgaW5zdGVhZC5cbiAqXG4gKiBAY2F0ZWdvcnkgem9uZSBvZiBkZWF0aFxuICogQHNpbmNlIDIuNS4wXG4gKiBAZGVwcmVjYXRlZFxuICovXG5leHBvcnQgdmFyIGZpbHRlcldpdGhJbmRleCA9IGZ1bmN0aW9uIChwcmVkaWNhdGUpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIHJldHVybiBmcm9tUmVhZG9ubHlBcnJheShhcy5maWx0ZXIoZnVuY3Rpb24gKGEsIGkpIHsgcmV0dXJuIHByZWRpY2F0ZShpLCBhKTsgfSkpO1xuICAgIH07XG59O1xuLyoqXG4gKiBVc2UgW2B1bnByZXBlbmRgXSgjdW5wcmVwZW5kKSBpbnN0ZWFkLlxuICpcbiAqIEBjYXRlZ29yeSB6b25lIG9mIGRlYXRoXG4gKiBAc2luY2UgMi4xMC4wXG4gKiBAZGVwcmVjYXRlZFxuICovXG5leHBvcnQgdmFyIHVuY29ucyA9IHVucHJlcGVuZDtcbi8qKlxuICogVXNlIFtgdW5hcHBlbmRgXSgjdW5hcHBlbmQpIGluc3RlYWQuXG4gKlxuICogQGNhdGVnb3J5IHpvbmUgb2YgZGVhdGhcbiAqIEBzaW5jZSAyLjEwLjBcbiAqIEBkZXByZWNhdGVkXG4gKi9cbmV4cG9ydCB2YXIgdW5zbm9jID0gdW5hcHBlbmQ7XG5leHBvcnQgZnVuY3Rpb24gY29ucyhoZWFkLCB0YWlsKSB7XG4gICAgcmV0dXJuIHRhaWwgPT09IHVuZGVmaW5lZCA/IHByZXBlbmQoaGVhZCkgOiBwaXBlKHRhaWwsIHByZXBlbmQoaGVhZCkpO1xufVxuLyoqXG4gKiBVc2UgW2BhcHBlbmRgXSguL1JlYWRvbmx5QXJyYXkudHMuaHRtbCNhcHBlbmQpIGluc3RlYWQuXG4gKlxuICogQGNhdGVnb3J5IHpvbmUgb2YgZGVhdGhcbiAqIEBzaW5jZSAyLjUuMFxuICogQGRlcHJlY2F0ZWRcbiAqL1xuZXhwb3J0IHZhciBzbm9jID0gZnVuY3Rpb24gKGluaXQsIGVuZCkgeyByZXR1cm4gcGlwZShpbml0LCBjb25jYXQoW2VuZF0pKTsgfTtcbi8qKlxuICogVXNlIFtgaW5zZXJ0QXRgXSguL1JlYWRvbmx5QXJyYXkudHMuaHRtbCNpbnNlcnRhdCkgaW5zdGVhZC5cbiAqXG4gKiBAY2F0ZWdvcnkgem9uZSBvZiBkZWF0aFxuICogQHNpbmNlIDIuNS4wXG4gKiBAZGVwcmVjYXRlZFxuICovXG5leHBvcnQgdmFyIGluc2VydEF0ID0gZnVuY3Rpb24gKGksIGEpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIHJldHVybiBpIDwgMCB8fCBpID4gYXMubGVuZ3RoID8gXy5ub25lIDogXy5zb21lKHVuc2FmZUluc2VydEF0KGksIGEsIGFzKSk7XG4gICAgfTtcbn07XG4vKipcbiAqIFVzZSBbYHByZXBlbmRBbGxgXSgjcHJlcGVuZGFsbCkgaW5zdGVhZC5cbiAqXG4gKiBAY2F0ZWdvcnkgem9uZSBvZiBkZWF0aFxuICogQHNpbmNlIDIuOS4wXG4gKiBAZGVwcmVjYXRlZFxuICovXG5leHBvcnQgdmFyIHByZXBlbmRUb0FsbCA9IHByZXBlbmRBbGw7XG4vKipcbiAqIFVzZSBbYGNvbmNhdEFsbGBdKCNjb25jYXRhbGwpIGluc3RlYWQuXG4gKlxuICogQGNhdGVnb3J5IHpvbmUgb2YgZGVhdGhcbiAqIEBzaW5jZSAyLjUuMFxuICogQGRlcHJlY2F0ZWRcbiAqL1xuZXhwb3J0IHZhciBmb2xkID0gY29uY2F0QWxsO1xuLyoqXG4gKiBUaGlzIGluc3RhbmNlIGlzIGRlcHJlY2F0ZWQsIHVzZSBzbWFsbCwgc3BlY2lmaWMgaW5zdGFuY2VzIGluc3RlYWQuXG4gKiBGb3IgZXhhbXBsZSBpZiBhIGZ1bmN0aW9uIG5lZWRzIGEgYEZ1bmN0b3JgIGluc3RhbmNlLCBwYXNzIGBSTkVBLkZ1bmN0b3JgIGluc3RlYWQgb2YgYFJORUEucmVhZG9ubHlOb25FbXB0eUFycmF5YFxuICogKHdoZXJlIGBSTkVBYCBpcyBmcm9tIGBpbXBvcnQgUk5FQSBmcm9tICdmcC10cy9SZWFkb25seU5vbkVtcHR5QXJyYXknYClcbiAqXG4gKiBAY2F0ZWdvcnkgem9uZSBvZiBkZWF0aFxuICogQHNpbmNlIDIuNS4wXG4gKiBAZGVwcmVjYXRlZFxuICovXG5leHBvcnQgdmFyIHJlYWRvbmx5Tm9uRW1wdHlBcnJheSA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICBvZjogb2YsXG4gICAgbWFwOiBfbWFwLFxuICAgIG1hcFdpdGhJbmRleDogX21hcFdpdGhJbmRleCxcbiAgICBhcDogX2FwLFxuICAgIGNoYWluOiBmbGF0TWFwLFxuICAgIGV4dGVuZDogX2V4dGVuZCxcbiAgICBleHRyYWN0OiBleHRyYWN0LFxuICAgIHJlZHVjZTogX3JlZHVjZSxcbiAgICBmb2xkTWFwOiBfZm9sZE1hcCxcbiAgICByZWR1Y2VSaWdodDogX3JlZHVjZVJpZ2h0LFxuICAgIHRyYXZlcnNlOiBfdHJhdmVyc2UsXG4gICAgc2VxdWVuY2U6IHNlcXVlbmNlLFxuICAgIHJlZHVjZVdpdGhJbmRleDogX3JlZHVjZVdpdGhJbmRleCxcbiAgICBmb2xkTWFwV2l0aEluZGV4OiBfZm9sZE1hcFdpdGhJbmRleCxcbiAgICByZWR1Y2VSaWdodFdpdGhJbmRleDogX3JlZHVjZVJpZ2h0V2l0aEluZGV4LFxuICAgIHRyYXZlcnNlV2l0aEluZGV4OiBfdHJhdmVyc2VXaXRoSW5kZXgsXG4gICAgYWx0OiBfYWx0XG59O1xuIiwKICAidmFyIF9fc3ByZWFkQXJyYXkgPSAodGhpcyAmJiB0aGlzLl9fc3ByZWFkQXJyYXkpIHx8IGZ1bmN0aW9uICh0bywgZnJvbSwgcGFjaykge1xuICAgIGlmIChwYWNrIHx8IGFyZ3VtZW50cy5sZW5ndGggPT09IDIpIGZvciAodmFyIGkgPSAwLCBsID0gZnJvbS5sZW5ndGgsIGFyOyBpIDwgbDsgaSsrKSB7XG4gICAgICAgIGlmIChhciB8fCAhKGkgaW4gZnJvbSkpIHtcbiAgICAgICAgICAgIGlmICghYXIpIGFyID0gQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoZnJvbSwgMCwgaSk7XG4gICAgICAgICAgICBhcltpXSA9IGZyb21baV07XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHRvLmNvbmNhdChhciB8fCBBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChmcm9tKSk7XG59O1xuaW1wb3J0IHsgYXBGaXJzdCBhcyBhcEZpcnN0XywgYXBTIGFzIGFwU18sIGFwU2Vjb25kIGFzIGFwU2Vjb25kXyB9IGZyb20gJy4vQXBwbHknO1xuaW1wb3J0IHsgYmluZCBhcyBiaW5kXywgY2hhaW5GaXJzdCBhcyBjaGFpbkZpcnN0XyB9IGZyb20gJy4vQ2hhaW4nO1xuaW1wb3J0IHsgZnJvbUVxdWFscyB9IGZyb20gJy4vRXEnO1xuaW1wb3J0IHsgZHVhbCwgZmxvdywgaWRlbnRpdHksIHBpcGUsIFNLIH0gZnJvbSAnLi9mdW5jdGlvbic7XG5pbXBvcnQgeyBiaW5kVG8gYXMgYmluZFRvXywgZmxhcCBhcyBmbGFwXywgbGV0IGFzIGxldF9fIH0gZnJvbSAnLi9GdW5jdG9yJztcbmltcG9ydCAqIGFzIF8gZnJvbSAnLi9pbnRlcm5hbCc7XG5pbXBvcnQgeyBnZXRNb25vaWQgfSBmcm9tICcuL09yZCc7XG5pbXBvcnQgKiBhcyBTZSBmcm9tICcuL1NlbWlncm91cCc7XG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vLyBpbnRlcm5hbFxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLyoqXG4gKiBAaW50ZXJuYWxcbiAqL1xuZXhwb3J0IHZhciBlbXB0eSA9IF8uZW1wdHlSZWFkb25seUFycmF5O1xuLyoqXG4gKiBAaW50ZXJuYWxcbiAqL1xuZXhwb3J0IHZhciBpc05vbkVtcHR5ID0gXy5pc05vbkVtcHR5O1xuLyoqXG4gKiBAaW50ZXJuYWxcbiAqL1xuZXhwb3J0IHZhciBpc091dE9mQm91bmQgPSBmdW5jdGlvbiAoaSwgYXMpIHsgcmV0dXJuIGkgPCAwIHx8IGkgPj0gYXMubGVuZ3RoOyB9O1xuLyoqXG4gKiBAaW50ZXJuYWxcbiAqL1xuZXhwb3J0IHZhciBwcmVwZW5kVyA9IGZ1bmN0aW9uIChoZWFkKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uICh0YWlsKSB7XG4gICAgICAgIHJldHVybiBfX3NwcmVhZEFycmF5KFtoZWFkXSwgdGFpbCwgdHJ1ZSk7XG4gICAgfTtcbn07XG4vKipcbiAqIEBpbnRlcm5hbFxuICovXG5leHBvcnQgdmFyIHByZXBlbmQgPSBwcmVwZW5kVztcbi8qKlxuICogQGludGVybmFsXG4gKi9cbmV4cG9ydCB2YXIgYXBwZW5kVyA9IGZ1bmN0aW9uIChlbmQpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGluaXQpIHtcbiAgICAgICAgcmV0dXJuIF9fc3ByZWFkQXJyYXkoX19zcHJlYWRBcnJheShbXSwgaW5pdCwgdHJ1ZSksIFtlbmRdLCBmYWxzZSk7XG4gICAgfTtcbn07XG4vKipcbiAqIEBpbnRlcm5hbFxuICovXG5leHBvcnQgdmFyIGFwcGVuZCA9IGFwcGVuZFc7XG4vKipcbiAqIEBpbnRlcm5hbFxuICovXG5leHBvcnQgdmFyIHVuc2FmZUluc2VydEF0ID0gZnVuY3Rpb24gKGksIGEsIGFzKSB7XG4gICAgaWYgKGlzTm9uRW1wdHkoYXMpKSB7XG4gICAgICAgIHZhciB4cyA9IF8uZnJvbVJlYWRvbmx5Tm9uRW1wdHlBcnJheShhcyk7XG4gICAgICAgIHhzLnNwbGljZShpLCAwLCBhKTtcbiAgICAgICAgcmV0dXJuIHhzO1xuICAgIH1cbiAgICByZXR1cm4gW2FdO1xufTtcbi8qKlxuICogQGludGVybmFsXG4gKi9cbmV4cG9ydCB2YXIgdW5zYWZlVXBkYXRlQXQgPSBmdW5jdGlvbiAoaSwgYSwgYXMpIHtcbiAgICBpZiAoYXNbaV0gPT09IGEpIHtcbiAgICAgICAgcmV0dXJuIGFzO1xuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgICAgdmFyIHhzID0gXy5mcm9tUmVhZG9ubHlOb25FbXB0eUFycmF5KGFzKTtcbiAgICAgICAgeHNbaV0gPSBhO1xuICAgICAgICByZXR1cm4geHM7XG4gICAgfVxufTtcbi8qKlxuICogUmVtb3ZlIGR1cGxpY2F0ZXMgZnJvbSBhIGBSZWFkb25seU5vbkVtcHR5QXJyYXlgLCBrZWVwaW5nIHRoZSBmaXJzdCBvY2N1cnJlbmNlIG9mIGFuIGVsZW1lbnQuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IHVuaXEgfSBmcm9tICdmcC10cy9SZWFkb25seU5vbkVtcHR5QXJyYXknXG4gKiBpbXBvcnQgKiBhcyBOIGZyb20gJ2ZwLXRzL251bWJlcidcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKHVuaXEoTi5FcSkoWzEsIDIsIDFdKSwgWzEsIDJdKVxuICpcbiAqIEBzaW5jZSAyLjExLjBcbiAqL1xuZXhwb3J0IHZhciB1bmlxID0gZnVuY3Rpb24gKEUpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIGlmIChhcy5sZW5ndGggPT09IDEpIHtcbiAgICAgICAgICAgIHJldHVybiBhcztcbiAgICAgICAgfVxuICAgICAgICB2YXIgb3V0ID0gW2hlYWQoYXMpXTtcbiAgICAgICAgdmFyIHJlc3QgPSB0YWlsKGFzKTtcbiAgICAgICAgdmFyIF9sb29wXzEgPSBmdW5jdGlvbiAoYSkge1xuICAgICAgICAgICAgaWYgKG91dC5ldmVyeShmdW5jdGlvbiAobykgeyByZXR1cm4gIUUuZXF1YWxzKG8sIGEpOyB9KSkge1xuICAgICAgICAgICAgICAgIG91dC5wdXNoKGEpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICBmb3IgKHZhciBfaSA9IDAsIHJlc3RfMSA9IHJlc3Q7IF9pIDwgcmVzdF8xLmxlbmd0aDsgX2krKykge1xuICAgICAgICAgICAgdmFyIGEgPSByZXN0XzFbX2ldO1xuICAgICAgICAgICAgX2xvb3BfMShhKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gb3V0O1xuICAgIH07XG59O1xuLyoqXG4gKiBTb3J0IHRoZSBlbGVtZW50cyBvZiBhIGBSZWFkb25seU5vbkVtcHR5QXJyYXlgIGluIGluY3JlYXNpbmcgb3JkZXIsIHdoZXJlIGVsZW1lbnRzIGFyZSBjb21wYXJlZCB1c2luZyBmaXJzdCBgb3Jkc1swXWAsIHRoZW4gYG9yZHNbMV1gLFxuICogZXRjLi4uXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCAqIGFzIFJORUEgZnJvbSAnZnAtdHMvUmVhZG9ubHlOb25FbXB0eUFycmF5J1xuICogaW1wb3J0IHsgY29udHJhbWFwIH0gZnJvbSAnZnAtdHMvT3JkJ1xuICogaW1wb3J0ICogYXMgUyBmcm9tICdmcC10cy9zdHJpbmcnXG4gKiBpbXBvcnQgKiBhcyBOIGZyb20gJ2ZwLXRzL251bWJlcidcbiAqIGltcG9ydCB7IHBpcGUgfSBmcm9tICdmcC10cy9mdW5jdGlvbidcbiAqXG4gKiBpbnRlcmZhY2UgUGVyc29uIHtcbiAqICAgbmFtZTogc3RyaW5nXG4gKiAgIGFnZTogbnVtYmVyXG4gKiB9XG4gKlxuICogY29uc3QgYnlOYW1lID0gcGlwZShTLk9yZCwgY29udHJhbWFwKChwOiBQZXJzb24pID0+IHAubmFtZSkpXG4gKlxuICogY29uc3QgYnlBZ2UgPSBwaXBlKE4uT3JkLCBjb250cmFtYXAoKHA6IFBlcnNvbikgPT4gcC5hZ2UpKVxuICpcbiAqIGNvbnN0IHNvcnRCeU5hbWVCeUFnZSA9IFJORUEuc29ydEJ5KFtieU5hbWUsIGJ5QWdlXSlcbiAqXG4gKiBjb25zdCBwZXJzb25zOiBSTkVBLlJlYWRvbmx5Tm9uRW1wdHlBcnJheTxQZXJzb24+ID0gW1xuICogICB7IG5hbWU6ICdhJywgYWdlOiAxIH0sXG4gKiAgIHsgbmFtZTogJ2InLCBhZ2U6IDMgfSxcbiAqICAgeyBuYW1lOiAnYycsIGFnZTogMiB9LFxuICogICB7IG5hbWU6ICdiJywgYWdlOiAyIH1cbiAqIF1cbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKHNvcnRCeU5hbWVCeUFnZShwZXJzb25zKSwgW1xuICogICB7IG5hbWU6ICdhJywgYWdlOiAxIH0sXG4gKiAgIHsgbmFtZTogJ2InLCBhZ2U6IDIgfSxcbiAqICAgeyBuYW1lOiAnYicsIGFnZTogMyB9LFxuICogICB7IG5hbWU6ICdjJywgYWdlOiAyIH1cbiAqIF0pXG4gKlxuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIHNvcnRCeSA9IGZ1bmN0aW9uIChvcmRzKSB7XG4gICAgaWYgKGlzTm9uRW1wdHkob3JkcykpIHtcbiAgICAgICAgdmFyIE0gPSBnZXRNb25vaWQoKTtcbiAgICAgICAgcmV0dXJuIHNvcnQob3Jkcy5yZWR1Y2UoTS5jb25jYXQsIE0uZW1wdHkpKTtcbiAgICB9XG4gICAgcmV0dXJuIGlkZW50aXR5O1xufTtcbi8qKlxuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIHVuaW9uID0gZnVuY3Rpb24gKEUpIHtcbiAgICB2YXIgdW5pcUUgPSB1bmlxKEUpO1xuICAgIHJldHVybiBmdW5jdGlvbiAoc2Vjb25kKSB7IHJldHVybiBmdW5jdGlvbiAoZmlyc3QpIHsgcmV0dXJuIHVuaXFFKHBpcGUoZmlyc3QsIGNvbmNhdChzZWNvbmQpKSk7IH07IH07XG59O1xuLyoqXG4gKiBSb3RhdGUgYSBgUmVhZG9ubHlOb25FbXB0eUFycmF5YCBieSBgbmAgc3RlcHMuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IHJvdGF0ZSB9IGZyb20gJ2ZwLXRzL1JlYWRvbmx5Tm9uRW1wdHlBcnJheSdcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKHJvdGF0ZSgyKShbMSwgMiwgMywgNCwgNV0pLCBbNCwgNSwgMSwgMiwgM10pXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKHJvdGF0ZSgtMikoWzEsIDIsIDMsIDQsIDVdKSwgWzMsIDQsIDUsIDEsIDJdKVxuICpcbiAqIEBzaW5jZSAyLjExLjBcbiAqL1xuZXhwb3J0IHZhciByb3RhdGUgPSBmdW5jdGlvbiAobikge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgdmFyIGxlbiA9IGFzLmxlbmd0aDtcbiAgICAgICAgdmFyIG0gPSBNYXRoLnJvdW5kKG4pICUgbGVuO1xuICAgICAgICBpZiAoaXNPdXRPZkJvdW5kKE1hdGguYWJzKG0pLCBhcykgfHwgbSA9PT0gMCkge1xuICAgICAgICAgICAgcmV0dXJuIGFzO1xuICAgICAgICB9XG4gICAgICAgIGlmIChtIDwgMCkge1xuICAgICAgICAgICAgdmFyIF9hID0gc3BsaXRBdCgtbSkoYXMpLCBmID0gX2FbMF0sIHMgPSBfYVsxXTtcbiAgICAgICAgICAgIHJldHVybiBwaXBlKHMsIGNvbmNhdChmKSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gcm90YXRlKG0gLSBsZW4pKGFzKTtcbiAgICAgICAgfVxuICAgIH07XG59O1xuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLy8gY29uc3RydWN0b3JzXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vKipcbiAqIFJldHVybiBhIGBSZWFkb25seU5vbkVtcHR5QXJyYXlgIGZyb20gYSBgUmVhZG9ubHlBcnJheWAgcmV0dXJuaW5nIGBub25lYCBpZiB0aGUgaW5wdXQgaXMgZW1wdHkuXG4gKlxuICogQGNhdGVnb3J5IGNvbnZlcnNpb25zXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBmcm9tUmVhZG9ubHlBcnJheSA9IGZ1bmN0aW9uIChhcykge1xuICAgIHJldHVybiBpc05vbkVtcHR5KGFzKSA/IF8uc29tZShhcykgOiBfLm5vbmU7XG59O1xuLyoqXG4gKiBSZXR1cm4gYSBgUmVhZG9ubHlOb25FbXB0eUFycmF5YCBvZiBsZW5ndGggYG5gIHdpdGggZWxlbWVudCBgaWAgaW5pdGlhbGl6ZWQgd2l0aCBgZihpKWAuXG4gKlxuICogKipOb3RlKiouIGBuYCBpcyBub3JtYWxpemVkIHRvIGEgbmF0dXJhbCBudW1iZXIuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IG1ha2VCeSB9IGZyb20gJ2ZwLXRzL1JlYWRvbmx5Tm9uRW1wdHlBcnJheSdcbiAqIGltcG9ydCB7IHBpcGUgfSBmcm9tICdmcC10cy9mdW5jdGlvbidcbiAqXG4gKiBjb25zdCBkb3VibGUgPSAobjogbnVtYmVyKTogbnVtYmVyID0+IG4gKiAyXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKHBpcGUoNSwgbWFrZUJ5KGRvdWJsZSkpLCBbMCwgMiwgNCwgNiwgOF0pXG4gKlxuICogQGNhdGVnb3J5IGNvbnN0cnVjdG9yc1xuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIG1ha2VCeSA9IGZ1bmN0aW9uIChmKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChuKSB7XG4gICAgICAgIHZhciBqID0gTWF0aC5tYXgoMCwgTWF0aC5mbG9vcihuKSk7XG4gICAgICAgIHZhciBvdXQgPSBbZigwKV07XG4gICAgICAgIGZvciAodmFyIGkgPSAxOyBpIDwgajsgaSsrKSB7XG4gICAgICAgICAgICBvdXQucHVzaChmKGkpKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gb3V0O1xuICAgIH07XG59O1xuLyoqXG4gKiBDcmVhdGUgYSBgUmVhZG9ubHlOb25FbXB0eUFycmF5YCBjb250YWluaW5nIGEgdmFsdWUgcmVwZWF0ZWQgdGhlIHNwZWNpZmllZCBudW1iZXIgb2YgdGltZXMuXG4gKlxuICogKipOb3RlKiouIGBuYCBpcyBub3JtYWxpemVkIHRvIGEgbmF0dXJhbCBudW1iZXIuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IHJlcGxpY2F0ZSB9IGZyb20gJ2ZwLXRzL1JlYWRvbmx5Tm9uRW1wdHlBcnJheSdcbiAqIGltcG9ydCB7IHBpcGUgfSBmcm9tICdmcC10cy9mdW5jdGlvbidcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKHBpcGUoMywgcmVwbGljYXRlKCdhJykpLCBbJ2EnLCAnYScsICdhJ10pXG4gKlxuICogQGNhdGVnb3J5IGNvbnN0cnVjdG9yc1xuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIHJlcGxpY2F0ZSA9IGZ1bmN0aW9uIChhKSB7IHJldHVybiBtYWtlQnkoZnVuY3Rpb24gKCkgeyByZXR1cm4gYTsgfSk7IH07XG4vKipcbiAqIENyZWF0ZSBhIGBSZWFkb25seU5vbkVtcHR5QXJyYXlgIGNvbnRhaW5pbmcgYSByYW5nZSBvZiBpbnRlZ2VycywgaW5jbHVkaW5nIGJvdGggZW5kcG9pbnRzLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyByYW5nZSB9IGZyb20gJ2ZwLXRzL1JlYWRvbmx5Tm9uRW1wdHlBcnJheSdcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKHJhbmdlKDEsIDUpLCBbMSwgMiwgMywgNCwgNV0pXG4gKlxuICogQGNhdGVnb3J5IGNvbnN0cnVjdG9yc1xuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIHJhbmdlID0gZnVuY3Rpb24gKHN0YXJ0LCBlbmQpIHtcbiAgICByZXR1cm4gc3RhcnQgPD0gZW5kID8gbWFrZUJ5KGZ1bmN0aW9uIChpKSB7IHJldHVybiBzdGFydCArIGk7IH0pKGVuZCAtIHN0YXJ0ICsgMSkgOiBbc3RhcnRdO1xufTtcbi8qKlxuICogUmV0dXJuIHRoZSB0dXBsZSBvZiB0aGUgYGhlYWRgIGFuZCB0aGUgYHRhaWxgLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyB1bnByZXBlbmQgfSBmcm9tICdmcC10cy9SZWFkb25seU5vbkVtcHR5QXJyYXknXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbCh1bnByZXBlbmQoWzEsIDIsIDMsIDRdKSwgWzEsIFsyLCAzLCA0XV0pXG4gKlxuICogQHNpbmNlIDIuOS4wXG4gKi9cbmV4cG9ydCB2YXIgdW5wcmVwZW5kID0gZnVuY3Rpb24gKGFzKSB7IHJldHVybiBbaGVhZChhcyksIHRhaWwoYXMpXTsgfTtcbi8qKlxuICogUmV0dXJuIHRoZSB0dXBsZSBvZiB0aGUgYGluaXRgIGFuZCB0aGUgYGxhc3RgLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyB1bmFwcGVuZCB9IGZyb20gJ2ZwLXRzL1JlYWRvbmx5Tm9uRW1wdHlBcnJheSdcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKHVuYXBwZW5kKFsxLCAyLCAzLCA0XSksIFtbMSwgMiwgM10sIDRdKVxuICpcbiAqIEBzaW5jZSAyLjkuMFxuICovXG5leHBvcnQgdmFyIHVuYXBwZW5kID0gZnVuY3Rpb24gKGFzKSB7IHJldHVybiBbaW5pdChhcyksIGxhc3QoYXMpXTsgfTtcbi8qKlxuICogQGNhdGVnb3J5IGNvbnZlcnNpb25zXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBmcm9tQXJyYXkgPSBmdW5jdGlvbiAoYXMpIHsgcmV0dXJuIGZyb21SZWFkb25seUFycmF5KGFzLnNsaWNlKCkpOyB9O1xuZXhwb3J0IGZ1bmN0aW9uIGNvbmNhdFcoc2Vjb25kKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChmaXJzdCkgeyByZXR1cm4gZmlyc3QuY29uY2F0KHNlY29uZCk7IH07XG59XG5leHBvcnQgZnVuY3Rpb24gY29uY2F0KHgsIHkpIHtcbiAgICByZXR1cm4geSA/IHguY29uY2F0KHkpIDogZnVuY3Rpb24gKHkpIHsgcmV0dXJuIHkuY29uY2F0KHgpOyB9O1xufVxuLyoqXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciByZXZlcnNlID0gZnVuY3Rpb24gKGFzKSB7XG4gICAgcmV0dXJuIGFzLmxlbmd0aCA9PT0gMSA/IGFzIDogX19zcHJlYWRBcnJheShbbGFzdChhcyldLCBhcy5zbGljZSgwLCAtMSkucmV2ZXJzZSgpLCB0cnVlKTtcbn07XG5leHBvcnQgZnVuY3Rpb24gZ3JvdXAoRSkge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgdmFyIGxlbiA9IGFzLmxlbmd0aDtcbiAgICAgICAgaWYgKGxlbiA9PT0gMCkge1xuICAgICAgICAgICAgcmV0dXJuIGVtcHR5O1xuICAgICAgICB9XG4gICAgICAgIHZhciBvdXQgPSBbXTtcbiAgICAgICAgdmFyIGhlYWQgPSBhc1swXTtcbiAgICAgICAgdmFyIG5lYSA9IFtoZWFkXTtcbiAgICAgICAgZm9yICh2YXIgaSA9IDE7IGkgPCBsZW47IGkrKykge1xuICAgICAgICAgICAgdmFyIGEgPSBhc1tpXTtcbiAgICAgICAgICAgIGlmIChFLmVxdWFscyhhLCBoZWFkKSkge1xuICAgICAgICAgICAgICAgIG5lYS5wdXNoKGEpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgb3V0LnB1c2gobmVhKTtcbiAgICAgICAgICAgICAgICBoZWFkID0gYTtcbiAgICAgICAgICAgICAgICBuZWEgPSBbaGVhZF07XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgb3V0LnB1c2gobmVhKTtcbiAgICAgICAgcmV0dXJuIG91dDtcbiAgICB9O1xufVxuLyoqXG4gKiBTcGxpdHMgYW4gYXJyYXkgaW50byBzdWItbm9uLWVtcHR5LWFycmF5cyBzdG9yZWQgaW4gYW4gb2JqZWN0LCBiYXNlZCBvbiB0aGUgcmVzdWx0IG9mIGNhbGxpbmcgYSBgc3RyaW5nYC1yZXR1cm5pbmdcbiAqIGZ1bmN0aW9uIG9uIGVhY2ggZWxlbWVudCwgYW5kIGdyb3VwaW5nIHRoZSByZXN1bHRzIGFjY29yZGluZyB0byB2YWx1ZXMgcmV0dXJuZWRcbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgZ3JvdXBCeSB9IGZyb20gJ2ZwLXRzL1JlYWRvbmx5Tm9uRW1wdHlBcnJheSdcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKGdyb3VwQnkoKHM6IHN0cmluZykgPT4gU3RyaW5nKHMubGVuZ3RoKSkoWydhJywgJ2InLCAnYWInXSksIHtcbiAqICAgJzEnOiBbJ2EnLCAnYiddLFxuICogICAnMic6IFsnYWInXVxuICogfSlcbiAqXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBncm91cEJ5ID0gZnVuY3Rpb24gKGYpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIHZhciBvdXQgPSB7fTtcbiAgICAgICAgZm9yICh2YXIgX2kgPSAwLCBhc18xID0gYXM7IF9pIDwgYXNfMS5sZW5ndGg7IF9pKyspIHtcbiAgICAgICAgICAgIHZhciBhID0gYXNfMVtfaV07XG4gICAgICAgICAgICB2YXIgayA9IGYoYSk7XG4gICAgICAgICAgICBpZiAoXy5oYXMuY2FsbChvdXQsIGspKSB7XG4gICAgICAgICAgICAgICAgb3V0W2tdLnB1c2goYSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBvdXRba10gPSBbYV07XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG91dDtcbiAgICB9O1xufTtcbi8qKlxuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgc29ydCA9IGZ1bmN0aW9uIChPKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykge1xuICAgICAgICByZXR1cm4gYXMubGVuZ3RoID09PSAxID8gYXMgOiBhcy5zbGljZSgpLnNvcnQoTy5jb21wYXJlKTtcbiAgICB9O1xufTtcbi8qKlxuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgdXBkYXRlQXQgPSBmdW5jdGlvbiAoaSwgYSkge1xuICAgIHJldHVybiBtb2RpZnlBdChpLCBmdW5jdGlvbiAoKSB7IHJldHVybiBhOyB9KTtcbn07XG4vKipcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIG1vZGlmeUF0ID0gZnVuY3Rpb24gKGksIGYpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIHJldHVybiBpc091dE9mQm91bmQoaSwgYXMpID8gXy5ub25lIDogXy5zb21lKHVuc2FmZVVwZGF0ZUF0KGksIGYoYXNbaV0pLCBhcykpO1xuICAgIH07XG59O1xuLyoqXG4gKiBAc2luY2UgMi41LjFcbiAqL1xuZXhwb3J0IHZhciB6aXBXaXRoID0gZnVuY3Rpb24gKGFzLCBicywgZikge1xuICAgIHZhciBjcyA9IFtmKGFzWzBdLCBic1swXSldO1xuICAgIHZhciBsZW4gPSBNYXRoLm1pbihhcy5sZW5ndGgsIGJzLmxlbmd0aCk7XG4gICAgZm9yICh2YXIgaSA9IDE7IGkgPCBsZW47IGkrKykge1xuICAgICAgICBjc1tpXSA9IGYoYXNbaV0sIGJzW2ldKTtcbiAgICB9XG4gICAgcmV0dXJuIGNzO1xufTtcbmV4cG9ydCBmdW5jdGlvbiB6aXAoYXMsIGJzKSB7XG4gICAgaWYgKGJzID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIChicykgeyByZXR1cm4gemlwKGJzLCBhcyk7IH07XG4gICAgfVxuICAgIHJldHVybiB6aXBXaXRoKGFzLCBicywgZnVuY3Rpb24gKGEsIGIpIHsgcmV0dXJuIFthLCBiXTsgfSk7XG59XG4vKipcbiAqIEBzaW5jZSAyLjUuMVxuICovXG5leHBvcnQgdmFyIHVuemlwID0gZnVuY3Rpb24gKGFicykge1xuICAgIHZhciBmYSA9IFthYnNbMF1bMF1dO1xuICAgIHZhciBmYiA9IFthYnNbMF1bMV1dO1xuICAgIGZvciAodmFyIGkgPSAxOyBpIDwgYWJzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIGZhW2ldID0gYWJzW2ldWzBdO1xuICAgICAgICBmYltpXSA9IGFic1tpXVsxXTtcbiAgICB9XG4gICAgcmV0dXJuIFtmYSwgZmJdO1xufTtcbi8qKlxuICogUHJlcGVuZCBhbiBlbGVtZW50IHRvIGV2ZXJ5IG1lbWJlciBvZiBhIGBSZWFkb25seU5vbkVtcHR5QXJyYXlgLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBwcmVwZW5kQWxsIH0gZnJvbSAnZnAtdHMvUmVhZG9ubHlOb25FbXB0eUFycmF5J1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwocHJlcGVuZEFsbCg5KShbMSwgMiwgMywgNF0pLCBbOSwgMSwgOSwgMiwgOSwgMywgOSwgNF0pXG4gKlxuICogQHNpbmNlIDIuMTAuMFxuICovXG5leHBvcnQgdmFyIHByZXBlbmRBbGwgPSBmdW5jdGlvbiAobWlkZGxlKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykge1xuICAgICAgICB2YXIgb3V0ID0gW21pZGRsZSwgYXNbMF1dO1xuICAgICAgICBmb3IgKHZhciBpID0gMTsgaSA8IGFzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICBvdXQucHVzaChtaWRkbGUsIGFzW2ldKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gb3V0O1xuICAgIH07XG59O1xuLyoqXG4gKiBQbGFjZXMgYW4gZWxlbWVudCBpbiBiZXR3ZWVuIG1lbWJlcnMgb2YgYSBgUmVhZG9ubHlOb25FbXB0eUFycmF5YC5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgaW50ZXJzcGVyc2UgfSBmcm9tICdmcC10cy9SZWFkb25seU5vbkVtcHR5QXJyYXknXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChpbnRlcnNwZXJzZSg5KShbMSwgMiwgMywgNF0pLCBbMSwgOSwgMiwgOSwgMywgOSwgNF0pXG4gKlxuICogQHNpbmNlIDIuOS4wXG4gKi9cbmV4cG9ydCB2YXIgaW50ZXJzcGVyc2UgPSBmdW5jdGlvbiAobWlkZGxlKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykge1xuICAgICAgICB2YXIgcmVzdCA9IHRhaWwoYXMpO1xuICAgICAgICByZXR1cm4gaXNOb25FbXB0eShyZXN0KSA/IHBpcGUocmVzdCwgcHJlcGVuZEFsbChtaWRkbGUpLCBwcmVwZW5kKGhlYWQoYXMpKSkgOiBhcztcbiAgICB9O1xufTtcbi8qKlxuICogQGNhdGVnb3J5IHNlcXVlbmNpbmdcbiAqIEBzaW5jZSAyLjEwLjBcbiAqL1xuZXhwb3J0IHZhciBjaGFpbldpdGhJbmRleCA9IGZ1bmN0aW9uIChmKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykge1xuICAgICAgICB2YXIgb3V0ID0gXy5mcm9tUmVhZG9ubHlOb25FbXB0eUFycmF5KGYoMCwgaGVhZChhcykpKTtcbiAgICAgICAgZm9yICh2YXIgaSA9IDE7IGkgPCBhcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgb3V0LnB1c2guYXBwbHkob3V0LCBmKGksIGFzW2ldKSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG91dDtcbiAgICB9O1xufTtcbi8qKlxuICogQSB1c2VmdWwgcmVjdXJzaW9uIHBhdHRlcm4gZm9yIHByb2Nlc3NpbmcgYSBgUmVhZG9ubHlOb25FbXB0eUFycmF5YCB0byBwcm9kdWNlIGEgbmV3IGBSZWFkb25seU5vbkVtcHR5QXJyYXlgLCBvZnRlbiB1c2VkIGZvciBcImNob3BwaW5nXCIgdXAgdGhlIGlucHV0XG4gKiBgUmVhZG9ubHlOb25FbXB0eUFycmF5YC4gVHlwaWNhbGx5IGBjaG9wYCBpcyBjYWxsZWQgd2l0aCBzb21lIGZ1bmN0aW9uIHRoYXQgd2lsbCBjb25zdW1lIGFuIGluaXRpYWwgcHJlZml4IG9mIHRoZSBgUmVhZG9ubHlOb25FbXB0eUFycmF5YCBhbmQgcHJvZHVjZSBhXG4gKiB2YWx1ZSBhbmQgdGhlIHRhaWwgb2YgdGhlIGBSZWFkb25seU5vbkVtcHR5QXJyYXlgLlxuICpcbiAqIEBzaW5jZSAyLjEwLjBcbiAqL1xuZXhwb3J0IHZhciBjaG9wID0gZnVuY3Rpb24gKGYpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIHZhciBfYSA9IGYoYXMpLCBiID0gX2FbMF0sIHJlc3QgPSBfYVsxXTtcbiAgICAgICAgdmFyIG91dCA9IFtiXTtcbiAgICAgICAgdmFyIG5leHQgPSByZXN0O1xuICAgICAgICB3aGlsZSAoaXNOb25FbXB0eShuZXh0KSkge1xuICAgICAgICAgICAgdmFyIF9iID0gZihuZXh0KSwgYl8xID0gX2JbMF0sIHJlc3RfMiA9IF9iWzFdO1xuICAgICAgICAgICAgb3V0LnB1c2goYl8xKTtcbiAgICAgICAgICAgIG5leHQgPSByZXN0XzI7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG91dDtcbiAgICB9O1xufTtcbi8qKlxuICogU3BsaXRzIGEgYFJlYWRvbmx5Tm9uRW1wdHlBcnJheWAgaW50byB0d28gcGllY2VzLCB0aGUgZmlyc3QgcGllY2UgaGFzIG1heCBgbmAgZWxlbWVudHMuXG4gKlxuICogQHNpbmNlIDIuMTAuMFxuICovXG5leHBvcnQgdmFyIHNwbGl0QXQgPSBmdW5jdGlvbiAobikge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgdmFyIG0gPSBNYXRoLm1heCgxLCBuKTtcbiAgICAgICAgcmV0dXJuIG0gPj0gYXMubGVuZ3RoID8gW2FzLCBlbXB0eV0gOiBbcGlwZShhcy5zbGljZSgxLCBtKSwgcHJlcGVuZChoZWFkKGFzKSkpLCBhcy5zbGljZShtKV07XG4gICAgfTtcbn07XG4vKipcbiAqIFNwbGl0cyBhIGBSZWFkb25seU5vbkVtcHR5QXJyYXlgIGludG8gbGVuZ3RoLWBuYCBwaWVjZXMuIFRoZSBsYXN0IHBpZWNlIHdpbGwgYmUgc2hvcnRlciBpZiBgbmAgZG9lcyBub3QgZXZlbmx5IGRpdmlkZSB0aGUgbGVuZ3RoIG9mXG4gKiB0aGUgYFJlYWRvbmx5Tm9uRW1wdHlBcnJheWAuXG4gKlxuICogQHNpbmNlIDIuMTAuMFxuICovXG5leHBvcnQgdmFyIGNodW5rc09mID0gZnVuY3Rpb24gKG4pIHsgcmV0dXJuIGNob3Aoc3BsaXRBdChuKSk7IH07XG52YXIgX21hcCA9IGZ1bmN0aW9uIChmYSwgZikgeyByZXR1cm4gcGlwZShmYSwgbWFwKGYpKTsgfTtcbi8qIGlzdGFuYnVsIGlnbm9yZSBuZXh0ICovXG52YXIgX21hcFdpdGhJbmRleCA9IGZ1bmN0aW9uIChmYSwgZikgeyByZXR1cm4gcGlwZShmYSwgbWFwV2l0aEluZGV4KGYpKTsgfTtcbnZhciBfYXAgPSBmdW5jdGlvbiAoZmFiLCBmYSkgeyByZXR1cm4gcGlwZShmYWIsIGFwKGZhKSk7IH07XG4vKiBpc3RhbmJ1bCBpZ25vcmUgbmV4dCAqL1xudmFyIF9leHRlbmQgPSBmdW5jdGlvbiAod2EsIGYpIHsgcmV0dXJuIHBpcGUod2EsIGV4dGVuZChmKSk7IH07XG4vKiBpc3RhbmJ1bCBpZ25vcmUgbmV4dCAqL1xudmFyIF9yZWR1Y2UgPSBmdW5jdGlvbiAoZmEsIGIsIGYpIHsgcmV0dXJuIHBpcGUoZmEsIHJlZHVjZShiLCBmKSk7IH07XG4vKiBpc3RhbmJ1bCBpZ25vcmUgbmV4dCAqL1xudmFyIF9mb2xkTWFwID0gZnVuY3Rpb24gKE0pIHtcbiAgICB2YXIgZm9sZE1hcE0gPSBmb2xkTWFwKE0pO1xuICAgIHJldHVybiBmdW5jdGlvbiAoZmEsIGYpIHsgcmV0dXJuIHBpcGUoZmEsIGZvbGRNYXBNKGYpKTsgfTtcbn07XG4vKiBpc3RhbmJ1bCBpZ25vcmUgbmV4dCAqL1xudmFyIF9yZWR1Y2VSaWdodCA9IGZ1bmN0aW9uIChmYSwgYiwgZikgeyByZXR1cm4gcGlwZShmYSwgcmVkdWNlUmlnaHQoYiwgZikpOyB9O1xuLyogaXN0YW5idWwgaWdub3JlIG5leHQgKi9cbnZhciBfdHJhdmVyc2UgPSBmdW5jdGlvbiAoRikge1xuICAgIHZhciB0cmF2ZXJzZUYgPSB0cmF2ZXJzZShGKTtcbiAgICByZXR1cm4gZnVuY3Rpb24gKHRhLCBmKSB7IHJldHVybiBwaXBlKHRhLCB0cmF2ZXJzZUYoZikpOyB9O1xufTtcbi8qIGlzdGFuYnVsIGlnbm9yZSBuZXh0ICovXG52YXIgX2FsdCA9IGZ1bmN0aW9uIChmYSwgdGhhdCkgeyByZXR1cm4gcGlwZShmYSwgYWx0KHRoYXQpKTsgfTtcbi8qIGlzdGFuYnVsIGlnbm9yZSBuZXh0ICovXG52YXIgX3JlZHVjZVdpdGhJbmRleCA9IGZ1bmN0aW9uIChmYSwgYiwgZikge1xuICAgIHJldHVybiBwaXBlKGZhLCByZWR1Y2VXaXRoSW5kZXgoYiwgZikpO1xufTtcbi8qIGlzdGFuYnVsIGlnbm9yZSBuZXh0ICovXG52YXIgX2ZvbGRNYXBXaXRoSW5kZXggPSBmdW5jdGlvbiAoTSkge1xuICAgIHZhciBmb2xkTWFwV2l0aEluZGV4TSA9IGZvbGRNYXBXaXRoSW5kZXgoTSk7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChmYSwgZikgeyByZXR1cm4gcGlwZShmYSwgZm9sZE1hcFdpdGhJbmRleE0oZikpOyB9O1xufTtcbi8qIGlzdGFuYnVsIGlnbm9yZSBuZXh0ICovXG52YXIgX3JlZHVjZVJpZ2h0V2l0aEluZGV4ID0gZnVuY3Rpb24gKGZhLCBiLCBmKSB7XG4gICAgcmV0dXJuIHBpcGUoZmEsIHJlZHVjZVJpZ2h0V2l0aEluZGV4KGIsIGYpKTtcbn07XG4vKiBpc3RhbmJ1bCBpZ25vcmUgbmV4dCAqL1xudmFyIF90cmF2ZXJzZVdpdGhJbmRleCA9IGZ1bmN0aW9uIChGKSB7XG4gICAgdmFyIHRyYXZlcnNlV2l0aEluZGV4RiA9IHRyYXZlcnNlV2l0aEluZGV4KEYpO1xuICAgIHJldHVybiBmdW5jdGlvbiAodGEsIGYpIHsgcmV0dXJuIHBpcGUodGEsIHRyYXZlcnNlV2l0aEluZGV4RihmKSk7IH07XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgY29uc3RydWN0b3JzXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBvZiA9IF8uc2luZ2xldG9uO1xuLyoqXG4gKiBMZXNzIHN0cmljdCB2ZXJzaW9uIG9mIFtgYWx0YF0oI2FsdCkuXG4gKlxuICogVGhlIGBXYCBzdWZmaXggKHNob3J0IGZvciAqKlcqKmlkZW5pbmcpIG1lYW5zIHRoYXQgdGhlIHJldHVybiB0eXBlcyB3aWxsIGJlIG1lcmdlZC5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0ICogYXMgUk5FQSBmcm9tICdmcC10cy9SZWFkb25seU5vbkVtcHR5QXJyYXknXG4gKiBpbXBvcnQgeyBwaXBlIH0gZnJvbSAnZnAtdHMvZnVuY3Rpb24nXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChcbiAqICAgcGlwZShcbiAqICAgICBbMSwgMiwgM10gYXMgUk5FQS5SZWFkb25seU5vbkVtcHR5QXJyYXk8bnVtYmVyPixcbiAqICAgICBSTkVBLmFsdFcoKCkgPT4gWydhJywgJ2InXSlcbiAqICAgKSxcbiAqICAgWzEsIDIsIDMsICdhJywgJ2InXVxuICogKVxuICpcbiAqIEBjYXRlZ29yeSBlcnJvciBoYW5kbGluZ1xuICogQHNpbmNlIDIuOS4wXG4gKi9cbmV4cG9ydCB2YXIgYWx0VyA9IGZ1bmN0aW9uICh0aGF0KSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykge1xuICAgICAgICByZXR1cm4gcGlwZShhcywgY29uY2F0Vyh0aGF0KCkpKTtcbiAgICB9O1xufTtcbi8qKlxuICogSWRlbnRpZmllcyBhbiBhc3NvY2lhdGl2ZSBvcGVyYXRpb24gb24gYSB0eXBlIGNvbnN0cnVjdG9yLiBJdCBpcyBzaW1pbGFyIHRvIGBTZW1pZ3JvdXBgLCBleGNlcHQgdGhhdCBpdCBhcHBsaWVzIHRvXG4gKiB0eXBlcyBvZiBraW5kIGAqIC0+ICpgLlxuICpcbiAqIEluIGNhc2Ugb2YgYFJlYWRvbmx5Tm9uRW1wdHlBcnJheWAgY29uY2F0ZW5hdGVzIHRoZSBpbnB1dHMgaW50byBhIHNpbmdsZSBhcnJheS5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0ICogYXMgUk5FQSBmcm9tICdmcC10cy9SZWFkb25seU5vbkVtcHR5QXJyYXknXG4gKiBpbXBvcnQgeyBwaXBlIH0gZnJvbSAnZnAtdHMvZnVuY3Rpb24nXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChcbiAqICAgcGlwZShcbiAqICAgICBbMSwgMiwgM10sXG4gKiAgICAgUk5FQS5hbHQoKCkgPT4gWzQsIDVdKVxuICogICApLFxuICogICBbMSwgMiwgMywgNCwgNV1cbiAqIClcbiAqXG4gKiBAY2F0ZWdvcnkgZXJyb3IgaGFuZGxpbmdcbiAqIEBzaW5jZSAyLjYuMlxuICovXG5leHBvcnQgdmFyIGFsdCA9IGFsdFc7XG4vKipcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIGFwID0gZnVuY3Rpb24gKGFzKSB7IHJldHVybiBmbGF0TWFwKGZ1bmN0aW9uIChmKSB7IHJldHVybiBwaXBlKGFzLCBtYXAoZikpOyB9KTsgfTtcbi8qKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCAqIGFzIFJORUEgZnJvbSAnZnAtdHMvUmVhZG9ubHlOb25FbXB0eUFycmF5J1xuICogaW1wb3J0IHsgcGlwZSB9IGZyb20gJ2ZwLXRzL2Z1bmN0aW9uJ1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoXG4gKiAgIHBpcGUoXG4gKiAgICAgWzEsIDIsIDNdLFxuICogICAgIFJORUEuZmxhdE1hcCgobikgPT4gW2BhJHtufWAsIGBiJHtufWBdKVxuICogICApLFxuICogICBbJ2ExJywgJ2IxJywgJ2EyJywgJ2IyJywgJ2EzJywgJ2IzJ11cbiAqIClcbiAqXG4gKiBAY2F0ZWdvcnkgc2VxdWVuY2luZ1xuICogQHNpbmNlIDIuMTQuMFxuICovXG5leHBvcnQgdmFyIGZsYXRNYXAgPSAvKiNfX1BVUkVfXyovIGR1YWwoMiwgZnVuY3Rpb24gKG1hLCBmKSB7XG4gICAgcmV0dXJuIHBpcGUobWEsIGNoYWluV2l0aEluZGV4KGZ1bmN0aW9uIChpLCBhKSB7IHJldHVybiBmKGEsIGkpOyB9KSk7XG59KTtcbi8qKlxuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgZXh0ZW5kID0gZnVuY3Rpb24gKGYpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIHZhciBuZXh0ID0gdGFpbChhcyk7XG4gICAgICAgIHZhciBvdXQgPSBbZihhcyldO1xuICAgICAgICB3aGlsZSAoaXNOb25FbXB0eShuZXh0KSkge1xuICAgICAgICAgICAgb3V0LnB1c2goZihuZXh0KSk7XG4gICAgICAgICAgICBuZXh0ID0gdGFpbChuZXh0KTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gb3V0O1xuICAgIH07XG59O1xuLyoqXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBkdXBsaWNhdGUgPSBcbi8qI19fUFVSRV9fKi8gZXh0ZW5kKGlkZW50aXR5KTtcbi8qKlxuICogQGNhdGVnb3J5IHNlcXVlbmNpbmdcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIGZsYXR0ZW4gPSBcbi8qI19fUFVSRV9fKi8gZmxhdE1hcChpZGVudGl0eSk7XG4vKipcbiAqIGBtYXBgIGNhbiBiZSB1c2VkIHRvIHR1cm4gZnVuY3Rpb25zIGAoYTogQSkgPT4gQmAgaW50byBmdW5jdGlvbnMgYChmYTogRjxBPikgPT4gRjxCPmAgd2hvc2UgYXJndW1lbnQgYW5kIHJldHVybiB0eXBlc1xuICogdXNlIHRoZSB0eXBlIGNvbnN0cnVjdG9yIGBGYCB0byByZXByZXNlbnQgc29tZSBjb21wdXRhdGlvbmFsIGNvbnRleHQuXG4gKlxuICogQGNhdGVnb3J5IG1hcHBpbmdcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIG1hcCA9IGZ1bmN0aW9uIChmKSB7XG4gICAgcmV0dXJuIG1hcFdpdGhJbmRleChmdW5jdGlvbiAoXywgYSkgeyByZXR1cm4gZihhKTsgfSk7XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgbWFwcGluZ1xuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgbWFwV2l0aEluZGV4ID0gZnVuY3Rpb24gKGYpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIHZhciBvdXQgPSBbZigwLCBoZWFkKGFzKSldO1xuICAgICAgICBmb3IgKHZhciBpID0gMTsgaSA8IGFzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICBvdXQucHVzaChmKGksIGFzW2ldKSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG91dDtcbiAgICB9O1xufTtcbi8qKlxuICogQGNhdGVnb3J5IGZvbGRpbmdcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIHJlZHVjZSA9IGZ1bmN0aW9uIChiLCBmKSB7XG4gICAgcmV0dXJuIHJlZHVjZVdpdGhJbmRleChiLCBmdW5jdGlvbiAoXywgYiwgYSkgeyByZXR1cm4gZihiLCBhKTsgfSk7XG59O1xuLyoqXG4gKiAqKk5vdGUqKi4gVGhlIGNvbnN0cmFpbnQgaXMgcmVsYXhlZDogYSBgU2VtaWdyb3VwYCBpbnN0ZWFkIG9mIGEgYE1vbm9pZGAuXG4gKlxuICogQGNhdGVnb3J5IGZvbGRpbmdcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIGZvbGRNYXAgPSBmdW5jdGlvbiAoUykge1xuICAgIHJldHVybiBmdW5jdGlvbiAoZikge1xuICAgICAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgICAgICByZXR1cm4gYXMuc2xpY2UoMSkucmVkdWNlKGZ1bmN0aW9uIChzLCBhKSB7IHJldHVybiBTLmNvbmNhdChzLCBmKGEpKTsgfSwgZihhc1swXSkpO1xuICAgICAgICB9O1xuICAgIH07XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgZm9sZGluZ1xuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgcmVkdWNlUmlnaHQgPSBmdW5jdGlvbiAoYiwgZikge1xuICAgIHJldHVybiByZWR1Y2VSaWdodFdpdGhJbmRleChiLCBmdW5jdGlvbiAoXywgYiwgYSkgeyByZXR1cm4gZihiLCBhKTsgfSk7XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgZm9sZGluZ1xuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgcmVkdWNlV2l0aEluZGV4ID0gZnVuY3Rpb24gKGIsIGYpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIHJldHVybiBhcy5yZWR1Y2UoZnVuY3Rpb24gKGIsIGEsIGkpIHsgcmV0dXJuIGYoaSwgYiwgYSk7IH0sIGIpO1xuICAgIH07XG59O1xuLyoqXG4gKiAqKk5vdGUqKi4gVGhlIGNvbnN0cmFpbnQgaXMgcmVsYXhlZDogYSBgU2VtaWdyb3VwYCBpbnN0ZWFkIG9mIGEgYE1vbm9pZGAuXG4gKlxuICogQGNhdGVnb3J5IGZvbGRpbmdcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIGZvbGRNYXBXaXRoSW5kZXggPSBmdW5jdGlvbiAoUykge1xuICAgIHJldHVybiBmdW5jdGlvbiAoZikge1xuICAgICAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgICAgICByZXR1cm4gYXMuc2xpY2UoMSkucmVkdWNlKGZ1bmN0aW9uIChzLCBhLCBpKSB7IHJldHVybiBTLmNvbmNhdChzLCBmKGkgKyAxLCBhKSk7IH0sIGYoMCwgYXNbMF0pKTtcbiAgICAgICAgfTtcbiAgICB9O1xufTtcbi8qKlxuICogQGNhdGVnb3J5IGZvbGRpbmdcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIHJlZHVjZVJpZ2h0V2l0aEluZGV4ID0gZnVuY3Rpb24gKGIsIGYpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIHJldHVybiBhcy5yZWR1Y2VSaWdodChmdW5jdGlvbiAoYiwgYSwgaSkgeyByZXR1cm4gZihpLCBhLCBiKTsgfSwgYik7XG4gICAgfTtcbn07XG4vKipcbiAqIEBjYXRlZ29yeSB0cmF2ZXJzaW5nXG4gKiBAc2luY2UgMi42LjNcbiAqL1xuZXhwb3J0IHZhciB0cmF2ZXJzZSA9IGZ1bmN0aW9uIChGKSB7XG4gICAgdmFyIHRyYXZlcnNlV2l0aEluZGV4RiA9IHRyYXZlcnNlV2l0aEluZGV4KEYpO1xuICAgIHJldHVybiBmdW5jdGlvbiAoZikgeyByZXR1cm4gdHJhdmVyc2VXaXRoSW5kZXhGKGZ1bmN0aW9uIChfLCBhKSB7IHJldHVybiBmKGEpOyB9KTsgfTtcbn07XG4vKipcbiAqIEBjYXRlZ29yeSB0cmF2ZXJzaW5nXG4gKiBAc2luY2UgMi42LjNcbiAqL1xuZXhwb3J0IHZhciBzZXF1ZW5jZSA9IGZ1bmN0aW9uIChGKSB7IHJldHVybiB0cmF2ZXJzZVdpdGhJbmRleChGKShTSyk7IH07XG4vKipcbiAqIEBjYXRlZ29yeSBzZXF1ZW5jaW5nXG4gKiBAc2luY2UgMi42LjNcbiAqL1xuZXhwb3J0IHZhciB0cmF2ZXJzZVdpdGhJbmRleCA9IGZ1bmN0aW9uIChGKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChmKSB7XG4gICAgICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgICAgIHZhciBvdXQgPSBGLm1hcChmKDAsIGhlYWQoYXMpKSwgb2YpO1xuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDE7IGkgPCBhcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgIG91dCA9IEYuYXAoRi5tYXAob3V0LCBmdW5jdGlvbiAoYnMpIHsgcmV0dXJuIGZ1bmN0aW9uIChiKSB7IHJldHVybiBwaXBlKGJzLCBhcHBlbmQoYikpOyB9OyB9KSwgZihpLCBhc1tpXSkpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIG91dDtcbiAgICAgICAgfTtcbiAgICB9O1xufTtcbi8qKlxuICogQGNhdGVnb3J5IENvbW9uYWRcbiAqIEBzaW5jZSAyLjYuM1xuICovXG5leHBvcnQgdmFyIGV4dHJhY3QgPSBfLmhlYWQ7XG4vKipcbiAqIEBjYXRlZ29yeSB0eXBlIGxhbWJkYXNcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIFVSSSA9ICdSZWFkb25seU5vbkVtcHR5QXJyYXknO1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBnZXRTaG93ID0gZnVuY3Rpb24gKFMpIHsgcmV0dXJuICh7XG4gICAgc2hvdzogZnVuY3Rpb24gKGFzKSB7IHJldHVybiBcIltcIi5jb25jYXQoYXMubWFwKFMuc2hvdykuam9pbignLCAnKSwgXCJdXCIpOyB9XG59KTsgfTtcbi8qKlxuICogQnVpbGRzIGEgYFNlbWlncm91cGAgaW5zdGFuY2UgZm9yIGBSZWFkb25seU5vbkVtcHR5QXJyYXlgXG4gKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgZ2V0U2VtaWdyb3VwID0gZnVuY3Rpb24gKCkgeyByZXR1cm4gKHtcbiAgICBjb25jYXQ6IGNvbmNhdFxufSk7IH07XG4vKipcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBnZXRFcSB9IGZyb20gJ2ZwLXRzL1JlYWRvbmx5Tm9uRW1wdHlBcnJheSdcbiAqIGltcG9ydCAqIGFzIE4gZnJvbSAnZnAtdHMvbnVtYmVyJ1xuICpcbiAqIGNvbnN0IEUgPSBnZXRFcShOLkVxKVxuICogYXNzZXJ0LnN0cmljdEVxdWFsKEUuZXF1YWxzKFsxLCAyXSwgWzEsIDJdKSwgdHJ1ZSlcbiAqIGFzc2VydC5zdHJpY3RFcXVhbChFLmVxdWFscyhbMSwgMl0sIFsxLCAzXSksIGZhbHNlKVxuICpcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIGdldEVxID0gZnVuY3Rpb24gKEUpIHtcbiAgICByZXR1cm4gZnJvbUVxdWFscyhmdW5jdGlvbiAoeHMsIHlzKSB7IHJldHVybiB4cy5sZW5ndGggPT09IHlzLmxlbmd0aCAmJiB4cy5ldmVyeShmdW5jdGlvbiAoeCwgaSkgeyByZXR1cm4gRS5lcXVhbHMoeCwgeXNbaV0pOyB9KTsgfSk7XG59O1xuLyoqXG4gKiBAc2luY2UgMi4xMS4wXG4gKi9cbmV4cG9ydCB2YXIgZ2V0VW5pb25TZW1pZ3JvdXAgPSBmdW5jdGlvbiAoRSkge1xuICAgIHZhciB1bmlvbkUgPSB1bmlvbihFKTtcbiAgICByZXR1cm4ge1xuICAgICAgICBjb25jYXQ6IGZ1bmN0aW9uIChmaXJzdCwgc2Vjb25kKSB7IHJldHVybiB1bmlvbkUoc2Vjb25kKShmaXJzdCk7IH1cbiAgICB9O1xufTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuNy4wXG4gKi9cbmV4cG9ydCB2YXIgRnVuY3RvciA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICBtYXA6IF9tYXBcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBtYXBwaW5nXG4gKiBAc2luY2UgMi4xMC4wXG4gKi9cbmV4cG9ydCB2YXIgZmxhcCA9IC8qI19fUFVSRV9fKi8gZmxhcF8oRnVuY3Rvcik7XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjEwLjBcbiAqL1xuZXhwb3J0IHZhciBQb2ludGVkID0ge1xuICAgIFVSSTogVVJJLFxuICAgIG9mOiBvZlxufTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuNy4wXG4gKi9cbmV4cG9ydCB2YXIgRnVuY3RvcldpdGhJbmRleCA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICBtYXA6IF9tYXAsXG4gICAgbWFwV2l0aEluZGV4OiBfbWFwV2l0aEluZGV4XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi4xMC4wXG4gKi9cbmV4cG9ydCB2YXIgQXBwbHkgPSB7XG4gICAgVVJJOiBVUkksXG4gICAgbWFwOiBfbWFwLFxuICAgIGFwOiBfYXBcbn07XG4vKipcbiAqIENvbWJpbmUgdHdvIGVmZmVjdGZ1bCBhY3Rpb25zLCBrZWVwaW5nIG9ubHkgdGhlIHJlc3VsdCBvZiB0aGUgZmlyc3QuXG4gKlxuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgYXBGaXJzdCA9IC8qI19fUFVSRV9fKi8gYXBGaXJzdF8oQXBwbHkpO1xuLyoqXG4gKiBDb21iaW5lIHR3byBlZmZlY3RmdWwgYWN0aW9ucywga2VlcGluZyBvbmx5IHRoZSByZXN1bHQgb2YgdGhlIHNlY29uZC5cbiAqXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBhcFNlY29uZCA9IC8qI19fUFVSRV9fKi8gYXBTZWNvbmRfKEFwcGx5KTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuNy4wXG4gKi9cbmV4cG9ydCB2YXIgQXBwbGljYXRpdmUgPSB7XG4gICAgVVJJOiBVUkksXG4gICAgbWFwOiBfbWFwLFxuICAgIGFwOiBfYXAsXG4gICAgb2Y6IG9mXG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi4xMC4wXG4gKi9cbmV4cG9ydCB2YXIgQ2hhaW4gPSB7XG4gICAgVVJJOiBVUkksXG4gICAgbWFwOiBfbWFwLFxuICAgIGFwOiBfYXAsXG4gICAgY2hhaW46IGZsYXRNYXBcbn07XG4vKipcbiAqIENvbXBvc2VzIGNvbXB1dGF0aW9ucyBpbiBzZXF1ZW5jZSwgdXNpbmcgdGhlIHJldHVybiB2YWx1ZSBvZiBvbmUgY29tcHV0YXRpb24gdG8gZGV0ZXJtaW5lIHRoZSBuZXh0IGNvbXB1dGF0aW9uIGFuZFxuICoga2VlcGluZyBvbmx5IHRoZSByZXN1bHQgb2YgdGhlIGZpcnN0LlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgKiBhcyBSQSBmcm9tICdmcC10cy9SZWFkb25seUFycmF5J1xuICogaW1wb3J0IHsgcGlwZSB9IGZyb20gJ2ZwLXRzL2Z1bmN0aW9uJ1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoXG4gKiAgIHBpcGUoXG4gKiAgICAgWzEsIDIsIDNdLFxuICogICAgIFJBLmNoYWluRmlyc3QoKCkgPT4gWydhJywgJ2InXSlcbiAqICAgKSxcbiAqICAgWzEsIDEsIDIsIDIsIDMsIDNdXG4gKiApXG4gKlxuICogQGNhdGVnb3J5IHNlcXVlbmNpbmdcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIGNoYWluRmlyc3QgPSAvKiNfX1BVUkVfXyovIGNoYWluRmlyc3RfKENoYWluKTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuNy4wXG4gKi9cbmV4cG9ydCB2YXIgTW9uYWQgPSB7XG4gICAgVVJJOiBVUkksXG4gICAgbWFwOiBfbWFwLFxuICAgIGFwOiBfYXAsXG4gICAgb2Y6IG9mLFxuICAgIGNoYWluOiBmbGF0TWFwXG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi43LjBcbiAqL1xuZXhwb3J0IHZhciBGb2xkYWJsZSA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICByZWR1Y2U6IF9yZWR1Y2UsXG4gICAgZm9sZE1hcDogX2ZvbGRNYXAsXG4gICAgcmVkdWNlUmlnaHQ6IF9yZWR1Y2VSaWdodFxufTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuNy4wXG4gKi9cbmV4cG9ydCB2YXIgRm9sZGFibGVXaXRoSW5kZXggPSB7XG4gICAgVVJJOiBVUkksXG4gICAgcmVkdWNlOiBfcmVkdWNlLFxuICAgIGZvbGRNYXA6IF9mb2xkTWFwLFxuICAgIHJlZHVjZVJpZ2h0OiBfcmVkdWNlUmlnaHQsXG4gICAgcmVkdWNlV2l0aEluZGV4OiBfcmVkdWNlV2l0aEluZGV4LFxuICAgIGZvbGRNYXBXaXRoSW5kZXg6IF9mb2xkTWFwV2l0aEluZGV4LFxuICAgIHJlZHVjZVJpZ2h0V2l0aEluZGV4OiBfcmVkdWNlUmlnaHRXaXRoSW5kZXhcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjcuMFxuICovXG5leHBvcnQgdmFyIFRyYXZlcnNhYmxlID0ge1xuICAgIFVSSTogVVJJLFxuICAgIG1hcDogX21hcCxcbiAgICByZWR1Y2U6IF9yZWR1Y2UsXG4gICAgZm9sZE1hcDogX2ZvbGRNYXAsXG4gICAgcmVkdWNlUmlnaHQ6IF9yZWR1Y2VSaWdodCxcbiAgICB0cmF2ZXJzZTogX3RyYXZlcnNlLFxuICAgIHNlcXVlbmNlOiBzZXF1ZW5jZVxufTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuNy4wXG4gKi9cbmV4cG9ydCB2YXIgVHJhdmVyc2FibGVXaXRoSW5kZXggPSB7XG4gICAgVVJJOiBVUkksXG4gICAgbWFwOiBfbWFwLFxuICAgIG1hcFdpdGhJbmRleDogX21hcFdpdGhJbmRleCxcbiAgICByZWR1Y2U6IF9yZWR1Y2UsXG4gICAgZm9sZE1hcDogX2ZvbGRNYXAsXG4gICAgcmVkdWNlUmlnaHQ6IF9yZWR1Y2VSaWdodCxcbiAgICB0cmF2ZXJzZTogX3RyYXZlcnNlLFxuICAgIHNlcXVlbmNlOiBzZXF1ZW5jZSxcbiAgICByZWR1Y2VXaXRoSW5kZXg6IF9yZWR1Y2VXaXRoSW5kZXgsXG4gICAgZm9sZE1hcFdpdGhJbmRleDogX2ZvbGRNYXBXaXRoSW5kZXgsXG4gICAgcmVkdWNlUmlnaHRXaXRoSW5kZXg6IF9yZWR1Y2VSaWdodFdpdGhJbmRleCxcbiAgICB0cmF2ZXJzZVdpdGhJbmRleDogX3RyYXZlcnNlV2l0aEluZGV4XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi43LjBcbiAqL1xuZXhwb3J0IHZhciBBbHQgPSB7XG4gICAgVVJJOiBVUkksXG4gICAgbWFwOiBfbWFwLFxuICAgIGFsdDogX2FsdFxufTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuNy4wXG4gKi9cbmV4cG9ydCB2YXIgQ29tb25hZCA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICBtYXA6IF9tYXAsXG4gICAgZXh0ZW5kOiBfZXh0ZW5kLFxuICAgIGV4dHJhY3Q6IGV4dHJhY3Rcbn07XG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vLyBkbyBub3RhdGlvblxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLyoqXG4gKiBAY2F0ZWdvcnkgZG8gbm90YXRpb25cbiAqIEBzaW5jZSAyLjkuMFxuICovXG5leHBvcnQgdmFyIERvID0gLyojX19QVVJFX18qLyBvZihfLmVtcHR5UmVjb3JkKTtcbi8qKlxuICogQGNhdGVnb3J5IGRvIG5vdGF0aW9uXG4gKiBAc2luY2UgMi44LjBcbiAqL1xuZXhwb3J0IHZhciBiaW5kVG8gPSAvKiNfX1BVUkVfXyovIGJpbmRUb18oRnVuY3Rvcik7XG52YXIgbGV0XyA9IC8qI19fUFVSRV9fKi8gbGV0X18oRnVuY3Rvcik7XG5leHBvcnQgeyBcbi8qKlxuICogQGNhdGVnb3J5IGRvIG5vdGF0aW9uXG4gKiBAc2luY2UgMi4xMy4wXG4gKi9cbmxldF8gYXMgbGV0IH07XG4vKipcbiAqIEBjYXRlZ29yeSBkbyBub3RhdGlvblxuICogQHNpbmNlIDIuOC4wXG4gKi9cbmV4cG9ydCB2YXIgYmluZCA9IC8qI19fUFVSRV9fKi8gYmluZF8oQ2hhaW4pO1xuLyoqXG4gKiBAY2F0ZWdvcnkgZG8gbm90YXRpb25cbiAqIEBzaW5jZSAyLjguMFxuICovXG5leHBvcnQgdmFyIGFwUyA9IC8qI19fUFVSRV9fKi8gYXBTXyhBcHBseSk7XG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vLyB1dGlsc1xuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLyoqXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBoZWFkID0gZXh0cmFjdDtcbi8qKlxuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgdGFpbCA9IF8udGFpbDtcbi8qKlxuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgbGFzdCA9IGZ1bmN0aW9uIChhcykgeyByZXR1cm4gYXNbYXMubGVuZ3RoIC0gMV07IH07XG4vKipcbiAqIEdldCBhbGwgYnV0IHRoZSBsYXN0IGVsZW1lbnQgb2YgYSBub24gZW1wdHkgYXJyYXksIGNyZWF0aW5nIGEgbmV3IGFycmF5LlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBpbml0IH0gZnJvbSAnZnAtdHMvUmVhZG9ubHlOb25FbXB0eUFycmF5J1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoaW5pdChbMSwgMiwgM10pLCBbMSwgMl0pXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKGluaXQoWzFdKSwgW10pXG4gKlxuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgaW5pdCA9IGZ1bmN0aW9uIChhcykgeyByZXR1cm4gYXMuc2xpY2UoMCwgLTEpOyB9O1xuLyoqXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBtaW4gPSBmdW5jdGlvbiAoTykge1xuICAgIHZhciBTID0gU2UubWluKE8pO1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHsgcmV0dXJuIGFzLnJlZHVjZShTLmNvbmNhdCk7IH07XG59O1xuLyoqXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBtYXggPSBmdW5jdGlvbiAoTykge1xuICAgIHZhciBTID0gU2UubWF4KE8pO1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHsgcmV0dXJuIGFzLnJlZHVjZShTLmNvbmNhdCk7IH07XG59O1xuLyoqXG4gKiBAc2luY2UgMi4xMC4wXG4gKi9cbmV4cG9ydCB2YXIgY29uY2F0QWxsID0gZnVuY3Rpb24gKFMpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIHJldHVybiBhcy5yZWR1Y2UoUy5jb25jYXQpO1xuICAgIH07XG59O1xuLyoqXG4gKiBCcmVhayBhIGBSZWFkb25seUFycmF5YCBpbnRvIGl0cyBmaXJzdCBlbGVtZW50IGFuZCByZW1haW5pbmcgZWxlbWVudHMuXG4gKlxuICogQGNhdGVnb3J5IHBhdHRlcm4gbWF0Y2hpbmdcbiAqIEBzaW5jZSAyLjExLjBcbiAqL1xuZXhwb3J0IHZhciBtYXRjaExlZnQgPSBmdW5jdGlvbiAoZikge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgcmV0dXJuIGYoaGVhZChhcyksIHRhaWwoYXMpKTtcbiAgICB9O1xufTtcbi8qKlxuICogQnJlYWsgYSBgUmVhZG9ubHlBcnJheWAgaW50byBpdHMgaW5pdGlhbCBlbGVtZW50cyBhbmQgdGhlIGxhc3QgZWxlbWVudC5cbiAqXG4gKiBAY2F0ZWdvcnkgcGF0dGVybiBtYXRjaGluZ1xuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIG1hdGNoUmlnaHQgPSBmdW5jdGlvbiAoZikge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgcmV0dXJuIGYoaW5pdChhcyksIGxhc3QoYXMpKTtcbiAgICB9O1xufTtcbi8qKlxuICogQXBwbHkgYSBmdW5jdGlvbiB0byB0aGUgaGVhZCwgY3JlYXRpbmcgYSBuZXcgYFJlYWRvbmx5Tm9uRW1wdHlBcnJheWAuXG4gKlxuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIG1vZGlmeUhlYWQgPSBmdW5jdGlvbiAoZikge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgcmV0dXJuIF9fc3ByZWFkQXJyYXkoW2YoaGVhZChhcykpXSwgdGFpbChhcyksIHRydWUpO1xuICAgIH07XG59O1xuLyoqXG4gKiBDaGFuZ2UgdGhlIGhlYWQsIGNyZWF0aW5nIGEgbmV3IGBSZWFkb25seU5vbkVtcHR5QXJyYXlgLlxuICpcbiAqIEBzaW5jZSAyLjExLjBcbiAqL1xuZXhwb3J0IHZhciB1cGRhdGVIZWFkID0gZnVuY3Rpb24gKGEpIHsgcmV0dXJuIG1vZGlmeUhlYWQoZnVuY3Rpb24gKCkgeyByZXR1cm4gYTsgfSk7IH07XG4vKipcbiAqIEFwcGx5IGEgZnVuY3Rpb24gdG8gdGhlIGxhc3QgZWxlbWVudCwgY3JlYXRpbmcgYSBuZXcgYFJlYWRvbmx5Tm9uRW1wdHlBcnJheWAuXG4gKlxuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIG1vZGlmeUxhc3QgPSBmdW5jdGlvbiAoZikge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgcmV0dXJuIHBpcGUoaW5pdChhcyksIGFwcGVuZChmKGxhc3QoYXMpKSkpO1xuICAgIH07XG59O1xuLyoqXG4gKiBDaGFuZ2UgdGhlIGxhc3QgZWxlbWVudCwgY3JlYXRpbmcgYSBuZXcgYFJlYWRvbmx5Tm9uRW1wdHlBcnJheWAuXG4gKlxuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIHVwZGF0ZUxhc3QgPSBmdW5jdGlvbiAoYSkgeyByZXR1cm4gbW9kaWZ5TGFzdChmdW5jdGlvbiAoKSB7IHJldHVybiBhOyB9KTsgfTtcbi8qKlxuICogUGxhY2VzIGFuIGVsZW1lbnQgaW4gYmV0d2VlbiBtZW1iZXJzIG9mIGEgYFJlYWRvbmx5Tm9uRW1wdHlBcnJheWAsIHRoZW4gZm9sZHMgdGhlIHJlc3VsdHMgdXNpbmcgdGhlIHByb3ZpZGVkIGBTZW1pZ3JvdXBgLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgKiBhcyBTIGZyb20gJ2ZwLXRzL3N0cmluZydcbiAqIGltcG9ydCB7IGludGVyY2FsYXRlIH0gZnJvbSAnZnAtdHMvUmVhZG9ubHlOb25FbXB0eUFycmF5J1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoaW50ZXJjYWxhdGUoUy5TZW1pZ3JvdXApKCctJykoWydhJywgJ2InLCAnYyddKSwgJ2EtYi1jJylcbiAqXG4gKiBAc2luY2UgMi4xMi4wXG4gKi9cbmV4cG9ydCB2YXIgaW50ZXJjYWxhdGUgPSBmdW5jdGlvbiAoUykge1xuICAgIHZhciBjb25jYXRBbGxTID0gY29uY2F0QWxsKFMpO1xuICAgIHJldHVybiBmdW5jdGlvbiAobWlkZGxlKSB7IHJldHVybiBmbG93KGludGVyc3BlcnNlKG1pZGRsZSksIGNvbmNhdEFsbFMpOyB9O1xufTtcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8vIGxlZ2FjeVxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLyoqXG4gKiBBbGlhcyBvZiBgZmxhdE1hcGAuXG4gKlxuICogQGNhdGVnb3J5IGxlZ2FjeVxuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgY2hhaW4gPSBmbGF0TWFwO1xuZXhwb3J0IGZ1bmN0aW9uIGdyb3VwU29ydChPKSB7XG4gICAgdmFyIHNvcnRPID0gc29ydChPKTtcbiAgICB2YXIgZ3JvdXBPID0gZ3JvdXAoTyk7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykgeyByZXR1cm4gKGlzTm9uRW1wdHkoYXMpID8gZ3JvdXBPKHNvcnRPKGFzKSkgOiBlbXB0eSk7IH07XG59XG5leHBvcnQgZnVuY3Rpb24gZmlsdGVyKHByZWRpY2F0ZSkge1xuICAgIHJldHVybiBmaWx0ZXJXaXRoSW5kZXgoZnVuY3Rpb24gKF8sIGEpIHsgcmV0dXJuIHByZWRpY2F0ZShhKTsgfSk7XG59XG4vKipcbiAqIFVzZSBbYGZpbHRlcldpdGhJbmRleGBdKC4vUmVhZG9ubHlBcnJheS50cy5odG1sI2ZpbHRlcndpdGhpbmRleCkgaW5zdGVhZC5cbiAqXG4gKiBAY2F0ZWdvcnkgem9uZSBvZiBkZWF0aFxuICogQHNpbmNlIDIuNS4wXG4gKiBAZGVwcmVjYXRlZFxuICovXG5leHBvcnQgdmFyIGZpbHRlcldpdGhJbmRleCA9IGZ1bmN0aW9uIChwcmVkaWNhdGUpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIHJldHVybiBmcm9tUmVhZG9ubHlBcnJheShhcy5maWx0ZXIoZnVuY3Rpb24gKGEsIGkpIHsgcmV0dXJuIHByZWRpY2F0ZShpLCBhKTsgfSkpO1xuICAgIH07XG59O1xuLyoqXG4gKiBVc2UgW2B1bnByZXBlbmRgXSgjdW5wcmVwZW5kKSBpbnN0ZWFkLlxuICpcbiAqIEBjYXRlZ29yeSB6b25lIG9mIGRlYXRoXG4gKiBAc2luY2UgMi4xMC4wXG4gKiBAZGVwcmVjYXRlZFxuICovXG5leHBvcnQgdmFyIHVuY29ucyA9IHVucHJlcGVuZDtcbi8qKlxuICogVXNlIFtgdW5hcHBlbmRgXSgjdW5hcHBlbmQpIGluc3RlYWQuXG4gKlxuICogQGNhdGVnb3J5IHpvbmUgb2YgZGVhdGhcbiAqIEBzaW5jZSAyLjEwLjBcbiAqIEBkZXByZWNhdGVkXG4gKi9cbmV4cG9ydCB2YXIgdW5zbm9jID0gdW5hcHBlbmQ7XG5leHBvcnQgZnVuY3Rpb24gY29ucyhoZWFkLCB0YWlsKSB7XG4gICAgcmV0dXJuIHRhaWwgPT09IHVuZGVmaW5lZCA/IHByZXBlbmQoaGVhZCkgOiBwaXBlKHRhaWwsIHByZXBlbmQoaGVhZCkpO1xufVxuLyoqXG4gKiBVc2UgW2BhcHBlbmRgXSguL1JlYWRvbmx5QXJyYXkudHMuaHRtbCNhcHBlbmQpIGluc3RlYWQuXG4gKlxuICogQGNhdGVnb3J5IHpvbmUgb2YgZGVhdGhcbiAqIEBzaW5jZSAyLjUuMFxuICogQGRlcHJlY2F0ZWRcbiAqL1xuZXhwb3J0IHZhciBzbm9jID0gZnVuY3Rpb24gKGluaXQsIGVuZCkgeyByZXR1cm4gcGlwZShpbml0LCBjb25jYXQoW2VuZF0pKTsgfTtcbi8qKlxuICogVXNlIFtgaW5zZXJ0QXRgXSguL1JlYWRvbmx5QXJyYXkudHMuaHRtbCNpbnNlcnRhdCkgaW5zdGVhZC5cbiAqXG4gKiBAY2F0ZWdvcnkgem9uZSBvZiBkZWF0aFxuICogQHNpbmNlIDIuNS4wXG4gKiBAZGVwcmVjYXRlZFxuICovXG5leHBvcnQgdmFyIGluc2VydEF0ID0gZnVuY3Rpb24gKGksIGEpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIHJldHVybiBpIDwgMCB8fCBpID4gYXMubGVuZ3RoID8gXy5ub25lIDogXy5zb21lKHVuc2FmZUluc2VydEF0KGksIGEsIGFzKSk7XG4gICAgfTtcbn07XG4vKipcbiAqIFVzZSBbYHByZXBlbmRBbGxgXSgjcHJlcGVuZGFsbCkgaW5zdGVhZC5cbiAqXG4gKiBAY2F0ZWdvcnkgem9uZSBvZiBkZWF0aFxuICogQHNpbmNlIDIuOS4wXG4gKiBAZGVwcmVjYXRlZFxuICovXG5leHBvcnQgdmFyIHByZXBlbmRUb0FsbCA9IHByZXBlbmRBbGw7XG4vKipcbiAqIFVzZSBbYGNvbmNhdEFsbGBdKCNjb25jYXRhbGwpIGluc3RlYWQuXG4gKlxuICogQGNhdGVnb3J5IHpvbmUgb2YgZGVhdGhcbiAqIEBzaW5jZSAyLjUuMFxuICogQGRlcHJlY2F0ZWRcbiAqL1xuZXhwb3J0IHZhciBmb2xkID0gY29uY2F0QWxsO1xuLyoqXG4gKiBUaGlzIGluc3RhbmNlIGlzIGRlcHJlY2F0ZWQsIHVzZSBzbWFsbCwgc3BlY2lmaWMgaW5zdGFuY2VzIGluc3RlYWQuXG4gKiBGb3IgZXhhbXBsZSBpZiBhIGZ1bmN0aW9uIG5lZWRzIGEgYEZ1bmN0b3JgIGluc3RhbmNlLCBwYXNzIGBSTkVBLkZ1bmN0b3JgIGluc3RlYWQgb2YgYFJORUEucmVhZG9ubHlOb25FbXB0eUFycmF5YFxuICogKHdoZXJlIGBSTkVBYCBpcyBmcm9tIGBpbXBvcnQgUk5FQSBmcm9tICdmcC10cy9SZWFkb25seU5vbkVtcHR5QXJyYXknYClcbiAqXG4gKiBAY2F0ZWdvcnkgem9uZSBvZiBkZWF0aFxuICogQHNpbmNlIDIuNS4wXG4gKiBAZGVwcmVjYXRlZFxuICovXG5leHBvcnQgdmFyIHJlYWRvbmx5Tm9uRW1wdHlBcnJheSA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICBvZjogb2YsXG4gICAgbWFwOiBfbWFwLFxuICAgIG1hcFdpdGhJbmRleDogX21hcFdpdGhJbmRleCxcbiAgICBhcDogX2FwLFxuICAgIGNoYWluOiBmbGF0TWFwLFxuICAgIGV4dGVuZDogX2V4dGVuZCxcbiAgICBleHRyYWN0OiBleHRyYWN0LFxuICAgIHJlZHVjZTogX3JlZHVjZSxcbiAgICBmb2xkTWFwOiBfZm9sZE1hcCxcbiAgICByZWR1Y2VSaWdodDogX3JlZHVjZVJpZ2h0LFxuICAgIHRyYXZlcnNlOiBfdHJhdmVyc2UsXG4gICAgc2VxdWVuY2U6IHNlcXVlbmNlLFxuICAgIHJlZHVjZVdpdGhJbmRleDogX3JlZHVjZVdpdGhJbmRleCxcbiAgICBmb2xkTWFwV2l0aEluZGV4OiBfZm9sZE1hcFdpdGhJbmRleCxcbiAgICByZWR1Y2VSaWdodFdpdGhJbmRleDogX3JlZHVjZVJpZ2h0V2l0aEluZGV4LFxuICAgIHRyYXZlcnNlV2l0aEluZGV4OiBfdHJhdmVyc2VXaXRoSW5kZXgsXG4gICAgYWx0OiBfYWx0XG59O1xuIiwKICAidmFyIF9fc3ByZWFkQXJyYXkgPSAodGhpcyAmJiB0aGlzLl9fc3ByZWFkQXJyYXkpIHx8IGZ1bmN0aW9uICh0bywgZnJvbSwgcGFjaykge1xuICAgIGlmIChwYWNrIHx8IGFyZ3VtZW50cy5sZW5ndGggPT09IDIpIGZvciAodmFyIGkgPSAwLCBsID0gZnJvbS5sZW5ndGgsIGFyOyBpIDwgbDsgaSsrKSB7XG4gICAgICAgIGlmIChhciB8fCAhKGkgaW4gZnJvbSkpIHtcbiAgICAgICAgICAgIGlmICghYXIpIGFyID0gQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoZnJvbSwgMCwgaSk7XG4gICAgICAgICAgICBhcltpXSA9IGZyb21baV07XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHRvLmNvbmNhdChhciB8fCBBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChmcm9tKSk7XG59O1xuaW1wb3J0IHsgYXBGaXJzdCBhcyBhcEZpcnN0XywgYXBTIGFzIGFwU18sIGFwU2Vjb25kIGFzIGFwU2Vjb25kXyB9IGZyb20gJy4vQXBwbHknO1xuaW1wb3J0IHsgYmluZCBhcyBiaW5kXywgY2hhaW5GaXJzdCBhcyBjaGFpbkZpcnN0XyB9IGZyb20gJy4vQ2hhaW4nO1xuaW1wb3J0IHsgZHVhbCwgaWRlbnRpdHksIHBpcGUgfSBmcm9tICcuL2Z1bmN0aW9uJztcbmltcG9ydCB7IGJpbmRUbyBhcyBiaW5kVG9fLCBmbGFwIGFzIGZsYXBfLCBsZXQgYXMgbGV0X18gfSBmcm9tICcuL0Z1bmN0b3InO1xuaW1wb3J0ICogYXMgXyBmcm9tICcuL2ludGVybmFsJztcbmltcG9ydCB7IGdldE1vbm9pZCB9IGZyb20gJy4vT3JkJztcbmltcG9ydCAqIGFzIFJORUEgZnJvbSAnLi9SZWFkb25seU5vbkVtcHR5QXJyYXknO1xuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLy8gaW50ZXJuYWxcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8qKlxuICogQGludGVybmFsXG4gKi9cbmV4cG9ydCB2YXIgaXNOb25FbXB0eSA9IGZ1bmN0aW9uIChhcykgeyByZXR1cm4gYXMubGVuZ3RoID4gMDsgfTtcbi8qKlxuICogQGludGVybmFsXG4gKi9cbmV4cG9ydCB2YXIgaXNPdXRPZkJvdW5kID0gZnVuY3Rpb24gKGksIGFzKSB7IHJldHVybiBpIDwgMCB8fCBpID49IGFzLmxlbmd0aDsgfTtcbi8qKlxuICogQGludGVybmFsXG4gKi9cbmV4cG9ydCB2YXIgcHJlcGVuZFcgPSBmdW5jdGlvbiAoaGVhZCkge1xuICAgIHJldHVybiBmdW5jdGlvbiAodGFpbCkge1xuICAgICAgICByZXR1cm4gX19zcHJlYWRBcnJheShbaGVhZF0sIHRhaWwsIHRydWUpO1xuICAgIH07XG59O1xuLyoqXG4gKiBAaW50ZXJuYWxcbiAqL1xuZXhwb3J0IHZhciBwcmVwZW5kID0gcHJlcGVuZFc7XG4vKipcbiAqIEBpbnRlcm5hbFxuICovXG5leHBvcnQgdmFyIGFwcGVuZFcgPSBmdW5jdGlvbiAoZW5kKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChpbml0KSB7XG4gICAgICAgIHJldHVybiBfX3NwcmVhZEFycmF5KF9fc3ByZWFkQXJyYXkoW10sIGluaXQsIHRydWUpLCBbZW5kXSwgZmFsc2UpO1xuICAgIH07XG59O1xuLyoqXG4gKiBAaW50ZXJuYWxcbiAqL1xuZXhwb3J0IHZhciBhcHBlbmQgPSBhcHBlbmRXO1xuLyoqXG4gKiBAaW50ZXJuYWxcbiAqL1xuZXhwb3J0IHZhciB1bnNhZmVJbnNlcnRBdCA9IGZ1bmN0aW9uIChpLCBhLCBhcykge1xuICAgIGlmIChpc05vbkVtcHR5KGFzKSkge1xuICAgICAgICB2YXIgeHMgPSBmcm9tUmVhZG9ubHlOb25FbXB0eUFycmF5KGFzKTtcbiAgICAgICAgeHMuc3BsaWNlKGksIDAsIGEpO1xuICAgICAgICByZXR1cm4geHM7XG4gICAgfVxuICAgIHJldHVybiBbYV07XG59O1xuLyoqXG4gKiBAaW50ZXJuYWxcbiAqL1xuZXhwb3J0IHZhciB1bnNhZmVVcGRhdGVBdCA9IGZ1bmN0aW9uIChpLCBhLCBhcykge1xuICAgIHZhciB4cyA9IGZyb21SZWFkb25seU5vbkVtcHR5QXJyYXkoYXMpO1xuICAgIHhzW2ldID0gYTtcbiAgICByZXR1cm4geHM7XG59O1xuLyoqXG4gKiBSZW1vdmUgZHVwbGljYXRlcyBmcm9tIGEgYE5vbkVtcHR5QXJyYXlgLCBrZWVwaW5nIHRoZSBmaXJzdCBvY2N1cnJlbmNlIG9mIGFuIGVsZW1lbnQuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IHVuaXEgfSBmcm9tICdmcC10cy9Ob25FbXB0eUFycmF5J1xuICogaW1wb3J0ICogYXMgTiBmcm9tICdmcC10cy9udW1iZXInXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbCh1bmlxKE4uRXEpKFsxLCAyLCAxXSksIFsxLCAyXSlcbiAqXG4gKiBAc2luY2UgMi4xMS4wXG4gKi9cbmV4cG9ydCB2YXIgdW5pcSA9IGZ1bmN0aW9uIChFKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykge1xuICAgICAgICBpZiAoYXMubGVuZ3RoID09PSAxKSB7XG4gICAgICAgICAgICByZXR1cm4gY29weShhcyk7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIG91dCA9IFtoZWFkKGFzKV07XG4gICAgICAgIHZhciByZXN0ID0gdGFpbChhcyk7XG4gICAgICAgIHZhciBfbG9vcF8xID0gZnVuY3Rpb24gKGEpIHtcbiAgICAgICAgICAgIGlmIChvdXQuZXZlcnkoZnVuY3Rpb24gKG8pIHsgcmV0dXJuICFFLmVxdWFscyhvLCBhKTsgfSkpIHtcbiAgICAgICAgICAgICAgICBvdXQucHVzaChhKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgZm9yICh2YXIgX2kgPSAwLCByZXN0XzEgPSByZXN0OyBfaSA8IHJlc3RfMS5sZW5ndGg7IF9pKyspIHtcbiAgICAgICAgICAgIHZhciBhID0gcmVzdF8xW19pXTtcbiAgICAgICAgICAgIF9sb29wXzEoYSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG91dDtcbiAgICB9O1xufTtcbi8qKlxuICogU29ydCB0aGUgZWxlbWVudHMgb2YgYSBgTm9uRW1wdHlBcnJheWAgaW4gaW5jcmVhc2luZyBvcmRlciwgd2hlcmUgZWxlbWVudHMgYXJlIGNvbXBhcmVkIHVzaW5nIGZpcnN0IGBvcmRzWzBdYCwgdGhlbiBgb3Jkc1sxXWAsXG4gKiBldGMuLi5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0ICogYXMgTkVBIGZyb20gJ2ZwLXRzL05vbkVtcHR5QXJyYXknXG4gKiBpbXBvcnQgeyBjb250cmFtYXAgfSBmcm9tICdmcC10cy9PcmQnXG4gKiBpbXBvcnQgKiBhcyBTIGZyb20gJ2ZwLXRzL3N0cmluZydcbiAqIGltcG9ydCAqIGFzIE4gZnJvbSAnZnAtdHMvbnVtYmVyJ1xuICogaW1wb3J0IHsgcGlwZSB9IGZyb20gJ2ZwLXRzL2Z1bmN0aW9uJ1xuICpcbiAqIGludGVyZmFjZSBQZXJzb24ge1xuICogICBuYW1lOiBzdHJpbmdcbiAqICAgYWdlOiBudW1iZXJcbiAqIH1cbiAqXG4gKiBjb25zdCBieU5hbWUgPSBwaXBlKFMuT3JkLCBjb250cmFtYXAoKHA6IFBlcnNvbikgPT4gcC5uYW1lKSlcbiAqXG4gKiBjb25zdCBieUFnZSA9IHBpcGUoTi5PcmQsIGNvbnRyYW1hcCgocDogUGVyc29uKSA9PiBwLmFnZSkpXG4gKlxuICogY29uc3Qgc29ydEJ5TmFtZUJ5QWdlID0gTkVBLnNvcnRCeShbYnlOYW1lLCBieUFnZV0pXG4gKlxuICogY29uc3QgcGVyc29uczogTkVBLk5vbkVtcHR5QXJyYXk8UGVyc29uPiA9IFtcbiAqICAgeyBuYW1lOiAnYScsIGFnZTogMSB9LFxuICogICB7IG5hbWU6ICdiJywgYWdlOiAzIH0sXG4gKiAgIHsgbmFtZTogJ2MnLCBhZ2U6IDIgfSxcbiAqICAgeyBuYW1lOiAnYicsIGFnZTogMiB9XG4gKiBdXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChzb3J0QnlOYW1lQnlBZ2UocGVyc29ucyksIFtcbiAqICAgeyBuYW1lOiAnYScsIGFnZTogMSB9LFxuICogICB7IG5hbWU6ICdiJywgYWdlOiAyIH0sXG4gKiAgIHsgbmFtZTogJ2InLCBhZ2U6IDMgfSxcbiAqICAgeyBuYW1lOiAnYycsIGFnZTogMiB9XG4gKiBdKVxuICpcbiAqIEBzaW5jZSAyLjExLjBcbiAqL1xuZXhwb3J0IHZhciBzb3J0QnkgPSBmdW5jdGlvbiAob3Jkcykge1xuICAgIGlmIChpc05vbkVtcHR5KG9yZHMpKSB7XG4gICAgICAgIHZhciBNID0gZ2V0TW9ub2lkKCk7XG4gICAgICAgIHJldHVybiBzb3J0KG9yZHMucmVkdWNlKE0uY29uY2F0LCBNLmVtcHR5KSk7XG4gICAgfVxuICAgIHJldHVybiBjb3B5O1xufTtcbi8qKlxuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIHVuaW9uID0gZnVuY3Rpb24gKEUpIHtcbiAgICB2YXIgdW5pcUUgPSB1bmlxKEUpO1xuICAgIHJldHVybiBmdW5jdGlvbiAoc2Vjb25kKSB7IHJldHVybiBmdW5jdGlvbiAoZmlyc3QpIHsgcmV0dXJuIHVuaXFFKHBpcGUoZmlyc3QsIGNvbmNhdChzZWNvbmQpKSk7IH07IH07XG59O1xuLyoqXG4gKiBSb3RhdGUgYSBgTm9uRW1wdHlBcnJheWAgYnkgYG5gIHN0ZXBzLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyByb3RhdGUgfSBmcm9tICdmcC10cy9Ob25FbXB0eUFycmF5J1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwocm90YXRlKDIpKFsxLCAyLCAzLCA0LCA1XSksIFs0LCA1LCAxLCAyLCAzXSlcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwocm90YXRlKC0yKShbMSwgMiwgMywgNCwgNV0pLCBbMywgNCwgNSwgMSwgMl0pXG4gKlxuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIHJvdGF0ZSA9IGZ1bmN0aW9uIChuKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykge1xuICAgICAgICB2YXIgbGVuID0gYXMubGVuZ3RoO1xuICAgICAgICB2YXIgbSA9IE1hdGgucm91bmQobikgJSBsZW47XG4gICAgICAgIGlmIChpc091dE9mQm91bmQoTWF0aC5hYnMobSksIGFzKSB8fCBtID09PSAwKSB7XG4gICAgICAgICAgICByZXR1cm4gY29weShhcyk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKG0gPCAwKSB7XG4gICAgICAgICAgICB2YXIgX2EgPSBzcGxpdEF0KC1tKShhcyksIGYgPSBfYVswXSwgcyA9IF9hWzFdO1xuICAgICAgICAgICAgcmV0dXJuIHBpcGUocywgY29uY2F0KGYpKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybiByb3RhdGUobSAtIGxlbikoYXMpO1xuICAgICAgICB9XG4gICAgfTtcbn07XG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vLyBjb25zdHJ1Y3RvcnNcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8qKlxuICogQGNhdGVnb3J5IGNvbnZlcnNpb25zXG4gKiBAc2luY2UgMi4xMC4wXG4gKi9cbmV4cG9ydCB2YXIgZnJvbVJlYWRvbmx5Tm9uRW1wdHlBcnJheSA9IF8uZnJvbVJlYWRvbmx5Tm9uRW1wdHlBcnJheTtcbi8qKlxuICogQnVpbGRzIGEgYE5vbkVtcHR5QXJyYXlgIGZyb20gYW4gYEFycmF5YCByZXR1cm5pbmcgYG5vbmVgIGlmIGBhc2AgaXMgYW4gZW1wdHkgYXJyYXlcbiAqXG4gKiBAY2F0ZWdvcnkgY29udmVyc2lvbnNcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIGZyb21BcnJheSA9IGZ1bmN0aW9uIChhcykgeyByZXR1cm4gKGlzTm9uRW1wdHkoYXMpID8gXy5zb21lKGFzKSA6IF8ubm9uZSk7IH07XG4vKipcbiAqIFJldHVybiBhIGBOb25FbXB0eUFycmF5YCBvZiBsZW5ndGggYG5gIHdpdGggZWxlbWVudCBgaWAgaW5pdGlhbGl6ZWQgd2l0aCBgZihpKWAuXG4gKlxuICogKipOb3RlKiouIGBuYCBpcyBub3JtYWxpemVkIHRvIGEgbmF0dXJhbCBudW1iZXIuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IG1ha2VCeSB9IGZyb20gJ2ZwLXRzL05vbkVtcHR5QXJyYXknXG4gKiBpbXBvcnQgeyBwaXBlIH0gZnJvbSAnZnAtdHMvZnVuY3Rpb24nXG4gKlxuICogY29uc3QgZG91YmxlID0gKG46IG51bWJlcik6IG51bWJlciA9PiBuICogMlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChwaXBlKDUsIG1ha2VCeShkb3VibGUpKSwgWzAsIDIsIDQsIDYsIDhdKVxuICpcbiAqIEBjYXRlZ29yeSBjb25zdHJ1Y3RvcnNcbiAqIEBzaW5jZSAyLjExLjBcbiAqL1xuZXhwb3J0IHZhciBtYWtlQnkgPSBmdW5jdGlvbiAoZikge1xuICAgIHJldHVybiBmdW5jdGlvbiAobikge1xuICAgICAgICB2YXIgaiA9IE1hdGgubWF4KDAsIE1hdGguZmxvb3IobikpO1xuICAgICAgICB2YXIgb3V0ID0gW2YoMCldO1xuICAgICAgICBmb3IgKHZhciBpID0gMTsgaSA8IGo7IGkrKykge1xuICAgICAgICAgICAgb3V0LnB1c2goZihpKSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG91dDtcbiAgICB9O1xufTtcbi8qKlxuICogQ3JlYXRlIGEgYE5vbkVtcHR5QXJyYXlgIGNvbnRhaW5pbmcgYSB2YWx1ZSByZXBlYXRlZCB0aGUgc3BlY2lmaWVkIG51bWJlciBvZiB0aW1lcy5cbiAqXG4gKiAqKk5vdGUqKi4gYG5gIGlzIG5vcm1hbGl6ZWQgdG8gYSBuYXR1cmFsIG51bWJlci5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgcmVwbGljYXRlIH0gZnJvbSAnZnAtdHMvTm9uRW1wdHlBcnJheSdcbiAqIGltcG9ydCB7IHBpcGUgfSBmcm9tICdmcC10cy9mdW5jdGlvbidcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKHBpcGUoMywgcmVwbGljYXRlKCdhJykpLCBbJ2EnLCAnYScsICdhJ10pXG4gKlxuICogQGNhdGVnb3J5IGNvbnN0cnVjdG9yc1xuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIHJlcGxpY2F0ZSA9IGZ1bmN0aW9uIChhKSB7IHJldHVybiBtYWtlQnkoZnVuY3Rpb24gKCkgeyByZXR1cm4gYTsgfSk7IH07XG4vKipcbiAqIENyZWF0ZSBhIGBOb25FbXB0eUFycmF5YCBjb250YWluaW5nIGEgcmFuZ2Ugb2YgaW50ZWdlcnMsIGluY2x1ZGluZyBib3RoIGVuZHBvaW50cy5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgcmFuZ2UgfSBmcm9tICdmcC10cy9Ob25FbXB0eUFycmF5J1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwocmFuZ2UoMSwgNSksIFsxLCAyLCAzLCA0LCA1XSlcbiAqXG4gKiBAY2F0ZWdvcnkgY29uc3RydWN0b3JzXG4gKiBAc2luY2UgMi4xMS4wXG4gKi9cbmV4cG9ydCB2YXIgcmFuZ2UgPSBmdW5jdGlvbiAoc3RhcnQsIGVuZCkge1xuICAgIHJldHVybiBzdGFydCA8PSBlbmQgPyBtYWtlQnkoZnVuY3Rpb24gKGkpIHsgcmV0dXJuIHN0YXJ0ICsgaTsgfSkoZW5kIC0gc3RhcnQgKyAxKSA6IFtzdGFydF07XG59O1xuLyoqXG4gKiBSZXR1cm4gdGhlIHR1cGxlIG9mIHRoZSBgaGVhZGAgYW5kIHRoZSBgdGFpbGAuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IHVucHJlcGVuZCB9IGZyb20gJ2ZwLXRzL05vbkVtcHR5QXJyYXknXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbCh1bnByZXBlbmQoWzEsIDIsIDNdKSwgWzEsIFsyLCAzXV0pXG4gKlxuICogQHNpbmNlIDIuOS4wXG4gKi9cbmV4cG9ydCB2YXIgdW5wcmVwZW5kID0gZnVuY3Rpb24gKGFzKSB7IHJldHVybiBbaGVhZChhcyksIHRhaWwoYXMpXTsgfTtcbi8qKlxuICogUmV0dXJuIHRoZSB0dXBsZSBvZiB0aGUgYGluaXRgIGFuZCB0aGUgYGxhc3RgLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyB1bmFwcGVuZCB9IGZyb20gJ2ZwLXRzL05vbkVtcHR5QXJyYXknXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbCh1bmFwcGVuZChbMSwgMiwgMywgNF0pLCBbWzEsIDIsIDNdLCA0XSlcbiAqXG4gKiBAc2luY2UgMi45LjBcbiAqL1xuZXhwb3J0IHZhciB1bmFwcGVuZCA9IGZ1bmN0aW9uIChhcykgeyByZXR1cm4gW2luaXQoYXMpLCBsYXN0KGFzKV07IH07XG5leHBvcnQgZnVuY3Rpb24gY29uY2F0VyhzZWNvbmQpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGZpcnN0KSB7IHJldHVybiBmaXJzdC5jb25jYXQoc2Vjb25kKTsgfTtcbn1cbmV4cG9ydCBmdW5jdGlvbiBjb25jYXQoeCwgeSkge1xuICAgIHJldHVybiB5ID8geC5jb25jYXQoeSkgOiBmdW5jdGlvbiAoeSkgeyByZXR1cm4geS5jb25jYXQoeCk7IH07XG59XG4vKipcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIHJldmVyc2UgPSBmdW5jdGlvbiAoYXMpIHsgcmV0dXJuIF9fc3ByZWFkQXJyYXkoW2xhc3QoYXMpXSwgYXMuc2xpY2UoMCwgLTEpLnJldmVyc2UoKSwgdHJ1ZSk7IH07XG5leHBvcnQgZnVuY3Rpb24gZ3JvdXAoRSkge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgdmFyIGxlbiA9IGFzLmxlbmd0aDtcbiAgICAgICAgaWYgKGxlbiA9PT0gMCkge1xuICAgICAgICAgICAgcmV0dXJuIFtdO1xuICAgICAgICB9XG4gICAgICAgIHZhciBvdXQgPSBbXTtcbiAgICAgICAgdmFyIGhlYWQgPSBhc1swXTtcbiAgICAgICAgdmFyIG5lYSA9IFtoZWFkXTtcbiAgICAgICAgZm9yICh2YXIgaSA9IDE7IGkgPCBsZW47IGkrKykge1xuICAgICAgICAgICAgdmFyIGEgPSBhc1tpXTtcbiAgICAgICAgICAgIGlmIChFLmVxdWFscyhhLCBoZWFkKSkge1xuICAgICAgICAgICAgICAgIG5lYS5wdXNoKGEpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgb3V0LnB1c2gobmVhKTtcbiAgICAgICAgICAgICAgICBoZWFkID0gYTtcbiAgICAgICAgICAgICAgICBuZWEgPSBbaGVhZF07XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgb3V0LnB1c2gobmVhKTtcbiAgICAgICAgcmV0dXJuIG91dDtcbiAgICB9O1xufVxuLyoqXG4gKiBTcGxpdHMgYW4gYXJyYXkgaW50byBzdWItbm9uLWVtcHR5LWFycmF5cyBzdG9yZWQgaW4gYW4gb2JqZWN0LCBiYXNlZCBvbiB0aGUgcmVzdWx0IG9mIGNhbGxpbmcgYSBgc3RyaW5nYC1yZXR1cm5pbmdcbiAqIGZ1bmN0aW9uIG9uIGVhY2ggZWxlbWVudCwgYW5kIGdyb3VwaW5nIHRoZSByZXN1bHRzIGFjY29yZGluZyB0byB2YWx1ZXMgcmV0dXJuZWRcbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgZ3JvdXBCeSB9IGZyb20gJ2ZwLXRzL05vbkVtcHR5QXJyYXknXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChncm91cEJ5KChzOiBzdHJpbmcpID0+IFN0cmluZyhzLmxlbmd0aCkpKFsnYScsICdiJywgJ2FiJ10pLCB7XG4gKiAgICcxJzogWydhJywgJ2InXSxcbiAqICAgJzInOiBbJ2FiJ11cbiAqIH0pXG4gKlxuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgZ3JvdXBCeSA9IGZ1bmN0aW9uIChmKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykge1xuICAgICAgICB2YXIgb3V0ID0ge307XG4gICAgICAgIGZvciAodmFyIF9pID0gMCwgYXNfMSA9IGFzOyBfaSA8IGFzXzEubGVuZ3RoOyBfaSsrKSB7XG4gICAgICAgICAgICB2YXIgYSA9IGFzXzFbX2ldO1xuICAgICAgICAgICAgdmFyIGsgPSBmKGEpO1xuICAgICAgICAgICAgaWYgKF8uaGFzLmNhbGwob3V0LCBrKSkge1xuICAgICAgICAgICAgICAgIG91dFtrXS5wdXNoKGEpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgb3V0W2tdID0gW2FdO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBvdXQ7XG4gICAgfTtcbn07XG4vKipcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIHNvcnQgPSBmdW5jdGlvbiAoTykge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgcmV0dXJuIGFzLnNsaWNlKCkuc29ydChPLmNvbXBhcmUpO1xuICAgIH07XG59O1xuLyoqXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciBpbnNlcnRBdCA9IGZ1bmN0aW9uIChpLCBhKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykge1xuICAgICAgICByZXR1cm4gaSA8IDAgfHwgaSA+IGFzLmxlbmd0aCA/IF8ubm9uZSA6IF8uc29tZSh1bnNhZmVJbnNlcnRBdChpLCBhLCBhcykpO1xuICAgIH07XG59O1xuLyoqXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciB1cGRhdGVBdCA9IGZ1bmN0aW9uIChpLCBhKSB7XG4gICAgcmV0dXJuIG1vZGlmeUF0KGksIGZ1bmN0aW9uICgpIHsgcmV0dXJuIGE7IH0pO1xufTtcbi8qKlxuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgbW9kaWZ5QXQgPSBmdW5jdGlvbiAoaSwgZikge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgcmV0dXJuIGlzT3V0T2ZCb3VuZChpLCBhcykgPyBfLm5vbmUgOiBfLnNvbWUodW5zYWZlVXBkYXRlQXQoaSwgZihhc1tpXSksIGFzKSk7XG4gICAgfTtcbn07XG4vKipcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIGNvcHkgPSBmcm9tUmVhZG9ubHlOb25FbXB0eUFycmF5O1xuLyoqXG4gKiBAY2F0ZWdvcnkgY29uc3RydWN0b3JzXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciBvZiA9IGZ1bmN0aW9uIChhKSB7IHJldHVybiBbYV07IH07XG4vKipcbiAqIEBzaW5jZSAyLjUuMVxuICovXG5leHBvcnQgdmFyIHppcFdpdGggPSBmdW5jdGlvbiAoYXMsIGJzLCBmKSB7XG4gICAgdmFyIGNzID0gW2YoYXNbMF0sIGJzWzBdKV07XG4gICAgdmFyIGxlbiA9IE1hdGgubWluKGFzLmxlbmd0aCwgYnMubGVuZ3RoKTtcbiAgICBmb3IgKHZhciBpID0gMTsgaSA8IGxlbjsgaSsrKSB7XG4gICAgICAgIGNzW2ldID0gZihhc1tpXSwgYnNbaV0pO1xuICAgIH1cbiAgICByZXR1cm4gY3M7XG59O1xuZXhwb3J0IGZ1bmN0aW9uIHppcChhcywgYnMpIHtcbiAgICBpZiAoYnMgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICByZXR1cm4gZnVuY3Rpb24gKGJzKSB7IHJldHVybiB6aXAoYnMsIGFzKTsgfTtcbiAgICB9XG4gICAgcmV0dXJuIHppcFdpdGgoYXMsIGJzLCBmdW5jdGlvbiAoYSwgYikgeyByZXR1cm4gW2EsIGJdOyB9KTtcbn1cbi8qKlxuICogQHNpbmNlIDIuNS4xXG4gKi9cbmV4cG9ydCB2YXIgdW56aXAgPSBmdW5jdGlvbiAoYWJzKSB7XG4gICAgdmFyIGZhID0gW2Fic1swXVswXV07XG4gICAgdmFyIGZiID0gW2Fic1swXVsxXV07XG4gICAgZm9yICh2YXIgaSA9IDE7IGkgPCBhYnMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgZmFbaV0gPSBhYnNbaV1bMF07XG4gICAgICAgIGZiW2ldID0gYWJzW2ldWzFdO1xuICAgIH1cbiAgICByZXR1cm4gW2ZhLCBmYl07XG59O1xuLyoqXG4gKiBQcmVwZW5kIGFuIGVsZW1lbnQgdG8gZXZlcnkgbWVtYmVyIG9mIGFuIGFycmF5XG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IHByZXBlbmRBbGwgfSBmcm9tICdmcC10cy9Ob25FbXB0eUFycmF5J1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwocHJlcGVuZEFsbCg5KShbMSwgMiwgMywgNF0pLCBbOSwgMSwgOSwgMiwgOSwgMywgOSwgNF0pXG4gKlxuICogQHNpbmNlIDIuMTAuMFxuICovXG5leHBvcnQgdmFyIHByZXBlbmRBbGwgPSBmdW5jdGlvbiAobWlkZGxlKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykge1xuICAgICAgICB2YXIgb3V0ID0gW21pZGRsZSwgYXNbMF1dO1xuICAgICAgICBmb3IgKHZhciBpID0gMTsgaSA8IGFzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICBvdXQucHVzaChtaWRkbGUsIGFzW2ldKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gb3V0O1xuICAgIH07XG59O1xuLyoqXG4gKiBQbGFjZXMgYW4gZWxlbWVudCBpbiBiZXR3ZWVuIG1lbWJlcnMgb2YgYW4gYXJyYXlcbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgaW50ZXJzcGVyc2UgfSBmcm9tICdmcC10cy9Ob25FbXB0eUFycmF5J1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoaW50ZXJzcGVyc2UoOSkoWzEsIDIsIDMsIDRdKSwgWzEsIDksIDIsIDksIDMsIDksIDRdKVxuICpcbiAqIEBzaW5jZSAyLjkuMFxuICovXG5leHBvcnQgdmFyIGludGVyc3BlcnNlID0gZnVuY3Rpb24gKG1pZGRsZSkge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgdmFyIHJlc3QgPSB0YWlsKGFzKTtcbiAgICAgICAgcmV0dXJuIGlzTm9uRW1wdHkocmVzdCkgPyBwaXBlKHJlc3QsIHByZXBlbmRBbGwobWlkZGxlKSwgcHJlcGVuZChoZWFkKGFzKSkpIDogY29weShhcyk7XG4gICAgfTtcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBmb2xkaW5nXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciBmb2xkTWFwV2l0aEluZGV4ID0gUk5FQS5mb2xkTWFwV2l0aEluZGV4O1xuLyoqXG4gKiBAY2F0ZWdvcnkgZm9sZGluZ1xuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgZm9sZE1hcCA9IFJORUEuZm9sZE1hcDtcbi8qKlxuICogQGNhdGVnb3J5IHNlcXVlbmNpbmdcbiAqIEBzaW5jZSAyLjEwLjBcbiAqL1xuZXhwb3J0IHZhciBjaGFpbldpdGhJbmRleCA9IGZ1bmN0aW9uIChmKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykge1xuICAgICAgICB2YXIgb3V0ID0gZnJvbVJlYWRvbmx5Tm9uRW1wdHlBcnJheShmKDAsIGhlYWQoYXMpKSk7XG4gICAgICAgIGZvciAodmFyIGkgPSAxOyBpIDwgYXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIG91dC5wdXNoLmFwcGx5KG91dCwgZihpLCBhc1tpXSkpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBvdXQ7XG4gICAgfTtcbn07XG4vKipcbiAqIEBzaW5jZSAyLjEwLjBcbiAqL1xuZXhwb3J0IHZhciBjaG9wID0gZnVuY3Rpb24gKGYpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIHZhciBfYSA9IGYoYXMpLCBiID0gX2FbMF0sIHJlc3QgPSBfYVsxXTtcbiAgICAgICAgdmFyIG91dCA9IFtiXTtcbiAgICAgICAgdmFyIG5leHQgPSByZXN0O1xuICAgICAgICB3aGlsZSAoaXNOb25FbXB0eShuZXh0KSkge1xuICAgICAgICAgICAgdmFyIF9iID0gZihuZXh0KSwgYl8xID0gX2JbMF0sIHJlc3RfMiA9IF9iWzFdO1xuICAgICAgICAgICAgb3V0LnB1c2goYl8xKTtcbiAgICAgICAgICAgIG5leHQgPSByZXN0XzI7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG91dDtcbiAgICB9O1xufTtcbi8qKlxuICogU3BsaXRzIGEgYE5vbkVtcHR5QXJyYXlgIGludG8gdHdvIHBpZWNlcywgdGhlIGZpcnN0IHBpZWNlIGhhcyBtYXggYG5gIGVsZW1lbnRzLlxuICpcbiAqIEBzaW5jZSAyLjEwLjBcbiAqL1xuZXhwb3J0IHZhciBzcGxpdEF0ID0gZnVuY3Rpb24gKG4pIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIHZhciBtID0gTWF0aC5tYXgoMSwgbik7XG4gICAgICAgIHJldHVybiBtID49IGFzLmxlbmd0aCA/IFtjb3B5KGFzKSwgW11dIDogW3BpcGUoYXMuc2xpY2UoMSwgbSksIHByZXBlbmQoaGVhZChhcykpKSwgYXMuc2xpY2UobSldO1xuICAgIH07XG59O1xuLyoqXG4gKiBAc2luY2UgMi4xMC4wXG4gKi9cbmV4cG9ydCB2YXIgY2h1bmtzT2YgPSBmdW5jdGlvbiAobikgeyByZXR1cm4gY2hvcChzcGxpdEF0KG4pKTsgfTtcbi8qIGlzdGFuYnVsIGlnbm9yZSBuZXh0ICovXG52YXIgX21hcCA9IGZ1bmN0aW9uIChmYSwgZikgeyByZXR1cm4gcGlwZShmYSwgbWFwKGYpKTsgfTtcbi8qIGlzdGFuYnVsIGlnbm9yZSBuZXh0ICovXG52YXIgX21hcFdpdGhJbmRleCA9IGZ1bmN0aW9uIChmYSwgZikgeyByZXR1cm4gcGlwZShmYSwgbWFwV2l0aEluZGV4KGYpKTsgfTtcbi8qIGlzdGFuYnVsIGlnbm9yZSBuZXh0ICovXG52YXIgX2FwID0gZnVuY3Rpb24gKGZhYiwgZmEpIHsgcmV0dXJuIHBpcGUoZmFiLCBhcChmYSkpOyB9O1xuLyogaXN0YW5idWwgaWdub3JlIG5leHQgKi9cbnZhciBfZXh0ZW5kID0gZnVuY3Rpb24gKHdhLCBmKSB7IHJldHVybiBwaXBlKHdhLCBleHRlbmQoZikpOyB9O1xuLyogaXN0YW5idWwgaWdub3JlIG5leHQgKi9cbnZhciBfcmVkdWNlID0gZnVuY3Rpb24gKGZhLCBiLCBmKSB7IHJldHVybiBwaXBlKGZhLCByZWR1Y2UoYiwgZikpOyB9O1xuLyogaXN0YW5idWwgaWdub3JlIG5leHQgKi9cbnZhciBfZm9sZE1hcCA9IGZ1bmN0aW9uIChNKSB7XG4gICAgdmFyIGZvbGRNYXBNID0gZm9sZE1hcChNKTtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGZhLCBmKSB7IHJldHVybiBwaXBlKGZhLCBmb2xkTWFwTShmKSk7IH07XG59O1xuLyogaXN0YW5idWwgaWdub3JlIG5leHQgKi9cbnZhciBfcmVkdWNlUmlnaHQgPSBmdW5jdGlvbiAoZmEsIGIsIGYpIHsgcmV0dXJuIHBpcGUoZmEsIHJlZHVjZVJpZ2h0KGIsIGYpKTsgfTtcbi8qIGlzdGFuYnVsIGlnbm9yZSBuZXh0ICovXG52YXIgX3RyYXZlcnNlID0gZnVuY3Rpb24gKEYpIHtcbiAgICB2YXIgdHJhdmVyc2VGID0gdHJhdmVyc2UoRik7XG4gICAgcmV0dXJuIGZ1bmN0aW9uICh0YSwgZikgeyByZXR1cm4gcGlwZSh0YSwgdHJhdmVyc2VGKGYpKTsgfTtcbn07XG4vKiBpc3RhbmJ1bCBpZ25vcmUgbmV4dCAqL1xudmFyIF9hbHQgPSBmdW5jdGlvbiAoZmEsIHRoYXQpIHsgcmV0dXJuIHBpcGUoZmEsIGFsdCh0aGF0KSk7IH07XG4vKiBpc3RhbmJ1bCBpZ25vcmUgbmV4dCAqL1xudmFyIF9yZWR1Y2VXaXRoSW5kZXggPSBmdW5jdGlvbiAoZmEsIGIsIGYpIHtcbiAgICByZXR1cm4gcGlwZShmYSwgcmVkdWNlV2l0aEluZGV4KGIsIGYpKTtcbn07XG4vKiBpc3RhbmJ1bCBpZ25vcmUgbmV4dCAqL1xudmFyIF9mb2xkTWFwV2l0aEluZGV4ID0gZnVuY3Rpb24gKE0pIHtcbiAgICB2YXIgZm9sZE1hcFdpdGhJbmRleE0gPSBmb2xkTWFwV2l0aEluZGV4KE0pO1xuICAgIHJldHVybiBmdW5jdGlvbiAoZmEsIGYpIHsgcmV0dXJuIHBpcGUoZmEsIGZvbGRNYXBXaXRoSW5kZXhNKGYpKTsgfTtcbn07XG4vKiBpc3RhbmJ1bCBpZ25vcmUgbmV4dCAqL1xudmFyIF9yZWR1Y2VSaWdodFdpdGhJbmRleCA9IGZ1bmN0aW9uIChmYSwgYiwgZikge1xuICAgIHJldHVybiBwaXBlKGZhLCByZWR1Y2VSaWdodFdpdGhJbmRleChiLCBmKSk7XG59O1xuLyogaXN0YW5idWwgaWdub3JlIG5leHQgKi9cbnZhciBfdHJhdmVyc2VXaXRoSW5kZXggPSBmdW5jdGlvbiAoRikge1xuICAgIHZhciB0cmF2ZXJzZVdpdGhJbmRleEYgPSB0cmF2ZXJzZVdpdGhJbmRleChGKTtcbiAgICByZXR1cm4gZnVuY3Rpb24gKHRhLCBmKSB7IHJldHVybiBwaXBlKHRhLCB0cmF2ZXJzZVdpdGhJbmRleEYoZikpOyB9O1xufTtcbi8qKlxuICogTGVzcyBzdHJpY3QgdmVyc2lvbiBvZiBbYGFsdGBdKCNhbHQpLlxuICpcbiAqIFRoZSBgV2Agc3VmZml4IChzaG9ydCBmb3IgKipXKippZGVuaW5nKSBtZWFucyB0aGF0IHRoZSByZXR1cm4gdHlwZXMgd2lsbCBiZSBtZXJnZWQuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCAqIGFzIE5FQSBmcm9tICdmcC10cy9Ob25FbXB0eUFycmF5J1xuICogaW1wb3J0IHsgcGlwZSB9IGZyb20gJ2ZwLXRzL2Z1bmN0aW9uJ1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoXG4gKiAgIHBpcGUoXG4gKiAgICAgWzEsIDIsIDNdIGFzIE5FQS5Ob25FbXB0eUFycmF5PG51bWJlcj4sXG4gKiAgICAgTkVBLmFsdFcoKCkgPT4gWydhJywgJ2InXSlcbiAqICAgKSxcbiAqICAgWzEsIDIsIDMsICdhJywgJ2InXVxuICogKVxuICpcbiAqIEBjYXRlZ29yeSBlcnJvciBoYW5kbGluZ1xuICogQHNpbmNlIDIuOS4wXG4gKi9cbmV4cG9ydCB2YXIgYWx0VyA9IGZ1bmN0aW9uICh0aGF0KSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykge1xuICAgICAgICByZXR1cm4gcGlwZShhcywgY29uY2F0Vyh0aGF0KCkpKTtcbiAgICB9O1xufTtcbi8qKlxuICogSWRlbnRpZmllcyBhbiBhc3NvY2lhdGl2ZSBvcGVyYXRpb24gb24gYSB0eXBlIGNvbnN0cnVjdG9yLiBJdCBpcyBzaW1pbGFyIHRvIGBTZW1pZ3JvdXBgLCBleGNlcHQgdGhhdCBpdCBhcHBsaWVzIHRvXG4gKiB0eXBlcyBvZiBraW5kIGAqIC0+ICpgLlxuICpcbiAqIEluIGNhc2Ugb2YgYE5vbkVtcHR5QXJyYXlgIGNvbmNhdGVuYXRlcyB0aGUgaW5wdXRzIGludG8gYSBzaW5nbGUgYXJyYXkuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCAqIGFzIE5FQSBmcm9tICdmcC10cy9Ob25FbXB0eUFycmF5J1xuICogaW1wb3J0IHsgcGlwZSB9IGZyb20gJ2ZwLXRzL2Z1bmN0aW9uJ1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoXG4gKiAgIHBpcGUoXG4gKiAgICAgWzEsIDIsIDNdLFxuICogICAgIE5FQS5hbHQoKCkgPT4gWzQsIDVdKVxuICogICApLFxuICogICBbMSwgMiwgMywgNCwgNV1cbiAqIClcbiAqXG4gKiBAY2F0ZWdvcnkgZXJyb3IgaGFuZGxpbmdcbiAqIEBzaW5jZSAyLjYuMlxuICovXG5leHBvcnQgdmFyIGFsdCA9IGFsdFc7XG4vKipcbiAqIEFwcGx5IGEgZnVuY3Rpb24gdG8gYW4gYXJndW1lbnQgdW5kZXIgYSB0eXBlIGNvbnN0cnVjdG9yLlxuICpcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIGFwID0gZnVuY3Rpb24gKGFzKSB7XG4gICAgcmV0dXJuIGZsYXRNYXAoZnVuY3Rpb24gKGYpIHsgcmV0dXJuIHBpcGUoYXMsIG1hcChmKSk7IH0pO1xufTtcbi8qKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCAqIGFzIE5FQSBmcm9tICdmcC10cy9Ob25FbXB0eUFycmF5J1xuICogaW1wb3J0IHsgcGlwZSB9IGZyb20gJ2ZwLXRzL2Z1bmN0aW9uJ1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoXG4gKiAgIHBpcGUoXG4gKiAgICAgWzEsIDIsIDNdLFxuICogICAgIE5FQS5mbGF0TWFwKChuKSA9PiBbYGEke259YCwgYGIke259YF0pXG4gKiAgICksXG4gKiAgIFsnYTEnLCAnYjEnLCAnYTInLCAnYjInLCAnYTMnLCAnYjMnXVxuICogKVxuICpcbiAqIEBjYXRlZ29yeSBzZXF1ZW5jaW5nXG4gKiBAc2luY2UgMi4xNC4wXG4gKi9cbmV4cG9ydCB2YXIgZmxhdE1hcCA9IC8qI19fUFVSRV9fKi8gZHVhbCgyLCBmdW5jdGlvbiAobWEsIGYpIHtcbiAgICByZXR1cm4gcGlwZShtYSwgY2hhaW5XaXRoSW5kZXgoZnVuY3Rpb24gKGksIGEpIHsgcmV0dXJuIGYoYSwgaSk7IH0pKTtcbn0pO1xuLyoqXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciBleHRlbmQgPSBmdW5jdGlvbiAoZikge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgdmFyIG5leHQgPSB0YWlsKGFzKTtcbiAgICAgICAgdmFyIG91dCA9IFtmKGFzKV07XG4gICAgICAgIHdoaWxlIChpc05vbkVtcHR5KG5leHQpKSB7XG4gICAgICAgICAgICBvdXQucHVzaChmKG5leHQpKTtcbiAgICAgICAgICAgIG5leHQgPSB0YWlsKG5leHQpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBvdXQ7XG4gICAgfTtcbn07XG4vKipcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIGR1cGxpY2F0ZSA9IC8qI19fUFVSRV9fKi8gZXh0ZW5kKGlkZW50aXR5KTtcbi8qKlxuICogQGNhdGVnb3J5IHNlcXVlbmNpbmdcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIGZsYXR0ZW4gPSAvKiNfX1BVUkVfXyovIGZsYXRNYXAoaWRlbnRpdHkpO1xuLyoqXG4gKiBgbWFwYCBjYW4gYmUgdXNlZCB0byB0dXJuIGZ1bmN0aW9ucyBgKGE6IEEpID0+IEJgIGludG8gZnVuY3Rpb25zIGAoZmE6IEY8QT4pID0+IEY8Qj5gIHdob3NlIGFyZ3VtZW50IGFuZCByZXR1cm4gdHlwZXNcbiAqIHVzZSB0aGUgdHlwZSBjb25zdHJ1Y3RvciBgRmAgdG8gcmVwcmVzZW50IHNvbWUgY29tcHV0YXRpb25hbCBjb250ZXh0LlxuICpcbiAqIEBjYXRlZ29yeSBtYXBwaW5nXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciBtYXAgPSBmdW5jdGlvbiAoZikgeyByZXR1cm4gbWFwV2l0aEluZGV4KGZ1bmN0aW9uIChfLCBhKSB7IHJldHVybiBmKGEpOyB9KTsgfTtcbi8qKlxuICogQGNhdGVnb3J5IG1hcHBpbmdcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIG1hcFdpdGhJbmRleCA9IGZ1bmN0aW9uIChmKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykge1xuICAgICAgICB2YXIgb3V0ID0gW2YoMCwgaGVhZChhcykpXTtcbiAgICAgICAgZm9yICh2YXIgaSA9IDE7IGkgPCBhcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgb3V0LnB1c2goZihpLCBhc1tpXSkpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBvdXQ7XG4gICAgfTtcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBmb2xkaW5nXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciByZWR1Y2UgPSBSTkVBLnJlZHVjZTtcbi8qKlxuICogQGNhdGVnb3J5IGZvbGRpbmdcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIHJlZHVjZVdpdGhJbmRleCA9IFJORUEucmVkdWNlV2l0aEluZGV4O1xuLyoqXG4gKiBAY2F0ZWdvcnkgZm9sZGluZ1xuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgcmVkdWNlUmlnaHQgPSBSTkVBLnJlZHVjZVJpZ2h0O1xuLyoqXG4gKiBAY2F0ZWdvcnkgZm9sZGluZ1xuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgcmVkdWNlUmlnaHRXaXRoSW5kZXggPSBSTkVBLnJlZHVjZVJpZ2h0V2l0aEluZGV4O1xuLyoqXG4gKiBAY2F0ZWdvcnkgdHJhdmVyc2luZ1xuICogQHNpbmNlIDIuNi4zXG4gKi9cbmV4cG9ydCB2YXIgdHJhdmVyc2UgPSBmdW5jdGlvbiAoRikge1xuICAgIHZhciB0cmF2ZXJzZVdpdGhJbmRleEYgPSB0cmF2ZXJzZVdpdGhJbmRleChGKTtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGYpIHsgcmV0dXJuIHRyYXZlcnNlV2l0aEluZGV4RihmdW5jdGlvbiAoXywgYSkgeyByZXR1cm4gZihhKTsgfSk7IH07XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgdHJhdmVyc2luZ1xuICogQHNpbmNlIDIuNi4zXG4gKi9cbmV4cG9ydCB2YXIgc2VxdWVuY2UgPSBmdW5jdGlvbiAoRikgeyByZXR1cm4gdHJhdmVyc2VXaXRoSW5kZXgoRikoZnVuY3Rpb24gKF8sIGEpIHsgcmV0dXJuIGE7IH0pOyB9O1xuLyoqXG4gKiBAY2F0ZWdvcnkgc2VxdWVuY2luZ1xuICogQHNpbmNlIDIuNi4zXG4gKi9cbmV4cG9ydCB2YXIgdHJhdmVyc2VXaXRoSW5kZXggPSBmdW5jdGlvbiAoRikge1xuICAgIHJldHVybiBmdW5jdGlvbiAoZikge1xuICAgICAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgICAgICB2YXIgb3V0ID0gRi5tYXAoZigwLCBoZWFkKGFzKSksIG9mKTtcbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAxOyBpIDwgYXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICBvdXQgPSBGLmFwKEYubWFwKG91dCwgZnVuY3Rpb24gKGJzKSB7IHJldHVybiBmdW5jdGlvbiAoYikgeyByZXR1cm4gcGlwZShicywgYXBwZW5kKGIpKTsgfTsgfSksIGYoaSwgYXNbaV0pKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBvdXQ7XG4gICAgICAgIH07XG4gICAgfTtcbn07XG4vKipcbiAqIEBzaW5jZSAyLjcuMFxuICovXG5leHBvcnQgdmFyIGV4dHJhY3QgPSBSTkVBLmhlYWQ7XG4vKipcbiAqIEBjYXRlZ29yeSB0eXBlIGxhbWJkYXNcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIFVSSSA9ICdOb25FbXB0eUFycmF5Jztcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgZ2V0U2hvdyA9IFJORUEuZ2V0U2hvdztcbi8qKlxuICogQnVpbGRzIGEgYFNlbWlncm91cGAgaW5zdGFuY2UgZm9yIGBOb25FbXB0eUFycmF5YFxuICpcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIGdldFNlbWlncm91cCA9IGZ1bmN0aW9uICgpIHsgcmV0dXJuICh7XG4gICAgY29uY2F0OiBjb25jYXRcbn0pOyB9O1xuLyoqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgZ2V0RXEgfSBmcm9tICdmcC10cy9Ob25FbXB0eUFycmF5J1xuICogaW1wb3J0ICogYXMgTiBmcm9tICdmcC10cy9udW1iZXInXG4gKlxuICogY29uc3QgRSA9IGdldEVxKE4uRXEpXG4gKiBhc3NlcnQuc3RyaWN0RXF1YWwoRS5lcXVhbHMoWzEsIDJdLCBbMSwgMl0pLCB0cnVlKVxuICogYXNzZXJ0LnN0cmljdEVxdWFsKEUuZXF1YWxzKFsxLCAyXSwgWzEsIDNdKSwgZmFsc2UpXG4gKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgZ2V0RXEgPSBSTkVBLmdldEVxO1xuLyoqXG4gKiBAc2luY2UgMi4xMS4wXG4gKi9cbmV4cG9ydCB2YXIgZ2V0VW5pb25TZW1pZ3JvdXAgPSBmdW5jdGlvbiAoRSkge1xuICAgIHZhciB1bmlvbkUgPSB1bmlvbihFKTtcbiAgICByZXR1cm4ge1xuICAgICAgICBjb25jYXQ6IGZ1bmN0aW9uIChmaXJzdCwgc2Vjb25kKSB7IHJldHVybiB1bmlvbkUoc2Vjb25kKShmaXJzdCk7IH1cbiAgICB9O1xufTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuNy4wXG4gKi9cbmV4cG9ydCB2YXIgRnVuY3RvciA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICBtYXA6IF9tYXBcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBtYXBwaW5nXG4gKiBAc2luY2UgMi4xMC4wXG4gKi9cbmV4cG9ydCB2YXIgZmxhcCA9IC8qI19fUFVSRV9fKi8gZmxhcF8oRnVuY3Rvcik7XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjEwLjBcbiAqL1xuZXhwb3J0IHZhciBQb2ludGVkID0ge1xuICAgIFVSSTogVVJJLFxuICAgIG9mOiBvZlxufTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuNy4wXG4gKi9cbmV4cG9ydCB2YXIgRnVuY3RvcldpdGhJbmRleCA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICBtYXA6IF9tYXAsXG4gICAgbWFwV2l0aEluZGV4OiBfbWFwV2l0aEluZGV4XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi4xMC4wXG4gKi9cbmV4cG9ydCB2YXIgQXBwbHkgPSB7XG4gICAgVVJJOiBVUkksXG4gICAgbWFwOiBfbWFwLFxuICAgIGFwOiBfYXBcbn07XG4vKipcbiAqIENvbWJpbmUgdHdvIGVmZmVjdGZ1bCBhY3Rpb25zLCBrZWVwaW5nIG9ubHkgdGhlIHJlc3VsdCBvZiB0aGUgZmlyc3QuXG4gKlxuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgYXBGaXJzdCA9IC8qI19fUFVSRV9fKi8gYXBGaXJzdF8oQXBwbHkpO1xuLyoqXG4gKiBDb21iaW5lIHR3byBlZmZlY3RmdWwgYWN0aW9ucywga2VlcGluZyBvbmx5IHRoZSByZXN1bHQgb2YgdGhlIHNlY29uZC5cbiAqXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBhcFNlY29uZCA9IC8qI19fUFVSRV9fKi8gYXBTZWNvbmRfKEFwcGx5KTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuNy4wXG4gKi9cbmV4cG9ydCB2YXIgQXBwbGljYXRpdmUgPSB7XG4gICAgVVJJOiBVUkksXG4gICAgbWFwOiBfbWFwLFxuICAgIGFwOiBfYXAsXG4gICAgb2Y6IG9mXG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi4xMC4wXG4gKi9cbmV4cG9ydCB2YXIgQ2hhaW4gPSB7XG4gICAgVVJJOiBVUkksXG4gICAgbWFwOiBfbWFwLFxuICAgIGFwOiBfYXAsXG4gICAgY2hhaW46IGZsYXRNYXBcbn07XG4vKipcbiAqIENvbXBvc2VzIGNvbXB1dGF0aW9ucyBpbiBzZXF1ZW5jZSwgdXNpbmcgdGhlIHJldHVybiB2YWx1ZSBvZiBvbmUgY29tcHV0YXRpb24gdG8gZGV0ZXJtaW5lIHRoZSBuZXh0IGNvbXB1dGF0aW9uIGFuZFxuICoga2VlcGluZyBvbmx5IHRoZSByZXN1bHQgb2YgdGhlIGZpcnN0LlxuICpcbiAqIEBjYXRlZ29yeSBzZXF1ZW5jaW5nXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBjaGFpbkZpcnN0ID0gXG4vKiNfX1BVUkVfXyovIGNoYWluRmlyc3RfKENoYWluKTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuNy4wXG4gKi9cbmV4cG9ydCB2YXIgTW9uYWQgPSB7XG4gICAgVVJJOiBVUkksXG4gICAgbWFwOiBfbWFwLFxuICAgIGFwOiBfYXAsXG4gICAgb2Y6IG9mLFxuICAgIGNoYWluOiBmbGF0TWFwXG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi43LjBcbiAqL1xuZXhwb3J0IHZhciBGb2xkYWJsZSA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICByZWR1Y2U6IF9yZWR1Y2UsXG4gICAgZm9sZE1hcDogX2ZvbGRNYXAsXG4gICAgcmVkdWNlUmlnaHQ6IF9yZWR1Y2VSaWdodFxufTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuNy4wXG4gKi9cbmV4cG9ydCB2YXIgRm9sZGFibGVXaXRoSW5kZXggPSB7XG4gICAgVVJJOiBVUkksXG4gICAgcmVkdWNlOiBfcmVkdWNlLFxuICAgIGZvbGRNYXA6IF9mb2xkTWFwLFxuICAgIHJlZHVjZVJpZ2h0OiBfcmVkdWNlUmlnaHQsXG4gICAgcmVkdWNlV2l0aEluZGV4OiBfcmVkdWNlV2l0aEluZGV4LFxuICAgIGZvbGRNYXBXaXRoSW5kZXg6IF9mb2xkTWFwV2l0aEluZGV4LFxuICAgIHJlZHVjZVJpZ2h0V2l0aEluZGV4OiBfcmVkdWNlUmlnaHRXaXRoSW5kZXhcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjcuMFxuICovXG5leHBvcnQgdmFyIFRyYXZlcnNhYmxlID0ge1xuICAgIFVSSTogVVJJLFxuICAgIG1hcDogX21hcCxcbiAgICByZWR1Y2U6IF9yZWR1Y2UsXG4gICAgZm9sZE1hcDogX2ZvbGRNYXAsXG4gICAgcmVkdWNlUmlnaHQ6IF9yZWR1Y2VSaWdodCxcbiAgICB0cmF2ZXJzZTogX3RyYXZlcnNlLFxuICAgIHNlcXVlbmNlOiBzZXF1ZW5jZVxufTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuNy4wXG4gKi9cbmV4cG9ydCB2YXIgVHJhdmVyc2FibGVXaXRoSW5kZXggPSB7XG4gICAgVVJJOiBVUkksXG4gICAgbWFwOiBfbWFwLFxuICAgIG1hcFdpdGhJbmRleDogX21hcFdpdGhJbmRleCxcbiAgICByZWR1Y2U6IF9yZWR1Y2UsXG4gICAgZm9sZE1hcDogX2ZvbGRNYXAsXG4gICAgcmVkdWNlUmlnaHQ6IF9yZWR1Y2VSaWdodCxcbiAgICB0cmF2ZXJzZTogX3RyYXZlcnNlLFxuICAgIHNlcXVlbmNlOiBzZXF1ZW5jZSxcbiAgICByZWR1Y2VXaXRoSW5kZXg6IF9yZWR1Y2VXaXRoSW5kZXgsXG4gICAgZm9sZE1hcFdpdGhJbmRleDogX2ZvbGRNYXBXaXRoSW5kZXgsXG4gICAgcmVkdWNlUmlnaHRXaXRoSW5kZXg6IF9yZWR1Y2VSaWdodFdpdGhJbmRleCxcbiAgICB0cmF2ZXJzZVdpdGhJbmRleDogX3RyYXZlcnNlV2l0aEluZGV4XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi43LjBcbiAqL1xuZXhwb3J0IHZhciBBbHQgPSB7XG4gICAgVVJJOiBVUkksXG4gICAgbWFwOiBfbWFwLFxuICAgIGFsdDogX2FsdFxufTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuNy4wXG4gKi9cbmV4cG9ydCB2YXIgQ29tb25hZCA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICBtYXA6IF9tYXAsXG4gICAgZXh0ZW5kOiBfZXh0ZW5kLFxuICAgIGV4dHJhY3Q6IGV4dHJhY3Rcbn07XG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vLyBkbyBub3RhdGlvblxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLyoqXG4gKiBAY2F0ZWdvcnkgZG8gbm90YXRpb25cbiAqIEBzaW5jZSAyLjkuMFxuICovXG5leHBvcnQgdmFyIERvID0gLyojX19QVVJFX18qLyBvZihfLmVtcHR5UmVjb3JkKTtcbi8qKlxuICogQGNhdGVnb3J5IGRvIG5vdGF0aW9uXG4gKiBAc2luY2UgMi44LjBcbiAqL1xuZXhwb3J0IHZhciBiaW5kVG8gPSAvKiNfX1BVUkVfXyovIGJpbmRUb18oRnVuY3Rvcik7XG52YXIgbGV0XyA9IC8qI19fUFVSRV9fKi8gbGV0X18oRnVuY3Rvcik7XG5leHBvcnQgeyBcbi8qKlxuICogQGNhdGVnb3J5IGRvIG5vdGF0aW9uXG4gKiBAc2luY2UgMi4xMy4wXG4gKi9cbmxldF8gYXMgbGV0IH07XG4vKipcbiAqIEBjYXRlZ29yeSBkbyBub3RhdGlvblxuICogQHNpbmNlIDIuOC4wXG4gKi9cbmV4cG9ydCB2YXIgYmluZCA9IC8qI19fUFVSRV9fKi8gYmluZF8oQ2hhaW4pO1xuLyoqXG4gKiBAY2F0ZWdvcnkgZG8gbm90YXRpb25cbiAqIEBzaW5jZSAyLjguMFxuICovXG5leHBvcnQgdmFyIGFwUyA9IC8qI19fUFVSRV9fKi8gYXBTXyhBcHBseSk7XG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vLyB1dGlsc1xuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLyoqXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciBoZWFkID0gUk5FQS5oZWFkO1xuLyoqXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciB0YWlsID0gZnVuY3Rpb24gKGFzKSB7IHJldHVybiBhcy5zbGljZSgxKTsgfTtcbi8qKlxuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgbGFzdCA9IFJORUEubGFzdDtcbi8qKlxuICogR2V0IGFsbCBidXQgdGhlIGxhc3QgZWxlbWVudCBvZiBhIG5vbiBlbXB0eSBhcnJheSwgY3JlYXRpbmcgYSBuZXcgYXJyYXkuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IGluaXQgfSBmcm9tICdmcC10cy9Ob25FbXB0eUFycmF5J1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoaW5pdChbMSwgMiwgM10pLCBbMSwgMl0pXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKGluaXQoWzFdKSwgW10pXG4gKlxuICogQHNpbmNlIDIuMi4wXG4gKi9cbmV4cG9ydCB2YXIgaW5pdCA9IGZ1bmN0aW9uIChhcykgeyByZXR1cm4gYXMuc2xpY2UoMCwgLTEpOyB9O1xuLyoqXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciBtaW4gPSBSTkVBLm1pbjtcbi8qKlxuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgbWF4ID0gUk5FQS5tYXg7XG4vKipcbiAqIEBzaW5jZSAyLjEwLjBcbiAqL1xuZXhwb3J0IHZhciBjb25jYXRBbGwgPSBmdW5jdGlvbiAoUykge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgcmV0dXJuIGFzLnJlZHVjZShTLmNvbmNhdCk7XG4gICAgfTtcbn07XG4vKipcbiAqIEJyZWFrIGFuIGBBcnJheWAgaW50byBpdHMgZmlyc3QgZWxlbWVudCBhbmQgcmVtYWluaW5nIGVsZW1lbnRzLlxuICpcbiAqIEBjYXRlZ29yeSBwYXR0ZXJuIG1hdGNoaW5nXG4gKiBAc2luY2UgMi4xMS4wXG4gKi9cbmV4cG9ydCB2YXIgbWF0Y2hMZWZ0ID0gZnVuY3Rpb24gKGYpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIHJldHVybiBmKGhlYWQoYXMpLCB0YWlsKGFzKSk7XG4gICAgfTtcbn07XG4vKipcbiAqIEJyZWFrIGFuIGBBcnJheWAgaW50byBpdHMgaW5pdGlhbCBlbGVtZW50cyBhbmQgdGhlIGxhc3QgZWxlbWVudC5cbiAqXG4gKiBAY2F0ZWdvcnkgcGF0dGVybiBtYXRjaGluZ1xuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIG1hdGNoUmlnaHQgPSBmdW5jdGlvbiAoZikge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgcmV0dXJuIGYoaW5pdChhcyksIGxhc3QoYXMpKTtcbiAgICB9O1xufTtcbi8qKlxuICogQXBwbHkgYSBmdW5jdGlvbiB0byB0aGUgaGVhZCwgY3JlYXRpbmcgYSBuZXcgYE5vbkVtcHR5QXJyYXlgLlxuICpcbiAqIEBzaW5jZSAyLjExLjBcbiAqL1xuZXhwb3J0IHZhciBtb2RpZnlIZWFkID0gZnVuY3Rpb24gKGYpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIHJldHVybiBfX3NwcmVhZEFycmF5KFtmKGhlYWQoYXMpKV0sIHRhaWwoYXMpLCB0cnVlKTtcbiAgICB9O1xufTtcbi8qKlxuICogQ2hhbmdlIHRoZSBoZWFkLCBjcmVhdGluZyBhIG5ldyBgTm9uRW1wdHlBcnJheWAuXG4gKlxuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIHVwZGF0ZUhlYWQgPSBmdW5jdGlvbiAoYSkgeyByZXR1cm4gbW9kaWZ5SGVhZChmdW5jdGlvbiAoKSB7IHJldHVybiBhOyB9KTsgfTtcbi8qKlxuICogQXBwbHkgYSBmdW5jdGlvbiB0byB0aGUgbGFzdCBlbGVtZW50LCBjcmVhdGluZyBhIG5ldyBgTm9uRW1wdHlBcnJheWAuXG4gKlxuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIG1vZGlmeUxhc3QgPSBmdW5jdGlvbiAoZikge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgcmV0dXJuIHBpcGUoaW5pdChhcyksIGFwcGVuZChmKGxhc3QoYXMpKSkpO1xuICAgIH07XG59O1xuLyoqXG4gKiBDaGFuZ2UgdGhlIGxhc3QgZWxlbWVudCwgY3JlYXRpbmcgYSBuZXcgYE5vbkVtcHR5QXJyYXlgLlxuICpcbiAqIEBzaW5jZSAyLjExLjBcbiAqL1xuZXhwb3J0IHZhciB1cGRhdGVMYXN0ID0gZnVuY3Rpb24gKGEpIHsgcmV0dXJuIG1vZGlmeUxhc3QoZnVuY3Rpb24gKCkgeyByZXR1cm4gYTsgfSk7IH07XG4vKipcbiAqIFBsYWNlcyBhbiBlbGVtZW50IGluIGJldHdlZW4gbWVtYmVycyBvZiBhIGBOb25FbXB0eUFycmF5YCwgdGhlbiBmb2xkcyB0aGUgcmVzdWx0cyB1c2luZyB0aGUgcHJvdmlkZWQgYFNlbWlncm91cGAuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCAqIGFzIFMgZnJvbSAnZnAtdHMvc3RyaW5nJ1xuICogaW1wb3J0IHsgaW50ZXJjYWxhdGUgfSBmcm9tICdmcC10cy9Ob25FbXB0eUFycmF5J1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoaW50ZXJjYWxhdGUoUy5TZW1pZ3JvdXApKCctJykoWydhJywgJ2InLCAnYyddKSwgJ2EtYi1jJylcbiAqXG4gKiBAc2luY2UgMi4xMi4wXG4gKi9cbmV4cG9ydCB2YXIgaW50ZXJjYWxhdGUgPSBSTkVBLmludGVyY2FsYXRlO1xuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLy8gbGVnYWN5XG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vKipcbiAqIEFsaWFzIG9mIGBmbGF0TWFwYC5cbiAqXG4gKiBAY2F0ZWdvcnkgbGVnYWN5XG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciBjaGFpbiA9IGZsYXRNYXA7XG5leHBvcnQgZnVuY3Rpb24gZ3JvdXBTb3J0KE8pIHtcbiAgICB2YXIgc29ydE8gPSBzb3J0KE8pO1xuICAgIHZhciBncm91cE8gPSBncm91cChPKTtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7IHJldHVybiAoaXNOb25FbXB0eShhcykgPyBncm91cE8oc29ydE8oYXMpKSA6IFtdKTsgfTtcbn1cbmV4cG9ydCBmdW5jdGlvbiBmaWx0ZXIocHJlZGljYXRlKSB7XG4gICAgcmV0dXJuIGZpbHRlcldpdGhJbmRleChmdW5jdGlvbiAoXywgYSkgeyByZXR1cm4gcHJlZGljYXRlKGEpOyB9KTtcbn1cbi8qKlxuICogVXNlIFtgZmlsdGVyV2l0aEluZGV4YF0oLi9BcnJheS50cy5odG1sI2ZpbHRlcndpdGhpbmRleCkgaW5zdGVhZC5cbiAqXG4gKiBAY2F0ZWdvcnkgem9uZSBvZiBkZWF0aFxuICogQHNpbmNlIDIuMC4wXG4gKiBAZGVwcmVjYXRlZFxuICovXG5leHBvcnQgdmFyIGZpbHRlcldpdGhJbmRleCA9IGZ1bmN0aW9uIChwcmVkaWNhdGUpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIHJldHVybiBmcm9tQXJyYXkoYXMuZmlsdGVyKGZ1bmN0aW9uIChhLCBpKSB7IHJldHVybiBwcmVkaWNhdGUoaSwgYSk7IH0pKTtcbiAgICB9O1xufTtcbi8qKlxuICogVXNlIFtgdW5wcmVwZW5kYF0oI3VucHJlcGVuZCkgaW5zdGVhZC5cbiAqXG4gKiBAY2F0ZWdvcnkgem9uZSBvZiBkZWF0aFxuICogQHNpbmNlIDIuOS4wXG4gKiBAZGVwcmVjYXRlZFxuICovXG5leHBvcnQgdmFyIHVuY29ucyA9IHVucHJlcGVuZDtcbi8qKlxuICogVXNlIFtgdW5hcHBlbmRgXSgjdW5hcHBlbmQpIGluc3RlYWQuXG4gKlxuICogQGNhdGVnb3J5IHpvbmUgb2YgZGVhdGhcbiAqIEBzaW5jZSAyLjkuMFxuICogQGRlcHJlY2F0ZWRcbiAqL1xuZXhwb3J0IHZhciB1bnNub2MgPSB1bmFwcGVuZDtcbmV4cG9ydCBmdW5jdGlvbiBjb25zKGhlYWQsIHRhaWwpIHtcbiAgICByZXR1cm4gdGFpbCA9PT0gdW5kZWZpbmVkID8gcHJlcGVuZChoZWFkKSA6IHBpcGUodGFpbCwgcHJlcGVuZChoZWFkKSk7XG59XG4vKipcbiAqIFVzZSBbYGFwcGVuZGBdKC4vQXJyYXkudHMuaHRtbCNhcHBlbmQpIGluc3RlYWQuXG4gKlxuICogQGNhdGVnb3J5IHpvbmUgb2YgZGVhdGhcbiAqIEBzaW5jZSAyLjAuMFxuICogQGRlcHJlY2F0ZWRcbiAqL1xuZXhwb3J0IHZhciBzbm9jID0gZnVuY3Rpb24gKGluaXQsIGVuZCkgeyByZXR1cm4gcGlwZShpbml0LCBhcHBlbmQoZW5kKSk7IH07XG4vKipcbiAqIFVzZSBbYHByZXBlbmRBbGxgXSgjcHJlcGVuZGFsbCkgaW5zdGVhZC5cbiAqXG4gKiBAY2F0ZWdvcnkgem9uZSBvZiBkZWF0aFxuICogQHNpbmNlIDIuOS4wXG4gKiBAZGVwcmVjYXRlZFxuICovXG5leHBvcnQgdmFyIHByZXBlbmRUb0FsbCA9IHByZXBlbmRBbGw7XG4vKipcbiAqIFVzZSBbYGNvbmNhdEFsbGBdKCNjb25jYXRhbGwpIGluc3RlYWQuXG4gKlxuICogQGNhdGVnb3J5IHpvbmUgb2YgZGVhdGhcbiAqIEBzaW5jZSAyLjUuMFxuICogQGRlcHJlY2F0ZWRcbiAqL1xuZXhwb3J0IHZhciBmb2xkID0gUk5FQS5jb25jYXRBbGw7XG4vKipcbiAqIFRoaXMgaW5zdGFuY2UgaXMgZGVwcmVjYXRlZCwgdXNlIHNtYWxsLCBzcGVjaWZpYyBpbnN0YW5jZXMgaW5zdGVhZC5cbiAqIEZvciBleGFtcGxlIGlmIGEgZnVuY3Rpb24gbmVlZHMgYSBgRnVuY3RvcmAgaW5zdGFuY2UsIHBhc3MgYE5FQS5GdW5jdG9yYCBpbnN0ZWFkIG9mIGBORUEubm9uRW1wdHlBcnJheWBcbiAqICh3aGVyZSBgTkVBYCBpcyBmcm9tIGBpbXBvcnQgTkVBIGZyb20gJ2ZwLXRzL05vbkVtcHR5QXJyYXknYClcbiAqXG4gKiBAY2F0ZWdvcnkgem9uZSBvZiBkZWF0aFxuICogQHNpbmNlIDIuMC4wXG4gKiBAZGVwcmVjYXRlZFxuICovXG5leHBvcnQgdmFyIG5vbkVtcHR5QXJyYXkgPSB7XG4gICAgVVJJOiBVUkksXG4gICAgb2Y6IG9mLFxuICAgIG1hcDogX21hcCxcbiAgICBtYXBXaXRoSW5kZXg6IF9tYXBXaXRoSW5kZXgsXG4gICAgYXA6IF9hcCxcbiAgICBjaGFpbjogZmxhdE1hcCxcbiAgICBleHRlbmQ6IF9leHRlbmQsXG4gICAgZXh0cmFjdDogZXh0cmFjdCxcbiAgICByZWR1Y2U6IF9yZWR1Y2UsXG4gICAgZm9sZE1hcDogX2ZvbGRNYXAsXG4gICAgcmVkdWNlUmlnaHQ6IF9yZWR1Y2VSaWdodCxcbiAgICB0cmF2ZXJzZTogX3RyYXZlcnNlLFxuICAgIHNlcXVlbmNlOiBzZXF1ZW5jZSxcbiAgICByZWR1Y2VXaXRoSW5kZXg6IF9yZWR1Y2VXaXRoSW5kZXgsXG4gICAgZm9sZE1hcFdpdGhJbmRleDogX2ZvbGRNYXBXaXRoSW5kZXgsXG4gICAgcmVkdWNlUmlnaHRXaXRoSW5kZXg6IF9yZWR1Y2VSaWdodFdpdGhJbmRleCxcbiAgICB0cmF2ZXJzZVdpdGhJbmRleDogX3RyYXZlcnNlV2l0aEluZGV4LFxuICAgIGFsdDogX2FsdFxufTtcbiIsCiAgInZhciBfX3NwcmVhZEFycmF5ID0gKHRoaXMgJiYgdGhpcy5fX3NwcmVhZEFycmF5KSB8fCBmdW5jdGlvbiAodG8sIGZyb20sIHBhY2spIHtcbiAgICBpZiAocGFjayB8fCBhcmd1bWVudHMubGVuZ3RoID09PSAyKSBmb3IgKHZhciBpID0gMCwgbCA9IGZyb20ubGVuZ3RoLCBhcjsgaSA8IGw7IGkrKykge1xuICAgICAgICBpZiAoYXIgfHwgIShpIGluIGZyb20pKSB7XG4gICAgICAgICAgICBpZiAoIWFyKSBhciA9IEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGZyb20sIDAsIGkpO1xuICAgICAgICAgICAgYXJbaV0gPSBmcm9tW2ldO1xuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiB0by5jb25jYXQoYXIgfHwgQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoZnJvbSkpO1xufTtcbmltcG9ydCB7IGFwRmlyc3QgYXMgYXBGaXJzdF8sIGFwUyBhcyBhcFNfLCBhcFNlY29uZCBhcyBhcFNlY29uZF8gfSBmcm9tICcuL0FwcGx5JztcbmltcG9ydCB7IGJpbmQgYXMgYmluZF8sIGNoYWluRmlyc3QgYXMgY2hhaW5GaXJzdF8gfSBmcm9tICcuL0NoYWluJztcbmltcG9ydCB7IGR1YWwsIGlkZW50aXR5LCBwaXBlIH0gZnJvbSAnLi9mdW5jdGlvbic7XG5pbXBvcnQgeyBiaW5kVG8gYXMgYmluZFRvXywgZmxhcCBhcyBmbGFwXywgbGV0IGFzIGxldF9fIH0gZnJvbSAnLi9GdW5jdG9yJztcbmltcG9ydCAqIGFzIF8gZnJvbSAnLi9pbnRlcm5hbCc7XG5pbXBvcnQgeyBnZXRNb25vaWQgfSBmcm9tICcuL09yZCc7XG5pbXBvcnQgKiBhcyBSTkVBIGZyb20gJy4vUmVhZG9ubHlOb25FbXB0eUFycmF5Jztcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8vIGludGVybmFsXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vKipcbiAqIEBpbnRlcm5hbFxuICovXG5leHBvcnQgdmFyIGlzTm9uRW1wdHkgPSBmdW5jdGlvbiAoYXMpIHsgcmV0dXJuIGFzLmxlbmd0aCA+IDA7IH07XG4vKipcbiAqIEBpbnRlcm5hbFxuICovXG5leHBvcnQgdmFyIGlzT3V0T2ZCb3VuZCA9IGZ1bmN0aW9uIChpLCBhcykgeyByZXR1cm4gaSA8IDAgfHwgaSA+PSBhcy5sZW5ndGg7IH07XG4vKipcbiAqIEBpbnRlcm5hbFxuICovXG5leHBvcnQgdmFyIHByZXBlbmRXID0gZnVuY3Rpb24gKGhlYWQpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKHRhaWwpIHtcbiAgICAgICAgcmV0dXJuIF9fc3ByZWFkQXJyYXkoW2hlYWRdLCB0YWlsLCB0cnVlKTtcbiAgICB9O1xufTtcbi8qKlxuICogQGludGVybmFsXG4gKi9cbmV4cG9ydCB2YXIgcHJlcGVuZCA9IHByZXBlbmRXO1xuLyoqXG4gKiBAaW50ZXJuYWxcbiAqL1xuZXhwb3J0IHZhciBhcHBlbmRXID0gZnVuY3Rpb24gKGVuZCkge1xuICAgIHJldHVybiBmdW5jdGlvbiAoaW5pdCkge1xuICAgICAgICByZXR1cm4gX19zcHJlYWRBcnJheShfX3NwcmVhZEFycmF5KFtdLCBpbml0LCB0cnVlKSwgW2VuZF0sIGZhbHNlKTtcbiAgICB9O1xufTtcbi8qKlxuICogQGludGVybmFsXG4gKi9cbmV4cG9ydCB2YXIgYXBwZW5kID0gYXBwZW5kVztcbi8qKlxuICogQGludGVybmFsXG4gKi9cbmV4cG9ydCB2YXIgdW5zYWZlSW5zZXJ0QXQgPSBmdW5jdGlvbiAoaSwgYSwgYXMpIHtcbiAgICBpZiAoaXNOb25FbXB0eShhcykpIHtcbiAgICAgICAgdmFyIHhzID0gZnJvbVJlYWRvbmx5Tm9uRW1wdHlBcnJheShhcyk7XG4gICAgICAgIHhzLnNwbGljZShpLCAwLCBhKTtcbiAgICAgICAgcmV0dXJuIHhzO1xuICAgIH1cbiAgICByZXR1cm4gW2FdO1xufTtcbi8qKlxuICogQGludGVybmFsXG4gKi9cbmV4cG9ydCB2YXIgdW5zYWZlVXBkYXRlQXQgPSBmdW5jdGlvbiAoaSwgYSwgYXMpIHtcbiAgICB2YXIgeHMgPSBmcm9tUmVhZG9ubHlOb25FbXB0eUFycmF5KGFzKTtcbiAgICB4c1tpXSA9IGE7XG4gICAgcmV0dXJuIHhzO1xufTtcbi8qKlxuICogUmVtb3ZlIGR1cGxpY2F0ZXMgZnJvbSBhIGBOb25FbXB0eUFycmF5YCwga2VlcGluZyB0aGUgZmlyc3Qgb2NjdXJyZW5jZSBvZiBhbiBlbGVtZW50LlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyB1bmlxIH0gZnJvbSAnZnAtdHMvTm9uRW1wdHlBcnJheSdcbiAqIGltcG9ydCAqIGFzIE4gZnJvbSAnZnAtdHMvbnVtYmVyJ1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwodW5pcShOLkVxKShbMSwgMiwgMV0pLCBbMSwgMl0pXG4gKlxuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIHVuaXEgPSBmdW5jdGlvbiAoRSkge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgaWYgKGFzLmxlbmd0aCA9PT0gMSkge1xuICAgICAgICAgICAgcmV0dXJuIGNvcHkoYXMpO1xuICAgICAgICB9XG4gICAgICAgIHZhciBvdXQgPSBbaGVhZChhcyldO1xuICAgICAgICB2YXIgcmVzdCA9IHRhaWwoYXMpO1xuICAgICAgICB2YXIgX2xvb3BfMSA9IGZ1bmN0aW9uIChhKSB7XG4gICAgICAgICAgICBpZiAob3V0LmV2ZXJ5KGZ1bmN0aW9uIChvKSB7IHJldHVybiAhRS5lcXVhbHMobywgYSk7IH0pKSB7XG4gICAgICAgICAgICAgICAgb3V0LnB1c2goYSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIGZvciAodmFyIF9pID0gMCwgcmVzdF8xID0gcmVzdDsgX2kgPCByZXN0XzEubGVuZ3RoOyBfaSsrKSB7XG4gICAgICAgICAgICB2YXIgYSA9IHJlc3RfMVtfaV07XG4gICAgICAgICAgICBfbG9vcF8xKGEpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBvdXQ7XG4gICAgfTtcbn07XG4vKipcbiAqIFNvcnQgdGhlIGVsZW1lbnRzIG9mIGEgYE5vbkVtcHR5QXJyYXlgIGluIGluY3JlYXNpbmcgb3JkZXIsIHdoZXJlIGVsZW1lbnRzIGFyZSBjb21wYXJlZCB1c2luZyBmaXJzdCBgb3Jkc1swXWAsIHRoZW4gYG9yZHNbMV1gLFxuICogZXRjLi4uXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCAqIGFzIE5FQSBmcm9tICdmcC10cy9Ob25FbXB0eUFycmF5J1xuICogaW1wb3J0IHsgY29udHJhbWFwIH0gZnJvbSAnZnAtdHMvT3JkJ1xuICogaW1wb3J0ICogYXMgUyBmcm9tICdmcC10cy9zdHJpbmcnXG4gKiBpbXBvcnQgKiBhcyBOIGZyb20gJ2ZwLXRzL251bWJlcidcbiAqIGltcG9ydCB7IHBpcGUgfSBmcm9tICdmcC10cy9mdW5jdGlvbidcbiAqXG4gKiBpbnRlcmZhY2UgUGVyc29uIHtcbiAqICAgbmFtZTogc3RyaW5nXG4gKiAgIGFnZTogbnVtYmVyXG4gKiB9XG4gKlxuICogY29uc3QgYnlOYW1lID0gcGlwZShTLk9yZCwgY29udHJhbWFwKChwOiBQZXJzb24pID0+IHAubmFtZSkpXG4gKlxuICogY29uc3QgYnlBZ2UgPSBwaXBlKE4uT3JkLCBjb250cmFtYXAoKHA6IFBlcnNvbikgPT4gcC5hZ2UpKVxuICpcbiAqIGNvbnN0IHNvcnRCeU5hbWVCeUFnZSA9IE5FQS5zb3J0QnkoW2J5TmFtZSwgYnlBZ2VdKVxuICpcbiAqIGNvbnN0IHBlcnNvbnM6IE5FQS5Ob25FbXB0eUFycmF5PFBlcnNvbj4gPSBbXG4gKiAgIHsgbmFtZTogJ2EnLCBhZ2U6IDEgfSxcbiAqICAgeyBuYW1lOiAnYicsIGFnZTogMyB9LFxuICogICB7IG5hbWU6ICdjJywgYWdlOiAyIH0sXG4gKiAgIHsgbmFtZTogJ2InLCBhZ2U6IDIgfVxuICogXVxuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoc29ydEJ5TmFtZUJ5QWdlKHBlcnNvbnMpLCBbXG4gKiAgIHsgbmFtZTogJ2EnLCBhZ2U6IDEgfSxcbiAqICAgeyBuYW1lOiAnYicsIGFnZTogMiB9LFxuICogICB7IG5hbWU6ICdiJywgYWdlOiAzIH0sXG4gKiAgIHsgbmFtZTogJ2MnLCBhZ2U6IDIgfVxuICogXSlcbiAqXG4gKiBAc2luY2UgMi4xMS4wXG4gKi9cbmV4cG9ydCB2YXIgc29ydEJ5ID0gZnVuY3Rpb24gKG9yZHMpIHtcbiAgICBpZiAoaXNOb25FbXB0eShvcmRzKSkge1xuICAgICAgICB2YXIgTSA9IGdldE1vbm9pZCgpO1xuICAgICAgICByZXR1cm4gc29ydChvcmRzLnJlZHVjZShNLmNvbmNhdCwgTS5lbXB0eSkpO1xuICAgIH1cbiAgICByZXR1cm4gY29weTtcbn07XG4vKipcbiAqIEBzaW5jZSAyLjExLjBcbiAqL1xuZXhwb3J0IHZhciB1bmlvbiA9IGZ1bmN0aW9uIChFKSB7XG4gICAgdmFyIHVuaXFFID0gdW5pcShFKTtcbiAgICByZXR1cm4gZnVuY3Rpb24gKHNlY29uZCkgeyByZXR1cm4gZnVuY3Rpb24gKGZpcnN0KSB7IHJldHVybiB1bmlxRShwaXBlKGZpcnN0LCBjb25jYXQoc2Vjb25kKSkpOyB9OyB9O1xufTtcbi8qKlxuICogUm90YXRlIGEgYE5vbkVtcHR5QXJyYXlgIGJ5IGBuYCBzdGVwcy5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgcm90YXRlIH0gZnJvbSAnZnAtdHMvTm9uRW1wdHlBcnJheSdcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKHJvdGF0ZSgyKShbMSwgMiwgMywgNCwgNV0pLCBbNCwgNSwgMSwgMiwgM10pXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKHJvdGF0ZSgtMikoWzEsIDIsIDMsIDQsIDVdKSwgWzMsIDQsIDUsIDEsIDJdKVxuICpcbiAqIEBzaW5jZSAyLjExLjBcbiAqL1xuZXhwb3J0IHZhciByb3RhdGUgPSBmdW5jdGlvbiAobikge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgdmFyIGxlbiA9IGFzLmxlbmd0aDtcbiAgICAgICAgdmFyIG0gPSBNYXRoLnJvdW5kKG4pICUgbGVuO1xuICAgICAgICBpZiAoaXNPdXRPZkJvdW5kKE1hdGguYWJzKG0pLCBhcykgfHwgbSA9PT0gMCkge1xuICAgICAgICAgICAgcmV0dXJuIGNvcHkoYXMpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChtIDwgMCkge1xuICAgICAgICAgICAgdmFyIF9hID0gc3BsaXRBdCgtbSkoYXMpLCBmID0gX2FbMF0sIHMgPSBfYVsxXTtcbiAgICAgICAgICAgIHJldHVybiBwaXBlKHMsIGNvbmNhdChmKSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gcm90YXRlKG0gLSBsZW4pKGFzKTtcbiAgICAgICAgfVxuICAgIH07XG59O1xuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLy8gY29uc3RydWN0b3JzXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vKipcbiAqIEBjYXRlZ29yeSBjb252ZXJzaW9uc1xuICogQHNpbmNlIDIuMTAuMFxuICovXG5leHBvcnQgdmFyIGZyb21SZWFkb25seU5vbkVtcHR5QXJyYXkgPSBfLmZyb21SZWFkb25seU5vbkVtcHR5QXJyYXk7XG4vKipcbiAqIEJ1aWxkcyBhIGBOb25FbXB0eUFycmF5YCBmcm9tIGFuIGBBcnJheWAgcmV0dXJuaW5nIGBub25lYCBpZiBgYXNgIGlzIGFuIGVtcHR5IGFycmF5XG4gKlxuICogQGNhdGVnb3J5IGNvbnZlcnNpb25zXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciBmcm9tQXJyYXkgPSBmdW5jdGlvbiAoYXMpIHsgcmV0dXJuIChpc05vbkVtcHR5KGFzKSA/IF8uc29tZShhcykgOiBfLm5vbmUpOyB9O1xuLyoqXG4gKiBSZXR1cm4gYSBgTm9uRW1wdHlBcnJheWAgb2YgbGVuZ3RoIGBuYCB3aXRoIGVsZW1lbnQgYGlgIGluaXRpYWxpemVkIHdpdGggYGYoaSlgLlxuICpcbiAqICoqTm90ZSoqLiBgbmAgaXMgbm9ybWFsaXplZCB0byBhIG5hdHVyYWwgbnVtYmVyLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBtYWtlQnkgfSBmcm9tICdmcC10cy9Ob25FbXB0eUFycmF5J1xuICogaW1wb3J0IHsgcGlwZSB9IGZyb20gJ2ZwLXRzL2Z1bmN0aW9uJ1xuICpcbiAqIGNvbnN0IGRvdWJsZSA9IChuOiBudW1iZXIpOiBudW1iZXIgPT4gbiAqIDJcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwocGlwZSg1LCBtYWtlQnkoZG91YmxlKSksIFswLCAyLCA0LCA2LCA4XSlcbiAqXG4gKiBAY2F0ZWdvcnkgY29uc3RydWN0b3JzXG4gKiBAc2luY2UgMi4xMS4wXG4gKi9cbmV4cG9ydCB2YXIgbWFrZUJ5ID0gZnVuY3Rpb24gKGYpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKG4pIHtcbiAgICAgICAgdmFyIGogPSBNYXRoLm1heCgwLCBNYXRoLmZsb29yKG4pKTtcbiAgICAgICAgdmFyIG91dCA9IFtmKDApXTtcbiAgICAgICAgZm9yICh2YXIgaSA9IDE7IGkgPCBqOyBpKyspIHtcbiAgICAgICAgICAgIG91dC5wdXNoKGYoaSkpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBvdXQ7XG4gICAgfTtcbn07XG4vKipcbiAqIENyZWF0ZSBhIGBOb25FbXB0eUFycmF5YCBjb250YWluaW5nIGEgdmFsdWUgcmVwZWF0ZWQgdGhlIHNwZWNpZmllZCBudW1iZXIgb2YgdGltZXMuXG4gKlxuICogKipOb3RlKiouIGBuYCBpcyBub3JtYWxpemVkIHRvIGEgbmF0dXJhbCBudW1iZXIuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IHJlcGxpY2F0ZSB9IGZyb20gJ2ZwLXRzL05vbkVtcHR5QXJyYXknXG4gKiBpbXBvcnQgeyBwaXBlIH0gZnJvbSAnZnAtdHMvZnVuY3Rpb24nXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChwaXBlKDMsIHJlcGxpY2F0ZSgnYScpKSwgWydhJywgJ2EnLCAnYSddKVxuICpcbiAqIEBjYXRlZ29yeSBjb25zdHJ1Y3RvcnNcbiAqIEBzaW5jZSAyLjExLjBcbiAqL1xuZXhwb3J0IHZhciByZXBsaWNhdGUgPSBmdW5jdGlvbiAoYSkgeyByZXR1cm4gbWFrZUJ5KGZ1bmN0aW9uICgpIHsgcmV0dXJuIGE7IH0pOyB9O1xuLyoqXG4gKiBDcmVhdGUgYSBgTm9uRW1wdHlBcnJheWAgY29udGFpbmluZyBhIHJhbmdlIG9mIGludGVnZXJzLCBpbmNsdWRpbmcgYm90aCBlbmRwb2ludHMuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IHJhbmdlIH0gZnJvbSAnZnAtdHMvTm9uRW1wdHlBcnJheSdcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKHJhbmdlKDEsIDUpLCBbMSwgMiwgMywgNCwgNV0pXG4gKlxuICogQGNhdGVnb3J5IGNvbnN0cnVjdG9yc1xuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIHJhbmdlID0gZnVuY3Rpb24gKHN0YXJ0LCBlbmQpIHtcbiAgICByZXR1cm4gc3RhcnQgPD0gZW5kID8gbWFrZUJ5KGZ1bmN0aW9uIChpKSB7IHJldHVybiBzdGFydCArIGk7IH0pKGVuZCAtIHN0YXJ0ICsgMSkgOiBbc3RhcnRdO1xufTtcbi8qKlxuICogUmV0dXJuIHRoZSB0dXBsZSBvZiB0aGUgYGhlYWRgIGFuZCB0aGUgYHRhaWxgLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyB1bnByZXBlbmQgfSBmcm9tICdmcC10cy9Ob25FbXB0eUFycmF5J1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwodW5wcmVwZW5kKFsxLCAyLCAzXSksIFsxLCBbMiwgM11dKVxuICpcbiAqIEBzaW5jZSAyLjkuMFxuICovXG5leHBvcnQgdmFyIHVucHJlcGVuZCA9IGZ1bmN0aW9uIChhcykgeyByZXR1cm4gW2hlYWQoYXMpLCB0YWlsKGFzKV07IH07XG4vKipcbiAqIFJldHVybiB0aGUgdHVwbGUgb2YgdGhlIGBpbml0YCBhbmQgdGhlIGBsYXN0YC5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgdW5hcHBlbmQgfSBmcm9tICdmcC10cy9Ob25FbXB0eUFycmF5J1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwodW5hcHBlbmQoWzEsIDIsIDMsIDRdKSwgW1sxLCAyLCAzXSwgNF0pXG4gKlxuICogQHNpbmNlIDIuOS4wXG4gKi9cbmV4cG9ydCB2YXIgdW5hcHBlbmQgPSBmdW5jdGlvbiAoYXMpIHsgcmV0dXJuIFtpbml0KGFzKSwgbGFzdChhcyldOyB9O1xuZXhwb3J0IGZ1bmN0aW9uIGNvbmNhdFcoc2Vjb25kKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChmaXJzdCkgeyByZXR1cm4gZmlyc3QuY29uY2F0KHNlY29uZCk7IH07XG59XG5leHBvcnQgZnVuY3Rpb24gY29uY2F0KHgsIHkpIHtcbiAgICByZXR1cm4geSA/IHguY29uY2F0KHkpIDogZnVuY3Rpb24gKHkpIHsgcmV0dXJuIHkuY29uY2F0KHgpOyB9O1xufVxuLyoqXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciByZXZlcnNlID0gZnVuY3Rpb24gKGFzKSB7IHJldHVybiBfX3NwcmVhZEFycmF5KFtsYXN0KGFzKV0sIGFzLnNsaWNlKDAsIC0xKS5yZXZlcnNlKCksIHRydWUpOyB9O1xuZXhwb3J0IGZ1bmN0aW9uIGdyb3VwKEUpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIHZhciBsZW4gPSBhcy5sZW5ndGg7XG4gICAgICAgIGlmIChsZW4gPT09IDApIHtcbiAgICAgICAgICAgIHJldHVybiBbXTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgb3V0ID0gW107XG4gICAgICAgIHZhciBoZWFkID0gYXNbMF07XG4gICAgICAgIHZhciBuZWEgPSBbaGVhZF07XG4gICAgICAgIGZvciAodmFyIGkgPSAxOyBpIDwgbGVuOyBpKyspIHtcbiAgICAgICAgICAgIHZhciBhID0gYXNbaV07XG4gICAgICAgICAgICBpZiAoRS5lcXVhbHMoYSwgaGVhZCkpIHtcbiAgICAgICAgICAgICAgICBuZWEucHVzaChhKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIG91dC5wdXNoKG5lYSk7XG4gICAgICAgICAgICAgICAgaGVhZCA9IGE7XG4gICAgICAgICAgICAgICAgbmVhID0gW2hlYWRdO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIG91dC5wdXNoKG5lYSk7XG4gICAgICAgIHJldHVybiBvdXQ7XG4gICAgfTtcbn1cbi8qKlxuICogU3BsaXRzIGFuIGFycmF5IGludG8gc3ViLW5vbi1lbXB0eS1hcnJheXMgc3RvcmVkIGluIGFuIG9iamVjdCwgYmFzZWQgb24gdGhlIHJlc3VsdCBvZiBjYWxsaW5nIGEgYHN0cmluZ2AtcmV0dXJuaW5nXG4gKiBmdW5jdGlvbiBvbiBlYWNoIGVsZW1lbnQsIGFuZCBncm91cGluZyB0aGUgcmVzdWx0cyBhY2NvcmRpbmcgdG8gdmFsdWVzIHJldHVybmVkXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IGdyb3VwQnkgfSBmcm9tICdmcC10cy9Ob25FbXB0eUFycmF5J1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoZ3JvdXBCeSgoczogc3RyaW5nKSA9PiBTdHJpbmcocy5sZW5ndGgpKShbJ2EnLCAnYicsICdhYiddKSwge1xuICogICAnMSc6IFsnYScsICdiJ10sXG4gKiAgICcyJzogWydhYiddXG4gKiB9KVxuICpcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIGdyb3VwQnkgPSBmdW5jdGlvbiAoZikge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgdmFyIG91dCA9IHt9O1xuICAgICAgICBmb3IgKHZhciBfaSA9IDAsIGFzXzEgPSBhczsgX2kgPCBhc18xLmxlbmd0aDsgX2krKykge1xuICAgICAgICAgICAgdmFyIGEgPSBhc18xW19pXTtcbiAgICAgICAgICAgIHZhciBrID0gZihhKTtcbiAgICAgICAgICAgIGlmIChfLmhhcy5jYWxsKG91dCwgaykpIHtcbiAgICAgICAgICAgICAgICBvdXRba10ucHVzaChhKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIG91dFtrXSA9IFthXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gb3V0O1xuICAgIH07XG59O1xuLyoqXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciBzb3J0ID0gZnVuY3Rpb24gKE8pIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIHJldHVybiBhcy5zbGljZSgpLnNvcnQoTy5jb21wYXJlKTtcbiAgICB9O1xufTtcbi8qKlxuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgaW5zZXJ0QXQgPSBmdW5jdGlvbiAoaSwgYSkge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgcmV0dXJuIGkgPCAwIHx8IGkgPiBhcy5sZW5ndGggPyBfLm5vbmUgOiBfLnNvbWUodW5zYWZlSW5zZXJ0QXQoaSwgYSwgYXMpKTtcbiAgICB9O1xufTtcbi8qKlxuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgdXBkYXRlQXQgPSBmdW5jdGlvbiAoaSwgYSkge1xuICAgIHJldHVybiBtb2RpZnlBdChpLCBmdW5jdGlvbiAoKSB7IHJldHVybiBhOyB9KTtcbn07XG4vKipcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIG1vZGlmeUF0ID0gZnVuY3Rpb24gKGksIGYpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIHJldHVybiBpc091dE9mQm91bmQoaSwgYXMpID8gXy5ub25lIDogXy5zb21lKHVuc2FmZVVwZGF0ZUF0KGksIGYoYXNbaV0pLCBhcykpO1xuICAgIH07XG59O1xuLyoqXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciBjb3B5ID0gZnJvbVJlYWRvbmx5Tm9uRW1wdHlBcnJheTtcbi8qKlxuICogQGNhdGVnb3J5IGNvbnN0cnVjdG9yc1xuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgb2YgPSBmdW5jdGlvbiAoYSkgeyByZXR1cm4gW2FdOyB9O1xuLyoqXG4gKiBAc2luY2UgMi41LjFcbiAqL1xuZXhwb3J0IHZhciB6aXBXaXRoID0gZnVuY3Rpb24gKGFzLCBicywgZikge1xuICAgIHZhciBjcyA9IFtmKGFzWzBdLCBic1swXSldO1xuICAgIHZhciBsZW4gPSBNYXRoLm1pbihhcy5sZW5ndGgsIGJzLmxlbmd0aCk7XG4gICAgZm9yICh2YXIgaSA9IDE7IGkgPCBsZW47IGkrKykge1xuICAgICAgICBjc1tpXSA9IGYoYXNbaV0sIGJzW2ldKTtcbiAgICB9XG4gICAgcmV0dXJuIGNzO1xufTtcbmV4cG9ydCBmdW5jdGlvbiB6aXAoYXMsIGJzKSB7XG4gICAgaWYgKGJzID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIChicykgeyByZXR1cm4gemlwKGJzLCBhcyk7IH07XG4gICAgfVxuICAgIHJldHVybiB6aXBXaXRoKGFzLCBicywgZnVuY3Rpb24gKGEsIGIpIHsgcmV0dXJuIFthLCBiXTsgfSk7XG59XG4vKipcbiAqIEBzaW5jZSAyLjUuMVxuICovXG5leHBvcnQgdmFyIHVuemlwID0gZnVuY3Rpb24gKGFicykge1xuICAgIHZhciBmYSA9IFthYnNbMF1bMF1dO1xuICAgIHZhciBmYiA9IFthYnNbMF1bMV1dO1xuICAgIGZvciAodmFyIGkgPSAxOyBpIDwgYWJzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIGZhW2ldID0gYWJzW2ldWzBdO1xuICAgICAgICBmYltpXSA9IGFic1tpXVsxXTtcbiAgICB9XG4gICAgcmV0dXJuIFtmYSwgZmJdO1xufTtcbi8qKlxuICogUHJlcGVuZCBhbiBlbGVtZW50IHRvIGV2ZXJ5IG1lbWJlciBvZiBhbiBhcnJheVxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBwcmVwZW5kQWxsIH0gZnJvbSAnZnAtdHMvTm9uRW1wdHlBcnJheSdcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKHByZXBlbmRBbGwoOSkoWzEsIDIsIDMsIDRdKSwgWzksIDEsIDksIDIsIDksIDMsIDksIDRdKVxuICpcbiAqIEBzaW5jZSAyLjEwLjBcbiAqL1xuZXhwb3J0IHZhciBwcmVwZW5kQWxsID0gZnVuY3Rpb24gKG1pZGRsZSkge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgdmFyIG91dCA9IFttaWRkbGUsIGFzWzBdXTtcbiAgICAgICAgZm9yICh2YXIgaSA9IDE7IGkgPCBhcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgb3V0LnB1c2gobWlkZGxlLCBhc1tpXSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG91dDtcbiAgICB9O1xufTtcbi8qKlxuICogUGxhY2VzIGFuIGVsZW1lbnQgaW4gYmV0d2VlbiBtZW1iZXJzIG9mIGFuIGFycmF5XG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IGludGVyc3BlcnNlIH0gZnJvbSAnZnAtdHMvTm9uRW1wdHlBcnJheSdcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKGludGVyc3BlcnNlKDkpKFsxLCAyLCAzLCA0XSksIFsxLCA5LCAyLCA5LCAzLCA5LCA0XSlcbiAqXG4gKiBAc2luY2UgMi45LjBcbiAqL1xuZXhwb3J0IHZhciBpbnRlcnNwZXJzZSA9IGZ1bmN0aW9uIChtaWRkbGUpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIHZhciByZXN0ID0gdGFpbChhcyk7XG4gICAgICAgIHJldHVybiBpc05vbkVtcHR5KHJlc3QpID8gcGlwZShyZXN0LCBwcmVwZW5kQWxsKG1pZGRsZSksIHByZXBlbmQoaGVhZChhcykpKSA6IGNvcHkoYXMpO1xuICAgIH07XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgZm9sZGluZ1xuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgZm9sZE1hcFdpdGhJbmRleCA9IFJORUEuZm9sZE1hcFdpdGhJbmRleDtcbi8qKlxuICogQGNhdGVnb3J5IGZvbGRpbmdcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIGZvbGRNYXAgPSBSTkVBLmZvbGRNYXA7XG4vKipcbiAqIEBjYXRlZ29yeSBzZXF1ZW5jaW5nXG4gKiBAc2luY2UgMi4xMC4wXG4gKi9cbmV4cG9ydCB2YXIgY2hhaW5XaXRoSW5kZXggPSBmdW5jdGlvbiAoZikge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgdmFyIG91dCA9IGZyb21SZWFkb25seU5vbkVtcHR5QXJyYXkoZigwLCBoZWFkKGFzKSkpO1xuICAgICAgICBmb3IgKHZhciBpID0gMTsgaSA8IGFzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICBvdXQucHVzaC5hcHBseShvdXQsIGYoaSwgYXNbaV0pKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gb3V0O1xuICAgIH07XG59O1xuLyoqXG4gKiBAc2luY2UgMi4xMC4wXG4gKi9cbmV4cG9ydCB2YXIgY2hvcCA9IGZ1bmN0aW9uIChmKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykge1xuICAgICAgICB2YXIgX2EgPSBmKGFzKSwgYiA9IF9hWzBdLCByZXN0ID0gX2FbMV07XG4gICAgICAgIHZhciBvdXQgPSBbYl07XG4gICAgICAgIHZhciBuZXh0ID0gcmVzdDtcbiAgICAgICAgd2hpbGUgKGlzTm9uRW1wdHkobmV4dCkpIHtcbiAgICAgICAgICAgIHZhciBfYiA9IGYobmV4dCksIGJfMSA9IF9iWzBdLCByZXN0XzIgPSBfYlsxXTtcbiAgICAgICAgICAgIG91dC5wdXNoKGJfMSk7XG4gICAgICAgICAgICBuZXh0ID0gcmVzdF8yO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBvdXQ7XG4gICAgfTtcbn07XG4vKipcbiAqIFNwbGl0cyBhIGBOb25FbXB0eUFycmF5YCBpbnRvIHR3byBwaWVjZXMsIHRoZSBmaXJzdCBwaWVjZSBoYXMgbWF4IGBuYCBlbGVtZW50cy5cbiAqXG4gKiBAc2luY2UgMi4xMC4wXG4gKi9cbmV4cG9ydCB2YXIgc3BsaXRBdCA9IGZ1bmN0aW9uIChuKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykge1xuICAgICAgICB2YXIgbSA9IE1hdGgubWF4KDEsIG4pO1xuICAgICAgICByZXR1cm4gbSA+PSBhcy5sZW5ndGggPyBbY29weShhcyksIFtdXSA6IFtwaXBlKGFzLnNsaWNlKDEsIG0pLCBwcmVwZW5kKGhlYWQoYXMpKSksIGFzLnNsaWNlKG0pXTtcbiAgICB9O1xufTtcbi8qKlxuICogQHNpbmNlIDIuMTAuMFxuICovXG5leHBvcnQgdmFyIGNodW5rc09mID0gZnVuY3Rpb24gKG4pIHsgcmV0dXJuIGNob3Aoc3BsaXRBdChuKSk7IH07XG4vKiBpc3RhbmJ1bCBpZ25vcmUgbmV4dCAqL1xudmFyIF9tYXAgPSBmdW5jdGlvbiAoZmEsIGYpIHsgcmV0dXJuIHBpcGUoZmEsIG1hcChmKSk7IH07XG4vKiBpc3RhbmJ1bCBpZ25vcmUgbmV4dCAqL1xudmFyIF9tYXBXaXRoSW5kZXggPSBmdW5jdGlvbiAoZmEsIGYpIHsgcmV0dXJuIHBpcGUoZmEsIG1hcFdpdGhJbmRleChmKSk7IH07XG4vKiBpc3RhbmJ1bCBpZ25vcmUgbmV4dCAqL1xudmFyIF9hcCA9IGZ1bmN0aW9uIChmYWIsIGZhKSB7IHJldHVybiBwaXBlKGZhYiwgYXAoZmEpKTsgfTtcbi8qIGlzdGFuYnVsIGlnbm9yZSBuZXh0ICovXG52YXIgX2V4dGVuZCA9IGZ1bmN0aW9uICh3YSwgZikgeyByZXR1cm4gcGlwZSh3YSwgZXh0ZW5kKGYpKTsgfTtcbi8qIGlzdGFuYnVsIGlnbm9yZSBuZXh0ICovXG52YXIgX3JlZHVjZSA9IGZ1bmN0aW9uIChmYSwgYiwgZikgeyByZXR1cm4gcGlwZShmYSwgcmVkdWNlKGIsIGYpKTsgfTtcbi8qIGlzdGFuYnVsIGlnbm9yZSBuZXh0ICovXG52YXIgX2ZvbGRNYXAgPSBmdW5jdGlvbiAoTSkge1xuICAgIHZhciBmb2xkTWFwTSA9IGZvbGRNYXAoTSk7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChmYSwgZikgeyByZXR1cm4gcGlwZShmYSwgZm9sZE1hcE0oZikpOyB9O1xufTtcbi8qIGlzdGFuYnVsIGlnbm9yZSBuZXh0ICovXG52YXIgX3JlZHVjZVJpZ2h0ID0gZnVuY3Rpb24gKGZhLCBiLCBmKSB7IHJldHVybiBwaXBlKGZhLCByZWR1Y2VSaWdodChiLCBmKSk7IH07XG4vKiBpc3RhbmJ1bCBpZ25vcmUgbmV4dCAqL1xudmFyIF90cmF2ZXJzZSA9IGZ1bmN0aW9uIChGKSB7XG4gICAgdmFyIHRyYXZlcnNlRiA9IHRyYXZlcnNlKEYpO1xuICAgIHJldHVybiBmdW5jdGlvbiAodGEsIGYpIHsgcmV0dXJuIHBpcGUodGEsIHRyYXZlcnNlRihmKSk7IH07XG59O1xuLyogaXN0YW5idWwgaWdub3JlIG5leHQgKi9cbnZhciBfYWx0ID0gZnVuY3Rpb24gKGZhLCB0aGF0KSB7IHJldHVybiBwaXBlKGZhLCBhbHQodGhhdCkpOyB9O1xuLyogaXN0YW5idWwgaWdub3JlIG5leHQgKi9cbnZhciBfcmVkdWNlV2l0aEluZGV4ID0gZnVuY3Rpb24gKGZhLCBiLCBmKSB7XG4gICAgcmV0dXJuIHBpcGUoZmEsIHJlZHVjZVdpdGhJbmRleChiLCBmKSk7XG59O1xuLyogaXN0YW5idWwgaWdub3JlIG5leHQgKi9cbnZhciBfZm9sZE1hcFdpdGhJbmRleCA9IGZ1bmN0aW9uIChNKSB7XG4gICAgdmFyIGZvbGRNYXBXaXRoSW5kZXhNID0gZm9sZE1hcFdpdGhJbmRleChNKTtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGZhLCBmKSB7IHJldHVybiBwaXBlKGZhLCBmb2xkTWFwV2l0aEluZGV4TShmKSk7IH07XG59O1xuLyogaXN0YW5idWwgaWdub3JlIG5leHQgKi9cbnZhciBfcmVkdWNlUmlnaHRXaXRoSW5kZXggPSBmdW5jdGlvbiAoZmEsIGIsIGYpIHtcbiAgICByZXR1cm4gcGlwZShmYSwgcmVkdWNlUmlnaHRXaXRoSW5kZXgoYiwgZikpO1xufTtcbi8qIGlzdGFuYnVsIGlnbm9yZSBuZXh0ICovXG52YXIgX3RyYXZlcnNlV2l0aEluZGV4ID0gZnVuY3Rpb24gKEYpIHtcbiAgICB2YXIgdHJhdmVyc2VXaXRoSW5kZXhGID0gdHJhdmVyc2VXaXRoSW5kZXgoRik7XG4gICAgcmV0dXJuIGZ1bmN0aW9uICh0YSwgZikgeyByZXR1cm4gcGlwZSh0YSwgdHJhdmVyc2VXaXRoSW5kZXhGKGYpKTsgfTtcbn07XG4vKipcbiAqIExlc3Mgc3RyaWN0IHZlcnNpb24gb2YgW2BhbHRgXSgjYWx0KS5cbiAqXG4gKiBUaGUgYFdgIHN1ZmZpeCAoc2hvcnQgZm9yICoqVyoqaWRlbmluZykgbWVhbnMgdGhhdCB0aGUgcmV0dXJuIHR5cGVzIHdpbGwgYmUgbWVyZ2VkLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgKiBhcyBORUEgZnJvbSAnZnAtdHMvTm9uRW1wdHlBcnJheSdcbiAqIGltcG9ydCB7IHBpcGUgfSBmcm9tICdmcC10cy9mdW5jdGlvbidcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKFxuICogICBwaXBlKFxuICogICAgIFsxLCAyLCAzXSBhcyBORUEuTm9uRW1wdHlBcnJheTxudW1iZXI+LFxuICogICAgIE5FQS5hbHRXKCgpID0+IFsnYScsICdiJ10pXG4gKiAgICksXG4gKiAgIFsxLCAyLCAzLCAnYScsICdiJ11cbiAqIClcbiAqXG4gKiBAY2F0ZWdvcnkgZXJyb3IgaGFuZGxpbmdcbiAqIEBzaW5jZSAyLjkuMFxuICovXG5leHBvcnQgdmFyIGFsdFcgPSBmdW5jdGlvbiAodGhhdCkge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgcmV0dXJuIHBpcGUoYXMsIGNvbmNhdFcodGhhdCgpKSk7XG4gICAgfTtcbn07XG4vKipcbiAqIElkZW50aWZpZXMgYW4gYXNzb2NpYXRpdmUgb3BlcmF0aW9uIG9uIGEgdHlwZSBjb25zdHJ1Y3Rvci4gSXQgaXMgc2ltaWxhciB0byBgU2VtaWdyb3VwYCwgZXhjZXB0IHRoYXQgaXQgYXBwbGllcyB0b1xuICogdHlwZXMgb2Yga2luZCBgKiAtPiAqYC5cbiAqXG4gKiBJbiBjYXNlIG9mIGBOb25FbXB0eUFycmF5YCBjb25jYXRlbmF0ZXMgdGhlIGlucHV0cyBpbnRvIGEgc2luZ2xlIGFycmF5LlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgKiBhcyBORUEgZnJvbSAnZnAtdHMvTm9uRW1wdHlBcnJheSdcbiAqIGltcG9ydCB7IHBpcGUgfSBmcm9tICdmcC10cy9mdW5jdGlvbidcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKFxuICogICBwaXBlKFxuICogICAgIFsxLCAyLCAzXSxcbiAqICAgICBORUEuYWx0KCgpID0+IFs0LCA1XSlcbiAqICAgKSxcbiAqICAgWzEsIDIsIDMsIDQsIDVdXG4gKiApXG4gKlxuICogQGNhdGVnb3J5IGVycm9yIGhhbmRsaW5nXG4gKiBAc2luY2UgMi42LjJcbiAqL1xuZXhwb3J0IHZhciBhbHQgPSBhbHRXO1xuLyoqXG4gKiBBcHBseSBhIGZ1bmN0aW9uIHRvIGFuIGFyZ3VtZW50IHVuZGVyIGEgdHlwZSBjb25zdHJ1Y3Rvci5cbiAqXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciBhcCA9IGZ1bmN0aW9uIChhcykge1xuICAgIHJldHVybiBmbGF0TWFwKGZ1bmN0aW9uIChmKSB7IHJldHVybiBwaXBlKGFzLCBtYXAoZikpOyB9KTtcbn07XG4vKipcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgKiBhcyBORUEgZnJvbSAnZnAtdHMvTm9uRW1wdHlBcnJheSdcbiAqIGltcG9ydCB7IHBpcGUgfSBmcm9tICdmcC10cy9mdW5jdGlvbidcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKFxuICogICBwaXBlKFxuICogICAgIFsxLCAyLCAzXSxcbiAqICAgICBORUEuZmxhdE1hcCgobikgPT4gW2BhJHtufWAsIGBiJHtufWBdKVxuICogICApLFxuICogICBbJ2ExJywgJ2IxJywgJ2EyJywgJ2IyJywgJ2EzJywgJ2IzJ11cbiAqIClcbiAqXG4gKiBAY2F0ZWdvcnkgc2VxdWVuY2luZ1xuICogQHNpbmNlIDIuMTQuMFxuICovXG5leHBvcnQgdmFyIGZsYXRNYXAgPSAvKiNfX1BVUkVfXyovIGR1YWwoMiwgZnVuY3Rpb24gKG1hLCBmKSB7XG4gICAgcmV0dXJuIHBpcGUobWEsIGNoYWluV2l0aEluZGV4KGZ1bmN0aW9uIChpLCBhKSB7IHJldHVybiBmKGEsIGkpOyB9KSk7XG59KTtcbi8qKlxuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgZXh0ZW5kID0gZnVuY3Rpb24gKGYpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIHZhciBuZXh0ID0gdGFpbChhcyk7XG4gICAgICAgIHZhciBvdXQgPSBbZihhcyldO1xuICAgICAgICB3aGlsZSAoaXNOb25FbXB0eShuZXh0KSkge1xuICAgICAgICAgICAgb3V0LnB1c2goZihuZXh0KSk7XG4gICAgICAgICAgICBuZXh0ID0gdGFpbChuZXh0KTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gb3V0O1xuICAgIH07XG59O1xuLyoqXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBkdXBsaWNhdGUgPSAvKiNfX1BVUkVfXyovIGV4dGVuZChpZGVudGl0eSk7XG4vKipcbiAqIEBjYXRlZ29yeSBzZXF1ZW5jaW5nXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBmbGF0dGVuID0gLyojX19QVVJFX18qLyBmbGF0TWFwKGlkZW50aXR5KTtcbi8qKlxuICogYG1hcGAgY2FuIGJlIHVzZWQgdG8gdHVybiBmdW5jdGlvbnMgYChhOiBBKSA9PiBCYCBpbnRvIGZ1bmN0aW9ucyBgKGZhOiBGPEE+KSA9PiBGPEI+YCB3aG9zZSBhcmd1bWVudCBhbmQgcmV0dXJuIHR5cGVzXG4gKiB1c2UgdGhlIHR5cGUgY29uc3RydWN0b3IgYEZgIHRvIHJlcHJlc2VudCBzb21lIGNvbXB1dGF0aW9uYWwgY29udGV4dC5cbiAqXG4gKiBAY2F0ZWdvcnkgbWFwcGluZ1xuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgbWFwID0gZnVuY3Rpb24gKGYpIHsgcmV0dXJuIG1hcFdpdGhJbmRleChmdW5jdGlvbiAoXywgYSkgeyByZXR1cm4gZihhKTsgfSk7IH07XG4vKipcbiAqIEBjYXRlZ29yeSBtYXBwaW5nXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciBtYXBXaXRoSW5kZXggPSBmdW5jdGlvbiAoZikge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgdmFyIG91dCA9IFtmKDAsIGhlYWQoYXMpKV07XG4gICAgICAgIGZvciAodmFyIGkgPSAxOyBpIDwgYXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIG91dC5wdXNoKGYoaSwgYXNbaV0pKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gb3V0O1xuICAgIH07XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgZm9sZGluZ1xuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgcmVkdWNlID0gUk5FQS5yZWR1Y2U7XG4vKipcbiAqIEBjYXRlZ29yeSBmb2xkaW5nXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciByZWR1Y2VXaXRoSW5kZXggPSBSTkVBLnJlZHVjZVdpdGhJbmRleDtcbi8qKlxuICogQGNhdGVnb3J5IGZvbGRpbmdcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIHJlZHVjZVJpZ2h0ID0gUk5FQS5yZWR1Y2VSaWdodDtcbi8qKlxuICogQGNhdGVnb3J5IGZvbGRpbmdcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIHJlZHVjZVJpZ2h0V2l0aEluZGV4ID0gUk5FQS5yZWR1Y2VSaWdodFdpdGhJbmRleDtcbi8qKlxuICogQGNhdGVnb3J5IHRyYXZlcnNpbmdcbiAqIEBzaW5jZSAyLjYuM1xuICovXG5leHBvcnQgdmFyIHRyYXZlcnNlID0gZnVuY3Rpb24gKEYpIHtcbiAgICB2YXIgdHJhdmVyc2VXaXRoSW5kZXhGID0gdHJhdmVyc2VXaXRoSW5kZXgoRik7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChmKSB7IHJldHVybiB0cmF2ZXJzZVdpdGhJbmRleEYoZnVuY3Rpb24gKF8sIGEpIHsgcmV0dXJuIGYoYSk7IH0pOyB9O1xufTtcbi8qKlxuICogQGNhdGVnb3J5IHRyYXZlcnNpbmdcbiAqIEBzaW5jZSAyLjYuM1xuICovXG5leHBvcnQgdmFyIHNlcXVlbmNlID0gZnVuY3Rpb24gKEYpIHsgcmV0dXJuIHRyYXZlcnNlV2l0aEluZGV4KEYpKGZ1bmN0aW9uIChfLCBhKSB7IHJldHVybiBhOyB9KTsgfTtcbi8qKlxuICogQGNhdGVnb3J5IHNlcXVlbmNpbmdcbiAqIEBzaW5jZSAyLjYuM1xuICovXG5leHBvcnQgdmFyIHRyYXZlcnNlV2l0aEluZGV4ID0gZnVuY3Rpb24gKEYpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGYpIHtcbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIChhcykge1xuICAgICAgICAgICAgdmFyIG91dCA9IEYubWFwKGYoMCwgaGVhZChhcykpLCBvZik7XG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMTsgaSA8IGFzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgb3V0ID0gRi5hcChGLm1hcChvdXQsIGZ1bmN0aW9uIChicykgeyByZXR1cm4gZnVuY3Rpb24gKGIpIHsgcmV0dXJuIHBpcGUoYnMsIGFwcGVuZChiKSk7IH07IH0pLCBmKGksIGFzW2ldKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gb3V0O1xuICAgICAgICB9O1xuICAgIH07XG59O1xuLyoqXG4gKiBAc2luY2UgMi43LjBcbiAqL1xuZXhwb3J0IHZhciBleHRyYWN0ID0gUk5FQS5oZWFkO1xuLyoqXG4gKiBAY2F0ZWdvcnkgdHlwZSBsYW1iZGFzXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciBVUkkgPSAnTm9uRW1wdHlBcnJheSc7XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIGdldFNob3cgPSBSTkVBLmdldFNob3c7XG4vKipcbiAqIEJ1aWxkcyBhIGBTZW1pZ3JvdXBgIGluc3RhbmNlIGZvciBgTm9uRW1wdHlBcnJheWBcbiAqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciBnZXRTZW1pZ3JvdXAgPSBmdW5jdGlvbiAoKSB7IHJldHVybiAoe1xuICAgIGNvbmNhdDogY29uY2F0XG59KTsgfTtcbi8qKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IGdldEVxIH0gZnJvbSAnZnAtdHMvTm9uRW1wdHlBcnJheSdcbiAqIGltcG9ydCAqIGFzIE4gZnJvbSAnZnAtdHMvbnVtYmVyJ1xuICpcbiAqIGNvbnN0IEUgPSBnZXRFcShOLkVxKVxuICogYXNzZXJ0LnN0cmljdEVxdWFsKEUuZXF1YWxzKFsxLCAyXSwgWzEsIDJdKSwgdHJ1ZSlcbiAqIGFzc2VydC5zdHJpY3RFcXVhbChFLmVxdWFscyhbMSwgMl0sIFsxLCAzXSksIGZhbHNlKVxuICpcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIGdldEVxID0gUk5FQS5nZXRFcTtcbi8qKlxuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIGdldFVuaW9uU2VtaWdyb3VwID0gZnVuY3Rpb24gKEUpIHtcbiAgICB2YXIgdW5pb25FID0gdW5pb24oRSk7XG4gICAgcmV0dXJuIHtcbiAgICAgICAgY29uY2F0OiBmdW5jdGlvbiAoZmlyc3QsIHNlY29uZCkgeyByZXR1cm4gdW5pb25FKHNlY29uZCkoZmlyc3QpOyB9XG4gICAgfTtcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjcuMFxuICovXG5leHBvcnQgdmFyIEZ1bmN0b3IgPSB7XG4gICAgVVJJOiBVUkksXG4gICAgbWFwOiBfbWFwXG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgbWFwcGluZ1xuICogQHNpbmNlIDIuMTAuMFxuICovXG5leHBvcnQgdmFyIGZsYXAgPSAvKiNfX1BVUkVfXyovIGZsYXBfKEZ1bmN0b3IpO1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi4xMC4wXG4gKi9cbmV4cG9ydCB2YXIgUG9pbnRlZCA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICBvZjogb2Zcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjcuMFxuICovXG5leHBvcnQgdmFyIEZ1bmN0b3JXaXRoSW5kZXggPSB7XG4gICAgVVJJOiBVUkksXG4gICAgbWFwOiBfbWFwLFxuICAgIG1hcFdpdGhJbmRleDogX21hcFdpdGhJbmRleFxufTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuMTAuMFxuICovXG5leHBvcnQgdmFyIEFwcGx5ID0ge1xuICAgIFVSSTogVVJJLFxuICAgIG1hcDogX21hcCxcbiAgICBhcDogX2FwXG59O1xuLyoqXG4gKiBDb21iaW5lIHR3byBlZmZlY3RmdWwgYWN0aW9ucywga2VlcGluZyBvbmx5IHRoZSByZXN1bHQgb2YgdGhlIGZpcnN0LlxuICpcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIGFwRmlyc3QgPSAvKiNfX1BVUkVfXyovIGFwRmlyc3RfKEFwcGx5KTtcbi8qKlxuICogQ29tYmluZSB0d28gZWZmZWN0ZnVsIGFjdGlvbnMsIGtlZXBpbmcgb25seSB0aGUgcmVzdWx0IG9mIHRoZSBzZWNvbmQuXG4gKlxuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgYXBTZWNvbmQgPSAvKiNfX1BVUkVfXyovIGFwU2Vjb25kXyhBcHBseSk7XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjcuMFxuICovXG5leHBvcnQgdmFyIEFwcGxpY2F0aXZlID0ge1xuICAgIFVSSTogVVJJLFxuICAgIG1hcDogX21hcCxcbiAgICBhcDogX2FwLFxuICAgIG9mOiBvZlxufTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuMTAuMFxuICovXG5leHBvcnQgdmFyIENoYWluID0ge1xuICAgIFVSSTogVVJJLFxuICAgIG1hcDogX21hcCxcbiAgICBhcDogX2FwLFxuICAgIGNoYWluOiBmbGF0TWFwXG59O1xuLyoqXG4gKiBDb21wb3NlcyBjb21wdXRhdGlvbnMgaW4gc2VxdWVuY2UsIHVzaW5nIHRoZSByZXR1cm4gdmFsdWUgb2Ygb25lIGNvbXB1dGF0aW9uIHRvIGRldGVybWluZSB0aGUgbmV4dCBjb21wdXRhdGlvbiBhbmRcbiAqIGtlZXBpbmcgb25seSB0aGUgcmVzdWx0IG9mIHRoZSBmaXJzdC5cbiAqXG4gKiBAY2F0ZWdvcnkgc2VxdWVuY2luZ1xuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgY2hhaW5GaXJzdCA9IFxuLyojX19QVVJFX18qLyBjaGFpbkZpcnN0XyhDaGFpbik7XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjcuMFxuICovXG5leHBvcnQgdmFyIE1vbmFkID0ge1xuICAgIFVSSTogVVJJLFxuICAgIG1hcDogX21hcCxcbiAgICBhcDogX2FwLFxuICAgIG9mOiBvZixcbiAgICBjaGFpbjogZmxhdE1hcFxufTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuNy4wXG4gKi9cbmV4cG9ydCB2YXIgRm9sZGFibGUgPSB7XG4gICAgVVJJOiBVUkksXG4gICAgcmVkdWNlOiBfcmVkdWNlLFxuICAgIGZvbGRNYXA6IF9mb2xkTWFwLFxuICAgIHJlZHVjZVJpZ2h0OiBfcmVkdWNlUmlnaHRcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjcuMFxuICovXG5leHBvcnQgdmFyIEZvbGRhYmxlV2l0aEluZGV4ID0ge1xuICAgIFVSSTogVVJJLFxuICAgIHJlZHVjZTogX3JlZHVjZSxcbiAgICBmb2xkTWFwOiBfZm9sZE1hcCxcbiAgICByZWR1Y2VSaWdodDogX3JlZHVjZVJpZ2h0LFxuICAgIHJlZHVjZVdpdGhJbmRleDogX3JlZHVjZVdpdGhJbmRleCxcbiAgICBmb2xkTWFwV2l0aEluZGV4OiBfZm9sZE1hcFdpdGhJbmRleCxcbiAgICByZWR1Y2VSaWdodFdpdGhJbmRleDogX3JlZHVjZVJpZ2h0V2l0aEluZGV4XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi43LjBcbiAqL1xuZXhwb3J0IHZhciBUcmF2ZXJzYWJsZSA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICBtYXA6IF9tYXAsXG4gICAgcmVkdWNlOiBfcmVkdWNlLFxuICAgIGZvbGRNYXA6IF9mb2xkTWFwLFxuICAgIHJlZHVjZVJpZ2h0OiBfcmVkdWNlUmlnaHQsXG4gICAgdHJhdmVyc2U6IF90cmF2ZXJzZSxcbiAgICBzZXF1ZW5jZTogc2VxdWVuY2Vcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjcuMFxuICovXG5leHBvcnQgdmFyIFRyYXZlcnNhYmxlV2l0aEluZGV4ID0ge1xuICAgIFVSSTogVVJJLFxuICAgIG1hcDogX21hcCxcbiAgICBtYXBXaXRoSW5kZXg6IF9tYXBXaXRoSW5kZXgsXG4gICAgcmVkdWNlOiBfcmVkdWNlLFxuICAgIGZvbGRNYXA6IF9mb2xkTWFwLFxuICAgIHJlZHVjZVJpZ2h0OiBfcmVkdWNlUmlnaHQsXG4gICAgdHJhdmVyc2U6IF90cmF2ZXJzZSxcbiAgICBzZXF1ZW5jZTogc2VxdWVuY2UsXG4gICAgcmVkdWNlV2l0aEluZGV4OiBfcmVkdWNlV2l0aEluZGV4LFxuICAgIGZvbGRNYXBXaXRoSW5kZXg6IF9mb2xkTWFwV2l0aEluZGV4LFxuICAgIHJlZHVjZVJpZ2h0V2l0aEluZGV4OiBfcmVkdWNlUmlnaHRXaXRoSW5kZXgsXG4gICAgdHJhdmVyc2VXaXRoSW5kZXg6IF90cmF2ZXJzZVdpdGhJbmRleFxufTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuNy4wXG4gKi9cbmV4cG9ydCB2YXIgQWx0ID0ge1xuICAgIFVSSTogVVJJLFxuICAgIG1hcDogX21hcCxcbiAgICBhbHQ6IF9hbHRcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjcuMFxuICovXG5leHBvcnQgdmFyIENvbW9uYWQgPSB7XG4gICAgVVJJOiBVUkksXG4gICAgbWFwOiBfbWFwLFxuICAgIGV4dGVuZDogX2V4dGVuZCxcbiAgICBleHRyYWN0OiBleHRyYWN0XG59O1xuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLy8gZG8gbm90YXRpb25cbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8qKlxuICogQGNhdGVnb3J5IGRvIG5vdGF0aW9uXG4gKiBAc2luY2UgMi45LjBcbiAqL1xuZXhwb3J0IHZhciBEbyA9IC8qI19fUFVSRV9fKi8gb2YoXy5lbXB0eVJlY29yZCk7XG4vKipcbiAqIEBjYXRlZ29yeSBkbyBub3RhdGlvblxuICogQHNpbmNlIDIuOC4wXG4gKi9cbmV4cG9ydCB2YXIgYmluZFRvID0gLyojX19QVVJFX18qLyBiaW5kVG9fKEZ1bmN0b3IpO1xudmFyIGxldF8gPSAvKiNfX1BVUkVfXyovIGxldF9fKEZ1bmN0b3IpO1xuZXhwb3J0IHsgXG4vKipcbiAqIEBjYXRlZ29yeSBkbyBub3RhdGlvblxuICogQHNpbmNlIDIuMTMuMFxuICovXG5sZXRfIGFzIGxldCB9O1xuLyoqXG4gKiBAY2F0ZWdvcnkgZG8gbm90YXRpb25cbiAqIEBzaW5jZSAyLjguMFxuICovXG5leHBvcnQgdmFyIGJpbmQgPSAvKiNfX1BVUkVfXyovIGJpbmRfKENoYWluKTtcbi8qKlxuICogQGNhdGVnb3J5IGRvIG5vdGF0aW9uXG4gKiBAc2luY2UgMi44LjBcbiAqL1xuZXhwb3J0IHZhciBhcFMgPSAvKiNfX1BVUkVfXyovIGFwU18oQXBwbHkpO1xuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLy8gdXRpbHNcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8qKlxuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgaGVhZCA9IFJORUEuaGVhZDtcbi8qKlxuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgdGFpbCA9IGZ1bmN0aW9uIChhcykgeyByZXR1cm4gYXMuc2xpY2UoMSk7IH07XG4vKipcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIGxhc3QgPSBSTkVBLmxhc3Q7XG4vKipcbiAqIEdldCBhbGwgYnV0IHRoZSBsYXN0IGVsZW1lbnQgb2YgYSBub24gZW1wdHkgYXJyYXksIGNyZWF0aW5nIGEgbmV3IGFycmF5LlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBpbml0IH0gZnJvbSAnZnAtdHMvTm9uRW1wdHlBcnJheSdcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKGluaXQoWzEsIDIsIDNdKSwgWzEsIDJdKVxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChpbml0KFsxXSksIFtdKVxuICpcbiAqIEBzaW5jZSAyLjIuMFxuICovXG5leHBvcnQgdmFyIGluaXQgPSBmdW5jdGlvbiAoYXMpIHsgcmV0dXJuIGFzLnNsaWNlKDAsIC0xKTsgfTtcbi8qKlxuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgbWluID0gUk5FQS5taW47XG4vKipcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIG1heCA9IFJORUEubWF4O1xuLyoqXG4gKiBAc2luY2UgMi4xMC4wXG4gKi9cbmV4cG9ydCB2YXIgY29uY2F0QWxsID0gZnVuY3Rpb24gKFMpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIHJldHVybiBhcy5yZWR1Y2UoUy5jb25jYXQpO1xuICAgIH07XG59O1xuLyoqXG4gKiBCcmVhayBhbiBgQXJyYXlgIGludG8gaXRzIGZpcnN0IGVsZW1lbnQgYW5kIHJlbWFpbmluZyBlbGVtZW50cy5cbiAqXG4gKiBAY2F0ZWdvcnkgcGF0dGVybiBtYXRjaGluZ1xuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIG1hdGNoTGVmdCA9IGZ1bmN0aW9uIChmKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykge1xuICAgICAgICByZXR1cm4gZihoZWFkKGFzKSwgdGFpbChhcykpO1xuICAgIH07XG59O1xuLyoqXG4gKiBCcmVhayBhbiBgQXJyYXlgIGludG8gaXRzIGluaXRpYWwgZWxlbWVudHMgYW5kIHRoZSBsYXN0IGVsZW1lbnQuXG4gKlxuICogQGNhdGVnb3J5IHBhdHRlcm4gbWF0Y2hpbmdcbiAqIEBzaW5jZSAyLjExLjBcbiAqL1xuZXhwb3J0IHZhciBtYXRjaFJpZ2h0ID0gZnVuY3Rpb24gKGYpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIHJldHVybiBmKGluaXQoYXMpLCBsYXN0KGFzKSk7XG4gICAgfTtcbn07XG4vKipcbiAqIEFwcGx5IGEgZnVuY3Rpb24gdG8gdGhlIGhlYWQsIGNyZWF0aW5nIGEgbmV3IGBOb25FbXB0eUFycmF5YC5cbiAqXG4gKiBAc2luY2UgMi4xMS4wXG4gKi9cbmV4cG9ydCB2YXIgbW9kaWZ5SGVhZCA9IGZ1bmN0aW9uIChmKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykge1xuICAgICAgICByZXR1cm4gX19zcHJlYWRBcnJheShbZihoZWFkKGFzKSldLCB0YWlsKGFzKSwgdHJ1ZSk7XG4gICAgfTtcbn07XG4vKipcbiAqIENoYW5nZSB0aGUgaGVhZCwgY3JlYXRpbmcgYSBuZXcgYE5vbkVtcHR5QXJyYXlgLlxuICpcbiAqIEBzaW5jZSAyLjExLjBcbiAqL1xuZXhwb3J0IHZhciB1cGRhdGVIZWFkID0gZnVuY3Rpb24gKGEpIHsgcmV0dXJuIG1vZGlmeUhlYWQoZnVuY3Rpb24gKCkgeyByZXR1cm4gYTsgfSk7IH07XG4vKipcbiAqIEFwcGx5IGEgZnVuY3Rpb24gdG8gdGhlIGxhc3QgZWxlbWVudCwgY3JlYXRpbmcgYSBuZXcgYE5vbkVtcHR5QXJyYXlgLlxuICpcbiAqIEBzaW5jZSAyLjExLjBcbiAqL1xuZXhwb3J0IHZhciBtb2RpZnlMYXN0ID0gZnVuY3Rpb24gKGYpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIHJldHVybiBwaXBlKGluaXQoYXMpLCBhcHBlbmQoZihsYXN0KGFzKSkpKTtcbiAgICB9O1xufTtcbi8qKlxuICogQ2hhbmdlIHRoZSBsYXN0IGVsZW1lbnQsIGNyZWF0aW5nIGEgbmV3IGBOb25FbXB0eUFycmF5YC5cbiAqXG4gKiBAc2luY2UgMi4xMS4wXG4gKi9cbmV4cG9ydCB2YXIgdXBkYXRlTGFzdCA9IGZ1bmN0aW9uIChhKSB7IHJldHVybiBtb2RpZnlMYXN0KGZ1bmN0aW9uICgpIHsgcmV0dXJuIGE7IH0pOyB9O1xuLyoqXG4gKiBQbGFjZXMgYW4gZWxlbWVudCBpbiBiZXR3ZWVuIG1lbWJlcnMgb2YgYSBgTm9uRW1wdHlBcnJheWAsIHRoZW4gZm9sZHMgdGhlIHJlc3VsdHMgdXNpbmcgdGhlIHByb3ZpZGVkIGBTZW1pZ3JvdXBgLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgKiBhcyBTIGZyb20gJ2ZwLXRzL3N0cmluZydcbiAqIGltcG9ydCB7IGludGVyY2FsYXRlIH0gZnJvbSAnZnAtdHMvTm9uRW1wdHlBcnJheSdcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKGludGVyY2FsYXRlKFMuU2VtaWdyb3VwKSgnLScpKFsnYScsICdiJywgJ2MnXSksICdhLWItYycpXG4gKlxuICogQHNpbmNlIDIuMTIuMFxuICovXG5leHBvcnQgdmFyIGludGVyY2FsYXRlID0gUk5FQS5pbnRlcmNhbGF0ZTtcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8vIGxlZ2FjeVxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLyoqXG4gKiBBbGlhcyBvZiBgZmxhdE1hcGAuXG4gKlxuICogQGNhdGVnb3J5IGxlZ2FjeVxuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgY2hhaW4gPSBmbGF0TWFwO1xuZXhwb3J0IGZ1bmN0aW9uIGdyb3VwU29ydChPKSB7XG4gICAgdmFyIHNvcnRPID0gc29ydChPKTtcbiAgICB2YXIgZ3JvdXBPID0gZ3JvdXAoTyk7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykgeyByZXR1cm4gKGlzTm9uRW1wdHkoYXMpID8gZ3JvdXBPKHNvcnRPKGFzKSkgOiBbXSk7IH07XG59XG5leHBvcnQgZnVuY3Rpb24gZmlsdGVyKHByZWRpY2F0ZSkge1xuICAgIHJldHVybiBmaWx0ZXJXaXRoSW5kZXgoZnVuY3Rpb24gKF8sIGEpIHsgcmV0dXJuIHByZWRpY2F0ZShhKTsgfSk7XG59XG4vKipcbiAqIFVzZSBbYGZpbHRlcldpdGhJbmRleGBdKC4vQXJyYXkudHMuaHRtbCNmaWx0ZXJ3aXRoaW5kZXgpIGluc3RlYWQuXG4gKlxuICogQGNhdGVnb3J5IHpvbmUgb2YgZGVhdGhcbiAqIEBzaW5jZSAyLjAuMFxuICogQGRlcHJlY2F0ZWRcbiAqL1xuZXhwb3J0IHZhciBmaWx0ZXJXaXRoSW5kZXggPSBmdW5jdGlvbiAocHJlZGljYXRlKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykge1xuICAgICAgICByZXR1cm4gZnJvbUFycmF5KGFzLmZpbHRlcihmdW5jdGlvbiAoYSwgaSkgeyByZXR1cm4gcHJlZGljYXRlKGksIGEpOyB9KSk7XG4gICAgfTtcbn07XG4vKipcbiAqIFVzZSBbYHVucHJlcGVuZGBdKCN1bnByZXBlbmQpIGluc3RlYWQuXG4gKlxuICogQGNhdGVnb3J5IHpvbmUgb2YgZGVhdGhcbiAqIEBzaW5jZSAyLjkuMFxuICogQGRlcHJlY2F0ZWRcbiAqL1xuZXhwb3J0IHZhciB1bmNvbnMgPSB1bnByZXBlbmQ7XG4vKipcbiAqIFVzZSBbYHVuYXBwZW5kYF0oI3VuYXBwZW5kKSBpbnN0ZWFkLlxuICpcbiAqIEBjYXRlZ29yeSB6b25lIG9mIGRlYXRoXG4gKiBAc2luY2UgMi45LjBcbiAqIEBkZXByZWNhdGVkXG4gKi9cbmV4cG9ydCB2YXIgdW5zbm9jID0gdW5hcHBlbmQ7XG5leHBvcnQgZnVuY3Rpb24gY29ucyhoZWFkLCB0YWlsKSB7XG4gICAgcmV0dXJuIHRhaWwgPT09IHVuZGVmaW5lZCA/IHByZXBlbmQoaGVhZCkgOiBwaXBlKHRhaWwsIHByZXBlbmQoaGVhZCkpO1xufVxuLyoqXG4gKiBVc2UgW2BhcHBlbmRgXSguL0FycmF5LnRzLmh0bWwjYXBwZW5kKSBpbnN0ZWFkLlxuICpcbiAqIEBjYXRlZ29yeSB6b25lIG9mIGRlYXRoXG4gKiBAc2luY2UgMi4wLjBcbiAqIEBkZXByZWNhdGVkXG4gKi9cbmV4cG9ydCB2YXIgc25vYyA9IGZ1bmN0aW9uIChpbml0LCBlbmQpIHsgcmV0dXJuIHBpcGUoaW5pdCwgYXBwZW5kKGVuZCkpOyB9O1xuLyoqXG4gKiBVc2UgW2BwcmVwZW5kQWxsYF0oI3ByZXBlbmRhbGwpIGluc3RlYWQuXG4gKlxuICogQGNhdGVnb3J5IHpvbmUgb2YgZGVhdGhcbiAqIEBzaW5jZSAyLjkuMFxuICogQGRlcHJlY2F0ZWRcbiAqL1xuZXhwb3J0IHZhciBwcmVwZW5kVG9BbGwgPSBwcmVwZW5kQWxsO1xuLyoqXG4gKiBVc2UgW2Bjb25jYXRBbGxgXSgjY29uY2F0YWxsKSBpbnN0ZWFkLlxuICpcbiAqIEBjYXRlZ29yeSB6b25lIG9mIGRlYXRoXG4gKiBAc2luY2UgMi41LjBcbiAqIEBkZXByZWNhdGVkXG4gKi9cbmV4cG9ydCB2YXIgZm9sZCA9IFJORUEuY29uY2F0QWxsO1xuLyoqXG4gKiBUaGlzIGluc3RhbmNlIGlzIGRlcHJlY2F0ZWQsIHVzZSBzbWFsbCwgc3BlY2lmaWMgaW5zdGFuY2VzIGluc3RlYWQuXG4gKiBGb3IgZXhhbXBsZSBpZiBhIGZ1bmN0aW9uIG5lZWRzIGEgYEZ1bmN0b3JgIGluc3RhbmNlLCBwYXNzIGBORUEuRnVuY3RvcmAgaW5zdGVhZCBvZiBgTkVBLm5vbkVtcHR5QXJyYXlgXG4gKiAod2hlcmUgYE5FQWAgaXMgZnJvbSBgaW1wb3J0IE5FQSBmcm9tICdmcC10cy9Ob25FbXB0eUFycmF5J2ApXG4gKlxuICogQGNhdGVnb3J5IHpvbmUgb2YgZGVhdGhcbiAqIEBzaW5jZSAyLjAuMFxuICogQGRlcHJlY2F0ZWRcbiAqL1xuZXhwb3J0IHZhciBub25FbXB0eUFycmF5ID0ge1xuICAgIFVSSTogVVJJLFxuICAgIG9mOiBvZixcbiAgICBtYXA6IF9tYXAsXG4gICAgbWFwV2l0aEluZGV4OiBfbWFwV2l0aEluZGV4LFxuICAgIGFwOiBfYXAsXG4gICAgY2hhaW46IGZsYXRNYXAsXG4gICAgZXh0ZW5kOiBfZXh0ZW5kLFxuICAgIGV4dHJhY3Q6IGV4dHJhY3QsXG4gICAgcmVkdWNlOiBfcmVkdWNlLFxuICAgIGZvbGRNYXA6IF9mb2xkTWFwLFxuICAgIHJlZHVjZVJpZ2h0OiBfcmVkdWNlUmlnaHQsXG4gICAgdHJhdmVyc2U6IF90cmF2ZXJzZSxcbiAgICBzZXF1ZW5jZTogc2VxdWVuY2UsXG4gICAgcmVkdWNlV2l0aEluZGV4OiBfcmVkdWNlV2l0aEluZGV4LFxuICAgIGZvbGRNYXBXaXRoSW5kZXg6IF9mb2xkTWFwV2l0aEluZGV4LFxuICAgIHJlZHVjZVJpZ2h0V2l0aEluZGV4OiBfcmVkdWNlUmlnaHRXaXRoSW5kZXgsXG4gICAgdHJhdmVyc2VXaXRoSW5kZXg6IF90cmF2ZXJzZVdpdGhJbmRleCxcbiAgICBhbHQ6IF9hbHRcbn07XG4iLAogICJ2YXIgX19zcHJlYWRBcnJheSA9ICh0aGlzICYmIHRoaXMuX19zcHJlYWRBcnJheSkgfHwgZnVuY3Rpb24gKHRvLCBmcm9tLCBwYWNrKSB7XG4gICAgaWYgKHBhY2sgfHwgYXJndW1lbnRzLmxlbmd0aCA9PT0gMikgZm9yICh2YXIgaSA9IDAsIGwgPSBmcm9tLmxlbmd0aCwgYXI7IGkgPCBsOyBpKyspIHtcbiAgICAgICAgaWYgKGFyIHx8ICEoaSBpbiBmcm9tKSkge1xuICAgICAgICAgICAgaWYgKCFhcikgYXIgPSBBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChmcm9tLCAwLCBpKTtcbiAgICAgICAgICAgIGFyW2ldID0gZnJvbVtpXTtcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gdG8uY29uY2F0KGFyIHx8IEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGZyb20pKTtcbn07XG5pbXBvcnQgeyBhcEZpcnN0IGFzIGFwRmlyc3RfLCBhcFMgYXMgYXBTXywgYXBTZWNvbmQgYXMgYXBTZWNvbmRfIH0gZnJvbSAnLi9BcHBseSc7XG5pbXBvcnQgeyBiaW5kIGFzIGJpbmRfLCBjaGFpbkZpcnN0IGFzIGNoYWluRmlyc3RfIH0gZnJvbSAnLi9DaGFpbic7XG5pbXBvcnQgeyBkdWFsLCBpZGVudGl0eSwgcGlwZSB9IGZyb20gJy4vZnVuY3Rpb24nO1xuaW1wb3J0IHsgYmluZFRvIGFzIGJpbmRUb18sIGZsYXAgYXMgZmxhcF8sIGxldCBhcyBsZXRfXyB9IGZyb20gJy4vRnVuY3Rvcic7XG5pbXBvcnQgKiBhcyBfIGZyb20gJy4vaW50ZXJuYWwnO1xuaW1wb3J0IHsgZ2V0TW9ub2lkIH0gZnJvbSAnLi9PcmQnO1xuaW1wb3J0ICogYXMgUk5FQSBmcm9tICcuL1JlYWRvbmx5Tm9uRW1wdHlBcnJheSc7XG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vLyBpbnRlcm5hbFxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLyoqXG4gKiBAaW50ZXJuYWxcbiAqL1xuZXhwb3J0IHZhciBpc05vbkVtcHR5ID0gZnVuY3Rpb24gKGFzKSB7IHJldHVybiBhcy5sZW5ndGggPiAwOyB9O1xuLyoqXG4gKiBAaW50ZXJuYWxcbiAqL1xuZXhwb3J0IHZhciBpc091dE9mQm91bmQgPSBmdW5jdGlvbiAoaSwgYXMpIHsgcmV0dXJuIGkgPCAwIHx8IGkgPj0gYXMubGVuZ3RoOyB9O1xuLyoqXG4gKiBAaW50ZXJuYWxcbiAqL1xuZXhwb3J0IHZhciBwcmVwZW5kVyA9IGZ1bmN0aW9uIChoZWFkKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uICh0YWlsKSB7XG4gICAgICAgIHJldHVybiBfX3NwcmVhZEFycmF5KFtoZWFkXSwgdGFpbCwgdHJ1ZSk7XG4gICAgfTtcbn07XG4vKipcbiAqIEBpbnRlcm5hbFxuICovXG5leHBvcnQgdmFyIHByZXBlbmQgPSBwcmVwZW5kVztcbi8qKlxuICogQGludGVybmFsXG4gKi9cbmV4cG9ydCB2YXIgYXBwZW5kVyA9IGZ1bmN0aW9uIChlbmQpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGluaXQpIHtcbiAgICAgICAgcmV0dXJuIF9fc3ByZWFkQXJyYXkoX19zcHJlYWRBcnJheShbXSwgaW5pdCwgdHJ1ZSksIFtlbmRdLCBmYWxzZSk7XG4gICAgfTtcbn07XG4vKipcbiAqIEBpbnRlcm5hbFxuICovXG5leHBvcnQgdmFyIGFwcGVuZCA9IGFwcGVuZFc7XG4vKipcbiAqIEBpbnRlcm5hbFxuICovXG5leHBvcnQgdmFyIHVuc2FmZUluc2VydEF0ID0gZnVuY3Rpb24gKGksIGEsIGFzKSB7XG4gICAgaWYgKGlzTm9uRW1wdHkoYXMpKSB7XG4gICAgICAgIHZhciB4cyA9IGZyb21SZWFkb25seU5vbkVtcHR5QXJyYXkoYXMpO1xuICAgICAgICB4cy5zcGxpY2UoaSwgMCwgYSk7XG4gICAgICAgIHJldHVybiB4cztcbiAgICB9XG4gICAgcmV0dXJuIFthXTtcbn07XG4vKipcbiAqIEBpbnRlcm5hbFxuICovXG5leHBvcnQgdmFyIHVuc2FmZVVwZGF0ZUF0ID0gZnVuY3Rpb24gKGksIGEsIGFzKSB7XG4gICAgdmFyIHhzID0gZnJvbVJlYWRvbmx5Tm9uRW1wdHlBcnJheShhcyk7XG4gICAgeHNbaV0gPSBhO1xuICAgIHJldHVybiB4cztcbn07XG4vKipcbiAqIFJlbW92ZSBkdXBsaWNhdGVzIGZyb20gYSBgTm9uRW1wdHlBcnJheWAsIGtlZXBpbmcgdGhlIGZpcnN0IG9jY3VycmVuY2Ugb2YgYW4gZWxlbWVudC5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgdW5pcSB9IGZyb20gJ2ZwLXRzL05vbkVtcHR5QXJyYXknXG4gKiBpbXBvcnQgKiBhcyBOIGZyb20gJ2ZwLXRzL251bWJlcidcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKHVuaXEoTi5FcSkoWzEsIDIsIDFdKSwgWzEsIDJdKVxuICpcbiAqIEBzaW5jZSAyLjExLjBcbiAqL1xuZXhwb3J0IHZhciB1bmlxID0gZnVuY3Rpb24gKEUpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIGlmIChhcy5sZW5ndGggPT09IDEpIHtcbiAgICAgICAgICAgIHJldHVybiBjb3B5KGFzKTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgb3V0ID0gW2hlYWQoYXMpXTtcbiAgICAgICAgdmFyIHJlc3QgPSB0YWlsKGFzKTtcbiAgICAgICAgdmFyIF9sb29wXzEgPSBmdW5jdGlvbiAoYSkge1xuICAgICAgICAgICAgaWYgKG91dC5ldmVyeShmdW5jdGlvbiAobykgeyByZXR1cm4gIUUuZXF1YWxzKG8sIGEpOyB9KSkge1xuICAgICAgICAgICAgICAgIG91dC5wdXNoKGEpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICBmb3IgKHZhciBfaSA9IDAsIHJlc3RfMSA9IHJlc3Q7IF9pIDwgcmVzdF8xLmxlbmd0aDsgX2krKykge1xuICAgICAgICAgICAgdmFyIGEgPSByZXN0XzFbX2ldO1xuICAgICAgICAgICAgX2xvb3BfMShhKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gb3V0O1xuICAgIH07XG59O1xuLyoqXG4gKiBTb3J0IHRoZSBlbGVtZW50cyBvZiBhIGBOb25FbXB0eUFycmF5YCBpbiBpbmNyZWFzaW5nIG9yZGVyLCB3aGVyZSBlbGVtZW50cyBhcmUgY29tcGFyZWQgdXNpbmcgZmlyc3QgYG9yZHNbMF1gLCB0aGVuIGBvcmRzWzFdYCxcbiAqIGV0Yy4uLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgKiBhcyBORUEgZnJvbSAnZnAtdHMvTm9uRW1wdHlBcnJheSdcbiAqIGltcG9ydCB7IGNvbnRyYW1hcCB9IGZyb20gJ2ZwLXRzL09yZCdcbiAqIGltcG9ydCAqIGFzIFMgZnJvbSAnZnAtdHMvc3RyaW5nJ1xuICogaW1wb3J0ICogYXMgTiBmcm9tICdmcC10cy9udW1iZXInXG4gKiBpbXBvcnQgeyBwaXBlIH0gZnJvbSAnZnAtdHMvZnVuY3Rpb24nXG4gKlxuICogaW50ZXJmYWNlIFBlcnNvbiB7XG4gKiAgIG5hbWU6IHN0cmluZ1xuICogICBhZ2U6IG51bWJlclxuICogfVxuICpcbiAqIGNvbnN0IGJ5TmFtZSA9IHBpcGUoUy5PcmQsIGNvbnRyYW1hcCgocDogUGVyc29uKSA9PiBwLm5hbWUpKVxuICpcbiAqIGNvbnN0IGJ5QWdlID0gcGlwZShOLk9yZCwgY29udHJhbWFwKChwOiBQZXJzb24pID0+IHAuYWdlKSlcbiAqXG4gKiBjb25zdCBzb3J0QnlOYW1lQnlBZ2UgPSBORUEuc29ydEJ5KFtieU5hbWUsIGJ5QWdlXSlcbiAqXG4gKiBjb25zdCBwZXJzb25zOiBORUEuTm9uRW1wdHlBcnJheTxQZXJzb24+ID0gW1xuICogICB7IG5hbWU6ICdhJywgYWdlOiAxIH0sXG4gKiAgIHsgbmFtZTogJ2InLCBhZ2U6IDMgfSxcbiAqICAgeyBuYW1lOiAnYycsIGFnZTogMiB9LFxuICogICB7IG5hbWU6ICdiJywgYWdlOiAyIH1cbiAqIF1cbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKHNvcnRCeU5hbWVCeUFnZShwZXJzb25zKSwgW1xuICogICB7IG5hbWU6ICdhJywgYWdlOiAxIH0sXG4gKiAgIHsgbmFtZTogJ2InLCBhZ2U6IDIgfSxcbiAqICAgeyBuYW1lOiAnYicsIGFnZTogMyB9LFxuICogICB7IG5hbWU6ICdjJywgYWdlOiAyIH1cbiAqIF0pXG4gKlxuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIHNvcnRCeSA9IGZ1bmN0aW9uIChvcmRzKSB7XG4gICAgaWYgKGlzTm9uRW1wdHkob3JkcykpIHtcbiAgICAgICAgdmFyIE0gPSBnZXRNb25vaWQoKTtcbiAgICAgICAgcmV0dXJuIHNvcnQob3Jkcy5yZWR1Y2UoTS5jb25jYXQsIE0uZW1wdHkpKTtcbiAgICB9XG4gICAgcmV0dXJuIGNvcHk7XG59O1xuLyoqXG4gKiBAc2luY2UgMi4xMS4wXG4gKi9cbmV4cG9ydCB2YXIgdW5pb24gPSBmdW5jdGlvbiAoRSkge1xuICAgIHZhciB1bmlxRSA9IHVuaXEoRSk7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChzZWNvbmQpIHsgcmV0dXJuIGZ1bmN0aW9uIChmaXJzdCkgeyByZXR1cm4gdW5pcUUocGlwZShmaXJzdCwgY29uY2F0KHNlY29uZCkpKTsgfTsgfTtcbn07XG4vKipcbiAqIFJvdGF0ZSBhIGBOb25FbXB0eUFycmF5YCBieSBgbmAgc3RlcHMuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IHJvdGF0ZSB9IGZyb20gJ2ZwLXRzL05vbkVtcHR5QXJyYXknXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChyb3RhdGUoMikoWzEsIDIsIDMsIDQsIDVdKSwgWzQsIDUsIDEsIDIsIDNdKVxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChyb3RhdGUoLTIpKFsxLCAyLCAzLCA0LCA1XSksIFszLCA0LCA1LCAxLCAyXSlcbiAqXG4gKiBAc2luY2UgMi4xMS4wXG4gKi9cbmV4cG9ydCB2YXIgcm90YXRlID0gZnVuY3Rpb24gKG4pIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIHZhciBsZW4gPSBhcy5sZW5ndGg7XG4gICAgICAgIHZhciBtID0gTWF0aC5yb3VuZChuKSAlIGxlbjtcbiAgICAgICAgaWYgKGlzT3V0T2ZCb3VuZChNYXRoLmFicyhtKSwgYXMpIHx8IG0gPT09IDApIHtcbiAgICAgICAgICAgIHJldHVybiBjb3B5KGFzKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAobSA8IDApIHtcbiAgICAgICAgICAgIHZhciBfYSA9IHNwbGl0QXQoLW0pKGFzKSwgZiA9IF9hWzBdLCBzID0gX2FbMV07XG4gICAgICAgICAgICByZXR1cm4gcGlwZShzLCBjb25jYXQoZikpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuIHJvdGF0ZShtIC0gbGVuKShhcyk7XG4gICAgICAgIH1cbiAgICB9O1xufTtcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8vIGNvbnN0cnVjdG9yc1xuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLyoqXG4gKiBAY2F0ZWdvcnkgY29udmVyc2lvbnNcbiAqIEBzaW5jZSAyLjEwLjBcbiAqL1xuZXhwb3J0IHZhciBmcm9tUmVhZG9ubHlOb25FbXB0eUFycmF5ID0gXy5mcm9tUmVhZG9ubHlOb25FbXB0eUFycmF5O1xuLyoqXG4gKiBCdWlsZHMgYSBgTm9uRW1wdHlBcnJheWAgZnJvbSBhbiBgQXJyYXlgIHJldHVybmluZyBgbm9uZWAgaWYgYGFzYCBpcyBhbiBlbXB0eSBhcnJheVxuICpcbiAqIEBjYXRlZ29yeSBjb252ZXJzaW9uc1xuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgZnJvbUFycmF5ID0gZnVuY3Rpb24gKGFzKSB7IHJldHVybiAoaXNOb25FbXB0eShhcykgPyBfLnNvbWUoYXMpIDogXy5ub25lKTsgfTtcbi8qKlxuICogUmV0dXJuIGEgYE5vbkVtcHR5QXJyYXlgIG9mIGxlbmd0aCBgbmAgd2l0aCBlbGVtZW50IGBpYCBpbml0aWFsaXplZCB3aXRoIGBmKGkpYC5cbiAqXG4gKiAqKk5vdGUqKi4gYG5gIGlzIG5vcm1hbGl6ZWQgdG8gYSBuYXR1cmFsIG51bWJlci5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgbWFrZUJ5IH0gZnJvbSAnZnAtdHMvTm9uRW1wdHlBcnJheSdcbiAqIGltcG9ydCB7IHBpcGUgfSBmcm9tICdmcC10cy9mdW5jdGlvbidcbiAqXG4gKiBjb25zdCBkb3VibGUgPSAobjogbnVtYmVyKTogbnVtYmVyID0+IG4gKiAyXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKHBpcGUoNSwgbWFrZUJ5KGRvdWJsZSkpLCBbMCwgMiwgNCwgNiwgOF0pXG4gKlxuICogQGNhdGVnb3J5IGNvbnN0cnVjdG9yc1xuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIG1ha2VCeSA9IGZ1bmN0aW9uIChmKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChuKSB7XG4gICAgICAgIHZhciBqID0gTWF0aC5tYXgoMCwgTWF0aC5mbG9vcihuKSk7XG4gICAgICAgIHZhciBvdXQgPSBbZigwKV07XG4gICAgICAgIGZvciAodmFyIGkgPSAxOyBpIDwgajsgaSsrKSB7XG4gICAgICAgICAgICBvdXQucHVzaChmKGkpKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gb3V0O1xuICAgIH07XG59O1xuLyoqXG4gKiBDcmVhdGUgYSBgTm9uRW1wdHlBcnJheWAgY29udGFpbmluZyBhIHZhbHVlIHJlcGVhdGVkIHRoZSBzcGVjaWZpZWQgbnVtYmVyIG9mIHRpbWVzLlxuICpcbiAqICoqTm90ZSoqLiBgbmAgaXMgbm9ybWFsaXplZCB0byBhIG5hdHVyYWwgbnVtYmVyLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyByZXBsaWNhdGUgfSBmcm9tICdmcC10cy9Ob25FbXB0eUFycmF5J1xuICogaW1wb3J0IHsgcGlwZSB9IGZyb20gJ2ZwLXRzL2Z1bmN0aW9uJ1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwocGlwZSgzLCByZXBsaWNhdGUoJ2EnKSksIFsnYScsICdhJywgJ2EnXSlcbiAqXG4gKiBAY2F0ZWdvcnkgY29uc3RydWN0b3JzXG4gKiBAc2luY2UgMi4xMS4wXG4gKi9cbmV4cG9ydCB2YXIgcmVwbGljYXRlID0gZnVuY3Rpb24gKGEpIHsgcmV0dXJuIG1ha2VCeShmdW5jdGlvbiAoKSB7IHJldHVybiBhOyB9KTsgfTtcbi8qKlxuICogQ3JlYXRlIGEgYE5vbkVtcHR5QXJyYXlgIGNvbnRhaW5pbmcgYSByYW5nZSBvZiBpbnRlZ2VycywgaW5jbHVkaW5nIGJvdGggZW5kcG9pbnRzLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyByYW5nZSB9IGZyb20gJ2ZwLXRzL05vbkVtcHR5QXJyYXknXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChyYW5nZSgxLCA1KSwgWzEsIDIsIDMsIDQsIDVdKVxuICpcbiAqIEBjYXRlZ29yeSBjb25zdHJ1Y3RvcnNcbiAqIEBzaW5jZSAyLjExLjBcbiAqL1xuZXhwb3J0IHZhciByYW5nZSA9IGZ1bmN0aW9uIChzdGFydCwgZW5kKSB7XG4gICAgcmV0dXJuIHN0YXJ0IDw9IGVuZCA/IG1ha2VCeShmdW5jdGlvbiAoaSkgeyByZXR1cm4gc3RhcnQgKyBpOyB9KShlbmQgLSBzdGFydCArIDEpIDogW3N0YXJ0XTtcbn07XG4vKipcbiAqIFJldHVybiB0aGUgdHVwbGUgb2YgdGhlIGBoZWFkYCBhbmQgdGhlIGB0YWlsYC5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgdW5wcmVwZW5kIH0gZnJvbSAnZnAtdHMvTm9uRW1wdHlBcnJheSdcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKHVucHJlcGVuZChbMSwgMiwgM10pLCBbMSwgWzIsIDNdXSlcbiAqXG4gKiBAc2luY2UgMi45LjBcbiAqL1xuZXhwb3J0IHZhciB1bnByZXBlbmQgPSBmdW5jdGlvbiAoYXMpIHsgcmV0dXJuIFtoZWFkKGFzKSwgdGFpbChhcyldOyB9O1xuLyoqXG4gKiBSZXR1cm4gdGhlIHR1cGxlIG9mIHRoZSBgaW5pdGAgYW5kIHRoZSBgbGFzdGAuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IHVuYXBwZW5kIH0gZnJvbSAnZnAtdHMvTm9uRW1wdHlBcnJheSdcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKHVuYXBwZW5kKFsxLCAyLCAzLCA0XSksIFtbMSwgMiwgM10sIDRdKVxuICpcbiAqIEBzaW5jZSAyLjkuMFxuICovXG5leHBvcnQgdmFyIHVuYXBwZW5kID0gZnVuY3Rpb24gKGFzKSB7IHJldHVybiBbaW5pdChhcyksIGxhc3QoYXMpXTsgfTtcbmV4cG9ydCBmdW5jdGlvbiBjb25jYXRXKHNlY29uZCkge1xuICAgIHJldHVybiBmdW5jdGlvbiAoZmlyc3QpIHsgcmV0dXJuIGZpcnN0LmNvbmNhdChzZWNvbmQpOyB9O1xufVxuZXhwb3J0IGZ1bmN0aW9uIGNvbmNhdCh4LCB5KSB7XG4gICAgcmV0dXJuIHkgPyB4LmNvbmNhdCh5KSA6IGZ1bmN0aW9uICh5KSB7IHJldHVybiB5LmNvbmNhdCh4KTsgfTtcbn1cbi8qKlxuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgcmV2ZXJzZSA9IGZ1bmN0aW9uIChhcykgeyByZXR1cm4gX19zcHJlYWRBcnJheShbbGFzdChhcyldLCBhcy5zbGljZSgwLCAtMSkucmV2ZXJzZSgpLCB0cnVlKTsgfTtcbmV4cG9ydCBmdW5jdGlvbiBncm91cChFKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykge1xuICAgICAgICB2YXIgbGVuID0gYXMubGVuZ3RoO1xuICAgICAgICBpZiAobGVuID09PSAwKSB7XG4gICAgICAgICAgICByZXR1cm4gW107XG4gICAgICAgIH1cbiAgICAgICAgdmFyIG91dCA9IFtdO1xuICAgICAgICB2YXIgaGVhZCA9IGFzWzBdO1xuICAgICAgICB2YXIgbmVhID0gW2hlYWRdO1xuICAgICAgICBmb3IgKHZhciBpID0gMTsgaSA8IGxlbjsgaSsrKSB7XG4gICAgICAgICAgICB2YXIgYSA9IGFzW2ldO1xuICAgICAgICAgICAgaWYgKEUuZXF1YWxzKGEsIGhlYWQpKSB7XG4gICAgICAgICAgICAgICAgbmVhLnB1c2goYSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBvdXQucHVzaChuZWEpO1xuICAgICAgICAgICAgICAgIGhlYWQgPSBhO1xuICAgICAgICAgICAgICAgIG5lYSA9IFtoZWFkXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBvdXQucHVzaChuZWEpO1xuICAgICAgICByZXR1cm4gb3V0O1xuICAgIH07XG59XG4vKipcbiAqIFNwbGl0cyBhbiBhcnJheSBpbnRvIHN1Yi1ub24tZW1wdHktYXJyYXlzIHN0b3JlZCBpbiBhbiBvYmplY3QsIGJhc2VkIG9uIHRoZSByZXN1bHQgb2YgY2FsbGluZyBhIGBzdHJpbmdgLXJldHVybmluZ1xuICogZnVuY3Rpb24gb24gZWFjaCBlbGVtZW50LCBhbmQgZ3JvdXBpbmcgdGhlIHJlc3VsdHMgYWNjb3JkaW5nIHRvIHZhbHVlcyByZXR1cm5lZFxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBncm91cEJ5IH0gZnJvbSAnZnAtdHMvTm9uRW1wdHlBcnJheSdcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKGdyb3VwQnkoKHM6IHN0cmluZykgPT4gU3RyaW5nKHMubGVuZ3RoKSkoWydhJywgJ2InLCAnYWInXSksIHtcbiAqICAgJzEnOiBbJ2EnLCAnYiddLFxuICogICAnMic6IFsnYWInXVxuICogfSlcbiAqXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciBncm91cEJ5ID0gZnVuY3Rpb24gKGYpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIHZhciBvdXQgPSB7fTtcbiAgICAgICAgZm9yICh2YXIgX2kgPSAwLCBhc18xID0gYXM7IF9pIDwgYXNfMS5sZW5ndGg7IF9pKyspIHtcbiAgICAgICAgICAgIHZhciBhID0gYXNfMVtfaV07XG4gICAgICAgICAgICB2YXIgayA9IGYoYSk7XG4gICAgICAgICAgICBpZiAoXy5oYXMuY2FsbChvdXQsIGspKSB7XG4gICAgICAgICAgICAgICAgb3V0W2tdLnB1c2goYSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBvdXRba10gPSBbYV07XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG91dDtcbiAgICB9O1xufTtcbi8qKlxuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgc29ydCA9IGZ1bmN0aW9uIChPKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykge1xuICAgICAgICByZXR1cm4gYXMuc2xpY2UoKS5zb3J0KE8uY29tcGFyZSk7XG4gICAgfTtcbn07XG4vKipcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIGluc2VydEF0ID0gZnVuY3Rpb24gKGksIGEpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIHJldHVybiBpIDwgMCB8fCBpID4gYXMubGVuZ3RoID8gXy5ub25lIDogXy5zb21lKHVuc2FmZUluc2VydEF0KGksIGEsIGFzKSk7XG4gICAgfTtcbn07XG4vKipcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIHVwZGF0ZUF0ID0gZnVuY3Rpb24gKGksIGEpIHtcbiAgICByZXR1cm4gbW9kaWZ5QXQoaSwgZnVuY3Rpb24gKCkgeyByZXR1cm4gYTsgfSk7XG59O1xuLyoqXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciBtb2RpZnlBdCA9IGZ1bmN0aW9uIChpLCBmKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykge1xuICAgICAgICByZXR1cm4gaXNPdXRPZkJvdW5kKGksIGFzKSA/IF8ubm9uZSA6IF8uc29tZSh1bnNhZmVVcGRhdGVBdChpLCBmKGFzW2ldKSwgYXMpKTtcbiAgICB9O1xufTtcbi8qKlxuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgY29weSA9IGZyb21SZWFkb25seU5vbkVtcHR5QXJyYXk7XG4vKipcbiAqIEBjYXRlZ29yeSBjb25zdHJ1Y3RvcnNcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIG9mID0gZnVuY3Rpb24gKGEpIHsgcmV0dXJuIFthXTsgfTtcbi8qKlxuICogQHNpbmNlIDIuNS4xXG4gKi9cbmV4cG9ydCB2YXIgemlwV2l0aCA9IGZ1bmN0aW9uIChhcywgYnMsIGYpIHtcbiAgICB2YXIgY3MgPSBbZihhc1swXSwgYnNbMF0pXTtcbiAgICB2YXIgbGVuID0gTWF0aC5taW4oYXMubGVuZ3RoLCBicy5sZW5ndGgpO1xuICAgIGZvciAodmFyIGkgPSAxOyBpIDwgbGVuOyBpKyspIHtcbiAgICAgICAgY3NbaV0gPSBmKGFzW2ldLCBic1tpXSk7XG4gICAgfVxuICAgIHJldHVybiBjcztcbn07XG5leHBvcnQgZnVuY3Rpb24gemlwKGFzLCBicykge1xuICAgIGlmIChicyA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgIHJldHVybiBmdW5jdGlvbiAoYnMpIHsgcmV0dXJuIHppcChicywgYXMpOyB9O1xuICAgIH1cbiAgICByZXR1cm4gemlwV2l0aChhcywgYnMsIGZ1bmN0aW9uIChhLCBiKSB7IHJldHVybiBbYSwgYl07IH0pO1xufVxuLyoqXG4gKiBAc2luY2UgMi41LjFcbiAqL1xuZXhwb3J0IHZhciB1bnppcCA9IGZ1bmN0aW9uIChhYnMpIHtcbiAgICB2YXIgZmEgPSBbYWJzWzBdWzBdXTtcbiAgICB2YXIgZmIgPSBbYWJzWzBdWzFdXTtcbiAgICBmb3IgKHZhciBpID0gMTsgaSA8IGFicy5sZW5ndGg7IGkrKykge1xuICAgICAgICBmYVtpXSA9IGFic1tpXVswXTtcbiAgICAgICAgZmJbaV0gPSBhYnNbaV1bMV07XG4gICAgfVxuICAgIHJldHVybiBbZmEsIGZiXTtcbn07XG4vKipcbiAqIFByZXBlbmQgYW4gZWxlbWVudCB0byBldmVyeSBtZW1iZXIgb2YgYW4gYXJyYXlcbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgcHJlcGVuZEFsbCB9IGZyb20gJ2ZwLXRzL05vbkVtcHR5QXJyYXknXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChwcmVwZW5kQWxsKDkpKFsxLCAyLCAzLCA0XSksIFs5LCAxLCA5LCAyLCA5LCAzLCA5LCA0XSlcbiAqXG4gKiBAc2luY2UgMi4xMC4wXG4gKi9cbmV4cG9ydCB2YXIgcHJlcGVuZEFsbCA9IGZ1bmN0aW9uIChtaWRkbGUpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIHZhciBvdXQgPSBbbWlkZGxlLCBhc1swXV07XG4gICAgICAgIGZvciAodmFyIGkgPSAxOyBpIDwgYXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIG91dC5wdXNoKG1pZGRsZSwgYXNbaV0pO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBvdXQ7XG4gICAgfTtcbn07XG4vKipcbiAqIFBsYWNlcyBhbiBlbGVtZW50IGluIGJldHdlZW4gbWVtYmVycyBvZiBhbiBhcnJheVxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBpbnRlcnNwZXJzZSB9IGZyb20gJ2ZwLXRzL05vbkVtcHR5QXJyYXknXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChpbnRlcnNwZXJzZSg5KShbMSwgMiwgMywgNF0pLCBbMSwgOSwgMiwgOSwgMywgOSwgNF0pXG4gKlxuICogQHNpbmNlIDIuOS4wXG4gKi9cbmV4cG9ydCB2YXIgaW50ZXJzcGVyc2UgPSBmdW5jdGlvbiAobWlkZGxlKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykge1xuICAgICAgICB2YXIgcmVzdCA9IHRhaWwoYXMpO1xuICAgICAgICByZXR1cm4gaXNOb25FbXB0eShyZXN0KSA/IHBpcGUocmVzdCwgcHJlcGVuZEFsbChtaWRkbGUpLCBwcmVwZW5kKGhlYWQoYXMpKSkgOiBjb3B5KGFzKTtcbiAgICB9O1xufTtcbi8qKlxuICogQGNhdGVnb3J5IGZvbGRpbmdcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIGZvbGRNYXBXaXRoSW5kZXggPSBSTkVBLmZvbGRNYXBXaXRoSW5kZXg7XG4vKipcbiAqIEBjYXRlZ29yeSBmb2xkaW5nXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciBmb2xkTWFwID0gUk5FQS5mb2xkTWFwO1xuLyoqXG4gKiBAY2F0ZWdvcnkgc2VxdWVuY2luZ1xuICogQHNpbmNlIDIuMTAuMFxuICovXG5leHBvcnQgdmFyIGNoYWluV2l0aEluZGV4ID0gZnVuY3Rpb24gKGYpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIHZhciBvdXQgPSBmcm9tUmVhZG9ubHlOb25FbXB0eUFycmF5KGYoMCwgaGVhZChhcykpKTtcbiAgICAgICAgZm9yICh2YXIgaSA9IDE7IGkgPCBhcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgb3V0LnB1c2guYXBwbHkob3V0LCBmKGksIGFzW2ldKSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG91dDtcbiAgICB9O1xufTtcbi8qKlxuICogQHNpbmNlIDIuMTAuMFxuICovXG5leHBvcnQgdmFyIGNob3AgPSBmdW5jdGlvbiAoZikge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgdmFyIF9hID0gZihhcyksIGIgPSBfYVswXSwgcmVzdCA9IF9hWzFdO1xuICAgICAgICB2YXIgb3V0ID0gW2JdO1xuICAgICAgICB2YXIgbmV4dCA9IHJlc3Q7XG4gICAgICAgIHdoaWxlIChpc05vbkVtcHR5KG5leHQpKSB7XG4gICAgICAgICAgICB2YXIgX2IgPSBmKG5leHQpLCBiXzEgPSBfYlswXSwgcmVzdF8yID0gX2JbMV07XG4gICAgICAgICAgICBvdXQucHVzaChiXzEpO1xuICAgICAgICAgICAgbmV4dCA9IHJlc3RfMjtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gb3V0O1xuICAgIH07XG59O1xuLyoqXG4gKiBTcGxpdHMgYSBgTm9uRW1wdHlBcnJheWAgaW50byB0d28gcGllY2VzLCB0aGUgZmlyc3QgcGllY2UgaGFzIG1heCBgbmAgZWxlbWVudHMuXG4gKlxuICogQHNpbmNlIDIuMTAuMFxuICovXG5leHBvcnQgdmFyIHNwbGl0QXQgPSBmdW5jdGlvbiAobikge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgdmFyIG0gPSBNYXRoLm1heCgxLCBuKTtcbiAgICAgICAgcmV0dXJuIG0gPj0gYXMubGVuZ3RoID8gW2NvcHkoYXMpLCBbXV0gOiBbcGlwZShhcy5zbGljZSgxLCBtKSwgcHJlcGVuZChoZWFkKGFzKSkpLCBhcy5zbGljZShtKV07XG4gICAgfTtcbn07XG4vKipcbiAqIEBzaW5jZSAyLjEwLjBcbiAqL1xuZXhwb3J0IHZhciBjaHVua3NPZiA9IGZ1bmN0aW9uIChuKSB7IHJldHVybiBjaG9wKHNwbGl0QXQobikpOyB9O1xuLyogaXN0YW5idWwgaWdub3JlIG5leHQgKi9cbnZhciBfbWFwID0gZnVuY3Rpb24gKGZhLCBmKSB7IHJldHVybiBwaXBlKGZhLCBtYXAoZikpOyB9O1xuLyogaXN0YW5idWwgaWdub3JlIG5leHQgKi9cbnZhciBfbWFwV2l0aEluZGV4ID0gZnVuY3Rpb24gKGZhLCBmKSB7IHJldHVybiBwaXBlKGZhLCBtYXBXaXRoSW5kZXgoZikpOyB9O1xuLyogaXN0YW5idWwgaWdub3JlIG5leHQgKi9cbnZhciBfYXAgPSBmdW5jdGlvbiAoZmFiLCBmYSkgeyByZXR1cm4gcGlwZShmYWIsIGFwKGZhKSk7IH07XG4vKiBpc3RhbmJ1bCBpZ25vcmUgbmV4dCAqL1xudmFyIF9leHRlbmQgPSBmdW5jdGlvbiAod2EsIGYpIHsgcmV0dXJuIHBpcGUod2EsIGV4dGVuZChmKSk7IH07XG4vKiBpc3RhbmJ1bCBpZ25vcmUgbmV4dCAqL1xudmFyIF9yZWR1Y2UgPSBmdW5jdGlvbiAoZmEsIGIsIGYpIHsgcmV0dXJuIHBpcGUoZmEsIHJlZHVjZShiLCBmKSk7IH07XG4vKiBpc3RhbmJ1bCBpZ25vcmUgbmV4dCAqL1xudmFyIF9mb2xkTWFwID0gZnVuY3Rpb24gKE0pIHtcbiAgICB2YXIgZm9sZE1hcE0gPSBmb2xkTWFwKE0pO1xuICAgIHJldHVybiBmdW5jdGlvbiAoZmEsIGYpIHsgcmV0dXJuIHBpcGUoZmEsIGZvbGRNYXBNKGYpKTsgfTtcbn07XG4vKiBpc3RhbmJ1bCBpZ25vcmUgbmV4dCAqL1xudmFyIF9yZWR1Y2VSaWdodCA9IGZ1bmN0aW9uIChmYSwgYiwgZikgeyByZXR1cm4gcGlwZShmYSwgcmVkdWNlUmlnaHQoYiwgZikpOyB9O1xuLyogaXN0YW5idWwgaWdub3JlIG5leHQgKi9cbnZhciBfdHJhdmVyc2UgPSBmdW5jdGlvbiAoRikge1xuICAgIHZhciB0cmF2ZXJzZUYgPSB0cmF2ZXJzZShGKTtcbiAgICByZXR1cm4gZnVuY3Rpb24gKHRhLCBmKSB7IHJldHVybiBwaXBlKHRhLCB0cmF2ZXJzZUYoZikpOyB9O1xufTtcbi8qIGlzdGFuYnVsIGlnbm9yZSBuZXh0ICovXG52YXIgX2FsdCA9IGZ1bmN0aW9uIChmYSwgdGhhdCkgeyByZXR1cm4gcGlwZShmYSwgYWx0KHRoYXQpKTsgfTtcbi8qIGlzdGFuYnVsIGlnbm9yZSBuZXh0ICovXG52YXIgX3JlZHVjZVdpdGhJbmRleCA9IGZ1bmN0aW9uIChmYSwgYiwgZikge1xuICAgIHJldHVybiBwaXBlKGZhLCByZWR1Y2VXaXRoSW5kZXgoYiwgZikpO1xufTtcbi8qIGlzdGFuYnVsIGlnbm9yZSBuZXh0ICovXG52YXIgX2ZvbGRNYXBXaXRoSW5kZXggPSBmdW5jdGlvbiAoTSkge1xuICAgIHZhciBmb2xkTWFwV2l0aEluZGV4TSA9IGZvbGRNYXBXaXRoSW5kZXgoTSk7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChmYSwgZikgeyByZXR1cm4gcGlwZShmYSwgZm9sZE1hcFdpdGhJbmRleE0oZikpOyB9O1xufTtcbi8qIGlzdGFuYnVsIGlnbm9yZSBuZXh0ICovXG52YXIgX3JlZHVjZVJpZ2h0V2l0aEluZGV4ID0gZnVuY3Rpb24gKGZhLCBiLCBmKSB7XG4gICAgcmV0dXJuIHBpcGUoZmEsIHJlZHVjZVJpZ2h0V2l0aEluZGV4KGIsIGYpKTtcbn07XG4vKiBpc3RhbmJ1bCBpZ25vcmUgbmV4dCAqL1xudmFyIF90cmF2ZXJzZVdpdGhJbmRleCA9IGZ1bmN0aW9uIChGKSB7XG4gICAgdmFyIHRyYXZlcnNlV2l0aEluZGV4RiA9IHRyYXZlcnNlV2l0aEluZGV4KEYpO1xuICAgIHJldHVybiBmdW5jdGlvbiAodGEsIGYpIHsgcmV0dXJuIHBpcGUodGEsIHRyYXZlcnNlV2l0aEluZGV4RihmKSk7IH07XG59O1xuLyoqXG4gKiBMZXNzIHN0cmljdCB2ZXJzaW9uIG9mIFtgYWx0YF0oI2FsdCkuXG4gKlxuICogVGhlIGBXYCBzdWZmaXggKHNob3J0IGZvciAqKlcqKmlkZW5pbmcpIG1lYW5zIHRoYXQgdGhlIHJldHVybiB0eXBlcyB3aWxsIGJlIG1lcmdlZC5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0ICogYXMgTkVBIGZyb20gJ2ZwLXRzL05vbkVtcHR5QXJyYXknXG4gKiBpbXBvcnQgeyBwaXBlIH0gZnJvbSAnZnAtdHMvZnVuY3Rpb24nXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChcbiAqICAgcGlwZShcbiAqICAgICBbMSwgMiwgM10gYXMgTkVBLk5vbkVtcHR5QXJyYXk8bnVtYmVyPixcbiAqICAgICBORUEuYWx0VygoKSA9PiBbJ2EnLCAnYiddKVxuICogICApLFxuICogICBbMSwgMiwgMywgJ2EnLCAnYiddXG4gKiApXG4gKlxuICogQGNhdGVnb3J5IGVycm9yIGhhbmRsaW5nXG4gKiBAc2luY2UgMi45LjBcbiAqL1xuZXhwb3J0IHZhciBhbHRXID0gZnVuY3Rpb24gKHRoYXQpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIHJldHVybiBwaXBlKGFzLCBjb25jYXRXKHRoYXQoKSkpO1xuICAgIH07XG59O1xuLyoqXG4gKiBJZGVudGlmaWVzIGFuIGFzc29jaWF0aXZlIG9wZXJhdGlvbiBvbiBhIHR5cGUgY29uc3RydWN0b3IuIEl0IGlzIHNpbWlsYXIgdG8gYFNlbWlncm91cGAsIGV4Y2VwdCB0aGF0IGl0IGFwcGxpZXMgdG9cbiAqIHR5cGVzIG9mIGtpbmQgYCogLT4gKmAuXG4gKlxuICogSW4gY2FzZSBvZiBgTm9uRW1wdHlBcnJheWAgY29uY2F0ZW5hdGVzIHRoZSBpbnB1dHMgaW50byBhIHNpbmdsZSBhcnJheS5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0ICogYXMgTkVBIGZyb20gJ2ZwLXRzL05vbkVtcHR5QXJyYXknXG4gKiBpbXBvcnQgeyBwaXBlIH0gZnJvbSAnZnAtdHMvZnVuY3Rpb24nXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChcbiAqICAgcGlwZShcbiAqICAgICBbMSwgMiwgM10sXG4gKiAgICAgTkVBLmFsdCgoKSA9PiBbNCwgNV0pXG4gKiAgICksXG4gKiAgIFsxLCAyLCAzLCA0LCA1XVxuICogKVxuICpcbiAqIEBjYXRlZ29yeSBlcnJvciBoYW5kbGluZ1xuICogQHNpbmNlIDIuNi4yXG4gKi9cbmV4cG9ydCB2YXIgYWx0ID0gYWx0Vztcbi8qKlxuICogQXBwbHkgYSBmdW5jdGlvbiB0byBhbiBhcmd1bWVudCB1bmRlciBhIHR5cGUgY29uc3RydWN0b3IuXG4gKlxuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgYXAgPSBmdW5jdGlvbiAoYXMpIHtcbiAgICByZXR1cm4gZmxhdE1hcChmdW5jdGlvbiAoZikgeyByZXR1cm4gcGlwZShhcywgbWFwKGYpKTsgfSk7XG59O1xuLyoqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0ICogYXMgTkVBIGZyb20gJ2ZwLXRzL05vbkVtcHR5QXJyYXknXG4gKiBpbXBvcnQgeyBwaXBlIH0gZnJvbSAnZnAtdHMvZnVuY3Rpb24nXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChcbiAqICAgcGlwZShcbiAqICAgICBbMSwgMiwgM10sXG4gKiAgICAgTkVBLmZsYXRNYXAoKG4pID0+IFtgYSR7bn1gLCBgYiR7bn1gXSlcbiAqICAgKSxcbiAqICAgWydhMScsICdiMScsICdhMicsICdiMicsICdhMycsICdiMyddXG4gKiApXG4gKlxuICogQGNhdGVnb3J5IHNlcXVlbmNpbmdcbiAqIEBzaW5jZSAyLjE0LjBcbiAqL1xuZXhwb3J0IHZhciBmbGF0TWFwID0gLyojX19QVVJFX18qLyBkdWFsKDIsIGZ1bmN0aW9uIChtYSwgZikge1xuICAgIHJldHVybiBwaXBlKG1hLCBjaGFpbldpdGhJbmRleChmdW5jdGlvbiAoaSwgYSkgeyByZXR1cm4gZihhLCBpKTsgfSkpO1xufSk7XG4vKipcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIGV4dGVuZCA9IGZ1bmN0aW9uIChmKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykge1xuICAgICAgICB2YXIgbmV4dCA9IHRhaWwoYXMpO1xuICAgICAgICB2YXIgb3V0ID0gW2YoYXMpXTtcbiAgICAgICAgd2hpbGUgKGlzTm9uRW1wdHkobmV4dCkpIHtcbiAgICAgICAgICAgIG91dC5wdXNoKGYobmV4dCkpO1xuICAgICAgICAgICAgbmV4dCA9IHRhaWwobmV4dCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG91dDtcbiAgICB9O1xufTtcbi8qKlxuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgZHVwbGljYXRlID0gLyojX19QVVJFX18qLyBleHRlbmQoaWRlbnRpdHkpO1xuLyoqXG4gKiBAY2F0ZWdvcnkgc2VxdWVuY2luZ1xuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgZmxhdHRlbiA9IC8qI19fUFVSRV9fKi8gZmxhdE1hcChpZGVudGl0eSk7XG4vKipcbiAqIGBtYXBgIGNhbiBiZSB1c2VkIHRvIHR1cm4gZnVuY3Rpb25zIGAoYTogQSkgPT4gQmAgaW50byBmdW5jdGlvbnMgYChmYTogRjxBPikgPT4gRjxCPmAgd2hvc2UgYXJndW1lbnQgYW5kIHJldHVybiB0eXBlc1xuICogdXNlIHRoZSB0eXBlIGNvbnN0cnVjdG9yIGBGYCB0byByZXByZXNlbnQgc29tZSBjb21wdXRhdGlvbmFsIGNvbnRleHQuXG4gKlxuICogQGNhdGVnb3J5IG1hcHBpbmdcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIG1hcCA9IGZ1bmN0aW9uIChmKSB7IHJldHVybiBtYXBXaXRoSW5kZXgoZnVuY3Rpb24gKF8sIGEpIHsgcmV0dXJuIGYoYSk7IH0pOyB9O1xuLyoqXG4gKiBAY2F0ZWdvcnkgbWFwcGluZ1xuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgbWFwV2l0aEluZGV4ID0gZnVuY3Rpb24gKGYpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIHZhciBvdXQgPSBbZigwLCBoZWFkKGFzKSldO1xuICAgICAgICBmb3IgKHZhciBpID0gMTsgaSA8IGFzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICBvdXQucHVzaChmKGksIGFzW2ldKSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG91dDtcbiAgICB9O1xufTtcbi8qKlxuICogQGNhdGVnb3J5IGZvbGRpbmdcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIHJlZHVjZSA9IFJORUEucmVkdWNlO1xuLyoqXG4gKiBAY2F0ZWdvcnkgZm9sZGluZ1xuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgcmVkdWNlV2l0aEluZGV4ID0gUk5FQS5yZWR1Y2VXaXRoSW5kZXg7XG4vKipcbiAqIEBjYXRlZ29yeSBmb2xkaW5nXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciByZWR1Y2VSaWdodCA9IFJORUEucmVkdWNlUmlnaHQ7XG4vKipcbiAqIEBjYXRlZ29yeSBmb2xkaW5nXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciByZWR1Y2VSaWdodFdpdGhJbmRleCA9IFJORUEucmVkdWNlUmlnaHRXaXRoSW5kZXg7XG4vKipcbiAqIEBjYXRlZ29yeSB0cmF2ZXJzaW5nXG4gKiBAc2luY2UgMi42LjNcbiAqL1xuZXhwb3J0IHZhciB0cmF2ZXJzZSA9IGZ1bmN0aW9uIChGKSB7XG4gICAgdmFyIHRyYXZlcnNlV2l0aEluZGV4RiA9IHRyYXZlcnNlV2l0aEluZGV4KEYpO1xuICAgIHJldHVybiBmdW5jdGlvbiAoZikgeyByZXR1cm4gdHJhdmVyc2VXaXRoSW5kZXhGKGZ1bmN0aW9uIChfLCBhKSB7IHJldHVybiBmKGEpOyB9KTsgfTtcbn07XG4vKipcbiAqIEBjYXRlZ29yeSB0cmF2ZXJzaW5nXG4gKiBAc2luY2UgMi42LjNcbiAqL1xuZXhwb3J0IHZhciBzZXF1ZW5jZSA9IGZ1bmN0aW9uIChGKSB7IHJldHVybiB0cmF2ZXJzZVdpdGhJbmRleChGKShmdW5jdGlvbiAoXywgYSkgeyByZXR1cm4gYTsgfSk7IH07XG4vKipcbiAqIEBjYXRlZ29yeSBzZXF1ZW5jaW5nXG4gKiBAc2luY2UgMi42LjNcbiAqL1xuZXhwb3J0IHZhciB0cmF2ZXJzZVdpdGhJbmRleCA9IGZ1bmN0aW9uIChGKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChmKSB7XG4gICAgICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgICAgIHZhciBvdXQgPSBGLm1hcChmKDAsIGhlYWQoYXMpKSwgb2YpO1xuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDE7IGkgPCBhcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgIG91dCA9IEYuYXAoRi5tYXAob3V0LCBmdW5jdGlvbiAoYnMpIHsgcmV0dXJuIGZ1bmN0aW9uIChiKSB7IHJldHVybiBwaXBlKGJzLCBhcHBlbmQoYikpOyB9OyB9KSwgZihpLCBhc1tpXSkpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIG91dDtcbiAgICAgICAgfTtcbiAgICB9O1xufTtcbi8qKlxuICogQHNpbmNlIDIuNy4wXG4gKi9cbmV4cG9ydCB2YXIgZXh0cmFjdCA9IFJORUEuaGVhZDtcbi8qKlxuICogQGNhdGVnb3J5IHR5cGUgbGFtYmRhc1xuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgVVJJID0gJ05vbkVtcHR5QXJyYXknO1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciBnZXRTaG93ID0gUk5FQS5nZXRTaG93O1xuLyoqXG4gKiBCdWlsZHMgYSBgU2VtaWdyb3VwYCBpbnN0YW5jZSBmb3IgYE5vbkVtcHR5QXJyYXlgXG4gKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgZ2V0U2VtaWdyb3VwID0gZnVuY3Rpb24gKCkgeyByZXR1cm4gKHtcbiAgICBjb25jYXQ6IGNvbmNhdFxufSk7IH07XG4vKipcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBnZXRFcSB9IGZyb20gJ2ZwLXRzL05vbkVtcHR5QXJyYXknXG4gKiBpbXBvcnQgKiBhcyBOIGZyb20gJ2ZwLXRzL251bWJlcidcbiAqXG4gKiBjb25zdCBFID0gZ2V0RXEoTi5FcSlcbiAqIGFzc2VydC5zdHJpY3RFcXVhbChFLmVxdWFscyhbMSwgMl0sIFsxLCAyXSksIHRydWUpXG4gKiBhc3NlcnQuc3RyaWN0RXF1YWwoRS5lcXVhbHMoWzEsIDJdLCBbMSwgM10pLCBmYWxzZSlcbiAqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciBnZXRFcSA9IFJORUEuZ2V0RXE7XG4vKipcbiAqIEBzaW5jZSAyLjExLjBcbiAqL1xuZXhwb3J0IHZhciBnZXRVbmlvblNlbWlncm91cCA9IGZ1bmN0aW9uIChFKSB7XG4gICAgdmFyIHVuaW9uRSA9IHVuaW9uKEUpO1xuICAgIHJldHVybiB7XG4gICAgICAgIGNvbmNhdDogZnVuY3Rpb24gKGZpcnN0LCBzZWNvbmQpIHsgcmV0dXJuIHVuaW9uRShzZWNvbmQpKGZpcnN0KTsgfVxuICAgIH07XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi43LjBcbiAqL1xuZXhwb3J0IHZhciBGdW5jdG9yID0ge1xuICAgIFVSSTogVVJJLFxuICAgIG1hcDogX21hcFxufTtcbi8qKlxuICogQGNhdGVnb3J5IG1hcHBpbmdcbiAqIEBzaW5jZSAyLjEwLjBcbiAqL1xuZXhwb3J0IHZhciBmbGFwID0gLyojX19QVVJFX18qLyBmbGFwXyhGdW5jdG9yKTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuMTAuMFxuICovXG5leHBvcnQgdmFyIFBvaW50ZWQgPSB7XG4gICAgVVJJOiBVUkksXG4gICAgb2Y6IG9mXG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi43LjBcbiAqL1xuZXhwb3J0IHZhciBGdW5jdG9yV2l0aEluZGV4ID0ge1xuICAgIFVSSTogVVJJLFxuICAgIG1hcDogX21hcCxcbiAgICBtYXBXaXRoSW5kZXg6IF9tYXBXaXRoSW5kZXhcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjEwLjBcbiAqL1xuZXhwb3J0IHZhciBBcHBseSA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICBtYXA6IF9tYXAsXG4gICAgYXA6IF9hcFxufTtcbi8qKlxuICogQ29tYmluZSB0d28gZWZmZWN0ZnVsIGFjdGlvbnMsIGtlZXBpbmcgb25seSB0aGUgcmVzdWx0IG9mIHRoZSBmaXJzdC5cbiAqXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBhcEZpcnN0ID0gLyojX19QVVJFX18qLyBhcEZpcnN0XyhBcHBseSk7XG4vKipcbiAqIENvbWJpbmUgdHdvIGVmZmVjdGZ1bCBhY3Rpb25zLCBrZWVwaW5nIG9ubHkgdGhlIHJlc3VsdCBvZiB0aGUgc2Vjb25kLlxuICpcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIGFwU2Vjb25kID0gLyojX19QVVJFX18qLyBhcFNlY29uZF8oQXBwbHkpO1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi43LjBcbiAqL1xuZXhwb3J0IHZhciBBcHBsaWNhdGl2ZSA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICBtYXA6IF9tYXAsXG4gICAgYXA6IF9hcCxcbiAgICBvZjogb2Zcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjEwLjBcbiAqL1xuZXhwb3J0IHZhciBDaGFpbiA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICBtYXA6IF9tYXAsXG4gICAgYXA6IF9hcCxcbiAgICBjaGFpbjogZmxhdE1hcFxufTtcbi8qKlxuICogQ29tcG9zZXMgY29tcHV0YXRpb25zIGluIHNlcXVlbmNlLCB1c2luZyB0aGUgcmV0dXJuIHZhbHVlIG9mIG9uZSBjb21wdXRhdGlvbiB0byBkZXRlcm1pbmUgdGhlIG5leHQgY29tcHV0YXRpb24gYW5kXG4gKiBrZWVwaW5nIG9ubHkgdGhlIHJlc3VsdCBvZiB0aGUgZmlyc3QuXG4gKlxuICogQGNhdGVnb3J5IHNlcXVlbmNpbmdcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIGNoYWluRmlyc3QgPSBcbi8qI19fUFVSRV9fKi8gY2hhaW5GaXJzdF8oQ2hhaW4pO1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi43LjBcbiAqL1xuZXhwb3J0IHZhciBNb25hZCA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICBtYXA6IF9tYXAsXG4gICAgYXA6IF9hcCxcbiAgICBvZjogb2YsXG4gICAgY2hhaW46IGZsYXRNYXBcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjcuMFxuICovXG5leHBvcnQgdmFyIEZvbGRhYmxlID0ge1xuICAgIFVSSTogVVJJLFxuICAgIHJlZHVjZTogX3JlZHVjZSxcbiAgICBmb2xkTWFwOiBfZm9sZE1hcCxcbiAgICByZWR1Y2VSaWdodDogX3JlZHVjZVJpZ2h0XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi43LjBcbiAqL1xuZXhwb3J0IHZhciBGb2xkYWJsZVdpdGhJbmRleCA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICByZWR1Y2U6IF9yZWR1Y2UsXG4gICAgZm9sZE1hcDogX2ZvbGRNYXAsXG4gICAgcmVkdWNlUmlnaHQ6IF9yZWR1Y2VSaWdodCxcbiAgICByZWR1Y2VXaXRoSW5kZXg6IF9yZWR1Y2VXaXRoSW5kZXgsXG4gICAgZm9sZE1hcFdpdGhJbmRleDogX2ZvbGRNYXBXaXRoSW5kZXgsXG4gICAgcmVkdWNlUmlnaHRXaXRoSW5kZXg6IF9yZWR1Y2VSaWdodFdpdGhJbmRleFxufTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuNy4wXG4gKi9cbmV4cG9ydCB2YXIgVHJhdmVyc2FibGUgPSB7XG4gICAgVVJJOiBVUkksXG4gICAgbWFwOiBfbWFwLFxuICAgIHJlZHVjZTogX3JlZHVjZSxcbiAgICBmb2xkTWFwOiBfZm9sZE1hcCxcbiAgICByZWR1Y2VSaWdodDogX3JlZHVjZVJpZ2h0LFxuICAgIHRyYXZlcnNlOiBfdHJhdmVyc2UsXG4gICAgc2VxdWVuY2U6IHNlcXVlbmNlXG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi43LjBcbiAqL1xuZXhwb3J0IHZhciBUcmF2ZXJzYWJsZVdpdGhJbmRleCA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICBtYXA6IF9tYXAsXG4gICAgbWFwV2l0aEluZGV4OiBfbWFwV2l0aEluZGV4LFxuICAgIHJlZHVjZTogX3JlZHVjZSxcbiAgICBmb2xkTWFwOiBfZm9sZE1hcCxcbiAgICByZWR1Y2VSaWdodDogX3JlZHVjZVJpZ2h0LFxuICAgIHRyYXZlcnNlOiBfdHJhdmVyc2UsXG4gICAgc2VxdWVuY2U6IHNlcXVlbmNlLFxuICAgIHJlZHVjZVdpdGhJbmRleDogX3JlZHVjZVdpdGhJbmRleCxcbiAgICBmb2xkTWFwV2l0aEluZGV4OiBfZm9sZE1hcFdpdGhJbmRleCxcbiAgICByZWR1Y2VSaWdodFdpdGhJbmRleDogX3JlZHVjZVJpZ2h0V2l0aEluZGV4LFxuICAgIHRyYXZlcnNlV2l0aEluZGV4OiBfdHJhdmVyc2VXaXRoSW5kZXhcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjcuMFxuICovXG5leHBvcnQgdmFyIEFsdCA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICBtYXA6IF9tYXAsXG4gICAgYWx0OiBfYWx0XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi43LjBcbiAqL1xuZXhwb3J0IHZhciBDb21vbmFkID0ge1xuICAgIFVSSTogVVJJLFxuICAgIG1hcDogX21hcCxcbiAgICBleHRlbmQ6IF9leHRlbmQsXG4gICAgZXh0cmFjdDogZXh0cmFjdFxufTtcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8vIGRvIG5vdGF0aW9uXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vKipcbiAqIEBjYXRlZ29yeSBkbyBub3RhdGlvblxuICogQHNpbmNlIDIuOS4wXG4gKi9cbmV4cG9ydCB2YXIgRG8gPSAvKiNfX1BVUkVfXyovIG9mKF8uZW1wdHlSZWNvcmQpO1xuLyoqXG4gKiBAY2F0ZWdvcnkgZG8gbm90YXRpb25cbiAqIEBzaW5jZSAyLjguMFxuICovXG5leHBvcnQgdmFyIGJpbmRUbyA9IC8qI19fUFVSRV9fKi8gYmluZFRvXyhGdW5jdG9yKTtcbnZhciBsZXRfID0gLyojX19QVVJFX18qLyBsZXRfXyhGdW5jdG9yKTtcbmV4cG9ydCB7IFxuLyoqXG4gKiBAY2F0ZWdvcnkgZG8gbm90YXRpb25cbiAqIEBzaW5jZSAyLjEzLjBcbiAqL1xubGV0XyBhcyBsZXQgfTtcbi8qKlxuICogQGNhdGVnb3J5IGRvIG5vdGF0aW9uXG4gKiBAc2luY2UgMi44LjBcbiAqL1xuZXhwb3J0IHZhciBiaW5kID0gLyojX19QVVJFX18qLyBiaW5kXyhDaGFpbik7XG4vKipcbiAqIEBjYXRlZ29yeSBkbyBub3RhdGlvblxuICogQHNpbmNlIDIuOC4wXG4gKi9cbmV4cG9ydCB2YXIgYXBTID0gLyojX19QVVJFX18qLyBhcFNfKEFwcGx5KTtcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8vIHV0aWxzXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vKipcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIGhlYWQgPSBSTkVBLmhlYWQ7XG4vKipcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIHRhaWwgPSBmdW5jdGlvbiAoYXMpIHsgcmV0dXJuIGFzLnNsaWNlKDEpOyB9O1xuLyoqXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciBsYXN0ID0gUk5FQS5sYXN0O1xuLyoqXG4gKiBHZXQgYWxsIGJ1dCB0aGUgbGFzdCBlbGVtZW50IG9mIGEgbm9uIGVtcHR5IGFycmF5LCBjcmVhdGluZyBhIG5ldyBhcnJheS5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgaW5pdCB9IGZyb20gJ2ZwLXRzL05vbkVtcHR5QXJyYXknXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChpbml0KFsxLCAyLCAzXSksIFsxLCAyXSlcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoaW5pdChbMV0pLCBbXSlcbiAqXG4gKiBAc2luY2UgMi4yLjBcbiAqL1xuZXhwb3J0IHZhciBpbml0ID0gZnVuY3Rpb24gKGFzKSB7IHJldHVybiBhcy5zbGljZSgwLCAtMSk7IH07XG4vKipcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIG1pbiA9IFJORUEubWluO1xuLyoqXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciBtYXggPSBSTkVBLm1heDtcbi8qKlxuICogQHNpbmNlIDIuMTAuMFxuICovXG5leHBvcnQgdmFyIGNvbmNhdEFsbCA9IGZ1bmN0aW9uIChTKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykge1xuICAgICAgICByZXR1cm4gYXMucmVkdWNlKFMuY29uY2F0KTtcbiAgICB9O1xufTtcbi8qKlxuICogQnJlYWsgYW4gYEFycmF5YCBpbnRvIGl0cyBmaXJzdCBlbGVtZW50IGFuZCByZW1haW5pbmcgZWxlbWVudHMuXG4gKlxuICogQGNhdGVnb3J5IHBhdHRlcm4gbWF0Y2hpbmdcbiAqIEBzaW5jZSAyLjExLjBcbiAqL1xuZXhwb3J0IHZhciBtYXRjaExlZnQgPSBmdW5jdGlvbiAoZikge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgcmV0dXJuIGYoaGVhZChhcyksIHRhaWwoYXMpKTtcbiAgICB9O1xufTtcbi8qKlxuICogQnJlYWsgYW4gYEFycmF5YCBpbnRvIGl0cyBpbml0aWFsIGVsZW1lbnRzIGFuZCB0aGUgbGFzdCBlbGVtZW50LlxuICpcbiAqIEBjYXRlZ29yeSBwYXR0ZXJuIG1hdGNoaW5nXG4gKiBAc2luY2UgMi4xMS4wXG4gKi9cbmV4cG9ydCB2YXIgbWF0Y2hSaWdodCA9IGZ1bmN0aW9uIChmKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykge1xuICAgICAgICByZXR1cm4gZihpbml0KGFzKSwgbGFzdChhcykpO1xuICAgIH07XG59O1xuLyoqXG4gKiBBcHBseSBhIGZ1bmN0aW9uIHRvIHRoZSBoZWFkLCBjcmVhdGluZyBhIG5ldyBgTm9uRW1wdHlBcnJheWAuXG4gKlxuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIG1vZGlmeUhlYWQgPSBmdW5jdGlvbiAoZikge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgcmV0dXJuIF9fc3ByZWFkQXJyYXkoW2YoaGVhZChhcykpXSwgdGFpbChhcyksIHRydWUpO1xuICAgIH07XG59O1xuLyoqXG4gKiBDaGFuZ2UgdGhlIGhlYWQsIGNyZWF0aW5nIGEgbmV3IGBOb25FbXB0eUFycmF5YC5cbiAqXG4gKiBAc2luY2UgMi4xMS4wXG4gKi9cbmV4cG9ydCB2YXIgdXBkYXRlSGVhZCA9IGZ1bmN0aW9uIChhKSB7IHJldHVybiBtb2RpZnlIZWFkKGZ1bmN0aW9uICgpIHsgcmV0dXJuIGE7IH0pOyB9O1xuLyoqXG4gKiBBcHBseSBhIGZ1bmN0aW9uIHRvIHRoZSBsYXN0IGVsZW1lbnQsIGNyZWF0aW5nIGEgbmV3IGBOb25FbXB0eUFycmF5YC5cbiAqXG4gKiBAc2luY2UgMi4xMS4wXG4gKi9cbmV4cG9ydCB2YXIgbW9kaWZ5TGFzdCA9IGZ1bmN0aW9uIChmKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykge1xuICAgICAgICByZXR1cm4gcGlwZShpbml0KGFzKSwgYXBwZW5kKGYobGFzdChhcykpKSk7XG4gICAgfTtcbn07XG4vKipcbiAqIENoYW5nZSB0aGUgbGFzdCBlbGVtZW50LCBjcmVhdGluZyBhIG5ldyBgTm9uRW1wdHlBcnJheWAuXG4gKlxuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIHVwZGF0ZUxhc3QgPSBmdW5jdGlvbiAoYSkgeyByZXR1cm4gbW9kaWZ5TGFzdChmdW5jdGlvbiAoKSB7IHJldHVybiBhOyB9KTsgfTtcbi8qKlxuICogUGxhY2VzIGFuIGVsZW1lbnQgaW4gYmV0d2VlbiBtZW1iZXJzIG9mIGEgYE5vbkVtcHR5QXJyYXlgLCB0aGVuIGZvbGRzIHRoZSByZXN1bHRzIHVzaW5nIHRoZSBwcm92aWRlZCBgU2VtaWdyb3VwYC5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0ICogYXMgUyBmcm9tICdmcC10cy9zdHJpbmcnXG4gKiBpbXBvcnQgeyBpbnRlcmNhbGF0ZSB9IGZyb20gJ2ZwLXRzL05vbkVtcHR5QXJyYXknXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChpbnRlcmNhbGF0ZShTLlNlbWlncm91cCkoJy0nKShbJ2EnLCAnYicsICdjJ10pLCAnYS1iLWMnKVxuICpcbiAqIEBzaW5jZSAyLjEyLjBcbiAqL1xuZXhwb3J0IHZhciBpbnRlcmNhbGF0ZSA9IFJORUEuaW50ZXJjYWxhdGU7XG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vLyBsZWdhY3lcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8qKlxuICogQWxpYXMgb2YgYGZsYXRNYXBgLlxuICpcbiAqIEBjYXRlZ29yeSBsZWdhY3lcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIGNoYWluID0gZmxhdE1hcDtcbmV4cG9ydCBmdW5jdGlvbiBncm91cFNvcnQoTykge1xuICAgIHZhciBzb3J0TyA9IHNvcnQoTyk7XG4gICAgdmFyIGdyb3VwTyA9IGdyb3VwKE8pO1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHsgcmV0dXJuIChpc05vbkVtcHR5KGFzKSA/IGdyb3VwTyhzb3J0TyhhcykpIDogW10pOyB9O1xufVxuZXhwb3J0IGZ1bmN0aW9uIGZpbHRlcihwcmVkaWNhdGUpIHtcbiAgICByZXR1cm4gZmlsdGVyV2l0aEluZGV4KGZ1bmN0aW9uIChfLCBhKSB7IHJldHVybiBwcmVkaWNhdGUoYSk7IH0pO1xufVxuLyoqXG4gKiBVc2UgW2BmaWx0ZXJXaXRoSW5kZXhgXSguL0FycmF5LnRzLmh0bWwjZmlsdGVyd2l0aGluZGV4KSBpbnN0ZWFkLlxuICpcbiAqIEBjYXRlZ29yeSB6b25lIG9mIGRlYXRoXG4gKiBAc2luY2UgMi4wLjBcbiAqIEBkZXByZWNhdGVkXG4gKi9cbmV4cG9ydCB2YXIgZmlsdGVyV2l0aEluZGV4ID0gZnVuY3Rpb24gKHByZWRpY2F0ZSkge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgcmV0dXJuIGZyb21BcnJheShhcy5maWx0ZXIoZnVuY3Rpb24gKGEsIGkpIHsgcmV0dXJuIHByZWRpY2F0ZShpLCBhKTsgfSkpO1xuICAgIH07XG59O1xuLyoqXG4gKiBVc2UgW2B1bnByZXBlbmRgXSgjdW5wcmVwZW5kKSBpbnN0ZWFkLlxuICpcbiAqIEBjYXRlZ29yeSB6b25lIG9mIGRlYXRoXG4gKiBAc2luY2UgMi45LjBcbiAqIEBkZXByZWNhdGVkXG4gKi9cbmV4cG9ydCB2YXIgdW5jb25zID0gdW5wcmVwZW5kO1xuLyoqXG4gKiBVc2UgW2B1bmFwcGVuZGBdKCN1bmFwcGVuZCkgaW5zdGVhZC5cbiAqXG4gKiBAY2F0ZWdvcnkgem9uZSBvZiBkZWF0aFxuICogQHNpbmNlIDIuOS4wXG4gKiBAZGVwcmVjYXRlZFxuICovXG5leHBvcnQgdmFyIHVuc25vYyA9IHVuYXBwZW5kO1xuZXhwb3J0IGZ1bmN0aW9uIGNvbnMoaGVhZCwgdGFpbCkge1xuICAgIHJldHVybiB0YWlsID09PSB1bmRlZmluZWQgPyBwcmVwZW5kKGhlYWQpIDogcGlwZSh0YWlsLCBwcmVwZW5kKGhlYWQpKTtcbn1cbi8qKlxuICogVXNlIFtgYXBwZW5kYF0oLi9BcnJheS50cy5odG1sI2FwcGVuZCkgaW5zdGVhZC5cbiAqXG4gKiBAY2F0ZWdvcnkgem9uZSBvZiBkZWF0aFxuICogQHNpbmNlIDIuMC4wXG4gKiBAZGVwcmVjYXRlZFxuICovXG5leHBvcnQgdmFyIHNub2MgPSBmdW5jdGlvbiAoaW5pdCwgZW5kKSB7IHJldHVybiBwaXBlKGluaXQsIGFwcGVuZChlbmQpKTsgfTtcbi8qKlxuICogVXNlIFtgcHJlcGVuZEFsbGBdKCNwcmVwZW5kYWxsKSBpbnN0ZWFkLlxuICpcbiAqIEBjYXRlZ29yeSB6b25lIG9mIGRlYXRoXG4gKiBAc2luY2UgMi45LjBcbiAqIEBkZXByZWNhdGVkXG4gKi9cbmV4cG9ydCB2YXIgcHJlcGVuZFRvQWxsID0gcHJlcGVuZEFsbDtcbi8qKlxuICogVXNlIFtgY29uY2F0QWxsYF0oI2NvbmNhdGFsbCkgaW5zdGVhZC5cbiAqXG4gKiBAY2F0ZWdvcnkgem9uZSBvZiBkZWF0aFxuICogQHNpbmNlIDIuNS4wXG4gKiBAZGVwcmVjYXRlZFxuICovXG5leHBvcnQgdmFyIGZvbGQgPSBSTkVBLmNvbmNhdEFsbDtcbi8qKlxuICogVGhpcyBpbnN0YW5jZSBpcyBkZXByZWNhdGVkLCB1c2Ugc21hbGwsIHNwZWNpZmljIGluc3RhbmNlcyBpbnN0ZWFkLlxuICogRm9yIGV4YW1wbGUgaWYgYSBmdW5jdGlvbiBuZWVkcyBhIGBGdW5jdG9yYCBpbnN0YW5jZSwgcGFzcyBgTkVBLkZ1bmN0b3JgIGluc3RlYWQgb2YgYE5FQS5ub25FbXB0eUFycmF5YFxuICogKHdoZXJlIGBORUFgIGlzIGZyb20gYGltcG9ydCBORUEgZnJvbSAnZnAtdHMvTm9uRW1wdHlBcnJheSdgKVxuICpcbiAqIEBjYXRlZ29yeSB6b25lIG9mIGRlYXRoXG4gKiBAc2luY2UgMi4wLjBcbiAqIEBkZXByZWNhdGVkXG4gKi9cbmV4cG9ydCB2YXIgbm9uRW1wdHlBcnJheSA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICBvZjogb2YsXG4gICAgbWFwOiBfbWFwLFxuICAgIG1hcFdpdGhJbmRleDogX21hcFdpdGhJbmRleCxcbiAgICBhcDogX2FwLFxuICAgIGNoYWluOiBmbGF0TWFwLFxuICAgIGV4dGVuZDogX2V4dGVuZCxcbiAgICBleHRyYWN0OiBleHRyYWN0LFxuICAgIHJlZHVjZTogX3JlZHVjZSxcbiAgICBmb2xkTWFwOiBfZm9sZE1hcCxcbiAgICByZWR1Y2VSaWdodDogX3JlZHVjZVJpZ2h0LFxuICAgIHRyYXZlcnNlOiBfdHJhdmVyc2UsXG4gICAgc2VxdWVuY2U6IHNlcXVlbmNlLFxuICAgIHJlZHVjZVdpdGhJbmRleDogX3JlZHVjZVdpdGhJbmRleCxcbiAgICBmb2xkTWFwV2l0aEluZGV4OiBfZm9sZE1hcFdpdGhJbmRleCxcbiAgICByZWR1Y2VSaWdodFdpdGhJbmRleDogX3JlZHVjZVJpZ2h0V2l0aEluZGV4LFxuICAgIHRyYXZlcnNlV2l0aEluZGV4OiBfdHJhdmVyc2VXaXRoSW5kZXgsXG4gICAgYWx0OiBfYWx0XG59O1xuIiwKICAidmFyIF9fc3ByZWFkQXJyYXkgPSAodGhpcyAmJiB0aGlzLl9fc3ByZWFkQXJyYXkpIHx8IGZ1bmN0aW9uICh0bywgZnJvbSwgcGFjaykge1xuICAgIGlmIChwYWNrIHx8IGFyZ3VtZW50cy5sZW5ndGggPT09IDIpIGZvciAodmFyIGkgPSAwLCBsID0gZnJvbS5sZW5ndGgsIGFyOyBpIDwgbDsgaSsrKSB7XG4gICAgICAgIGlmIChhciB8fCAhKGkgaW4gZnJvbSkpIHtcbiAgICAgICAgICAgIGlmICghYXIpIGFyID0gQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoZnJvbSwgMCwgaSk7XG4gICAgICAgICAgICBhcltpXSA9IGZyb21baV07XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHRvLmNvbmNhdChhciB8fCBBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChmcm9tKSk7XG59O1xuaW1wb3J0IHsgYXBGaXJzdCBhcyBhcEZpcnN0XywgYXBTIGFzIGFwU18sIGFwU2Vjb25kIGFzIGFwU2Vjb25kXyB9IGZyb20gJy4vQXBwbHknO1xuaW1wb3J0IHsgYmluZCBhcyBiaW5kXywgY2hhaW5GaXJzdCBhcyBjaGFpbkZpcnN0XyB9IGZyb20gJy4vQ2hhaW4nO1xuaW1wb3J0IHsgZHVhbCwgaWRlbnRpdHksIHBpcGUgfSBmcm9tICcuL2Z1bmN0aW9uJztcbmltcG9ydCB7IGJpbmRUbyBhcyBiaW5kVG9fLCBmbGFwIGFzIGZsYXBfLCBsZXQgYXMgbGV0X18gfSBmcm9tICcuL0Z1bmN0b3InO1xuaW1wb3J0ICogYXMgXyBmcm9tICcuL2ludGVybmFsJztcbmltcG9ydCB7IGdldE1vbm9pZCB9IGZyb20gJy4vT3JkJztcbmltcG9ydCAqIGFzIFJORUEgZnJvbSAnLi9SZWFkb25seU5vbkVtcHR5QXJyYXknO1xuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLy8gaW50ZXJuYWxcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8qKlxuICogQGludGVybmFsXG4gKi9cbmV4cG9ydCB2YXIgaXNOb25FbXB0eSA9IGZ1bmN0aW9uIChhcykgeyByZXR1cm4gYXMubGVuZ3RoID4gMDsgfTtcbi8qKlxuICogQGludGVybmFsXG4gKi9cbmV4cG9ydCB2YXIgaXNPdXRPZkJvdW5kID0gZnVuY3Rpb24gKGksIGFzKSB7IHJldHVybiBpIDwgMCB8fCBpID49IGFzLmxlbmd0aDsgfTtcbi8qKlxuICogQGludGVybmFsXG4gKi9cbmV4cG9ydCB2YXIgcHJlcGVuZFcgPSBmdW5jdGlvbiAoaGVhZCkge1xuICAgIHJldHVybiBmdW5jdGlvbiAodGFpbCkge1xuICAgICAgICByZXR1cm4gX19zcHJlYWRBcnJheShbaGVhZF0sIHRhaWwsIHRydWUpO1xuICAgIH07XG59O1xuLyoqXG4gKiBAaW50ZXJuYWxcbiAqL1xuZXhwb3J0IHZhciBwcmVwZW5kID0gcHJlcGVuZFc7XG4vKipcbiAqIEBpbnRlcm5hbFxuICovXG5leHBvcnQgdmFyIGFwcGVuZFcgPSBmdW5jdGlvbiAoZW5kKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChpbml0KSB7XG4gICAgICAgIHJldHVybiBfX3NwcmVhZEFycmF5KF9fc3ByZWFkQXJyYXkoW10sIGluaXQsIHRydWUpLCBbZW5kXSwgZmFsc2UpO1xuICAgIH07XG59O1xuLyoqXG4gKiBAaW50ZXJuYWxcbiAqL1xuZXhwb3J0IHZhciBhcHBlbmQgPSBhcHBlbmRXO1xuLyoqXG4gKiBAaW50ZXJuYWxcbiAqL1xuZXhwb3J0IHZhciB1bnNhZmVJbnNlcnRBdCA9IGZ1bmN0aW9uIChpLCBhLCBhcykge1xuICAgIGlmIChpc05vbkVtcHR5KGFzKSkge1xuICAgICAgICB2YXIgeHMgPSBmcm9tUmVhZG9ubHlOb25FbXB0eUFycmF5KGFzKTtcbiAgICAgICAgeHMuc3BsaWNlKGksIDAsIGEpO1xuICAgICAgICByZXR1cm4geHM7XG4gICAgfVxuICAgIHJldHVybiBbYV07XG59O1xuLyoqXG4gKiBAaW50ZXJuYWxcbiAqL1xuZXhwb3J0IHZhciB1bnNhZmVVcGRhdGVBdCA9IGZ1bmN0aW9uIChpLCBhLCBhcykge1xuICAgIHZhciB4cyA9IGZyb21SZWFkb25seU5vbkVtcHR5QXJyYXkoYXMpO1xuICAgIHhzW2ldID0gYTtcbiAgICByZXR1cm4geHM7XG59O1xuLyoqXG4gKiBSZW1vdmUgZHVwbGljYXRlcyBmcm9tIGEgYE5vbkVtcHR5QXJyYXlgLCBrZWVwaW5nIHRoZSBmaXJzdCBvY2N1cnJlbmNlIG9mIGFuIGVsZW1lbnQuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IHVuaXEgfSBmcm9tICdmcC10cy9Ob25FbXB0eUFycmF5J1xuICogaW1wb3J0ICogYXMgTiBmcm9tICdmcC10cy9udW1iZXInXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbCh1bmlxKE4uRXEpKFsxLCAyLCAxXSksIFsxLCAyXSlcbiAqXG4gKiBAc2luY2UgMi4xMS4wXG4gKi9cbmV4cG9ydCB2YXIgdW5pcSA9IGZ1bmN0aW9uIChFKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykge1xuICAgICAgICBpZiAoYXMubGVuZ3RoID09PSAxKSB7XG4gICAgICAgICAgICByZXR1cm4gY29weShhcyk7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIG91dCA9IFtoZWFkKGFzKV07XG4gICAgICAgIHZhciByZXN0ID0gdGFpbChhcyk7XG4gICAgICAgIHZhciBfbG9vcF8xID0gZnVuY3Rpb24gKGEpIHtcbiAgICAgICAgICAgIGlmIChvdXQuZXZlcnkoZnVuY3Rpb24gKG8pIHsgcmV0dXJuICFFLmVxdWFscyhvLCBhKTsgfSkpIHtcbiAgICAgICAgICAgICAgICBvdXQucHVzaChhKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgZm9yICh2YXIgX2kgPSAwLCByZXN0XzEgPSByZXN0OyBfaSA8IHJlc3RfMS5sZW5ndGg7IF9pKyspIHtcbiAgICAgICAgICAgIHZhciBhID0gcmVzdF8xW19pXTtcbiAgICAgICAgICAgIF9sb29wXzEoYSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG91dDtcbiAgICB9O1xufTtcbi8qKlxuICogU29ydCB0aGUgZWxlbWVudHMgb2YgYSBgTm9uRW1wdHlBcnJheWAgaW4gaW5jcmVhc2luZyBvcmRlciwgd2hlcmUgZWxlbWVudHMgYXJlIGNvbXBhcmVkIHVzaW5nIGZpcnN0IGBvcmRzWzBdYCwgdGhlbiBgb3Jkc1sxXWAsXG4gKiBldGMuLi5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0ICogYXMgTkVBIGZyb20gJ2ZwLXRzL05vbkVtcHR5QXJyYXknXG4gKiBpbXBvcnQgeyBjb250cmFtYXAgfSBmcm9tICdmcC10cy9PcmQnXG4gKiBpbXBvcnQgKiBhcyBTIGZyb20gJ2ZwLXRzL3N0cmluZydcbiAqIGltcG9ydCAqIGFzIE4gZnJvbSAnZnAtdHMvbnVtYmVyJ1xuICogaW1wb3J0IHsgcGlwZSB9IGZyb20gJ2ZwLXRzL2Z1bmN0aW9uJ1xuICpcbiAqIGludGVyZmFjZSBQZXJzb24ge1xuICogICBuYW1lOiBzdHJpbmdcbiAqICAgYWdlOiBudW1iZXJcbiAqIH1cbiAqXG4gKiBjb25zdCBieU5hbWUgPSBwaXBlKFMuT3JkLCBjb250cmFtYXAoKHA6IFBlcnNvbikgPT4gcC5uYW1lKSlcbiAqXG4gKiBjb25zdCBieUFnZSA9IHBpcGUoTi5PcmQsIGNvbnRyYW1hcCgocDogUGVyc29uKSA9PiBwLmFnZSkpXG4gKlxuICogY29uc3Qgc29ydEJ5TmFtZUJ5QWdlID0gTkVBLnNvcnRCeShbYnlOYW1lLCBieUFnZV0pXG4gKlxuICogY29uc3QgcGVyc29uczogTkVBLk5vbkVtcHR5QXJyYXk8UGVyc29uPiA9IFtcbiAqICAgeyBuYW1lOiAnYScsIGFnZTogMSB9LFxuICogICB7IG5hbWU6ICdiJywgYWdlOiAzIH0sXG4gKiAgIHsgbmFtZTogJ2MnLCBhZ2U6IDIgfSxcbiAqICAgeyBuYW1lOiAnYicsIGFnZTogMiB9XG4gKiBdXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChzb3J0QnlOYW1lQnlBZ2UocGVyc29ucyksIFtcbiAqICAgeyBuYW1lOiAnYScsIGFnZTogMSB9LFxuICogICB7IG5hbWU6ICdiJywgYWdlOiAyIH0sXG4gKiAgIHsgbmFtZTogJ2InLCBhZ2U6IDMgfSxcbiAqICAgeyBuYW1lOiAnYycsIGFnZTogMiB9XG4gKiBdKVxuICpcbiAqIEBzaW5jZSAyLjExLjBcbiAqL1xuZXhwb3J0IHZhciBzb3J0QnkgPSBmdW5jdGlvbiAob3Jkcykge1xuICAgIGlmIChpc05vbkVtcHR5KG9yZHMpKSB7XG4gICAgICAgIHZhciBNID0gZ2V0TW9ub2lkKCk7XG4gICAgICAgIHJldHVybiBzb3J0KG9yZHMucmVkdWNlKE0uY29uY2F0LCBNLmVtcHR5KSk7XG4gICAgfVxuICAgIHJldHVybiBjb3B5O1xufTtcbi8qKlxuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIHVuaW9uID0gZnVuY3Rpb24gKEUpIHtcbiAgICB2YXIgdW5pcUUgPSB1bmlxKEUpO1xuICAgIHJldHVybiBmdW5jdGlvbiAoc2Vjb25kKSB7IHJldHVybiBmdW5jdGlvbiAoZmlyc3QpIHsgcmV0dXJuIHVuaXFFKHBpcGUoZmlyc3QsIGNvbmNhdChzZWNvbmQpKSk7IH07IH07XG59O1xuLyoqXG4gKiBSb3RhdGUgYSBgTm9uRW1wdHlBcnJheWAgYnkgYG5gIHN0ZXBzLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyByb3RhdGUgfSBmcm9tICdmcC10cy9Ob25FbXB0eUFycmF5J1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwocm90YXRlKDIpKFsxLCAyLCAzLCA0LCA1XSksIFs0LCA1LCAxLCAyLCAzXSlcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwocm90YXRlKC0yKShbMSwgMiwgMywgNCwgNV0pLCBbMywgNCwgNSwgMSwgMl0pXG4gKlxuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIHJvdGF0ZSA9IGZ1bmN0aW9uIChuKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykge1xuICAgICAgICB2YXIgbGVuID0gYXMubGVuZ3RoO1xuICAgICAgICB2YXIgbSA9IE1hdGgucm91bmQobikgJSBsZW47XG4gICAgICAgIGlmIChpc091dE9mQm91bmQoTWF0aC5hYnMobSksIGFzKSB8fCBtID09PSAwKSB7XG4gICAgICAgICAgICByZXR1cm4gY29weShhcyk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKG0gPCAwKSB7XG4gICAgICAgICAgICB2YXIgX2EgPSBzcGxpdEF0KC1tKShhcyksIGYgPSBfYVswXSwgcyA9IF9hWzFdO1xuICAgICAgICAgICAgcmV0dXJuIHBpcGUocywgY29uY2F0KGYpKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybiByb3RhdGUobSAtIGxlbikoYXMpO1xuICAgICAgICB9XG4gICAgfTtcbn07XG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vLyBjb25zdHJ1Y3RvcnNcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8qKlxuICogQGNhdGVnb3J5IGNvbnZlcnNpb25zXG4gKiBAc2luY2UgMi4xMC4wXG4gKi9cbmV4cG9ydCB2YXIgZnJvbVJlYWRvbmx5Tm9uRW1wdHlBcnJheSA9IF8uZnJvbVJlYWRvbmx5Tm9uRW1wdHlBcnJheTtcbi8qKlxuICogQnVpbGRzIGEgYE5vbkVtcHR5QXJyYXlgIGZyb20gYW4gYEFycmF5YCByZXR1cm5pbmcgYG5vbmVgIGlmIGBhc2AgaXMgYW4gZW1wdHkgYXJyYXlcbiAqXG4gKiBAY2F0ZWdvcnkgY29udmVyc2lvbnNcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIGZyb21BcnJheSA9IGZ1bmN0aW9uIChhcykgeyByZXR1cm4gKGlzTm9uRW1wdHkoYXMpID8gXy5zb21lKGFzKSA6IF8ubm9uZSk7IH07XG4vKipcbiAqIFJldHVybiBhIGBOb25FbXB0eUFycmF5YCBvZiBsZW5ndGggYG5gIHdpdGggZWxlbWVudCBgaWAgaW5pdGlhbGl6ZWQgd2l0aCBgZihpKWAuXG4gKlxuICogKipOb3RlKiouIGBuYCBpcyBub3JtYWxpemVkIHRvIGEgbmF0dXJhbCBudW1iZXIuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IG1ha2VCeSB9IGZyb20gJ2ZwLXRzL05vbkVtcHR5QXJyYXknXG4gKiBpbXBvcnQgeyBwaXBlIH0gZnJvbSAnZnAtdHMvZnVuY3Rpb24nXG4gKlxuICogY29uc3QgZG91YmxlID0gKG46IG51bWJlcik6IG51bWJlciA9PiBuICogMlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChwaXBlKDUsIG1ha2VCeShkb3VibGUpKSwgWzAsIDIsIDQsIDYsIDhdKVxuICpcbiAqIEBjYXRlZ29yeSBjb25zdHJ1Y3RvcnNcbiAqIEBzaW5jZSAyLjExLjBcbiAqL1xuZXhwb3J0IHZhciBtYWtlQnkgPSBmdW5jdGlvbiAoZikge1xuICAgIHJldHVybiBmdW5jdGlvbiAobikge1xuICAgICAgICB2YXIgaiA9IE1hdGgubWF4KDAsIE1hdGguZmxvb3IobikpO1xuICAgICAgICB2YXIgb3V0ID0gW2YoMCldO1xuICAgICAgICBmb3IgKHZhciBpID0gMTsgaSA8IGo7IGkrKykge1xuICAgICAgICAgICAgb3V0LnB1c2goZihpKSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG91dDtcbiAgICB9O1xufTtcbi8qKlxuICogQ3JlYXRlIGEgYE5vbkVtcHR5QXJyYXlgIGNvbnRhaW5pbmcgYSB2YWx1ZSByZXBlYXRlZCB0aGUgc3BlY2lmaWVkIG51bWJlciBvZiB0aW1lcy5cbiAqXG4gKiAqKk5vdGUqKi4gYG5gIGlzIG5vcm1hbGl6ZWQgdG8gYSBuYXR1cmFsIG51bWJlci5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgcmVwbGljYXRlIH0gZnJvbSAnZnAtdHMvTm9uRW1wdHlBcnJheSdcbiAqIGltcG9ydCB7IHBpcGUgfSBmcm9tICdmcC10cy9mdW5jdGlvbidcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKHBpcGUoMywgcmVwbGljYXRlKCdhJykpLCBbJ2EnLCAnYScsICdhJ10pXG4gKlxuICogQGNhdGVnb3J5IGNvbnN0cnVjdG9yc1xuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIHJlcGxpY2F0ZSA9IGZ1bmN0aW9uIChhKSB7IHJldHVybiBtYWtlQnkoZnVuY3Rpb24gKCkgeyByZXR1cm4gYTsgfSk7IH07XG4vKipcbiAqIENyZWF0ZSBhIGBOb25FbXB0eUFycmF5YCBjb250YWluaW5nIGEgcmFuZ2Ugb2YgaW50ZWdlcnMsIGluY2x1ZGluZyBib3RoIGVuZHBvaW50cy5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgcmFuZ2UgfSBmcm9tICdmcC10cy9Ob25FbXB0eUFycmF5J1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwocmFuZ2UoMSwgNSksIFsxLCAyLCAzLCA0LCA1XSlcbiAqXG4gKiBAY2F0ZWdvcnkgY29uc3RydWN0b3JzXG4gKiBAc2luY2UgMi4xMS4wXG4gKi9cbmV4cG9ydCB2YXIgcmFuZ2UgPSBmdW5jdGlvbiAoc3RhcnQsIGVuZCkge1xuICAgIHJldHVybiBzdGFydCA8PSBlbmQgPyBtYWtlQnkoZnVuY3Rpb24gKGkpIHsgcmV0dXJuIHN0YXJ0ICsgaTsgfSkoZW5kIC0gc3RhcnQgKyAxKSA6IFtzdGFydF07XG59O1xuLyoqXG4gKiBSZXR1cm4gdGhlIHR1cGxlIG9mIHRoZSBgaGVhZGAgYW5kIHRoZSBgdGFpbGAuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IHVucHJlcGVuZCB9IGZyb20gJ2ZwLXRzL05vbkVtcHR5QXJyYXknXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbCh1bnByZXBlbmQoWzEsIDIsIDNdKSwgWzEsIFsyLCAzXV0pXG4gKlxuICogQHNpbmNlIDIuOS4wXG4gKi9cbmV4cG9ydCB2YXIgdW5wcmVwZW5kID0gZnVuY3Rpb24gKGFzKSB7IHJldHVybiBbaGVhZChhcyksIHRhaWwoYXMpXTsgfTtcbi8qKlxuICogUmV0dXJuIHRoZSB0dXBsZSBvZiB0aGUgYGluaXRgIGFuZCB0aGUgYGxhc3RgLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyB1bmFwcGVuZCB9IGZyb20gJ2ZwLXRzL05vbkVtcHR5QXJyYXknXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbCh1bmFwcGVuZChbMSwgMiwgMywgNF0pLCBbWzEsIDIsIDNdLCA0XSlcbiAqXG4gKiBAc2luY2UgMi45LjBcbiAqL1xuZXhwb3J0IHZhciB1bmFwcGVuZCA9IGZ1bmN0aW9uIChhcykgeyByZXR1cm4gW2luaXQoYXMpLCBsYXN0KGFzKV07IH07XG5leHBvcnQgZnVuY3Rpb24gY29uY2F0VyhzZWNvbmQpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGZpcnN0KSB7IHJldHVybiBmaXJzdC5jb25jYXQoc2Vjb25kKTsgfTtcbn1cbmV4cG9ydCBmdW5jdGlvbiBjb25jYXQoeCwgeSkge1xuICAgIHJldHVybiB5ID8geC5jb25jYXQoeSkgOiBmdW5jdGlvbiAoeSkgeyByZXR1cm4geS5jb25jYXQoeCk7IH07XG59XG4vKipcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIHJldmVyc2UgPSBmdW5jdGlvbiAoYXMpIHsgcmV0dXJuIF9fc3ByZWFkQXJyYXkoW2xhc3QoYXMpXSwgYXMuc2xpY2UoMCwgLTEpLnJldmVyc2UoKSwgdHJ1ZSk7IH07XG5leHBvcnQgZnVuY3Rpb24gZ3JvdXAoRSkge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgdmFyIGxlbiA9IGFzLmxlbmd0aDtcbiAgICAgICAgaWYgKGxlbiA9PT0gMCkge1xuICAgICAgICAgICAgcmV0dXJuIFtdO1xuICAgICAgICB9XG4gICAgICAgIHZhciBvdXQgPSBbXTtcbiAgICAgICAgdmFyIGhlYWQgPSBhc1swXTtcbiAgICAgICAgdmFyIG5lYSA9IFtoZWFkXTtcbiAgICAgICAgZm9yICh2YXIgaSA9IDE7IGkgPCBsZW47IGkrKykge1xuICAgICAgICAgICAgdmFyIGEgPSBhc1tpXTtcbiAgICAgICAgICAgIGlmIChFLmVxdWFscyhhLCBoZWFkKSkge1xuICAgICAgICAgICAgICAgIG5lYS5wdXNoKGEpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgb3V0LnB1c2gobmVhKTtcbiAgICAgICAgICAgICAgICBoZWFkID0gYTtcbiAgICAgICAgICAgICAgICBuZWEgPSBbaGVhZF07XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgb3V0LnB1c2gobmVhKTtcbiAgICAgICAgcmV0dXJuIG91dDtcbiAgICB9O1xufVxuLyoqXG4gKiBTcGxpdHMgYW4gYXJyYXkgaW50byBzdWItbm9uLWVtcHR5LWFycmF5cyBzdG9yZWQgaW4gYW4gb2JqZWN0LCBiYXNlZCBvbiB0aGUgcmVzdWx0IG9mIGNhbGxpbmcgYSBgc3RyaW5nYC1yZXR1cm5pbmdcbiAqIGZ1bmN0aW9uIG9uIGVhY2ggZWxlbWVudCwgYW5kIGdyb3VwaW5nIHRoZSByZXN1bHRzIGFjY29yZGluZyB0byB2YWx1ZXMgcmV0dXJuZWRcbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgZ3JvdXBCeSB9IGZyb20gJ2ZwLXRzL05vbkVtcHR5QXJyYXknXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChncm91cEJ5KChzOiBzdHJpbmcpID0+IFN0cmluZyhzLmxlbmd0aCkpKFsnYScsICdiJywgJ2FiJ10pLCB7XG4gKiAgICcxJzogWydhJywgJ2InXSxcbiAqICAgJzInOiBbJ2FiJ11cbiAqIH0pXG4gKlxuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgZ3JvdXBCeSA9IGZ1bmN0aW9uIChmKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykge1xuICAgICAgICB2YXIgb3V0ID0ge307XG4gICAgICAgIGZvciAodmFyIF9pID0gMCwgYXNfMSA9IGFzOyBfaSA8IGFzXzEubGVuZ3RoOyBfaSsrKSB7XG4gICAgICAgICAgICB2YXIgYSA9IGFzXzFbX2ldO1xuICAgICAgICAgICAgdmFyIGsgPSBmKGEpO1xuICAgICAgICAgICAgaWYgKF8uaGFzLmNhbGwob3V0LCBrKSkge1xuICAgICAgICAgICAgICAgIG91dFtrXS5wdXNoKGEpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgb3V0W2tdID0gW2FdO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBvdXQ7XG4gICAgfTtcbn07XG4vKipcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIHNvcnQgPSBmdW5jdGlvbiAoTykge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgcmV0dXJuIGFzLnNsaWNlKCkuc29ydChPLmNvbXBhcmUpO1xuICAgIH07XG59O1xuLyoqXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciBpbnNlcnRBdCA9IGZ1bmN0aW9uIChpLCBhKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykge1xuICAgICAgICByZXR1cm4gaSA8IDAgfHwgaSA+IGFzLmxlbmd0aCA/IF8ubm9uZSA6IF8uc29tZSh1bnNhZmVJbnNlcnRBdChpLCBhLCBhcykpO1xuICAgIH07XG59O1xuLyoqXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciB1cGRhdGVBdCA9IGZ1bmN0aW9uIChpLCBhKSB7XG4gICAgcmV0dXJuIG1vZGlmeUF0KGksIGZ1bmN0aW9uICgpIHsgcmV0dXJuIGE7IH0pO1xufTtcbi8qKlxuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgbW9kaWZ5QXQgPSBmdW5jdGlvbiAoaSwgZikge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgcmV0dXJuIGlzT3V0T2ZCb3VuZChpLCBhcykgPyBfLm5vbmUgOiBfLnNvbWUodW5zYWZlVXBkYXRlQXQoaSwgZihhc1tpXSksIGFzKSk7XG4gICAgfTtcbn07XG4vKipcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIGNvcHkgPSBmcm9tUmVhZG9ubHlOb25FbXB0eUFycmF5O1xuLyoqXG4gKiBAY2F0ZWdvcnkgY29uc3RydWN0b3JzXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciBvZiA9IGZ1bmN0aW9uIChhKSB7IHJldHVybiBbYV07IH07XG4vKipcbiAqIEBzaW5jZSAyLjUuMVxuICovXG5leHBvcnQgdmFyIHppcFdpdGggPSBmdW5jdGlvbiAoYXMsIGJzLCBmKSB7XG4gICAgdmFyIGNzID0gW2YoYXNbMF0sIGJzWzBdKV07XG4gICAgdmFyIGxlbiA9IE1hdGgubWluKGFzLmxlbmd0aCwgYnMubGVuZ3RoKTtcbiAgICBmb3IgKHZhciBpID0gMTsgaSA8IGxlbjsgaSsrKSB7XG4gICAgICAgIGNzW2ldID0gZihhc1tpXSwgYnNbaV0pO1xuICAgIH1cbiAgICByZXR1cm4gY3M7XG59O1xuZXhwb3J0IGZ1bmN0aW9uIHppcChhcywgYnMpIHtcbiAgICBpZiAoYnMgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICByZXR1cm4gZnVuY3Rpb24gKGJzKSB7IHJldHVybiB6aXAoYnMsIGFzKTsgfTtcbiAgICB9XG4gICAgcmV0dXJuIHppcFdpdGgoYXMsIGJzLCBmdW5jdGlvbiAoYSwgYikgeyByZXR1cm4gW2EsIGJdOyB9KTtcbn1cbi8qKlxuICogQHNpbmNlIDIuNS4xXG4gKi9cbmV4cG9ydCB2YXIgdW56aXAgPSBmdW5jdGlvbiAoYWJzKSB7XG4gICAgdmFyIGZhID0gW2Fic1swXVswXV07XG4gICAgdmFyIGZiID0gW2Fic1swXVsxXV07XG4gICAgZm9yICh2YXIgaSA9IDE7IGkgPCBhYnMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgZmFbaV0gPSBhYnNbaV1bMF07XG4gICAgICAgIGZiW2ldID0gYWJzW2ldWzFdO1xuICAgIH1cbiAgICByZXR1cm4gW2ZhLCBmYl07XG59O1xuLyoqXG4gKiBQcmVwZW5kIGFuIGVsZW1lbnQgdG8gZXZlcnkgbWVtYmVyIG9mIGFuIGFycmF5XG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IHByZXBlbmRBbGwgfSBmcm9tICdmcC10cy9Ob25FbXB0eUFycmF5J1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwocHJlcGVuZEFsbCg5KShbMSwgMiwgMywgNF0pLCBbOSwgMSwgOSwgMiwgOSwgMywgOSwgNF0pXG4gKlxuICogQHNpbmNlIDIuMTAuMFxuICovXG5leHBvcnQgdmFyIHByZXBlbmRBbGwgPSBmdW5jdGlvbiAobWlkZGxlKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykge1xuICAgICAgICB2YXIgb3V0ID0gW21pZGRsZSwgYXNbMF1dO1xuICAgICAgICBmb3IgKHZhciBpID0gMTsgaSA8IGFzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICBvdXQucHVzaChtaWRkbGUsIGFzW2ldKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gb3V0O1xuICAgIH07XG59O1xuLyoqXG4gKiBQbGFjZXMgYW4gZWxlbWVudCBpbiBiZXR3ZWVuIG1lbWJlcnMgb2YgYW4gYXJyYXlcbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgaW50ZXJzcGVyc2UgfSBmcm9tICdmcC10cy9Ob25FbXB0eUFycmF5J1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoaW50ZXJzcGVyc2UoOSkoWzEsIDIsIDMsIDRdKSwgWzEsIDksIDIsIDksIDMsIDksIDRdKVxuICpcbiAqIEBzaW5jZSAyLjkuMFxuICovXG5leHBvcnQgdmFyIGludGVyc3BlcnNlID0gZnVuY3Rpb24gKG1pZGRsZSkge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgdmFyIHJlc3QgPSB0YWlsKGFzKTtcbiAgICAgICAgcmV0dXJuIGlzTm9uRW1wdHkocmVzdCkgPyBwaXBlKHJlc3QsIHByZXBlbmRBbGwobWlkZGxlKSwgcHJlcGVuZChoZWFkKGFzKSkpIDogY29weShhcyk7XG4gICAgfTtcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBmb2xkaW5nXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciBmb2xkTWFwV2l0aEluZGV4ID0gUk5FQS5mb2xkTWFwV2l0aEluZGV4O1xuLyoqXG4gKiBAY2F0ZWdvcnkgZm9sZGluZ1xuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgZm9sZE1hcCA9IFJORUEuZm9sZE1hcDtcbi8qKlxuICogQGNhdGVnb3J5IHNlcXVlbmNpbmdcbiAqIEBzaW5jZSAyLjEwLjBcbiAqL1xuZXhwb3J0IHZhciBjaGFpbldpdGhJbmRleCA9IGZ1bmN0aW9uIChmKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykge1xuICAgICAgICB2YXIgb3V0ID0gZnJvbVJlYWRvbmx5Tm9uRW1wdHlBcnJheShmKDAsIGhlYWQoYXMpKSk7XG4gICAgICAgIGZvciAodmFyIGkgPSAxOyBpIDwgYXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIG91dC5wdXNoLmFwcGx5KG91dCwgZihpLCBhc1tpXSkpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBvdXQ7XG4gICAgfTtcbn07XG4vKipcbiAqIEBzaW5jZSAyLjEwLjBcbiAqL1xuZXhwb3J0IHZhciBjaG9wID0gZnVuY3Rpb24gKGYpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIHZhciBfYSA9IGYoYXMpLCBiID0gX2FbMF0sIHJlc3QgPSBfYVsxXTtcbiAgICAgICAgdmFyIG91dCA9IFtiXTtcbiAgICAgICAgdmFyIG5leHQgPSByZXN0O1xuICAgICAgICB3aGlsZSAoaXNOb25FbXB0eShuZXh0KSkge1xuICAgICAgICAgICAgdmFyIF9iID0gZihuZXh0KSwgYl8xID0gX2JbMF0sIHJlc3RfMiA9IF9iWzFdO1xuICAgICAgICAgICAgb3V0LnB1c2goYl8xKTtcbiAgICAgICAgICAgIG5leHQgPSByZXN0XzI7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG91dDtcbiAgICB9O1xufTtcbi8qKlxuICogU3BsaXRzIGEgYE5vbkVtcHR5QXJyYXlgIGludG8gdHdvIHBpZWNlcywgdGhlIGZpcnN0IHBpZWNlIGhhcyBtYXggYG5gIGVsZW1lbnRzLlxuICpcbiAqIEBzaW5jZSAyLjEwLjBcbiAqL1xuZXhwb3J0IHZhciBzcGxpdEF0ID0gZnVuY3Rpb24gKG4pIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIHZhciBtID0gTWF0aC5tYXgoMSwgbik7XG4gICAgICAgIHJldHVybiBtID49IGFzLmxlbmd0aCA/IFtjb3B5KGFzKSwgW11dIDogW3BpcGUoYXMuc2xpY2UoMSwgbSksIHByZXBlbmQoaGVhZChhcykpKSwgYXMuc2xpY2UobSldO1xuICAgIH07XG59O1xuLyoqXG4gKiBAc2luY2UgMi4xMC4wXG4gKi9cbmV4cG9ydCB2YXIgY2h1bmtzT2YgPSBmdW5jdGlvbiAobikgeyByZXR1cm4gY2hvcChzcGxpdEF0KG4pKTsgfTtcbi8qIGlzdGFuYnVsIGlnbm9yZSBuZXh0ICovXG52YXIgX21hcCA9IGZ1bmN0aW9uIChmYSwgZikgeyByZXR1cm4gcGlwZShmYSwgbWFwKGYpKTsgfTtcbi8qIGlzdGFuYnVsIGlnbm9yZSBuZXh0ICovXG52YXIgX21hcFdpdGhJbmRleCA9IGZ1bmN0aW9uIChmYSwgZikgeyByZXR1cm4gcGlwZShmYSwgbWFwV2l0aEluZGV4KGYpKTsgfTtcbi8qIGlzdGFuYnVsIGlnbm9yZSBuZXh0ICovXG52YXIgX2FwID0gZnVuY3Rpb24gKGZhYiwgZmEpIHsgcmV0dXJuIHBpcGUoZmFiLCBhcChmYSkpOyB9O1xuLyogaXN0YW5idWwgaWdub3JlIG5leHQgKi9cbnZhciBfZXh0ZW5kID0gZnVuY3Rpb24gKHdhLCBmKSB7IHJldHVybiBwaXBlKHdhLCBleHRlbmQoZikpOyB9O1xuLyogaXN0YW5idWwgaWdub3JlIG5leHQgKi9cbnZhciBfcmVkdWNlID0gZnVuY3Rpb24gKGZhLCBiLCBmKSB7IHJldHVybiBwaXBlKGZhLCByZWR1Y2UoYiwgZikpOyB9O1xuLyogaXN0YW5idWwgaWdub3JlIG5leHQgKi9cbnZhciBfZm9sZE1hcCA9IGZ1bmN0aW9uIChNKSB7XG4gICAgdmFyIGZvbGRNYXBNID0gZm9sZE1hcChNKTtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGZhLCBmKSB7IHJldHVybiBwaXBlKGZhLCBmb2xkTWFwTShmKSk7IH07XG59O1xuLyogaXN0YW5idWwgaWdub3JlIG5leHQgKi9cbnZhciBfcmVkdWNlUmlnaHQgPSBmdW5jdGlvbiAoZmEsIGIsIGYpIHsgcmV0dXJuIHBpcGUoZmEsIHJlZHVjZVJpZ2h0KGIsIGYpKTsgfTtcbi8qIGlzdGFuYnVsIGlnbm9yZSBuZXh0ICovXG52YXIgX3RyYXZlcnNlID0gZnVuY3Rpb24gKEYpIHtcbiAgICB2YXIgdHJhdmVyc2VGID0gdHJhdmVyc2UoRik7XG4gICAgcmV0dXJuIGZ1bmN0aW9uICh0YSwgZikgeyByZXR1cm4gcGlwZSh0YSwgdHJhdmVyc2VGKGYpKTsgfTtcbn07XG4vKiBpc3RhbmJ1bCBpZ25vcmUgbmV4dCAqL1xudmFyIF9hbHQgPSBmdW5jdGlvbiAoZmEsIHRoYXQpIHsgcmV0dXJuIHBpcGUoZmEsIGFsdCh0aGF0KSk7IH07XG4vKiBpc3RhbmJ1bCBpZ25vcmUgbmV4dCAqL1xudmFyIF9yZWR1Y2VXaXRoSW5kZXggPSBmdW5jdGlvbiAoZmEsIGIsIGYpIHtcbiAgICByZXR1cm4gcGlwZShmYSwgcmVkdWNlV2l0aEluZGV4KGIsIGYpKTtcbn07XG4vKiBpc3RhbmJ1bCBpZ25vcmUgbmV4dCAqL1xudmFyIF9mb2xkTWFwV2l0aEluZGV4ID0gZnVuY3Rpb24gKE0pIHtcbiAgICB2YXIgZm9sZE1hcFdpdGhJbmRleE0gPSBmb2xkTWFwV2l0aEluZGV4KE0pO1xuICAgIHJldHVybiBmdW5jdGlvbiAoZmEsIGYpIHsgcmV0dXJuIHBpcGUoZmEsIGZvbGRNYXBXaXRoSW5kZXhNKGYpKTsgfTtcbn07XG4vKiBpc3RhbmJ1bCBpZ25vcmUgbmV4dCAqL1xudmFyIF9yZWR1Y2VSaWdodFdpdGhJbmRleCA9IGZ1bmN0aW9uIChmYSwgYiwgZikge1xuICAgIHJldHVybiBwaXBlKGZhLCByZWR1Y2VSaWdodFdpdGhJbmRleChiLCBmKSk7XG59O1xuLyogaXN0YW5idWwgaWdub3JlIG5leHQgKi9cbnZhciBfdHJhdmVyc2VXaXRoSW5kZXggPSBmdW5jdGlvbiAoRikge1xuICAgIHZhciB0cmF2ZXJzZVdpdGhJbmRleEYgPSB0cmF2ZXJzZVdpdGhJbmRleChGKTtcbiAgICByZXR1cm4gZnVuY3Rpb24gKHRhLCBmKSB7IHJldHVybiBwaXBlKHRhLCB0cmF2ZXJzZVdpdGhJbmRleEYoZikpOyB9O1xufTtcbi8qKlxuICogTGVzcyBzdHJpY3QgdmVyc2lvbiBvZiBbYGFsdGBdKCNhbHQpLlxuICpcbiAqIFRoZSBgV2Agc3VmZml4IChzaG9ydCBmb3IgKipXKippZGVuaW5nKSBtZWFucyB0aGF0IHRoZSByZXR1cm4gdHlwZXMgd2lsbCBiZSBtZXJnZWQuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCAqIGFzIE5FQSBmcm9tICdmcC10cy9Ob25FbXB0eUFycmF5J1xuICogaW1wb3J0IHsgcGlwZSB9IGZyb20gJ2ZwLXRzL2Z1bmN0aW9uJ1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoXG4gKiAgIHBpcGUoXG4gKiAgICAgWzEsIDIsIDNdIGFzIE5FQS5Ob25FbXB0eUFycmF5PG51bWJlcj4sXG4gKiAgICAgTkVBLmFsdFcoKCkgPT4gWydhJywgJ2InXSlcbiAqICAgKSxcbiAqICAgWzEsIDIsIDMsICdhJywgJ2InXVxuICogKVxuICpcbiAqIEBjYXRlZ29yeSBlcnJvciBoYW5kbGluZ1xuICogQHNpbmNlIDIuOS4wXG4gKi9cbmV4cG9ydCB2YXIgYWx0VyA9IGZ1bmN0aW9uICh0aGF0KSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykge1xuICAgICAgICByZXR1cm4gcGlwZShhcywgY29uY2F0Vyh0aGF0KCkpKTtcbiAgICB9O1xufTtcbi8qKlxuICogSWRlbnRpZmllcyBhbiBhc3NvY2lhdGl2ZSBvcGVyYXRpb24gb24gYSB0eXBlIGNvbnN0cnVjdG9yLiBJdCBpcyBzaW1pbGFyIHRvIGBTZW1pZ3JvdXBgLCBleGNlcHQgdGhhdCBpdCBhcHBsaWVzIHRvXG4gKiB0eXBlcyBvZiBraW5kIGAqIC0+ICpgLlxuICpcbiAqIEluIGNhc2Ugb2YgYE5vbkVtcHR5QXJyYXlgIGNvbmNhdGVuYXRlcyB0aGUgaW5wdXRzIGludG8gYSBzaW5nbGUgYXJyYXkuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCAqIGFzIE5FQSBmcm9tICdmcC10cy9Ob25FbXB0eUFycmF5J1xuICogaW1wb3J0IHsgcGlwZSB9IGZyb20gJ2ZwLXRzL2Z1bmN0aW9uJ1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoXG4gKiAgIHBpcGUoXG4gKiAgICAgWzEsIDIsIDNdLFxuICogICAgIE5FQS5hbHQoKCkgPT4gWzQsIDVdKVxuICogICApLFxuICogICBbMSwgMiwgMywgNCwgNV1cbiAqIClcbiAqXG4gKiBAY2F0ZWdvcnkgZXJyb3IgaGFuZGxpbmdcbiAqIEBzaW5jZSAyLjYuMlxuICovXG5leHBvcnQgdmFyIGFsdCA9IGFsdFc7XG4vKipcbiAqIEFwcGx5IGEgZnVuY3Rpb24gdG8gYW4gYXJndW1lbnQgdW5kZXIgYSB0eXBlIGNvbnN0cnVjdG9yLlxuICpcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIGFwID0gZnVuY3Rpb24gKGFzKSB7XG4gICAgcmV0dXJuIGZsYXRNYXAoZnVuY3Rpb24gKGYpIHsgcmV0dXJuIHBpcGUoYXMsIG1hcChmKSk7IH0pO1xufTtcbi8qKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCAqIGFzIE5FQSBmcm9tICdmcC10cy9Ob25FbXB0eUFycmF5J1xuICogaW1wb3J0IHsgcGlwZSB9IGZyb20gJ2ZwLXRzL2Z1bmN0aW9uJ1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoXG4gKiAgIHBpcGUoXG4gKiAgICAgWzEsIDIsIDNdLFxuICogICAgIE5FQS5mbGF0TWFwKChuKSA9PiBbYGEke259YCwgYGIke259YF0pXG4gKiAgICksXG4gKiAgIFsnYTEnLCAnYjEnLCAnYTInLCAnYjInLCAnYTMnLCAnYjMnXVxuICogKVxuICpcbiAqIEBjYXRlZ29yeSBzZXF1ZW5jaW5nXG4gKiBAc2luY2UgMi4xNC4wXG4gKi9cbmV4cG9ydCB2YXIgZmxhdE1hcCA9IC8qI19fUFVSRV9fKi8gZHVhbCgyLCBmdW5jdGlvbiAobWEsIGYpIHtcbiAgICByZXR1cm4gcGlwZShtYSwgY2hhaW5XaXRoSW5kZXgoZnVuY3Rpb24gKGksIGEpIHsgcmV0dXJuIGYoYSwgaSk7IH0pKTtcbn0pO1xuLyoqXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciBleHRlbmQgPSBmdW5jdGlvbiAoZikge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgdmFyIG5leHQgPSB0YWlsKGFzKTtcbiAgICAgICAgdmFyIG91dCA9IFtmKGFzKV07XG4gICAgICAgIHdoaWxlIChpc05vbkVtcHR5KG5leHQpKSB7XG4gICAgICAgICAgICBvdXQucHVzaChmKG5leHQpKTtcbiAgICAgICAgICAgIG5leHQgPSB0YWlsKG5leHQpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBvdXQ7XG4gICAgfTtcbn07XG4vKipcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIGR1cGxpY2F0ZSA9IC8qI19fUFVSRV9fKi8gZXh0ZW5kKGlkZW50aXR5KTtcbi8qKlxuICogQGNhdGVnb3J5IHNlcXVlbmNpbmdcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIGZsYXR0ZW4gPSAvKiNfX1BVUkVfXyovIGZsYXRNYXAoaWRlbnRpdHkpO1xuLyoqXG4gKiBgbWFwYCBjYW4gYmUgdXNlZCB0byB0dXJuIGZ1bmN0aW9ucyBgKGE6IEEpID0+IEJgIGludG8gZnVuY3Rpb25zIGAoZmE6IEY8QT4pID0+IEY8Qj5gIHdob3NlIGFyZ3VtZW50IGFuZCByZXR1cm4gdHlwZXNcbiAqIHVzZSB0aGUgdHlwZSBjb25zdHJ1Y3RvciBgRmAgdG8gcmVwcmVzZW50IHNvbWUgY29tcHV0YXRpb25hbCBjb250ZXh0LlxuICpcbiAqIEBjYXRlZ29yeSBtYXBwaW5nXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciBtYXAgPSBmdW5jdGlvbiAoZikgeyByZXR1cm4gbWFwV2l0aEluZGV4KGZ1bmN0aW9uIChfLCBhKSB7IHJldHVybiBmKGEpOyB9KTsgfTtcbi8qKlxuICogQGNhdGVnb3J5IG1hcHBpbmdcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIG1hcFdpdGhJbmRleCA9IGZ1bmN0aW9uIChmKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykge1xuICAgICAgICB2YXIgb3V0ID0gW2YoMCwgaGVhZChhcykpXTtcbiAgICAgICAgZm9yICh2YXIgaSA9IDE7IGkgPCBhcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgb3V0LnB1c2goZihpLCBhc1tpXSkpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBvdXQ7XG4gICAgfTtcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBmb2xkaW5nXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciByZWR1Y2UgPSBSTkVBLnJlZHVjZTtcbi8qKlxuICogQGNhdGVnb3J5IGZvbGRpbmdcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIHJlZHVjZVdpdGhJbmRleCA9IFJORUEucmVkdWNlV2l0aEluZGV4O1xuLyoqXG4gKiBAY2F0ZWdvcnkgZm9sZGluZ1xuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgcmVkdWNlUmlnaHQgPSBSTkVBLnJlZHVjZVJpZ2h0O1xuLyoqXG4gKiBAY2F0ZWdvcnkgZm9sZGluZ1xuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgcmVkdWNlUmlnaHRXaXRoSW5kZXggPSBSTkVBLnJlZHVjZVJpZ2h0V2l0aEluZGV4O1xuLyoqXG4gKiBAY2F0ZWdvcnkgdHJhdmVyc2luZ1xuICogQHNpbmNlIDIuNi4zXG4gKi9cbmV4cG9ydCB2YXIgdHJhdmVyc2UgPSBmdW5jdGlvbiAoRikge1xuICAgIHZhciB0cmF2ZXJzZVdpdGhJbmRleEYgPSB0cmF2ZXJzZVdpdGhJbmRleChGKTtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGYpIHsgcmV0dXJuIHRyYXZlcnNlV2l0aEluZGV4RihmdW5jdGlvbiAoXywgYSkgeyByZXR1cm4gZihhKTsgfSk7IH07XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgdHJhdmVyc2luZ1xuICogQHNpbmNlIDIuNi4zXG4gKi9cbmV4cG9ydCB2YXIgc2VxdWVuY2UgPSBmdW5jdGlvbiAoRikgeyByZXR1cm4gdHJhdmVyc2VXaXRoSW5kZXgoRikoZnVuY3Rpb24gKF8sIGEpIHsgcmV0dXJuIGE7IH0pOyB9O1xuLyoqXG4gKiBAY2F0ZWdvcnkgc2VxdWVuY2luZ1xuICogQHNpbmNlIDIuNi4zXG4gKi9cbmV4cG9ydCB2YXIgdHJhdmVyc2VXaXRoSW5kZXggPSBmdW5jdGlvbiAoRikge1xuICAgIHJldHVybiBmdW5jdGlvbiAoZikge1xuICAgICAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgICAgICB2YXIgb3V0ID0gRi5tYXAoZigwLCBoZWFkKGFzKSksIG9mKTtcbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAxOyBpIDwgYXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICBvdXQgPSBGLmFwKEYubWFwKG91dCwgZnVuY3Rpb24gKGJzKSB7IHJldHVybiBmdW5jdGlvbiAoYikgeyByZXR1cm4gcGlwZShicywgYXBwZW5kKGIpKTsgfTsgfSksIGYoaSwgYXNbaV0pKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBvdXQ7XG4gICAgICAgIH07XG4gICAgfTtcbn07XG4vKipcbiAqIEBzaW5jZSAyLjcuMFxuICovXG5leHBvcnQgdmFyIGV4dHJhY3QgPSBSTkVBLmhlYWQ7XG4vKipcbiAqIEBjYXRlZ29yeSB0eXBlIGxhbWJkYXNcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIFVSSSA9ICdOb25FbXB0eUFycmF5Jztcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgZ2V0U2hvdyA9IFJORUEuZ2V0U2hvdztcbi8qKlxuICogQnVpbGRzIGEgYFNlbWlncm91cGAgaW5zdGFuY2UgZm9yIGBOb25FbXB0eUFycmF5YFxuICpcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIGdldFNlbWlncm91cCA9IGZ1bmN0aW9uICgpIHsgcmV0dXJuICh7XG4gICAgY29uY2F0OiBjb25jYXRcbn0pOyB9O1xuLyoqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgZ2V0RXEgfSBmcm9tICdmcC10cy9Ob25FbXB0eUFycmF5J1xuICogaW1wb3J0ICogYXMgTiBmcm9tICdmcC10cy9udW1iZXInXG4gKlxuICogY29uc3QgRSA9IGdldEVxKE4uRXEpXG4gKiBhc3NlcnQuc3RyaWN0RXF1YWwoRS5lcXVhbHMoWzEsIDJdLCBbMSwgMl0pLCB0cnVlKVxuICogYXNzZXJ0LnN0cmljdEVxdWFsKEUuZXF1YWxzKFsxLCAyXSwgWzEsIDNdKSwgZmFsc2UpXG4gKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgZ2V0RXEgPSBSTkVBLmdldEVxO1xuLyoqXG4gKiBAc2luY2UgMi4xMS4wXG4gKi9cbmV4cG9ydCB2YXIgZ2V0VW5pb25TZW1pZ3JvdXAgPSBmdW5jdGlvbiAoRSkge1xuICAgIHZhciB1bmlvbkUgPSB1bmlvbihFKTtcbiAgICByZXR1cm4ge1xuICAgICAgICBjb25jYXQ6IGZ1bmN0aW9uIChmaXJzdCwgc2Vjb25kKSB7IHJldHVybiB1bmlvbkUoc2Vjb25kKShmaXJzdCk7IH1cbiAgICB9O1xufTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuNy4wXG4gKi9cbmV4cG9ydCB2YXIgRnVuY3RvciA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICBtYXA6IF9tYXBcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBtYXBwaW5nXG4gKiBAc2luY2UgMi4xMC4wXG4gKi9cbmV4cG9ydCB2YXIgZmxhcCA9IC8qI19fUFVSRV9fKi8gZmxhcF8oRnVuY3Rvcik7XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjEwLjBcbiAqL1xuZXhwb3J0IHZhciBQb2ludGVkID0ge1xuICAgIFVSSTogVVJJLFxuICAgIG9mOiBvZlxufTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuNy4wXG4gKi9cbmV4cG9ydCB2YXIgRnVuY3RvcldpdGhJbmRleCA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICBtYXA6IF9tYXAsXG4gICAgbWFwV2l0aEluZGV4OiBfbWFwV2l0aEluZGV4XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi4xMC4wXG4gKi9cbmV4cG9ydCB2YXIgQXBwbHkgPSB7XG4gICAgVVJJOiBVUkksXG4gICAgbWFwOiBfbWFwLFxuICAgIGFwOiBfYXBcbn07XG4vKipcbiAqIENvbWJpbmUgdHdvIGVmZmVjdGZ1bCBhY3Rpb25zLCBrZWVwaW5nIG9ubHkgdGhlIHJlc3VsdCBvZiB0aGUgZmlyc3QuXG4gKlxuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgYXBGaXJzdCA9IC8qI19fUFVSRV9fKi8gYXBGaXJzdF8oQXBwbHkpO1xuLyoqXG4gKiBDb21iaW5lIHR3byBlZmZlY3RmdWwgYWN0aW9ucywga2VlcGluZyBvbmx5IHRoZSByZXN1bHQgb2YgdGhlIHNlY29uZC5cbiAqXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBhcFNlY29uZCA9IC8qI19fUFVSRV9fKi8gYXBTZWNvbmRfKEFwcGx5KTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuNy4wXG4gKi9cbmV4cG9ydCB2YXIgQXBwbGljYXRpdmUgPSB7XG4gICAgVVJJOiBVUkksXG4gICAgbWFwOiBfbWFwLFxuICAgIGFwOiBfYXAsXG4gICAgb2Y6IG9mXG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi4xMC4wXG4gKi9cbmV4cG9ydCB2YXIgQ2hhaW4gPSB7XG4gICAgVVJJOiBVUkksXG4gICAgbWFwOiBfbWFwLFxuICAgIGFwOiBfYXAsXG4gICAgY2hhaW46IGZsYXRNYXBcbn07XG4vKipcbiAqIENvbXBvc2VzIGNvbXB1dGF0aW9ucyBpbiBzZXF1ZW5jZSwgdXNpbmcgdGhlIHJldHVybiB2YWx1ZSBvZiBvbmUgY29tcHV0YXRpb24gdG8gZGV0ZXJtaW5lIHRoZSBuZXh0IGNvbXB1dGF0aW9uIGFuZFxuICoga2VlcGluZyBvbmx5IHRoZSByZXN1bHQgb2YgdGhlIGZpcnN0LlxuICpcbiAqIEBjYXRlZ29yeSBzZXF1ZW5jaW5nXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBjaGFpbkZpcnN0ID0gXG4vKiNfX1BVUkVfXyovIGNoYWluRmlyc3RfKENoYWluKTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuNy4wXG4gKi9cbmV4cG9ydCB2YXIgTW9uYWQgPSB7XG4gICAgVVJJOiBVUkksXG4gICAgbWFwOiBfbWFwLFxuICAgIGFwOiBfYXAsXG4gICAgb2Y6IG9mLFxuICAgIGNoYWluOiBmbGF0TWFwXG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi43LjBcbiAqL1xuZXhwb3J0IHZhciBGb2xkYWJsZSA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICByZWR1Y2U6IF9yZWR1Y2UsXG4gICAgZm9sZE1hcDogX2ZvbGRNYXAsXG4gICAgcmVkdWNlUmlnaHQ6IF9yZWR1Y2VSaWdodFxufTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuNy4wXG4gKi9cbmV4cG9ydCB2YXIgRm9sZGFibGVXaXRoSW5kZXggPSB7XG4gICAgVVJJOiBVUkksXG4gICAgcmVkdWNlOiBfcmVkdWNlLFxuICAgIGZvbGRNYXA6IF9mb2xkTWFwLFxuICAgIHJlZHVjZVJpZ2h0OiBfcmVkdWNlUmlnaHQsXG4gICAgcmVkdWNlV2l0aEluZGV4OiBfcmVkdWNlV2l0aEluZGV4LFxuICAgIGZvbGRNYXBXaXRoSW5kZXg6IF9mb2xkTWFwV2l0aEluZGV4LFxuICAgIHJlZHVjZVJpZ2h0V2l0aEluZGV4OiBfcmVkdWNlUmlnaHRXaXRoSW5kZXhcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjcuMFxuICovXG5leHBvcnQgdmFyIFRyYXZlcnNhYmxlID0ge1xuICAgIFVSSTogVVJJLFxuICAgIG1hcDogX21hcCxcbiAgICByZWR1Y2U6IF9yZWR1Y2UsXG4gICAgZm9sZE1hcDogX2ZvbGRNYXAsXG4gICAgcmVkdWNlUmlnaHQ6IF9yZWR1Y2VSaWdodCxcbiAgICB0cmF2ZXJzZTogX3RyYXZlcnNlLFxuICAgIHNlcXVlbmNlOiBzZXF1ZW5jZVxufTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuNy4wXG4gKi9cbmV4cG9ydCB2YXIgVHJhdmVyc2FibGVXaXRoSW5kZXggPSB7XG4gICAgVVJJOiBVUkksXG4gICAgbWFwOiBfbWFwLFxuICAgIG1hcFdpdGhJbmRleDogX21hcFdpdGhJbmRleCxcbiAgICByZWR1Y2U6IF9yZWR1Y2UsXG4gICAgZm9sZE1hcDogX2ZvbGRNYXAsXG4gICAgcmVkdWNlUmlnaHQ6IF9yZWR1Y2VSaWdodCxcbiAgICB0cmF2ZXJzZTogX3RyYXZlcnNlLFxuICAgIHNlcXVlbmNlOiBzZXF1ZW5jZSxcbiAgICByZWR1Y2VXaXRoSW5kZXg6IF9yZWR1Y2VXaXRoSW5kZXgsXG4gICAgZm9sZE1hcFdpdGhJbmRleDogX2ZvbGRNYXBXaXRoSW5kZXgsXG4gICAgcmVkdWNlUmlnaHRXaXRoSW5kZXg6IF9yZWR1Y2VSaWdodFdpdGhJbmRleCxcbiAgICB0cmF2ZXJzZVdpdGhJbmRleDogX3RyYXZlcnNlV2l0aEluZGV4XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi43LjBcbiAqL1xuZXhwb3J0IHZhciBBbHQgPSB7XG4gICAgVVJJOiBVUkksXG4gICAgbWFwOiBfbWFwLFxuICAgIGFsdDogX2FsdFxufTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuNy4wXG4gKi9cbmV4cG9ydCB2YXIgQ29tb25hZCA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICBtYXA6IF9tYXAsXG4gICAgZXh0ZW5kOiBfZXh0ZW5kLFxuICAgIGV4dHJhY3Q6IGV4dHJhY3Rcbn07XG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vLyBkbyBub3RhdGlvblxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLyoqXG4gKiBAY2F0ZWdvcnkgZG8gbm90YXRpb25cbiAqIEBzaW5jZSAyLjkuMFxuICovXG5leHBvcnQgdmFyIERvID0gLyojX19QVVJFX18qLyBvZihfLmVtcHR5UmVjb3JkKTtcbi8qKlxuICogQGNhdGVnb3J5IGRvIG5vdGF0aW9uXG4gKiBAc2luY2UgMi44LjBcbiAqL1xuZXhwb3J0IHZhciBiaW5kVG8gPSAvKiNfX1BVUkVfXyovIGJpbmRUb18oRnVuY3Rvcik7XG52YXIgbGV0XyA9IC8qI19fUFVSRV9fKi8gbGV0X18oRnVuY3Rvcik7XG5leHBvcnQgeyBcbi8qKlxuICogQGNhdGVnb3J5IGRvIG5vdGF0aW9uXG4gKiBAc2luY2UgMi4xMy4wXG4gKi9cbmxldF8gYXMgbGV0IH07XG4vKipcbiAqIEBjYXRlZ29yeSBkbyBub3RhdGlvblxuICogQHNpbmNlIDIuOC4wXG4gKi9cbmV4cG9ydCB2YXIgYmluZCA9IC8qI19fUFVSRV9fKi8gYmluZF8oQ2hhaW4pO1xuLyoqXG4gKiBAY2F0ZWdvcnkgZG8gbm90YXRpb25cbiAqIEBzaW5jZSAyLjguMFxuICovXG5leHBvcnQgdmFyIGFwUyA9IC8qI19fUFVSRV9fKi8gYXBTXyhBcHBseSk7XG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vLyB1dGlsc1xuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLyoqXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciBoZWFkID0gUk5FQS5oZWFkO1xuLyoqXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciB0YWlsID0gZnVuY3Rpb24gKGFzKSB7IHJldHVybiBhcy5zbGljZSgxKTsgfTtcbi8qKlxuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgbGFzdCA9IFJORUEubGFzdDtcbi8qKlxuICogR2V0IGFsbCBidXQgdGhlIGxhc3QgZWxlbWVudCBvZiBhIG5vbiBlbXB0eSBhcnJheSwgY3JlYXRpbmcgYSBuZXcgYXJyYXkuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IGluaXQgfSBmcm9tICdmcC10cy9Ob25FbXB0eUFycmF5J1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoaW5pdChbMSwgMiwgM10pLCBbMSwgMl0pXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKGluaXQoWzFdKSwgW10pXG4gKlxuICogQHNpbmNlIDIuMi4wXG4gKi9cbmV4cG9ydCB2YXIgaW5pdCA9IGZ1bmN0aW9uIChhcykgeyByZXR1cm4gYXMuc2xpY2UoMCwgLTEpOyB9O1xuLyoqXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciBtaW4gPSBSTkVBLm1pbjtcbi8qKlxuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgbWF4ID0gUk5FQS5tYXg7XG4vKipcbiAqIEBzaW5jZSAyLjEwLjBcbiAqL1xuZXhwb3J0IHZhciBjb25jYXRBbGwgPSBmdW5jdGlvbiAoUykge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgcmV0dXJuIGFzLnJlZHVjZShTLmNvbmNhdCk7XG4gICAgfTtcbn07XG4vKipcbiAqIEJyZWFrIGFuIGBBcnJheWAgaW50byBpdHMgZmlyc3QgZWxlbWVudCBhbmQgcmVtYWluaW5nIGVsZW1lbnRzLlxuICpcbiAqIEBjYXRlZ29yeSBwYXR0ZXJuIG1hdGNoaW5nXG4gKiBAc2luY2UgMi4xMS4wXG4gKi9cbmV4cG9ydCB2YXIgbWF0Y2hMZWZ0ID0gZnVuY3Rpb24gKGYpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIHJldHVybiBmKGhlYWQoYXMpLCB0YWlsKGFzKSk7XG4gICAgfTtcbn07XG4vKipcbiAqIEJyZWFrIGFuIGBBcnJheWAgaW50byBpdHMgaW5pdGlhbCBlbGVtZW50cyBhbmQgdGhlIGxhc3QgZWxlbWVudC5cbiAqXG4gKiBAY2F0ZWdvcnkgcGF0dGVybiBtYXRjaGluZ1xuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIG1hdGNoUmlnaHQgPSBmdW5jdGlvbiAoZikge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgcmV0dXJuIGYoaW5pdChhcyksIGxhc3QoYXMpKTtcbiAgICB9O1xufTtcbi8qKlxuICogQXBwbHkgYSBmdW5jdGlvbiB0byB0aGUgaGVhZCwgY3JlYXRpbmcgYSBuZXcgYE5vbkVtcHR5QXJyYXlgLlxuICpcbiAqIEBzaW5jZSAyLjExLjBcbiAqL1xuZXhwb3J0IHZhciBtb2RpZnlIZWFkID0gZnVuY3Rpb24gKGYpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIHJldHVybiBfX3NwcmVhZEFycmF5KFtmKGhlYWQoYXMpKV0sIHRhaWwoYXMpLCB0cnVlKTtcbiAgICB9O1xufTtcbi8qKlxuICogQ2hhbmdlIHRoZSBoZWFkLCBjcmVhdGluZyBhIG5ldyBgTm9uRW1wdHlBcnJheWAuXG4gKlxuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIHVwZGF0ZUhlYWQgPSBmdW5jdGlvbiAoYSkgeyByZXR1cm4gbW9kaWZ5SGVhZChmdW5jdGlvbiAoKSB7IHJldHVybiBhOyB9KTsgfTtcbi8qKlxuICogQXBwbHkgYSBmdW5jdGlvbiB0byB0aGUgbGFzdCBlbGVtZW50LCBjcmVhdGluZyBhIG5ldyBgTm9uRW1wdHlBcnJheWAuXG4gKlxuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIG1vZGlmeUxhc3QgPSBmdW5jdGlvbiAoZikge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgcmV0dXJuIHBpcGUoaW5pdChhcyksIGFwcGVuZChmKGxhc3QoYXMpKSkpO1xuICAgIH07XG59O1xuLyoqXG4gKiBDaGFuZ2UgdGhlIGxhc3QgZWxlbWVudCwgY3JlYXRpbmcgYSBuZXcgYE5vbkVtcHR5QXJyYXlgLlxuICpcbiAqIEBzaW5jZSAyLjExLjBcbiAqL1xuZXhwb3J0IHZhciB1cGRhdGVMYXN0ID0gZnVuY3Rpb24gKGEpIHsgcmV0dXJuIG1vZGlmeUxhc3QoZnVuY3Rpb24gKCkgeyByZXR1cm4gYTsgfSk7IH07XG4vKipcbiAqIFBsYWNlcyBhbiBlbGVtZW50IGluIGJldHdlZW4gbWVtYmVycyBvZiBhIGBOb25FbXB0eUFycmF5YCwgdGhlbiBmb2xkcyB0aGUgcmVzdWx0cyB1c2luZyB0aGUgcHJvdmlkZWQgYFNlbWlncm91cGAuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCAqIGFzIFMgZnJvbSAnZnAtdHMvc3RyaW5nJ1xuICogaW1wb3J0IHsgaW50ZXJjYWxhdGUgfSBmcm9tICdmcC10cy9Ob25FbXB0eUFycmF5J1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoaW50ZXJjYWxhdGUoUy5TZW1pZ3JvdXApKCctJykoWydhJywgJ2InLCAnYyddKSwgJ2EtYi1jJylcbiAqXG4gKiBAc2luY2UgMi4xMi4wXG4gKi9cbmV4cG9ydCB2YXIgaW50ZXJjYWxhdGUgPSBSTkVBLmludGVyY2FsYXRlO1xuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLy8gbGVnYWN5XG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vKipcbiAqIEFsaWFzIG9mIGBmbGF0TWFwYC5cbiAqXG4gKiBAY2F0ZWdvcnkgbGVnYWN5XG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciBjaGFpbiA9IGZsYXRNYXA7XG5leHBvcnQgZnVuY3Rpb24gZ3JvdXBTb3J0KE8pIHtcbiAgICB2YXIgc29ydE8gPSBzb3J0KE8pO1xuICAgIHZhciBncm91cE8gPSBncm91cChPKTtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7IHJldHVybiAoaXNOb25FbXB0eShhcykgPyBncm91cE8oc29ydE8oYXMpKSA6IFtdKTsgfTtcbn1cbmV4cG9ydCBmdW5jdGlvbiBmaWx0ZXIocHJlZGljYXRlKSB7XG4gICAgcmV0dXJuIGZpbHRlcldpdGhJbmRleChmdW5jdGlvbiAoXywgYSkgeyByZXR1cm4gcHJlZGljYXRlKGEpOyB9KTtcbn1cbi8qKlxuICogVXNlIFtgZmlsdGVyV2l0aEluZGV4YF0oLi9BcnJheS50cy5odG1sI2ZpbHRlcndpdGhpbmRleCkgaW5zdGVhZC5cbiAqXG4gKiBAY2F0ZWdvcnkgem9uZSBvZiBkZWF0aFxuICogQHNpbmNlIDIuMC4wXG4gKiBAZGVwcmVjYXRlZFxuICovXG5leHBvcnQgdmFyIGZpbHRlcldpdGhJbmRleCA9IGZ1bmN0aW9uIChwcmVkaWNhdGUpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIHJldHVybiBmcm9tQXJyYXkoYXMuZmlsdGVyKGZ1bmN0aW9uIChhLCBpKSB7IHJldHVybiBwcmVkaWNhdGUoaSwgYSk7IH0pKTtcbiAgICB9O1xufTtcbi8qKlxuICogVXNlIFtgdW5wcmVwZW5kYF0oI3VucHJlcGVuZCkgaW5zdGVhZC5cbiAqXG4gKiBAY2F0ZWdvcnkgem9uZSBvZiBkZWF0aFxuICogQHNpbmNlIDIuOS4wXG4gKiBAZGVwcmVjYXRlZFxuICovXG5leHBvcnQgdmFyIHVuY29ucyA9IHVucHJlcGVuZDtcbi8qKlxuICogVXNlIFtgdW5hcHBlbmRgXSgjdW5hcHBlbmQpIGluc3RlYWQuXG4gKlxuICogQGNhdGVnb3J5IHpvbmUgb2YgZGVhdGhcbiAqIEBzaW5jZSAyLjkuMFxuICogQGRlcHJlY2F0ZWRcbiAqL1xuZXhwb3J0IHZhciB1bnNub2MgPSB1bmFwcGVuZDtcbmV4cG9ydCBmdW5jdGlvbiBjb25zKGhlYWQsIHRhaWwpIHtcbiAgICByZXR1cm4gdGFpbCA9PT0gdW5kZWZpbmVkID8gcHJlcGVuZChoZWFkKSA6IHBpcGUodGFpbCwgcHJlcGVuZChoZWFkKSk7XG59XG4vKipcbiAqIFVzZSBbYGFwcGVuZGBdKC4vQXJyYXkudHMuaHRtbCNhcHBlbmQpIGluc3RlYWQuXG4gKlxuICogQGNhdGVnb3J5IHpvbmUgb2YgZGVhdGhcbiAqIEBzaW5jZSAyLjAuMFxuICogQGRlcHJlY2F0ZWRcbiAqL1xuZXhwb3J0IHZhciBzbm9jID0gZnVuY3Rpb24gKGluaXQsIGVuZCkgeyByZXR1cm4gcGlwZShpbml0LCBhcHBlbmQoZW5kKSk7IH07XG4vKipcbiAqIFVzZSBbYHByZXBlbmRBbGxgXSgjcHJlcGVuZGFsbCkgaW5zdGVhZC5cbiAqXG4gKiBAY2F0ZWdvcnkgem9uZSBvZiBkZWF0aFxuICogQHNpbmNlIDIuOS4wXG4gKiBAZGVwcmVjYXRlZFxuICovXG5leHBvcnQgdmFyIHByZXBlbmRUb0FsbCA9IHByZXBlbmRBbGw7XG4vKipcbiAqIFVzZSBbYGNvbmNhdEFsbGBdKCNjb25jYXRhbGwpIGluc3RlYWQuXG4gKlxuICogQGNhdGVnb3J5IHpvbmUgb2YgZGVhdGhcbiAqIEBzaW5jZSAyLjUuMFxuICogQGRlcHJlY2F0ZWRcbiAqL1xuZXhwb3J0IHZhciBmb2xkID0gUk5FQS5jb25jYXRBbGw7XG4vKipcbiAqIFRoaXMgaW5zdGFuY2UgaXMgZGVwcmVjYXRlZCwgdXNlIHNtYWxsLCBzcGVjaWZpYyBpbnN0YW5jZXMgaW5zdGVhZC5cbiAqIEZvciBleGFtcGxlIGlmIGEgZnVuY3Rpb24gbmVlZHMgYSBgRnVuY3RvcmAgaW5zdGFuY2UsIHBhc3MgYE5FQS5GdW5jdG9yYCBpbnN0ZWFkIG9mIGBORUEubm9uRW1wdHlBcnJheWBcbiAqICh3aGVyZSBgTkVBYCBpcyBmcm9tIGBpbXBvcnQgTkVBIGZyb20gJ2ZwLXRzL05vbkVtcHR5QXJyYXknYClcbiAqXG4gKiBAY2F0ZWdvcnkgem9uZSBvZiBkZWF0aFxuICogQHNpbmNlIDIuMC4wXG4gKiBAZGVwcmVjYXRlZFxuICovXG5leHBvcnQgdmFyIG5vbkVtcHR5QXJyYXkgPSB7XG4gICAgVVJJOiBVUkksXG4gICAgb2Y6IG9mLFxuICAgIG1hcDogX21hcCxcbiAgICBtYXBXaXRoSW5kZXg6IF9tYXBXaXRoSW5kZXgsXG4gICAgYXA6IF9hcCxcbiAgICBjaGFpbjogZmxhdE1hcCxcbiAgICBleHRlbmQ6IF9leHRlbmQsXG4gICAgZXh0cmFjdDogZXh0cmFjdCxcbiAgICByZWR1Y2U6IF9yZWR1Y2UsXG4gICAgZm9sZE1hcDogX2ZvbGRNYXAsXG4gICAgcmVkdWNlUmlnaHQ6IF9yZWR1Y2VSaWdodCxcbiAgICB0cmF2ZXJzZTogX3RyYXZlcnNlLFxuICAgIHNlcXVlbmNlOiBzZXF1ZW5jZSxcbiAgICByZWR1Y2VXaXRoSW5kZXg6IF9yZWR1Y2VXaXRoSW5kZXgsXG4gICAgZm9sZE1hcFdpdGhJbmRleDogX2ZvbGRNYXBXaXRoSW5kZXgsXG4gICAgcmVkdWNlUmlnaHRXaXRoSW5kZXg6IF9yZWR1Y2VSaWdodFdpdGhJbmRleCxcbiAgICB0cmF2ZXJzZVdpdGhJbmRleDogX3RyYXZlcnNlV2l0aEluZGV4LFxuICAgIGFsdDogX2FsdFxufTtcbiIsCiAgInZhciBfX3NwcmVhZEFycmF5ID0gKHRoaXMgJiYgdGhpcy5fX3NwcmVhZEFycmF5KSB8fCBmdW5jdGlvbiAodG8sIGZyb20sIHBhY2spIHtcbiAgICBpZiAocGFjayB8fCBhcmd1bWVudHMubGVuZ3RoID09PSAyKSBmb3IgKHZhciBpID0gMCwgbCA9IGZyb20ubGVuZ3RoLCBhcjsgaSA8IGw7IGkrKykge1xuICAgICAgICBpZiAoYXIgfHwgIShpIGluIGZyb20pKSB7XG4gICAgICAgICAgICBpZiAoIWFyKSBhciA9IEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGZyb20sIDAsIGkpO1xuICAgICAgICAgICAgYXJbaV0gPSBmcm9tW2ldO1xuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiB0by5jb25jYXQoYXIgfHwgQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoZnJvbSkpO1xufTtcbmltcG9ydCB7IGFwRmlyc3QgYXMgYXBGaXJzdF8sIGFwUyBhcyBhcFNfLCBhcFNlY29uZCBhcyBhcFNlY29uZF8gfSBmcm9tICcuL0FwcGx5JztcbmltcG9ydCB7IGJpbmQgYXMgYmluZF8sIGNoYWluRmlyc3QgYXMgY2hhaW5GaXJzdF8gfSBmcm9tICcuL0NoYWluJztcbmltcG9ydCB7IGR1YWwsIGlkZW50aXR5LCBwaXBlIH0gZnJvbSAnLi9mdW5jdGlvbic7XG5pbXBvcnQgeyBiaW5kVG8gYXMgYmluZFRvXywgZmxhcCBhcyBmbGFwXywgbGV0IGFzIGxldF9fIH0gZnJvbSAnLi9GdW5jdG9yJztcbmltcG9ydCAqIGFzIF8gZnJvbSAnLi9pbnRlcm5hbCc7XG5pbXBvcnQgeyBnZXRNb25vaWQgfSBmcm9tICcuL09yZCc7XG5pbXBvcnQgKiBhcyBSTkVBIGZyb20gJy4vUmVhZG9ubHlOb25FbXB0eUFycmF5Jztcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8vIGludGVybmFsXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vKipcbiAqIEBpbnRlcm5hbFxuICovXG5leHBvcnQgdmFyIGlzTm9uRW1wdHkgPSBmdW5jdGlvbiAoYXMpIHsgcmV0dXJuIGFzLmxlbmd0aCA+IDA7IH07XG4vKipcbiAqIEBpbnRlcm5hbFxuICovXG5leHBvcnQgdmFyIGlzT3V0T2ZCb3VuZCA9IGZ1bmN0aW9uIChpLCBhcykgeyByZXR1cm4gaSA8IDAgfHwgaSA+PSBhcy5sZW5ndGg7IH07XG4vKipcbiAqIEBpbnRlcm5hbFxuICovXG5leHBvcnQgdmFyIHByZXBlbmRXID0gZnVuY3Rpb24gKGhlYWQpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKHRhaWwpIHtcbiAgICAgICAgcmV0dXJuIF9fc3ByZWFkQXJyYXkoW2hlYWRdLCB0YWlsLCB0cnVlKTtcbiAgICB9O1xufTtcbi8qKlxuICogQGludGVybmFsXG4gKi9cbmV4cG9ydCB2YXIgcHJlcGVuZCA9IHByZXBlbmRXO1xuLyoqXG4gKiBAaW50ZXJuYWxcbiAqL1xuZXhwb3J0IHZhciBhcHBlbmRXID0gZnVuY3Rpb24gKGVuZCkge1xuICAgIHJldHVybiBmdW5jdGlvbiAoaW5pdCkge1xuICAgICAgICByZXR1cm4gX19zcHJlYWRBcnJheShfX3NwcmVhZEFycmF5KFtdLCBpbml0LCB0cnVlKSwgW2VuZF0sIGZhbHNlKTtcbiAgICB9O1xufTtcbi8qKlxuICogQGludGVybmFsXG4gKi9cbmV4cG9ydCB2YXIgYXBwZW5kID0gYXBwZW5kVztcbi8qKlxuICogQGludGVybmFsXG4gKi9cbmV4cG9ydCB2YXIgdW5zYWZlSW5zZXJ0QXQgPSBmdW5jdGlvbiAoaSwgYSwgYXMpIHtcbiAgICBpZiAoaXNOb25FbXB0eShhcykpIHtcbiAgICAgICAgdmFyIHhzID0gZnJvbVJlYWRvbmx5Tm9uRW1wdHlBcnJheShhcyk7XG4gICAgICAgIHhzLnNwbGljZShpLCAwLCBhKTtcbiAgICAgICAgcmV0dXJuIHhzO1xuICAgIH1cbiAgICByZXR1cm4gW2FdO1xufTtcbi8qKlxuICogQGludGVybmFsXG4gKi9cbmV4cG9ydCB2YXIgdW5zYWZlVXBkYXRlQXQgPSBmdW5jdGlvbiAoaSwgYSwgYXMpIHtcbiAgICB2YXIgeHMgPSBmcm9tUmVhZG9ubHlOb25FbXB0eUFycmF5KGFzKTtcbiAgICB4c1tpXSA9IGE7XG4gICAgcmV0dXJuIHhzO1xufTtcbi8qKlxuICogUmVtb3ZlIGR1cGxpY2F0ZXMgZnJvbSBhIGBOb25FbXB0eUFycmF5YCwga2VlcGluZyB0aGUgZmlyc3Qgb2NjdXJyZW5jZSBvZiBhbiBlbGVtZW50LlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyB1bmlxIH0gZnJvbSAnZnAtdHMvTm9uRW1wdHlBcnJheSdcbiAqIGltcG9ydCAqIGFzIE4gZnJvbSAnZnAtdHMvbnVtYmVyJ1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwodW5pcShOLkVxKShbMSwgMiwgMV0pLCBbMSwgMl0pXG4gKlxuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIHVuaXEgPSBmdW5jdGlvbiAoRSkge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgaWYgKGFzLmxlbmd0aCA9PT0gMSkge1xuICAgICAgICAgICAgcmV0dXJuIGNvcHkoYXMpO1xuICAgICAgICB9XG4gICAgICAgIHZhciBvdXQgPSBbaGVhZChhcyldO1xuICAgICAgICB2YXIgcmVzdCA9IHRhaWwoYXMpO1xuICAgICAgICB2YXIgX2xvb3BfMSA9IGZ1bmN0aW9uIChhKSB7XG4gICAgICAgICAgICBpZiAob3V0LmV2ZXJ5KGZ1bmN0aW9uIChvKSB7IHJldHVybiAhRS5lcXVhbHMobywgYSk7IH0pKSB7XG4gICAgICAgICAgICAgICAgb3V0LnB1c2goYSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIGZvciAodmFyIF9pID0gMCwgcmVzdF8xID0gcmVzdDsgX2kgPCByZXN0XzEubGVuZ3RoOyBfaSsrKSB7XG4gICAgICAgICAgICB2YXIgYSA9IHJlc3RfMVtfaV07XG4gICAgICAgICAgICBfbG9vcF8xKGEpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBvdXQ7XG4gICAgfTtcbn07XG4vKipcbiAqIFNvcnQgdGhlIGVsZW1lbnRzIG9mIGEgYE5vbkVtcHR5QXJyYXlgIGluIGluY3JlYXNpbmcgb3JkZXIsIHdoZXJlIGVsZW1lbnRzIGFyZSBjb21wYXJlZCB1c2luZyBmaXJzdCBgb3Jkc1swXWAsIHRoZW4gYG9yZHNbMV1gLFxuICogZXRjLi4uXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCAqIGFzIE5FQSBmcm9tICdmcC10cy9Ob25FbXB0eUFycmF5J1xuICogaW1wb3J0IHsgY29udHJhbWFwIH0gZnJvbSAnZnAtdHMvT3JkJ1xuICogaW1wb3J0ICogYXMgUyBmcm9tICdmcC10cy9zdHJpbmcnXG4gKiBpbXBvcnQgKiBhcyBOIGZyb20gJ2ZwLXRzL251bWJlcidcbiAqIGltcG9ydCB7IHBpcGUgfSBmcm9tICdmcC10cy9mdW5jdGlvbidcbiAqXG4gKiBpbnRlcmZhY2UgUGVyc29uIHtcbiAqICAgbmFtZTogc3RyaW5nXG4gKiAgIGFnZTogbnVtYmVyXG4gKiB9XG4gKlxuICogY29uc3QgYnlOYW1lID0gcGlwZShTLk9yZCwgY29udHJhbWFwKChwOiBQZXJzb24pID0+IHAubmFtZSkpXG4gKlxuICogY29uc3QgYnlBZ2UgPSBwaXBlKE4uT3JkLCBjb250cmFtYXAoKHA6IFBlcnNvbikgPT4gcC5hZ2UpKVxuICpcbiAqIGNvbnN0IHNvcnRCeU5hbWVCeUFnZSA9IE5FQS5zb3J0QnkoW2J5TmFtZSwgYnlBZ2VdKVxuICpcbiAqIGNvbnN0IHBlcnNvbnM6IE5FQS5Ob25FbXB0eUFycmF5PFBlcnNvbj4gPSBbXG4gKiAgIHsgbmFtZTogJ2EnLCBhZ2U6IDEgfSxcbiAqICAgeyBuYW1lOiAnYicsIGFnZTogMyB9LFxuICogICB7IG5hbWU6ICdjJywgYWdlOiAyIH0sXG4gKiAgIHsgbmFtZTogJ2InLCBhZ2U6IDIgfVxuICogXVxuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoc29ydEJ5TmFtZUJ5QWdlKHBlcnNvbnMpLCBbXG4gKiAgIHsgbmFtZTogJ2EnLCBhZ2U6IDEgfSxcbiAqICAgeyBuYW1lOiAnYicsIGFnZTogMiB9LFxuICogICB7IG5hbWU6ICdiJywgYWdlOiAzIH0sXG4gKiAgIHsgbmFtZTogJ2MnLCBhZ2U6IDIgfVxuICogXSlcbiAqXG4gKiBAc2luY2UgMi4xMS4wXG4gKi9cbmV4cG9ydCB2YXIgc29ydEJ5ID0gZnVuY3Rpb24gKG9yZHMpIHtcbiAgICBpZiAoaXNOb25FbXB0eShvcmRzKSkge1xuICAgICAgICB2YXIgTSA9IGdldE1vbm9pZCgpO1xuICAgICAgICByZXR1cm4gc29ydChvcmRzLnJlZHVjZShNLmNvbmNhdCwgTS5lbXB0eSkpO1xuICAgIH1cbiAgICByZXR1cm4gY29weTtcbn07XG4vKipcbiAqIEBzaW5jZSAyLjExLjBcbiAqL1xuZXhwb3J0IHZhciB1bmlvbiA9IGZ1bmN0aW9uIChFKSB7XG4gICAgdmFyIHVuaXFFID0gdW5pcShFKTtcbiAgICByZXR1cm4gZnVuY3Rpb24gKHNlY29uZCkgeyByZXR1cm4gZnVuY3Rpb24gKGZpcnN0KSB7IHJldHVybiB1bmlxRShwaXBlKGZpcnN0LCBjb25jYXQoc2Vjb25kKSkpOyB9OyB9O1xufTtcbi8qKlxuICogUm90YXRlIGEgYE5vbkVtcHR5QXJyYXlgIGJ5IGBuYCBzdGVwcy5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgcm90YXRlIH0gZnJvbSAnZnAtdHMvTm9uRW1wdHlBcnJheSdcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKHJvdGF0ZSgyKShbMSwgMiwgMywgNCwgNV0pLCBbNCwgNSwgMSwgMiwgM10pXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKHJvdGF0ZSgtMikoWzEsIDIsIDMsIDQsIDVdKSwgWzMsIDQsIDUsIDEsIDJdKVxuICpcbiAqIEBzaW5jZSAyLjExLjBcbiAqL1xuZXhwb3J0IHZhciByb3RhdGUgPSBmdW5jdGlvbiAobikge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgdmFyIGxlbiA9IGFzLmxlbmd0aDtcbiAgICAgICAgdmFyIG0gPSBNYXRoLnJvdW5kKG4pICUgbGVuO1xuICAgICAgICBpZiAoaXNPdXRPZkJvdW5kKE1hdGguYWJzKG0pLCBhcykgfHwgbSA9PT0gMCkge1xuICAgICAgICAgICAgcmV0dXJuIGNvcHkoYXMpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChtIDwgMCkge1xuICAgICAgICAgICAgdmFyIF9hID0gc3BsaXRBdCgtbSkoYXMpLCBmID0gX2FbMF0sIHMgPSBfYVsxXTtcbiAgICAgICAgICAgIHJldHVybiBwaXBlKHMsIGNvbmNhdChmKSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gcm90YXRlKG0gLSBsZW4pKGFzKTtcbiAgICAgICAgfVxuICAgIH07XG59O1xuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLy8gY29uc3RydWN0b3JzXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vKipcbiAqIEBjYXRlZ29yeSBjb252ZXJzaW9uc1xuICogQHNpbmNlIDIuMTAuMFxuICovXG5leHBvcnQgdmFyIGZyb21SZWFkb25seU5vbkVtcHR5QXJyYXkgPSBfLmZyb21SZWFkb25seU5vbkVtcHR5QXJyYXk7XG4vKipcbiAqIEJ1aWxkcyBhIGBOb25FbXB0eUFycmF5YCBmcm9tIGFuIGBBcnJheWAgcmV0dXJuaW5nIGBub25lYCBpZiBgYXNgIGlzIGFuIGVtcHR5IGFycmF5XG4gKlxuICogQGNhdGVnb3J5IGNvbnZlcnNpb25zXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciBmcm9tQXJyYXkgPSBmdW5jdGlvbiAoYXMpIHsgcmV0dXJuIChpc05vbkVtcHR5KGFzKSA/IF8uc29tZShhcykgOiBfLm5vbmUpOyB9O1xuLyoqXG4gKiBSZXR1cm4gYSBgTm9uRW1wdHlBcnJheWAgb2YgbGVuZ3RoIGBuYCB3aXRoIGVsZW1lbnQgYGlgIGluaXRpYWxpemVkIHdpdGggYGYoaSlgLlxuICpcbiAqICoqTm90ZSoqLiBgbmAgaXMgbm9ybWFsaXplZCB0byBhIG5hdHVyYWwgbnVtYmVyLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBtYWtlQnkgfSBmcm9tICdmcC10cy9Ob25FbXB0eUFycmF5J1xuICogaW1wb3J0IHsgcGlwZSB9IGZyb20gJ2ZwLXRzL2Z1bmN0aW9uJ1xuICpcbiAqIGNvbnN0IGRvdWJsZSA9IChuOiBudW1iZXIpOiBudW1iZXIgPT4gbiAqIDJcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwocGlwZSg1LCBtYWtlQnkoZG91YmxlKSksIFswLCAyLCA0LCA2LCA4XSlcbiAqXG4gKiBAY2F0ZWdvcnkgY29uc3RydWN0b3JzXG4gKiBAc2luY2UgMi4xMS4wXG4gKi9cbmV4cG9ydCB2YXIgbWFrZUJ5ID0gZnVuY3Rpb24gKGYpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKG4pIHtcbiAgICAgICAgdmFyIGogPSBNYXRoLm1heCgwLCBNYXRoLmZsb29yKG4pKTtcbiAgICAgICAgdmFyIG91dCA9IFtmKDApXTtcbiAgICAgICAgZm9yICh2YXIgaSA9IDE7IGkgPCBqOyBpKyspIHtcbiAgICAgICAgICAgIG91dC5wdXNoKGYoaSkpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBvdXQ7XG4gICAgfTtcbn07XG4vKipcbiAqIENyZWF0ZSBhIGBOb25FbXB0eUFycmF5YCBjb250YWluaW5nIGEgdmFsdWUgcmVwZWF0ZWQgdGhlIHNwZWNpZmllZCBudW1iZXIgb2YgdGltZXMuXG4gKlxuICogKipOb3RlKiouIGBuYCBpcyBub3JtYWxpemVkIHRvIGEgbmF0dXJhbCBudW1iZXIuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IHJlcGxpY2F0ZSB9IGZyb20gJ2ZwLXRzL05vbkVtcHR5QXJyYXknXG4gKiBpbXBvcnQgeyBwaXBlIH0gZnJvbSAnZnAtdHMvZnVuY3Rpb24nXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChwaXBlKDMsIHJlcGxpY2F0ZSgnYScpKSwgWydhJywgJ2EnLCAnYSddKVxuICpcbiAqIEBjYXRlZ29yeSBjb25zdHJ1Y3RvcnNcbiAqIEBzaW5jZSAyLjExLjBcbiAqL1xuZXhwb3J0IHZhciByZXBsaWNhdGUgPSBmdW5jdGlvbiAoYSkgeyByZXR1cm4gbWFrZUJ5KGZ1bmN0aW9uICgpIHsgcmV0dXJuIGE7IH0pOyB9O1xuLyoqXG4gKiBDcmVhdGUgYSBgTm9uRW1wdHlBcnJheWAgY29udGFpbmluZyBhIHJhbmdlIG9mIGludGVnZXJzLCBpbmNsdWRpbmcgYm90aCBlbmRwb2ludHMuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IHJhbmdlIH0gZnJvbSAnZnAtdHMvTm9uRW1wdHlBcnJheSdcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKHJhbmdlKDEsIDUpLCBbMSwgMiwgMywgNCwgNV0pXG4gKlxuICogQGNhdGVnb3J5IGNvbnN0cnVjdG9yc1xuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIHJhbmdlID0gZnVuY3Rpb24gKHN0YXJ0LCBlbmQpIHtcbiAgICByZXR1cm4gc3RhcnQgPD0gZW5kID8gbWFrZUJ5KGZ1bmN0aW9uIChpKSB7IHJldHVybiBzdGFydCArIGk7IH0pKGVuZCAtIHN0YXJ0ICsgMSkgOiBbc3RhcnRdO1xufTtcbi8qKlxuICogUmV0dXJuIHRoZSB0dXBsZSBvZiB0aGUgYGhlYWRgIGFuZCB0aGUgYHRhaWxgLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyB1bnByZXBlbmQgfSBmcm9tICdmcC10cy9Ob25FbXB0eUFycmF5J1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwodW5wcmVwZW5kKFsxLCAyLCAzXSksIFsxLCBbMiwgM11dKVxuICpcbiAqIEBzaW5jZSAyLjkuMFxuICovXG5leHBvcnQgdmFyIHVucHJlcGVuZCA9IGZ1bmN0aW9uIChhcykgeyByZXR1cm4gW2hlYWQoYXMpLCB0YWlsKGFzKV07IH07XG4vKipcbiAqIFJldHVybiB0aGUgdHVwbGUgb2YgdGhlIGBpbml0YCBhbmQgdGhlIGBsYXN0YC5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgdW5hcHBlbmQgfSBmcm9tICdmcC10cy9Ob25FbXB0eUFycmF5J1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwodW5hcHBlbmQoWzEsIDIsIDMsIDRdKSwgW1sxLCAyLCAzXSwgNF0pXG4gKlxuICogQHNpbmNlIDIuOS4wXG4gKi9cbmV4cG9ydCB2YXIgdW5hcHBlbmQgPSBmdW5jdGlvbiAoYXMpIHsgcmV0dXJuIFtpbml0KGFzKSwgbGFzdChhcyldOyB9O1xuZXhwb3J0IGZ1bmN0aW9uIGNvbmNhdFcoc2Vjb25kKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChmaXJzdCkgeyByZXR1cm4gZmlyc3QuY29uY2F0KHNlY29uZCk7IH07XG59XG5leHBvcnQgZnVuY3Rpb24gY29uY2F0KHgsIHkpIHtcbiAgICByZXR1cm4geSA/IHguY29uY2F0KHkpIDogZnVuY3Rpb24gKHkpIHsgcmV0dXJuIHkuY29uY2F0KHgpOyB9O1xufVxuLyoqXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciByZXZlcnNlID0gZnVuY3Rpb24gKGFzKSB7IHJldHVybiBfX3NwcmVhZEFycmF5KFtsYXN0KGFzKV0sIGFzLnNsaWNlKDAsIC0xKS5yZXZlcnNlKCksIHRydWUpOyB9O1xuZXhwb3J0IGZ1bmN0aW9uIGdyb3VwKEUpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIHZhciBsZW4gPSBhcy5sZW5ndGg7XG4gICAgICAgIGlmIChsZW4gPT09IDApIHtcbiAgICAgICAgICAgIHJldHVybiBbXTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgb3V0ID0gW107XG4gICAgICAgIHZhciBoZWFkID0gYXNbMF07XG4gICAgICAgIHZhciBuZWEgPSBbaGVhZF07XG4gICAgICAgIGZvciAodmFyIGkgPSAxOyBpIDwgbGVuOyBpKyspIHtcbiAgICAgICAgICAgIHZhciBhID0gYXNbaV07XG4gICAgICAgICAgICBpZiAoRS5lcXVhbHMoYSwgaGVhZCkpIHtcbiAgICAgICAgICAgICAgICBuZWEucHVzaChhKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIG91dC5wdXNoKG5lYSk7XG4gICAgICAgICAgICAgICAgaGVhZCA9IGE7XG4gICAgICAgICAgICAgICAgbmVhID0gW2hlYWRdO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIG91dC5wdXNoKG5lYSk7XG4gICAgICAgIHJldHVybiBvdXQ7XG4gICAgfTtcbn1cbi8qKlxuICogU3BsaXRzIGFuIGFycmF5IGludG8gc3ViLW5vbi1lbXB0eS1hcnJheXMgc3RvcmVkIGluIGFuIG9iamVjdCwgYmFzZWQgb24gdGhlIHJlc3VsdCBvZiBjYWxsaW5nIGEgYHN0cmluZ2AtcmV0dXJuaW5nXG4gKiBmdW5jdGlvbiBvbiBlYWNoIGVsZW1lbnQsIGFuZCBncm91cGluZyB0aGUgcmVzdWx0cyBhY2NvcmRpbmcgdG8gdmFsdWVzIHJldHVybmVkXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IGdyb3VwQnkgfSBmcm9tICdmcC10cy9Ob25FbXB0eUFycmF5J1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoZ3JvdXBCeSgoczogc3RyaW5nKSA9PiBTdHJpbmcocy5sZW5ndGgpKShbJ2EnLCAnYicsICdhYiddKSwge1xuICogICAnMSc6IFsnYScsICdiJ10sXG4gKiAgICcyJzogWydhYiddXG4gKiB9KVxuICpcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIGdyb3VwQnkgPSBmdW5jdGlvbiAoZikge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgdmFyIG91dCA9IHt9O1xuICAgICAgICBmb3IgKHZhciBfaSA9IDAsIGFzXzEgPSBhczsgX2kgPCBhc18xLmxlbmd0aDsgX2krKykge1xuICAgICAgICAgICAgdmFyIGEgPSBhc18xW19pXTtcbiAgICAgICAgICAgIHZhciBrID0gZihhKTtcbiAgICAgICAgICAgIGlmIChfLmhhcy5jYWxsKG91dCwgaykpIHtcbiAgICAgICAgICAgICAgICBvdXRba10ucHVzaChhKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIG91dFtrXSA9IFthXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gb3V0O1xuICAgIH07XG59O1xuLyoqXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciBzb3J0ID0gZnVuY3Rpb24gKE8pIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIHJldHVybiBhcy5zbGljZSgpLnNvcnQoTy5jb21wYXJlKTtcbiAgICB9O1xufTtcbi8qKlxuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgaW5zZXJ0QXQgPSBmdW5jdGlvbiAoaSwgYSkge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgcmV0dXJuIGkgPCAwIHx8IGkgPiBhcy5sZW5ndGggPyBfLm5vbmUgOiBfLnNvbWUodW5zYWZlSW5zZXJ0QXQoaSwgYSwgYXMpKTtcbiAgICB9O1xufTtcbi8qKlxuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgdXBkYXRlQXQgPSBmdW5jdGlvbiAoaSwgYSkge1xuICAgIHJldHVybiBtb2RpZnlBdChpLCBmdW5jdGlvbiAoKSB7IHJldHVybiBhOyB9KTtcbn07XG4vKipcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIG1vZGlmeUF0ID0gZnVuY3Rpb24gKGksIGYpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIHJldHVybiBpc091dE9mQm91bmQoaSwgYXMpID8gXy5ub25lIDogXy5zb21lKHVuc2FmZVVwZGF0ZUF0KGksIGYoYXNbaV0pLCBhcykpO1xuICAgIH07XG59O1xuLyoqXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciBjb3B5ID0gZnJvbVJlYWRvbmx5Tm9uRW1wdHlBcnJheTtcbi8qKlxuICogQGNhdGVnb3J5IGNvbnN0cnVjdG9yc1xuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgb2YgPSBmdW5jdGlvbiAoYSkgeyByZXR1cm4gW2FdOyB9O1xuLyoqXG4gKiBAc2luY2UgMi41LjFcbiAqL1xuZXhwb3J0IHZhciB6aXBXaXRoID0gZnVuY3Rpb24gKGFzLCBicywgZikge1xuICAgIHZhciBjcyA9IFtmKGFzWzBdLCBic1swXSldO1xuICAgIHZhciBsZW4gPSBNYXRoLm1pbihhcy5sZW5ndGgsIGJzLmxlbmd0aCk7XG4gICAgZm9yICh2YXIgaSA9IDE7IGkgPCBsZW47IGkrKykge1xuICAgICAgICBjc1tpXSA9IGYoYXNbaV0sIGJzW2ldKTtcbiAgICB9XG4gICAgcmV0dXJuIGNzO1xufTtcbmV4cG9ydCBmdW5jdGlvbiB6aXAoYXMsIGJzKSB7XG4gICAgaWYgKGJzID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIChicykgeyByZXR1cm4gemlwKGJzLCBhcyk7IH07XG4gICAgfVxuICAgIHJldHVybiB6aXBXaXRoKGFzLCBicywgZnVuY3Rpb24gKGEsIGIpIHsgcmV0dXJuIFthLCBiXTsgfSk7XG59XG4vKipcbiAqIEBzaW5jZSAyLjUuMVxuICovXG5leHBvcnQgdmFyIHVuemlwID0gZnVuY3Rpb24gKGFicykge1xuICAgIHZhciBmYSA9IFthYnNbMF1bMF1dO1xuICAgIHZhciBmYiA9IFthYnNbMF1bMV1dO1xuICAgIGZvciAodmFyIGkgPSAxOyBpIDwgYWJzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIGZhW2ldID0gYWJzW2ldWzBdO1xuICAgICAgICBmYltpXSA9IGFic1tpXVsxXTtcbiAgICB9XG4gICAgcmV0dXJuIFtmYSwgZmJdO1xufTtcbi8qKlxuICogUHJlcGVuZCBhbiBlbGVtZW50IHRvIGV2ZXJ5IG1lbWJlciBvZiBhbiBhcnJheVxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBwcmVwZW5kQWxsIH0gZnJvbSAnZnAtdHMvTm9uRW1wdHlBcnJheSdcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKHByZXBlbmRBbGwoOSkoWzEsIDIsIDMsIDRdKSwgWzksIDEsIDksIDIsIDksIDMsIDksIDRdKVxuICpcbiAqIEBzaW5jZSAyLjEwLjBcbiAqL1xuZXhwb3J0IHZhciBwcmVwZW5kQWxsID0gZnVuY3Rpb24gKG1pZGRsZSkge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgdmFyIG91dCA9IFttaWRkbGUsIGFzWzBdXTtcbiAgICAgICAgZm9yICh2YXIgaSA9IDE7IGkgPCBhcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgb3V0LnB1c2gobWlkZGxlLCBhc1tpXSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG91dDtcbiAgICB9O1xufTtcbi8qKlxuICogUGxhY2VzIGFuIGVsZW1lbnQgaW4gYmV0d2VlbiBtZW1iZXJzIG9mIGFuIGFycmF5XG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IGludGVyc3BlcnNlIH0gZnJvbSAnZnAtdHMvTm9uRW1wdHlBcnJheSdcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKGludGVyc3BlcnNlKDkpKFsxLCAyLCAzLCA0XSksIFsxLCA5LCAyLCA5LCAzLCA5LCA0XSlcbiAqXG4gKiBAc2luY2UgMi45LjBcbiAqL1xuZXhwb3J0IHZhciBpbnRlcnNwZXJzZSA9IGZ1bmN0aW9uIChtaWRkbGUpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIHZhciByZXN0ID0gdGFpbChhcyk7XG4gICAgICAgIHJldHVybiBpc05vbkVtcHR5KHJlc3QpID8gcGlwZShyZXN0LCBwcmVwZW5kQWxsKG1pZGRsZSksIHByZXBlbmQoaGVhZChhcykpKSA6IGNvcHkoYXMpO1xuICAgIH07XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgZm9sZGluZ1xuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgZm9sZE1hcFdpdGhJbmRleCA9IFJORUEuZm9sZE1hcFdpdGhJbmRleDtcbi8qKlxuICogQGNhdGVnb3J5IGZvbGRpbmdcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIGZvbGRNYXAgPSBSTkVBLmZvbGRNYXA7XG4vKipcbiAqIEBjYXRlZ29yeSBzZXF1ZW5jaW5nXG4gKiBAc2luY2UgMi4xMC4wXG4gKi9cbmV4cG9ydCB2YXIgY2hhaW5XaXRoSW5kZXggPSBmdW5jdGlvbiAoZikge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgdmFyIG91dCA9IGZyb21SZWFkb25seU5vbkVtcHR5QXJyYXkoZigwLCBoZWFkKGFzKSkpO1xuICAgICAgICBmb3IgKHZhciBpID0gMTsgaSA8IGFzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICBvdXQucHVzaC5hcHBseShvdXQsIGYoaSwgYXNbaV0pKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gb3V0O1xuICAgIH07XG59O1xuLyoqXG4gKiBAc2luY2UgMi4xMC4wXG4gKi9cbmV4cG9ydCB2YXIgY2hvcCA9IGZ1bmN0aW9uIChmKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykge1xuICAgICAgICB2YXIgX2EgPSBmKGFzKSwgYiA9IF9hWzBdLCByZXN0ID0gX2FbMV07XG4gICAgICAgIHZhciBvdXQgPSBbYl07XG4gICAgICAgIHZhciBuZXh0ID0gcmVzdDtcbiAgICAgICAgd2hpbGUgKGlzTm9uRW1wdHkobmV4dCkpIHtcbiAgICAgICAgICAgIHZhciBfYiA9IGYobmV4dCksIGJfMSA9IF9iWzBdLCByZXN0XzIgPSBfYlsxXTtcbiAgICAgICAgICAgIG91dC5wdXNoKGJfMSk7XG4gICAgICAgICAgICBuZXh0ID0gcmVzdF8yO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBvdXQ7XG4gICAgfTtcbn07XG4vKipcbiAqIFNwbGl0cyBhIGBOb25FbXB0eUFycmF5YCBpbnRvIHR3byBwaWVjZXMsIHRoZSBmaXJzdCBwaWVjZSBoYXMgbWF4IGBuYCBlbGVtZW50cy5cbiAqXG4gKiBAc2luY2UgMi4xMC4wXG4gKi9cbmV4cG9ydCB2YXIgc3BsaXRBdCA9IGZ1bmN0aW9uIChuKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykge1xuICAgICAgICB2YXIgbSA9IE1hdGgubWF4KDEsIG4pO1xuICAgICAgICByZXR1cm4gbSA+PSBhcy5sZW5ndGggPyBbY29weShhcyksIFtdXSA6IFtwaXBlKGFzLnNsaWNlKDEsIG0pLCBwcmVwZW5kKGhlYWQoYXMpKSksIGFzLnNsaWNlKG0pXTtcbiAgICB9O1xufTtcbi8qKlxuICogQHNpbmNlIDIuMTAuMFxuICovXG5leHBvcnQgdmFyIGNodW5rc09mID0gZnVuY3Rpb24gKG4pIHsgcmV0dXJuIGNob3Aoc3BsaXRBdChuKSk7IH07XG4vKiBpc3RhbmJ1bCBpZ25vcmUgbmV4dCAqL1xudmFyIF9tYXAgPSBmdW5jdGlvbiAoZmEsIGYpIHsgcmV0dXJuIHBpcGUoZmEsIG1hcChmKSk7IH07XG4vKiBpc3RhbmJ1bCBpZ25vcmUgbmV4dCAqL1xudmFyIF9tYXBXaXRoSW5kZXggPSBmdW5jdGlvbiAoZmEsIGYpIHsgcmV0dXJuIHBpcGUoZmEsIG1hcFdpdGhJbmRleChmKSk7IH07XG4vKiBpc3RhbmJ1bCBpZ25vcmUgbmV4dCAqL1xudmFyIF9hcCA9IGZ1bmN0aW9uIChmYWIsIGZhKSB7IHJldHVybiBwaXBlKGZhYiwgYXAoZmEpKTsgfTtcbi8qIGlzdGFuYnVsIGlnbm9yZSBuZXh0ICovXG52YXIgX2V4dGVuZCA9IGZ1bmN0aW9uICh3YSwgZikgeyByZXR1cm4gcGlwZSh3YSwgZXh0ZW5kKGYpKTsgfTtcbi8qIGlzdGFuYnVsIGlnbm9yZSBuZXh0ICovXG52YXIgX3JlZHVjZSA9IGZ1bmN0aW9uIChmYSwgYiwgZikgeyByZXR1cm4gcGlwZShmYSwgcmVkdWNlKGIsIGYpKTsgfTtcbi8qIGlzdGFuYnVsIGlnbm9yZSBuZXh0ICovXG52YXIgX2ZvbGRNYXAgPSBmdW5jdGlvbiAoTSkge1xuICAgIHZhciBmb2xkTWFwTSA9IGZvbGRNYXAoTSk7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChmYSwgZikgeyByZXR1cm4gcGlwZShmYSwgZm9sZE1hcE0oZikpOyB9O1xufTtcbi8qIGlzdGFuYnVsIGlnbm9yZSBuZXh0ICovXG52YXIgX3JlZHVjZVJpZ2h0ID0gZnVuY3Rpb24gKGZhLCBiLCBmKSB7IHJldHVybiBwaXBlKGZhLCByZWR1Y2VSaWdodChiLCBmKSk7IH07XG4vKiBpc3RhbmJ1bCBpZ25vcmUgbmV4dCAqL1xudmFyIF90cmF2ZXJzZSA9IGZ1bmN0aW9uIChGKSB7XG4gICAgdmFyIHRyYXZlcnNlRiA9IHRyYXZlcnNlKEYpO1xuICAgIHJldHVybiBmdW5jdGlvbiAodGEsIGYpIHsgcmV0dXJuIHBpcGUodGEsIHRyYXZlcnNlRihmKSk7IH07XG59O1xuLyogaXN0YW5idWwgaWdub3JlIG5leHQgKi9cbnZhciBfYWx0ID0gZnVuY3Rpb24gKGZhLCB0aGF0KSB7IHJldHVybiBwaXBlKGZhLCBhbHQodGhhdCkpOyB9O1xuLyogaXN0YW5idWwgaWdub3JlIG5leHQgKi9cbnZhciBfcmVkdWNlV2l0aEluZGV4ID0gZnVuY3Rpb24gKGZhLCBiLCBmKSB7XG4gICAgcmV0dXJuIHBpcGUoZmEsIHJlZHVjZVdpdGhJbmRleChiLCBmKSk7XG59O1xuLyogaXN0YW5idWwgaWdub3JlIG5leHQgKi9cbnZhciBfZm9sZE1hcFdpdGhJbmRleCA9IGZ1bmN0aW9uIChNKSB7XG4gICAgdmFyIGZvbGRNYXBXaXRoSW5kZXhNID0gZm9sZE1hcFdpdGhJbmRleChNKTtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGZhLCBmKSB7IHJldHVybiBwaXBlKGZhLCBmb2xkTWFwV2l0aEluZGV4TShmKSk7IH07XG59O1xuLyogaXN0YW5idWwgaWdub3JlIG5leHQgKi9cbnZhciBfcmVkdWNlUmlnaHRXaXRoSW5kZXggPSBmdW5jdGlvbiAoZmEsIGIsIGYpIHtcbiAgICByZXR1cm4gcGlwZShmYSwgcmVkdWNlUmlnaHRXaXRoSW5kZXgoYiwgZikpO1xufTtcbi8qIGlzdGFuYnVsIGlnbm9yZSBuZXh0ICovXG52YXIgX3RyYXZlcnNlV2l0aEluZGV4ID0gZnVuY3Rpb24gKEYpIHtcbiAgICB2YXIgdHJhdmVyc2VXaXRoSW5kZXhGID0gdHJhdmVyc2VXaXRoSW5kZXgoRik7XG4gICAgcmV0dXJuIGZ1bmN0aW9uICh0YSwgZikgeyByZXR1cm4gcGlwZSh0YSwgdHJhdmVyc2VXaXRoSW5kZXhGKGYpKTsgfTtcbn07XG4vKipcbiAqIExlc3Mgc3RyaWN0IHZlcnNpb24gb2YgW2BhbHRgXSgjYWx0KS5cbiAqXG4gKiBUaGUgYFdgIHN1ZmZpeCAoc2hvcnQgZm9yICoqVyoqaWRlbmluZykgbWVhbnMgdGhhdCB0aGUgcmV0dXJuIHR5cGVzIHdpbGwgYmUgbWVyZ2VkLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgKiBhcyBORUEgZnJvbSAnZnAtdHMvTm9uRW1wdHlBcnJheSdcbiAqIGltcG9ydCB7IHBpcGUgfSBmcm9tICdmcC10cy9mdW5jdGlvbidcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKFxuICogICBwaXBlKFxuICogICAgIFsxLCAyLCAzXSBhcyBORUEuTm9uRW1wdHlBcnJheTxudW1iZXI+LFxuICogICAgIE5FQS5hbHRXKCgpID0+IFsnYScsICdiJ10pXG4gKiAgICksXG4gKiAgIFsxLCAyLCAzLCAnYScsICdiJ11cbiAqIClcbiAqXG4gKiBAY2F0ZWdvcnkgZXJyb3IgaGFuZGxpbmdcbiAqIEBzaW5jZSAyLjkuMFxuICovXG5leHBvcnQgdmFyIGFsdFcgPSBmdW5jdGlvbiAodGhhdCkge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgcmV0dXJuIHBpcGUoYXMsIGNvbmNhdFcodGhhdCgpKSk7XG4gICAgfTtcbn07XG4vKipcbiAqIElkZW50aWZpZXMgYW4gYXNzb2NpYXRpdmUgb3BlcmF0aW9uIG9uIGEgdHlwZSBjb25zdHJ1Y3Rvci4gSXQgaXMgc2ltaWxhciB0byBgU2VtaWdyb3VwYCwgZXhjZXB0IHRoYXQgaXQgYXBwbGllcyB0b1xuICogdHlwZXMgb2Yga2luZCBgKiAtPiAqYC5cbiAqXG4gKiBJbiBjYXNlIG9mIGBOb25FbXB0eUFycmF5YCBjb25jYXRlbmF0ZXMgdGhlIGlucHV0cyBpbnRvIGEgc2luZ2xlIGFycmF5LlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgKiBhcyBORUEgZnJvbSAnZnAtdHMvTm9uRW1wdHlBcnJheSdcbiAqIGltcG9ydCB7IHBpcGUgfSBmcm9tICdmcC10cy9mdW5jdGlvbidcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKFxuICogICBwaXBlKFxuICogICAgIFsxLCAyLCAzXSxcbiAqICAgICBORUEuYWx0KCgpID0+IFs0LCA1XSlcbiAqICAgKSxcbiAqICAgWzEsIDIsIDMsIDQsIDVdXG4gKiApXG4gKlxuICogQGNhdGVnb3J5IGVycm9yIGhhbmRsaW5nXG4gKiBAc2luY2UgMi42LjJcbiAqL1xuZXhwb3J0IHZhciBhbHQgPSBhbHRXO1xuLyoqXG4gKiBBcHBseSBhIGZ1bmN0aW9uIHRvIGFuIGFyZ3VtZW50IHVuZGVyIGEgdHlwZSBjb25zdHJ1Y3Rvci5cbiAqXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciBhcCA9IGZ1bmN0aW9uIChhcykge1xuICAgIHJldHVybiBmbGF0TWFwKGZ1bmN0aW9uIChmKSB7IHJldHVybiBwaXBlKGFzLCBtYXAoZikpOyB9KTtcbn07XG4vKipcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgKiBhcyBORUEgZnJvbSAnZnAtdHMvTm9uRW1wdHlBcnJheSdcbiAqIGltcG9ydCB7IHBpcGUgfSBmcm9tICdmcC10cy9mdW5jdGlvbidcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKFxuICogICBwaXBlKFxuICogICAgIFsxLCAyLCAzXSxcbiAqICAgICBORUEuZmxhdE1hcCgobikgPT4gW2BhJHtufWAsIGBiJHtufWBdKVxuICogICApLFxuICogICBbJ2ExJywgJ2IxJywgJ2EyJywgJ2IyJywgJ2EzJywgJ2IzJ11cbiAqIClcbiAqXG4gKiBAY2F0ZWdvcnkgc2VxdWVuY2luZ1xuICogQHNpbmNlIDIuMTQuMFxuICovXG5leHBvcnQgdmFyIGZsYXRNYXAgPSAvKiNfX1BVUkVfXyovIGR1YWwoMiwgZnVuY3Rpb24gKG1hLCBmKSB7XG4gICAgcmV0dXJuIHBpcGUobWEsIGNoYWluV2l0aEluZGV4KGZ1bmN0aW9uIChpLCBhKSB7IHJldHVybiBmKGEsIGkpOyB9KSk7XG59KTtcbi8qKlxuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgZXh0ZW5kID0gZnVuY3Rpb24gKGYpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIHZhciBuZXh0ID0gdGFpbChhcyk7XG4gICAgICAgIHZhciBvdXQgPSBbZihhcyldO1xuICAgICAgICB3aGlsZSAoaXNOb25FbXB0eShuZXh0KSkge1xuICAgICAgICAgICAgb3V0LnB1c2goZihuZXh0KSk7XG4gICAgICAgICAgICBuZXh0ID0gdGFpbChuZXh0KTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gb3V0O1xuICAgIH07XG59O1xuLyoqXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBkdXBsaWNhdGUgPSAvKiNfX1BVUkVfXyovIGV4dGVuZChpZGVudGl0eSk7XG4vKipcbiAqIEBjYXRlZ29yeSBzZXF1ZW5jaW5nXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBmbGF0dGVuID0gLyojX19QVVJFX18qLyBmbGF0TWFwKGlkZW50aXR5KTtcbi8qKlxuICogYG1hcGAgY2FuIGJlIHVzZWQgdG8gdHVybiBmdW5jdGlvbnMgYChhOiBBKSA9PiBCYCBpbnRvIGZ1bmN0aW9ucyBgKGZhOiBGPEE+KSA9PiBGPEI+YCB3aG9zZSBhcmd1bWVudCBhbmQgcmV0dXJuIHR5cGVzXG4gKiB1c2UgdGhlIHR5cGUgY29uc3RydWN0b3IgYEZgIHRvIHJlcHJlc2VudCBzb21lIGNvbXB1dGF0aW9uYWwgY29udGV4dC5cbiAqXG4gKiBAY2F0ZWdvcnkgbWFwcGluZ1xuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgbWFwID0gZnVuY3Rpb24gKGYpIHsgcmV0dXJuIG1hcFdpdGhJbmRleChmdW5jdGlvbiAoXywgYSkgeyByZXR1cm4gZihhKTsgfSk7IH07XG4vKipcbiAqIEBjYXRlZ29yeSBtYXBwaW5nXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciBtYXBXaXRoSW5kZXggPSBmdW5jdGlvbiAoZikge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgdmFyIG91dCA9IFtmKDAsIGhlYWQoYXMpKV07XG4gICAgICAgIGZvciAodmFyIGkgPSAxOyBpIDwgYXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIG91dC5wdXNoKGYoaSwgYXNbaV0pKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gb3V0O1xuICAgIH07XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgZm9sZGluZ1xuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgcmVkdWNlID0gUk5FQS5yZWR1Y2U7XG4vKipcbiAqIEBjYXRlZ29yeSBmb2xkaW5nXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciByZWR1Y2VXaXRoSW5kZXggPSBSTkVBLnJlZHVjZVdpdGhJbmRleDtcbi8qKlxuICogQGNhdGVnb3J5IGZvbGRpbmdcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIHJlZHVjZVJpZ2h0ID0gUk5FQS5yZWR1Y2VSaWdodDtcbi8qKlxuICogQGNhdGVnb3J5IGZvbGRpbmdcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIHJlZHVjZVJpZ2h0V2l0aEluZGV4ID0gUk5FQS5yZWR1Y2VSaWdodFdpdGhJbmRleDtcbi8qKlxuICogQGNhdGVnb3J5IHRyYXZlcnNpbmdcbiAqIEBzaW5jZSAyLjYuM1xuICovXG5leHBvcnQgdmFyIHRyYXZlcnNlID0gZnVuY3Rpb24gKEYpIHtcbiAgICB2YXIgdHJhdmVyc2VXaXRoSW5kZXhGID0gdHJhdmVyc2VXaXRoSW5kZXgoRik7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChmKSB7IHJldHVybiB0cmF2ZXJzZVdpdGhJbmRleEYoZnVuY3Rpb24gKF8sIGEpIHsgcmV0dXJuIGYoYSk7IH0pOyB9O1xufTtcbi8qKlxuICogQGNhdGVnb3J5IHRyYXZlcnNpbmdcbiAqIEBzaW5jZSAyLjYuM1xuICovXG5leHBvcnQgdmFyIHNlcXVlbmNlID0gZnVuY3Rpb24gKEYpIHsgcmV0dXJuIHRyYXZlcnNlV2l0aEluZGV4KEYpKGZ1bmN0aW9uIChfLCBhKSB7IHJldHVybiBhOyB9KTsgfTtcbi8qKlxuICogQGNhdGVnb3J5IHNlcXVlbmNpbmdcbiAqIEBzaW5jZSAyLjYuM1xuICovXG5leHBvcnQgdmFyIHRyYXZlcnNlV2l0aEluZGV4ID0gZnVuY3Rpb24gKEYpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGYpIHtcbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIChhcykge1xuICAgICAgICAgICAgdmFyIG91dCA9IEYubWFwKGYoMCwgaGVhZChhcykpLCBvZik7XG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMTsgaSA8IGFzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgb3V0ID0gRi5hcChGLm1hcChvdXQsIGZ1bmN0aW9uIChicykgeyByZXR1cm4gZnVuY3Rpb24gKGIpIHsgcmV0dXJuIHBpcGUoYnMsIGFwcGVuZChiKSk7IH07IH0pLCBmKGksIGFzW2ldKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gb3V0O1xuICAgICAgICB9O1xuICAgIH07XG59O1xuLyoqXG4gKiBAc2luY2UgMi43LjBcbiAqL1xuZXhwb3J0IHZhciBleHRyYWN0ID0gUk5FQS5oZWFkO1xuLyoqXG4gKiBAY2F0ZWdvcnkgdHlwZSBsYW1iZGFzXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciBVUkkgPSAnTm9uRW1wdHlBcnJheSc7XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIGdldFNob3cgPSBSTkVBLmdldFNob3c7XG4vKipcbiAqIEJ1aWxkcyBhIGBTZW1pZ3JvdXBgIGluc3RhbmNlIGZvciBgTm9uRW1wdHlBcnJheWBcbiAqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciBnZXRTZW1pZ3JvdXAgPSBmdW5jdGlvbiAoKSB7IHJldHVybiAoe1xuICAgIGNvbmNhdDogY29uY2F0XG59KTsgfTtcbi8qKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IGdldEVxIH0gZnJvbSAnZnAtdHMvTm9uRW1wdHlBcnJheSdcbiAqIGltcG9ydCAqIGFzIE4gZnJvbSAnZnAtdHMvbnVtYmVyJ1xuICpcbiAqIGNvbnN0IEUgPSBnZXRFcShOLkVxKVxuICogYXNzZXJ0LnN0cmljdEVxdWFsKEUuZXF1YWxzKFsxLCAyXSwgWzEsIDJdKSwgdHJ1ZSlcbiAqIGFzc2VydC5zdHJpY3RFcXVhbChFLmVxdWFscyhbMSwgMl0sIFsxLCAzXSksIGZhbHNlKVxuICpcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIGdldEVxID0gUk5FQS5nZXRFcTtcbi8qKlxuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIGdldFVuaW9uU2VtaWdyb3VwID0gZnVuY3Rpb24gKEUpIHtcbiAgICB2YXIgdW5pb25FID0gdW5pb24oRSk7XG4gICAgcmV0dXJuIHtcbiAgICAgICAgY29uY2F0OiBmdW5jdGlvbiAoZmlyc3QsIHNlY29uZCkgeyByZXR1cm4gdW5pb25FKHNlY29uZCkoZmlyc3QpOyB9XG4gICAgfTtcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjcuMFxuICovXG5leHBvcnQgdmFyIEZ1bmN0b3IgPSB7XG4gICAgVVJJOiBVUkksXG4gICAgbWFwOiBfbWFwXG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgbWFwcGluZ1xuICogQHNpbmNlIDIuMTAuMFxuICovXG5leHBvcnQgdmFyIGZsYXAgPSAvKiNfX1BVUkVfXyovIGZsYXBfKEZ1bmN0b3IpO1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi4xMC4wXG4gKi9cbmV4cG9ydCB2YXIgUG9pbnRlZCA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICBvZjogb2Zcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjcuMFxuICovXG5leHBvcnQgdmFyIEZ1bmN0b3JXaXRoSW5kZXggPSB7XG4gICAgVVJJOiBVUkksXG4gICAgbWFwOiBfbWFwLFxuICAgIG1hcFdpdGhJbmRleDogX21hcFdpdGhJbmRleFxufTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuMTAuMFxuICovXG5leHBvcnQgdmFyIEFwcGx5ID0ge1xuICAgIFVSSTogVVJJLFxuICAgIG1hcDogX21hcCxcbiAgICBhcDogX2FwXG59O1xuLyoqXG4gKiBDb21iaW5lIHR3byBlZmZlY3RmdWwgYWN0aW9ucywga2VlcGluZyBvbmx5IHRoZSByZXN1bHQgb2YgdGhlIGZpcnN0LlxuICpcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIGFwRmlyc3QgPSAvKiNfX1BVUkVfXyovIGFwRmlyc3RfKEFwcGx5KTtcbi8qKlxuICogQ29tYmluZSB0d28gZWZmZWN0ZnVsIGFjdGlvbnMsIGtlZXBpbmcgb25seSB0aGUgcmVzdWx0IG9mIHRoZSBzZWNvbmQuXG4gKlxuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgYXBTZWNvbmQgPSAvKiNfX1BVUkVfXyovIGFwU2Vjb25kXyhBcHBseSk7XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjcuMFxuICovXG5leHBvcnQgdmFyIEFwcGxpY2F0aXZlID0ge1xuICAgIFVSSTogVVJJLFxuICAgIG1hcDogX21hcCxcbiAgICBhcDogX2FwLFxuICAgIG9mOiBvZlxufTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuMTAuMFxuICovXG5leHBvcnQgdmFyIENoYWluID0ge1xuICAgIFVSSTogVVJJLFxuICAgIG1hcDogX21hcCxcbiAgICBhcDogX2FwLFxuICAgIGNoYWluOiBmbGF0TWFwXG59O1xuLyoqXG4gKiBDb21wb3NlcyBjb21wdXRhdGlvbnMgaW4gc2VxdWVuY2UsIHVzaW5nIHRoZSByZXR1cm4gdmFsdWUgb2Ygb25lIGNvbXB1dGF0aW9uIHRvIGRldGVybWluZSB0aGUgbmV4dCBjb21wdXRhdGlvbiBhbmRcbiAqIGtlZXBpbmcgb25seSB0aGUgcmVzdWx0IG9mIHRoZSBmaXJzdC5cbiAqXG4gKiBAY2F0ZWdvcnkgc2VxdWVuY2luZ1xuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgY2hhaW5GaXJzdCA9IFxuLyojX19QVVJFX18qLyBjaGFpbkZpcnN0XyhDaGFpbik7XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjcuMFxuICovXG5leHBvcnQgdmFyIE1vbmFkID0ge1xuICAgIFVSSTogVVJJLFxuICAgIG1hcDogX21hcCxcbiAgICBhcDogX2FwLFxuICAgIG9mOiBvZixcbiAgICBjaGFpbjogZmxhdE1hcFxufTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuNy4wXG4gKi9cbmV4cG9ydCB2YXIgRm9sZGFibGUgPSB7XG4gICAgVVJJOiBVUkksXG4gICAgcmVkdWNlOiBfcmVkdWNlLFxuICAgIGZvbGRNYXA6IF9mb2xkTWFwLFxuICAgIHJlZHVjZVJpZ2h0OiBfcmVkdWNlUmlnaHRcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjcuMFxuICovXG5leHBvcnQgdmFyIEZvbGRhYmxlV2l0aEluZGV4ID0ge1xuICAgIFVSSTogVVJJLFxuICAgIHJlZHVjZTogX3JlZHVjZSxcbiAgICBmb2xkTWFwOiBfZm9sZE1hcCxcbiAgICByZWR1Y2VSaWdodDogX3JlZHVjZVJpZ2h0LFxuICAgIHJlZHVjZVdpdGhJbmRleDogX3JlZHVjZVdpdGhJbmRleCxcbiAgICBmb2xkTWFwV2l0aEluZGV4OiBfZm9sZE1hcFdpdGhJbmRleCxcbiAgICByZWR1Y2VSaWdodFdpdGhJbmRleDogX3JlZHVjZVJpZ2h0V2l0aEluZGV4XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi43LjBcbiAqL1xuZXhwb3J0IHZhciBUcmF2ZXJzYWJsZSA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICBtYXA6IF9tYXAsXG4gICAgcmVkdWNlOiBfcmVkdWNlLFxuICAgIGZvbGRNYXA6IF9mb2xkTWFwLFxuICAgIHJlZHVjZVJpZ2h0OiBfcmVkdWNlUmlnaHQsXG4gICAgdHJhdmVyc2U6IF90cmF2ZXJzZSxcbiAgICBzZXF1ZW5jZTogc2VxdWVuY2Vcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjcuMFxuICovXG5leHBvcnQgdmFyIFRyYXZlcnNhYmxlV2l0aEluZGV4ID0ge1xuICAgIFVSSTogVVJJLFxuICAgIG1hcDogX21hcCxcbiAgICBtYXBXaXRoSW5kZXg6IF9tYXBXaXRoSW5kZXgsXG4gICAgcmVkdWNlOiBfcmVkdWNlLFxuICAgIGZvbGRNYXA6IF9mb2xkTWFwLFxuICAgIHJlZHVjZVJpZ2h0OiBfcmVkdWNlUmlnaHQsXG4gICAgdHJhdmVyc2U6IF90cmF2ZXJzZSxcbiAgICBzZXF1ZW5jZTogc2VxdWVuY2UsXG4gICAgcmVkdWNlV2l0aEluZGV4OiBfcmVkdWNlV2l0aEluZGV4LFxuICAgIGZvbGRNYXBXaXRoSW5kZXg6IF9mb2xkTWFwV2l0aEluZGV4LFxuICAgIHJlZHVjZVJpZ2h0V2l0aEluZGV4OiBfcmVkdWNlUmlnaHRXaXRoSW5kZXgsXG4gICAgdHJhdmVyc2VXaXRoSW5kZXg6IF90cmF2ZXJzZVdpdGhJbmRleFxufTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuNy4wXG4gKi9cbmV4cG9ydCB2YXIgQWx0ID0ge1xuICAgIFVSSTogVVJJLFxuICAgIG1hcDogX21hcCxcbiAgICBhbHQ6IF9hbHRcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjcuMFxuICovXG5leHBvcnQgdmFyIENvbW9uYWQgPSB7XG4gICAgVVJJOiBVUkksXG4gICAgbWFwOiBfbWFwLFxuICAgIGV4dGVuZDogX2V4dGVuZCxcbiAgICBleHRyYWN0OiBleHRyYWN0XG59O1xuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLy8gZG8gbm90YXRpb25cbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8qKlxuICogQGNhdGVnb3J5IGRvIG5vdGF0aW9uXG4gKiBAc2luY2UgMi45LjBcbiAqL1xuZXhwb3J0IHZhciBEbyA9IC8qI19fUFVSRV9fKi8gb2YoXy5lbXB0eVJlY29yZCk7XG4vKipcbiAqIEBjYXRlZ29yeSBkbyBub3RhdGlvblxuICogQHNpbmNlIDIuOC4wXG4gKi9cbmV4cG9ydCB2YXIgYmluZFRvID0gLyojX19QVVJFX18qLyBiaW5kVG9fKEZ1bmN0b3IpO1xudmFyIGxldF8gPSAvKiNfX1BVUkVfXyovIGxldF9fKEZ1bmN0b3IpO1xuZXhwb3J0IHsgXG4vKipcbiAqIEBjYXRlZ29yeSBkbyBub3RhdGlvblxuICogQHNpbmNlIDIuMTMuMFxuICovXG5sZXRfIGFzIGxldCB9O1xuLyoqXG4gKiBAY2F0ZWdvcnkgZG8gbm90YXRpb25cbiAqIEBzaW5jZSAyLjguMFxuICovXG5leHBvcnQgdmFyIGJpbmQgPSAvKiNfX1BVUkVfXyovIGJpbmRfKENoYWluKTtcbi8qKlxuICogQGNhdGVnb3J5IGRvIG5vdGF0aW9uXG4gKiBAc2luY2UgMi44LjBcbiAqL1xuZXhwb3J0IHZhciBhcFMgPSAvKiNfX1BVUkVfXyovIGFwU18oQXBwbHkpO1xuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLy8gdXRpbHNcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8qKlxuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgaGVhZCA9IFJORUEuaGVhZDtcbi8qKlxuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgdGFpbCA9IGZ1bmN0aW9uIChhcykgeyByZXR1cm4gYXMuc2xpY2UoMSk7IH07XG4vKipcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIGxhc3QgPSBSTkVBLmxhc3Q7XG4vKipcbiAqIEdldCBhbGwgYnV0IHRoZSBsYXN0IGVsZW1lbnQgb2YgYSBub24gZW1wdHkgYXJyYXksIGNyZWF0aW5nIGEgbmV3IGFycmF5LlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBpbml0IH0gZnJvbSAnZnAtdHMvTm9uRW1wdHlBcnJheSdcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKGluaXQoWzEsIDIsIDNdKSwgWzEsIDJdKVxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChpbml0KFsxXSksIFtdKVxuICpcbiAqIEBzaW5jZSAyLjIuMFxuICovXG5leHBvcnQgdmFyIGluaXQgPSBmdW5jdGlvbiAoYXMpIHsgcmV0dXJuIGFzLnNsaWNlKDAsIC0xKTsgfTtcbi8qKlxuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgbWluID0gUk5FQS5taW47XG4vKipcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIG1heCA9IFJORUEubWF4O1xuLyoqXG4gKiBAc2luY2UgMi4xMC4wXG4gKi9cbmV4cG9ydCB2YXIgY29uY2F0QWxsID0gZnVuY3Rpb24gKFMpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIHJldHVybiBhcy5yZWR1Y2UoUy5jb25jYXQpO1xuICAgIH07XG59O1xuLyoqXG4gKiBCcmVhayBhbiBgQXJyYXlgIGludG8gaXRzIGZpcnN0IGVsZW1lbnQgYW5kIHJlbWFpbmluZyBlbGVtZW50cy5cbiAqXG4gKiBAY2F0ZWdvcnkgcGF0dGVybiBtYXRjaGluZ1xuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIG1hdGNoTGVmdCA9IGZ1bmN0aW9uIChmKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykge1xuICAgICAgICByZXR1cm4gZihoZWFkKGFzKSwgdGFpbChhcykpO1xuICAgIH07XG59O1xuLyoqXG4gKiBCcmVhayBhbiBgQXJyYXlgIGludG8gaXRzIGluaXRpYWwgZWxlbWVudHMgYW5kIHRoZSBsYXN0IGVsZW1lbnQuXG4gKlxuICogQGNhdGVnb3J5IHBhdHRlcm4gbWF0Y2hpbmdcbiAqIEBzaW5jZSAyLjExLjBcbiAqL1xuZXhwb3J0IHZhciBtYXRjaFJpZ2h0ID0gZnVuY3Rpb24gKGYpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIHJldHVybiBmKGluaXQoYXMpLCBsYXN0KGFzKSk7XG4gICAgfTtcbn07XG4vKipcbiAqIEFwcGx5IGEgZnVuY3Rpb24gdG8gdGhlIGhlYWQsIGNyZWF0aW5nIGEgbmV3IGBOb25FbXB0eUFycmF5YC5cbiAqXG4gKiBAc2luY2UgMi4xMS4wXG4gKi9cbmV4cG9ydCB2YXIgbW9kaWZ5SGVhZCA9IGZ1bmN0aW9uIChmKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykge1xuICAgICAgICByZXR1cm4gX19zcHJlYWRBcnJheShbZihoZWFkKGFzKSldLCB0YWlsKGFzKSwgdHJ1ZSk7XG4gICAgfTtcbn07XG4vKipcbiAqIENoYW5nZSB0aGUgaGVhZCwgY3JlYXRpbmcgYSBuZXcgYE5vbkVtcHR5QXJyYXlgLlxuICpcbiAqIEBzaW5jZSAyLjExLjBcbiAqL1xuZXhwb3J0IHZhciB1cGRhdGVIZWFkID0gZnVuY3Rpb24gKGEpIHsgcmV0dXJuIG1vZGlmeUhlYWQoZnVuY3Rpb24gKCkgeyByZXR1cm4gYTsgfSk7IH07XG4vKipcbiAqIEFwcGx5IGEgZnVuY3Rpb24gdG8gdGhlIGxhc3QgZWxlbWVudCwgY3JlYXRpbmcgYSBuZXcgYE5vbkVtcHR5QXJyYXlgLlxuICpcbiAqIEBzaW5jZSAyLjExLjBcbiAqL1xuZXhwb3J0IHZhciBtb2RpZnlMYXN0ID0gZnVuY3Rpb24gKGYpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIHJldHVybiBwaXBlKGluaXQoYXMpLCBhcHBlbmQoZihsYXN0KGFzKSkpKTtcbiAgICB9O1xufTtcbi8qKlxuICogQ2hhbmdlIHRoZSBsYXN0IGVsZW1lbnQsIGNyZWF0aW5nIGEgbmV3IGBOb25FbXB0eUFycmF5YC5cbiAqXG4gKiBAc2luY2UgMi4xMS4wXG4gKi9cbmV4cG9ydCB2YXIgdXBkYXRlTGFzdCA9IGZ1bmN0aW9uIChhKSB7IHJldHVybiBtb2RpZnlMYXN0KGZ1bmN0aW9uICgpIHsgcmV0dXJuIGE7IH0pOyB9O1xuLyoqXG4gKiBQbGFjZXMgYW4gZWxlbWVudCBpbiBiZXR3ZWVuIG1lbWJlcnMgb2YgYSBgTm9uRW1wdHlBcnJheWAsIHRoZW4gZm9sZHMgdGhlIHJlc3VsdHMgdXNpbmcgdGhlIHByb3ZpZGVkIGBTZW1pZ3JvdXBgLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgKiBhcyBTIGZyb20gJ2ZwLXRzL3N0cmluZydcbiAqIGltcG9ydCB7IGludGVyY2FsYXRlIH0gZnJvbSAnZnAtdHMvTm9uRW1wdHlBcnJheSdcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKGludGVyY2FsYXRlKFMuU2VtaWdyb3VwKSgnLScpKFsnYScsICdiJywgJ2MnXSksICdhLWItYycpXG4gKlxuICogQHNpbmNlIDIuMTIuMFxuICovXG5leHBvcnQgdmFyIGludGVyY2FsYXRlID0gUk5FQS5pbnRlcmNhbGF0ZTtcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8vIGxlZ2FjeVxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLyoqXG4gKiBBbGlhcyBvZiBgZmxhdE1hcGAuXG4gKlxuICogQGNhdGVnb3J5IGxlZ2FjeVxuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgY2hhaW4gPSBmbGF0TWFwO1xuZXhwb3J0IGZ1bmN0aW9uIGdyb3VwU29ydChPKSB7XG4gICAgdmFyIHNvcnRPID0gc29ydChPKTtcbiAgICB2YXIgZ3JvdXBPID0gZ3JvdXAoTyk7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykgeyByZXR1cm4gKGlzTm9uRW1wdHkoYXMpID8gZ3JvdXBPKHNvcnRPKGFzKSkgOiBbXSk7IH07XG59XG5leHBvcnQgZnVuY3Rpb24gZmlsdGVyKHByZWRpY2F0ZSkge1xuICAgIHJldHVybiBmaWx0ZXJXaXRoSW5kZXgoZnVuY3Rpb24gKF8sIGEpIHsgcmV0dXJuIHByZWRpY2F0ZShhKTsgfSk7XG59XG4vKipcbiAqIFVzZSBbYGZpbHRlcldpdGhJbmRleGBdKC4vQXJyYXkudHMuaHRtbCNmaWx0ZXJ3aXRoaW5kZXgpIGluc3RlYWQuXG4gKlxuICogQGNhdGVnb3J5IHpvbmUgb2YgZGVhdGhcbiAqIEBzaW5jZSAyLjAuMFxuICogQGRlcHJlY2F0ZWRcbiAqL1xuZXhwb3J0IHZhciBmaWx0ZXJXaXRoSW5kZXggPSBmdW5jdGlvbiAocHJlZGljYXRlKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykge1xuICAgICAgICByZXR1cm4gZnJvbUFycmF5KGFzLmZpbHRlcihmdW5jdGlvbiAoYSwgaSkgeyByZXR1cm4gcHJlZGljYXRlKGksIGEpOyB9KSk7XG4gICAgfTtcbn07XG4vKipcbiAqIFVzZSBbYHVucHJlcGVuZGBdKCN1bnByZXBlbmQpIGluc3RlYWQuXG4gKlxuICogQGNhdGVnb3J5IHpvbmUgb2YgZGVhdGhcbiAqIEBzaW5jZSAyLjkuMFxuICogQGRlcHJlY2F0ZWRcbiAqL1xuZXhwb3J0IHZhciB1bmNvbnMgPSB1bnByZXBlbmQ7XG4vKipcbiAqIFVzZSBbYHVuYXBwZW5kYF0oI3VuYXBwZW5kKSBpbnN0ZWFkLlxuICpcbiAqIEBjYXRlZ29yeSB6b25lIG9mIGRlYXRoXG4gKiBAc2luY2UgMi45LjBcbiAqIEBkZXByZWNhdGVkXG4gKi9cbmV4cG9ydCB2YXIgdW5zbm9jID0gdW5hcHBlbmQ7XG5leHBvcnQgZnVuY3Rpb24gY29ucyhoZWFkLCB0YWlsKSB7XG4gICAgcmV0dXJuIHRhaWwgPT09IHVuZGVmaW5lZCA/IHByZXBlbmQoaGVhZCkgOiBwaXBlKHRhaWwsIHByZXBlbmQoaGVhZCkpO1xufVxuLyoqXG4gKiBVc2UgW2BhcHBlbmRgXSguL0FycmF5LnRzLmh0bWwjYXBwZW5kKSBpbnN0ZWFkLlxuICpcbiAqIEBjYXRlZ29yeSB6b25lIG9mIGRlYXRoXG4gKiBAc2luY2UgMi4wLjBcbiAqIEBkZXByZWNhdGVkXG4gKi9cbmV4cG9ydCB2YXIgc25vYyA9IGZ1bmN0aW9uIChpbml0LCBlbmQpIHsgcmV0dXJuIHBpcGUoaW5pdCwgYXBwZW5kKGVuZCkpOyB9O1xuLyoqXG4gKiBVc2UgW2BwcmVwZW5kQWxsYF0oI3ByZXBlbmRhbGwpIGluc3RlYWQuXG4gKlxuICogQGNhdGVnb3J5IHpvbmUgb2YgZGVhdGhcbiAqIEBzaW5jZSAyLjkuMFxuICogQGRlcHJlY2F0ZWRcbiAqL1xuZXhwb3J0IHZhciBwcmVwZW5kVG9BbGwgPSBwcmVwZW5kQWxsO1xuLyoqXG4gKiBVc2UgW2Bjb25jYXRBbGxgXSgjY29uY2F0YWxsKSBpbnN0ZWFkLlxuICpcbiAqIEBjYXRlZ29yeSB6b25lIG9mIGRlYXRoXG4gKiBAc2luY2UgMi41LjBcbiAqIEBkZXByZWNhdGVkXG4gKi9cbmV4cG9ydCB2YXIgZm9sZCA9IFJORUEuY29uY2F0QWxsO1xuLyoqXG4gKiBUaGlzIGluc3RhbmNlIGlzIGRlcHJlY2F0ZWQsIHVzZSBzbWFsbCwgc3BlY2lmaWMgaW5zdGFuY2VzIGluc3RlYWQuXG4gKiBGb3IgZXhhbXBsZSBpZiBhIGZ1bmN0aW9uIG5lZWRzIGEgYEZ1bmN0b3JgIGluc3RhbmNlLCBwYXNzIGBORUEuRnVuY3RvcmAgaW5zdGVhZCBvZiBgTkVBLm5vbkVtcHR5QXJyYXlgXG4gKiAod2hlcmUgYE5FQWAgaXMgZnJvbSBgaW1wb3J0IE5FQSBmcm9tICdmcC10cy9Ob25FbXB0eUFycmF5J2ApXG4gKlxuICogQGNhdGVnb3J5IHpvbmUgb2YgZGVhdGhcbiAqIEBzaW5jZSAyLjAuMFxuICogQGRlcHJlY2F0ZWRcbiAqL1xuZXhwb3J0IHZhciBub25FbXB0eUFycmF5ID0ge1xuICAgIFVSSTogVVJJLFxuICAgIG9mOiBvZixcbiAgICBtYXA6IF9tYXAsXG4gICAgbWFwV2l0aEluZGV4OiBfbWFwV2l0aEluZGV4LFxuICAgIGFwOiBfYXAsXG4gICAgY2hhaW46IGZsYXRNYXAsXG4gICAgZXh0ZW5kOiBfZXh0ZW5kLFxuICAgIGV4dHJhY3Q6IGV4dHJhY3QsXG4gICAgcmVkdWNlOiBfcmVkdWNlLFxuICAgIGZvbGRNYXA6IF9mb2xkTWFwLFxuICAgIHJlZHVjZVJpZ2h0OiBfcmVkdWNlUmlnaHQsXG4gICAgdHJhdmVyc2U6IF90cmF2ZXJzZSxcbiAgICBzZXF1ZW5jZTogc2VxdWVuY2UsXG4gICAgcmVkdWNlV2l0aEluZGV4OiBfcmVkdWNlV2l0aEluZGV4LFxuICAgIGZvbGRNYXBXaXRoSW5kZXg6IF9mb2xkTWFwV2l0aEluZGV4LFxuICAgIHJlZHVjZVJpZ2h0V2l0aEluZGV4OiBfcmVkdWNlUmlnaHRXaXRoSW5kZXgsXG4gICAgdHJhdmVyc2VXaXRoSW5kZXg6IF90cmF2ZXJzZVdpdGhJbmRleCxcbiAgICBhbHQ6IF9hbHRcbn07XG4iLAogICJ2YXIgX19zcHJlYWRBcnJheSA9ICh0aGlzICYmIHRoaXMuX19zcHJlYWRBcnJheSkgfHwgZnVuY3Rpb24gKHRvLCBmcm9tLCBwYWNrKSB7XG4gICAgaWYgKHBhY2sgfHwgYXJndW1lbnRzLmxlbmd0aCA9PT0gMikgZm9yICh2YXIgaSA9IDAsIGwgPSBmcm9tLmxlbmd0aCwgYXI7IGkgPCBsOyBpKyspIHtcbiAgICAgICAgaWYgKGFyIHx8ICEoaSBpbiBmcm9tKSkge1xuICAgICAgICAgICAgaWYgKCFhcikgYXIgPSBBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChmcm9tLCAwLCBpKTtcbiAgICAgICAgICAgIGFyW2ldID0gZnJvbVtpXTtcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gdG8uY29uY2F0KGFyIHx8IEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGZyb20pKTtcbn07XG5pbXBvcnQgeyBhcEZpcnN0IGFzIGFwRmlyc3RfLCBhcFMgYXMgYXBTXywgYXBTZWNvbmQgYXMgYXBTZWNvbmRfIH0gZnJvbSAnLi9BcHBseSc7XG5pbXBvcnQgeyBiaW5kIGFzIGJpbmRfLCBjaGFpbkZpcnN0IGFzIGNoYWluRmlyc3RfIH0gZnJvbSAnLi9DaGFpbic7XG5pbXBvcnQgeyBkdWFsLCBpZGVudGl0eSwgcGlwZSB9IGZyb20gJy4vZnVuY3Rpb24nO1xuaW1wb3J0IHsgYmluZFRvIGFzIGJpbmRUb18sIGZsYXAgYXMgZmxhcF8sIGxldCBhcyBsZXRfXyB9IGZyb20gJy4vRnVuY3Rvcic7XG5pbXBvcnQgKiBhcyBfIGZyb20gJy4vaW50ZXJuYWwnO1xuaW1wb3J0IHsgZ2V0TW9ub2lkIH0gZnJvbSAnLi9PcmQnO1xuaW1wb3J0ICogYXMgUk5FQSBmcm9tICcuL1JlYWRvbmx5Tm9uRW1wdHlBcnJheSc7XG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vLyBpbnRlcm5hbFxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLyoqXG4gKiBAaW50ZXJuYWxcbiAqL1xuZXhwb3J0IHZhciBpc05vbkVtcHR5ID0gZnVuY3Rpb24gKGFzKSB7IHJldHVybiBhcy5sZW5ndGggPiAwOyB9O1xuLyoqXG4gKiBAaW50ZXJuYWxcbiAqL1xuZXhwb3J0IHZhciBpc091dE9mQm91bmQgPSBmdW5jdGlvbiAoaSwgYXMpIHsgcmV0dXJuIGkgPCAwIHx8IGkgPj0gYXMubGVuZ3RoOyB9O1xuLyoqXG4gKiBAaW50ZXJuYWxcbiAqL1xuZXhwb3J0IHZhciBwcmVwZW5kVyA9IGZ1bmN0aW9uIChoZWFkKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uICh0YWlsKSB7XG4gICAgICAgIHJldHVybiBfX3NwcmVhZEFycmF5KFtoZWFkXSwgdGFpbCwgdHJ1ZSk7XG4gICAgfTtcbn07XG4vKipcbiAqIEBpbnRlcm5hbFxuICovXG5leHBvcnQgdmFyIHByZXBlbmQgPSBwcmVwZW5kVztcbi8qKlxuICogQGludGVybmFsXG4gKi9cbmV4cG9ydCB2YXIgYXBwZW5kVyA9IGZ1bmN0aW9uIChlbmQpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGluaXQpIHtcbiAgICAgICAgcmV0dXJuIF9fc3ByZWFkQXJyYXkoX19zcHJlYWRBcnJheShbXSwgaW5pdCwgdHJ1ZSksIFtlbmRdLCBmYWxzZSk7XG4gICAgfTtcbn07XG4vKipcbiAqIEBpbnRlcm5hbFxuICovXG5leHBvcnQgdmFyIGFwcGVuZCA9IGFwcGVuZFc7XG4vKipcbiAqIEBpbnRlcm5hbFxuICovXG5leHBvcnQgdmFyIHVuc2FmZUluc2VydEF0ID0gZnVuY3Rpb24gKGksIGEsIGFzKSB7XG4gICAgaWYgKGlzTm9uRW1wdHkoYXMpKSB7XG4gICAgICAgIHZhciB4cyA9IGZyb21SZWFkb25seU5vbkVtcHR5QXJyYXkoYXMpO1xuICAgICAgICB4cy5zcGxpY2UoaSwgMCwgYSk7XG4gICAgICAgIHJldHVybiB4cztcbiAgICB9XG4gICAgcmV0dXJuIFthXTtcbn07XG4vKipcbiAqIEBpbnRlcm5hbFxuICovXG5leHBvcnQgdmFyIHVuc2FmZVVwZGF0ZUF0ID0gZnVuY3Rpb24gKGksIGEsIGFzKSB7XG4gICAgdmFyIHhzID0gZnJvbVJlYWRvbmx5Tm9uRW1wdHlBcnJheShhcyk7XG4gICAgeHNbaV0gPSBhO1xuICAgIHJldHVybiB4cztcbn07XG4vKipcbiAqIFJlbW92ZSBkdXBsaWNhdGVzIGZyb20gYSBgTm9uRW1wdHlBcnJheWAsIGtlZXBpbmcgdGhlIGZpcnN0IG9jY3VycmVuY2Ugb2YgYW4gZWxlbWVudC5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgdW5pcSB9IGZyb20gJ2ZwLXRzL05vbkVtcHR5QXJyYXknXG4gKiBpbXBvcnQgKiBhcyBOIGZyb20gJ2ZwLXRzL251bWJlcidcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKHVuaXEoTi5FcSkoWzEsIDIsIDFdKSwgWzEsIDJdKVxuICpcbiAqIEBzaW5jZSAyLjExLjBcbiAqL1xuZXhwb3J0IHZhciB1bmlxID0gZnVuY3Rpb24gKEUpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIGlmIChhcy5sZW5ndGggPT09IDEpIHtcbiAgICAgICAgICAgIHJldHVybiBjb3B5KGFzKTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgb3V0ID0gW2hlYWQoYXMpXTtcbiAgICAgICAgdmFyIHJlc3QgPSB0YWlsKGFzKTtcbiAgICAgICAgdmFyIF9sb29wXzEgPSBmdW5jdGlvbiAoYSkge1xuICAgICAgICAgICAgaWYgKG91dC5ldmVyeShmdW5jdGlvbiAobykgeyByZXR1cm4gIUUuZXF1YWxzKG8sIGEpOyB9KSkge1xuICAgICAgICAgICAgICAgIG91dC5wdXNoKGEpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICBmb3IgKHZhciBfaSA9IDAsIHJlc3RfMSA9IHJlc3Q7IF9pIDwgcmVzdF8xLmxlbmd0aDsgX2krKykge1xuICAgICAgICAgICAgdmFyIGEgPSByZXN0XzFbX2ldO1xuICAgICAgICAgICAgX2xvb3BfMShhKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gb3V0O1xuICAgIH07XG59O1xuLyoqXG4gKiBTb3J0IHRoZSBlbGVtZW50cyBvZiBhIGBOb25FbXB0eUFycmF5YCBpbiBpbmNyZWFzaW5nIG9yZGVyLCB3aGVyZSBlbGVtZW50cyBhcmUgY29tcGFyZWQgdXNpbmcgZmlyc3QgYG9yZHNbMF1gLCB0aGVuIGBvcmRzWzFdYCxcbiAqIGV0Yy4uLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgKiBhcyBORUEgZnJvbSAnZnAtdHMvTm9uRW1wdHlBcnJheSdcbiAqIGltcG9ydCB7IGNvbnRyYW1hcCB9IGZyb20gJ2ZwLXRzL09yZCdcbiAqIGltcG9ydCAqIGFzIFMgZnJvbSAnZnAtdHMvc3RyaW5nJ1xuICogaW1wb3J0ICogYXMgTiBmcm9tICdmcC10cy9udW1iZXInXG4gKiBpbXBvcnQgeyBwaXBlIH0gZnJvbSAnZnAtdHMvZnVuY3Rpb24nXG4gKlxuICogaW50ZXJmYWNlIFBlcnNvbiB7XG4gKiAgIG5hbWU6IHN0cmluZ1xuICogICBhZ2U6IG51bWJlclxuICogfVxuICpcbiAqIGNvbnN0IGJ5TmFtZSA9IHBpcGUoUy5PcmQsIGNvbnRyYW1hcCgocDogUGVyc29uKSA9PiBwLm5hbWUpKVxuICpcbiAqIGNvbnN0IGJ5QWdlID0gcGlwZShOLk9yZCwgY29udHJhbWFwKChwOiBQZXJzb24pID0+IHAuYWdlKSlcbiAqXG4gKiBjb25zdCBzb3J0QnlOYW1lQnlBZ2UgPSBORUEuc29ydEJ5KFtieU5hbWUsIGJ5QWdlXSlcbiAqXG4gKiBjb25zdCBwZXJzb25zOiBORUEuTm9uRW1wdHlBcnJheTxQZXJzb24+ID0gW1xuICogICB7IG5hbWU6ICdhJywgYWdlOiAxIH0sXG4gKiAgIHsgbmFtZTogJ2InLCBhZ2U6IDMgfSxcbiAqICAgeyBuYW1lOiAnYycsIGFnZTogMiB9LFxuICogICB7IG5hbWU6ICdiJywgYWdlOiAyIH1cbiAqIF1cbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKHNvcnRCeU5hbWVCeUFnZShwZXJzb25zKSwgW1xuICogICB7IG5hbWU6ICdhJywgYWdlOiAxIH0sXG4gKiAgIHsgbmFtZTogJ2InLCBhZ2U6IDIgfSxcbiAqICAgeyBuYW1lOiAnYicsIGFnZTogMyB9LFxuICogICB7IG5hbWU6ICdjJywgYWdlOiAyIH1cbiAqIF0pXG4gKlxuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIHNvcnRCeSA9IGZ1bmN0aW9uIChvcmRzKSB7XG4gICAgaWYgKGlzTm9uRW1wdHkob3JkcykpIHtcbiAgICAgICAgdmFyIE0gPSBnZXRNb25vaWQoKTtcbiAgICAgICAgcmV0dXJuIHNvcnQob3Jkcy5yZWR1Y2UoTS5jb25jYXQsIE0uZW1wdHkpKTtcbiAgICB9XG4gICAgcmV0dXJuIGNvcHk7XG59O1xuLyoqXG4gKiBAc2luY2UgMi4xMS4wXG4gKi9cbmV4cG9ydCB2YXIgdW5pb24gPSBmdW5jdGlvbiAoRSkge1xuICAgIHZhciB1bmlxRSA9IHVuaXEoRSk7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChzZWNvbmQpIHsgcmV0dXJuIGZ1bmN0aW9uIChmaXJzdCkgeyByZXR1cm4gdW5pcUUocGlwZShmaXJzdCwgY29uY2F0KHNlY29uZCkpKTsgfTsgfTtcbn07XG4vKipcbiAqIFJvdGF0ZSBhIGBOb25FbXB0eUFycmF5YCBieSBgbmAgc3RlcHMuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IHJvdGF0ZSB9IGZyb20gJ2ZwLXRzL05vbkVtcHR5QXJyYXknXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChyb3RhdGUoMikoWzEsIDIsIDMsIDQsIDVdKSwgWzQsIDUsIDEsIDIsIDNdKVxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChyb3RhdGUoLTIpKFsxLCAyLCAzLCA0LCA1XSksIFszLCA0LCA1LCAxLCAyXSlcbiAqXG4gKiBAc2luY2UgMi4xMS4wXG4gKi9cbmV4cG9ydCB2YXIgcm90YXRlID0gZnVuY3Rpb24gKG4pIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIHZhciBsZW4gPSBhcy5sZW5ndGg7XG4gICAgICAgIHZhciBtID0gTWF0aC5yb3VuZChuKSAlIGxlbjtcbiAgICAgICAgaWYgKGlzT3V0T2ZCb3VuZChNYXRoLmFicyhtKSwgYXMpIHx8IG0gPT09IDApIHtcbiAgICAgICAgICAgIHJldHVybiBjb3B5KGFzKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAobSA8IDApIHtcbiAgICAgICAgICAgIHZhciBfYSA9IHNwbGl0QXQoLW0pKGFzKSwgZiA9IF9hWzBdLCBzID0gX2FbMV07XG4gICAgICAgICAgICByZXR1cm4gcGlwZShzLCBjb25jYXQoZikpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuIHJvdGF0ZShtIC0gbGVuKShhcyk7XG4gICAgICAgIH1cbiAgICB9O1xufTtcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8vIGNvbnN0cnVjdG9yc1xuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLyoqXG4gKiBAY2F0ZWdvcnkgY29udmVyc2lvbnNcbiAqIEBzaW5jZSAyLjEwLjBcbiAqL1xuZXhwb3J0IHZhciBmcm9tUmVhZG9ubHlOb25FbXB0eUFycmF5ID0gXy5mcm9tUmVhZG9ubHlOb25FbXB0eUFycmF5O1xuLyoqXG4gKiBCdWlsZHMgYSBgTm9uRW1wdHlBcnJheWAgZnJvbSBhbiBgQXJyYXlgIHJldHVybmluZyBgbm9uZWAgaWYgYGFzYCBpcyBhbiBlbXB0eSBhcnJheVxuICpcbiAqIEBjYXRlZ29yeSBjb252ZXJzaW9uc1xuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgZnJvbUFycmF5ID0gZnVuY3Rpb24gKGFzKSB7IHJldHVybiAoaXNOb25FbXB0eShhcykgPyBfLnNvbWUoYXMpIDogXy5ub25lKTsgfTtcbi8qKlxuICogUmV0dXJuIGEgYE5vbkVtcHR5QXJyYXlgIG9mIGxlbmd0aCBgbmAgd2l0aCBlbGVtZW50IGBpYCBpbml0aWFsaXplZCB3aXRoIGBmKGkpYC5cbiAqXG4gKiAqKk5vdGUqKi4gYG5gIGlzIG5vcm1hbGl6ZWQgdG8gYSBuYXR1cmFsIG51bWJlci5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgbWFrZUJ5IH0gZnJvbSAnZnAtdHMvTm9uRW1wdHlBcnJheSdcbiAqIGltcG9ydCB7IHBpcGUgfSBmcm9tICdmcC10cy9mdW5jdGlvbidcbiAqXG4gKiBjb25zdCBkb3VibGUgPSAobjogbnVtYmVyKTogbnVtYmVyID0+IG4gKiAyXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKHBpcGUoNSwgbWFrZUJ5KGRvdWJsZSkpLCBbMCwgMiwgNCwgNiwgOF0pXG4gKlxuICogQGNhdGVnb3J5IGNvbnN0cnVjdG9yc1xuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIG1ha2VCeSA9IGZ1bmN0aW9uIChmKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChuKSB7XG4gICAgICAgIHZhciBqID0gTWF0aC5tYXgoMCwgTWF0aC5mbG9vcihuKSk7XG4gICAgICAgIHZhciBvdXQgPSBbZigwKV07XG4gICAgICAgIGZvciAodmFyIGkgPSAxOyBpIDwgajsgaSsrKSB7XG4gICAgICAgICAgICBvdXQucHVzaChmKGkpKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gb3V0O1xuICAgIH07XG59O1xuLyoqXG4gKiBDcmVhdGUgYSBgTm9uRW1wdHlBcnJheWAgY29udGFpbmluZyBhIHZhbHVlIHJlcGVhdGVkIHRoZSBzcGVjaWZpZWQgbnVtYmVyIG9mIHRpbWVzLlxuICpcbiAqICoqTm90ZSoqLiBgbmAgaXMgbm9ybWFsaXplZCB0byBhIG5hdHVyYWwgbnVtYmVyLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyByZXBsaWNhdGUgfSBmcm9tICdmcC10cy9Ob25FbXB0eUFycmF5J1xuICogaW1wb3J0IHsgcGlwZSB9IGZyb20gJ2ZwLXRzL2Z1bmN0aW9uJ1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwocGlwZSgzLCByZXBsaWNhdGUoJ2EnKSksIFsnYScsICdhJywgJ2EnXSlcbiAqXG4gKiBAY2F0ZWdvcnkgY29uc3RydWN0b3JzXG4gKiBAc2luY2UgMi4xMS4wXG4gKi9cbmV4cG9ydCB2YXIgcmVwbGljYXRlID0gZnVuY3Rpb24gKGEpIHsgcmV0dXJuIG1ha2VCeShmdW5jdGlvbiAoKSB7IHJldHVybiBhOyB9KTsgfTtcbi8qKlxuICogQ3JlYXRlIGEgYE5vbkVtcHR5QXJyYXlgIGNvbnRhaW5pbmcgYSByYW5nZSBvZiBpbnRlZ2VycywgaW5jbHVkaW5nIGJvdGggZW5kcG9pbnRzLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyByYW5nZSB9IGZyb20gJ2ZwLXRzL05vbkVtcHR5QXJyYXknXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChyYW5nZSgxLCA1KSwgWzEsIDIsIDMsIDQsIDVdKVxuICpcbiAqIEBjYXRlZ29yeSBjb25zdHJ1Y3RvcnNcbiAqIEBzaW5jZSAyLjExLjBcbiAqL1xuZXhwb3J0IHZhciByYW5nZSA9IGZ1bmN0aW9uIChzdGFydCwgZW5kKSB7XG4gICAgcmV0dXJuIHN0YXJ0IDw9IGVuZCA/IG1ha2VCeShmdW5jdGlvbiAoaSkgeyByZXR1cm4gc3RhcnQgKyBpOyB9KShlbmQgLSBzdGFydCArIDEpIDogW3N0YXJ0XTtcbn07XG4vKipcbiAqIFJldHVybiB0aGUgdHVwbGUgb2YgdGhlIGBoZWFkYCBhbmQgdGhlIGB0YWlsYC5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgdW5wcmVwZW5kIH0gZnJvbSAnZnAtdHMvTm9uRW1wdHlBcnJheSdcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKHVucHJlcGVuZChbMSwgMiwgM10pLCBbMSwgWzIsIDNdXSlcbiAqXG4gKiBAc2luY2UgMi45LjBcbiAqL1xuZXhwb3J0IHZhciB1bnByZXBlbmQgPSBmdW5jdGlvbiAoYXMpIHsgcmV0dXJuIFtoZWFkKGFzKSwgdGFpbChhcyldOyB9O1xuLyoqXG4gKiBSZXR1cm4gdGhlIHR1cGxlIG9mIHRoZSBgaW5pdGAgYW5kIHRoZSBgbGFzdGAuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IHVuYXBwZW5kIH0gZnJvbSAnZnAtdHMvTm9uRW1wdHlBcnJheSdcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKHVuYXBwZW5kKFsxLCAyLCAzLCA0XSksIFtbMSwgMiwgM10sIDRdKVxuICpcbiAqIEBzaW5jZSAyLjkuMFxuICovXG5leHBvcnQgdmFyIHVuYXBwZW5kID0gZnVuY3Rpb24gKGFzKSB7IHJldHVybiBbaW5pdChhcyksIGxhc3QoYXMpXTsgfTtcbmV4cG9ydCBmdW5jdGlvbiBjb25jYXRXKHNlY29uZCkge1xuICAgIHJldHVybiBmdW5jdGlvbiAoZmlyc3QpIHsgcmV0dXJuIGZpcnN0LmNvbmNhdChzZWNvbmQpOyB9O1xufVxuZXhwb3J0IGZ1bmN0aW9uIGNvbmNhdCh4LCB5KSB7XG4gICAgcmV0dXJuIHkgPyB4LmNvbmNhdCh5KSA6IGZ1bmN0aW9uICh5KSB7IHJldHVybiB5LmNvbmNhdCh4KTsgfTtcbn1cbi8qKlxuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgcmV2ZXJzZSA9IGZ1bmN0aW9uIChhcykgeyByZXR1cm4gX19zcHJlYWRBcnJheShbbGFzdChhcyldLCBhcy5zbGljZSgwLCAtMSkucmV2ZXJzZSgpLCB0cnVlKTsgfTtcbmV4cG9ydCBmdW5jdGlvbiBncm91cChFKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykge1xuICAgICAgICB2YXIgbGVuID0gYXMubGVuZ3RoO1xuICAgICAgICBpZiAobGVuID09PSAwKSB7XG4gICAgICAgICAgICByZXR1cm4gW107XG4gICAgICAgIH1cbiAgICAgICAgdmFyIG91dCA9IFtdO1xuICAgICAgICB2YXIgaGVhZCA9IGFzWzBdO1xuICAgICAgICB2YXIgbmVhID0gW2hlYWRdO1xuICAgICAgICBmb3IgKHZhciBpID0gMTsgaSA8IGxlbjsgaSsrKSB7XG4gICAgICAgICAgICB2YXIgYSA9IGFzW2ldO1xuICAgICAgICAgICAgaWYgKEUuZXF1YWxzKGEsIGhlYWQpKSB7XG4gICAgICAgICAgICAgICAgbmVhLnB1c2goYSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBvdXQucHVzaChuZWEpO1xuICAgICAgICAgICAgICAgIGhlYWQgPSBhO1xuICAgICAgICAgICAgICAgIG5lYSA9IFtoZWFkXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBvdXQucHVzaChuZWEpO1xuICAgICAgICByZXR1cm4gb3V0O1xuICAgIH07XG59XG4vKipcbiAqIFNwbGl0cyBhbiBhcnJheSBpbnRvIHN1Yi1ub24tZW1wdHktYXJyYXlzIHN0b3JlZCBpbiBhbiBvYmplY3QsIGJhc2VkIG9uIHRoZSByZXN1bHQgb2YgY2FsbGluZyBhIGBzdHJpbmdgLXJldHVybmluZ1xuICogZnVuY3Rpb24gb24gZWFjaCBlbGVtZW50LCBhbmQgZ3JvdXBpbmcgdGhlIHJlc3VsdHMgYWNjb3JkaW5nIHRvIHZhbHVlcyByZXR1cm5lZFxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBncm91cEJ5IH0gZnJvbSAnZnAtdHMvTm9uRW1wdHlBcnJheSdcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKGdyb3VwQnkoKHM6IHN0cmluZykgPT4gU3RyaW5nKHMubGVuZ3RoKSkoWydhJywgJ2InLCAnYWInXSksIHtcbiAqICAgJzEnOiBbJ2EnLCAnYiddLFxuICogICAnMic6IFsnYWInXVxuICogfSlcbiAqXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciBncm91cEJ5ID0gZnVuY3Rpb24gKGYpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIHZhciBvdXQgPSB7fTtcbiAgICAgICAgZm9yICh2YXIgX2kgPSAwLCBhc18xID0gYXM7IF9pIDwgYXNfMS5sZW5ndGg7IF9pKyspIHtcbiAgICAgICAgICAgIHZhciBhID0gYXNfMVtfaV07XG4gICAgICAgICAgICB2YXIgayA9IGYoYSk7XG4gICAgICAgICAgICBpZiAoXy5oYXMuY2FsbChvdXQsIGspKSB7XG4gICAgICAgICAgICAgICAgb3V0W2tdLnB1c2goYSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBvdXRba10gPSBbYV07XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG91dDtcbiAgICB9O1xufTtcbi8qKlxuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgc29ydCA9IGZ1bmN0aW9uIChPKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykge1xuICAgICAgICByZXR1cm4gYXMuc2xpY2UoKS5zb3J0KE8uY29tcGFyZSk7XG4gICAgfTtcbn07XG4vKipcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIGluc2VydEF0ID0gZnVuY3Rpb24gKGksIGEpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIHJldHVybiBpIDwgMCB8fCBpID4gYXMubGVuZ3RoID8gXy5ub25lIDogXy5zb21lKHVuc2FmZUluc2VydEF0KGksIGEsIGFzKSk7XG4gICAgfTtcbn07XG4vKipcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIHVwZGF0ZUF0ID0gZnVuY3Rpb24gKGksIGEpIHtcbiAgICByZXR1cm4gbW9kaWZ5QXQoaSwgZnVuY3Rpb24gKCkgeyByZXR1cm4gYTsgfSk7XG59O1xuLyoqXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciBtb2RpZnlBdCA9IGZ1bmN0aW9uIChpLCBmKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykge1xuICAgICAgICByZXR1cm4gaXNPdXRPZkJvdW5kKGksIGFzKSA/IF8ubm9uZSA6IF8uc29tZSh1bnNhZmVVcGRhdGVBdChpLCBmKGFzW2ldKSwgYXMpKTtcbiAgICB9O1xufTtcbi8qKlxuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgY29weSA9IGZyb21SZWFkb25seU5vbkVtcHR5QXJyYXk7XG4vKipcbiAqIEBjYXRlZ29yeSBjb25zdHJ1Y3RvcnNcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIG9mID0gZnVuY3Rpb24gKGEpIHsgcmV0dXJuIFthXTsgfTtcbi8qKlxuICogQHNpbmNlIDIuNS4xXG4gKi9cbmV4cG9ydCB2YXIgemlwV2l0aCA9IGZ1bmN0aW9uIChhcywgYnMsIGYpIHtcbiAgICB2YXIgY3MgPSBbZihhc1swXSwgYnNbMF0pXTtcbiAgICB2YXIgbGVuID0gTWF0aC5taW4oYXMubGVuZ3RoLCBicy5sZW5ndGgpO1xuICAgIGZvciAodmFyIGkgPSAxOyBpIDwgbGVuOyBpKyspIHtcbiAgICAgICAgY3NbaV0gPSBmKGFzW2ldLCBic1tpXSk7XG4gICAgfVxuICAgIHJldHVybiBjcztcbn07XG5leHBvcnQgZnVuY3Rpb24gemlwKGFzLCBicykge1xuICAgIGlmIChicyA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgIHJldHVybiBmdW5jdGlvbiAoYnMpIHsgcmV0dXJuIHppcChicywgYXMpOyB9O1xuICAgIH1cbiAgICByZXR1cm4gemlwV2l0aChhcywgYnMsIGZ1bmN0aW9uIChhLCBiKSB7IHJldHVybiBbYSwgYl07IH0pO1xufVxuLyoqXG4gKiBAc2luY2UgMi41LjFcbiAqL1xuZXhwb3J0IHZhciB1bnppcCA9IGZ1bmN0aW9uIChhYnMpIHtcbiAgICB2YXIgZmEgPSBbYWJzWzBdWzBdXTtcbiAgICB2YXIgZmIgPSBbYWJzWzBdWzFdXTtcbiAgICBmb3IgKHZhciBpID0gMTsgaSA8IGFicy5sZW5ndGg7IGkrKykge1xuICAgICAgICBmYVtpXSA9IGFic1tpXVswXTtcbiAgICAgICAgZmJbaV0gPSBhYnNbaV1bMV07XG4gICAgfVxuICAgIHJldHVybiBbZmEsIGZiXTtcbn07XG4vKipcbiAqIFByZXBlbmQgYW4gZWxlbWVudCB0byBldmVyeSBtZW1iZXIgb2YgYW4gYXJyYXlcbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgcHJlcGVuZEFsbCB9IGZyb20gJ2ZwLXRzL05vbkVtcHR5QXJyYXknXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChwcmVwZW5kQWxsKDkpKFsxLCAyLCAzLCA0XSksIFs5LCAxLCA5LCAyLCA5LCAzLCA5LCA0XSlcbiAqXG4gKiBAc2luY2UgMi4xMC4wXG4gKi9cbmV4cG9ydCB2YXIgcHJlcGVuZEFsbCA9IGZ1bmN0aW9uIChtaWRkbGUpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIHZhciBvdXQgPSBbbWlkZGxlLCBhc1swXV07XG4gICAgICAgIGZvciAodmFyIGkgPSAxOyBpIDwgYXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIG91dC5wdXNoKG1pZGRsZSwgYXNbaV0pO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBvdXQ7XG4gICAgfTtcbn07XG4vKipcbiAqIFBsYWNlcyBhbiBlbGVtZW50IGluIGJldHdlZW4gbWVtYmVycyBvZiBhbiBhcnJheVxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBpbnRlcnNwZXJzZSB9IGZyb20gJ2ZwLXRzL05vbkVtcHR5QXJyYXknXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChpbnRlcnNwZXJzZSg5KShbMSwgMiwgMywgNF0pLCBbMSwgOSwgMiwgOSwgMywgOSwgNF0pXG4gKlxuICogQHNpbmNlIDIuOS4wXG4gKi9cbmV4cG9ydCB2YXIgaW50ZXJzcGVyc2UgPSBmdW5jdGlvbiAobWlkZGxlKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykge1xuICAgICAgICB2YXIgcmVzdCA9IHRhaWwoYXMpO1xuICAgICAgICByZXR1cm4gaXNOb25FbXB0eShyZXN0KSA/IHBpcGUocmVzdCwgcHJlcGVuZEFsbChtaWRkbGUpLCBwcmVwZW5kKGhlYWQoYXMpKSkgOiBjb3B5KGFzKTtcbiAgICB9O1xufTtcbi8qKlxuICogQGNhdGVnb3J5IGZvbGRpbmdcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIGZvbGRNYXBXaXRoSW5kZXggPSBSTkVBLmZvbGRNYXBXaXRoSW5kZXg7XG4vKipcbiAqIEBjYXRlZ29yeSBmb2xkaW5nXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciBmb2xkTWFwID0gUk5FQS5mb2xkTWFwO1xuLyoqXG4gKiBAY2F0ZWdvcnkgc2VxdWVuY2luZ1xuICogQHNpbmNlIDIuMTAuMFxuICovXG5leHBvcnQgdmFyIGNoYWluV2l0aEluZGV4ID0gZnVuY3Rpb24gKGYpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIHZhciBvdXQgPSBmcm9tUmVhZG9ubHlOb25FbXB0eUFycmF5KGYoMCwgaGVhZChhcykpKTtcbiAgICAgICAgZm9yICh2YXIgaSA9IDE7IGkgPCBhcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgb3V0LnB1c2guYXBwbHkob3V0LCBmKGksIGFzW2ldKSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG91dDtcbiAgICB9O1xufTtcbi8qKlxuICogQHNpbmNlIDIuMTAuMFxuICovXG5leHBvcnQgdmFyIGNob3AgPSBmdW5jdGlvbiAoZikge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgdmFyIF9hID0gZihhcyksIGIgPSBfYVswXSwgcmVzdCA9IF9hWzFdO1xuICAgICAgICB2YXIgb3V0ID0gW2JdO1xuICAgICAgICB2YXIgbmV4dCA9IHJlc3Q7XG4gICAgICAgIHdoaWxlIChpc05vbkVtcHR5KG5leHQpKSB7XG4gICAgICAgICAgICB2YXIgX2IgPSBmKG5leHQpLCBiXzEgPSBfYlswXSwgcmVzdF8yID0gX2JbMV07XG4gICAgICAgICAgICBvdXQucHVzaChiXzEpO1xuICAgICAgICAgICAgbmV4dCA9IHJlc3RfMjtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gb3V0O1xuICAgIH07XG59O1xuLyoqXG4gKiBTcGxpdHMgYSBgTm9uRW1wdHlBcnJheWAgaW50byB0d28gcGllY2VzLCB0aGUgZmlyc3QgcGllY2UgaGFzIG1heCBgbmAgZWxlbWVudHMuXG4gKlxuICogQHNpbmNlIDIuMTAuMFxuICovXG5leHBvcnQgdmFyIHNwbGl0QXQgPSBmdW5jdGlvbiAobikge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgdmFyIG0gPSBNYXRoLm1heCgxLCBuKTtcbiAgICAgICAgcmV0dXJuIG0gPj0gYXMubGVuZ3RoID8gW2NvcHkoYXMpLCBbXV0gOiBbcGlwZShhcy5zbGljZSgxLCBtKSwgcHJlcGVuZChoZWFkKGFzKSkpLCBhcy5zbGljZShtKV07XG4gICAgfTtcbn07XG4vKipcbiAqIEBzaW5jZSAyLjEwLjBcbiAqL1xuZXhwb3J0IHZhciBjaHVua3NPZiA9IGZ1bmN0aW9uIChuKSB7IHJldHVybiBjaG9wKHNwbGl0QXQobikpOyB9O1xuLyogaXN0YW5idWwgaWdub3JlIG5leHQgKi9cbnZhciBfbWFwID0gZnVuY3Rpb24gKGZhLCBmKSB7IHJldHVybiBwaXBlKGZhLCBtYXAoZikpOyB9O1xuLyogaXN0YW5idWwgaWdub3JlIG5leHQgKi9cbnZhciBfbWFwV2l0aEluZGV4ID0gZnVuY3Rpb24gKGZhLCBmKSB7IHJldHVybiBwaXBlKGZhLCBtYXBXaXRoSW5kZXgoZikpOyB9O1xuLyogaXN0YW5idWwgaWdub3JlIG5leHQgKi9cbnZhciBfYXAgPSBmdW5jdGlvbiAoZmFiLCBmYSkgeyByZXR1cm4gcGlwZShmYWIsIGFwKGZhKSk7IH07XG4vKiBpc3RhbmJ1bCBpZ25vcmUgbmV4dCAqL1xudmFyIF9leHRlbmQgPSBmdW5jdGlvbiAod2EsIGYpIHsgcmV0dXJuIHBpcGUod2EsIGV4dGVuZChmKSk7IH07XG4vKiBpc3RhbmJ1bCBpZ25vcmUgbmV4dCAqL1xudmFyIF9yZWR1Y2UgPSBmdW5jdGlvbiAoZmEsIGIsIGYpIHsgcmV0dXJuIHBpcGUoZmEsIHJlZHVjZShiLCBmKSk7IH07XG4vKiBpc3RhbmJ1bCBpZ25vcmUgbmV4dCAqL1xudmFyIF9mb2xkTWFwID0gZnVuY3Rpb24gKE0pIHtcbiAgICB2YXIgZm9sZE1hcE0gPSBmb2xkTWFwKE0pO1xuICAgIHJldHVybiBmdW5jdGlvbiAoZmEsIGYpIHsgcmV0dXJuIHBpcGUoZmEsIGZvbGRNYXBNKGYpKTsgfTtcbn07XG4vKiBpc3RhbmJ1bCBpZ25vcmUgbmV4dCAqL1xudmFyIF9yZWR1Y2VSaWdodCA9IGZ1bmN0aW9uIChmYSwgYiwgZikgeyByZXR1cm4gcGlwZShmYSwgcmVkdWNlUmlnaHQoYiwgZikpOyB9O1xuLyogaXN0YW5idWwgaWdub3JlIG5leHQgKi9cbnZhciBfdHJhdmVyc2UgPSBmdW5jdGlvbiAoRikge1xuICAgIHZhciB0cmF2ZXJzZUYgPSB0cmF2ZXJzZShGKTtcbiAgICByZXR1cm4gZnVuY3Rpb24gKHRhLCBmKSB7IHJldHVybiBwaXBlKHRhLCB0cmF2ZXJzZUYoZikpOyB9O1xufTtcbi8qIGlzdGFuYnVsIGlnbm9yZSBuZXh0ICovXG52YXIgX2FsdCA9IGZ1bmN0aW9uIChmYSwgdGhhdCkgeyByZXR1cm4gcGlwZShmYSwgYWx0KHRoYXQpKTsgfTtcbi8qIGlzdGFuYnVsIGlnbm9yZSBuZXh0ICovXG52YXIgX3JlZHVjZVdpdGhJbmRleCA9IGZ1bmN0aW9uIChmYSwgYiwgZikge1xuICAgIHJldHVybiBwaXBlKGZhLCByZWR1Y2VXaXRoSW5kZXgoYiwgZikpO1xufTtcbi8qIGlzdGFuYnVsIGlnbm9yZSBuZXh0ICovXG52YXIgX2ZvbGRNYXBXaXRoSW5kZXggPSBmdW5jdGlvbiAoTSkge1xuICAgIHZhciBmb2xkTWFwV2l0aEluZGV4TSA9IGZvbGRNYXBXaXRoSW5kZXgoTSk7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChmYSwgZikgeyByZXR1cm4gcGlwZShmYSwgZm9sZE1hcFdpdGhJbmRleE0oZikpOyB9O1xufTtcbi8qIGlzdGFuYnVsIGlnbm9yZSBuZXh0ICovXG52YXIgX3JlZHVjZVJpZ2h0V2l0aEluZGV4ID0gZnVuY3Rpb24gKGZhLCBiLCBmKSB7XG4gICAgcmV0dXJuIHBpcGUoZmEsIHJlZHVjZVJpZ2h0V2l0aEluZGV4KGIsIGYpKTtcbn07XG4vKiBpc3RhbmJ1bCBpZ25vcmUgbmV4dCAqL1xudmFyIF90cmF2ZXJzZVdpdGhJbmRleCA9IGZ1bmN0aW9uIChGKSB7XG4gICAgdmFyIHRyYXZlcnNlV2l0aEluZGV4RiA9IHRyYXZlcnNlV2l0aEluZGV4KEYpO1xuICAgIHJldHVybiBmdW5jdGlvbiAodGEsIGYpIHsgcmV0dXJuIHBpcGUodGEsIHRyYXZlcnNlV2l0aEluZGV4RihmKSk7IH07XG59O1xuLyoqXG4gKiBMZXNzIHN0cmljdCB2ZXJzaW9uIG9mIFtgYWx0YF0oI2FsdCkuXG4gKlxuICogVGhlIGBXYCBzdWZmaXggKHNob3J0IGZvciAqKlcqKmlkZW5pbmcpIG1lYW5zIHRoYXQgdGhlIHJldHVybiB0eXBlcyB3aWxsIGJlIG1lcmdlZC5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0ICogYXMgTkVBIGZyb20gJ2ZwLXRzL05vbkVtcHR5QXJyYXknXG4gKiBpbXBvcnQgeyBwaXBlIH0gZnJvbSAnZnAtdHMvZnVuY3Rpb24nXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChcbiAqICAgcGlwZShcbiAqICAgICBbMSwgMiwgM10gYXMgTkVBLk5vbkVtcHR5QXJyYXk8bnVtYmVyPixcbiAqICAgICBORUEuYWx0VygoKSA9PiBbJ2EnLCAnYiddKVxuICogICApLFxuICogICBbMSwgMiwgMywgJ2EnLCAnYiddXG4gKiApXG4gKlxuICogQGNhdGVnb3J5IGVycm9yIGhhbmRsaW5nXG4gKiBAc2luY2UgMi45LjBcbiAqL1xuZXhwb3J0IHZhciBhbHRXID0gZnVuY3Rpb24gKHRoYXQpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIHJldHVybiBwaXBlKGFzLCBjb25jYXRXKHRoYXQoKSkpO1xuICAgIH07XG59O1xuLyoqXG4gKiBJZGVudGlmaWVzIGFuIGFzc29jaWF0aXZlIG9wZXJhdGlvbiBvbiBhIHR5cGUgY29uc3RydWN0b3IuIEl0IGlzIHNpbWlsYXIgdG8gYFNlbWlncm91cGAsIGV4Y2VwdCB0aGF0IGl0IGFwcGxpZXMgdG9cbiAqIHR5cGVzIG9mIGtpbmQgYCogLT4gKmAuXG4gKlxuICogSW4gY2FzZSBvZiBgTm9uRW1wdHlBcnJheWAgY29uY2F0ZW5hdGVzIHRoZSBpbnB1dHMgaW50byBhIHNpbmdsZSBhcnJheS5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0ICogYXMgTkVBIGZyb20gJ2ZwLXRzL05vbkVtcHR5QXJyYXknXG4gKiBpbXBvcnQgeyBwaXBlIH0gZnJvbSAnZnAtdHMvZnVuY3Rpb24nXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChcbiAqICAgcGlwZShcbiAqICAgICBbMSwgMiwgM10sXG4gKiAgICAgTkVBLmFsdCgoKSA9PiBbNCwgNV0pXG4gKiAgICksXG4gKiAgIFsxLCAyLCAzLCA0LCA1XVxuICogKVxuICpcbiAqIEBjYXRlZ29yeSBlcnJvciBoYW5kbGluZ1xuICogQHNpbmNlIDIuNi4yXG4gKi9cbmV4cG9ydCB2YXIgYWx0ID0gYWx0Vztcbi8qKlxuICogQXBwbHkgYSBmdW5jdGlvbiB0byBhbiBhcmd1bWVudCB1bmRlciBhIHR5cGUgY29uc3RydWN0b3IuXG4gKlxuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgYXAgPSBmdW5jdGlvbiAoYXMpIHtcbiAgICByZXR1cm4gZmxhdE1hcChmdW5jdGlvbiAoZikgeyByZXR1cm4gcGlwZShhcywgbWFwKGYpKTsgfSk7XG59O1xuLyoqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0ICogYXMgTkVBIGZyb20gJ2ZwLXRzL05vbkVtcHR5QXJyYXknXG4gKiBpbXBvcnQgeyBwaXBlIH0gZnJvbSAnZnAtdHMvZnVuY3Rpb24nXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChcbiAqICAgcGlwZShcbiAqICAgICBbMSwgMiwgM10sXG4gKiAgICAgTkVBLmZsYXRNYXAoKG4pID0+IFtgYSR7bn1gLCBgYiR7bn1gXSlcbiAqICAgKSxcbiAqICAgWydhMScsICdiMScsICdhMicsICdiMicsICdhMycsICdiMyddXG4gKiApXG4gKlxuICogQGNhdGVnb3J5IHNlcXVlbmNpbmdcbiAqIEBzaW5jZSAyLjE0LjBcbiAqL1xuZXhwb3J0IHZhciBmbGF0TWFwID0gLyojX19QVVJFX18qLyBkdWFsKDIsIGZ1bmN0aW9uIChtYSwgZikge1xuICAgIHJldHVybiBwaXBlKG1hLCBjaGFpbldpdGhJbmRleChmdW5jdGlvbiAoaSwgYSkgeyByZXR1cm4gZihhLCBpKTsgfSkpO1xufSk7XG4vKipcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIGV4dGVuZCA9IGZ1bmN0aW9uIChmKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykge1xuICAgICAgICB2YXIgbmV4dCA9IHRhaWwoYXMpO1xuICAgICAgICB2YXIgb3V0ID0gW2YoYXMpXTtcbiAgICAgICAgd2hpbGUgKGlzTm9uRW1wdHkobmV4dCkpIHtcbiAgICAgICAgICAgIG91dC5wdXNoKGYobmV4dCkpO1xuICAgICAgICAgICAgbmV4dCA9IHRhaWwobmV4dCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG91dDtcbiAgICB9O1xufTtcbi8qKlxuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgZHVwbGljYXRlID0gLyojX19QVVJFX18qLyBleHRlbmQoaWRlbnRpdHkpO1xuLyoqXG4gKiBAY2F0ZWdvcnkgc2VxdWVuY2luZ1xuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgZmxhdHRlbiA9IC8qI19fUFVSRV9fKi8gZmxhdE1hcChpZGVudGl0eSk7XG4vKipcbiAqIGBtYXBgIGNhbiBiZSB1c2VkIHRvIHR1cm4gZnVuY3Rpb25zIGAoYTogQSkgPT4gQmAgaW50byBmdW5jdGlvbnMgYChmYTogRjxBPikgPT4gRjxCPmAgd2hvc2UgYXJndW1lbnQgYW5kIHJldHVybiB0eXBlc1xuICogdXNlIHRoZSB0eXBlIGNvbnN0cnVjdG9yIGBGYCB0byByZXByZXNlbnQgc29tZSBjb21wdXRhdGlvbmFsIGNvbnRleHQuXG4gKlxuICogQGNhdGVnb3J5IG1hcHBpbmdcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIG1hcCA9IGZ1bmN0aW9uIChmKSB7IHJldHVybiBtYXBXaXRoSW5kZXgoZnVuY3Rpb24gKF8sIGEpIHsgcmV0dXJuIGYoYSk7IH0pOyB9O1xuLyoqXG4gKiBAY2F0ZWdvcnkgbWFwcGluZ1xuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgbWFwV2l0aEluZGV4ID0gZnVuY3Rpb24gKGYpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIHZhciBvdXQgPSBbZigwLCBoZWFkKGFzKSldO1xuICAgICAgICBmb3IgKHZhciBpID0gMTsgaSA8IGFzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICBvdXQucHVzaChmKGksIGFzW2ldKSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG91dDtcbiAgICB9O1xufTtcbi8qKlxuICogQGNhdGVnb3J5IGZvbGRpbmdcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIHJlZHVjZSA9IFJORUEucmVkdWNlO1xuLyoqXG4gKiBAY2F0ZWdvcnkgZm9sZGluZ1xuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgcmVkdWNlV2l0aEluZGV4ID0gUk5FQS5yZWR1Y2VXaXRoSW5kZXg7XG4vKipcbiAqIEBjYXRlZ29yeSBmb2xkaW5nXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciByZWR1Y2VSaWdodCA9IFJORUEucmVkdWNlUmlnaHQ7XG4vKipcbiAqIEBjYXRlZ29yeSBmb2xkaW5nXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciByZWR1Y2VSaWdodFdpdGhJbmRleCA9IFJORUEucmVkdWNlUmlnaHRXaXRoSW5kZXg7XG4vKipcbiAqIEBjYXRlZ29yeSB0cmF2ZXJzaW5nXG4gKiBAc2luY2UgMi42LjNcbiAqL1xuZXhwb3J0IHZhciB0cmF2ZXJzZSA9IGZ1bmN0aW9uIChGKSB7XG4gICAgdmFyIHRyYXZlcnNlV2l0aEluZGV4RiA9IHRyYXZlcnNlV2l0aEluZGV4KEYpO1xuICAgIHJldHVybiBmdW5jdGlvbiAoZikgeyByZXR1cm4gdHJhdmVyc2VXaXRoSW5kZXhGKGZ1bmN0aW9uIChfLCBhKSB7IHJldHVybiBmKGEpOyB9KTsgfTtcbn07XG4vKipcbiAqIEBjYXRlZ29yeSB0cmF2ZXJzaW5nXG4gKiBAc2luY2UgMi42LjNcbiAqL1xuZXhwb3J0IHZhciBzZXF1ZW5jZSA9IGZ1bmN0aW9uIChGKSB7IHJldHVybiB0cmF2ZXJzZVdpdGhJbmRleChGKShmdW5jdGlvbiAoXywgYSkgeyByZXR1cm4gYTsgfSk7IH07XG4vKipcbiAqIEBjYXRlZ29yeSBzZXF1ZW5jaW5nXG4gKiBAc2luY2UgMi42LjNcbiAqL1xuZXhwb3J0IHZhciB0cmF2ZXJzZVdpdGhJbmRleCA9IGZ1bmN0aW9uIChGKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChmKSB7XG4gICAgICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgICAgIHZhciBvdXQgPSBGLm1hcChmKDAsIGhlYWQoYXMpKSwgb2YpO1xuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDE7IGkgPCBhcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgIG91dCA9IEYuYXAoRi5tYXAob3V0LCBmdW5jdGlvbiAoYnMpIHsgcmV0dXJuIGZ1bmN0aW9uIChiKSB7IHJldHVybiBwaXBlKGJzLCBhcHBlbmQoYikpOyB9OyB9KSwgZihpLCBhc1tpXSkpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIG91dDtcbiAgICAgICAgfTtcbiAgICB9O1xufTtcbi8qKlxuICogQHNpbmNlIDIuNy4wXG4gKi9cbmV4cG9ydCB2YXIgZXh0cmFjdCA9IFJORUEuaGVhZDtcbi8qKlxuICogQGNhdGVnb3J5IHR5cGUgbGFtYmRhc1xuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgVVJJID0gJ05vbkVtcHR5QXJyYXknO1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciBnZXRTaG93ID0gUk5FQS5nZXRTaG93O1xuLyoqXG4gKiBCdWlsZHMgYSBgU2VtaWdyb3VwYCBpbnN0YW5jZSBmb3IgYE5vbkVtcHR5QXJyYXlgXG4gKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgZ2V0U2VtaWdyb3VwID0gZnVuY3Rpb24gKCkgeyByZXR1cm4gKHtcbiAgICBjb25jYXQ6IGNvbmNhdFxufSk7IH07XG4vKipcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBnZXRFcSB9IGZyb20gJ2ZwLXRzL05vbkVtcHR5QXJyYXknXG4gKiBpbXBvcnQgKiBhcyBOIGZyb20gJ2ZwLXRzL251bWJlcidcbiAqXG4gKiBjb25zdCBFID0gZ2V0RXEoTi5FcSlcbiAqIGFzc2VydC5zdHJpY3RFcXVhbChFLmVxdWFscyhbMSwgMl0sIFsxLCAyXSksIHRydWUpXG4gKiBhc3NlcnQuc3RyaWN0RXF1YWwoRS5lcXVhbHMoWzEsIDJdLCBbMSwgM10pLCBmYWxzZSlcbiAqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciBnZXRFcSA9IFJORUEuZ2V0RXE7XG4vKipcbiAqIEBzaW5jZSAyLjExLjBcbiAqL1xuZXhwb3J0IHZhciBnZXRVbmlvblNlbWlncm91cCA9IGZ1bmN0aW9uIChFKSB7XG4gICAgdmFyIHVuaW9uRSA9IHVuaW9uKEUpO1xuICAgIHJldHVybiB7XG4gICAgICAgIGNvbmNhdDogZnVuY3Rpb24gKGZpcnN0LCBzZWNvbmQpIHsgcmV0dXJuIHVuaW9uRShzZWNvbmQpKGZpcnN0KTsgfVxuICAgIH07XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi43LjBcbiAqL1xuZXhwb3J0IHZhciBGdW5jdG9yID0ge1xuICAgIFVSSTogVVJJLFxuICAgIG1hcDogX21hcFxufTtcbi8qKlxuICogQGNhdGVnb3J5IG1hcHBpbmdcbiAqIEBzaW5jZSAyLjEwLjBcbiAqL1xuZXhwb3J0IHZhciBmbGFwID0gLyojX19QVVJFX18qLyBmbGFwXyhGdW5jdG9yKTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuMTAuMFxuICovXG5leHBvcnQgdmFyIFBvaW50ZWQgPSB7XG4gICAgVVJJOiBVUkksXG4gICAgb2Y6IG9mXG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi43LjBcbiAqL1xuZXhwb3J0IHZhciBGdW5jdG9yV2l0aEluZGV4ID0ge1xuICAgIFVSSTogVVJJLFxuICAgIG1hcDogX21hcCxcbiAgICBtYXBXaXRoSW5kZXg6IF9tYXBXaXRoSW5kZXhcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjEwLjBcbiAqL1xuZXhwb3J0IHZhciBBcHBseSA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICBtYXA6IF9tYXAsXG4gICAgYXA6IF9hcFxufTtcbi8qKlxuICogQ29tYmluZSB0d28gZWZmZWN0ZnVsIGFjdGlvbnMsIGtlZXBpbmcgb25seSB0aGUgcmVzdWx0IG9mIHRoZSBmaXJzdC5cbiAqXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBhcEZpcnN0ID0gLyojX19QVVJFX18qLyBhcEZpcnN0XyhBcHBseSk7XG4vKipcbiAqIENvbWJpbmUgdHdvIGVmZmVjdGZ1bCBhY3Rpb25zLCBrZWVwaW5nIG9ubHkgdGhlIHJlc3VsdCBvZiB0aGUgc2Vjb25kLlxuICpcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIGFwU2Vjb25kID0gLyojX19QVVJFX18qLyBhcFNlY29uZF8oQXBwbHkpO1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi43LjBcbiAqL1xuZXhwb3J0IHZhciBBcHBsaWNhdGl2ZSA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICBtYXA6IF9tYXAsXG4gICAgYXA6IF9hcCxcbiAgICBvZjogb2Zcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjEwLjBcbiAqL1xuZXhwb3J0IHZhciBDaGFpbiA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICBtYXA6IF9tYXAsXG4gICAgYXA6IF9hcCxcbiAgICBjaGFpbjogZmxhdE1hcFxufTtcbi8qKlxuICogQ29tcG9zZXMgY29tcHV0YXRpb25zIGluIHNlcXVlbmNlLCB1c2luZyB0aGUgcmV0dXJuIHZhbHVlIG9mIG9uZSBjb21wdXRhdGlvbiB0byBkZXRlcm1pbmUgdGhlIG5leHQgY29tcHV0YXRpb24gYW5kXG4gKiBrZWVwaW5nIG9ubHkgdGhlIHJlc3VsdCBvZiB0aGUgZmlyc3QuXG4gKlxuICogQGNhdGVnb3J5IHNlcXVlbmNpbmdcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIGNoYWluRmlyc3QgPSBcbi8qI19fUFVSRV9fKi8gY2hhaW5GaXJzdF8oQ2hhaW4pO1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi43LjBcbiAqL1xuZXhwb3J0IHZhciBNb25hZCA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICBtYXA6IF9tYXAsXG4gICAgYXA6IF9hcCxcbiAgICBvZjogb2YsXG4gICAgY2hhaW46IGZsYXRNYXBcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjcuMFxuICovXG5leHBvcnQgdmFyIEZvbGRhYmxlID0ge1xuICAgIFVSSTogVVJJLFxuICAgIHJlZHVjZTogX3JlZHVjZSxcbiAgICBmb2xkTWFwOiBfZm9sZE1hcCxcbiAgICByZWR1Y2VSaWdodDogX3JlZHVjZVJpZ2h0XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi43LjBcbiAqL1xuZXhwb3J0IHZhciBGb2xkYWJsZVdpdGhJbmRleCA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICByZWR1Y2U6IF9yZWR1Y2UsXG4gICAgZm9sZE1hcDogX2ZvbGRNYXAsXG4gICAgcmVkdWNlUmlnaHQ6IF9yZWR1Y2VSaWdodCxcbiAgICByZWR1Y2VXaXRoSW5kZXg6IF9yZWR1Y2VXaXRoSW5kZXgsXG4gICAgZm9sZE1hcFdpdGhJbmRleDogX2ZvbGRNYXBXaXRoSW5kZXgsXG4gICAgcmVkdWNlUmlnaHRXaXRoSW5kZXg6IF9yZWR1Y2VSaWdodFdpdGhJbmRleFxufTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuNy4wXG4gKi9cbmV4cG9ydCB2YXIgVHJhdmVyc2FibGUgPSB7XG4gICAgVVJJOiBVUkksXG4gICAgbWFwOiBfbWFwLFxuICAgIHJlZHVjZTogX3JlZHVjZSxcbiAgICBmb2xkTWFwOiBfZm9sZE1hcCxcbiAgICByZWR1Y2VSaWdodDogX3JlZHVjZVJpZ2h0LFxuICAgIHRyYXZlcnNlOiBfdHJhdmVyc2UsXG4gICAgc2VxdWVuY2U6IHNlcXVlbmNlXG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi43LjBcbiAqL1xuZXhwb3J0IHZhciBUcmF2ZXJzYWJsZVdpdGhJbmRleCA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICBtYXA6IF9tYXAsXG4gICAgbWFwV2l0aEluZGV4OiBfbWFwV2l0aEluZGV4LFxuICAgIHJlZHVjZTogX3JlZHVjZSxcbiAgICBmb2xkTWFwOiBfZm9sZE1hcCxcbiAgICByZWR1Y2VSaWdodDogX3JlZHVjZVJpZ2h0LFxuICAgIHRyYXZlcnNlOiBfdHJhdmVyc2UsXG4gICAgc2VxdWVuY2U6IHNlcXVlbmNlLFxuICAgIHJlZHVjZVdpdGhJbmRleDogX3JlZHVjZVdpdGhJbmRleCxcbiAgICBmb2xkTWFwV2l0aEluZGV4OiBfZm9sZE1hcFdpdGhJbmRleCxcbiAgICByZWR1Y2VSaWdodFdpdGhJbmRleDogX3JlZHVjZVJpZ2h0V2l0aEluZGV4LFxuICAgIHRyYXZlcnNlV2l0aEluZGV4OiBfdHJhdmVyc2VXaXRoSW5kZXhcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjcuMFxuICovXG5leHBvcnQgdmFyIEFsdCA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICBtYXA6IF9tYXAsXG4gICAgYWx0OiBfYWx0XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi43LjBcbiAqL1xuZXhwb3J0IHZhciBDb21vbmFkID0ge1xuICAgIFVSSTogVVJJLFxuICAgIG1hcDogX21hcCxcbiAgICBleHRlbmQ6IF9leHRlbmQsXG4gICAgZXh0cmFjdDogZXh0cmFjdFxufTtcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8vIGRvIG5vdGF0aW9uXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vKipcbiAqIEBjYXRlZ29yeSBkbyBub3RhdGlvblxuICogQHNpbmNlIDIuOS4wXG4gKi9cbmV4cG9ydCB2YXIgRG8gPSAvKiNfX1BVUkVfXyovIG9mKF8uZW1wdHlSZWNvcmQpO1xuLyoqXG4gKiBAY2F0ZWdvcnkgZG8gbm90YXRpb25cbiAqIEBzaW5jZSAyLjguMFxuICovXG5leHBvcnQgdmFyIGJpbmRUbyA9IC8qI19fUFVSRV9fKi8gYmluZFRvXyhGdW5jdG9yKTtcbnZhciBsZXRfID0gLyojX19QVVJFX18qLyBsZXRfXyhGdW5jdG9yKTtcbmV4cG9ydCB7IFxuLyoqXG4gKiBAY2F0ZWdvcnkgZG8gbm90YXRpb25cbiAqIEBzaW5jZSAyLjEzLjBcbiAqL1xubGV0XyBhcyBsZXQgfTtcbi8qKlxuICogQGNhdGVnb3J5IGRvIG5vdGF0aW9uXG4gKiBAc2luY2UgMi44LjBcbiAqL1xuZXhwb3J0IHZhciBiaW5kID0gLyojX19QVVJFX18qLyBiaW5kXyhDaGFpbik7XG4vKipcbiAqIEBjYXRlZ29yeSBkbyBub3RhdGlvblxuICogQHNpbmNlIDIuOC4wXG4gKi9cbmV4cG9ydCB2YXIgYXBTID0gLyojX19QVVJFX18qLyBhcFNfKEFwcGx5KTtcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8vIHV0aWxzXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vKipcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIGhlYWQgPSBSTkVBLmhlYWQ7XG4vKipcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIHRhaWwgPSBmdW5jdGlvbiAoYXMpIHsgcmV0dXJuIGFzLnNsaWNlKDEpOyB9O1xuLyoqXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciBsYXN0ID0gUk5FQS5sYXN0O1xuLyoqXG4gKiBHZXQgYWxsIGJ1dCB0aGUgbGFzdCBlbGVtZW50IG9mIGEgbm9uIGVtcHR5IGFycmF5LCBjcmVhdGluZyBhIG5ldyBhcnJheS5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgaW5pdCB9IGZyb20gJ2ZwLXRzL05vbkVtcHR5QXJyYXknXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChpbml0KFsxLCAyLCAzXSksIFsxLCAyXSlcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoaW5pdChbMV0pLCBbXSlcbiAqXG4gKiBAc2luY2UgMi4yLjBcbiAqL1xuZXhwb3J0IHZhciBpbml0ID0gZnVuY3Rpb24gKGFzKSB7IHJldHVybiBhcy5zbGljZSgwLCAtMSk7IH07XG4vKipcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIG1pbiA9IFJORUEubWluO1xuLyoqXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciBtYXggPSBSTkVBLm1heDtcbi8qKlxuICogQHNpbmNlIDIuMTAuMFxuICovXG5leHBvcnQgdmFyIGNvbmNhdEFsbCA9IGZ1bmN0aW9uIChTKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykge1xuICAgICAgICByZXR1cm4gYXMucmVkdWNlKFMuY29uY2F0KTtcbiAgICB9O1xufTtcbi8qKlxuICogQnJlYWsgYW4gYEFycmF5YCBpbnRvIGl0cyBmaXJzdCBlbGVtZW50IGFuZCByZW1haW5pbmcgZWxlbWVudHMuXG4gKlxuICogQGNhdGVnb3J5IHBhdHRlcm4gbWF0Y2hpbmdcbiAqIEBzaW5jZSAyLjExLjBcbiAqL1xuZXhwb3J0IHZhciBtYXRjaExlZnQgPSBmdW5jdGlvbiAoZikge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgcmV0dXJuIGYoaGVhZChhcyksIHRhaWwoYXMpKTtcbiAgICB9O1xufTtcbi8qKlxuICogQnJlYWsgYW4gYEFycmF5YCBpbnRvIGl0cyBpbml0aWFsIGVsZW1lbnRzIGFuZCB0aGUgbGFzdCBlbGVtZW50LlxuICpcbiAqIEBjYXRlZ29yeSBwYXR0ZXJuIG1hdGNoaW5nXG4gKiBAc2luY2UgMi4xMS4wXG4gKi9cbmV4cG9ydCB2YXIgbWF0Y2hSaWdodCA9IGZ1bmN0aW9uIChmKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykge1xuICAgICAgICByZXR1cm4gZihpbml0KGFzKSwgbGFzdChhcykpO1xuICAgIH07XG59O1xuLyoqXG4gKiBBcHBseSBhIGZ1bmN0aW9uIHRvIHRoZSBoZWFkLCBjcmVhdGluZyBhIG5ldyBgTm9uRW1wdHlBcnJheWAuXG4gKlxuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIG1vZGlmeUhlYWQgPSBmdW5jdGlvbiAoZikge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgcmV0dXJuIF9fc3ByZWFkQXJyYXkoW2YoaGVhZChhcykpXSwgdGFpbChhcyksIHRydWUpO1xuICAgIH07XG59O1xuLyoqXG4gKiBDaGFuZ2UgdGhlIGhlYWQsIGNyZWF0aW5nIGEgbmV3IGBOb25FbXB0eUFycmF5YC5cbiAqXG4gKiBAc2luY2UgMi4xMS4wXG4gKi9cbmV4cG9ydCB2YXIgdXBkYXRlSGVhZCA9IGZ1bmN0aW9uIChhKSB7IHJldHVybiBtb2RpZnlIZWFkKGZ1bmN0aW9uICgpIHsgcmV0dXJuIGE7IH0pOyB9O1xuLyoqXG4gKiBBcHBseSBhIGZ1bmN0aW9uIHRvIHRoZSBsYXN0IGVsZW1lbnQsIGNyZWF0aW5nIGEgbmV3IGBOb25FbXB0eUFycmF5YC5cbiAqXG4gKiBAc2luY2UgMi4xMS4wXG4gKi9cbmV4cG9ydCB2YXIgbW9kaWZ5TGFzdCA9IGZ1bmN0aW9uIChmKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykge1xuICAgICAgICByZXR1cm4gcGlwZShpbml0KGFzKSwgYXBwZW5kKGYobGFzdChhcykpKSk7XG4gICAgfTtcbn07XG4vKipcbiAqIENoYW5nZSB0aGUgbGFzdCBlbGVtZW50LCBjcmVhdGluZyBhIG5ldyBgTm9uRW1wdHlBcnJheWAuXG4gKlxuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIHVwZGF0ZUxhc3QgPSBmdW5jdGlvbiAoYSkgeyByZXR1cm4gbW9kaWZ5TGFzdChmdW5jdGlvbiAoKSB7IHJldHVybiBhOyB9KTsgfTtcbi8qKlxuICogUGxhY2VzIGFuIGVsZW1lbnQgaW4gYmV0d2VlbiBtZW1iZXJzIG9mIGEgYE5vbkVtcHR5QXJyYXlgLCB0aGVuIGZvbGRzIHRoZSByZXN1bHRzIHVzaW5nIHRoZSBwcm92aWRlZCBgU2VtaWdyb3VwYC5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0ICogYXMgUyBmcm9tICdmcC10cy9zdHJpbmcnXG4gKiBpbXBvcnQgeyBpbnRlcmNhbGF0ZSB9IGZyb20gJ2ZwLXRzL05vbkVtcHR5QXJyYXknXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChpbnRlcmNhbGF0ZShTLlNlbWlncm91cCkoJy0nKShbJ2EnLCAnYicsICdjJ10pLCAnYS1iLWMnKVxuICpcbiAqIEBzaW5jZSAyLjEyLjBcbiAqL1xuZXhwb3J0IHZhciBpbnRlcmNhbGF0ZSA9IFJORUEuaW50ZXJjYWxhdGU7XG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vLyBsZWdhY3lcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8qKlxuICogQWxpYXMgb2YgYGZsYXRNYXBgLlxuICpcbiAqIEBjYXRlZ29yeSBsZWdhY3lcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIGNoYWluID0gZmxhdE1hcDtcbmV4cG9ydCBmdW5jdGlvbiBncm91cFNvcnQoTykge1xuICAgIHZhciBzb3J0TyA9IHNvcnQoTyk7XG4gICAgdmFyIGdyb3VwTyA9IGdyb3VwKE8pO1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHsgcmV0dXJuIChpc05vbkVtcHR5KGFzKSA/IGdyb3VwTyhzb3J0TyhhcykpIDogW10pOyB9O1xufVxuZXhwb3J0IGZ1bmN0aW9uIGZpbHRlcihwcmVkaWNhdGUpIHtcbiAgICByZXR1cm4gZmlsdGVyV2l0aEluZGV4KGZ1bmN0aW9uIChfLCBhKSB7IHJldHVybiBwcmVkaWNhdGUoYSk7IH0pO1xufVxuLyoqXG4gKiBVc2UgW2BmaWx0ZXJXaXRoSW5kZXhgXSguL0FycmF5LnRzLmh0bWwjZmlsdGVyd2l0aGluZGV4KSBpbnN0ZWFkLlxuICpcbiAqIEBjYXRlZ29yeSB6b25lIG9mIGRlYXRoXG4gKiBAc2luY2UgMi4wLjBcbiAqIEBkZXByZWNhdGVkXG4gKi9cbmV4cG9ydCB2YXIgZmlsdGVyV2l0aEluZGV4ID0gZnVuY3Rpb24gKHByZWRpY2F0ZSkge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgcmV0dXJuIGZyb21BcnJheShhcy5maWx0ZXIoZnVuY3Rpb24gKGEsIGkpIHsgcmV0dXJuIHByZWRpY2F0ZShpLCBhKTsgfSkpO1xuICAgIH07XG59O1xuLyoqXG4gKiBVc2UgW2B1bnByZXBlbmRgXSgjdW5wcmVwZW5kKSBpbnN0ZWFkLlxuICpcbiAqIEBjYXRlZ29yeSB6b25lIG9mIGRlYXRoXG4gKiBAc2luY2UgMi45LjBcbiAqIEBkZXByZWNhdGVkXG4gKi9cbmV4cG9ydCB2YXIgdW5jb25zID0gdW5wcmVwZW5kO1xuLyoqXG4gKiBVc2UgW2B1bmFwcGVuZGBdKCN1bmFwcGVuZCkgaW5zdGVhZC5cbiAqXG4gKiBAY2F0ZWdvcnkgem9uZSBvZiBkZWF0aFxuICogQHNpbmNlIDIuOS4wXG4gKiBAZGVwcmVjYXRlZFxuICovXG5leHBvcnQgdmFyIHVuc25vYyA9IHVuYXBwZW5kO1xuZXhwb3J0IGZ1bmN0aW9uIGNvbnMoaGVhZCwgdGFpbCkge1xuICAgIHJldHVybiB0YWlsID09PSB1bmRlZmluZWQgPyBwcmVwZW5kKGhlYWQpIDogcGlwZSh0YWlsLCBwcmVwZW5kKGhlYWQpKTtcbn1cbi8qKlxuICogVXNlIFtgYXBwZW5kYF0oLi9BcnJheS50cy5odG1sI2FwcGVuZCkgaW5zdGVhZC5cbiAqXG4gKiBAY2F0ZWdvcnkgem9uZSBvZiBkZWF0aFxuICogQHNpbmNlIDIuMC4wXG4gKiBAZGVwcmVjYXRlZFxuICovXG5leHBvcnQgdmFyIHNub2MgPSBmdW5jdGlvbiAoaW5pdCwgZW5kKSB7IHJldHVybiBwaXBlKGluaXQsIGFwcGVuZChlbmQpKTsgfTtcbi8qKlxuICogVXNlIFtgcHJlcGVuZEFsbGBdKCNwcmVwZW5kYWxsKSBpbnN0ZWFkLlxuICpcbiAqIEBjYXRlZ29yeSB6b25lIG9mIGRlYXRoXG4gKiBAc2luY2UgMi45LjBcbiAqIEBkZXByZWNhdGVkXG4gKi9cbmV4cG9ydCB2YXIgcHJlcGVuZFRvQWxsID0gcHJlcGVuZEFsbDtcbi8qKlxuICogVXNlIFtgY29uY2F0QWxsYF0oI2NvbmNhdGFsbCkgaW5zdGVhZC5cbiAqXG4gKiBAY2F0ZWdvcnkgem9uZSBvZiBkZWF0aFxuICogQHNpbmNlIDIuNS4wXG4gKiBAZGVwcmVjYXRlZFxuICovXG5leHBvcnQgdmFyIGZvbGQgPSBSTkVBLmNvbmNhdEFsbDtcbi8qKlxuICogVGhpcyBpbnN0YW5jZSBpcyBkZXByZWNhdGVkLCB1c2Ugc21hbGwsIHNwZWNpZmljIGluc3RhbmNlcyBpbnN0ZWFkLlxuICogRm9yIGV4YW1wbGUgaWYgYSBmdW5jdGlvbiBuZWVkcyBhIGBGdW5jdG9yYCBpbnN0YW5jZSwgcGFzcyBgTkVBLkZ1bmN0b3JgIGluc3RlYWQgb2YgYE5FQS5ub25FbXB0eUFycmF5YFxuICogKHdoZXJlIGBORUFgIGlzIGZyb20gYGltcG9ydCBORUEgZnJvbSAnZnAtdHMvTm9uRW1wdHlBcnJheSdgKVxuICpcbiAqIEBjYXRlZ29yeSB6b25lIG9mIGRlYXRoXG4gKiBAc2luY2UgMi4wLjBcbiAqIEBkZXByZWNhdGVkXG4gKi9cbmV4cG9ydCB2YXIgbm9uRW1wdHlBcnJheSA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICBvZjogb2YsXG4gICAgbWFwOiBfbWFwLFxuICAgIG1hcFdpdGhJbmRleDogX21hcFdpdGhJbmRleCxcbiAgICBhcDogX2FwLFxuICAgIGNoYWluOiBmbGF0TWFwLFxuICAgIGV4dGVuZDogX2V4dGVuZCxcbiAgICBleHRyYWN0OiBleHRyYWN0LFxuICAgIHJlZHVjZTogX3JlZHVjZSxcbiAgICBmb2xkTWFwOiBfZm9sZE1hcCxcbiAgICByZWR1Y2VSaWdodDogX3JlZHVjZVJpZ2h0LFxuICAgIHRyYXZlcnNlOiBfdHJhdmVyc2UsXG4gICAgc2VxdWVuY2U6IHNlcXVlbmNlLFxuICAgIHJlZHVjZVdpdGhJbmRleDogX3JlZHVjZVdpdGhJbmRleCxcbiAgICBmb2xkTWFwV2l0aEluZGV4OiBfZm9sZE1hcFdpdGhJbmRleCxcbiAgICByZWR1Y2VSaWdodFdpdGhJbmRleDogX3JlZHVjZVJpZ2h0V2l0aEluZGV4LFxuICAgIHRyYXZlcnNlV2l0aEluZGV4OiBfdHJhdmVyc2VXaXRoSW5kZXgsXG4gICAgYWx0OiBfYWx0XG59O1xuIiwKICAidmFyIF9fc3ByZWFkQXJyYXkgPSAodGhpcyAmJiB0aGlzLl9fc3ByZWFkQXJyYXkpIHx8IGZ1bmN0aW9uICh0bywgZnJvbSwgcGFjaykge1xuICAgIGlmIChwYWNrIHx8IGFyZ3VtZW50cy5sZW5ndGggPT09IDIpIGZvciAodmFyIGkgPSAwLCBsID0gZnJvbS5sZW5ndGgsIGFyOyBpIDwgbDsgaSsrKSB7XG4gICAgICAgIGlmIChhciB8fCAhKGkgaW4gZnJvbSkpIHtcbiAgICAgICAgICAgIGlmICghYXIpIGFyID0gQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoZnJvbSwgMCwgaSk7XG4gICAgICAgICAgICBhcltpXSA9IGZyb21baV07XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHRvLmNvbmNhdChhciB8fCBBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChmcm9tKSk7XG59O1xuaW1wb3J0IHsgYXBGaXJzdCBhcyBhcEZpcnN0XywgYXBTIGFzIGFwU18sIGFwU2Vjb25kIGFzIGFwU2Vjb25kXyB9IGZyb20gJy4vQXBwbHknO1xuaW1wb3J0IHsgYmluZCBhcyBiaW5kXywgY2hhaW5GaXJzdCBhcyBjaGFpbkZpcnN0XyB9IGZyb20gJy4vQ2hhaW4nO1xuaW1wb3J0IHsgZHVhbCwgaWRlbnRpdHksIHBpcGUgfSBmcm9tICcuL2Z1bmN0aW9uJztcbmltcG9ydCB7IGJpbmRUbyBhcyBiaW5kVG9fLCBmbGFwIGFzIGZsYXBfLCBsZXQgYXMgbGV0X18gfSBmcm9tICcuL0Z1bmN0b3InO1xuaW1wb3J0ICogYXMgXyBmcm9tICcuL2ludGVybmFsJztcbmltcG9ydCB7IGdldE1vbm9pZCB9IGZyb20gJy4vT3JkJztcbmltcG9ydCAqIGFzIFJORUEgZnJvbSAnLi9SZWFkb25seU5vbkVtcHR5QXJyYXknO1xuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLy8gaW50ZXJuYWxcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8qKlxuICogQGludGVybmFsXG4gKi9cbmV4cG9ydCB2YXIgaXNOb25FbXB0eSA9IGZ1bmN0aW9uIChhcykgeyByZXR1cm4gYXMubGVuZ3RoID4gMDsgfTtcbi8qKlxuICogQGludGVybmFsXG4gKi9cbmV4cG9ydCB2YXIgaXNPdXRPZkJvdW5kID0gZnVuY3Rpb24gKGksIGFzKSB7IHJldHVybiBpIDwgMCB8fCBpID49IGFzLmxlbmd0aDsgfTtcbi8qKlxuICogQGludGVybmFsXG4gKi9cbmV4cG9ydCB2YXIgcHJlcGVuZFcgPSBmdW5jdGlvbiAoaGVhZCkge1xuICAgIHJldHVybiBmdW5jdGlvbiAodGFpbCkge1xuICAgICAgICByZXR1cm4gX19zcHJlYWRBcnJheShbaGVhZF0sIHRhaWwsIHRydWUpO1xuICAgIH07XG59O1xuLyoqXG4gKiBAaW50ZXJuYWxcbiAqL1xuZXhwb3J0IHZhciBwcmVwZW5kID0gcHJlcGVuZFc7XG4vKipcbiAqIEBpbnRlcm5hbFxuICovXG5leHBvcnQgdmFyIGFwcGVuZFcgPSBmdW5jdGlvbiAoZW5kKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChpbml0KSB7XG4gICAgICAgIHJldHVybiBfX3NwcmVhZEFycmF5KF9fc3ByZWFkQXJyYXkoW10sIGluaXQsIHRydWUpLCBbZW5kXSwgZmFsc2UpO1xuICAgIH07XG59O1xuLyoqXG4gKiBAaW50ZXJuYWxcbiAqL1xuZXhwb3J0IHZhciBhcHBlbmQgPSBhcHBlbmRXO1xuLyoqXG4gKiBAaW50ZXJuYWxcbiAqL1xuZXhwb3J0IHZhciB1bnNhZmVJbnNlcnRBdCA9IGZ1bmN0aW9uIChpLCBhLCBhcykge1xuICAgIGlmIChpc05vbkVtcHR5KGFzKSkge1xuICAgICAgICB2YXIgeHMgPSBmcm9tUmVhZG9ubHlOb25FbXB0eUFycmF5KGFzKTtcbiAgICAgICAgeHMuc3BsaWNlKGksIDAsIGEpO1xuICAgICAgICByZXR1cm4geHM7XG4gICAgfVxuICAgIHJldHVybiBbYV07XG59O1xuLyoqXG4gKiBAaW50ZXJuYWxcbiAqL1xuZXhwb3J0IHZhciB1bnNhZmVVcGRhdGVBdCA9IGZ1bmN0aW9uIChpLCBhLCBhcykge1xuICAgIHZhciB4cyA9IGZyb21SZWFkb25seU5vbkVtcHR5QXJyYXkoYXMpO1xuICAgIHhzW2ldID0gYTtcbiAgICByZXR1cm4geHM7XG59O1xuLyoqXG4gKiBSZW1vdmUgZHVwbGljYXRlcyBmcm9tIGEgYE5vbkVtcHR5QXJyYXlgLCBrZWVwaW5nIHRoZSBmaXJzdCBvY2N1cnJlbmNlIG9mIGFuIGVsZW1lbnQuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IHVuaXEgfSBmcm9tICdmcC10cy9Ob25FbXB0eUFycmF5J1xuICogaW1wb3J0ICogYXMgTiBmcm9tICdmcC10cy9udW1iZXInXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbCh1bmlxKE4uRXEpKFsxLCAyLCAxXSksIFsxLCAyXSlcbiAqXG4gKiBAc2luY2UgMi4xMS4wXG4gKi9cbmV4cG9ydCB2YXIgdW5pcSA9IGZ1bmN0aW9uIChFKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykge1xuICAgICAgICBpZiAoYXMubGVuZ3RoID09PSAxKSB7XG4gICAgICAgICAgICByZXR1cm4gY29weShhcyk7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIG91dCA9IFtoZWFkKGFzKV07XG4gICAgICAgIHZhciByZXN0ID0gdGFpbChhcyk7XG4gICAgICAgIHZhciBfbG9vcF8xID0gZnVuY3Rpb24gKGEpIHtcbiAgICAgICAgICAgIGlmIChvdXQuZXZlcnkoZnVuY3Rpb24gKG8pIHsgcmV0dXJuICFFLmVxdWFscyhvLCBhKTsgfSkpIHtcbiAgICAgICAgICAgICAgICBvdXQucHVzaChhKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgZm9yICh2YXIgX2kgPSAwLCByZXN0XzEgPSByZXN0OyBfaSA8IHJlc3RfMS5sZW5ndGg7IF9pKyspIHtcbiAgICAgICAgICAgIHZhciBhID0gcmVzdF8xW19pXTtcbiAgICAgICAgICAgIF9sb29wXzEoYSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG91dDtcbiAgICB9O1xufTtcbi8qKlxuICogU29ydCB0aGUgZWxlbWVudHMgb2YgYSBgTm9uRW1wdHlBcnJheWAgaW4gaW5jcmVhc2luZyBvcmRlciwgd2hlcmUgZWxlbWVudHMgYXJlIGNvbXBhcmVkIHVzaW5nIGZpcnN0IGBvcmRzWzBdYCwgdGhlbiBgb3Jkc1sxXWAsXG4gKiBldGMuLi5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0ICogYXMgTkVBIGZyb20gJ2ZwLXRzL05vbkVtcHR5QXJyYXknXG4gKiBpbXBvcnQgeyBjb250cmFtYXAgfSBmcm9tICdmcC10cy9PcmQnXG4gKiBpbXBvcnQgKiBhcyBTIGZyb20gJ2ZwLXRzL3N0cmluZydcbiAqIGltcG9ydCAqIGFzIE4gZnJvbSAnZnAtdHMvbnVtYmVyJ1xuICogaW1wb3J0IHsgcGlwZSB9IGZyb20gJ2ZwLXRzL2Z1bmN0aW9uJ1xuICpcbiAqIGludGVyZmFjZSBQZXJzb24ge1xuICogICBuYW1lOiBzdHJpbmdcbiAqICAgYWdlOiBudW1iZXJcbiAqIH1cbiAqXG4gKiBjb25zdCBieU5hbWUgPSBwaXBlKFMuT3JkLCBjb250cmFtYXAoKHA6IFBlcnNvbikgPT4gcC5uYW1lKSlcbiAqXG4gKiBjb25zdCBieUFnZSA9IHBpcGUoTi5PcmQsIGNvbnRyYW1hcCgocDogUGVyc29uKSA9PiBwLmFnZSkpXG4gKlxuICogY29uc3Qgc29ydEJ5TmFtZUJ5QWdlID0gTkVBLnNvcnRCeShbYnlOYW1lLCBieUFnZV0pXG4gKlxuICogY29uc3QgcGVyc29uczogTkVBLk5vbkVtcHR5QXJyYXk8UGVyc29uPiA9IFtcbiAqICAgeyBuYW1lOiAnYScsIGFnZTogMSB9LFxuICogICB7IG5hbWU6ICdiJywgYWdlOiAzIH0sXG4gKiAgIHsgbmFtZTogJ2MnLCBhZ2U6IDIgfSxcbiAqICAgeyBuYW1lOiAnYicsIGFnZTogMiB9XG4gKiBdXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChzb3J0QnlOYW1lQnlBZ2UocGVyc29ucyksIFtcbiAqICAgeyBuYW1lOiAnYScsIGFnZTogMSB9LFxuICogICB7IG5hbWU6ICdiJywgYWdlOiAyIH0sXG4gKiAgIHsgbmFtZTogJ2InLCBhZ2U6IDMgfSxcbiAqICAgeyBuYW1lOiAnYycsIGFnZTogMiB9XG4gKiBdKVxuICpcbiAqIEBzaW5jZSAyLjExLjBcbiAqL1xuZXhwb3J0IHZhciBzb3J0QnkgPSBmdW5jdGlvbiAob3Jkcykge1xuICAgIGlmIChpc05vbkVtcHR5KG9yZHMpKSB7XG4gICAgICAgIHZhciBNID0gZ2V0TW9ub2lkKCk7XG4gICAgICAgIHJldHVybiBzb3J0KG9yZHMucmVkdWNlKE0uY29uY2F0LCBNLmVtcHR5KSk7XG4gICAgfVxuICAgIHJldHVybiBjb3B5O1xufTtcbi8qKlxuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIHVuaW9uID0gZnVuY3Rpb24gKEUpIHtcbiAgICB2YXIgdW5pcUUgPSB1bmlxKEUpO1xuICAgIHJldHVybiBmdW5jdGlvbiAoc2Vjb25kKSB7IHJldHVybiBmdW5jdGlvbiAoZmlyc3QpIHsgcmV0dXJuIHVuaXFFKHBpcGUoZmlyc3QsIGNvbmNhdChzZWNvbmQpKSk7IH07IH07XG59O1xuLyoqXG4gKiBSb3RhdGUgYSBgTm9uRW1wdHlBcnJheWAgYnkgYG5gIHN0ZXBzLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyByb3RhdGUgfSBmcm9tICdmcC10cy9Ob25FbXB0eUFycmF5J1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwocm90YXRlKDIpKFsxLCAyLCAzLCA0LCA1XSksIFs0LCA1LCAxLCAyLCAzXSlcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwocm90YXRlKC0yKShbMSwgMiwgMywgNCwgNV0pLCBbMywgNCwgNSwgMSwgMl0pXG4gKlxuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIHJvdGF0ZSA9IGZ1bmN0aW9uIChuKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykge1xuICAgICAgICB2YXIgbGVuID0gYXMubGVuZ3RoO1xuICAgICAgICB2YXIgbSA9IE1hdGgucm91bmQobikgJSBsZW47XG4gICAgICAgIGlmIChpc091dE9mQm91bmQoTWF0aC5hYnMobSksIGFzKSB8fCBtID09PSAwKSB7XG4gICAgICAgICAgICByZXR1cm4gY29weShhcyk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKG0gPCAwKSB7XG4gICAgICAgICAgICB2YXIgX2EgPSBzcGxpdEF0KC1tKShhcyksIGYgPSBfYVswXSwgcyA9IF9hWzFdO1xuICAgICAgICAgICAgcmV0dXJuIHBpcGUocywgY29uY2F0KGYpKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybiByb3RhdGUobSAtIGxlbikoYXMpO1xuICAgICAgICB9XG4gICAgfTtcbn07XG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vLyBjb25zdHJ1Y3RvcnNcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8qKlxuICogQGNhdGVnb3J5IGNvbnZlcnNpb25zXG4gKiBAc2luY2UgMi4xMC4wXG4gKi9cbmV4cG9ydCB2YXIgZnJvbVJlYWRvbmx5Tm9uRW1wdHlBcnJheSA9IF8uZnJvbVJlYWRvbmx5Tm9uRW1wdHlBcnJheTtcbi8qKlxuICogQnVpbGRzIGEgYE5vbkVtcHR5QXJyYXlgIGZyb20gYW4gYEFycmF5YCByZXR1cm5pbmcgYG5vbmVgIGlmIGBhc2AgaXMgYW4gZW1wdHkgYXJyYXlcbiAqXG4gKiBAY2F0ZWdvcnkgY29udmVyc2lvbnNcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIGZyb21BcnJheSA9IGZ1bmN0aW9uIChhcykgeyByZXR1cm4gKGlzTm9uRW1wdHkoYXMpID8gXy5zb21lKGFzKSA6IF8ubm9uZSk7IH07XG4vKipcbiAqIFJldHVybiBhIGBOb25FbXB0eUFycmF5YCBvZiBsZW5ndGggYG5gIHdpdGggZWxlbWVudCBgaWAgaW5pdGlhbGl6ZWQgd2l0aCBgZihpKWAuXG4gKlxuICogKipOb3RlKiouIGBuYCBpcyBub3JtYWxpemVkIHRvIGEgbmF0dXJhbCBudW1iZXIuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IG1ha2VCeSB9IGZyb20gJ2ZwLXRzL05vbkVtcHR5QXJyYXknXG4gKiBpbXBvcnQgeyBwaXBlIH0gZnJvbSAnZnAtdHMvZnVuY3Rpb24nXG4gKlxuICogY29uc3QgZG91YmxlID0gKG46IG51bWJlcik6IG51bWJlciA9PiBuICogMlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChwaXBlKDUsIG1ha2VCeShkb3VibGUpKSwgWzAsIDIsIDQsIDYsIDhdKVxuICpcbiAqIEBjYXRlZ29yeSBjb25zdHJ1Y3RvcnNcbiAqIEBzaW5jZSAyLjExLjBcbiAqL1xuZXhwb3J0IHZhciBtYWtlQnkgPSBmdW5jdGlvbiAoZikge1xuICAgIHJldHVybiBmdW5jdGlvbiAobikge1xuICAgICAgICB2YXIgaiA9IE1hdGgubWF4KDAsIE1hdGguZmxvb3IobikpO1xuICAgICAgICB2YXIgb3V0ID0gW2YoMCldO1xuICAgICAgICBmb3IgKHZhciBpID0gMTsgaSA8IGo7IGkrKykge1xuICAgICAgICAgICAgb3V0LnB1c2goZihpKSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG91dDtcbiAgICB9O1xufTtcbi8qKlxuICogQ3JlYXRlIGEgYE5vbkVtcHR5QXJyYXlgIGNvbnRhaW5pbmcgYSB2YWx1ZSByZXBlYXRlZCB0aGUgc3BlY2lmaWVkIG51bWJlciBvZiB0aW1lcy5cbiAqXG4gKiAqKk5vdGUqKi4gYG5gIGlzIG5vcm1hbGl6ZWQgdG8gYSBuYXR1cmFsIG51bWJlci5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgcmVwbGljYXRlIH0gZnJvbSAnZnAtdHMvTm9uRW1wdHlBcnJheSdcbiAqIGltcG9ydCB7IHBpcGUgfSBmcm9tICdmcC10cy9mdW5jdGlvbidcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKHBpcGUoMywgcmVwbGljYXRlKCdhJykpLCBbJ2EnLCAnYScsICdhJ10pXG4gKlxuICogQGNhdGVnb3J5IGNvbnN0cnVjdG9yc1xuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIHJlcGxpY2F0ZSA9IGZ1bmN0aW9uIChhKSB7IHJldHVybiBtYWtlQnkoZnVuY3Rpb24gKCkgeyByZXR1cm4gYTsgfSk7IH07XG4vKipcbiAqIENyZWF0ZSBhIGBOb25FbXB0eUFycmF5YCBjb250YWluaW5nIGEgcmFuZ2Ugb2YgaW50ZWdlcnMsIGluY2x1ZGluZyBib3RoIGVuZHBvaW50cy5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgcmFuZ2UgfSBmcm9tICdmcC10cy9Ob25FbXB0eUFycmF5J1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwocmFuZ2UoMSwgNSksIFsxLCAyLCAzLCA0LCA1XSlcbiAqXG4gKiBAY2F0ZWdvcnkgY29uc3RydWN0b3JzXG4gKiBAc2luY2UgMi4xMS4wXG4gKi9cbmV4cG9ydCB2YXIgcmFuZ2UgPSBmdW5jdGlvbiAoc3RhcnQsIGVuZCkge1xuICAgIHJldHVybiBzdGFydCA8PSBlbmQgPyBtYWtlQnkoZnVuY3Rpb24gKGkpIHsgcmV0dXJuIHN0YXJ0ICsgaTsgfSkoZW5kIC0gc3RhcnQgKyAxKSA6IFtzdGFydF07XG59O1xuLyoqXG4gKiBSZXR1cm4gdGhlIHR1cGxlIG9mIHRoZSBgaGVhZGAgYW5kIHRoZSBgdGFpbGAuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IHVucHJlcGVuZCB9IGZyb20gJ2ZwLXRzL05vbkVtcHR5QXJyYXknXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbCh1bnByZXBlbmQoWzEsIDIsIDNdKSwgWzEsIFsyLCAzXV0pXG4gKlxuICogQHNpbmNlIDIuOS4wXG4gKi9cbmV4cG9ydCB2YXIgdW5wcmVwZW5kID0gZnVuY3Rpb24gKGFzKSB7IHJldHVybiBbaGVhZChhcyksIHRhaWwoYXMpXTsgfTtcbi8qKlxuICogUmV0dXJuIHRoZSB0dXBsZSBvZiB0aGUgYGluaXRgIGFuZCB0aGUgYGxhc3RgLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyB1bmFwcGVuZCB9IGZyb20gJ2ZwLXRzL05vbkVtcHR5QXJyYXknXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbCh1bmFwcGVuZChbMSwgMiwgMywgNF0pLCBbWzEsIDIsIDNdLCA0XSlcbiAqXG4gKiBAc2luY2UgMi45LjBcbiAqL1xuZXhwb3J0IHZhciB1bmFwcGVuZCA9IGZ1bmN0aW9uIChhcykgeyByZXR1cm4gW2luaXQoYXMpLCBsYXN0KGFzKV07IH07XG5leHBvcnQgZnVuY3Rpb24gY29uY2F0VyhzZWNvbmQpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGZpcnN0KSB7IHJldHVybiBmaXJzdC5jb25jYXQoc2Vjb25kKTsgfTtcbn1cbmV4cG9ydCBmdW5jdGlvbiBjb25jYXQoeCwgeSkge1xuICAgIHJldHVybiB5ID8geC5jb25jYXQoeSkgOiBmdW5jdGlvbiAoeSkgeyByZXR1cm4geS5jb25jYXQoeCk7IH07XG59XG4vKipcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIHJldmVyc2UgPSBmdW5jdGlvbiAoYXMpIHsgcmV0dXJuIF9fc3ByZWFkQXJyYXkoW2xhc3QoYXMpXSwgYXMuc2xpY2UoMCwgLTEpLnJldmVyc2UoKSwgdHJ1ZSk7IH07XG5leHBvcnQgZnVuY3Rpb24gZ3JvdXAoRSkge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgdmFyIGxlbiA9IGFzLmxlbmd0aDtcbiAgICAgICAgaWYgKGxlbiA9PT0gMCkge1xuICAgICAgICAgICAgcmV0dXJuIFtdO1xuICAgICAgICB9XG4gICAgICAgIHZhciBvdXQgPSBbXTtcbiAgICAgICAgdmFyIGhlYWQgPSBhc1swXTtcbiAgICAgICAgdmFyIG5lYSA9IFtoZWFkXTtcbiAgICAgICAgZm9yICh2YXIgaSA9IDE7IGkgPCBsZW47IGkrKykge1xuICAgICAgICAgICAgdmFyIGEgPSBhc1tpXTtcbiAgICAgICAgICAgIGlmIChFLmVxdWFscyhhLCBoZWFkKSkge1xuICAgICAgICAgICAgICAgIG5lYS5wdXNoKGEpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgb3V0LnB1c2gobmVhKTtcbiAgICAgICAgICAgICAgICBoZWFkID0gYTtcbiAgICAgICAgICAgICAgICBuZWEgPSBbaGVhZF07XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgb3V0LnB1c2gobmVhKTtcbiAgICAgICAgcmV0dXJuIG91dDtcbiAgICB9O1xufVxuLyoqXG4gKiBTcGxpdHMgYW4gYXJyYXkgaW50byBzdWItbm9uLWVtcHR5LWFycmF5cyBzdG9yZWQgaW4gYW4gb2JqZWN0LCBiYXNlZCBvbiB0aGUgcmVzdWx0IG9mIGNhbGxpbmcgYSBgc3RyaW5nYC1yZXR1cm5pbmdcbiAqIGZ1bmN0aW9uIG9uIGVhY2ggZWxlbWVudCwgYW5kIGdyb3VwaW5nIHRoZSByZXN1bHRzIGFjY29yZGluZyB0byB2YWx1ZXMgcmV0dXJuZWRcbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgZ3JvdXBCeSB9IGZyb20gJ2ZwLXRzL05vbkVtcHR5QXJyYXknXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChncm91cEJ5KChzOiBzdHJpbmcpID0+IFN0cmluZyhzLmxlbmd0aCkpKFsnYScsICdiJywgJ2FiJ10pLCB7XG4gKiAgICcxJzogWydhJywgJ2InXSxcbiAqICAgJzInOiBbJ2FiJ11cbiAqIH0pXG4gKlxuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgZ3JvdXBCeSA9IGZ1bmN0aW9uIChmKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykge1xuICAgICAgICB2YXIgb3V0ID0ge307XG4gICAgICAgIGZvciAodmFyIF9pID0gMCwgYXNfMSA9IGFzOyBfaSA8IGFzXzEubGVuZ3RoOyBfaSsrKSB7XG4gICAgICAgICAgICB2YXIgYSA9IGFzXzFbX2ldO1xuICAgICAgICAgICAgdmFyIGsgPSBmKGEpO1xuICAgICAgICAgICAgaWYgKF8uaGFzLmNhbGwob3V0LCBrKSkge1xuICAgICAgICAgICAgICAgIG91dFtrXS5wdXNoKGEpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgb3V0W2tdID0gW2FdO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBvdXQ7XG4gICAgfTtcbn07XG4vKipcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIHNvcnQgPSBmdW5jdGlvbiAoTykge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgcmV0dXJuIGFzLnNsaWNlKCkuc29ydChPLmNvbXBhcmUpO1xuICAgIH07XG59O1xuLyoqXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciBpbnNlcnRBdCA9IGZ1bmN0aW9uIChpLCBhKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykge1xuICAgICAgICByZXR1cm4gaSA8IDAgfHwgaSA+IGFzLmxlbmd0aCA/IF8ubm9uZSA6IF8uc29tZSh1bnNhZmVJbnNlcnRBdChpLCBhLCBhcykpO1xuICAgIH07XG59O1xuLyoqXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciB1cGRhdGVBdCA9IGZ1bmN0aW9uIChpLCBhKSB7XG4gICAgcmV0dXJuIG1vZGlmeUF0KGksIGZ1bmN0aW9uICgpIHsgcmV0dXJuIGE7IH0pO1xufTtcbi8qKlxuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgbW9kaWZ5QXQgPSBmdW5jdGlvbiAoaSwgZikge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgcmV0dXJuIGlzT3V0T2ZCb3VuZChpLCBhcykgPyBfLm5vbmUgOiBfLnNvbWUodW5zYWZlVXBkYXRlQXQoaSwgZihhc1tpXSksIGFzKSk7XG4gICAgfTtcbn07XG4vKipcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIGNvcHkgPSBmcm9tUmVhZG9ubHlOb25FbXB0eUFycmF5O1xuLyoqXG4gKiBAY2F0ZWdvcnkgY29uc3RydWN0b3JzXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciBvZiA9IGZ1bmN0aW9uIChhKSB7IHJldHVybiBbYV07IH07XG4vKipcbiAqIEBzaW5jZSAyLjUuMVxuICovXG5leHBvcnQgdmFyIHppcFdpdGggPSBmdW5jdGlvbiAoYXMsIGJzLCBmKSB7XG4gICAgdmFyIGNzID0gW2YoYXNbMF0sIGJzWzBdKV07XG4gICAgdmFyIGxlbiA9IE1hdGgubWluKGFzLmxlbmd0aCwgYnMubGVuZ3RoKTtcbiAgICBmb3IgKHZhciBpID0gMTsgaSA8IGxlbjsgaSsrKSB7XG4gICAgICAgIGNzW2ldID0gZihhc1tpXSwgYnNbaV0pO1xuICAgIH1cbiAgICByZXR1cm4gY3M7XG59O1xuZXhwb3J0IGZ1bmN0aW9uIHppcChhcywgYnMpIHtcbiAgICBpZiAoYnMgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICByZXR1cm4gZnVuY3Rpb24gKGJzKSB7IHJldHVybiB6aXAoYnMsIGFzKTsgfTtcbiAgICB9XG4gICAgcmV0dXJuIHppcFdpdGgoYXMsIGJzLCBmdW5jdGlvbiAoYSwgYikgeyByZXR1cm4gW2EsIGJdOyB9KTtcbn1cbi8qKlxuICogQHNpbmNlIDIuNS4xXG4gKi9cbmV4cG9ydCB2YXIgdW56aXAgPSBmdW5jdGlvbiAoYWJzKSB7XG4gICAgdmFyIGZhID0gW2Fic1swXVswXV07XG4gICAgdmFyIGZiID0gW2Fic1swXVsxXV07XG4gICAgZm9yICh2YXIgaSA9IDE7IGkgPCBhYnMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgZmFbaV0gPSBhYnNbaV1bMF07XG4gICAgICAgIGZiW2ldID0gYWJzW2ldWzFdO1xuICAgIH1cbiAgICByZXR1cm4gW2ZhLCBmYl07XG59O1xuLyoqXG4gKiBQcmVwZW5kIGFuIGVsZW1lbnQgdG8gZXZlcnkgbWVtYmVyIG9mIGFuIGFycmF5XG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IHByZXBlbmRBbGwgfSBmcm9tICdmcC10cy9Ob25FbXB0eUFycmF5J1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwocHJlcGVuZEFsbCg5KShbMSwgMiwgMywgNF0pLCBbOSwgMSwgOSwgMiwgOSwgMywgOSwgNF0pXG4gKlxuICogQHNpbmNlIDIuMTAuMFxuICovXG5leHBvcnQgdmFyIHByZXBlbmRBbGwgPSBmdW5jdGlvbiAobWlkZGxlKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykge1xuICAgICAgICB2YXIgb3V0ID0gW21pZGRsZSwgYXNbMF1dO1xuICAgICAgICBmb3IgKHZhciBpID0gMTsgaSA8IGFzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICBvdXQucHVzaChtaWRkbGUsIGFzW2ldKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gb3V0O1xuICAgIH07XG59O1xuLyoqXG4gKiBQbGFjZXMgYW4gZWxlbWVudCBpbiBiZXR3ZWVuIG1lbWJlcnMgb2YgYW4gYXJyYXlcbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgaW50ZXJzcGVyc2UgfSBmcm9tICdmcC10cy9Ob25FbXB0eUFycmF5J1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoaW50ZXJzcGVyc2UoOSkoWzEsIDIsIDMsIDRdKSwgWzEsIDksIDIsIDksIDMsIDksIDRdKVxuICpcbiAqIEBzaW5jZSAyLjkuMFxuICovXG5leHBvcnQgdmFyIGludGVyc3BlcnNlID0gZnVuY3Rpb24gKG1pZGRsZSkge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgdmFyIHJlc3QgPSB0YWlsKGFzKTtcbiAgICAgICAgcmV0dXJuIGlzTm9uRW1wdHkocmVzdCkgPyBwaXBlKHJlc3QsIHByZXBlbmRBbGwobWlkZGxlKSwgcHJlcGVuZChoZWFkKGFzKSkpIDogY29weShhcyk7XG4gICAgfTtcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBmb2xkaW5nXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciBmb2xkTWFwV2l0aEluZGV4ID0gUk5FQS5mb2xkTWFwV2l0aEluZGV4O1xuLyoqXG4gKiBAY2F0ZWdvcnkgZm9sZGluZ1xuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgZm9sZE1hcCA9IFJORUEuZm9sZE1hcDtcbi8qKlxuICogQGNhdGVnb3J5IHNlcXVlbmNpbmdcbiAqIEBzaW5jZSAyLjEwLjBcbiAqL1xuZXhwb3J0IHZhciBjaGFpbldpdGhJbmRleCA9IGZ1bmN0aW9uIChmKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykge1xuICAgICAgICB2YXIgb3V0ID0gZnJvbVJlYWRvbmx5Tm9uRW1wdHlBcnJheShmKDAsIGhlYWQoYXMpKSk7XG4gICAgICAgIGZvciAodmFyIGkgPSAxOyBpIDwgYXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIG91dC5wdXNoLmFwcGx5KG91dCwgZihpLCBhc1tpXSkpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBvdXQ7XG4gICAgfTtcbn07XG4vKipcbiAqIEBzaW5jZSAyLjEwLjBcbiAqL1xuZXhwb3J0IHZhciBjaG9wID0gZnVuY3Rpb24gKGYpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIHZhciBfYSA9IGYoYXMpLCBiID0gX2FbMF0sIHJlc3QgPSBfYVsxXTtcbiAgICAgICAgdmFyIG91dCA9IFtiXTtcbiAgICAgICAgdmFyIG5leHQgPSByZXN0O1xuICAgICAgICB3aGlsZSAoaXNOb25FbXB0eShuZXh0KSkge1xuICAgICAgICAgICAgdmFyIF9iID0gZihuZXh0KSwgYl8xID0gX2JbMF0sIHJlc3RfMiA9IF9iWzFdO1xuICAgICAgICAgICAgb3V0LnB1c2goYl8xKTtcbiAgICAgICAgICAgIG5leHQgPSByZXN0XzI7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG91dDtcbiAgICB9O1xufTtcbi8qKlxuICogU3BsaXRzIGEgYE5vbkVtcHR5QXJyYXlgIGludG8gdHdvIHBpZWNlcywgdGhlIGZpcnN0IHBpZWNlIGhhcyBtYXggYG5gIGVsZW1lbnRzLlxuICpcbiAqIEBzaW5jZSAyLjEwLjBcbiAqL1xuZXhwb3J0IHZhciBzcGxpdEF0ID0gZnVuY3Rpb24gKG4pIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIHZhciBtID0gTWF0aC5tYXgoMSwgbik7XG4gICAgICAgIHJldHVybiBtID49IGFzLmxlbmd0aCA/IFtjb3B5KGFzKSwgW11dIDogW3BpcGUoYXMuc2xpY2UoMSwgbSksIHByZXBlbmQoaGVhZChhcykpKSwgYXMuc2xpY2UobSldO1xuICAgIH07XG59O1xuLyoqXG4gKiBAc2luY2UgMi4xMC4wXG4gKi9cbmV4cG9ydCB2YXIgY2h1bmtzT2YgPSBmdW5jdGlvbiAobikgeyByZXR1cm4gY2hvcChzcGxpdEF0KG4pKTsgfTtcbi8qIGlzdGFuYnVsIGlnbm9yZSBuZXh0ICovXG52YXIgX21hcCA9IGZ1bmN0aW9uIChmYSwgZikgeyByZXR1cm4gcGlwZShmYSwgbWFwKGYpKTsgfTtcbi8qIGlzdGFuYnVsIGlnbm9yZSBuZXh0ICovXG52YXIgX21hcFdpdGhJbmRleCA9IGZ1bmN0aW9uIChmYSwgZikgeyByZXR1cm4gcGlwZShmYSwgbWFwV2l0aEluZGV4KGYpKTsgfTtcbi8qIGlzdGFuYnVsIGlnbm9yZSBuZXh0ICovXG52YXIgX2FwID0gZnVuY3Rpb24gKGZhYiwgZmEpIHsgcmV0dXJuIHBpcGUoZmFiLCBhcChmYSkpOyB9O1xuLyogaXN0YW5idWwgaWdub3JlIG5leHQgKi9cbnZhciBfZXh0ZW5kID0gZnVuY3Rpb24gKHdhLCBmKSB7IHJldHVybiBwaXBlKHdhLCBleHRlbmQoZikpOyB9O1xuLyogaXN0YW5idWwgaWdub3JlIG5leHQgKi9cbnZhciBfcmVkdWNlID0gZnVuY3Rpb24gKGZhLCBiLCBmKSB7IHJldHVybiBwaXBlKGZhLCByZWR1Y2UoYiwgZikpOyB9O1xuLyogaXN0YW5idWwgaWdub3JlIG5leHQgKi9cbnZhciBfZm9sZE1hcCA9IGZ1bmN0aW9uIChNKSB7XG4gICAgdmFyIGZvbGRNYXBNID0gZm9sZE1hcChNKTtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGZhLCBmKSB7IHJldHVybiBwaXBlKGZhLCBmb2xkTWFwTShmKSk7IH07XG59O1xuLyogaXN0YW5idWwgaWdub3JlIG5leHQgKi9cbnZhciBfcmVkdWNlUmlnaHQgPSBmdW5jdGlvbiAoZmEsIGIsIGYpIHsgcmV0dXJuIHBpcGUoZmEsIHJlZHVjZVJpZ2h0KGIsIGYpKTsgfTtcbi8qIGlzdGFuYnVsIGlnbm9yZSBuZXh0ICovXG52YXIgX3RyYXZlcnNlID0gZnVuY3Rpb24gKEYpIHtcbiAgICB2YXIgdHJhdmVyc2VGID0gdHJhdmVyc2UoRik7XG4gICAgcmV0dXJuIGZ1bmN0aW9uICh0YSwgZikgeyByZXR1cm4gcGlwZSh0YSwgdHJhdmVyc2VGKGYpKTsgfTtcbn07XG4vKiBpc3RhbmJ1bCBpZ25vcmUgbmV4dCAqL1xudmFyIF9hbHQgPSBmdW5jdGlvbiAoZmEsIHRoYXQpIHsgcmV0dXJuIHBpcGUoZmEsIGFsdCh0aGF0KSk7IH07XG4vKiBpc3RhbmJ1bCBpZ25vcmUgbmV4dCAqL1xudmFyIF9yZWR1Y2VXaXRoSW5kZXggPSBmdW5jdGlvbiAoZmEsIGIsIGYpIHtcbiAgICByZXR1cm4gcGlwZShmYSwgcmVkdWNlV2l0aEluZGV4KGIsIGYpKTtcbn07XG4vKiBpc3RhbmJ1bCBpZ25vcmUgbmV4dCAqL1xudmFyIF9mb2xkTWFwV2l0aEluZGV4ID0gZnVuY3Rpb24gKE0pIHtcbiAgICB2YXIgZm9sZE1hcFdpdGhJbmRleE0gPSBmb2xkTWFwV2l0aEluZGV4KE0pO1xuICAgIHJldHVybiBmdW5jdGlvbiAoZmEsIGYpIHsgcmV0dXJuIHBpcGUoZmEsIGZvbGRNYXBXaXRoSW5kZXhNKGYpKTsgfTtcbn07XG4vKiBpc3RhbmJ1bCBpZ25vcmUgbmV4dCAqL1xudmFyIF9yZWR1Y2VSaWdodFdpdGhJbmRleCA9IGZ1bmN0aW9uIChmYSwgYiwgZikge1xuICAgIHJldHVybiBwaXBlKGZhLCByZWR1Y2VSaWdodFdpdGhJbmRleChiLCBmKSk7XG59O1xuLyogaXN0YW5idWwgaWdub3JlIG5leHQgKi9cbnZhciBfdHJhdmVyc2VXaXRoSW5kZXggPSBmdW5jdGlvbiAoRikge1xuICAgIHZhciB0cmF2ZXJzZVdpdGhJbmRleEYgPSB0cmF2ZXJzZVdpdGhJbmRleChGKTtcbiAgICByZXR1cm4gZnVuY3Rpb24gKHRhLCBmKSB7IHJldHVybiBwaXBlKHRhLCB0cmF2ZXJzZVdpdGhJbmRleEYoZikpOyB9O1xufTtcbi8qKlxuICogTGVzcyBzdHJpY3QgdmVyc2lvbiBvZiBbYGFsdGBdKCNhbHQpLlxuICpcbiAqIFRoZSBgV2Agc3VmZml4IChzaG9ydCBmb3IgKipXKippZGVuaW5nKSBtZWFucyB0aGF0IHRoZSByZXR1cm4gdHlwZXMgd2lsbCBiZSBtZXJnZWQuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCAqIGFzIE5FQSBmcm9tICdmcC10cy9Ob25FbXB0eUFycmF5J1xuICogaW1wb3J0IHsgcGlwZSB9IGZyb20gJ2ZwLXRzL2Z1bmN0aW9uJ1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoXG4gKiAgIHBpcGUoXG4gKiAgICAgWzEsIDIsIDNdIGFzIE5FQS5Ob25FbXB0eUFycmF5PG51bWJlcj4sXG4gKiAgICAgTkVBLmFsdFcoKCkgPT4gWydhJywgJ2InXSlcbiAqICAgKSxcbiAqICAgWzEsIDIsIDMsICdhJywgJ2InXVxuICogKVxuICpcbiAqIEBjYXRlZ29yeSBlcnJvciBoYW5kbGluZ1xuICogQHNpbmNlIDIuOS4wXG4gKi9cbmV4cG9ydCB2YXIgYWx0VyA9IGZ1bmN0aW9uICh0aGF0KSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykge1xuICAgICAgICByZXR1cm4gcGlwZShhcywgY29uY2F0Vyh0aGF0KCkpKTtcbiAgICB9O1xufTtcbi8qKlxuICogSWRlbnRpZmllcyBhbiBhc3NvY2lhdGl2ZSBvcGVyYXRpb24gb24gYSB0eXBlIGNvbnN0cnVjdG9yLiBJdCBpcyBzaW1pbGFyIHRvIGBTZW1pZ3JvdXBgLCBleGNlcHQgdGhhdCBpdCBhcHBsaWVzIHRvXG4gKiB0eXBlcyBvZiBraW5kIGAqIC0+ICpgLlxuICpcbiAqIEluIGNhc2Ugb2YgYE5vbkVtcHR5QXJyYXlgIGNvbmNhdGVuYXRlcyB0aGUgaW5wdXRzIGludG8gYSBzaW5nbGUgYXJyYXkuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCAqIGFzIE5FQSBmcm9tICdmcC10cy9Ob25FbXB0eUFycmF5J1xuICogaW1wb3J0IHsgcGlwZSB9IGZyb20gJ2ZwLXRzL2Z1bmN0aW9uJ1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoXG4gKiAgIHBpcGUoXG4gKiAgICAgWzEsIDIsIDNdLFxuICogICAgIE5FQS5hbHQoKCkgPT4gWzQsIDVdKVxuICogICApLFxuICogICBbMSwgMiwgMywgNCwgNV1cbiAqIClcbiAqXG4gKiBAY2F0ZWdvcnkgZXJyb3IgaGFuZGxpbmdcbiAqIEBzaW5jZSAyLjYuMlxuICovXG5leHBvcnQgdmFyIGFsdCA9IGFsdFc7XG4vKipcbiAqIEFwcGx5IGEgZnVuY3Rpb24gdG8gYW4gYXJndW1lbnQgdW5kZXIgYSB0eXBlIGNvbnN0cnVjdG9yLlxuICpcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIGFwID0gZnVuY3Rpb24gKGFzKSB7XG4gICAgcmV0dXJuIGZsYXRNYXAoZnVuY3Rpb24gKGYpIHsgcmV0dXJuIHBpcGUoYXMsIG1hcChmKSk7IH0pO1xufTtcbi8qKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCAqIGFzIE5FQSBmcm9tICdmcC10cy9Ob25FbXB0eUFycmF5J1xuICogaW1wb3J0IHsgcGlwZSB9IGZyb20gJ2ZwLXRzL2Z1bmN0aW9uJ1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoXG4gKiAgIHBpcGUoXG4gKiAgICAgWzEsIDIsIDNdLFxuICogICAgIE5FQS5mbGF0TWFwKChuKSA9PiBbYGEke259YCwgYGIke259YF0pXG4gKiAgICksXG4gKiAgIFsnYTEnLCAnYjEnLCAnYTInLCAnYjInLCAnYTMnLCAnYjMnXVxuICogKVxuICpcbiAqIEBjYXRlZ29yeSBzZXF1ZW5jaW5nXG4gKiBAc2luY2UgMi4xNC4wXG4gKi9cbmV4cG9ydCB2YXIgZmxhdE1hcCA9IC8qI19fUFVSRV9fKi8gZHVhbCgyLCBmdW5jdGlvbiAobWEsIGYpIHtcbiAgICByZXR1cm4gcGlwZShtYSwgY2hhaW5XaXRoSW5kZXgoZnVuY3Rpb24gKGksIGEpIHsgcmV0dXJuIGYoYSwgaSk7IH0pKTtcbn0pO1xuLyoqXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciBleHRlbmQgPSBmdW5jdGlvbiAoZikge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgdmFyIG5leHQgPSB0YWlsKGFzKTtcbiAgICAgICAgdmFyIG91dCA9IFtmKGFzKV07XG4gICAgICAgIHdoaWxlIChpc05vbkVtcHR5KG5leHQpKSB7XG4gICAgICAgICAgICBvdXQucHVzaChmKG5leHQpKTtcbiAgICAgICAgICAgIG5leHQgPSB0YWlsKG5leHQpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBvdXQ7XG4gICAgfTtcbn07XG4vKipcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIGR1cGxpY2F0ZSA9IC8qI19fUFVSRV9fKi8gZXh0ZW5kKGlkZW50aXR5KTtcbi8qKlxuICogQGNhdGVnb3J5IHNlcXVlbmNpbmdcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIGZsYXR0ZW4gPSAvKiNfX1BVUkVfXyovIGZsYXRNYXAoaWRlbnRpdHkpO1xuLyoqXG4gKiBgbWFwYCBjYW4gYmUgdXNlZCB0byB0dXJuIGZ1bmN0aW9ucyBgKGE6IEEpID0+IEJgIGludG8gZnVuY3Rpb25zIGAoZmE6IEY8QT4pID0+IEY8Qj5gIHdob3NlIGFyZ3VtZW50IGFuZCByZXR1cm4gdHlwZXNcbiAqIHVzZSB0aGUgdHlwZSBjb25zdHJ1Y3RvciBgRmAgdG8gcmVwcmVzZW50IHNvbWUgY29tcHV0YXRpb25hbCBjb250ZXh0LlxuICpcbiAqIEBjYXRlZ29yeSBtYXBwaW5nXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciBtYXAgPSBmdW5jdGlvbiAoZikgeyByZXR1cm4gbWFwV2l0aEluZGV4KGZ1bmN0aW9uIChfLCBhKSB7IHJldHVybiBmKGEpOyB9KTsgfTtcbi8qKlxuICogQGNhdGVnb3J5IG1hcHBpbmdcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIG1hcFdpdGhJbmRleCA9IGZ1bmN0aW9uIChmKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykge1xuICAgICAgICB2YXIgb3V0ID0gW2YoMCwgaGVhZChhcykpXTtcbiAgICAgICAgZm9yICh2YXIgaSA9IDE7IGkgPCBhcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgb3V0LnB1c2goZihpLCBhc1tpXSkpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBvdXQ7XG4gICAgfTtcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBmb2xkaW5nXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciByZWR1Y2UgPSBSTkVBLnJlZHVjZTtcbi8qKlxuICogQGNhdGVnb3J5IGZvbGRpbmdcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIHJlZHVjZVdpdGhJbmRleCA9IFJORUEucmVkdWNlV2l0aEluZGV4O1xuLyoqXG4gKiBAY2F0ZWdvcnkgZm9sZGluZ1xuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgcmVkdWNlUmlnaHQgPSBSTkVBLnJlZHVjZVJpZ2h0O1xuLyoqXG4gKiBAY2F0ZWdvcnkgZm9sZGluZ1xuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgcmVkdWNlUmlnaHRXaXRoSW5kZXggPSBSTkVBLnJlZHVjZVJpZ2h0V2l0aEluZGV4O1xuLyoqXG4gKiBAY2F0ZWdvcnkgdHJhdmVyc2luZ1xuICogQHNpbmNlIDIuNi4zXG4gKi9cbmV4cG9ydCB2YXIgdHJhdmVyc2UgPSBmdW5jdGlvbiAoRikge1xuICAgIHZhciB0cmF2ZXJzZVdpdGhJbmRleEYgPSB0cmF2ZXJzZVdpdGhJbmRleChGKTtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGYpIHsgcmV0dXJuIHRyYXZlcnNlV2l0aEluZGV4RihmdW5jdGlvbiAoXywgYSkgeyByZXR1cm4gZihhKTsgfSk7IH07XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgdHJhdmVyc2luZ1xuICogQHNpbmNlIDIuNi4zXG4gKi9cbmV4cG9ydCB2YXIgc2VxdWVuY2UgPSBmdW5jdGlvbiAoRikgeyByZXR1cm4gdHJhdmVyc2VXaXRoSW5kZXgoRikoZnVuY3Rpb24gKF8sIGEpIHsgcmV0dXJuIGE7IH0pOyB9O1xuLyoqXG4gKiBAY2F0ZWdvcnkgc2VxdWVuY2luZ1xuICogQHNpbmNlIDIuNi4zXG4gKi9cbmV4cG9ydCB2YXIgdHJhdmVyc2VXaXRoSW5kZXggPSBmdW5jdGlvbiAoRikge1xuICAgIHJldHVybiBmdW5jdGlvbiAoZikge1xuICAgICAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgICAgICB2YXIgb3V0ID0gRi5tYXAoZigwLCBoZWFkKGFzKSksIG9mKTtcbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAxOyBpIDwgYXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICBvdXQgPSBGLmFwKEYubWFwKG91dCwgZnVuY3Rpb24gKGJzKSB7IHJldHVybiBmdW5jdGlvbiAoYikgeyByZXR1cm4gcGlwZShicywgYXBwZW5kKGIpKTsgfTsgfSksIGYoaSwgYXNbaV0pKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBvdXQ7XG4gICAgICAgIH07XG4gICAgfTtcbn07XG4vKipcbiAqIEBzaW5jZSAyLjcuMFxuICovXG5leHBvcnQgdmFyIGV4dHJhY3QgPSBSTkVBLmhlYWQ7XG4vKipcbiAqIEBjYXRlZ29yeSB0eXBlIGxhbWJkYXNcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIFVSSSA9ICdOb25FbXB0eUFycmF5Jztcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgZ2V0U2hvdyA9IFJORUEuZ2V0U2hvdztcbi8qKlxuICogQnVpbGRzIGEgYFNlbWlncm91cGAgaW5zdGFuY2UgZm9yIGBOb25FbXB0eUFycmF5YFxuICpcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIGdldFNlbWlncm91cCA9IGZ1bmN0aW9uICgpIHsgcmV0dXJuICh7XG4gICAgY29uY2F0OiBjb25jYXRcbn0pOyB9O1xuLyoqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgZ2V0RXEgfSBmcm9tICdmcC10cy9Ob25FbXB0eUFycmF5J1xuICogaW1wb3J0ICogYXMgTiBmcm9tICdmcC10cy9udW1iZXInXG4gKlxuICogY29uc3QgRSA9IGdldEVxKE4uRXEpXG4gKiBhc3NlcnQuc3RyaWN0RXF1YWwoRS5lcXVhbHMoWzEsIDJdLCBbMSwgMl0pLCB0cnVlKVxuICogYXNzZXJ0LnN0cmljdEVxdWFsKEUuZXF1YWxzKFsxLCAyXSwgWzEsIDNdKSwgZmFsc2UpXG4gKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgZ2V0RXEgPSBSTkVBLmdldEVxO1xuLyoqXG4gKiBAc2luY2UgMi4xMS4wXG4gKi9cbmV4cG9ydCB2YXIgZ2V0VW5pb25TZW1pZ3JvdXAgPSBmdW5jdGlvbiAoRSkge1xuICAgIHZhciB1bmlvbkUgPSB1bmlvbihFKTtcbiAgICByZXR1cm4ge1xuICAgICAgICBjb25jYXQ6IGZ1bmN0aW9uIChmaXJzdCwgc2Vjb25kKSB7IHJldHVybiB1bmlvbkUoc2Vjb25kKShmaXJzdCk7IH1cbiAgICB9O1xufTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuNy4wXG4gKi9cbmV4cG9ydCB2YXIgRnVuY3RvciA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICBtYXA6IF9tYXBcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBtYXBwaW5nXG4gKiBAc2luY2UgMi4xMC4wXG4gKi9cbmV4cG9ydCB2YXIgZmxhcCA9IC8qI19fUFVSRV9fKi8gZmxhcF8oRnVuY3Rvcik7XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjEwLjBcbiAqL1xuZXhwb3J0IHZhciBQb2ludGVkID0ge1xuICAgIFVSSTogVVJJLFxuICAgIG9mOiBvZlxufTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuNy4wXG4gKi9cbmV4cG9ydCB2YXIgRnVuY3RvcldpdGhJbmRleCA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICBtYXA6IF9tYXAsXG4gICAgbWFwV2l0aEluZGV4OiBfbWFwV2l0aEluZGV4XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi4xMC4wXG4gKi9cbmV4cG9ydCB2YXIgQXBwbHkgPSB7XG4gICAgVVJJOiBVUkksXG4gICAgbWFwOiBfbWFwLFxuICAgIGFwOiBfYXBcbn07XG4vKipcbiAqIENvbWJpbmUgdHdvIGVmZmVjdGZ1bCBhY3Rpb25zLCBrZWVwaW5nIG9ubHkgdGhlIHJlc3VsdCBvZiB0aGUgZmlyc3QuXG4gKlxuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgYXBGaXJzdCA9IC8qI19fUFVSRV9fKi8gYXBGaXJzdF8oQXBwbHkpO1xuLyoqXG4gKiBDb21iaW5lIHR3byBlZmZlY3RmdWwgYWN0aW9ucywga2VlcGluZyBvbmx5IHRoZSByZXN1bHQgb2YgdGhlIHNlY29uZC5cbiAqXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBhcFNlY29uZCA9IC8qI19fUFVSRV9fKi8gYXBTZWNvbmRfKEFwcGx5KTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuNy4wXG4gKi9cbmV4cG9ydCB2YXIgQXBwbGljYXRpdmUgPSB7XG4gICAgVVJJOiBVUkksXG4gICAgbWFwOiBfbWFwLFxuICAgIGFwOiBfYXAsXG4gICAgb2Y6IG9mXG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi4xMC4wXG4gKi9cbmV4cG9ydCB2YXIgQ2hhaW4gPSB7XG4gICAgVVJJOiBVUkksXG4gICAgbWFwOiBfbWFwLFxuICAgIGFwOiBfYXAsXG4gICAgY2hhaW46IGZsYXRNYXBcbn07XG4vKipcbiAqIENvbXBvc2VzIGNvbXB1dGF0aW9ucyBpbiBzZXF1ZW5jZSwgdXNpbmcgdGhlIHJldHVybiB2YWx1ZSBvZiBvbmUgY29tcHV0YXRpb24gdG8gZGV0ZXJtaW5lIHRoZSBuZXh0IGNvbXB1dGF0aW9uIGFuZFxuICoga2VlcGluZyBvbmx5IHRoZSByZXN1bHQgb2YgdGhlIGZpcnN0LlxuICpcbiAqIEBjYXRlZ29yeSBzZXF1ZW5jaW5nXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBjaGFpbkZpcnN0ID0gXG4vKiNfX1BVUkVfXyovIGNoYWluRmlyc3RfKENoYWluKTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuNy4wXG4gKi9cbmV4cG9ydCB2YXIgTW9uYWQgPSB7XG4gICAgVVJJOiBVUkksXG4gICAgbWFwOiBfbWFwLFxuICAgIGFwOiBfYXAsXG4gICAgb2Y6IG9mLFxuICAgIGNoYWluOiBmbGF0TWFwXG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi43LjBcbiAqL1xuZXhwb3J0IHZhciBGb2xkYWJsZSA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICByZWR1Y2U6IF9yZWR1Y2UsXG4gICAgZm9sZE1hcDogX2ZvbGRNYXAsXG4gICAgcmVkdWNlUmlnaHQ6IF9yZWR1Y2VSaWdodFxufTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuNy4wXG4gKi9cbmV4cG9ydCB2YXIgRm9sZGFibGVXaXRoSW5kZXggPSB7XG4gICAgVVJJOiBVUkksXG4gICAgcmVkdWNlOiBfcmVkdWNlLFxuICAgIGZvbGRNYXA6IF9mb2xkTWFwLFxuICAgIHJlZHVjZVJpZ2h0OiBfcmVkdWNlUmlnaHQsXG4gICAgcmVkdWNlV2l0aEluZGV4OiBfcmVkdWNlV2l0aEluZGV4LFxuICAgIGZvbGRNYXBXaXRoSW5kZXg6IF9mb2xkTWFwV2l0aEluZGV4LFxuICAgIHJlZHVjZVJpZ2h0V2l0aEluZGV4OiBfcmVkdWNlUmlnaHRXaXRoSW5kZXhcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjcuMFxuICovXG5leHBvcnQgdmFyIFRyYXZlcnNhYmxlID0ge1xuICAgIFVSSTogVVJJLFxuICAgIG1hcDogX21hcCxcbiAgICByZWR1Y2U6IF9yZWR1Y2UsXG4gICAgZm9sZE1hcDogX2ZvbGRNYXAsXG4gICAgcmVkdWNlUmlnaHQ6IF9yZWR1Y2VSaWdodCxcbiAgICB0cmF2ZXJzZTogX3RyYXZlcnNlLFxuICAgIHNlcXVlbmNlOiBzZXF1ZW5jZVxufTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuNy4wXG4gKi9cbmV4cG9ydCB2YXIgVHJhdmVyc2FibGVXaXRoSW5kZXggPSB7XG4gICAgVVJJOiBVUkksXG4gICAgbWFwOiBfbWFwLFxuICAgIG1hcFdpdGhJbmRleDogX21hcFdpdGhJbmRleCxcbiAgICByZWR1Y2U6IF9yZWR1Y2UsXG4gICAgZm9sZE1hcDogX2ZvbGRNYXAsXG4gICAgcmVkdWNlUmlnaHQ6IF9yZWR1Y2VSaWdodCxcbiAgICB0cmF2ZXJzZTogX3RyYXZlcnNlLFxuICAgIHNlcXVlbmNlOiBzZXF1ZW5jZSxcbiAgICByZWR1Y2VXaXRoSW5kZXg6IF9yZWR1Y2VXaXRoSW5kZXgsXG4gICAgZm9sZE1hcFdpdGhJbmRleDogX2ZvbGRNYXBXaXRoSW5kZXgsXG4gICAgcmVkdWNlUmlnaHRXaXRoSW5kZXg6IF9yZWR1Y2VSaWdodFdpdGhJbmRleCxcbiAgICB0cmF2ZXJzZVdpdGhJbmRleDogX3RyYXZlcnNlV2l0aEluZGV4XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi43LjBcbiAqL1xuZXhwb3J0IHZhciBBbHQgPSB7XG4gICAgVVJJOiBVUkksXG4gICAgbWFwOiBfbWFwLFxuICAgIGFsdDogX2FsdFxufTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuNy4wXG4gKi9cbmV4cG9ydCB2YXIgQ29tb25hZCA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICBtYXA6IF9tYXAsXG4gICAgZXh0ZW5kOiBfZXh0ZW5kLFxuICAgIGV4dHJhY3Q6IGV4dHJhY3Rcbn07XG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vLyBkbyBub3RhdGlvblxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLyoqXG4gKiBAY2F0ZWdvcnkgZG8gbm90YXRpb25cbiAqIEBzaW5jZSAyLjkuMFxuICovXG5leHBvcnQgdmFyIERvID0gLyojX19QVVJFX18qLyBvZihfLmVtcHR5UmVjb3JkKTtcbi8qKlxuICogQGNhdGVnb3J5IGRvIG5vdGF0aW9uXG4gKiBAc2luY2UgMi44LjBcbiAqL1xuZXhwb3J0IHZhciBiaW5kVG8gPSAvKiNfX1BVUkVfXyovIGJpbmRUb18oRnVuY3Rvcik7XG52YXIgbGV0XyA9IC8qI19fUFVSRV9fKi8gbGV0X18oRnVuY3Rvcik7XG5leHBvcnQgeyBcbi8qKlxuICogQGNhdGVnb3J5IGRvIG5vdGF0aW9uXG4gKiBAc2luY2UgMi4xMy4wXG4gKi9cbmxldF8gYXMgbGV0IH07XG4vKipcbiAqIEBjYXRlZ29yeSBkbyBub3RhdGlvblxuICogQHNpbmNlIDIuOC4wXG4gKi9cbmV4cG9ydCB2YXIgYmluZCA9IC8qI19fUFVSRV9fKi8gYmluZF8oQ2hhaW4pO1xuLyoqXG4gKiBAY2F0ZWdvcnkgZG8gbm90YXRpb25cbiAqIEBzaW5jZSAyLjguMFxuICovXG5leHBvcnQgdmFyIGFwUyA9IC8qI19fUFVSRV9fKi8gYXBTXyhBcHBseSk7XG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vLyB1dGlsc1xuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLyoqXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciBoZWFkID0gUk5FQS5oZWFkO1xuLyoqXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciB0YWlsID0gZnVuY3Rpb24gKGFzKSB7IHJldHVybiBhcy5zbGljZSgxKTsgfTtcbi8qKlxuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgbGFzdCA9IFJORUEubGFzdDtcbi8qKlxuICogR2V0IGFsbCBidXQgdGhlIGxhc3QgZWxlbWVudCBvZiBhIG5vbiBlbXB0eSBhcnJheSwgY3JlYXRpbmcgYSBuZXcgYXJyYXkuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IGluaXQgfSBmcm9tICdmcC10cy9Ob25FbXB0eUFycmF5J1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoaW5pdChbMSwgMiwgM10pLCBbMSwgMl0pXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKGluaXQoWzFdKSwgW10pXG4gKlxuICogQHNpbmNlIDIuMi4wXG4gKi9cbmV4cG9ydCB2YXIgaW5pdCA9IGZ1bmN0aW9uIChhcykgeyByZXR1cm4gYXMuc2xpY2UoMCwgLTEpOyB9O1xuLyoqXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciBtaW4gPSBSTkVBLm1pbjtcbi8qKlxuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgbWF4ID0gUk5FQS5tYXg7XG4vKipcbiAqIEBzaW5jZSAyLjEwLjBcbiAqL1xuZXhwb3J0IHZhciBjb25jYXRBbGwgPSBmdW5jdGlvbiAoUykge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgcmV0dXJuIGFzLnJlZHVjZShTLmNvbmNhdCk7XG4gICAgfTtcbn07XG4vKipcbiAqIEJyZWFrIGFuIGBBcnJheWAgaW50byBpdHMgZmlyc3QgZWxlbWVudCBhbmQgcmVtYWluaW5nIGVsZW1lbnRzLlxuICpcbiAqIEBjYXRlZ29yeSBwYXR0ZXJuIG1hdGNoaW5nXG4gKiBAc2luY2UgMi4xMS4wXG4gKi9cbmV4cG9ydCB2YXIgbWF0Y2hMZWZ0ID0gZnVuY3Rpb24gKGYpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIHJldHVybiBmKGhlYWQoYXMpLCB0YWlsKGFzKSk7XG4gICAgfTtcbn07XG4vKipcbiAqIEJyZWFrIGFuIGBBcnJheWAgaW50byBpdHMgaW5pdGlhbCBlbGVtZW50cyBhbmQgdGhlIGxhc3QgZWxlbWVudC5cbiAqXG4gKiBAY2F0ZWdvcnkgcGF0dGVybiBtYXRjaGluZ1xuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIG1hdGNoUmlnaHQgPSBmdW5jdGlvbiAoZikge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgcmV0dXJuIGYoaW5pdChhcyksIGxhc3QoYXMpKTtcbiAgICB9O1xufTtcbi8qKlxuICogQXBwbHkgYSBmdW5jdGlvbiB0byB0aGUgaGVhZCwgY3JlYXRpbmcgYSBuZXcgYE5vbkVtcHR5QXJyYXlgLlxuICpcbiAqIEBzaW5jZSAyLjExLjBcbiAqL1xuZXhwb3J0IHZhciBtb2RpZnlIZWFkID0gZnVuY3Rpb24gKGYpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIHJldHVybiBfX3NwcmVhZEFycmF5KFtmKGhlYWQoYXMpKV0sIHRhaWwoYXMpLCB0cnVlKTtcbiAgICB9O1xufTtcbi8qKlxuICogQ2hhbmdlIHRoZSBoZWFkLCBjcmVhdGluZyBhIG5ldyBgTm9uRW1wdHlBcnJheWAuXG4gKlxuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIHVwZGF0ZUhlYWQgPSBmdW5jdGlvbiAoYSkgeyByZXR1cm4gbW9kaWZ5SGVhZChmdW5jdGlvbiAoKSB7IHJldHVybiBhOyB9KTsgfTtcbi8qKlxuICogQXBwbHkgYSBmdW5jdGlvbiB0byB0aGUgbGFzdCBlbGVtZW50LCBjcmVhdGluZyBhIG5ldyBgTm9uRW1wdHlBcnJheWAuXG4gKlxuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIG1vZGlmeUxhc3QgPSBmdW5jdGlvbiAoZikge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgcmV0dXJuIHBpcGUoaW5pdChhcyksIGFwcGVuZChmKGxhc3QoYXMpKSkpO1xuICAgIH07XG59O1xuLyoqXG4gKiBDaGFuZ2UgdGhlIGxhc3QgZWxlbWVudCwgY3JlYXRpbmcgYSBuZXcgYE5vbkVtcHR5QXJyYXlgLlxuICpcbiAqIEBzaW5jZSAyLjExLjBcbiAqL1xuZXhwb3J0IHZhciB1cGRhdGVMYXN0ID0gZnVuY3Rpb24gKGEpIHsgcmV0dXJuIG1vZGlmeUxhc3QoZnVuY3Rpb24gKCkgeyByZXR1cm4gYTsgfSk7IH07XG4vKipcbiAqIFBsYWNlcyBhbiBlbGVtZW50IGluIGJldHdlZW4gbWVtYmVycyBvZiBhIGBOb25FbXB0eUFycmF5YCwgdGhlbiBmb2xkcyB0aGUgcmVzdWx0cyB1c2luZyB0aGUgcHJvdmlkZWQgYFNlbWlncm91cGAuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCAqIGFzIFMgZnJvbSAnZnAtdHMvc3RyaW5nJ1xuICogaW1wb3J0IHsgaW50ZXJjYWxhdGUgfSBmcm9tICdmcC10cy9Ob25FbXB0eUFycmF5J1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoaW50ZXJjYWxhdGUoUy5TZW1pZ3JvdXApKCctJykoWydhJywgJ2InLCAnYyddKSwgJ2EtYi1jJylcbiAqXG4gKiBAc2luY2UgMi4xMi4wXG4gKi9cbmV4cG9ydCB2YXIgaW50ZXJjYWxhdGUgPSBSTkVBLmludGVyY2FsYXRlO1xuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLy8gbGVnYWN5XG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vKipcbiAqIEFsaWFzIG9mIGBmbGF0TWFwYC5cbiAqXG4gKiBAY2F0ZWdvcnkgbGVnYWN5XG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciBjaGFpbiA9IGZsYXRNYXA7XG5leHBvcnQgZnVuY3Rpb24gZ3JvdXBTb3J0KE8pIHtcbiAgICB2YXIgc29ydE8gPSBzb3J0KE8pO1xuICAgIHZhciBncm91cE8gPSBncm91cChPKTtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7IHJldHVybiAoaXNOb25FbXB0eShhcykgPyBncm91cE8oc29ydE8oYXMpKSA6IFtdKTsgfTtcbn1cbmV4cG9ydCBmdW5jdGlvbiBmaWx0ZXIocHJlZGljYXRlKSB7XG4gICAgcmV0dXJuIGZpbHRlcldpdGhJbmRleChmdW5jdGlvbiAoXywgYSkgeyByZXR1cm4gcHJlZGljYXRlKGEpOyB9KTtcbn1cbi8qKlxuICogVXNlIFtgZmlsdGVyV2l0aEluZGV4YF0oLi9BcnJheS50cy5odG1sI2ZpbHRlcndpdGhpbmRleCkgaW5zdGVhZC5cbiAqXG4gKiBAY2F0ZWdvcnkgem9uZSBvZiBkZWF0aFxuICogQHNpbmNlIDIuMC4wXG4gKiBAZGVwcmVjYXRlZFxuICovXG5leHBvcnQgdmFyIGZpbHRlcldpdGhJbmRleCA9IGZ1bmN0aW9uIChwcmVkaWNhdGUpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIHJldHVybiBmcm9tQXJyYXkoYXMuZmlsdGVyKGZ1bmN0aW9uIChhLCBpKSB7IHJldHVybiBwcmVkaWNhdGUoaSwgYSk7IH0pKTtcbiAgICB9O1xufTtcbi8qKlxuICogVXNlIFtgdW5wcmVwZW5kYF0oI3VucHJlcGVuZCkgaW5zdGVhZC5cbiAqXG4gKiBAY2F0ZWdvcnkgem9uZSBvZiBkZWF0aFxuICogQHNpbmNlIDIuOS4wXG4gKiBAZGVwcmVjYXRlZFxuICovXG5leHBvcnQgdmFyIHVuY29ucyA9IHVucHJlcGVuZDtcbi8qKlxuICogVXNlIFtgdW5hcHBlbmRgXSgjdW5hcHBlbmQpIGluc3RlYWQuXG4gKlxuICogQGNhdGVnb3J5IHpvbmUgb2YgZGVhdGhcbiAqIEBzaW5jZSAyLjkuMFxuICogQGRlcHJlY2F0ZWRcbiAqL1xuZXhwb3J0IHZhciB1bnNub2MgPSB1bmFwcGVuZDtcbmV4cG9ydCBmdW5jdGlvbiBjb25zKGhlYWQsIHRhaWwpIHtcbiAgICByZXR1cm4gdGFpbCA9PT0gdW5kZWZpbmVkID8gcHJlcGVuZChoZWFkKSA6IHBpcGUodGFpbCwgcHJlcGVuZChoZWFkKSk7XG59XG4vKipcbiAqIFVzZSBbYGFwcGVuZGBdKC4vQXJyYXkudHMuaHRtbCNhcHBlbmQpIGluc3RlYWQuXG4gKlxuICogQGNhdGVnb3J5IHpvbmUgb2YgZGVhdGhcbiAqIEBzaW5jZSAyLjAuMFxuICogQGRlcHJlY2F0ZWRcbiAqL1xuZXhwb3J0IHZhciBzbm9jID0gZnVuY3Rpb24gKGluaXQsIGVuZCkgeyByZXR1cm4gcGlwZShpbml0LCBhcHBlbmQoZW5kKSk7IH07XG4vKipcbiAqIFVzZSBbYHByZXBlbmRBbGxgXSgjcHJlcGVuZGFsbCkgaW5zdGVhZC5cbiAqXG4gKiBAY2F0ZWdvcnkgem9uZSBvZiBkZWF0aFxuICogQHNpbmNlIDIuOS4wXG4gKiBAZGVwcmVjYXRlZFxuICovXG5leHBvcnQgdmFyIHByZXBlbmRUb0FsbCA9IHByZXBlbmRBbGw7XG4vKipcbiAqIFVzZSBbYGNvbmNhdEFsbGBdKCNjb25jYXRhbGwpIGluc3RlYWQuXG4gKlxuICogQGNhdGVnb3J5IHpvbmUgb2YgZGVhdGhcbiAqIEBzaW5jZSAyLjUuMFxuICogQGRlcHJlY2F0ZWRcbiAqL1xuZXhwb3J0IHZhciBmb2xkID0gUk5FQS5jb25jYXRBbGw7XG4vKipcbiAqIFRoaXMgaW5zdGFuY2UgaXMgZGVwcmVjYXRlZCwgdXNlIHNtYWxsLCBzcGVjaWZpYyBpbnN0YW5jZXMgaW5zdGVhZC5cbiAqIEZvciBleGFtcGxlIGlmIGEgZnVuY3Rpb24gbmVlZHMgYSBgRnVuY3RvcmAgaW5zdGFuY2UsIHBhc3MgYE5FQS5GdW5jdG9yYCBpbnN0ZWFkIG9mIGBORUEubm9uRW1wdHlBcnJheWBcbiAqICh3aGVyZSBgTkVBYCBpcyBmcm9tIGBpbXBvcnQgTkVBIGZyb20gJ2ZwLXRzL05vbkVtcHR5QXJyYXknYClcbiAqXG4gKiBAY2F0ZWdvcnkgem9uZSBvZiBkZWF0aFxuICogQHNpbmNlIDIuMC4wXG4gKiBAZGVwcmVjYXRlZFxuICovXG5leHBvcnQgdmFyIG5vbkVtcHR5QXJyYXkgPSB7XG4gICAgVVJJOiBVUkksXG4gICAgb2Y6IG9mLFxuICAgIG1hcDogX21hcCxcbiAgICBtYXBXaXRoSW5kZXg6IF9tYXBXaXRoSW5kZXgsXG4gICAgYXA6IF9hcCxcbiAgICBjaGFpbjogZmxhdE1hcCxcbiAgICBleHRlbmQ6IF9leHRlbmQsXG4gICAgZXh0cmFjdDogZXh0cmFjdCxcbiAgICByZWR1Y2U6IF9yZWR1Y2UsXG4gICAgZm9sZE1hcDogX2ZvbGRNYXAsXG4gICAgcmVkdWNlUmlnaHQ6IF9yZWR1Y2VSaWdodCxcbiAgICB0cmF2ZXJzZTogX3RyYXZlcnNlLFxuICAgIHNlcXVlbmNlOiBzZXF1ZW5jZSxcbiAgICByZWR1Y2VXaXRoSW5kZXg6IF9yZWR1Y2VXaXRoSW5kZXgsXG4gICAgZm9sZE1hcFdpdGhJbmRleDogX2ZvbGRNYXBXaXRoSW5kZXgsXG4gICAgcmVkdWNlUmlnaHRXaXRoSW5kZXg6IF9yZWR1Y2VSaWdodFdpdGhJbmRleCxcbiAgICB0cmF2ZXJzZVdpdGhJbmRleDogX3RyYXZlcnNlV2l0aEluZGV4LFxuICAgIGFsdDogX2FsdFxufTtcbiIsCiAgInZhciBfX3NwcmVhZEFycmF5ID0gKHRoaXMgJiYgdGhpcy5fX3NwcmVhZEFycmF5KSB8fCBmdW5jdGlvbiAodG8sIGZyb20sIHBhY2spIHtcbiAgICBpZiAocGFjayB8fCBhcmd1bWVudHMubGVuZ3RoID09PSAyKSBmb3IgKHZhciBpID0gMCwgbCA9IGZyb20ubGVuZ3RoLCBhcjsgaSA8IGw7IGkrKykge1xuICAgICAgICBpZiAoYXIgfHwgIShpIGluIGZyb20pKSB7XG4gICAgICAgICAgICBpZiAoIWFyKSBhciA9IEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGZyb20sIDAsIGkpO1xuICAgICAgICAgICAgYXJbaV0gPSBmcm9tW2ldO1xuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiB0by5jb25jYXQoYXIgfHwgQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoZnJvbSkpO1xufTtcbmltcG9ydCB7IGFwRmlyc3QgYXMgYXBGaXJzdF8sIGFwUyBhcyBhcFNfLCBhcFNlY29uZCBhcyBhcFNlY29uZF8gfSBmcm9tICcuL0FwcGx5JztcbmltcG9ydCB7IGJpbmQgYXMgYmluZF8sIGNoYWluRmlyc3QgYXMgY2hhaW5GaXJzdF8gfSBmcm9tICcuL0NoYWluJztcbmltcG9ydCB7IGR1YWwsIGlkZW50aXR5LCBwaXBlIH0gZnJvbSAnLi9mdW5jdGlvbic7XG5pbXBvcnQgeyBiaW5kVG8gYXMgYmluZFRvXywgZmxhcCBhcyBmbGFwXywgbGV0IGFzIGxldF9fIH0gZnJvbSAnLi9GdW5jdG9yJztcbmltcG9ydCAqIGFzIF8gZnJvbSAnLi9pbnRlcm5hbCc7XG5pbXBvcnQgeyBnZXRNb25vaWQgfSBmcm9tICcuL09yZCc7XG5pbXBvcnQgKiBhcyBSTkVBIGZyb20gJy4vUmVhZG9ubHlOb25FbXB0eUFycmF5Jztcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8vIGludGVybmFsXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vKipcbiAqIEBpbnRlcm5hbFxuICovXG5leHBvcnQgdmFyIGlzTm9uRW1wdHkgPSBmdW5jdGlvbiAoYXMpIHsgcmV0dXJuIGFzLmxlbmd0aCA+IDA7IH07XG4vKipcbiAqIEBpbnRlcm5hbFxuICovXG5leHBvcnQgdmFyIGlzT3V0T2ZCb3VuZCA9IGZ1bmN0aW9uIChpLCBhcykgeyByZXR1cm4gaSA8IDAgfHwgaSA+PSBhcy5sZW5ndGg7IH07XG4vKipcbiAqIEBpbnRlcm5hbFxuICovXG5leHBvcnQgdmFyIHByZXBlbmRXID0gZnVuY3Rpb24gKGhlYWQpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKHRhaWwpIHtcbiAgICAgICAgcmV0dXJuIF9fc3ByZWFkQXJyYXkoW2hlYWRdLCB0YWlsLCB0cnVlKTtcbiAgICB9O1xufTtcbi8qKlxuICogQGludGVybmFsXG4gKi9cbmV4cG9ydCB2YXIgcHJlcGVuZCA9IHByZXBlbmRXO1xuLyoqXG4gKiBAaW50ZXJuYWxcbiAqL1xuZXhwb3J0IHZhciBhcHBlbmRXID0gZnVuY3Rpb24gKGVuZCkge1xuICAgIHJldHVybiBmdW5jdGlvbiAoaW5pdCkge1xuICAgICAgICByZXR1cm4gX19zcHJlYWRBcnJheShfX3NwcmVhZEFycmF5KFtdLCBpbml0LCB0cnVlKSwgW2VuZF0sIGZhbHNlKTtcbiAgICB9O1xufTtcbi8qKlxuICogQGludGVybmFsXG4gKi9cbmV4cG9ydCB2YXIgYXBwZW5kID0gYXBwZW5kVztcbi8qKlxuICogQGludGVybmFsXG4gKi9cbmV4cG9ydCB2YXIgdW5zYWZlSW5zZXJ0QXQgPSBmdW5jdGlvbiAoaSwgYSwgYXMpIHtcbiAgICBpZiAoaXNOb25FbXB0eShhcykpIHtcbiAgICAgICAgdmFyIHhzID0gZnJvbVJlYWRvbmx5Tm9uRW1wdHlBcnJheShhcyk7XG4gICAgICAgIHhzLnNwbGljZShpLCAwLCBhKTtcbiAgICAgICAgcmV0dXJuIHhzO1xuICAgIH1cbiAgICByZXR1cm4gW2FdO1xufTtcbi8qKlxuICogQGludGVybmFsXG4gKi9cbmV4cG9ydCB2YXIgdW5zYWZlVXBkYXRlQXQgPSBmdW5jdGlvbiAoaSwgYSwgYXMpIHtcbiAgICB2YXIgeHMgPSBmcm9tUmVhZG9ubHlOb25FbXB0eUFycmF5KGFzKTtcbiAgICB4c1tpXSA9IGE7XG4gICAgcmV0dXJuIHhzO1xufTtcbi8qKlxuICogUmVtb3ZlIGR1cGxpY2F0ZXMgZnJvbSBhIGBOb25FbXB0eUFycmF5YCwga2VlcGluZyB0aGUgZmlyc3Qgb2NjdXJyZW5jZSBvZiBhbiBlbGVtZW50LlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyB1bmlxIH0gZnJvbSAnZnAtdHMvTm9uRW1wdHlBcnJheSdcbiAqIGltcG9ydCAqIGFzIE4gZnJvbSAnZnAtdHMvbnVtYmVyJ1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwodW5pcShOLkVxKShbMSwgMiwgMV0pLCBbMSwgMl0pXG4gKlxuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIHVuaXEgPSBmdW5jdGlvbiAoRSkge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgaWYgKGFzLmxlbmd0aCA9PT0gMSkge1xuICAgICAgICAgICAgcmV0dXJuIGNvcHkoYXMpO1xuICAgICAgICB9XG4gICAgICAgIHZhciBvdXQgPSBbaGVhZChhcyldO1xuICAgICAgICB2YXIgcmVzdCA9IHRhaWwoYXMpO1xuICAgICAgICB2YXIgX2xvb3BfMSA9IGZ1bmN0aW9uIChhKSB7XG4gICAgICAgICAgICBpZiAob3V0LmV2ZXJ5KGZ1bmN0aW9uIChvKSB7IHJldHVybiAhRS5lcXVhbHMobywgYSk7IH0pKSB7XG4gICAgICAgICAgICAgICAgb3V0LnB1c2goYSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIGZvciAodmFyIF9pID0gMCwgcmVzdF8xID0gcmVzdDsgX2kgPCByZXN0XzEubGVuZ3RoOyBfaSsrKSB7XG4gICAgICAgICAgICB2YXIgYSA9IHJlc3RfMVtfaV07XG4gICAgICAgICAgICBfbG9vcF8xKGEpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBvdXQ7XG4gICAgfTtcbn07XG4vKipcbiAqIFNvcnQgdGhlIGVsZW1lbnRzIG9mIGEgYE5vbkVtcHR5QXJyYXlgIGluIGluY3JlYXNpbmcgb3JkZXIsIHdoZXJlIGVsZW1lbnRzIGFyZSBjb21wYXJlZCB1c2luZyBmaXJzdCBgb3Jkc1swXWAsIHRoZW4gYG9yZHNbMV1gLFxuICogZXRjLi4uXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCAqIGFzIE5FQSBmcm9tICdmcC10cy9Ob25FbXB0eUFycmF5J1xuICogaW1wb3J0IHsgY29udHJhbWFwIH0gZnJvbSAnZnAtdHMvT3JkJ1xuICogaW1wb3J0ICogYXMgUyBmcm9tICdmcC10cy9zdHJpbmcnXG4gKiBpbXBvcnQgKiBhcyBOIGZyb20gJ2ZwLXRzL251bWJlcidcbiAqIGltcG9ydCB7IHBpcGUgfSBmcm9tICdmcC10cy9mdW5jdGlvbidcbiAqXG4gKiBpbnRlcmZhY2UgUGVyc29uIHtcbiAqICAgbmFtZTogc3RyaW5nXG4gKiAgIGFnZTogbnVtYmVyXG4gKiB9XG4gKlxuICogY29uc3QgYnlOYW1lID0gcGlwZShTLk9yZCwgY29udHJhbWFwKChwOiBQZXJzb24pID0+IHAubmFtZSkpXG4gKlxuICogY29uc3QgYnlBZ2UgPSBwaXBlKE4uT3JkLCBjb250cmFtYXAoKHA6IFBlcnNvbikgPT4gcC5hZ2UpKVxuICpcbiAqIGNvbnN0IHNvcnRCeU5hbWVCeUFnZSA9IE5FQS5zb3J0QnkoW2J5TmFtZSwgYnlBZ2VdKVxuICpcbiAqIGNvbnN0IHBlcnNvbnM6IE5FQS5Ob25FbXB0eUFycmF5PFBlcnNvbj4gPSBbXG4gKiAgIHsgbmFtZTogJ2EnLCBhZ2U6IDEgfSxcbiAqICAgeyBuYW1lOiAnYicsIGFnZTogMyB9LFxuICogICB7IG5hbWU6ICdjJywgYWdlOiAyIH0sXG4gKiAgIHsgbmFtZTogJ2InLCBhZ2U6IDIgfVxuICogXVxuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoc29ydEJ5TmFtZUJ5QWdlKHBlcnNvbnMpLCBbXG4gKiAgIHsgbmFtZTogJ2EnLCBhZ2U6IDEgfSxcbiAqICAgeyBuYW1lOiAnYicsIGFnZTogMiB9LFxuICogICB7IG5hbWU6ICdiJywgYWdlOiAzIH0sXG4gKiAgIHsgbmFtZTogJ2MnLCBhZ2U6IDIgfVxuICogXSlcbiAqXG4gKiBAc2luY2UgMi4xMS4wXG4gKi9cbmV4cG9ydCB2YXIgc29ydEJ5ID0gZnVuY3Rpb24gKG9yZHMpIHtcbiAgICBpZiAoaXNOb25FbXB0eShvcmRzKSkge1xuICAgICAgICB2YXIgTSA9IGdldE1vbm9pZCgpO1xuICAgICAgICByZXR1cm4gc29ydChvcmRzLnJlZHVjZShNLmNvbmNhdCwgTS5lbXB0eSkpO1xuICAgIH1cbiAgICByZXR1cm4gY29weTtcbn07XG4vKipcbiAqIEBzaW5jZSAyLjExLjBcbiAqL1xuZXhwb3J0IHZhciB1bmlvbiA9IGZ1bmN0aW9uIChFKSB7XG4gICAgdmFyIHVuaXFFID0gdW5pcShFKTtcbiAgICByZXR1cm4gZnVuY3Rpb24gKHNlY29uZCkgeyByZXR1cm4gZnVuY3Rpb24gKGZpcnN0KSB7IHJldHVybiB1bmlxRShwaXBlKGZpcnN0LCBjb25jYXQoc2Vjb25kKSkpOyB9OyB9O1xufTtcbi8qKlxuICogUm90YXRlIGEgYE5vbkVtcHR5QXJyYXlgIGJ5IGBuYCBzdGVwcy5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgcm90YXRlIH0gZnJvbSAnZnAtdHMvTm9uRW1wdHlBcnJheSdcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKHJvdGF0ZSgyKShbMSwgMiwgMywgNCwgNV0pLCBbNCwgNSwgMSwgMiwgM10pXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKHJvdGF0ZSgtMikoWzEsIDIsIDMsIDQsIDVdKSwgWzMsIDQsIDUsIDEsIDJdKVxuICpcbiAqIEBzaW5jZSAyLjExLjBcbiAqL1xuZXhwb3J0IHZhciByb3RhdGUgPSBmdW5jdGlvbiAobikge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgdmFyIGxlbiA9IGFzLmxlbmd0aDtcbiAgICAgICAgdmFyIG0gPSBNYXRoLnJvdW5kKG4pICUgbGVuO1xuICAgICAgICBpZiAoaXNPdXRPZkJvdW5kKE1hdGguYWJzKG0pLCBhcykgfHwgbSA9PT0gMCkge1xuICAgICAgICAgICAgcmV0dXJuIGNvcHkoYXMpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChtIDwgMCkge1xuICAgICAgICAgICAgdmFyIF9hID0gc3BsaXRBdCgtbSkoYXMpLCBmID0gX2FbMF0sIHMgPSBfYVsxXTtcbiAgICAgICAgICAgIHJldHVybiBwaXBlKHMsIGNvbmNhdChmKSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gcm90YXRlKG0gLSBsZW4pKGFzKTtcbiAgICAgICAgfVxuICAgIH07XG59O1xuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLy8gY29uc3RydWN0b3JzXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vKipcbiAqIEBjYXRlZ29yeSBjb252ZXJzaW9uc1xuICogQHNpbmNlIDIuMTAuMFxuICovXG5leHBvcnQgdmFyIGZyb21SZWFkb25seU5vbkVtcHR5QXJyYXkgPSBfLmZyb21SZWFkb25seU5vbkVtcHR5QXJyYXk7XG4vKipcbiAqIEJ1aWxkcyBhIGBOb25FbXB0eUFycmF5YCBmcm9tIGFuIGBBcnJheWAgcmV0dXJuaW5nIGBub25lYCBpZiBgYXNgIGlzIGFuIGVtcHR5IGFycmF5XG4gKlxuICogQGNhdGVnb3J5IGNvbnZlcnNpb25zXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciBmcm9tQXJyYXkgPSBmdW5jdGlvbiAoYXMpIHsgcmV0dXJuIChpc05vbkVtcHR5KGFzKSA/IF8uc29tZShhcykgOiBfLm5vbmUpOyB9O1xuLyoqXG4gKiBSZXR1cm4gYSBgTm9uRW1wdHlBcnJheWAgb2YgbGVuZ3RoIGBuYCB3aXRoIGVsZW1lbnQgYGlgIGluaXRpYWxpemVkIHdpdGggYGYoaSlgLlxuICpcbiAqICoqTm90ZSoqLiBgbmAgaXMgbm9ybWFsaXplZCB0byBhIG5hdHVyYWwgbnVtYmVyLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBtYWtlQnkgfSBmcm9tICdmcC10cy9Ob25FbXB0eUFycmF5J1xuICogaW1wb3J0IHsgcGlwZSB9IGZyb20gJ2ZwLXRzL2Z1bmN0aW9uJ1xuICpcbiAqIGNvbnN0IGRvdWJsZSA9IChuOiBudW1iZXIpOiBudW1iZXIgPT4gbiAqIDJcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwocGlwZSg1LCBtYWtlQnkoZG91YmxlKSksIFswLCAyLCA0LCA2LCA4XSlcbiAqXG4gKiBAY2F0ZWdvcnkgY29uc3RydWN0b3JzXG4gKiBAc2luY2UgMi4xMS4wXG4gKi9cbmV4cG9ydCB2YXIgbWFrZUJ5ID0gZnVuY3Rpb24gKGYpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKG4pIHtcbiAgICAgICAgdmFyIGogPSBNYXRoLm1heCgwLCBNYXRoLmZsb29yKG4pKTtcbiAgICAgICAgdmFyIG91dCA9IFtmKDApXTtcbiAgICAgICAgZm9yICh2YXIgaSA9IDE7IGkgPCBqOyBpKyspIHtcbiAgICAgICAgICAgIG91dC5wdXNoKGYoaSkpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBvdXQ7XG4gICAgfTtcbn07XG4vKipcbiAqIENyZWF0ZSBhIGBOb25FbXB0eUFycmF5YCBjb250YWluaW5nIGEgdmFsdWUgcmVwZWF0ZWQgdGhlIHNwZWNpZmllZCBudW1iZXIgb2YgdGltZXMuXG4gKlxuICogKipOb3RlKiouIGBuYCBpcyBub3JtYWxpemVkIHRvIGEgbmF0dXJhbCBudW1iZXIuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IHJlcGxpY2F0ZSB9IGZyb20gJ2ZwLXRzL05vbkVtcHR5QXJyYXknXG4gKiBpbXBvcnQgeyBwaXBlIH0gZnJvbSAnZnAtdHMvZnVuY3Rpb24nXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChwaXBlKDMsIHJlcGxpY2F0ZSgnYScpKSwgWydhJywgJ2EnLCAnYSddKVxuICpcbiAqIEBjYXRlZ29yeSBjb25zdHJ1Y3RvcnNcbiAqIEBzaW5jZSAyLjExLjBcbiAqL1xuZXhwb3J0IHZhciByZXBsaWNhdGUgPSBmdW5jdGlvbiAoYSkgeyByZXR1cm4gbWFrZUJ5KGZ1bmN0aW9uICgpIHsgcmV0dXJuIGE7IH0pOyB9O1xuLyoqXG4gKiBDcmVhdGUgYSBgTm9uRW1wdHlBcnJheWAgY29udGFpbmluZyBhIHJhbmdlIG9mIGludGVnZXJzLCBpbmNsdWRpbmcgYm90aCBlbmRwb2ludHMuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IHJhbmdlIH0gZnJvbSAnZnAtdHMvTm9uRW1wdHlBcnJheSdcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKHJhbmdlKDEsIDUpLCBbMSwgMiwgMywgNCwgNV0pXG4gKlxuICogQGNhdGVnb3J5IGNvbnN0cnVjdG9yc1xuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIHJhbmdlID0gZnVuY3Rpb24gKHN0YXJ0LCBlbmQpIHtcbiAgICByZXR1cm4gc3RhcnQgPD0gZW5kID8gbWFrZUJ5KGZ1bmN0aW9uIChpKSB7IHJldHVybiBzdGFydCArIGk7IH0pKGVuZCAtIHN0YXJ0ICsgMSkgOiBbc3RhcnRdO1xufTtcbi8qKlxuICogUmV0dXJuIHRoZSB0dXBsZSBvZiB0aGUgYGhlYWRgIGFuZCB0aGUgYHRhaWxgLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyB1bnByZXBlbmQgfSBmcm9tICdmcC10cy9Ob25FbXB0eUFycmF5J1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwodW5wcmVwZW5kKFsxLCAyLCAzXSksIFsxLCBbMiwgM11dKVxuICpcbiAqIEBzaW5jZSAyLjkuMFxuICovXG5leHBvcnQgdmFyIHVucHJlcGVuZCA9IGZ1bmN0aW9uIChhcykgeyByZXR1cm4gW2hlYWQoYXMpLCB0YWlsKGFzKV07IH07XG4vKipcbiAqIFJldHVybiB0aGUgdHVwbGUgb2YgdGhlIGBpbml0YCBhbmQgdGhlIGBsYXN0YC5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgdW5hcHBlbmQgfSBmcm9tICdmcC10cy9Ob25FbXB0eUFycmF5J1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwodW5hcHBlbmQoWzEsIDIsIDMsIDRdKSwgW1sxLCAyLCAzXSwgNF0pXG4gKlxuICogQHNpbmNlIDIuOS4wXG4gKi9cbmV4cG9ydCB2YXIgdW5hcHBlbmQgPSBmdW5jdGlvbiAoYXMpIHsgcmV0dXJuIFtpbml0KGFzKSwgbGFzdChhcyldOyB9O1xuZXhwb3J0IGZ1bmN0aW9uIGNvbmNhdFcoc2Vjb25kKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChmaXJzdCkgeyByZXR1cm4gZmlyc3QuY29uY2F0KHNlY29uZCk7IH07XG59XG5leHBvcnQgZnVuY3Rpb24gY29uY2F0KHgsIHkpIHtcbiAgICByZXR1cm4geSA/IHguY29uY2F0KHkpIDogZnVuY3Rpb24gKHkpIHsgcmV0dXJuIHkuY29uY2F0KHgpOyB9O1xufVxuLyoqXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciByZXZlcnNlID0gZnVuY3Rpb24gKGFzKSB7IHJldHVybiBfX3NwcmVhZEFycmF5KFtsYXN0KGFzKV0sIGFzLnNsaWNlKDAsIC0xKS5yZXZlcnNlKCksIHRydWUpOyB9O1xuZXhwb3J0IGZ1bmN0aW9uIGdyb3VwKEUpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIHZhciBsZW4gPSBhcy5sZW5ndGg7XG4gICAgICAgIGlmIChsZW4gPT09IDApIHtcbiAgICAgICAgICAgIHJldHVybiBbXTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgb3V0ID0gW107XG4gICAgICAgIHZhciBoZWFkID0gYXNbMF07XG4gICAgICAgIHZhciBuZWEgPSBbaGVhZF07XG4gICAgICAgIGZvciAodmFyIGkgPSAxOyBpIDwgbGVuOyBpKyspIHtcbiAgICAgICAgICAgIHZhciBhID0gYXNbaV07XG4gICAgICAgICAgICBpZiAoRS5lcXVhbHMoYSwgaGVhZCkpIHtcbiAgICAgICAgICAgICAgICBuZWEucHVzaChhKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIG91dC5wdXNoKG5lYSk7XG4gICAgICAgICAgICAgICAgaGVhZCA9IGE7XG4gICAgICAgICAgICAgICAgbmVhID0gW2hlYWRdO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIG91dC5wdXNoKG5lYSk7XG4gICAgICAgIHJldHVybiBvdXQ7XG4gICAgfTtcbn1cbi8qKlxuICogU3BsaXRzIGFuIGFycmF5IGludG8gc3ViLW5vbi1lbXB0eS1hcnJheXMgc3RvcmVkIGluIGFuIG9iamVjdCwgYmFzZWQgb24gdGhlIHJlc3VsdCBvZiBjYWxsaW5nIGEgYHN0cmluZ2AtcmV0dXJuaW5nXG4gKiBmdW5jdGlvbiBvbiBlYWNoIGVsZW1lbnQsIGFuZCBncm91cGluZyB0aGUgcmVzdWx0cyBhY2NvcmRpbmcgdG8gdmFsdWVzIHJldHVybmVkXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IGdyb3VwQnkgfSBmcm9tICdmcC10cy9Ob25FbXB0eUFycmF5J1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoZ3JvdXBCeSgoczogc3RyaW5nKSA9PiBTdHJpbmcocy5sZW5ndGgpKShbJ2EnLCAnYicsICdhYiddKSwge1xuICogICAnMSc6IFsnYScsICdiJ10sXG4gKiAgICcyJzogWydhYiddXG4gKiB9KVxuICpcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIGdyb3VwQnkgPSBmdW5jdGlvbiAoZikge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgdmFyIG91dCA9IHt9O1xuICAgICAgICBmb3IgKHZhciBfaSA9IDAsIGFzXzEgPSBhczsgX2kgPCBhc18xLmxlbmd0aDsgX2krKykge1xuICAgICAgICAgICAgdmFyIGEgPSBhc18xW19pXTtcbiAgICAgICAgICAgIHZhciBrID0gZihhKTtcbiAgICAgICAgICAgIGlmIChfLmhhcy5jYWxsKG91dCwgaykpIHtcbiAgICAgICAgICAgICAgICBvdXRba10ucHVzaChhKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIG91dFtrXSA9IFthXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gb3V0O1xuICAgIH07XG59O1xuLyoqXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciBzb3J0ID0gZnVuY3Rpb24gKE8pIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIHJldHVybiBhcy5zbGljZSgpLnNvcnQoTy5jb21wYXJlKTtcbiAgICB9O1xufTtcbi8qKlxuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgaW5zZXJ0QXQgPSBmdW5jdGlvbiAoaSwgYSkge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgcmV0dXJuIGkgPCAwIHx8IGkgPiBhcy5sZW5ndGggPyBfLm5vbmUgOiBfLnNvbWUodW5zYWZlSW5zZXJ0QXQoaSwgYSwgYXMpKTtcbiAgICB9O1xufTtcbi8qKlxuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgdXBkYXRlQXQgPSBmdW5jdGlvbiAoaSwgYSkge1xuICAgIHJldHVybiBtb2RpZnlBdChpLCBmdW5jdGlvbiAoKSB7IHJldHVybiBhOyB9KTtcbn07XG4vKipcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIG1vZGlmeUF0ID0gZnVuY3Rpb24gKGksIGYpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIHJldHVybiBpc091dE9mQm91bmQoaSwgYXMpID8gXy5ub25lIDogXy5zb21lKHVuc2FmZVVwZGF0ZUF0KGksIGYoYXNbaV0pLCBhcykpO1xuICAgIH07XG59O1xuLyoqXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciBjb3B5ID0gZnJvbVJlYWRvbmx5Tm9uRW1wdHlBcnJheTtcbi8qKlxuICogQGNhdGVnb3J5IGNvbnN0cnVjdG9yc1xuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgb2YgPSBmdW5jdGlvbiAoYSkgeyByZXR1cm4gW2FdOyB9O1xuLyoqXG4gKiBAc2luY2UgMi41LjFcbiAqL1xuZXhwb3J0IHZhciB6aXBXaXRoID0gZnVuY3Rpb24gKGFzLCBicywgZikge1xuICAgIHZhciBjcyA9IFtmKGFzWzBdLCBic1swXSldO1xuICAgIHZhciBsZW4gPSBNYXRoLm1pbihhcy5sZW5ndGgsIGJzLmxlbmd0aCk7XG4gICAgZm9yICh2YXIgaSA9IDE7IGkgPCBsZW47IGkrKykge1xuICAgICAgICBjc1tpXSA9IGYoYXNbaV0sIGJzW2ldKTtcbiAgICB9XG4gICAgcmV0dXJuIGNzO1xufTtcbmV4cG9ydCBmdW5jdGlvbiB6aXAoYXMsIGJzKSB7XG4gICAgaWYgKGJzID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIChicykgeyByZXR1cm4gemlwKGJzLCBhcyk7IH07XG4gICAgfVxuICAgIHJldHVybiB6aXBXaXRoKGFzLCBicywgZnVuY3Rpb24gKGEsIGIpIHsgcmV0dXJuIFthLCBiXTsgfSk7XG59XG4vKipcbiAqIEBzaW5jZSAyLjUuMVxuICovXG5leHBvcnQgdmFyIHVuemlwID0gZnVuY3Rpb24gKGFicykge1xuICAgIHZhciBmYSA9IFthYnNbMF1bMF1dO1xuICAgIHZhciBmYiA9IFthYnNbMF1bMV1dO1xuICAgIGZvciAodmFyIGkgPSAxOyBpIDwgYWJzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIGZhW2ldID0gYWJzW2ldWzBdO1xuICAgICAgICBmYltpXSA9IGFic1tpXVsxXTtcbiAgICB9XG4gICAgcmV0dXJuIFtmYSwgZmJdO1xufTtcbi8qKlxuICogUHJlcGVuZCBhbiBlbGVtZW50IHRvIGV2ZXJ5IG1lbWJlciBvZiBhbiBhcnJheVxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBwcmVwZW5kQWxsIH0gZnJvbSAnZnAtdHMvTm9uRW1wdHlBcnJheSdcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKHByZXBlbmRBbGwoOSkoWzEsIDIsIDMsIDRdKSwgWzksIDEsIDksIDIsIDksIDMsIDksIDRdKVxuICpcbiAqIEBzaW5jZSAyLjEwLjBcbiAqL1xuZXhwb3J0IHZhciBwcmVwZW5kQWxsID0gZnVuY3Rpb24gKG1pZGRsZSkge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgdmFyIG91dCA9IFttaWRkbGUsIGFzWzBdXTtcbiAgICAgICAgZm9yICh2YXIgaSA9IDE7IGkgPCBhcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgb3V0LnB1c2gobWlkZGxlLCBhc1tpXSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG91dDtcbiAgICB9O1xufTtcbi8qKlxuICogUGxhY2VzIGFuIGVsZW1lbnQgaW4gYmV0d2VlbiBtZW1iZXJzIG9mIGFuIGFycmF5XG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IGludGVyc3BlcnNlIH0gZnJvbSAnZnAtdHMvTm9uRW1wdHlBcnJheSdcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKGludGVyc3BlcnNlKDkpKFsxLCAyLCAzLCA0XSksIFsxLCA5LCAyLCA5LCAzLCA5LCA0XSlcbiAqXG4gKiBAc2luY2UgMi45LjBcbiAqL1xuZXhwb3J0IHZhciBpbnRlcnNwZXJzZSA9IGZ1bmN0aW9uIChtaWRkbGUpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIHZhciByZXN0ID0gdGFpbChhcyk7XG4gICAgICAgIHJldHVybiBpc05vbkVtcHR5KHJlc3QpID8gcGlwZShyZXN0LCBwcmVwZW5kQWxsKG1pZGRsZSksIHByZXBlbmQoaGVhZChhcykpKSA6IGNvcHkoYXMpO1xuICAgIH07XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgZm9sZGluZ1xuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgZm9sZE1hcFdpdGhJbmRleCA9IFJORUEuZm9sZE1hcFdpdGhJbmRleDtcbi8qKlxuICogQGNhdGVnb3J5IGZvbGRpbmdcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIGZvbGRNYXAgPSBSTkVBLmZvbGRNYXA7XG4vKipcbiAqIEBjYXRlZ29yeSBzZXF1ZW5jaW5nXG4gKiBAc2luY2UgMi4xMC4wXG4gKi9cbmV4cG9ydCB2YXIgY2hhaW5XaXRoSW5kZXggPSBmdW5jdGlvbiAoZikge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgdmFyIG91dCA9IGZyb21SZWFkb25seU5vbkVtcHR5QXJyYXkoZigwLCBoZWFkKGFzKSkpO1xuICAgICAgICBmb3IgKHZhciBpID0gMTsgaSA8IGFzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICBvdXQucHVzaC5hcHBseShvdXQsIGYoaSwgYXNbaV0pKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gb3V0O1xuICAgIH07XG59O1xuLyoqXG4gKiBAc2luY2UgMi4xMC4wXG4gKi9cbmV4cG9ydCB2YXIgY2hvcCA9IGZ1bmN0aW9uIChmKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykge1xuICAgICAgICB2YXIgX2EgPSBmKGFzKSwgYiA9IF9hWzBdLCByZXN0ID0gX2FbMV07XG4gICAgICAgIHZhciBvdXQgPSBbYl07XG4gICAgICAgIHZhciBuZXh0ID0gcmVzdDtcbiAgICAgICAgd2hpbGUgKGlzTm9uRW1wdHkobmV4dCkpIHtcbiAgICAgICAgICAgIHZhciBfYiA9IGYobmV4dCksIGJfMSA9IF9iWzBdLCByZXN0XzIgPSBfYlsxXTtcbiAgICAgICAgICAgIG91dC5wdXNoKGJfMSk7XG4gICAgICAgICAgICBuZXh0ID0gcmVzdF8yO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBvdXQ7XG4gICAgfTtcbn07XG4vKipcbiAqIFNwbGl0cyBhIGBOb25FbXB0eUFycmF5YCBpbnRvIHR3byBwaWVjZXMsIHRoZSBmaXJzdCBwaWVjZSBoYXMgbWF4IGBuYCBlbGVtZW50cy5cbiAqXG4gKiBAc2luY2UgMi4xMC4wXG4gKi9cbmV4cG9ydCB2YXIgc3BsaXRBdCA9IGZ1bmN0aW9uIChuKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykge1xuICAgICAgICB2YXIgbSA9IE1hdGgubWF4KDEsIG4pO1xuICAgICAgICByZXR1cm4gbSA+PSBhcy5sZW5ndGggPyBbY29weShhcyksIFtdXSA6IFtwaXBlKGFzLnNsaWNlKDEsIG0pLCBwcmVwZW5kKGhlYWQoYXMpKSksIGFzLnNsaWNlKG0pXTtcbiAgICB9O1xufTtcbi8qKlxuICogQHNpbmNlIDIuMTAuMFxuICovXG5leHBvcnQgdmFyIGNodW5rc09mID0gZnVuY3Rpb24gKG4pIHsgcmV0dXJuIGNob3Aoc3BsaXRBdChuKSk7IH07XG4vKiBpc3RhbmJ1bCBpZ25vcmUgbmV4dCAqL1xudmFyIF9tYXAgPSBmdW5jdGlvbiAoZmEsIGYpIHsgcmV0dXJuIHBpcGUoZmEsIG1hcChmKSk7IH07XG4vKiBpc3RhbmJ1bCBpZ25vcmUgbmV4dCAqL1xudmFyIF9tYXBXaXRoSW5kZXggPSBmdW5jdGlvbiAoZmEsIGYpIHsgcmV0dXJuIHBpcGUoZmEsIG1hcFdpdGhJbmRleChmKSk7IH07XG4vKiBpc3RhbmJ1bCBpZ25vcmUgbmV4dCAqL1xudmFyIF9hcCA9IGZ1bmN0aW9uIChmYWIsIGZhKSB7IHJldHVybiBwaXBlKGZhYiwgYXAoZmEpKTsgfTtcbi8qIGlzdGFuYnVsIGlnbm9yZSBuZXh0ICovXG52YXIgX2V4dGVuZCA9IGZ1bmN0aW9uICh3YSwgZikgeyByZXR1cm4gcGlwZSh3YSwgZXh0ZW5kKGYpKTsgfTtcbi8qIGlzdGFuYnVsIGlnbm9yZSBuZXh0ICovXG52YXIgX3JlZHVjZSA9IGZ1bmN0aW9uIChmYSwgYiwgZikgeyByZXR1cm4gcGlwZShmYSwgcmVkdWNlKGIsIGYpKTsgfTtcbi8qIGlzdGFuYnVsIGlnbm9yZSBuZXh0ICovXG52YXIgX2ZvbGRNYXAgPSBmdW5jdGlvbiAoTSkge1xuICAgIHZhciBmb2xkTWFwTSA9IGZvbGRNYXAoTSk7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChmYSwgZikgeyByZXR1cm4gcGlwZShmYSwgZm9sZE1hcE0oZikpOyB9O1xufTtcbi8qIGlzdGFuYnVsIGlnbm9yZSBuZXh0ICovXG52YXIgX3JlZHVjZVJpZ2h0ID0gZnVuY3Rpb24gKGZhLCBiLCBmKSB7IHJldHVybiBwaXBlKGZhLCByZWR1Y2VSaWdodChiLCBmKSk7IH07XG4vKiBpc3RhbmJ1bCBpZ25vcmUgbmV4dCAqL1xudmFyIF90cmF2ZXJzZSA9IGZ1bmN0aW9uIChGKSB7XG4gICAgdmFyIHRyYXZlcnNlRiA9IHRyYXZlcnNlKEYpO1xuICAgIHJldHVybiBmdW5jdGlvbiAodGEsIGYpIHsgcmV0dXJuIHBpcGUodGEsIHRyYXZlcnNlRihmKSk7IH07XG59O1xuLyogaXN0YW5idWwgaWdub3JlIG5leHQgKi9cbnZhciBfYWx0ID0gZnVuY3Rpb24gKGZhLCB0aGF0KSB7IHJldHVybiBwaXBlKGZhLCBhbHQodGhhdCkpOyB9O1xuLyogaXN0YW5idWwgaWdub3JlIG5leHQgKi9cbnZhciBfcmVkdWNlV2l0aEluZGV4ID0gZnVuY3Rpb24gKGZhLCBiLCBmKSB7XG4gICAgcmV0dXJuIHBpcGUoZmEsIHJlZHVjZVdpdGhJbmRleChiLCBmKSk7XG59O1xuLyogaXN0YW5idWwgaWdub3JlIG5leHQgKi9cbnZhciBfZm9sZE1hcFdpdGhJbmRleCA9IGZ1bmN0aW9uIChNKSB7XG4gICAgdmFyIGZvbGRNYXBXaXRoSW5kZXhNID0gZm9sZE1hcFdpdGhJbmRleChNKTtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGZhLCBmKSB7IHJldHVybiBwaXBlKGZhLCBmb2xkTWFwV2l0aEluZGV4TShmKSk7IH07XG59O1xuLyogaXN0YW5idWwgaWdub3JlIG5leHQgKi9cbnZhciBfcmVkdWNlUmlnaHRXaXRoSW5kZXggPSBmdW5jdGlvbiAoZmEsIGIsIGYpIHtcbiAgICByZXR1cm4gcGlwZShmYSwgcmVkdWNlUmlnaHRXaXRoSW5kZXgoYiwgZikpO1xufTtcbi8qIGlzdGFuYnVsIGlnbm9yZSBuZXh0ICovXG52YXIgX3RyYXZlcnNlV2l0aEluZGV4ID0gZnVuY3Rpb24gKEYpIHtcbiAgICB2YXIgdHJhdmVyc2VXaXRoSW5kZXhGID0gdHJhdmVyc2VXaXRoSW5kZXgoRik7XG4gICAgcmV0dXJuIGZ1bmN0aW9uICh0YSwgZikgeyByZXR1cm4gcGlwZSh0YSwgdHJhdmVyc2VXaXRoSW5kZXhGKGYpKTsgfTtcbn07XG4vKipcbiAqIExlc3Mgc3RyaWN0IHZlcnNpb24gb2YgW2BhbHRgXSgjYWx0KS5cbiAqXG4gKiBUaGUgYFdgIHN1ZmZpeCAoc2hvcnQgZm9yICoqVyoqaWRlbmluZykgbWVhbnMgdGhhdCB0aGUgcmV0dXJuIHR5cGVzIHdpbGwgYmUgbWVyZ2VkLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgKiBhcyBORUEgZnJvbSAnZnAtdHMvTm9uRW1wdHlBcnJheSdcbiAqIGltcG9ydCB7IHBpcGUgfSBmcm9tICdmcC10cy9mdW5jdGlvbidcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKFxuICogICBwaXBlKFxuICogICAgIFsxLCAyLCAzXSBhcyBORUEuTm9uRW1wdHlBcnJheTxudW1iZXI+LFxuICogICAgIE5FQS5hbHRXKCgpID0+IFsnYScsICdiJ10pXG4gKiAgICksXG4gKiAgIFsxLCAyLCAzLCAnYScsICdiJ11cbiAqIClcbiAqXG4gKiBAY2F0ZWdvcnkgZXJyb3IgaGFuZGxpbmdcbiAqIEBzaW5jZSAyLjkuMFxuICovXG5leHBvcnQgdmFyIGFsdFcgPSBmdW5jdGlvbiAodGhhdCkge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgcmV0dXJuIHBpcGUoYXMsIGNvbmNhdFcodGhhdCgpKSk7XG4gICAgfTtcbn07XG4vKipcbiAqIElkZW50aWZpZXMgYW4gYXNzb2NpYXRpdmUgb3BlcmF0aW9uIG9uIGEgdHlwZSBjb25zdHJ1Y3Rvci4gSXQgaXMgc2ltaWxhciB0byBgU2VtaWdyb3VwYCwgZXhjZXB0IHRoYXQgaXQgYXBwbGllcyB0b1xuICogdHlwZXMgb2Yga2luZCBgKiAtPiAqYC5cbiAqXG4gKiBJbiBjYXNlIG9mIGBOb25FbXB0eUFycmF5YCBjb25jYXRlbmF0ZXMgdGhlIGlucHV0cyBpbnRvIGEgc2luZ2xlIGFycmF5LlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgKiBhcyBORUEgZnJvbSAnZnAtdHMvTm9uRW1wdHlBcnJheSdcbiAqIGltcG9ydCB7IHBpcGUgfSBmcm9tICdmcC10cy9mdW5jdGlvbidcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKFxuICogICBwaXBlKFxuICogICAgIFsxLCAyLCAzXSxcbiAqICAgICBORUEuYWx0KCgpID0+IFs0LCA1XSlcbiAqICAgKSxcbiAqICAgWzEsIDIsIDMsIDQsIDVdXG4gKiApXG4gKlxuICogQGNhdGVnb3J5IGVycm9yIGhhbmRsaW5nXG4gKiBAc2luY2UgMi42LjJcbiAqL1xuZXhwb3J0IHZhciBhbHQgPSBhbHRXO1xuLyoqXG4gKiBBcHBseSBhIGZ1bmN0aW9uIHRvIGFuIGFyZ3VtZW50IHVuZGVyIGEgdHlwZSBjb25zdHJ1Y3Rvci5cbiAqXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciBhcCA9IGZ1bmN0aW9uIChhcykge1xuICAgIHJldHVybiBmbGF0TWFwKGZ1bmN0aW9uIChmKSB7IHJldHVybiBwaXBlKGFzLCBtYXAoZikpOyB9KTtcbn07XG4vKipcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgKiBhcyBORUEgZnJvbSAnZnAtdHMvTm9uRW1wdHlBcnJheSdcbiAqIGltcG9ydCB7IHBpcGUgfSBmcm9tICdmcC10cy9mdW5jdGlvbidcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKFxuICogICBwaXBlKFxuICogICAgIFsxLCAyLCAzXSxcbiAqICAgICBORUEuZmxhdE1hcCgobikgPT4gW2BhJHtufWAsIGBiJHtufWBdKVxuICogICApLFxuICogICBbJ2ExJywgJ2IxJywgJ2EyJywgJ2IyJywgJ2EzJywgJ2IzJ11cbiAqIClcbiAqXG4gKiBAY2F0ZWdvcnkgc2VxdWVuY2luZ1xuICogQHNpbmNlIDIuMTQuMFxuICovXG5leHBvcnQgdmFyIGZsYXRNYXAgPSAvKiNfX1BVUkVfXyovIGR1YWwoMiwgZnVuY3Rpb24gKG1hLCBmKSB7XG4gICAgcmV0dXJuIHBpcGUobWEsIGNoYWluV2l0aEluZGV4KGZ1bmN0aW9uIChpLCBhKSB7IHJldHVybiBmKGEsIGkpOyB9KSk7XG59KTtcbi8qKlxuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgZXh0ZW5kID0gZnVuY3Rpb24gKGYpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIHZhciBuZXh0ID0gdGFpbChhcyk7XG4gICAgICAgIHZhciBvdXQgPSBbZihhcyldO1xuICAgICAgICB3aGlsZSAoaXNOb25FbXB0eShuZXh0KSkge1xuICAgICAgICAgICAgb3V0LnB1c2goZihuZXh0KSk7XG4gICAgICAgICAgICBuZXh0ID0gdGFpbChuZXh0KTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gb3V0O1xuICAgIH07XG59O1xuLyoqXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBkdXBsaWNhdGUgPSAvKiNfX1BVUkVfXyovIGV4dGVuZChpZGVudGl0eSk7XG4vKipcbiAqIEBjYXRlZ29yeSBzZXF1ZW5jaW5nXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBmbGF0dGVuID0gLyojX19QVVJFX18qLyBmbGF0TWFwKGlkZW50aXR5KTtcbi8qKlxuICogYG1hcGAgY2FuIGJlIHVzZWQgdG8gdHVybiBmdW5jdGlvbnMgYChhOiBBKSA9PiBCYCBpbnRvIGZ1bmN0aW9ucyBgKGZhOiBGPEE+KSA9PiBGPEI+YCB3aG9zZSBhcmd1bWVudCBhbmQgcmV0dXJuIHR5cGVzXG4gKiB1c2UgdGhlIHR5cGUgY29uc3RydWN0b3IgYEZgIHRvIHJlcHJlc2VudCBzb21lIGNvbXB1dGF0aW9uYWwgY29udGV4dC5cbiAqXG4gKiBAY2F0ZWdvcnkgbWFwcGluZ1xuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgbWFwID0gZnVuY3Rpb24gKGYpIHsgcmV0dXJuIG1hcFdpdGhJbmRleChmdW5jdGlvbiAoXywgYSkgeyByZXR1cm4gZihhKTsgfSk7IH07XG4vKipcbiAqIEBjYXRlZ29yeSBtYXBwaW5nXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciBtYXBXaXRoSW5kZXggPSBmdW5jdGlvbiAoZikge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgdmFyIG91dCA9IFtmKDAsIGhlYWQoYXMpKV07XG4gICAgICAgIGZvciAodmFyIGkgPSAxOyBpIDwgYXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIG91dC5wdXNoKGYoaSwgYXNbaV0pKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gb3V0O1xuICAgIH07XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgZm9sZGluZ1xuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgcmVkdWNlID0gUk5FQS5yZWR1Y2U7XG4vKipcbiAqIEBjYXRlZ29yeSBmb2xkaW5nXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciByZWR1Y2VXaXRoSW5kZXggPSBSTkVBLnJlZHVjZVdpdGhJbmRleDtcbi8qKlxuICogQGNhdGVnb3J5IGZvbGRpbmdcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIHJlZHVjZVJpZ2h0ID0gUk5FQS5yZWR1Y2VSaWdodDtcbi8qKlxuICogQGNhdGVnb3J5IGZvbGRpbmdcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIHJlZHVjZVJpZ2h0V2l0aEluZGV4ID0gUk5FQS5yZWR1Y2VSaWdodFdpdGhJbmRleDtcbi8qKlxuICogQGNhdGVnb3J5IHRyYXZlcnNpbmdcbiAqIEBzaW5jZSAyLjYuM1xuICovXG5leHBvcnQgdmFyIHRyYXZlcnNlID0gZnVuY3Rpb24gKEYpIHtcbiAgICB2YXIgdHJhdmVyc2VXaXRoSW5kZXhGID0gdHJhdmVyc2VXaXRoSW5kZXgoRik7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChmKSB7IHJldHVybiB0cmF2ZXJzZVdpdGhJbmRleEYoZnVuY3Rpb24gKF8sIGEpIHsgcmV0dXJuIGYoYSk7IH0pOyB9O1xufTtcbi8qKlxuICogQGNhdGVnb3J5IHRyYXZlcnNpbmdcbiAqIEBzaW5jZSAyLjYuM1xuICovXG5leHBvcnQgdmFyIHNlcXVlbmNlID0gZnVuY3Rpb24gKEYpIHsgcmV0dXJuIHRyYXZlcnNlV2l0aEluZGV4KEYpKGZ1bmN0aW9uIChfLCBhKSB7IHJldHVybiBhOyB9KTsgfTtcbi8qKlxuICogQGNhdGVnb3J5IHNlcXVlbmNpbmdcbiAqIEBzaW5jZSAyLjYuM1xuICovXG5leHBvcnQgdmFyIHRyYXZlcnNlV2l0aEluZGV4ID0gZnVuY3Rpb24gKEYpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGYpIHtcbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIChhcykge1xuICAgICAgICAgICAgdmFyIG91dCA9IEYubWFwKGYoMCwgaGVhZChhcykpLCBvZik7XG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMTsgaSA8IGFzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgb3V0ID0gRi5hcChGLm1hcChvdXQsIGZ1bmN0aW9uIChicykgeyByZXR1cm4gZnVuY3Rpb24gKGIpIHsgcmV0dXJuIHBpcGUoYnMsIGFwcGVuZChiKSk7IH07IH0pLCBmKGksIGFzW2ldKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gb3V0O1xuICAgICAgICB9O1xuICAgIH07XG59O1xuLyoqXG4gKiBAc2luY2UgMi43LjBcbiAqL1xuZXhwb3J0IHZhciBleHRyYWN0ID0gUk5FQS5oZWFkO1xuLyoqXG4gKiBAY2F0ZWdvcnkgdHlwZSBsYW1iZGFzXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciBVUkkgPSAnTm9uRW1wdHlBcnJheSc7XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIGdldFNob3cgPSBSTkVBLmdldFNob3c7XG4vKipcbiAqIEJ1aWxkcyBhIGBTZW1pZ3JvdXBgIGluc3RhbmNlIGZvciBgTm9uRW1wdHlBcnJheWBcbiAqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciBnZXRTZW1pZ3JvdXAgPSBmdW5jdGlvbiAoKSB7IHJldHVybiAoe1xuICAgIGNvbmNhdDogY29uY2F0XG59KTsgfTtcbi8qKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IGdldEVxIH0gZnJvbSAnZnAtdHMvTm9uRW1wdHlBcnJheSdcbiAqIGltcG9ydCAqIGFzIE4gZnJvbSAnZnAtdHMvbnVtYmVyJ1xuICpcbiAqIGNvbnN0IEUgPSBnZXRFcShOLkVxKVxuICogYXNzZXJ0LnN0cmljdEVxdWFsKEUuZXF1YWxzKFsxLCAyXSwgWzEsIDJdKSwgdHJ1ZSlcbiAqIGFzc2VydC5zdHJpY3RFcXVhbChFLmVxdWFscyhbMSwgMl0sIFsxLCAzXSksIGZhbHNlKVxuICpcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIGdldEVxID0gUk5FQS5nZXRFcTtcbi8qKlxuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIGdldFVuaW9uU2VtaWdyb3VwID0gZnVuY3Rpb24gKEUpIHtcbiAgICB2YXIgdW5pb25FID0gdW5pb24oRSk7XG4gICAgcmV0dXJuIHtcbiAgICAgICAgY29uY2F0OiBmdW5jdGlvbiAoZmlyc3QsIHNlY29uZCkgeyByZXR1cm4gdW5pb25FKHNlY29uZCkoZmlyc3QpOyB9XG4gICAgfTtcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjcuMFxuICovXG5leHBvcnQgdmFyIEZ1bmN0b3IgPSB7XG4gICAgVVJJOiBVUkksXG4gICAgbWFwOiBfbWFwXG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgbWFwcGluZ1xuICogQHNpbmNlIDIuMTAuMFxuICovXG5leHBvcnQgdmFyIGZsYXAgPSAvKiNfX1BVUkVfXyovIGZsYXBfKEZ1bmN0b3IpO1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi4xMC4wXG4gKi9cbmV4cG9ydCB2YXIgUG9pbnRlZCA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICBvZjogb2Zcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjcuMFxuICovXG5leHBvcnQgdmFyIEZ1bmN0b3JXaXRoSW5kZXggPSB7XG4gICAgVVJJOiBVUkksXG4gICAgbWFwOiBfbWFwLFxuICAgIG1hcFdpdGhJbmRleDogX21hcFdpdGhJbmRleFxufTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuMTAuMFxuICovXG5leHBvcnQgdmFyIEFwcGx5ID0ge1xuICAgIFVSSTogVVJJLFxuICAgIG1hcDogX21hcCxcbiAgICBhcDogX2FwXG59O1xuLyoqXG4gKiBDb21iaW5lIHR3byBlZmZlY3RmdWwgYWN0aW9ucywga2VlcGluZyBvbmx5IHRoZSByZXN1bHQgb2YgdGhlIGZpcnN0LlxuICpcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIGFwRmlyc3QgPSAvKiNfX1BVUkVfXyovIGFwRmlyc3RfKEFwcGx5KTtcbi8qKlxuICogQ29tYmluZSB0d28gZWZmZWN0ZnVsIGFjdGlvbnMsIGtlZXBpbmcgb25seSB0aGUgcmVzdWx0IG9mIHRoZSBzZWNvbmQuXG4gKlxuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgYXBTZWNvbmQgPSAvKiNfX1BVUkVfXyovIGFwU2Vjb25kXyhBcHBseSk7XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjcuMFxuICovXG5leHBvcnQgdmFyIEFwcGxpY2F0aXZlID0ge1xuICAgIFVSSTogVVJJLFxuICAgIG1hcDogX21hcCxcbiAgICBhcDogX2FwLFxuICAgIG9mOiBvZlxufTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuMTAuMFxuICovXG5leHBvcnQgdmFyIENoYWluID0ge1xuICAgIFVSSTogVVJJLFxuICAgIG1hcDogX21hcCxcbiAgICBhcDogX2FwLFxuICAgIGNoYWluOiBmbGF0TWFwXG59O1xuLyoqXG4gKiBDb21wb3NlcyBjb21wdXRhdGlvbnMgaW4gc2VxdWVuY2UsIHVzaW5nIHRoZSByZXR1cm4gdmFsdWUgb2Ygb25lIGNvbXB1dGF0aW9uIHRvIGRldGVybWluZSB0aGUgbmV4dCBjb21wdXRhdGlvbiBhbmRcbiAqIGtlZXBpbmcgb25seSB0aGUgcmVzdWx0IG9mIHRoZSBmaXJzdC5cbiAqXG4gKiBAY2F0ZWdvcnkgc2VxdWVuY2luZ1xuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgY2hhaW5GaXJzdCA9IFxuLyojX19QVVJFX18qLyBjaGFpbkZpcnN0XyhDaGFpbik7XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjcuMFxuICovXG5leHBvcnQgdmFyIE1vbmFkID0ge1xuICAgIFVSSTogVVJJLFxuICAgIG1hcDogX21hcCxcbiAgICBhcDogX2FwLFxuICAgIG9mOiBvZixcbiAgICBjaGFpbjogZmxhdE1hcFxufTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuNy4wXG4gKi9cbmV4cG9ydCB2YXIgRm9sZGFibGUgPSB7XG4gICAgVVJJOiBVUkksXG4gICAgcmVkdWNlOiBfcmVkdWNlLFxuICAgIGZvbGRNYXA6IF9mb2xkTWFwLFxuICAgIHJlZHVjZVJpZ2h0OiBfcmVkdWNlUmlnaHRcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjcuMFxuICovXG5leHBvcnQgdmFyIEZvbGRhYmxlV2l0aEluZGV4ID0ge1xuICAgIFVSSTogVVJJLFxuICAgIHJlZHVjZTogX3JlZHVjZSxcbiAgICBmb2xkTWFwOiBfZm9sZE1hcCxcbiAgICByZWR1Y2VSaWdodDogX3JlZHVjZVJpZ2h0LFxuICAgIHJlZHVjZVdpdGhJbmRleDogX3JlZHVjZVdpdGhJbmRleCxcbiAgICBmb2xkTWFwV2l0aEluZGV4OiBfZm9sZE1hcFdpdGhJbmRleCxcbiAgICByZWR1Y2VSaWdodFdpdGhJbmRleDogX3JlZHVjZVJpZ2h0V2l0aEluZGV4XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi43LjBcbiAqL1xuZXhwb3J0IHZhciBUcmF2ZXJzYWJsZSA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICBtYXA6IF9tYXAsXG4gICAgcmVkdWNlOiBfcmVkdWNlLFxuICAgIGZvbGRNYXA6IF9mb2xkTWFwLFxuICAgIHJlZHVjZVJpZ2h0OiBfcmVkdWNlUmlnaHQsXG4gICAgdHJhdmVyc2U6IF90cmF2ZXJzZSxcbiAgICBzZXF1ZW5jZTogc2VxdWVuY2Vcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjcuMFxuICovXG5leHBvcnQgdmFyIFRyYXZlcnNhYmxlV2l0aEluZGV4ID0ge1xuICAgIFVSSTogVVJJLFxuICAgIG1hcDogX21hcCxcbiAgICBtYXBXaXRoSW5kZXg6IF9tYXBXaXRoSW5kZXgsXG4gICAgcmVkdWNlOiBfcmVkdWNlLFxuICAgIGZvbGRNYXA6IF9mb2xkTWFwLFxuICAgIHJlZHVjZVJpZ2h0OiBfcmVkdWNlUmlnaHQsXG4gICAgdHJhdmVyc2U6IF90cmF2ZXJzZSxcbiAgICBzZXF1ZW5jZTogc2VxdWVuY2UsXG4gICAgcmVkdWNlV2l0aEluZGV4OiBfcmVkdWNlV2l0aEluZGV4LFxuICAgIGZvbGRNYXBXaXRoSW5kZXg6IF9mb2xkTWFwV2l0aEluZGV4LFxuICAgIHJlZHVjZVJpZ2h0V2l0aEluZGV4OiBfcmVkdWNlUmlnaHRXaXRoSW5kZXgsXG4gICAgdHJhdmVyc2VXaXRoSW5kZXg6IF90cmF2ZXJzZVdpdGhJbmRleFxufTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuNy4wXG4gKi9cbmV4cG9ydCB2YXIgQWx0ID0ge1xuICAgIFVSSTogVVJJLFxuICAgIG1hcDogX21hcCxcbiAgICBhbHQ6IF9hbHRcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjcuMFxuICovXG5leHBvcnQgdmFyIENvbW9uYWQgPSB7XG4gICAgVVJJOiBVUkksXG4gICAgbWFwOiBfbWFwLFxuICAgIGV4dGVuZDogX2V4dGVuZCxcbiAgICBleHRyYWN0OiBleHRyYWN0XG59O1xuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLy8gZG8gbm90YXRpb25cbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8qKlxuICogQGNhdGVnb3J5IGRvIG5vdGF0aW9uXG4gKiBAc2luY2UgMi45LjBcbiAqL1xuZXhwb3J0IHZhciBEbyA9IC8qI19fUFVSRV9fKi8gb2YoXy5lbXB0eVJlY29yZCk7XG4vKipcbiAqIEBjYXRlZ29yeSBkbyBub3RhdGlvblxuICogQHNpbmNlIDIuOC4wXG4gKi9cbmV4cG9ydCB2YXIgYmluZFRvID0gLyojX19QVVJFX18qLyBiaW5kVG9fKEZ1bmN0b3IpO1xudmFyIGxldF8gPSAvKiNfX1BVUkVfXyovIGxldF9fKEZ1bmN0b3IpO1xuZXhwb3J0IHsgXG4vKipcbiAqIEBjYXRlZ29yeSBkbyBub3RhdGlvblxuICogQHNpbmNlIDIuMTMuMFxuICovXG5sZXRfIGFzIGxldCB9O1xuLyoqXG4gKiBAY2F0ZWdvcnkgZG8gbm90YXRpb25cbiAqIEBzaW5jZSAyLjguMFxuICovXG5leHBvcnQgdmFyIGJpbmQgPSAvKiNfX1BVUkVfXyovIGJpbmRfKENoYWluKTtcbi8qKlxuICogQGNhdGVnb3J5IGRvIG5vdGF0aW9uXG4gKiBAc2luY2UgMi44LjBcbiAqL1xuZXhwb3J0IHZhciBhcFMgPSAvKiNfX1BVUkVfXyovIGFwU18oQXBwbHkpO1xuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLy8gdXRpbHNcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8qKlxuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgaGVhZCA9IFJORUEuaGVhZDtcbi8qKlxuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgdGFpbCA9IGZ1bmN0aW9uIChhcykgeyByZXR1cm4gYXMuc2xpY2UoMSk7IH07XG4vKipcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIGxhc3QgPSBSTkVBLmxhc3Q7XG4vKipcbiAqIEdldCBhbGwgYnV0IHRoZSBsYXN0IGVsZW1lbnQgb2YgYSBub24gZW1wdHkgYXJyYXksIGNyZWF0aW5nIGEgbmV3IGFycmF5LlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBpbml0IH0gZnJvbSAnZnAtdHMvTm9uRW1wdHlBcnJheSdcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKGluaXQoWzEsIDIsIDNdKSwgWzEsIDJdKVxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChpbml0KFsxXSksIFtdKVxuICpcbiAqIEBzaW5jZSAyLjIuMFxuICovXG5leHBvcnQgdmFyIGluaXQgPSBmdW5jdGlvbiAoYXMpIHsgcmV0dXJuIGFzLnNsaWNlKDAsIC0xKTsgfTtcbi8qKlxuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgbWluID0gUk5FQS5taW47XG4vKipcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIG1heCA9IFJORUEubWF4O1xuLyoqXG4gKiBAc2luY2UgMi4xMC4wXG4gKi9cbmV4cG9ydCB2YXIgY29uY2F0QWxsID0gZnVuY3Rpb24gKFMpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIHJldHVybiBhcy5yZWR1Y2UoUy5jb25jYXQpO1xuICAgIH07XG59O1xuLyoqXG4gKiBCcmVhayBhbiBgQXJyYXlgIGludG8gaXRzIGZpcnN0IGVsZW1lbnQgYW5kIHJlbWFpbmluZyBlbGVtZW50cy5cbiAqXG4gKiBAY2F0ZWdvcnkgcGF0dGVybiBtYXRjaGluZ1xuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIG1hdGNoTGVmdCA9IGZ1bmN0aW9uIChmKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykge1xuICAgICAgICByZXR1cm4gZihoZWFkKGFzKSwgdGFpbChhcykpO1xuICAgIH07XG59O1xuLyoqXG4gKiBCcmVhayBhbiBgQXJyYXlgIGludG8gaXRzIGluaXRpYWwgZWxlbWVudHMgYW5kIHRoZSBsYXN0IGVsZW1lbnQuXG4gKlxuICogQGNhdGVnb3J5IHBhdHRlcm4gbWF0Y2hpbmdcbiAqIEBzaW5jZSAyLjExLjBcbiAqL1xuZXhwb3J0IHZhciBtYXRjaFJpZ2h0ID0gZnVuY3Rpb24gKGYpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIHJldHVybiBmKGluaXQoYXMpLCBsYXN0KGFzKSk7XG4gICAgfTtcbn07XG4vKipcbiAqIEFwcGx5IGEgZnVuY3Rpb24gdG8gdGhlIGhlYWQsIGNyZWF0aW5nIGEgbmV3IGBOb25FbXB0eUFycmF5YC5cbiAqXG4gKiBAc2luY2UgMi4xMS4wXG4gKi9cbmV4cG9ydCB2YXIgbW9kaWZ5SGVhZCA9IGZ1bmN0aW9uIChmKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykge1xuICAgICAgICByZXR1cm4gX19zcHJlYWRBcnJheShbZihoZWFkKGFzKSldLCB0YWlsKGFzKSwgdHJ1ZSk7XG4gICAgfTtcbn07XG4vKipcbiAqIENoYW5nZSB0aGUgaGVhZCwgY3JlYXRpbmcgYSBuZXcgYE5vbkVtcHR5QXJyYXlgLlxuICpcbiAqIEBzaW5jZSAyLjExLjBcbiAqL1xuZXhwb3J0IHZhciB1cGRhdGVIZWFkID0gZnVuY3Rpb24gKGEpIHsgcmV0dXJuIG1vZGlmeUhlYWQoZnVuY3Rpb24gKCkgeyByZXR1cm4gYTsgfSk7IH07XG4vKipcbiAqIEFwcGx5IGEgZnVuY3Rpb24gdG8gdGhlIGxhc3QgZWxlbWVudCwgY3JlYXRpbmcgYSBuZXcgYE5vbkVtcHR5QXJyYXlgLlxuICpcbiAqIEBzaW5jZSAyLjExLjBcbiAqL1xuZXhwb3J0IHZhciBtb2RpZnlMYXN0ID0gZnVuY3Rpb24gKGYpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIHJldHVybiBwaXBlKGluaXQoYXMpLCBhcHBlbmQoZihsYXN0KGFzKSkpKTtcbiAgICB9O1xufTtcbi8qKlxuICogQ2hhbmdlIHRoZSBsYXN0IGVsZW1lbnQsIGNyZWF0aW5nIGEgbmV3IGBOb25FbXB0eUFycmF5YC5cbiAqXG4gKiBAc2luY2UgMi4xMS4wXG4gKi9cbmV4cG9ydCB2YXIgdXBkYXRlTGFzdCA9IGZ1bmN0aW9uIChhKSB7IHJldHVybiBtb2RpZnlMYXN0KGZ1bmN0aW9uICgpIHsgcmV0dXJuIGE7IH0pOyB9O1xuLyoqXG4gKiBQbGFjZXMgYW4gZWxlbWVudCBpbiBiZXR3ZWVuIG1lbWJlcnMgb2YgYSBgTm9uRW1wdHlBcnJheWAsIHRoZW4gZm9sZHMgdGhlIHJlc3VsdHMgdXNpbmcgdGhlIHByb3ZpZGVkIGBTZW1pZ3JvdXBgLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgKiBhcyBTIGZyb20gJ2ZwLXRzL3N0cmluZydcbiAqIGltcG9ydCB7IGludGVyY2FsYXRlIH0gZnJvbSAnZnAtdHMvTm9uRW1wdHlBcnJheSdcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKGludGVyY2FsYXRlKFMuU2VtaWdyb3VwKSgnLScpKFsnYScsICdiJywgJ2MnXSksICdhLWItYycpXG4gKlxuICogQHNpbmNlIDIuMTIuMFxuICovXG5leHBvcnQgdmFyIGludGVyY2FsYXRlID0gUk5FQS5pbnRlcmNhbGF0ZTtcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8vIGxlZ2FjeVxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLyoqXG4gKiBBbGlhcyBvZiBgZmxhdE1hcGAuXG4gKlxuICogQGNhdGVnb3J5IGxlZ2FjeVxuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgY2hhaW4gPSBmbGF0TWFwO1xuZXhwb3J0IGZ1bmN0aW9uIGdyb3VwU29ydChPKSB7XG4gICAgdmFyIHNvcnRPID0gc29ydChPKTtcbiAgICB2YXIgZ3JvdXBPID0gZ3JvdXAoTyk7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykgeyByZXR1cm4gKGlzTm9uRW1wdHkoYXMpID8gZ3JvdXBPKHNvcnRPKGFzKSkgOiBbXSk7IH07XG59XG5leHBvcnQgZnVuY3Rpb24gZmlsdGVyKHByZWRpY2F0ZSkge1xuICAgIHJldHVybiBmaWx0ZXJXaXRoSW5kZXgoZnVuY3Rpb24gKF8sIGEpIHsgcmV0dXJuIHByZWRpY2F0ZShhKTsgfSk7XG59XG4vKipcbiAqIFVzZSBbYGZpbHRlcldpdGhJbmRleGBdKC4vQXJyYXkudHMuaHRtbCNmaWx0ZXJ3aXRoaW5kZXgpIGluc3RlYWQuXG4gKlxuICogQGNhdGVnb3J5IHpvbmUgb2YgZGVhdGhcbiAqIEBzaW5jZSAyLjAuMFxuICogQGRlcHJlY2F0ZWRcbiAqL1xuZXhwb3J0IHZhciBmaWx0ZXJXaXRoSW5kZXggPSBmdW5jdGlvbiAocHJlZGljYXRlKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykge1xuICAgICAgICByZXR1cm4gZnJvbUFycmF5KGFzLmZpbHRlcihmdW5jdGlvbiAoYSwgaSkgeyByZXR1cm4gcHJlZGljYXRlKGksIGEpOyB9KSk7XG4gICAgfTtcbn07XG4vKipcbiAqIFVzZSBbYHVucHJlcGVuZGBdKCN1bnByZXBlbmQpIGluc3RlYWQuXG4gKlxuICogQGNhdGVnb3J5IHpvbmUgb2YgZGVhdGhcbiAqIEBzaW5jZSAyLjkuMFxuICogQGRlcHJlY2F0ZWRcbiAqL1xuZXhwb3J0IHZhciB1bmNvbnMgPSB1bnByZXBlbmQ7XG4vKipcbiAqIFVzZSBbYHVuYXBwZW5kYF0oI3VuYXBwZW5kKSBpbnN0ZWFkLlxuICpcbiAqIEBjYXRlZ29yeSB6b25lIG9mIGRlYXRoXG4gKiBAc2luY2UgMi45LjBcbiAqIEBkZXByZWNhdGVkXG4gKi9cbmV4cG9ydCB2YXIgdW5zbm9jID0gdW5hcHBlbmQ7XG5leHBvcnQgZnVuY3Rpb24gY29ucyhoZWFkLCB0YWlsKSB7XG4gICAgcmV0dXJuIHRhaWwgPT09IHVuZGVmaW5lZCA/IHByZXBlbmQoaGVhZCkgOiBwaXBlKHRhaWwsIHByZXBlbmQoaGVhZCkpO1xufVxuLyoqXG4gKiBVc2UgW2BhcHBlbmRgXSguL0FycmF5LnRzLmh0bWwjYXBwZW5kKSBpbnN0ZWFkLlxuICpcbiAqIEBjYXRlZ29yeSB6b25lIG9mIGRlYXRoXG4gKiBAc2luY2UgMi4wLjBcbiAqIEBkZXByZWNhdGVkXG4gKi9cbmV4cG9ydCB2YXIgc25vYyA9IGZ1bmN0aW9uIChpbml0LCBlbmQpIHsgcmV0dXJuIHBpcGUoaW5pdCwgYXBwZW5kKGVuZCkpOyB9O1xuLyoqXG4gKiBVc2UgW2BwcmVwZW5kQWxsYF0oI3ByZXBlbmRhbGwpIGluc3RlYWQuXG4gKlxuICogQGNhdGVnb3J5IHpvbmUgb2YgZGVhdGhcbiAqIEBzaW5jZSAyLjkuMFxuICogQGRlcHJlY2F0ZWRcbiAqL1xuZXhwb3J0IHZhciBwcmVwZW5kVG9BbGwgPSBwcmVwZW5kQWxsO1xuLyoqXG4gKiBVc2UgW2Bjb25jYXRBbGxgXSgjY29uY2F0YWxsKSBpbnN0ZWFkLlxuICpcbiAqIEBjYXRlZ29yeSB6b25lIG9mIGRlYXRoXG4gKiBAc2luY2UgMi41LjBcbiAqIEBkZXByZWNhdGVkXG4gKi9cbmV4cG9ydCB2YXIgZm9sZCA9IFJORUEuY29uY2F0QWxsO1xuLyoqXG4gKiBUaGlzIGluc3RhbmNlIGlzIGRlcHJlY2F0ZWQsIHVzZSBzbWFsbCwgc3BlY2lmaWMgaW5zdGFuY2VzIGluc3RlYWQuXG4gKiBGb3IgZXhhbXBsZSBpZiBhIGZ1bmN0aW9uIG5lZWRzIGEgYEZ1bmN0b3JgIGluc3RhbmNlLCBwYXNzIGBORUEuRnVuY3RvcmAgaW5zdGVhZCBvZiBgTkVBLm5vbkVtcHR5QXJyYXlgXG4gKiAod2hlcmUgYE5FQWAgaXMgZnJvbSBgaW1wb3J0IE5FQSBmcm9tICdmcC10cy9Ob25FbXB0eUFycmF5J2ApXG4gKlxuICogQGNhdGVnb3J5IHpvbmUgb2YgZGVhdGhcbiAqIEBzaW5jZSAyLjAuMFxuICogQGRlcHJlY2F0ZWRcbiAqL1xuZXhwb3J0IHZhciBub25FbXB0eUFycmF5ID0ge1xuICAgIFVSSTogVVJJLFxuICAgIG9mOiBvZixcbiAgICBtYXA6IF9tYXAsXG4gICAgbWFwV2l0aEluZGV4OiBfbWFwV2l0aEluZGV4LFxuICAgIGFwOiBfYXAsXG4gICAgY2hhaW46IGZsYXRNYXAsXG4gICAgZXh0ZW5kOiBfZXh0ZW5kLFxuICAgIGV4dHJhY3Q6IGV4dHJhY3QsXG4gICAgcmVkdWNlOiBfcmVkdWNlLFxuICAgIGZvbGRNYXA6IF9mb2xkTWFwLFxuICAgIHJlZHVjZVJpZ2h0OiBfcmVkdWNlUmlnaHQsXG4gICAgdHJhdmVyc2U6IF90cmF2ZXJzZSxcbiAgICBzZXF1ZW5jZTogc2VxdWVuY2UsXG4gICAgcmVkdWNlV2l0aEluZGV4OiBfcmVkdWNlV2l0aEluZGV4LFxuICAgIGZvbGRNYXBXaXRoSW5kZXg6IF9mb2xkTWFwV2l0aEluZGV4LFxuICAgIHJlZHVjZVJpZ2h0V2l0aEluZGV4OiBfcmVkdWNlUmlnaHRXaXRoSW5kZXgsXG4gICAgdHJhdmVyc2VXaXRoSW5kZXg6IF90cmF2ZXJzZVdpdGhJbmRleCxcbiAgICBhbHQ6IF9hbHRcbn07XG4iLAogICJ2YXIgX19zcHJlYWRBcnJheSA9ICh0aGlzICYmIHRoaXMuX19zcHJlYWRBcnJheSkgfHwgZnVuY3Rpb24gKHRvLCBmcm9tLCBwYWNrKSB7XG4gICAgaWYgKHBhY2sgfHwgYXJndW1lbnRzLmxlbmd0aCA9PT0gMikgZm9yICh2YXIgaSA9IDAsIGwgPSBmcm9tLmxlbmd0aCwgYXI7IGkgPCBsOyBpKyspIHtcbiAgICAgICAgaWYgKGFyIHx8ICEoaSBpbiBmcm9tKSkge1xuICAgICAgICAgICAgaWYgKCFhcikgYXIgPSBBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChmcm9tLCAwLCBpKTtcbiAgICAgICAgICAgIGFyW2ldID0gZnJvbVtpXTtcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gdG8uY29uY2F0KGFyIHx8IEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGZyb20pKTtcbn07XG5pbXBvcnQgeyBhcEZpcnN0IGFzIGFwRmlyc3RfLCBhcFMgYXMgYXBTXywgYXBTZWNvbmQgYXMgYXBTZWNvbmRfIH0gZnJvbSAnLi9BcHBseSc7XG5pbXBvcnQgeyBiaW5kIGFzIGJpbmRfLCBjaGFpbkZpcnN0IGFzIGNoYWluRmlyc3RfIH0gZnJvbSAnLi9DaGFpbic7XG5pbXBvcnQgeyBkdWFsLCBpZGVudGl0eSwgcGlwZSB9IGZyb20gJy4vZnVuY3Rpb24nO1xuaW1wb3J0IHsgYmluZFRvIGFzIGJpbmRUb18sIGZsYXAgYXMgZmxhcF8sIGxldCBhcyBsZXRfXyB9IGZyb20gJy4vRnVuY3Rvcic7XG5pbXBvcnQgKiBhcyBfIGZyb20gJy4vaW50ZXJuYWwnO1xuaW1wb3J0IHsgZ2V0TW9ub2lkIH0gZnJvbSAnLi9PcmQnO1xuaW1wb3J0ICogYXMgUk5FQSBmcm9tICcuL1JlYWRvbmx5Tm9uRW1wdHlBcnJheSc7XG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vLyBpbnRlcm5hbFxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLyoqXG4gKiBAaW50ZXJuYWxcbiAqL1xuZXhwb3J0IHZhciBpc05vbkVtcHR5ID0gZnVuY3Rpb24gKGFzKSB7IHJldHVybiBhcy5sZW5ndGggPiAwOyB9O1xuLyoqXG4gKiBAaW50ZXJuYWxcbiAqL1xuZXhwb3J0IHZhciBpc091dE9mQm91bmQgPSBmdW5jdGlvbiAoaSwgYXMpIHsgcmV0dXJuIGkgPCAwIHx8IGkgPj0gYXMubGVuZ3RoOyB9O1xuLyoqXG4gKiBAaW50ZXJuYWxcbiAqL1xuZXhwb3J0IHZhciBwcmVwZW5kVyA9IGZ1bmN0aW9uIChoZWFkKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uICh0YWlsKSB7XG4gICAgICAgIHJldHVybiBfX3NwcmVhZEFycmF5KFtoZWFkXSwgdGFpbCwgdHJ1ZSk7XG4gICAgfTtcbn07XG4vKipcbiAqIEBpbnRlcm5hbFxuICovXG5leHBvcnQgdmFyIHByZXBlbmQgPSBwcmVwZW5kVztcbi8qKlxuICogQGludGVybmFsXG4gKi9cbmV4cG9ydCB2YXIgYXBwZW5kVyA9IGZ1bmN0aW9uIChlbmQpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGluaXQpIHtcbiAgICAgICAgcmV0dXJuIF9fc3ByZWFkQXJyYXkoX19zcHJlYWRBcnJheShbXSwgaW5pdCwgdHJ1ZSksIFtlbmRdLCBmYWxzZSk7XG4gICAgfTtcbn07XG4vKipcbiAqIEBpbnRlcm5hbFxuICovXG5leHBvcnQgdmFyIGFwcGVuZCA9IGFwcGVuZFc7XG4vKipcbiAqIEBpbnRlcm5hbFxuICovXG5leHBvcnQgdmFyIHVuc2FmZUluc2VydEF0ID0gZnVuY3Rpb24gKGksIGEsIGFzKSB7XG4gICAgaWYgKGlzTm9uRW1wdHkoYXMpKSB7XG4gICAgICAgIHZhciB4cyA9IGZyb21SZWFkb25seU5vbkVtcHR5QXJyYXkoYXMpO1xuICAgICAgICB4cy5zcGxpY2UoaSwgMCwgYSk7XG4gICAgICAgIHJldHVybiB4cztcbiAgICB9XG4gICAgcmV0dXJuIFthXTtcbn07XG4vKipcbiAqIEBpbnRlcm5hbFxuICovXG5leHBvcnQgdmFyIHVuc2FmZVVwZGF0ZUF0ID0gZnVuY3Rpb24gKGksIGEsIGFzKSB7XG4gICAgdmFyIHhzID0gZnJvbVJlYWRvbmx5Tm9uRW1wdHlBcnJheShhcyk7XG4gICAgeHNbaV0gPSBhO1xuICAgIHJldHVybiB4cztcbn07XG4vKipcbiAqIFJlbW92ZSBkdXBsaWNhdGVzIGZyb20gYSBgTm9uRW1wdHlBcnJheWAsIGtlZXBpbmcgdGhlIGZpcnN0IG9jY3VycmVuY2Ugb2YgYW4gZWxlbWVudC5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgdW5pcSB9IGZyb20gJ2ZwLXRzL05vbkVtcHR5QXJyYXknXG4gKiBpbXBvcnQgKiBhcyBOIGZyb20gJ2ZwLXRzL251bWJlcidcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKHVuaXEoTi5FcSkoWzEsIDIsIDFdKSwgWzEsIDJdKVxuICpcbiAqIEBzaW5jZSAyLjExLjBcbiAqL1xuZXhwb3J0IHZhciB1bmlxID0gZnVuY3Rpb24gKEUpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIGlmIChhcy5sZW5ndGggPT09IDEpIHtcbiAgICAgICAgICAgIHJldHVybiBjb3B5KGFzKTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgb3V0ID0gW2hlYWQoYXMpXTtcbiAgICAgICAgdmFyIHJlc3QgPSB0YWlsKGFzKTtcbiAgICAgICAgdmFyIF9sb29wXzEgPSBmdW5jdGlvbiAoYSkge1xuICAgICAgICAgICAgaWYgKG91dC5ldmVyeShmdW5jdGlvbiAobykgeyByZXR1cm4gIUUuZXF1YWxzKG8sIGEpOyB9KSkge1xuICAgICAgICAgICAgICAgIG91dC5wdXNoKGEpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICBmb3IgKHZhciBfaSA9IDAsIHJlc3RfMSA9IHJlc3Q7IF9pIDwgcmVzdF8xLmxlbmd0aDsgX2krKykge1xuICAgICAgICAgICAgdmFyIGEgPSByZXN0XzFbX2ldO1xuICAgICAgICAgICAgX2xvb3BfMShhKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gb3V0O1xuICAgIH07XG59O1xuLyoqXG4gKiBTb3J0IHRoZSBlbGVtZW50cyBvZiBhIGBOb25FbXB0eUFycmF5YCBpbiBpbmNyZWFzaW5nIG9yZGVyLCB3aGVyZSBlbGVtZW50cyBhcmUgY29tcGFyZWQgdXNpbmcgZmlyc3QgYG9yZHNbMF1gLCB0aGVuIGBvcmRzWzFdYCxcbiAqIGV0Yy4uLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgKiBhcyBORUEgZnJvbSAnZnAtdHMvTm9uRW1wdHlBcnJheSdcbiAqIGltcG9ydCB7IGNvbnRyYW1hcCB9IGZyb20gJ2ZwLXRzL09yZCdcbiAqIGltcG9ydCAqIGFzIFMgZnJvbSAnZnAtdHMvc3RyaW5nJ1xuICogaW1wb3J0ICogYXMgTiBmcm9tICdmcC10cy9udW1iZXInXG4gKiBpbXBvcnQgeyBwaXBlIH0gZnJvbSAnZnAtdHMvZnVuY3Rpb24nXG4gKlxuICogaW50ZXJmYWNlIFBlcnNvbiB7XG4gKiAgIG5hbWU6IHN0cmluZ1xuICogICBhZ2U6IG51bWJlclxuICogfVxuICpcbiAqIGNvbnN0IGJ5TmFtZSA9IHBpcGUoUy5PcmQsIGNvbnRyYW1hcCgocDogUGVyc29uKSA9PiBwLm5hbWUpKVxuICpcbiAqIGNvbnN0IGJ5QWdlID0gcGlwZShOLk9yZCwgY29udHJhbWFwKChwOiBQZXJzb24pID0+IHAuYWdlKSlcbiAqXG4gKiBjb25zdCBzb3J0QnlOYW1lQnlBZ2UgPSBORUEuc29ydEJ5KFtieU5hbWUsIGJ5QWdlXSlcbiAqXG4gKiBjb25zdCBwZXJzb25zOiBORUEuTm9uRW1wdHlBcnJheTxQZXJzb24+ID0gW1xuICogICB7IG5hbWU6ICdhJywgYWdlOiAxIH0sXG4gKiAgIHsgbmFtZTogJ2InLCBhZ2U6IDMgfSxcbiAqICAgeyBuYW1lOiAnYycsIGFnZTogMiB9LFxuICogICB7IG5hbWU6ICdiJywgYWdlOiAyIH1cbiAqIF1cbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKHNvcnRCeU5hbWVCeUFnZShwZXJzb25zKSwgW1xuICogICB7IG5hbWU6ICdhJywgYWdlOiAxIH0sXG4gKiAgIHsgbmFtZTogJ2InLCBhZ2U6IDIgfSxcbiAqICAgeyBuYW1lOiAnYicsIGFnZTogMyB9LFxuICogICB7IG5hbWU6ICdjJywgYWdlOiAyIH1cbiAqIF0pXG4gKlxuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIHNvcnRCeSA9IGZ1bmN0aW9uIChvcmRzKSB7XG4gICAgaWYgKGlzTm9uRW1wdHkob3JkcykpIHtcbiAgICAgICAgdmFyIE0gPSBnZXRNb25vaWQoKTtcbiAgICAgICAgcmV0dXJuIHNvcnQob3Jkcy5yZWR1Y2UoTS5jb25jYXQsIE0uZW1wdHkpKTtcbiAgICB9XG4gICAgcmV0dXJuIGNvcHk7XG59O1xuLyoqXG4gKiBAc2luY2UgMi4xMS4wXG4gKi9cbmV4cG9ydCB2YXIgdW5pb24gPSBmdW5jdGlvbiAoRSkge1xuICAgIHZhciB1bmlxRSA9IHVuaXEoRSk7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChzZWNvbmQpIHsgcmV0dXJuIGZ1bmN0aW9uIChmaXJzdCkgeyByZXR1cm4gdW5pcUUocGlwZShmaXJzdCwgY29uY2F0KHNlY29uZCkpKTsgfTsgfTtcbn07XG4vKipcbiAqIFJvdGF0ZSBhIGBOb25FbXB0eUFycmF5YCBieSBgbmAgc3RlcHMuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IHJvdGF0ZSB9IGZyb20gJ2ZwLXRzL05vbkVtcHR5QXJyYXknXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChyb3RhdGUoMikoWzEsIDIsIDMsIDQsIDVdKSwgWzQsIDUsIDEsIDIsIDNdKVxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChyb3RhdGUoLTIpKFsxLCAyLCAzLCA0LCA1XSksIFszLCA0LCA1LCAxLCAyXSlcbiAqXG4gKiBAc2luY2UgMi4xMS4wXG4gKi9cbmV4cG9ydCB2YXIgcm90YXRlID0gZnVuY3Rpb24gKG4pIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIHZhciBsZW4gPSBhcy5sZW5ndGg7XG4gICAgICAgIHZhciBtID0gTWF0aC5yb3VuZChuKSAlIGxlbjtcbiAgICAgICAgaWYgKGlzT3V0T2ZCb3VuZChNYXRoLmFicyhtKSwgYXMpIHx8IG0gPT09IDApIHtcbiAgICAgICAgICAgIHJldHVybiBjb3B5KGFzKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAobSA8IDApIHtcbiAgICAgICAgICAgIHZhciBfYSA9IHNwbGl0QXQoLW0pKGFzKSwgZiA9IF9hWzBdLCBzID0gX2FbMV07XG4gICAgICAgICAgICByZXR1cm4gcGlwZShzLCBjb25jYXQoZikpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuIHJvdGF0ZShtIC0gbGVuKShhcyk7XG4gICAgICAgIH1cbiAgICB9O1xufTtcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8vIGNvbnN0cnVjdG9yc1xuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLyoqXG4gKiBAY2F0ZWdvcnkgY29udmVyc2lvbnNcbiAqIEBzaW5jZSAyLjEwLjBcbiAqL1xuZXhwb3J0IHZhciBmcm9tUmVhZG9ubHlOb25FbXB0eUFycmF5ID0gXy5mcm9tUmVhZG9ubHlOb25FbXB0eUFycmF5O1xuLyoqXG4gKiBCdWlsZHMgYSBgTm9uRW1wdHlBcnJheWAgZnJvbSBhbiBgQXJyYXlgIHJldHVybmluZyBgbm9uZWAgaWYgYGFzYCBpcyBhbiBlbXB0eSBhcnJheVxuICpcbiAqIEBjYXRlZ29yeSBjb252ZXJzaW9uc1xuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgZnJvbUFycmF5ID0gZnVuY3Rpb24gKGFzKSB7IHJldHVybiAoaXNOb25FbXB0eShhcykgPyBfLnNvbWUoYXMpIDogXy5ub25lKTsgfTtcbi8qKlxuICogUmV0dXJuIGEgYE5vbkVtcHR5QXJyYXlgIG9mIGxlbmd0aCBgbmAgd2l0aCBlbGVtZW50IGBpYCBpbml0aWFsaXplZCB3aXRoIGBmKGkpYC5cbiAqXG4gKiAqKk5vdGUqKi4gYG5gIGlzIG5vcm1hbGl6ZWQgdG8gYSBuYXR1cmFsIG51bWJlci5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgbWFrZUJ5IH0gZnJvbSAnZnAtdHMvTm9uRW1wdHlBcnJheSdcbiAqIGltcG9ydCB7IHBpcGUgfSBmcm9tICdmcC10cy9mdW5jdGlvbidcbiAqXG4gKiBjb25zdCBkb3VibGUgPSAobjogbnVtYmVyKTogbnVtYmVyID0+IG4gKiAyXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKHBpcGUoNSwgbWFrZUJ5KGRvdWJsZSkpLCBbMCwgMiwgNCwgNiwgOF0pXG4gKlxuICogQGNhdGVnb3J5IGNvbnN0cnVjdG9yc1xuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIG1ha2VCeSA9IGZ1bmN0aW9uIChmKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChuKSB7XG4gICAgICAgIHZhciBqID0gTWF0aC5tYXgoMCwgTWF0aC5mbG9vcihuKSk7XG4gICAgICAgIHZhciBvdXQgPSBbZigwKV07XG4gICAgICAgIGZvciAodmFyIGkgPSAxOyBpIDwgajsgaSsrKSB7XG4gICAgICAgICAgICBvdXQucHVzaChmKGkpKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gb3V0O1xuICAgIH07XG59O1xuLyoqXG4gKiBDcmVhdGUgYSBgTm9uRW1wdHlBcnJheWAgY29udGFpbmluZyBhIHZhbHVlIHJlcGVhdGVkIHRoZSBzcGVjaWZpZWQgbnVtYmVyIG9mIHRpbWVzLlxuICpcbiAqICoqTm90ZSoqLiBgbmAgaXMgbm9ybWFsaXplZCB0byBhIG5hdHVyYWwgbnVtYmVyLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyByZXBsaWNhdGUgfSBmcm9tICdmcC10cy9Ob25FbXB0eUFycmF5J1xuICogaW1wb3J0IHsgcGlwZSB9IGZyb20gJ2ZwLXRzL2Z1bmN0aW9uJ1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwocGlwZSgzLCByZXBsaWNhdGUoJ2EnKSksIFsnYScsICdhJywgJ2EnXSlcbiAqXG4gKiBAY2F0ZWdvcnkgY29uc3RydWN0b3JzXG4gKiBAc2luY2UgMi4xMS4wXG4gKi9cbmV4cG9ydCB2YXIgcmVwbGljYXRlID0gZnVuY3Rpb24gKGEpIHsgcmV0dXJuIG1ha2VCeShmdW5jdGlvbiAoKSB7IHJldHVybiBhOyB9KTsgfTtcbi8qKlxuICogQ3JlYXRlIGEgYE5vbkVtcHR5QXJyYXlgIGNvbnRhaW5pbmcgYSByYW5nZSBvZiBpbnRlZ2VycywgaW5jbHVkaW5nIGJvdGggZW5kcG9pbnRzLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyByYW5nZSB9IGZyb20gJ2ZwLXRzL05vbkVtcHR5QXJyYXknXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChyYW5nZSgxLCA1KSwgWzEsIDIsIDMsIDQsIDVdKVxuICpcbiAqIEBjYXRlZ29yeSBjb25zdHJ1Y3RvcnNcbiAqIEBzaW5jZSAyLjExLjBcbiAqL1xuZXhwb3J0IHZhciByYW5nZSA9IGZ1bmN0aW9uIChzdGFydCwgZW5kKSB7XG4gICAgcmV0dXJuIHN0YXJ0IDw9IGVuZCA/IG1ha2VCeShmdW5jdGlvbiAoaSkgeyByZXR1cm4gc3RhcnQgKyBpOyB9KShlbmQgLSBzdGFydCArIDEpIDogW3N0YXJ0XTtcbn07XG4vKipcbiAqIFJldHVybiB0aGUgdHVwbGUgb2YgdGhlIGBoZWFkYCBhbmQgdGhlIGB0YWlsYC5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgdW5wcmVwZW5kIH0gZnJvbSAnZnAtdHMvTm9uRW1wdHlBcnJheSdcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKHVucHJlcGVuZChbMSwgMiwgM10pLCBbMSwgWzIsIDNdXSlcbiAqXG4gKiBAc2luY2UgMi45LjBcbiAqL1xuZXhwb3J0IHZhciB1bnByZXBlbmQgPSBmdW5jdGlvbiAoYXMpIHsgcmV0dXJuIFtoZWFkKGFzKSwgdGFpbChhcyldOyB9O1xuLyoqXG4gKiBSZXR1cm4gdGhlIHR1cGxlIG9mIHRoZSBgaW5pdGAgYW5kIHRoZSBgbGFzdGAuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IHVuYXBwZW5kIH0gZnJvbSAnZnAtdHMvTm9uRW1wdHlBcnJheSdcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKHVuYXBwZW5kKFsxLCAyLCAzLCA0XSksIFtbMSwgMiwgM10sIDRdKVxuICpcbiAqIEBzaW5jZSAyLjkuMFxuICovXG5leHBvcnQgdmFyIHVuYXBwZW5kID0gZnVuY3Rpb24gKGFzKSB7IHJldHVybiBbaW5pdChhcyksIGxhc3QoYXMpXTsgfTtcbmV4cG9ydCBmdW5jdGlvbiBjb25jYXRXKHNlY29uZCkge1xuICAgIHJldHVybiBmdW5jdGlvbiAoZmlyc3QpIHsgcmV0dXJuIGZpcnN0LmNvbmNhdChzZWNvbmQpOyB9O1xufVxuZXhwb3J0IGZ1bmN0aW9uIGNvbmNhdCh4LCB5KSB7XG4gICAgcmV0dXJuIHkgPyB4LmNvbmNhdCh5KSA6IGZ1bmN0aW9uICh5KSB7IHJldHVybiB5LmNvbmNhdCh4KTsgfTtcbn1cbi8qKlxuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgcmV2ZXJzZSA9IGZ1bmN0aW9uIChhcykgeyByZXR1cm4gX19zcHJlYWRBcnJheShbbGFzdChhcyldLCBhcy5zbGljZSgwLCAtMSkucmV2ZXJzZSgpLCB0cnVlKTsgfTtcbmV4cG9ydCBmdW5jdGlvbiBncm91cChFKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykge1xuICAgICAgICB2YXIgbGVuID0gYXMubGVuZ3RoO1xuICAgICAgICBpZiAobGVuID09PSAwKSB7XG4gICAgICAgICAgICByZXR1cm4gW107XG4gICAgICAgIH1cbiAgICAgICAgdmFyIG91dCA9IFtdO1xuICAgICAgICB2YXIgaGVhZCA9IGFzWzBdO1xuICAgICAgICB2YXIgbmVhID0gW2hlYWRdO1xuICAgICAgICBmb3IgKHZhciBpID0gMTsgaSA8IGxlbjsgaSsrKSB7XG4gICAgICAgICAgICB2YXIgYSA9IGFzW2ldO1xuICAgICAgICAgICAgaWYgKEUuZXF1YWxzKGEsIGhlYWQpKSB7XG4gICAgICAgICAgICAgICAgbmVhLnB1c2goYSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBvdXQucHVzaChuZWEpO1xuICAgICAgICAgICAgICAgIGhlYWQgPSBhO1xuICAgICAgICAgICAgICAgIG5lYSA9IFtoZWFkXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBvdXQucHVzaChuZWEpO1xuICAgICAgICByZXR1cm4gb3V0O1xuICAgIH07XG59XG4vKipcbiAqIFNwbGl0cyBhbiBhcnJheSBpbnRvIHN1Yi1ub24tZW1wdHktYXJyYXlzIHN0b3JlZCBpbiBhbiBvYmplY3QsIGJhc2VkIG9uIHRoZSByZXN1bHQgb2YgY2FsbGluZyBhIGBzdHJpbmdgLXJldHVybmluZ1xuICogZnVuY3Rpb24gb24gZWFjaCBlbGVtZW50LCBhbmQgZ3JvdXBpbmcgdGhlIHJlc3VsdHMgYWNjb3JkaW5nIHRvIHZhbHVlcyByZXR1cm5lZFxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBncm91cEJ5IH0gZnJvbSAnZnAtdHMvTm9uRW1wdHlBcnJheSdcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKGdyb3VwQnkoKHM6IHN0cmluZykgPT4gU3RyaW5nKHMubGVuZ3RoKSkoWydhJywgJ2InLCAnYWInXSksIHtcbiAqICAgJzEnOiBbJ2EnLCAnYiddLFxuICogICAnMic6IFsnYWInXVxuICogfSlcbiAqXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciBncm91cEJ5ID0gZnVuY3Rpb24gKGYpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIHZhciBvdXQgPSB7fTtcbiAgICAgICAgZm9yICh2YXIgX2kgPSAwLCBhc18xID0gYXM7IF9pIDwgYXNfMS5sZW5ndGg7IF9pKyspIHtcbiAgICAgICAgICAgIHZhciBhID0gYXNfMVtfaV07XG4gICAgICAgICAgICB2YXIgayA9IGYoYSk7XG4gICAgICAgICAgICBpZiAoXy5oYXMuY2FsbChvdXQsIGspKSB7XG4gICAgICAgICAgICAgICAgb3V0W2tdLnB1c2goYSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBvdXRba10gPSBbYV07XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG91dDtcbiAgICB9O1xufTtcbi8qKlxuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgc29ydCA9IGZ1bmN0aW9uIChPKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykge1xuICAgICAgICByZXR1cm4gYXMuc2xpY2UoKS5zb3J0KE8uY29tcGFyZSk7XG4gICAgfTtcbn07XG4vKipcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIGluc2VydEF0ID0gZnVuY3Rpb24gKGksIGEpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIHJldHVybiBpIDwgMCB8fCBpID4gYXMubGVuZ3RoID8gXy5ub25lIDogXy5zb21lKHVuc2FmZUluc2VydEF0KGksIGEsIGFzKSk7XG4gICAgfTtcbn07XG4vKipcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIHVwZGF0ZUF0ID0gZnVuY3Rpb24gKGksIGEpIHtcbiAgICByZXR1cm4gbW9kaWZ5QXQoaSwgZnVuY3Rpb24gKCkgeyByZXR1cm4gYTsgfSk7XG59O1xuLyoqXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciBtb2RpZnlBdCA9IGZ1bmN0aW9uIChpLCBmKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykge1xuICAgICAgICByZXR1cm4gaXNPdXRPZkJvdW5kKGksIGFzKSA/IF8ubm9uZSA6IF8uc29tZSh1bnNhZmVVcGRhdGVBdChpLCBmKGFzW2ldKSwgYXMpKTtcbiAgICB9O1xufTtcbi8qKlxuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgY29weSA9IGZyb21SZWFkb25seU5vbkVtcHR5QXJyYXk7XG4vKipcbiAqIEBjYXRlZ29yeSBjb25zdHJ1Y3RvcnNcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIG9mID0gZnVuY3Rpb24gKGEpIHsgcmV0dXJuIFthXTsgfTtcbi8qKlxuICogQHNpbmNlIDIuNS4xXG4gKi9cbmV4cG9ydCB2YXIgemlwV2l0aCA9IGZ1bmN0aW9uIChhcywgYnMsIGYpIHtcbiAgICB2YXIgY3MgPSBbZihhc1swXSwgYnNbMF0pXTtcbiAgICB2YXIgbGVuID0gTWF0aC5taW4oYXMubGVuZ3RoLCBicy5sZW5ndGgpO1xuICAgIGZvciAodmFyIGkgPSAxOyBpIDwgbGVuOyBpKyspIHtcbiAgICAgICAgY3NbaV0gPSBmKGFzW2ldLCBic1tpXSk7XG4gICAgfVxuICAgIHJldHVybiBjcztcbn07XG5leHBvcnQgZnVuY3Rpb24gemlwKGFzLCBicykge1xuICAgIGlmIChicyA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgIHJldHVybiBmdW5jdGlvbiAoYnMpIHsgcmV0dXJuIHppcChicywgYXMpOyB9O1xuICAgIH1cbiAgICByZXR1cm4gemlwV2l0aChhcywgYnMsIGZ1bmN0aW9uIChhLCBiKSB7IHJldHVybiBbYSwgYl07IH0pO1xufVxuLyoqXG4gKiBAc2luY2UgMi41LjFcbiAqL1xuZXhwb3J0IHZhciB1bnppcCA9IGZ1bmN0aW9uIChhYnMpIHtcbiAgICB2YXIgZmEgPSBbYWJzWzBdWzBdXTtcbiAgICB2YXIgZmIgPSBbYWJzWzBdWzFdXTtcbiAgICBmb3IgKHZhciBpID0gMTsgaSA8IGFicy5sZW5ndGg7IGkrKykge1xuICAgICAgICBmYVtpXSA9IGFic1tpXVswXTtcbiAgICAgICAgZmJbaV0gPSBhYnNbaV1bMV07XG4gICAgfVxuICAgIHJldHVybiBbZmEsIGZiXTtcbn07XG4vKipcbiAqIFByZXBlbmQgYW4gZWxlbWVudCB0byBldmVyeSBtZW1iZXIgb2YgYW4gYXJyYXlcbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgcHJlcGVuZEFsbCB9IGZyb20gJ2ZwLXRzL05vbkVtcHR5QXJyYXknXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChwcmVwZW5kQWxsKDkpKFsxLCAyLCAzLCA0XSksIFs5LCAxLCA5LCAyLCA5LCAzLCA5LCA0XSlcbiAqXG4gKiBAc2luY2UgMi4xMC4wXG4gKi9cbmV4cG9ydCB2YXIgcHJlcGVuZEFsbCA9IGZ1bmN0aW9uIChtaWRkbGUpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIHZhciBvdXQgPSBbbWlkZGxlLCBhc1swXV07XG4gICAgICAgIGZvciAodmFyIGkgPSAxOyBpIDwgYXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIG91dC5wdXNoKG1pZGRsZSwgYXNbaV0pO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBvdXQ7XG4gICAgfTtcbn07XG4vKipcbiAqIFBsYWNlcyBhbiBlbGVtZW50IGluIGJldHdlZW4gbWVtYmVycyBvZiBhbiBhcnJheVxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBpbnRlcnNwZXJzZSB9IGZyb20gJ2ZwLXRzL05vbkVtcHR5QXJyYXknXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChpbnRlcnNwZXJzZSg5KShbMSwgMiwgMywgNF0pLCBbMSwgOSwgMiwgOSwgMywgOSwgNF0pXG4gKlxuICogQHNpbmNlIDIuOS4wXG4gKi9cbmV4cG9ydCB2YXIgaW50ZXJzcGVyc2UgPSBmdW5jdGlvbiAobWlkZGxlKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykge1xuICAgICAgICB2YXIgcmVzdCA9IHRhaWwoYXMpO1xuICAgICAgICByZXR1cm4gaXNOb25FbXB0eShyZXN0KSA/IHBpcGUocmVzdCwgcHJlcGVuZEFsbChtaWRkbGUpLCBwcmVwZW5kKGhlYWQoYXMpKSkgOiBjb3B5KGFzKTtcbiAgICB9O1xufTtcbi8qKlxuICogQGNhdGVnb3J5IGZvbGRpbmdcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIGZvbGRNYXBXaXRoSW5kZXggPSBSTkVBLmZvbGRNYXBXaXRoSW5kZXg7XG4vKipcbiAqIEBjYXRlZ29yeSBmb2xkaW5nXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciBmb2xkTWFwID0gUk5FQS5mb2xkTWFwO1xuLyoqXG4gKiBAY2F0ZWdvcnkgc2VxdWVuY2luZ1xuICogQHNpbmNlIDIuMTAuMFxuICovXG5leHBvcnQgdmFyIGNoYWluV2l0aEluZGV4ID0gZnVuY3Rpb24gKGYpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIHZhciBvdXQgPSBmcm9tUmVhZG9ubHlOb25FbXB0eUFycmF5KGYoMCwgaGVhZChhcykpKTtcbiAgICAgICAgZm9yICh2YXIgaSA9IDE7IGkgPCBhcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgb3V0LnB1c2guYXBwbHkob3V0LCBmKGksIGFzW2ldKSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG91dDtcbiAgICB9O1xufTtcbi8qKlxuICogQHNpbmNlIDIuMTAuMFxuICovXG5leHBvcnQgdmFyIGNob3AgPSBmdW5jdGlvbiAoZikge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgdmFyIF9hID0gZihhcyksIGIgPSBfYVswXSwgcmVzdCA9IF9hWzFdO1xuICAgICAgICB2YXIgb3V0ID0gW2JdO1xuICAgICAgICB2YXIgbmV4dCA9IHJlc3Q7XG4gICAgICAgIHdoaWxlIChpc05vbkVtcHR5KG5leHQpKSB7XG4gICAgICAgICAgICB2YXIgX2IgPSBmKG5leHQpLCBiXzEgPSBfYlswXSwgcmVzdF8yID0gX2JbMV07XG4gICAgICAgICAgICBvdXQucHVzaChiXzEpO1xuICAgICAgICAgICAgbmV4dCA9IHJlc3RfMjtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gb3V0O1xuICAgIH07XG59O1xuLyoqXG4gKiBTcGxpdHMgYSBgTm9uRW1wdHlBcnJheWAgaW50byB0d28gcGllY2VzLCB0aGUgZmlyc3QgcGllY2UgaGFzIG1heCBgbmAgZWxlbWVudHMuXG4gKlxuICogQHNpbmNlIDIuMTAuMFxuICovXG5leHBvcnQgdmFyIHNwbGl0QXQgPSBmdW5jdGlvbiAobikge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgdmFyIG0gPSBNYXRoLm1heCgxLCBuKTtcbiAgICAgICAgcmV0dXJuIG0gPj0gYXMubGVuZ3RoID8gW2NvcHkoYXMpLCBbXV0gOiBbcGlwZShhcy5zbGljZSgxLCBtKSwgcHJlcGVuZChoZWFkKGFzKSkpLCBhcy5zbGljZShtKV07XG4gICAgfTtcbn07XG4vKipcbiAqIEBzaW5jZSAyLjEwLjBcbiAqL1xuZXhwb3J0IHZhciBjaHVua3NPZiA9IGZ1bmN0aW9uIChuKSB7IHJldHVybiBjaG9wKHNwbGl0QXQobikpOyB9O1xuLyogaXN0YW5idWwgaWdub3JlIG5leHQgKi9cbnZhciBfbWFwID0gZnVuY3Rpb24gKGZhLCBmKSB7IHJldHVybiBwaXBlKGZhLCBtYXAoZikpOyB9O1xuLyogaXN0YW5idWwgaWdub3JlIG5leHQgKi9cbnZhciBfbWFwV2l0aEluZGV4ID0gZnVuY3Rpb24gKGZhLCBmKSB7IHJldHVybiBwaXBlKGZhLCBtYXBXaXRoSW5kZXgoZikpOyB9O1xuLyogaXN0YW5idWwgaWdub3JlIG5leHQgKi9cbnZhciBfYXAgPSBmdW5jdGlvbiAoZmFiLCBmYSkgeyByZXR1cm4gcGlwZShmYWIsIGFwKGZhKSk7IH07XG4vKiBpc3RhbmJ1bCBpZ25vcmUgbmV4dCAqL1xudmFyIF9leHRlbmQgPSBmdW5jdGlvbiAod2EsIGYpIHsgcmV0dXJuIHBpcGUod2EsIGV4dGVuZChmKSk7IH07XG4vKiBpc3RhbmJ1bCBpZ25vcmUgbmV4dCAqL1xudmFyIF9yZWR1Y2UgPSBmdW5jdGlvbiAoZmEsIGIsIGYpIHsgcmV0dXJuIHBpcGUoZmEsIHJlZHVjZShiLCBmKSk7IH07XG4vKiBpc3RhbmJ1bCBpZ25vcmUgbmV4dCAqL1xudmFyIF9mb2xkTWFwID0gZnVuY3Rpb24gKE0pIHtcbiAgICB2YXIgZm9sZE1hcE0gPSBmb2xkTWFwKE0pO1xuICAgIHJldHVybiBmdW5jdGlvbiAoZmEsIGYpIHsgcmV0dXJuIHBpcGUoZmEsIGZvbGRNYXBNKGYpKTsgfTtcbn07XG4vKiBpc3RhbmJ1bCBpZ25vcmUgbmV4dCAqL1xudmFyIF9yZWR1Y2VSaWdodCA9IGZ1bmN0aW9uIChmYSwgYiwgZikgeyByZXR1cm4gcGlwZShmYSwgcmVkdWNlUmlnaHQoYiwgZikpOyB9O1xuLyogaXN0YW5idWwgaWdub3JlIG5leHQgKi9cbnZhciBfdHJhdmVyc2UgPSBmdW5jdGlvbiAoRikge1xuICAgIHZhciB0cmF2ZXJzZUYgPSB0cmF2ZXJzZShGKTtcbiAgICByZXR1cm4gZnVuY3Rpb24gKHRhLCBmKSB7IHJldHVybiBwaXBlKHRhLCB0cmF2ZXJzZUYoZikpOyB9O1xufTtcbi8qIGlzdGFuYnVsIGlnbm9yZSBuZXh0ICovXG52YXIgX2FsdCA9IGZ1bmN0aW9uIChmYSwgdGhhdCkgeyByZXR1cm4gcGlwZShmYSwgYWx0KHRoYXQpKTsgfTtcbi8qIGlzdGFuYnVsIGlnbm9yZSBuZXh0ICovXG52YXIgX3JlZHVjZVdpdGhJbmRleCA9IGZ1bmN0aW9uIChmYSwgYiwgZikge1xuICAgIHJldHVybiBwaXBlKGZhLCByZWR1Y2VXaXRoSW5kZXgoYiwgZikpO1xufTtcbi8qIGlzdGFuYnVsIGlnbm9yZSBuZXh0ICovXG52YXIgX2ZvbGRNYXBXaXRoSW5kZXggPSBmdW5jdGlvbiAoTSkge1xuICAgIHZhciBmb2xkTWFwV2l0aEluZGV4TSA9IGZvbGRNYXBXaXRoSW5kZXgoTSk7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChmYSwgZikgeyByZXR1cm4gcGlwZShmYSwgZm9sZE1hcFdpdGhJbmRleE0oZikpOyB9O1xufTtcbi8qIGlzdGFuYnVsIGlnbm9yZSBuZXh0ICovXG52YXIgX3JlZHVjZVJpZ2h0V2l0aEluZGV4ID0gZnVuY3Rpb24gKGZhLCBiLCBmKSB7XG4gICAgcmV0dXJuIHBpcGUoZmEsIHJlZHVjZVJpZ2h0V2l0aEluZGV4KGIsIGYpKTtcbn07XG4vKiBpc3RhbmJ1bCBpZ25vcmUgbmV4dCAqL1xudmFyIF90cmF2ZXJzZVdpdGhJbmRleCA9IGZ1bmN0aW9uIChGKSB7XG4gICAgdmFyIHRyYXZlcnNlV2l0aEluZGV4RiA9IHRyYXZlcnNlV2l0aEluZGV4KEYpO1xuICAgIHJldHVybiBmdW5jdGlvbiAodGEsIGYpIHsgcmV0dXJuIHBpcGUodGEsIHRyYXZlcnNlV2l0aEluZGV4RihmKSk7IH07XG59O1xuLyoqXG4gKiBMZXNzIHN0cmljdCB2ZXJzaW9uIG9mIFtgYWx0YF0oI2FsdCkuXG4gKlxuICogVGhlIGBXYCBzdWZmaXggKHNob3J0IGZvciAqKlcqKmlkZW5pbmcpIG1lYW5zIHRoYXQgdGhlIHJldHVybiB0eXBlcyB3aWxsIGJlIG1lcmdlZC5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0ICogYXMgTkVBIGZyb20gJ2ZwLXRzL05vbkVtcHR5QXJyYXknXG4gKiBpbXBvcnQgeyBwaXBlIH0gZnJvbSAnZnAtdHMvZnVuY3Rpb24nXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChcbiAqICAgcGlwZShcbiAqICAgICBbMSwgMiwgM10gYXMgTkVBLk5vbkVtcHR5QXJyYXk8bnVtYmVyPixcbiAqICAgICBORUEuYWx0VygoKSA9PiBbJ2EnLCAnYiddKVxuICogICApLFxuICogICBbMSwgMiwgMywgJ2EnLCAnYiddXG4gKiApXG4gKlxuICogQGNhdGVnb3J5IGVycm9yIGhhbmRsaW5nXG4gKiBAc2luY2UgMi45LjBcbiAqL1xuZXhwb3J0IHZhciBhbHRXID0gZnVuY3Rpb24gKHRoYXQpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIHJldHVybiBwaXBlKGFzLCBjb25jYXRXKHRoYXQoKSkpO1xuICAgIH07XG59O1xuLyoqXG4gKiBJZGVudGlmaWVzIGFuIGFzc29jaWF0aXZlIG9wZXJhdGlvbiBvbiBhIHR5cGUgY29uc3RydWN0b3IuIEl0IGlzIHNpbWlsYXIgdG8gYFNlbWlncm91cGAsIGV4Y2VwdCB0aGF0IGl0IGFwcGxpZXMgdG9cbiAqIHR5cGVzIG9mIGtpbmQgYCogLT4gKmAuXG4gKlxuICogSW4gY2FzZSBvZiBgTm9uRW1wdHlBcnJheWAgY29uY2F0ZW5hdGVzIHRoZSBpbnB1dHMgaW50byBhIHNpbmdsZSBhcnJheS5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0ICogYXMgTkVBIGZyb20gJ2ZwLXRzL05vbkVtcHR5QXJyYXknXG4gKiBpbXBvcnQgeyBwaXBlIH0gZnJvbSAnZnAtdHMvZnVuY3Rpb24nXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChcbiAqICAgcGlwZShcbiAqICAgICBbMSwgMiwgM10sXG4gKiAgICAgTkVBLmFsdCgoKSA9PiBbNCwgNV0pXG4gKiAgICksXG4gKiAgIFsxLCAyLCAzLCA0LCA1XVxuICogKVxuICpcbiAqIEBjYXRlZ29yeSBlcnJvciBoYW5kbGluZ1xuICogQHNpbmNlIDIuNi4yXG4gKi9cbmV4cG9ydCB2YXIgYWx0ID0gYWx0Vztcbi8qKlxuICogQXBwbHkgYSBmdW5jdGlvbiB0byBhbiBhcmd1bWVudCB1bmRlciBhIHR5cGUgY29uc3RydWN0b3IuXG4gKlxuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgYXAgPSBmdW5jdGlvbiAoYXMpIHtcbiAgICByZXR1cm4gZmxhdE1hcChmdW5jdGlvbiAoZikgeyByZXR1cm4gcGlwZShhcywgbWFwKGYpKTsgfSk7XG59O1xuLyoqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0ICogYXMgTkVBIGZyb20gJ2ZwLXRzL05vbkVtcHR5QXJyYXknXG4gKiBpbXBvcnQgeyBwaXBlIH0gZnJvbSAnZnAtdHMvZnVuY3Rpb24nXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChcbiAqICAgcGlwZShcbiAqICAgICBbMSwgMiwgM10sXG4gKiAgICAgTkVBLmZsYXRNYXAoKG4pID0+IFtgYSR7bn1gLCBgYiR7bn1gXSlcbiAqICAgKSxcbiAqICAgWydhMScsICdiMScsICdhMicsICdiMicsICdhMycsICdiMyddXG4gKiApXG4gKlxuICogQGNhdGVnb3J5IHNlcXVlbmNpbmdcbiAqIEBzaW5jZSAyLjE0LjBcbiAqL1xuZXhwb3J0IHZhciBmbGF0TWFwID0gLyojX19QVVJFX18qLyBkdWFsKDIsIGZ1bmN0aW9uIChtYSwgZikge1xuICAgIHJldHVybiBwaXBlKG1hLCBjaGFpbldpdGhJbmRleChmdW5jdGlvbiAoaSwgYSkgeyByZXR1cm4gZihhLCBpKTsgfSkpO1xufSk7XG4vKipcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIGV4dGVuZCA9IGZ1bmN0aW9uIChmKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykge1xuICAgICAgICB2YXIgbmV4dCA9IHRhaWwoYXMpO1xuICAgICAgICB2YXIgb3V0ID0gW2YoYXMpXTtcbiAgICAgICAgd2hpbGUgKGlzTm9uRW1wdHkobmV4dCkpIHtcbiAgICAgICAgICAgIG91dC5wdXNoKGYobmV4dCkpO1xuICAgICAgICAgICAgbmV4dCA9IHRhaWwobmV4dCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG91dDtcbiAgICB9O1xufTtcbi8qKlxuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgZHVwbGljYXRlID0gLyojX19QVVJFX18qLyBleHRlbmQoaWRlbnRpdHkpO1xuLyoqXG4gKiBAY2F0ZWdvcnkgc2VxdWVuY2luZ1xuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgZmxhdHRlbiA9IC8qI19fUFVSRV9fKi8gZmxhdE1hcChpZGVudGl0eSk7XG4vKipcbiAqIGBtYXBgIGNhbiBiZSB1c2VkIHRvIHR1cm4gZnVuY3Rpb25zIGAoYTogQSkgPT4gQmAgaW50byBmdW5jdGlvbnMgYChmYTogRjxBPikgPT4gRjxCPmAgd2hvc2UgYXJndW1lbnQgYW5kIHJldHVybiB0eXBlc1xuICogdXNlIHRoZSB0eXBlIGNvbnN0cnVjdG9yIGBGYCB0byByZXByZXNlbnQgc29tZSBjb21wdXRhdGlvbmFsIGNvbnRleHQuXG4gKlxuICogQGNhdGVnb3J5IG1hcHBpbmdcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIG1hcCA9IGZ1bmN0aW9uIChmKSB7IHJldHVybiBtYXBXaXRoSW5kZXgoZnVuY3Rpb24gKF8sIGEpIHsgcmV0dXJuIGYoYSk7IH0pOyB9O1xuLyoqXG4gKiBAY2F0ZWdvcnkgbWFwcGluZ1xuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgbWFwV2l0aEluZGV4ID0gZnVuY3Rpb24gKGYpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIHZhciBvdXQgPSBbZigwLCBoZWFkKGFzKSldO1xuICAgICAgICBmb3IgKHZhciBpID0gMTsgaSA8IGFzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICBvdXQucHVzaChmKGksIGFzW2ldKSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG91dDtcbiAgICB9O1xufTtcbi8qKlxuICogQGNhdGVnb3J5IGZvbGRpbmdcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIHJlZHVjZSA9IFJORUEucmVkdWNlO1xuLyoqXG4gKiBAY2F0ZWdvcnkgZm9sZGluZ1xuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgcmVkdWNlV2l0aEluZGV4ID0gUk5FQS5yZWR1Y2VXaXRoSW5kZXg7XG4vKipcbiAqIEBjYXRlZ29yeSBmb2xkaW5nXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciByZWR1Y2VSaWdodCA9IFJORUEucmVkdWNlUmlnaHQ7XG4vKipcbiAqIEBjYXRlZ29yeSBmb2xkaW5nXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciByZWR1Y2VSaWdodFdpdGhJbmRleCA9IFJORUEucmVkdWNlUmlnaHRXaXRoSW5kZXg7XG4vKipcbiAqIEBjYXRlZ29yeSB0cmF2ZXJzaW5nXG4gKiBAc2luY2UgMi42LjNcbiAqL1xuZXhwb3J0IHZhciB0cmF2ZXJzZSA9IGZ1bmN0aW9uIChGKSB7XG4gICAgdmFyIHRyYXZlcnNlV2l0aEluZGV4RiA9IHRyYXZlcnNlV2l0aEluZGV4KEYpO1xuICAgIHJldHVybiBmdW5jdGlvbiAoZikgeyByZXR1cm4gdHJhdmVyc2VXaXRoSW5kZXhGKGZ1bmN0aW9uIChfLCBhKSB7IHJldHVybiBmKGEpOyB9KTsgfTtcbn07XG4vKipcbiAqIEBjYXRlZ29yeSB0cmF2ZXJzaW5nXG4gKiBAc2luY2UgMi42LjNcbiAqL1xuZXhwb3J0IHZhciBzZXF1ZW5jZSA9IGZ1bmN0aW9uIChGKSB7IHJldHVybiB0cmF2ZXJzZVdpdGhJbmRleChGKShmdW5jdGlvbiAoXywgYSkgeyByZXR1cm4gYTsgfSk7IH07XG4vKipcbiAqIEBjYXRlZ29yeSBzZXF1ZW5jaW5nXG4gKiBAc2luY2UgMi42LjNcbiAqL1xuZXhwb3J0IHZhciB0cmF2ZXJzZVdpdGhJbmRleCA9IGZ1bmN0aW9uIChGKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChmKSB7XG4gICAgICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgICAgIHZhciBvdXQgPSBGLm1hcChmKDAsIGhlYWQoYXMpKSwgb2YpO1xuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDE7IGkgPCBhcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgIG91dCA9IEYuYXAoRi5tYXAob3V0LCBmdW5jdGlvbiAoYnMpIHsgcmV0dXJuIGZ1bmN0aW9uIChiKSB7IHJldHVybiBwaXBlKGJzLCBhcHBlbmQoYikpOyB9OyB9KSwgZihpLCBhc1tpXSkpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIG91dDtcbiAgICAgICAgfTtcbiAgICB9O1xufTtcbi8qKlxuICogQHNpbmNlIDIuNy4wXG4gKi9cbmV4cG9ydCB2YXIgZXh0cmFjdCA9IFJORUEuaGVhZDtcbi8qKlxuICogQGNhdGVnb3J5IHR5cGUgbGFtYmRhc1xuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgVVJJID0gJ05vbkVtcHR5QXJyYXknO1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciBnZXRTaG93ID0gUk5FQS5nZXRTaG93O1xuLyoqXG4gKiBCdWlsZHMgYSBgU2VtaWdyb3VwYCBpbnN0YW5jZSBmb3IgYE5vbkVtcHR5QXJyYXlgXG4gKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgZ2V0U2VtaWdyb3VwID0gZnVuY3Rpb24gKCkgeyByZXR1cm4gKHtcbiAgICBjb25jYXQ6IGNvbmNhdFxufSk7IH07XG4vKipcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBnZXRFcSB9IGZyb20gJ2ZwLXRzL05vbkVtcHR5QXJyYXknXG4gKiBpbXBvcnQgKiBhcyBOIGZyb20gJ2ZwLXRzL251bWJlcidcbiAqXG4gKiBjb25zdCBFID0gZ2V0RXEoTi5FcSlcbiAqIGFzc2VydC5zdHJpY3RFcXVhbChFLmVxdWFscyhbMSwgMl0sIFsxLCAyXSksIHRydWUpXG4gKiBhc3NlcnQuc3RyaWN0RXF1YWwoRS5lcXVhbHMoWzEsIDJdLCBbMSwgM10pLCBmYWxzZSlcbiAqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciBnZXRFcSA9IFJORUEuZ2V0RXE7XG4vKipcbiAqIEBzaW5jZSAyLjExLjBcbiAqL1xuZXhwb3J0IHZhciBnZXRVbmlvblNlbWlncm91cCA9IGZ1bmN0aW9uIChFKSB7XG4gICAgdmFyIHVuaW9uRSA9IHVuaW9uKEUpO1xuICAgIHJldHVybiB7XG4gICAgICAgIGNvbmNhdDogZnVuY3Rpb24gKGZpcnN0LCBzZWNvbmQpIHsgcmV0dXJuIHVuaW9uRShzZWNvbmQpKGZpcnN0KTsgfVxuICAgIH07XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi43LjBcbiAqL1xuZXhwb3J0IHZhciBGdW5jdG9yID0ge1xuICAgIFVSSTogVVJJLFxuICAgIG1hcDogX21hcFxufTtcbi8qKlxuICogQGNhdGVnb3J5IG1hcHBpbmdcbiAqIEBzaW5jZSAyLjEwLjBcbiAqL1xuZXhwb3J0IHZhciBmbGFwID0gLyojX19QVVJFX18qLyBmbGFwXyhGdW5jdG9yKTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuMTAuMFxuICovXG5leHBvcnQgdmFyIFBvaW50ZWQgPSB7XG4gICAgVVJJOiBVUkksXG4gICAgb2Y6IG9mXG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi43LjBcbiAqL1xuZXhwb3J0IHZhciBGdW5jdG9yV2l0aEluZGV4ID0ge1xuICAgIFVSSTogVVJJLFxuICAgIG1hcDogX21hcCxcbiAgICBtYXBXaXRoSW5kZXg6IF9tYXBXaXRoSW5kZXhcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjEwLjBcbiAqL1xuZXhwb3J0IHZhciBBcHBseSA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICBtYXA6IF9tYXAsXG4gICAgYXA6IF9hcFxufTtcbi8qKlxuICogQ29tYmluZSB0d28gZWZmZWN0ZnVsIGFjdGlvbnMsIGtlZXBpbmcgb25seSB0aGUgcmVzdWx0IG9mIHRoZSBmaXJzdC5cbiAqXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBhcEZpcnN0ID0gLyojX19QVVJFX18qLyBhcEZpcnN0XyhBcHBseSk7XG4vKipcbiAqIENvbWJpbmUgdHdvIGVmZmVjdGZ1bCBhY3Rpb25zLCBrZWVwaW5nIG9ubHkgdGhlIHJlc3VsdCBvZiB0aGUgc2Vjb25kLlxuICpcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIGFwU2Vjb25kID0gLyojX19QVVJFX18qLyBhcFNlY29uZF8oQXBwbHkpO1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi43LjBcbiAqL1xuZXhwb3J0IHZhciBBcHBsaWNhdGl2ZSA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICBtYXA6IF9tYXAsXG4gICAgYXA6IF9hcCxcbiAgICBvZjogb2Zcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjEwLjBcbiAqL1xuZXhwb3J0IHZhciBDaGFpbiA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICBtYXA6IF9tYXAsXG4gICAgYXA6IF9hcCxcbiAgICBjaGFpbjogZmxhdE1hcFxufTtcbi8qKlxuICogQ29tcG9zZXMgY29tcHV0YXRpb25zIGluIHNlcXVlbmNlLCB1c2luZyB0aGUgcmV0dXJuIHZhbHVlIG9mIG9uZSBjb21wdXRhdGlvbiB0byBkZXRlcm1pbmUgdGhlIG5leHQgY29tcHV0YXRpb24gYW5kXG4gKiBrZWVwaW5nIG9ubHkgdGhlIHJlc3VsdCBvZiB0aGUgZmlyc3QuXG4gKlxuICogQGNhdGVnb3J5IHNlcXVlbmNpbmdcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIGNoYWluRmlyc3QgPSBcbi8qI19fUFVSRV9fKi8gY2hhaW5GaXJzdF8oQ2hhaW4pO1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi43LjBcbiAqL1xuZXhwb3J0IHZhciBNb25hZCA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICBtYXA6IF9tYXAsXG4gICAgYXA6IF9hcCxcbiAgICBvZjogb2YsXG4gICAgY2hhaW46IGZsYXRNYXBcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjcuMFxuICovXG5leHBvcnQgdmFyIEZvbGRhYmxlID0ge1xuICAgIFVSSTogVVJJLFxuICAgIHJlZHVjZTogX3JlZHVjZSxcbiAgICBmb2xkTWFwOiBfZm9sZE1hcCxcbiAgICByZWR1Y2VSaWdodDogX3JlZHVjZVJpZ2h0XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi43LjBcbiAqL1xuZXhwb3J0IHZhciBGb2xkYWJsZVdpdGhJbmRleCA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICByZWR1Y2U6IF9yZWR1Y2UsXG4gICAgZm9sZE1hcDogX2ZvbGRNYXAsXG4gICAgcmVkdWNlUmlnaHQ6IF9yZWR1Y2VSaWdodCxcbiAgICByZWR1Y2VXaXRoSW5kZXg6IF9yZWR1Y2VXaXRoSW5kZXgsXG4gICAgZm9sZE1hcFdpdGhJbmRleDogX2ZvbGRNYXBXaXRoSW5kZXgsXG4gICAgcmVkdWNlUmlnaHRXaXRoSW5kZXg6IF9yZWR1Y2VSaWdodFdpdGhJbmRleFxufTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuNy4wXG4gKi9cbmV4cG9ydCB2YXIgVHJhdmVyc2FibGUgPSB7XG4gICAgVVJJOiBVUkksXG4gICAgbWFwOiBfbWFwLFxuICAgIHJlZHVjZTogX3JlZHVjZSxcbiAgICBmb2xkTWFwOiBfZm9sZE1hcCxcbiAgICByZWR1Y2VSaWdodDogX3JlZHVjZVJpZ2h0LFxuICAgIHRyYXZlcnNlOiBfdHJhdmVyc2UsXG4gICAgc2VxdWVuY2U6IHNlcXVlbmNlXG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi43LjBcbiAqL1xuZXhwb3J0IHZhciBUcmF2ZXJzYWJsZVdpdGhJbmRleCA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICBtYXA6IF9tYXAsXG4gICAgbWFwV2l0aEluZGV4OiBfbWFwV2l0aEluZGV4LFxuICAgIHJlZHVjZTogX3JlZHVjZSxcbiAgICBmb2xkTWFwOiBfZm9sZE1hcCxcbiAgICByZWR1Y2VSaWdodDogX3JlZHVjZVJpZ2h0LFxuICAgIHRyYXZlcnNlOiBfdHJhdmVyc2UsXG4gICAgc2VxdWVuY2U6IHNlcXVlbmNlLFxuICAgIHJlZHVjZVdpdGhJbmRleDogX3JlZHVjZVdpdGhJbmRleCxcbiAgICBmb2xkTWFwV2l0aEluZGV4OiBfZm9sZE1hcFdpdGhJbmRleCxcbiAgICByZWR1Y2VSaWdodFdpdGhJbmRleDogX3JlZHVjZVJpZ2h0V2l0aEluZGV4LFxuICAgIHRyYXZlcnNlV2l0aEluZGV4OiBfdHJhdmVyc2VXaXRoSW5kZXhcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjcuMFxuICovXG5leHBvcnQgdmFyIEFsdCA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICBtYXA6IF9tYXAsXG4gICAgYWx0OiBfYWx0XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi43LjBcbiAqL1xuZXhwb3J0IHZhciBDb21vbmFkID0ge1xuICAgIFVSSTogVVJJLFxuICAgIG1hcDogX21hcCxcbiAgICBleHRlbmQ6IF9leHRlbmQsXG4gICAgZXh0cmFjdDogZXh0cmFjdFxufTtcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8vIGRvIG5vdGF0aW9uXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vKipcbiAqIEBjYXRlZ29yeSBkbyBub3RhdGlvblxuICogQHNpbmNlIDIuOS4wXG4gKi9cbmV4cG9ydCB2YXIgRG8gPSAvKiNfX1BVUkVfXyovIG9mKF8uZW1wdHlSZWNvcmQpO1xuLyoqXG4gKiBAY2F0ZWdvcnkgZG8gbm90YXRpb25cbiAqIEBzaW5jZSAyLjguMFxuICovXG5leHBvcnQgdmFyIGJpbmRUbyA9IC8qI19fUFVSRV9fKi8gYmluZFRvXyhGdW5jdG9yKTtcbnZhciBsZXRfID0gLyojX19QVVJFX18qLyBsZXRfXyhGdW5jdG9yKTtcbmV4cG9ydCB7IFxuLyoqXG4gKiBAY2F0ZWdvcnkgZG8gbm90YXRpb25cbiAqIEBzaW5jZSAyLjEzLjBcbiAqL1xubGV0XyBhcyBsZXQgfTtcbi8qKlxuICogQGNhdGVnb3J5IGRvIG5vdGF0aW9uXG4gKiBAc2luY2UgMi44LjBcbiAqL1xuZXhwb3J0IHZhciBiaW5kID0gLyojX19QVVJFX18qLyBiaW5kXyhDaGFpbik7XG4vKipcbiAqIEBjYXRlZ29yeSBkbyBub3RhdGlvblxuICogQHNpbmNlIDIuOC4wXG4gKi9cbmV4cG9ydCB2YXIgYXBTID0gLyojX19QVVJFX18qLyBhcFNfKEFwcGx5KTtcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8vIHV0aWxzXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vKipcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIGhlYWQgPSBSTkVBLmhlYWQ7XG4vKipcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIHRhaWwgPSBmdW5jdGlvbiAoYXMpIHsgcmV0dXJuIGFzLnNsaWNlKDEpOyB9O1xuLyoqXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciBsYXN0ID0gUk5FQS5sYXN0O1xuLyoqXG4gKiBHZXQgYWxsIGJ1dCB0aGUgbGFzdCBlbGVtZW50IG9mIGEgbm9uIGVtcHR5IGFycmF5LCBjcmVhdGluZyBhIG5ldyBhcnJheS5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgaW5pdCB9IGZyb20gJ2ZwLXRzL05vbkVtcHR5QXJyYXknXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChpbml0KFsxLCAyLCAzXSksIFsxLCAyXSlcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoaW5pdChbMV0pLCBbXSlcbiAqXG4gKiBAc2luY2UgMi4yLjBcbiAqL1xuZXhwb3J0IHZhciBpbml0ID0gZnVuY3Rpb24gKGFzKSB7IHJldHVybiBhcy5zbGljZSgwLCAtMSk7IH07XG4vKipcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIG1pbiA9IFJORUEubWluO1xuLyoqXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciBtYXggPSBSTkVBLm1heDtcbi8qKlxuICogQHNpbmNlIDIuMTAuMFxuICovXG5leHBvcnQgdmFyIGNvbmNhdEFsbCA9IGZ1bmN0aW9uIChTKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykge1xuICAgICAgICByZXR1cm4gYXMucmVkdWNlKFMuY29uY2F0KTtcbiAgICB9O1xufTtcbi8qKlxuICogQnJlYWsgYW4gYEFycmF5YCBpbnRvIGl0cyBmaXJzdCBlbGVtZW50IGFuZCByZW1haW5pbmcgZWxlbWVudHMuXG4gKlxuICogQGNhdGVnb3J5IHBhdHRlcm4gbWF0Y2hpbmdcbiAqIEBzaW5jZSAyLjExLjBcbiAqL1xuZXhwb3J0IHZhciBtYXRjaExlZnQgPSBmdW5jdGlvbiAoZikge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgcmV0dXJuIGYoaGVhZChhcyksIHRhaWwoYXMpKTtcbiAgICB9O1xufTtcbi8qKlxuICogQnJlYWsgYW4gYEFycmF5YCBpbnRvIGl0cyBpbml0aWFsIGVsZW1lbnRzIGFuZCB0aGUgbGFzdCBlbGVtZW50LlxuICpcbiAqIEBjYXRlZ29yeSBwYXR0ZXJuIG1hdGNoaW5nXG4gKiBAc2luY2UgMi4xMS4wXG4gKi9cbmV4cG9ydCB2YXIgbWF0Y2hSaWdodCA9IGZ1bmN0aW9uIChmKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykge1xuICAgICAgICByZXR1cm4gZihpbml0KGFzKSwgbGFzdChhcykpO1xuICAgIH07XG59O1xuLyoqXG4gKiBBcHBseSBhIGZ1bmN0aW9uIHRvIHRoZSBoZWFkLCBjcmVhdGluZyBhIG5ldyBgTm9uRW1wdHlBcnJheWAuXG4gKlxuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIG1vZGlmeUhlYWQgPSBmdW5jdGlvbiAoZikge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgcmV0dXJuIF9fc3ByZWFkQXJyYXkoW2YoaGVhZChhcykpXSwgdGFpbChhcyksIHRydWUpO1xuICAgIH07XG59O1xuLyoqXG4gKiBDaGFuZ2UgdGhlIGhlYWQsIGNyZWF0aW5nIGEgbmV3IGBOb25FbXB0eUFycmF5YC5cbiAqXG4gKiBAc2luY2UgMi4xMS4wXG4gKi9cbmV4cG9ydCB2YXIgdXBkYXRlSGVhZCA9IGZ1bmN0aW9uIChhKSB7IHJldHVybiBtb2RpZnlIZWFkKGZ1bmN0aW9uICgpIHsgcmV0dXJuIGE7IH0pOyB9O1xuLyoqXG4gKiBBcHBseSBhIGZ1bmN0aW9uIHRvIHRoZSBsYXN0IGVsZW1lbnQsIGNyZWF0aW5nIGEgbmV3IGBOb25FbXB0eUFycmF5YC5cbiAqXG4gKiBAc2luY2UgMi4xMS4wXG4gKi9cbmV4cG9ydCB2YXIgbW9kaWZ5TGFzdCA9IGZ1bmN0aW9uIChmKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykge1xuICAgICAgICByZXR1cm4gcGlwZShpbml0KGFzKSwgYXBwZW5kKGYobGFzdChhcykpKSk7XG4gICAgfTtcbn07XG4vKipcbiAqIENoYW5nZSB0aGUgbGFzdCBlbGVtZW50LCBjcmVhdGluZyBhIG5ldyBgTm9uRW1wdHlBcnJheWAuXG4gKlxuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIHVwZGF0ZUxhc3QgPSBmdW5jdGlvbiAoYSkgeyByZXR1cm4gbW9kaWZ5TGFzdChmdW5jdGlvbiAoKSB7IHJldHVybiBhOyB9KTsgfTtcbi8qKlxuICogUGxhY2VzIGFuIGVsZW1lbnQgaW4gYmV0d2VlbiBtZW1iZXJzIG9mIGEgYE5vbkVtcHR5QXJyYXlgLCB0aGVuIGZvbGRzIHRoZSByZXN1bHRzIHVzaW5nIHRoZSBwcm92aWRlZCBgU2VtaWdyb3VwYC5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0ICogYXMgUyBmcm9tICdmcC10cy9zdHJpbmcnXG4gKiBpbXBvcnQgeyBpbnRlcmNhbGF0ZSB9IGZyb20gJ2ZwLXRzL05vbkVtcHR5QXJyYXknXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChpbnRlcmNhbGF0ZShTLlNlbWlncm91cCkoJy0nKShbJ2EnLCAnYicsICdjJ10pLCAnYS1iLWMnKVxuICpcbiAqIEBzaW5jZSAyLjEyLjBcbiAqL1xuZXhwb3J0IHZhciBpbnRlcmNhbGF0ZSA9IFJORUEuaW50ZXJjYWxhdGU7XG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vLyBsZWdhY3lcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8qKlxuICogQWxpYXMgb2YgYGZsYXRNYXBgLlxuICpcbiAqIEBjYXRlZ29yeSBsZWdhY3lcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIGNoYWluID0gZmxhdE1hcDtcbmV4cG9ydCBmdW5jdGlvbiBncm91cFNvcnQoTykge1xuICAgIHZhciBzb3J0TyA9IHNvcnQoTyk7XG4gICAgdmFyIGdyb3VwTyA9IGdyb3VwKE8pO1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHsgcmV0dXJuIChpc05vbkVtcHR5KGFzKSA/IGdyb3VwTyhzb3J0TyhhcykpIDogW10pOyB9O1xufVxuZXhwb3J0IGZ1bmN0aW9uIGZpbHRlcihwcmVkaWNhdGUpIHtcbiAgICByZXR1cm4gZmlsdGVyV2l0aEluZGV4KGZ1bmN0aW9uIChfLCBhKSB7IHJldHVybiBwcmVkaWNhdGUoYSk7IH0pO1xufVxuLyoqXG4gKiBVc2UgW2BmaWx0ZXJXaXRoSW5kZXhgXSguL0FycmF5LnRzLmh0bWwjZmlsdGVyd2l0aGluZGV4KSBpbnN0ZWFkLlxuICpcbiAqIEBjYXRlZ29yeSB6b25lIG9mIGRlYXRoXG4gKiBAc2luY2UgMi4wLjBcbiAqIEBkZXByZWNhdGVkXG4gKi9cbmV4cG9ydCB2YXIgZmlsdGVyV2l0aEluZGV4ID0gZnVuY3Rpb24gKHByZWRpY2F0ZSkge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgcmV0dXJuIGZyb21BcnJheShhcy5maWx0ZXIoZnVuY3Rpb24gKGEsIGkpIHsgcmV0dXJuIHByZWRpY2F0ZShpLCBhKTsgfSkpO1xuICAgIH07XG59O1xuLyoqXG4gKiBVc2UgW2B1bnByZXBlbmRgXSgjdW5wcmVwZW5kKSBpbnN0ZWFkLlxuICpcbiAqIEBjYXRlZ29yeSB6b25lIG9mIGRlYXRoXG4gKiBAc2luY2UgMi45LjBcbiAqIEBkZXByZWNhdGVkXG4gKi9cbmV4cG9ydCB2YXIgdW5jb25zID0gdW5wcmVwZW5kO1xuLyoqXG4gKiBVc2UgW2B1bmFwcGVuZGBdKCN1bmFwcGVuZCkgaW5zdGVhZC5cbiAqXG4gKiBAY2F0ZWdvcnkgem9uZSBvZiBkZWF0aFxuICogQHNpbmNlIDIuOS4wXG4gKiBAZGVwcmVjYXRlZFxuICovXG5leHBvcnQgdmFyIHVuc25vYyA9IHVuYXBwZW5kO1xuZXhwb3J0IGZ1bmN0aW9uIGNvbnMoaGVhZCwgdGFpbCkge1xuICAgIHJldHVybiB0YWlsID09PSB1bmRlZmluZWQgPyBwcmVwZW5kKGhlYWQpIDogcGlwZSh0YWlsLCBwcmVwZW5kKGhlYWQpKTtcbn1cbi8qKlxuICogVXNlIFtgYXBwZW5kYF0oLi9BcnJheS50cy5odG1sI2FwcGVuZCkgaW5zdGVhZC5cbiAqXG4gKiBAY2F0ZWdvcnkgem9uZSBvZiBkZWF0aFxuICogQHNpbmNlIDIuMC4wXG4gKiBAZGVwcmVjYXRlZFxuICovXG5leHBvcnQgdmFyIHNub2MgPSBmdW5jdGlvbiAoaW5pdCwgZW5kKSB7IHJldHVybiBwaXBlKGluaXQsIGFwcGVuZChlbmQpKTsgfTtcbi8qKlxuICogVXNlIFtgcHJlcGVuZEFsbGBdKCNwcmVwZW5kYWxsKSBpbnN0ZWFkLlxuICpcbiAqIEBjYXRlZ29yeSB6b25lIG9mIGRlYXRoXG4gKiBAc2luY2UgMi45LjBcbiAqIEBkZXByZWNhdGVkXG4gKi9cbmV4cG9ydCB2YXIgcHJlcGVuZFRvQWxsID0gcHJlcGVuZEFsbDtcbi8qKlxuICogVXNlIFtgY29uY2F0QWxsYF0oI2NvbmNhdGFsbCkgaW5zdGVhZC5cbiAqXG4gKiBAY2F0ZWdvcnkgem9uZSBvZiBkZWF0aFxuICogQHNpbmNlIDIuNS4wXG4gKiBAZGVwcmVjYXRlZFxuICovXG5leHBvcnQgdmFyIGZvbGQgPSBSTkVBLmNvbmNhdEFsbDtcbi8qKlxuICogVGhpcyBpbnN0YW5jZSBpcyBkZXByZWNhdGVkLCB1c2Ugc21hbGwsIHNwZWNpZmljIGluc3RhbmNlcyBpbnN0ZWFkLlxuICogRm9yIGV4YW1wbGUgaWYgYSBmdW5jdGlvbiBuZWVkcyBhIGBGdW5jdG9yYCBpbnN0YW5jZSwgcGFzcyBgTkVBLkZ1bmN0b3JgIGluc3RlYWQgb2YgYE5FQS5ub25FbXB0eUFycmF5YFxuICogKHdoZXJlIGBORUFgIGlzIGZyb20gYGltcG9ydCBORUEgZnJvbSAnZnAtdHMvTm9uRW1wdHlBcnJheSdgKVxuICpcbiAqIEBjYXRlZ29yeSB6b25lIG9mIGRlYXRoXG4gKiBAc2luY2UgMi4wLjBcbiAqIEBkZXByZWNhdGVkXG4gKi9cbmV4cG9ydCB2YXIgbm9uRW1wdHlBcnJheSA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICBvZjogb2YsXG4gICAgbWFwOiBfbWFwLFxuICAgIG1hcFdpdGhJbmRleDogX21hcFdpdGhJbmRleCxcbiAgICBhcDogX2FwLFxuICAgIGNoYWluOiBmbGF0TWFwLFxuICAgIGV4dGVuZDogX2V4dGVuZCxcbiAgICBleHRyYWN0OiBleHRyYWN0LFxuICAgIHJlZHVjZTogX3JlZHVjZSxcbiAgICBmb2xkTWFwOiBfZm9sZE1hcCxcbiAgICByZWR1Y2VSaWdodDogX3JlZHVjZVJpZ2h0LFxuICAgIHRyYXZlcnNlOiBfdHJhdmVyc2UsXG4gICAgc2VxdWVuY2U6IHNlcXVlbmNlLFxuICAgIHJlZHVjZVdpdGhJbmRleDogX3JlZHVjZVdpdGhJbmRleCxcbiAgICBmb2xkTWFwV2l0aEluZGV4OiBfZm9sZE1hcFdpdGhJbmRleCxcbiAgICByZWR1Y2VSaWdodFdpdGhJbmRleDogX3JlZHVjZVJpZ2h0V2l0aEluZGV4LFxuICAgIHRyYXZlcnNlV2l0aEluZGV4OiBfdHJhdmVyc2VXaXRoSW5kZXgsXG4gICAgYWx0OiBfYWx0XG59O1xuIiwKICAidmFyIF9fc3ByZWFkQXJyYXkgPSAodGhpcyAmJiB0aGlzLl9fc3ByZWFkQXJyYXkpIHx8IGZ1bmN0aW9uICh0bywgZnJvbSwgcGFjaykge1xuICAgIGlmIChwYWNrIHx8IGFyZ3VtZW50cy5sZW5ndGggPT09IDIpIGZvciAodmFyIGkgPSAwLCBsID0gZnJvbS5sZW5ndGgsIGFyOyBpIDwgbDsgaSsrKSB7XG4gICAgICAgIGlmIChhciB8fCAhKGkgaW4gZnJvbSkpIHtcbiAgICAgICAgICAgIGlmICghYXIpIGFyID0gQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoZnJvbSwgMCwgaSk7XG4gICAgICAgICAgICBhcltpXSA9IGZyb21baV07XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHRvLmNvbmNhdChhciB8fCBBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChmcm9tKSk7XG59O1xuaW1wb3J0IHsgYXBGaXJzdCBhcyBhcEZpcnN0XywgYXBTIGFzIGFwU18sIGFwU2Vjb25kIGFzIGFwU2Vjb25kXyB9IGZyb20gJy4vQXBwbHknO1xuaW1wb3J0IHsgYmluZCBhcyBiaW5kXywgY2hhaW5GaXJzdCBhcyBjaGFpbkZpcnN0XyB9IGZyb20gJy4vQ2hhaW4nO1xuaW1wb3J0IHsgZHVhbCwgaWRlbnRpdHksIHBpcGUgfSBmcm9tICcuL2Z1bmN0aW9uJztcbmltcG9ydCB7IGJpbmRUbyBhcyBiaW5kVG9fLCBmbGFwIGFzIGZsYXBfLCBsZXQgYXMgbGV0X18gfSBmcm9tICcuL0Z1bmN0b3InO1xuaW1wb3J0ICogYXMgXyBmcm9tICcuL2ludGVybmFsJztcbmltcG9ydCB7IGdldE1vbm9pZCB9IGZyb20gJy4vT3JkJztcbmltcG9ydCAqIGFzIFJORUEgZnJvbSAnLi9SZWFkb25seU5vbkVtcHR5QXJyYXknO1xuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLy8gaW50ZXJuYWxcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8qKlxuICogQGludGVybmFsXG4gKi9cbmV4cG9ydCB2YXIgaXNOb25FbXB0eSA9IGZ1bmN0aW9uIChhcykgeyByZXR1cm4gYXMubGVuZ3RoID4gMDsgfTtcbi8qKlxuICogQGludGVybmFsXG4gKi9cbmV4cG9ydCB2YXIgaXNPdXRPZkJvdW5kID0gZnVuY3Rpb24gKGksIGFzKSB7IHJldHVybiBpIDwgMCB8fCBpID49IGFzLmxlbmd0aDsgfTtcbi8qKlxuICogQGludGVybmFsXG4gKi9cbmV4cG9ydCB2YXIgcHJlcGVuZFcgPSBmdW5jdGlvbiAoaGVhZCkge1xuICAgIHJldHVybiBmdW5jdGlvbiAodGFpbCkge1xuICAgICAgICByZXR1cm4gX19zcHJlYWRBcnJheShbaGVhZF0sIHRhaWwsIHRydWUpO1xuICAgIH07XG59O1xuLyoqXG4gKiBAaW50ZXJuYWxcbiAqL1xuZXhwb3J0IHZhciBwcmVwZW5kID0gcHJlcGVuZFc7XG4vKipcbiAqIEBpbnRlcm5hbFxuICovXG5leHBvcnQgdmFyIGFwcGVuZFcgPSBmdW5jdGlvbiAoZW5kKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChpbml0KSB7XG4gICAgICAgIHJldHVybiBfX3NwcmVhZEFycmF5KF9fc3ByZWFkQXJyYXkoW10sIGluaXQsIHRydWUpLCBbZW5kXSwgZmFsc2UpO1xuICAgIH07XG59O1xuLyoqXG4gKiBAaW50ZXJuYWxcbiAqL1xuZXhwb3J0IHZhciBhcHBlbmQgPSBhcHBlbmRXO1xuLyoqXG4gKiBAaW50ZXJuYWxcbiAqL1xuZXhwb3J0IHZhciB1bnNhZmVJbnNlcnRBdCA9IGZ1bmN0aW9uIChpLCBhLCBhcykge1xuICAgIGlmIChpc05vbkVtcHR5KGFzKSkge1xuICAgICAgICB2YXIgeHMgPSBmcm9tUmVhZG9ubHlOb25FbXB0eUFycmF5KGFzKTtcbiAgICAgICAgeHMuc3BsaWNlKGksIDAsIGEpO1xuICAgICAgICByZXR1cm4geHM7XG4gICAgfVxuICAgIHJldHVybiBbYV07XG59O1xuLyoqXG4gKiBAaW50ZXJuYWxcbiAqL1xuZXhwb3J0IHZhciB1bnNhZmVVcGRhdGVBdCA9IGZ1bmN0aW9uIChpLCBhLCBhcykge1xuICAgIHZhciB4cyA9IGZyb21SZWFkb25seU5vbkVtcHR5QXJyYXkoYXMpO1xuICAgIHhzW2ldID0gYTtcbiAgICByZXR1cm4geHM7XG59O1xuLyoqXG4gKiBSZW1vdmUgZHVwbGljYXRlcyBmcm9tIGEgYE5vbkVtcHR5QXJyYXlgLCBrZWVwaW5nIHRoZSBmaXJzdCBvY2N1cnJlbmNlIG9mIGFuIGVsZW1lbnQuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IHVuaXEgfSBmcm9tICdmcC10cy9Ob25FbXB0eUFycmF5J1xuICogaW1wb3J0ICogYXMgTiBmcm9tICdmcC10cy9udW1iZXInXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbCh1bmlxKE4uRXEpKFsxLCAyLCAxXSksIFsxLCAyXSlcbiAqXG4gKiBAc2luY2UgMi4xMS4wXG4gKi9cbmV4cG9ydCB2YXIgdW5pcSA9IGZ1bmN0aW9uIChFKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykge1xuICAgICAgICBpZiAoYXMubGVuZ3RoID09PSAxKSB7XG4gICAgICAgICAgICByZXR1cm4gY29weShhcyk7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIG91dCA9IFtoZWFkKGFzKV07XG4gICAgICAgIHZhciByZXN0ID0gdGFpbChhcyk7XG4gICAgICAgIHZhciBfbG9vcF8xID0gZnVuY3Rpb24gKGEpIHtcbiAgICAgICAgICAgIGlmIChvdXQuZXZlcnkoZnVuY3Rpb24gKG8pIHsgcmV0dXJuICFFLmVxdWFscyhvLCBhKTsgfSkpIHtcbiAgICAgICAgICAgICAgICBvdXQucHVzaChhKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgZm9yICh2YXIgX2kgPSAwLCByZXN0XzEgPSByZXN0OyBfaSA8IHJlc3RfMS5sZW5ndGg7IF9pKyspIHtcbiAgICAgICAgICAgIHZhciBhID0gcmVzdF8xW19pXTtcbiAgICAgICAgICAgIF9sb29wXzEoYSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG91dDtcbiAgICB9O1xufTtcbi8qKlxuICogU29ydCB0aGUgZWxlbWVudHMgb2YgYSBgTm9uRW1wdHlBcnJheWAgaW4gaW5jcmVhc2luZyBvcmRlciwgd2hlcmUgZWxlbWVudHMgYXJlIGNvbXBhcmVkIHVzaW5nIGZpcnN0IGBvcmRzWzBdYCwgdGhlbiBgb3Jkc1sxXWAsXG4gKiBldGMuLi5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0ICogYXMgTkVBIGZyb20gJ2ZwLXRzL05vbkVtcHR5QXJyYXknXG4gKiBpbXBvcnQgeyBjb250cmFtYXAgfSBmcm9tICdmcC10cy9PcmQnXG4gKiBpbXBvcnQgKiBhcyBTIGZyb20gJ2ZwLXRzL3N0cmluZydcbiAqIGltcG9ydCAqIGFzIE4gZnJvbSAnZnAtdHMvbnVtYmVyJ1xuICogaW1wb3J0IHsgcGlwZSB9IGZyb20gJ2ZwLXRzL2Z1bmN0aW9uJ1xuICpcbiAqIGludGVyZmFjZSBQZXJzb24ge1xuICogICBuYW1lOiBzdHJpbmdcbiAqICAgYWdlOiBudW1iZXJcbiAqIH1cbiAqXG4gKiBjb25zdCBieU5hbWUgPSBwaXBlKFMuT3JkLCBjb250cmFtYXAoKHA6IFBlcnNvbikgPT4gcC5uYW1lKSlcbiAqXG4gKiBjb25zdCBieUFnZSA9IHBpcGUoTi5PcmQsIGNvbnRyYW1hcCgocDogUGVyc29uKSA9PiBwLmFnZSkpXG4gKlxuICogY29uc3Qgc29ydEJ5TmFtZUJ5QWdlID0gTkVBLnNvcnRCeShbYnlOYW1lLCBieUFnZV0pXG4gKlxuICogY29uc3QgcGVyc29uczogTkVBLk5vbkVtcHR5QXJyYXk8UGVyc29uPiA9IFtcbiAqICAgeyBuYW1lOiAnYScsIGFnZTogMSB9LFxuICogICB7IG5hbWU6ICdiJywgYWdlOiAzIH0sXG4gKiAgIHsgbmFtZTogJ2MnLCBhZ2U6IDIgfSxcbiAqICAgeyBuYW1lOiAnYicsIGFnZTogMiB9XG4gKiBdXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChzb3J0QnlOYW1lQnlBZ2UocGVyc29ucyksIFtcbiAqICAgeyBuYW1lOiAnYScsIGFnZTogMSB9LFxuICogICB7IG5hbWU6ICdiJywgYWdlOiAyIH0sXG4gKiAgIHsgbmFtZTogJ2InLCBhZ2U6IDMgfSxcbiAqICAgeyBuYW1lOiAnYycsIGFnZTogMiB9XG4gKiBdKVxuICpcbiAqIEBzaW5jZSAyLjExLjBcbiAqL1xuZXhwb3J0IHZhciBzb3J0QnkgPSBmdW5jdGlvbiAob3Jkcykge1xuICAgIGlmIChpc05vbkVtcHR5KG9yZHMpKSB7XG4gICAgICAgIHZhciBNID0gZ2V0TW9ub2lkKCk7XG4gICAgICAgIHJldHVybiBzb3J0KG9yZHMucmVkdWNlKE0uY29uY2F0LCBNLmVtcHR5KSk7XG4gICAgfVxuICAgIHJldHVybiBjb3B5O1xufTtcbi8qKlxuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIHVuaW9uID0gZnVuY3Rpb24gKEUpIHtcbiAgICB2YXIgdW5pcUUgPSB1bmlxKEUpO1xuICAgIHJldHVybiBmdW5jdGlvbiAoc2Vjb25kKSB7IHJldHVybiBmdW5jdGlvbiAoZmlyc3QpIHsgcmV0dXJuIHVuaXFFKHBpcGUoZmlyc3QsIGNvbmNhdChzZWNvbmQpKSk7IH07IH07XG59O1xuLyoqXG4gKiBSb3RhdGUgYSBgTm9uRW1wdHlBcnJheWAgYnkgYG5gIHN0ZXBzLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyByb3RhdGUgfSBmcm9tICdmcC10cy9Ob25FbXB0eUFycmF5J1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwocm90YXRlKDIpKFsxLCAyLCAzLCA0LCA1XSksIFs0LCA1LCAxLCAyLCAzXSlcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwocm90YXRlKC0yKShbMSwgMiwgMywgNCwgNV0pLCBbMywgNCwgNSwgMSwgMl0pXG4gKlxuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIHJvdGF0ZSA9IGZ1bmN0aW9uIChuKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykge1xuICAgICAgICB2YXIgbGVuID0gYXMubGVuZ3RoO1xuICAgICAgICB2YXIgbSA9IE1hdGgucm91bmQobikgJSBsZW47XG4gICAgICAgIGlmIChpc091dE9mQm91bmQoTWF0aC5hYnMobSksIGFzKSB8fCBtID09PSAwKSB7XG4gICAgICAgICAgICByZXR1cm4gY29weShhcyk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKG0gPCAwKSB7XG4gICAgICAgICAgICB2YXIgX2EgPSBzcGxpdEF0KC1tKShhcyksIGYgPSBfYVswXSwgcyA9IF9hWzFdO1xuICAgICAgICAgICAgcmV0dXJuIHBpcGUocywgY29uY2F0KGYpKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybiByb3RhdGUobSAtIGxlbikoYXMpO1xuICAgICAgICB9XG4gICAgfTtcbn07XG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vLyBjb25zdHJ1Y3RvcnNcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8qKlxuICogQGNhdGVnb3J5IGNvbnZlcnNpb25zXG4gKiBAc2luY2UgMi4xMC4wXG4gKi9cbmV4cG9ydCB2YXIgZnJvbVJlYWRvbmx5Tm9uRW1wdHlBcnJheSA9IF8uZnJvbVJlYWRvbmx5Tm9uRW1wdHlBcnJheTtcbi8qKlxuICogQnVpbGRzIGEgYE5vbkVtcHR5QXJyYXlgIGZyb20gYW4gYEFycmF5YCByZXR1cm5pbmcgYG5vbmVgIGlmIGBhc2AgaXMgYW4gZW1wdHkgYXJyYXlcbiAqXG4gKiBAY2F0ZWdvcnkgY29udmVyc2lvbnNcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIGZyb21BcnJheSA9IGZ1bmN0aW9uIChhcykgeyByZXR1cm4gKGlzTm9uRW1wdHkoYXMpID8gXy5zb21lKGFzKSA6IF8ubm9uZSk7IH07XG4vKipcbiAqIFJldHVybiBhIGBOb25FbXB0eUFycmF5YCBvZiBsZW5ndGggYG5gIHdpdGggZWxlbWVudCBgaWAgaW5pdGlhbGl6ZWQgd2l0aCBgZihpKWAuXG4gKlxuICogKipOb3RlKiouIGBuYCBpcyBub3JtYWxpemVkIHRvIGEgbmF0dXJhbCBudW1iZXIuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IG1ha2VCeSB9IGZyb20gJ2ZwLXRzL05vbkVtcHR5QXJyYXknXG4gKiBpbXBvcnQgeyBwaXBlIH0gZnJvbSAnZnAtdHMvZnVuY3Rpb24nXG4gKlxuICogY29uc3QgZG91YmxlID0gKG46IG51bWJlcik6IG51bWJlciA9PiBuICogMlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChwaXBlKDUsIG1ha2VCeShkb3VibGUpKSwgWzAsIDIsIDQsIDYsIDhdKVxuICpcbiAqIEBjYXRlZ29yeSBjb25zdHJ1Y3RvcnNcbiAqIEBzaW5jZSAyLjExLjBcbiAqL1xuZXhwb3J0IHZhciBtYWtlQnkgPSBmdW5jdGlvbiAoZikge1xuICAgIHJldHVybiBmdW5jdGlvbiAobikge1xuICAgICAgICB2YXIgaiA9IE1hdGgubWF4KDAsIE1hdGguZmxvb3IobikpO1xuICAgICAgICB2YXIgb3V0ID0gW2YoMCldO1xuICAgICAgICBmb3IgKHZhciBpID0gMTsgaSA8IGo7IGkrKykge1xuICAgICAgICAgICAgb3V0LnB1c2goZihpKSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG91dDtcbiAgICB9O1xufTtcbi8qKlxuICogQ3JlYXRlIGEgYE5vbkVtcHR5QXJyYXlgIGNvbnRhaW5pbmcgYSB2YWx1ZSByZXBlYXRlZCB0aGUgc3BlY2lmaWVkIG51bWJlciBvZiB0aW1lcy5cbiAqXG4gKiAqKk5vdGUqKi4gYG5gIGlzIG5vcm1hbGl6ZWQgdG8gYSBuYXR1cmFsIG51bWJlci5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgcmVwbGljYXRlIH0gZnJvbSAnZnAtdHMvTm9uRW1wdHlBcnJheSdcbiAqIGltcG9ydCB7IHBpcGUgfSBmcm9tICdmcC10cy9mdW5jdGlvbidcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKHBpcGUoMywgcmVwbGljYXRlKCdhJykpLCBbJ2EnLCAnYScsICdhJ10pXG4gKlxuICogQGNhdGVnb3J5IGNvbnN0cnVjdG9yc1xuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIHJlcGxpY2F0ZSA9IGZ1bmN0aW9uIChhKSB7IHJldHVybiBtYWtlQnkoZnVuY3Rpb24gKCkgeyByZXR1cm4gYTsgfSk7IH07XG4vKipcbiAqIENyZWF0ZSBhIGBOb25FbXB0eUFycmF5YCBjb250YWluaW5nIGEgcmFuZ2Ugb2YgaW50ZWdlcnMsIGluY2x1ZGluZyBib3RoIGVuZHBvaW50cy5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgcmFuZ2UgfSBmcm9tICdmcC10cy9Ob25FbXB0eUFycmF5J1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwocmFuZ2UoMSwgNSksIFsxLCAyLCAzLCA0LCA1XSlcbiAqXG4gKiBAY2F0ZWdvcnkgY29uc3RydWN0b3JzXG4gKiBAc2luY2UgMi4xMS4wXG4gKi9cbmV4cG9ydCB2YXIgcmFuZ2UgPSBmdW5jdGlvbiAoc3RhcnQsIGVuZCkge1xuICAgIHJldHVybiBzdGFydCA8PSBlbmQgPyBtYWtlQnkoZnVuY3Rpb24gKGkpIHsgcmV0dXJuIHN0YXJ0ICsgaTsgfSkoZW5kIC0gc3RhcnQgKyAxKSA6IFtzdGFydF07XG59O1xuLyoqXG4gKiBSZXR1cm4gdGhlIHR1cGxlIG9mIHRoZSBgaGVhZGAgYW5kIHRoZSBgdGFpbGAuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IHVucHJlcGVuZCB9IGZyb20gJ2ZwLXRzL05vbkVtcHR5QXJyYXknXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbCh1bnByZXBlbmQoWzEsIDIsIDNdKSwgWzEsIFsyLCAzXV0pXG4gKlxuICogQHNpbmNlIDIuOS4wXG4gKi9cbmV4cG9ydCB2YXIgdW5wcmVwZW5kID0gZnVuY3Rpb24gKGFzKSB7IHJldHVybiBbaGVhZChhcyksIHRhaWwoYXMpXTsgfTtcbi8qKlxuICogUmV0dXJuIHRoZSB0dXBsZSBvZiB0aGUgYGluaXRgIGFuZCB0aGUgYGxhc3RgLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyB1bmFwcGVuZCB9IGZyb20gJ2ZwLXRzL05vbkVtcHR5QXJyYXknXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbCh1bmFwcGVuZChbMSwgMiwgMywgNF0pLCBbWzEsIDIsIDNdLCA0XSlcbiAqXG4gKiBAc2luY2UgMi45LjBcbiAqL1xuZXhwb3J0IHZhciB1bmFwcGVuZCA9IGZ1bmN0aW9uIChhcykgeyByZXR1cm4gW2luaXQoYXMpLCBsYXN0KGFzKV07IH07XG5leHBvcnQgZnVuY3Rpb24gY29uY2F0VyhzZWNvbmQpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGZpcnN0KSB7IHJldHVybiBmaXJzdC5jb25jYXQoc2Vjb25kKTsgfTtcbn1cbmV4cG9ydCBmdW5jdGlvbiBjb25jYXQoeCwgeSkge1xuICAgIHJldHVybiB5ID8geC5jb25jYXQoeSkgOiBmdW5jdGlvbiAoeSkgeyByZXR1cm4geS5jb25jYXQoeCk7IH07XG59XG4vKipcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIHJldmVyc2UgPSBmdW5jdGlvbiAoYXMpIHsgcmV0dXJuIF9fc3ByZWFkQXJyYXkoW2xhc3QoYXMpXSwgYXMuc2xpY2UoMCwgLTEpLnJldmVyc2UoKSwgdHJ1ZSk7IH07XG5leHBvcnQgZnVuY3Rpb24gZ3JvdXAoRSkge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgdmFyIGxlbiA9IGFzLmxlbmd0aDtcbiAgICAgICAgaWYgKGxlbiA9PT0gMCkge1xuICAgICAgICAgICAgcmV0dXJuIFtdO1xuICAgICAgICB9XG4gICAgICAgIHZhciBvdXQgPSBbXTtcbiAgICAgICAgdmFyIGhlYWQgPSBhc1swXTtcbiAgICAgICAgdmFyIG5lYSA9IFtoZWFkXTtcbiAgICAgICAgZm9yICh2YXIgaSA9IDE7IGkgPCBsZW47IGkrKykge1xuICAgICAgICAgICAgdmFyIGEgPSBhc1tpXTtcbiAgICAgICAgICAgIGlmIChFLmVxdWFscyhhLCBoZWFkKSkge1xuICAgICAgICAgICAgICAgIG5lYS5wdXNoKGEpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgb3V0LnB1c2gobmVhKTtcbiAgICAgICAgICAgICAgICBoZWFkID0gYTtcbiAgICAgICAgICAgICAgICBuZWEgPSBbaGVhZF07XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgb3V0LnB1c2gobmVhKTtcbiAgICAgICAgcmV0dXJuIG91dDtcbiAgICB9O1xufVxuLyoqXG4gKiBTcGxpdHMgYW4gYXJyYXkgaW50byBzdWItbm9uLWVtcHR5LWFycmF5cyBzdG9yZWQgaW4gYW4gb2JqZWN0LCBiYXNlZCBvbiB0aGUgcmVzdWx0IG9mIGNhbGxpbmcgYSBgc3RyaW5nYC1yZXR1cm5pbmdcbiAqIGZ1bmN0aW9uIG9uIGVhY2ggZWxlbWVudCwgYW5kIGdyb3VwaW5nIHRoZSByZXN1bHRzIGFjY29yZGluZyB0byB2YWx1ZXMgcmV0dXJuZWRcbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgZ3JvdXBCeSB9IGZyb20gJ2ZwLXRzL05vbkVtcHR5QXJyYXknXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChncm91cEJ5KChzOiBzdHJpbmcpID0+IFN0cmluZyhzLmxlbmd0aCkpKFsnYScsICdiJywgJ2FiJ10pLCB7XG4gKiAgICcxJzogWydhJywgJ2InXSxcbiAqICAgJzInOiBbJ2FiJ11cbiAqIH0pXG4gKlxuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgZ3JvdXBCeSA9IGZ1bmN0aW9uIChmKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykge1xuICAgICAgICB2YXIgb3V0ID0ge307XG4gICAgICAgIGZvciAodmFyIF9pID0gMCwgYXNfMSA9IGFzOyBfaSA8IGFzXzEubGVuZ3RoOyBfaSsrKSB7XG4gICAgICAgICAgICB2YXIgYSA9IGFzXzFbX2ldO1xuICAgICAgICAgICAgdmFyIGsgPSBmKGEpO1xuICAgICAgICAgICAgaWYgKF8uaGFzLmNhbGwob3V0LCBrKSkge1xuICAgICAgICAgICAgICAgIG91dFtrXS5wdXNoKGEpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgb3V0W2tdID0gW2FdO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBvdXQ7XG4gICAgfTtcbn07XG4vKipcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIHNvcnQgPSBmdW5jdGlvbiAoTykge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgcmV0dXJuIGFzLnNsaWNlKCkuc29ydChPLmNvbXBhcmUpO1xuICAgIH07XG59O1xuLyoqXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciBpbnNlcnRBdCA9IGZ1bmN0aW9uIChpLCBhKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykge1xuICAgICAgICByZXR1cm4gaSA8IDAgfHwgaSA+IGFzLmxlbmd0aCA/IF8ubm9uZSA6IF8uc29tZSh1bnNhZmVJbnNlcnRBdChpLCBhLCBhcykpO1xuICAgIH07XG59O1xuLyoqXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciB1cGRhdGVBdCA9IGZ1bmN0aW9uIChpLCBhKSB7XG4gICAgcmV0dXJuIG1vZGlmeUF0KGksIGZ1bmN0aW9uICgpIHsgcmV0dXJuIGE7IH0pO1xufTtcbi8qKlxuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgbW9kaWZ5QXQgPSBmdW5jdGlvbiAoaSwgZikge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgcmV0dXJuIGlzT3V0T2ZCb3VuZChpLCBhcykgPyBfLm5vbmUgOiBfLnNvbWUodW5zYWZlVXBkYXRlQXQoaSwgZihhc1tpXSksIGFzKSk7XG4gICAgfTtcbn07XG4vKipcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIGNvcHkgPSBmcm9tUmVhZG9ubHlOb25FbXB0eUFycmF5O1xuLyoqXG4gKiBAY2F0ZWdvcnkgY29uc3RydWN0b3JzXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciBvZiA9IGZ1bmN0aW9uIChhKSB7IHJldHVybiBbYV07IH07XG4vKipcbiAqIEBzaW5jZSAyLjUuMVxuICovXG5leHBvcnQgdmFyIHppcFdpdGggPSBmdW5jdGlvbiAoYXMsIGJzLCBmKSB7XG4gICAgdmFyIGNzID0gW2YoYXNbMF0sIGJzWzBdKV07XG4gICAgdmFyIGxlbiA9IE1hdGgubWluKGFzLmxlbmd0aCwgYnMubGVuZ3RoKTtcbiAgICBmb3IgKHZhciBpID0gMTsgaSA8IGxlbjsgaSsrKSB7XG4gICAgICAgIGNzW2ldID0gZihhc1tpXSwgYnNbaV0pO1xuICAgIH1cbiAgICByZXR1cm4gY3M7XG59O1xuZXhwb3J0IGZ1bmN0aW9uIHppcChhcywgYnMpIHtcbiAgICBpZiAoYnMgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICByZXR1cm4gZnVuY3Rpb24gKGJzKSB7IHJldHVybiB6aXAoYnMsIGFzKTsgfTtcbiAgICB9XG4gICAgcmV0dXJuIHppcFdpdGgoYXMsIGJzLCBmdW5jdGlvbiAoYSwgYikgeyByZXR1cm4gW2EsIGJdOyB9KTtcbn1cbi8qKlxuICogQHNpbmNlIDIuNS4xXG4gKi9cbmV4cG9ydCB2YXIgdW56aXAgPSBmdW5jdGlvbiAoYWJzKSB7XG4gICAgdmFyIGZhID0gW2Fic1swXVswXV07XG4gICAgdmFyIGZiID0gW2Fic1swXVsxXV07XG4gICAgZm9yICh2YXIgaSA9IDE7IGkgPCBhYnMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgZmFbaV0gPSBhYnNbaV1bMF07XG4gICAgICAgIGZiW2ldID0gYWJzW2ldWzFdO1xuICAgIH1cbiAgICByZXR1cm4gW2ZhLCBmYl07XG59O1xuLyoqXG4gKiBQcmVwZW5kIGFuIGVsZW1lbnQgdG8gZXZlcnkgbWVtYmVyIG9mIGFuIGFycmF5XG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IHByZXBlbmRBbGwgfSBmcm9tICdmcC10cy9Ob25FbXB0eUFycmF5J1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwocHJlcGVuZEFsbCg5KShbMSwgMiwgMywgNF0pLCBbOSwgMSwgOSwgMiwgOSwgMywgOSwgNF0pXG4gKlxuICogQHNpbmNlIDIuMTAuMFxuICovXG5leHBvcnQgdmFyIHByZXBlbmRBbGwgPSBmdW5jdGlvbiAobWlkZGxlKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykge1xuICAgICAgICB2YXIgb3V0ID0gW21pZGRsZSwgYXNbMF1dO1xuICAgICAgICBmb3IgKHZhciBpID0gMTsgaSA8IGFzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICBvdXQucHVzaChtaWRkbGUsIGFzW2ldKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gb3V0O1xuICAgIH07XG59O1xuLyoqXG4gKiBQbGFjZXMgYW4gZWxlbWVudCBpbiBiZXR3ZWVuIG1lbWJlcnMgb2YgYW4gYXJyYXlcbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgaW50ZXJzcGVyc2UgfSBmcm9tICdmcC10cy9Ob25FbXB0eUFycmF5J1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoaW50ZXJzcGVyc2UoOSkoWzEsIDIsIDMsIDRdKSwgWzEsIDksIDIsIDksIDMsIDksIDRdKVxuICpcbiAqIEBzaW5jZSAyLjkuMFxuICovXG5leHBvcnQgdmFyIGludGVyc3BlcnNlID0gZnVuY3Rpb24gKG1pZGRsZSkge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgdmFyIHJlc3QgPSB0YWlsKGFzKTtcbiAgICAgICAgcmV0dXJuIGlzTm9uRW1wdHkocmVzdCkgPyBwaXBlKHJlc3QsIHByZXBlbmRBbGwobWlkZGxlKSwgcHJlcGVuZChoZWFkKGFzKSkpIDogY29weShhcyk7XG4gICAgfTtcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBmb2xkaW5nXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciBmb2xkTWFwV2l0aEluZGV4ID0gUk5FQS5mb2xkTWFwV2l0aEluZGV4O1xuLyoqXG4gKiBAY2F0ZWdvcnkgZm9sZGluZ1xuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgZm9sZE1hcCA9IFJORUEuZm9sZE1hcDtcbi8qKlxuICogQGNhdGVnb3J5IHNlcXVlbmNpbmdcbiAqIEBzaW5jZSAyLjEwLjBcbiAqL1xuZXhwb3J0IHZhciBjaGFpbldpdGhJbmRleCA9IGZ1bmN0aW9uIChmKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykge1xuICAgICAgICB2YXIgb3V0ID0gZnJvbVJlYWRvbmx5Tm9uRW1wdHlBcnJheShmKDAsIGhlYWQoYXMpKSk7XG4gICAgICAgIGZvciAodmFyIGkgPSAxOyBpIDwgYXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIG91dC5wdXNoLmFwcGx5KG91dCwgZihpLCBhc1tpXSkpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBvdXQ7XG4gICAgfTtcbn07XG4vKipcbiAqIEBzaW5jZSAyLjEwLjBcbiAqL1xuZXhwb3J0IHZhciBjaG9wID0gZnVuY3Rpb24gKGYpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIHZhciBfYSA9IGYoYXMpLCBiID0gX2FbMF0sIHJlc3QgPSBfYVsxXTtcbiAgICAgICAgdmFyIG91dCA9IFtiXTtcbiAgICAgICAgdmFyIG5leHQgPSByZXN0O1xuICAgICAgICB3aGlsZSAoaXNOb25FbXB0eShuZXh0KSkge1xuICAgICAgICAgICAgdmFyIF9iID0gZihuZXh0KSwgYl8xID0gX2JbMF0sIHJlc3RfMiA9IF9iWzFdO1xuICAgICAgICAgICAgb3V0LnB1c2goYl8xKTtcbiAgICAgICAgICAgIG5leHQgPSByZXN0XzI7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG91dDtcbiAgICB9O1xufTtcbi8qKlxuICogU3BsaXRzIGEgYE5vbkVtcHR5QXJyYXlgIGludG8gdHdvIHBpZWNlcywgdGhlIGZpcnN0IHBpZWNlIGhhcyBtYXggYG5gIGVsZW1lbnRzLlxuICpcbiAqIEBzaW5jZSAyLjEwLjBcbiAqL1xuZXhwb3J0IHZhciBzcGxpdEF0ID0gZnVuY3Rpb24gKG4pIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIHZhciBtID0gTWF0aC5tYXgoMSwgbik7XG4gICAgICAgIHJldHVybiBtID49IGFzLmxlbmd0aCA/IFtjb3B5KGFzKSwgW11dIDogW3BpcGUoYXMuc2xpY2UoMSwgbSksIHByZXBlbmQoaGVhZChhcykpKSwgYXMuc2xpY2UobSldO1xuICAgIH07XG59O1xuLyoqXG4gKiBAc2luY2UgMi4xMC4wXG4gKi9cbmV4cG9ydCB2YXIgY2h1bmtzT2YgPSBmdW5jdGlvbiAobikgeyByZXR1cm4gY2hvcChzcGxpdEF0KG4pKTsgfTtcbi8qIGlzdGFuYnVsIGlnbm9yZSBuZXh0ICovXG52YXIgX21hcCA9IGZ1bmN0aW9uIChmYSwgZikgeyByZXR1cm4gcGlwZShmYSwgbWFwKGYpKTsgfTtcbi8qIGlzdGFuYnVsIGlnbm9yZSBuZXh0ICovXG52YXIgX21hcFdpdGhJbmRleCA9IGZ1bmN0aW9uIChmYSwgZikgeyByZXR1cm4gcGlwZShmYSwgbWFwV2l0aEluZGV4KGYpKTsgfTtcbi8qIGlzdGFuYnVsIGlnbm9yZSBuZXh0ICovXG52YXIgX2FwID0gZnVuY3Rpb24gKGZhYiwgZmEpIHsgcmV0dXJuIHBpcGUoZmFiLCBhcChmYSkpOyB9O1xuLyogaXN0YW5idWwgaWdub3JlIG5leHQgKi9cbnZhciBfZXh0ZW5kID0gZnVuY3Rpb24gKHdhLCBmKSB7IHJldHVybiBwaXBlKHdhLCBleHRlbmQoZikpOyB9O1xuLyogaXN0YW5idWwgaWdub3JlIG5leHQgKi9cbnZhciBfcmVkdWNlID0gZnVuY3Rpb24gKGZhLCBiLCBmKSB7IHJldHVybiBwaXBlKGZhLCByZWR1Y2UoYiwgZikpOyB9O1xuLyogaXN0YW5idWwgaWdub3JlIG5leHQgKi9cbnZhciBfZm9sZE1hcCA9IGZ1bmN0aW9uIChNKSB7XG4gICAgdmFyIGZvbGRNYXBNID0gZm9sZE1hcChNKTtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGZhLCBmKSB7IHJldHVybiBwaXBlKGZhLCBmb2xkTWFwTShmKSk7IH07XG59O1xuLyogaXN0YW5idWwgaWdub3JlIG5leHQgKi9cbnZhciBfcmVkdWNlUmlnaHQgPSBmdW5jdGlvbiAoZmEsIGIsIGYpIHsgcmV0dXJuIHBpcGUoZmEsIHJlZHVjZVJpZ2h0KGIsIGYpKTsgfTtcbi8qIGlzdGFuYnVsIGlnbm9yZSBuZXh0ICovXG52YXIgX3RyYXZlcnNlID0gZnVuY3Rpb24gKEYpIHtcbiAgICB2YXIgdHJhdmVyc2VGID0gdHJhdmVyc2UoRik7XG4gICAgcmV0dXJuIGZ1bmN0aW9uICh0YSwgZikgeyByZXR1cm4gcGlwZSh0YSwgdHJhdmVyc2VGKGYpKTsgfTtcbn07XG4vKiBpc3RhbmJ1bCBpZ25vcmUgbmV4dCAqL1xudmFyIF9hbHQgPSBmdW5jdGlvbiAoZmEsIHRoYXQpIHsgcmV0dXJuIHBpcGUoZmEsIGFsdCh0aGF0KSk7IH07XG4vKiBpc3RhbmJ1bCBpZ25vcmUgbmV4dCAqL1xudmFyIF9yZWR1Y2VXaXRoSW5kZXggPSBmdW5jdGlvbiAoZmEsIGIsIGYpIHtcbiAgICByZXR1cm4gcGlwZShmYSwgcmVkdWNlV2l0aEluZGV4KGIsIGYpKTtcbn07XG4vKiBpc3RhbmJ1bCBpZ25vcmUgbmV4dCAqL1xudmFyIF9mb2xkTWFwV2l0aEluZGV4ID0gZnVuY3Rpb24gKE0pIHtcbiAgICB2YXIgZm9sZE1hcFdpdGhJbmRleE0gPSBmb2xkTWFwV2l0aEluZGV4KE0pO1xuICAgIHJldHVybiBmdW5jdGlvbiAoZmEsIGYpIHsgcmV0dXJuIHBpcGUoZmEsIGZvbGRNYXBXaXRoSW5kZXhNKGYpKTsgfTtcbn07XG4vKiBpc3RhbmJ1bCBpZ25vcmUgbmV4dCAqL1xudmFyIF9yZWR1Y2VSaWdodFdpdGhJbmRleCA9IGZ1bmN0aW9uIChmYSwgYiwgZikge1xuICAgIHJldHVybiBwaXBlKGZhLCByZWR1Y2VSaWdodFdpdGhJbmRleChiLCBmKSk7XG59O1xuLyogaXN0YW5idWwgaWdub3JlIG5leHQgKi9cbnZhciBfdHJhdmVyc2VXaXRoSW5kZXggPSBmdW5jdGlvbiAoRikge1xuICAgIHZhciB0cmF2ZXJzZVdpdGhJbmRleEYgPSB0cmF2ZXJzZVdpdGhJbmRleChGKTtcbiAgICByZXR1cm4gZnVuY3Rpb24gKHRhLCBmKSB7IHJldHVybiBwaXBlKHRhLCB0cmF2ZXJzZVdpdGhJbmRleEYoZikpOyB9O1xufTtcbi8qKlxuICogTGVzcyBzdHJpY3QgdmVyc2lvbiBvZiBbYGFsdGBdKCNhbHQpLlxuICpcbiAqIFRoZSBgV2Agc3VmZml4IChzaG9ydCBmb3IgKipXKippZGVuaW5nKSBtZWFucyB0aGF0IHRoZSByZXR1cm4gdHlwZXMgd2lsbCBiZSBtZXJnZWQuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCAqIGFzIE5FQSBmcm9tICdmcC10cy9Ob25FbXB0eUFycmF5J1xuICogaW1wb3J0IHsgcGlwZSB9IGZyb20gJ2ZwLXRzL2Z1bmN0aW9uJ1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoXG4gKiAgIHBpcGUoXG4gKiAgICAgWzEsIDIsIDNdIGFzIE5FQS5Ob25FbXB0eUFycmF5PG51bWJlcj4sXG4gKiAgICAgTkVBLmFsdFcoKCkgPT4gWydhJywgJ2InXSlcbiAqICAgKSxcbiAqICAgWzEsIDIsIDMsICdhJywgJ2InXVxuICogKVxuICpcbiAqIEBjYXRlZ29yeSBlcnJvciBoYW5kbGluZ1xuICogQHNpbmNlIDIuOS4wXG4gKi9cbmV4cG9ydCB2YXIgYWx0VyA9IGZ1bmN0aW9uICh0aGF0KSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykge1xuICAgICAgICByZXR1cm4gcGlwZShhcywgY29uY2F0Vyh0aGF0KCkpKTtcbiAgICB9O1xufTtcbi8qKlxuICogSWRlbnRpZmllcyBhbiBhc3NvY2lhdGl2ZSBvcGVyYXRpb24gb24gYSB0eXBlIGNvbnN0cnVjdG9yLiBJdCBpcyBzaW1pbGFyIHRvIGBTZW1pZ3JvdXBgLCBleGNlcHQgdGhhdCBpdCBhcHBsaWVzIHRvXG4gKiB0eXBlcyBvZiBraW5kIGAqIC0+ICpgLlxuICpcbiAqIEluIGNhc2Ugb2YgYE5vbkVtcHR5QXJyYXlgIGNvbmNhdGVuYXRlcyB0aGUgaW5wdXRzIGludG8gYSBzaW5nbGUgYXJyYXkuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCAqIGFzIE5FQSBmcm9tICdmcC10cy9Ob25FbXB0eUFycmF5J1xuICogaW1wb3J0IHsgcGlwZSB9IGZyb20gJ2ZwLXRzL2Z1bmN0aW9uJ1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoXG4gKiAgIHBpcGUoXG4gKiAgICAgWzEsIDIsIDNdLFxuICogICAgIE5FQS5hbHQoKCkgPT4gWzQsIDVdKVxuICogICApLFxuICogICBbMSwgMiwgMywgNCwgNV1cbiAqIClcbiAqXG4gKiBAY2F0ZWdvcnkgZXJyb3IgaGFuZGxpbmdcbiAqIEBzaW5jZSAyLjYuMlxuICovXG5leHBvcnQgdmFyIGFsdCA9IGFsdFc7XG4vKipcbiAqIEFwcGx5IGEgZnVuY3Rpb24gdG8gYW4gYXJndW1lbnQgdW5kZXIgYSB0eXBlIGNvbnN0cnVjdG9yLlxuICpcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIGFwID0gZnVuY3Rpb24gKGFzKSB7XG4gICAgcmV0dXJuIGZsYXRNYXAoZnVuY3Rpb24gKGYpIHsgcmV0dXJuIHBpcGUoYXMsIG1hcChmKSk7IH0pO1xufTtcbi8qKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCAqIGFzIE5FQSBmcm9tICdmcC10cy9Ob25FbXB0eUFycmF5J1xuICogaW1wb3J0IHsgcGlwZSB9IGZyb20gJ2ZwLXRzL2Z1bmN0aW9uJ1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoXG4gKiAgIHBpcGUoXG4gKiAgICAgWzEsIDIsIDNdLFxuICogICAgIE5FQS5mbGF0TWFwKChuKSA9PiBbYGEke259YCwgYGIke259YF0pXG4gKiAgICksXG4gKiAgIFsnYTEnLCAnYjEnLCAnYTInLCAnYjInLCAnYTMnLCAnYjMnXVxuICogKVxuICpcbiAqIEBjYXRlZ29yeSBzZXF1ZW5jaW5nXG4gKiBAc2luY2UgMi4xNC4wXG4gKi9cbmV4cG9ydCB2YXIgZmxhdE1hcCA9IC8qI19fUFVSRV9fKi8gZHVhbCgyLCBmdW5jdGlvbiAobWEsIGYpIHtcbiAgICByZXR1cm4gcGlwZShtYSwgY2hhaW5XaXRoSW5kZXgoZnVuY3Rpb24gKGksIGEpIHsgcmV0dXJuIGYoYSwgaSk7IH0pKTtcbn0pO1xuLyoqXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciBleHRlbmQgPSBmdW5jdGlvbiAoZikge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgdmFyIG5leHQgPSB0YWlsKGFzKTtcbiAgICAgICAgdmFyIG91dCA9IFtmKGFzKV07XG4gICAgICAgIHdoaWxlIChpc05vbkVtcHR5KG5leHQpKSB7XG4gICAgICAgICAgICBvdXQucHVzaChmKG5leHQpKTtcbiAgICAgICAgICAgIG5leHQgPSB0YWlsKG5leHQpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBvdXQ7XG4gICAgfTtcbn07XG4vKipcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIGR1cGxpY2F0ZSA9IC8qI19fUFVSRV9fKi8gZXh0ZW5kKGlkZW50aXR5KTtcbi8qKlxuICogQGNhdGVnb3J5IHNlcXVlbmNpbmdcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIGZsYXR0ZW4gPSAvKiNfX1BVUkVfXyovIGZsYXRNYXAoaWRlbnRpdHkpO1xuLyoqXG4gKiBgbWFwYCBjYW4gYmUgdXNlZCB0byB0dXJuIGZ1bmN0aW9ucyBgKGE6IEEpID0+IEJgIGludG8gZnVuY3Rpb25zIGAoZmE6IEY8QT4pID0+IEY8Qj5gIHdob3NlIGFyZ3VtZW50IGFuZCByZXR1cm4gdHlwZXNcbiAqIHVzZSB0aGUgdHlwZSBjb25zdHJ1Y3RvciBgRmAgdG8gcmVwcmVzZW50IHNvbWUgY29tcHV0YXRpb25hbCBjb250ZXh0LlxuICpcbiAqIEBjYXRlZ29yeSBtYXBwaW5nXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciBtYXAgPSBmdW5jdGlvbiAoZikgeyByZXR1cm4gbWFwV2l0aEluZGV4KGZ1bmN0aW9uIChfLCBhKSB7IHJldHVybiBmKGEpOyB9KTsgfTtcbi8qKlxuICogQGNhdGVnb3J5IG1hcHBpbmdcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIG1hcFdpdGhJbmRleCA9IGZ1bmN0aW9uIChmKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykge1xuICAgICAgICB2YXIgb3V0ID0gW2YoMCwgaGVhZChhcykpXTtcbiAgICAgICAgZm9yICh2YXIgaSA9IDE7IGkgPCBhcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgb3V0LnB1c2goZihpLCBhc1tpXSkpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBvdXQ7XG4gICAgfTtcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBmb2xkaW5nXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciByZWR1Y2UgPSBSTkVBLnJlZHVjZTtcbi8qKlxuICogQGNhdGVnb3J5IGZvbGRpbmdcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIHJlZHVjZVdpdGhJbmRleCA9IFJORUEucmVkdWNlV2l0aEluZGV4O1xuLyoqXG4gKiBAY2F0ZWdvcnkgZm9sZGluZ1xuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgcmVkdWNlUmlnaHQgPSBSTkVBLnJlZHVjZVJpZ2h0O1xuLyoqXG4gKiBAY2F0ZWdvcnkgZm9sZGluZ1xuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgcmVkdWNlUmlnaHRXaXRoSW5kZXggPSBSTkVBLnJlZHVjZVJpZ2h0V2l0aEluZGV4O1xuLyoqXG4gKiBAY2F0ZWdvcnkgdHJhdmVyc2luZ1xuICogQHNpbmNlIDIuNi4zXG4gKi9cbmV4cG9ydCB2YXIgdHJhdmVyc2UgPSBmdW5jdGlvbiAoRikge1xuICAgIHZhciB0cmF2ZXJzZVdpdGhJbmRleEYgPSB0cmF2ZXJzZVdpdGhJbmRleChGKTtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGYpIHsgcmV0dXJuIHRyYXZlcnNlV2l0aEluZGV4RihmdW5jdGlvbiAoXywgYSkgeyByZXR1cm4gZihhKTsgfSk7IH07XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgdHJhdmVyc2luZ1xuICogQHNpbmNlIDIuNi4zXG4gKi9cbmV4cG9ydCB2YXIgc2VxdWVuY2UgPSBmdW5jdGlvbiAoRikgeyByZXR1cm4gdHJhdmVyc2VXaXRoSW5kZXgoRikoZnVuY3Rpb24gKF8sIGEpIHsgcmV0dXJuIGE7IH0pOyB9O1xuLyoqXG4gKiBAY2F0ZWdvcnkgc2VxdWVuY2luZ1xuICogQHNpbmNlIDIuNi4zXG4gKi9cbmV4cG9ydCB2YXIgdHJhdmVyc2VXaXRoSW5kZXggPSBmdW5jdGlvbiAoRikge1xuICAgIHJldHVybiBmdW5jdGlvbiAoZikge1xuICAgICAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgICAgICB2YXIgb3V0ID0gRi5tYXAoZigwLCBoZWFkKGFzKSksIG9mKTtcbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAxOyBpIDwgYXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICBvdXQgPSBGLmFwKEYubWFwKG91dCwgZnVuY3Rpb24gKGJzKSB7IHJldHVybiBmdW5jdGlvbiAoYikgeyByZXR1cm4gcGlwZShicywgYXBwZW5kKGIpKTsgfTsgfSksIGYoaSwgYXNbaV0pKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBvdXQ7XG4gICAgICAgIH07XG4gICAgfTtcbn07XG4vKipcbiAqIEBzaW5jZSAyLjcuMFxuICovXG5leHBvcnQgdmFyIGV4dHJhY3QgPSBSTkVBLmhlYWQ7XG4vKipcbiAqIEBjYXRlZ29yeSB0eXBlIGxhbWJkYXNcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIFVSSSA9ICdOb25FbXB0eUFycmF5Jztcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgZ2V0U2hvdyA9IFJORUEuZ2V0U2hvdztcbi8qKlxuICogQnVpbGRzIGEgYFNlbWlncm91cGAgaW5zdGFuY2UgZm9yIGBOb25FbXB0eUFycmF5YFxuICpcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIGdldFNlbWlncm91cCA9IGZ1bmN0aW9uICgpIHsgcmV0dXJuICh7XG4gICAgY29uY2F0OiBjb25jYXRcbn0pOyB9O1xuLyoqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgZ2V0RXEgfSBmcm9tICdmcC10cy9Ob25FbXB0eUFycmF5J1xuICogaW1wb3J0ICogYXMgTiBmcm9tICdmcC10cy9udW1iZXInXG4gKlxuICogY29uc3QgRSA9IGdldEVxKE4uRXEpXG4gKiBhc3NlcnQuc3RyaWN0RXF1YWwoRS5lcXVhbHMoWzEsIDJdLCBbMSwgMl0pLCB0cnVlKVxuICogYXNzZXJ0LnN0cmljdEVxdWFsKEUuZXF1YWxzKFsxLCAyXSwgWzEsIDNdKSwgZmFsc2UpXG4gKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgZ2V0RXEgPSBSTkVBLmdldEVxO1xuLyoqXG4gKiBAc2luY2UgMi4xMS4wXG4gKi9cbmV4cG9ydCB2YXIgZ2V0VW5pb25TZW1pZ3JvdXAgPSBmdW5jdGlvbiAoRSkge1xuICAgIHZhciB1bmlvbkUgPSB1bmlvbihFKTtcbiAgICByZXR1cm4ge1xuICAgICAgICBjb25jYXQ6IGZ1bmN0aW9uIChmaXJzdCwgc2Vjb25kKSB7IHJldHVybiB1bmlvbkUoc2Vjb25kKShmaXJzdCk7IH1cbiAgICB9O1xufTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuNy4wXG4gKi9cbmV4cG9ydCB2YXIgRnVuY3RvciA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICBtYXA6IF9tYXBcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBtYXBwaW5nXG4gKiBAc2luY2UgMi4xMC4wXG4gKi9cbmV4cG9ydCB2YXIgZmxhcCA9IC8qI19fUFVSRV9fKi8gZmxhcF8oRnVuY3Rvcik7XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjEwLjBcbiAqL1xuZXhwb3J0IHZhciBQb2ludGVkID0ge1xuICAgIFVSSTogVVJJLFxuICAgIG9mOiBvZlxufTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuNy4wXG4gKi9cbmV4cG9ydCB2YXIgRnVuY3RvcldpdGhJbmRleCA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICBtYXA6IF9tYXAsXG4gICAgbWFwV2l0aEluZGV4OiBfbWFwV2l0aEluZGV4XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi4xMC4wXG4gKi9cbmV4cG9ydCB2YXIgQXBwbHkgPSB7XG4gICAgVVJJOiBVUkksXG4gICAgbWFwOiBfbWFwLFxuICAgIGFwOiBfYXBcbn07XG4vKipcbiAqIENvbWJpbmUgdHdvIGVmZmVjdGZ1bCBhY3Rpb25zLCBrZWVwaW5nIG9ubHkgdGhlIHJlc3VsdCBvZiB0aGUgZmlyc3QuXG4gKlxuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgYXBGaXJzdCA9IC8qI19fUFVSRV9fKi8gYXBGaXJzdF8oQXBwbHkpO1xuLyoqXG4gKiBDb21iaW5lIHR3byBlZmZlY3RmdWwgYWN0aW9ucywga2VlcGluZyBvbmx5IHRoZSByZXN1bHQgb2YgdGhlIHNlY29uZC5cbiAqXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBhcFNlY29uZCA9IC8qI19fUFVSRV9fKi8gYXBTZWNvbmRfKEFwcGx5KTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuNy4wXG4gKi9cbmV4cG9ydCB2YXIgQXBwbGljYXRpdmUgPSB7XG4gICAgVVJJOiBVUkksXG4gICAgbWFwOiBfbWFwLFxuICAgIGFwOiBfYXAsXG4gICAgb2Y6IG9mXG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi4xMC4wXG4gKi9cbmV4cG9ydCB2YXIgQ2hhaW4gPSB7XG4gICAgVVJJOiBVUkksXG4gICAgbWFwOiBfbWFwLFxuICAgIGFwOiBfYXAsXG4gICAgY2hhaW46IGZsYXRNYXBcbn07XG4vKipcbiAqIENvbXBvc2VzIGNvbXB1dGF0aW9ucyBpbiBzZXF1ZW5jZSwgdXNpbmcgdGhlIHJldHVybiB2YWx1ZSBvZiBvbmUgY29tcHV0YXRpb24gdG8gZGV0ZXJtaW5lIHRoZSBuZXh0IGNvbXB1dGF0aW9uIGFuZFxuICoga2VlcGluZyBvbmx5IHRoZSByZXN1bHQgb2YgdGhlIGZpcnN0LlxuICpcbiAqIEBjYXRlZ29yeSBzZXF1ZW5jaW5nXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBjaGFpbkZpcnN0ID0gXG4vKiNfX1BVUkVfXyovIGNoYWluRmlyc3RfKENoYWluKTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuNy4wXG4gKi9cbmV4cG9ydCB2YXIgTW9uYWQgPSB7XG4gICAgVVJJOiBVUkksXG4gICAgbWFwOiBfbWFwLFxuICAgIGFwOiBfYXAsXG4gICAgb2Y6IG9mLFxuICAgIGNoYWluOiBmbGF0TWFwXG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi43LjBcbiAqL1xuZXhwb3J0IHZhciBGb2xkYWJsZSA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICByZWR1Y2U6IF9yZWR1Y2UsXG4gICAgZm9sZE1hcDogX2ZvbGRNYXAsXG4gICAgcmVkdWNlUmlnaHQ6IF9yZWR1Y2VSaWdodFxufTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuNy4wXG4gKi9cbmV4cG9ydCB2YXIgRm9sZGFibGVXaXRoSW5kZXggPSB7XG4gICAgVVJJOiBVUkksXG4gICAgcmVkdWNlOiBfcmVkdWNlLFxuICAgIGZvbGRNYXA6IF9mb2xkTWFwLFxuICAgIHJlZHVjZVJpZ2h0OiBfcmVkdWNlUmlnaHQsXG4gICAgcmVkdWNlV2l0aEluZGV4OiBfcmVkdWNlV2l0aEluZGV4LFxuICAgIGZvbGRNYXBXaXRoSW5kZXg6IF9mb2xkTWFwV2l0aEluZGV4LFxuICAgIHJlZHVjZVJpZ2h0V2l0aEluZGV4OiBfcmVkdWNlUmlnaHRXaXRoSW5kZXhcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjcuMFxuICovXG5leHBvcnQgdmFyIFRyYXZlcnNhYmxlID0ge1xuICAgIFVSSTogVVJJLFxuICAgIG1hcDogX21hcCxcbiAgICByZWR1Y2U6IF9yZWR1Y2UsXG4gICAgZm9sZE1hcDogX2ZvbGRNYXAsXG4gICAgcmVkdWNlUmlnaHQ6IF9yZWR1Y2VSaWdodCxcbiAgICB0cmF2ZXJzZTogX3RyYXZlcnNlLFxuICAgIHNlcXVlbmNlOiBzZXF1ZW5jZVxufTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuNy4wXG4gKi9cbmV4cG9ydCB2YXIgVHJhdmVyc2FibGVXaXRoSW5kZXggPSB7XG4gICAgVVJJOiBVUkksXG4gICAgbWFwOiBfbWFwLFxuICAgIG1hcFdpdGhJbmRleDogX21hcFdpdGhJbmRleCxcbiAgICByZWR1Y2U6IF9yZWR1Y2UsXG4gICAgZm9sZE1hcDogX2ZvbGRNYXAsXG4gICAgcmVkdWNlUmlnaHQ6IF9yZWR1Y2VSaWdodCxcbiAgICB0cmF2ZXJzZTogX3RyYXZlcnNlLFxuICAgIHNlcXVlbmNlOiBzZXF1ZW5jZSxcbiAgICByZWR1Y2VXaXRoSW5kZXg6IF9yZWR1Y2VXaXRoSW5kZXgsXG4gICAgZm9sZE1hcFdpdGhJbmRleDogX2ZvbGRNYXBXaXRoSW5kZXgsXG4gICAgcmVkdWNlUmlnaHRXaXRoSW5kZXg6IF9yZWR1Y2VSaWdodFdpdGhJbmRleCxcbiAgICB0cmF2ZXJzZVdpdGhJbmRleDogX3RyYXZlcnNlV2l0aEluZGV4XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi43LjBcbiAqL1xuZXhwb3J0IHZhciBBbHQgPSB7XG4gICAgVVJJOiBVUkksXG4gICAgbWFwOiBfbWFwLFxuICAgIGFsdDogX2FsdFxufTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuNy4wXG4gKi9cbmV4cG9ydCB2YXIgQ29tb25hZCA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICBtYXA6IF9tYXAsXG4gICAgZXh0ZW5kOiBfZXh0ZW5kLFxuICAgIGV4dHJhY3Q6IGV4dHJhY3Rcbn07XG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vLyBkbyBub3RhdGlvblxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLyoqXG4gKiBAY2F0ZWdvcnkgZG8gbm90YXRpb25cbiAqIEBzaW5jZSAyLjkuMFxuICovXG5leHBvcnQgdmFyIERvID0gLyojX19QVVJFX18qLyBvZihfLmVtcHR5UmVjb3JkKTtcbi8qKlxuICogQGNhdGVnb3J5IGRvIG5vdGF0aW9uXG4gKiBAc2luY2UgMi44LjBcbiAqL1xuZXhwb3J0IHZhciBiaW5kVG8gPSAvKiNfX1BVUkVfXyovIGJpbmRUb18oRnVuY3Rvcik7XG52YXIgbGV0XyA9IC8qI19fUFVSRV9fKi8gbGV0X18oRnVuY3Rvcik7XG5leHBvcnQgeyBcbi8qKlxuICogQGNhdGVnb3J5IGRvIG5vdGF0aW9uXG4gKiBAc2luY2UgMi4xMy4wXG4gKi9cbmxldF8gYXMgbGV0IH07XG4vKipcbiAqIEBjYXRlZ29yeSBkbyBub3RhdGlvblxuICogQHNpbmNlIDIuOC4wXG4gKi9cbmV4cG9ydCB2YXIgYmluZCA9IC8qI19fUFVSRV9fKi8gYmluZF8oQ2hhaW4pO1xuLyoqXG4gKiBAY2F0ZWdvcnkgZG8gbm90YXRpb25cbiAqIEBzaW5jZSAyLjguMFxuICovXG5leHBvcnQgdmFyIGFwUyA9IC8qI19fUFVSRV9fKi8gYXBTXyhBcHBseSk7XG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vLyB1dGlsc1xuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLyoqXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciBoZWFkID0gUk5FQS5oZWFkO1xuLyoqXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciB0YWlsID0gZnVuY3Rpb24gKGFzKSB7IHJldHVybiBhcy5zbGljZSgxKTsgfTtcbi8qKlxuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgbGFzdCA9IFJORUEubGFzdDtcbi8qKlxuICogR2V0IGFsbCBidXQgdGhlIGxhc3QgZWxlbWVudCBvZiBhIG5vbiBlbXB0eSBhcnJheSwgY3JlYXRpbmcgYSBuZXcgYXJyYXkuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IGluaXQgfSBmcm9tICdmcC10cy9Ob25FbXB0eUFycmF5J1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoaW5pdChbMSwgMiwgM10pLCBbMSwgMl0pXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKGluaXQoWzFdKSwgW10pXG4gKlxuICogQHNpbmNlIDIuMi4wXG4gKi9cbmV4cG9ydCB2YXIgaW5pdCA9IGZ1bmN0aW9uIChhcykgeyByZXR1cm4gYXMuc2xpY2UoMCwgLTEpOyB9O1xuLyoqXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciBtaW4gPSBSTkVBLm1pbjtcbi8qKlxuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgbWF4ID0gUk5FQS5tYXg7XG4vKipcbiAqIEBzaW5jZSAyLjEwLjBcbiAqL1xuZXhwb3J0IHZhciBjb25jYXRBbGwgPSBmdW5jdGlvbiAoUykge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgcmV0dXJuIGFzLnJlZHVjZShTLmNvbmNhdCk7XG4gICAgfTtcbn07XG4vKipcbiAqIEJyZWFrIGFuIGBBcnJheWAgaW50byBpdHMgZmlyc3QgZWxlbWVudCBhbmQgcmVtYWluaW5nIGVsZW1lbnRzLlxuICpcbiAqIEBjYXRlZ29yeSBwYXR0ZXJuIG1hdGNoaW5nXG4gKiBAc2luY2UgMi4xMS4wXG4gKi9cbmV4cG9ydCB2YXIgbWF0Y2hMZWZ0ID0gZnVuY3Rpb24gKGYpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIHJldHVybiBmKGhlYWQoYXMpLCB0YWlsKGFzKSk7XG4gICAgfTtcbn07XG4vKipcbiAqIEJyZWFrIGFuIGBBcnJheWAgaW50byBpdHMgaW5pdGlhbCBlbGVtZW50cyBhbmQgdGhlIGxhc3QgZWxlbWVudC5cbiAqXG4gKiBAY2F0ZWdvcnkgcGF0dGVybiBtYXRjaGluZ1xuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIG1hdGNoUmlnaHQgPSBmdW5jdGlvbiAoZikge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgcmV0dXJuIGYoaW5pdChhcyksIGxhc3QoYXMpKTtcbiAgICB9O1xufTtcbi8qKlxuICogQXBwbHkgYSBmdW5jdGlvbiB0byB0aGUgaGVhZCwgY3JlYXRpbmcgYSBuZXcgYE5vbkVtcHR5QXJyYXlgLlxuICpcbiAqIEBzaW5jZSAyLjExLjBcbiAqL1xuZXhwb3J0IHZhciBtb2RpZnlIZWFkID0gZnVuY3Rpb24gKGYpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIHJldHVybiBfX3NwcmVhZEFycmF5KFtmKGhlYWQoYXMpKV0sIHRhaWwoYXMpLCB0cnVlKTtcbiAgICB9O1xufTtcbi8qKlxuICogQ2hhbmdlIHRoZSBoZWFkLCBjcmVhdGluZyBhIG5ldyBgTm9uRW1wdHlBcnJheWAuXG4gKlxuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIHVwZGF0ZUhlYWQgPSBmdW5jdGlvbiAoYSkgeyByZXR1cm4gbW9kaWZ5SGVhZChmdW5jdGlvbiAoKSB7IHJldHVybiBhOyB9KTsgfTtcbi8qKlxuICogQXBwbHkgYSBmdW5jdGlvbiB0byB0aGUgbGFzdCBlbGVtZW50LCBjcmVhdGluZyBhIG5ldyBgTm9uRW1wdHlBcnJheWAuXG4gKlxuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIG1vZGlmeUxhc3QgPSBmdW5jdGlvbiAoZikge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgcmV0dXJuIHBpcGUoaW5pdChhcyksIGFwcGVuZChmKGxhc3QoYXMpKSkpO1xuICAgIH07XG59O1xuLyoqXG4gKiBDaGFuZ2UgdGhlIGxhc3QgZWxlbWVudCwgY3JlYXRpbmcgYSBuZXcgYE5vbkVtcHR5QXJyYXlgLlxuICpcbiAqIEBzaW5jZSAyLjExLjBcbiAqL1xuZXhwb3J0IHZhciB1cGRhdGVMYXN0ID0gZnVuY3Rpb24gKGEpIHsgcmV0dXJuIG1vZGlmeUxhc3QoZnVuY3Rpb24gKCkgeyByZXR1cm4gYTsgfSk7IH07XG4vKipcbiAqIFBsYWNlcyBhbiBlbGVtZW50IGluIGJldHdlZW4gbWVtYmVycyBvZiBhIGBOb25FbXB0eUFycmF5YCwgdGhlbiBmb2xkcyB0aGUgcmVzdWx0cyB1c2luZyB0aGUgcHJvdmlkZWQgYFNlbWlncm91cGAuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCAqIGFzIFMgZnJvbSAnZnAtdHMvc3RyaW5nJ1xuICogaW1wb3J0IHsgaW50ZXJjYWxhdGUgfSBmcm9tICdmcC10cy9Ob25FbXB0eUFycmF5J1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoaW50ZXJjYWxhdGUoUy5TZW1pZ3JvdXApKCctJykoWydhJywgJ2InLCAnYyddKSwgJ2EtYi1jJylcbiAqXG4gKiBAc2luY2UgMi4xMi4wXG4gKi9cbmV4cG9ydCB2YXIgaW50ZXJjYWxhdGUgPSBSTkVBLmludGVyY2FsYXRlO1xuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLy8gbGVnYWN5XG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vKipcbiAqIEFsaWFzIG9mIGBmbGF0TWFwYC5cbiAqXG4gKiBAY2F0ZWdvcnkgbGVnYWN5XG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciBjaGFpbiA9IGZsYXRNYXA7XG5leHBvcnQgZnVuY3Rpb24gZ3JvdXBTb3J0KE8pIHtcbiAgICB2YXIgc29ydE8gPSBzb3J0KE8pO1xuICAgIHZhciBncm91cE8gPSBncm91cChPKTtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7IHJldHVybiAoaXNOb25FbXB0eShhcykgPyBncm91cE8oc29ydE8oYXMpKSA6IFtdKTsgfTtcbn1cbmV4cG9ydCBmdW5jdGlvbiBmaWx0ZXIocHJlZGljYXRlKSB7XG4gICAgcmV0dXJuIGZpbHRlcldpdGhJbmRleChmdW5jdGlvbiAoXywgYSkgeyByZXR1cm4gcHJlZGljYXRlKGEpOyB9KTtcbn1cbi8qKlxuICogVXNlIFtgZmlsdGVyV2l0aEluZGV4YF0oLi9BcnJheS50cy5odG1sI2ZpbHRlcndpdGhpbmRleCkgaW5zdGVhZC5cbiAqXG4gKiBAY2F0ZWdvcnkgem9uZSBvZiBkZWF0aFxuICogQHNpbmNlIDIuMC4wXG4gKiBAZGVwcmVjYXRlZFxuICovXG5leHBvcnQgdmFyIGZpbHRlcldpdGhJbmRleCA9IGZ1bmN0aW9uIChwcmVkaWNhdGUpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIHJldHVybiBmcm9tQXJyYXkoYXMuZmlsdGVyKGZ1bmN0aW9uIChhLCBpKSB7IHJldHVybiBwcmVkaWNhdGUoaSwgYSk7IH0pKTtcbiAgICB9O1xufTtcbi8qKlxuICogVXNlIFtgdW5wcmVwZW5kYF0oI3VucHJlcGVuZCkgaW5zdGVhZC5cbiAqXG4gKiBAY2F0ZWdvcnkgem9uZSBvZiBkZWF0aFxuICogQHNpbmNlIDIuOS4wXG4gKiBAZGVwcmVjYXRlZFxuICovXG5leHBvcnQgdmFyIHVuY29ucyA9IHVucHJlcGVuZDtcbi8qKlxuICogVXNlIFtgdW5hcHBlbmRgXSgjdW5hcHBlbmQpIGluc3RlYWQuXG4gKlxuICogQGNhdGVnb3J5IHpvbmUgb2YgZGVhdGhcbiAqIEBzaW5jZSAyLjkuMFxuICogQGRlcHJlY2F0ZWRcbiAqL1xuZXhwb3J0IHZhciB1bnNub2MgPSB1bmFwcGVuZDtcbmV4cG9ydCBmdW5jdGlvbiBjb25zKGhlYWQsIHRhaWwpIHtcbiAgICByZXR1cm4gdGFpbCA9PT0gdW5kZWZpbmVkID8gcHJlcGVuZChoZWFkKSA6IHBpcGUodGFpbCwgcHJlcGVuZChoZWFkKSk7XG59XG4vKipcbiAqIFVzZSBbYGFwcGVuZGBdKC4vQXJyYXkudHMuaHRtbCNhcHBlbmQpIGluc3RlYWQuXG4gKlxuICogQGNhdGVnb3J5IHpvbmUgb2YgZGVhdGhcbiAqIEBzaW5jZSAyLjAuMFxuICogQGRlcHJlY2F0ZWRcbiAqL1xuZXhwb3J0IHZhciBzbm9jID0gZnVuY3Rpb24gKGluaXQsIGVuZCkgeyByZXR1cm4gcGlwZShpbml0LCBhcHBlbmQoZW5kKSk7IH07XG4vKipcbiAqIFVzZSBbYHByZXBlbmRBbGxgXSgjcHJlcGVuZGFsbCkgaW5zdGVhZC5cbiAqXG4gKiBAY2F0ZWdvcnkgem9uZSBvZiBkZWF0aFxuICogQHNpbmNlIDIuOS4wXG4gKiBAZGVwcmVjYXRlZFxuICovXG5leHBvcnQgdmFyIHByZXBlbmRUb0FsbCA9IHByZXBlbmRBbGw7XG4vKipcbiAqIFVzZSBbYGNvbmNhdEFsbGBdKCNjb25jYXRhbGwpIGluc3RlYWQuXG4gKlxuICogQGNhdGVnb3J5IHpvbmUgb2YgZGVhdGhcbiAqIEBzaW5jZSAyLjUuMFxuICogQGRlcHJlY2F0ZWRcbiAqL1xuZXhwb3J0IHZhciBmb2xkID0gUk5FQS5jb25jYXRBbGw7XG4vKipcbiAqIFRoaXMgaW5zdGFuY2UgaXMgZGVwcmVjYXRlZCwgdXNlIHNtYWxsLCBzcGVjaWZpYyBpbnN0YW5jZXMgaW5zdGVhZC5cbiAqIEZvciBleGFtcGxlIGlmIGEgZnVuY3Rpb24gbmVlZHMgYSBgRnVuY3RvcmAgaW5zdGFuY2UsIHBhc3MgYE5FQS5GdW5jdG9yYCBpbnN0ZWFkIG9mIGBORUEubm9uRW1wdHlBcnJheWBcbiAqICh3aGVyZSBgTkVBYCBpcyBmcm9tIGBpbXBvcnQgTkVBIGZyb20gJ2ZwLXRzL05vbkVtcHR5QXJyYXknYClcbiAqXG4gKiBAY2F0ZWdvcnkgem9uZSBvZiBkZWF0aFxuICogQHNpbmNlIDIuMC4wXG4gKiBAZGVwcmVjYXRlZFxuICovXG5leHBvcnQgdmFyIG5vbkVtcHR5QXJyYXkgPSB7XG4gICAgVVJJOiBVUkksXG4gICAgb2Y6IG9mLFxuICAgIG1hcDogX21hcCxcbiAgICBtYXBXaXRoSW5kZXg6IF9tYXBXaXRoSW5kZXgsXG4gICAgYXA6IF9hcCxcbiAgICBjaGFpbjogZmxhdE1hcCxcbiAgICBleHRlbmQ6IF9leHRlbmQsXG4gICAgZXh0cmFjdDogZXh0cmFjdCxcbiAgICByZWR1Y2U6IF9yZWR1Y2UsXG4gICAgZm9sZE1hcDogX2ZvbGRNYXAsXG4gICAgcmVkdWNlUmlnaHQ6IF9yZWR1Y2VSaWdodCxcbiAgICB0cmF2ZXJzZTogX3RyYXZlcnNlLFxuICAgIHNlcXVlbmNlOiBzZXF1ZW5jZSxcbiAgICByZWR1Y2VXaXRoSW5kZXg6IF9yZWR1Y2VXaXRoSW5kZXgsXG4gICAgZm9sZE1hcFdpdGhJbmRleDogX2ZvbGRNYXBXaXRoSW5kZXgsXG4gICAgcmVkdWNlUmlnaHRXaXRoSW5kZXg6IF9yZWR1Y2VSaWdodFdpdGhJbmRleCxcbiAgICB0cmF2ZXJzZVdpdGhJbmRleDogX3RyYXZlcnNlV2l0aEluZGV4LFxuICAgIGFsdDogX2FsdFxufTtcbiIsCiAgInZhciBfX3NwcmVhZEFycmF5ID0gKHRoaXMgJiYgdGhpcy5fX3NwcmVhZEFycmF5KSB8fCBmdW5jdGlvbiAodG8sIGZyb20sIHBhY2spIHtcbiAgICBpZiAocGFjayB8fCBhcmd1bWVudHMubGVuZ3RoID09PSAyKSBmb3IgKHZhciBpID0gMCwgbCA9IGZyb20ubGVuZ3RoLCBhcjsgaSA8IGw7IGkrKykge1xuICAgICAgICBpZiAoYXIgfHwgIShpIGluIGZyb20pKSB7XG4gICAgICAgICAgICBpZiAoIWFyKSBhciA9IEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGZyb20sIDAsIGkpO1xuICAgICAgICAgICAgYXJbaV0gPSBmcm9tW2ldO1xuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiB0by5jb25jYXQoYXIgfHwgQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoZnJvbSkpO1xufTtcbmltcG9ydCB7IGFwRmlyc3QgYXMgYXBGaXJzdF8sIGFwUyBhcyBhcFNfLCBhcFNlY29uZCBhcyBhcFNlY29uZF8gfSBmcm9tICcuL0FwcGx5JztcbmltcG9ydCB7IGJpbmQgYXMgYmluZF8sIGNoYWluRmlyc3QgYXMgY2hhaW5GaXJzdF8gfSBmcm9tICcuL0NoYWluJztcbmltcG9ydCB7IGR1YWwsIGlkZW50aXR5LCBwaXBlIH0gZnJvbSAnLi9mdW5jdGlvbic7XG5pbXBvcnQgeyBiaW5kVG8gYXMgYmluZFRvXywgZmxhcCBhcyBmbGFwXywgbGV0IGFzIGxldF9fIH0gZnJvbSAnLi9GdW5jdG9yJztcbmltcG9ydCAqIGFzIF8gZnJvbSAnLi9pbnRlcm5hbCc7XG5pbXBvcnQgeyBnZXRNb25vaWQgfSBmcm9tICcuL09yZCc7XG5pbXBvcnQgKiBhcyBSTkVBIGZyb20gJy4vUmVhZG9ubHlOb25FbXB0eUFycmF5Jztcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8vIGludGVybmFsXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vKipcbiAqIEBpbnRlcm5hbFxuICovXG5leHBvcnQgdmFyIGlzTm9uRW1wdHkgPSBmdW5jdGlvbiAoYXMpIHsgcmV0dXJuIGFzLmxlbmd0aCA+IDA7IH07XG4vKipcbiAqIEBpbnRlcm5hbFxuICovXG5leHBvcnQgdmFyIGlzT3V0T2ZCb3VuZCA9IGZ1bmN0aW9uIChpLCBhcykgeyByZXR1cm4gaSA8IDAgfHwgaSA+PSBhcy5sZW5ndGg7IH07XG4vKipcbiAqIEBpbnRlcm5hbFxuICovXG5leHBvcnQgdmFyIHByZXBlbmRXID0gZnVuY3Rpb24gKGhlYWQpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKHRhaWwpIHtcbiAgICAgICAgcmV0dXJuIF9fc3ByZWFkQXJyYXkoW2hlYWRdLCB0YWlsLCB0cnVlKTtcbiAgICB9O1xufTtcbi8qKlxuICogQGludGVybmFsXG4gKi9cbmV4cG9ydCB2YXIgcHJlcGVuZCA9IHByZXBlbmRXO1xuLyoqXG4gKiBAaW50ZXJuYWxcbiAqL1xuZXhwb3J0IHZhciBhcHBlbmRXID0gZnVuY3Rpb24gKGVuZCkge1xuICAgIHJldHVybiBmdW5jdGlvbiAoaW5pdCkge1xuICAgICAgICByZXR1cm4gX19zcHJlYWRBcnJheShfX3NwcmVhZEFycmF5KFtdLCBpbml0LCB0cnVlKSwgW2VuZF0sIGZhbHNlKTtcbiAgICB9O1xufTtcbi8qKlxuICogQGludGVybmFsXG4gKi9cbmV4cG9ydCB2YXIgYXBwZW5kID0gYXBwZW5kVztcbi8qKlxuICogQGludGVybmFsXG4gKi9cbmV4cG9ydCB2YXIgdW5zYWZlSW5zZXJ0QXQgPSBmdW5jdGlvbiAoaSwgYSwgYXMpIHtcbiAgICBpZiAoaXNOb25FbXB0eShhcykpIHtcbiAgICAgICAgdmFyIHhzID0gZnJvbVJlYWRvbmx5Tm9uRW1wdHlBcnJheShhcyk7XG4gICAgICAgIHhzLnNwbGljZShpLCAwLCBhKTtcbiAgICAgICAgcmV0dXJuIHhzO1xuICAgIH1cbiAgICByZXR1cm4gW2FdO1xufTtcbi8qKlxuICogQGludGVybmFsXG4gKi9cbmV4cG9ydCB2YXIgdW5zYWZlVXBkYXRlQXQgPSBmdW5jdGlvbiAoaSwgYSwgYXMpIHtcbiAgICB2YXIgeHMgPSBmcm9tUmVhZG9ubHlOb25FbXB0eUFycmF5KGFzKTtcbiAgICB4c1tpXSA9IGE7XG4gICAgcmV0dXJuIHhzO1xufTtcbi8qKlxuICogUmVtb3ZlIGR1cGxpY2F0ZXMgZnJvbSBhIGBOb25FbXB0eUFycmF5YCwga2VlcGluZyB0aGUgZmlyc3Qgb2NjdXJyZW5jZSBvZiBhbiBlbGVtZW50LlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyB1bmlxIH0gZnJvbSAnZnAtdHMvTm9uRW1wdHlBcnJheSdcbiAqIGltcG9ydCAqIGFzIE4gZnJvbSAnZnAtdHMvbnVtYmVyJ1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwodW5pcShOLkVxKShbMSwgMiwgMV0pLCBbMSwgMl0pXG4gKlxuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIHVuaXEgPSBmdW5jdGlvbiAoRSkge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgaWYgKGFzLmxlbmd0aCA9PT0gMSkge1xuICAgICAgICAgICAgcmV0dXJuIGNvcHkoYXMpO1xuICAgICAgICB9XG4gICAgICAgIHZhciBvdXQgPSBbaGVhZChhcyldO1xuICAgICAgICB2YXIgcmVzdCA9IHRhaWwoYXMpO1xuICAgICAgICB2YXIgX2xvb3BfMSA9IGZ1bmN0aW9uIChhKSB7XG4gICAgICAgICAgICBpZiAob3V0LmV2ZXJ5KGZ1bmN0aW9uIChvKSB7IHJldHVybiAhRS5lcXVhbHMobywgYSk7IH0pKSB7XG4gICAgICAgICAgICAgICAgb3V0LnB1c2goYSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIGZvciAodmFyIF9pID0gMCwgcmVzdF8xID0gcmVzdDsgX2kgPCByZXN0XzEubGVuZ3RoOyBfaSsrKSB7XG4gICAgICAgICAgICB2YXIgYSA9IHJlc3RfMVtfaV07XG4gICAgICAgICAgICBfbG9vcF8xKGEpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBvdXQ7XG4gICAgfTtcbn07XG4vKipcbiAqIFNvcnQgdGhlIGVsZW1lbnRzIG9mIGEgYE5vbkVtcHR5QXJyYXlgIGluIGluY3JlYXNpbmcgb3JkZXIsIHdoZXJlIGVsZW1lbnRzIGFyZSBjb21wYXJlZCB1c2luZyBmaXJzdCBgb3Jkc1swXWAsIHRoZW4gYG9yZHNbMV1gLFxuICogZXRjLi4uXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCAqIGFzIE5FQSBmcm9tICdmcC10cy9Ob25FbXB0eUFycmF5J1xuICogaW1wb3J0IHsgY29udHJhbWFwIH0gZnJvbSAnZnAtdHMvT3JkJ1xuICogaW1wb3J0ICogYXMgUyBmcm9tICdmcC10cy9zdHJpbmcnXG4gKiBpbXBvcnQgKiBhcyBOIGZyb20gJ2ZwLXRzL251bWJlcidcbiAqIGltcG9ydCB7IHBpcGUgfSBmcm9tICdmcC10cy9mdW5jdGlvbidcbiAqXG4gKiBpbnRlcmZhY2UgUGVyc29uIHtcbiAqICAgbmFtZTogc3RyaW5nXG4gKiAgIGFnZTogbnVtYmVyXG4gKiB9XG4gKlxuICogY29uc3QgYnlOYW1lID0gcGlwZShTLk9yZCwgY29udHJhbWFwKChwOiBQZXJzb24pID0+IHAubmFtZSkpXG4gKlxuICogY29uc3QgYnlBZ2UgPSBwaXBlKE4uT3JkLCBjb250cmFtYXAoKHA6IFBlcnNvbikgPT4gcC5hZ2UpKVxuICpcbiAqIGNvbnN0IHNvcnRCeU5hbWVCeUFnZSA9IE5FQS5zb3J0QnkoW2J5TmFtZSwgYnlBZ2VdKVxuICpcbiAqIGNvbnN0IHBlcnNvbnM6IE5FQS5Ob25FbXB0eUFycmF5PFBlcnNvbj4gPSBbXG4gKiAgIHsgbmFtZTogJ2EnLCBhZ2U6IDEgfSxcbiAqICAgeyBuYW1lOiAnYicsIGFnZTogMyB9LFxuICogICB7IG5hbWU6ICdjJywgYWdlOiAyIH0sXG4gKiAgIHsgbmFtZTogJ2InLCBhZ2U6IDIgfVxuICogXVxuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoc29ydEJ5TmFtZUJ5QWdlKHBlcnNvbnMpLCBbXG4gKiAgIHsgbmFtZTogJ2EnLCBhZ2U6IDEgfSxcbiAqICAgeyBuYW1lOiAnYicsIGFnZTogMiB9LFxuICogICB7IG5hbWU6ICdiJywgYWdlOiAzIH0sXG4gKiAgIHsgbmFtZTogJ2MnLCBhZ2U6IDIgfVxuICogXSlcbiAqXG4gKiBAc2luY2UgMi4xMS4wXG4gKi9cbmV4cG9ydCB2YXIgc29ydEJ5ID0gZnVuY3Rpb24gKG9yZHMpIHtcbiAgICBpZiAoaXNOb25FbXB0eShvcmRzKSkge1xuICAgICAgICB2YXIgTSA9IGdldE1vbm9pZCgpO1xuICAgICAgICByZXR1cm4gc29ydChvcmRzLnJlZHVjZShNLmNvbmNhdCwgTS5lbXB0eSkpO1xuICAgIH1cbiAgICByZXR1cm4gY29weTtcbn07XG4vKipcbiAqIEBzaW5jZSAyLjExLjBcbiAqL1xuZXhwb3J0IHZhciB1bmlvbiA9IGZ1bmN0aW9uIChFKSB7XG4gICAgdmFyIHVuaXFFID0gdW5pcShFKTtcbiAgICByZXR1cm4gZnVuY3Rpb24gKHNlY29uZCkgeyByZXR1cm4gZnVuY3Rpb24gKGZpcnN0KSB7IHJldHVybiB1bmlxRShwaXBlKGZpcnN0LCBjb25jYXQoc2Vjb25kKSkpOyB9OyB9O1xufTtcbi8qKlxuICogUm90YXRlIGEgYE5vbkVtcHR5QXJyYXlgIGJ5IGBuYCBzdGVwcy5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgcm90YXRlIH0gZnJvbSAnZnAtdHMvTm9uRW1wdHlBcnJheSdcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKHJvdGF0ZSgyKShbMSwgMiwgMywgNCwgNV0pLCBbNCwgNSwgMSwgMiwgM10pXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKHJvdGF0ZSgtMikoWzEsIDIsIDMsIDQsIDVdKSwgWzMsIDQsIDUsIDEsIDJdKVxuICpcbiAqIEBzaW5jZSAyLjExLjBcbiAqL1xuZXhwb3J0IHZhciByb3RhdGUgPSBmdW5jdGlvbiAobikge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgdmFyIGxlbiA9IGFzLmxlbmd0aDtcbiAgICAgICAgdmFyIG0gPSBNYXRoLnJvdW5kKG4pICUgbGVuO1xuICAgICAgICBpZiAoaXNPdXRPZkJvdW5kKE1hdGguYWJzKG0pLCBhcykgfHwgbSA9PT0gMCkge1xuICAgICAgICAgICAgcmV0dXJuIGNvcHkoYXMpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChtIDwgMCkge1xuICAgICAgICAgICAgdmFyIF9hID0gc3BsaXRBdCgtbSkoYXMpLCBmID0gX2FbMF0sIHMgPSBfYVsxXTtcbiAgICAgICAgICAgIHJldHVybiBwaXBlKHMsIGNvbmNhdChmKSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gcm90YXRlKG0gLSBsZW4pKGFzKTtcbiAgICAgICAgfVxuICAgIH07XG59O1xuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLy8gY29uc3RydWN0b3JzXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vKipcbiAqIEBjYXRlZ29yeSBjb252ZXJzaW9uc1xuICogQHNpbmNlIDIuMTAuMFxuICovXG5leHBvcnQgdmFyIGZyb21SZWFkb25seU5vbkVtcHR5QXJyYXkgPSBfLmZyb21SZWFkb25seU5vbkVtcHR5QXJyYXk7XG4vKipcbiAqIEJ1aWxkcyBhIGBOb25FbXB0eUFycmF5YCBmcm9tIGFuIGBBcnJheWAgcmV0dXJuaW5nIGBub25lYCBpZiBgYXNgIGlzIGFuIGVtcHR5IGFycmF5XG4gKlxuICogQGNhdGVnb3J5IGNvbnZlcnNpb25zXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciBmcm9tQXJyYXkgPSBmdW5jdGlvbiAoYXMpIHsgcmV0dXJuIChpc05vbkVtcHR5KGFzKSA/IF8uc29tZShhcykgOiBfLm5vbmUpOyB9O1xuLyoqXG4gKiBSZXR1cm4gYSBgTm9uRW1wdHlBcnJheWAgb2YgbGVuZ3RoIGBuYCB3aXRoIGVsZW1lbnQgYGlgIGluaXRpYWxpemVkIHdpdGggYGYoaSlgLlxuICpcbiAqICoqTm90ZSoqLiBgbmAgaXMgbm9ybWFsaXplZCB0byBhIG5hdHVyYWwgbnVtYmVyLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBtYWtlQnkgfSBmcm9tICdmcC10cy9Ob25FbXB0eUFycmF5J1xuICogaW1wb3J0IHsgcGlwZSB9IGZyb20gJ2ZwLXRzL2Z1bmN0aW9uJ1xuICpcbiAqIGNvbnN0IGRvdWJsZSA9IChuOiBudW1iZXIpOiBudW1iZXIgPT4gbiAqIDJcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwocGlwZSg1LCBtYWtlQnkoZG91YmxlKSksIFswLCAyLCA0LCA2LCA4XSlcbiAqXG4gKiBAY2F0ZWdvcnkgY29uc3RydWN0b3JzXG4gKiBAc2luY2UgMi4xMS4wXG4gKi9cbmV4cG9ydCB2YXIgbWFrZUJ5ID0gZnVuY3Rpb24gKGYpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKG4pIHtcbiAgICAgICAgdmFyIGogPSBNYXRoLm1heCgwLCBNYXRoLmZsb29yKG4pKTtcbiAgICAgICAgdmFyIG91dCA9IFtmKDApXTtcbiAgICAgICAgZm9yICh2YXIgaSA9IDE7IGkgPCBqOyBpKyspIHtcbiAgICAgICAgICAgIG91dC5wdXNoKGYoaSkpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBvdXQ7XG4gICAgfTtcbn07XG4vKipcbiAqIENyZWF0ZSBhIGBOb25FbXB0eUFycmF5YCBjb250YWluaW5nIGEgdmFsdWUgcmVwZWF0ZWQgdGhlIHNwZWNpZmllZCBudW1iZXIgb2YgdGltZXMuXG4gKlxuICogKipOb3RlKiouIGBuYCBpcyBub3JtYWxpemVkIHRvIGEgbmF0dXJhbCBudW1iZXIuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IHJlcGxpY2F0ZSB9IGZyb20gJ2ZwLXRzL05vbkVtcHR5QXJyYXknXG4gKiBpbXBvcnQgeyBwaXBlIH0gZnJvbSAnZnAtdHMvZnVuY3Rpb24nXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChwaXBlKDMsIHJlcGxpY2F0ZSgnYScpKSwgWydhJywgJ2EnLCAnYSddKVxuICpcbiAqIEBjYXRlZ29yeSBjb25zdHJ1Y3RvcnNcbiAqIEBzaW5jZSAyLjExLjBcbiAqL1xuZXhwb3J0IHZhciByZXBsaWNhdGUgPSBmdW5jdGlvbiAoYSkgeyByZXR1cm4gbWFrZUJ5KGZ1bmN0aW9uICgpIHsgcmV0dXJuIGE7IH0pOyB9O1xuLyoqXG4gKiBDcmVhdGUgYSBgTm9uRW1wdHlBcnJheWAgY29udGFpbmluZyBhIHJhbmdlIG9mIGludGVnZXJzLCBpbmNsdWRpbmcgYm90aCBlbmRwb2ludHMuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IHJhbmdlIH0gZnJvbSAnZnAtdHMvTm9uRW1wdHlBcnJheSdcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKHJhbmdlKDEsIDUpLCBbMSwgMiwgMywgNCwgNV0pXG4gKlxuICogQGNhdGVnb3J5IGNvbnN0cnVjdG9yc1xuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIHJhbmdlID0gZnVuY3Rpb24gKHN0YXJ0LCBlbmQpIHtcbiAgICByZXR1cm4gc3RhcnQgPD0gZW5kID8gbWFrZUJ5KGZ1bmN0aW9uIChpKSB7IHJldHVybiBzdGFydCArIGk7IH0pKGVuZCAtIHN0YXJ0ICsgMSkgOiBbc3RhcnRdO1xufTtcbi8qKlxuICogUmV0dXJuIHRoZSB0dXBsZSBvZiB0aGUgYGhlYWRgIGFuZCB0aGUgYHRhaWxgLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyB1bnByZXBlbmQgfSBmcm9tICdmcC10cy9Ob25FbXB0eUFycmF5J1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwodW5wcmVwZW5kKFsxLCAyLCAzXSksIFsxLCBbMiwgM11dKVxuICpcbiAqIEBzaW5jZSAyLjkuMFxuICovXG5leHBvcnQgdmFyIHVucHJlcGVuZCA9IGZ1bmN0aW9uIChhcykgeyByZXR1cm4gW2hlYWQoYXMpLCB0YWlsKGFzKV07IH07XG4vKipcbiAqIFJldHVybiB0aGUgdHVwbGUgb2YgdGhlIGBpbml0YCBhbmQgdGhlIGBsYXN0YC5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgdW5hcHBlbmQgfSBmcm9tICdmcC10cy9Ob25FbXB0eUFycmF5J1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwodW5hcHBlbmQoWzEsIDIsIDMsIDRdKSwgW1sxLCAyLCAzXSwgNF0pXG4gKlxuICogQHNpbmNlIDIuOS4wXG4gKi9cbmV4cG9ydCB2YXIgdW5hcHBlbmQgPSBmdW5jdGlvbiAoYXMpIHsgcmV0dXJuIFtpbml0KGFzKSwgbGFzdChhcyldOyB9O1xuZXhwb3J0IGZ1bmN0aW9uIGNvbmNhdFcoc2Vjb25kKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChmaXJzdCkgeyByZXR1cm4gZmlyc3QuY29uY2F0KHNlY29uZCk7IH07XG59XG5leHBvcnQgZnVuY3Rpb24gY29uY2F0KHgsIHkpIHtcbiAgICByZXR1cm4geSA/IHguY29uY2F0KHkpIDogZnVuY3Rpb24gKHkpIHsgcmV0dXJuIHkuY29uY2F0KHgpOyB9O1xufVxuLyoqXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciByZXZlcnNlID0gZnVuY3Rpb24gKGFzKSB7IHJldHVybiBfX3NwcmVhZEFycmF5KFtsYXN0KGFzKV0sIGFzLnNsaWNlKDAsIC0xKS5yZXZlcnNlKCksIHRydWUpOyB9O1xuZXhwb3J0IGZ1bmN0aW9uIGdyb3VwKEUpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIHZhciBsZW4gPSBhcy5sZW5ndGg7XG4gICAgICAgIGlmIChsZW4gPT09IDApIHtcbiAgICAgICAgICAgIHJldHVybiBbXTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgb3V0ID0gW107XG4gICAgICAgIHZhciBoZWFkID0gYXNbMF07XG4gICAgICAgIHZhciBuZWEgPSBbaGVhZF07XG4gICAgICAgIGZvciAodmFyIGkgPSAxOyBpIDwgbGVuOyBpKyspIHtcbiAgICAgICAgICAgIHZhciBhID0gYXNbaV07XG4gICAgICAgICAgICBpZiAoRS5lcXVhbHMoYSwgaGVhZCkpIHtcbiAgICAgICAgICAgICAgICBuZWEucHVzaChhKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIG91dC5wdXNoKG5lYSk7XG4gICAgICAgICAgICAgICAgaGVhZCA9IGE7XG4gICAgICAgICAgICAgICAgbmVhID0gW2hlYWRdO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIG91dC5wdXNoKG5lYSk7XG4gICAgICAgIHJldHVybiBvdXQ7XG4gICAgfTtcbn1cbi8qKlxuICogU3BsaXRzIGFuIGFycmF5IGludG8gc3ViLW5vbi1lbXB0eS1hcnJheXMgc3RvcmVkIGluIGFuIG9iamVjdCwgYmFzZWQgb24gdGhlIHJlc3VsdCBvZiBjYWxsaW5nIGEgYHN0cmluZ2AtcmV0dXJuaW5nXG4gKiBmdW5jdGlvbiBvbiBlYWNoIGVsZW1lbnQsIGFuZCBncm91cGluZyB0aGUgcmVzdWx0cyBhY2NvcmRpbmcgdG8gdmFsdWVzIHJldHVybmVkXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IGdyb3VwQnkgfSBmcm9tICdmcC10cy9Ob25FbXB0eUFycmF5J1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoZ3JvdXBCeSgoczogc3RyaW5nKSA9PiBTdHJpbmcocy5sZW5ndGgpKShbJ2EnLCAnYicsICdhYiddKSwge1xuICogICAnMSc6IFsnYScsICdiJ10sXG4gKiAgICcyJzogWydhYiddXG4gKiB9KVxuICpcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIGdyb3VwQnkgPSBmdW5jdGlvbiAoZikge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgdmFyIG91dCA9IHt9O1xuICAgICAgICBmb3IgKHZhciBfaSA9IDAsIGFzXzEgPSBhczsgX2kgPCBhc18xLmxlbmd0aDsgX2krKykge1xuICAgICAgICAgICAgdmFyIGEgPSBhc18xW19pXTtcbiAgICAgICAgICAgIHZhciBrID0gZihhKTtcbiAgICAgICAgICAgIGlmIChfLmhhcy5jYWxsKG91dCwgaykpIHtcbiAgICAgICAgICAgICAgICBvdXRba10ucHVzaChhKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIG91dFtrXSA9IFthXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gb3V0O1xuICAgIH07XG59O1xuLyoqXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciBzb3J0ID0gZnVuY3Rpb24gKE8pIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIHJldHVybiBhcy5zbGljZSgpLnNvcnQoTy5jb21wYXJlKTtcbiAgICB9O1xufTtcbi8qKlxuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgaW5zZXJ0QXQgPSBmdW5jdGlvbiAoaSwgYSkge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgcmV0dXJuIGkgPCAwIHx8IGkgPiBhcy5sZW5ndGggPyBfLm5vbmUgOiBfLnNvbWUodW5zYWZlSW5zZXJ0QXQoaSwgYSwgYXMpKTtcbiAgICB9O1xufTtcbi8qKlxuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgdXBkYXRlQXQgPSBmdW5jdGlvbiAoaSwgYSkge1xuICAgIHJldHVybiBtb2RpZnlBdChpLCBmdW5jdGlvbiAoKSB7IHJldHVybiBhOyB9KTtcbn07XG4vKipcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIG1vZGlmeUF0ID0gZnVuY3Rpb24gKGksIGYpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIHJldHVybiBpc091dE9mQm91bmQoaSwgYXMpID8gXy5ub25lIDogXy5zb21lKHVuc2FmZVVwZGF0ZUF0KGksIGYoYXNbaV0pLCBhcykpO1xuICAgIH07XG59O1xuLyoqXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciBjb3B5ID0gZnJvbVJlYWRvbmx5Tm9uRW1wdHlBcnJheTtcbi8qKlxuICogQGNhdGVnb3J5IGNvbnN0cnVjdG9yc1xuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgb2YgPSBmdW5jdGlvbiAoYSkgeyByZXR1cm4gW2FdOyB9O1xuLyoqXG4gKiBAc2luY2UgMi41LjFcbiAqL1xuZXhwb3J0IHZhciB6aXBXaXRoID0gZnVuY3Rpb24gKGFzLCBicywgZikge1xuICAgIHZhciBjcyA9IFtmKGFzWzBdLCBic1swXSldO1xuICAgIHZhciBsZW4gPSBNYXRoLm1pbihhcy5sZW5ndGgsIGJzLmxlbmd0aCk7XG4gICAgZm9yICh2YXIgaSA9IDE7IGkgPCBsZW47IGkrKykge1xuICAgICAgICBjc1tpXSA9IGYoYXNbaV0sIGJzW2ldKTtcbiAgICB9XG4gICAgcmV0dXJuIGNzO1xufTtcbmV4cG9ydCBmdW5jdGlvbiB6aXAoYXMsIGJzKSB7XG4gICAgaWYgKGJzID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIChicykgeyByZXR1cm4gemlwKGJzLCBhcyk7IH07XG4gICAgfVxuICAgIHJldHVybiB6aXBXaXRoKGFzLCBicywgZnVuY3Rpb24gKGEsIGIpIHsgcmV0dXJuIFthLCBiXTsgfSk7XG59XG4vKipcbiAqIEBzaW5jZSAyLjUuMVxuICovXG5leHBvcnQgdmFyIHVuemlwID0gZnVuY3Rpb24gKGFicykge1xuICAgIHZhciBmYSA9IFthYnNbMF1bMF1dO1xuICAgIHZhciBmYiA9IFthYnNbMF1bMV1dO1xuICAgIGZvciAodmFyIGkgPSAxOyBpIDwgYWJzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIGZhW2ldID0gYWJzW2ldWzBdO1xuICAgICAgICBmYltpXSA9IGFic1tpXVsxXTtcbiAgICB9XG4gICAgcmV0dXJuIFtmYSwgZmJdO1xufTtcbi8qKlxuICogUHJlcGVuZCBhbiBlbGVtZW50IHRvIGV2ZXJ5IG1lbWJlciBvZiBhbiBhcnJheVxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBwcmVwZW5kQWxsIH0gZnJvbSAnZnAtdHMvTm9uRW1wdHlBcnJheSdcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKHByZXBlbmRBbGwoOSkoWzEsIDIsIDMsIDRdKSwgWzksIDEsIDksIDIsIDksIDMsIDksIDRdKVxuICpcbiAqIEBzaW5jZSAyLjEwLjBcbiAqL1xuZXhwb3J0IHZhciBwcmVwZW5kQWxsID0gZnVuY3Rpb24gKG1pZGRsZSkge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgdmFyIG91dCA9IFttaWRkbGUsIGFzWzBdXTtcbiAgICAgICAgZm9yICh2YXIgaSA9IDE7IGkgPCBhcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgb3V0LnB1c2gobWlkZGxlLCBhc1tpXSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG91dDtcbiAgICB9O1xufTtcbi8qKlxuICogUGxhY2VzIGFuIGVsZW1lbnQgaW4gYmV0d2VlbiBtZW1iZXJzIG9mIGFuIGFycmF5XG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IGludGVyc3BlcnNlIH0gZnJvbSAnZnAtdHMvTm9uRW1wdHlBcnJheSdcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKGludGVyc3BlcnNlKDkpKFsxLCAyLCAzLCA0XSksIFsxLCA5LCAyLCA5LCAzLCA5LCA0XSlcbiAqXG4gKiBAc2luY2UgMi45LjBcbiAqL1xuZXhwb3J0IHZhciBpbnRlcnNwZXJzZSA9IGZ1bmN0aW9uIChtaWRkbGUpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIHZhciByZXN0ID0gdGFpbChhcyk7XG4gICAgICAgIHJldHVybiBpc05vbkVtcHR5KHJlc3QpID8gcGlwZShyZXN0LCBwcmVwZW5kQWxsKG1pZGRsZSksIHByZXBlbmQoaGVhZChhcykpKSA6IGNvcHkoYXMpO1xuICAgIH07XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgZm9sZGluZ1xuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgZm9sZE1hcFdpdGhJbmRleCA9IFJORUEuZm9sZE1hcFdpdGhJbmRleDtcbi8qKlxuICogQGNhdGVnb3J5IGZvbGRpbmdcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIGZvbGRNYXAgPSBSTkVBLmZvbGRNYXA7XG4vKipcbiAqIEBjYXRlZ29yeSBzZXF1ZW5jaW5nXG4gKiBAc2luY2UgMi4xMC4wXG4gKi9cbmV4cG9ydCB2YXIgY2hhaW5XaXRoSW5kZXggPSBmdW5jdGlvbiAoZikge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgdmFyIG91dCA9IGZyb21SZWFkb25seU5vbkVtcHR5QXJyYXkoZigwLCBoZWFkKGFzKSkpO1xuICAgICAgICBmb3IgKHZhciBpID0gMTsgaSA8IGFzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICBvdXQucHVzaC5hcHBseShvdXQsIGYoaSwgYXNbaV0pKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gb3V0O1xuICAgIH07XG59O1xuLyoqXG4gKiBAc2luY2UgMi4xMC4wXG4gKi9cbmV4cG9ydCB2YXIgY2hvcCA9IGZ1bmN0aW9uIChmKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykge1xuICAgICAgICB2YXIgX2EgPSBmKGFzKSwgYiA9IF9hWzBdLCByZXN0ID0gX2FbMV07XG4gICAgICAgIHZhciBvdXQgPSBbYl07XG4gICAgICAgIHZhciBuZXh0ID0gcmVzdDtcbiAgICAgICAgd2hpbGUgKGlzTm9uRW1wdHkobmV4dCkpIHtcbiAgICAgICAgICAgIHZhciBfYiA9IGYobmV4dCksIGJfMSA9IF9iWzBdLCByZXN0XzIgPSBfYlsxXTtcbiAgICAgICAgICAgIG91dC5wdXNoKGJfMSk7XG4gICAgICAgICAgICBuZXh0ID0gcmVzdF8yO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBvdXQ7XG4gICAgfTtcbn07XG4vKipcbiAqIFNwbGl0cyBhIGBOb25FbXB0eUFycmF5YCBpbnRvIHR3byBwaWVjZXMsIHRoZSBmaXJzdCBwaWVjZSBoYXMgbWF4IGBuYCBlbGVtZW50cy5cbiAqXG4gKiBAc2luY2UgMi4xMC4wXG4gKi9cbmV4cG9ydCB2YXIgc3BsaXRBdCA9IGZ1bmN0aW9uIChuKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykge1xuICAgICAgICB2YXIgbSA9IE1hdGgubWF4KDEsIG4pO1xuICAgICAgICByZXR1cm4gbSA+PSBhcy5sZW5ndGggPyBbY29weShhcyksIFtdXSA6IFtwaXBlKGFzLnNsaWNlKDEsIG0pLCBwcmVwZW5kKGhlYWQoYXMpKSksIGFzLnNsaWNlKG0pXTtcbiAgICB9O1xufTtcbi8qKlxuICogQHNpbmNlIDIuMTAuMFxuICovXG5leHBvcnQgdmFyIGNodW5rc09mID0gZnVuY3Rpb24gKG4pIHsgcmV0dXJuIGNob3Aoc3BsaXRBdChuKSk7IH07XG4vKiBpc3RhbmJ1bCBpZ25vcmUgbmV4dCAqL1xudmFyIF9tYXAgPSBmdW5jdGlvbiAoZmEsIGYpIHsgcmV0dXJuIHBpcGUoZmEsIG1hcChmKSk7IH07XG4vKiBpc3RhbmJ1bCBpZ25vcmUgbmV4dCAqL1xudmFyIF9tYXBXaXRoSW5kZXggPSBmdW5jdGlvbiAoZmEsIGYpIHsgcmV0dXJuIHBpcGUoZmEsIG1hcFdpdGhJbmRleChmKSk7IH07XG4vKiBpc3RhbmJ1bCBpZ25vcmUgbmV4dCAqL1xudmFyIF9hcCA9IGZ1bmN0aW9uIChmYWIsIGZhKSB7IHJldHVybiBwaXBlKGZhYiwgYXAoZmEpKTsgfTtcbi8qIGlzdGFuYnVsIGlnbm9yZSBuZXh0ICovXG52YXIgX2V4dGVuZCA9IGZ1bmN0aW9uICh3YSwgZikgeyByZXR1cm4gcGlwZSh3YSwgZXh0ZW5kKGYpKTsgfTtcbi8qIGlzdGFuYnVsIGlnbm9yZSBuZXh0ICovXG52YXIgX3JlZHVjZSA9IGZ1bmN0aW9uIChmYSwgYiwgZikgeyByZXR1cm4gcGlwZShmYSwgcmVkdWNlKGIsIGYpKTsgfTtcbi8qIGlzdGFuYnVsIGlnbm9yZSBuZXh0ICovXG52YXIgX2ZvbGRNYXAgPSBmdW5jdGlvbiAoTSkge1xuICAgIHZhciBmb2xkTWFwTSA9IGZvbGRNYXAoTSk7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChmYSwgZikgeyByZXR1cm4gcGlwZShmYSwgZm9sZE1hcE0oZikpOyB9O1xufTtcbi8qIGlzdGFuYnVsIGlnbm9yZSBuZXh0ICovXG52YXIgX3JlZHVjZVJpZ2h0ID0gZnVuY3Rpb24gKGZhLCBiLCBmKSB7IHJldHVybiBwaXBlKGZhLCByZWR1Y2VSaWdodChiLCBmKSk7IH07XG4vKiBpc3RhbmJ1bCBpZ25vcmUgbmV4dCAqL1xudmFyIF90cmF2ZXJzZSA9IGZ1bmN0aW9uIChGKSB7XG4gICAgdmFyIHRyYXZlcnNlRiA9IHRyYXZlcnNlKEYpO1xuICAgIHJldHVybiBmdW5jdGlvbiAodGEsIGYpIHsgcmV0dXJuIHBpcGUodGEsIHRyYXZlcnNlRihmKSk7IH07XG59O1xuLyogaXN0YW5idWwgaWdub3JlIG5leHQgKi9cbnZhciBfYWx0ID0gZnVuY3Rpb24gKGZhLCB0aGF0KSB7IHJldHVybiBwaXBlKGZhLCBhbHQodGhhdCkpOyB9O1xuLyogaXN0YW5idWwgaWdub3JlIG5leHQgKi9cbnZhciBfcmVkdWNlV2l0aEluZGV4ID0gZnVuY3Rpb24gKGZhLCBiLCBmKSB7XG4gICAgcmV0dXJuIHBpcGUoZmEsIHJlZHVjZVdpdGhJbmRleChiLCBmKSk7XG59O1xuLyogaXN0YW5idWwgaWdub3JlIG5leHQgKi9cbnZhciBfZm9sZE1hcFdpdGhJbmRleCA9IGZ1bmN0aW9uIChNKSB7XG4gICAgdmFyIGZvbGRNYXBXaXRoSW5kZXhNID0gZm9sZE1hcFdpdGhJbmRleChNKTtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGZhLCBmKSB7IHJldHVybiBwaXBlKGZhLCBmb2xkTWFwV2l0aEluZGV4TShmKSk7IH07XG59O1xuLyogaXN0YW5idWwgaWdub3JlIG5leHQgKi9cbnZhciBfcmVkdWNlUmlnaHRXaXRoSW5kZXggPSBmdW5jdGlvbiAoZmEsIGIsIGYpIHtcbiAgICByZXR1cm4gcGlwZShmYSwgcmVkdWNlUmlnaHRXaXRoSW5kZXgoYiwgZikpO1xufTtcbi8qIGlzdGFuYnVsIGlnbm9yZSBuZXh0ICovXG52YXIgX3RyYXZlcnNlV2l0aEluZGV4ID0gZnVuY3Rpb24gKEYpIHtcbiAgICB2YXIgdHJhdmVyc2VXaXRoSW5kZXhGID0gdHJhdmVyc2VXaXRoSW5kZXgoRik7XG4gICAgcmV0dXJuIGZ1bmN0aW9uICh0YSwgZikgeyByZXR1cm4gcGlwZSh0YSwgdHJhdmVyc2VXaXRoSW5kZXhGKGYpKTsgfTtcbn07XG4vKipcbiAqIExlc3Mgc3RyaWN0IHZlcnNpb24gb2YgW2BhbHRgXSgjYWx0KS5cbiAqXG4gKiBUaGUgYFdgIHN1ZmZpeCAoc2hvcnQgZm9yICoqVyoqaWRlbmluZykgbWVhbnMgdGhhdCB0aGUgcmV0dXJuIHR5cGVzIHdpbGwgYmUgbWVyZ2VkLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgKiBhcyBORUEgZnJvbSAnZnAtdHMvTm9uRW1wdHlBcnJheSdcbiAqIGltcG9ydCB7IHBpcGUgfSBmcm9tICdmcC10cy9mdW5jdGlvbidcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKFxuICogICBwaXBlKFxuICogICAgIFsxLCAyLCAzXSBhcyBORUEuTm9uRW1wdHlBcnJheTxudW1iZXI+LFxuICogICAgIE5FQS5hbHRXKCgpID0+IFsnYScsICdiJ10pXG4gKiAgICksXG4gKiAgIFsxLCAyLCAzLCAnYScsICdiJ11cbiAqIClcbiAqXG4gKiBAY2F0ZWdvcnkgZXJyb3IgaGFuZGxpbmdcbiAqIEBzaW5jZSAyLjkuMFxuICovXG5leHBvcnQgdmFyIGFsdFcgPSBmdW5jdGlvbiAodGhhdCkge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgcmV0dXJuIHBpcGUoYXMsIGNvbmNhdFcodGhhdCgpKSk7XG4gICAgfTtcbn07XG4vKipcbiAqIElkZW50aWZpZXMgYW4gYXNzb2NpYXRpdmUgb3BlcmF0aW9uIG9uIGEgdHlwZSBjb25zdHJ1Y3Rvci4gSXQgaXMgc2ltaWxhciB0byBgU2VtaWdyb3VwYCwgZXhjZXB0IHRoYXQgaXQgYXBwbGllcyB0b1xuICogdHlwZXMgb2Yga2luZCBgKiAtPiAqYC5cbiAqXG4gKiBJbiBjYXNlIG9mIGBOb25FbXB0eUFycmF5YCBjb25jYXRlbmF0ZXMgdGhlIGlucHV0cyBpbnRvIGEgc2luZ2xlIGFycmF5LlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgKiBhcyBORUEgZnJvbSAnZnAtdHMvTm9uRW1wdHlBcnJheSdcbiAqIGltcG9ydCB7IHBpcGUgfSBmcm9tICdmcC10cy9mdW5jdGlvbidcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKFxuICogICBwaXBlKFxuICogICAgIFsxLCAyLCAzXSxcbiAqICAgICBORUEuYWx0KCgpID0+IFs0LCA1XSlcbiAqICAgKSxcbiAqICAgWzEsIDIsIDMsIDQsIDVdXG4gKiApXG4gKlxuICogQGNhdGVnb3J5IGVycm9yIGhhbmRsaW5nXG4gKiBAc2luY2UgMi42LjJcbiAqL1xuZXhwb3J0IHZhciBhbHQgPSBhbHRXO1xuLyoqXG4gKiBBcHBseSBhIGZ1bmN0aW9uIHRvIGFuIGFyZ3VtZW50IHVuZGVyIGEgdHlwZSBjb25zdHJ1Y3Rvci5cbiAqXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciBhcCA9IGZ1bmN0aW9uIChhcykge1xuICAgIHJldHVybiBmbGF0TWFwKGZ1bmN0aW9uIChmKSB7IHJldHVybiBwaXBlKGFzLCBtYXAoZikpOyB9KTtcbn07XG4vKipcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgKiBhcyBORUEgZnJvbSAnZnAtdHMvTm9uRW1wdHlBcnJheSdcbiAqIGltcG9ydCB7IHBpcGUgfSBmcm9tICdmcC10cy9mdW5jdGlvbidcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKFxuICogICBwaXBlKFxuICogICAgIFsxLCAyLCAzXSxcbiAqICAgICBORUEuZmxhdE1hcCgobikgPT4gW2BhJHtufWAsIGBiJHtufWBdKVxuICogICApLFxuICogICBbJ2ExJywgJ2IxJywgJ2EyJywgJ2IyJywgJ2EzJywgJ2IzJ11cbiAqIClcbiAqXG4gKiBAY2F0ZWdvcnkgc2VxdWVuY2luZ1xuICogQHNpbmNlIDIuMTQuMFxuICovXG5leHBvcnQgdmFyIGZsYXRNYXAgPSAvKiNfX1BVUkVfXyovIGR1YWwoMiwgZnVuY3Rpb24gKG1hLCBmKSB7XG4gICAgcmV0dXJuIHBpcGUobWEsIGNoYWluV2l0aEluZGV4KGZ1bmN0aW9uIChpLCBhKSB7IHJldHVybiBmKGEsIGkpOyB9KSk7XG59KTtcbi8qKlxuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgZXh0ZW5kID0gZnVuY3Rpb24gKGYpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIHZhciBuZXh0ID0gdGFpbChhcyk7XG4gICAgICAgIHZhciBvdXQgPSBbZihhcyldO1xuICAgICAgICB3aGlsZSAoaXNOb25FbXB0eShuZXh0KSkge1xuICAgICAgICAgICAgb3V0LnB1c2goZihuZXh0KSk7XG4gICAgICAgICAgICBuZXh0ID0gdGFpbChuZXh0KTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gb3V0O1xuICAgIH07XG59O1xuLyoqXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBkdXBsaWNhdGUgPSAvKiNfX1BVUkVfXyovIGV4dGVuZChpZGVudGl0eSk7XG4vKipcbiAqIEBjYXRlZ29yeSBzZXF1ZW5jaW5nXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBmbGF0dGVuID0gLyojX19QVVJFX18qLyBmbGF0TWFwKGlkZW50aXR5KTtcbi8qKlxuICogYG1hcGAgY2FuIGJlIHVzZWQgdG8gdHVybiBmdW5jdGlvbnMgYChhOiBBKSA9PiBCYCBpbnRvIGZ1bmN0aW9ucyBgKGZhOiBGPEE+KSA9PiBGPEI+YCB3aG9zZSBhcmd1bWVudCBhbmQgcmV0dXJuIHR5cGVzXG4gKiB1c2UgdGhlIHR5cGUgY29uc3RydWN0b3IgYEZgIHRvIHJlcHJlc2VudCBzb21lIGNvbXB1dGF0aW9uYWwgY29udGV4dC5cbiAqXG4gKiBAY2F0ZWdvcnkgbWFwcGluZ1xuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgbWFwID0gZnVuY3Rpb24gKGYpIHsgcmV0dXJuIG1hcFdpdGhJbmRleChmdW5jdGlvbiAoXywgYSkgeyByZXR1cm4gZihhKTsgfSk7IH07XG4vKipcbiAqIEBjYXRlZ29yeSBtYXBwaW5nXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciBtYXBXaXRoSW5kZXggPSBmdW5jdGlvbiAoZikge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgdmFyIG91dCA9IFtmKDAsIGhlYWQoYXMpKV07XG4gICAgICAgIGZvciAodmFyIGkgPSAxOyBpIDwgYXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIG91dC5wdXNoKGYoaSwgYXNbaV0pKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gb3V0O1xuICAgIH07XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgZm9sZGluZ1xuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgcmVkdWNlID0gUk5FQS5yZWR1Y2U7XG4vKipcbiAqIEBjYXRlZ29yeSBmb2xkaW5nXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciByZWR1Y2VXaXRoSW5kZXggPSBSTkVBLnJlZHVjZVdpdGhJbmRleDtcbi8qKlxuICogQGNhdGVnb3J5IGZvbGRpbmdcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIHJlZHVjZVJpZ2h0ID0gUk5FQS5yZWR1Y2VSaWdodDtcbi8qKlxuICogQGNhdGVnb3J5IGZvbGRpbmdcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIHJlZHVjZVJpZ2h0V2l0aEluZGV4ID0gUk5FQS5yZWR1Y2VSaWdodFdpdGhJbmRleDtcbi8qKlxuICogQGNhdGVnb3J5IHRyYXZlcnNpbmdcbiAqIEBzaW5jZSAyLjYuM1xuICovXG5leHBvcnQgdmFyIHRyYXZlcnNlID0gZnVuY3Rpb24gKEYpIHtcbiAgICB2YXIgdHJhdmVyc2VXaXRoSW5kZXhGID0gdHJhdmVyc2VXaXRoSW5kZXgoRik7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChmKSB7IHJldHVybiB0cmF2ZXJzZVdpdGhJbmRleEYoZnVuY3Rpb24gKF8sIGEpIHsgcmV0dXJuIGYoYSk7IH0pOyB9O1xufTtcbi8qKlxuICogQGNhdGVnb3J5IHRyYXZlcnNpbmdcbiAqIEBzaW5jZSAyLjYuM1xuICovXG5leHBvcnQgdmFyIHNlcXVlbmNlID0gZnVuY3Rpb24gKEYpIHsgcmV0dXJuIHRyYXZlcnNlV2l0aEluZGV4KEYpKGZ1bmN0aW9uIChfLCBhKSB7IHJldHVybiBhOyB9KTsgfTtcbi8qKlxuICogQGNhdGVnb3J5IHNlcXVlbmNpbmdcbiAqIEBzaW5jZSAyLjYuM1xuICovXG5leHBvcnQgdmFyIHRyYXZlcnNlV2l0aEluZGV4ID0gZnVuY3Rpb24gKEYpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGYpIHtcbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIChhcykge1xuICAgICAgICAgICAgdmFyIG91dCA9IEYubWFwKGYoMCwgaGVhZChhcykpLCBvZik7XG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMTsgaSA8IGFzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgb3V0ID0gRi5hcChGLm1hcChvdXQsIGZ1bmN0aW9uIChicykgeyByZXR1cm4gZnVuY3Rpb24gKGIpIHsgcmV0dXJuIHBpcGUoYnMsIGFwcGVuZChiKSk7IH07IH0pLCBmKGksIGFzW2ldKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gb3V0O1xuICAgICAgICB9O1xuICAgIH07XG59O1xuLyoqXG4gKiBAc2luY2UgMi43LjBcbiAqL1xuZXhwb3J0IHZhciBleHRyYWN0ID0gUk5FQS5oZWFkO1xuLyoqXG4gKiBAY2F0ZWdvcnkgdHlwZSBsYW1iZGFzXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciBVUkkgPSAnTm9uRW1wdHlBcnJheSc7XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIGdldFNob3cgPSBSTkVBLmdldFNob3c7XG4vKipcbiAqIEJ1aWxkcyBhIGBTZW1pZ3JvdXBgIGluc3RhbmNlIGZvciBgTm9uRW1wdHlBcnJheWBcbiAqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciBnZXRTZW1pZ3JvdXAgPSBmdW5jdGlvbiAoKSB7IHJldHVybiAoe1xuICAgIGNvbmNhdDogY29uY2F0XG59KTsgfTtcbi8qKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IGdldEVxIH0gZnJvbSAnZnAtdHMvTm9uRW1wdHlBcnJheSdcbiAqIGltcG9ydCAqIGFzIE4gZnJvbSAnZnAtdHMvbnVtYmVyJ1xuICpcbiAqIGNvbnN0IEUgPSBnZXRFcShOLkVxKVxuICogYXNzZXJ0LnN0cmljdEVxdWFsKEUuZXF1YWxzKFsxLCAyXSwgWzEsIDJdKSwgdHJ1ZSlcbiAqIGFzc2VydC5zdHJpY3RFcXVhbChFLmVxdWFscyhbMSwgMl0sIFsxLCAzXSksIGZhbHNlKVxuICpcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIGdldEVxID0gUk5FQS5nZXRFcTtcbi8qKlxuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIGdldFVuaW9uU2VtaWdyb3VwID0gZnVuY3Rpb24gKEUpIHtcbiAgICB2YXIgdW5pb25FID0gdW5pb24oRSk7XG4gICAgcmV0dXJuIHtcbiAgICAgICAgY29uY2F0OiBmdW5jdGlvbiAoZmlyc3QsIHNlY29uZCkgeyByZXR1cm4gdW5pb25FKHNlY29uZCkoZmlyc3QpOyB9XG4gICAgfTtcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjcuMFxuICovXG5leHBvcnQgdmFyIEZ1bmN0b3IgPSB7XG4gICAgVVJJOiBVUkksXG4gICAgbWFwOiBfbWFwXG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgbWFwcGluZ1xuICogQHNpbmNlIDIuMTAuMFxuICovXG5leHBvcnQgdmFyIGZsYXAgPSAvKiNfX1BVUkVfXyovIGZsYXBfKEZ1bmN0b3IpO1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi4xMC4wXG4gKi9cbmV4cG9ydCB2YXIgUG9pbnRlZCA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICBvZjogb2Zcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjcuMFxuICovXG5leHBvcnQgdmFyIEZ1bmN0b3JXaXRoSW5kZXggPSB7XG4gICAgVVJJOiBVUkksXG4gICAgbWFwOiBfbWFwLFxuICAgIG1hcFdpdGhJbmRleDogX21hcFdpdGhJbmRleFxufTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuMTAuMFxuICovXG5leHBvcnQgdmFyIEFwcGx5ID0ge1xuICAgIFVSSTogVVJJLFxuICAgIG1hcDogX21hcCxcbiAgICBhcDogX2FwXG59O1xuLyoqXG4gKiBDb21iaW5lIHR3byBlZmZlY3RmdWwgYWN0aW9ucywga2VlcGluZyBvbmx5IHRoZSByZXN1bHQgb2YgdGhlIGZpcnN0LlxuICpcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIGFwRmlyc3QgPSAvKiNfX1BVUkVfXyovIGFwRmlyc3RfKEFwcGx5KTtcbi8qKlxuICogQ29tYmluZSB0d28gZWZmZWN0ZnVsIGFjdGlvbnMsIGtlZXBpbmcgb25seSB0aGUgcmVzdWx0IG9mIHRoZSBzZWNvbmQuXG4gKlxuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgYXBTZWNvbmQgPSAvKiNfX1BVUkVfXyovIGFwU2Vjb25kXyhBcHBseSk7XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjcuMFxuICovXG5leHBvcnQgdmFyIEFwcGxpY2F0aXZlID0ge1xuICAgIFVSSTogVVJJLFxuICAgIG1hcDogX21hcCxcbiAgICBhcDogX2FwLFxuICAgIG9mOiBvZlxufTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuMTAuMFxuICovXG5leHBvcnQgdmFyIENoYWluID0ge1xuICAgIFVSSTogVVJJLFxuICAgIG1hcDogX21hcCxcbiAgICBhcDogX2FwLFxuICAgIGNoYWluOiBmbGF0TWFwXG59O1xuLyoqXG4gKiBDb21wb3NlcyBjb21wdXRhdGlvbnMgaW4gc2VxdWVuY2UsIHVzaW5nIHRoZSByZXR1cm4gdmFsdWUgb2Ygb25lIGNvbXB1dGF0aW9uIHRvIGRldGVybWluZSB0aGUgbmV4dCBjb21wdXRhdGlvbiBhbmRcbiAqIGtlZXBpbmcgb25seSB0aGUgcmVzdWx0IG9mIHRoZSBmaXJzdC5cbiAqXG4gKiBAY2F0ZWdvcnkgc2VxdWVuY2luZ1xuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgY2hhaW5GaXJzdCA9IFxuLyojX19QVVJFX18qLyBjaGFpbkZpcnN0XyhDaGFpbik7XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjcuMFxuICovXG5leHBvcnQgdmFyIE1vbmFkID0ge1xuICAgIFVSSTogVVJJLFxuICAgIG1hcDogX21hcCxcbiAgICBhcDogX2FwLFxuICAgIG9mOiBvZixcbiAgICBjaGFpbjogZmxhdE1hcFxufTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuNy4wXG4gKi9cbmV4cG9ydCB2YXIgRm9sZGFibGUgPSB7XG4gICAgVVJJOiBVUkksXG4gICAgcmVkdWNlOiBfcmVkdWNlLFxuICAgIGZvbGRNYXA6IF9mb2xkTWFwLFxuICAgIHJlZHVjZVJpZ2h0OiBfcmVkdWNlUmlnaHRcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjcuMFxuICovXG5leHBvcnQgdmFyIEZvbGRhYmxlV2l0aEluZGV4ID0ge1xuICAgIFVSSTogVVJJLFxuICAgIHJlZHVjZTogX3JlZHVjZSxcbiAgICBmb2xkTWFwOiBfZm9sZE1hcCxcbiAgICByZWR1Y2VSaWdodDogX3JlZHVjZVJpZ2h0LFxuICAgIHJlZHVjZVdpdGhJbmRleDogX3JlZHVjZVdpdGhJbmRleCxcbiAgICBmb2xkTWFwV2l0aEluZGV4OiBfZm9sZE1hcFdpdGhJbmRleCxcbiAgICByZWR1Y2VSaWdodFdpdGhJbmRleDogX3JlZHVjZVJpZ2h0V2l0aEluZGV4XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi43LjBcbiAqL1xuZXhwb3J0IHZhciBUcmF2ZXJzYWJsZSA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICBtYXA6IF9tYXAsXG4gICAgcmVkdWNlOiBfcmVkdWNlLFxuICAgIGZvbGRNYXA6IF9mb2xkTWFwLFxuICAgIHJlZHVjZVJpZ2h0OiBfcmVkdWNlUmlnaHQsXG4gICAgdHJhdmVyc2U6IF90cmF2ZXJzZSxcbiAgICBzZXF1ZW5jZTogc2VxdWVuY2Vcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjcuMFxuICovXG5leHBvcnQgdmFyIFRyYXZlcnNhYmxlV2l0aEluZGV4ID0ge1xuICAgIFVSSTogVVJJLFxuICAgIG1hcDogX21hcCxcbiAgICBtYXBXaXRoSW5kZXg6IF9tYXBXaXRoSW5kZXgsXG4gICAgcmVkdWNlOiBfcmVkdWNlLFxuICAgIGZvbGRNYXA6IF9mb2xkTWFwLFxuICAgIHJlZHVjZVJpZ2h0OiBfcmVkdWNlUmlnaHQsXG4gICAgdHJhdmVyc2U6IF90cmF2ZXJzZSxcbiAgICBzZXF1ZW5jZTogc2VxdWVuY2UsXG4gICAgcmVkdWNlV2l0aEluZGV4OiBfcmVkdWNlV2l0aEluZGV4LFxuICAgIGZvbGRNYXBXaXRoSW5kZXg6IF9mb2xkTWFwV2l0aEluZGV4LFxuICAgIHJlZHVjZVJpZ2h0V2l0aEluZGV4OiBfcmVkdWNlUmlnaHRXaXRoSW5kZXgsXG4gICAgdHJhdmVyc2VXaXRoSW5kZXg6IF90cmF2ZXJzZVdpdGhJbmRleFxufTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuNy4wXG4gKi9cbmV4cG9ydCB2YXIgQWx0ID0ge1xuICAgIFVSSTogVVJJLFxuICAgIG1hcDogX21hcCxcbiAgICBhbHQ6IF9hbHRcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjcuMFxuICovXG5leHBvcnQgdmFyIENvbW9uYWQgPSB7XG4gICAgVVJJOiBVUkksXG4gICAgbWFwOiBfbWFwLFxuICAgIGV4dGVuZDogX2V4dGVuZCxcbiAgICBleHRyYWN0OiBleHRyYWN0XG59O1xuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLy8gZG8gbm90YXRpb25cbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8qKlxuICogQGNhdGVnb3J5IGRvIG5vdGF0aW9uXG4gKiBAc2luY2UgMi45LjBcbiAqL1xuZXhwb3J0IHZhciBEbyA9IC8qI19fUFVSRV9fKi8gb2YoXy5lbXB0eVJlY29yZCk7XG4vKipcbiAqIEBjYXRlZ29yeSBkbyBub3RhdGlvblxuICogQHNpbmNlIDIuOC4wXG4gKi9cbmV4cG9ydCB2YXIgYmluZFRvID0gLyojX19QVVJFX18qLyBiaW5kVG9fKEZ1bmN0b3IpO1xudmFyIGxldF8gPSAvKiNfX1BVUkVfXyovIGxldF9fKEZ1bmN0b3IpO1xuZXhwb3J0IHsgXG4vKipcbiAqIEBjYXRlZ29yeSBkbyBub3RhdGlvblxuICogQHNpbmNlIDIuMTMuMFxuICovXG5sZXRfIGFzIGxldCB9O1xuLyoqXG4gKiBAY2F0ZWdvcnkgZG8gbm90YXRpb25cbiAqIEBzaW5jZSAyLjguMFxuICovXG5leHBvcnQgdmFyIGJpbmQgPSAvKiNfX1BVUkVfXyovIGJpbmRfKENoYWluKTtcbi8qKlxuICogQGNhdGVnb3J5IGRvIG5vdGF0aW9uXG4gKiBAc2luY2UgMi44LjBcbiAqL1xuZXhwb3J0IHZhciBhcFMgPSAvKiNfX1BVUkVfXyovIGFwU18oQXBwbHkpO1xuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLy8gdXRpbHNcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8qKlxuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgaGVhZCA9IFJORUEuaGVhZDtcbi8qKlxuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgdGFpbCA9IGZ1bmN0aW9uIChhcykgeyByZXR1cm4gYXMuc2xpY2UoMSk7IH07XG4vKipcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIGxhc3QgPSBSTkVBLmxhc3Q7XG4vKipcbiAqIEdldCBhbGwgYnV0IHRoZSBsYXN0IGVsZW1lbnQgb2YgYSBub24gZW1wdHkgYXJyYXksIGNyZWF0aW5nIGEgbmV3IGFycmF5LlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBpbml0IH0gZnJvbSAnZnAtdHMvTm9uRW1wdHlBcnJheSdcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKGluaXQoWzEsIDIsIDNdKSwgWzEsIDJdKVxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChpbml0KFsxXSksIFtdKVxuICpcbiAqIEBzaW5jZSAyLjIuMFxuICovXG5leHBvcnQgdmFyIGluaXQgPSBmdW5jdGlvbiAoYXMpIHsgcmV0dXJuIGFzLnNsaWNlKDAsIC0xKTsgfTtcbi8qKlxuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgbWluID0gUk5FQS5taW47XG4vKipcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIG1heCA9IFJORUEubWF4O1xuLyoqXG4gKiBAc2luY2UgMi4xMC4wXG4gKi9cbmV4cG9ydCB2YXIgY29uY2F0QWxsID0gZnVuY3Rpb24gKFMpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIHJldHVybiBhcy5yZWR1Y2UoUy5jb25jYXQpO1xuICAgIH07XG59O1xuLyoqXG4gKiBCcmVhayBhbiBgQXJyYXlgIGludG8gaXRzIGZpcnN0IGVsZW1lbnQgYW5kIHJlbWFpbmluZyBlbGVtZW50cy5cbiAqXG4gKiBAY2F0ZWdvcnkgcGF0dGVybiBtYXRjaGluZ1xuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIG1hdGNoTGVmdCA9IGZ1bmN0aW9uIChmKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykge1xuICAgICAgICByZXR1cm4gZihoZWFkKGFzKSwgdGFpbChhcykpO1xuICAgIH07XG59O1xuLyoqXG4gKiBCcmVhayBhbiBgQXJyYXlgIGludG8gaXRzIGluaXRpYWwgZWxlbWVudHMgYW5kIHRoZSBsYXN0IGVsZW1lbnQuXG4gKlxuICogQGNhdGVnb3J5IHBhdHRlcm4gbWF0Y2hpbmdcbiAqIEBzaW5jZSAyLjExLjBcbiAqL1xuZXhwb3J0IHZhciBtYXRjaFJpZ2h0ID0gZnVuY3Rpb24gKGYpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIHJldHVybiBmKGluaXQoYXMpLCBsYXN0KGFzKSk7XG4gICAgfTtcbn07XG4vKipcbiAqIEFwcGx5IGEgZnVuY3Rpb24gdG8gdGhlIGhlYWQsIGNyZWF0aW5nIGEgbmV3IGBOb25FbXB0eUFycmF5YC5cbiAqXG4gKiBAc2luY2UgMi4xMS4wXG4gKi9cbmV4cG9ydCB2YXIgbW9kaWZ5SGVhZCA9IGZ1bmN0aW9uIChmKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykge1xuICAgICAgICByZXR1cm4gX19zcHJlYWRBcnJheShbZihoZWFkKGFzKSldLCB0YWlsKGFzKSwgdHJ1ZSk7XG4gICAgfTtcbn07XG4vKipcbiAqIENoYW5nZSB0aGUgaGVhZCwgY3JlYXRpbmcgYSBuZXcgYE5vbkVtcHR5QXJyYXlgLlxuICpcbiAqIEBzaW5jZSAyLjExLjBcbiAqL1xuZXhwb3J0IHZhciB1cGRhdGVIZWFkID0gZnVuY3Rpb24gKGEpIHsgcmV0dXJuIG1vZGlmeUhlYWQoZnVuY3Rpb24gKCkgeyByZXR1cm4gYTsgfSk7IH07XG4vKipcbiAqIEFwcGx5IGEgZnVuY3Rpb24gdG8gdGhlIGxhc3QgZWxlbWVudCwgY3JlYXRpbmcgYSBuZXcgYE5vbkVtcHR5QXJyYXlgLlxuICpcbiAqIEBzaW5jZSAyLjExLjBcbiAqL1xuZXhwb3J0IHZhciBtb2RpZnlMYXN0ID0gZnVuY3Rpb24gKGYpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIHJldHVybiBwaXBlKGluaXQoYXMpLCBhcHBlbmQoZihsYXN0KGFzKSkpKTtcbiAgICB9O1xufTtcbi8qKlxuICogQ2hhbmdlIHRoZSBsYXN0IGVsZW1lbnQsIGNyZWF0aW5nIGEgbmV3IGBOb25FbXB0eUFycmF5YC5cbiAqXG4gKiBAc2luY2UgMi4xMS4wXG4gKi9cbmV4cG9ydCB2YXIgdXBkYXRlTGFzdCA9IGZ1bmN0aW9uIChhKSB7IHJldHVybiBtb2RpZnlMYXN0KGZ1bmN0aW9uICgpIHsgcmV0dXJuIGE7IH0pOyB9O1xuLyoqXG4gKiBQbGFjZXMgYW4gZWxlbWVudCBpbiBiZXR3ZWVuIG1lbWJlcnMgb2YgYSBgTm9uRW1wdHlBcnJheWAsIHRoZW4gZm9sZHMgdGhlIHJlc3VsdHMgdXNpbmcgdGhlIHByb3ZpZGVkIGBTZW1pZ3JvdXBgLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgKiBhcyBTIGZyb20gJ2ZwLXRzL3N0cmluZydcbiAqIGltcG9ydCB7IGludGVyY2FsYXRlIH0gZnJvbSAnZnAtdHMvTm9uRW1wdHlBcnJheSdcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKGludGVyY2FsYXRlKFMuU2VtaWdyb3VwKSgnLScpKFsnYScsICdiJywgJ2MnXSksICdhLWItYycpXG4gKlxuICogQHNpbmNlIDIuMTIuMFxuICovXG5leHBvcnQgdmFyIGludGVyY2FsYXRlID0gUk5FQS5pbnRlcmNhbGF0ZTtcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8vIGxlZ2FjeVxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLyoqXG4gKiBBbGlhcyBvZiBgZmxhdE1hcGAuXG4gKlxuICogQGNhdGVnb3J5IGxlZ2FjeVxuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgY2hhaW4gPSBmbGF0TWFwO1xuZXhwb3J0IGZ1bmN0aW9uIGdyb3VwU29ydChPKSB7XG4gICAgdmFyIHNvcnRPID0gc29ydChPKTtcbiAgICB2YXIgZ3JvdXBPID0gZ3JvdXAoTyk7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykgeyByZXR1cm4gKGlzTm9uRW1wdHkoYXMpID8gZ3JvdXBPKHNvcnRPKGFzKSkgOiBbXSk7IH07XG59XG5leHBvcnQgZnVuY3Rpb24gZmlsdGVyKHByZWRpY2F0ZSkge1xuICAgIHJldHVybiBmaWx0ZXJXaXRoSW5kZXgoZnVuY3Rpb24gKF8sIGEpIHsgcmV0dXJuIHByZWRpY2F0ZShhKTsgfSk7XG59XG4vKipcbiAqIFVzZSBbYGZpbHRlcldpdGhJbmRleGBdKC4vQXJyYXkudHMuaHRtbCNmaWx0ZXJ3aXRoaW5kZXgpIGluc3RlYWQuXG4gKlxuICogQGNhdGVnb3J5IHpvbmUgb2YgZGVhdGhcbiAqIEBzaW5jZSAyLjAuMFxuICogQGRlcHJlY2F0ZWRcbiAqL1xuZXhwb3J0IHZhciBmaWx0ZXJXaXRoSW5kZXggPSBmdW5jdGlvbiAocHJlZGljYXRlKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykge1xuICAgICAgICByZXR1cm4gZnJvbUFycmF5KGFzLmZpbHRlcihmdW5jdGlvbiAoYSwgaSkgeyByZXR1cm4gcHJlZGljYXRlKGksIGEpOyB9KSk7XG4gICAgfTtcbn07XG4vKipcbiAqIFVzZSBbYHVucHJlcGVuZGBdKCN1bnByZXBlbmQpIGluc3RlYWQuXG4gKlxuICogQGNhdGVnb3J5IHpvbmUgb2YgZGVhdGhcbiAqIEBzaW5jZSAyLjkuMFxuICogQGRlcHJlY2F0ZWRcbiAqL1xuZXhwb3J0IHZhciB1bmNvbnMgPSB1bnByZXBlbmQ7XG4vKipcbiAqIFVzZSBbYHVuYXBwZW5kYF0oI3VuYXBwZW5kKSBpbnN0ZWFkLlxuICpcbiAqIEBjYXRlZ29yeSB6b25lIG9mIGRlYXRoXG4gKiBAc2luY2UgMi45LjBcbiAqIEBkZXByZWNhdGVkXG4gKi9cbmV4cG9ydCB2YXIgdW5zbm9jID0gdW5hcHBlbmQ7XG5leHBvcnQgZnVuY3Rpb24gY29ucyhoZWFkLCB0YWlsKSB7XG4gICAgcmV0dXJuIHRhaWwgPT09IHVuZGVmaW5lZCA/IHByZXBlbmQoaGVhZCkgOiBwaXBlKHRhaWwsIHByZXBlbmQoaGVhZCkpO1xufVxuLyoqXG4gKiBVc2UgW2BhcHBlbmRgXSguL0FycmF5LnRzLmh0bWwjYXBwZW5kKSBpbnN0ZWFkLlxuICpcbiAqIEBjYXRlZ29yeSB6b25lIG9mIGRlYXRoXG4gKiBAc2luY2UgMi4wLjBcbiAqIEBkZXByZWNhdGVkXG4gKi9cbmV4cG9ydCB2YXIgc25vYyA9IGZ1bmN0aW9uIChpbml0LCBlbmQpIHsgcmV0dXJuIHBpcGUoaW5pdCwgYXBwZW5kKGVuZCkpOyB9O1xuLyoqXG4gKiBVc2UgW2BwcmVwZW5kQWxsYF0oI3ByZXBlbmRhbGwpIGluc3RlYWQuXG4gKlxuICogQGNhdGVnb3J5IHpvbmUgb2YgZGVhdGhcbiAqIEBzaW5jZSAyLjkuMFxuICogQGRlcHJlY2F0ZWRcbiAqL1xuZXhwb3J0IHZhciBwcmVwZW5kVG9BbGwgPSBwcmVwZW5kQWxsO1xuLyoqXG4gKiBVc2UgW2Bjb25jYXRBbGxgXSgjY29uY2F0YWxsKSBpbnN0ZWFkLlxuICpcbiAqIEBjYXRlZ29yeSB6b25lIG9mIGRlYXRoXG4gKiBAc2luY2UgMi41LjBcbiAqIEBkZXByZWNhdGVkXG4gKi9cbmV4cG9ydCB2YXIgZm9sZCA9IFJORUEuY29uY2F0QWxsO1xuLyoqXG4gKiBUaGlzIGluc3RhbmNlIGlzIGRlcHJlY2F0ZWQsIHVzZSBzbWFsbCwgc3BlY2lmaWMgaW5zdGFuY2VzIGluc3RlYWQuXG4gKiBGb3IgZXhhbXBsZSBpZiBhIGZ1bmN0aW9uIG5lZWRzIGEgYEZ1bmN0b3JgIGluc3RhbmNlLCBwYXNzIGBORUEuRnVuY3RvcmAgaW5zdGVhZCBvZiBgTkVBLm5vbkVtcHR5QXJyYXlgXG4gKiAod2hlcmUgYE5FQWAgaXMgZnJvbSBgaW1wb3J0IE5FQSBmcm9tICdmcC10cy9Ob25FbXB0eUFycmF5J2ApXG4gKlxuICogQGNhdGVnb3J5IHpvbmUgb2YgZGVhdGhcbiAqIEBzaW5jZSAyLjAuMFxuICogQGRlcHJlY2F0ZWRcbiAqL1xuZXhwb3J0IHZhciBub25FbXB0eUFycmF5ID0ge1xuICAgIFVSSTogVVJJLFxuICAgIG9mOiBvZixcbiAgICBtYXA6IF9tYXAsXG4gICAgbWFwV2l0aEluZGV4OiBfbWFwV2l0aEluZGV4LFxuICAgIGFwOiBfYXAsXG4gICAgY2hhaW46IGZsYXRNYXAsXG4gICAgZXh0ZW5kOiBfZXh0ZW5kLFxuICAgIGV4dHJhY3Q6IGV4dHJhY3QsXG4gICAgcmVkdWNlOiBfcmVkdWNlLFxuICAgIGZvbGRNYXA6IF9mb2xkTWFwLFxuICAgIHJlZHVjZVJpZ2h0OiBfcmVkdWNlUmlnaHQsXG4gICAgdHJhdmVyc2U6IF90cmF2ZXJzZSxcbiAgICBzZXF1ZW5jZTogc2VxdWVuY2UsXG4gICAgcmVkdWNlV2l0aEluZGV4OiBfcmVkdWNlV2l0aEluZGV4LFxuICAgIGZvbGRNYXBXaXRoSW5kZXg6IF9mb2xkTWFwV2l0aEluZGV4LFxuICAgIHJlZHVjZVJpZ2h0V2l0aEluZGV4OiBfcmVkdWNlUmlnaHRXaXRoSW5kZXgsXG4gICAgdHJhdmVyc2VXaXRoSW5kZXg6IF90cmF2ZXJzZVdpdGhJbmRleCxcbiAgICBhbHQ6IF9hbHRcbn07XG4iLAogICIvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vLyByZWZpbmVtZW50c1xuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLyoqXG4gKiBAY2F0ZWdvcnkgcmVmaW5lbWVudHNcbiAqIEBzaW5jZSAyLjExLjBcbiAqL1xuZXhwb3J0IHZhciBpc051bWJlciA9IGZ1bmN0aW9uICh1KSB7IHJldHVybiB0eXBlb2YgdSA9PT0gJ251bWJlcic7IH07XG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vLyBpbnN0YW5jZXNcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuMTAuMFxuICovXG5leHBvcnQgdmFyIEVxID0ge1xuICAgIGVxdWFsczogZnVuY3Rpb24gKGZpcnN0LCBzZWNvbmQpIHsgcmV0dXJuIGZpcnN0ID09PSBzZWNvbmQ7IH1cbn07XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjEwLjBcbiAqL1xuZXhwb3J0IHZhciBPcmQgPSB7XG4gICAgZXF1YWxzOiBFcS5lcXVhbHMsXG4gICAgY29tcGFyZTogZnVuY3Rpb24gKGZpcnN0LCBzZWNvbmQpIHsgcmV0dXJuIChmaXJzdCA8IHNlY29uZCA/IC0xIDogZmlyc3QgPiBzZWNvbmQgPyAxIDogMCk7IH1cbn07XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjEwLjBcbiAqL1xuZXhwb3J0IHZhciBCb3VuZGVkID0ge1xuICAgIGVxdWFsczogRXEuZXF1YWxzLFxuICAgIGNvbXBhcmU6IE9yZC5jb21wYXJlLFxuICAgIHRvcDogSW5maW5pdHksXG4gICAgYm90dG9tOiAtSW5maW5pdHlcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjEwLjBcbiAqL1xuZXhwb3J0IHZhciBTaG93ID0ge1xuICAgIHNob3c6IGZ1bmN0aW9uIChuKSB7IHJldHVybiBKU09OLnN0cmluZ2lmeShuKTsgfVxufTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIE1hZ21hU3ViID0ge1xuICAgIGNvbmNhdDogZnVuY3Rpb24gKGZpcnN0LCBzZWNvbmQpIHsgcmV0dXJuIGZpcnN0IC0gc2Vjb25kOyB9XG59O1xuLyoqXG4gKiBgbnVtYmVyYCBzZW1pZ3JvdXAgdW5kZXIgYWRkaXRpb24uXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IFNlbWlncm91cFN1bSB9IGZyb20gJ2ZwLXRzL251bWJlcidcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKFNlbWlncm91cFN1bS5jb25jYXQoMiwgMyksIDUpXG4gKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuMTAuMFxuICovXG5leHBvcnQgdmFyIFNlbWlncm91cFN1bSA9IHtcbiAgICBjb25jYXQ6IGZ1bmN0aW9uIChmaXJzdCwgc2Vjb25kKSB7IHJldHVybiBmaXJzdCArIHNlY29uZDsgfVxufTtcbi8qKlxuICogYG51bWJlcmAgc2VtaWdyb3VwIHVuZGVyIG11bHRpcGxpY2F0aW9uLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBTZW1pZ3JvdXBQcm9kdWN0IH0gZnJvbSAnZnAtdHMvbnVtYmVyJ1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoU2VtaWdyb3VwUHJvZHVjdC5jb25jYXQoMiwgMyksIDYpXG4gKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuMTAuMFxuICovXG5leHBvcnQgdmFyIFNlbWlncm91cFByb2R1Y3QgPSB7XG4gICAgY29uY2F0OiBmdW5jdGlvbiAoZmlyc3QsIHNlY29uZCkgeyByZXR1cm4gZmlyc3QgKiBzZWNvbmQ7IH1cbn07XG4vKipcbiAqIGBudW1iZXJgIG1vbm9pZCB1bmRlciBhZGRpdGlvbi5cbiAqXG4gKiBUaGUgYGVtcHR5YCB2YWx1ZSBpcyBgMGAuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IE1vbm9pZFN1bSB9IGZyb20gJ2ZwLXRzL251bWJlcidcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKE1vbm9pZFN1bS5jb25jYXQoMiwgTW9ub2lkU3VtLmVtcHR5KSwgMilcbiAqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi4xMC4wXG4gKi9cbmV4cG9ydCB2YXIgTW9ub2lkU3VtID0ge1xuICAgIGNvbmNhdDogU2VtaWdyb3VwU3VtLmNvbmNhdCxcbiAgICBlbXB0eTogMFxufTtcbi8qKlxuICogYG51bWJlcmAgbW9ub2lkIHVuZGVyIG11bHRpcGxpY2F0aW9uLlxuICpcbiAqIFRoZSBgZW1wdHlgIHZhbHVlIGlzIGAxYC5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgTW9ub2lkUHJvZHVjdCB9IGZyb20gJ2ZwLXRzL251bWJlcidcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKE1vbm9pZFByb2R1Y3QuY29uY2F0KDIsIE1vbm9pZFByb2R1Y3QuZW1wdHkpLCAyKVxuICpcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjEwLjBcbiAqL1xuZXhwb3J0IHZhciBNb25vaWRQcm9kdWN0ID0ge1xuICAgIGNvbmNhdDogU2VtaWdyb3VwUHJvZHVjdC5jb25jYXQsXG4gICAgZW1wdHk6IDFcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjEwLjBcbiAqL1xuZXhwb3J0IHZhciBGaWVsZCA9IHtcbiAgICBhZGQ6IFNlbWlncm91cFN1bS5jb25jYXQsXG4gICAgemVybzogMCxcbiAgICBtdWw6IFNlbWlncm91cFByb2R1Y3QuY29uY2F0LFxuICAgIG9uZTogMSxcbiAgICBzdWI6IE1hZ21hU3ViLmNvbmNhdCxcbiAgICBkZWdyZWU6IGZ1bmN0aW9uIChfKSB7IHJldHVybiAxOyB9LFxuICAgIGRpdjogZnVuY3Rpb24gKGZpcnN0LCBzZWNvbmQpIHsgcmV0dXJuIGZpcnN0IC8gc2Vjb25kOyB9LFxuICAgIG1vZDogZnVuY3Rpb24gKGZpcnN0LCBzZWNvbmQpIHsgcmV0dXJuIGZpcnN0ICUgc2Vjb25kOyB9XG59O1xuIiwKICAiLyoqXG4gKiBgYGB0c1xuICogaW50ZXJmYWNlIFNlcGFyYXRlZDxFLCBBPiB7XG4gKiAgICByZWFkb25seSBsZWZ0OiBFXG4gKiAgICByZWFkb25seSByaWdodDogQVxuICogfVxuICogYGBgXG4gKlxuICogUmVwcmVzZW50cyBhIHJlc3VsdCBvZiBzZXBhcmF0aW5nIGEgd2hvbGUgaW50byB0d28gcGFydHMuXG4gKlxuICogQHNpbmNlIDIuMTAuMFxuICovXG5pbXBvcnQgeyBwaXBlIH0gZnJvbSAnLi9mdW5jdGlvbic7XG5pbXBvcnQgeyBmbGFwIGFzIGZsYXBfIH0gZnJvbSAnLi9GdW5jdG9yJztcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8vIGNvbnN0cnVjdG9yc1xuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLyoqXG4gKiBAY2F0ZWdvcnkgY29uc3RydWN0b3JzXG4gKiBAc2luY2UgMi4xMC4wXG4gKi9cbmV4cG9ydCB2YXIgc2VwYXJhdGVkID0gZnVuY3Rpb24gKGxlZnQsIHJpZ2h0KSB7IHJldHVybiAoeyBsZWZ0OiBsZWZ0LCByaWdodDogcmlnaHQgfSk7IH07XG52YXIgX21hcCA9IGZ1bmN0aW9uIChmYSwgZikgeyByZXR1cm4gcGlwZShmYSwgbWFwKGYpKTsgfTtcbnZhciBfbWFwTGVmdCA9IGZ1bmN0aW9uIChmYSwgZikgeyByZXR1cm4gcGlwZShmYSwgbWFwTGVmdChmKSk7IH07XG52YXIgX2JpbWFwID0gZnVuY3Rpb24gKGZhLCBnLCBmKSB7IHJldHVybiBwaXBlKGZhLCBiaW1hcChnLCBmKSk7IH07XG4vKipcbiAqIGBtYXBgIGNhbiBiZSB1c2VkIHRvIHR1cm4gZnVuY3Rpb25zIGAoYTogQSkgPT4gQmAgaW50byBmdW5jdGlvbnMgYChmYTogRjxBPikgPT4gRjxCPmAgd2hvc2UgYXJndW1lbnQgYW5kIHJldHVybiB0eXBlc1xuICogdXNlIHRoZSB0eXBlIGNvbnN0cnVjdG9yIGBGYCB0byByZXByZXNlbnQgc29tZSBjb21wdXRhdGlvbmFsIGNvbnRleHQuXG4gKlxuICogQGNhdGVnb3J5IG1hcHBpbmdcbiAqIEBzaW5jZSAyLjEwLjBcbiAqL1xuZXhwb3J0IHZhciBtYXAgPSBmdW5jdGlvbiAoZikge1xuICAgIHJldHVybiBmdW5jdGlvbiAoZmEpIHtcbiAgICAgICAgcmV0dXJuIHNlcGFyYXRlZChsZWZ0KGZhKSwgZihyaWdodChmYSkpKTtcbiAgICB9O1xufTtcbi8qKlxuICogTWFwIGEgZnVuY3Rpb24gb3ZlciB0aGUgZmlyc3QgdHlwZSBhcmd1bWVudCBvZiBhIGJpZnVuY3Rvci5cbiAqXG4gKiBAY2F0ZWdvcnkgZXJyb3IgaGFuZGxpbmdcbiAqIEBzaW5jZSAyLjEwLjBcbiAqL1xuZXhwb3J0IHZhciBtYXBMZWZ0ID0gZnVuY3Rpb24gKGYpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGZhKSB7XG4gICAgICAgIHJldHVybiBzZXBhcmF0ZWQoZihsZWZ0KGZhKSksIHJpZ2h0KGZhKSk7XG4gICAgfTtcbn07XG4vKipcbiAqIE1hcCBhIHBhaXIgb2YgZnVuY3Rpb25zIG92ZXIgdGhlIHR3byB0eXBlIGFyZ3VtZW50cyBvZiB0aGUgYmlmdW5jdG9yLlxuICpcbiAqIEBjYXRlZ29yeSBtYXBwaW5nXG4gKiBAc2luY2UgMi4xMC4wXG4gKi9cbmV4cG9ydCB2YXIgYmltYXAgPSBmdW5jdGlvbiAoZiwgZykge1xuICAgIHJldHVybiBmdW5jdGlvbiAoZmEpIHtcbiAgICAgICAgcmV0dXJuIHNlcGFyYXRlZChmKGxlZnQoZmEpKSwgZyhyaWdodChmYSkpKTtcbiAgICB9O1xufTtcbi8qKlxuICogQGNhdGVnb3J5IHR5cGUgbGFtYmRhc1xuICogQHNpbmNlIDIuMTAuMFxuICovXG5leHBvcnQgdmFyIFVSSSA9ICdTZXBhcmF0ZWQnO1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi4xMC4wXG4gKi9cbmV4cG9ydCB2YXIgQmlmdW5jdG9yID0ge1xuICAgIFVSSTogVVJJLFxuICAgIG1hcExlZnQ6IF9tYXBMZWZ0LFxuICAgIGJpbWFwOiBfYmltYXBcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjEwLjBcbiAqL1xuZXhwb3J0IHZhciBGdW5jdG9yID0ge1xuICAgIFVSSTogVVJJLFxuICAgIG1hcDogX21hcFxufTtcbi8qKlxuICogQGNhdGVnb3J5IG1hcHBpbmdcbiAqIEBzaW5jZSAyLjEwLjBcbiAqL1xuZXhwb3J0IHZhciBmbGFwID0gLyojX19QVVJFX18qLyBmbGFwXyhGdW5jdG9yKTtcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8vIHV0aWxzXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vKipcbiAqIEBzaW5jZSAyLjEwLjBcbiAqL1xuZXhwb3J0IHZhciBsZWZ0ID0gZnVuY3Rpb24gKHMpIHsgcmV0dXJuIHMubGVmdDsgfTtcbi8qKlxuICogQHNpbmNlIDIuMTAuMFxuICovXG5leHBvcnQgdmFyIHJpZ2h0ID0gZnVuY3Rpb24gKHMpIHsgcmV0dXJuIHMucmlnaHQ7IH07XG4iLAogICJpbXBvcnQgKiBhcyBfIGZyb20gJy4vaW50ZXJuYWwnO1xuZXhwb3J0IGZ1bmN0aW9uIHdpbHREZWZhdWx0KFQsIEMpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKEYpIHtcbiAgICAgICAgdmFyIHRyYXZlcnNlRiA9IFQudHJhdmVyc2UoRik7XG4gICAgICAgIHJldHVybiBmdW5jdGlvbiAod2EsIGYpIHsgcmV0dXJuIEYubWFwKHRyYXZlcnNlRih3YSwgZiksIEMuc2VwYXJhdGUpOyB9O1xuICAgIH07XG59XG5leHBvcnQgZnVuY3Rpb24gd2l0aGVyRGVmYXVsdChULCBDKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChGKSB7XG4gICAgICAgIHZhciB0cmF2ZXJzZUYgPSBULnRyYXZlcnNlKEYpO1xuICAgICAgICByZXR1cm4gZnVuY3Rpb24gKHdhLCBmKSB7IHJldHVybiBGLm1hcCh0cmF2ZXJzZUYod2EsIGYpLCBDLmNvbXBhY3QpOyB9O1xuICAgIH07XG59XG5leHBvcnQgZnVuY3Rpb24gZmlsdGVyRShXKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChGKSB7XG4gICAgICAgIHZhciB3aXRoZXJGID0gVy53aXRoZXIoRik7XG4gICAgICAgIHJldHVybiBmdW5jdGlvbiAocHJlZGljYXRlKSB7IHJldHVybiBmdW5jdGlvbiAoZ2EpIHsgcmV0dXJuIHdpdGhlckYoZ2EsIGZ1bmN0aW9uIChhKSB7IHJldHVybiBGLm1hcChwcmVkaWNhdGUoYSksIGZ1bmN0aW9uIChiKSB7IHJldHVybiAoYiA/IF8uc29tZShhKSA6IF8ubm9uZSk7IH0pOyB9KTsgfTsgfTtcbiAgICB9O1xufVxuIiwKICAiZXhwb3J0IGZ1bmN0aW9uIGd1YXJkKEYsIFApIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGIpIHsgcmV0dXJuIChiID8gUC5vZih1bmRlZmluZWQpIDogRi56ZXJvKCkpOyB9O1xufVxuIiwKICAidmFyIF9fc3ByZWFkQXJyYXkgPSAodGhpcyAmJiB0aGlzLl9fc3ByZWFkQXJyYXkpIHx8IGZ1bmN0aW9uICh0bywgZnJvbSwgcGFjaykge1xuICAgIGlmIChwYWNrIHx8IGFyZ3VtZW50cy5sZW5ndGggPT09IDIpIGZvciAodmFyIGkgPSAwLCBsID0gZnJvbS5sZW5ndGgsIGFyOyBpIDwgbDsgaSsrKSB7XG4gICAgICAgIGlmIChhciB8fCAhKGkgaW4gZnJvbSkpIHtcbiAgICAgICAgICAgIGlmICghYXIpIGFyID0gQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoZnJvbSwgMCwgaSk7XG4gICAgICAgICAgICBhcltpXSA9IGZyb21baV07XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHRvLmNvbmNhdChhciB8fCBBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChmcm9tKSk7XG59O1xuaW1wb3J0IHsgYXBGaXJzdCBhcyBhcEZpcnN0XywgYXBTIGFzIGFwU18sIGFwU2Vjb25kIGFzIGFwU2Vjb25kXyB9IGZyb20gJy4vQXBwbHknO1xuaW1wb3J0IHsgYmluZCBhcyBiaW5kXywgY2hhaW5GaXJzdCBhcyBjaGFpbkZpcnN0XyB9IGZyb20gJy4vQ2hhaW4nO1xuaW1wb3J0IHsgZnJvbUVxdWFscyB9IGZyb20gJy4vRXEnO1xuaW1wb3J0IHsgZnJvbUVpdGhlcksgYXMgZnJvbUVpdGhlcktfIH0gZnJvbSAnLi9Gcm9tRWl0aGVyJztcbmltcG9ydCB7IGR1YWwsIGlkZW50aXR5LCBwaXBlIH0gZnJvbSAnLi9mdW5jdGlvbic7XG5pbXBvcnQgeyBiaW5kVG8gYXMgYmluZFRvXywgZmxhcCBhcyBmbGFwXywgbGV0IGFzIGxldF9fIH0gZnJvbSAnLi9GdW5jdG9yJztcbmltcG9ydCAqIGFzIF8gZnJvbSAnLi9pbnRlcm5hbCc7XG5pbXBvcnQgKiBhcyBOIGZyb20gJy4vbnVtYmVyJztcbmltcG9ydCB7IGZyb21Db21wYXJlIH0gZnJvbSAnLi9PcmQnO1xuaW1wb3J0ICogYXMgUk5FQSBmcm9tICcuL1JlYWRvbmx5Tm9uRW1wdHlBcnJheSc7XG5pbXBvcnQgeyBzZXBhcmF0ZWQgfSBmcm9tICcuL1NlcGFyYXRlZCc7XG5pbXBvcnQgeyBmaWx0ZXJFIGFzIGZpbHRlckVfLCB3aWx0RGVmYXVsdCwgd2l0aGVyRGVmYXVsdCB9IGZyb20gJy4vV2l0aGVyYWJsZSc7XG5pbXBvcnQgeyBndWFyZCBhcyBndWFyZF8gfSBmcm9tICcuL1plcm8nO1xuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLy8gcmVmaW5lbWVudHNcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8qKlxuICogVGVzdCB3aGV0aGVyIGEgYFJlYWRvbmx5QXJyYXlgIGlzIGVtcHR5LlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBpc0VtcHR5IH0gZnJvbSAnZnAtdHMvUmVhZG9ubHlBcnJheSdcbiAqXG4gKiBhc3NlcnQuc3RyaWN0RXF1YWwoaXNFbXB0eShbXSksIHRydWUpXG4gKlxuICogQGNhdGVnb3J5IHJlZmluZW1lbnRzXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBpc0VtcHR5ID0gZnVuY3Rpb24gKGFzKSB7IHJldHVybiBhcy5sZW5ndGggPT09IDA7IH07XG4vKipcbiAqIFRlc3Qgd2hldGhlciBhIGBSZWFkb25seUFycmF5YCBpcyBub24gZW1wdHkuXG4gKlxuICogQGNhdGVnb3J5IHJlZmluZW1lbnRzXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBpc05vbkVtcHR5ID0gUk5FQS5pc05vbkVtcHR5O1xuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLy8gY29uc3RydWN0b3JzXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vKipcbiAqIFByZXBlbmQgYW4gZWxlbWVudCB0byB0aGUgZnJvbnQgb2YgYSBgUmVhZG9ubHlBcnJheWAsIGNyZWF0aW5nIGEgbmV3IGBSZWFkb25seU5vbkVtcHR5QXJyYXlgLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBwcmVwZW5kIH0gZnJvbSAnZnAtdHMvUmVhZG9ubHlBcnJheSdcbiAqIGltcG9ydCB7IHBpcGUgfSBmcm9tICdmcC10cy9mdW5jdGlvbidcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKHBpcGUoWzIsIDMsIDRdLCBwcmVwZW5kKDEpKSwgWzEsIDIsIDMsIDRdKVxuICpcbiAqIEBzaW5jZSAyLjEwLjBcbiAqL1xuZXhwb3J0IHZhciBwcmVwZW5kID0gUk5FQS5wcmVwZW5kO1xuLyoqXG4gKiBMZXNzIHN0cmljdCB2ZXJzaW9uIG9mIFtgcHJlcGVuZGBdKCNwcmVwZW5kKS5cbiAqXG4gKiBAc2luY2UgMi4xMS4wXG4gKi9cbmV4cG9ydCB2YXIgcHJlcGVuZFcgPSBSTkVBLnByZXBlbmRXO1xuLyoqXG4gKiBBcHBlbmQgYW4gZWxlbWVudCB0byB0aGUgZW5kIG9mIGEgYFJlYWRvbmx5QXJyYXlgLCBjcmVhdGluZyBhIG5ldyBgUmVhZG9ubHlOb25FbXB0eUFycmF5YC5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgYXBwZW5kIH0gZnJvbSAnZnAtdHMvUmVhZG9ubHlBcnJheSdcbiAqIGltcG9ydCB7IHBpcGUgfSBmcm9tICdmcC10cy9mdW5jdGlvbidcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKHBpcGUoWzEsIDIsIDNdLCBhcHBlbmQoNCkpLCBbMSwgMiwgMywgNF0pXG4gKlxuICogQHNpbmNlIDIuMTAuMFxuICovXG5leHBvcnQgdmFyIGFwcGVuZCA9IFJORUEuYXBwZW5kO1xuLyoqXG4gKiBMZXNzIHN0cmljdCB2ZXJzaW9uIG9mIFtgYXBwZW5kYF0oI2FwcGVuZCkuXG4gKlxuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIGFwcGVuZFcgPSBSTkVBLmFwcGVuZFc7XG4vKipcbiAqIFJldHVybiBhIGBSZWFkb25seUFycmF5YCBvZiBsZW5ndGggYG5gIHdpdGggZWxlbWVudCBgaWAgaW5pdGlhbGl6ZWQgd2l0aCBgZihpKWAuXG4gKlxuICogKipOb3RlKiouIGBuYCBpcyBub3JtYWxpemVkIHRvIGEgbm9uIG5lZ2F0aXZlIGludGVnZXIuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IG1ha2VCeSB9IGZyb20gJ2ZwLXRzL1JlYWRvbmx5QXJyYXknXG4gKlxuICogY29uc3QgZG91YmxlID0gKG46IG51bWJlcik6IG51bWJlciA9PiBuICogMlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChtYWtlQnkoNSwgZG91YmxlKSwgWzAsIDIsIDQsIDYsIDhdKVxuICpcbiAqIEBjYXRlZ29yeSBjb25zdHJ1Y3RvcnNcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIG1ha2VCeSA9IGZ1bmN0aW9uIChuLCBmKSB7IHJldHVybiAobiA8PSAwID8gZW1wdHkgOiBSTkVBLm1ha2VCeShmKShuKSk7IH07XG4vKipcbiAqIENyZWF0ZSBhIGBSZWFkb25seUFycmF5YCBjb250YWluaW5nIGEgdmFsdWUgcmVwZWF0ZWQgdGhlIHNwZWNpZmllZCBudW1iZXIgb2YgdGltZXMuXG4gKlxuICogKipOb3RlKiouIGBuYCBpcyBub3JtYWxpemVkIHRvIGEgbm9uIG5lZ2F0aXZlIGludGVnZXIuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IHJlcGxpY2F0ZSB9IGZyb20gJ2ZwLXRzL1JlYWRvbmx5QXJyYXknXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChyZXBsaWNhdGUoMywgJ2EnKSwgWydhJywgJ2EnLCAnYSddKVxuICpcbiAqIEBjYXRlZ29yeSBjb25zdHJ1Y3RvcnNcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIHJlcGxpY2F0ZSA9IGZ1bmN0aW9uIChuLCBhKSB7IHJldHVybiBtYWtlQnkobiwgZnVuY3Rpb24gKCkgeyByZXR1cm4gYTsgfSk7IH07XG5leHBvcnQgZnVuY3Rpb24gZnJvbVByZWRpY2F0ZShwcmVkaWNhdGUpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGEpIHsgcmV0dXJuIChwcmVkaWNhdGUoYSkgPyBbYV0gOiBlbXB0eSk7IH07XG59XG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vLyBjb252ZXJzaW9uc1xuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLyoqXG4gKiBAY2F0ZWdvcnkgY29udmVyc2lvbnNcbiAqIEBzaW5jZSAyLjExLjBcbiAqL1xuZXhwb3J0IHZhciBmcm9tT3B0aW9uID0gZnVuY3Rpb24gKG1hKSB7IHJldHVybiAoXy5pc05vbmUobWEpID8gZW1wdHkgOiBbbWEudmFsdWVdKTsgfTtcbi8qKlxuICogVHJhbnNmb3JtcyBhbiBgRWl0aGVyYCB0byBhIGBSZWFkb25seUFycmF5YC5cbiAqXG4gKiBAY2F0ZWdvcnkgY29udmVyc2lvbnNcbiAqIEBzaW5jZSAyLjExLjBcbiAqL1xuZXhwb3J0IHZhciBmcm9tRWl0aGVyID0gZnVuY3Rpb24gKGUpIHsgcmV0dXJuIChfLmlzTGVmdChlKSA/IGVtcHR5IDogW2UucmlnaHRdKTsgfTtcbi8qKlxuICogTGVzcyBzdHJpY3QgdmVyc2lvbiBvZiBbYG1hdGNoYF0oI21hdGNoKS5cbiAqXG4gKiBUaGUgYFdgIHN1ZmZpeCAoc2hvcnQgZm9yICoqVyoqaWRlbmluZykgbWVhbnMgdGhhdCB0aGUgaGFuZGxlciByZXR1cm4gdHlwZXMgd2lsbCBiZSBtZXJnZWQuXG4gKlxuICogQGNhdGVnb3J5IHBhdHRlcm4gbWF0Y2hpbmdcbiAqIEBzaW5jZSAyLjExLjBcbiAqL1xuZXhwb3J0IHZhciBtYXRjaFcgPSBmdW5jdGlvbiAob25FbXB0eSwgb25Ob25FbXB0eSkge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgcmV0dXJuIGlzTm9uRW1wdHkoYXMpID8gb25Ob25FbXB0eShhcykgOiBvbkVtcHR5KCk7XG4gICAgfTtcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBwYXR0ZXJuIG1hdGNoaW5nXG4gKiBAc2luY2UgMi4xMS4wXG4gKi9cbmV4cG9ydCB2YXIgbWF0Y2ggPSBtYXRjaFc7XG4vKipcbiAqIExlc3Mgc3RyaWN0IHZlcnNpb24gb2YgW2BtYXRjaExlZnRgXSgjbWF0Y2hsZWZ0KS5cbiAqXG4gKiBAY2F0ZWdvcnkgcGF0dGVybiBtYXRjaGluZ1xuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIG1hdGNoTGVmdFcgPSBmdW5jdGlvbiAob25FbXB0eSwgb25Ob25FbXB0eSkge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgcmV0dXJuIGlzTm9uRW1wdHkoYXMpID8gb25Ob25FbXB0eShSTkVBLmhlYWQoYXMpLCBSTkVBLnRhaWwoYXMpKSA6IG9uRW1wdHkoKTtcbiAgICB9O1xufTtcbi8qKlxuICogQnJlYWsgYSBgUmVhZG9ubHlBcnJheWAgaW50byBpdHMgZmlyc3QgZWxlbWVudCBhbmQgcmVtYWluaW5nIGVsZW1lbnRzLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBtYXRjaExlZnQgfSBmcm9tICdmcC10cy9SZWFkb25seUFycmF5J1xuICpcbiAqIGNvbnN0IGxlbjogPEE+KGFzOiBSZWFkb25seUFycmF5PEE+KSA9PiBudW1iZXIgPSBtYXRjaExlZnQoKCkgPT4gMCwgKF8sIHRhaWwpID0+IDEgKyBsZW4odGFpbCkpXG4gKiBhc3NlcnQuc3RyaWN0RXF1YWwobGVuKFsxLCAyLCAzXSksIDMpXG4gKlxuICogQGNhdGVnb3J5IHBhdHRlcm4gbWF0Y2hpbmdcbiAqIEBzaW5jZSAyLjEwLjBcbiAqL1xuZXhwb3J0IHZhciBtYXRjaExlZnQgPSBtYXRjaExlZnRXO1xuLyoqXG4gKiBBbGlhcyBvZiBbYG1hdGNoTGVmdGBdKCNtYXRjaGxlZnQpLlxuICpcbiAqIEBjYXRlZ29yeSBwYXR0ZXJuIG1hdGNoaW5nXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBmb2xkTGVmdCA9IG1hdGNoTGVmdDtcbi8qKlxuICogTGVzcyBzdHJpY3QgdmVyc2lvbiBvZiBbYG1hdGNoUmlnaHRgXSgjbWF0Y2hyaWdodCkuXG4gKlxuICogQGNhdGVnb3J5IHBhdHRlcm4gbWF0Y2hpbmdcbiAqIEBzaW5jZSAyLjExLjBcbiAqL1xuZXhwb3J0IHZhciBtYXRjaFJpZ2h0VyA9IGZ1bmN0aW9uIChvbkVtcHR5LCBvbk5vbkVtcHR5KSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykge1xuICAgICAgICByZXR1cm4gaXNOb25FbXB0eShhcykgPyBvbk5vbkVtcHR5KFJORUEuaW5pdChhcyksIFJORUEubGFzdChhcykpIDogb25FbXB0eSgpO1xuICAgIH07XG59O1xuLyoqXG4gKiBCcmVhayBhIGBSZWFkb25seUFycmF5YCBpbnRvIGl0cyBpbml0aWFsIGVsZW1lbnRzIGFuZCB0aGUgbGFzdCBlbGVtZW50LlxuICpcbiAqIEBjYXRlZ29yeSBwYXR0ZXJuIG1hdGNoaW5nXG4gKiBAc2luY2UgMi4xMC4wXG4gKi9cbmV4cG9ydCB2YXIgbWF0Y2hSaWdodCA9IG1hdGNoUmlnaHRXO1xuLyoqXG4gKiBBbGlhcyBvZiBbYG1hdGNoUmlnaHRgXSgjbWF0Y2hyaWdodCkuXG4gKlxuICogQGNhdGVnb3J5IHBhdHRlcm4gbWF0Y2hpbmdcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIGZvbGRSaWdodCA9IG1hdGNoUmlnaHQ7XG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vLyBjb21iaW5hdG9yc1xuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLyoqXG4gKiBAY2F0ZWdvcnkgc2VxdWVuY2luZ1xuICogQHNpbmNlIDIuNy4wXG4gKi9cbmV4cG9ydCB2YXIgY2hhaW5XaXRoSW5kZXggPSBmdW5jdGlvbiAoZikge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgaWYgKGlzRW1wdHkoYXMpKSB7XG4gICAgICAgICAgICByZXR1cm4gZW1wdHk7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIG91dCA9IFtdO1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGFzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICBvdXQucHVzaC5hcHBseShvdXQsIGYoaSwgYXNbaV0pKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gb3V0O1xuICAgIH07XG59O1xuLyoqXG4gKiBTYW1lIGFzIGByZWR1Y2VgIGJ1dCBpdCBjYXJyaWVzIG92ZXIgdGhlIGludGVybWVkaWF0ZSBzdGVwcy5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgc2NhbkxlZnQgfSBmcm9tICdmcC10cy9SZWFkb25seUFycmF5J1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoc2NhbkxlZnQoMTAsIChiLCBhOiBudW1iZXIpID0+IGIgLSBhKShbMSwgMiwgM10pLCBbMTAsIDksIDcsIDRdKVxuICpcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIHNjYW5MZWZ0ID0gZnVuY3Rpb24gKGIsIGYpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIHZhciBsZW4gPSBhcy5sZW5ndGg7XG4gICAgICAgIHZhciBvdXQgPSBuZXcgQXJyYXkobGVuICsgMSk7XG4gICAgICAgIG91dFswXSA9IGI7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbGVuOyBpKyspIHtcbiAgICAgICAgICAgIG91dFtpICsgMV0gPSBmKG91dFtpXSwgYXNbaV0pO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBvdXQ7XG4gICAgfTtcbn07XG4vKipcbiAqIEZvbGQgYW4gYXJyYXkgZnJvbSB0aGUgcmlnaHQsIGtlZXBpbmcgYWxsIGludGVybWVkaWF0ZSByZXN1bHRzIGluc3RlYWQgb2Ygb25seSB0aGUgZmluYWwgcmVzdWx0XG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IHNjYW5SaWdodCB9IGZyb20gJ2ZwLXRzL1JlYWRvbmx5QXJyYXknXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChzY2FuUmlnaHQoMTAsIChhOiBudW1iZXIsIGIpID0+IGIgLSBhKShbMSwgMiwgM10pLCBbNCwgNSwgNywgMTBdKVxuICpcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIHNjYW5SaWdodCA9IGZ1bmN0aW9uIChiLCBmKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykge1xuICAgICAgICB2YXIgbGVuID0gYXMubGVuZ3RoO1xuICAgICAgICB2YXIgb3V0ID0gbmV3IEFycmF5KGxlbiArIDEpO1xuICAgICAgICBvdXRbbGVuXSA9IGI7XG4gICAgICAgIGZvciAodmFyIGkgPSBsZW4gLSAxOyBpID49IDA7IGktLSkge1xuICAgICAgICAgICAgb3V0W2ldID0gZihhc1tpXSwgb3V0W2kgKyAxXSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG91dDtcbiAgICB9O1xufTtcbi8qKlxuICogQ2FsY3VsYXRlIHRoZSBudW1iZXIgb2YgZWxlbWVudHMgaW4gYSBgUmVhZG9ubHlBcnJheWAuXG4gKlxuICogQHNpbmNlIDIuMTAuMFxuICovXG5leHBvcnQgdmFyIHNpemUgPSBmdW5jdGlvbiAoYXMpIHsgcmV0dXJuIGFzLmxlbmd0aDsgfTtcbi8qKlxuICogVGVzdCB3aGV0aGVyIGFuIGFycmF5IGNvbnRhaW5zIGEgcGFydGljdWxhciBpbmRleFxuICpcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIGlzT3V0T2ZCb3VuZCA9IFJORUEuaXNPdXRPZkJvdW5kO1xuZXhwb3J0IGZ1bmN0aW9uIGxvb2t1cChpLCBhcykge1xuICAgIHJldHVybiBhcyA9PT0gdW5kZWZpbmVkID8gZnVuY3Rpb24gKGFzKSB7IHJldHVybiBsb29rdXAoaSwgYXMpOyB9IDogaXNPdXRPZkJvdW5kKGksIGFzKSA/IF8ubm9uZSA6IF8uc29tZShhc1tpXSk7XG59XG4vKipcbiAqIEdldCB0aGUgZmlyc3QgZWxlbWVudCBpbiBhbiBhcnJheSwgb3IgYE5vbmVgIGlmIHRoZSBhcnJheSBpcyBlbXB0eVxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBoZWFkIH0gZnJvbSAnZnAtdHMvUmVhZG9ubHlBcnJheSdcbiAqIGltcG9ydCB7IHNvbWUsIG5vbmUgfSBmcm9tICdmcC10cy9PcHRpb24nXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChoZWFkKFsxLCAyLCAzXSksIHNvbWUoMSkpXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKGhlYWQoW10pLCBub25lKVxuICpcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIGhlYWQgPSBmdW5jdGlvbiAoYXMpIHsgcmV0dXJuIChpc05vbkVtcHR5KGFzKSA/IF8uc29tZShSTkVBLmhlYWQoYXMpKSA6IF8ubm9uZSk7IH07XG4vKipcbiAqIEdldCB0aGUgbGFzdCBlbGVtZW50IGluIGFuIGFycmF5LCBvciBgTm9uZWAgaWYgdGhlIGFycmF5IGlzIGVtcHR5XG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IGxhc3QgfSBmcm9tICdmcC10cy9SZWFkb25seUFycmF5J1xuICogaW1wb3J0IHsgc29tZSwgbm9uZSB9IGZyb20gJ2ZwLXRzL09wdGlvbidcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKGxhc3QoWzEsIDIsIDNdKSwgc29tZSgzKSlcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwobGFzdChbXSksIG5vbmUpXG4gKlxuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgbGFzdCA9IGZ1bmN0aW9uIChhcykgeyByZXR1cm4gKGlzTm9uRW1wdHkoYXMpID8gXy5zb21lKFJORUEubGFzdChhcykpIDogXy5ub25lKTsgfTtcbi8qKlxuICogR2V0IGFsbCBidXQgdGhlIGZpcnN0IGVsZW1lbnQgb2YgYW4gYXJyYXksIGNyZWF0aW5nIGEgbmV3IGFycmF5LCBvciBgTm9uZWAgaWYgdGhlIGFycmF5IGlzIGVtcHR5XG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IHRhaWwgfSBmcm9tICdmcC10cy9SZWFkb25seUFycmF5J1xuICogaW1wb3J0IHsgc29tZSwgbm9uZSB9IGZyb20gJ2ZwLXRzL09wdGlvbidcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKHRhaWwoWzEsIDIsIDNdKSwgc29tZShbMiwgM10pKVxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbCh0YWlsKFtdKSwgbm9uZSlcbiAqXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciB0YWlsID0gZnVuY3Rpb24gKGFzKSB7XG4gICAgcmV0dXJuIGlzTm9uRW1wdHkoYXMpID8gXy5zb21lKFJORUEudGFpbChhcykpIDogXy5ub25lO1xufTtcbi8qKlxuICogR2V0IGFsbCBidXQgdGhlIGxhc3QgZWxlbWVudCBvZiBhbiBhcnJheSwgY3JlYXRpbmcgYSBuZXcgYXJyYXksIG9yIGBOb25lYCBpZiB0aGUgYXJyYXkgaXMgZW1wdHlcbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgaW5pdCB9IGZyb20gJ2ZwLXRzL1JlYWRvbmx5QXJyYXknXG4gKiBpbXBvcnQgeyBzb21lLCBub25lIH0gZnJvbSAnZnAtdHMvT3B0aW9uJ1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoaW5pdChbMSwgMiwgM10pLCBzb21lKFsxLCAyXSkpXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKGluaXQoW10pLCBub25lKVxuICpcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIGluaXQgPSBmdW5jdGlvbiAoYXMpIHtcbiAgICByZXR1cm4gaXNOb25FbXB0eShhcykgPyBfLnNvbWUoUk5FQS5pbml0KGFzKSkgOiBfLm5vbmU7XG59O1xuLyoqXG4gKiBLZWVwIG9ubHkgYSBtYXggbnVtYmVyIG9mIGVsZW1lbnRzIGZyb20gdGhlIHN0YXJ0IG9mIGFuIGBSZWFkb25seUFycmF5YCwgY3JlYXRpbmcgYSBuZXcgYFJlYWRvbmx5QXJyYXlgLlxuICpcbiAqICoqTm90ZSoqLiBgbmAgaXMgbm9ybWFsaXplZCB0byBhIG5vbiBuZWdhdGl2ZSBpbnRlZ2VyLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgKiBhcyBSQSBmcm9tICdmcC10cy9SZWFkb25seUFycmF5J1xuICogaW1wb3J0IHsgcGlwZSB9IGZyb20gJ2ZwLXRzL2Z1bmN0aW9uJ1xuICpcbiAqIGNvbnN0IGlucHV0OiBSZWFkb25seUFycmF5PG51bWJlcj4gPSBbMSwgMiwgM11cbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwocGlwZShpbnB1dCwgUkEudGFrZUxlZnQoMikpLCBbMSwgMl0pXG4gKlxuICogLy8gb3V0IG9mIGJvdW5kc1xuICogYXNzZXJ0LnN0cmljdEVxdWFsKHBpcGUoaW5wdXQsIFJBLnRha2VMZWZ0KDQpKSwgaW5wdXQpXG4gKiBhc3NlcnQuc3RyaWN0RXF1YWwocGlwZShpbnB1dCwgUkEudGFrZUxlZnQoLTEpKSwgaW5wdXQpXG4gKlxuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgdGFrZUxlZnQgPSBmdW5jdGlvbiAobikge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgcmV0dXJuIGlzT3V0T2ZCb3VuZChuLCBhcykgPyBhcyA6IG4gPT09IDAgPyBlbXB0eSA6IGFzLnNsaWNlKDAsIG4pO1xuICAgIH07XG59O1xuLyoqXG4gKiBLZWVwIG9ubHkgYSBtYXggbnVtYmVyIG9mIGVsZW1lbnRzIGZyb20gdGhlIGVuZCBvZiBhbiBgUmVhZG9ubHlBcnJheWAsIGNyZWF0aW5nIGEgbmV3IGBSZWFkb25seUFycmF5YC5cbiAqXG4gKiAqKk5vdGUqKi4gYG5gIGlzIG5vcm1hbGl6ZWQgdG8gYSBub24gbmVnYXRpdmUgaW50ZWdlci5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0ICogYXMgUkEgZnJvbSAnZnAtdHMvUmVhZG9ubHlBcnJheSdcbiAqIGltcG9ydCB7IHBpcGUgfSBmcm9tICdmcC10cy9mdW5jdGlvbidcbiAqXG4gKiBjb25zdCBpbnB1dDogUmVhZG9ubHlBcnJheTxudW1iZXI+ID0gWzEsIDIsIDNdXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKHBpcGUoaW5wdXQsIFJBLnRha2VSaWdodCgyKSksIFsyLCAzXSlcbiAqXG4gKiAvLyBvdXQgb2YgYm91bmRzXG4gKiBhc3NlcnQuc3RyaWN0RXF1YWwocGlwZShpbnB1dCwgUkEudGFrZVJpZ2h0KDQpKSwgaW5wdXQpXG4gKiBhc3NlcnQuc3RyaWN0RXF1YWwocGlwZShpbnB1dCwgUkEudGFrZVJpZ2h0KC0xKSksIGlucHV0KVxuICpcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIHRha2VSaWdodCA9IGZ1bmN0aW9uIChuKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykge1xuICAgICAgICByZXR1cm4gaXNPdXRPZkJvdW5kKG4sIGFzKSA/IGFzIDogbiA9PT0gMCA/IGVtcHR5IDogYXMuc2xpY2UoLW4pO1xuICAgIH07XG59O1xuZXhwb3J0IGZ1bmN0aW9uIHRha2VMZWZ0V2hpbGUocHJlZGljYXRlKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykge1xuICAgICAgICB2YXIgb3V0ID0gW107XG4gICAgICAgIGZvciAodmFyIF9pID0gMCwgYXNfMSA9IGFzOyBfaSA8IGFzXzEubGVuZ3RoOyBfaSsrKSB7XG4gICAgICAgICAgICB2YXIgYSA9IGFzXzFbX2ldO1xuICAgICAgICAgICAgaWYgKCFwcmVkaWNhdGUoYSkpIHtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIG91dC5wdXNoKGEpO1xuICAgICAgICB9XG4gICAgICAgIHZhciBsZW4gPSBvdXQubGVuZ3RoO1xuICAgICAgICByZXR1cm4gbGVuID09PSBhcy5sZW5ndGggPyBhcyA6IGxlbiA9PT0gMCA/IGVtcHR5IDogb3V0O1xuICAgIH07XG59XG52YXIgc3BhbkxlZnRJbmRleCA9IGZ1bmN0aW9uIChhcywgcHJlZGljYXRlKSB7XG4gICAgdmFyIGwgPSBhcy5sZW5ndGg7XG4gICAgdmFyIGkgPSAwO1xuICAgIGZvciAoOyBpIDwgbDsgaSsrKSB7XG4gICAgICAgIGlmICghcHJlZGljYXRlKGFzW2ldKSkge1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIGk7XG59O1xuZXhwb3J0IGZ1bmN0aW9uIHNwYW5MZWZ0KHByZWRpY2F0ZSkge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgdmFyIF9hID0gc3BsaXRBdChzcGFuTGVmdEluZGV4KGFzLCBwcmVkaWNhdGUpKShhcyksIGluaXQgPSBfYVswXSwgcmVzdCA9IF9hWzFdO1xuICAgICAgICByZXR1cm4geyBpbml0OiBpbml0LCByZXN0OiByZXN0IH07XG4gICAgfTtcbn1cbi8qKlxuICogRHJvcCBhIG1heCBudW1iZXIgb2YgZWxlbWVudHMgZnJvbSB0aGUgc3RhcnQgb2YgYW4gYFJlYWRvbmx5QXJyYXlgLCBjcmVhdGluZyBhIG5ldyBgUmVhZG9ubHlBcnJheWAuXG4gKlxuICogKipOb3RlKiouIGBuYCBpcyBub3JtYWxpemVkIHRvIGEgbm9uIG5lZ2F0aXZlIGludGVnZXIuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCAqIGFzIFJBIGZyb20gJ2ZwLXRzL1JlYWRvbmx5QXJyYXknXG4gKiBpbXBvcnQgeyBwaXBlIH0gZnJvbSAnZnAtdHMvZnVuY3Rpb24nXG4gKlxuICogY29uc3QgaW5wdXQ6IFJlYWRvbmx5QXJyYXk8bnVtYmVyPiA9IFsxLCAyLCAzXVxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChwaXBlKGlucHV0LCBSQS5kcm9wTGVmdCgyKSksIFszXSlcbiAqIGFzc2VydC5zdHJpY3RFcXVhbChwaXBlKGlucHV0LCBSQS5kcm9wTGVmdCgwKSksIGlucHV0KVxuICogYXNzZXJ0LnN0cmljdEVxdWFsKHBpcGUoaW5wdXQsIFJBLmRyb3BMZWZ0KC0xKSksIGlucHV0KVxuICpcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIGRyb3BMZWZ0ID0gZnVuY3Rpb24gKG4pIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIHJldHVybiBuIDw9IDAgfHwgaXNFbXB0eShhcykgPyBhcyA6IG4gPj0gYXMubGVuZ3RoID8gZW1wdHkgOiBhcy5zbGljZShuLCBhcy5sZW5ndGgpO1xuICAgIH07XG59O1xuLyoqXG4gKiBEcm9wIGEgbWF4IG51bWJlciBvZiBlbGVtZW50cyBmcm9tIHRoZSBlbmQgb2YgYW4gYFJlYWRvbmx5QXJyYXlgLCBjcmVhdGluZyBhIG5ldyBgUmVhZG9ubHlBcnJheWAuXG4gKlxuICogKipOb3RlKiouIGBuYCBpcyBub3JtYWxpemVkIHRvIGEgbm9uIG5lZ2F0aXZlIGludGVnZXIuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCAqIGFzIFJBIGZyb20gJ2ZwLXRzL1JlYWRvbmx5QXJyYXknXG4gKiBpbXBvcnQgeyBwaXBlIH0gZnJvbSAnZnAtdHMvZnVuY3Rpb24nXG4gKlxuICogY29uc3QgaW5wdXQ6IFJlYWRvbmx5QXJyYXk8bnVtYmVyPiA9IFsxLCAyLCAzXVxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChwaXBlKGlucHV0LCBSQS5kcm9wUmlnaHQoMikpLCBbMV0pXG4gKiBhc3NlcnQuc3RyaWN0RXF1YWwocGlwZShpbnB1dCwgUkEuZHJvcFJpZ2h0KDApKSwgaW5wdXQpXG4gKiBhc3NlcnQuc3RyaWN0RXF1YWwocGlwZShpbnB1dCwgUkEuZHJvcFJpZ2h0KC0xKSksIGlucHV0KVxuICpcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIGRyb3BSaWdodCA9IGZ1bmN0aW9uIChuKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykge1xuICAgICAgICByZXR1cm4gbiA8PSAwIHx8IGlzRW1wdHkoYXMpID8gYXMgOiBuID49IGFzLmxlbmd0aCA/IGVtcHR5IDogYXMuc2xpY2UoMCwgYXMubGVuZ3RoIC0gbik7XG4gICAgfTtcbn07XG5leHBvcnQgZnVuY3Rpb24gZHJvcExlZnRXaGlsZShwcmVkaWNhdGUpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIHZhciBpID0gc3BhbkxlZnRJbmRleChhcywgcHJlZGljYXRlKTtcbiAgICAgICAgcmV0dXJuIGkgPT09IDAgPyBhcyA6IGkgPT09IGFzLmxlbmd0aCA/IGVtcHR5IDogYXMuc2xpY2UoaSk7XG4gICAgfTtcbn1cbi8qKlxuICogRmluZCB0aGUgZmlyc3QgaW5kZXggZm9yIHdoaWNoIGEgcHJlZGljYXRlIGhvbGRzXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IGZpbmRJbmRleCB9IGZyb20gJ2ZwLXRzL1JlYWRvbmx5QXJyYXknXG4gKiBpbXBvcnQgeyBzb21lLCBub25lIH0gZnJvbSAnZnAtdHMvT3B0aW9uJ1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoZmluZEluZGV4KChuOiBudW1iZXIpID0+IG4gPT09IDIpKFsxLCAyLCAzXSksIHNvbWUoMSkpXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKGZpbmRJbmRleCgobjogbnVtYmVyKSA9PiBuID09PSAyKShbXSksIG5vbmUpXG4gKlxuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgZmluZEluZGV4ID0gZnVuY3Rpb24gKHByZWRpY2F0ZSkge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBhcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgaWYgKHByZWRpY2F0ZShhc1tpXSkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gXy5zb21lKGkpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBfLm5vbmU7XG4gICAgfTtcbn07XG5leHBvcnQgZnVuY3Rpb24gZmluZEZpcnN0KHByZWRpY2F0ZSkge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBhcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgaWYgKHByZWRpY2F0ZShhc1tpXSkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gXy5zb21lKGFzW2ldKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gXy5ub25lO1xuICAgIH07XG59XG4vKipcbiAqIEZpbmQgdGhlIGZpcnN0IGVsZW1lbnQgcmV0dXJuZWQgYnkgYW4gb3B0aW9uIGJhc2VkIHNlbGVjdG9yIGZ1bmN0aW9uXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IGZpbmRGaXJzdE1hcCB9IGZyb20gJ2ZwLXRzL1JlYWRvbmx5QXJyYXknXG4gKiBpbXBvcnQgeyBzb21lLCBub25lIH0gZnJvbSAnZnAtdHMvT3B0aW9uJ1xuICpcbiAqIGludGVyZmFjZSBQZXJzb24ge1xuICogICByZWFkb25seSBuYW1lOiBzdHJpbmdcbiAqICAgcmVhZG9ubHkgYWdlPzogbnVtYmVyXG4gKiB9XG4gKlxuICogY29uc3QgcGVyc29uczogUmVhZG9ubHlBcnJheTxQZXJzb24+ID0gW3sgbmFtZTogJ0pvaG4nIH0sIHsgbmFtZTogJ01hcnknLCBhZ2U6IDQ1IH0sIHsgbmFtZTogJ0pvZXknLCBhZ2U6IDI4IH1dXG4gKlxuICogLy8gcmV0dXJucyB0aGUgbmFtZSBvZiB0aGUgZmlyc3QgcGVyc29uIHRoYXQgaGFzIGFuIGFnZVxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChmaW5kRmlyc3RNYXAoKHA6IFBlcnNvbikgPT4gKHAuYWdlID09PSB1bmRlZmluZWQgPyBub25lIDogc29tZShwLm5hbWUpKSkocGVyc29ucyksIHNvbWUoJ01hcnknKSlcbiAqXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBmaW5kRmlyc3RNYXAgPSBmdW5jdGlvbiAoZikge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBhcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgdmFyIG91dCA9IGYoYXNbaV0pO1xuICAgICAgICAgICAgaWYgKF8uaXNTb21lKG91dCkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gb3V0O1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBfLm5vbmU7XG4gICAgfTtcbn07XG5leHBvcnQgZnVuY3Rpb24gZmluZExhc3QocHJlZGljYXRlKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykge1xuICAgICAgICBmb3IgKHZhciBpID0gYXMubGVuZ3RoIC0gMTsgaSA+PSAwOyBpLS0pIHtcbiAgICAgICAgICAgIGlmIChwcmVkaWNhdGUoYXNbaV0pKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIF8uc29tZShhc1tpXSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIF8ubm9uZTtcbiAgICB9O1xufVxuLyoqXG4gKiBGaW5kIHRoZSBsYXN0IGVsZW1lbnQgcmV0dXJuZWQgYnkgYW4gb3B0aW9uIGJhc2VkIHNlbGVjdG9yIGZ1bmN0aW9uXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IGZpbmRMYXN0TWFwIH0gZnJvbSAnZnAtdHMvUmVhZG9ubHlBcnJheSdcbiAqIGltcG9ydCB7IHNvbWUsIG5vbmUgfSBmcm9tICdmcC10cy9PcHRpb24nXG4gKlxuICogaW50ZXJmYWNlIFBlcnNvbiB7XG4gKiAgIHJlYWRvbmx5IG5hbWU6IHN0cmluZ1xuICogICByZWFkb25seSBhZ2U/OiBudW1iZXJcbiAqIH1cbiAqXG4gKiBjb25zdCBwZXJzb25zOiBSZWFkb25seUFycmF5PFBlcnNvbj4gPSBbeyBuYW1lOiAnSm9obicgfSwgeyBuYW1lOiAnTWFyeScsIGFnZTogNDUgfSwgeyBuYW1lOiAnSm9leScsIGFnZTogMjggfV1cbiAqXG4gKiAvLyByZXR1cm5zIHRoZSBuYW1lIG9mIHRoZSBsYXN0IHBlcnNvbiB0aGF0IGhhcyBhbiBhZ2VcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoZmluZExhc3RNYXAoKHA6IFBlcnNvbikgPT4gKHAuYWdlID09PSB1bmRlZmluZWQgPyBub25lIDogc29tZShwLm5hbWUpKSkocGVyc29ucyksIHNvbWUoJ0pvZXknKSlcbiAqXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBmaW5kTGFzdE1hcCA9IGZ1bmN0aW9uIChmKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykge1xuICAgICAgICBmb3IgKHZhciBpID0gYXMubGVuZ3RoIC0gMTsgaSA+PSAwOyBpLS0pIHtcbiAgICAgICAgICAgIHZhciBvdXQgPSBmKGFzW2ldKTtcbiAgICAgICAgICAgIGlmIChfLmlzU29tZShvdXQpKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG91dDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gXy5ub25lO1xuICAgIH07XG59O1xuLyoqXG4gKiBSZXR1cm5zIHRoZSBpbmRleCBvZiB0aGUgbGFzdCBlbGVtZW50IG9mIHRoZSBsaXN0IHdoaWNoIG1hdGNoZXMgdGhlIHByZWRpY2F0ZVxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBmaW5kTGFzdEluZGV4IH0gZnJvbSAnZnAtdHMvUmVhZG9ubHlBcnJheSdcbiAqIGltcG9ydCB7IHNvbWUsIG5vbmUgfSBmcm9tICdmcC10cy9PcHRpb24nXG4gKlxuICogaW50ZXJmYWNlIFgge1xuICogICByZWFkb25seSBhOiBudW1iZXJcbiAqICAgcmVhZG9ubHkgYjogbnVtYmVyXG4gKiB9XG4gKiBjb25zdCB4czogUmVhZG9ubHlBcnJheTxYPiA9IFt7IGE6IDEsIGI6IDAgfSwgeyBhOiAxLCBiOiAxIH1dXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKGZpbmRMYXN0SW5kZXgoKHg6IHsgcmVhZG9ubHkgYTogbnVtYmVyIH0pID0+IHguYSA9PT0gMSkoeHMpLCBzb21lKDEpKVxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChmaW5kTGFzdEluZGV4KCh4OiB7IHJlYWRvbmx5IGE6IG51bWJlciB9KSA9PiB4LmEgPT09IDQpKHhzKSwgbm9uZSlcbiAqXG4gKlxuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgZmluZExhc3RJbmRleCA9IGZ1bmN0aW9uIChwcmVkaWNhdGUpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIGZvciAodmFyIGkgPSBhcy5sZW5ndGggLSAxOyBpID49IDA7IGktLSkge1xuICAgICAgICAgICAgaWYgKHByZWRpY2F0ZShhc1tpXSkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gXy5zb21lKGkpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBfLm5vbmU7XG4gICAgfTtcbn07XG4vKipcbiAqIEluc2VydCBhbiBlbGVtZW50IGF0IHRoZSBzcGVjaWZpZWQgaW5kZXgsIGNyZWF0aW5nIGEgbmV3IGFycmF5LCBvciByZXR1cm5pbmcgYE5vbmVgIGlmIHRoZSBpbmRleCBpcyBvdXQgb2YgYm91bmRzXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IGluc2VydEF0IH0gZnJvbSAnZnAtdHMvUmVhZG9ubHlBcnJheSdcbiAqIGltcG9ydCB7IHNvbWUgfSBmcm9tICdmcC10cy9PcHRpb24nXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChpbnNlcnRBdCgyLCA1KShbMSwgMiwgMywgNF0pLCBzb21lKFsxLCAyLCA1LCAzLCA0XSkpXG4gKlxuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgaW5zZXJ0QXQgPSBmdW5jdGlvbiAoaSwgYSkge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgcmV0dXJuIGkgPCAwIHx8IGkgPiBhcy5sZW5ndGggPyBfLm5vbmUgOiBfLnNvbWUoUk5FQS51bnNhZmVJbnNlcnRBdChpLCBhLCBhcykpO1xuICAgIH07XG59O1xuLyoqXG4gKiBDaGFuZ2UgdGhlIGVsZW1lbnQgYXQgdGhlIHNwZWNpZmllZCBpbmRleCwgY3JlYXRpbmcgYSBuZXcgYXJyYXksIG9yIHJldHVybmluZyBgTm9uZWAgaWYgdGhlIGluZGV4IGlzIG91dCBvZiBib3VuZHNcbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgdXBkYXRlQXQgfSBmcm9tICdmcC10cy9SZWFkb25seUFycmF5J1xuICogaW1wb3J0IHsgc29tZSwgbm9uZSB9IGZyb20gJ2ZwLXRzL09wdGlvbidcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKHVwZGF0ZUF0KDEsIDEpKFsxLCAyLCAzXSksIHNvbWUoWzEsIDEsIDNdKSlcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwodXBkYXRlQXQoMSwgMSkoW10pLCBub25lKVxuICpcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIHVwZGF0ZUF0ID0gZnVuY3Rpb24gKGksIGEpIHtcbiAgICByZXR1cm4gbW9kaWZ5QXQoaSwgZnVuY3Rpb24gKCkgeyByZXR1cm4gYTsgfSk7XG59O1xuLyoqXG4gKiBEZWxldGUgdGhlIGVsZW1lbnQgYXQgdGhlIHNwZWNpZmllZCBpbmRleCwgY3JlYXRpbmcgYSBuZXcgYXJyYXksIG9yIHJldHVybmluZyBgTm9uZWAgaWYgdGhlIGluZGV4IGlzIG91dCBvZiBib3VuZHNcbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgZGVsZXRlQXQgfSBmcm9tICdmcC10cy9SZWFkb25seUFycmF5J1xuICogaW1wb3J0IHsgc29tZSwgbm9uZSB9IGZyb20gJ2ZwLXRzL09wdGlvbidcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKGRlbGV0ZUF0KDApKFsxLCAyLCAzXSksIHNvbWUoWzIsIDNdKSlcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoZGVsZXRlQXQoMSkoW10pLCBub25lKVxuICpcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIGRlbGV0ZUF0ID0gZnVuY3Rpb24gKGkpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIHJldHVybiBpc091dE9mQm91bmQoaSwgYXMpID8gXy5ub25lIDogXy5zb21lKHVuc2FmZURlbGV0ZUF0KGksIGFzKSk7XG4gICAgfTtcbn07XG4vKipcbiAqIEFwcGx5IGEgZnVuY3Rpb24gdG8gdGhlIGVsZW1lbnQgYXQgdGhlIHNwZWNpZmllZCBpbmRleCwgY3JlYXRpbmcgYSBuZXcgYXJyYXksIG9yIHJldHVybmluZyBgTm9uZWAgaWYgdGhlIGluZGV4IGlzIG91dFxuICogb2YgYm91bmRzXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IG1vZGlmeUF0IH0gZnJvbSAnZnAtdHMvUmVhZG9ubHlBcnJheSdcbiAqIGltcG9ydCB7IHNvbWUsIG5vbmUgfSBmcm9tICdmcC10cy9PcHRpb24nXG4gKlxuICogY29uc3QgZG91YmxlID0gKHg6IG51bWJlcik6IG51bWJlciA9PiB4ICogMlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChtb2RpZnlBdCgxLCBkb3VibGUpKFsxLCAyLCAzXSksIHNvbWUoWzEsIDQsIDNdKSlcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwobW9kaWZ5QXQoMSwgZG91YmxlKShbXSksIG5vbmUpXG4gKlxuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgbW9kaWZ5QXQgPSBmdW5jdGlvbiAoaSwgZikge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgcmV0dXJuIGlzT3V0T2ZCb3VuZChpLCBhcykgPyBfLm5vbmUgOiBfLnNvbWUodW5zYWZlVXBkYXRlQXQoaSwgZihhc1tpXSksIGFzKSk7XG4gICAgfTtcbn07XG4vKipcbiAqIFJldmVyc2UgYW4gYXJyYXksIGNyZWF0aW5nIGEgbmV3IGFycmF5XG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IHJldmVyc2UgfSBmcm9tICdmcC10cy9SZWFkb25seUFycmF5J1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwocmV2ZXJzZShbMSwgMiwgM10pLCBbMywgMiwgMV0pXG4gKlxuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgcmV2ZXJzZSA9IGZ1bmN0aW9uIChhcykgeyByZXR1cm4gKGFzLmxlbmd0aCA8PSAxID8gYXMgOiBhcy5zbGljZSgpLnJldmVyc2UoKSk7IH07XG4vKipcbiAqIEV4dHJhY3RzIGZyb20gYW4gYXJyYXkgb2YgYEVpdGhlcmAgYWxsIHRoZSBgUmlnaHRgIGVsZW1lbnRzLiBBbGwgdGhlIGBSaWdodGAgZWxlbWVudHMgYXJlIGV4dHJhY3RlZCBpbiBvcmRlclxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyByaWdodHMgfSBmcm9tICdmcC10cy9SZWFkb25seUFycmF5J1xuICogaW1wb3J0IHsgcmlnaHQsIGxlZnQgfSBmcm9tICdmcC10cy9FaXRoZXInXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChyaWdodHMoW3JpZ2h0KDEpLCBsZWZ0KCdmb28nKSwgcmlnaHQoMildKSwgWzEsIDJdKVxuICpcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIHJpZ2h0cyA9IGZ1bmN0aW9uIChhcykge1xuICAgIHZhciByID0gW107XG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBhcy5sZW5ndGg7IGkrKykge1xuICAgICAgICB2YXIgYSA9IGFzW2ldO1xuICAgICAgICBpZiAoYS5fdGFnID09PSAnUmlnaHQnKSB7XG4gICAgICAgICAgICByLnB1c2goYS5yaWdodCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHI7XG59O1xuLyoqXG4gKiBFeHRyYWN0cyBmcm9tIGFuIGFycmF5IG9mIGBFaXRoZXJgIGFsbCB0aGUgYExlZnRgIGVsZW1lbnRzLiBBbGwgdGhlIGBMZWZ0YCBlbGVtZW50cyBhcmUgZXh0cmFjdGVkIGluIG9yZGVyXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IGxlZnRzIH0gZnJvbSAnZnAtdHMvUmVhZG9ubHlBcnJheSdcbiAqIGltcG9ydCB7IGxlZnQsIHJpZ2h0IH0gZnJvbSAnZnAtdHMvRWl0aGVyJ1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwobGVmdHMoW3JpZ2h0KDEpLCBsZWZ0KCdmb28nKSwgcmlnaHQoMildKSwgWydmb28nXSlcbiAqXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBsZWZ0cyA9IGZ1bmN0aW9uIChhcykge1xuICAgIHZhciByID0gW107XG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBhcy5sZW5ndGg7IGkrKykge1xuICAgICAgICB2YXIgYSA9IGFzW2ldO1xuICAgICAgICBpZiAoYS5fdGFnID09PSAnTGVmdCcpIHtcbiAgICAgICAgICAgIHIucHVzaChhLmxlZnQpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiByO1xufTtcbi8qKlxuICogU29ydCB0aGUgZWxlbWVudHMgb2YgYW4gYXJyYXkgaW4gaW5jcmVhc2luZyBvcmRlciwgY3JlYXRpbmcgYSBuZXcgYXJyYXlcbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgc29ydCB9IGZyb20gJ2ZwLXRzL1JlYWRvbmx5QXJyYXknXG4gKiBpbXBvcnQgKiBhcyBOIGZyb20gJ2ZwLXRzL251bWJlcidcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKHNvcnQoTi5PcmQpKFszLCAyLCAxXSksIFsxLCAyLCAzXSlcbiAqXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBzb3J0ID0gZnVuY3Rpb24gKE8pIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIHJldHVybiBhcy5sZW5ndGggPD0gMSA/IGFzIDogYXMuc2xpY2UoKS5zb3J0KE8uY29tcGFyZSk7XG4gICAgfTtcbn07XG4vLyBUT0RPOiBjdXJyeSBhbmQgbWFrZSBkYXRhLWxhc3QgaW4gdjNcbi8qKlxuICogQXBwbHkgYSBmdW5jdGlvbiB0byBwYWlycyBvZiBlbGVtZW50cyBhdCB0aGUgc2FtZSBpbmRleCBpbiB0d28gYXJyYXlzLCBjb2xsZWN0aW5nIHRoZSByZXN1bHRzIGluIGEgbmV3IGFycmF5LiBJZiBvbmVcbiAqIGlucHV0IGFycmF5IGlzIHNob3J0LCBleGNlc3MgZWxlbWVudHMgb2YgdGhlIGxvbmdlciBhcnJheSBhcmUgZGlzY2FyZGVkLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyB6aXBXaXRoIH0gZnJvbSAnZnAtdHMvUmVhZG9ubHlBcnJheSdcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKHppcFdpdGgoWzEsIDIsIDNdLCBbJ2EnLCAnYicsICdjJywgJ2QnXSwgKG4sIHMpID0+IHMgKyBuKSwgWydhMScsICdiMicsICdjMyddKVxuICpcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIHppcFdpdGggPSBmdW5jdGlvbiAoZmEsIGZiLCBmKSB7XG4gICAgdmFyIGZjID0gW107XG4gICAgdmFyIGxlbiA9IE1hdGgubWluKGZhLmxlbmd0aCwgZmIubGVuZ3RoKTtcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IGxlbjsgaSsrKSB7XG4gICAgICAgIGZjW2ldID0gZihmYVtpXSwgZmJbaV0pO1xuICAgIH1cbiAgICByZXR1cm4gZmM7XG59O1xuZXhwb3J0IGZ1bmN0aW9uIHppcChhcywgYnMpIHtcbiAgICBpZiAoYnMgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICByZXR1cm4gZnVuY3Rpb24gKGJzKSB7IHJldHVybiB6aXAoYnMsIGFzKTsgfTtcbiAgICB9XG4gICAgcmV0dXJuIHppcFdpdGgoYXMsIGJzLCBmdW5jdGlvbiAoYSwgYikgeyByZXR1cm4gW2EsIGJdOyB9KTtcbn1cbi8qKlxuICogVGhlIGZ1bmN0aW9uIGlzIHJldmVyc2Ugb2YgYHppcGAuIFRha2VzIGFuIGFycmF5IG9mIHBhaXJzIGFuZCByZXR1cm4gdHdvIGNvcnJlc3BvbmRpbmcgYXJyYXlzXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IHVuemlwIH0gZnJvbSAnZnAtdHMvUmVhZG9ubHlBcnJheSdcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKHVuemlwKFtbMSwgJ2EnXSwgWzIsICdiJ10sIFszLCAnYyddXSksIFtbMSwgMiwgM10sIFsnYScsICdiJywgJ2MnXV0pXG4gKlxuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgdW56aXAgPSBmdW5jdGlvbiAoYXMpIHtcbiAgICB2YXIgZmEgPSBbXTtcbiAgICB2YXIgZmIgPSBbXTtcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IGFzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIGZhW2ldID0gYXNbaV1bMF07XG4gICAgICAgIGZiW2ldID0gYXNbaV1bMV07XG4gICAgfVxuICAgIHJldHVybiBbZmEsIGZiXTtcbn07XG4vKipcbiAqIFByZXBlbmQgYW4gZWxlbWVudCB0byBldmVyeSBtZW1iZXIgb2YgYW4gYXJyYXlcbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgcHJlcGVuZEFsbCB9IGZyb20gJ2ZwLXRzL1JlYWRvbmx5QXJyYXknXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChwcmVwZW5kQWxsKDkpKFsxLCAyLCAzLCA0XSksIFs5LCAxLCA5LCAyLCA5LCAzLCA5LCA0XSlcbiAqXG4gKiBAc2luY2UgMi4xMC4wXG4gKi9cbmV4cG9ydCB2YXIgcHJlcGVuZEFsbCA9IGZ1bmN0aW9uIChtaWRkbGUpIHtcbiAgICB2YXIgZiA9IFJORUEucHJlcGVuZEFsbChtaWRkbGUpO1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHsgcmV0dXJuIChpc05vbkVtcHR5KGFzKSA/IGYoYXMpIDogYXMpOyB9O1xufTtcbi8qKlxuICogUGxhY2VzIGFuIGVsZW1lbnQgaW4gYmV0d2VlbiBtZW1iZXJzIG9mIGFuIGFycmF5XG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IGludGVyc3BlcnNlIH0gZnJvbSAnZnAtdHMvUmVhZG9ubHlBcnJheSdcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKGludGVyc3BlcnNlKDkpKFsxLCAyLCAzLCA0XSksIFsxLCA5LCAyLCA5LCAzLCA5LCA0XSlcbiAqXG4gKiBAc2luY2UgMi45LjBcbiAqL1xuZXhwb3J0IHZhciBpbnRlcnNwZXJzZSA9IGZ1bmN0aW9uIChtaWRkbGUpIHtcbiAgICB2YXIgZiA9IFJORUEuaW50ZXJzcGVyc2UobWlkZGxlKTtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7IHJldHVybiAoaXNOb25FbXB0eShhcykgPyBmKGFzKSA6IGFzKTsgfTtcbn07XG4vKipcbiAqIFJvdGF0ZSBhIGBSZWFkb25seUFycmF5YCBieSBgbmAgc3RlcHMuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IHJvdGF0ZSB9IGZyb20gJ2ZwLXRzL1JlYWRvbmx5QXJyYXknXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChyb3RhdGUoMikoWzEsIDIsIDMsIDQsIDVdKSwgWzQsIDUsIDEsIDIsIDNdKVxuICpcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIHJvdGF0ZSA9IGZ1bmN0aW9uIChuKSB7XG4gICAgdmFyIGYgPSBSTkVBLnJvdGF0ZShuKTtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7IHJldHVybiAoaXNOb25FbXB0eShhcykgPyBmKGFzKSA6IGFzKTsgfTtcbn07XG5leHBvcnQgZnVuY3Rpb24gZWxlbShFKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhLCBhcykge1xuICAgICAgICBpZiAoYXMgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgdmFyIGVsZW1FXzEgPSBlbGVtKEUpO1xuICAgICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIChhcykgeyByZXR1cm4gZWxlbUVfMShhLCBhcyk7IH07XG4gICAgICAgIH1cbiAgICAgICAgdmFyIHByZWRpY2F0ZSA9IGZ1bmN0aW9uIChlbGVtZW50KSB7IHJldHVybiBFLmVxdWFscyhlbGVtZW50LCBhKTsgfTtcbiAgICAgICAgdmFyIGkgPSAwO1xuICAgICAgICBmb3IgKDsgaSA8IGFzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICBpZiAocHJlZGljYXRlKGFzW2ldKSkge1xuICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9O1xufVxuLyoqXG4gKiBSZW1vdmUgZHVwbGljYXRlcyBmcm9tIGFuIGFycmF5LCBrZWVwaW5nIHRoZSBmaXJzdCBvY2N1cnJlbmNlIG9mIGFuIGVsZW1lbnQuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IHVuaXEgfSBmcm9tICdmcC10cy9SZWFkb25seUFycmF5J1xuICogaW1wb3J0ICogYXMgTiBmcm9tICdmcC10cy9udW1iZXInXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbCh1bmlxKE4uRXEpKFsxLCAyLCAxXSksIFsxLCAyXSlcbiAqXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciB1bmlxID0gZnVuY3Rpb24gKEUpIHtcbiAgICB2YXIgZiA9IFJORUEudW5pcShFKTtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7IHJldHVybiAoaXNOb25FbXB0eShhcykgPyBmKGFzKSA6IGFzKTsgfTtcbn07XG4vKipcbiAqIFNvcnQgdGhlIGVsZW1lbnRzIG9mIGFuIGFycmF5IGluIGluY3JlYXNpbmcgb3JkZXIsIHdoZXJlIGVsZW1lbnRzIGFyZSBjb21wYXJlZCB1c2luZyBmaXJzdCBgb3Jkc1swXWAsIHRoZW4gYG9yZHNbMV1gLFxuICogZXRjLi4uXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IHNvcnRCeSB9IGZyb20gJ2ZwLXRzL1JlYWRvbmx5QXJyYXknXG4gKiBpbXBvcnQgeyBjb250cmFtYXAgfSBmcm9tICdmcC10cy9PcmQnXG4gKiBpbXBvcnQgKiBhcyBTIGZyb20gJ2ZwLXRzL3N0cmluZydcbiAqIGltcG9ydCAqIGFzIE4gZnJvbSAnZnAtdHMvbnVtYmVyJ1xuICogaW1wb3J0IHsgcGlwZSB9IGZyb20gJ2ZwLXRzL2Z1bmN0aW9uJ1xuICpcbiAqIGludGVyZmFjZSBQZXJzb24ge1xuICogICByZWFkb25seSBuYW1lOiBzdHJpbmdcbiAqICAgcmVhZG9ubHkgYWdlOiBudW1iZXJcbiAqIH1cbiAqIGNvbnN0IGJ5TmFtZSA9IHBpcGUoUy5PcmQsIGNvbnRyYW1hcCgocDogUGVyc29uKSA9PiBwLm5hbWUpKVxuICogY29uc3QgYnlBZ2UgPSBwaXBlKE4uT3JkLCBjb250cmFtYXAoKHA6IFBlcnNvbikgPT4gcC5hZ2UpKVxuICpcbiAqIGNvbnN0IHNvcnRCeU5hbWVCeUFnZSA9IHNvcnRCeShbYnlOYW1lLCBieUFnZV0pXG4gKlxuICogY29uc3QgcGVyc29ucyA9IFt7IG5hbWU6ICdhJywgYWdlOiAxIH0sIHsgbmFtZTogJ2InLCBhZ2U6IDMgfSwgeyBuYW1lOiAnYycsIGFnZTogMiB9LCB7IG5hbWU6ICdiJywgYWdlOiAyIH1dXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKHNvcnRCeU5hbWVCeUFnZShwZXJzb25zKSwgW1xuICogICB7IG5hbWU6ICdhJywgYWdlOiAxIH0sXG4gKiAgIHsgbmFtZTogJ2InLCBhZ2U6IDIgfSxcbiAqICAgeyBuYW1lOiAnYicsIGFnZTogMyB9LFxuICogICB7IG5hbWU6ICdjJywgYWdlOiAyIH1cbiAqIF0pXG4gKlxuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgc29ydEJ5ID0gZnVuY3Rpb24gKG9yZHMpIHtcbiAgICB2YXIgZiA9IFJORUEuc29ydEJ5KG9yZHMpO1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHsgcmV0dXJuIChpc05vbkVtcHR5KGFzKSA/IGYoYXMpIDogYXMpOyB9O1xufTtcbi8qKlxuICogQSB1c2VmdWwgcmVjdXJzaW9uIHBhdHRlcm4gZm9yIHByb2Nlc3NpbmcgYSBgUmVhZG9ubHlBcnJheWAgdG8gcHJvZHVjZSBhIG5ldyBgUmVhZG9ubHlBcnJheWAsIG9mdGVuIHVzZWQgZm9yIFwiY2hvcHBpbmdcIiB1cCB0aGUgaW5wdXRcbiAqIGBSZWFkb25seUFycmF5YC4gVHlwaWNhbGx5IGBjaG9wYCBpcyBjYWxsZWQgd2l0aCBzb21lIGZ1bmN0aW9uIHRoYXQgd2lsbCBjb25zdW1lIGFuIGluaXRpYWwgcHJlZml4IG9mIHRoZSBgUmVhZG9ubHlBcnJheWAgYW5kIHByb2R1Y2UgYVxuICogdmFsdWUgYW5kIHRoZSB0YWlsIG9mIHRoZSBgUmVhZG9ubHlBcnJheWAuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IEVxIH0gZnJvbSAnZnAtdHMvRXEnXG4gKiBpbXBvcnQgKiBhcyBSQSBmcm9tICdmcC10cy9SZWFkb25seUFycmF5J1xuICogaW1wb3J0ICogYXMgTiBmcm9tICdmcC10cy9udW1iZXInXG4gKiBpbXBvcnQgeyBwaXBlIH0gZnJvbSAnZnAtdHMvZnVuY3Rpb24nXG4gKlxuICogY29uc3QgZ3JvdXAgPSA8QT4oUzogRXE8QT4pOiAoKGFzOiBSZWFkb25seUFycmF5PEE+KSA9PiBSZWFkb25seUFycmF5PFJlYWRvbmx5QXJyYXk8QT4+KSA9PiB7XG4gKiAgIHJldHVybiBSQS5jaG9wKGFzID0+IHtcbiAqICAgICBjb25zdCB7IGluaXQsIHJlc3QgfSA9IHBpcGUoYXMsIFJBLnNwYW5MZWZ0KChhOiBBKSA9PiBTLmVxdWFscyhhLCBhc1swXSkpKVxuICogICAgIHJldHVybiBbaW5pdCwgcmVzdF1cbiAqICAgfSlcbiAqIH1cbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoZ3JvdXAoTi5FcSkoWzEsIDEsIDIsIDMsIDMsIDRdKSwgW1sxLCAxXSwgWzJdLCBbMywgM10sIFs0XV0pXG4gKlxuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgY2hvcCA9IGZ1bmN0aW9uIChmKSB7XG4gICAgdmFyIGcgPSBSTkVBLmNob3AoZik7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykgeyByZXR1cm4gKGlzTm9uRW1wdHkoYXMpID8gZyhhcykgOiBlbXB0eSk7IH07XG59O1xuLyoqXG4gKiBTcGxpdHMgYSBgUmVhZG9ubHlBcnJheWAgaW50byB0d28gcGllY2VzLCB0aGUgZmlyc3QgcGllY2UgaGFzIG1heCBgbmAgZWxlbWVudHMuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IHNwbGl0QXQgfSBmcm9tICdmcC10cy9SZWFkb25seUFycmF5J1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoc3BsaXRBdCgyKShbMSwgMiwgMywgNCwgNV0pLCBbWzEsIDJdLCBbMywgNCwgNV1dKVxuICpcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIHNwbGl0QXQgPSBmdW5jdGlvbiAobikge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgcmV0dXJuIG4gPj0gMSAmJiBpc05vbkVtcHR5KGFzKSA/IFJORUEuc3BsaXRBdChuKShhcykgOiBpc0VtcHR5KGFzKSA/IFthcywgZW1wdHldIDogW2VtcHR5LCBhc107XG4gICAgfTtcbn07XG4vKipcbiAqIFNwbGl0cyBhIGBSZWFkb25seUFycmF5YCBpbnRvIGxlbmd0aC1gbmAgcGllY2VzLiBUaGUgbGFzdCBwaWVjZSB3aWxsIGJlIHNob3J0ZXIgaWYgYG5gIGRvZXMgbm90IGV2ZW5seSBkaXZpZGUgdGhlIGxlbmd0aCBvZlxuICogdGhlIGBSZWFkb25seUFycmF5YC4gTm90ZSB0aGF0IGBjaHVua3NPZihuKShbXSlgIGlzIGBbXWAsIG5vdCBgW1tdXWAuIFRoaXMgaXMgaW50ZW50aW9uYWwsIGFuZCBpcyBjb25zaXN0ZW50IHdpdGggYSByZWN1cnNpdmVcbiAqIGRlZmluaXRpb24gb2YgYGNodW5rc09mYDsgaXQgc2F0aXNmaWVzIHRoZSBwcm9wZXJ0eSB0aGF0OlxuICpcbiAqIGBgYHRzXG4gKiBjaHVua3NPZihuKSh4cykuY29uY2F0KGNodW5rc09mKG4pKHlzKSkgPT0gY2h1bmtzT2YobikoeHMuY29uY2F0KHlzKSkpXG4gKiBgYGBcbiAqXG4gKiB3aGVuZXZlciBgbmAgZXZlbmx5IGRpdmlkZXMgdGhlIGxlbmd0aCBvZiBgYXNgLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBjaHVua3NPZiB9IGZyb20gJ2ZwLXRzL1JlYWRvbmx5QXJyYXknXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChjaHVua3NPZigyKShbMSwgMiwgMywgNCwgNV0pLCBbWzEsIDJdLCBbMywgNF0sIFs1XV0pXG4gKlxuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgY2h1bmtzT2YgPSBmdW5jdGlvbiAobikge1xuICAgIHZhciBmID0gUk5FQS5jaHVua3NPZihuKTtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7IHJldHVybiAoaXNOb25FbXB0eShhcykgPyBmKGFzKSA6IGVtcHR5KTsgfTtcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBsaWZ0aW5nXG4gKiBAc2luY2UgMi4xMS4wXG4gKi9cbmV4cG9ydCB2YXIgZnJvbU9wdGlvbksgPSBmdW5jdGlvbiAoZikge1xuICAgIHJldHVybiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBhID0gW107XG4gICAgICAgIGZvciAodmFyIF9pID0gMDsgX2kgPCBhcmd1bWVudHMubGVuZ3RoOyBfaSsrKSB7XG4gICAgICAgICAgICBhW19pXSA9IGFyZ3VtZW50c1tfaV07XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGZyb21PcHRpb24oZi5hcHBseSh2b2lkIDAsIGEpKTtcbiAgICB9O1xufTtcbmV4cG9ydCBmdW5jdGlvbiBjb21wcmVoZW5zaW9uKGlucHV0LCBmLCBnKSB7XG4gICAgaWYgKGcgPT09IHZvaWQgMCkgeyBnID0gZnVuY3Rpb24gKCkgeyByZXR1cm4gdHJ1ZTsgfTsgfVxuICAgIHZhciBnbyA9IGZ1bmN0aW9uIChzY29wZSwgaW5wdXQpIHtcbiAgICAgICAgcmV0dXJuIGlzTm9uRW1wdHkoaW5wdXQpXG4gICAgICAgICAgICA/IGZsYXRNYXAoUk5FQS5oZWFkKGlucHV0KSwgZnVuY3Rpb24gKGEpIHsgcmV0dXJuIGdvKHBpcGUoc2NvcGUsIGFwcGVuZChhKSksIFJORUEudGFpbChpbnB1dCkpOyB9KVxuICAgICAgICAgICAgOiBnLmFwcGx5KHZvaWQgMCwgc2NvcGUpID8gW2YuYXBwbHkodm9pZCAwLCBzY29wZSldXG4gICAgICAgICAgICAgICAgOiBlbXB0eTtcbiAgICB9O1xuICAgIHJldHVybiBnbyhlbXB0eSwgaW5wdXQpO1xufVxuLyoqXG4gKiBAc2luY2UgMi4xMS4wXG4gKi9cbmV4cG9ydCB2YXIgY29uY2F0VyA9IGZ1bmN0aW9uIChzZWNvbmQpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGZpcnN0KSB7XG4gICAgICAgIHJldHVybiBpc0VtcHR5KGZpcnN0KSA/IHNlY29uZCA6IGlzRW1wdHkoc2Vjb25kKSA/IGZpcnN0IDogZmlyc3QuY29uY2F0KHNlY29uZCk7XG4gICAgfTtcbn07XG4vKipcbiAqIEBzaW5jZSAyLjExLjBcbiAqL1xuZXhwb3J0IHZhciBjb25jYXQgPSBjb25jYXRXO1xuZXhwb3J0IGZ1bmN0aW9uIHVuaW9uKEUpIHtcbiAgICB2YXIgdW5pb25FID0gUk5FQS51bmlvbihFKTtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGZpcnN0LCBzZWNvbmQpIHtcbiAgICAgICAgaWYgKHNlY29uZCA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICB2YXIgdW5pb25FXzEgPSB1bmlvbihFKTtcbiAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbiAoc2Vjb25kKSB7IHJldHVybiB1bmlvbkVfMShzZWNvbmQsIGZpcnN0KTsgfTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gaXNOb25FbXB0eShmaXJzdCkgJiYgaXNOb25FbXB0eShzZWNvbmQpID8gdW5pb25FKHNlY29uZCkoZmlyc3QpIDogaXNOb25FbXB0eShmaXJzdCkgPyBmaXJzdCA6IHNlY29uZDtcbiAgICB9O1xufVxuZXhwb3J0IGZ1bmN0aW9uIGludGVyc2VjdGlvbihFKSB7XG4gICAgdmFyIGVsZW1FID0gZWxlbShFKTtcbiAgICByZXR1cm4gZnVuY3Rpb24gKHhzLCB5cykge1xuICAgICAgICBpZiAoeXMgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgdmFyIGludGVyc2VjdGlvbkVfMSA9IGludGVyc2VjdGlvbihFKTtcbiAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbiAoeXMpIHsgcmV0dXJuIGludGVyc2VjdGlvbkVfMSh5cywgeHMpOyB9O1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB4cy5maWx0ZXIoZnVuY3Rpb24gKGEpIHsgcmV0dXJuIGVsZW1FKGEsIHlzKTsgfSk7XG4gICAgfTtcbn1cbmV4cG9ydCBmdW5jdGlvbiBkaWZmZXJlbmNlKEUpIHtcbiAgICB2YXIgZWxlbUUgPSBlbGVtKEUpO1xuICAgIHJldHVybiBmdW5jdGlvbiAoeHMsIHlzKSB7XG4gICAgICAgIGlmICh5cyA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICB2YXIgZGlmZmVyZW5jZUVfMSA9IGRpZmZlcmVuY2UoRSk7XG4gICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24gKHlzKSB7IHJldHVybiBkaWZmZXJlbmNlRV8xKHlzLCB4cyk7IH07XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHhzLmZpbHRlcihmdW5jdGlvbiAoYSkgeyByZXR1cm4gIWVsZW1FKGEsIHlzKTsgfSk7XG4gICAgfTtcbn1cbnZhciBfbWFwID0gZnVuY3Rpb24gKGZhLCBmKSB7IHJldHVybiBwaXBlKGZhLCBtYXAoZikpOyB9O1xudmFyIF9tYXBXaXRoSW5kZXggPSBmdW5jdGlvbiAoZmEsIGYpIHsgcmV0dXJuIHBpcGUoZmEsIG1hcFdpdGhJbmRleChmKSk7IH07XG52YXIgX2FwID0gZnVuY3Rpb24gKGZhYiwgZmEpIHsgcmV0dXJuIHBpcGUoZmFiLCBhcChmYSkpOyB9O1xudmFyIF9maWx0ZXIgPSBmdW5jdGlvbiAoZmEsIHByZWRpY2F0ZSkge1xuICAgIHJldHVybiBwaXBlKGZhLCBmaWx0ZXIocHJlZGljYXRlKSk7XG59O1xudmFyIF9maWx0ZXJNYXAgPSBmdW5jdGlvbiAoZmEsIGYpIHsgcmV0dXJuIHBpcGUoZmEsIGZpbHRlck1hcChmKSk7IH07XG52YXIgX3BhcnRpdGlvbiA9IGZ1bmN0aW9uIChmYSwgcHJlZGljYXRlKSB7XG4gICAgcmV0dXJuIHBpcGUoZmEsIHBhcnRpdGlvbihwcmVkaWNhdGUpKTtcbn07XG52YXIgX3BhcnRpdGlvbk1hcCA9IGZ1bmN0aW9uIChmYSwgZikgeyByZXR1cm4gcGlwZShmYSwgcGFydGl0aW9uTWFwKGYpKTsgfTtcbnZhciBfcGFydGl0aW9uV2l0aEluZGV4ID0gZnVuY3Rpb24gKGZhLCBwcmVkaWNhdGVXaXRoSW5kZXgpIHsgcmV0dXJuIHBpcGUoZmEsIHBhcnRpdGlvbldpdGhJbmRleChwcmVkaWNhdGVXaXRoSW5kZXgpKTsgfTtcbnZhciBfcGFydGl0aW9uTWFwV2l0aEluZGV4ID0gZnVuY3Rpb24gKGZhLCBmKSB7IHJldHVybiBwaXBlKGZhLCBwYXJ0aXRpb25NYXBXaXRoSW5kZXgoZikpOyB9O1xudmFyIF9hbHQgPSBmdW5jdGlvbiAoZmEsIHRoYXQpIHsgcmV0dXJuIHBpcGUoZmEsIGFsdCh0aGF0KSk7IH07XG52YXIgX3JlZHVjZSA9IGZ1bmN0aW9uIChmYSwgYiwgZikgeyByZXR1cm4gcGlwZShmYSwgcmVkdWNlKGIsIGYpKTsgfTtcbnZhciBfZm9sZE1hcCA9IGZ1bmN0aW9uIChNKSB7XG4gICAgdmFyIGZvbGRNYXBNID0gZm9sZE1hcChNKTtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGZhLCBmKSB7IHJldHVybiBwaXBlKGZhLCBmb2xkTWFwTShmKSk7IH07XG59O1xudmFyIF9yZWR1Y2VSaWdodCA9IGZ1bmN0aW9uIChmYSwgYiwgZikgeyByZXR1cm4gcGlwZShmYSwgcmVkdWNlUmlnaHQoYiwgZikpOyB9O1xudmFyIF9yZWR1Y2VXaXRoSW5kZXggPSBmdW5jdGlvbiAoZmEsIGIsIGYpIHtcbiAgICByZXR1cm4gcGlwZShmYSwgcmVkdWNlV2l0aEluZGV4KGIsIGYpKTtcbn07XG52YXIgX2ZvbGRNYXBXaXRoSW5kZXggPSBmdW5jdGlvbiAoTSkge1xuICAgIHZhciBmb2xkTWFwV2l0aEluZGV4TSA9IGZvbGRNYXBXaXRoSW5kZXgoTSk7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChmYSwgZikgeyByZXR1cm4gcGlwZShmYSwgZm9sZE1hcFdpdGhJbmRleE0oZikpOyB9O1xufTtcbnZhciBfcmVkdWNlUmlnaHRXaXRoSW5kZXggPSBmdW5jdGlvbiAoZmEsIGIsIGYpIHtcbiAgICByZXR1cm4gcGlwZShmYSwgcmVkdWNlUmlnaHRXaXRoSW5kZXgoYiwgZikpO1xufTtcbnZhciBfZmlsdGVyTWFwV2l0aEluZGV4ID0gZnVuY3Rpb24gKGZhLCBmKSB7IHJldHVybiBwaXBlKGZhLCBmaWx0ZXJNYXBXaXRoSW5kZXgoZikpOyB9O1xudmFyIF9maWx0ZXJXaXRoSW5kZXggPSBmdW5jdGlvbiAoZmEsIHByZWRpY2F0ZVdpdGhJbmRleCkgeyByZXR1cm4gcGlwZShmYSwgZmlsdGVyV2l0aEluZGV4KHByZWRpY2F0ZVdpdGhJbmRleCkpOyB9O1xudmFyIF9leHRlbmQgPSBmdW5jdGlvbiAoZmEsIGYpIHsgcmV0dXJuIHBpcGUoZmEsIGV4dGVuZChmKSk7IH07XG52YXIgX3RyYXZlcnNlID0gZnVuY3Rpb24gKEYpIHtcbiAgICB2YXIgdHJhdmVyc2VGID0gdHJhdmVyc2UoRik7XG4gICAgcmV0dXJuIGZ1bmN0aW9uICh0YSwgZikgeyByZXR1cm4gcGlwZSh0YSwgdHJhdmVyc2VGKGYpKTsgfTtcbn07XG4vKiBpc3RhbmJ1bCBpZ25vcmUgbmV4dCAqL1xudmFyIF90cmF2ZXJzZVdpdGhJbmRleCA9IGZ1bmN0aW9uIChGKSB7XG4gICAgdmFyIHRyYXZlcnNlV2l0aEluZGV4RiA9IHRyYXZlcnNlV2l0aEluZGV4KEYpO1xuICAgIHJldHVybiBmdW5jdGlvbiAodGEsIGYpIHsgcmV0dXJuIHBpcGUodGEsIHRyYXZlcnNlV2l0aEluZGV4RihmKSk7IH07XG59O1xuLyoqIEBpbnRlcm5hbCAqL1xuZXhwb3J0IHZhciBfY2hhaW5SZWNEZXB0aEZpcnN0ID0gZnVuY3Rpb24gKGEsIGYpIHsgcmV0dXJuIHBpcGUoYSwgY2hhaW5SZWNEZXB0aEZpcnN0KGYpKTsgfTtcbi8qKiBAaW50ZXJuYWwgKi9cbmV4cG9ydCB2YXIgX2NoYWluUmVjQnJlYWR0aEZpcnN0ID0gZnVuY3Rpb24gKGEsIGYpIHsgcmV0dXJuIHBpcGUoYSwgY2hhaW5SZWNCcmVhZHRoRmlyc3QoZikpOyB9O1xuLyoqXG4gKiBAY2F0ZWdvcnkgY29uc3RydWN0b3JzXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBvZiA9IFJORUEub2Y7XG4vKipcbiAqIEBzaW5jZSAyLjcuMFxuICovXG5leHBvcnQgdmFyIHplcm8gPSBmdW5jdGlvbiAoKSB7IHJldHVybiBlbXB0eTsgfTtcbi8qKlxuICogTGVzcyBzdHJpY3QgdmVyc2lvbiBvZiBbYGFsdGBdKCNhbHQpLlxuICpcbiAqIFRoZSBgV2Agc3VmZml4IChzaG9ydCBmb3IgKipXKippZGVuaW5nKSBtZWFucyB0aGF0IHRoZSByZXR1cm4gdHlwZXMgd2lsbCBiZSBtZXJnZWQuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCAqIGFzIFJBIGZyb20gJ2ZwLXRzL1JlYWRvbmx5QXJyYXknXG4gKiBpbXBvcnQgeyBwaXBlIH0gZnJvbSAnZnAtdHMvZnVuY3Rpb24nXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChcbiAqICAgcGlwZShcbiAqICAgICBbMSwgMiwgM10sXG4gKiAgICAgUkEuYWx0VygoKSA9PiBbJ2EnLCAnYiddKVxuICogICApLFxuICogICBbMSwgMiwgMywgJ2EnLCAnYiddXG4gKiApXG4gKlxuICogQGNhdGVnb3J5IGVycm9yIGhhbmRsaW5nXG4gKiBAc2luY2UgMi45LjBcbiAqL1xuZXhwb3J0IHZhciBhbHRXID0gZnVuY3Rpb24gKHRoYXQpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGZhKSB7XG4gICAgICAgIHJldHVybiBmYS5jb25jYXQodGhhdCgpKTtcbiAgICB9O1xufTtcbi8qKlxuICogSWRlbnRpZmllcyBhbiBhc3NvY2lhdGl2ZSBvcGVyYXRpb24gb24gYSB0eXBlIGNvbnN0cnVjdG9yLiBJdCBpcyBzaW1pbGFyIHRvIGBTZW1pZ3JvdXBgLCBleGNlcHQgdGhhdCBpdCBhcHBsaWVzIHRvXG4gKiB0eXBlcyBvZiBraW5kIGAqIC0+ICpgLlxuICpcbiAqIEluIGNhc2Ugb2YgYFJlYWRvbmx5QXJyYXlgIGNvbmNhdGVuYXRlcyB0aGUgaW5wdXRzIGludG8gYSBzaW5nbGUgYXJyYXkuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCAqIGFzIFJBIGZyb20gJ2ZwLXRzL1JlYWRvbmx5QXJyYXknXG4gKiBpbXBvcnQgeyBwaXBlIH0gZnJvbSAnZnAtdHMvZnVuY3Rpb24nXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChcbiAqICAgcGlwZShcbiAqICAgICBbMSwgMiwgM10sXG4gKiAgICAgUkEuYWx0KCgpID0+IFs0LCA1XSlcbiAqICAgKSxcbiAqICAgWzEsIDIsIDMsIDQsIDVdXG4gKiApXG4gKlxuICogQGNhdGVnb3J5IGVycm9yIGhhbmRsaW5nXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBhbHQgPSBhbHRXO1xuLyoqXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBhcCA9IGZ1bmN0aW9uIChmYSkge1xuICAgIHJldHVybiBmbGF0TWFwKGZ1bmN0aW9uIChmKSB7IHJldHVybiBwaXBlKGZhLCBtYXAoZikpOyB9KTtcbn07XG4vKipcbiAqIENvbXBvc2VzIGNvbXB1dGF0aW9ucyBpbiBzZXF1ZW5jZSwgdXNpbmcgdGhlIHJldHVybiB2YWx1ZSBvZiBvbmUgY29tcHV0YXRpb24gdG8gZGV0ZXJtaW5lIHRoZSBuZXh0IGNvbXB1dGF0aW9uLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgKiBhcyBSQSBmcm9tICdmcC10cy9SZWFkb25seUFycmF5J1xuICogaW1wb3J0IHsgcGlwZSB9IGZyb20gJ2ZwLXRzL2Z1bmN0aW9uJ1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoXG4gKiAgIHBpcGUoXG4gKiAgICAgWzEsIDIsIDNdLFxuICogICAgIFJBLmZsYXRNYXAoKG4pID0+IFtgYSR7bn1gLCBgYiR7bn1gXSlcbiAqICAgKSxcbiAqICAgWydhMScsICdiMScsICdhMicsICdiMicsICdhMycsICdiMyddXG4gKiApXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKFxuICogICBwaXBlKFxuICogICAgIFsxLCAyLCAzXSxcbiAqICAgICBSQS5mbGF0TWFwKCgpID0+IFtdKVxuICogICApLFxuICogICBbXVxuICogKVxuICpcbiAqIEBjYXRlZ29yeSBzZXF1ZW5jaW5nXG4gKiBAc2luY2UgMi4xNC4wXG4gKi9cbmV4cG9ydCB2YXIgZmxhdE1hcCA9IC8qI19fUFVSRV9fKi8gZHVhbCgyLCBmdW5jdGlvbiAobWEsIGYpIHtcbiAgICByZXR1cm4gcGlwZShtYSwgY2hhaW5XaXRoSW5kZXgoZnVuY3Rpb24gKGksIGEpIHsgcmV0dXJuIGYoYSwgaSk7IH0pKTtcbn0pO1xuLyoqXG4gKiBAY2F0ZWdvcnkgc2VxdWVuY2luZ1xuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgZmxhdHRlbiA9IC8qI19fUFVSRV9fKi8gZmxhdE1hcChpZGVudGl0eSk7XG4vKipcbiAqIGBtYXBgIGNhbiBiZSB1c2VkIHRvIHR1cm4gZnVuY3Rpb25zIGAoYTogQSkgPT4gQmAgaW50byBmdW5jdGlvbnMgYChmYTogRjxBPikgPT4gRjxCPmAgd2hvc2UgYXJndW1lbnQgYW5kIHJldHVybiB0eXBlc1xuICogdXNlIHRoZSB0eXBlIGNvbnN0cnVjdG9yIGBGYCB0byByZXByZXNlbnQgc29tZSBjb21wdXRhdGlvbmFsIGNvbnRleHQuXG4gKlxuICogQGNhdGVnb3J5IG1hcHBpbmdcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIG1hcCA9IGZ1bmN0aW9uIChmKSB7IHJldHVybiBmdW5jdGlvbiAoZmEpIHtcbiAgICByZXR1cm4gZmEubWFwKGZ1bmN0aW9uIChhKSB7IHJldHVybiBmKGEpOyB9KTtcbn07IH07XG4vKipcbiAqIEBjYXRlZ29yeSBtYXBwaW5nXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBtYXBXaXRoSW5kZXggPSBmdW5jdGlvbiAoZikgeyByZXR1cm4gZnVuY3Rpb24gKGZhKSB7XG4gICAgcmV0dXJuIGZhLm1hcChmdW5jdGlvbiAoYSwgaSkgeyByZXR1cm4gZihpLCBhKTsgfSk7XG59OyB9O1xuLyoqXG4gKiBAY2F0ZWdvcnkgZmlsdGVyaW5nXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBzZXBhcmF0ZSA9IGZ1bmN0aW9uIChmYSkge1xuICAgIHZhciBsZWZ0ID0gW107XG4gICAgdmFyIHJpZ2h0ID0gW107XG4gICAgZm9yICh2YXIgX2kgPSAwLCBmYV8xID0gZmE7IF9pIDwgZmFfMS5sZW5ndGg7IF9pKyspIHtcbiAgICAgICAgdmFyIGUgPSBmYV8xW19pXTtcbiAgICAgICAgaWYgKGUuX3RhZyA9PT0gJ0xlZnQnKSB7XG4gICAgICAgICAgICBsZWZ0LnB1c2goZS5sZWZ0KTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHJpZ2h0LnB1c2goZS5yaWdodCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHNlcGFyYXRlZChsZWZ0LCByaWdodCk7XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgZmlsdGVyaW5nXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBmaWx0ZXIgPSBmdW5jdGlvbiAocHJlZGljYXRlKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykge1xuICAgICAgICByZXR1cm4gYXMuZmlsdGVyKHByZWRpY2F0ZSk7XG4gICAgfTtcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBmaWx0ZXJpbmdcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIGZpbHRlck1hcFdpdGhJbmRleCA9IGZ1bmN0aW9uIChmKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChmYSkge1xuICAgICAgICB2YXIgb3V0ID0gW107XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgZmEubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIHZhciBvcHRpb25CID0gZihpLCBmYVtpXSk7XG4gICAgICAgICAgICBpZiAoXy5pc1NvbWUob3B0aW9uQikpIHtcbiAgICAgICAgICAgICAgICBvdXQucHVzaChvcHRpb25CLnZhbHVlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gb3V0O1xuICAgIH07XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgZmlsdGVyaW5nXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBmaWx0ZXJNYXAgPSBmdW5jdGlvbiAoZikge1xuICAgIHJldHVybiBmaWx0ZXJNYXBXaXRoSW5kZXgoZnVuY3Rpb24gKF8sIGEpIHsgcmV0dXJuIGYoYSk7IH0pO1xufTtcbi8qKlxuICogQGNhdGVnb3J5IGZpbHRlcmluZ1xuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgY29tcGFjdCA9IC8qI19fUFVSRV9fKi8gZmlsdGVyTWFwKGlkZW50aXR5KTtcbi8qKlxuICogQGNhdGVnb3J5IGZpbHRlcmluZ1xuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgcGFydGl0aW9uID0gZnVuY3Rpb24gKHByZWRpY2F0ZSkge1xuICAgIHJldHVybiBwYXJ0aXRpb25XaXRoSW5kZXgoZnVuY3Rpb24gKF8sIGEpIHsgcmV0dXJuIHByZWRpY2F0ZShhKTsgfSk7XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgZmlsdGVyaW5nXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBwYXJ0aXRpb25XaXRoSW5kZXggPSBmdW5jdGlvbiAocHJlZGljYXRlV2l0aEluZGV4KSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykge1xuICAgICAgICB2YXIgbGVmdCA9IFtdO1xuICAgICAgICB2YXIgcmlnaHQgPSBbXTtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBhcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgdmFyIGEgPSBhc1tpXTtcbiAgICAgICAgICAgIGlmIChwcmVkaWNhdGVXaXRoSW5kZXgoaSwgYSkpIHtcbiAgICAgICAgICAgICAgICByaWdodC5wdXNoKGEpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgbGVmdC5wdXNoKGEpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBzZXBhcmF0ZWQobGVmdCwgcmlnaHQpO1xuICAgIH07XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgZmlsdGVyaW5nXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBwYXJ0aXRpb25NYXAgPSBmdW5jdGlvbiAoZikge1xuICAgIHJldHVybiBwYXJ0aXRpb25NYXBXaXRoSW5kZXgoZnVuY3Rpb24gKF8sIGEpIHsgcmV0dXJuIGYoYSk7IH0pO1xufTtcbi8qKlxuICogQGNhdGVnb3J5IGZpbHRlcmluZ1xuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgcGFydGl0aW9uTWFwV2l0aEluZGV4ID0gZnVuY3Rpb24gKGYpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGZhKSB7XG4gICAgICAgIHZhciBsZWZ0ID0gW107XG4gICAgICAgIHZhciByaWdodCA9IFtdO1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGZhLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICB2YXIgZSA9IGYoaSwgZmFbaV0pO1xuICAgICAgICAgICAgaWYgKGUuX3RhZyA9PT0gJ0xlZnQnKSB7XG4gICAgICAgICAgICAgICAgbGVmdC5wdXNoKGUubGVmdCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICByaWdodC5wdXNoKGUucmlnaHQpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBzZXBhcmF0ZWQobGVmdCwgcmlnaHQpO1xuICAgIH07XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgZmlsdGVyaW5nXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBmaWx0ZXJXaXRoSW5kZXggPSBmdW5jdGlvbiAocHJlZGljYXRlV2l0aEluZGV4KSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykge1xuICAgICAgICByZXR1cm4gYXMuZmlsdGVyKGZ1bmN0aW9uIChhLCBpKSB7IHJldHVybiBwcmVkaWNhdGVXaXRoSW5kZXgoaSwgYSk7IH0pO1xuICAgIH07XG59O1xuLyoqXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBleHRlbmQgPSBmdW5jdGlvbiAoZikgeyByZXR1cm4gZnVuY3Rpb24gKHdhKSB7XG4gICAgcmV0dXJuIHdhLm1hcChmdW5jdGlvbiAoXywgaSkgeyByZXR1cm4gZih3YS5zbGljZShpKSk7IH0pO1xufTsgfTtcbi8qKlxuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgZHVwbGljYXRlID0gLyojX19QVVJFX18qLyBleHRlbmQoaWRlbnRpdHkpO1xuLyoqXG4gKiBAY2F0ZWdvcnkgZm9sZGluZ1xuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgZm9sZE1hcFdpdGhJbmRleCA9IGZ1bmN0aW9uIChNKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChmKSB7XG4gICAgICAgIHJldHVybiBmdW5jdGlvbiAoZmEpIHtcbiAgICAgICAgICAgIHJldHVybiBmYS5yZWR1Y2UoZnVuY3Rpb24gKGIsIGEsIGkpIHsgcmV0dXJuIE0uY29uY2F0KGIsIGYoaSwgYSkpOyB9LCBNLmVtcHR5KTtcbiAgICAgICAgfTtcbiAgICB9O1xufTtcbi8qKlxuICogQGNhdGVnb3J5IGZvbGRpbmdcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIHJlZHVjZSA9IGZ1bmN0aW9uIChiLCBmKSB7XG4gICAgcmV0dXJuIHJlZHVjZVdpdGhJbmRleChiLCBmdW5jdGlvbiAoXywgYiwgYSkgeyByZXR1cm4gZihiLCBhKTsgfSk7XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgZm9sZGluZ1xuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgZm9sZE1hcCA9IGZ1bmN0aW9uIChNKSB7XG4gICAgdmFyIGZvbGRNYXBXaXRoSW5kZXhNID0gZm9sZE1hcFdpdGhJbmRleChNKTtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGYpIHsgcmV0dXJuIGZvbGRNYXBXaXRoSW5kZXhNKGZ1bmN0aW9uIChfLCBhKSB7IHJldHVybiBmKGEpOyB9KTsgfTtcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBmb2xkaW5nXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciByZWR1Y2VXaXRoSW5kZXggPSBmdW5jdGlvbiAoYiwgZikgeyByZXR1cm4gZnVuY3Rpb24gKGZhKSB7XG4gICAgdmFyIGxlbiA9IGZhLmxlbmd0aDtcbiAgICB2YXIgb3V0ID0gYjtcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IGxlbjsgaSsrKSB7XG4gICAgICAgIG91dCA9IGYoaSwgb3V0LCBmYVtpXSk7XG4gICAgfVxuICAgIHJldHVybiBvdXQ7XG59OyB9O1xuLyoqXG4gKiBAY2F0ZWdvcnkgZm9sZGluZ1xuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgcmVkdWNlUmlnaHQgPSBmdW5jdGlvbiAoYiwgZikge1xuICAgIHJldHVybiByZWR1Y2VSaWdodFdpdGhJbmRleChiLCBmdW5jdGlvbiAoXywgYSwgYikgeyByZXR1cm4gZihhLCBiKTsgfSk7XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgZm9sZGluZ1xuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgcmVkdWNlUmlnaHRXaXRoSW5kZXggPSBmdW5jdGlvbiAoYiwgZikgeyByZXR1cm4gZnVuY3Rpb24gKGZhKSB7XG4gICAgcmV0dXJuIGZhLnJlZHVjZVJpZ2h0KGZ1bmN0aW9uIChiLCBhLCBpKSB7IHJldHVybiBmKGksIGEsIGIpOyB9LCBiKTtcbn07IH07XG4vKipcbiAqIEBjYXRlZ29yeSB0cmF2ZXJzaW5nXG4gKiBAc2luY2UgMi42LjNcbiAqL1xuZXhwb3J0IHZhciB0cmF2ZXJzZSA9IGZ1bmN0aW9uIChGKSB7XG4gICAgdmFyIHRyYXZlcnNlV2l0aEluZGV4RiA9IHRyYXZlcnNlV2l0aEluZGV4KEYpO1xuICAgIHJldHVybiBmdW5jdGlvbiAoZikgeyByZXR1cm4gdHJhdmVyc2VXaXRoSW5kZXhGKGZ1bmN0aW9uIChfLCBhKSB7IHJldHVybiBmKGEpOyB9KTsgfTtcbn07XG4vKipcbiAqIEBjYXRlZ29yeSB0cmF2ZXJzaW5nXG4gKiBAc2luY2UgMi42LjNcbiAqL1xuZXhwb3J0IHZhciBzZXF1ZW5jZSA9IGZ1bmN0aW9uIChGKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uICh0YSkge1xuICAgICAgICByZXR1cm4gX3JlZHVjZSh0YSwgRi5vZih6ZXJvKCkpLCBmdW5jdGlvbiAoZmFzLCBmYSkge1xuICAgICAgICAgICAgcmV0dXJuIEYuYXAoRi5tYXAoZmFzLCBmdW5jdGlvbiAoYXMpIHsgcmV0dXJuIGZ1bmN0aW9uIChhKSB7IHJldHVybiBwaXBlKGFzLCBhcHBlbmQoYSkpOyB9OyB9KSwgZmEpO1xuICAgICAgICB9KTtcbiAgICB9O1xufTtcbi8qKlxuICogQGNhdGVnb3J5IHNlcXVlbmNpbmdcbiAqIEBzaW5jZSAyLjYuM1xuICovXG5leHBvcnQgdmFyIHRyYXZlcnNlV2l0aEluZGV4ID0gZnVuY3Rpb24gKEYpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGYpIHtcbiAgICAgICAgcmV0dXJuIHJlZHVjZVdpdGhJbmRleChGLm9mKHplcm8oKSksIGZ1bmN0aW9uIChpLCBmYnMsIGEpIHtcbiAgICAgICAgICAgIHJldHVybiBGLmFwKEYubWFwKGZicywgZnVuY3Rpb24gKGJzKSB7IHJldHVybiBmdW5jdGlvbiAoYikgeyByZXR1cm4gcGlwZShicywgYXBwZW5kKGIpKTsgfTsgfSksIGYoaSwgYSkpO1xuICAgICAgICB9KTtcbiAgICB9O1xufTtcbi8qKlxuICogQGNhdGVnb3J5IGZpbHRlcmluZ1xuICogQHNpbmNlIDIuNi41XG4gKi9cbmV4cG9ydCB2YXIgd2l0aGVyID0gZnVuY3Rpb24gKEYpIHtcbiAgICB2YXIgX3dpdGhlckYgPSBfd2l0aGVyKEYpO1xuICAgIHJldHVybiBmdW5jdGlvbiAoZikgeyByZXR1cm4gZnVuY3Rpb24gKGZhKSB7IHJldHVybiBfd2l0aGVyRihmYSwgZik7IH07IH07XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgZmlsdGVyaW5nXG4gKiBAc2luY2UgMi42LjVcbiAqL1xuZXhwb3J0IHZhciB3aWx0ID0gZnVuY3Rpb24gKEYpIHtcbiAgICB2YXIgX3dpbHRGID0gX3dpbHQoRik7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChmKSB7IHJldHVybiBmdW5jdGlvbiAoZmEpIHsgcmV0dXJuIF93aWx0RihmYSwgZik7IH07IH07XG59O1xuLyoqXG4gKiBAc2luY2UgMi42LjZcbiAqL1xuZXhwb3J0IHZhciB1bmZvbGQgPSBmdW5jdGlvbiAoYiwgZikge1xuICAgIHZhciBvdXQgPSBbXTtcbiAgICB2YXIgYmIgPSBiO1xuICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBuby1jb25zdGFudC1jb25kaXRpb25cbiAgICB3aGlsZSAodHJ1ZSkge1xuICAgICAgICB2YXIgbXQgPSBmKGJiKTtcbiAgICAgICAgaWYgKF8uaXNTb21lKG10KSkge1xuICAgICAgICAgICAgdmFyIF9hID0gbXQudmFsdWUsIGEgPSBfYVswXSwgYl8xID0gX2FbMV07XG4gICAgICAgICAgICBvdXQucHVzaChhKTtcbiAgICAgICAgICAgIGJiID0gYl8xO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIG91dDtcbn07XG4vKipcbiAqIEBjYXRlZ29yeSB0eXBlIGxhbWJkYXNcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIFVSSSA9ICdSZWFkb25seUFycmF5Jztcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgZ2V0U2hvdyA9IGZ1bmN0aW9uIChTKSB7IHJldHVybiAoe1xuICAgIHNob3c6IGZ1bmN0aW9uIChhcykgeyByZXR1cm4gXCJbXCIuY29uY2F0KGFzLm1hcChTLnNob3cpLmpvaW4oJywgJyksIFwiXVwiKTsgfVxufSk7IH07XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIGdldFNlbWlncm91cCA9IGZ1bmN0aW9uICgpIHsgcmV0dXJuICh7XG4gICAgY29uY2F0OiBmdW5jdGlvbiAoZmlyc3QsIHNlY29uZCkgeyByZXR1cm4gKGlzRW1wdHkoZmlyc3QpID8gc2Vjb25kIDogaXNFbXB0eShzZWNvbmQpID8gZmlyc3QgOiBmaXJzdC5jb25jYXQoc2Vjb25kKSk7IH1cbn0pOyB9O1xuLyoqXG4gKiBSZXR1cm5zIGEgYE1vbm9pZGAgZm9yIGBSZWFkb25seUFycmF5PEE+YC5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgZ2V0TW9ub2lkIH0gZnJvbSAnZnAtdHMvUmVhZG9ubHlBcnJheSdcbiAqXG4gKiBjb25zdCBNID0gZ2V0TW9ub2lkPG51bWJlcj4oKVxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChNLmNvbmNhdChbMSwgMl0sIFszLCA0XSksIFsxLCAyLCAzLCA0XSlcbiAqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBnZXRNb25vaWQgPSBmdW5jdGlvbiAoKSB7IHJldHVybiAoe1xuICAgIGNvbmNhdDogZ2V0U2VtaWdyb3VwKCkuY29uY2F0LFxuICAgIGVtcHR5OiBlbXB0eVxufSk7IH07XG4vKipcbiAqIERlcml2ZXMgYW4gYEVxYCBvdmVyIHRoZSBgUmVhZG9ubHlBcnJheWAgb2YgYSBnaXZlbiBlbGVtZW50IHR5cGUgZnJvbSB0aGUgYEVxYCBvZiB0aGF0IHR5cGUuIFRoZSBkZXJpdmVkIGBFcWAgZGVmaW5lcyB0d29cbiAqIGFycmF5cyBhcyBlcXVhbCBpZiBhbGwgZWxlbWVudHMgb2YgYm90aCBhcnJheXMgYXJlIGNvbXBhcmVkIGVxdWFsIHBhaXJ3aXNlIHdpdGggdGhlIGdpdmVuIGBFYC4gSW4gY2FzZSBvZiBhcnJheXMgb2ZcbiAqIGRpZmZlcmVudCBsZW5ndGhzLCB0aGUgcmVzdWx0IGlzIG5vbiBlcXVhbGl0eS5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0ICogYXMgUyBmcm9tICdmcC10cy9zdHJpbmcnXG4gKiBpbXBvcnQgeyBnZXRFcSB9IGZyb20gJ2ZwLXRzL1JlYWRvbmx5QXJyYXknXG4gKlxuICogY29uc3QgRSA9IGdldEVxKFMuRXEpXG4gKiBhc3NlcnQuc3RyaWN0RXF1YWwoRS5lcXVhbHMoWydhJywgJ2InXSwgWydhJywgJ2InXSksIHRydWUpXG4gKiBhc3NlcnQuc3RyaWN0RXF1YWwoRS5lcXVhbHMoWydhJ10sIFtdKSwgZmFsc2UpXG4gKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgZ2V0RXEgPSBmdW5jdGlvbiAoRSkge1xuICAgIHJldHVybiBmcm9tRXF1YWxzKGZ1bmN0aW9uICh4cywgeXMpIHsgcmV0dXJuIHhzLmxlbmd0aCA9PT0geXMubGVuZ3RoICYmIHhzLmV2ZXJ5KGZ1bmN0aW9uICh4LCBpKSB7IHJldHVybiBFLmVxdWFscyh4LCB5c1tpXSk7IH0pOyB9KTtcbn07XG4vKipcbiAqIERlcml2ZXMgYW4gYE9yZGAgb3ZlciB0aGUgYFJlYWRvbmx5QXJyYXlgIG9mIGEgZ2l2ZW4gZWxlbWVudCB0eXBlIGZyb20gdGhlIGBPcmRgIG9mIHRoYXQgdHlwZS4gVGhlIG9yZGVyaW5nIGJldHdlZW4gdHdvIHN1Y2hcbiAqIGFycmF5cyBpcyBlcXVhbCB0bzogdGhlIGZpcnN0IG5vbiBlcXVhbCBjb21wYXJpc29uIG9mIGVhY2ggYXJyYXlzIGVsZW1lbnRzIHRha2VuIHBhaXJ3aXNlIGluIGluY3JlYXNpbmcgb3JkZXIsIGluXG4gKiBjYXNlIG9mIGVxdWFsaXR5IG92ZXIgYWxsIHRoZSBwYWlyd2lzZSBlbGVtZW50czsgdGhlIGxvbmdlc3QgYXJyYXkgaXMgY29uc2lkZXJlZCB0aGUgZ3JlYXRlc3QsIGlmIGJvdGggYXJyYXlzIGhhdmVcbiAqIHRoZSBzYW1lIGxlbmd0aCwgdGhlIHJlc3VsdCBpcyBlcXVhbGl0eS5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgZ2V0T3JkIH0gZnJvbSAnZnAtdHMvUmVhZG9ubHlBcnJheSdcbiAqIGltcG9ydCAqIGFzIFMgZnJvbSAnZnAtdHMvc3RyaW5nJ1xuICpcbiAqIGNvbnN0IE8gPSBnZXRPcmQoUy5PcmQpXG4gKiBhc3NlcnQuc3RyaWN0RXF1YWwoTy5jb21wYXJlKFsnYiddLCBbJ2EnXSksIDEpXG4gKiBhc3NlcnQuc3RyaWN0RXF1YWwoTy5jb21wYXJlKFsnYSddLCBbJ2EnXSksIDApXG4gKiBhc3NlcnQuc3RyaWN0RXF1YWwoTy5jb21wYXJlKFsnYSddLCBbJ2InXSksIC0xKVxuICpcbiAqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBnZXRPcmQgPSBmdW5jdGlvbiAoTykge1xuICAgIHJldHVybiBmcm9tQ29tcGFyZShmdW5jdGlvbiAoYSwgYikge1xuICAgICAgICB2YXIgYUxlbiA9IGEubGVuZ3RoO1xuICAgICAgICB2YXIgYkxlbiA9IGIubGVuZ3RoO1xuICAgICAgICB2YXIgbGVuID0gTWF0aC5taW4oYUxlbiwgYkxlbik7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbGVuOyBpKyspIHtcbiAgICAgICAgICAgIHZhciBvcmRlcmluZyA9IE8uY29tcGFyZShhW2ldLCBiW2ldKTtcbiAgICAgICAgICAgIGlmIChvcmRlcmluZyAhPT0gMCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBvcmRlcmluZztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gTi5PcmQuY29tcGFyZShhTGVuLCBiTGVuKTtcbiAgICB9KTtcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjExLjBcbiAqL1xuZXhwb3J0IHZhciBnZXRVbmlvblNlbWlncm91cCA9IGZ1bmN0aW9uIChFKSB7XG4gICAgdmFyIHVuaW9uRSA9IHVuaW9uKEUpO1xuICAgIHJldHVybiB7XG4gICAgICAgIGNvbmNhdDogZnVuY3Rpb24gKGZpcnN0LCBzZWNvbmQpIHsgcmV0dXJuIHVuaW9uRShzZWNvbmQpKGZpcnN0KTsgfVxuICAgIH07XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi4xMS4wXG4gKi9cbmV4cG9ydCB2YXIgZ2V0VW5pb25Nb25vaWQgPSBmdW5jdGlvbiAoRSkgeyByZXR1cm4gKHtcbiAgICBjb25jYXQ6IGdldFVuaW9uU2VtaWdyb3VwKEUpLmNvbmNhdCxcbiAgICBlbXB0eTogZW1wdHlcbn0pOyB9O1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi4xMS4wXG4gKi9cbmV4cG9ydCB2YXIgZ2V0SW50ZXJzZWN0aW9uU2VtaWdyb3VwID0gZnVuY3Rpb24gKEUpIHtcbiAgICB2YXIgaW50ZXJzZWN0aW9uRSA9IGludGVyc2VjdGlvbihFKTtcbiAgICByZXR1cm4ge1xuICAgICAgICBjb25jYXQ6IGZ1bmN0aW9uIChmaXJzdCwgc2Vjb25kKSB7IHJldHVybiBpbnRlcnNlY3Rpb25FKHNlY29uZCkoZmlyc3QpOyB9XG4gICAgfTtcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjExLjBcbiAqL1xuZXhwb3J0IHZhciBnZXREaWZmZXJlbmNlTWFnbWEgPSBmdW5jdGlvbiAoRSkge1xuICAgIHZhciBkaWZmZXJlbmNlRSA9IGRpZmZlcmVuY2UoRSk7XG4gICAgcmV0dXJuIHtcbiAgICAgICAgY29uY2F0OiBmdW5jdGlvbiAoZmlyc3QsIHNlY29uZCkgeyByZXR1cm4gZGlmZmVyZW5jZUUoc2Vjb25kKShmaXJzdCk7IH1cbiAgICB9O1xufTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuNy4wXG4gKi9cbmV4cG9ydCB2YXIgRnVuY3RvciA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICBtYXA6IF9tYXBcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBtYXBwaW5nXG4gKiBAc2luY2UgMi4xMC4wXG4gKi9cbmV4cG9ydCB2YXIgZmxhcCA9IC8qI19fUFVSRV9fKi8gZmxhcF8oRnVuY3Rvcik7XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjEwLjBcbiAqL1xuZXhwb3J0IHZhciBQb2ludGVkID0ge1xuICAgIFVSSTogVVJJLFxuICAgIG9mOiBvZlxufTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuNy4wXG4gKi9cbmV4cG9ydCB2YXIgRnVuY3RvcldpdGhJbmRleCA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICBtYXA6IF9tYXAsXG4gICAgbWFwV2l0aEluZGV4OiBfbWFwV2l0aEluZGV4XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi4xMC4wXG4gKi9cbmV4cG9ydCB2YXIgQXBwbHkgPSB7XG4gICAgVVJJOiBVUkksXG4gICAgbWFwOiBfbWFwLFxuICAgIGFwOiBfYXBcbn07XG4vKipcbiAqIENvbWJpbmUgdHdvIGVmZmVjdGZ1bCBhY3Rpb25zLCBrZWVwaW5nIG9ubHkgdGhlIHJlc3VsdCBvZiB0aGUgZmlyc3QuXG4gKlxuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgYXBGaXJzdCA9IC8qI19fUFVSRV9fKi8gYXBGaXJzdF8oQXBwbHkpO1xuLyoqXG4gKiBDb21iaW5lIHR3byBlZmZlY3RmdWwgYWN0aW9ucywga2VlcGluZyBvbmx5IHRoZSByZXN1bHQgb2YgdGhlIHNlY29uZC5cbiAqXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBhcFNlY29uZCA9IC8qI19fUFVSRV9fKi8gYXBTZWNvbmRfKEFwcGx5KTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuNy4wXG4gKi9cbmV4cG9ydCB2YXIgQXBwbGljYXRpdmUgPSB7XG4gICAgVVJJOiBVUkksXG4gICAgbWFwOiBfbWFwLFxuICAgIGFwOiBfYXAsXG4gICAgb2Y6IG9mXG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi4xMC4wXG4gKi9cbmV4cG9ydCB2YXIgQ2hhaW4gPSB7XG4gICAgVVJJOiBVUkksXG4gICAgbWFwOiBfbWFwLFxuICAgIGFwOiBfYXAsXG4gICAgY2hhaW46IGZsYXRNYXBcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjcuMFxuICovXG5leHBvcnQgdmFyIE1vbmFkID0ge1xuICAgIFVSSTogVVJJLFxuICAgIG1hcDogX21hcCxcbiAgICBhcDogX2FwLFxuICAgIG9mOiBvZixcbiAgICBjaGFpbjogZmxhdE1hcFxufTtcbi8qKlxuICogQ29tcG9zZXMgY29tcHV0YXRpb25zIGluIHNlcXVlbmNlLCB1c2luZyB0aGUgcmV0dXJuIHZhbHVlIG9mIG9uZSBjb21wdXRhdGlvbiB0byBkZXRlcm1pbmUgdGhlIG5leHQgY29tcHV0YXRpb24gYW5kXG4gKiBrZWVwaW5nIG9ubHkgdGhlIHJlc3VsdCBvZiB0aGUgZmlyc3QuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCAqIGFzIFJBIGZyb20gJ2ZwLXRzL1JlYWRvbmx5QXJyYXknXG4gKiBpbXBvcnQgeyBwaXBlIH0gZnJvbSAnZnAtdHMvZnVuY3Rpb24nXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChcbiAqICAgcGlwZShcbiAqICAgICBbMSwgMiwgM10sXG4gKiAgICAgUkEuY2hhaW5GaXJzdCgoKSA9PiBbJ2EnLCAnYiddKVxuICogICApLFxuICogICBbMSwgMSwgMiwgMiwgMywgM11cbiAqIClcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoXG4gKiAgIHBpcGUoXG4gKiAgICAgWzEsIDIsIDNdLFxuICogICAgIFJBLmNoYWluRmlyc3QoKCkgPT4gW10pXG4gKiAgICksXG4gKiAgIFtdXG4gKiApXG4gKlxuICogQGNhdGVnb3J5IHNlcXVlbmNpbmdcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIGNoYWluRmlyc3QgPSBcbi8qI19fUFVSRV9fKi8gY2hhaW5GaXJzdF8oQ2hhaW4pO1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi43LjBcbiAqL1xuZXhwb3J0IHZhciBVbmZvbGRhYmxlID0ge1xuICAgIFVSSTogVVJJLFxuICAgIHVuZm9sZDogdW5mb2xkXG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi43LjBcbiAqL1xuZXhwb3J0IHZhciBBbHQgPSB7XG4gICAgVVJJOiBVUkksXG4gICAgbWFwOiBfbWFwLFxuICAgIGFsdDogX2FsdFxufTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIFplcm8gPSB7XG4gICAgVVJJOiBVUkksXG4gICAgemVybzogemVyb1xufTtcbi8qKlxuICogQGNhdGVnb3J5IGRvIG5vdGF0aW9uXG4gKiBAc2luY2UgMi4xMS4wXG4gKi9cbmV4cG9ydCB2YXIgZ3VhcmQgPSAvKiNfX1BVUkVfXyovIGd1YXJkXyhaZXJvLCBQb2ludGVkKTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuNy4wXG4gKi9cbmV4cG9ydCB2YXIgQWx0ZXJuYXRpdmUgPSB7XG4gICAgVVJJOiBVUkksXG4gICAgbWFwOiBfbWFwLFxuICAgIGFwOiBfYXAsXG4gICAgb2Y6IG9mLFxuICAgIGFsdDogX2FsdCxcbiAgICB6ZXJvOiB6ZXJvXG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi43LjBcbiAqL1xuZXhwb3J0IHZhciBFeHRlbmQgPSB7XG4gICAgVVJJOiBVUkksXG4gICAgbWFwOiBfbWFwLFxuICAgIGV4dGVuZDogX2V4dGVuZFxufTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuNy4wXG4gKi9cbmV4cG9ydCB2YXIgQ29tcGFjdGFibGUgPSB7XG4gICAgVVJJOiBVUkksXG4gICAgY29tcGFjdDogY29tcGFjdCxcbiAgICBzZXBhcmF0ZTogc2VwYXJhdGVcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjcuMFxuICovXG5leHBvcnQgdmFyIEZpbHRlcmFibGUgPSB7XG4gICAgVVJJOiBVUkksXG4gICAgbWFwOiBfbWFwLFxuICAgIGNvbXBhY3Q6IGNvbXBhY3QsXG4gICAgc2VwYXJhdGU6IHNlcGFyYXRlLFxuICAgIGZpbHRlcjogX2ZpbHRlcixcbiAgICBmaWx0ZXJNYXA6IF9maWx0ZXJNYXAsXG4gICAgcGFydGl0aW9uOiBfcGFydGl0aW9uLFxuICAgIHBhcnRpdGlvbk1hcDogX3BhcnRpdGlvbk1hcFxufTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuNy4wXG4gKi9cbmV4cG9ydCB2YXIgRmlsdGVyYWJsZVdpdGhJbmRleCA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICBtYXA6IF9tYXAsXG4gICAgbWFwV2l0aEluZGV4OiBfbWFwV2l0aEluZGV4LFxuICAgIGNvbXBhY3Q6IGNvbXBhY3QsXG4gICAgc2VwYXJhdGU6IHNlcGFyYXRlLFxuICAgIGZpbHRlcjogX2ZpbHRlcixcbiAgICBmaWx0ZXJNYXA6IF9maWx0ZXJNYXAsXG4gICAgcGFydGl0aW9uOiBfcGFydGl0aW9uLFxuICAgIHBhcnRpdGlvbk1hcDogX3BhcnRpdGlvbk1hcCxcbiAgICBwYXJ0aXRpb25NYXBXaXRoSW5kZXg6IF9wYXJ0aXRpb25NYXBXaXRoSW5kZXgsXG4gICAgcGFydGl0aW9uV2l0aEluZGV4OiBfcGFydGl0aW9uV2l0aEluZGV4LFxuICAgIGZpbHRlck1hcFdpdGhJbmRleDogX2ZpbHRlck1hcFdpdGhJbmRleCxcbiAgICBmaWx0ZXJXaXRoSW5kZXg6IF9maWx0ZXJXaXRoSW5kZXhcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjcuMFxuICovXG5leHBvcnQgdmFyIEZvbGRhYmxlID0ge1xuICAgIFVSSTogVVJJLFxuICAgIHJlZHVjZTogX3JlZHVjZSxcbiAgICBmb2xkTWFwOiBfZm9sZE1hcCxcbiAgICByZWR1Y2VSaWdodDogX3JlZHVjZVJpZ2h0XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi43LjBcbiAqL1xuZXhwb3J0IHZhciBGb2xkYWJsZVdpdGhJbmRleCA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICByZWR1Y2U6IF9yZWR1Y2UsXG4gICAgZm9sZE1hcDogX2ZvbGRNYXAsXG4gICAgcmVkdWNlUmlnaHQ6IF9yZWR1Y2VSaWdodCxcbiAgICByZWR1Y2VXaXRoSW5kZXg6IF9yZWR1Y2VXaXRoSW5kZXgsXG4gICAgZm9sZE1hcFdpdGhJbmRleDogX2ZvbGRNYXBXaXRoSW5kZXgsXG4gICAgcmVkdWNlUmlnaHRXaXRoSW5kZXg6IF9yZWR1Y2VSaWdodFdpdGhJbmRleFxufTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuNy4wXG4gKi9cbmV4cG9ydCB2YXIgVHJhdmVyc2FibGUgPSB7XG4gICAgVVJJOiBVUkksXG4gICAgbWFwOiBfbWFwLFxuICAgIHJlZHVjZTogX3JlZHVjZSxcbiAgICBmb2xkTWFwOiBfZm9sZE1hcCxcbiAgICByZWR1Y2VSaWdodDogX3JlZHVjZVJpZ2h0LFxuICAgIHRyYXZlcnNlOiBfdHJhdmVyc2UsXG4gICAgc2VxdWVuY2U6IHNlcXVlbmNlXG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi43LjBcbiAqL1xuZXhwb3J0IHZhciBUcmF2ZXJzYWJsZVdpdGhJbmRleCA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICBtYXA6IF9tYXAsXG4gICAgbWFwV2l0aEluZGV4OiBfbWFwV2l0aEluZGV4LFxuICAgIHJlZHVjZTogX3JlZHVjZSxcbiAgICBmb2xkTWFwOiBfZm9sZE1hcCxcbiAgICByZWR1Y2VSaWdodDogX3JlZHVjZVJpZ2h0LFxuICAgIHJlZHVjZVdpdGhJbmRleDogX3JlZHVjZVdpdGhJbmRleCxcbiAgICBmb2xkTWFwV2l0aEluZGV4OiBfZm9sZE1hcFdpdGhJbmRleCxcbiAgICByZWR1Y2VSaWdodFdpdGhJbmRleDogX3JlZHVjZVJpZ2h0V2l0aEluZGV4LFxuICAgIHRyYXZlcnNlOiBfdHJhdmVyc2UsXG4gICAgc2VxdWVuY2U6IHNlcXVlbmNlLFxuICAgIHRyYXZlcnNlV2l0aEluZGV4OiBfdHJhdmVyc2VXaXRoSW5kZXhcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBzZXF1ZW5jaW5nXG4gKiBAc2luY2UgMi4xMS4wXG4gKi9cbmV4cG9ydCB2YXIgY2hhaW5SZWNEZXB0aEZpcnN0ID0gZnVuY3Rpb24gKGYpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGEpIHtcbiAgICAgICAgdmFyIHRvZG8gPSBfX3NwcmVhZEFycmF5KFtdLCBmKGEpLCB0cnVlKTtcbiAgICAgICAgdmFyIG91dCA9IFtdO1xuICAgICAgICB3aGlsZSAodG9kby5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICB2YXIgZSA9IHRvZG8uc2hpZnQoKTtcbiAgICAgICAgICAgIGlmIChfLmlzTGVmdChlKSkge1xuICAgICAgICAgICAgICAgIHRvZG8udW5zaGlmdC5hcHBseSh0b2RvLCBmKGUubGVmdCkpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgb3V0LnB1c2goZS5yaWdodCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG91dDtcbiAgICB9O1xufTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIENoYWluUmVjRGVwdGhGaXJzdCA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICBtYXA6IF9tYXAsXG4gICAgYXA6IF9hcCxcbiAgICBjaGFpbjogZmxhdE1hcCxcbiAgICBjaGFpblJlYzogX2NoYWluUmVjRGVwdGhGaXJzdFxufTtcbi8qKlxuICogQGNhdGVnb3J5IHNlcXVlbmNpbmdcbiAqIEBzaW5jZSAyLjExLjBcbiAqL1xuZXhwb3J0IHZhciBjaGFpblJlY0JyZWFkdGhGaXJzdCA9IGZ1bmN0aW9uIChmKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhKSB7XG4gICAgICAgIHZhciBpbml0aWFsID0gZihhKTtcbiAgICAgICAgdmFyIHRvZG8gPSBbXTtcbiAgICAgICAgdmFyIG91dCA9IFtdO1xuICAgICAgICBmdW5jdGlvbiBnbyhlKSB7XG4gICAgICAgICAgICBpZiAoXy5pc0xlZnQoZSkpIHtcbiAgICAgICAgICAgICAgICBmKGUubGVmdCkuZm9yRWFjaChmdW5jdGlvbiAodikgeyByZXR1cm4gdG9kby5wdXNoKHYpOyB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIG91dC5wdXNoKGUucmlnaHQpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGZvciAodmFyIF9pID0gMCwgaW5pdGlhbF8xID0gaW5pdGlhbDsgX2kgPCBpbml0aWFsXzEubGVuZ3RoOyBfaSsrKSB7XG4gICAgICAgICAgICB2YXIgZSA9IGluaXRpYWxfMVtfaV07XG4gICAgICAgICAgICBnbyhlKTtcbiAgICAgICAgfVxuICAgICAgICB3aGlsZSAodG9kby5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICBnbyh0b2RvLnNoaWZ0KCkpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBvdXQ7XG4gICAgfTtcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjExLjBcbiAqL1xuZXhwb3J0IHZhciBDaGFpblJlY0JyZWFkdGhGaXJzdCA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICBtYXA6IF9tYXAsXG4gICAgYXA6IF9hcCxcbiAgICBjaGFpbjogZmxhdE1hcCxcbiAgICBjaGFpblJlYzogX2NoYWluUmVjQnJlYWR0aEZpcnN0XG59O1xudmFyIF93aXRoZXIgPSAvKiNfX1BVUkVfXyovIHdpdGhlckRlZmF1bHQoVHJhdmVyc2FibGUsIENvbXBhY3RhYmxlKTtcbnZhciBfd2lsdCA9IC8qI19fUFVSRV9fKi8gd2lsdERlZmF1bHQoVHJhdmVyc2FibGUsIENvbXBhY3RhYmxlKTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuNy4wXG4gKi9cbmV4cG9ydCB2YXIgV2l0aGVyYWJsZSA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICBtYXA6IF9tYXAsXG4gICAgY29tcGFjdDogY29tcGFjdCxcbiAgICBzZXBhcmF0ZTogc2VwYXJhdGUsXG4gICAgZmlsdGVyOiBfZmlsdGVyLFxuICAgIGZpbHRlck1hcDogX2ZpbHRlck1hcCxcbiAgICBwYXJ0aXRpb246IF9wYXJ0aXRpb24sXG4gICAgcGFydGl0aW9uTWFwOiBfcGFydGl0aW9uTWFwLFxuICAgIHJlZHVjZTogX3JlZHVjZSxcbiAgICBmb2xkTWFwOiBfZm9sZE1hcCxcbiAgICByZWR1Y2VSaWdodDogX3JlZHVjZVJpZ2h0LFxuICAgIHRyYXZlcnNlOiBfdHJhdmVyc2UsXG4gICAgc2VxdWVuY2U6IHNlcXVlbmNlLFxuICAgIHdpdGhlcjogX3dpdGhlcixcbiAgICB3aWx0OiBfd2lsdFxufTtcbi8qKlxuICogRmlsdGVyIHZhbHVlcyBpbnNpZGUgYSBjb250ZXh0LlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBwaXBlIH0gZnJvbSAnZnAtdHMvZnVuY3Rpb24nXG4gKiBpbXBvcnQgKiBhcyBSQSBmcm9tICdmcC10cy9SZWFkb25seUFycmF5J1xuICogaW1wb3J0ICogYXMgVCBmcm9tICdmcC10cy9UYXNrJ1xuICpcbiAqIGNvbnN0IGZpbHRlckUgPSBSQS5maWx0ZXJFKFQuQXBwbGljYXRpdmVQYXIpXG4gKiBhc3luYyBmdW5jdGlvbiB0ZXN0KCkge1xuICogICBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKFxuICogICAgIGF3YWl0IHBpcGUoXG4gKiAgICAgICBbLTEsIDIsIDNdLFxuICogICAgICAgZmlsdGVyRSgobikgPT4gVC5vZihuID4gMCkpXG4gKiAgICAgKSgpLFxuICogICAgIFsyLCAzXVxuICogICApXG4gKiB9XG4gKiB0ZXN0KClcbiAqXG4gKiBAc2luY2UgMi4xMS4wXG4gKi9cbmV4cG9ydCB2YXIgZmlsdGVyRSA9IC8qI19fUFVSRV9fKi8gZmlsdGVyRV8oV2l0aGVyYWJsZSk7XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjExLjBcbiAqL1xuZXhwb3J0IHZhciBGcm9tRWl0aGVyID0ge1xuICAgIFVSSTogVVJJLFxuICAgIGZyb21FaXRoZXI6IGZyb21FaXRoZXJcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBsaWZ0aW5nXG4gKiBAc2luY2UgMi4xMS4wXG4gKi9cbmV4cG9ydCB2YXIgZnJvbUVpdGhlcksgPSAvKiNfX1BVUkVfXyovIGZyb21FaXRoZXJLXyhGcm9tRWl0aGVyKTtcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8vIHVuc2FmZVxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLyoqXG4gKiBAY2F0ZWdvcnkgdW5zYWZlXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciB1bnNhZmVJbnNlcnRBdCA9IFJORUEudW5zYWZlSW5zZXJ0QXQ7XG4vKipcbiAqIEBjYXRlZ29yeSB1bnNhZmVcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIHVuc2FmZVVwZGF0ZUF0ID0gZnVuY3Rpb24gKGksIGEsIGFzKSB7XG4gICAgcmV0dXJuIGlzTm9uRW1wdHkoYXMpID8gUk5FQS51bnNhZmVVcGRhdGVBdChpLCBhLCBhcykgOiBhcztcbn07XG4vKipcbiAqIEBjYXRlZ29yeSB1bnNhZmVcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIHVuc2FmZURlbGV0ZUF0ID0gZnVuY3Rpb24gKGksIGFzKSB7XG4gICAgdmFyIHhzID0gYXMuc2xpY2UoKTtcbiAgICB4cy5zcGxpY2UoaSwgMSk7XG4gICAgcmV0dXJuIHhzO1xufTtcbi8qKlxuICogQGNhdGVnb3J5IGNvbnZlcnNpb25zXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciB0b0FycmF5ID0gZnVuY3Rpb24gKGFzKSB7IHJldHVybiBhcy5zbGljZSgpOyB9O1xuLyoqXG4gKiBAY2F0ZWdvcnkgY29udmVyc2lvbnNcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIGZyb21BcnJheSA9IGZ1bmN0aW9uIChhcykgeyByZXR1cm4gKGlzRW1wdHkoYXMpID8gZW1wdHkgOiBhcy5zbGljZSgpKTsgfTtcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8vIHV0aWxzXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vKipcbiAqIEFuIGVtcHR5IGFycmF5XG4gKlxuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgZW1wdHkgPSBSTkVBLmVtcHR5O1xuZXhwb3J0IGZ1bmN0aW9uIGV2ZXJ5KHByZWRpY2F0ZSkge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHsgcmV0dXJuIGFzLmV2ZXJ5KHByZWRpY2F0ZSk7IH07XG59XG4vKipcbiAqIENoZWNrIGlmIGEgcHJlZGljYXRlIGhvbGRzIHRydWUgZm9yIGFueSBhcnJheSBtZW1iZXIuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IHNvbWUgfSBmcm9tICdmcC10cy9SZWFkb25seUFycmF5J1xuICogaW1wb3J0IHsgcGlwZSB9IGZyb20gJ2ZwLXRzL2Z1bmN0aW9uJ1xuICpcbiAqIGNvbnN0IGlzUG9zaXRpdmUgPSAobjogbnVtYmVyKTogYm9vbGVhbiA9PiBuID4gMFxuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwocGlwZShbLTEsIC0yLCAzXSwgc29tZShpc1Bvc2l0aXZlKSksIHRydWUpXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKHBpcGUoWy0xLCAtMiwgLTNdLCBzb21lKGlzUG9zaXRpdmUpKSwgZmFsc2UpXG4gKlxuICogQHNpbmNlIDIuOS4wXG4gKi9cbmV4cG9ydCB2YXIgc29tZSA9IGZ1bmN0aW9uIChwcmVkaWNhdGUpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIHJldHVybiBhcy5zb21lKHByZWRpY2F0ZSk7XG4gICAgfTtcbn07XG4vKipcbiAqIEFsaWFzIG9mIFtgc29tZWBdKCNzb21lKVxuICpcbiAqIEBzaW5jZSAyLjExLjBcbiAqL1xuZXhwb3J0IHZhciBleGlzdHMgPSBzb21lO1xuLyoqXG4gKiBQbGFjZXMgYW4gZWxlbWVudCBpbiBiZXR3ZWVuIG1lbWJlcnMgb2YgYSBgUmVhZG9ubHlBcnJheWAsIHRoZW4gZm9sZHMgdGhlIHJlc3VsdHMgdXNpbmcgdGhlIHByb3ZpZGVkIGBNb25vaWRgLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgKiBhcyBTIGZyb20gJ2ZwLXRzL3N0cmluZydcbiAqIGltcG9ydCB7IGludGVyY2FsYXRlIH0gZnJvbSAnZnAtdHMvUmVhZG9ubHlBcnJheSdcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKGludGVyY2FsYXRlKFMuTW9ub2lkKSgnLScpKFsnYScsICdiJywgJ2MnXSksICdhLWItYycpXG4gKlxuICogQHNpbmNlIDIuMTIuMFxuICovXG5leHBvcnQgdmFyIGludGVyY2FsYXRlID0gZnVuY3Rpb24gKE0pIHtcbiAgICB2YXIgaW50ZXJjYWxhdGVNID0gUk5FQS5pbnRlcmNhbGF0ZShNKTtcbiAgICByZXR1cm4gZnVuY3Rpb24gKG1pZGRsZSkgeyByZXR1cm4gbWF0Y2goZnVuY3Rpb24gKCkgeyByZXR1cm4gTS5lbXB0eTsgfSwgaW50ZXJjYWxhdGVNKG1pZGRsZSkpOyB9O1xufTtcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8vIGRvIG5vdGF0aW9uXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vKipcbiAqIEBjYXRlZ29yeSBkbyBub3RhdGlvblxuICogQHNpbmNlIDIuOS4wXG4gKi9cbmV4cG9ydCB2YXIgRG8gPSAvKiNfX1BVUkVfXyovIG9mKF8uZW1wdHlSZWNvcmQpO1xuLyoqXG4gKiBAY2F0ZWdvcnkgZG8gbm90YXRpb25cbiAqIEBzaW5jZSAyLjguMFxuICovXG5leHBvcnQgdmFyIGJpbmRUbyA9IC8qI19fUFVSRV9fKi8gYmluZFRvXyhGdW5jdG9yKTtcbnZhciBsZXRfID0gLyojX19QVVJFX18qLyBsZXRfXyhGdW5jdG9yKTtcbmV4cG9ydCB7IFxuLyoqXG4gKiBAY2F0ZWdvcnkgZG8gbm90YXRpb25cbiAqIEBzaW5jZSAyLjEzLjBcbiAqL1xubGV0XyBhcyBsZXQgfTtcbi8qKlxuICogQGNhdGVnb3J5IGRvIG5vdGF0aW9uXG4gKiBAc2luY2UgMi44LjBcbiAqL1xuZXhwb3J0IHZhciBiaW5kID0gLyojX19QVVJFX18qLyBiaW5kXyhDaGFpbik7XG4vKipcbiAqIEBjYXRlZ29yeSBkbyBub3RhdGlvblxuICogQHNpbmNlIDIuOC4wXG4gKi9cbmV4cG9ydCB2YXIgYXBTID0gLyojX19QVVJFX18qLyBhcFNfKEFwcGx5KTtcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8vIGxlZ2FjeVxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLyoqXG4gKiBBbGlhcyBvZiBgZmxhdE1hcGAuXG4gKlxuICogQGNhdGVnb3J5IGxlZ2FjeVxuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgY2hhaW4gPSBmbGF0TWFwO1xuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLy8gZGVwcmVjYXRlZFxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLyoqXG4gKiBVc2UgYFJlYWRvbmx5Tm9uRW1wdHlBcnJheWAgbW9kdWxlIGluc3RlYWQuXG4gKlxuICogQGNhdGVnb3J5IHpvbmUgb2YgZGVhdGhcbiAqIEBzaW5jZSAyLjUuMFxuICogQGRlcHJlY2F0ZWRcbiAqL1xuZXhwb3J0IHZhciByYW5nZSA9IFJORUEucmFuZ2U7XG4vKipcbiAqIFVzZSBbYHByZXBlbmRgXSgjcHJlcGVuZCkgaW5zdGVhZC5cbiAqXG4gKiBAY2F0ZWdvcnkgem9uZSBvZiBkZWF0aFxuICogQHNpbmNlIDIuNS4wXG4gKiBAZGVwcmVjYXRlZFxuICovXG5leHBvcnQgdmFyIGNvbnMgPSBSTkVBLmNvbnM7XG4vKipcbiAqIFVzZSBbYGFwcGVuZGBdKCNhcHBlbmQpIGluc3RlYWQuXG4gKlxuICogQGNhdGVnb3J5IHpvbmUgb2YgZGVhdGhcbiAqIEBzaW5jZSAyLjUuMFxuICogQGRlcHJlY2F0ZWRcbiAqL1xuZXhwb3J0IHZhciBzbm9jID0gUk5FQS5zbm9jO1xuLyoqXG4gKiBVc2UgW2BwcmVwZW5kQWxsYF0oI3ByZXBlbmRhbGwpIGluc3RlYWQuXG4gKlxuICogQGNhdGVnb3J5IHpvbmUgb2YgZGVhdGhcbiAqIEBzaW5jZSAyLjkuMFxuICogQGRlcHJlY2F0ZWRcbiAqL1xuZXhwb3J0IHZhciBwcmVwZW5kVG9BbGwgPSBwcmVwZW5kQWxsO1xuLyoqXG4gKiBUaGlzIGluc3RhbmNlIGlzIGRlcHJlY2F0ZWQsIHVzZSBzbWFsbCwgc3BlY2lmaWMgaW5zdGFuY2VzIGluc3RlYWQuXG4gKiBGb3IgZXhhbXBsZSBpZiBhIGZ1bmN0aW9uIG5lZWRzIGEgYEZ1bmN0b3JgIGluc3RhbmNlLCBwYXNzIGBSQS5GdW5jdG9yYCBpbnN0ZWFkIG9mIGBSQS5yZWFkb25seUFycmF5YFxuICogKHdoZXJlIGBSQWAgaXMgZnJvbSBgaW1wb3J0IFJBIGZyb20gJ2ZwLXRzL1JlYWRvbmx5QXJyYXknYClcbiAqXG4gKiBAY2F0ZWdvcnkgem9uZSBvZiBkZWF0aFxuICogQHNpbmNlIDIuNS4wXG4gKiBAZGVwcmVjYXRlZFxuICovXG5leHBvcnQgdmFyIHJlYWRvbmx5QXJyYXkgPSB7XG4gICAgVVJJOiBVUkksXG4gICAgY29tcGFjdDogY29tcGFjdCxcbiAgICBzZXBhcmF0ZTogc2VwYXJhdGUsXG4gICAgbWFwOiBfbWFwLFxuICAgIGFwOiBfYXAsXG4gICAgb2Y6IG9mLFxuICAgIGNoYWluOiBmbGF0TWFwLFxuICAgIGZpbHRlcjogX2ZpbHRlcixcbiAgICBmaWx0ZXJNYXA6IF9maWx0ZXJNYXAsXG4gICAgcGFydGl0aW9uOiBfcGFydGl0aW9uLFxuICAgIHBhcnRpdGlvbk1hcDogX3BhcnRpdGlvbk1hcCxcbiAgICBtYXBXaXRoSW5kZXg6IF9tYXBXaXRoSW5kZXgsXG4gICAgcGFydGl0aW9uTWFwV2l0aEluZGV4OiBfcGFydGl0aW9uTWFwV2l0aEluZGV4LFxuICAgIHBhcnRpdGlvbldpdGhJbmRleDogX3BhcnRpdGlvbldpdGhJbmRleCxcbiAgICBmaWx0ZXJNYXBXaXRoSW5kZXg6IF9maWx0ZXJNYXBXaXRoSW5kZXgsXG4gICAgZmlsdGVyV2l0aEluZGV4OiBfZmlsdGVyV2l0aEluZGV4LFxuICAgIGFsdDogX2FsdCxcbiAgICB6ZXJvOiB6ZXJvLFxuICAgIHVuZm9sZDogdW5mb2xkLFxuICAgIHJlZHVjZTogX3JlZHVjZSxcbiAgICBmb2xkTWFwOiBfZm9sZE1hcCxcbiAgICByZWR1Y2VSaWdodDogX3JlZHVjZVJpZ2h0LFxuICAgIHRyYXZlcnNlOiBfdHJhdmVyc2UsXG4gICAgc2VxdWVuY2U6IHNlcXVlbmNlLFxuICAgIHJlZHVjZVdpdGhJbmRleDogX3JlZHVjZVdpdGhJbmRleCxcbiAgICBmb2xkTWFwV2l0aEluZGV4OiBfZm9sZE1hcFdpdGhJbmRleCxcbiAgICByZWR1Y2VSaWdodFdpdGhJbmRleDogX3JlZHVjZVJpZ2h0V2l0aEluZGV4LFxuICAgIHRyYXZlcnNlV2l0aEluZGV4OiBfdHJhdmVyc2VXaXRoSW5kZXgsXG4gICAgZXh0ZW5kOiBfZXh0ZW5kLFxuICAgIHdpdGhlcjogX3dpdGhlcixcbiAgICB3aWx0OiBfd2lsdFxufTtcbiIsCiAgInZhciBfX3NwcmVhZEFycmF5ID0gKHRoaXMgJiYgdGhpcy5fX3NwcmVhZEFycmF5KSB8fCBmdW5jdGlvbiAodG8sIGZyb20sIHBhY2spIHtcbiAgICBpZiAocGFjayB8fCBhcmd1bWVudHMubGVuZ3RoID09PSAyKSBmb3IgKHZhciBpID0gMCwgbCA9IGZyb20ubGVuZ3RoLCBhcjsgaSA8IGw7IGkrKykge1xuICAgICAgICBpZiAoYXIgfHwgIShpIGluIGZyb20pKSB7XG4gICAgICAgICAgICBpZiAoIWFyKSBhciA9IEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGZyb20sIDAsIGkpO1xuICAgICAgICAgICAgYXJbaV0gPSBmcm9tW2ldO1xuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiB0by5jb25jYXQoYXIgfHwgQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoZnJvbSkpO1xufTtcbmltcG9ydCB7IGFwRmlyc3QgYXMgYXBGaXJzdF8sIGFwUyBhcyBhcFNfLCBhcFNlY29uZCBhcyBhcFNlY29uZF8gfSBmcm9tICcuL0FwcGx5JztcbmltcG9ydCB7IGJpbmQgYXMgYmluZF8sIGNoYWluRmlyc3QgYXMgY2hhaW5GaXJzdF8gfSBmcm9tICcuL0NoYWluJztcbmltcG9ydCB7IGZyb21FcXVhbHMgfSBmcm9tICcuL0VxJztcbmltcG9ydCB7IGZyb21FaXRoZXJLIGFzIGZyb21FaXRoZXJLXyB9IGZyb20gJy4vRnJvbUVpdGhlcic7XG5pbXBvcnQgeyBkdWFsLCBpZGVudGl0eSwgcGlwZSB9IGZyb20gJy4vZnVuY3Rpb24nO1xuaW1wb3J0IHsgYmluZFRvIGFzIGJpbmRUb18sIGZsYXAgYXMgZmxhcF8sIGxldCBhcyBsZXRfXyB9IGZyb20gJy4vRnVuY3Rvcic7XG5pbXBvcnQgKiBhcyBfIGZyb20gJy4vaW50ZXJuYWwnO1xuaW1wb3J0ICogYXMgTiBmcm9tICcuL251bWJlcic7XG5pbXBvcnQgeyBmcm9tQ29tcGFyZSB9IGZyb20gJy4vT3JkJztcbmltcG9ydCAqIGFzIFJORUEgZnJvbSAnLi9SZWFkb25seU5vbkVtcHR5QXJyYXknO1xuaW1wb3J0IHsgc2VwYXJhdGVkIH0gZnJvbSAnLi9TZXBhcmF0ZWQnO1xuaW1wb3J0IHsgZmlsdGVyRSBhcyBmaWx0ZXJFXywgd2lsdERlZmF1bHQsIHdpdGhlckRlZmF1bHQgfSBmcm9tICcuL1dpdGhlcmFibGUnO1xuaW1wb3J0IHsgZ3VhcmQgYXMgZ3VhcmRfIH0gZnJvbSAnLi9aZXJvJztcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8vIHJlZmluZW1lbnRzXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vKipcbiAqIFRlc3Qgd2hldGhlciBhIGBSZWFkb25seUFycmF5YCBpcyBlbXB0eS5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgaXNFbXB0eSB9IGZyb20gJ2ZwLXRzL1JlYWRvbmx5QXJyYXknXG4gKlxuICogYXNzZXJ0LnN0cmljdEVxdWFsKGlzRW1wdHkoW10pLCB0cnVlKVxuICpcbiAqIEBjYXRlZ29yeSByZWZpbmVtZW50c1xuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgaXNFbXB0eSA9IGZ1bmN0aW9uIChhcykgeyByZXR1cm4gYXMubGVuZ3RoID09PSAwOyB9O1xuLyoqXG4gKiBUZXN0IHdoZXRoZXIgYSBgUmVhZG9ubHlBcnJheWAgaXMgbm9uIGVtcHR5LlxuICpcbiAqIEBjYXRlZ29yeSByZWZpbmVtZW50c1xuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgaXNOb25FbXB0eSA9IFJORUEuaXNOb25FbXB0eTtcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8vIGNvbnN0cnVjdG9yc1xuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLyoqXG4gKiBQcmVwZW5kIGFuIGVsZW1lbnQgdG8gdGhlIGZyb250IG9mIGEgYFJlYWRvbmx5QXJyYXlgLCBjcmVhdGluZyBhIG5ldyBgUmVhZG9ubHlOb25FbXB0eUFycmF5YC5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgcHJlcGVuZCB9IGZyb20gJ2ZwLXRzL1JlYWRvbmx5QXJyYXknXG4gKiBpbXBvcnQgeyBwaXBlIH0gZnJvbSAnZnAtdHMvZnVuY3Rpb24nXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChwaXBlKFsyLCAzLCA0XSwgcHJlcGVuZCgxKSksIFsxLCAyLCAzLCA0XSlcbiAqXG4gKiBAc2luY2UgMi4xMC4wXG4gKi9cbmV4cG9ydCB2YXIgcHJlcGVuZCA9IFJORUEucHJlcGVuZDtcbi8qKlxuICogTGVzcyBzdHJpY3QgdmVyc2lvbiBvZiBbYHByZXBlbmRgXSgjcHJlcGVuZCkuXG4gKlxuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIHByZXBlbmRXID0gUk5FQS5wcmVwZW5kVztcbi8qKlxuICogQXBwZW5kIGFuIGVsZW1lbnQgdG8gdGhlIGVuZCBvZiBhIGBSZWFkb25seUFycmF5YCwgY3JlYXRpbmcgYSBuZXcgYFJlYWRvbmx5Tm9uRW1wdHlBcnJheWAuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IGFwcGVuZCB9IGZyb20gJ2ZwLXRzL1JlYWRvbmx5QXJyYXknXG4gKiBpbXBvcnQgeyBwaXBlIH0gZnJvbSAnZnAtdHMvZnVuY3Rpb24nXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChwaXBlKFsxLCAyLCAzXSwgYXBwZW5kKDQpKSwgWzEsIDIsIDMsIDRdKVxuICpcbiAqIEBzaW5jZSAyLjEwLjBcbiAqL1xuZXhwb3J0IHZhciBhcHBlbmQgPSBSTkVBLmFwcGVuZDtcbi8qKlxuICogTGVzcyBzdHJpY3QgdmVyc2lvbiBvZiBbYGFwcGVuZGBdKCNhcHBlbmQpLlxuICpcbiAqIEBzaW5jZSAyLjExLjBcbiAqL1xuZXhwb3J0IHZhciBhcHBlbmRXID0gUk5FQS5hcHBlbmRXO1xuLyoqXG4gKiBSZXR1cm4gYSBgUmVhZG9ubHlBcnJheWAgb2YgbGVuZ3RoIGBuYCB3aXRoIGVsZW1lbnQgYGlgIGluaXRpYWxpemVkIHdpdGggYGYoaSlgLlxuICpcbiAqICoqTm90ZSoqLiBgbmAgaXMgbm9ybWFsaXplZCB0byBhIG5vbiBuZWdhdGl2ZSBpbnRlZ2VyLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBtYWtlQnkgfSBmcm9tICdmcC10cy9SZWFkb25seUFycmF5J1xuICpcbiAqIGNvbnN0IGRvdWJsZSA9IChuOiBudW1iZXIpOiBudW1iZXIgPT4gbiAqIDJcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwobWFrZUJ5KDUsIGRvdWJsZSksIFswLCAyLCA0LCA2LCA4XSlcbiAqXG4gKiBAY2F0ZWdvcnkgY29uc3RydWN0b3JzXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBtYWtlQnkgPSBmdW5jdGlvbiAobiwgZikgeyByZXR1cm4gKG4gPD0gMCA/IGVtcHR5IDogUk5FQS5tYWtlQnkoZikobikpOyB9O1xuLyoqXG4gKiBDcmVhdGUgYSBgUmVhZG9ubHlBcnJheWAgY29udGFpbmluZyBhIHZhbHVlIHJlcGVhdGVkIHRoZSBzcGVjaWZpZWQgbnVtYmVyIG9mIHRpbWVzLlxuICpcbiAqICoqTm90ZSoqLiBgbmAgaXMgbm9ybWFsaXplZCB0byBhIG5vbiBuZWdhdGl2ZSBpbnRlZ2VyLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyByZXBsaWNhdGUgfSBmcm9tICdmcC10cy9SZWFkb25seUFycmF5J1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwocmVwbGljYXRlKDMsICdhJyksIFsnYScsICdhJywgJ2EnXSlcbiAqXG4gKiBAY2F0ZWdvcnkgY29uc3RydWN0b3JzXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciByZXBsaWNhdGUgPSBmdW5jdGlvbiAobiwgYSkgeyByZXR1cm4gbWFrZUJ5KG4sIGZ1bmN0aW9uICgpIHsgcmV0dXJuIGE7IH0pOyB9O1xuZXhwb3J0IGZ1bmN0aW9uIGZyb21QcmVkaWNhdGUocHJlZGljYXRlKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhKSB7IHJldHVybiAocHJlZGljYXRlKGEpID8gW2FdIDogZW1wdHkpOyB9O1xufVxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLy8gY29udmVyc2lvbnNcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8qKlxuICogQGNhdGVnb3J5IGNvbnZlcnNpb25zXG4gKiBAc2luY2UgMi4xMS4wXG4gKi9cbmV4cG9ydCB2YXIgZnJvbU9wdGlvbiA9IGZ1bmN0aW9uIChtYSkgeyByZXR1cm4gKF8uaXNOb25lKG1hKSA/IGVtcHR5IDogW21hLnZhbHVlXSk7IH07XG4vKipcbiAqIFRyYW5zZm9ybXMgYW4gYEVpdGhlcmAgdG8gYSBgUmVhZG9ubHlBcnJheWAuXG4gKlxuICogQGNhdGVnb3J5IGNvbnZlcnNpb25zXG4gKiBAc2luY2UgMi4xMS4wXG4gKi9cbmV4cG9ydCB2YXIgZnJvbUVpdGhlciA9IGZ1bmN0aW9uIChlKSB7IHJldHVybiAoXy5pc0xlZnQoZSkgPyBlbXB0eSA6IFtlLnJpZ2h0XSk7IH07XG4vKipcbiAqIExlc3Mgc3RyaWN0IHZlcnNpb24gb2YgW2BtYXRjaGBdKCNtYXRjaCkuXG4gKlxuICogVGhlIGBXYCBzdWZmaXggKHNob3J0IGZvciAqKlcqKmlkZW5pbmcpIG1lYW5zIHRoYXQgdGhlIGhhbmRsZXIgcmV0dXJuIHR5cGVzIHdpbGwgYmUgbWVyZ2VkLlxuICpcbiAqIEBjYXRlZ29yeSBwYXR0ZXJuIG1hdGNoaW5nXG4gKiBAc2luY2UgMi4xMS4wXG4gKi9cbmV4cG9ydCB2YXIgbWF0Y2hXID0gZnVuY3Rpb24gKG9uRW1wdHksIG9uTm9uRW1wdHkpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIHJldHVybiBpc05vbkVtcHR5KGFzKSA/IG9uTm9uRW1wdHkoYXMpIDogb25FbXB0eSgpO1xuICAgIH07XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgcGF0dGVybiBtYXRjaGluZ1xuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIG1hdGNoID0gbWF0Y2hXO1xuLyoqXG4gKiBMZXNzIHN0cmljdCB2ZXJzaW9uIG9mIFtgbWF0Y2hMZWZ0YF0oI21hdGNobGVmdCkuXG4gKlxuICogQGNhdGVnb3J5IHBhdHRlcm4gbWF0Y2hpbmdcbiAqIEBzaW5jZSAyLjExLjBcbiAqL1xuZXhwb3J0IHZhciBtYXRjaExlZnRXID0gZnVuY3Rpb24gKG9uRW1wdHksIG9uTm9uRW1wdHkpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIHJldHVybiBpc05vbkVtcHR5KGFzKSA/IG9uTm9uRW1wdHkoUk5FQS5oZWFkKGFzKSwgUk5FQS50YWlsKGFzKSkgOiBvbkVtcHR5KCk7XG4gICAgfTtcbn07XG4vKipcbiAqIEJyZWFrIGEgYFJlYWRvbmx5QXJyYXlgIGludG8gaXRzIGZpcnN0IGVsZW1lbnQgYW5kIHJlbWFpbmluZyBlbGVtZW50cy5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgbWF0Y2hMZWZ0IH0gZnJvbSAnZnAtdHMvUmVhZG9ubHlBcnJheSdcbiAqXG4gKiBjb25zdCBsZW46IDxBPihhczogUmVhZG9ubHlBcnJheTxBPikgPT4gbnVtYmVyID0gbWF0Y2hMZWZ0KCgpID0+IDAsIChfLCB0YWlsKSA9PiAxICsgbGVuKHRhaWwpKVxuICogYXNzZXJ0LnN0cmljdEVxdWFsKGxlbihbMSwgMiwgM10pLCAzKVxuICpcbiAqIEBjYXRlZ29yeSBwYXR0ZXJuIG1hdGNoaW5nXG4gKiBAc2luY2UgMi4xMC4wXG4gKi9cbmV4cG9ydCB2YXIgbWF0Y2hMZWZ0ID0gbWF0Y2hMZWZ0Vztcbi8qKlxuICogQWxpYXMgb2YgW2BtYXRjaExlZnRgXSgjbWF0Y2hsZWZ0KS5cbiAqXG4gKiBAY2F0ZWdvcnkgcGF0dGVybiBtYXRjaGluZ1xuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgZm9sZExlZnQgPSBtYXRjaExlZnQ7XG4vKipcbiAqIExlc3Mgc3RyaWN0IHZlcnNpb24gb2YgW2BtYXRjaFJpZ2h0YF0oI21hdGNocmlnaHQpLlxuICpcbiAqIEBjYXRlZ29yeSBwYXR0ZXJuIG1hdGNoaW5nXG4gKiBAc2luY2UgMi4xMS4wXG4gKi9cbmV4cG9ydCB2YXIgbWF0Y2hSaWdodFcgPSBmdW5jdGlvbiAob25FbXB0eSwgb25Ob25FbXB0eSkge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgcmV0dXJuIGlzTm9uRW1wdHkoYXMpID8gb25Ob25FbXB0eShSTkVBLmluaXQoYXMpLCBSTkVBLmxhc3QoYXMpKSA6IG9uRW1wdHkoKTtcbiAgICB9O1xufTtcbi8qKlxuICogQnJlYWsgYSBgUmVhZG9ubHlBcnJheWAgaW50byBpdHMgaW5pdGlhbCBlbGVtZW50cyBhbmQgdGhlIGxhc3QgZWxlbWVudC5cbiAqXG4gKiBAY2F0ZWdvcnkgcGF0dGVybiBtYXRjaGluZ1xuICogQHNpbmNlIDIuMTAuMFxuICovXG5leHBvcnQgdmFyIG1hdGNoUmlnaHQgPSBtYXRjaFJpZ2h0Vztcbi8qKlxuICogQWxpYXMgb2YgW2BtYXRjaFJpZ2h0YF0oI21hdGNocmlnaHQpLlxuICpcbiAqIEBjYXRlZ29yeSBwYXR0ZXJuIG1hdGNoaW5nXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBmb2xkUmlnaHQgPSBtYXRjaFJpZ2h0O1xuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLy8gY29tYmluYXRvcnNcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8qKlxuICogQGNhdGVnb3J5IHNlcXVlbmNpbmdcbiAqIEBzaW5jZSAyLjcuMFxuICovXG5leHBvcnQgdmFyIGNoYWluV2l0aEluZGV4ID0gZnVuY3Rpb24gKGYpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIGlmIChpc0VtcHR5KGFzKSkge1xuICAgICAgICAgICAgcmV0dXJuIGVtcHR5O1xuICAgICAgICB9XG4gICAgICAgIHZhciBvdXQgPSBbXTtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBhcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgb3V0LnB1c2guYXBwbHkob3V0LCBmKGksIGFzW2ldKSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG91dDtcbiAgICB9O1xufTtcbi8qKlxuICogU2FtZSBhcyBgcmVkdWNlYCBidXQgaXQgY2FycmllcyBvdmVyIHRoZSBpbnRlcm1lZGlhdGUgc3RlcHMuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IHNjYW5MZWZ0IH0gZnJvbSAnZnAtdHMvUmVhZG9ubHlBcnJheSdcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKHNjYW5MZWZ0KDEwLCAoYiwgYTogbnVtYmVyKSA9PiBiIC0gYSkoWzEsIDIsIDNdKSwgWzEwLCA5LCA3LCA0XSlcbiAqXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBzY2FuTGVmdCA9IGZ1bmN0aW9uIChiLCBmKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykge1xuICAgICAgICB2YXIgbGVuID0gYXMubGVuZ3RoO1xuICAgICAgICB2YXIgb3V0ID0gbmV3IEFycmF5KGxlbiArIDEpO1xuICAgICAgICBvdXRbMF0gPSBiO1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGxlbjsgaSsrKSB7XG4gICAgICAgICAgICBvdXRbaSArIDFdID0gZihvdXRbaV0sIGFzW2ldKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gb3V0O1xuICAgIH07XG59O1xuLyoqXG4gKiBGb2xkIGFuIGFycmF5IGZyb20gdGhlIHJpZ2h0LCBrZWVwaW5nIGFsbCBpbnRlcm1lZGlhdGUgcmVzdWx0cyBpbnN0ZWFkIG9mIG9ubHkgdGhlIGZpbmFsIHJlc3VsdFxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBzY2FuUmlnaHQgfSBmcm9tICdmcC10cy9SZWFkb25seUFycmF5J1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoc2NhblJpZ2h0KDEwLCAoYTogbnVtYmVyLCBiKSA9PiBiIC0gYSkoWzEsIDIsIDNdKSwgWzQsIDUsIDcsIDEwXSlcbiAqXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBzY2FuUmlnaHQgPSBmdW5jdGlvbiAoYiwgZikge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgdmFyIGxlbiA9IGFzLmxlbmd0aDtcbiAgICAgICAgdmFyIG91dCA9IG5ldyBBcnJheShsZW4gKyAxKTtcbiAgICAgICAgb3V0W2xlbl0gPSBiO1xuICAgICAgICBmb3IgKHZhciBpID0gbGVuIC0gMTsgaSA+PSAwOyBpLS0pIHtcbiAgICAgICAgICAgIG91dFtpXSA9IGYoYXNbaV0sIG91dFtpICsgMV0pO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBvdXQ7XG4gICAgfTtcbn07XG4vKipcbiAqIENhbGN1bGF0ZSB0aGUgbnVtYmVyIG9mIGVsZW1lbnRzIGluIGEgYFJlYWRvbmx5QXJyYXlgLlxuICpcbiAqIEBzaW5jZSAyLjEwLjBcbiAqL1xuZXhwb3J0IHZhciBzaXplID0gZnVuY3Rpb24gKGFzKSB7IHJldHVybiBhcy5sZW5ndGg7IH07XG4vKipcbiAqIFRlc3Qgd2hldGhlciBhbiBhcnJheSBjb250YWlucyBhIHBhcnRpY3VsYXIgaW5kZXhcbiAqXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBpc091dE9mQm91bmQgPSBSTkVBLmlzT3V0T2ZCb3VuZDtcbmV4cG9ydCBmdW5jdGlvbiBsb29rdXAoaSwgYXMpIHtcbiAgICByZXR1cm4gYXMgPT09IHVuZGVmaW5lZCA/IGZ1bmN0aW9uIChhcykgeyByZXR1cm4gbG9va3VwKGksIGFzKTsgfSA6IGlzT3V0T2ZCb3VuZChpLCBhcykgPyBfLm5vbmUgOiBfLnNvbWUoYXNbaV0pO1xufVxuLyoqXG4gKiBHZXQgdGhlIGZpcnN0IGVsZW1lbnQgaW4gYW4gYXJyYXksIG9yIGBOb25lYCBpZiB0aGUgYXJyYXkgaXMgZW1wdHlcbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgaGVhZCB9IGZyb20gJ2ZwLXRzL1JlYWRvbmx5QXJyYXknXG4gKiBpbXBvcnQgeyBzb21lLCBub25lIH0gZnJvbSAnZnAtdHMvT3B0aW9uJ1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoaGVhZChbMSwgMiwgM10pLCBzb21lKDEpKVxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChoZWFkKFtdKSwgbm9uZSlcbiAqXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBoZWFkID0gZnVuY3Rpb24gKGFzKSB7IHJldHVybiAoaXNOb25FbXB0eShhcykgPyBfLnNvbWUoUk5FQS5oZWFkKGFzKSkgOiBfLm5vbmUpOyB9O1xuLyoqXG4gKiBHZXQgdGhlIGxhc3QgZWxlbWVudCBpbiBhbiBhcnJheSwgb3IgYE5vbmVgIGlmIHRoZSBhcnJheSBpcyBlbXB0eVxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBsYXN0IH0gZnJvbSAnZnAtdHMvUmVhZG9ubHlBcnJheSdcbiAqIGltcG9ydCB7IHNvbWUsIG5vbmUgfSBmcm9tICdmcC10cy9PcHRpb24nXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChsYXN0KFsxLCAyLCAzXSksIHNvbWUoMykpXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKGxhc3QoW10pLCBub25lKVxuICpcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIGxhc3QgPSBmdW5jdGlvbiAoYXMpIHsgcmV0dXJuIChpc05vbkVtcHR5KGFzKSA/IF8uc29tZShSTkVBLmxhc3QoYXMpKSA6IF8ubm9uZSk7IH07XG4vKipcbiAqIEdldCBhbGwgYnV0IHRoZSBmaXJzdCBlbGVtZW50IG9mIGFuIGFycmF5LCBjcmVhdGluZyBhIG5ldyBhcnJheSwgb3IgYE5vbmVgIGlmIHRoZSBhcnJheSBpcyBlbXB0eVxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyB0YWlsIH0gZnJvbSAnZnAtdHMvUmVhZG9ubHlBcnJheSdcbiAqIGltcG9ydCB7IHNvbWUsIG5vbmUgfSBmcm9tICdmcC10cy9PcHRpb24nXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbCh0YWlsKFsxLCAyLCAzXSksIHNvbWUoWzIsIDNdKSlcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwodGFpbChbXSksIG5vbmUpXG4gKlxuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgdGFpbCA9IGZ1bmN0aW9uIChhcykge1xuICAgIHJldHVybiBpc05vbkVtcHR5KGFzKSA/IF8uc29tZShSTkVBLnRhaWwoYXMpKSA6IF8ubm9uZTtcbn07XG4vKipcbiAqIEdldCBhbGwgYnV0IHRoZSBsYXN0IGVsZW1lbnQgb2YgYW4gYXJyYXksIGNyZWF0aW5nIGEgbmV3IGFycmF5LCBvciBgTm9uZWAgaWYgdGhlIGFycmF5IGlzIGVtcHR5XG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IGluaXQgfSBmcm9tICdmcC10cy9SZWFkb25seUFycmF5J1xuICogaW1wb3J0IHsgc29tZSwgbm9uZSB9IGZyb20gJ2ZwLXRzL09wdGlvbidcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKGluaXQoWzEsIDIsIDNdKSwgc29tZShbMSwgMl0pKVxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChpbml0KFtdKSwgbm9uZSlcbiAqXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBpbml0ID0gZnVuY3Rpb24gKGFzKSB7XG4gICAgcmV0dXJuIGlzTm9uRW1wdHkoYXMpID8gXy5zb21lKFJORUEuaW5pdChhcykpIDogXy5ub25lO1xufTtcbi8qKlxuICogS2VlcCBvbmx5IGEgbWF4IG51bWJlciBvZiBlbGVtZW50cyBmcm9tIHRoZSBzdGFydCBvZiBhbiBgUmVhZG9ubHlBcnJheWAsIGNyZWF0aW5nIGEgbmV3IGBSZWFkb25seUFycmF5YC5cbiAqXG4gKiAqKk5vdGUqKi4gYG5gIGlzIG5vcm1hbGl6ZWQgdG8gYSBub24gbmVnYXRpdmUgaW50ZWdlci5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0ICogYXMgUkEgZnJvbSAnZnAtdHMvUmVhZG9ubHlBcnJheSdcbiAqIGltcG9ydCB7IHBpcGUgfSBmcm9tICdmcC10cy9mdW5jdGlvbidcbiAqXG4gKiBjb25zdCBpbnB1dDogUmVhZG9ubHlBcnJheTxudW1iZXI+ID0gWzEsIDIsIDNdXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKHBpcGUoaW5wdXQsIFJBLnRha2VMZWZ0KDIpKSwgWzEsIDJdKVxuICpcbiAqIC8vIG91dCBvZiBib3VuZHNcbiAqIGFzc2VydC5zdHJpY3RFcXVhbChwaXBlKGlucHV0LCBSQS50YWtlTGVmdCg0KSksIGlucHV0KVxuICogYXNzZXJ0LnN0cmljdEVxdWFsKHBpcGUoaW5wdXQsIFJBLnRha2VMZWZ0KC0xKSksIGlucHV0KVxuICpcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIHRha2VMZWZ0ID0gZnVuY3Rpb24gKG4pIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIHJldHVybiBpc091dE9mQm91bmQobiwgYXMpID8gYXMgOiBuID09PSAwID8gZW1wdHkgOiBhcy5zbGljZSgwLCBuKTtcbiAgICB9O1xufTtcbi8qKlxuICogS2VlcCBvbmx5IGEgbWF4IG51bWJlciBvZiBlbGVtZW50cyBmcm9tIHRoZSBlbmQgb2YgYW4gYFJlYWRvbmx5QXJyYXlgLCBjcmVhdGluZyBhIG5ldyBgUmVhZG9ubHlBcnJheWAuXG4gKlxuICogKipOb3RlKiouIGBuYCBpcyBub3JtYWxpemVkIHRvIGEgbm9uIG5lZ2F0aXZlIGludGVnZXIuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCAqIGFzIFJBIGZyb20gJ2ZwLXRzL1JlYWRvbmx5QXJyYXknXG4gKiBpbXBvcnQgeyBwaXBlIH0gZnJvbSAnZnAtdHMvZnVuY3Rpb24nXG4gKlxuICogY29uc3QgaW5wdXQ6IFJlYWRvbmx5QXJyYXk8bnVtYmVyPiA9IFsxLCAyLCAzXVxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChwaXBlKGlucHV0LCBSQS50YWtlUmlnaHQoMikpLCBbMiwgM10pXG4gKlxuICogLy8gb3V0IG9mIGJvdW5kc1xuICogYXNzZXJ0LnN0cmljdEVxdWFsKHBpcGUoaW5wdXQsIFJBLnRha2VSaWdodCg0KSksIGlucHV0KVxuICogYXNzZXJ0LnN0cmljdEVxdWFsKHBpcGUoaW5wdXQsIFJBLnRha2VSaWdodCgtMSkpLCBpbnB1dClcbiAqXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciB0YWtlUmlnaHQgPSBmdW5jdGlvbiAobikge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgcmV0dXJuIGlzT3V0T2ZCb3VuZChuLCBhcykgPyBhcyA6IG4gPT09IDAgPyBlbXB0eSA6IGFzLnNsaWNlKC1uKTtcbiAgICB9O1xufTtcbmV4cG9ydCBmdW5jdGlvbiB0YWtlTGVmdFdoaWxlKHByZWRpY2F0ZSkge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgdmFyIG91dCA9IFtdO1xuICAgICAgICBmb3IgKHZhciBfaSA9IDAsIGFzXzEgPSBhczsgX2kgPCBhc18xLmxlbmd0aDsgX2krKykge1xuICAgICAgICAgICAgdmFyIGEgPSBhc18xW19pXTtcbiAgICAgICAgICAgIGlmICghcHJlZGljYXRlKGEpKSB7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBvdXQucHVzaChhKTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgbGVuID0gb3V0Lmxlbmd0aDtcbiAgICAgICAgcmV0dXJuIGxlbiA9PT0gYXMubGVuZ3RoID8gYXMgOiBsZW4gPT09IDAgPyBlbXB0eSA6IG91dDtcbiAgICB9O1xufVxudmFyIHNwYW5MZWZ0SW5kZXggPSBmdW5jdGlvbiAoYXMsIHByZWRpY2F0ZSkge1xuICAgIHZhciBsID0gYXMubGVuZ3RoO1xuICAgIHZhciBpID0gMDtcbiAgICBmb3IgKDsgaSA8IGw7IGkrKykge1xuICAgICAgICBpZiAoIXByZWRpY2F0ZShhc1tpXSkpIHtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiBpO1xufTtcbmV4cG9ydCBmdW5jdGlvbiBzcGFuTGVmdChwcmVkaWNhdGUpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIHZhciBfYSA9IHNwbGl0QXQoc3BhbkxlZnRJbmRleChhcywgcHJlZGljYXRlKSkoYXMpLCBpbml0ID0gX2FbMF0sIHJlc3QgPSBfYVsxXTtcbiAgICAgICAgcmV0dXJuIHsgaW5pdDogaW5pdCwgcmVzdDogcmVzdCB9O1xuICAgIH07XG59XG4vKipcbiAqIERyb3AgYSBtYXggbnVtYmVyIG9mIGVsZW1lbnRzIGZyb20gdGhlIHN0YXJ0IG9mIGFuIGBSZWFkb25seUFycmF5YCwgY3JlYXRpbmcgYSBuZXcgYFJlYWRvbmx5QXJyYXlgLlxuICpcbiAqICoqTm90ZSoqLiBgbmAgaXMgbm9ybWFsaXplZCB0byBhIG5vbiBuZWdhdGl2ZSBpbnRlZ2VyLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgKiBhcyBSQSBmcm9tICdmcC10cy9SZWFkb25seUFycmF5J1xuICogaW1wb3J0IHsgcGlwZSB9IGZyb20gJ2ZwLXRzL2Z1bmN0aW9uJ1xuICpcbiAqIGNvbnN0IGlucHV0OiBSZWFkb25seUFycmF5PG51bWJlcj4gPSBbMSwgMiwgM11cbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwocGlwZShpbnB1dCwgUkEuZHJvcExlZnQoMikpLCBbM10pXG4gKiBhc3NlcnQuc3RyaWN0RXF1YWwocGlwZShpbnB1dCwgUkEuZHJvcExlZnQoMCkpLCBpbnB1dClcbiAqIGFzc2VydC5zdHJpY3RFcXVhbChwaXBlKGlucHV0LCBSQS5kcm9wTGVmdCgtMSkpLCBpbnB1dClcbiAqXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBkcm9wTGVmdCA9IGZ1bmN0aW9uIChuKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykge1xuICAgICAgICByZXR1cm4gbiA8PSAwIHx8IGlzRW1wdHkoYXMpID8gYXMgOiBuID49IGFzLmxlbmd0aCA/IGVtcHR5IDogYXMuc2xpY2UobiwgYXMubGVuZ3RoKTtcbiAgICB9O1xufTtcbi8qKlxuICogRHJvcCBhIG1heCBudW1iZXIgb2YgZWxlbWVudHMgZnJvbSB0aGUgZW5kIG9mIGFuIGBSZWFkb25seUFycmF5YCwgY3JlYXRpbmcgYSBuZXcgYFJlYWRvbmx5QXJyYXlgLlxuICpcbiAqICoqTm90ZSoqLiBgbmAgaXMgbm9ybWFsaXplZCB0byBhIG5vbiBuZWdhdGl2ZSBpbnRlZ2VyLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgKiBhcyBSQSBmcm9tICdmcC10cy9SZWFkb25seUFycmF5J1xuICogaW1wb3J0IHsgcGlwZSB9IGZyb20gJ2ZwLXRzL2Z1bmN0aW9uJ1xuICpcbiAqIGNvbnN0IGlucHV0OiBSZWFkb25seUFycmF5PG51bWJlcj4gPSBbMSwgMiwgM11cbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwocGlwZShpbnB1dCwgUkEuZHJvcFJpZ2h0KDIpKSwgWzFdKVxuICogYXNzZXJ0LnN0cmljdEVxdWFsKHBpcGUoaW5wdXQsIFJBLmRyb3BSaWdodCgwKSksIGlucHV0KVxuICogYXNzZXJ0LnN0cmljdEVxdWFsKHBpcGUoaW5wdXQsIFJBLmRyb3BSaWdodCgtMSkpLCBpbnB1dClcbiAqXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBkcm9wUmlnaHQgPSBmdW5jdGlvbiAobikge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgcmV0dXJuIG4gPD0gMCB8fCBpc0VtcHR5KGFzKSA/IGFzIDogbiA+PSBhcy5sZW5ndGggPyBlbXB0eSA6IGFzLnNsaWNlKDAsIGFzLmxlbmd0aCAtIG4pO1xuICAgIH07XG59O1xuZXhwb3J0IGZ1bmN0aW9uIGRyb3BMZWZ0V2hpbGUocHJlZGljYXRlKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykge1xuICAgICAgICB2YXIgaSA9IHNwYW5MZWZ0SW5kZXgoYXMsIHByZWRpY2F0ZSk7XG4gICAgICAgIHJldHVybiBpID09PSAwID8gYXMgOiBpID09PSBhcy5sZW5ndGggPyBlbXB0eSA6IGFzLnNsaWNlKGkpO1xuICAgIH07XG59XG4vKipcbiAqIEZpbmQgdGhlIGZpcnN0IGluZGV4IGZvciB3aGljaCBhIHByZWRpY2F0ZSBob2xkc1xuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBmaW5kSW5kZXggfSBmcm9tICdmcC10cy9SZWFkb25seUFycmF5J1xuICogaW1wb3J0IHsgc29tZSwgbm9uZSB9IGZyb20gJ2ZwLXRzL09wdGlvbidcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKGZpbmRJbmRleCgobjogbnVtYmVyKSA9PiBuID09PSAyKShbMSwgMiwgM10pLCBzb21lKDEpKVxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChmaW5kSW5kZXgoKG46IG51bWJlcikgPT4gbiA9PT0gMikoW10pLCBub25lKVxuICpcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIGZpbmRJbmRleCA9IGZ1bmN0aW9uIChwcmVkaWNhdGUpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgYXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIGlmIChwcmVkaWNhdGUoYXNbaV0pKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIF8uc29tZShpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gXy5ub25lO1xuICAgIH07XG59O1xuZXhwb3J0IGZ1bmN0aW9uIGZpbmRGaXJzdChwcmVkaWNhdGUpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgYXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIGlmIChwcmVkaWNhdGUoYXNbaV0pKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIF8uc29tZShhc1tpXSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIF8ubm9uZTtcbiAgICB9O1xufVxuLyoqXG4gKiBGaW5kIHRoZSBmaXJzdCBlbGVtZW50IHJldHVybmVkIGJ5IGFuIG9wdGlvbiBiYXNlZCBzZWxlY3RvciBmdW5jdGlvblxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBmaW5kRmlyc3RNYXAgfSBmcm9tICdmcC10cy9SZWFkb25seUFycmF5J1xuICogaW1wb3J0IHsgc29tZSwgbm9uZSB9IGZyb20gJ2ZwLXRzL09wdGlvbidcbiAqXG4gKiBpbnRlcmZhY2UgUGVyc29uIHtcbiAqICAgcmVhZG9ubHkgbmFtZTogc3RyaW5nXG4gKiAgIHJlYWRvbmx5IGFnZT86IG51bWJlclxuICogfVxuICpcbiAqIGNvbnN0IHBlcnNvbnM6IFJlYWRvbmx5QXJyYXk8UGVyc29uPiA9IFt7IG5hbWU6ICdKb2huJyB9LCB7IG5hbWU6ICdNYXJ5JywgYWdlOiA0NSB9LCB7IG5hbWU6ICdKb2V5JywgYWdlOiAyOCB9XVxuICpcbiAqIC8vIHJldHVybnMgdGhlIG5hbWUgb2YgdGhlIGZpcnN0IHBlcnNvbiB0aGF0IGhhcyBhbiBhZ2VcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoZmluZEZpcnN0TWFwKChwOiBQZXJzb24pID0+IChwLmFnZSA9PT0gdW5kZWZpbmVkID8gbm9uZSA6IHNvbWUocC5uYW1lKSkpKHBlcnNvbnMpLCBzb21lKCdNYXJ5JykpXG4gKlxuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgZmluZEZpcnN0TWFwID0gZnVuY3Rpb24gKGYpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgYXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIHZhciBvdXQgPSBmKGFzW2ldKTtcbiAgICAgICAgICAgIGlmIChfLmlzU29tZShvdXQpKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG91dDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gXy5ub25lO1xuICAgIH07XG59O1xuZXhwb3J0IGZ1bmN0aW9uIGZpbmRMYXN0KHByZWRpY2F0ZSkge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgZm9yICh2YXIgaSA9IGFzLmxlbmd0aCAtIDE7IGkgPj0gMDsgaS0tKSB7XG4gICAgICAgICAgICBpZiAocHJlZGljYXRlKGFzW2ldKSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBfLnNvbWUoYXNbaV0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBfLm5vbmU7XG4gICAgfTtcbn1cbi8qKlxuICogRmluZCB0aGUgbGFzdCBlbGVtZW50IHJldHVybmVkIGJ5IGFuIG9wdGlvbiBiYXNlZCBzZWxlY3RvciBmdW5jdGlvblxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBmaW5kTGFzdE1hcCB9IGZyb20gJ2ZwLXRzL1JlYWRvbmx5QXJyYXknXG4gKiBpbXBvcnQgeyBzb21lLCBub25lIH0gZnJvbSAnZnAtdHMvT3B0aW9uJ1xuICpcbiAqIGludGVyZmFjZSBQZXJzb24ge1xuICogICByZWFkb25seSBuYW1lOiBzdHJpbmdcbiAqICAgcmVhZG9ubHkgYWdlPzogbnVtYmVyXG4gKiB9XG4gKlxuICogY29uc3QgcGVyc29uczogUmVhZG9ubHlBcnJheTxQZXJzb24+ID0gW3sgbmFtZTogJ0pvaG4nIH0sIHsgbmFtZTogJ01hcnknLCBhZ2U6IDQ1IH0sIHsgbmFtZTogJ0pvZXknLCBhZ2U6IDI4IH1dXG4gKlxuICogLy8gcmV0dXJucyB0aGUgbmFtZSBvZiB0aGUgbGFzdCBwZXJzb24gdGhhdCBoYXMgYW4gYWdlXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKGZpbmRMYXN0TWFwKChwOiBQZXJzb24pID0+IChwLmFnZSA9PT0gdW5kZWZpbmVkID8gbm9uZSA6IHNvbWUocC5uYW1lKSkpKHBlcnNvbnMpLCBzb21lKCdKb2V5JykpXG4gKlxuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgZmluZExhc3RNYXAgPSBmdW5jdGlvbiAoZikge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgZm9yICh2YXIgaSA9IGFzLmxlbmd0aCAtIDE7IGkgPj0gMDsgaS0tKSB7XG4gICAgICAgICAgICB2YXIgb3V0ID0gZihhc1tpXSk7XG4gICAgICAgICAgICBpZiAoXy5pc1NvbWUob3V0KSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBvdXQ7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIF8ubm9uZTtcbiAgICB9O1xufTtcbi8qKlxuICogUmV0dXJucyB0aGUgaW5kZXggb2YgdGhlIGxhc3QgZWxlbWVudCBvZiB0aGUgbGlzdCB3aGljaCBtYXRjaGVzIHRoZSBwcmVkaWNhdGVcbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgZmluZExhc3RJbmRleCB9IGZyb20gJ2ZwLXRzL1JlYWRvbmx5QXJyYXknXG4gKiBpbXBvcnQgeyBzb21lLCBub25lIH0gZnJvbSAnZnAtdHMvT3B0aW9uJ1xuICpcbiAqIGludGVyZmFjZSBYIHtcbiAqICAgcmVhZG9ubHkgYTogbnVtYmVyXG4gKiAgIHJlYWRvbmx5IGI6IG51bWJlclxuICogfVxuICogY29uc3QgeHM6IFJlYWRvbmx5QXJyYXk8WD4gPSBbeyBhOiAxLCBiOiAwIH0sIHsgYTogMSwgYjogMSB9XVxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChmaW5kTGFzdEluZGV4KCh4OiB7IHJlYWRvbmx5IGE6IG51bWJlciB9KSA9PiB4LmEgPT09IDEpKHhzKSwgc29tZSgxKSlcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoZmluZExhc3RJbmRleCgoeDogeyByZWFkb25seSBhOiBudW1iZXIgfSkgPT4geC5hID09PSA0KSh4cyksIG5vbmUpXG4gKlxuICpcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIGZpbmRMYXN0SW5kZXggPSBmdW5jdGlvbiAocHJlZGljYXRlKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykge1xuICAgICAgICBmb3IgKHZhciBpID0gYXMubGVuZ3RoIC0gMTsgaSA+PSAwOyBpLS0pIHtcbiAgICAgICAgICAgIGlmIChwcmVkaWNhdGUoYXNbaV0pKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIF8uc29tZShpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gXy5ub25lO1xuICAgIH07XG59O1xuLyoqXG4gKiBJbnNlcnQgYW4gZWxlbWVudCBhdCB0aGUgc3BlY2lmaWVkIGluZGV4LCBjcmVhdGluZyBhIG5ldyBhcnJheSwgb3IgcmV0dXJuaW5nIGBOb25lYCBpZiB0aGUgaW5kZXggaXMgb3V0IG9mIGJvdW5kc1xuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBpbnNlcnRBdCB9IGZyb20gJ2ZwLXRzL1JlYWRvbmx5QXJyYXknXG4gKiBpbXBvcnQgeyBzb21lIH0gZnJvbSAnZnAtdHMvT3B0aW9uJ1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoaW5zZXJ0QXQoMiwgNSkoWzEsIDIsIDMsIDRdKSwgc29tZShbMSwgMiwgNSwgMywgNF0pKVxuICpcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIGluc2VydEF0ID0gZnVuY3Rpb24gKGksIGEpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIHJldHVybiBpIDwgMCB8fCBpID4gYXMubGVuZ3RoID8gXy5ub25lIDogXy5zb21lKFJORUEudW5zYWZlSW5zZXJ0QXQoaSwgYSwgYXMpKTtcbiAgICB9O1xufTtcbi8qKlxuICogQ2hhbmdlIHRoZSBlbGVtZW50IGF0IHRoZSBzcGVjaWZpZWQgaW5kZXgsIGNyZWF0aW5nIGEgbmV3IGFycmF5LCBvciByZXR1cm5pbmcgYE5vbmVgIGlmIHRoZSBpbmRleCBpcyBvdXQgb2YgYm91bmRzXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IHVwZGF0ZUF0IH0gZnJvbSAnZnAtdHMvUmVhZG9ubHlBcnJheSdcbiAqIGltcG9ydCB7IHNvbWUsIG5vbmUgfSBmcm9tICdmcC10cy9PcHRpb24nXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbCh1cGRhdGVBdCgxLCAxKShbMSwgMiwgM10pLCBzb21lKFsxLCAxLCAzXSkpXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKHVwZGF0ZUF0KDEsIDEpKFtdKSwgbm9uZSlcbiAqXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciB1cGRhdGVBdCA9IGZ1bmN0aW9uIChpLCBhKSB7XG4gICAgcmV0dXJuIG1vZGlmeUF0KGksIGZ1bmN0aW9uICgpIHsgcmV0dXJuIGE7IH0pO1xufTtcbi8qKlxuICogRGVsZXRlIHRoZSBlbGVtZW50IGF0IHRoZSBzcGVjaWZpZWQgaW5kZXgsIGNyZWF0aW5nIGEgbmV3IGFycmF5LCBvciByZXR1cm5pbmcgYE5vbmVgIGlmIHRoZSBpbmRleCBpcyBvdXQgb2YgYm91bmRzXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IGRlbGV0ZUF0IH0gZnJvbSAnZnAtdHMvUmVhZG9ubHlBcnJheSdcbiAqIGltcG9ydCB7IHNvbWUsIG5vbmUgfSBmcm9tICdmcC10cy9PcHRpb24nXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChkZWxldGVBdCgwKShbMSwgMiwgM10pLCBzb21lKFsyLCAzXSkpXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKGRlbGV0ZUF0KDEpKFtdKSwgbm9uZSlcbiAqXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBkZWxldGVBdCA9IGZ1bmN0aW9uIChpKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykge1xuICAgICAgICByZXR1cm4gaXNPdXRPZkJvdW5kKGksIGFzKSA/IF8ubm9uZSA6IF8uc29tZSh1bnNhZmVEZWxldGVBdChpLCBhcykpO1xuICAgIH07XG59O1xuLyoqXG4gKiBBcHBseSBhIGZ1bmN0aW9uIHRvIHRoZSBlbGVtZW50IGF0IHRoZSBzcGVjaWZpZWQgaW5kZXgsIGNyZWF0aW5nIGEgbmV3IGFycmF5LCBvciByZXR1cm5pbmcgYE5vbmVgIGlmIHRoZSBpbmRleCBpcyBvdXRcbiAqIG9mIGJvdW5kc1xuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBtb2RpZnlBdCB9IGZyb20gJ2ZwLXRzL1JlYWRvbmx5QXJyYXknXG4gKiBpbXBvcnQgeyBzb21lLCBub25lIH0gZnJvbSAnZnAtdHMvT3B0aW9uJ1xuICpcbiAqIGNvbnN0IGRvdWJsZSA9ICh4OiBudW1iZXIpOiBudW1iZXIgPT4geCAqIDJcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwobW9kaWZ5QXQoMSwgZG91YmxlKShbMSwgMiwgM10pLCBzb21lKFsxLCA0LCAzXSkpXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKG1vZGlmeUF0KDEsIGRvdWJsZSkoW10pLCBub25lKVxuICpcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIG1vZGlmeUF0ID0gZnVuY3Rpb24gKGksIGYpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIHJldHVybiBpc091dE9mQm91bmQoaSwgYXMpID8gXy5ub25lIDogXy5zb21lKHVuc2FmZVVwZGF0ZUF0KGksIGYoYXNbaV0pLCBhcykpO1xuICAgIH07XG59O1xuLyoqXG4gKiBSZXZlcnNlIGFuIGFycmF5LCBjcmVhdGluZyBhIG5ldyBhcnJheVxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyByZXZlcnNlIH0gZnJvbSAnZnAtdHMvUmVhZG9ubHlBcnJheSdcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKHJldmVyc2UoWzEsIDIsIDNdKSwgWzMsIDIsIDFdKVxuICpcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIHJldmVyc2UgPSBmdW5jdGlvbiAoYXMpIHsgcmV0dXJuIChhcy5sZW5ndGggPD0gMSA/IGFzIDogYXMuc2xpY2UoKS5yZXZlcnNlKCkpOyB9O1xuLyoqXG4gKiBFeHRyYWN0cyBmcm9tIGFuIGFycmF5IG9mIGBFaXRoZXJgIGFsbCB0aGUgYFJpZ2h0YCBlbGVtZW50cy4gQWxsIHRoZSBgUmlnaHRgIGVsZW1lbnRzIGFyZSBleHRyYWN0ZWQgaW4gb3JkZXJcbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgcmlnaHRzIH0gZnJvbSAnZnAtdHMvUmVhZG9ubHlBcnJheSdcbiAqIGltcG9ydCB7IHJpZ2h0LCBsZWZ0IH0gZnJvbSAnZnAtdHMvRWl0aGVyJ1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwocmlnaHRzKFtyaWdodCgxKSwgbGVmdCgnZm9vJyksIHJpZ2h0KDIpXSksIFsxLCAyXSlcbiAqXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciByaWdodHMgPSBmdW5jdGlvbiAoYXMpIHtcbiAgICB2YXIgciA9IFtdO1xuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgYXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgdmFyIGEgPSBhc1tpXTtcbiAgICAgICAgaWYgKGEuX3RhZyA9PT0gJ1JpZ2h0Jykge1xuICAgICAgICAgICAgci5wdXNoKGEucmlnaHQpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiByO1xufTtcbi8qKlxuICogRXh0cmFjdHMgZnJvbSBhbiBhcnJheSBvZiBgRWl0aGVyYCBhbGwgdGhlIGBMZWZ0YCBlbGVtZW50cy4gQWxsIHRoZSBgTGVmdGAgZWxlbWVudHMgYXJlIGV4dHJhY3RlZCBpbiBvcmRlclxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBsZWZ0cyB9IGZyb20gJ2ZwLXRzL1JlYWRvbmx5QXJyYXknXG4gKiBpbXBvcnQgeyBsZWZ0LCByaWdodCB9IGZyb20gJ2ZwLXRzL0VpdGhlcidcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKGxlZnRzKFtyaWdodCgxKSwgbGVmdCgnZm9vJyksIHJpZ2h0KDIpXSksIFsnZm9vJ10pXG4gKlxuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgbGVmdHMgPSBmdW5jdGlvbiAoYXMpIHtcbiAgICB2YXIgciA9IFtdO1xuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgYXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgdmFyIGEgPSBhc1tpXTtcbiAgICAgICAgaWYgKGEuX3RhZyA9PT0gJ0xlZnQnKSB7XG4gICAgICAgICAgICByLnB1c2goYS5sZWZ0KTtcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gcjtcbn07XG4vKipcbiAqIFNvcnQgdGhlIGVsZW1lbnRzIG9mIGFuIGFycmF5IGluIGluY3JlYXNpbmcgb3JkZXIsIGNyZWF0aW5nIGEgbmV3IGFycmF5XG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IHNvcnQgfSBmcm9tICdmcC10cy9SZWFkb25seUFycmF5J1xuICogaW1wb3J0ICogYXMgTiBmcm9tICdmcC10cy9udW1iZXInXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChzb3J0KE4uT3JkKShbMywgMiwgMV0pLCBbMSwgMiwgM10pXG4gKlxuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgc29ydCA9IGZ1bmN0aW9uIChPKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykge1xuICAgICAgICByZXR1cm4gYXMubGVuZ3RoIDw9IDEgPyBhcyA6IGFzLnNsaWNlKCkuc29ydChPLmNvbXBhcmUpO1xuICAgIH07XG59O1xuLy8gVE9ETzogY3VycnkgYW5kIG1ha2UgZGF0YS1sYXN0IGluIHYzXG4vKipcbiAqIEFwcGx5IGEgZnVuY3Rpb24gdG8gcGFpcnMgb2YgZWxlbWVudHMgYXQgdGhlIHNhbWUgaW5kZXggaW4gdHdvIGFycmF5cywgY29sbGVjdGluZyB0aGUgcmVzdWx0cyBpbiBhIG5ldyBhcnJheS4gSWYgb25lXG4gKiBpbnB1dCBhcnJheSBpcyBzaG9ydCwgZXhjZXNzIGVsZW1lbnRzIG9mIHRoZSBsb25nZXIgYXJyYXkgYXJlIGRpc2NhcmRlZC5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgemlwV2l0aCB9IGZyb20gJ2ZwLXRzL1JlYWRvbmx5QXJyYXknXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbCh6aXBXaXRoKFsxLCAyLCAzXSwgWydhJywgJ2InLCAnYycsICdkJ10sIChuLCBzKSA9PiBzICsgbiksIFsnYTEnLCAnYjInLCAnYzMnXSlcbiAqXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciB6aXBXaXRoID0gZnVuY3Rpb24gKGZhLCBmYiwgZikge1xuICAgIHZhciBmYyA9IFtdO1xuICAgIHZhciBsZW4gPSBNYXRoLm1pbihmYS5sZW5ndGgsIGZiLmxlbmd0aCk7XG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBsZW47IGkrKykge1xuICAgICAgICBmY1tpXSA9IGYoZmFbaV0sIGZiW2ldKTtcbiAgICB9XG4gICAgcmV0dXJuIGZjO1xufTtcbmV4cG9ydCBmdW5jdGlvbiB6aXAoYXMsIGJzKSB7XG4gICAgaWYgKGJzID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIChicykgeyByZXR1cm4gemlwKGJzLCBhcyk7IH07XG4gICAgfVxuICAgIHJldHVybiB6aXBXaXRoKGFzLCBicywgZnVuY3Rpb24gKGEsIGIpIHsgcmV0dXJuIFthLCBiXTsgfSk7XG59XG4vKipcbiAqIFRoZSBmdW5jdGlvbiBpcyByZXZlcnNlIG9mIGB6aXBgLiBUYWtlcyBhbiBhcnJheSBvZiBwYWlycyBhbmQgcmV0dXJuIHR3byBjb3JyZXNwb25kaW5nIGFycmF5c1xuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyB1bnppcCB9IGZyb20gJ2ZwLXRzL1JlYWRvbmx5QXJyYXknXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbCh1bnppcChbWzEsICdhJ10sIFsyLCAnYiddLCBbMywgJ2MnXV0pLCBbWzEsIDIsIDNdLCBbJ2EnLCAnYicsICdjJ11dKVxuICpcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIHVuemlwID0gZnVuY3Rpb24gKGFzKSB7XG4gICAgdmFyIGZhID0gW107XG4gICAgdmFyIGZiID0gW107XG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBhcy5sZW5ndGg7IGkrKykge1xuICAgICAgICBmYVtpXSA9IGFzW2ldWzBdO1xuICAgICAgICBmYltpXSA9IGFzW2ldWzFdO1xuICAgIH1cbiAgICByZXR1cm4gW2ZhLCBmYl07XG59O1xuLyoqXG4gKiBQcmVwZW5kIGFuIGVsZW1lbnQgdG8gZXZlcnkgbWVtYmVyIG9mIGFuIGFycmF5XG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IHByZXBlbmRBbGwgfSBmcm9tICdmcC10cy9SZWFkb25seUFycmF5J1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwocHJlcGVuZEFsbCg5KShbMSwgMiwgMywgNF0pLCBbOSwgMSwgOSwgMiwgOSwgMywgOSwgNF0pXG4gKlxuICogQHNpbmNlIDIuMTAuMFxuICovXG5leHBvcnQgdmFyIHByZXBlbmRBbGwgPSBmdW5jdGlvbiAobWlkZGxlKSB7XG4gICAgdmFyIGYgPSBSTkVBLnByZXBlbmRBbGwobWlkZGxlKTtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7IHJldHVybiAoaXNOb25FbXB0eShhcykgPyBmKGFzKSA6IGFzKTsgfTtcbn07XG4vKipcbiAqIFBsYWNlcyBhbiBlbGVtZW50IGluIGJldHdlZW4gbWVtYmVycyBvZiBhbiBhcnJheVxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBpbnRlcnNwZXJzZSB9IGZyb20gJ2ZwLXRzL1JlYWRvbmx5QXJyYXknXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChpbnRlcnNwZXJzZSg5KShbMSwgMiwgMywgNF0pLCBbMSwgOSwgMiwgOSwgMywgOSwgNF0pXG4gKlxuICogQHNpbmNlIDIuOS4wXG4gKi9cbmV4cG9ydCB2YXIgaW50ZXJzcGVyc2UgPSBmdW5jdGlvbiAobWlkZGxlKSB7XG4gICAgdmFyIGYgPSBSTkVBLmludGVyc3BlcnNlKG1pZGRsZSk7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykgeyByZXR1cm4gKGlzTm9uRW1wdHkoYXMpID8gZihhcykgOiBhcyk7IH07XG59O1xuLyoqXG4gKiBSb3RhdGUgYSBgUmVhZG9ubHlBcnJheWAgYnkgYG5gIHN0ZXBzLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyByb3RhdGUgfSBmcm9tICdmcC10cy9SZWFkb25seUFycmF5J1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwocm90YXRlKDIpKFsxLCAyLCAzLCA0LCA1XSksIFs0LCA1LCAxLCAyLCAzXSlcbiAqXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciByb3RhdGUgPSBmdW5jdGlvbiAobikge1xuICAgIHZhciBmID0gUk5FQS5yb3RhdGUobik7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykgeyByZXR1cm4gKGlzTm9uRW1wdHkoYXMpID8gZihhcykgOiBhcyk7IH07XG59O1xuZXhwb3J0IGZ1bmN0aW9uIGVsZW0oRSkge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYSwgYXMpIHtcbiAgICAgICAgaWYgKGFzID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIHZhciBlbGVtRV8xID0gZWxlbShFKTtcbiAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHsgcmV0dXJuIGVsZW1FXzEoYSwgYXMpOyB9O1xuICAgICAgICB9XG4gICAgICAgIHZhciBwcmVkaWNhdGUgPSBmdW5jdGlvbiAoZWxlbWVudCkgeyByZXR1cm4gRS5lcXVhbHMoZWxlbWVudCwgYSk7IH07XG4gICAgICAgIHZhciBpID0gMDtcbiAgICAgICAgZm9yICg7IGkgPCBhcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgaWYgKHByZWRpY2F0ZShhc1tpXSkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfTtcbn1cbi8qKlxuICogUmVtb3ZlIGR1cGxpY2F0ZXMgZnJvbSBhbiBhcnJheSwga2VlcGluZyB0aGUgZmlyc3Qgb2NjdXJyZW5jZSBvZiBhbiBlbGVtZW50LlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyB1bmlxIH0gZnJvbSAnZnAtdHMvUmVhZG9ubHlBcnJheSdcbiAqIGltcG9ydCAqIGFzIE4gZnJvbSAnZnAtdHMvbnVtYmVyJ1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwodW5pcShOLkVxKShbMSwgMiwgMV0pLCBbMSwgMl0pXG4gKlxuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgdW5pcSA9IGZ1bmN0aW9uIChFKSB7XG4gICAgdmFyIGYgPSBSTkVBLnVuaXEoRSk7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykgeyByZXR1cm4gKGlzTm9uRW1wdHkoYXMpID8gZihhcykgOiBhcyk7IH07XG59O1xuLyoqXG4gKiBTb3J0IHRoZSBlbGVtZW50cyBvZiBhbiBhcnJheSBpbiBpbmNyZWFzaW5nIG9yZGVyLCB3aGVyZSBlbGVtZW50cyBhcmUgY29tcGFyZWQgdXNpbmcgZmlyc3QgYG9yZHNbMF1gLCB0aGVuIGBvcmRzWzFdYCxcbiAqIGV0Yy4uLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBzb3J0QnkgfSBmcm9tICdmcC10cy9SZWFkb25seUFycmF5J1xuICogaW1wb3J0IHsgY29udHJhbWFwIH0gZnJvbSAnZnAtdHMvT3JkJ1xuICogaW1wb3J0ICogYXMgUyBmcm9tICdmcC10cy9zdHJpbmcnXG4gKiBpbXBvcnQgKiBhcyBOIGZyb20gJ2ZwLXRzL251bWJlcidcbiAqIGltcG9ydCB7IHBpcGUgfSBmcm9tICdmcC10cy9mdW5jdGlvbidcbiAqXG4gKiBpbnRlcmZhY2UgUGVyc29uIHtcbiAqICAgcmVhZG9ubHkgbmFtZTogc3RyaW5nXG4gKiAgIHJlYWRvbmx5IGFnZTogbnVtYmVyXG4gKiB9XG4gKiBjb25zdCBieU5hbWUgPSBwaXBlKFMuT3JkLCBjb250cmFtYXAoKHA6IFBlcnNvbikgPT4gcC5uYW1lKSlcbiAqIGNvbnN0IGJ5QWdlID0gcGlwZShOLk9yZCwgY29udHJhbWFwKChwOiBQZXJzb24pID0+IHAuYWdlKSlcbiAqXG4gKiBjb25zdCBzb3J0QnlOYW1lQnlBZ2UgPSBzb3J0QnkoW2J5TmFtZSwgYnlBZ2VdKVxuICpcbiAqIGNvbnN0IHBlcnNvbnMgPSBbeyBuYW1lOiAnYScsIGFnZTogMSB9LCB7IG5hbWU6ICdiJywgYWdlOiAzIH0sIHsgbmFtZTogJ2MnLCBhZ2U6IDIgfSwgeyBuYW1lOiAnYicsIGFnZTogMiB9XVxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChzb3J0QnlOYW1lQnlBZ2UocGVyc29ucyksIFtcbiAqICAgeyBuYW1lOiAnYScsIGFnZTogMSB9LFxuICogICB7IG5hbWU6ICdiJywgYWdlOiAyIH0sXG4gKiAgIHsgbmFtZTogJ2InLCBhZ2U6IDMgfSxcbiAqICAgeyBuYW1lOiAnYycsIGFnZTogMiB9XG4gKiBdKVxuICpcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIHNvcnRCeSA9IGZ1bmN0aW9uIChvcmRzKSB7XG4gICAgdmFyIGYgPSBSTkVBLnNvcnRCeShvcmRzKTtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7IHJldHVybiAoaXNOb25FbXB0eShhcykgPyBmKGFzKSA6IGFzKTsgfTtcbn07XG4vKipcbiAqIEEgdXNlZnVsIHJlY3Vyc2lvbiBwYXR0ZXJuIGZvciBwcm9jZXNzaW5nIGEgYFJlYWRvbmx5QXJyYXlgIHRvIHByb2R1Y2UgYSBuZXcgYFJlYWRvbmx5QXJyYXlgLCBvZnRlbiB1c2VkIGZvciBcImNob3BwaW5nXCIgdXAgdGhlIGlucHV0XG4gKiBgUmVhZG9ubHlBcnJheWAuIFR5cGljYWxseSBgY2hvcGAgaXMgY2FsbGVkIHdpdGggc29tZSBmdW5jdGlvbiB0aGF0IHdpbGwgY29uc3VtZSBhbiBpbml0aWFsIHByZWZpeCBvZiB0aGUgYFJlYWRvbmx5QXJyYXlgIGFuZCBwcm9kdWNlIGFcbiAqIHZhbHVlIGFuZCB0aGUgdGFpbCBvZiB0aGUgYFJlYWRvbmx5QXJyYXlgLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBFcSB9IGZyb20gJ2ZwLXRzL0VxJ1xuICogaW1wb3J0ICogYXMgUkEgZnJvbSAnZnAtdHMvUmVhZG9ubHlBcnJheSdcbiAqIGltcG9ydCAqIGFzIE4gZnJvbSAnZnAtdHMvbnVtYmVyJ1xuICogaW1wb3J0IHsgcGlwZSB9IGZyb20gJ2ZwLXRzL2Z1bmN0aW9uJ1xuICpcbiAqIGNvbnN0IGdyb3VwID0gPEE+KFM6IEVxPEE+KTogKChhczogUmVhZG9ubHlBcnJheTxBPikgPT4gUmVhZG9ubHlBcnJheTxSZWFkb25seUFycmF5PEE+PikgPT4ge1xuICogICByZXR1cm4gUkEuY2hvcChhcyA9PiB7XG4gKiAgICAgY29uc3QgeyBpbml0LCByZXN0IH0gPSBwaXBlKGFzLCBSQS5zcGFuTGVmdCgoYTogQSkgPT4gUy5lcXVhbHMoYSwgYXNbMF0pKSlcbiAqICAgICByZXR1cm4gW2luaXQsIHJlc3RdXG4gKiAgIH0pXG4gKiB9XG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKGdyb3VwKE4uRXEpKFsxLCAxLCAyLCAzLCAzLCA0XSksIFtbMSwgMV0sIFsyXSwgWzMsIDNdLCBbNF1dKVxuICpcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIGNob3AgPSBmdW5jdGlvbiAoZikge1xuICAgIHZhciBnID0gUk5FQS5jaG9wKGYpO1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHsgcmV0dXJuIChpc05vbkVtcHR5KGFzKSA/IGcoYXMpIDogZW1wdHkpOyB9O1xufTtcbi8qKlxuICogU3BsaXRzIGEgYFJlYWRvbmx5QXJyYXlgIGludG8gdHdvIHBpZWNlcywgdGhlIGZpcnN0IHBpZWNlIGhhcyBtYXggYG5gIGVsZW1lbnRzLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBzcGxpdEF0IH0gZnJvbSAnZnAtdHMvUmVhZG9ubHlBcnJheSdcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKHNwbGl0QXQoMikoWzEsIDIsIDMsIDQsIDVdKSwgW1sxLCAyXSwgWzMsIDQsIDVdXSlcbiAqXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBzcGxpdEF0ID0gZnVuY3Rpb24gKG4pIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIHJldHVybiBuID49IDEgJiYgaXNOb25FbXB0eShhcykgPyBSTkVBLnNwbGl0QXQobikoYXMpIDogaXNFbXB0eShhcykgPyBbYXMsIGVtcHR5XSA6IFtlbXB0eSwgYXNdO1xuICAgIH07XG59O1xuLyoqXG4gKiBTcGxpdHMgYSBgUmVhZG9ubHlBcnJheWAgaW50byBsZW5ndGgtYG5gIHBpZWNlcy4gVGhlIGxhc3QgcGllY2Ugd2lsbCBiZSBzaG9ydGVyIGlmIGBuYCBkb2VzIG5vdCBldmVubHkgZGl2aWRlIHRoZSBsZW5ndGggb2ZcbiAqIHRoZSBgUmVhZG9ubHlBcnJheWAuIE5vdGUgdGhhdCBgY2h1bmtzT2YobikoW10pYCBpcyBgW11gLCBub3QgYFtbXV1gLiBUaGlzIGlzIGludGVudGlvbmFsLCBhbmQgaXMgY29uc2lzdGVudCB3aXRoIGEgcmVjdXJzaXZlXG4gKiBkZWZpbml0aW9uIG9mIGBjaHVua3NPZmA7IGl0IHNhdGlzZmllcyB0aGUgcHJvcGVydHkgdGhhdDpcbiAqXG4gKiBgYGB0c1xuICogY2h1bmtzT2YobikoeHMpLmNvbmNhdChjaHVua3NPZihuKSh5cykpID09IGNodW5rc09mKG4pKHhzLmNvbmNhdCh5cykpKVxuICogYGBgXG4gKlxuICogd2hlbmV2ZXIgYG5gIGV2ZW5seSBkaXZpZGVzIHRoZSBsZW5ndGggb2YgYGFzYC5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgY2h1bmtzT2YgfSBmcm9tICdmcC10cy9SZWFkb25seUFycmF5J1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoY2h1bmtzT2YoMikoWzEsIDIsIDMsIDQsIDVdKSwgW1sxLCAyXSwgWzMsIDRdLCBbNV1dKVxuICpcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIGNodW5rc09mID0gZnVuY3Rpb24gKG4pIHtcbiAgICB2YXIgZiA9IFJORUEuY2h1bmtzT2Yobik7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykgeyByZXR1cm4gKGlzTm9uRW1wdHkoYXMpID8gZihhcykgOiBlbXB0eSk7IH07XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgbGlmdGluZ1xuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIGZyb21PcHRpb25LID0gZnVuY3Rpb24gKGYpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgYSA9IFtdO1xuICAgICAgICBmb3IgKHZhciBfaSA9IDA7IF9pIDwgYXJndW1lbnRzLmxlbmd0aDsgX2krKykge1xuICAgICAgICAgICAgYVtfaV0gPSBhcmd1bWVudHNbX2ldO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBmcm9tT3B0aW9uKGYuYXBwbHkodm9pZCAwLCBhKSk7XG4gICAgfTtcbn07XG5leHBvcnQgZnVuY3Rpb24gY29tcHJlaGVuc2lvbihpbnB1dCwgZiwgZykge1xuICAgIGlmIChnID09PSB2b2lkIDApIHsgZyA9IGZ1bmN0aW9uICgpIHsgcmV0dXJuIHRydWU7IH07IH1cbiAgICB2YXIgZ28gPSBmdW5jdGlvbiAoc2NvcGUsIGlucHV0KSB7XG4gICAgICAgIHJldHVybiBpc05vbkVtcHR5KGlucHV0KVxuICAgICAgICAgICAgPyBmbGF0TWFwKFJORUEuaGVhZChpbnB1dCksIGZ1bmN0aW9uIChhKSB7IHJldHVybiBnbyhwaXBlKHNjb3BlLCBhcHBlbmQoYSkpLCBSTkVBLnRhaWwoaW5wdXQpKTsgfSlcbiAgICAgICAgICAgIDogZy5hcHBseSh2b2lkIDAsIHNjb3BlKSA/IFtmLmFwcGx5KHZvaWQgMCwgc2NvcGUpXVxuICAgICAgICAgICAgICAgIDogZW1wdHk7XG4gICAgfTtcbiAgICByZXR1cm4gZ28oZW1wdHksIGlucHV0KTtcbn1cbi8qKlxuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIGNvbmNhdFcgPSBmdW5jdGlvbiAoc2Vjb25kKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChmaXJzdCkge1xuICAgICAgICByZXR1cm4gaXNFbXB0eShmaXJzdCkgPyBzZWNvbmQgOiBpc0VtcHR5KHNlY29uZCkgPyBmaXJzdCA6IGZpcnN0LmNvbmNhdChzZWNvbmQpO1xuICAgIH07XG59O1xuLyoqXG4gKiBAc2luY2UgMi4xMS4wXG4gKi9cbmV4cG9ydCB2YXIgY29uY2F0ID0gY29uY2F0VztcbmV4cG9ydCBmdW5jdGlvbiB1bmlvbihFKSB7XG4gICAgdmFyIHVuaW9uRSA9IFJORUEudW5pb24oRSk7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChmaXJzdCwgc2Vjb25kKSB7XG4gICAgICAgIGlmIChzZWNvbmQgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgdmFyIHVuaW9uRV8xID0gdW5pb24oRSk7XG4gICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24gKHNlY29uZCkgeyByZXR1cm4gdW5pb25FXzEoc2Vjb25kLCBmaXJzdCk7IH07XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGlzTm9uRW1wdHkoZmlyc3QpICYmIGlzTm9uRW1wdHkoc2Vjb25kKSA/IHVuaW9uRShzZWNvbmQpKGZpcnN0KSA6IGlzTm9uRW1wdHkoZmlyc3QpID8gZmlyc3QgOiBzZWNvbmQ7XG4gICAgfTtcbn1cbmV4cG9ydCBmdW5jdGlvbiBpbnRlcnNlY3Rpb24oRSkge1xuICAgIHZhciBlbGVtRSA9IGVsZW0oRSk7XG4gICAgcmV0dXJuIGZ1bmN0aW9uICh4cywgeXMpIHtcbiAgICAgICAgaWYgKHlzID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIHZhciBpbnRlcnNlY3Rpb25FXzEgPSBpbnRlcnNlY3Rpb24oRSk7XG4gICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24gKHlzKSB7IHJldHVybiBpbnRlcnNlY3Rpb25FXzEoeXMsIHhzKTsgfTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4geHMuZmlsdGVyKGZ1bmN0aW9uIChhKSB7IHJldHVybiBlbGVtRShhLCB5cyk7IH0pO1xuICAgIH07XG59XG5leHBvcnQgZnVuY3Rpb24gZGlmZmVyZW5jZShFKSB7XG4gICAgdmFyIGVsZW1FID0gZWxlbShFKTtcbiAgICByZXR1cm4gZnVuY3Rpb24gKHhzLCB5cykge1xuICAgICAgICBpZiAoeXMgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgdmFyIGRpZmZlcmVuY2VFXzEgPSBkaWZmZXJlbmNlKEUpO1xuICAgICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uICh5cykgeyByZXR1cm4gZGlmZmVyZW5jZUVfMSh5cywgeHMpOyB9O1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB4cy5maWx0ZXIoZnVuY3Rpb24gKGEpIHsgcmV0dXJuICFlbGVtRShhLCB5cyk7IH0pO1xuICAgIH07XG59XG52YXIgX21hcCA9IGZ1bmN0aW9uIChmYSwgZikgeyByZXR1cm4gcGlwZShmYSwgbWFwKGYpKTsgfTtcbnZhciBfbWFwV2l0aEluZGV4ID0gZnVuY3Rpb24gKGZhLCBmKSB7IHJldHVybiBwaXBlKGZhLCBtYXBXaXRoSW5kZXgoZikpOyB9O1xudmFyIF9hcCA9IGZ1bmN0aW9uIChmYWIsIGZhKSB7IHJldHVybiBwaXBlKGZhYiwgYXAoZmEpKTsgfTtcbnZhciBfZmlsdGVyID0gZnVuY3Rpb24gKGZhLCBwcmVkaWNhdGUpIHtcbiAgICByZXR1cm4gcGlwZShmYSwgZmlsdGVyKHByZWRpY2F0ZSkpO1xufTtcbnZhciBfZmlsdGVyTWFwID0gZnVuY3Rpb24gKGZhLCBmKSB7IHJldHVybiBwaXBlKGZhLCBmaWx0ZXJNYXAoZikpOyB9O1xudmFyIF9wYXJ0aXRpb24gPSBmdW5jdGlvbiAoZmEsIHByZWRpY2F0ZSkge1xuICAgIHJldHVybiBwaXBlKGZhLCBwYXJ0aXRpb24ocHJlZGljYXRlKSk7XG59O1xudmFyIF9wYXJ0aXRpb25NYXAgPSBmdW5jdGlvbiAoZmEsIGYpIHsgcmV0dXJuIHBpcGUoZmEsIHBhcnRpdGlvbk1hcChmKSk7IH07XG52YXIgX3BhcnRpdGlvbldpdGhJbmRleCA9IGZ1bmN0aW9uIChmYSwgcHJlZGljYXRlV2l0aEluZGV4KSB7IHJldHVybiBwaXBlKGZhLCBwYXJ0aXRpb25XaXRoSW5kZXgocHJlZGljYXRlV2l0aEluZGV4KSk7IH07XG52YXIgX3BhcnRpdGlvbk1hcFdpdGhJbmRleCA9IGZ1bmN0aW9uIChmYSwgZikgeyByZXR1cm4gcGlwZShmYSwgcGFydGl0aW9uTWFwV2l0aEluZGV4KGYpKTsgfTtcbnZhciBfYWx0ID0gZnVuY3Rpb24gKGZhLCB0aGF0KSB7IHJldHVybiBwaXBlKGZhLCBhbHQodGhhdCkpOyB9O1xudmFyIF9yZWR1Y2UgPSBmdW5jdGlvbiAoZmEsIGIsIGYpIHsgcmV0dXJuIHBpcGUoZmEsIHJlZHVjZShiLCBmKSk7IH07XG52YXIgX2ZvbGRNYXAgPSBmdW5jdGlvbiAoTSkge1xuICAgIHZhciBmb2xkTWFwTSA9IGZvbGRNYXAoTSk7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChmYSwgZikgeyByZXR1cm4gcGlwZShmYSwgZm9sZE1hcE0oZikpOyB9O1xufTtcbnZhciBfcmVkdWNlUmlnaHQgPSBmdW5jdGlvbiAoZmEsIGIsIGYpIHsgcmV0dXJuIHBpcGUoZmEsIHJlZHVjZVJpZ2h0KGIsIGYpKTsgfTtcbnZhciBfcmVkdWNlV2l0aEluZGV4ID0gZnVuY3Rpb24gKGZhLCBiLCBmKSB7XG4gICAgcmV0dXJuIHBpcGUoZmEsIHJlZHVjZVdpdGhJbmRleChiLCBmKSk7XG59O1xudmFyIF9mb2xkTWFwV2l0aEluZGV4ID0gZnVuY3Rpb24gKE0pIHtcbiAgICB2YXIgZm9sZE1hcFdpdGhJbmRleE0gPSBmb2xkTWFwV2l0aEluZGV4KE0pO1xuICAgIHJldHVybiBmdW5jdGlvbiAoZmEsIGYpIHsgcmV0dXJuIHBpcGUoZmEsIGZvbGRNYXBXaXRoSW5kZXhNKGYpKTsgfTtcbn07XG52YXIgX3JlZHVjZVJpZ2h0V2l0aEluZGV4ID0gZnVuY3Rpb24gKGZhLCBiLCBmKSB7XG4gICAgcmV0dXJuIHBpcGUoZmEsIHJlZHVjZVJpZ2h0V2l0aEluZGV4KGIsIGYpKTtcbn07XG52YXIgX2ZpbHRlck1hcFdpdGhJbmRleCA9IGZ1bmN0aW9uIChmYSwgZikgeyByZXR1cm4gcGlwZShmYSwgZmlsdGVyTWFwV2l0aEluZGV4KGYpKTsgfTtcbnZhciBfZmlsdGVyV2l0aEluZGV4ID0gZnVuY3Rpb24gKGZhLCBwcmVkaWNhdGVXaXRoSW5kZXgpIHsgcmV0dXJuIHBpcGUoZmEsIGZpbHRlcldpdGhJbmRleChwcmVkaWNhdGVXaXRoSW5kZXgpKTsgfTtcbnZhciBfZXh0ZW5kID0gZnVuY3Rpb24gKGZhLCBmKSB7IHJldHVybiBwaXBlKGZhLCBleHRlbmQoZikpOyB9O1xudmFyIF90cmF2ZXJzZSA9IGZ1bmN0aW9uIChGKSB7XG4gICAgdmFyIHRyYXZlcnNlRiA9IHRyYXZlcnNlKEYpO1xuICAgIHJldHVybiBmdW5jdGlvbiAodGEsIGYpIHsgcmV0dXJuIHBpcGUodGEsIHRyYXZlcnNlRihmKSk7IH07XG59O1xuLyogaXN0YW5idWwgaWdub3JlIG5leHQgKi9cbnZhciBfdHJhdmVyc2VXaXRoSW5kZXggPSBmdW5jdGlvbiAoRikge1xuICAgIHZhciB0cmF2ZXJzZVdpdGhJbmRleEYgPSB0cmF2ZXJzZVdpdGhJbmRleChGKTtcbiAgICByZXR1cm4gZnVuY3Rpb24gKHRhLCBmKSB7IHJldHVybiBwaXBlKHRhLCB0cmF2ZXJzZVdpdGhJbmRleEYoZikpOyB9O1xufTtcbi8qKiBAaW50ZXJuYWwgKi9cbmV4cG9ydCB2YXIgX2NoYWluUmVjRGVwdGhGaXJzdCA9IGZ1bmN0aW9uIChhLCBmKSB7IHJldHVybiBwaXBlKGEsIGNoYWluUmVjRGVwdGhGaXJzdChmKSk7IH07XG4vKiogQGludGVybmFsICovXG5leHBvcnQgdmFyIF9jaGFpblJlY0JyZWFkdGhGaXJzdCA9IGZ1bmN0aW9uIChhLCBmKSB7IHJldHVybiBwaXBlKGEsIGNoYWluUmVjQnJlYWR0aEZpcnN0KGYpKTsgfTtcbi8qKlxuICogQGNhdGVnb3J5IGNvbnN0cnVjdG9yc1xuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgb2YgPSBSTkVBLm9mO1xuLyoqXG4gKiBAc2luY2UgMi43LjBcbiAqL1xuZXhwb3J0IHZhciB6ZXJvID0gZnVuY3Rpb24gKCkgeyByZXR1cm4gZW1wdHk7IH07XG4vKipcbiAqIExlc3Mgc3RyaWN0IHZlcnNpb24gb2YgW2BhbHRgXSgjYWx0KS5cbiAqXG4gKiBUaGUgYFdgIHN1ZmZpeCAoc2hvcnQgZm9yICoqVyoqaWRlbmluZykgbWVhbnMgdGhhdCB0aGUgcmV0dXJuIHR5cGVzIHdpbGwgYmUgbWVyZ2VkLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgKiBhcyBSQSBmcm9tICdmcC10cy9SZWFkb25seUFycmF5J1xuICogaW1wb3J0IHsgcGlwZSB9IGZyb20gJ2ZwLXRzL2Z1bmN0aW9uJ1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoXG4gKiAgIHBpcGUoXG4gKiAgICAgWzEsIDIsIDNdLFxuICogICAgIFJBLmFsdFcoKCkgPT4gWydhJywgJ2InXSlcbiAqICAgKSxcbiAqICAgWzEsIDIsIDMsICdhJywgJ2InXVxuICogKVxuICpcbiAqIEBjYXRlZ29yeSBlcnJvciBoYW5kbGluZ1xuICogQHNpbmNlIDIuOS4wXG4gKi9cbmV4cG9ydCB2YXIgYWx0VyA9IGZ1bmN0aW9uICh0aGF0KSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChmYSkge1xuICAgICAgICByZXR1cm4gZmEuY29uY2F0KHRoYXQoKSk7XG4gICAgfTtcbn07XG4vKipcbiAqIElkZW50aWZpZXMgYW4gYXNzb2NpYXRpdmUgb3BlcmF0aW9uIG9uIGEgdHlwZSBjb25zdHJ1Y3Rvci4gSXQgaXMgc2ltaWxhciB0byBgU2VtaWdyb3VwYCwgZXhjZXB0IHRoYXQgaXQgYXBwbGllcyB0b1xuICogdHlwZXMgb2Yga2luZCBgKiAtPiAqYC5cbiAqXG4gKiBJbiBjYXNlIG9mIGBSZWFkb25seUFycmF5YCBjb25jYXRlbmF0ZXMgdGhlIGlucHV0cyBpbnRvIGEgc2luZ2xlIGFycmF5LlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgKiBhcyBSQSBmcm9tICdmcC10cy9SZWFkb25seUFycmF5J1xuICogaW1wb3J0IHsgcGlwZSB9IGZyb20gJ2ZwLXRzL2Z1bmN0aW9uJ1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoXG4gKiAgIHBpcGUoXG4gKiAgICAgWzEsIDIsIDNdLFxuICogICAgIFJBLmFsdCgoKSA9PiBbNCwgNV0pXG4gKiAgICksXG4gKiAgIFsxLCAyLCAzLCA0LCA1XVxuICogKVxuICpcbiAqIEBjYXRlZ29yeSBlcnJvciBoYW5kbGluZ1xuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgYWx0ID0gYWx0Vztcbi8qKlxuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgYXAgPSBmdW5jdGlvbiAoZmEpIHtcbiAgICByZXR1cm4gZmxhdE1hcChmdW5jdGlvbiAoZikgeyByZXR1cm4gcGlwZShmYSwgbWFwKGYpKTsgfSk7XG59O1xuLyoqXG4gKiBDb21wb3NlcyBjb21wdXRhdGlvbnMgaW4gc2VxdWVuY2UsIHVzaW5nIHRoZSByZXR1cm4gdmFsdWUgb2Ygb25lIGNvbXB1dGF0aW9uIHRvIGRldGVybWluZSB0aGUgbmV4dCBjb21wdXRhdGlvbi5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0ICogYXMgUkEgZnJvbSAnZnAtdHMvUmVhZG9ubHlBcnJheSdcbiAqIGltcG9ydCB7IHBpcGUgfSBmcm9tICdmcC10cy9mdW5jdGlvbidcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKFxuICogICBwaXBlKFxuICogICAgIFsxLCAyLCAzXSxcbiAqICAgICBSQS5mbGF0TWFwKChuKSA9PiBbYGEke259YCwgYGIke259YF0pXG4gKiAgICksXG4gKiAgIFsnYTEnLCAnYjEnLCAnYTInLCAnYjInLCAnYTMnLCAnYjMnXVxuICogKVxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChcbiAqICAgcGlwZShcbiAqICAgICBbMSwgMiwgM10sXG4gKiAgICAgUkEuZmxhdE1hcCgoKSA9PiBbXSlcbiAqICAgKSxcbiAqICAgW11cbiAqIClcbiAqXG4gKiBAY2F0ZWdvcnkgc2VxdWVuY2luZ1xuICogQHNpbmNlIDIuMTQuMFxuICovXG5leHBvcnQgdmFyIGZsYXRNYXAgPSAvKiNfX1BVUkVfXyovIGR1YWwoMiwgZnVuY3Rpb24gKG1hLCBmKSB7XG4gICAgcmV0dXJuIHBpcGUobWEsIGNoYWluV2l0aEluZGV4KGZ1bmN0aW9uIChpLCBhKSB7IHJldHVybiBmKGEsIGkpOyB9KSk7XG59KTtcbi8qKlxuICogQGNhdGVnb3J5IHNlcXVlbmNpbmdcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIGZsYXR0ZW4gPSAvKiNfX1BVUkVfXyovIGZsYXRNYXAoaWRlbnRpdHkpO1xuLyoqXG4gKiBgbWFwYCBjYW4gYmUgdXNlZCB0byB0dXJuIGZ1bmN0aW9ucyBgKGE6IEEpID0+IEJgIGludG8gZnVuY3Rpb25zIGAoZmE6IEY8QT4pID0+IEY8Qj5gIHdob3NlIGFyZ3VtZW50IGFuZCByZXR1cm4gdHlwZXNcbiAqIHVzZSB0aGUgdHlwZSBjb25zdHJ1Y3RvciBgRmAgdG8gcmVwcmVzZW50IHNvbWUgY29tcHV0YXRpb25hbCBjb250ZXh0LlxuICpcbiAqIEBjYXRlZ29yeSBtYXBwaW5nXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBtYXAgPSBmdW5jdGlvbiAoZikgeyByZXR1cm4gZnVuY3Rpb24gKGZhKSB7XG4gICAgcmV0dXJuIGZhLm1hcChmdW5jdGlvbiAoYSkgeyByZXR1cm4gZihhKTsgfSk7XG59OyB9O1xuLyoqXG4gKiBAY2F0ZWdvcnkgbWFwcGluZ1xuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgbWFwV2l0aEluZGV4ID0gZnVuY3Rpb24gKGYpIHsgcmV0dXJuIGZ1bmN0aW9uIChmYSkge1xuICAgIHJldHVybiBmYS5tYXAoZnVuY3Rpb24gKGEsIGkpIHsgcmV0dXJuIGYoaSwgYSk7IH0pO1xufTsgfTtcbi8qKlxuICogQGNhdGVnb3J5IGZpbHRlcmluZ1xuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgc2VwYXJhdGUgPSBmdW5jdGlvbiAoZmEpIHtcbiAgICB2YXIgbGVmdCA9IFtdO1xuICAgIHZhciByaWdodCA9IFtdO1xuICAgIGZvciAodmFyIF9pID0gMCwgZmFfMSA9IGZhOyBfaSA8IGZhXzEubGVuZ3RoOyBfaSsrKSB7XG4gICAgICAgIHZhciBlID0gZmFfMVtfaV07XG4gICAgICAgIGlmIChlLl90YWcgPT09ICdMZWZ0Jykge1xuICAgICAgICAgICAgbGVmdC5wdXNoKGUubGVmdCk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICByaWdodC5wdXNoKGUucmlnaHQpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiBzZXBhcmF0ZWQobGVmdCwgcmlnaHQpO1xufTtcbi8qKlxuICogQGNhdGVnb3J5IGZpbHRlcmluZ1xuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgZmlsdGVyID0gZnVuY3Rpb24gKHByZWRpY2F0ZSkge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgcmV0dXJuIGFzLmZpbHRlcihwcmVkaWNhdGUpO1xuICAgIH07XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgZmlsdGVyaW5nXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBmaWx0ZXJNYXBXaXRoSW5kZXggPSBmdW5jdGlvbiAoZikge1xuICAgIHJldHVybiBmdW5jdGlvbiAoZmEpIHtcbiAgICAgICAgdmFyIG91dCA9IFtdO1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGZhLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICB2YXIgb3B0aW9uQiA9IGYoaSwgZmFbaV0pO1xuICAgICAgICAgICAgaWYgKF8uaXNTb21lKG9wdGlvbkIpKSB7XG4gICAgICAgICAgICAgICAgb3V0LnB1c2gob3B0aW9uQi52YWx1ZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG91dDtcbiAgICB9O1xufTtcbi8qKlxuICogQGNhdGVnb3J5IGZpbHRlcmluZ1xuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgZmlsdGVyTWFwID0gZnVuY3Rpb24gKGYpIHtcbiAgICByZXR1cm4gZmlsdGVyTWFwV2l0aEluZGV4KGZ1bmN0aW9uIChfLCBhKSB7IHJldHVybiBmKGEpOyB9KTtcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBmaWx0ZXJpbmdcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIGNvbXBhY3QgPSAvKiNfX1BVUkVfXyovIGZpbHRlck1hcChpZGVudGl0eSk7XG4vKipcbiAqIEBjYXRlZ29yeSBmaWx0ZXJpbmdcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIHBhcnRpdGlvbiA9IGZ1bmN0aW9uIChwcmVkaWNhdGUpIHtcbiAgICByZXR1cm4gcGFydGl0aW9uV2l0aEluZGV4KGZ1bmN0aW9uIChfLCBhKSB7IHJldHVybiBwcmVkaWNhdGUoYSk7IH0pO1xufTtcbi8qKlxuICogQGNhdGVnb3J5IGZpbHRlcmluZ1xuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgcGFydGl0aW9uV2l0aEluZGV4ID0gZnVuY3Rpb24gKHByZWRpY2F0ZVdpdGhJbmRleCkge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgdmFyIGxlZnQgPSBbXTtcbiAgICAgICAgdmFyIHJpZ2h0ID0gW107XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgYXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIHZhciBhID0gYXNbaV07XG4gICAgICAgICAgICBpZiAocHJlZGljYXRlV2l0aEluZGV4KGksIGEpKSB7XG4gICAgICAgICAgICAgICAgcmlnaHQucHVzaChhKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIGxlZnQucHVzaChhKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gc2VwYXJhdGVkKGxlZnQsIHJpZ2h0KTtcbiAgICB9O1xufTtcbi8qKlxuICogQGNhdGVnb3J5IGZpbHRlcmluZ1xuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgcGFydGl0aW9uTWFwID0gZnVuY3Rpb24gKGYpIHtcbiAgICByZXR1cm4gcGFydGl0aW9uTWFwV2l0aEluZGV4KGZ1bmN0aW9uIChfLCBhKSB7IHJldHVybiBmKGEpOyB9KTtcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBmaWx0ZXJpbmdcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIHBhcnRpdGlvbk1hcFdpdGhJbmRleCA9IGZ1bmN0aW9uIChmKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChmYSkge1xuICAgICAgICB2YXIgbGVmdCA9IFtdO1xuICAgICAgICB2YXIgcmlnaHQgPSBbXTtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBmYS5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgdmFyIGUgPSBmKGksIGZhW2ldKTtcbiAgICAgICAgICAgIGlmIChlLl90YWcgPT09ICdMZWZ0Jykge1xuICAgICAgICAgICAgICAgIGxlZnQucHVzaChlLmxlZnQpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgcmlnaHQucHVzaChlLnJpZ2h0KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gc2VwYXJhdGVkKGxlZnQsIHJpZ2h0KTtcbiAgICB9O1xufTtcbi8qKlxuICogQGNhdGVnb3J5IGZpbHRlcmluZ1xuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgZmlsdGVyV2l0aEluZGV4ID0gZnVuY3Rpb24gKHByZWRpY2F0ZVdpdGhJbmRleCkge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgcmV0dXJuIGFzLmZpbHRlcihmdW5jdGlvbiAoYSwgaSkgeyByZXR1cm4gcHJlZGljYXRlV2l0aEluZGV4KGksIGEpOyB9KTtcbiAgICB9O1xufTtcbi8qKlxuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgZXh0ZW5kID0gZnVuY3Rpb24gKGYpIHsgcmV0dXJuIGZ1bmN0aW9uICh3YSkge1xuICAgIHJldHVybiB3YS5tYXAoZnVuY3Rpb24gKF8sIGkpIHsgcmV0dXJuIGYod2Euc2xpY2UoaSkpOyB9KTtcbn07IH07XG4vKipcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIGR1cGxpY2F0ZSA9IC8qI19fUFVSRV9fKi8gZXh0ZW5kKGlkZW50aXR5KTtcbi8qKlxuICogQGNhdGVnb3J5IGZvbGRpbmdcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIGZvbGRNYXBXaXRoSW5kZXggPSBmdW5jdGlvbiAoTSkge1xuICAgIHJldHVybiBmdW5jdGlvbiAoZikge1xuICAgICAgICByZXR1cm4gZnVuY3Rpb24gKGZhKSB7XG4gICAgICAgICAgICByZXR1cm4gZmEucmVkdWNlKGZ1bmN0aW9uIChiLCBhLCBpKSB7IHJldHVybiBNLmNvbmNhdChiLCBmKGksIGEpKTsgfSwgTS5lbXB0eSk7XG4gICAgICAgIH07XG4gICAgfTtcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBmb2xkaW5nXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciByZWR1Y2UgPSBmdW5jdGlvbiAoYiwgZikge1xuICAgIHJldHVybiByZWR1Y2VXaXRoSW5kZXgoYiwgZnVuY3Rpb24gKF8sIGIsIGEpIHsgcmV0dXJuIGYoYiwgYSk7IH0pO1xufTtcbi8qKlxuICogQGNhdGVnb3J5IGZvbGRpbmdcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIGZvbGRNYXAgPSBmdW5jdGlvbiAoTSkge1xuICAgIHZhciBmb2xkTWFwV2l0aEluZGV4TSA9IGZvbGRNYXBXaXRoSW5kZXgoTSk7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChmKSB7IHJldHVybiBmb2xkTWFwV2l0aEluZGV4TShmdW5jdGlvbiAoXywgYSkgeyByZXR1cm4gZihhKTsgfSk7IH07XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgZm9sZGluZ1xuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgcmVkdWNlV2l0aEluZGV4ID0gZnVuY3Rpb24gKGIsIGYpIHsgcmV0dXJuIGZ1bmN0aW9uIChmYSkge1xuICAgIHZhciBsZW4gPSBmYS5sZW5ndGg7XG4gICAgdmFyIG91dCA9IGI7XG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBsZW47IGkrKykge1xuICAgICAgICBvdXQgPSBmKGksIG91dCwgZmFbaV0pO1xuICAgIH1cbiAgICByZXR1cm4gb3V0O1xufTsgfTtcbi8qKlxuICogQGNhdGVnb3J5IGZvbGRpbmdcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIHJlZHVjZVJpZ2h0ID0gZnVuY3Rpb24gKGIsIGYpIHtcbiAgICByZXR1cm4gcmVkdWNlUmlnaHRXaXRoSW5kZXgoYiwgZnVuY3Rpb24gKF8sIGEsIGIpIHsgcmV0dXJuIGYoYSwgYik7IH0pO1xufTtcbi8qKlxuICogQGNhdGVnb3J5IGZvbGRpbmdcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIHJlZHVjZVJpZ2h0V2l0aEluZGV4ID0gZnVuY3Rpb24gKGIsIGYpIHsgcmV0dXJuIGZ1bmN0aW9uIChmYSkge1xuICAgIHJldHVybiBmYS5yZWR1Y2VSaWdodChmdW5jdGlvbiAoYiwgYSwgaSkgeyByZXR1cm4gZihpLCBhLCBiKTsgfSwgYik7XG59OyB9O1xuLyoqXG4gKiBAY2F0ZWdvcnkgdHJhdmVyc2luZ1xuICogQHNpbmNlIDIuNi4zXG4gKi9cbmV4cG9ydCB2YXIgdHJhdmVyc2UgPSBmdW5jdGlvbiAoRikge1xuICAgIHZhciB0cmF2ZXJzZVdpdGhJbmRleEYgPSB0cmF2ZXJzZVdpdGhJbmRleChGKTtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGYpIHsgcmV0dXJuIHRyYXZlcnNlV2l0aEluZGV4RihmdW5jdGlvbiAoXywgYSkgeyByZXR1cm4gZihhKTsgfSk7IH07XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgdHJhdmVyc2luZ1xuICogQHNpbmNlIDIuNi4zXG4gKi9cbmV4cG9ydCB2YXIgc2VxdWVuY2UgPSBmdW5jdGlvbiAoRikge1xuICAgIHJldHVybiBmdW5jdGlvbiAodGEpIHtcbiAgICAgICAgcmV0dXJuIF9yZWR1Y2UodGEsIEYub2YoemVybygpKSwgZnVuY3Rpb24gKGZhcywgZmEpIHtcbiAgICAgICAgICAgIHJldHVybiBGLmFwKEYubWFwKGZhcywgZnVuY3Rpb24gKGFzKSB7IHJldHVybiBmdW5jdGlvbiAoYSkgeyByZXR1cm4gcGlwZShhcywgYXBwZW5kKGEpKTsgfTsgfSksIGZhKTtcbiAgICAgICAgfSk7XG4gICAgfTtcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBzZXF1ZW5jaW5nXG4gKiBAc2luY2UgMi42LjNcbiAqL1xuZXhwb3J0IHZhciB0cmF2ZXJzZVdpdGhJbmRleCA9IGZ1bmN0aW9uIChGKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChmKSB7XG4gICAgICAgIHJldHVybiByZWR1Y2VXaXRoSW5kZXgoRi5vZih6ZXJvKCkpLCBmdW5jdGlvbiAoaSwgZmJzLCBhKSB7XG4gICAgICAgICAgICByZXR1cm4gRi5hcChGLm1hcChmYnMsIGZ1bmN0aW9uIChicykgeyByZXR1cm4gZnVuY3Rpb24gKGIpIHsgcmV0dXJuIHBpcGUoYnMsIGFwcGVuZChiKSk7IH07IH0pLCBmKGksIGEpKTtcbiAgICAgICAgfSk7XG4gICAgfTtcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBmaWx0ZXJpbmdcbiAqIEBzaW5jZSAyLjYuNVxuICovXG5leHBvcnQgdmFyIHdpdGhlciA9IGZ1bmN0aW9uIChGKSB7XG4gICAgdmFyIF93aXRoZXJGID0gX3dpdGhlcihGKTtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGYpIHsgcmV0dXJuIGZ1bmN0aW9uIChmYSkgeyByZXR1cm4gX3dpdGhlckYoZmEsIGYpOyB9OyB9O1xufTtcbi8qKlxuICogQGNhdGVnb3J5IGZpbHRlcmluZ1xuICogQHNpbmNlIDIuNi41XG4gKi9cbmV4cG9ydCB2YXIgd2lsdCA9IGZ1bmN0aW9uIChGKSB7XG4gICAgdmFyIF93aWx0RiA9IF93aWx0KEYpO1xuICAgIHJldHVybiBmdW5jdGlvbiAoZikgeyByZXR1cm4gZnVuY3Rpb24gKGZhKSB7IHJldHVybiBfd2lsdEYoZmEsIGYpOyB9OyB9O1xufTtcbi8qKlxuICogQHNpbmNlIDIuNi42XG4gKi9cbmV4cG9ydCB2YXIgdW5mb2xkID0gZnVuY3Rpb24gKGIsIGYpIHtcbiAgICB2YXIgb3V0ID0gW107XG4gICAgdmFyIGJiID0gYjtcbiAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tY29uc3RhbnQtY29uZGl0aW9uXG4gICAgd2hpbGUgKHRydWUpIHtcbiAgICAgICAgdmFyIG10ID0gZihiYik7XG4gICAgICAgIGlmIChfLmlzU29tZShtdCkpIHtcbiAgICAgICAgICAgIHZhciBfYSA9IG10LnZhbHVlLCBhID0gX2FbMF0sIGJfMSA9IF9hWzFdO1xuICAgICAgICAgICAgb3V0LnB1c2goYSk7XG4gICAgICAgICAgICBiYiA9IGJfMTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiBvdXQ7XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgdHlwZSBsYW1iZGFzXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBVUkkgPSAnUmVhZG9ubHlBcnJheSc7XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIGdldFNob3cgPSBmdW5jdGlvbiAoUykgeyByZXR1cm4gKHtcbiAgICBzaG93OiBmdW5jdGlvbiAoYXMpIHsgcmV0dXJuIFwiW1wiLmNvbmNhdChhcy5tYXAoUy5zaG93KS5qb2luKCcsICcpLCBcIl1cIik7IH1cbn0pOyB9O1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBnZXRTZW1pZ3JvdXAgPSBmdW5jdGlvbiAoKSB7IHJldHVybiAoe1xuICAgIGNvbmNhdDogZnVuY3Rpb24gKGZpcnN0LCBzZWNvbmQpIHsgcmV0dXJuIChpc0VtcHR5KGZpcnN0KSA/IHNlY29uZCA6IGlzRW1wdHkoc2Vjb25kKSA/IGZpcnN0IDogZmlyc3QuY29uY2F0KHNlY29uZCkpOyB9XG59KTsgfTtcbi8qKlxuICogUmV0dXJucyBhIGBNb25vaWRgIGZvciBgUmVhZG9ubHlBcnJheTxBPmAuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IGdldE1vbm9pZCB9IGZyb20gJ2ZwLXRzL1JlYWRvbmx5QXJyYXknXG4gKlxuICogY29uc3QgTSA9IGdldE1vbm9pZDxudW1iZXI+KClcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoTS5jb25jYXQoWzEsIDJdLCBbMywgNF0pLCBbMSwgMiwgMywgNF0pXG4gKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgZ2V0TW9ub2lkID0gZnVuY3Rpb24gKCkgeyByZXR1cm4gKHtcbiAgICBjb25jYXQ6IGdldFNlbWlncm91cCgpLmNvbmNhdCxcbiAgICBlbXB0eTogZW1wdHlcbn0pOyB9O1xuLyoqXG4gKiBEZXJpdmVzIGFuIGBFcWAgb3ZlciB0aGUgYFJlYWRvbmx5QXJyYXlgIG9mIGEgZ2l2ZW4gZWxlbWVudCB0eXBlIGZyb20gdGhlIGBFcWAgb2YgdGhhdCB0eXBlLiBUaGUgZGVyaXZlZCBgRXFgIGRlZmluZXMgdHdvXG4gKiBhcnJheXMgYXMgZXF1YWwgaWYgYWxsIGVsZW1lbnRzIG9mIGJvdGggYXJyYXlzIGFyZSBjb21wYXJlZCBlcXVhbCBwYWlyd2lzZSB3aXRoIHRoZSBnaXZlbiBgRWAuIEluIGNhc2Ugb2YgYXJyYXlzIG9mXG4gKiBkaWZmZXJlbnQgbGVuZ3RocywgdGhlIHJlc3VsdCBpcyBub24gZXF1YWxpdHkuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCAqIGFzIFMgZnJvbSAnZnAtdHMvc3RyaW5nJ1xuICogaW1wb3J0IHsgZ2V0RXEgfSBmcm9tICdmcC10cy9SZWFkb25seUFycmF5J1xuICpcbiAqIGNvbnN0IEUgPSBnZXRFcShTLkVxKVxuICogYXNzZXJ0LnN0cmljdEVxdWFsKEUuZXF1YWxzKFsnYScsICdiJ10sIFsnYScsICdiJ10pLCB0cnVlKVxuICogYXNzZXJ0LnN0cmljdEVxdWFsKEUuZXF1YWxzKFsnYSddLCBbXSksIGZhbHNlKVxuICpcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIGdldEVxID0gZnVuY3Rpb24gKEUpIHtcbiAgICByZXR1cm4gZnJvbUVxdWFscyhmdW5jdGlvbiAoeHMsIHlzKSB7IHJldHVybiB4cy5sZW5ndGggPT09IHlzLmxlbmd0aCAmJiB4cy5ldmVyeShmdW5jdGlvbiAoeCwgaSkgeyByZXR1cm4gRS5lcXVhbHMoeCwgeXNbaV0pOyB9KTsgfSk7XG59O1xuLyoqXG4gKiBEZXJpdmVzIGFuIGBPcmRgIG92ZXIgdGhlIGBSZWFkb25seUFycmF5YCBvZiBhIGdpdmVuIGVsZW1lbnQgdHlwZSBmcm9tIHRoZSBgT3JkYCBvZiB0aGF0IHR5cGUuIFRoZSBvcmRlcmluZyBiZXR3ZWVuIHR3byBzdWNoXG4gKiBhcnJheXMgaXMgZXF1YWwgdG86IHRoZSBmaXJzdCBub24gZXF1YWwgY29tcGFyaXNvbiBvZiBlYWNoIGFycmF5cyBlbGVtZW50cyB0YWtlbiBwYWlyd2lzZSBpbiBpbmNyZWFzaW5nIG9yZGVyLCBpblxuICogY2FzZSBvZiBlcXVhbGl0eSBvdmVyIGFsbCB0aGUgcGFpcndpc2UgZWxlbWVudHM7IHRoZSBsb25nZXN0IGFycmF5IGlzIGNvbnNpZGVyZWQgdGhlIGdyZWF0ZXN0LCBpZiBib3RoIGFycmF5cyBoYXZlXG4gKiB0aGUgc2FtZSBsZW5ndGgsIHRoZSByZXN1bHQgaXMgZXF1YWxpdHkuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IGdldE9yZCB9IGZyb20gJ2ZwLXRzL1JlYWRvbmx5QXJyYXknXG4gKiBpbXBvcnQgKiBhcyBTIGZyb20gJ2ZwLXRzL3N0cmluZydcbiAqXG4gKiBjb25zdCBPID0gZ2V0T3JkKFMuT3JkKVxuICogYXNzZXJ0LnN0cmljdEVxdWFsKE8uY29tcGFyZShbJ2InXSwgWydhJ10pLCAxKVxuICogYXNzZXJ0LnN0cmljdEVxdWFsKE8uY29tcGFyZShbJ2EnXSwgWydhJ10pLCAwKVxuICogYXNzZXJ0LnN0cmljdEVxdWFsKE8uY29tcGFyZShbJ2EnXSwgWydiJ10pLCAtMSlcbiAqXG4gKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgZ2V0T3JkID0gZnVuY3Rpb24gKE8pIHtcbiAgICByZXR1cm4gZnJvbUNvbXBhcmUoZnVuY3Rpb24gKGEsIGIpIHtcbiAgICAgICAgdmFyIGFMZW4gPSBhLmxlbmd0aDtcbiAgICAgICAgdmFyIGJMZW4gPSBiLmxlbmd0aDtcbiAgICAgICAgdmFyIGxlbiA9IE1hdGgubWluKGFMZW4sIGJMZW4pO1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGxlbjsgaSsrKSB7XG4gICAgICAgICAgICB2YXIgb3JkZXJpbmcgPSBPLmNvbXBhcmUoYVtpXSwgYltpXSk7XG4gICAgICAgICAgICBpZiAob3JkZXJpbmcgIT09IDApIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gb3JkZXJpbmc7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIE4uT3JkLmNvbXBhcmUoYUxlbiwgYkxlbik7XG4gICAgfSk7XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi4xMS4wXG4gKi9cbmV4cG9ydCB2YXIgZ2V0VW5pb25TZW1pZ3JvdXAgPSBmdW5jdGlvbiAoRSkge1xuICAgIHZhciB1bmlvbkUgPSB1bmlvbihFKTtcbiAgICByZXR1cm4ge1xuICAgICAgICBjb25jYXQ6IGZ1bmN0aW9uIChmaXJzdCwgc2Vjb25kKSB7IHJldHVybiB1bmlvbkUoc2Vjb25kKShmaXJzdCk7IH1cbiAgICB9O1xufTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIGdldFVuaW9uTW9ub2lkID0gZnVuY3Rpb24gKEUpIHsgcmV0dXJuICh7XG4gICAgY29uY2F0OiBnZXRVbmlvblNlbWlncm91cChFKS5jb25jYXQsXG4gICAgZW1wdHk6IGVtcHR5XG59KTsgfTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIGdldEludGVyc2VjdGlvblNlbWlncm91cCA9IGZ1bmN0aW9uIChFKSB7XG4gICAgdmFyIGludGVyc2VjdGlvbkUgPSBpbnRlcnNlY3Rpb24oRSk7XG4gICAgcmV0dXJuIHtcbiAgICAgICAgY29uY2F0OiBmdW5jdGlvbiAoZmlyc3QsIHNlY29uZCkgeyByZXR1cm4gaW50ZXJzZWN0aW9uRShzZWNvbmQpKGZpcnN0KTsgfVxuICAgIH07XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi4xMS4wXG4gKi9cbmV4cG9ydCB2YXIgZ2V0RGlmZmVyZW5jZU1hZ21hID0gZnVuY3Rpb24gKEUpIHtcbiAgICB2YXIgZGlmZmVyZW5jZUUgPSBkaWZmZXJlbmNlKEUpO1xuICAgIHJldHVybiB7XG4gICAgICAgIGNvbmNhdDogZnVuY3Rpb24gKGZpcnN0LCBzZWNvbmQpIHsgcmV0dXJuIGRpZmZlcmVuY2VFKHNlY29uZCkoZmlyc3QpOyB9XG4gICAgfTtcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjcuMFxuICovXG5leHBvcnQgdmFyIEZ1bmN0b3IgPSB7XG4gICAgVVJJOiBVUkksXG4gICAgbWFwOiBfbWFwXG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgbWFwcGluZ1xuICogQHNpbmNlIDIuMTAuMFxuICovXG5leHBvcnQgdmFyIGZsYXAgPSAvKiNfX1BVUkVfXyovIGZsYXBfKEZ1bmN0b3IpO1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi4xMC4wXG4gKi9cbmV4cG9ydCB2YXIgUG9pbnRlZCA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICBvZjogb2Zcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjcuMFxuICovXG5leHBvcnQgdmFyIEZ1bmN0b3JXaXRoSW5kZXggPSB7XG4gICAgVVJJOiBVUkksXG4gICAgbWFwOiBfbWFwLFxuICAgIG1hcFdpdGhJbmRleDogX21hcFdpdGhJbmRleFxufTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuMTAuMFxuICovXG5leHBvcnQgdmFyIEFwcGx5ID0ge1xuICAgIFVSSTogVVJJLFxuICAgIG1hcDogX21hcCxcbiAgICBhcDogX2FwXG59O1xuLyoqXG4gKiBDb21iaW5lIHR3byBlZmZlY3RmdWwgYWN0aW9ucywga2VlcGluZyBvbmx5IHRoZSByZXN1bHQgb2YgdGhlIGZpcnN0LlxuICpcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIGFwRmlyc3QgPSAvKiNfX1BVUkVfXyovIGFwRmlyc3RfKEFwcGx5KTtcbi8qKlxuICogQ29tYmluZSB0d28gZWZmZWN0ZnVsIGFjdGlvbnMsIGtlZXBpbmcgb25seSB0aGUgcmVzdWx0IG9mIHRoZSBzZWNvbmQuXG4gKlxuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgYXBTZWNvbmQgPSAvKiNfX1BVUkVfXyovIGFwU2Vjb25kXyhBcHBseSk7XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjcuMFxuICovXG5leHBvcnQgdmFyIEFwcGxpY2F0aXZlID0ge1xuICAgIFVSSTogVVJJLFxuICAgIG1hcDogX21hcCxcbiAgICBhcDogX2FwLFxuICAgIG9mOiBvZlxufTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuMTAuMFxuICovXG5leHBvcnQgdmFyIENoYWluID0ge1xuICAgIFVSSTogVVJJLFxuICAgIG1hcDogX21hcCxcbiAgICBhcDogX2FwLFxuICAgIGNoYWluOiBmbGF0TWFwXG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi43LjBcbiAqL1xuZXhwb3J0IHZhciBNb25hZCA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICBtYXA6IF9tYXAsXG4gICAgYXA6IF9hcCxcbiAgICBvZjogb2YsXG4gICAgY2hhaW46IGZsYXRNYXBcbn07XG4vKipcbiAqIENvbXBvc2VzIGNvbXB1dGF0aW9ucyBpbiBzZXF1ZW5jZSwgdXNpbmcgdGhlIHJldHVybiB2YWx1ZSBvZiBvbmUgY29tcHV0YXRpb24gdG8gZGV0ZXJtaW5lIHRoZSBuZXh0IGNvbXB1dGF0aW9uIGFuZFxuICoga2VlcGluZyBvbmx5IHRoZSByZXN1bHQgb2YgdGhlIGZpcnN0LlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgKiBhcyBSQSBmcm9tICdmcC10cy9SZWFkb25seUFycmF5J1xuICogaW1wb3J0IHsgcGlwZSB9IGZyb20gJ2ZwLXRzL2Z1bmN0aW9uJ1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoXG4gKiAgIHBpcGUoXG4gKiAgICAgWzEsIDIsIDNdLFxuICogICAgIFJBLmNoYWluRmlyc3QoKCkgPT4gWydhJywgJ2InXSlcbiAqICAgKSxcbiAqICAgWzEsIDEsIDIsIDIsIDMsIDNdXG4gKiApXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKFxuICogICBwaXBlKFxuICogICAgIFsxLCAyLCAzXSxcbiAqICAgICBSQS5jaGFpbkZpcnN0KCgpID0+IFtdKVxuICogICApLFxuICogICBbXVxuICogKVxuICpcbiAqIEBjYXRlZ29yeSBzZXF1ZW5jaW5nXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBjaGFpbkZpcnN0ID0gXG4vKiNfX1BVUkVfXyovIGNoYWluRmlyc3RfKENoYWluKTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuNy4wXG4gKi9cbmV4cG9ydCB2YXIgVW5mb2xkYWJsZSA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICB1bmZvbGQ6IHVuZm9sZFxufTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuNy4wXG4gKi9cbmV4cG9ydCB2YXIgQWx0ID0ge1xuICAgIFVSSTogVVJJLFxuICAgIG1hcDogX21hcCxcbiAgICBhbHQ6IF9hbHRcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjExLjBcbiAqL1xuZXhwb3J0IHZhciBaZXJvID0ge1xuICAgIFVSSTogVVJJLFxuICAgIHplcm86IHplcm9cbn07XG4vKipcbiAqIEBjYXRlZ29yeSBkbyBub3RhdGlvblxuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIGd1YXJkID0gLyojX19QVVJFX18qLyBndWFyZF8oWmVybywgUG9pbnRlZCk7XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjcuMFxuICovXG5leHBvcnQgdmFyIEFsdGVybmF0aXZlID0ge1xuICAgIFVSSTogVVJJLFxuICAgIG1hcDogX21hcCxcbiAgICBhcDogX2FwLFxuICAgIG9mOiBvZixcbiAgICBhbHQ6IF9hbHQsXG4gICAgemVybzogemVyb1xufTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuNy4wXG4gKi9cbmV4cG9ydCB2YXIgRXh0ZW5kID0ge1xuICAgIFVSSTogVVJJLFxuICAgIG1hcDogX21hcCxcbiAgICBleHRlbmQ6IF9leHRlbmRcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjcuMFxuICovXG5leHBvcnQgdmFyIENvbXBhY3RhYmxlID0ge1xuICAgIFVSSTogVVJJLFxuICAgIGNvbXBhY3Q6IGNvbXBhY3QsXG4gICAgc2VwYXJhdGU6IHNlcGFyYXRlXG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi43LjBcbiAqL1xuZXhwb3J0IHZhciBGaWx0ZXJhYmxlID0ge1xuICAgIFVSSTogVVJJLFxuICAgIG1hcDogX21hcCxcbiAgICBjb21wYWN0OiBjb21wYWN0LFxuICAgIHNlcGFyYXRlOiBzZXBhcmF0ZSxcbiAgICBmaWx0ZXI6IF9maWx0ZXIsXG4gICAgZmlsdGVyTWFwOiBfZmlsdGVyTWFwLFxuICAgIHBhcnRpdGlvbjogX3BhcnRpdGlvbixcbiAgICBwYXJ0aXRpb25NYXA6IF9wYXJ0aXRpb25NYXBcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjcuMFxuICovXG5leHBvcnQgdmFyIEZpbHRlcmFibGVXaXRoSW5kZXggPSB7XG4gICAgVVJJOiBVUkksXG4gICAgbWFwOiBfbWFwLFxuICAgIG1hcFdpdGhJbmRleDogX21hcFdpdGhJbmRleCxcbiAgICBjb21wYWN0OiBjb21wYWN0LFxuICAgIHNlcGFyYXRlOiBzZXBhcmF0ZSxcbiAgICBmaWx0ZXI6IF9maWx0ZXIsXG4gICAgZmlsdGVyTWFwOiBfZmlsdGVyTWFwLFxuICAgIHBhcnRpdGlvbjogX3BhcnRpdGlvbixcbiAgICBwYXJ0aXRpb25NYXA6IF9wYXJ0aXRpb25NYXAsXG4gICAgcGFydGl0aW9uTWFwV2l0aEluZGV4OiBfcGFydGl0aW9uTWFwV2l0aEluZGV4LFxuICAgIHBhcnRpdGlvbldpdGhJbmRleDogX3BhcnRpdGlvbldpdGhJbmRleCxcbiAgICBmaWx0ZXJNYXBXaXRoSW5kZXg6IF9maWx0ZXJNYXBXaXRoSW5kZXgsXG4gICAgZmlsdGVyV2l0aEluZGV4OiBfZmlsdGVyV2l0aEluZGV4XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi43LjBcbiAqL1xuZXhwb3J0IHZhciBGb2xkYWJsZSA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICByZWR1Y2U6IF9yZWR1Y2UsXG4gICAgZm9sZE1hcDogX2ZvbGRNYXAsXG4gICAgcmVkdWNlUmlnaHQ6IF9yZWR1Y2VSaWdodFxufTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuNy4wXG4gKi9cbmV4cG9ydCB2YXIgRm9sZGFibGVXaXRoSW5kZXggPSB7XG4gICAgVVJJOiBVUkksXG4gICAgcmVkdWNlOiBfcmVkdWNlLFxuICAgIGZvbGRNYXA6IF9mb2xkTWFwLFxuICAgIHJlZHVjZVJpZ2h0OiBfcmVkdWNlUmlnaHQsXG4gICAgcmVkdWNlV2l0aEluZGV4OiBfcmVkdWNlV2l0aEluZGV4LFxuICAgIGZvbGRNYXBXaXRoSW5kZXg6IF9mb2xkTWFwV2l0aEluZGV4LFxuICAgIHJlZHVjZVJpZ2h0V2l0aEluZGV4OiBfcmVkdWNlUmlnaHRXaXRoSW5kZXhcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjcuMFxuICovXG5leHBvcnQgdmFyIFRyYXZlcnNhYmxlID0ge1xuICAgIFVSSTogVVJJLFxuICAgIG1hcDogX21hcCxcbiAgICByZWR1Y2U6IF9yZWR1Y2UsXG4gICAgZm9sZE1hcDogX2ZvbGRNYXAsXG4gICAgcmVkdWNlUmlnaHQ6IF9yZWR1Y2VSaWdodCxcbiAgICB0cmF2ZXJzZTogX3RyYXZlcnNlLFxuICAgIHNlcXVlbmNlOiBzZXF1ZW5jZVxufTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuNy4wXG4gKi9cbmV4cG9ydCB2YXIgVHJhdmVyc2FibGVXaXRoSW5kZXggPSB7XG4gICAgVVJJOiBVUkksXG4gICAgbWFwOiBfbWFwLFxuICAgIG1hcFdpdGhJbmRleDogX21hcFdpdGhJbmRleCxcbiAgICByZWR1Y2U6IF9yZWR1Y2UsXG4gICAgZm9sZE1hcDogX2ZvbGRNYXAsXG4gICAgcmVkdWNlUmlnaHQ6IF9yZWR1Y2VSaWdodCxcbiAgICByZWR1Y2VXaXRoSW5kZXg6IF9yZWR1Y2VXaXRoSW5kZXgsXG4gICAgZm9sZE1hcFdpdGhJbmRleDogX2ZvbGRNYXBXaXRoSW5kZXgsXG4gICAgcmVkdWNlUmlnaHRXaXRoSW5kZXg6IF9yZWR1Y2VSaWdodFdpdGhJbmRleCxcbiAgICB0cmF2ZXJzZTogX3RyYXZlcnNlLFxuICAgIHNlcXVlbmNlOiBzZXF1ZW5jZSxcbiAgICB0cmF2ZXJzZVdpdGhJbmRleDogX3RyYXZlcnNlV2l0aEluZGV4XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgc2VxdWVuY2luZ1xuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIGNoYWluUmVjRGVwdGhGaXJzdCA9IGZ1bmN0aW9uIChmKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhKSB7XG4gICAgICAgIHZhciB0b2RvID0gX19zcHJlYWRBcnJheShbXSwgZihhKSwgdHJ1ZSk7XG4gICAgICAgIHZhciBvdXQgPSBbXTtcbiAgICAgICAgd2hpbGUgKHRvZG8ubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgdmFyIGUgPSB0b2RvLnNoaWZ0KCk7XG4gICAgICAgICAgICBpZiAoXy5pc0xlZnQoZSkpIHtcbiAgICAgICAgICAgICAgICB0b2RvLnVuc2hpZnQuYXBwbHkodG9kbywgZihlLmxlZnQpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIG91dC5wdXNoKGUucmlnaHQpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBvdXQ7XG4gICAgfTtcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjExLjBcbiAqL1xuZXhwb3J0IHZhciBDaGFpblJlY0RlcHRoRmlyc3QgPSB7XG4gICAgVVJJOiBVUkksXG4gICAgbWFwOiBfbWFwLFxuICAgIGFwOiBfYXAsXG4gICAgY2hhaW46IGZsYXRNYXAsXG4gICAgY2hhaW5SZWM6IF9jaGFpblJlY0RlcHRoRmlyc3Rcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBzZXF1ZW5jaW5nXG4gKiBAc2luY2UgMi4xMS4wXG4gKi9cbmV4cG9ydCB2YXIgY2hhaW5SZWNCcmVhZHRoRmlyc3QgPSBmdW5jdGlvbiAoZikge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYSkge1xuICAgICAgICB2YXIgaW5pdGlhbCA9IGYoYSk7XG4gICAgICAgIHZhciB0b2RvID0gW107XG4gICAgICAgIHZhciBvdXQgPSBbXTtcbiAgICAgICAgZnVuY3Rpb24gZ28oZSkge1xuICAgICAgICAgICAgaWYgKF8uaXNMZWZ0KGUpKSB7XG4gICAgICAgICAgICAgICAgZihlLmxlZnQpLmZvckVhY2goZnVuY3Rpb24gKHYpIHsgcmV0dXJuIHRvZG8ucHVzaCh2KTsgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBvdXQucHVzaChlLnJpZ2h0KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBmb3IgKHZhciBfaSA9IDAsIGluaXRpYWxfMSA9IGluaXRpYWw7IF9pIDwgaW5pdGlhbF8xLmxlbmd0aDsgX2krKykge1xuICAgICAgICAgICAgdmFyIGUgPSBpbml0aWFsXzFbX2ldO1xuICAgICAgICAgICAgZ28oZSk7XG4gICAgICAgIH1cbiAgICAgICAgd2hpbGUgKHRvZG8ubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgZ28odG9kby5zaGlmdCgpKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gb3V0O1xuICAgIH07XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi4xMS4wXG4gKi9cbmV4cG9ydCB2YXIgQ2hhaW5SZWNCcmVhZHRoRmlyc3QgPSB7XG4gICAgVVJJOiBVUkksXG4gICAgbWFwOiBfbWFwLFxuICAgIGFwOiBfYXAsXG4gICAgY2hhaW46IGZsYXRNYXAsXG4gICAgY2hhaW5SZWM6IF9jaGFpblJlY0JyZWFkdGhGaXJzdFxufTtcbnZhciBfd2l0aGVyID0gLyojX19QVVJFX18qLyB3aXRoZXJEZWZhdWx0KFRyYXZlcnNhYmxlLCBDb21wYWN0YWJsZSk7XG52YXIgX3dpbHQgPSAvKiNfX1BVUkVfXyovIHdpbHREZWZhdWx0KFRyYXZlcnNhYmxlLCBDb21wYWN0YWJsZSk7XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjcuMFxuICovXG5leHBvcnQgdmFyIFdpdGhlcmFibGUgPSB7XG4gICAgVVJJOiBVUkksXG4gICAgbWFwOiBfbWFwLFxuICAgIGNvbXBhY3Q6IGNvbXBhY3QsXG4gICAgc2VwYXJhdGU6IHNlcGFyYXRlLFxuICAgIGZpbHRlcjogX2ZpbHRlcixcbiAgICBmaWx0ZXJNYXA6IF9maWx0ZXJNYXAsXG4gICAgcGFydGl0aW9uOiBfcGFydGl0aW9uLFxuICAgIHBhcnRpdGlvbk1hcDogX3BhcnRpdGlvbk1hcCxcbiAgICByZWR1Y2U6IF9yZWR1Y2UsXG4gICAgZm9sZE1hcDogX2ZvbGRNYXAsXG4gICAgcmVkdWNlUmlnaHQ6IF9yZWR1Y2VSaWdodCxcbiAgICB0cmF2ZXJzZTogX3RyYXZlcnNlLFxuICAgIHNlcXVlbmNlOiBzZXF1ZW5jZSxcbiAgICB3aXRoZXI6IF93aXRoZXIsXG4gICAgd2lsdDogX3dpbHRcbn07XG4vKipcbiAqIEZpbHRlciB2YWx1ZXMgaW5zaWRlIGEgY29udGV4dC5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgcGlwZSB9IGZyb20gJ2ZwLXRzL2Z1bmN0aW9uJ1xuICogaW1wb3J0ICogYXMgUkEgZnJvbSAnZnAtdHMvUmVhZG9ubHlBcnJheSdcbiAqIGltcG9ydCAqIGFzIFQgZnJvbSAnZnAtdHMvVGFzaydcbiAqXG4gKiBjb25zdCBmaWx0ZXJFID0gUkEuZmlsdGVyRShULkFwcGxpY2F0aXZlUGFyKVxuICogYXN5bmMgZnVuY3Rpb24gdGVzdCgpIHtcbiAqICAgYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChcbiAqICAgICBhd2FpdCBwaXBlKFxuICogICAgICAgWy0xLCAyLCAzXSxcbiAqICAgICAgIGZpbHRlckUoKG4pID0+IFQub2YobiA+IDApKVxuICogICAgICkoKSxcbiAqICAgICBbMiwgM11cbiAqICAgKVxuICogfVxuICogdGVzdCgpXG4gKlxuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIGZpbHRlckUgPSAvKiNfX1BVUkVfXyovIGZpbHRlckVfKFdpdGhlcmFibGUpO1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi4xMS4wXG4gKi9cbmV4cG9ydCB2YXIgRnJvbUVpdGhlciA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICBmcm9tRWl0aGVyOiBmcm9tRWl0aGVyXG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgbGlmdGluZ1xuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIGZyb21FaXRoZXJLID0gLyojX19QVVJFX18qLyBmcm9tRWl0aGVyS18oRnJvbUVpdGhlcik7XG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vLyB1bnNhZmVcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8qKlxuICogQGNhdGVnb3J5IHVuc2FmZVxuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgdW5zYWZlSW5zZXJ0QXQgPSBSTkVBLnVuc2FmZUluc2VydEF0O1xuLyoqXG4gKiBAY2F0ZWdvcnkgdW5zYWZlXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciB1bnNhZmVVcGRhdGVBdCA9IGZ1bmN0aW9uIChpLCBhLCBhcykge1xuICAgIHJldHVybiBpc05vbkVtcHR5KGFzKSA/IFJORUEudW5zYWZlVXBkYXRlQXQoaSwgYSwgYXMpIDogYXM7XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgdW5zYWZlXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciB1bnNhZmVEZWxldGVBdCA9IGZ1bmN0aW9uIChpLCBhcykge1xuICAgIHZhciB4cyA9IGFzLnNsaWNlKCk7XG4gICAgeHMuc3BsaWNlKGksIDEpO1xuICAgIHJldHVybiB4cztcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBjb252ZXJzaW9uc1xuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgdG9BcnJheSA9IGZ1bmN0aW9uIChhcykgeyByZXR1cm4gYXMuc2xpY2UoKTsgfTtcbi8qKlxuICogQGNhdGVnb3J5IGNvbnZlcnNpb25zXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBmcm9tQXJyYXkgPSBmdW5jdGlvbiAoYXMpIHsgcmV0dXJuIChpc0VtcHR5KGFzKSA/IGVtcHR5IDogYXMuc2xpY2UoKSk7IH07XG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vLyB1dGlsc1xuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLyoqXG4gKiBBbiBlbXB0eSBhcnJheVxuICpcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIGVtcHR5ID0gUk5FQS5lbXB0eTtcbmV4cG9ydCBmdW5jdGlvbiBldmVyeShwcmVkaWNhdGUpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7IHJldHVybiBhcy5ldmVyeShwcmVkaWNhdGUpOyB9O1xufVxuLyoqXG4gKiBDaGVjayBpZiBhIHByZWRpY2F0ZSBob2xkcyB0cnVlIGZvciBhbnkgYXJyYXkgbWVtYmVyLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBzb21lIH0gZnJvbSAnZnAtdHMvUmVhZG9ubHlBcnJheSdcbiAqIGltcG9ydCB7IHBpcGUgfSBmcm9tICdmcC10cy9mdW5jdGlvbidcbiAqXG4gKiBjb25zdCBpc1Bvc2l0aXZlID0gKG46IG51bWJlcik6IGJvb2xlYW4gPT4gbiA+IDBcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKHBpcGUoWy0xLCAtMiwgM10sIHNvbWUoaXNQb3NpdGl2ZSkpLCB0cnVlKVxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChwaXBlKFstMSwgLTIsIC0zXSwgc29tZShpc1Bvc2l0aXZlKSksIGZhbHNlKVxuICpcbiAqIEBzaW5jZSAyLjkuMFxuICovXG5leHBvcnQgdmFyIHNvbWUgPSBmdW5jdGlvbiAocHJlZGljYXRlKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykge1xuICAgICAgICByZXR1cm4gYXMuc29tZShwcmVkaWNhdGUpO1xuICAgIH07XG59O1xuLyoqXG4gKiBBbGlhcyBvZiBbYHNvbWVgXSgjc29tZSlcbiAqXG4gKiBAc2luY2UgMi4xMS4wXG4gKi9cbmV4cG9ydCB2YXIgZXhpc3RzID0gc29tZTtcbi8qKlxuICogUGxhY2VzIGFuIGVsZW1lbnQgaW4gYmV0d2VlbiBtZW1iZXJzIG9mIGEgYFJlYWRvbmx5QXJyYXlgLCB0aGVuIGZvbGRzIHRoZSByZXN1bHRzIHVzaW5nIHRoZSBwcm92aWRlZCBgTW9ub2lkYC5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0ICogYXMgUyBmcm9tICdmcC10cy9zdHJpbmcnXG4gKiBpbXBvcnQgeyBpbnRlcmNhbGF0ZSB9IGZyb20gJ2ZwLXRzL1JlYWRvbmx5QXJyYXknXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChpbnRlcmNhbGF0ZShTLk1vbm9pZCkoJy0nKShbJ2EnLCAnYicsICdjJ10pLCAnYS1iLWMnKVxuICpcbiAqIEBzaW5jZSAyLjEyLjBcbiAqL1xuZXhwb3J0IHZhciBpbnRlcmNhbGF0ZSA9IGZ1bmN0aW9uIChNKSB7XG4gICAgdmFyIGludGVyY2FsYXRlTSA9IFJORUEuaW50ZXJjYWxhdGUoTSk7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChtaWRkbGUpIHsgcmV0dXJuIG1hdGNoKGZ1bmN0aW9uICgpIHsgcmV0dXJuIE0uZW1wdHk7IH0sIGludGVyY2FsYXRlTShtaWRkbGUpKTsgfTtcbn07XG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vLyBkbyBub3RhdGlvblxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLyoqXG4gKiBAY2F0ZWdvcnkgZG8gbm90YXRpb25cbiAqIEBzaW5jZSAyLjkuMFxuICovXG5leHBvcnQgdmFyIERvID0gLyojX19QVVJFX18qLyBvZihfLmVtcHR5UmVjb3JkKTtcbi8qKlxuICogQGNhdGVnb3J5IGRvIG5vdGF0aW9uXG4gKiBAc2luY2UgMi44LjBcbiAqL1xuZXhwb3J0IHZhciBiaW5kVG8gPSAvKiNfX1BVUkVfXyovIGJpbmRUb18oRnVuY3Rvcik7XG52YXIgbGV0XyA9IC8qI19fUFVSRV9fKi8gbGV0X18oRnVuY3Rvcik7XG5leHBvcnQgeyBcbi8qKlxuICogQGNhdGVnb3J5IGRvIG5vdGF0aW9uXG4gKiBAc2luY2UgMi4xMy4wXG4gKi9cbmxldF8gYXMgbGV0IH07XG4vKipcbiAqIEBjYXRlZ29yeSBkbyBub3RhdGlvblxuICogQHNpbmNlIDIuOC4wXG4gKi9cbmV4cG9ydCB2YXIgYmluZCA9IC8qI19fUFVSRV9fKi8gYmluZF8oQ2hhaW4pO1xuLyoqXG4gKiBAY2F0ZWdvcnkgZG8gbm90YXRpb25cbiAqIEBzaW5jZSAyLjguMFxuICovXG5leHBvcnQgdmFyIGFwUyA9IC8qI19fUFVSRV9fKi8gYXBTXyhBcHBseSk7XG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vLyBsZWdhY3lcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8qKlxuICogQWxpYXMgb2YgYGZsYXRNYXBgLlxuICpcbiAqIEBjYXRlZ29yeSBsZWdhY3lcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIGNoYWluID0gZmxhdE1hcDtcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8vIGRlcHJlY2F0ZWRcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8qKlxuICogVXNlIGBSZWFkb25seU5vbkVtcHR5QXJyYXlgIG1vZHVsZSBpbnN0ZWFkLlxuICpcbiAqIEBjYXRlZ29yeSB6b25lIG9mIGRlYXRoXG4gKiBAc2luY2UgMi41LjBcbiAqIEBkZXByZWNhdGVkXG4gKi9cbmV4cG9ydCB2YXIgcmFuZ2UgPSBSTkVBLnJhbmdlO1xuLyoqXG4gKiBVc2UgW2BwcmVwZW5kYF0oI3ByZXBlbmQpIGluc3RlYWQuXG4gKlxuICogQGNhdGVnb3J5IHpvbmUgb2YgZGVhdGhcbiAqIEBzaW5jZSAyLjUuMFxuICogQGRlcHJlY2F0ZWRcbiAqL1xuZXhwb3J0IHZhciBjb25zID0gUk5FQS5jb25zO1xuLyoqXG4gKiBVc2UgW2BhcHBlbmRgXSgjYXBwZW5kKSBpbnN0ZWFkLlxuICpcbiAqIEBjYXRlZ29yeSB6b25lIG9mIGRlYXRoXG4gKiBAc2luY2UgMi41LjBcbiAqIEBkZXByZWNhdGVkXG4gKi9cbmV4cG9ydCB2YXIgc25vYyA9IFJORUEuc25vYztcbi8qKlxuICogVXNlIFtgcHJlcGVuZEFsbGBdKCNwcmVwZW5kYWxsKSBpbnN0ZWFkLlxuICpcbiAqIEBjYXRlZ29yeSB6b25lIG9mIGRlYXRoXG4gKiBAc2luY2UgMi45LjBcbiAqIEBkZXByZWNhdGVkXG4gKi9cbmV4cG9ydCB2YXIgcHJlcGVuZFRvQWxsID0gcHJlcGVuZEFsbDtcbi8qKlxuICogVGhpcyBpbnN0YW5jZSBpcyBkZXByZWNhdGVkLCB1c2Ugc21hbGwsIHNwZWNpZmljIGluc3RhbmNlcyBpbnN0ZWFkLlxuICogRm9yIGV4YW1wbGUgaWYgYSBmdW5jdGlvbiBuZWVkcyBhIGBGdW5jdG9yYCBpbnN0YW5jZSwgcGFzcyBgUkEuRnVuY3RvcmAgaW5zdGVhZCBvZiBgUkEucmVhZG9ubHlBcnJheWBcbiAqICh3aGVyZSBgUkFgIGlzIGZyb20gYGltcG9ydCBSQSBmcm9tICdmcC10cy9SZWFkb25seUFycmF5J2ApXG4gKlxuICogQGNhdGVnb3J5IHpvbmUgb2YgZGVhdGhcbiAqIEBzaW5jZSAyLjUuMFxuICogQGRlcHJlY2F0ZWRcbiAqL1xuZXhwb3J0IHZhciByZWFkb25seUFycmF5ID0ge1xuICAgIFVSSTogVVJJLFxuICAgIGNvbXBhY3Q6IGNvbXBhY3QsXG4gICAgc2VwYXJhdGU6IHNlcGFyYXRlLFxuICAgIG1hcDogX21hcCxcbiAgICBhcDogX2FwLFxuICAgIG9mOiBvZixcbiAgICBjaGFpbjogZmxhdE1hcCxcbiAgICBmaWx0ZXI6IF9maWx0ZXIsXG4gICAgZmlsdGVyTWFwOiBfZmlsdGVyTWFwLFxuICAgIHBhcnRpdGlvbjogX3BhcnRpdGlvbixcbiAgICBwYXJ0aXRpb25NYXA6IF9wYXJ0aXRpb25NYXAsXG4gICAgbWFwV2l0aEluZGV4OiBfbWFwV2l0aEluZGV4LFxuICAgIHBhcnRpdGlvbk1hcFdpdGhJbmRleDogX3BhcnRpdGlvbk1hcFdpdGhJbmRleCxcbiAgICBwYXJ0aXRpb25XaXRoSW5kZXg6IF9wYXJ0aXRpb25XaXRoSW5kZXgsXG4gICAgZmlsdGVyTWFwV2l0aEluZGV4OiBfZmlsdGVyTWFwV2l0aEluZGV4LFxuICAgIGZpbHRlcldpdGhJbmRleDogX2ZpbHRlcldpdGhJbmRleCxcbiAgICBhbHQ6IF9hbHQsXG4gICAgemVybzogemVybyxcbiAgICB1bmZvbGQ6IHVuZm9sZCxcbiAgICByZWR1Y2U6IF9yZWR1Y2UsXG4gICAgZm9sZE1hcDogX2ZvbGRNYXAsXG4gICAgcmVkdWNlUmlnaHQ6IF9yZWR1Y2VSaWdodCxcbiAgICB0cmF2ZXJzZTogX3RyYXZlcnNlLFxuICAgIHNlcXVlbmNlOiBzZXF1ZW5jZSxcbiAgICByZWR1Y2VXaXRoSW5kZXg6IF9yZWR1Y2VXaXRoSW5kZXgsXG4gICAgZm9sZE1hcFdpdGhJbmRleDogX2ZvbGRNYXBXaXRoSW5kZXgsXG4gICAgcmVkdWNlUmlnaHRXaXRoSW5kZXg6IF9yZWR1Y2VSaWdodFdpdGhJbmRleCxcbiAgICB0cmF2ZXJzZVdpdGhJbmRleDogX3RyYXZlcnNlV2l0aEluZGV4LFxuICAgIGV4dGVuZDogX2V4dGVuZCxcbiAgICB3aXRoZXI6IF93aXRoZXIsXG4gICAgd2lsdDogX3dpbHRcbn07XG4iLAogICJ2YXIgX19zcHJlYWRBcnJheSA9ICh0aGlzICYmIHRoaXMuX19zcHJlYWRBcnJheSkgfHwgZnVuY3Rpb24gKHRvLCBmcm9tLCBwYWNrKSB7XG4gICAgaWYgKHBhY2sgfHwgYXJndW1lbnRzLmxlbmd0aCA9PT0gMikgZm9yICh2YXIgaSA9IDAsIGwgPSBmcm9tLmxlbmd0aCwgYXI7IGkgPCBsOyBpKyspIHtcbiAgICAgICAgaWYgKGFyIHx8ICEoaSBpbiBmcm9tKSkge1xuICAgICAgICAgICAgaWYgKCFhcikgYXIgPSBBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChmcm9tLCAwLCBpKTtcbiAgICAgICAgICAgIGFyW2ldID0gZnJvbVtpXTtcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gdG8uY29uY2F0KGFyIHx8IEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGZyb20pKTtcbn07XG5pbXBvcnQgeyBhcEZpcnN0IGFzIGFwRmlyc3RfLCBhcFMgYXMgYXBTXywgYXBTZWNvbmQgYXMgYXBTZWNvbmRfIH0gZnJvbSAnLi9BcHBseSc7XG5pbXBvcnQgeyBiaW5kIGFzIGJpbmRfLCBjaGFpbkZpcnN0IGFzIGNoYWluRmlyc3RfIH0gZnJvbSAnLi9DaGFpbic7XG5pbXBvcnQgeyBmcm9tRXF1YWxzIH0gZnJvbSAnLi9FcSc7XG5pbXBvcnQgeyBmcm9tRWl0aGVySyBhcyBmcm9tRWl0aGVyS18gfSBmcm9tICcuL0Zyb21FaXRoZXInO1xuaW1wb3J0IHsgZHVhbCwgaWRlbnRpdHksIHBpcGUgfSBmcm9tICcuL2Z1bmN0aW9uJztcbmltcG9ydCB7IGJpbmRUbyBhcyBiaW5kVG9fLCBmbGFwIGFzIGZsYXBfLCBsZXQgYXMgbGV0X18gfSBmcm9tICcuL0Z1bmN0b3InO1xuaW1wb3J0ICogYXMgXyBmcm9tICcuL2ludGVybmFsJztcbmltcG9ydCAqIGFzIE4gZnJvbSAnLi9udW1iZXInO1xuaW1wb3J0IHsgZnJvbUNvbXBhcmUgfSBmcm9tICcuL09yZCc7XG5pbXBvcnQgKiBhcyBSTkVBIGZyb20gJy4vUmVhZG9ubHlOb25FbXB0eUFycmF5JztcbmltcG9ydCB7IHNlcGFyYXRlZCB9IGZyb20gJy4vU2VwYXJhdGVkJztcbmltcG9ydCB7IGZpbHRlckUgYXMgZmlsdGVyRV8sIHdpbHREZWZhdWx0LCB3aXRoZXJEZWZhdWx0IH0gZnJvbSAnLi9XaXRoZXJhYmxlJztcbmltcG9ydCB7IGd1YXJkIGFzIGd1YXJkXyB9IGZyb20gJy4vWmVybyc7XG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vLyByZWZpbmVtZW50c1xuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLyoqXG4gKiBUZXN0IHdoZXRoZXIgYSBgUmVhZG9ubHlBcnJheWAgaXMgZW1wdHkuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IGlzRW1wdHkgfSBmcm9tICdmcC10cy9SZWFkb25seUFycmF5J1xuICpcbiAqIGFzc2VydC5zdHJpY3RFcXVhbChpc0VtcHR5KFtdKSwgdHJ1ZSlcbiAqXG4gKiBAY2F0ZWdvcnkgcmVmaW5lbWVudHNcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIGlzRW1wdHkgPSBmdW5jdGlvbiAoYXMpIHsgcmV0dXJuIGFzLmxlbmd0aCA9PT0gMDsgfTtcbi8qKlxuICogVGVzdCB3aGV0aGVyIGEgYFJlYWRvbmx5QXJyYXlgIGlzIG5vbiBlbXB0eS5cbiAqXG4gKiBAY2F0ZWdvcnkgcmVmaW5lbWVudHNcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIGlzTm9uRW1wdHkgPSBSTkVBLmlzTm9uRW1wdHk7XG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vLyBjb25zdHJ1Y3RvcnNcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8qKlxuICogUHJlcGVuZCBhbiBlbGVtZW50IHRvIHRoZSBmcm9udCBvZiBhIGBSZWFkb25seUFycmF5YCwgY3JlYXRpbmcgYSBuZXcgYFJlYWRvbmx5Tm9uRW1wdHlBcnJheWAuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IHByZXBlbmQgfSBmcm9tICdmcC10cy9SZWFkb25seUFycmF5J1xuICogaW1wb3J0IHsgcGlwZSB9IGZyb20gJ2ZwLXRzL2Z1bmN0aW9uJ1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwocGlwZShbMiwgMywgNF0sIHByZXBlbmQoMSkpLCBbMSwgMiwgMywgNF0pXG4gKlxuICogQHNpbmNlIDIuMTAuMFxuICovXG5leHBvcnQgdmFyIHByZXBlbmQgPSBSTkVBLnByZXBlbmQ7XG4vKipcbiAqIExlc3Mgc3RyaWN0IHZlcnNpb24gb2YgW2BwcmVwZW5kYF0oI3ByZXBlbmQpLlxuICpcbiAqIEBzaW5jZSAyLjExLjBcbiAqL1xuZXhwb3J0IHZhciBwcmVwZW5kVyA9IFJORUEucHJlcGVuZFc7XG4vKipcbiAqIEFwcGVuZCBhbiBlbGVtZW50IHRvIHRoZSBlbmQgb2YgYSBgUmVhZG9ubHlBcnJheWAsIGNyZWF0aW5nIGEgbmV3IGBSZWFkb25seU5vbkVtcHR5QXJyYXlgLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBhcHBlbmQgfSBmcm9tICdmcC10cy9SZWFkb25seUFycmF5J1xuICogaW1wb3J0IHsgcGlwZSB9IGZyb20gJ2ZwLXRzL2Z1bmN0aW9uJ1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwocGlwZShbMSwgMiwgM10sIGFwcGVuZCg0KSksIFsxLCAyLCAzLCA0XSlcbiAqXG4gKiBAc2luY2UgMi4xMC4wXG4gKi9cbmV4cG9ydCB2YXIgYXBwZW5kID0gUk5FQS5hcHBlbmQ7XG4vKipcbiAqIExlc3Mgc3RyaWN0IHZlcnNpb24gb2YgW2BhcHBlbmRgXSgjYXBwZW5kKS5cbiAqXG4gKiBAc2luY2UgMi4xMS4wXG4gKi9cbmV4cG9ydCB2YXIgYXBwZW5kVyA9IFJORUEuYXBwZW5kVztcbi8qKlxuICogUmV0dXJuIGEgYFJlYWRvbmx5QXJyYXlgIG9mIGxlbmd0aCBgbmAgd2l0aCBlbGVtZW50IGBpYCBpbml0aWFsaXplZCB3aXRoIGBmKGkpYC5cbiAqXG4gKiAqKk5vdGUqKi4gYG5gIGlzIG5vcm1hbGl6ZWQgdG8gYSBub24gbmVnYXRpdmUgaW50ZWdlci5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgbWFrZUJ5IH0gZnJvbSAnZnAtdHMvUmVhZG9ubHlBcnJheSdcbiAqXG4gKiBjb25zdCBkb3VibGUgPSAobjogbnVtYmVyKTogbnVtYmVyID0+IG4gKiAyXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKG1ha2VCeSg1LCBkb3VibGUpLCBbMCwgMiwgNCwgNiwgOF0pXG4gKlxuICogQGNhdGVnb3J5IGNvbnN0cnVjdG9yc1xuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgbWFrZUJ5ID0gZnVuY3Rpb24gKG4sIGYpIHsgcmV0dXJuIChuIDw9IDAgPyBlbXB0eSA6IFJORUEubWFrZUJ5KGYpKG4pKTsgfTtcbi8qKlxuICogQ3JlYXRlIGEgYFJlYWRvbmx5QXJyYXlgIGNvbnRhaW5pbmcgYSB2YWx1ZSByZXBlYXRlZCB0aGUgc3BlY2lmaWVkIG51bWJlciBvZiB0aW1lcy5cbiAqXG4gKiAqKk5vdGUqKi4gYG5gIGlzIG5vcm1hbGl6ZWQgdG8gYSBub24gbmVnYXRpdmUgaW50ZWdlci5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgcmVwbGljYXRlIH0gZnJvbSAnZnAtdHMvUmVhZG9ubHlBcnJheSdcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKHJlcGxpY2F0ZSgzLCAnYScpLCBbJ2EnLCAnYScsICdhJ10pXG4gKlxuICogQGNhdGVnb3J5IGNvbnN0cnVjdG9yc1xuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgcmVwbGljYXRlID0gZnVuY3Rpb24gKG4sIGEpIHsgcmV0dXJuIG1ha2VCeShuLCBmdW5jdGlvbiAoKSB7IHJldHVybiBhOyB9KTsgfTtcbmV4cG9ydCBmdW5jdGlvbiBmcm9tUHJlZGljYXRlKHByZWRpY2F0ZSkge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYSkgeyByZXR1cm4gKHByZWRpY2F0ZShhKSA/IFthXSA6IGVtcHR5KTsgfTtcbn1cbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8vIGNvbnZlcnNpb25zXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vKipcbiAqIEBjYXRlZ29yeSBjb252ZXJzaW9uc1xuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIGZyb21PcHRpb24gPSBmdW5jdGlvbiAobWEpIHsgcmV0dXJuIChfLmlzTm9uZShtYSkgPyBlbXB0eSA6IFttYS52YWx1ZV0pOyB9O1xuLyoqXG4gKiBUcmFuc2Zvcm1zIGFuIGBFaXRoZXJgIHRvIGEgYFJlYWRvbmx5QXJyYXlgLlxuICpcbiAqIEBjYXRlZ29yeSBjb252ZXJzaW9uc1xuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIGZyb21FaXRoZXIgPSBmdW5jdGlvbiAoZSkgeyByZXR1cm4gKF8uaXNMZWZ0KGUpID8gZW1wdHkgOiBbZS5yaWdodF0pOyB9O1xuLyoqXG4gKiBMZXNzIHN0cmljdCB2ZXJzaW9uIG9mIFtgbWF0Y2hgXSgjbWF0Y2gpLlxuICpcbiAqIFRoZSBgV2Agc3VmZml4IChzaG9ydCBmb3IgKipXKippZGVuaW5nKSBtZWFucyB0aGF0IHRoZSBoYW5kbGVyIHJldHVybiB0eXBlcyB3aWxsIGJlIG1lcmdlZC5cbiAqXG4gKiBAY2F0ZWdvcnkgcGF0dGVybiBtYXRjaGluZ1xuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIG1hdGNoVyA9IGZ1bmN0aW9uIChvbkVtcHR5LCBvbk5vbkVtcHR5KSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykge1xuICAgICAgICByZXR1cm4gaXNOb25FbXB0eShhcykgPyBvbk5vbkVtcHR5KGFzKSA6IG9uRW1wdHkoKTtcbiAgICB9O1xufTtcbi8qKlxuICogQGNhdGVnb3J5IHBhdHRlcm4gbWF0Y2hpbmdcbiAqIEBzaW5jZSAyLjExLjBcbiAqL1xuZXhwb3J0IHZhciBtYXRjaCA9IG1hdGNoVztcbi8qKlxuICogTGVzcyBzdHJpY3QgdmVyc2lvbiBvZiBbYG1hdGNoTGVmdGBdKCNtYXRjaGxlZnQpLlxuICpcbiAqIEBjYXRlZ29yeSBwYXR0ZXJuIG1hdGNoaW5nXG4gKiBAc2luY2UgMi4xMS4wXG4gKi9cbmV4cG9ydCB2YXIgbWF0Y2hMZWZ0VyA9IGZ1bmN0aW9uIChvbkVtcHR5LCBvbk5vbkVtcHR5KSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykge1xuICAgICAgICByZXR1cm4gaXNOb25FbXB0eShhcykgPyBvbk5vbkVtcHR5KFJORUEuaGVhZChhcyksIFJORUEudGFpbChhcykpIDogb25FbXB0eSgpO1xuICAgIH07XG59O1xuLyoqXG4gKiBCcmVhayBhIGBSZWFkb25seUFycmF5YCBpbnRvIGl0cyBmaXJzdCBlbGVtZW50IGFuZCByZW1haW5pbmcgZWxlbWVudHMuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IG1hdGNoTGVmdCB9IGZyb20gJ2ZwLXRzL1JlYWRvbmx5QXJyYXknXG4gKlxuICogY29uc3QgbGVuOiA8QT4oYXM6IFJlYWRvbmx5QXJyYXk8QT4pID0+IG51bWJlciA9IG1hdGNoTGVmdCgoKSA9PiAwLCAoXywgdGFpbCkgPT4gMSArIGxlbih0YWlsKSlcbiAqIGFzc2VydC5zdHJpY3RFcXVhbChsZW4oWzEsIDIsIDNdKSwgMylcbiAqXG4gKiBAY2F0ZWdvcnkgcGF0dGVybiBtYXRjaGluZ1xuICogQHNpbmNlIDIuMTAuMFxuICovXG5leHBvcnQgdmFyIG1hdGNoTGVmdCA9IG1hdGNoTGVmdFc7XG4vKipcbiAqIEFsaWFzIG9mIFtgbWF0Y2hMZWZ0YF0oI21hdGNobGVmdCkuXG4gKlxuICogQGNhdGVnb3J5IHBhdHRlcm4gbWF0Y2hpbmdcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIGZvbGRMZWZ0ID0gbWF0Y2hMZWZ0O1xuLyoqXG4gKiBMZXNzIHN0cmljdCB2ZXJzaW9uIG9mIFtgbWF0Y2hSaWdodGBdKCNtYXRjaHJpZ2h0KS5cbiAqXG4gKiBAY2F0ZWdvcnkgcGF0dGVybiBtYXRjaGluZ1xuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIG1hdGNoUmlnaHRXID0gZnVuY3Rpb24gKG9uRW1wdHksIG9uTm9uRW1wdHkpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIHJldHVybiBpc05vbkVtcHR5KGFzKSA/IG9uTm9uRW1wdHkoUk5FQS5pbml0KGFzKSwgUk5FQS5sYXN0KGFzKSkgOiBvbkVtcHR5KCk7XG4gICAgfTtcbn07XG4vKipcbiAqIEJyZWFrIGEgYFJlYWRvbmx5QXJyYXlgIGludG8gaXRzIGluaXRpYWwgZWxlbWVudHMgYW5kIHRoZSBsYXN0IGVsZW1lbnQuXG4gKlxuICogQGNhdGVnb3J5IHBhdHRlcm4gbWF0Y2hpbmdcbiAqIEBzaW5jZSAyLjEwLjBcbiAqL1xuZXhwb3J0IHZhciBtYXRjaFJpZ2h0ID0gbWF0Y2hSaWdodFc7XG4vKipcbiAqIEFsaWFzIG9mIFtgbWF0Y2hSaWdodGBdKCNtYXRjaHJpZ2h0KS5cbiAqXG4gKiBAY2F0ZWdvcnkgcGF0dGVybiBtYXRjaGluZ1xuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgZm9sZFJpZ2h0ID0gbWF0Y2hSaWdodDtcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8vIGNvbWJpbmF0b3JzXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vKipcbiAqIEBjYXRlZ29yeSBzZXF1ZW5jaW5nXG4gKiBAc2luY2UgMi43LjBcbiAqL1xuZXhwb3J0IHZhciBjaGFpbldpdGhJbmRleCA9IGZ1bmN0aW9uIChmKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykge1xuICAgICAgICBpZiAoaXNFbXB0eShhcykpIHtcbiAgICAgICAgICAgIHJldHVybiBlbXB0eTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgb3V0ID0gW107XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgYXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIG91dC5wdXNoLmFwcGx5KG91dCwgZihpLCBhc1tpXSkpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBvdXQ7XG4gICAgfTtcbn07XG4vKipcbiAqIFNhbWUgYXMgYHJlZHVjZWAgYnV0IGl0IGNhcnJpZXMgb3ZlciB0aGUgaW50ZXJtZWRpYXRlIHN0ZXBzLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBzY2FuTGVmdCB9IGZyb20gJ2ZwLXRzL1JlYWRvbmx5QXJyYXknXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChzY2FuTGVmdCgxMCwgKGIsIGE6IG51bWJlcikgPT4gYiAtIGEpKFsxLCAyLCAzXSksIFsxMCwgOSwgNywgNF0pXG4gKlxuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgc2NhbkxlZnQgPSBmdW5jdGlvbiAoYiwgZikge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgdmFyIGxlbiA9IGFzLmxlbmd0aDtcbiAgICAgICAgdmFyIG91dCA9IG5ldyBBcnJheShsZW4gKyAxKTtcbiAgICAgICAgb3V0WzBdID0gYjtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBsZW47IGkrKykge1xuICAgICAgICAgICAgb3V0W2kgKyAxXSA9IGYob3V0W2ldLCBhc1tpXSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG91dDtcbiAgICB9O1xufTtcbi8qKlxuICogRm9sZCBhbiBhcnJheSBmcm9tIHRoZSByaWdodCwga2VlcGluZyBhbGwgaW50ZXJtZWRpYXRlIHJlc3VsdHMgaW5zdGVhZCBvZiBvbmx5IHRoZSBmaW5hbCByZXN1bHRcbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgc2NhblJpZ2h0IH0gZnJvbSAnZnAtdHMvUmVhZG9ubHlBcnJheSdcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKHNjYW5SaWdodCgxMCwgKGE6IG51bWJlciwgYikgPT4gYiAtIGEpKFsxLCAyLCAzXSksIFs0LCA1LCA3LCAxMF0pXG4gKlxuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgc2NhblJpZ2h0ID0gZnVuY3Rpb24gKGIsIGYpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIHZhciBsZW4gPSBhcy5sZW5ndGg7XG4gICAgICAgIHZhciBvdXQgPSBuZXcgQXJyYXkobGVuICsgMSk7XG4gICAgICAgIG91dFtsZW5dID0gYjtcbiAgICAgICAgZm9yICh2YXIgaSA9IGxlbiAtIDE7IGkgPj0gMDsgaS0tKSB7XG4gICAgICAgICAgICBvdXRbaV0gPSBmKGFzW2ldLCBvdXRbaSArIDFdKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gb3V0O1xuICAgIH07XG59O1xuLyoqXG4gKiBDYWxjdWxhdGUgdGhlIG51bWJlciBvZiBlbGVtZW50cyBpbiBhIGBSZWFkb25seUFycmF5YC5cbiAqXG4gKiBAc2luY2UgMi4xMC4wXG4gKi9cbmV4cG9ydCB2YXIgc2l6ZSA9IGZ1bmN0aW9uIChhcykgeyByZXR1cm4gYXMubGVuZ3RoOyB9O1xuLyoqXG4gKiBUZXN0IHdoZXRoZXIgYW4gYXJyYXkgY29udGFpbnMgYSBwYXJ0aWN1bGFyIGluZGV4XG4gKlxuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgaXNPdXRPZkJvdW5kID0gUk5FQS5pc091dE9mQm91bmQ7XG5leHBvcnQgZnVuY3Rpb24gbG9va3VwKGksIGFzKSB7XG4gICAgcmV0dXJuIGFzID09PSB1bmRlZmluZWQgPyBmdW5jdGlvbiAoYXMpIHsgcmV0dXJuIGxvb2t1cChpLCBhcyk7IH0gOiBpc091dE9mQm91bmQoaSwgYXMpID8gXy5ub25lIDogXy5zb21lKGFzW2ldKTtcbn1cbi8qKlxuICogR2V0IHRoZSBmaXJzdCBlbGVtZW50IGluIGFuIGFycmF5LCBvciBgTm9uZWAgaWYgdGhlIGFycmF5IGlzIGVtcHR5XG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IGhlYWQgfSBmcm9tICdmcC10cy9SZWFkb25seUFycmF5J1xuICogaW1wb3J0IHsgc29tZSwgbm9uZSB9IGZyb20gJ2ZwLXRzL09wdGlvbidcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKGhlYWQoWzEsIDIsIDNdKSwgc29tZSgxKSlcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoaGVhZChbXSksIG5vbmUpXG4gKlxuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgaGVhZCA9IGZ1bmN0aW9uIChhcykgeyByZXR1cm4gKGlzTm9uRW1wdHkoYXMpID8gXy5zb21lKFJORUEuaGVhZChhcykpIDogXy5ub25lKTsgfTtcbi8qKlxuICogR2V0IHRoZSBsYXN0IGVsZW1lbnQgaW4gYW4gYXJyYXksIG9yIGBOb25lYCBpZiB0aGUgYXJyYXkgaXMgZW1wdHlcbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgbGFzdCB9IGZyb20gJ2ZwLXRzL1JlYWRvbmx5QXJyYXknXG4gKiBpbXBvcnQgeyBzb21lLCBub25lIH0gZnJvbSAnZnAtdHMvT3B0aW9uJ1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwobGFzdChbMSwgMiwgM10pLCBzb21lKDMpKVxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChsYXN0KFtdKSwgbm9uZSlcbiAqXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBsYXN0ID0gZnVuY3Rpb24gKGFzKSB7IHJldHVybiAoaXNOb25FbXB0eShhcykgPyBfLnNvbWUoUk5FQS5sYXN0KGFzKSkgOiBfLm5vbmUpOyB9O1xuLyoqXG4gKiBHZXQgYWxsIGJ1dCB0aGUgZmlyc3QgZWxlbWVudCBvZiBhbiBhcnJheSwgY3JlYXRpbmcgYSBuZXcgYXJyYXksIG9yIGBOb25lYCBpZiB0aGUgYXJyYXkgaXMgZW1wdHlcbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgdGFpbCB9IGZyb20gJ2ZwLXRzL1JlYWRvbmx5QXJyYXknXG4gKiBpbXBvcnQgeyBzb21lLCBub25lIH0gZnJvbSAnZnAtdHMvT3B0aW9uJ1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwodGFpbChbMSwgMiwgM10pLCBzb21lKFsyLCAzXSkpXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKHRhaWwoW10pLCBub25lKVxuICpcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIHRhaWwgPSBmdW5jdGlvbiAoYXMpIHtcbiAgICByZXR1cm4gaXNOb25FbXB0eShhcykgPyBfLnNvbWUoUk5FQS50YWlsKGFzKSkgOiBfLm5vbmU7XG59O1xuLyoqXG4gKiBHZXQgYWxsIGJ1dCB0aGUgbGFzdCBlbGVtZW50IG9mIGFuIGFycmF5LCBjcmVhdGluZyBhIG5ldyBhcnJheSwgb3IgYE5vbmVgIGlmIHRoZSBhcnJheSBpcyBlbXB0eVxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBpbml0IH0gZnJvbSAnZnAtdHMvUmVhZG9ubHlBcnJheSdcbiAqIGltcG9ydCB7IHNvbWUsIG5vbmUgfSBmcm9tICdmcC10cy9PcHRpb24nXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChpbml0KFsxLCAyLCAzXSksIHNvbWUoWzEsIDJdKSlcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoaW5pdChbXSksIG5vbmUpXG4gKlxuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgaW5pdCA9IGZ1bmN0aW9uIChhcykge1xuICAgIHJldHVybiBpc05vbkVtcHR5KGFzKSA/IF8uc29tZShSTkVBLmluaXQoYXMpKSA6IF8ubm9uZTtcbn07XG4vKipcbiAqIEtlZXAgb25seSBhIG1heCBudW1iZXIgb2YgZWxlbWVudHMgZnJvbSB0aGUgc3RhcnQgb2YgYW4gYFJlYWRvbmx5QXJyYXlgLCBjcmVhdGluZyBhIG5ldyBgUmVhZG9ubHlBcnJheWAuXG4gKlxuICogKipOb3RlKiouIGBuYCBpcyBub3JtYWxpemVkIHRvIGEgbm9uIG5lZ2F0aXZlIGludGVnZXIuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCAqIGFzIFJBIGZyb20gJ2ZwLXRzL1JlYWRvbmx5QXJyYXknXG4gKiBpbXBvcnQgeyBwaXBlIH0gZnJvbSAnZnAtdHMvZnVuY3Rpb24nXG4gKlxuICogY29uc3QgaW5wdXQ6IFJlYWRvbmx5QXJyYXk8bnVtYmVyPiA9IFsxLCAyLCAzXVxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChwaXBlKGlucHV0LCBSQS50YWtlTGVmdCgyKSksIFsxLCAyXSlcbiAqXG4gKiAvLyBvdXQgb2YgYm91bmRzXG4gKiBhc3NlcnQuc3RyaWN0RXF1YWwocGlwZShpbnB1dCwgUkEudGFrZUxlZnQoNCkpLCBpbnB1dClcbiAqIGFzc2VydC5zdHJpY3RFcXVhbChwaXBlKGlucHV0LCBSQS50YWtlTGVmdCgtMSkpLCBpbnB1dClcbiAqXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciB0YWtlTGVmdCA9IGZ1bmN0aW9uIChuKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykge1xuICAgICAgICByZXR1cm4gaXNPdXRPZkJvdW5kKG4sIGFzKSA/IGFzIDogbiA9PT0gMCA/IGVtcHR5IDogYXMuc2xpY2UoMCwgbik7XG4gICAgfTtcbn07XG4vKipcbiAqIEtlZXAgb25seSBhIG1heCBudW1iZXIgb2YgZWxlbWVudHMgZnJvbSB0aGUgZW5kIG9mIGFuIGBSZWFkb25seUFycmF5YCwgY3JlYXRpbmcgYSBuZXcgYFJlYWRvbmx5QXJyYXlgLlxuICpcbiAqICoqTm90ZSoqLiBgbmAgaXMgbm9ybWFsaXplZCB0byBhIG5vbiBuZWdhdGl2ZSBpbnRlZ2VyLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgKiBhcyBSQSBmcm9tICdmcC10cy9SZWFkb25seUFycmF5J1xuICogaW1wb3J0IHsgcGlwZSB9IGZyb20gJ2ZwLXRzL2Z1bmN0aW9uJ1xuICpcbiAqIGNvbnN0IGlucHV0OiBSZWFkb25seUFycmF5PG51bWJlcj4gPSBbMSwgMiwgM11cbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwocGlwZShpbnB1dCwgUkEudGFrZVJpZ2h0KDIpKSwgWzIsIDNdKVxuICpcbiAqIC8vIG91dCBvZiBib3VuZHNcbiAqIGFzc2VydC5zdHJpY3RFcXVhbChwaXBlKGlucHV0LCBSQS50YWtlUmlnaHQoNCkpLCBpbnB1dClcbiAqIGFzc2VydC5zdHJpY3RFcXVhbChwaXBlKGlucHV0LCBSQS50YWtlUmlnaHQoLTEpKSwgaW5wdXQpXG4gKlxuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgdGFrZVJpZ2h0ID0gZnVuY3Rpb24gKG4pIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIHJldHVybiBpc091dE9mQm91bmQobiwgYXMpID8gYXMgOiBuID09PSAwID8gZW1wdHkgOiBhcy5zbGljZSgtbik7XG4gICAgfTtcbn07XG5leHBvcnQgZnVuY3Rpb24gdGFrZUxlZnRXaGlsZShwcmVkaWNhdGUpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIHZhciBvdXQgPSBbXTtcbiAgICAgICAgZm9yICh2YXIgX2kgPSAwLCBhc18xID0gYXM7IF9pIDwgYXNfMS5sZW5ndGg7IF9pKyspIHtcbiAgICAgICAgICAgIHZhciBhID0gYXNfMVtfaV07XG4gICAgICAgICAgICBpZiAoIXByZWRpY2F0ZShhKSkge1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgb3V0LnB1c2goYSk7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGxlbiA9IG91dC5sZW5ndGg7XG4gICAgICAgIHJldHVybiBsZW4gPT09IGFzLmxlbmd0aCA/IGFzIDogbGVuID09PSAwID8gZW1wdHkgOiBvdXQ7XG4gICAgfTtcbn1cbnZhciBzcGFuTGVmdEluZGV4ID0gZnVuY3Rpb24gKGFzLCBwcmVkaWNhdGUpIHtcbiAgICB2YXIgbCA9IGFzLmxlbmd0aDtcbiAgICB2YXIgaSA9IDA7XG4gICAgZm9yICg7IGkgPCBsOyBpKyspIHtcbiAgICAgICAgaWYgKCFwcmVkaWNhdGUoYXNbaV0pKSB7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gaTtcbn07XG5leHBvcnQgZnVuY3Rpb24gc3BhbkxlZnQocHJlZGljYXRlKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykge1xuICAgICAgICB2YXIgX2EgPSBzcGxpdEF0KHNwYW5MZWZ0SW5kZXgoYXMsIHByZWRpY2F0ZSkpKGFzKSwgaW5pdCA9IF9hWzBdLCByZXN0ID0gX2FbMV07XG4gICAgICAgIHJldHVybiB7IGluaXQ6IGluaXQsIHJlc3Q6IHJlc3QgfTtcbiAgICB9O1xufVxuLyoqXG4gKiBEcm9wIGEgbWF4IG51bWJlciBvZiBlbGVtZW50cyBmcm9tIHRoZSBzdGFydCBvZiBhbiBgUmVhZG9ubHlBcnJheWAsIGNyZWF0aW5nIGEgbmV3IGBSZWFkb25seUFycmF5YC5cbiAqXG4gKiAqKk5vdGUqKi4gYG5gIGlzIG5vcm1hbGl6ZWQgdG8gYSBub24gbmVnYXRpdmUgaW50ZWdlci5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0ICogYXMgUkEgZnJvbSAnZnAtdHMvUmVhZG9ubHlBcnJheSdcbiAqIGltcG9ydCB7IHBpcGUgfSBmcm9tICdmcC10cy9mdW5jdGlvbidcbiAqXG4gKiBjb25zdCBpbnB1dDogUmVhZG9ubHlBcnJheTxudW1iZXI+ID0gWzEsIDIsIDNdXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKHBpcGUoaW5wdXQsIFJBLmRyb3BMZWZ0KDIpKSwgWzNdKVxuICogYXNzZXJ0LnN0cmljdEVxdWFsKHBpcGUoaW5wdXQsIFJBLmRyb3BMZWZ0KDApKSwgaW5wdXQpXG4gKiBhc3NlcnQuc3RyaWN0RXF1YWwocGlwZShpbnB1dCwgUkEuZHJvcExlZnQoLTEpKSwgaW5wdXQpXG4gKlxuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgZHJvcExlZnQgPSBmdW5jdGlvbiAobikge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgcmV0dXJuIG4gPD0gMCB8fCBpc0VtcHR5KGFzKSA/IGFzIDogbiA+PSBhcy5sZW5ndGggPyBlbXB0eSA6IGFzLnNsaWNlKG4sIGFzLmxlbmd0aCk7XG4gICAgfTtcbn07XG4vKipcbiAqIERyb3AgYSBtYXggbnVtYmVyIG9mIGVsZW1lbnRzIGZyb20gdGhlIGVuZCBvZiBhbiBgUmVhZG9ubHlBcnJheWAsIGNyZWF0aW5nIGEgbmV3IGBSZWFkb25seUFycmF5YC5cbiAqXG4gKiAqKk5vdGUqKi4gYG5gIGlzIG5vcm1hbGl6ZWQgdG8gYSBub24gbmVnYXRpdmUgaW50ZWdlci5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0ICogYXMgUkEgZnJvbSAnZnAtdHMvUmVhZG9ubHlBcnJheSdcbiAqIGltcG9ydCB7IHBpcGUgfSBmcm9tICdmcC10cy9mdW5jdGlvbidcbiAqXG4gKiBjb25zdCBpbnB1dDogUmVhZG9ubHlBcnJheTxudW1iZXI+ID0gWzEsIDIsIDNdXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKHBpcGUoaW5wdXQsIFJBLmRyb3BSaWdodCgyKSksIFsxXSlcbiAqIGFzc2VydC5zdHJpY3RFcXVhbChwaXBlKGlucHV0LCBSQS5kcm9wUmlnaHQoMCkpLCBpbnB1dClcbiAqIGFzc2VydC5zdHJpY3RFcXVhbChwaXBlKGlucHV0LCBSQS5kcm9wUmlnaHQoLTEpKSwgaW5wdXQpXG4gKlxuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgZHJvcFJpZ2h0ID0gZnVuY3Rpb24gKG4pIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIHJldHVybiBuIDw9IDAgfHwgaXNFbXB0eShhcykgPyBhcyA6IG4gPj0gYXMubGVuZ3RoID8gZW1wdHkgOiBhcy5zbGljZSgwLCBhcy5sZW5ndGggLSBuKTtcbiAgICB9O1xufTtcbmV4cG9ydCBmdW5jdGlvbiBkcm9wTGVmdFdoaWxlKHByZWRpY2F0ZSkge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgdmFyIGkgPSBzcGFuTGVmdEluZGV4KGFzLCBwcmVkaWNhdGUpO1xuICAgICAgICByZXR1cm4gaSA9PT0gMCA/IGFzIDogaSA9PT0gYXMubGVuZ3RoID8gZW1wdHkgOiBhcy5zbGljZShpKTtcbiAgICB9O1xufVxuLyoqXG4gKiBGaW5kIHRoZSBmaXJzdCBpbmRleCBmb3Igd2hpY2ggYSBwcmVkaWNhdGUgaG9sZHNcbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgZmluZEluZGV4IH0gZnJvbSAnZnAtdHMvUmVhZG9ubHlBcnJheSdcbiAqIGltcG9ydCB7IHNvbWUsIG5vbmUgfSBmcm9tICdmcC10cy9PcHRpb24nXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChmaW5kSW5kZXgoKG46IG51bWJlcikgPT4gbiA9PT0gMikoWzEsIDIsIDNdKSwgc29tZSgxKSlcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoZmluZEluZGV4KChuOiBudW1iZXIpID0+IG4gPT09IDIpKFtdKSwgbm9uZSlcbiAqXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBmaW5kSW5kZXggPSBmdW5jdGlvbiAocHJlZGljYXRlKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykge1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGFzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICBpZiAocHJlZGljYXRlKGFzW2ldKSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBfLnNvbWUoaSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIF8ubm9uZTtcbiAgICB9O1xufTtcbmV4cG9ydCBmdW5jdGlvbiBmaW5kRmlyc3QocHJlZGljYXRlKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykge1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGFzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICBpZiAocHJlZGljYXRlKGFzW2ldKSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBfLnNvbWUoYXNbaV0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBfLm5vbmU7XG4gICAgfTtcbn1cbi8qKlxuICogRmluZCB0aGUgZmlyc3QgZWxlbWVudCByZXR1cm5lZCBieSBhbiBvcHRpb24gYmFzZWQgc2VsZWN0b3IgZnVuY3Rpb25cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgZmluZEZpcnN0TWFwIH0gZnJvbSAnZnAtdHMvUmVhZG9ubHlBcnJheSdcbiAqIGltcG9ydCB7IHNvbWUsIG5vbmUgfSBmcm9tICdmcC10cy9PcHRpb24nXG4gKlxuICogaW50ZXJmYWNlIFBlcnNvbiB7XG4gKiAgIHJlYWRvbmx5IG5hbWU6IHN0cmluZ1xuICogICByZWFkb25seSBhZ2U/OiBudW1iZXJcbiAqIH1cbiAqXG4gKiBjb25zdCBwZXJzb25zOiBSZWFkb25seUFycmF5PFBlcnNvbj4gPSBbeyBuYW1lOiAnSm9obicgfSwgeyBuYW1lOiAnTWFyeScsIGFnZTogNDUgfSwgeyBuYW1lOiAnSm9leScsIGFnZTogMjggfV1cbiAqXG4gKiAvLyByZXR1cm5zIHRoZSBuYW1lIG9mIHRoZSBmaXJzdCBwZXJzb24gdGhhdCBoYXMgYW4gYWdlXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKGZpbmRGaXJzdE1hcCgocDogUGVyc29uKSA9PiAocC5hZ2UgPT09IHVuZGVmaW5lZCA/IG5vbmUgOiBzb21lKHAubmFtZSkpKShwZXJzb25zKSwgc29tZSgnTWFyeScpKVxuICpcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIGZpbmRGaXJzdE1hcCA9IGZ1bmN0aW9uIChmKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykge1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGFzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICB2YXIgb3V0ID0gZihhc1tpXSk7XG4gICAgICAgICAgICBpZiAoXy5pc1NvbWUob3V0KSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBvdXQ7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIF8ubm9uZTtcbiAgICB9O1xufTtcbmV4cG9ydCBmdW5jdGlvbiBmaW5kTGFzdChwcmVkaWNhdGUpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIGZvciAodmFyIGkgPSBhcy5sZW5ndGggLSAxOyBpID49IDA7IGktLSkge1xuICAgICAgICAgICAgaWYgKHByZWRpY2F0ZShhc1tpXSkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gXy5zb21lKGFzW2ldKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gXy5ub25lO1xuICAgIH07XG59XG4vKipcbiAqIEZpbmQgdGhlIGxhc3QgZWxlbWVudCByZXR1cm5lZCBieSBhbiBvcHRpb24gYmFzZWQgc2VsZWN0b3IgZnVuY3Rpb25cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgZmluZExhc3RNYXAgfSBmcm9tICdmcC10cy9SZWFkb25seUFycmF5J1xuICogaW1wb3J0IHsgc29tZSwgbm9uZSB9IGZyb20gJ2ZwLXRzL09wdGlvbidcbiAqXG4gKiBpbnRlcmZhY2UgUGVyc29uIHtcbiAqICAgcmVhZG9ubHkgbmFtZTogc3RyaW5nXG4gKiAgIHJlYWRvbmx5IGFnZT86IG51bWJlclxuICogfVxuICpcbiAqIGNvbnN0IHBlcnNvbnM6IFJlYWRvbmx5QXJyYXk8UGVyc29uPiA9IFt7IG5hbWU6ICdKb2huJyB9LCB7IG5hbWU6ICdNYXJ5JywgYWdlOiA0NSB9LCB7IG5hbWU6ICdKb2V5JywgYWdlOiAyOCB9XVxuICpcbiAqIC8vIHJldHVybnMgdGhlIG5hbWUgb2YgdGhlIGxhc3QgcGVyc29uIHRoYXQgaGFzIGFuIGFnZVxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChmaW5kTGFzdE1hcCgocDogUGVyc29uKSA9PiAocC5hZ2UgPT09IHVuZGVmaW5lZCA/IG5vbmUgOiBzb21lKHAubmFtZSkpKShwZXJzb25zKSwgc29tZSgnSm9leScpKVxuICpcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIGZpbmRMYXN0TWFwID0gZnVuY3Rpb24gKGYpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIGZvciAodmFyIGkgPSBhcy5sZW5ndGggLSAxOyBpID49IDA7IGktLSkge1xuICAgICAgICAgICAgdmFyIG91dCA9IGYoYXNbaV0pO1xuICAgICAgICAgICAgaWYgKF8uaXNTb21lKG91dCkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gb3V0O1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBfLm5vbmU7XG4gICAgfTtcbn07XG4vKipcbiAqIFJldHVybnMgdGhlIGluZGV4IG9mIHRoZSBsYXN0IGVsZW1lbnQgb2YgdGhlIGxpc3Qgd2hpY2ggbWF0Y2hlcyB0aGUgcHJlZGljYXRlXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IGZpbmRMYXN0SW5kZXggfSBmcm9tICdmcC10cy9SZWFkb25seUFycmF5J1xuICogaW1wb3J0IHsgc29tZSwgbm9uZSB9IGZyb20gJ2ZwLXRzL09wdGlvbidcbiAqXG4gKiBpbnRlcmZhY2UgWCB7XG4gKiAgIHJlYWRvbmx5IGE6IG51bWJlclxuICogICByZWFkb25seSBiOiBudW1iZXJcbiAqIH1cbiAqIGNvbnN0IHhzOiBSZWFkb25seUFycmF5PFg+ID0gW3sgYTogMSwgYjogMCB9LCB7IGE6IDEsIGI6IDEgfV1cbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoZmluZExhc3RJbmRleCgoeDogeyByZWFkb25seSBhOiBudW1iZXIgfSkgPT4geC5hID09PSAxKSh4cyksIHNvbWUoMSkpXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKGZpbmRMYXN0SW5kZXgoKHg6IHsgcmVhZG9ubHkgYTogbnVtYmVyIH0pID0+IHguYSA9PT0gNCkoeHMpLCBub25lKVxuICpcbiAqXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBmaW5kTGFzdEluZGV4ID0gZnVuY3Rpb24gKHByZWRpY2F0ZSkge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgZm9yICh2YXIgaSA9IGFzLmxlbmd0aCAtIDE7IGkgPj0gMDsgaS0tKSB7XG4gICAgICAgICAgICBpZiAocHJlZGljYXRlKGFzW2ldKSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBfLnNvbWUoaSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIF8ubm9uZTtcbiAgICB9O1xufTtcbi8qKlxuICogSW5zZXJ0IGFuIGVsZW1lbnQgYXQgdGhlIHNwZWNpZmllZCBpbmRleCwgY3JlYXRpbmcgYSBuZXcgYXJyYXksIG9yIHJldHVybmluZyBgTm9uZWAgaWYgdGhlIGluZGV4IGlzIG91dCBvZiBib3VuZHNcbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgaW5zZXJ0QXQgfSBmcm9tICdmcC10cy9SZWFkb25seUFycmF5J1xuICogaW1wb3J0IHsgc29tZSB9IGZyb20gJ2ZwLXRzL09wdGlvbidcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKGluc2VydEF0KDIsIDUpKFsxLCAyLCAzLCA0XSksIHNvbWUoWzEsIDIsIDUsIDMsIDRdKSlcbiAqXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBpbnNlcnRBdCA9IGZ1bmN0aW9uIChpLCBhKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykge1xuICAgICAgICByZXR1cm4gaSA8IDAgfHwgaSA+IGFzLmxlbmd0aCA/IF8ubm9uZSA6IF8uc29tZShSTkVBLnVuc2FmZUluc2VydEF0KGksIGEsIGFzKSk7XG4gICAgfTtcbn07XG4vKipcbiAqIENoYW5nZSB0aGUgZWxlbWVudCBhdCB0aGUgc3BlY2lmaWVkIGluZGV4LCBjcmVhdGluZyBhIG5ldyBhcnJheSwgb3IgcmV0dXJuaW5nIGBOb25lYCBpZiB0aGUgaW5kZXggaXMgb3V0IG9mIGJvdW5kc1xuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyB1cGRhdGVBdCB9IGZyb20gJ2ZwLXRzL1JlYWRvbmx5QXJyYXknXG4gKiBpbXBvcnQgeyBzb21lLCBub25lIH0gZnJvbSAnZnAtdHMvT3B0aW9uJ1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwodXBkYXRlQXQoMSwgMSkoWzEsIDIsIDNdKSwgc29tZShbMSwgMSwgM10pKVxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbCh1cGRhdGVBdCgxLCAxKShbXSksIG5vbmUpXG4gKlxuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgdXBkYXRlQXQgPSBmdW5jdGlvbiAoaSwgYSkge1xuICAgIHJldHVybiBtb2RpZnlBdChpLCBmdW5jdGlvbiAoKSB7IHJldHVybiBhOyB9KTtcbn07XG4vKipcbiAqIERlbGV0ZSB0aGUgZWxlbWVudCBhdCB0aGUgc3BlY2lmaWVkIGluZGV4LCBjcmVhdGluZyBhIG5ldyBhcnJheSwgb3IgcmV0dXJuaW5nIGBOb25lYCBpZiB0aGUgaW5kZXggaXMgb3V0IG9mIGJvdW5kc1xuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBkZWxldGVBdCB9IGZyb20gJ2ZwLXRzL1JlYWRvbmx5QXJyYXknXG4gKiBpbXBvcnQgeyBzb21lLCBub25lIH0gZnJvbSAnZnAtdHMvT3B0aW9uJ1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoZGVsZXRlQXQoMCkoWzEsIDIsIDNdKSwgc29tZShbMiwgM10pKVxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChkZWxldGVBdCgxKShbXSksIG5vbmUpXG4gKlxuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgZGVsZXRlQXQgPSBmdW5jdGlvbiAoaSkge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgcmV0dXJuIGlzT3V0T2ZCb3VuZChpLCBhcykgPyBfLm5vbmUgOiBfLnNvbWUodW5zYWZlRGVsZXRlQXQoaSwgYXMpKTtcbiAgICB9O1xufTtcbi8qKlxuICogQXBwbHkgYSBmdW5jdGlvbiB0byB0aGUgZWxlbWVudCBhdCB0aGUgc3BlY2lmaWVkIGluZGV4LCBjcmVhdGluZyBhIG5ldyBhcnJheSwgb3IgcmV0dXJuaW5nIGBOb25lYCBpZiB0aGUgaW5kZXggaXMgb3V0XG4gKiBvZiBib3VuZHNcbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgbW9kaWZ5QXQgfSBmcm9tICdmcC10cy9SZWFkb25seUFycmF5J1xuICogaW1wb3J0IHsgc29tZSwgbm9uZSB9IGZyb20gJ2ZwLXRzL09wdGlvbidcbiAqXG4gKiBjb25zdCBkb3VibGUgPSAoeDogbnVtYmVyKTogbnVtYmVyID0+IHggKiAyXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKG1vZGlmeUF0KDEsIGRvdWJsZSkoWzEsIDIsIDNdKSwgc29tZShbMSwgNCwgM10pKVxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChtb2RpZnlBdCgxLCBkb3VibGUpKFtdKSwgbm9uZSlcbiAqXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBtb2RpZnlBdCA9IGZ1bmN0aW9uIChpLCBmKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykge1xuICAgICAgICByZXR1cm4gaXNPdXRPZkJvdW5kKGksIGFzKSA/IF8ubm9uZSA6IF8uc29tZSh1bnNhZmVVcGRhdGVBdChpLCBmKGFzW2ldKSwgYXMpKTtcbiAgICB9O1xufTtcbi8qKlxuICogUmV2ZXJzZSBhbiBhcnJheSwgY3JlYXRpbmcgYSBuZXcgYXJyYXlcbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgcmV2ZXJzZSB9IGZyb20gJ2ZwLXRzL1JlYWRvbmx5QXJyYXknXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChyZXZlcnNlKFsxLCAyLCAzXSksIFszLCAyLCAxXSlcbiAqXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciByZXZlcnNlID0gZnVuY3Rpb24gKGFzKSB7IHJldHVybiAoYXMubGVuZ3RoIDw9IDEgPyBhcyA6IGFzLnNsaWNlKCkucmV2ZXJzZSgpKTsgfTtcbi8qKlxuICogRXh0cmFjdHMgZnJvbSBhbiBhcnJheSBvZiBgRWl0aGVyYCBhbGwgdGhlIGBSaWdodGAgZWxlbWVudHMuIEFsbCB0aGUgYFJpZ2h0YCBlbGVtZW50cyBhcmUgZXh0cmFjdGVkIGluIG9yZGVyXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IHJpZ2h0cyB9IGZyb20gJ2ZwLXRzL1JlYWRvbmx5QXJyYXknXG4gKiBpbXBvcnQgeyByaWdodCwgbGVmdCB9IGZyb20gJ2ZwLXRzL0VpdGhlcidcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKHJpZ2h0cyhbcmlnaHQoMSksIGxlZnQoJ2ZvbycpLCByaWdodCgyKV0pLCBbMSwgMl0pXG4gKlxuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgcmlnaHRzID0gZnVuY3Rpb24gKGFzKSB7XG4gICAgdmFyIHIgPSBbXTtcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IGFzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIHZhciBhID0gYXNbaV07XG4gICAgICAgIGlmIChhLl90YWcgPT09ICdSaWdodCcpIHtcbiAgICAgICAgICAgIHIucHVzaChhLnJpZ2h0KTtcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gcjtcbn07XG4vKipcbiAqIEV4dHJhY3RzIGZyb20gYW4gYXJyYXkgb2YgYEVpdGhlcmAgYWxsIHRoZSBgTGVmdGAgZWxlbWVudHMuIEFsbCB0aGUgYExlZnRgIGVsZW1lbnRzIGFyZSBleHRyYWN0ZWQgaW4gb3JkZXJcbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgbGVmdHMgfSBmcm9tICdmcC10cy9SZWFkb25seUFycmF5J1xuICogaW1wb3J0IHsgbGVmdCwgcmlnaHQgfSBmcm9tICdmcC10cy9FaXRoZXInXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChsZWZ0cyhbcmlnaHQoMSksIGxlZnQoJ2ZvbycpLCByaWdodCgyKV0pLCBbJ2ZvbyddKVxuICpcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIGxlZnRzID0gZnVuY3Rpb24gKGFzKSB7XG4gICAgdmFyIHIgPSBbXTtcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IGFzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIHZhciBhID0gYXNbaV07XG4gICAgICAgIGlmIChhLl90YWcgPT09ICdMZWZ0Jykge1xuICAgICAgICAgICAgci5wdXNoKGEubGVmdCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHI7XG59O1xuLyoqXG4gKiBTb3J0IHRoZSBlbGVtZW50cyBvZiBhbiBhcnJheSBpbiBpbmNyZWFzaW5nIG9yZGVyLCBjcmVhdGluZyBhIG5ldyBhcnJheVxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBzb3J0IH0gZnJvbSAnZnAtdHMvUmVhZG9ubHlBcnJheSdcbiAqIGltcG9ydCAqIGFzIE4gZnJvbSAnZnAtdHMvbnVtYmVyJ1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoc29ydChOLk9yZCkoWzMsIDIsIDFdKSwgWzEsIDIsIDNdKVxuICpcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIHNvcnQgPSBmdW5jdGlvbiAoTykge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgcmV0dXJuIGFzLmxlbmd0aCA8PSAxID8gYXMgOiBhcy5zbGljZSgpLnNvcnQoTy5jb21wYXJlKTtcbiAgICB9O1xufTtcbi8vIFRPRE86IGN1cnJ5IGFuZCBtYWtlIGRhdGEtbGFzdCBpbiB2M1xuLyoqXG4gKiBBcHBseSBhIGZ1bmN0aW9uIHRvIHBhaXJzIG9mIGVsZW1lbnRzIGF0IHRoZSBzYW1lIGluZGV4IGluIHR3byBhcnJheXMsIGNvbGxlY3RpbmcgdGhlIHJlc3VsdHMgaW4gYSBuZXcgYXJyYXkuIElmIG9uZVxuICogaW5wdXQgYXJyYXkgaXMgc2hvcnQsIGV4Y2VzcyBlbGVtZW50cyBvZiB0aGUgbG9uZ2VyIGFycmF5IGFyZSBkaXNjYXJkZWQuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IHppcFdpdGggfSBmcm9tICdmcC10cy9SZWFkb25seUFycmF5J1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoemlwV2l0aChbMSwgMiwgM10sIFsnYScsICdiJywgJ2MnLCAnZCddLCAobiwgcykgPT4gcyArIG4pLCBbJ2ExJywgJ2IyJywgJ2MzJ10pXG4gKlxuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgemlwV2l0aCA9IGZ1bmN0aW9uIChmYSwgZmIsIGYpIHtcbiAgICB2YXIgZmMgPSBbXTtcbiAgICB2YXIgbGVuID0gTWF0aC5taW4oZmEubGVuZ3RoLCBmYi5sZW5ndGgpO1xuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbGVuOyBpKyspIHtcbiAgICAgICAgZmNbaV0gPSBmKGZhW2ldLCBmYltpXSk7XG4gICAgfVxuICAgIHJldHVybiBmYztcbn07XG5leHBvcnQgZnVuY3Rpb24gemlwKGFzLCBicykge1xuICAgIGlmIChicyA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgIHJldHVybiBmdW5jdGlvbiAoYnMpIHsgcmV0dXJuIHppcChicywgYXMpOyB9O1xuICAgIH1cbiAgICByZXR1cm4gemlwV2l0aChhcywgYnMsIGZ1bmN0aW9uIChhLCBiKSB7IHJldHVybiBbYSwgYl07IH0pO1xufVxuLyoqXG4gKiBUaGUgZnVuY3Rpb24gaXMgcmV2ZXJzZSBvZiBgemlwYC4gVGFrZXMgYW4gYXJyYXkgb2YgcGFpcnMgYW5kIHJldHVybiB0d28gY29ycmVzcG9uZGluZyBhcnJheXNcbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgdW56aXAgfSBmcm9tICdmcC10cy9SZWFkb25seUFycmF5J1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwodW56aXAoW1sxLCAnYSddLCBbMiwgJ2InXSwgWzMsICdjJ11dKSwgW1sxLCAyLCAzXSwgWydhJywgJ2InLCAnYyddXSlcbiAqXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciB1bnppcCA9IGZ1bmN0aW9uIChhcykge1xuICAgIHZhciBmYSA9IFtdO1xuICAgIHZhciBmYiA9IFtdO1xuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgYXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgZmFbaV0gPSBhc1tpXVswXTtcbiAgICAgICAgZmJbaV0gPSBhc1tpXVsxXTtcbiAgICB9XG4gICAgcmV0dXJuIFtmYSwgZmJdO1xufTtcbi8qKlxuICogUHJlcGVuZCBhbiBlbGVtZW50IHRvIGV2ZXJ5IG1lbWJlciBvZiBhbiBhcnJheVxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBwcmVwZW5kQWxsIH0gZnJvbSAnZnAtdHMvUmVhZG9ubHlBcnJheSdcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKHByZXBlbmRBbGwoOSkoWzEsIDIsIDMsIDRdKSwgWzksIDEsIDksIDIsIDksIDMsIDksIDRdKVxuICpcbiAqIEBzaW5jZSAyLjEwLjBcbiAqL1xuZXhwb3J0IHZhciBwcmVwZW5kQWxsID0gZnVuY3Rpb24gKG1pZGRsZSkge1xuICAgIHZhciBmID0gUk5FQS5wcmVwZW5kQWxsKG1pZGRsZSk7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykgeyByZXR1cm4gKGlzTm9uRW1wdHkoYXMpID8gZihhcykgOiBhcyk7IH07XG59O1xuLyoqXG4gKiBQbGFjZXMgYW4gZWxlbWVudCBpbiBiZXR3ZWVuIG1lbWJlcnMgb2YgYW4gYXJyYXlcbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgaW50ZXJzcGVyc2UgfSBmcm9tICdmcC10cy9SZWFkb25seUFycmF5J1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoaW50ZXJzcGVyc2UoOSkoWzEsIDIsIDMsIDRdKSwgWzEsIDksIDIsIDksIDMsIDksIDRdKVxuICpcbiAqIEBzaW5jZSAyLjkuMFxuICovXG5leHBvcnQgdmFyIGludGVyc3BlcnNlID0gZnVuY3Rpb24gKG1pZGRsZSkge1xuICAgIHZhciBmID0gUk5FQS5pbnRlcnNwZXJzZShtaWRkbGUpO1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHsgcmV0dXJuIChpc05vbkVtcHR5KGFzKSA/IGYoYXMpIDogYXMpOyB9O1xufTtcbi8qKlxuICogUm90YXRlIGEgYFJlYWRvbmx5QXJyYXlgIGJ5IGBuYCBzdGVwcy5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgcm90YXRlIH0gZnJvbSAnZnAtdHMvUmVhZG9ubHlBcnJheSdcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKHJvdGF0ZSgyKShbMSwgMiwgMywgNCwgNV0pLCBbNCwgNSwgMSwgMiwgM10pXG4gKlxuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgcm90YXRlID0gZnVuY3Rpb24gKG4pIHtcbiAgICB2YXIgZiA9IFJORUEucm90YXRlKG4pO1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHsgcmV0dXJuIChpc05vbkVtcHR5KGFzKSA/IGYoYXMpIDogYXMpOyB9O1xufTtcbmV4cG9ydCBmdW5jdGlvbiBlbGVtKEUpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGEsIGFzKSB7XG4gICAgICAgIGlmIChhcyA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICB2YXIgZWxlbUVfMSA9IGVsZW0oRSk7XG4gICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7IHJldHVybiBlbGVtRV8xKGEsIGFzKTsgfTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgcHJlZGljYXRlID0gZnVuY3Rpb24gKGVsZW1lbnQpIHsgcmV0dXJuIEUuZXF1YWxzKGVsZW1lbnQsIGEpOyB9O1xuICAgICAgICB2YXIgaSA9IDA7XG4gICAgICAgIGZvciAoOyBpIDwgYXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIGlmIChwcmVkaWNhdGUoYXNbaV0pKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH07XG59XG4vKipcbiAqIFJlbW92ZSBkdXBsaWNhdGVzIGZyb20gYW4gYXJyYXksIGtlZXBpbmcgdGhlIGZpcnN0IG9jY3VycmVuY2Ugb2YgYW4gZWxlbWVudC5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgdW5pcSB9IGZyb20gJ2ZwLXRzL1JlYWRvbmx5QXJyYXknXG4gKiBpbXBvcnQgKiBhcyBOIGZyb20gJ2ZwLXRzL251bWJlcidcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKHVuaXEoTi5FcSkoWzEsIDIsIDFdKSwgWzEsIDJdKVxuICpcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIHVuaXEgPSBmdW5jdGlvbiAoRSkge1xuICAgIHZhciBmID0gUk5FQS51bmlxKEUpO1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHsgcmV0dXJuIChpc05vbkVtcHR5KGFzKSA/IGYoYXMpIDogYXMpOyB9O1xufTtcbi8qKlxuICogU29ydCB0aGUgZWxlbWVudHMgb2YgYW4gYXJyYXkgaW4gaW5jcmVhc2luZyBvcmRlciwgd2hlcmUgZWxlbWVudHMgYXJlIGNvbXBhcmVkIHVzaW5nIGZpcnN0IGBvcmRzWzBdYCwgdGhlbiBgb3Jkc1sxXWAsXG4gKiBldGMuLi5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgc29ydEJ5IH0gZnJvbSAnZnAtdHMvUmVhZG9ubHlBcnJheSdcbiAqIGltcG9ydCB7IGNvbnRyYW1hcCB9IGZyb20gJ2ZwLXRzL09yZCdcbiAqIGltcG9ydCAqIGFzIFMgZnJvbSAnZnAtdHMvc3RyaW5nJ1xuICogaW1wb3J0ICogYXMgTiBmcm9tICdmcC10cy9udW1iZXInXG4gKiBpbXBvcnQgeyBwaXBlIH0gZnJvbSAnZnAtdHMvZnVuY3Rpb24nXG4gKlxuICogaW50ZXJmYWNlIFBlcnNvbiB7XG4gKiAgIHJlYWRvbmx5IG5hbWU6IHN0cmluZ1xuICogICByZWFkb25seSBhZ2U6IG51bWJlclxuICogfVxuICogY29uc3QgYnlOYW1lID0gcGlwZShTLk9yZCwgY29udHJhbWFwKChwOiBQZXJzb24pID0+IHAubmFtZSkpXG4gKiBjb25zdCBieUFnZSA9IHBpcGUoTi5PcmQsIGNvbnRyYW1hcCgocDogUGVyc29uKSA9PiBwLmFnZSkpXG4gKlxuICogY29uc3Qgc29ydEJ5TmFtZUJ5QWdlID0gc29ydEJ5KFtieU5hbWUsIGJ5QWdlXSlcbiAqXG4gKiBjb25zdCBwZXJzb25zID0gW3sgbmFtZTogJ2EnLCBhZ2U6IDEgfSwgeyBuYW1lOiAnYicsIGFnZTogMyB9LCB7IG5hbWU6ICdjJywgYWdlOiAyIH0sIHsgbmFtZTogJ2InLCBhZ2U6IDIgfV1cbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoc29ydEJ5TmFtZUJ5QWdlKHBlcnNvbnMpLCBbXG4gKiAgIHsgbmFtZTogJ2EnLCBhZ2U6IDEgfSxcbiAqICAgeyBuYW1lOiAnYicsIGFnZTogMiB9LFxuICogICB7IG5hbWU6ICdiJywgYWdlOiAzIH0sXG4gKiAgIHsgbmFtZTogJ2MnLCBhZ2U6IDIgfVxuICogXSlcbiAqXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBzb3J0QnkgPSBmdW5jdGlvbiAob3Jkcykge1xuICAgIHZhciBmID0gUk5FQS5zb3J0Qnkob3Jkcyk7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykgeyByZXR1cm4gKGlzTm9uRW1wdHkoYXMpID8gZihhcykgOiBhcyk7IH07XG59O1xuLyoqXG4gKiBBIHVzZWZ1bCByZWN1cnNpb24gcGF0dGVybiBmb3IgcHJvY2Vzc2luZyBhIGBSZWFkb25seUFycmF5YCB0byBwcm9kdWNlIGEgbmV3IGBSZWFkb25seUFycmF5YCwgb2Z0ZW4gdXNlZCBmb3IgXCJjaG9wcGluZ1wiIHVwIHRoZSBpbnB1dFxuICogYFJlYWRvbmx5QXJyYXlgLiBUeXBpY2FsbHkgYGNob3BgIGlzIGNhbGxlZCB3aXRoIHNvbWUgZnVuY3Rpb24gdGhhdCB3aWxsIGNvbnN1bWUgYW4gaW5pdGlhbCBwcmVmaXggb2YgdGhlIGBSZWFkb25seUFycmF5YCBhbmQgcHJvZHVjZSBhXG4gKiB2YWx1ZSBhbmQgdGhlIHRhaWwgb2YgdGhlIGBSZWFkb25seUFycmF5YC5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgRXEgfSBmcm9tICdmcC10cy9FcSdcbiAqIGltcG9ydCAqIGFzIFJBIGZyb20gJ2ZwLXRzL1JlYWRvbmx5QXJyYXknXG4gKiBpbXBvcnQgKiBhcyBOIGZyb20gJ2ZwLXRzL251bWJlcidcbiAqIGltcG9ydCB7IHBpcGUgfSBmcm9tICdmcC10cy9mdW5jdGlvbidcbiAqXG4gKiBjb25zdCBncm91cCA9IDxBPihTOiBFcTxBPik6ICgoYXM6IFJlYWRvbmx5QXJyYXk8QT4pID0+IFJlYWRvbmx5QXJyYXk8UmVhZG9ubHlBcnJheTxBPj4pID0+IHtcbiAqICAgcmV0dXJuIFJBLmNob3AoYXMgPT4ge1xuICogICAgIGNvbnN0IHsgaW5pdCwgcmVzdCB9ID0gcGlwZShhcywgUkEuc3BhbkxlZnQoKGE6IEEpID0+IFMuZXF1YWxzKGEsIGFzWzBdKSkpXG4gKiAgICAgcmV0dXJuIFtpbml0LCByZXN0XVxuICogICB9KVxuICogfVxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChncm91cChOLkVxKShbMSwgMSwgMiwgMywgMywgNF0pLCBbWzEsIDFdLCBbMl0sIFszLCAzXSwgWzRdXSlcbiAqXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBjaG9wID0gZnVuY3Rpb24gKGYpIHtcbiAgICB2YXIgZyA9IFJORUEuY2hvcChmKTtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7IHJldHVybiAoaXNOb25FbXB0eShhcykgPyBnKGFzKSA6IGVtcHR5KTsgfTtcbn07XG4vKipcbiAqIFNwbGl0cyBhIGBSZWFkb25seUFycmF5YCBpbnRvIHR3byBwaWVjZXMsIHRoZSBmaXJzdCBwaWVjZSBoYXMgbWF4IGBuYCBlbGVtZW50cy5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgc3BsaXRBdCB9IGZyb20gJ2ZwLXRzL1JlYWRvbmx5QXJyYXknXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChzcGxpdEF0KDIpKFsxLCAyLCAzLCA0LCA1XSksIFtbMSwgMl0sIFszLCA0LCA1XV0pXG4gKlxuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgc3BsaXRBdCA9IGZ1bmN0aW9uIChuKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykge1xuICAgICAgICByZXR1cm4gbiA+PSAxICYmIGlzTm9uRW1wdHkoYXMpID8gUk5FQS5zcGxpdEF0KG4pKGFzKSA6IGlzRW1wdHkoYXMpID8gW2FzLCBlbXB0eV0gOiBbZW1wdHksIGFzXTtcbiAgICB9O1xufTtcbi8qKlxuICogU3BsaXRzIGEgYFJlYWRvbmx5QXJyYXlgIGludG8gbGVuZ3RoLWBuYCBwaWVjZXMuIFRoZSBsYXN0IHBpZWNlIHdpbGwgYmUgc2hvcnRlciBpZiBgbmAgZG9lcyBub3QgZXZlbmx5IGRpdmlkZSB0aGUgbGVuZ3RoIG9mXG4gKiB0aGUgYFJlYWRvbmx5QXJyYXlgLiBOb3RlIHRoYXQgYGNodW5rc09mKG4pKFtdKWAgaXMgYFtdYCwgbm90IGBbW11dYC4gVGhpcyBpcyBpbnRlbnRpb25hbCwgYW5kIGlzIGNvbnNpc3RlbnQgd2l0aCBhIHJlY3Vyc2l2ZVxuICogZGVmaW5pdGlvbiBvZiBgY2h1bmtzT2ZgOyBpdCBzYXRpc2ZpZXMgdGhlIHByb3BlcnR5IHRoYXQ6XG4gKlxuICogYGBgdHNcbiAqIGNodW5rc09mKG4pKHhzKS5jb25jYXQoY2h1bmtzT2YobikoeXMpKSA9PSBjaHVua3NPZihuKSh4cy5jb25jYXQoeXMpKSlcbiAqIGBgYFxuICpcbiAqIHdoZW5ldmVyIGBuYCBldmVubHkgZGl2aWRlcyB0aGUgbGVuZ3RoIG9mIGBhc2AuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IGNodW5rc09mIH0gZnJvbSAnZnAtdHMvUmVhZG9ubHlBcnJheSdcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKGNodW5rc09mKDIpKFsxLCAyLCAzLCA0LCA1XSksIFtbMSwgMl0sIFszLCA0XSwgWzVdXSlcbiAqXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBjaHVua3NPZiA9IGZ1bmN0aW9uIChuKSB7XG4gICAgdmFyIGYgPSBSTkVBLmNodW5rc09mKG4pO1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHsgcmV0dXJuIChpc05vbkVtcHR5KGFzKSA/IGYoYXMpIDogZW1wdHkpOyB9O1xufTtcbi8qKlxuICogQGNhdGVnb3J5IGxpZnRpbmdcbiAqIEBzaW5jZSAyLjExLjBcbiAqL1xuZXhwb3J0IHZhciBmcm9tT3B0aW9uSyA9IGZ1bmN0aW9uIChmKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIGEgPSBbXTtcbiAgICAgICAgZm9yICh2YXIgX2kgPSAwOyBfaSA8IGFyZ3VtZW50cy5sZW5ndGg7IF9pKyspIHtcbiAgICAgICAgICAgIGFbX2ldID0gYXJndW1lbnRzW19pXTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gZnJvbU9wdGlvbihmLmFwcGx5KHZvaWQgMCwgYSkpO1xuICAgIH07XG59O1xuZXhwb3J0IGZ1bmN0aW9uIGNvbXByZWhlbnNpb24oaW5wdXQsIGYsIGcpIHtcbiAgICBpZiAoZyA9PT0gdm9pZCAwKSB7IGcgPSBmdW5jdGlvbiAoKSB7IHJldHVybiB0cnVlOyB9OyB9XG4gICAgdmFyIGdvID0gZnVuY3Rpb24gKHNjb3BlLCBpbnB1dCkge1xuICAgICAgICByZXR1cm4gaXNOb25FbXB0eShpbnB1dClcbiAgICAgICAgICAgID8gZmxhdE1hcChSTkVBLmhlYWQoaW5wdXQpLCBmdW5jdGlvbiAoYSkgeyByZXR1cm4gZ28ocGlwZShzY29wZSwgYXBwZW5kKGEpKSwgUk5FQS50YWlsKGlucHV0KSk7IH0pXG4gICAgICAgICAgICA6IGcuYXBwbHkodm9pZCAwLCBzY29wZSkgPyBbZi5hcHBseSh2b2lkIDAsIHNjb3BlKV1cbiAgICAgICAgICAgICAgICA6IGVtcHR5O1xuICAgIH07XG4gICAgcmV0dXJuIGdvKGVtcHR5LCBpbnB1dCk7XG59XG4vKipcbiAqIEBzaW5jZSAyLjExLjBcbiAqL1xuZXhwb3J0IHZhciBjb25jYXRXID0gZnVuY3Rpb24gKHNlY29uZCkge1xuICAgIHJldHVybiBmdW5jdGlvbiAoZmlyc3QpIHtcbiAgICAgICAgcmV0dXJuIGlzRW1wdHkoZmlyc3QpID8gc2Vjb25kIDogaXNFbXB0eShzZWNvbmQpID8gZmlyc3QgOiBmaXJzdC5jb25jYXQoc2Vjb25kKTtcbiAgICB9O1xufTtcbi8qKlxuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIGNvbmNhdCA9IGNvbmNhdFc7XG5leHBvcnQgZnVuY3Rpb24gdW5pb24oRSkge1xuICAgIHZhciB1bmlvbkUgPSBSTkVBLnVuaW9uKEUpO1xuICAgIHJldHVybiBmdW5jdGlvbiAoZmlyc3QsIHNlY29uZCkge1xuICAgICAgICBpZiAoc2Vjb25kID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIHZhciB1bmlvbkVfMSA9IHVuaW9uKEUpO1xuICAgICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIChzZWNvbmQpIHsgcmV0dXJuIHVuaW9uRV8xKHNlY29uZCwgZmlyc3QpOyB9O1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBpc05vbkVtcHR5KGZpcnN0KSAmJiBpc05vbkVtcHR5KHNlY29uZCkgPyB1bmlvbkUoc2Vjb25kKShmaXJzdCkgOiBpc05vbkVtcHR5KGZpcnN0KSA/IGZpcnN0IDogc2Vjb25kO1xuICAgIH07XG59XG5leHBvcnQgZnVuY3Rpb24gaW50ZXJzZWN0aW9uKEUpIHtcbiAgICB2YXIgZWxlbUUgPSBlbGVtKEUpO1xuICAgIHJldHVybiBmdW5jdGlvbiAoeHMsIHlzKSB7XG4gICAgICAgIGlmICh5cyA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICB2YXIgaW50ZXJzZWN0aW9uRV8xID0gaW50ZXJzZWN0aW9uKEUpO1xuICAgICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uICh5cykgeyByZXR1cm4gaW50ZXJzZWN0aW9uRV8xKHlzLCB4cyk7IH07XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHhzLmZpbHRlcihmdW5jdGlvbiAoYSkgeyByZXR1cm4gZWxlbUUoYSwgeXMpOyB9KTtcbiAgICB9O1xufVxuZXhwb3J0IGZ1bmN0aW9uIGRpZmZlcmVuY2UoRSkge1xuICAgIHZhciBlbGVtRSA9IGVsZW0oRSk7XG4gICAgcmV0dXJuIGZ1bmN0aW9uICh4cywgeXMpIHtcbiAgICAgICAgaWYgKHlzID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIHZhciBkaWZmZXJlbmNlRV8xID0gZGlmZmVyZW5jZShFKTtcbiAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbiAoeXMpIHsgcmV0dXJuIGRpZmZlcmVuY2VFXzEoeXMsIHhzKTsgfTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4geHMuZmlsdGVyKGZ1bmN0aW9uIChhKSB7IHJldHVybiAhZWxlbUUoYSwgeXMpOyB9KTtcbiAgICB9O1xufVxudmFyIF9tYXAgPSBmdW5jdGlvbiAoZmEsIGYpIHsgcmV0dXJuIHBpcGUoZmEsIG1hcChmKSk7IH07XG52YXIgX21hcFdpdGhJbmRleCA9IGZ1bmN0aW9uIChmYSwgZikgeyByZXR1cm4gcGlwZShmYSwgbWFwV2l0aEluZGV4KGYpKTsgfTtcbnZhciBfYXAgPSBmdW5jdGlvbiAoZmFiLCBmYSkgeyByZXR1cm4gcGlwZShmYWIsIGFwKGZhKSk7IH07XG52YXIgX2ZpbHRlciA9IGZ1bmN0aW9uIChmYSwgcHJlZGljYXRlKSB7XG4gICAgcmV0dXJuIHBpcGUoZmEsIGZpbHRlcihwcmVkaWNhdGUpKTtcbn07XG52YXIgX2ZpbHRlck1hcCA9IGZ1bmN0aW9uIChmYSwgZikgeyByZXR1cm4gcGlwZShmYSwgZmlsdGVyTWFwKGYpKTsgfTtcbnZhciBfcGFydGl0aW9uID0gZnVuY3Rpb24gKGZhLCBwcmVkaWNhdGUpIHtcbiAgICByZXR1cm4gcGlwZShmYSwgcGFydGl0aW9uKHByZWRpY2F0ZSkpO1xufTtcbnZhciBfcGFydGl0aW9uTWFwID0gZnVuY3Rpb24gKGZhLCBmKSB7IHJldHVybiBwaXBlKGZhLCBwYXJ0aXRpb25NYXAoZikpOyB9O1xudmFyIF9wYXJ0aXRpb25XaXRoSW5kZXggPSBmdW5jdGlvbiAoZmEsIHByZWRpY2F0ZVdpdGhJbmRleCkgeyByZXR1cm4gcGlwZShmYSwgcGFydGl0aW9uV2l0aEluZGV4KHByZWRpY2F0ZVdpdGhJbmRleCkpOyB9O1xudmFyIF9wYXJ0aXRpb25NYXBXaXRoSW5kZXggPSBmdW5jdGlvbiAoZmEsIGYpIHsgcmV0dXJuIHBpcGUoZmEsIHBhcnRpdGlvbk1hcFdpdGhJbmRleChmKSk7IH07XG52YXIgX2FsdCA9IGZ1bmN0aW9uIChmYSwgdGhhdCkgeyByZXR1cm4gcGlwZShmYSwgYWx0KHRoYXQpKTsgfTtcbnZhciBfcmVkdWNlID0gZnVuY3Rpb24gKGZhLCBiLCBmKSB7IHJldHVybiBwaXBlKGZhLCByZWR1Y2UoYiwgZikpOyB9O1xudmFyIF9mb2xkTWFwID0gZnVuY3Rpb24gKE0pIHtcbiAgICB2YXIgZm9sZE1hcE0gPSBmb2xkTWFwKE0pO1xuICAgIHJldHVybiBmdW5jdGlvbiAoZmEsIGYpIHsgcmV0dXJuIHBpcGUoZmEsIGZvbGRNYXBNKGYpKTsgfTtcbn07XG52YXIgX3JlZHVjZVJpZ2h0ID0gZnVuY3Rpb24gKGZhLCBiLCBmKSB7IHJldHVybiBwaXBlKGZhLCByZWR1Y2VSaWdodChiLCBmKSk7IH07XG52YXIgX3JlZHVjZVdpdGhJbmRleCA9IGZ1bmN0aW9uIChmYSwgYiwgZikge1xuICAgIHJldHVybiBwaXBlKGZhLCByZWR1Y2VXaXRoSW5kZXgoYiwgZikpO1xufTtcbnZhciBfZm9sZE1hcFdpdGhJbmRleCA9IGZ1bmN0aW9uIChNKSB7XG4gICAgdmFyIGZvbGRNYXBXaXRoSW5kZXhNID0gZm9sZE1hcFdpdGhJbmRleChNKTtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGZhLCBmKSB7IHJldHVybiBwaXBlKGZhLCBmb2xkTWFwV2l0aEluZGV4TShmKSk7IH07XG59O1xudmFyIF9yZWR1Y2VSaWdodFdpdGhJbmRleCA9IGZ1bmN0aW9uIChmYSwgYiwgZikge1xuICAgIHJldHVybiBwaXBlKGZhLCByZWR1Y2VSaWdodFdpdGhJbmRleChiLCBmKSk7XG59O1xudmFyIF9maWx0ZXJNYXBXaXRoSW5kZXggPSBmdW5jdGlvbiAoZmEsIGYpIHsgcmV0dXJuIHBpcGUoZmEsIGZpbHRlck1hcFdpdGhJbmRleChmKSk7IH07XG52YXIgX2ZpbHRlcldpdGhJbmRleCA9IGZ1bmN0aW9uIChmYSwgcHJlZGljYXRlV2l0aEluZGV4KSB7IHJldHVybiBwaXBlKGZhLCBmaWx0ZXJXaXRoSW5kZXgocHJlZGljYXRlV2l0aEluZGV4KSk7IH07XG52YXIgX2V4dGVuZCA9IGZ1bmN0aW9uIChmYSwgZikgeyByZXR1cm4gcGlwZShmYSwgZXh0ZW5kKGYpKTsgfTtcbnZhciBfdHJhdmVyc2UgPSBmdW5jdGlvbiAoRikge1xuICAgIHZhciB0cmF2ZXJzZUYgPSB0cmF2ZXJzZShGKTtcbiAgICByZXR1cm4gZnVuY3Rpb24gKHRhLCBmKSB7IHJldHVybiBwaXBlKHRhLCB0cmF2ZXJzZUYoZikpOyB9O1xufTtcbi8qIGlzdGFuYnVsIGlnbm9yZSBuZXh0ICovXG52YXIgX3RyYXZlcnNlV2l0aEluZGV4ID0gZnVuY3Rpb24gKEYpIHtcbiAgICB2YXIgdHJhdmVyc2VXaXRoSW5kZXhGID0gdHJhdmVyc2VXaXRoSW5kZXgoRik7XG4gICAgcmV0dXJuIGZ1bmN0aW9uICh0YSwgZikgeyByZXR1cm4gcGlwZSh0YSwgdHJhdmVyc2VXaXRoSW5kZXhGKGYpKTsgfTtcbn07XG4vKiogQGludGVybmFsICovXG5leHBvcnQgdmFyIF9jaGFpblJlY0RlcHRoRmlyc3QgPSBmdW5jdGlvbiAoYSwgZikgeyByZXR1cm4gcGlwZShhLCBjaGFpblJlY0RlcHRoRmlyc3QoZikpOyB9O1xuLyoqIEBpbnRlcm5hbCAqL1xuZXhwb3J0IHZhciBfY2hhaW5SZWNCcmVhZHRoRmlyc3QgPSBmdW5jdGlvbiAoYSwgZikgeyByZXR1cm4gcGlwZShhLCBjaGFpblJlY0JyZWFkdGhGaXJzdChmKSk7IH07XG4vKipcbiAqIEBjYXRlZ29yeSBjb25zdHJ1Y3RvcnNcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIG9mID0gUk5FQS5vZjtcbi8qKlxuICogQHNpbmNlIDIuNy4wXG4gKi9cbmV4cG9ydCB2YXIgemVybyA9IGZ1bmN0aW9uICgpIHsgcmV0dXJuIGVtcHR5OyB9O1xuLyoqXG4gKiBMZXNzIHN0cmljdCB2ZXJzaW9uIG9mIFtgYWx0YF0oI2FsdCkuXG4gKlxuICogVGhlIGBXYCBzdWZmaXggKHNob3J0IGZvciAqKlcqKmlkZW5pbmcpIG1lYW5zIHRoYXQgdGhlIHJldHVybiB0eXBlcyB3aWxsIGJlIG1lcmdlZC5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0ICogYXMgUkEgZnJvbSAnZnAtdHMvUmVhZG9ubHlBcnJheSdcbiAqIGltcG9ydCB7IHBpcGUgfSBmcm9tICdmcC10cy9mdW5jdGlvbidcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKFxuICogICBwaXBlKFxuICogICAgIFsxLCAyLCAzXSxcbiAqICAgICBSQS5hbHRXKCgpID0+IFsnYScsICdiJ10pXG4gKiAgICksXG4gKiAgIFsxLCAyLCAzLCAnYScsICdiJ11cbiAqIClcbiAqXG4gKiBAY2F0ZWdvcnkgZXJyb3IgaGFuZGxpbmdcbiAqIEBzaW5jZSAyLjkuMFxuICovXG5leHBvcnQgdmFyIGFsdFcgPSBmdW5jdGlvbiAodGhhdCkge1xuICAgIHJldHVybiBmdW5jdGlvbiAoZmEpIHtcbiAgICAgICAgcmV0dXJuIGZhLmNvbmNhdCh0aGF0KCkpO1xuICAgIH07XG59O1xuLyoqXG4gKiBJZGVudGlmaWVzIGFuIGFzc29jaWF0aXZlIG9wZXJhdGlvbiBvbiBhIHR5cGUgY29uc3RydWN0b3IuIEl0IGlzIHNpbWlsYXIgdG8gYFNlbWlncm91cGAsIGV4Y2VwdCB0aGF0IGl0IGFwcGxpZXMgdG9cbiAqIHR5cGVzIG9mIGtpbmQgYCogLT4gKmAuXG4gKlxuICogSW4gY2FzZSBvZiBgUmVhZG9ubHlBcnJheWAgY29uY2F0ZW5hdGVzIHRoZSBpbnB1dHMgaW50byBhIHNpbmdsZSBhcnJheS5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0ICogYXMgUkEgZnJvbSAnZnAtdHMvUmVhZG9ubHlBcnJheSdcbiAqIGltcG9ydCB7IHBpcGUgfSBmcm9tICdmcC10cy9mdW5jdGlvbidcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKFxuICogICBwaXBlKFxuICogICAgIFsxLCAyLCAzXSxcbiAqICAgICBSQS5hbHQoKCkgPT4gWzQsIDVdKVxuICogICApLFxuICogICBbMSwgMiwgMywgNCwgNV1cbiAqIClcbiAqXG4gKiBAY2F0ZWdvcnkgZXJyb3IgaGFuZGxpbmdcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIGFsdCA9IGFsdFc7XG4vKipcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIGFwID0gZnVuY3Rpb24gKGZhKSB7XG4gICAgcmV0dXJuIGZsYXRNYXAoZnVuY3Rpb24gKGYpIHsgcmV0dXJuIHBpcGUoZmEsIG1hcChmKSk7IH0pO1xufTtcbi8qKlxuICogQ29tcG9zZXMgY29tcHV0YXRpb25zIGluIHNlcXVlbmNlLCB1c2luZyB0aGUgcmV0dXJuIHZhbHVlIG9mIG9uZSBjb21wdXRhdGlvbiB0byBkZXRlcm1pbmUgdGhlIG5leHQgY29tcHV0YXRpb24uXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCAqIGFzIFJBIGZyb20gJ2ZwLXRzL1JlYWRvbmx5QXJyYXknXG4gKiBpbXBvcnQgeyBwaXBlIH0gZnJvbSAnZnAtdHMvZnVuY3Rpb24nXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChcbiAqICAgcGlwZShcbiAqICAgICBbMSwgMiwgM10sXG4gKiAgICAgUkEuZmxhdE1hcCgobikgPT4gW2BhJHtufWAsIGBiJHtufWBdKVxuICogICApLFxuICogICBbJ2ExJywgJ2IxJywgJ2EyJywgJ2IyJywgJ2EzJywgJ2IzJ11cbiAqIClcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoXG4gKiAgIHBpcGUoXG4gKiAgICAgWzEsIDIsIDNdLFxuICogICAgIFJBLmZsYXRNYXAoKCkgPT4gW10pXG4gKiAgICksXG4gKiAgIFtdXG4gKiApXG4gKlxuICogQGNhdGVnb3J5IHNlcXVlbmNpbmdcbiAqIEBzaW5jZSAyLjE0LjBcbiAqL1xuZXhwb3J0IHZhciBmbGF0TWFwID0gLyojX19QVVJFX18qLyBkdWFsKDIsIGZ1bmN0aW9uIChtYSwgZikge1xuICAgIHJldHVybiBwaXBlKG1hLCBjaGFpbldpdGhJbmRleChmdW5jdGlvbiAoaSwgYSkgeyByZXR1cm4gZihhLCBpKTsgfSkpO1xufSk7XG4vKipcbiAqIEBjYXRlZ29yeSBzZXF1ZW5jaW5nXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBmbGF0dGVuID0gLyojX19QVVJFX18qLyBmbGF0TWFwKGlkZW50aXR5KTtcbi8qKlxuICogYG1hcGAgY2FuIGJlIHVzZWQgdG8gdHVybiBmdW5jdGlvbnMgYChhOiBBKSA9PiBCYCBpbnRvIGZ1bmN0aW9ucyBgKGZhOiBGPEE+KSA9PiBGPEI+YCB3aG9zZSBhcmd1bWVudCBhbmQgcmV0dXJuIHR5cGVzXG4gKiB1c2UgdGhlIHR5cGUgY29uc3RydWN0b3IgYEZgIHRvIHJlcHJlc2VudCBzb21lIGNvbXB1dGF0aW9uYWwgY29udGV4dC5cbiAqXG4gKiBAY2F0ZWdvcnkgbWFwcGluZ1xuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgbWFwID0gZnVuY3Rpb24gKGYpIHsgcmV0dXJuIGZ1bmN0aW9uIChmYSkge1xuICAgIHJldHVybiBmYS5tYXAoZnVuY3Rpb24gKGEpIHsgcmV0dXJuIGYoYSk7IH0pO1xufTsgfTtcbi8qKlxuICogQGNhdGVnb3J5IG1hcHBpbmdcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIG1hcFdpdGhJbmRleCA9IGZ1bmN0aW9uIChmKSB7IHJldHVybiBmdW5jdGlvbiAoZmEpIHtcbiAgICByZXR1cm4gZmEubWFwKGZ1bmN0aW9uIChhLCBpKSB7IHJldHVybiBmKGksIGEpOyB9KTtcbn07IH07XG4vKipcbiAqIEBjYXRlZ29yeSBmaWx0ZXJpbmdcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIHNlcGFyYXRlID0gZnVuY3Rpb24gKGZhKSB7XG4gICAgdmFyIGxlZnQgPSBbXTtcbiAgICB2YXIgcmlnaHQgPSBbXTtcbiAgICBmb3IgKHZhciBfaSA9IDAsIGZhXzEgPSBmYTsgX2kgPCBmYV8xLmxlbmd0aDsgX2krKykge1xuICAgICAgICB2YXIgZSA9IGZhXzFbX2ldO1xuICAgICAgICBpZiAoZS5fdGFnID09PSAnTGVmdCcpIHtcbiAgICAgICAgICAgIGxlZnQucHVzaChlLmxlZnQpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgcmlnaHQucHVzaChlLnJpZ2h0KTtcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gc2VwYXJhdGVkKGxlZnQsIHJpZ2h0KTtcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBmaWx0ZXJpbmdcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIGZpbHRlciA9IGZ1bmN0aW9uIChwcmVkaWNhdGUpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIHJldHVybiBhcy5maWx0ZXIocHJlZGljYXRlKTtcbiAgICB9O1xufTtcbi8qKlxuICogQGNhdGVnb3J5IGZpbHRlcmluZ1xuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgZmlsdGVyTWFwV2l0aEluZGV4ID0gZnVuY3Rpb24gKGYpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGZhKSB7XG4gICAgICAgIHZhciBvdXQgPSBbXTtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBmYS5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgdmFyIG9wdGlvbkIgPSBmKGksIGZhW2ldKTtcbiAgICAgICAgICAgIGlmIChfLmlzU29tZShvcHRpb25CKSkge1xuICAgICAgICAgICAgICAgIG91dC5wdXNoKG9wdGlvbkIudmFsdWUpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBvdXQ7XG4gICAgfTtcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBmaWx0ZXJpbmdcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIGZpbHRlck1hcCA9IGZ1bmN0aW9uIChmKSB7XG4gICAgcmV0dXJuIGZpbHRlck1hcFdpdGhJbmRleChmdW5jdGlvbiAoXywgYSkgeyByZXR1cm4gZihhKTsgfSk7XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgZmlsdGVyaW5nXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBjb21wYWN0ID0gLyojX19QVVJFX18qLyBmaWx0ZXJNYXAoaWRlbnRpdHkpO1xuLyoqXG4gKiBAY2F0ZWdvcnkgZmlsdGVyaW5nXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBwYXJ0aXRpb24gPSBmdW5jdGlvbiAocHJlZGljYXRlKSB7XG4gICAgcmV0dXJuIHBhcnRpdGlvbldpdGhJbmRleChmdW5jdGlvbiAoXywgYSkgeyByZXR1cm4gcHJlZGljYXRlKGEpOyB9KTtcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBmaWx0ZXJpbmdcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIHBhcnRpdGlvbldpdGhJbmRleCA9IGZ1bmN0aW9uIChwcmVkaWNhdGVXaXRoSW5kZXgpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIHZhciBsZWZ0ID0gW107XG4gICAgICAgIHZhciByaWdodCA9IFtdO1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGFzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICB2YXIgYSA9IGFzW2ldO1xuICAgICAgICAgICAgaWYgKHByZWRpY2F0ZVdpdGhJbmRleChpLCBhKSkge1xuICAgICAgICAgICAgICAgIHJpZ2h0LnB1c2goYSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBsZWZ0LnB1c2goYSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHNlcGFyYXRlZChsZWZ0LCByaWdodCk7XG4gICAgfTtcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBmaWx0ZXJpbmdcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIHBhcnRpdGlvbk1hcCA9IGZ1bmN0aW9uIChmKSB7XG4gICAgcmV0dXJuIHBhcnRpdGlvbk1hcFdpdGhJbmRleChmdW5jdGlvbiAoXywgYSkgeyByZXR1cm4gZihhKTsgfSk7XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgZmlsdGVyaW5nXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBwYXJ0aXRpb25NYXBXaXRoSW5kZXggPSBmdW5jdGlvbiAoZikge1xuICAgIHJldHVybiBmdW5jdGlvbiAoZmEpIHtcbiAgICAgICAgdmFyIGxlZnQgPSBbXTtcbiAgICAgICAgdmFyIHJpZ2h0ID0gW107XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgZmEubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIHZhciBlID0gZihpLCBmYVtpXSk7XG4gICAgICAgICAgICBpZiAoZS5fdGFnID09PSAnTGVmdCcpIHtcbiAgICAgICAgICAgICAgICBsZWZ0LnB1c2goZS5sZWZ0KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHJpZ2h0LnB1c2goZS5yaWdodCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHNlcGFyYXRlZChsZWZ0LCByaWdodCk7XG4gICAgfTtcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBmaWx0ZXJpbmdcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIGZpbHRlcldpdGhJbmRleCA9IGZ1bmN0aW9uIChwcmVkaWNhdGVXaXRoSW5kZXgpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIHJldHVybiBhcy5maWx0ZXIoZnVuY3Rpb24gKGEsIGkpIHsgcmV0dXJuIHByZWRpY2F0ZVdpdGhJbmRleChpLCBhKTsgfSk7XG4gICAgfTtcbn07XG4vKipcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIGV4dGVuZCA9IGZ1bmN0aW9uIChmKSB7IHJldHVybiBmdW5jdGlvbiAod2EpIHtcbiAgICByZXR1cm4gd2EubWFwKGZ1bmN0aW9uIChfLCBpKSB7IHJldHVybiBmKHdhLnNsaWNlKGkpKTsgfSk7XG59OyB9O1xuLyoqXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBkdXBsaWNhdGUgPSAvKiNfX1BVUkVfXyovIGV4dGVuZChpZGVudGl0eSk7XG4vKipcbiAqIEBjYXRlZ29yeSBmb2xkaW5nXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBmb2xkTWFwV2l0aEluZGV4ID0gZnVuY3Rpb24gKE0pIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGYpIHtcbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIChmYSkge1xuICAgICAgICAgICAgcmV0dXJuIGZhLnJlZHVjZShmdW5jdGlvbiAoYiwgYSwgaSkgeyByZXR1cm4gTS5jb25jYXQoYiwgZihpLCBhKSk7IH0sIE0uZW1wdHkpO1xuICAgICAgICB9O1xuICAgIH07XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgZm9sZGluZ1xuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgcmVkdWNlID0gZnVuY3Rpb24gKGIsIGYpIHtcbiAgICByZXR1cm4gcmVkdWNlV2l0aEluZGV4KGIsIGZ1bmN0aW9uIChfLCBiLCBhKSB7IHJldHVybiBmKGIsIGEpOyB9KTtcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBmb2xkaW5nXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBmb2xkTWFwID0gZnVuY3Rpb24gKE0pIHtcbiAgICB2YXIgZm9sZE1hcFdpdGhJbmRleE0gPSBmb2xkTWFwV2l0aEluZGV4KE0pO1xuICAgIHJldHVybiBmdW5jdGlvbiAoZikgeyByZXR1cm4gZm9sZE1hcFdpdGhJbmRleE0oZnVuY3Rpb24gKF8sIGEpIHsgcmV0dXJuIGYoYSk7IH0pOyB9O1xufTtcbi8qKlxuICogQGNhdGVnb3J5IGZvbGRpbmdcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIHJlZHVjZVdpdGhJbmRleCA9IGZ1bmN0aW9uIChiLCBmKSB7IHJldHVybiBmdW5jdGlvbiAoZmEpIHtcbiAgICB2YXIgbGVuID0gZmEubGVuZ3RoO1xuICAgIHZhciBvdXQgPSBiO1xuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbGVuOyBpKyspIHtcbiAgICAgICAgb3V0ID0gZihpLCBvdXQsIGZhW2ldKTtcbiAgICB9XG4gICAgcmV0dXJuIG91dDtcbn07IH07XG4vKipcbiAqIEBjYXRlZ29yeSBmb2xkaW5nXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciByZWR1Y2VSaWdodCA9IGZ1bmN0aW9uIChiLCBmKSB7XG4gICAgcmV0dXJuIHJlZHVjZVJpZ2h0V2l0aEluZGV4KGIsIGZ1bmN0aW9uIChfLCBhLCBiKSB7IHJldHVybiBmKGEsIGIpOyB9KTtcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBmb2xkaW5nXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciByZWR1Y2VSaWdodFdpdGhJbmRleCA9IGZ1bmN0aW9uIChiLCBmKSB7IHJldHVybiBmdW5jdGlvbiAoZmEpIHtcbiAgICByZXR1cm4gZmEucmVkdWNlUmlnaHQoZnVuY3Rpb24gKGIsIGEsIGkpIHsgcmV0dXJuIGYoaSwgYSwgYik7IH0sIGIpO1xufTsgfTtcbi8qKlxuICogQGNhdGVnb3J5IHRyYXZlcnNpbmdcbiAqIEBzaW5jZSAyLjYuM1xuICovXG5leHBvcnQgdmFyIHRyYXZlcnNlID0gZnVuY3Rpb24gKEYpIHtcbiAgICB2YXIgdHJhdmVyc2VXaXRoSW5kZXhGID0gdHJhdmVyc2VXaXRoSW5kZXgoRik7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChmKSB7IHJldHVybiB0cmF2ZXJzZVdpdGhJbmRleEYoZnVuY3Rpb24gKF8sIGEpIHsgcmV0dXJuIGYoYSk7IH0pOyB9O1xufTtcbi8qKlxuICogQGNhdGVnb3J5IHRyYXZlcnNpbmdcbiAqIEBzaW5jZSAyLjYuM1xuICovXG5leHBvcnQgdmFyIHNlcXVlbmNlID0gZnVuY3Rpb24gKEYpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKHRhKSB7XG4gICAgICAgIHJldHVybiBfcmVkdWNlKHRhLCBGLm9mKHplcm8oKSksIGZ1bmN0aW9uIChmYXMsIGZhKSB7XG4gICAgICAgICAgICByZXR1cm4gRi5hcChGLm1hcChmYXMsIGZ1bmN0aW9uIChhcykgeyByZXR1cm4gZnVuY3Rpb24gKGEpIHsgcmV0dXJuIHBpcGUoYXMsIGFwcGVuZChhKSk7IH07IH0pLCBmYSk7XG4gICAgICAgIH0pO1xuICAgIH07XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgc2VxdWVuY2luZ1xuICogQHNpbmNlIDIuNi4zXG4gKi9cbmV4cG9ydCB2YXIgdHJhdmVyc2VXaXRoSW5kZXggPSBmdW5jdGlvbiAoRikge1xuICAgIHJldHVybiBmdW5jdGlvbiAoZikge1xuICAgICAgICByZXR1cm4gcmVkdWNlV2l0aEluZGV4KEYub2YoemVybygpKSwgZnVuY3Rpb24gKGksIGZicywgYSkge1xuICAgICAgICAgICAgcmV0dXJuIEYuYXAoRi5tYXAoZmJzLCBmdW5jdGlvbiAoYnMpIHsgcmV0dXJuIGZ1bmN0aW9uIChiKSB7IHJldHVybiBwaXBlKGJzLCBhcHBlbmQoYikpOyB9OyB9KSwgZihpLCBhKSk7XG4gICAgICAgIH0pO1xuICAgIH07XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgZmlsdGVyaW5nXG4gKiBAc2luY2UgMi42LjVcbiAqL1xuZXhwb3J0IHZhciB3aXRoZXIgPSBmdW5jdGlvbiAoRikge1xuICAgIHZhciBfd2l0aGVyRiA9IF93aXRoZXIoRik7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChmKSB7IHJldHVybiBmdW5jdGlvbiAoZmEpIHsgcmV0dXJuIF93aXRoZXJGKGZhLCBmKTsgfTsgfTtcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBmaWx0ZXJpbmdcbiAqIEBzaW5jZSAyLjYuNVxuICovXG5leHBvcnQgdmFyIHdpbHQgPSBmdW5jdGlvbiAoRikge1xuICAgIHZhciBfd2lsdEYgPSBfd2lsdChGKTtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGYpIHsgcmV0dXJuIGZ1bmN0aW9uIChmYSkgeyByZXR1cm4gX3dpbHRGKGZhLCBmKTsgfTsgfTtcbn07XG4vKipcbiAqIEBzaW5jZSAyLjYuNlxuICovXG5leHBvcnQgdmFyIHVuZm9sZCA9IGZ1bmN0aW9uIChiLCBmKSB7XG4gICAgdmFyIG91dCA9IFtdO1xuICAgIHZhciBiYiA9IGI7XG4gICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG5vLWNvbnN0YW50LWNvbmRpdGlvblxuICAgIHdoaWxlICh0cnVlKSB7XG4gICAgICAgIHZhciBtdCA9IGYoYmIpO1xuICAgICAgICBpZiAoXy5pc1NvbWUobXQpKSB7XG4gICAgICAgICAgICB2YXIgX2EgPSBtdC52YWx1ZSwgYSA9IF9hWzBdLCBiXzEgPSBfYVsxXTtcbiAgICAgICAgICAgIG91dC5wdXNoKGEpO1xuICAgICAgICAgICAgYmIgPSBiXzE7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gb3V0O1xufTtcbi8qKlxuICogQGNhdGVnb3J5IHR5cGUgbGFtYmRhc1xuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgVVJJID0gJ1JlYWRvbmx5QXJyYXknO1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBnZXRTaG93ID0gZnVuY3Rpb24gKFMpIHsgcmV0dXJuICh7XG4gICAgc2hvdzogZnVuY3Rpb24gKGFzKSB7IHJldHVybiBcIltcIi5jb25jYXQoYXMubWFwKFMuc2hvdykuam9pbignLCAnKSwgXCJdXCIpOyB9XG59KTsgfTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgZ2V0U2VtaWdyb3VwID0gZnVuY3Rpb24gKCkgeyByZXR1cm4gKHtcbiAgICBjb25jYXQ6IGZ1bmN0aW9uIChmaXJzdCwgc2Vjb25kKSB7IHJldHVybiAoaXNFbXB0eShmaXJzdCkgPyBzZWNvbmQgOiBpc0VtcHR5KHNlY29uZCkgPyBmaXJzdCA6IGZpcnN0LmNvbmNhdChzZWNvbmQpKTsgfVxufSk7IH07XG4vKipcbiAqIFJldHVybnMgYSBgTW9ub2lkYCBmb3IgYFJlYWRvbmx5QXJyYXk8QT5gLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBnZXRNb25vaWQgfSBmcm9tICdmcC10cy9SZWFkb25seUFycmF5J1xuICpcbiAqIGNvbnN0IE0gPSBnZXRNb25vaWQ8bnVtYmVyPigpXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKE0uY29uY2F0KFsxLCAyXSwgWzMsIDRdKSwgWzEsIDIsIDMsIDRdKVxuICpcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIGdldE1vbm9pZCA9IGZ1bmN0aW9uICgpIHsgcmV0dXJuICh7XG4gICAgY29uY2F0OiBnZXRTZW1pZ3JvdXAoKS5jb25jYXQsXG4gICAgZW1wdHk6IGVtcHR5XG59KTsgfTtcbi8qKlxuICogRGVyaXZlcyBhbiBgRXFgIG92ZXIgdGhlIGBSZWFkb25seUFycmF5YCBvZiBhIGdpdmVuIGVsZW1lbnQgdHlwZSBmcm9tIHRoZSBgRXFgIG9mIHRoYXQgdHlwZS4gVGhlIGRlcml2ZWQgYEVxYCBkZWZpbmVzIHR3b1xuICogYXJyYXlzIGFzIGVxdWFsIGlmIGFsbCBlbGVtZW50cyBvZiBib3RoIGFycmF5cyBhcmUgY29tcGFyZWQgZXF1YWwgcGFpcndpc2Ugd2l0aCB0aGUgZ2l2ZW4gYEVgLiBJbiBjYXNlIG9mIGFycmF5cyBvZlxuICogZGlmZmVyZW50IGxlbmd0aHMsIHRoZSByZXN1bHQgaXMgbm9uIGVxdWFsaXR5LlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgKiBhcyBTIGZyb20gJ2ZwLXRzL3N0cmluZydcbiAqIGltcG9ydCB7IGdldEVxIH0gZnJvbSAnZnAtdHMvUmVhZG9ubHlBcnJheSdcbiAqXG4gKiBjb25zdCBFID0gZ2V0RXEoUy5FcSlcbiAqIGFzc2VydC5zdHJpY3RFcXVhbChFLmVxdWFscyhbJ2EnLCAnYiddLCBbJ2EnLCAnYiddKSwgdHJ1ZSlcbiAqIGFzc2VydC5zdHJpY3RFcXVhbChFLmVxdWFscyhbJ2EnXSwgW10pLCBmYWxzZSlcbiAqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBnZXRFcSA9IGZ1bmN0aW9uIChFKSB7XG4gICAgcmV0dXJuIGZyb21FcXVhbHMoZnVuY3Rpb24gKHhzLCB5cykgeyByZXR1cm4geHMubGVuZ3RoID09PSB5cy5sZW5ndGggJiYgeHMuZXZlcnkoZnVuY3Rpb24gKHgsIGkpIHsgcmV0dXJuIEUuZXF1YWxzKHgsIHlzW2ldKTsgfSk7IH0pO1xufTtcbi8qKlxuICogRGVyaXZlcyBhbiBgT3JkYCBvdmVyIHRoZSBgUmVhZG9ubHlBcnJheWAgb2YgYSBnaXZlbiBlbGVtZW50IHR5cGUgZnJvbSB0aGUgYE9yZGAgb2YgdGhhdCB0eXBlLiBUaGUgb3JkZXJpbmcgYmV0d2VlbiB0d28gc3VjaFxuICogYXJyYXlzIGlzIGVxdWFsIHRvOiB0aGUgZmlyc3Qgbm9uIGVxdWFsIGNvbXBhcmlzb24gb2YgZWFjaCBhcnJheXMgZWxlbWVudHMgdGFrZW4gcGFpcndpc2UgaW4gaW5jcmVhc2luZyBvcmRlciwgaW5cbiAqIGNhc2Ugb2YgZXF1YWxpdHkgb3ZlciBhbGwgdGhlIHBhaXJ3aXNlIGVsZW1lbnRzOyB0aGUgbG9uZ2VzdCBhcnJheSBpcyBjb25zaWRlcmVkIHRoZSBncmVhdGVzdCwgaWYgYm90aCBhcnJheXMgaGF2ZVxuICogdGhlIHNhbWUgbGVuZ3RoLCB0aGUgcmVzdWx0IGlzIGVxdWFsaXR5LlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBnZXRPcmQgfSBmcm9tICdmcC10cy9SZWFkb25seUFycmF5J1xuICogaW1wb3J0ICogYXMgUyBmcm9tICdmcC10cy9zdHJpbmcnXG4gKlxuICogY29uc3QgTyA9IGdldE9yZChTLk9yZClcbiAqIGFzc2VydC5zdHJpY3RFcXVhbChPLmNvbXBhcmUoWydiJ10sIFsnYSddKSwgMSlcbiAqIGFzc2VydC5zdHJpY3RFcXVhbChPLmNvbXBhcmUoWydhJ10sIFsnYSddKSwgMClcbiAqIGFzc2VydC5zdHJpY3RFcXVhbChPLmNvbXBhcmUoWydhJ10sIFsnYiddKSwgLTEpXG4gKlxuICpcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIGdldE9yZCA9IGZ1bmN0aW9uIChPKSB7XG4gICAgcmV0dXJuIGZyb21Db21wYXJlKGZ1bmN0aW9uIChhLCBiKSB7XG4gICAgICAgIHZhciBhTGVuID0gYS5sZW5ndGg7XG4gICAgICAgIHZhciBiTGVuID0gYi5sZW5ndGg7XG4gICAgICAgIHZhciBsZW4gPSBNYXRoLm1pbihhTGVuLCBiTGVuKTtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBsZW47IGkrKykge1xuICAgICAgICAgICAgdmFyIG9yZGVyaW5nID0gTy5jb21wYXJlKGFbaV0sIGJbaV0pO1xuICAgICAgICAgICAgaWYgKG9yZGVyaW5nICE9PSAwKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG9yZGVyaW5nO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBOLk9yZC5jb21wYXJlKGFMZW4sIGJMZW4pO1xuICAgIH0pO1xufTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIGdldFVuaW9uU2VtaWdyb3VwID0gZnVuY3Rpb24gKEUpIHtcbiAgICB2YXIgdW5pb25FID0gdW5pb24oRSk7XG4gICAgcmV0dXJuIHtcbiAgICAgICAgY29uY2F0OiBmdW5jdGlvbiAoZmlyc3QsIHNlY29uZCkgeyByZXR1cm4gdW5pb25FKHNlY29uZCkoZmlyc3QpOyB9XG4gICAgfTtcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjExLjBcbiAqL1xuZXhwb3J0IHZhciBnZXRVbmlvbk1vbm9pZCA9IGZ1bmN0aW9uIChFKSB7IHJldHVybiAoe1xuICAgIGNvbmNhdDogZ2V0VW5pb25TZW1pZ3JvdXAoRSkuY29uY2F0LFxuICAgIGVtcHR5OiBlbXB0eVxufSk7IH07XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjExLjBcbiAqL1xuZXhwb3J0IHZhciBnZXRJbnRlcnNlY3Rpb25TZW1pZ3JvdXAgPSBmdW5jdGlvbiAoRSkge1xuICAgIHZhciBpbnRlcnNlY3Rpb25FID0gaW50ZXJzZWN0aW9uKEUpO1xuICAgIHJldHVybiB7XG4gICAgICAgIGNvbmNhdDogZnVuY3Rpb24gKGZpcnN0LCBzZWNvbmQpIHsgcmV0dXJuIGludGVyc2VjdGlvbkUoc2Vjb25kKShmaXJzdCk7IH1cbiAgICB9O1xufTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIGdldERpZmZlcmVuY2VNYWdtYSA9IGZ1bmN0aW9uIChFKSB7XG4gICAgdmFyIGRpZmZlcmVuY2VFID0gZGlmZmVyZW5jZShFKTtcbiAgICByZXR1cm4ge1xuICAgICAgICBjb25jYXQ6IGZ1bmN0aW9uIChmaXJzdCwgc2Vjb25kKSB7IHJldHVybiBkaWZmZXJlbmNlRShzZWNvbmQpKGZpcnN0KTsgfVxuICAgIH07XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi43LjBcbiAqL1xuZXhwb3J0IHZhciBGdW5jdG9yID0ge1xuICAgIFVSSTogVVJJLFxuICAgIG1hcDogX21hcFxufTtcbi8qKlxuICogQGNhdGVnb3J5IG1hcHBpbmdcbiAqIEBzaW5jZSAyLjEwLjBcbiAqL1xuZXhwb3J0IHZhciBmbGFwID0gLyojX19QVVJFX18qLyBmbGFwXyhGdW5jdG9yKTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuMTAuMFxuICovXG5leHBvcnQgdmFyIFBvaW50ZWQgPSB7XG4gICAgVVJJOiBVUkksXG4gICAgb2Y6IG9mXG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi43LjBcbiAqL1xuZXhwb3J0IHZhciBGdW5jdG9yV2l0aEluZGV4ID0ge1xuICAgIFVSSTogVVJJLFxuICAgIG1hcDogX21hcCxcbiAgICBtYXBXaXRoSW5kZXg6IF9tYXBXaXRoSW5kZXhcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjEwLjBcbiAqL1xuZXhwb3J0IHZhciBBcHBseSA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICBtYXA6IF9tYXAsXG4gICAgYXA6IF9hcFxufTtcbi8qKlxuICogQ29tYmluZSB0d28gZWZmZWN0ZnVsIGFjdGlvbnMsIGtlZXBpbmcgb25seSB0aGUgcmVzdWx0IG9mIHRoZSBmaXJzdC5cbiAqXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBhcEZpcnN0ID0gLyojX19QVVJFX18qLyBhcEZpcnN0XyhBcHBseSk7XG4vKipcbiAqIENvbWJpbmUgdHdvIGVmZmVjdGZ1bCBhY3Rpb25zLCBrZWVwaW5nIG9ubHkgdGhlIHJlc3VsdCBvZiB0aGUgc2Vjb25kLlxuICpcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIGFwU2Vjb25kID0gLyojX19QVVJFX18qLyBhcFNlY29uZF8oQXBwbHkpO1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi43LjBcbiAqL1xuZXhwb3J0IHZhciBBcHBsaWNhdGl2ZSA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICBtYXA6IF9tYXAsXG4gICAgYXA6IF9hcCxcbiAgICBvZjogb2Zcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjEwLjBcbiAqL1xuZXhwb3J0IHZhciBDaGFpbiA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICBtYXA6IF9tYXAsXG4gICAgYXA6IF9hcCxcbiAgICBjaGFpbjogZmxhdE1hcFxufTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuNy4wXG4gKi9cbmV4cG9ydCB2YXIgTW9uYWQgPSB7XG4gICAgVVJJOiBVUkksXG4gICAgbWFwOiBfbWFwLFxuICAgIGFwOiBfYXAsXG4gICAgb2Y6IG9mLFxuICAgIGNoYWluOiBmbGF0TWFwXG59O1xuLyoqXG4gKiBDb21wb3NlcyBjb21wdXRhdGlvbnMgaW4gc2VxdWVuY2UsIHVzaW5nIHRoZSByZXR1cm4gdmFsdWUgb2Ygb25lIGNvbXB1dGF0aW9uIHRvIGRldGVybWluZSB0aGUgbmV4dCBjb21wdXRhdGlvbiBhbmRcbiAqIGtlZXBpbmcgb25seSB0aGUgcmVzdWx0IG9mIHRoZSBmaXJzdC5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0ICogYXMgUkEgZnJvbSAnZnAtdHMvUmVhZG9ubHlBcnJheSdcbiAqIGltcG9ydCB7IHBpcGUgfSBmcm9tICdmcC10cy9mdW5jdGlvbidcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKFxuICogICBwaXBlKFxuICogICAgIFsxLCAyLCAzXSxcbiAqICAgICBSQS5jaGFpbkZpcnN0KCgpID0+IFsnYScsICdiJ10pXG4gKiAgICksXG4gKiAgIFsxLCAxLCAyLCAyLCAzLCAzXVxuICogKVxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChcbiAqICAgcGlwZShcbiAqICAgICBbMSwgMiwgM10sXG4gKiAgICAgUkEuY2hhaW5GaXJzdCgoKSA9PiBbXSlcbiAqICAgKSxcbiAqICAgW11cbiAqIClcbiAqXG4gKiBAY2F0ZWdvcnkgc2VxdWVuY2luZ1xuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgY2hhaW5GaXJzdCA9IFxuLyojX19QVVJFX18qLyBjaGFpbkZpcnN0XyhDaGFpbik7XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjcuMFxuICovXG5leHBvcnQgdmFyIFVuZm9sZGFibGUgPSB7XG4gICAgVVJJOiBVUkksXG4gICAgdW5mb2xkOiB1bmZvbGRcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjcuMFxuICovXG5leHBvcnQgdmFyIEFsdCA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICBtYXA6IF9tYXAsXG4gICAgYWx0OiBfYWx0XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi4xMS4wXG4gKi9cbmV4cG9ydCB2YXIgWmVybyA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICB6ZXJvOiB6ZXJvXG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgZG8gbm90YXRpb25cbiAqIEBzaW5jZSAyLjExLjBcbiAqL1xuZXhwb3J0IHZhciBndWFyZCA9IC8qI19fUFVSRV9fKi8gZ3VhcmRfKFplcm8sIFBvaW50ZWQpO1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi43LjBcbiAqL1xuZXhwb3J0IHZhciBBbHRlcm5hdGl2ZSA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICBtYXA6IF9tYXAsXG4gICAgYXA6IF9hcCxcbiAgICBvZjogb2YsXG4gICAgYWx0OiBfYWx0LFxuICAgIHplcm86IHplcm9cbn07XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjcuMFxuICovXG5leHBvcnQgdmFyIEV4dGVuZCA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICBtYXA6IF9tYXAsXG4gICAgZXh0ZW5kOiBfZXh0ZW5kXG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi43LjBcbiAqL1xuZXhwb3J0IHZhciBDb21wYWN0YWJsZSA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICBjb21wYWN0OiBjb21wYWN0LFxuICAgIHNlcGFyYXRlOiBzZXBhcmF0ZVxufTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuNy4wXG4gKi9cbmV4cG9ydCB2YXIgRmlsdGVyYWJsZSA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICBtYXA6IF9tYXAsXG4gICAgY29tcGFjdDogY29tcGFjdCxcbiAgICBzZXBhcmF0ZTogc2VwYXJhdGUsXG4gICAgZmlsdGVyOiBfZmlsdGVyLFxuICAgIGZpbHRlck1hcDogX2ZpbHRlck1hcCxcbiAgICBwYXJ0aXRpb246IF9wYXJ0aXRpb24sXG4gICAgcGFydGl0aW9uTWFwOiBfcGFydGl0aW9uTWFwXG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi43LjBcbiAqL1xuZXhwb3J0IHZhciBGaWx0ZXJhYmxlV2l0aEluZGV4ID0ge1xuICAgIFVSSTogVVJJLFxuICAgIG1hcDogX21hcCxcbiAgICBtYXBXaXRoSW5kZXg6IF9tYXBXaXRoSW5kZXgsXG4gICAgY29tcGFjdDogY29tcGFjdCxcbiAgICBzZXBhcmF0ZTogc2VwYXJhdGUsXG4gICAgZmlsdGVyOiBfZmlsdGVyLFxuICAgIGZpbHRlck1hcDogX2ZpbHRlck1hcCxcbiAgICBwYXJ0aXRpb246IF9wYXJ0aXRpb24sXG4gICAgcGFydGl0aW9uTWFwOiBfcGFydGl0aW9uTWFwLFxuICAgIHBhcnRpdGlvbk1hcFdpdGhJbmRleDogX3BhcnRpdGlvbk1hcFdpdGhJbmRleCxcbiAgICBwYXJ0aXRpb25XaXRoSW5kZXg6IF9wYXJ0aXRpb25XaXRoSW5kZXgsXG4gICAgZmlsdGVyTWFwV2l0aEluZGV4OiBfZmlsdGVyTWFwV2l0aEluZGV4LFxuICAgIGZpbHRlcldpdGhJbmRleDogX2ZpbHRlcldpdGhJbmRleFxufTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuNy4wXG4gKi9cbmV4cG9ydCB2YXIgRm9sZGFibGUgPSB7XG4gICAgVVJJOiBVUkksXG4gICAgcmVkdWNlOiBfcmVkdWNlLFxuICAgIGZvbGRNYXA6IF9mb2xkTWFwLFxuICAgIHJlZHVjZVJpZ2h0OiBfcmVkdWNlUmlnaHRcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjcuMFxuICovXG5leHBvcnQgdmFyIEZvbGRhYmxlV2l0aEluZGV4ID0ge1xuICAgIFVSSTogVVJJLFxuICAgIHJlZHVjZTogX3JlZHVjZSxcbiAgICBmb2xkTWFwOiBfZm9sZE1hcCxcbiAgICByZWR1Y2VSaWdodDogX3JlZHVjZVJpZ2h0LFxuICAgIHJlZHVjZVdpdGhJbmRleDogX3JlZHVjZVdpdGhJbmRleCxcbiAgICBmb2xkTWFwV2l0aEluZGV4OiBfZm9sZE1hcFdpdGhJbmRleCxcbiAgICByZWR1Y2VSaWdodFdpdGhJbmRleDogX3JlZHVjZVJpZ2h0V2l0aEluZGV4XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi43LjBcbiAqL1xuZXhwb3J0IHZhciBUcmF2ZXJzYWJsZSA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICBtYXA6IF9tYXAsXG4gICAgcmVkdWNlOiBfcmVkdWNlLFxuICAgIGZvbGRNYXA6IF9mb2xkTWFwLFxuICAgIHJlZHVjZVJpZ2h0OiBfcmVkdWNlUmlnaHQsXG4gICAgdHJhdmVyc2U6IF90cmF2ZXJzZSxcbiAgICBzZXF1ZW5jZTogc2VxdWVuY2Vcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjcuMFxuICovXG5leHBvcnQgdmFyIFRyYXZlcnNhYmxlV2l0aEluZGV4ID0ge1xuICAgIFVSSTogVVJJLFxuICAgIG1hcDogX21hcCxcbiAgICBtYXBXaXRoSW5kZXg6IF9tYXBXaXRoSW5kZXgsXG4gICAgcmVkdWNlOiBfcmVkdWNlLFxuICAgIGZvbGRNYXA6IF9mb2xkTWFwLFxuICAgIHJlZHVjZVJpZ2h0OiBfcmVkdWNlUmlnaHQsXG4gICAgcmVkdWNlV2l0aEluZGV4OiBfcmVkdWNlV2l0aEluZGV4LFxuICAgIGZvbGRNYXBXaXRoSW5kZXg6IF9mb2xkTWFwV2l0aEluZGV4LFxuICAgIHJlZHVjZVJpZ2h0V2l0aEluZGV4OiBfcmVkdWNlUmlnaHRXaXRoSW5kZXgsXG4gICAgdHJhdmVyc2U6IF90cmF2ZXJzZSxcbiAgICBzZXF1ZW5jZTogc2VxdWVuY2UsXG4gICAgdHJhdmVyc2VXaXRoSW5kZXg6IF90cmF2ZXJzZVdpdGhJbmRleFxufTtcbi8qKlxuICogQGNhdGVnb3J5IHNlcXVlbmNpbmdcbiAqIEBzaW5jZSAyLjExLjBcbiAqL1xuZXhwb3J0IHZhciBjaGFpblJlY0RlcHRoRmlyc3QgPSBmdW5jdGlvbiAoZikge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYSkge1xuICAgICAgICB2YXIgdG9kbyA9IF9fc3ByZWFkQXJyYXkoW10sIGYoYSksIHRydWUpO1xuICAgICAgICB2YXIgb3V0ID0gW107XG4gICAgICAgIHdoaWxlICh0b2RvLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgIHZhciBlID0gdG9kby5zaGlmdCgpO1xuICAgICAgICAgICAgaWYgKF8uaXNMZWZ0KGUpKSB7XG4gICAgICAgICAgICAgICAgdG9kby51bnNoaWZ0LmFwcGx5KHRvZG8sIGYoZS5sZWZ0KSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBvdXQucHVzaChlLnJpZ2h0KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gb3V0O1xuICAgIH07XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi4xMS4wXG4gKi9cbmV4cG9ydCB2YXIgQ2hhaW5SZWNEZXB0aEZpcnN0ID0ge1xuICAgIFVSSTogVVJJLFxuICAgIG1hcDogX21hcCxcbiAgICBhcDogX2FwLFxuICAgIGNoYWluOiBmbGF0TWFwLFxuICAgIGNoYWluUmVjOiBfY2hhaW5SZWNEZXB0aEZpcnN0XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgc2VxdWVuY2luZ1xuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIGNoYWluUmVjQnJlYWR0aEZpcnN0ID0gZnVuY3Rpb24gKGYpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGEpIHtcbiAgICAgICAgdmFyIGluaXRpYWwgPSBmKGEpO1xuICAgICAgICB2YXIgdG9kbyA9IFtdO1xuICAgICAgICB2YXIgb3V0ID0gW107XG4gICAgICAgIGZ1bmN0aW9uIGdvKGUpIHtcbiAgICAgICAgICAgIGlmIChfLmlzTGVmdChlKSkge1xuICAgICAgICAgICAgICAgIGYoZS5sZWZ0KS5mb3JFYWNoKGZ1bmN0aW9uICh2KSB7IHJldHVybiB0b2RvLnB1c2godik7IH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgb3V0LnB1c2goZS5yaWdodCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZm9yICh2YXIgX2kgPSAwLCBpbml0aWFsXzEgPSBpbml0aWFsOyBfaSA8IGluaXRpYWxfMS5sZW5ndGg7IF9pKyspIHtcbiAgICAgICAgICAgIHZhciBlID0gaW5pdGlhbF8xW19pXTtcbiAgICAgICAgICAgIGdvKGUpO1xuICAgICAgICB9XG4gICAgICAgIHdoaWxlICh0b2RvLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgIGdvKHRvZG8uc2hpZnQoKSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG91dDtcbiAgICB9O1xufTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIENoYWluUmVjQnJlYWR0aEZpcnN0ID0ge1xuICAgIFVSSTogVVJJLFxuICAgIG1hcDogX21hcCxcbiAgICBhcDogX2FwLFxuICAgIGNoYWluOiBmbGF0TWFwLFxuICAgIGNoYWluUmVjOiBfY2hhaW5SZWNCcmVhZHRoRmlyc3Rcbn07XG52YXIgX3dpdGhlciA9IC8qI19fUFVSRV9fKi8gd2l0aGVyRGVmYXVsdChUcmF2ZXJzYWJsZSwgQ29tcGFjdGFibGUpO1xudmFyIF93aWx0ID0gLyojX19QVVJFX18qLyB3aWx0RGVmYXVsdChUcmF2ZXJzYWJsZSwgQ29tcGFjdGFibGUpO1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi43LjBcbiAqL1xuZXhwb3J0IHZhciBXaXRoZXJhYmxlID0ge1xuICAgIFVSSTogVVJJLFxuICAgIG1hcDogX21hcCxcbiAgICBjb21wYWN0OiBjb21wYWN0LFxuICAgIHNlcGFyYXRlOiBzZXBhcmF0ZSxcbiAgICBmaWx0ZXI6IF9maWx0ZXIsXG4gICAgZmlsdGVyTWFwOiBfZmlsdGVyTWFwLFxuICAgIHBhcnRpdGlvbjogX3BhcnRpdGlvbixcbiAgICBwYXJ0aXRpb25NYXA6IF9wYXJ0aXRpb25NYXAsXG4gICAgcmVkdWNlOiBfcmVkdWNlLFxuICAgIGZvbGRNYXA6IF9mb2xkTWFwLFxuICAgIHJlZHVjZVJpZ2h0OiBfcmVkdWNlUmlnaHQsXG4gICAgdHJhdmVyc2U6IF90cmF2ZXJzZSxcbiAgICBzZXF1ZW5jZTogc2VxdWVuY2UsXG4gICAgd2l0aGVyOiBfd2l0aGVyLFxuICAgIHdpbHQ6IF93aWx0XG59O1xuLyoqXG4gKiBGaWx0ZXIgdmFsdWVzIGluc2lkZSBhIGNvbnRleHQuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IHBpcGUgfSBmcm9tICdmcC10cy9mdW5jdGlvbidcbiAqIGltcG9ydCAqIGFzIFJBIGZyb20gJ2ZwLXRzL1JlYWRvbmx5QXJyYXknXG4gKiBpbXBvcnQgKiBhcyBUIGZyb20gJ2ZwLXRzL1Rhc2snXG4gKlxuICogY29uc3QgZmlsdGVyRSA9IFJBLmZpbHRlckUoVC5BcHBsaWNhdGl2ZVBhcilcbiAqIGFzeW5jIGZ1bmN0aW9uIHRlc3QoKSB7XG4gKiAgIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoXG4gKiAgICAgYXdhaXQgcGlwZShcbiAqICAgICAgIFstMSwgMiwgM10sXG4gKiAgICAgICBmaWx0ZXJFKChuKSA9PiBULm9mKG4gPiAwKSlcbiAqICAgICApKCksXG4gKiAgICAgWzIsIDNdXG4gKiAgIClcbiAqIH1cbiAqIHRlc3QoKVxuICpcbiAqIEBzaW5jZSAyLjExLjBcbiAqL1xuZXhwb3J0IHZhciBmaWx0ZXJFID0gLyojX19QVVJFX18qLyBmaWx0ZXJFXyhXaXRoZXJhYmxlKTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIEZyb21FaXRoZXIgPSB7XG4gICAgVVJJOiBVUkksXG4gICAgZnJvbUVpdGhlcjogZnJvbUVpdGhlclxufTtcbi8qKlxuICogQGNhdGVnb3J5IGxpZnRpbmdcbiAqIEBzaW5jZSAyLjExLjBcbiAqL1xuZXhwb3J0IHZhciBmcm9tRWl0aGVySyA9IC8qI19fUFVSRV9fKi8gZnJvbUVpdGhlcktfKEZyb21FaXRoZXIpO1xuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLy8gdW5zYWZlXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vKipcbiAqIEBjYXRlZ29yeSB1bnNhZmVcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIHVuc2FmZUluc2VydEF0ID0gUk5FQS51bnNhZmVJbnNlcnRBdDtcbi8qKlxuICogQGNhdGVnb3J5IHVuc2FmZVxuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgdW5zYWZlVXBkYXRlQXQgPSBmdW5jdGlvbiAoaSwgYSwgYXMpIHtcbiAgICByZXR1cm4gaXNOb25FbXB0eShhcykgPyBSTkVBLnVuc2FmZVVwZGF0ZUF0KGksIGEsIGFzKSA6IGFzO1xufTtcbi8qKlxuICogQGNhdGVnb3J5IHVuc2FmZVxuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgdW5zYWZlRGVsZXRlQXQgPSBmdW5jdGlvbiAoaSwgYXMpIHtcbiAgICB2YXIgeHMgPSBhcy5zbGljZSgpO1xuICAgIHhzLnNwbGljZShpLCAxKTtcbiAgICByZXR1cm4geHM7XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgY29udmVyc2lvbnNcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIHRvQXJyYXkgPSBmdW5jdGlvbiAoYXMpIHsgcmV0dXJuIGFzLnNsaWNlKCk7IH07XG4vKipcbiAqIEBjYXRlZ29yeSBjb252ZXJzaW9uc1xuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgZnJvbUFycmF5ID0gZnVuY3Rpb24gKGFzKSB7IHJldHVybiAoaXNFbXB0eShhcykgPyBlbXB0eSA6IGFzLnNsaWNlKCkpOyB9O1xuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLy8gdXRpbHNcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8qKlxuICogQW4gZW1wdHkgYXJyYXlcbiAqXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBlbXB0eSA9IFJORUEuZW1wdHk7XG5leHBvcnQgZnVuY3Rpb24gZXZlcnkocHJlZGljYXRlKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykgeyByZXR1cm4gYXMuZXZlcnkocHJlZGljYXRlKTsgfTtcbn1cbi8qKlxuICogQ2hlY2sgaWYgYSBwcmVkaWNhdGUgaG9sZHMgdHJ1ZSBmb3IgYW55IGFycmF5IG1lbWJlci5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgc29tZSB9IGZyb20gJ2ZwLXRzL1JlYWRvbmx5QXJyYXknXG4gKiBpbXBvcnQgeyBwaXBlIH0gZnJvbSAnZnAtdHMvZnVuY3Rpb24nXG4gKlxuICogY29uc3QgaXNQb3NpdGl2ZSA9IChuOiBudW1iZXIpOiBib29sZWFuID0+IG4gPiAwXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChwaXBlKFstMSwgLTIsIDNdLCBzb21lKGlzUG9zaXRpdmUpKSwgdHJ1ZSlcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwocGlwZShbLTEsIC0yLCAtM10sIHNvbWUoaXNQb3NpdGl2ZSkpLCBmYWxzZSlcbiAqXG4gKiBAc2luY2UgMi45LjBcbiAqL1xuZXhwb3J0IHZhciBzb21lID0gZnVuY3Rpb24gKHByZWRpY2F0ZSkge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgcmV0dXJuIGFzLnNvbWUocHJlZGljYXRlKTtcbiAgICB9O1xufTtcbi8qKlxuICogQWxpYXMgb2YgW2Bzb21lYF0oI3NvbWUpXG4gKlxuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIGV4aXN0cyA9IHNvbWU7XG4vKipcbiAqIFBsYWNlcyBhbiBlbGVtZW50IGluIGJldHdlZW4gbWVtYmVycyBvZiBhIGBSZWFkb25seUFycmF5YCwgdGhlbiBmb2xkcyB0aGUgcmVzdWx0cyB1c2luZyB0aGUgcHJvdmlkZWQgYE1vbm9pZGAuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCAqIGFzIFMgZnJvbSAnZnAtdHMvc3RyaW5nJ1xuICogaW1wb3J0IHsgaW50ZXJjYWxhdGUgfSBmcm9tICdmcC10cy9SZWFkb25seUFycmF5J1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoaW50ZXJjYWxhdGUoUy5Nb25vaWQpKCctJykoWydhJywgJ2InLCAnYyddKSwgJ2EtYi1jJylcbiAqXG4gKiBAc2luY2UgMi4xMi4wXG4gKi9cbmV4cG9ydCB2YXIgaW50ZXJjYWxhdGUgPSBmdW5jdGlvbiAoTSkge1xuICAgIHZhciBpbnRlcmNhbGF0ZU0gPSBSTkVBLmludGVyY2FsYXRlKE0pO1xuICAgIHJldHVybiBmdW5jdGlvbiAobWlkZGxlKSB7IHJldHVybiBtYXRjaChmdW5jdGlvbiAoKSB7IHJldHVybiBNLmVtcHR5OyB9LCBpbnRlcmNhbGF0ZU0obWlkZGxlKSk7IH07XG59O1xuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLy8gZG8gbm90YXRpb25cbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8qKlxuICogQGNhdGVnb3J5IGRvIG5vdGF0aW9uXG4gKiBAc2luY2UgMi45LjBcbiAqL1xuZXhwb3J0IHZhciBEbyA9IC8qI19fUFVSRV9fKi8gb2YoXy5lbXB0eVJlY29yZCk7XG4vKipcbiAqIEBjYXRlZ29yeSBkbyBub3RhdGlvblxuICogQHNpbmNlIDIuOC4wXG4gKi9cbmV4cG9ydCB2YXIgYmluZFRvID0gLyojX19QVVJFX18qLyBiaW5kVG9fKEZ1bmN0b3IpO1xudmFyIGxldF8gPSAvKiNfX1BVUkVfXyovIGxldF9fKEZ1bmN0b3IpO1xuZXhwb3J0IHsgXG4vKipcbiAqIEBjYXRlZ29yeSBkbyBub3RhdGlvblxuICogQHNpbmNlIDIuMTMuMFxuICovXG5sZXRfIGFzIGxldCB9O1xuLyoqXG4gKiBAY2F0ZWdvcnkgZG8gbm90YXRpb25cbiAqIEBzaW5jZSAyLjguMFxuICovXG5leHBvcnQgdmFyIGJpbmQgPSAvKiNfX1BVUkVfXyovIGJpbmRfKENoYWluKTtcbi8qKlxuICogQGNhdGVnb3J5IGRvIG5vdGF0aW9uXG4gKiBAc2luY2UgMi44LjBcbiAqL1xuZXhwb3J0IHZhciBhcFMgPSAvKiNfX1BVUkVfXyovIGFwU18oQXBwbHkpO1xuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLy8gbGVnYWN5XG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vKipcbiAqIEFsaWFzIG9mIGBmbGF0TWFwYC5cbiAqXG4gKiBAY2F0ZWdvcnkgbGVnYWN5XG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBjaGFpbiA9IGZsYXRNYXA7XG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vLyBkZXByZWNhdGVkXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vKipcbiAqIFVzZSBgUmVhZG9ubHlOb25FbXB0eUFycmF5YCBtb2R1bGUgaW5zdGVhZC5cbiAqXG4gKiBAY2F0ZWdvcnkgem9uZSBvZiBkZWF0aFxuICogQHNpbmNlIDIuNS4wXG4gKiBAZGVwcmVjYXRlZFxuICovXG5leHBvcnQgdmFyIHJhbmdlID0gUk5FQS5yYW5nZTtcbi8qKlxuICogVXNlIFtgcHJlcGVuZGBdKCNwcmVwZW5kKSBpbnN0ZWFkLlxuICpcbiAqIEBjYXRlZ29yeSB6b25lIG9mIGRlYXRoXG4gKiBAc2luY2UgMi41LjBcbiAqIEBkZXByZWNhdGVkXG4gKi9cbmV4cG9ydCB2YXIgY29ucyA9IFJORUEuY29ucztcbi8qKlxuICogVXNlIFtgYXBwZW5kYF0oI2FwcGVuZCkgaW5zdGVhZC5cbiAqXG4gKiBAY2F0ZWdvcnkgem9uZSBvZiBkZWF0aFxuICogQHNpbmNlIDIuNS4wXG4gKiBAZGVwcmVjYXRlZFxuICovXG5leHBvcnQgdmFyIHNub2MgPSBSTkVBLnNub2M7XG4vKipcbiAqIFVzZSBbYHByZXBlbmRBbGxgXSgjcHJlcGVuZGFsbCkgaW5zdGVhZC5cbiAqXG4gKiBAY2F0ZWdvcnkgem9uZSBvZiBkZWF0aFxuICogQHNpbmNlIDIuOS4wXG4gKiBAZGVwcmVjYXRlZFxuICovXG5leHBvcnQgdmFyIHByZXBlbmRUb0FsbCA9IHByZXBlbmRBbGw7XG4vKipcbiAqIFRoaXMgaW5zdGFuY2UgaXMgZGVwcmVjYXRlZCwgdXNlIHNtYWxsLCBzcGVjaWZpYyBpbnN0YW5jZXMgaW5zdGVhZC5cbiAqIEZvciBleGFtcGxlIGlmIGEgZnVuY3Rpb24gbmVlZHMgYSBgRnVuY3RvcmAgaW5zdGFuY2UsIHBhc3MgYFJBLkZ1bmN0b3JgIGluc3RlYWQgb2YgYFJBLnJlYWRvbmx5QXJyYXlgXG4gKiAod2hlcmUgYFJBYCBpcyBmcm9tIGBpbXBvcnQgUkEgZnJvbSAnZnAtdHMvUmVhZG9ubHlBcnJheSdgKVxuICpcbiAqIEBjYXRlZ29yeSB6b25lIG9mIGRlYXRoXG4gKiBAc2luY2UgMi41LjBcbiAqIEBkZXByZWNhdGVkXG4gKi9cbmV4cG9ydCB2YXIgcmVhZG9ubHlBcnJheSA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICBjb21wYWN0OiBjb21wYWN0LFxuICAgIHNlcGFyYXRlOiBzZXBhcmF0ZSxcbiAgICBtYXA6IF9tYXAsXG4gICAgYXA6IF9hcCxcbiAgICBvZjogb2YsXG4gICAgY2hhaW46IGZsYXRNYXAsXG4gICAgZmlsdGVyOiBfZmlsdGVyLFxuICAgIGZpbHRlck1hcDogX2ZpbHRlck1hcCxcbiAgICBwYXJ0aXRpb246IF9wYXJ0aXRpb24sXG4gICAgcGFydGl0aW9uTWFwOiBfcGFydGl0aW9uTWFwLFxuICAgIG1hcFdpdGhJbmRleDogX21hcFdpdGhJbmRleCxcbiAgICBwYXJ0aXRpb25NYXBXaXRoSW5kZXg6IF9wYXJ0aXRpb25NYXBXaXRoSW5kZXgsXG4gICAgcGFydGl0aW9uV2l0aEluZGV4OiBfcGFydGl0aW9uV2l0aEluZGV4LFxuICAgIGZpbHRlck1hcFdpdGhJbmRleDogX2ZpbHRlck1hcFdpdGhJbmRleCxcbiAgICBmaWx0ZXJXaXRoSW5kZXg6IF9maWx0ZXJXaXRoSW5kZXgsXG4gICAgYWx0OiBfYWx0LFxuICAgIHplcm86IHplcm8sXG4gICAgdW5mb2xkOiB1bmZvbGQsXG4gICAgcmVkdWNlOiBfcmVkdWNlLFxuICAgIGZvbGRNYXA6IF9mb2xkTWFwLFxuICAgIHJlZHVjZVJpZ2h0OiBfcmVkdWNlUmlnaHQsXG4gICAgdHJhdmVyc2U6IF90cmF2ZXJzZSxcbiAgICBzZXF1ZW5jZTogc2VxdWVuY2UsXG4gICAgcmVkdWNlV2l0aEluZGV4OiBfcmVkdWNlV2l0aEluZGV4LFxuICAgIGZvbGRNYXBXaXRoSW5kZXg6IF9mb2xkTWFwV2l0aEluZGV4LFxuICAgIHJlZHVjZVJpZ2h0V2l0aEluZGV4OiBfcmVkdWNlUmlnaHRXaXRoSW5kZXgsXG4gICAgdHJhdmVyc2VXaXRoSW5kZXg6IF90cmF2ZXJzZVdpdGhJbmRleCxcbiAgICBleHRlbmQ6IF9leHRlbmQsXG4gICAgd2l0aGVyOiBfd2l0aGVyLFxuICAgIHdpbHQ6IF93aWx0XG59O1xuIiwKICAidmFyIF9fc3ByZWFkQXJyYXkgPSAodGhpcyAmJiB0aGlzLl9fc3ByZWFkQXJyYXkpIHx8IGZ1bmN0aW9uICh0bywgZnJvbSwgcGFjaykge1xuICAgIGlmIChwYWNrIHx8IGFyZ3VtZW50cy5sZW5ndGggPT09IDIpIGZvciAodmFyIGkgPSAwLCBsID0gZnJvbS5sZW5ndGgsIGFyOyBpIDwgbDsgaSsrKSB7XG4gICAgICAgIGlmIChhciB8fCAhKGkgaW4gZnJvbSkpIHtcbiAgICAgICAgICAgIGlmICghYXIpIGFyID0gQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoZnJvbSwgMCwgaSk7XG4gICAgICAgICAgICBhcltpXSA9IGZyb21baV07XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHRvLmNvbmNhdChhciB8fCBBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChmcm9tKSk7XG59O1xuaW1wb3J0IHsgYXBGaXJzdCBhcyBhcEZpcnN0XywgYXBTIGFzIGFwU18sIGFwU2Vjb25kIGFzIGFwU2Vjb25kXyB9IGZyb20gJy4vQXBwbHknO1xuaW1wb3J0IHsgYmluZCBhcyBiaW5kXywgY2hhaW5GaXJzdCBhcyBjaGFpbkZpcnN0XyB9IGZyb20gJy4vQ2hhaW4nO1xuaW1wb3J0IHsgZnJvbUVxdWFscyB9IGZyb20gJy4vRXEnO1xuaW1wb3J0IHsgZnJvbUVpdGhlcksgYXMgZnJvbUVpdGhlcktfIH0gZnJvbSAnLi9Gcm9tRWl0aGVyJztcbmltcG9ydCB7IGR1YWwsIGlkZW50aXR5LCBwaXBlIH0gZnJvbSAnLi9mdW5jdGlvbic7XG5pbXBvcnQgeyBiaW5kVG8gYXMgYmluZFRvXywgZmxhcCBhcyBmbGFwXywgbGV0IGFzIGxldF9fIH0gZnJvbSAnLi9GdW5jdG9yJztcbmltcG9ydCAqIGFzIF8gZnJvbSAnLi9pbnRlcm5hbCc7XG5pbXBvcnQgKiBhcyBOIGZyb20gJy4vbnVtYmVyJztcbmltcG9ydCB7IGZyb21Db21wYXJlIH0gZnJvbSAnLi9PcmQnO1xuaW1wb3J0ICogYXMgUk5FQSBmcm9tICcuL1JlYWRvbmx5Tm9uRW1wdHlBcnJheSc7XG5pbXBvcnQgeyBzZXBhcmF0ZWQgfSBmcm9tICcuL1NlcGFyYXRlZCc7XG5pbXBvcnQgeyBmaWx0ZXJFIGFzIGZpbHRlckVfLCB3aWx0RGVmYXVsdCwgd2l0aGVyRGVmYXVsdCB9IGZyb20gJy4vV2l0aGVyYWJsZSc7XG5pbXBvcnQgeyBndWFyZCBhcyBndWFyZF8gfSBmcm9tICcuL1plcm8nO1xuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLy8gcmVmaW5lbWVudHNcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8qKlxuICogVGVzdCB3aGV0aGVyIGEgYFJlYWRvbmx5QXJyYXlgIGlzIGVtcHR5LlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBpc0VtcHR5IH0gZnJvbSAnZnAtdHMvUmVhZG9ubHlBcnJheSdcbiAqXG4gKiBhc3NlcnQuc3RyaWN0RXF1YWwoaXNFbXB0eShbXSksIHRydWUpXG4gKlxuICogQGNhdGVnb3J5IHJlZmluZW1lbnRzXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBpc0VtcHR5ID0gZnVuY3Rpb24gKGFzKSB7IHJldHVybiBhcy5sZW5ndGggPT09IDA7IH07XG4vKipcbiAqIFRlc3Qgd2hldGhlciBhIGBSZWFkb25seUFycmF5YCBpcyBub24gZW1wdHkuXG4gKlxuICogQGNhdGVnb3J5IHJlZmluZW1lbnRzXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBpc05vbkVtcHR5ID0gUk5FQS5pc05vbkVtcHR5O1xuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLy8gY29uc3RydWN0b3JzXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vKipcbiAqIFByZXBlbmQgYW4gZWxlbWVudCB0byB0aGUgZnJvbnQgb2YgYSBgUmVhZG9ubHlBcnJheWAsIGNyZWF0aW5nIGEgbmV3IGBSZWFkb25seU5vbkVtcHR5QXJyYXlgLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBwcmVwZW5kIH0gZnJvbSAnZnAtdHMvUmVhZG9ubHlBcnJheSdcbiAqIGltcG9ydCB7IHBpcGUgfSBmcm9tICdmcC10cy9mdW5jdGlvbidcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKHBpcGUoWzIsIDMsIDRdLCBwcmVwZW5kKDEpKSwgWzEsIDIsIDMsIDRdKVxuICpcbiAqIEBzaW5jZSAyLjEwLjBcbiAqL1xuZXhwb3J0IHZhciBwcmVwZW5kID0gUk5FQS5wcmVwZW5kO1xuLyoqXG4gKiBMZXNzIHN0cmljdCB2ZXJzaW9uIG9mIFtgcHJlcGVuZGBdKCNwcmVwZW5kKS5cbiAqXG4gKiBAc2luY2UgMi4xMS4wXG4gKi9cbmV4cG9ydCB2YXIgcHJlcGVuZFcgPSBSTkVBLnByZXBlbmRXO1xuLyoqXG4gKiBBcHBlbmQgYW4gZWxlbWVudCB0byB0aGUgZW5kIG9mIGEgYFJlYWRvbmx5QXJyYXlgLCBjcmVhdGluZyBhIG5ldyBgUmVhZG9ubHlOb25FbXB0eUFycmF5YC5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgYXBwZW5kIH0gZnJvbSAnZnAtdHMvUmVhZG9ubHlBcnJheSdcbiAqIGltcG9ydCB7IHBpcGUgfSBmcm9tICdmcC10cy9mdW5jdGlvbidcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKHBpcGUoWzEsIDIsIDNdLCBhcHBlbmQoNCkpLCBbMSwgMiwgMywgNF0pXG4gKlxuICogQHNpbmNlIDIuMTAuMFxuICovXG5leHBvcnQgdmFyIGFwcGVuZCA9IFJORUEuYXBwZW5kO1xuLyoqXG4gKiBMZXNzIHN0cmljdCB2ZXJzaW9uIG9mIFtgYXBwZW5kYF0oI2FwcGVuZCkuXG4gKlxuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIGFwcGVuZFcgPSBSTkVBLmFwcGVuZFc7XG4vKipcbiAqIFJldHVybiBhIGBSZWFkb25seUFycmF5YCBvZiBsZW5ndGggYG5gIHdpdGggZWxlbWVudCBgaWAgaW5pdGlhbGl6ZWQgd2l0aCBgZihpKWAuXG4gKlxuICogKipOb3RlKiouIGBuYCBpcyBub3JtYWxpemVkIHRvIGEgbm9uIG5lZ2F0aXZlIGludGVnZXIuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IG1ha2VCeSB9IGZyb20gJ2ZwLXRzL1JlYWRvbmx5QXJyYXknXG4gKlxuICogY29uc3QgZG91YmxlID0gKG46IG51bWJlcik6IG51bWJlciA9PiBuICogMlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChtYWtlQnkoNSwgZG91YmxlKSwgWzAsIDIsIDQsIDYsIDhdKVxuICpcbiAqIEBjYXRlZ29yeSBjb25zdHJ1Y3RvcnNcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIG1ha2VCeSA9IGZ1bmN0aW9uIChuLCBmKSB7IHJldHVybiAobiA8PSAwID8gZW1wdHkgOiBSTkVBLm1ha2VCeShmKShuKSk7IH07XG4vKipcbiAqIENyZWF0ZSBhIGBSZWFkb25seUFycmF5YCBjb250YWluaW5nIGEgdmFsdWUgcmVwZWF0ZWQgdGhlIHNwZWNpZmllZCBudW1iZXIgb2YgdGltZXMuXG4gKlxuICogKipOb3RlKiouIGBuYCBpcyBub3JtYWxpemVkIHRvIGEgbm9uIG5lZ2F0aXZlIGludGVnZXIuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IHJlcGxpY2F0ZSB9IGZyb20gJ2ZwLXRzL1JlYWRvbmx5QXJyYXknXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChyZXBsaWNhdGUoMywgJ2EnKSwgWydhJywgJ2EnLCAnYSddKVxuICpcbiAqIEBjYXRlZ29yeSBjb25zdHJ1Y3RvcnNcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIHJlcGxpY2F0ZSA9IGZ1bmN0aW9uIChuLCBhKSB7IHJldHVybiBtYWtlQnkobiwgZnVuY3Rpb24gKCkgeyByZXR1cm4gYTsgfSk7IH07XG5leHBvcnQgZnVuY3Rpb24gZnJvbVByZWRpY2F0ZShwcmVkaWNhdGUpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGEpIHsgcmV0dXJuIChwcmVkaWNhdGUoYSkgPyBbYV0gOiBlbXB0eSk7IH07XG59XG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vLyBjb252ZXJzaW9uc1xuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLyoqXG4gKiBAY2F0ZWdvcnkgY29udmVyc2lvbnNcbiAqIEBzaW5jZSAyLjExLjBcbiAqL1xuZXhwb3J0IHZhciBmcm9tT3B0aW9uID0gZnVuY3Rpb24gKG1hKSB7IHJldHVybiAoXy5pc05vbmUobWEpID8gZW1wdHkgOiBbbWEudmFsdWVdKTsgfTtcbi8qKlxuICogVHJhbnNmb3JtcyBhbiBgRWl0aGVyYCB0byBhIGBSZWFkb25seUFycmF5YC5cbiAqXG4gKiBAY2F0ZWdvcnkgY29udmVyc2lvbnNcbiAqIEBzaW5jZSAyLjExLjBcbiAqL1xuZXhwb3J0IHZhciBmcm9tRWl0aGVyID0gZnVuY3Rpb24gKGUpIHsgcmV0dXJuIChfLmlzTGVmdChlKSA/IGVtcHR5IDogW2UucmlnaHRdKTsgfTtcbi8qKlxuICogTGVzcyBzdHJpY3QgdmVyc2lvbiBvZiBbYG1hdGNoYF0oI21hdGNoKS5cbiAqXG4gKiBUaGUgYFdgIHN1ZmZpeCAoc2hvcnQgZm9yICoqVyoqaWRlbmluZykgbWVhbnMgdGhhdCB0aGUgaGFuZGxlciByZXR1cm4gdHlwZXMgd2lsbCBiZSBtZXJnZWQuXG4gKlxuICogQGNhdGVnb3J5IHBhdHRlcm4gbWF0Y2hpbmdcbiAqIEBzaW5jZSAyLjExLjBcbiAqL1xuZXhwb3J0IHZhciBtYXRjaFcgPSBmdW5jdGlvbiAob25FbXB0eSwgb25Ob25FbXB0eSkge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgcmV0dXJuIGlzTm9uRW1wdHkoYXMpID8gb25Ob25FbXB0eShhcykgOiBvbkVtcHR5KCk7XG4gICAgfTtcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBwYXR0ZXJuIG1hdGNoaW5nXG4gKiBAc2luY2UgMi4xMS4wXG4gKi9cbmV4cG9ydCB2YXIgbWF0Y2ggPSBtYXRjaFc7XG4vKipcbiAqIExlc3Mgc3RyaWN0IHZlcnNpb24gb2YgW2BtYXRjaExlZnRgXSgjbWF0Y2hsZWZ0KS5cbiAqXG4gKiBAY2F0ZWdvcnkgcGF0dGVybiBtYXRjaGluZ1xuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIG1hdGNoTGVmdFcgPSBmdW5jdGlvbiAob25FbXB0eSwgb25Ob25FbXB0eSkge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgcmV0dXJuIGlzTm9uRW1wdHkoYXMpID8gb25Ob25FbXB0eShSTkVBLmhlYWQoYXMpLCBSTkVBLnRhaWwoYXMpKSA6IG9uRW1wdHkoKTtcbiAgICB9O1xufTtcbi8qKlxuICogQnJlYWsgYSBgUmVhZG9ubHlBcnJheWAgaW50byBpdHMgZmlyc3QgZWxlbWVudCBhbmQgcmVtYWluaW5nIGVsZW1lbnRzLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBtYXRjaExlZnQgfSBmcm9tICdmcC10cy9SZWFkb25seUFycmF5J1xuICpcbiAqIGNvbnN0IGxlbjogPEE+KGFzOiBSZWFkb25seUFycmF5PEE+KSA9PiBudW1iZXIgPSBtYXRjaExlZnQoKCkgPT4gMCwgKF8sIHRhaWwpID0+IDEgKyBsZW4odGFpbCkpXG4gKiBhc3NlcnQuc3RyaWN0RXF1YWwobGVuKFsxLCAyLCAzXSksIDMpXG4gKlxuICogQGNhdGVnb3J5IHBhdHRlcm4gbWF0Y2hpbmdcbiAqIEBzaW5jZSAyLjEwLjBcbiAqL1xuZXhwb3J0IHZhciBtYXRjaExlZnQgPSBtYXRjaExlZnRXO1xuLyoqXG4gKiBBbGlhcyBvZiBbYG1hdGNoTGVmdGBdKCNtYXRjaGxlZnQpLlxuICpcbiAqIEBjYXRlZ29yeSBwYXR0ZXJuIG1hdGNoaW5nXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBmb2xkTGVmdCA9IG1hdGNoTGVmdDtcbi8qKlxuICogTGVzcyBzdHJpY3QgdmVyc2lvbiBvZiBbYG1hdGNoUmlnaHRgXSgjbWF0Y2hyaWdodCkuXG4gKlxuICogQGNhdGVnb3J5IHBhdHRlcm4gbWF0Y2hpbmdcbiAqIEBzaW5jZSAyLjExLjBcbiAqL1xuZXhwb3J0IHZhciBtYXRjaFJpZ2h0VyA9IGZ1bmN0aW9uIChvbkVtcHR5LCBvbk5vbkVtcHR5KSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykge1xuICAgICAgICByZXR1cm4gaXNOb25FbXB0eShhcykgPyBvbk5vbkVtcHR5KFJORUEuaW5pdChhcyksIFJORUEubGFzdChhcykpIDogb25FbXB0eSgpO1xuICAgIH07XG59O1xuLyoqXG4gKiBCcmVhayBhIGBSZWFkb25seUFycmF5YCBpbnRvIGl0cyBpbml0aWFsIGVsZW1lbnRzIGFuZCB0aGUgbGFzdCBlbGVtZW50LlxuICpcbiAqIEBjYXRlZ29yeSBwYXR0ZXJuIG1hdGNoaW5nXG4gKiBAc2luY2UgMi4xMC4wXG4gKi9cbmV4cG9ydCB2YXIgbWF0Y2hSaWdodCA9IG1hdGNoUmlnaHRXO1xuLyoqXG4gKiBBbGlhcyBvZiBbYG1hdGNoUmlnaHRgXSgjbWF0Y2hyaWdodCkuXG4gKlxuICogQGNhdGVnb3J5IHBhdHRlcm4gbWF0Y2hpbmdcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIGZvbGRSaWdodCA9IG1hdGNoUmlnaHQ7XG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vLyBjb21iaW5hdG9yc1xuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLyoqXG4gKiBAY2F0ZWdvcnkgc2VxdWVuY2luZ1xuICogQHNpbmNlIDIuNy4wXG4gKi9cbmV4cG9ydCB2YXIgY2hhaW5XaXRoSW5kZXggPSBmdW5jdGlvbiAoZikge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgaWYgKGlzRW1wdHkoYXMpKSB7XG4gICAgICAgICAgICByZXR1cm4gZW1wdHk7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIG91dCA9IFtdO1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGFzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICBvdXQucHVzaC5hcHBseShvdXQsIGYoaSwgYXNbaV0pKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gb3V0O1xuICAgIH07XG59O1xuLyoqXG4gKiBTYW1lIGFzIGByZWR1Y2VgIGJ1dCBpdCBjYXJyaWVzIG92ZXIgdGhlIGludGVybWVkaWF0ZSBzdGVwcy5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgc2NhbkxlZnQgfSBmcm9tICdmcC10cy9SZWFkb25seUFycmF5J1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoc2NhbkxlZnQoMTAsIChiLCBhOiBudW1iZXIpID0+IGIgLSBhKShbMSwgMiwgM10pLCBbMTAsIDksIDcsIDRdKVxuICpcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIHNjYW5MZWZ0ID0gZnVuY3Rpb24gKGIsIGYpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIHZhciBsZW4gPSBhcy5sZW5ndGg7XG4gICAgICAgIHZhciBvdXQgPSBuZXcgQXJyYXkobGVuICsgMSk7XG4gICAgICAgIG91dFswXSA9IGI7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbGVuOyBpKyspIHtcbiAgICAgICAgICAgIG91dFtpICsgMV0gPSBmKG91dFtpXSwgYXNbaV0pO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBvdXQ7XG4gICAgfTtcbn07XG4vKipcbiAqIEZvbGQgYW4gYXJyYXkgZnJvbSB0aGUgcmlnaHQsIGtlZXBpbmcgYWxsIGludGVybWVkaWF0ZSByZXN1bHRzIGluc3RlYWQgb2Ygb25seSB0aGUgZmluYWwgcmVzdWx0XG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IHNjYW5SaWdodCB9IGZyb20gJ2ZwLXRzL1JlYWRvbmx5QXJyYXknXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChzY2FuUmlnaHQoMTAsIChhOiBudW1iZXIsIGIpID0+IGIgLSBhKShbMSwgMiwgM10pLCBbNCwgNSwgNywgMTBdKVxuICpcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIHNjYW5SaWdodCA9IGZ1bmN0aW9uIChiLCBmKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykge1xuICAgICAgICB2YXIgbGVuID0gYXMubGVuZ3RoO1xuICAgICAgICB2YXIgb3V0ID0gbmV3IEFycmF5KGxlbiArIDEpO1xuICAgICAgICBvdXRbbGVuXSA9IGI7XG4gICAgICAgIGZvciAodmFyIGkgPSBsZW4gLSAxOyBpID49IDA7IGktLSkge1xuICAgICAgICAgICAgb3V0W2ldID0gZihhc1tpXSwgb3V0W2kgKyAxXSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG91dDtcbiAgICB9O1xufTtcbi8qKlxuICogQ2FsY3VsYXRlIHRoZSBudW1iZXIgb2YgZWxlbWVudHMgaW4gYSBgUmVhZG9ubHlBcnJheWAuXG4gKlxuICogQHNpbmNlIDIuMTAuMFxuICovXG5leHBvcnQgdmFyIHNpemUgPSBmdW5jdGlvbiAoYXMpIHsgcmV0dXJuIGFzLmxlbmd0aDsgfTtcbi8qKlxuICogVGVzdCB3aGV0aGVyIGFuIGFycmF5IGNvbnRhaW5zIGEgcGFydGljdWxhciBpbmRleFxuICpcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIGlzT3V0T2ZCb3VuZCA9IFJORUEuaXNPdXRPZkJvdW5kO1xuZXhwb3J0IGZ1bmN0aW9uIGxvb2t1cChpLCBhcykge1xuICAgIHJldHVybiBhcyA9PT0gdW5kZWZpbmVkID8gZnVuY3Rpb24gKGFzKSB7IHJldHVybiBsb29rdXAoaSwgYXMpOyB9IDogaXNPdXRPZkJvdW5kKGksIGFzKSA/IF8ubm9uZSA6IF8uc29tZShhc1tpXSk7XG59XG4vKipcbiAqIEdldCB0aGUgZmlyc3QgZWxlbWVudCBpbiBhbiBhcnJheSwgb3IgYE5vbmVgIGlmIHRoZSBhcnJheSBpcyBlbXB0eVxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBoZWFkIH0gZnJvbSAnZnAtdHMvUmVhZG9ubHlBcnJheSdcbiAqIGltcG9ydCB7IHNvbWUsIG5vbmUgfSBmcm9tICdmcC10cy9PcHRpb24nXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChoZWFkKFsxLCAyLCAzXSksIHNvbWUoMSkpXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKGhlYWQoW10pLCBub25lKVxuICpcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIGhlYWQgPSBmdW5jdGlvbiAoYXMpIHsgcmV0dXJuIChpc05vbkVtcHR5KGFzKSA/IF8uc29tZShSTkVBLmhlYWQoYXMpKSA6IF8ubm9uZSk7IH07XG4vKipcbiAqIEdldCB0aGUgbGFzdCBlbGVtZW50IGluIGFuIGFycmF5LCBvciBgTm9uZWAgaWYgdGhlIGFycmF5IGlzIGVtcHR5XG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IGxhc3QgfSBmcm9tICdmcC10cy9SZWFkb25seUFycmF5J1xuICogaW1wb3J0IHsgc29tZSwgbm9uZSB9IGZyb20gJ2ZwLXRzL09wdGlvbidcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKGxhc3QoWzEsIDIsIDNdKSwgc29tZSgzKSlcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwobGFzdChbXSksIG5vbmUpXG4gKlxuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgbGFzdCA9IGZ1bmN0aW9uIChhcykgeyByZXR1cm4gKGlzTm9uRW1wdHkoYXMpID8gXy5zb21lKFJORUEubGFzdChhcykpIDogXy5ub25lKTsgfTtcbi8qKlxuICogR2V0IGFsbCBidXQgdGhlIGZpcnN0IGVsZW1lbnQgb2YgYW4gYXJyYXksIGNyZWF0aW5nIGEgbmV3IGFycmF5LCBvciBgTm9uZWAgaWYgdGhlIGFycmF5IGlzIGVtcHR5XG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IHRhaWwgfSBmcm9tICdmcC10cy9SZWFkb25seUFycmF5J1xuICogaW1wb3J0IHsgc29tZSwgbm9uZSB9IGZyb20gJ2ZwLXRzL09wdGlvbidcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKHRhaWwoWzEsIDIsIDNdKSwgc29tZShbMiwgM10pKVxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbCh0YWlsKFtdKSwgbm9uZSlcbiAqXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciB0YWlsID0gZnVuY3Rpb24gKGFzKSB7XG4gICAgcmV0dXJuIGlzTm9uRW1wdHkoYXMpID8gXy5zb21lKFJORUEudGFpbChhcykpIDogXy5ub25lO1xufTtcbi8qKlxuICogR2V0IGFsbCBidXQgdGhlIGxhc3QgZWxlbWVudCBvZiBhbiBhcnJheSwgY3JlYXRpbmcgYSBuZXcgYXJyYXksIG9yIGBOb25lYCBpZiB0aGUgYXJyYXkgaXMgZW1wdHlcbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgaW5pdCB9IGZyb20gJ2ZwLXRzL1JlYWRvbmx5QXJyYXknXG4gKiBpbXBvcnQgeyBzb21lLCBub25lIH0gZnJvbSAnZnAtdHMvT3B0aW9uJ1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoaW5pdChbMSwgMiwgM10pLCBzb21lKFsxLCAyXSkpXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKGluaXQoW10pLCBub25lKVxuICpcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIGluaXQgPSBmdW5jdGlvbiAoYXMpIHtcbiAgICByZXR1cm4gaXNOb25FbXB0eShhcykgPyBfLnNvbWUoUk5FQS5pbml0KGFzKSkgOiBfLm5vbmU7XG59O1xuLyoqXG4gKiBLZWVwIG9ubHkgYSBtYXggbnVtYmVyIG9mIGVsZW1lbnRzIGZyb20gdGhlIHN0YXJ0IG9mIGFuIGBSZWFkb25seUFycmF5YCwgY3JlYXRpbmcgYSBuZXcgYFJlYWRvbmx5QXJyYXlgLlxuICpcbiAqICoqTm90ZSoqLiBgbmAgaXMgbm9ybWFsaXplZCB0byBhIG5vbiBuZWdhdGl2ZSBpbnRlZ2VyLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgKiBhcyBSQSBmcm9tICdmcC10cy9SZWFkb25seUFycmF5J1xuICogaW1wb3J0IHsgcGlwZSB9IGZyb20gJ2ZwLXRzL2Z1bmN0aW9uJ1xuICpcbiAqIGNvbnN0IGlucHV0OiBSZWFkb25seUFycmF5PG51bWJlcj4gPSBbMSwgMiwgM11cbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwocGlwZShpbnB1dCwgUkEudGFrZUxlZnQoMikpLCBbMSwgMl0pXG4gKlxuICogLy8gb3V0IG9mIGJvdW5kc1xuICogYXNzZXJ0LnN0cmljdEVxdWFsKHBpcGUoaW5wdXQsIFJBLnRha2VMZWZ0KDQpKSwgaW5wdXQpXG4gKiBhc3NlcnQuc3RyaWN0RXF1YWwocGlwZShpbnB1dCwgUkEudGFrZUxlZnQoLTEpKSwgaW5wdXQpXG4gKlxuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgdGFrZUxlZnQgPSBmdW5jdGlvbiAobikge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgcmV0dXJuIGlzT3V0T2ZCb3VuZChuLCBhcykgPyBhcyA6IG4gPT09IDAgPyBlbXB0eSA6IGFzLnNsaWNlKDAsIG4pO1xuICAgIH07XG59O1xuLyoqXG4gKiBLZWVwIG9ubHkgYSBtYXggbnVtYmVyIG9mIGVsZW1lbnRzIGZyb20gdGhlIGVuZCBvZiBhbiBgUmVhZG9ubHlBcnJheWAsIGNyZWF0aW5nIGEgbmV3IGBSZWFkb25seUFycmF5YC5cbiAqXG4gKiAqKk5vdGUqKi4gYG5gIGlzIG5vcm1hbGl6ZWQgdG8gYSBub24gbmVnYXRpdmUgaW50ZWdlci5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0ICogYXMgUkEgZnJvbSAnZnAtdHMvUmVhZG9ubHlBcnJheSdcbiAqIGltcG9ydCB7IHBpcGUgfSBmcm9tICdmcC10cy9mdW5jdGlvbidcbiAqXG4gKiBjb25zdCBpbnB1dDogUmVhZG9ubHlBcnJheTxudW1iZXI+ID0gWzEsIDIsIDNdXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKHBpcGUoaW5wdXQsIFJBLnRha2VSaWdodCgyKSksIFsyLCAzXSlcbiAqXG4gKiAvLyBvdXQgb2YgYm91bmRzXG4gKiBhc3NlcnQuc3RyaWN0RXF1YWwocGlwZShpbnB1dCwgUkEudGFrZVJpZ2h0KDQpKSwgaW5wdXQpXG4gKiBhc3NlcnQuc3RyaWN0RXF1YWwocGlwZShpbnB1dCwgUkEudGFrZVJpZ2h0KC0xKSksIGlucHV0KVxuICpcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIHRha2VSaWdodCA9IGZ1bmN0aW9uIChuKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykge1xuICAgICAgICByZXR1cm4gaXNPdXRPZkJvdW5kKG4sIGFzKSA/IGFzIDogbiA9PT0gMCA/IGVtcHR5IDogYXMuc2xpY2UoLW4pO1xuICAgIH07XG59O1xuZXhwb3J0IGZ1bmN0aW9uIHRha2VMZWZ0V2hpbGUocHJlZGljYXRlKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykge1xuICAgICAgICB2YXIgb3V0ID0gW107XG4gICAgICAgIGZvciAodmFyIF9pID0gMCwgYXNfMSA9IGFzOyBfaSA8IGFzXzEubGVuZ3RoOyBfaSsrKSB7XG4gICAgICAgICAgICB2YXIgYSA9IGFzXzFbX2ldO1xuICAgICAgICAgICAgaWYgKCFwcmVkaWNhdGUoYSkpIHtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIG91dC5wdXNoKGEpO1xuICAgICAgICB9XG4gICAgICAgIHZhciBsZW4gPSBvdXQubGVuZ3RoO1xuICAgICAgICByZXR1cm4gbGVuID09PSBhcy5sZW5ndGggPyBhcyA6IGxlbiA9PT0gMCA/IGVtcHR5IDogb3V0O1xuICAgIH07XG59XG52YXIgc3BhbkxlZnRJbmRleCA9IGZ1bmN0aW9uIChhcywgcHJlZGljYXRlKSB7XG4gICAgdmFyIGwgPSBhcy5sZW5ndGg7XG4gICAgdmFyIGkgPSAwO1xuICAgIGZvciAoOyBpIDwgbDsgaSsrKSB7XG4gICAgICAgIGlmICghcHJlZGljYXRlKGFzW2ldKSkge1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIGk7XG59O1xuZXhwb3J0IGZ1bmN0aW9uIHNwYW5MZWZ0KHByZWRpY2F0ZSkge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgdmFyIF9hID0gc3BsaXRBdChzcGFuTGVmdEluZGV4KGFzLCBwcmVkaWNhdGUpKShhcyksIGluaXQgPSBfYVswXSwgcmVzdCA9IF9hWzFdO1xuICAgICAgICByZXR1cm4geyBpbml0OiBpbml0LCByZXN0OiByZXN0IH07XG4gICAgfTtcbn1cbi8qKlxuICogRHJvcCBhIG1heCBudW1iZXIgb2YgZWxlbWVudHMgZnJvbSB0aGUgc3RhcnQgb2YgYW4gYFJlYWRvbmx5QXJyYXlgLCBjcmVhdGluZyBhIG5ldyBgUmVhZG9ubHlBcnJheWAuXG4gKlxuICogKipOb3RlKiouIGBuYCBpcyBub3JtYWxpemVkIHRvIGEgbm9uIG5lZ2F0aXZlIGludGVnZXIuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCAqIGFzIFJBIGZyb20gJ2ZwLXRzL1JlYWRvbmx5QXJyYXknXG4gKiBpbXBvcnQgeyBwaXBlIH0gZnJvbSAnZnAtdHMvZnVuY3Rpb24nXG4gKlxuICogY29uc3QgaW5wdXQ6IFJlYWRvbmx5QXJyYXk8bnVtYmVyPiA9IFsxLCAyLCAzXVxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChwaXBlKGlucHV0LCBSQS5kcm9wTGVmdCgyKSksIFszXSlcbiAqIGFzc2VydC5zdHJpY3RFcXVhbChwaXBlKGlucHV0LCBSQS5kcm9wTGVmdCgwKSksIGlucHV0KVxuICogYXNzZXJ0LnN0cmljdEVxdWFsKHBpcGUoaW5wdXQsIFJBLmRyb3BMZWZ0KC0xKSksIGlucHV0KVxuICpcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIGRyb3BMZWZ0ID0gZnVuY3Rpb24gKG4pIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIHJldHVybiBuIDw9IDAgfHwgaXNFbXB0eShhcykgPyBhcyA6IG4gPj0gYXMubGVuZ3RoID8gZW1wdHkgOiBhcy5zbGljZShuLCBhcy5sZW5ndGgpO1xuICAgIH07XG59O1xuLyoqXG4gKiBEcm9wIGEgbWF4IG51bWJlciBvZiBlbGVtZW50cyBmcm9tIHRoZSBlbmQgb2YgYW4gYFJlYWRvbmx5QXJyYXlgLCBjcmVhdGluZyBhIG5ldyBgUmVhZG9ubHlBcnJheWAuXG4gKlxuICogKipOb3RlKiouIGBuYCBpcyBub3JtYWxpemVkIHRvIGEgbm9uIG5lZ2F0aXZlIGludGVnZXIuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCAqIGFzIFJBIGZyb20gJ2ZwLXRzL1JlYWRvbmx5QXJyYXknXG4gKiBpbXBvcnQgeyBwaXBlIH0gZnJvbSAnZnAtdHMvZnVuY3Rpb24nXG4gKlxuICogY29uc3QgaW5wdXQ6IFJlYWRvbmx5QXJyYXk8bnVtYmVyPiA9IFsxLCAyLCAzXVxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChwaXBlKGlucHV0LCBSQS5kcm9wUmlnaHQoMikpLCBbMV0pXG4gKiBhc3NlcnQuc3RyaWN0RXF1YWwocGlwZShpbnB1dCwgUkEuZHJvcFJpZ2h0KDApKSwgaW5wdXQpXG4gKiBhc3NlcnQuc3RyaWN0RXF1YWwocGlwZShpbnB1dCwgUkEuZHJvcFJpZ2h0KC0xKSksIGlucHV0KVxuICpcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIGRyb3BSaWdodCA9IGZ1bmN0aW9uIChuKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykge1xuICAgICAgICByZXR1cm4gbiA8PSAwIHx8IGlzRW1wdHkoYXMpID8gYXMgOiBuID49IGFzLmxlbmd0aCA/IGVtcHR5IDogYXMuc2xpY2UoMCwgYXMubGVuZ3RoIC0gbik7XG4gICAgfTtcbn07XG5leHBvcnQgZnVuY3Rpb24gZHJvcExlZnRXaGlsZShwcmVkaWNhdGUpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIHZhciBpID0gc3BhbkxlZnRJbmRleChhcywgcHJlZGljYXRlKTtcbiAgICAgICAgcmV0dXJuIGkgPT09IDAgPyBhcyA6IGkgPT09IGFzLmxlbmd0aCA/IGVtcHR5IDogYXMuc2xpY2UoaSk7XG4gICAgfTtcbn1cbi8qKlxuICogRmluZCB0aGUgZmlyc3QgaW5kZXggZm9yIHdoaWNoIGEgcHJlZGljYXRlIGhvbGRzXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IGZpbmRJbmRleCB9IGZyb20gJ2ZwLXRzL1JlYWRvbmx5QXJyYXknXG4gKiBpbXBvcnQgeyBzb21lLCBub25lIH0gZnJvbSAnZnAtdHMvT3B0aW9uJ1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoZmluZEluZGV4KChuOiBudW1iZXIpID0+IG4gPT09IDIpKFsxLCAyLCAzXSksIHNvbWUoMSkpXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKGZpbmRJbmRleCgobjogbnVtYmVyKSA9PiBuID09PSAyKShbXSksIG5vbmUpXG4gKlxuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgZmluZEluZGV4ID0gZnVuY3Rpb24gKHByZWRpY2F0ZSkge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBhcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgaWYgKHByZWRpY2F0ZShhc1tpXSkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gXy5zb21lKGkpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBfLm5vbmU7XG4gICAgfTtcbn07XG5leHBvcnQgZnVuY3Rpb24gZmluZEZpcnN0KHByZWRpY2F0ZSkge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBhcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgaWYgKHByZWRpY2F0ZShhc1tpXSkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gXy5zb21lKGFzW2ldKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gXy5ub25lO1xuICAgIH07XG59XG4vKipcbiAqIEZpbmQgdGhlIGZpcnN0IGVsZW1lbnQgcmV0dXJuZWQgYnkgYW4gb3B0aW9uIGJhc2VkIHNlbGVjdG9yIGZ1bmN0aW9uXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IGZpbmRGaXJzdE1hcCB9IGZyb20gJ2ZwLXRzL1JlYWRvbmx5QXJyYXknXG4gKiBpbXBvcnQgeyBzb21lLCBub25lIH0gZnJvbSAnZnAtdHMvT3B0aW9uJ1xuICpcbiAqIGludGVyZmFjZSBQZXJzb24ge1xuICogICByZWFkb25seSBuYW1lOiBzdHJpbmdcbiAqICAgcmVhZG9ubHkgYWdlPzogbnVtYmVyXG4gKiB9XG4gKlxuICogY29uc3QgcGVyc29uczogUmVhZG9ubHlBcnJheTxQZXJzb24+ID0gW3sgbmFtZTogJ0pvaG4nIH0sIHsgbmFtZTogJ01hcnknLCBhZ2U6IDQ1IH0sIHsgbmFtZTogJ0pvZXknLCBhZ2U6IDI4IH1dXG4gKlxuICogLy8gcmV0dXJucyB0aGUgbmFtZSBvZiB0aGUgZmlyc3QgcGVyc29uIHRoYXQgaGFzIGFuIGFnZVxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChmaW5kRmlyc3RNYXAoKHA6IFBlcnNvbikgPT4gKHAuYWdlID09PSB1bmRlZmluZWQgPyBub25lIDogc29tZShwLm5hbWUpKSkocGVyc29ucyksIHNvbWUoJ01hcnknKSlcbiAqXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBmaW5kRmlyc3RNYXAgPSBmdW5jdGlvbiAoZikge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBhcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgdmFyIG91dCA9IGYoYXNbaV0pO1xuICAgICAgICAgICAgaWYgKF8uaXNTb21lKG91dCkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gb3V0O1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBfLm5vbmU7XG4gICAgfTtcbn07XG5leHBvcnQgZnVuY3Rpb24gZmluZExhc3QocHJlZGljYXRlKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykge1xuICAgICAgICBmb3IgKHZhciBpID0gYXMubGVuZ3RoIC0gMTsgaSA+PSAwOyBpLS0pIHtcbiAgICAgICAgICAgIGlmIChwcmVkaWNhdGUoYXNbaV0pKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIF8uc29tZShhc1tpXSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIF8ubm9uZTtcbiAgICB9O1xufVxuLyoqXG4gKiBGaW5kIHRoZSBsYXN0IGVsZW1lbnQgcmV0dXJuZWQgYnkgYW4gb3B0aW9uIGJhc2VkIHNlbGVjdG9yIGZ1bmN0aW9uXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IGZpbmRMYXN0TWFwIH0gZnJvbSAnZnAtdHMvUmVhZG9ubHlBcnJheSdcbiAqIGltcG9ydCB7IHNvbWUsIG5vbmUgfSBmcm9tICdmcC10cy9PcHRpb24nXG4gKlxuICogaW50ZXJmYWNlIFBlcnNvbiB7XG4gKiAgIHJlYWRvbmx5IG5hbWU6IHN0cmluZ1xuICogICByZWFkb25seSBhZ2U/OiBudW1iZXJcbiAqIH1cbiAqXG4gKiBjb25zdCBwZXJzb25zOiBSZWFkb25seUFycmF5PFBlcnNvbj4gPSBbeyBuYW1lOiAnSm9obicgfSwgeyBuYW1lOiAnTWFyeScsIGFnZTogNDUgfSwgeyBuYW1lOiAnSm9leScsIGFnZTogMjggfV1cbiAqXG4gKiAvLyByZXR1cm5zIHRoZSBuYW1lIG9mIHRoZSBsYXN0IHBlcnNvbiB0aGF0IGhhcyBhbiBhZ2VcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoZmluZExhc3RNYXAoKHA6IFBlcnNvbikgPT4gKHAuYWdlID09PSB1bmRlZmluZWQgPyBub25lIDogc29tZShwLm5hbWUpKSkocGVyc29ucyksIHNvbWUoJ0pvZXknKSlcbiAqXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBmaW5kTGFzdE1hcCA9IGZ1bmN0aW9uIChmKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykge1xuICAgICAgICBmb3IgKHZhciBpID0gYXMubGVuZ3RoIC0gMTsgaSA+PSAwOyBpLS0pIHtcbiAgICAgICAgICAgIHZhciBvdXQgPSBmKGFzW2ldKTtcbiAgICAgICAgICAgIGlmIChfLmlzU29tZShvdXQpKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG91dDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gXy5ub25lO1xuICAgIH07XG59O1xuLyoqXG4gKiBSZXR1cm5zIHRoZSBpbmRleCBvZiB0aGUgbGFzdCBlbGVtZW50IG9mIHRoZSBsaXN0IHdoaWNoIG1hdGNoZXMgdGhlIHByZWRpY2F0ZVxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBmaW5kTGFzdEluZGV4IH0gZnJvbSAnZnAtdHMvUmVhZG9ubHlBcnJheSdcbiAqIGltcG9ydCB7IHNvbWUsIG5vbmUgfSBmcm9tICdmcC10cy9PcHRpb24nXG4gKlxuICogaW50ZXJmYWNlIFgge1xuICogICByZWFkb25seSBhOiBudW1iZXJcbiAqICAgcmVhZG9ubHkgYjogbnVtYmVyXG4gKiB9XG4gKiBjb25zdCB4czogUmVhZG9ubHlBcnJheTxYPiA9IFt7IGE6IDEsIGI6IDAgfSwgeyBhOiAxLCBiOiAxIH1dXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKGZpbmRMYXN0SW5kZXgoKHg6IHsgcmVhZG9ubHkgYTogbnVtYmVyIH0pID0+IHguYSA9PT0gMSkoeHMpLCBzb21lKDEpKVxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChmaW5kTGFzdEluZGV4KCh4OiB7IHJlYWRvbmx5IGE6IG51bWJlciB9KSA9PiB4LmEgPT09IDQpKHhzKSwgbm9uZSlcbiAqXG4gKlxuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgZmluZExhc3RJbmRleCA9IGZ1bmN0aW9uIChwcmVkaWNhdGUpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIGZvciAodmFyIGkgPSBhcy5sZW5ndGggLSAxOyBpID49IDA7IGktLSkge1xuICAgICAgICAgICAgaWYgKHByZWRpY2F0ZShhc1tpXSkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gXy5zb21lKGkpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBfLm5vbmU7XG4gICAgfTtcbn07XG4vKipcbiAqIEluc2VydCBhbiBlbGVtZW50IGF0IHRoZSBzcGVjaWZpZWQgaW5kZXgsIGNyZWF0aW5nIGEgbmV3IGFycmF5LCBvciByZXR1cm5pbmcgYE5vbmVgIGlmIHRoZSBpbmRleCBpcyBvdXQgb2YgYm91bmRzXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IGluc2VydEF0IH0gZnJvbSAnZnAtdHMvUmVhZG9ubHlBcnJheSdcbiAqIGltcG9ydCB7IHNvbWUgfSBmcm9tICdmcC10cy9PcHRpb24nXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChpbnNlcnRBdCgyLCA1KShbMSwgMiwgMywgNF0pLCBzb21lKFsxLCAyLCA1LCAzLCA0XSkpXG4gKlxuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgaW5zZXJ0QXQgPSBmdW5jdGlvbiAoaSwgYSkge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgcmV0dXJuIGkgPCAwIHx8IGkgPiBhcy5sZW5ndGggPyBfLm5vbmUgOiBfLnNvbWUoUk5FQS51bnNhZmVJbnNlcnRBdChpLCBhLCBhcykpO1xuICAgIH07XG59O1xuLyoqXG4gKiBDaGFuZ2UgdGhlIGVsZW1lbnQgYXQgdGhlIHNwZWNpZmllZCBpbmRleCwgY3JlYXRpbmcgYSBuZXcgYXJyYXksIG9yIHJldHVybmluZyBgTm9uZWAgaWYgdGhlIGluZGV4IGlzIG91dCBvZiBib3VuZHNcbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgdXBkYXRlQXQgfSBmcm9tICdmcC10cy9SZWFkb25seUFycmF5J1xuICogaW1wb3J0IHsgc29tZSwgbm9uZSB9IGZyb20gJ2ZwLXRzL09wdGlvbidcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKHVwZGF0ZUF0KDEsIDEpKFsxLCAyLCAzXSksIHNvbWUoWzEsIDEsIDNdKSlcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwodXBkYXRlQXQoMSwgMSkoW10pLCBub25lKVxuICpcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIHVwZGF0ZUF0ID0gZnVuY3Rpb24gKGksIGEpIHtcbiAgICByZXR1cm4gbW9kaWZ5QXQoaSwgZnVuY3Rpb24gKCkgeyByZXR1cm4gYTsgfSk7XG59O1xuLyoqXG4gKiBEZWxldGUgdGhlIGVsZW1lbnQgYXQgdGhlIHNwZWNpZmllZCBpbmRleCwgY3JlYXRpbmcgYSBuZXcgYXJyYXksIG9yIHJldHVybmluZyBgTm9uZWAgaWYgdGhlIGluZGV4IGlzIG91dCBvZiBib3VuZHNcbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgZGVsZXRlQXQgfSBmcm9tICdmcC10cy9SZWFkb25seUFycmF5J1xuICogaW1wb3J0IHsgc29tZSwgbm9uZSB9IGZyb20gJ2ZwLXRzL09wdGlvbidcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKGRlbGV0ZUF0KDApKFsxLCAyLCAzXSksIHNvbWUoWzIsIDNdKSlcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoZGVsZXRlQXQoMSkoW10pLCBub25lKVxuICpcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIGRlbGV0ZUF0ID0gZnVuY3Rpb24gKGkpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIHJldHVybiBpc091dE9mQm91bmQoaSwgYXMpID8gXy5ub25lIDogXy5zb21lKHVuc2FmZURlbGV0ZUF0KGksIGFzKSk7XG4gICAgfTtcbn07XG4vKipcbiAqIEFwcGx5IGEgZnVuY3Rpb24gdG8gdGhlIGVsZW1lbnQgYXQgdGhlIHNwZWNpZmllZCBpbmRleCwgY3JlYXRpbmcgYSBuZXcgYXJyYXksIG9yIHJldHVybmluZyBgTm9uZWAgaWYgdGhlIGluZGV4IGlzIG91dFxuICogb2YgYm91bmRzXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IG1vZGlmeUF0IH0gZnJvbSAnZnAtdHMvUmVhZG9ubHlBcnJheSdcbiAqIGltcG9ydCB7IHNvbWUsIG5vbmUgfSBmcm9tICdmcC10cy9PcHRpb24nXG4gKlxuICogY29uc3QgZG91YmxlID0gKHg6IG51bWJlcik6IG51bWJlciA9PiB4ICogMlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChtb2RpZnlBdCgxLCBkb3VibGUpKFsxLCAyLCAzXSksIHNvbWUoWzEsIDQsIDNdKSlcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwobW9kaWZ5QXQoMSwgZG91YmxlKShbXSksIG5vbmUpXG4gKlxuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgbW9kaWZ5QXQgPSBmdW5jdGlvbiAoaSwgZikge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgcmV0dXJuIGlzT3V0T2ZCb3VuZChpLCBhcykgPyBfLm5vbmUgOiBfLnNvbWUodW5zYWZlVXBkYXRlQXQoaSwgZihhc1tpXSksIGFzKSk7XG4gICAgfTtcbn07XG4vKipcbiAqIFJldmVyc2UgYW4gYXJyYXksIGNyZWF0aW5nIGEgbmV3IGFycmF5XG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IHJldmVyc2UgfSBmcm9tICdmcC10cy9SZWFkb25seUFycmF5J1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwocmV2ZXJzZShbMSwgMiwgM10pLCBbMywgMiwgMV0pXG4gKlxuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgcmV2ZXJzZSA9IGZ1bmN0aW9uIChhcykgeyByZXR1cm4gKGFzLmxlbmd0aCA8PSAxID8gYXMgOiBhcy5zbGljZSgpLnJldmVyc2UoKSk7IH07XG4vKipcbiAqIEV4dHJhY3RzIGZyb20gYW4gYXJyYXkgb2YgYEVpdGhlcmAgYWxsIHRoZSBgUmlnaHRgIGVsZW1lbnRzLiBBbGwgdGhlIGBSaWdodGAgZWxlbWVudHMgYXJlIGV4dHJhY3RlZCBpbiBvcmRlclxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyByaWdodHMgfSBmcm9tICdmcC10cy9SZWFkb25seUFycmF5J1xuICogaW1wb3J0IHsgcmlnaHQsIGxlZnQgfSBmcm9tICdmcC10cy9FaXRoZXInXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChyaWdodHMoW3JpZ2h0KDEpLCBsZWZ0KCdmb28nKSwgcmlnaHQoMildKSwgWzEsIDJdKVxuICpcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIHJpZ2h0cyA9IGZ1bmN0aW9uIChhcykge1xuICAgIHZhciByID0gW107XG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBhcy5sZW5ndGg7IGkrKykge1xuICAgICAgICB2YXIgYSA9IGFzW2ldO1xuICAgICAgICBpZiAoYS5fdGFnID09PSAnUmlnaHQnKSB7XG4gICAgICAgICAgICByLnB1c2goYS5yaWdodCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHI7XG59O1xuLyoqXG4gKiBFeHRyYWN0cyBmcm9tIGFuIGFycmF5IG9mIGBFaXRoZXJgIGFsbCB0aGUgYExlZnRgIGVsZW1lbnRzLiBBbGwgdGhlIGBMZWZ0YCBlbGVtZW50cyBhcmUgZXh0cmFjdGVkIGluIG9yZGVyXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IGxlZnRzIH0gZnJvbSAnZnAtdHMvUmVhZG9ubHlBcnJheSdcbiAqIGltcG9ydCB7IGxlZnQsIHJpZ2h0IH0gZnJvbSAnZnAtdHMvRWl0aGVyJ1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwobGVmdHMoW3JpZ2h0KDEpLCBsZWZ0KCdmb28nKSwgcmlnaHQoMildKSwgWydmb28nXSlcbiAqXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBsZWZ0cyA9IGZ1bmN0aW9uIChhcykge1xuICAgIHZhciByID0gW107XG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBhcy5sZW5ndGg7IGkrKykge1xuICAgICAgICB2YXIgYSA9IGFzW2ldO1xuICAgICAgICBpZiAoYS5fdGFnID09PSAnTGVmdCcpIHtcbiAgICAgICAgICAgIHIucHVzaChhLmxlZnQpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiByO1xufTtcbi8qKlxuICogU29ydCB0aGUgZWxlbWVudHMgb2YgYW4gYXJyYXkgaW4gaW5jcmVhc2luZyBvcmRlciwgY3JlYXRpbmcgYSBuZXcgYXJyYXlcbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgc29ydCB9IGZyb20gJ2ZwLXRzL1JlYWRvbmx5QXJyYXknXG4gKiBpbXBvcnQgKiBhcyBOIGZyb20gJ2ZwLXRzL251bWJlcidcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKHNvcnQoTi5PcmQpKFszLCAyLCAxXSksIFsxLCAyLCAzXSlcbiAqXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBzb3J0ID0gZnVuY3Rpb24gKE8pIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIHJldHVybiBhcy5sZW5ndGggPD0gMSA/IGFzIDogYXMuc2xpY2UoKS5zb3J0KE8uY29tcGFyZSk7XG4gICAgfTtcbn07XG4vLyBUT0RPOiBjdXJyeSBhbmQgbWFrZSBkYXRhLWxhc3QgaW4gdjNcbi8qKlxuICogQXBwbHkgYSBmdW5jdGlvbiB0byBwYWlycyBvZiBlbGVtZW50cyBhdCB0aGUgc2FtZSBpbmRleCBpbiB0d28gYXJyYXlzLCBjb2xsZWN0aW5nIHRoZSByZXN1bHRzIGluIGEgbmV3IGFycmF5LiBJZiBvbmVcbiAqIGlucHV0IGFycmF5IGlzIHNob3J0LCBleGNlc3MgZWxlbWVudHMgb2YgdGhlIGxvbmdlciBhcnJheSBhcmUgZGlzY2FyZGVkLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyB6aXBXaXRoIH0gZnJvbSAnZnAtdHMvUmVhZG9ubHlBcnJheSdcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKHppcFdpdGgoWzEsIDIsIDNdLCBbJ2EnLCAnYicsICdjJywgJ2QnXSwgKG4sIHMpID0+IHMgKyBuKSwgWydhMScsICdiMicsICdjMyddKVxuICpcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIHppcFdpdGggPSBmdW5jdGlvbiAoZmEsIGZiLCBmKSB7XG4gICAgdmFyIGZjID0gW107XG4gICAgdmFyIGxlbiA9IE1hdGgubWluKGZhLmxlbmd0aCwgZmIubGVuZ3RoKTtcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IGxlbjsgaSsrKSB7XG4gICAgICAgIGZjW2ldID0gZihmYVtpXSwgZmJbaV0pO1xuICAgIH1cbiAgICByZXR1cm4gZmM7XG59O1xuZXhwb3J0IGZ1bmN0aW9uIHppcChhcywgYnMpIHtcbiAgICBpZiAoYnMgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICByZXR1cm4gZnVuY3Rpb24gKGJzKSB7IHJldHVybiB6aXAoYnMsIGFzKTsgfTtcbiAgICB9XG4gICAgcmV0dXJuIHppcFdpdGgoYXMsIGJzLCBmdW5jdGlvbiAoYSwgYikgeyByZXR1cm4gW2EsIGJdOyB9KTtcbn1cbi8qKlxuICogVGhlIGZ1bmN0aW9uIGlzIHJldmVyc2Ugb2YgYHppcGAuIFRha2VzIGFuIGFycmF5IG9mIHBhaXJzIGFuZCByZXR1cm4gdHdvIGNvcnJlc3BvbmRpbmcgYXJyYXlzXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IHVuemlwIH0gZnJvbSAnZnAtdHMvUmVhZG9ubHlBcnJheSdcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKHVuemlwKFtbMSwgJ2EnXSwgWzIsICdiJ10sIFszLCAnYyddXSksIFtbMSwgMiwgM10sIFsnYScsICdiJywgJ2MnXV0pXG4gKlxuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgdW56aXAgPSBmdW5jdGlvbiAoYXMpIHtcbiAgICB2YXIgZmEgPSBbXTtcbiAgICB2YXIgZmIgPSBbXTtcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IGFzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIGZhW2ldID0gYXNbaV1bMF07XG4gICAgICAgIGZiW2ldID0gYXNbaV1bMV07XG4gICAgfVxuICAgIHJldHVybiBbZmEsIGZiXTtcbn07XG4vKipcbiAqIFByZXBlbmQgYW4gZWxlbWVudCB0byBldmVyeSBtZW1iZXIgb2YgYW4gYXJyYXlcbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgcHJlcGVuZEFsbCB9IGZyb20gJ2ZwLXRzL1JlYWRvbmx5QXJyYXknXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChwcmVwZW5kQWxsKDkpKFsxLCAyLCAzLCA0XSksIFs5LCAxLCA5LCAyLCA5LCAzLCA5LCA0XSlcbiAqXG4gKiBAc2luY2UgMi4xMC4wXG4gKi9cbmV4cG9ydCB2YXIgcHJlcGVuZEFsbCA9IGZ1bmN0aW9uIChtaWRkbGUpIHtcbiAgICB2YXIgZiA9IFJORUEucHJlcGVuZEFsbChtaWRkbGUpO1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHsgcmV0dXJuIChpc05vbkVtcHR5KGFzKSA/IGYoYXMpIDogYXMpOyB9O1xufTtcbi8qKlxuICogUGxhY2VzIGFuIGVsZW1lbnQgaW4gYmV0d2VlbiBtZW1iZXJzIG9mIGFuIGFycmF5XG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IGludGVyc3BlcnNlIH0gZnJvbSAnZnAtdHMvUmVhZG9ubHlBcnJheSdcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKGludGVyc3BlcnNlKDkpKFsxLCAyLCAzLCA0XSksIFsxLCA5LCAyLCA5LCAzLCA5LCA0XSlcbiAqXG4gKiBAc2luY2UgMi45LjBcbiAqL1xuZXhwb3J0IHZhciBpbnRlcnNwZXJzZSA9IGZ1bmN0aW9uIChtaWRkbGUpIHtcbiAgICB2YXIgZiA9IFJORUEuaW50ZXJzcGVyc2UobWlkZGxlKTtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7IHJldHVybiAoaXNOb25FbXB0eShhcykgPyBmKGFzKSA6IGFzKTsgfTtcbn07XG4vKipcbiAqIFJvdGF0ZSBhIGBSZWFkb25seUFycmF5YCBieSBgbmAgc3RlcHMuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IHJvdGF0ZSB9IGZyb20gJ2ZwLXRzL1JlYWRvbmx5QXJyYXknXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChyb3RhdGUoMikoWzEsIDIsIDMsIDQsIDVdKSwgWzQsIDUsIDEsIDIsIDNdKVxuICpcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIHJvdGF0ZSA9IGZ1bmN0aW9uIChuKSB7XG4gICAgdmFyIGYgPSBSTkVBLnJvdGF0ZShuKTtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7IHJldHVybiAoaXNOb25FbXB0eShhcykgPyBmKGFzKSA6IGFzKTsgfTtcbn07XG5leHBvcnQgZnVuY3Rpb24gZWxlbShFKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhLCBhcykge1xuICAgICAgICBpZiAoYXMgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgdmFyIGVsZW1FXzEgPSBlbGVtKEUpO1xuICAgICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIChhcykgeyByZXR1cm4gZWxlbUVfMShhLCBhcyk7IH07XG4gICAgICAgIH1cbiAgICAgICAgdmFyIHByZWRpY2F0ZSA9IGZ1bmN0aW9uIChlbGVtZW50KSB7IHJldHVybiBFLmVxdWFscyhlbGVtZW50LCBhKTsgfTtcbiAgICAgICAgdmFyIGkgPSAwO1xuICAgICAgICBmb3IgKDsgaSA8IGFzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICBpZiAocHJlZGljYXRlKGFzW2ldKSkge1xuICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9O1xufVxuLyoqXG4gKiBSZW1vdmUgZHVwbGljYXRlcyBmcm9tIGFuIGFycmF5LCBrZWVwaW5nIHRoZSBmaXJzdCBvY2N1cnJlbmNlIG9mIGFuIGVsZW1lbnQuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IHVuaXEgfSBmcm9tICdmcC10cy9SZWFkb25seUFycmF5J1xuICogaW1wb3J0ICogYXMgTiBmcm9tICdmcC10cy9udW1iZXInXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbCh1bmlxKE4uRXEpKFsxLCAyLCAxXSksIFsxLCAyXSlcbiAqXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciB1bmlxID0gZnVuY3Rpb24gKEUpIHtcbiAgICB2YXIgZiA9IFJORUEudW5pcShFKTtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7IHJldHVybiAoaXNOb25FbXB0eShhcykgPyBmKGFzKSA6IGFzKTsgfTtcbn07XG4vKipcbiAqIFNvcnQgdGhlIGVsZW1lbnRzIG9mIGFuIGFycmF5IGluIGluY3JlYXNpbmcgb3JkZXIsIHdoZXJlIGVsZW1lbnRzIGFyZSBjb21wYXJlZCB1c2luZyBmaXJzdCBgb3Jkc1swXWAsIHRoZW4gYG9yZHNbMV1gLFxuICogZXRjLi4uXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IHNvcnRCeSB9IGZyb20gJ2ZwLXRzL1JlYWRvbmx5QXJyYXknXG4gKiBpbXBvcnQgeyBjb250cmFtYXAgfSBmcm9tICdmcC10cy9PcmQnXG4gKiBpbXBvcnQgKiBhcyBTIGZyb20gJ2ZwLXRzL3N0cmluZydcbiAqIGltcG9ydCAqIGFzIE4gZnJvbSAnZnAtdHMvbnVtYmVyJ1xuICogaW1wb3J0IHsgcGlwZSB9IGZyb20gJ2ZwLXRzL2Z1bmN0aW9uJ1xuICpcbiAqIGludGVyZmFjZSBQZXJzb24ge1xuICogICByZWFkb25seSBuYW1lOiBzdHJpbmdcbiAqICAgcmVhZG9ubHkgYWdlOiBudW1iZXJcbiAqIH1cbiAqIGNvbnN0IGJ5TmFtZSA9IHBpcGUoUy5PcmQsIGNvbnRyYW1hcCgocDogUGVyc29uKSA9PiBwLm5hbWUpKVxuICogY29uc3QgYnlBZ2UgPSBwaXBlKE4uT3JkLCBjb250cmFtYXAoKHA6IFBlcnNvbikgPT4gcC5hZ2UpKVxuICpcbiAqIGNvbnN0IHNvcnRCeU5hbWVCeUFnZSA9IHNvcnRCeShbYnlOYW1lLCBieUFnZV0pXG4gKlxuICogY29uc3QgcGVyc29ucyA9IFt7IG5hbWU6ICdhJywgYWdlOiAxIH0sIHsgbmFtZTogJ2InLCBhZ2U6IDMgfSwgeyBuYW1lOiAnYycsIGFnZTogMiB9LCB7IG5hbWU6ICdiJywgYWdlOiAyIH1dXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKHNvcnRCeU5hbWVCeUFnZShwZXJzb25zKSwgW1xuICogICB7IG5hbWU6ICdhJywgYWdlOiAxIH0sXG4gKiAgIHsgbmFtZTogJ2InLCBhZ2U6IDIgfSxcbiAqICAgeyBuYW1lOiAnYicsIGFnZTogMyB9LFxuICogICB7IG5hbWU6ICdjJywgYWdlOiAyIH1cbiAqIF0pXG4gKlxuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgc29ydEJ5ID0gZnVuY3Rpb24gKG9yZHMpIHtcbiAgICB2YXIgZiA9IFJORUEuc29ydEJ5KG9yZHMpO1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHsgcmV0dXJuIChpc05vbkVtcHR5KGFzKSA/IGYoYXMpIDogYXMpOyB9O1xufTtcbi8qKlxuICogQSB1c2VmdWwgcmVjdXJzaW9uIHBhdHRlcm4gZm9yIHByb2Nlc3NpbmcgYSBgUmVhZG9ubHlBcnJheWAgdG8gcHJvZHVjZSBhIG5ldyBgUmVhZG9ubHlBcnJheWAsIG9mdGVuIHVzZWQgZm9yIFwiY2hvcHBpbmdcIiB1cCB0aGUgaW5wdXRcbiAqIGBSZWFkb25seUFycmF5YC4gVHlwaWNhbGx5IGBjaG9wYCBpcyBjYWxsZWQgd2l0aCBzb21lIGZ1bmN0aW9uIHRoYXQgd2lsbCBjb25zdW1lIGFuIGluaXRpYWwgcHJlZml4IG9mIHRoZSBgUmVhZG9ubHlBcnJheWAgYW5kIHByb2R1Y2UgYVxuICogdmFsdWUgYW5kIHRoZSB0YWlsIG9mIHRoZSBgUmVhZG9ubHlBcnJheWAuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IEVxIH0gZnJvbSAnZnAtdHMvRXEnXG4gKiBpbXBvcnQgKiBhcyBSQSBmcm9tICdmcC10cy9SZWFkb25seUFycmF5J1xuICogaW1wb3J0ICogYXMgTiBmcm9tICdmcC10cy9udW1iZXInXG4gKiBpbXBvcnQgeyBwaXBlIH0gZnJvbSAnZnAtdHMvZnVuY3Rpb24nXG4gKlxuICogY29uc3QgZ3JvdXAgPSA8QT4oUzogRXE8QT4pOiAoKGFzOiBSZWFkb25seUFycmF5PEE+KSA9PiBSZWFkb25seUFycmF5PFJlYWRvbmx5QXJyYXk8QT4+KSA9PiB7XG4gKiAgIHJldHVybiBSQS5jaG9wKGFzID0+IHtcbiAqICAgICBjb25zdCB7IGluaXQsIHJlc3QgfSA9IHBpcGUoYXMsIFJBLnNwYW5MZWZ0KChhOiBBKSA9PiBTLmVxdWFscyhhLCBhc1swXSkpKVxuICogICAgIHJldHVybiBbaW5pdCwgcmVzdF1cbiAqICAgfSlcbiAqIH1cbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoZ3JvdXAoTi5FcSkoWzEsIDEsIDIsIDMsIDMsIDRdKSwgW1sxLCAxXSwgWzJdLCBbMywgM10sIFs0XV0pXG4gKlxuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgY2hvcCA9IGZ1bmN0aW9uIChmKSB7XG4gICAgdmFyIGcgPSBSTkVBLmNob3AoZik7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykgeyByZXR1cm4gKGlzTm9uRW1wdHkoYXMpID8gZyhhcykgOiBlbXB0eSk7IH07XG59O1xuLyoqXG4gKiBTcGxpdHMgYSBgUmVhZG9ubHlBcnJheWAgaW50byB0d28gcGllY2VzLCB0aGUgZmlyc3QgcGllY2UgaGFzIG1heCBgbmAgZWxlbWVudHMuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IHNwbGl0QXQgfSBmcm9tICdmcC10cy9SZWFkb25seUFycmF5J1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoc3BsaXRBdCgyKShbMSwgMiwgMywgNCwgNV0pLCBbWzEsIDJdLCBbMywgNCwgNV1dKVxuICpcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIHNwbGl0QXQgPSBmdW5jdGlvbiAobikge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgcmV0dXJuIG4gPj0gMSAmJiBpc05vbkVtcHR5KGFzKSA/IFJORUEuc3BsaXRBdChuKShhcykgOiBpc0VtcHR5KGFzKSA/IFthcywgZW1wdHldIDogW2VtcHR5LCBhc107XG4gICAgfTtcbn07XG4vKipcbiAqIFNwbGl0cyBhIGBSZWFkb25seUFycmF5YCBpbnRvIGxlbmd0aC1gbmAgcGllY2VzLiBUaGUgbGFzdCBwaWVjZSB3aWxsIGJlIHNob3J0ZXIgaWYgYG5gIGRvZXMgbm90IGV2ZW5seSBkaXZpZGUgdGhlIGxlbmd0aCBvZlxuICogdGhlIGBSZWFkb25seUFycmF5YC4gTm90ZSB0aGF0IGBjaHVua3NPZihuKShbXSlgIGlzIGBbXWAsIG5vdCBgW1tdXWAuIFRoaXMgaXMgaW50ZW50aW9uYWwsIGFuZCBpcyBjb25zaXN0ZW50IHdpdGggYSByZWN1cnNpdmVcbiAqIGRlZmluaXRpb24gb2YgYGNodW5rc09mYDsgaXQgc2F0aXNmaWVzIHRoZSBwcm9wZXJ0eSB0aGF0OlxuICpcbiAqIGBgYHRzXG4gKiBjaHVua3NPZihuKSh4cykuY29uY2F0KGNodW5rc09mKG4pKHlzKSkgPT0gY2h1bmtzT2YobikoeHMuY29uY2F0KHlzKSkpXG4gKiBgYGBcbiAqXG4gKiB3aGVuZXZlciBgbmAgZXZlbmx5IGRpdmlkZXMgdGhlIGxlbmd0aCBvZiBgYXNgLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBjaHVua3NPZiB9IGZyb20gJ2ZwLXRzL1JlYWRvbmx5QXJyYXknXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChjaHVua3NPZigyKShbMSwgMiwgMywgNCwgNV0pLCBbWzEsIDJdLCBbMywgNF0sIFs1XV0pXG4gKlxuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgY2h1bmtzT2YgPSBmdW5jdGlvbiAobikge1xuICAgIHZhciBmID0gUk5FQS5jaHVua3NPZihuKTtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7IHJldHVybiAoaXNOb25FbXB0eShhcykgPyBmKGFzKSA6IGVtcHR5KTsgfTtcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBsaWZ0aW5nXG4gKiBAc2luY2UgMi4xMS4wXG4gKi9cbmV4cG9ydCB2YXIgZnJvbU9wdGlvbksgPSBmdW5jdGlvbiAoZikge1xuICAgIHJldHVybiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBhID0gW107XG4gICAgICAgIGZvciAodmFyIF9pID0gMDsgX2kgPCBhcmd1bWVudHMubGVuZ3RoOyBfaSsrKSB7XG4gICAgICAgICAgICBhW19pXSA9IGFyZ3VtZW50c1tfaV07XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGZyb21PcHRpb24oZi5hcHBseSh2b2lkIDAsIGEpKTtcbiAgICB9O1xufTtcbmV4cG9ydCBmdW5jdGlvbiBjb21wcmVoZW5zaW9uKGlucHV0LCBmLCBnKSB7XG4gICAgaWYgKGcgPT09IHZvaWQgMCkgeyBnID0gZnVuY3Rpb24gKCkgeyByZXR1cm4gdHJ1ZTsgfTsgfVxuICAgIHZhciBnbyA9IGZ1bmN0aW9uIChzY29wZSwgaW5wdXQpIHtcbiAgICAgICAgcmV0dXJuIGlzTm9uRW1wdHkoaW5wdXQpXG4gICAgICAgICAgICA/IGZsYXRNYXAoUk5FQS5oZWFkKGlucHV0KSwgZnVuY3Rpb24gKGEpIHsgcmV0dXJuIGdvKHBpcGUoc2NvcGUsIGFwcGVuZChhKSksIFJORUEudGFpbChpbnB1dCkpOyB9KVxuICAgICAgICAgICAgOiBnLmFwcGx5KHZvaWQgMCwgc2NvcGUpID8gW2YuYXBwbHkodm9pZCAwLCBzY29wZSldXG4gICAgICAgICAgICAgICAgOiBlbXB0eTtcbiAgICB9O1xuICAgIHJldHVybiBnbyhlbXB0eSwgaW5wdXQpO1xufVxuLyoqXG4gKiBAc2luY2UgMi4xMS4wXG4gKi9cbmV4cG9ydCB2YXIgY29uY2F0VyA9IGZ1bmN0aW9uIChzZWNvbmQpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGZpcnN0KSB7XG4gICAgICAgIHJldHVybiBpc0VtcHR5KGZpcnN0KSA/IHNlY29uZCA6IGlzRW1wdHkoc2Vjb25kKSA/IGZpcnN0IDogZmlyc3QuY29uY2F0KHNlY29uZCk7XG4gICAgfTtcbn07XG4vKipcbiAqIEBzaW5jZSAyLjExLjBcbiAqL1xuZXhwb3J0IHZhciBjb25jYXQgPSBjb25jYXRXO1xuZXhwb3J0IGZ1bmN0aW9uIHVuaW9uKEUpIHtcbiAgICB2YXIgdW5pb25FID0gUk5FQS51bmlvbihFKTtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGZpcnN0LCBzZWNvbmQpIHtcbiAgICAgICAgaWYgKHNlY29uZCA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICB2YXIgdW5pb25FXzEgPSB1bmlvbihFKTtcbiAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbiAoc2Vjb25kKSB7IHJldHVybiB1bmlvbkVfMShzZWNvbmQsIGZpcnN0KTsgfTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gaXNOb25FbXB0eShmaXJzdCkgJiYgaXNOb25FbXB0eShzZWNvbmQpID8gdW5pb25FKHNlY29uZCkoZmlyc3QpIDogaXNOb25FbXB0eShmaXJzdCkgPyBmaXJzdCA6IHNlY29uZDtcbiAgICB9O1xufVxuZXhwb3J0IGZ1bmN0aW9uIGludGVyc2VjdGlvbihFKSB7XG4gICAgdmFyIGVsZW1FID0gZWxlbShFKTtcbiAgICByZXR1cm4gZnVuY3Rpb24gKHhzLCB5cykge1xuICAgICAgICBpZiAoeXMgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgdmFyIGludGVyc2VjdGlvbkVfMSA9IGludGVyc2VjdGlvbihFKTtcbiAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbiAoeXMpIHsgcmV0dXJuIGludGVyc2VjdGlvbkVfMSh5cywgeHMpOyB9O1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB4cy5maWx0ZXIoZnVuY3Rpb24gKGEpIHsgcmV0dXJuIGVsZW1FKGEsIHlzKTsgfSk7XG4gICAgfTtcbn1cbmV4cG9ydCBmdW5jdGlvbiBkaWZmZXJlbmNlKEUpIHtcbiAgICB2YXIgZWxlbUUgPSBlbGVtKEUpO1xuICAgIHJldHVybiBmdW5jdGlvbiAoeHMsIHlzKSB7XG4gICAgICAgIGlmICh5cyA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICB2YXIgZGlmZmVyZW5jZUVfMSA9IGRpZmZlcmVuY2UoRSk7XG4gICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24gKHlzKSB7IHJldHVybiBkaWZmZXJlbmNlRV8xKHlzLCB4cyk7IH07XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHhzLmZpbHRlcihmdW5jdGlvbiAoYSkgeyByZXR1cm4gIWVsZW1FKGEsIHlzKTsgfSk7XG4gICAgfTtcbn1cbnZhciBfbWFwID0gZnVuY3Rpb24gKGZhLCBmKSB7IHJldHVybiBwaXBlKGZhLCBtYXAoZikpOyB9O1xudmFyIF9tYXBXaXRoSW5kZXggPSBmdW5jdGlvbiAoZmEsIGYpIHsgcmV0dXJuIHBpcGUoZmEsIG1hcFdpdGhJbmRleChmKSk7IH07XG52YXIgX2FwID0gZnVuY3Rpb24gKGZhYiwgZmEpIHsgcmV0dXJuIHBpcGUoZmFiLCBhcChmYSkpOyB9O1xudmFyIF9maWx0ZXIgPSBmdW5jdGlvbiAoZmEsIHByZWRpY2F0ZSkge1xuICAgIHJldHVybiBwaXBlKGZhLCBmaWx0ZXIocHJlZGljYXRlKSk7XG59O1xudmFyIF9maWx0ZXJNYXAgPSBmdW5jdGlvbiAoZmEsIGYpIHsgcmV0dXJuIHBpcGUoZmEsIGZpbHRlck1hcChmKSk7IH07XG52YXIgX3BhcnRpdGlvbiA9IGZ1bmN0aW9uIChmYSwgcHJlZGljYXRlKSB7XG4gICAgcmV0dXJuIHBpcGUoZmEsIHBhcnRpdGlvbihwcmVkaWNhdGUpKTtcbn07XG52YXIgX3BhcnRpdGlvbk1hcCA9IGZ1bmN0aW9uIChmYSwgZikgeyByZXR1cm4gcGlwZShmYSwgcGFydGl0aW9uTWFwKGYpKTsgfTtcbnZhciBfcGFydGl0aW9uV2l0aEluZGV4ID0gZnVuY3Rpb24gKGZhLCBwcmVkaWNhdGVXaXRoSW5kZXgpIHsgcmV0dXJuIHBpcGUoZmEsIHBhcnRpdGlvbldpdGhJbmRleChwcmVkaWNhdGVXaXRoSW5kZXgpKTsgfTtcbnZhciBfcGFydGl0aW9uTWFwV2l0aEluZGV4ID0gZnVuY3Rpb24gKGZhLCBmKSB7IHJldHVybiBwaXBlKGZhLCBwYXJ0aXRpb25NYXBXaXRoSW5kZXgoZikpOyB9O1xudmFyIF9hbHQgPSBmdW5jdGlvbiAoZmEsIHRoYXQpIHsgcmV0dXJuIHBpcGUoZmEsIGFsdCh0aGF0KSk7IH07XG52YXIgX3JlZHVjZSA9IGZ1bmN0aW9uIChmYSwgYiwgZikgeyByZXR1cm4gcGlwZShmYSwgcmVkdWNlKGIsIGYpKTsgfTtcbnZhciBfZm9sZE1hcCA9IGZ1bmN0aW9uIChNKSB7XG4gICAgdmFyIGZvbGRNYXBNID0gZm9sZE1hcChNKTtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGZhLCBmKSB7IHJldHVybiBwaXBlKGZhLCBmb2xkTWFwTShmKSk7IH07XG59O1xudmFyIF9yZWR1Y2VSaWdodCA9IGZ1bmN0aW9uIChmYSwgYiwgZikgeyByZXR1cm4gcGlwZShmYSwgcmVkdWNlUmlnaHQoYiwgZikpOyB9O1xudmFyIF9yZWR1Y2VXaXRoSW5kZXggPSBmdW5jdGlvbiAoZmEsIGIsIGYpIHtcbiAgICByZXR1cm4gcGlwZShmYSwgcmVkdWNlV2l0aEluZGV4KGIsIGYpKTtcbn07XG52YXIgX2ZvbGRNYXBXaXRoSW5kZXggPSBmdW5jdGlvbiAoTSkge1xuICAgIHZhciBmb2xkTWFwV2l0aEluZGV4TSA9IGZvbGRNYXBXaXRoSW5kZXgoTSk7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChmYSwgZikgeyByZXR1cm4gcGlwZShmYSwgZm9sZE1hcFdpdGhJbmRleE0oZikpOyB9O1xufTtcbnZhciBfcmVkdWNlUmlnaHRXaXRoSW5kZXggPSBmdW5jdGlvbiAoZmEsIGIsIGYpIHtcbiAgICByZXR1cm4gcGlwZShmYSwgcmVkdWNlUmlnaHRXaXRoSW5kZXgoYiwgZikpO1xufTtcbnZhciBfZmlsdGVyTWFwV2l0aEluZGV4ID0gZnVuY3Rpb24gKGZhLCBmKSB7IHJldHVybiBwaXBlKGZhLCBmaWx0ZXJNYXBXaXRoSW5kZXgoZikpOyB9O1xudmFyIF9maWx0ZXJXaXRoSW5kZXggPSBmdW5jdGlvbiAoZmEsIHByZWRpY2F0ZVdpdGhJbmRleCkgeyByZXR1cm4gcGlwZShmYSwgZmlsdGVyV2l0aEluZGV4KHByZWRpY2F0ZVdpdGhJbmRleCkpOyB9O1xudmFyIF9leHRlbmQgPSBmdW5jdGlvbiAoZmEsIGYpIHsgcmV0dXJuIHBpcGUoZmEsIGV4dGVuZChmKSk7IH07XG52YXIgX3RyYXZlcnNlID0gZnVuY3Rpb24gKEYpIHtcbiAgICB2YXIgdHJhdmVyc2VGID0gdHJhdmVyc2UoRik7XG4gICAgcmV0dXJuIGZ1bmN0aW9uICh0YSwgZikgeyByZXR1cm4gcGlwZSh0YSwgdHJhdmVyc2VGKGYpKTsgfTtcbn07XG4vKiBpc3RhbmJ1bCBpZ25vcmUgbmV4dCAqL1xudmFyIF90cmF2ZXJzZVdpdGhJbmRleCA9IGZ1bmN0aW9uIChGKSB7XG4gICAgdmFyIHRyYXZlcnNlV2l0aEluZGV4RiA9IHRyYXZlcnNlV2l0aEluZGV4KEYpO1xuICAgIHJldHVybiBmdW5jdGlvbiAodGEsIGYpIHsgcmV0dXJuIHBpcGUodGEsIHRyYXZlcnNlV2l0aEluZGV4RihmKSk7IH07XG59O1xuLyoqIEBpbnRlcm5hbCAqL1xuZXhwb3J0IHZhciBfY2hhaW5SZWNEZXB0aEZpcnN0ID0gZnVuY3Rpb24gKGEsIGYpIHsgcmV0dXJuIHBpcGUoYSwgY2hhaW5SZWNEZXB0aEZpcnN0KGYpKTsgfTtcbi8qKiBAaW50ZXJuYWwgKi9cbmV4cG9ydCB2YXIgX2NoYWluUmVjQnJlYWR0aEZpcnN0ID0gZnVuY3Rpb24gKGEsIGYpIHsgcmV0dXJuIHBpcGUoYSwgY2hhaW5SZWNCcmVhZHRoRmlyc3QoZikpOyB9O1xuLyoqXG4gKiBAY2F0ZWdvcnkgY29uc3RydWN0b3JzXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBvZiA9IFJORUEub2Y7XG4vKipcbiAqIEBzaW5jZSAyLjcuMFxuICovXG5leHBvcnQgdmFyIHplcm8gPSBmdW5jdGlvbiAoKSB7IHJldHVybiBlbXB0eTsgfTtcbi8qKlxuICogTGVzcyBzdHJpY3QgdmVyc2lvbiBvZiBbYGFsdGBdKCNhbHQpLlxuICpcbiAqIFRoZSBgV2Agc3VmZml4IChzaG9ydCBmb3IgKipXKippZGVuaW5nKSBtZWFucyB0aGF0IHRoZSByZXR1cm4gdHlwZXMgd2lsbCBiZSBtZXJnZWQuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCAqIGFzIFJBIGZyb20gJ2ZwLXRzL1JlYWRvbmx5QXJyYXknXG4gKiBpbXBvcnQgeyBwaXBlIH0gZnJvbSAnZnAtdHMvZnVuY3Rpb24nXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChcbiAqICAgcGlwZShcbiAqICAgICBbMSwgMiwgM10sXG4gKiAgICAgUkEuYWx0VygoKSA9PiBbJ2EnLCAnYiddKVxuICogICApLFxuICogICBbMSwgMiwgMywgJ2EnLCAnYiddXG4gKiApXG4gKlxuICogQGNhdGVnb3J5IGVycm9yIGhhbmRsaW5nXG4gKiBAc2luY2UgMi45LjBcbiAqL1xuZXhwb3J0IHZhciBhbHRXID0gZnVuY3Rpb24gKHRoYXQpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGZhKSB7XG4gICAgICAgIHJldHVybiBmYS5jb25jYXQodGhhdCgpKTtcbiAgICB9O1xufTtcbi8qKlxuICogSWRlbnRpZmllcyBhbiBhc3NvY2lhdGl2ZSBvcGVyYXRpb24gb24gYSB0eXBlIGNvbnN0cnVjdG9yLiBJdCBpcyBzaW1pbGFyIHRvIGBTZW1pZ3JvdXBgLCBleGNlcHQgdGhhdCBpdCBhcHBsaWVzIHRvXG4gKiB0eXBlcyBvZiBraW5kIGAqIC0+ICpgLlxuICpcbiAqIEluIGNhc2Ugb2YgYFJlYWRvbmx5QXJyYXlgIGNvbmNhdGVuYXRlcyB0aGUgaW5wdXRzIGludG8gYSBzaW5nbGUgYXJyYXkuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCAqIGFzIFJBIGZyb20gJ2ZwLXRzL1JlYWRvbmx5QXJyYXknXG4gKiBpbXBvcnQgeyBwaXBlIH0gZnJvbSAnZnAtdHMvZnVuY3Rpb24nXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChcbiAqICAgcGlwZShcbiAqICAgICBbMSwgMiwgM10sXG4gKiAgICAgUkEuYWx0KCgpID0+IFs0LCA1XSlcbiAqICAgKSxcbiAqICAgWzEsIDIsIDMsIDQsIDVdXG4gKiApXG4gKlxuICogQGNhdGVnb3J5IGVycm9yIGhhbmRsaW5nXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBhbHQgPSBhbHRXO1xuLyoqXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBhcCA9IGZ1bmN0aW9uIChmYSkge1xuICAgIHJldHVybiBmbGF0TWFwKGZ1bmN0aW9uIChmKSB7IHJldHVybiBwaXBlKGZhLCBtYXAoZikpOyB9KTtcbn07XG4vKipcbiAqIENvbXBvc2VzIGNvbXB1dGF0aW9ucyBpbiBzZXF1ZW5jZSwgdXNpbmcgdGhlIHJldHVybiB2YWx1ZSBvZiBvbmUgY29tcHV0YXRpb24gdG8gZGV0ZXJtaW5lIHRoZSBuZXh0IGNvbXB1dGF0aW9uLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgKiBhcyBSQSBmcm9tICdmcC10cy9SZWFkb25seUFycmF5J1xuICogaW1wb3J0IHsgcGlwZSB9IGZyb20gJ2ZwLXRzL2Z1bmN0aW9uJ1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoXG4gKiAgIHBpcGUoXG4gKiAgICAgWzEsIDIsIDNdLFxuICogICAgIFJBLmZsYXRNYXAoKG4pID0+IFtgYSR7bn1gLCBgYiR7bn1gXSlcbiAqICAgKSxcbiAqICAgWydhMScsICdiMScsICdhMicsICdiMicsICdhMycsICdiMyddXG4gKiApXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKFxuICogICBwaXBlKFxuICogICAgIFsxLCAyLCAzXSxcbiAqICAgICBSQS5mbGF0TWFwKCgpID0+IFtdKVxuICogICApLFxuICogICBbXVxuICogKVxuICpcbiAqIEBjYXRlZ29yeSBzZXF1ZW5jaW5nXG4gKiBAc2luY2UgMi4xNC4wXG4gKi9cbmV4cG9ydCB2YXIgZmxhdE1hcCA9IC8qI19fUFVSRV9fKi8gZHVhbCgyLCBmdW5jdGlvbiAobWEsIGYpIHtcbiAgICByZXR1cm4gcGlwZShtYSwgY2hhaW5XaXRoSW5kZXgoZnVuY3Rpb24gKGksIGEpIHsgcmV0dXJuIGYoYSwgaSk7IH0pKTtcbn0pO1xuLyoqXG4gKiBAY2F0ZWdvcnkgc2VxdWVuY2luZ1xuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgZmxhdHRlbiA9IC8qI19fUFVSRV9fKi8gZmxhdE1hcChpZGVudGl0eSk7XG4vKipcbiAqIGBtYXBgIGNhbiBiZSB1c2VkIHRvIHR1cm4gZnVuY3Rpb25zIGAoYTogQSkgPT4gQmAgaW50byBmdW5jdGlvbnMgYChmYTogRjxBPikgPT4gRjxCPmAgd2hvc2UgYXJndW1lbnQgYW5kIHJldHVybiB0eXBlc1xuICogdXNlIHRoZSB0eXBlIGNvbnN0cnVjdG9yIGBGYCB0byByZXByZXNlbnQgc29tZSBjb21wdXRhdGlvbmFsIGNvbnRleHQuXG4gKlxuICogQGNhdGVnb3J5IG1hcHBpbmdcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIG1hcCA9IGZ1bmN0aW9uIChmKSB7IHJldHVybiBmdW5jdGlvbiAoZmEpIHtcbiAgICByZXR1cm4gZmEubWFwKGZ1bmN0aW9uIChhKSB7IHJldHVybiBmKGEpOyB9KTtcbn07IH07XG4vKipcbiAqIEBjYXRlZ29yeSBtYXBwaW5nXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBtYXBXaXRoSW5kZXggPSBmdW5jdGlvbiAoZikgeyByZXR1cm4gZnVuY3Rpb24gKGZhKSB7XG4gICAgcmV0dXJuIGZhLm1hcChmdW5jdGlvbiAoYSwgaSkgeyByZXR1cm4gZihpLCBhKTsgfSk7XG59OyB9O1xuLyoqXG4gKiBAY2F0ZWdvcnkgZmlsdGVyaW5nXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBzZXBhcmF0ZSA9IGZ1bmN0aW9uIChmYSkge1xuICAgIHZhciBsZWZ0ID0gW107XG4gICAgdmFyIHJpZ2h0ID0gW107XG4gICAgZm9yICh2YXIgX2kgPSAwLCBmYV8xID0gZmE7IF9pIDwgZmFfMS5sZW5ndGg7IF9pKyspIHtcbiAgICAgICAgdmFyIGUgPSBmYV8xW19pXTtcbiAgICAgICAgaWYgKGUuX3RhZyA9PT0gJ0xlZnQnKSB7XG4gICAgICAgICAgICBsZWZ0LnB1c2goZS5sZWZ0KTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHJpZ2h0LnB1c2goZS5yaWdodCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHNlcGFyYXRlZChsZWZ0LCByaWdodCk7XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgZmlsdGVyaW5nXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBmaWx0ZXIgPSBmdW5jdGlvbiAocHJlZGljYXRlKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykge1xuICAgICAgICByZXR1cm4gYXMuZmlsdGVyKHByZWRpY2F0ZSk7XG4gICAgfTtcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBmaWx0ZXJpbmdcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIGZpbHRlck1hcFdpdGhJbmRleCA9IGZ1bmN0aW9uIChmKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChmYSkge1xuICAgICAgICB2YXIgb3V0ID0gW107XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgZmEubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIHZhciBvcHRpb25CID0gZihpLCBmYVtpXSk7XG4gICAgICAgICAgICBpZiAoXy5pc1NvbWUob3B0aW9uQikpIHtcbiAgICAgICAgICAgICAgICBvdXQucHVzaChvcHRpb25CLnZhbHVlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gb3V0O1xuICAgIH07XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgZmlsdGVyaW5nXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBmaWx0ZXJNYXAgPSBmdW5jdGlvbiAoZikge1xuICAgIHJldHVybiBmaWx0ZXJNYXBXaXRoSW5kZXgoZnVuY3Rpb24gKF8sIGEpIHsgcmV0dXJuIGYoYSk7IH0pO1xufTtcbi8qKlxuICogQGNhdGVnb3J5IGZpbHRlcmluZ1xuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgY29tcGFjdCA9IC8qI19fUFVSRV9fKi8gZmlsdGVyTWFwKGlkZW50aXR5KTtcbi8qKlxuICogQGNhdGVnb3J5IGZpbHRlcmluZ1xuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgcGFydGl0aW9uID0gZnVuY3Rpb24gKHByZWRpY2F0ZSkge1xuICAgIHJldHVybiBwYXJ0aXRpb25XaXRoSW5kZXgoZnVuY3Rpb24gKF8sIGEpIHsgcmV0dXJuIHByZWRpY2F0ZShhKTsgfSk7XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgZmlsdGVyaW5nXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBwYXJ0aXRpb25XaXRoSW5kZXggPSBmdW5jdGlvbiAocHJlZGljYXRlV2l0aEluZGV4KSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykge1xuICAgICAgICB2YXIgbGVmdCA9IFtdO1xuICAgICAgICB2YXIgcmlnaHQgPSBbXTtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBhcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgdmFyIGEgPSBhc1tpXTtcbiAgICAgICAgICAgIGlmIChwcmVkaWNhdGVXaXRoSW5kZXgoaSwgYSkpIHtcbiAgICAgICAgICAgICAgICByaWdodC5wdXNoKGEpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgbGVmdC5wdXNoKGEpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBzZXBhcmF0ZWQobGVmdCwgcmlnaHQpO1xuICAgIH07XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgZmlsdGVyaW5nXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBwYXJ0aXRpb25NYXAgPSBmdW5jdGlvbiAoZikge1xuICAgIHJldHVybiBwYXJ0aXRpb25NYXBXaXRoSW5kZXgoZnVuY3Rpb24gKF8sIGEpIHsgcmV0dXJuIGYoYSk7IH0pO1xufTtcbi8qKlxuICogQGNhdGVnb3J5IGZpbHRlcmluZ1xuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgcGFydGl0aW9uTWFwV2l0aEluZGV4ID0gZnVuY3Rpb24gKGYpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGZhKSB7XG4gICAgICAgIHZhciBsZWZ0ID0gW107XG4gICAgICAgIHZhciByaWdodCA9IFtdO1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGZhLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICB2YXIgZSA9IGYoaSwgZmFbaV0pO1xuICAgICAgICAgICAgaWYgKGUuX3RhZyA9PT0gJ0xlZnQnKSB7XG4gICAgICAgICAgICAgICAgbGVmdC5wdXNoKGUubGVmdCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICByaWdodC5wdXNoKGUucmlnaHQpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBzZXBhcmF0ZWQobGVmdCwgcmlnaHQpO1xuICAgIH07XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgZmlsdGVyaW5nXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBmaWx0ZXJXaXRoSW5kZXggPSBmdW5jdGlvbiAocHJlZGljYXRlV2l0aEluZGV4KSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykge1xuICAgICAgICByZXR1cm4gYXMuZmlsdGVyKGZ1bmN0aW9uIChhLCBpKSB7IHJldHVybiBwcmVkaWNhdGVXaXRoSW5kZXgoaSwgYSk7IH0pO1xuICAgIH07XG59O1xuLyoqXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBleHRlbmQgPSBmdW5jdGlvbiAoZikgeyByZXR1cm4gZnVuY3Rpb24gKHdhKSB7XG4gICAgcmV0dXJuIHdhLm1hcChmdW5jdGlvbiAoXywgaSkgeyByZXR1cm4gZih3YS5zbGljZShpKSk7IH0pO1xufTsgfTtcbi8qKlxuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgZHVwbGljYXRlID0gLyojX19QVVJFX18qLyBleHRlbmQoaWRlbnRpdHkpO1xuLyoqXG4gKiBAY2F0ZWdvcnkgZm9sZGluZ1xuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgZm9sZE1hcFdpdGhJbmRleCA9IGZ1bmN0aW9uIChNKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChmKSB7XG4gICAgICAgIHJldHVybiBmdW5jdGlvbiAoZmEpIHtcbiAgICAgICAgICAgIHJldHVybiBmYS5yZWR1Y2UoZnVuY3Rpb24gKGIsIGEsIGkpIHsgcmV0dXJuIE0uY29uY2F0KGIsIGYoaSwgYSkpOyB9LCBNLmVtcHR5KTtcbiAgICAgICAgfTtcbiAgICB9O1xufTtcbi8qKlxuICogQGNhdGVnb3J5IGZvbGRpbmdcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIHJlZHVjZSA9IGZ1bmN0aW9uIChiLCBmKSB7XG4gICAgcmV0dXJuIHJlZHVjZVdpdGhJbmRleChiLCBmdW5jdGlvbiAoXywgYiwgYSkgeyByZXR1cm4gZihiLCBhKTsgfSk7XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgZm9sZGluZ1xuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgZm9sZE1hcCA9IGZ1bmN0aW9uIChNKSB7XG4gICAgdmFyIGZvbGRNYXBXaXRoSW5kZXhNID0gZm9sZE1hcFdpdGhJbmRleChNKTtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGYpIHsgcmV0dXJuIGZvbGRNYXBXaXRoSW5kZXhNKGZ1bmN0aW9uIChfLCBhKSB7IHJldHVybiBmKGEpOyB9KTsgfTtcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBmb2xkaW5nXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciByZWR1Y2VXaXRoSW5kZXggPSBmdW5jdGlvbiAoYiwgZikgeyByZXR1cm4gZnVuY3Rpb24gKGZhKSB7XG4gICAgdmFyIGxlbiA9IGZhLmxlbmd0aDtcbiAgICB2YXIgb3V0ID0gYjtcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IGxlbjsgaSsrKSB7XG4gICAgICAgIG91dCA9IGYoaSwgb3V0LCBmYVtpXSk7XG4gICAgfVxuICAgIHJldHVybiBvdXQ7XG59OyB9O1xuLyoqXG4gKiBAY2F0ZWdvcnkgZm9sZGluZ1xuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgcmVkdWNlUmlnaHQgPSBmdW5jdGlvbiAoYiwgZikge1xuICAgIHJldHVybiByZWR1Y2VSaWdodFdpdGhJbmRleChiLCBmdW5jdGlvbiAoXywgYSwgYikgeyByZXR1cm4gZihhLCBiKTsgfSk7XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgZm9sZGluZ1xuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgcmVkdWNlUmlnaHRXaXRoSW5kZXggPSBmdW5jdGlvbiAoYiwgZikgeyByZXR1cm4gZnVuY3Rpb24gKGZhKSB7XG4gICAgcmV0dXJuIGZhLnJlZHVjZVJpZ2h0KGZ1bmN0aW9uIChiLCBhLCBpKSB7IHJldHVybiBmKGksIGEsIGIpOyB9LCBiKTtcbn07IH07XG4vKipcbiAqIEBjYXRlZ29yeSB0cmF2ZXJzaW5nXG4gKiBAc2luY2UgMi42LjNcbiAqL1xuZXhwb3J0IHZhciB0cmF2ZXJzZSA9IGZ1bmN0aW9uIChGKSB7XG4gICAgdmFyIHRyYXZlcnNlV2l0aEluZGV4RiA9IHRyYXZlcnNlV2l0aEluZGV4KEYpO1xuICAgIHJldHVybiBmdW5jdGlvbiAoZikgeyByZXR1cm4gdHJhdmVyc2VXaXRoSW5kZXhGKGZ1bmN0aW9uIChfLCBhKSB7IHJldHVybiBmKGEpOyB9KTsgfTtcbn07XG4vKipcbiAqIEBjYXRlZ29yeSB0cmF2ZXJzaW5nXG4gKiBAc2luY2UgMi42LjNcbiAqL1xuZXhwb3J0IHZhciBzZXF1ZW5jZSA9IGZ1bmN0aW9uIChGKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uICh0YSkge1xuICAgICAgICByZXR1cm4gX3JlZHVjZSh0YSwgRi5vZih6ZXJvKCkpLCBmdW5jdGlvbiAoZmFzLCBmYSkge1xuICAgICAgICAgICAgcmV0dXJuIEYuYXAoRi5tYXAoZmFzLCBmdW5jdGlvbiAoYXMpIHsgcmV0dXJuIGZ1bmN0aW9uIChhKSB7IHJldHVybiBwaXBlKGFzLCBhcHBlbmQoYSkpOyB9OyB9KSwgZmEpO1xuICAgICAgICB9KTtcbiAgICB9O1xufTtcbi8qKlxuICogQGNhdGVnb3J5IHNlcXVlbmNpbmdcbiAqIEBzaW5jZSAyLjYuM1xuICovXG5leHBvcnQgdmFyIHRyYXZlcnNlV2l0aEluZGV4ID0gZnVuY3Rpb24gKEYpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGYpIHtcbiAgICAgICAgcmV0dXJuIHJlZHVjZVdpdGhJbmRleChGLm9mKHplcm8oKSksIGZ1bmN0aW9uIChpLCBmYnMsIGEpIHtcbiAgICAgICAgICAgIHJldHVybiBGLmFwKEYubWFwKGZicywgZnVuY3Rpb24gKGJzKSB7IHJldHVybiBmdW5jdGlvbiAoYikgeyByZXR1cm4gcGlwZShicywgYXBwZW5kKGIpKTsgfTsgfSksIGYoaSwgYSkpO1xuICAgICAgICB9KTtcbiAgICB9O1xufTtcbi8qKlxuICogQGNhdGVnb3J5IGZpbHRlcmluZ1xuICogQHNpbmNlIDIuNi41XG4gKi9cbmV4cG9ydCB2YXIgd2l0aGVyID0gZnVuY3Rpb24gKEYpIHtcbiAgICB2YXIgX3dpdGhlckYgPSBfd2l0aGVyKEYpO1xuICAgIHJldHVybiBmdW5jdGlvbiAoZikgeyByZXR1cm4gZnVuY3Rpb24gKGZhKSB7IHJldHVybiBfd2l0aGVyRihmYSwgZik7IH07IH07XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgZmlsdGVyaW5nXG4gKiBAc2luY2UgMi42LjVcbiAqL1xuZXhwb3J0IHZhciB3aWx0ID0gZnVuY3Rpb24gKEYpIHtcbiAgICB2YXIgX3dpbHRGID0gX3dpbHQoRik7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChmKSB7IHJldHVybiBmdW5jdGlvbiAoZmEpIHsgcmV0dXJuIF93aWx0RihmYSwgZik7IH07IH07XG59O1xuLyoqXG4gKiBAc2luY2UgMi42LjZcbiAqL1xuZXhwb3J0IHZhciB1bmZvbGQgPSBmdW5jdGlvbiAoYiwgZikge1xuICAgIHZhciBvdXQgPSBbXTtcbiAgICB2YXIgYmIgPSBiO1xuICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBuby1jb25zdGFudC1jb25kaXRpb25cbiAgICB3aGlsZSAodHJ1ZSkge1xuICAgICAgICB2YXIgbXQgPSBmKGJiKTtcbiAgICAgICAgaWYgKF8uaXNTb21lKG10KSkge1xuICAgICAgICAgICAgdmFyIF9hID0gbXQudmFsdWUsIGEgPSBfYVswXSwgYl8xID0gX2FbMV07XG4gICAgICAgICAgICBvdXQucHVzaChhKTtcbiAgICAgICAgICAgIGJiID0gYl8xO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIG91dDtcbn07XG4vKipcbiAqIEBjYXRlZ29yeSB0eXBlIGxhbWJkYXNcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIFVSSSA9ICdSZWFkb25seUFycmF5Jztcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgZ2V0U2hvdyA9IGZ1bmN0aW9uIChTKSB7IHJldHVybiAoe1xuICAgIHNob3c6IGZ1bmN0aW9uIChhcykgeyByZXR1cm4gXCJbXCIuY29uY2F0KGFzLm1hcChTLnNob3cpLmpvaW4oJywgJyksIFwiXVwiKTsgfVxufSk7IH07XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIGdldFNlbWlncm91cCA9IGZ1bmN0aW9uICgpIHsgcmV0dXJuICh7XG4gICAgY29uY2F0OiBmdW5jdGlvbiAoZmlyc3QsIHNlY29uZCkgeyByZXR1cm4gKGlzRW1wdHkoZmlyc3QpID8gc2Vjb25kIDogaXNFbXB0eShzZWNvbmQpID8gZmlyc3QgOiBmaXJzdC5jb25jYXQoc2Vjb25kKSk7IH1cbn0pOyB9O1xuLyoqXG4gKiBSZXR1cm5zIGEgYE1vbm9pZGAgZm9yIGBSZWFkb25seUFycmF5PEE+YC5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgZ2V0TW9ub2lkIH0gZnJvbSAnZnAtdHMvUmVhZG9ubHlBcnJheSdcbiAqXG4gKiBjb25zdCBNID0gZ2V0TW9ub2lkPG51bWJlcj4oKVxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChNLmNvbmNhdChbMSwgMl0sIFszLCA0XSksIFsxLCAyLCAzLCA0XSlcbiAqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBnZXRNb25vaWQgPSBmdW5jdGlvbiAoKSB7IHJldHVybiAoe1xuICAgIGNvbmNhdDogZ2V0U2VtaWdyb3VwKCkuY29uY2F0LFxuICAgIGVtcHR5OiBlbXB0eVxufSk7IH07XG4vKipcbiAqIERlcml2ZXMgYW4gYEVxYCBvdmVyIHRoZSBgUmVhZG9ubHlBcnJheWAgb2YgYSBnaXZlbiBlbGVtZW50IHR5cGUgZnJvbSB0aGUgYEVxYCBvZiB0aGF0IHR5cGUuIFRoZSBkZXJpdmVkIGBFcWAgZGVmaW5lcyB0d29cbiAqIGFycmF5cyBhcyBlcXVhbCBpZiBhbGwgZWxlbWVudHMgb2YgYm90aCBhcnJheXMgYXJlIGNvbXBhcmVkIGVxdWFsIHBhaXJ3aXNlIHdpdGggdGhlIGdpdmVuIGBFYC4gSW4gY2FzZSBvZiBhcnJheXMgb2ZcbiAqIGRpZmZlcmVudCBsZW5ndGhzLCB0aGUgcmVzdWx0IGlzIG5vbiBlcXVhbGl0eS5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0ICogYXMgUyBmcm9tICdmcC10cy9zdHJpbmcnXG4gKiBpbXBvcnQgeyBnZXRFcSB9IGZyb20gJ2ZwLXRzL1JlYWRvbmx5QXJyYXknXG4gKlxuICogY29uc3QgRSA9IGdldEVxKFMuRXEpXG4gKiBhc3NlcnQuc3RyaWN0RXF1YWwoRS5lcXVhbHMoWydhJywgJ2InXSwgWydhJywgJ2InXSksIHRydWUpXG4gKiBhc3NlcnQuc3RyaWN0RXF1YWwoRS5lcXVhbHMoWydhJ10sIFtdKSwgZmFsc2UpXG4gKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgZ2V0RXEgPSBmdW5jdGlvbiAoRSkge1xuICAgIHJldHVybiBmcm9tRXF1YWxzKGZ1bmN0aW9uICh4cywgeXMpIHsgcmV0dXJuIHhzLmxlbmd0aCA9PT0geXMubGVuZ3RoICYmIHhzLmV2ZXJ5KGZ1bmN0aW9uICh4LCBpKSB7IHJldHVybiBFLmVxdWFscyh4LCB5c1tpXSk7IH0pOyB9KTtcbn07XG4vKipcbiAqIERlcml2ZXMgYW4gYE9yZGAgb3ZlciB0aGUgYFJlYWRvbmx5QXJyYXlgIG9mIGEgZ2l2ZW4gZWxlbWVudCB0eXBlIGZyb20gdGhlIGBPcmRgIG9mIHRoYXQgdHlwZS4gVGhlIG9yZGVyaW5nIGJldHdlZW4gdHdvIHN1Y2hcbiAqIGFycmF5cyBpcyBlcXVhbCB0bzogdGhlIGZpcnN0IG5vbiBlcXVhbCBjb21wYXJpc29uIG9mIGVhY2ggYXJyYXlzIGVsZW1lbnRzIHRha2VuIHBhaXJ3aXNlIGluIGluY3JlYXNpbmcgb3JkZXIsIGluXG4gKiBjYXNlIG9mIGVxdWFsaXR5IG92ZXIgYWxsIHRoZSBwYWlyd2lzZSBlbGVtZW50czsgdGhlIGxvbmdlc3QgYXJyYXkgaXMgY29uc2lkZXJlZCB0aGUgZ3JlYXRlc3QsIGlmIGJvdGggYXJyYXlzIGhhdmVcbiAqIHRoZSBzYW1lIGxlbmd0aCwgdGhlIHJlc3VsdCBpcyBlcXVhbGl0eS5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgZ2V0T3JkIH0gZnJvbSAnZnAtdHMvUmVhZG9ubHlBcnJheSdcbiAqIGltcG9ydCAqIGFzIFMgZnJvbSAnZnAtdHMvc3RyaW5nJ1xuICpcbiAqIGNvbnN0IE8gPSBnZXRPcmQoUy5PcmQpXG4gKiBhc3NlcnQuc3RyaWN0RXF1YWwoTy5jb21wYXJlKFsnYiddLCBbJ2EnXSksIDEpXG4gKiBhc3NlcnQuc3RyaWN0RXF1YWwoTy5jb21wYXJlKFsnYSddLCBbJ2EnXSksIDApXG4gKiBhc3NlcnQuc3RyaWN0RXF1YWwoTy5jb21wYXJlKFsnYSddLCBbJ2InXSksIC0xKVxuICpcbiAqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBnZXRPcmQgPSBmdW5jdGlvbiAoTykge1xuICAgIHJldHVybiBmcm9tQ29tcGFyZShmdW5jdGlvbiAoYSwgYikge1xuICAgICAgICB2YXIgYUxlbiA9IGEubGVuZ3RoO1xuICAgICAgICB2YXIgYkxlbiA9IGIubGVuZ3RoO1xuICAgICAgICB2YXIgbGVuID0gTWF0aC5taW4oYUxlbiwgYkxlbik7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbGVuOyBpKyspIHtcbiAgICAgICAgICAgIHZhciBvcmRlcmluZyA9IE8uY29tcGFyZShhW2ldLCBiW2ldKTtcbiAgICAgICAgICAgIGlmIChvcmRlcmluZyAhPT0gMCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBvcmRlcmluZztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gTi5PcmQuY29tcGFyZShhTGVuLCBiTGVuKTtcbiAgICB9KTtcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjExLjBcbiAqL1xuZXhwb3J0IHZhciBnZXRVbmlvblNlbWlncm91cCA9IGZ1bmN0aW9uIChFKSB7XG4gICAgdmFyIHVuaW9uRSA9IHVuaW9uKEUpO1xuICAgIHJldHVybiB7XG4gICAgICAgIGNvbmNhdDogZnVuY3Rpb24gKGZpcnN0LCBzZWNvbmQpIHsgcmV0dXJuIHVuaW9uRShzZWNvbmQpKGZpcnN0KTsgfVxuICAgIH07XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi4xMS4wXG4gKi9cbmV4cG9ydCB2YXIgZ2V0VW5pb25Nb25vaWQgPSBmdW5jdGlvbiAoRSkgeyByZXR1cm4gKHtcbiAgICBjb25jYXQ6IGdldFVuaW9uU2VtaWdyb3VwKEUpLmNvbmNhdCxcbiAgICBlbXB0eTogZW1wdHlcbn0pOyB9O1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi4xMS4wXG4gKi9cbmV4cG9ydCB2YXIgZ2V0SW50ZXJzZWN0aW9uU2VtaWdyb3VwID0gZnVuY3Rpb24gKEUpIHtcbiAgICB2YXIgaW50ZXJzZWN0aW9uRSA9IGludGVyc2VjdGlvbihFKTtcbiAgICByZXR1cm4ge1xuICAgICAgICBjb25jYXQ6IGZ1bmN0aW9uIChmaXJzdCwgc2Vjb25kKSB7IHJldHVybiBpbnRlcnNlY3Rpb25FKHNlY29uZCkoZmlyc3QpOyB9XG4gICAgfTtcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjExLjBcbiAqL1xuZXhwb3J0IHZhciBnZXREaWZmZXJlbmNlTWFnbWEgPSBmdW5jdGlvbiAoRSkge1xuICAgIHZhciBkaWZmZXJlbmNlRSA9IGRpZmZlcmVuY2UoRSk7XG4gICAgcmV0dXJuIHtcbiAgICAgICAgY29uY2F0OiBmdW5jdGlvbiAoZmlyc3QsIHNlY29uZCkgeyByZXR1cm4gZGlmZmVyZW5jZUUoc2Vjb25kKShmaXJzdCk7IH1cbiAgICB9O1xufTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuNy4wXG4gKi9cbmV4cG9ydCB2YXIgRnVuY3RvciA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICBtYXA6IF9tYXBcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBtYXBwaW5nXG4gKiBAc2luY2UgMi4xMC4wXG4gKi9cbmV4cG9ydCB2YXIgZmxhcCA9IC8qI19fUFVSRV9fKi8gZmxhcF8oRnVuY3Rvcik7XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjEwLjBcbiAqL1xuZXhwb3J0IHZhciBQb2ludGVkID0ge1xuICAgIFVSSTogVVJJLFxuICAgIG9mOiBvZlxufTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuNy4wXG4gKi9cbmV4cG9ydCB2YXIgRnVuY3RvcldpdGhJbmRleCA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICBtYXA6IF9tYXAsXG4gICAgbWFwV2l0aEluZGV4OiBfbWFwV2l0aEluZGV4XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi4xMC4wXG4gKi9cbmV4cG9ydCB2YXIgQXBwbHkgPSB7XG4gICAgVVJJOiBVUkksXG4gICAgbWFwOiBfbWFwLFxuICAgIGFwOiBfYXBcbn07XG4vKipcbiAqIENvbWJpbmUgdHdvIGVmZmVjdGZ1bCBhY3Rpb25zLCBrZWVwaW5nIG9ubHkgdGhlIHJlc3VsdCBvZiB0aGUgZmlyc3QuXG4gKlxuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgYXBGaXJzdCA9IC8qI19fUFVSRV9fKi8gYXBGaXJzdF8oQXBwbHkpO1xuLyoqXG4gKiBDb21iaW5lIHR3byBlZmZlY3RmdWwgYWN0aW9ucywga2VlcGluZyBvbmx5IHRoZSByZXN1bHQgb2YgdGhlIHNlY29uZC5cbiAqXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBhcFNlY29uZCA9IC8qI19fUFVSRV9fKi8gYXBTZWNvbmRfKEFwcGx5KTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuNy4wXG4gKi9cbmV4cG9ydCB2YXIgQXBwbGljYXRpdmUgPSB7XG4gICAgVVJJOiBVUkksXG4gICAgbWFwOiBfbWFwLFxuICAgIGFwOiBfYXAsXG4gICAgb2Y6IG9mXG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi4xMC4wXG4gKi9cbmV4cG9ydCB2YXIgQ2hhaW4gPSB7XG4gICAgVVJJOiBVUkksXG4gICAgbWFwOiBfbWFwLFxuICAgIGFwOiBfYXAsXG4gICAgY2hhaW46IGZsYXRNYXBcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjcuMFxuICovXG5leHBvcnQgdmFyIE1vbmFkID0ge1xuICAgIFVSSTogVVJJLFxuICAgIG1hcDogX21hcCxcbiAgICBhcDogX2FwLFxuICAgIG9mOiBvZixcbiAgICBjaGFpbjogZmxhdE1hcFxufTtcbi8qKlxuICogQ29tcG9zZXMgY29tcHV0YXRpb25zIGluIHNlcXVlbmNlLCB1c2luZyB0aGUgcmV0dXJuIHZhbHVlIG9mIG9uZSBjb21wdXRhdGlvbiB0byBkZXRlcm1pbmUgdGhlIG5leHQgY29tcHV0YXRpb24gYW5kXG4gKiBrZWVwaW5nIG9ubHkgdGhlIHJlc3VsdCBvZiB0aGUgZmlyc3QuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCAqIGFzIFJBIGZyb20gJ2ZwLXRzL1JlYWRvbmx5QXJyYXknXG4gKiBpbXBvcnQgeyBwaXBlIH0gZnJvbSAnZnAtdHMvZnVuY3Rpb24nXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChcbiAqICAgcGlwZShcbiAqICAgICBbMSwgMiwgM10sXG4gKiAgICAgUkEuY2hhaW5GaXJzdCgoKSA9PiBbJ2EnLCAnYiddKVxuICogICApLFxuICogICBbMSwgMSwgMiwgMiwgMywgM11cbiAqIClcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoXG4gKiAgIHBpcGUoXG4gKiAgICAgWzEsIDIsIDNdLFxuICogICAgIFJBLmNoYWluRmlyc3QoKCkgPT4gW10pXG4gKiAgICksXG4gKiAgIFtdXG4gKiApXG4gKlxuICogQGNhdGVnb3J5IHNlcXVlbmNpbmdcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIGNoYWluRmlyc3QgPSBcbi8qI19fUFVSRV9fKi8gY2hhaW5GaXJzdF8oQ2hhaW4pO1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi43LjBcbiAqL1xuZXhwb3J0IHZhciBVbmZvbGRhYmxlID0ge1xuICAgIFVSSTogVVJJLFxuICAgIHVuZm9sZDogdW5mb2xkXG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi43LjBcbiAqL1xuZXhwb3J0IHZhciBBbHQgPSB7XG4gICAgVVJJOiBVUkksXG4gICAgbWFwOiBfbWFwLFxuICAgIGFsdDogX2FsdFxufTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIFplcm8gPSB7XG4gICAgVVJJOiBVUkksXG4gICAgemVybzogemVyb1xufTtcbi8qKlxuICogQGNhdGVnb3J5IGRvIG5vdGF0aW9uXG4gKiBAc2luY2UgMi4xMS4wXG4gKi9cbmV4cG9ydCB2YXIgZ3VhcmQgPSAvKiNfX1BVUkVfXyovIGd1YXJkXyhaZXJvLCBQb2ludGVkKTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuNy4wXG4gKi9cbmV4cG9ydCB2YXIgQWx0ZXJuYXRpdmUgPSB7XG4gICAgVVJJOiBVUkksXG4gICAgbWFwOiBfbWFwLFxuICAgIGFwOiBfYXAsXG4gICAgb2Y6IG9mLFxuICAgIGFsdDogX2FsdCxcbiAgICB6ZXJvOiB6ZXJvXG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi43LjBcbiAqL1xuZXhwb3J0IHZhciBFeHRlbmQgPSB7XG4gICAgVVJJOiBVUkksXG4gICAgbWFwOiBfbWFwLFxuICAgIGV4dGVuZDogX2V4dGVuZFxufTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuNy4wXG4gKi9cbmV4cG9ydCB2YXIgQ29tcGFjdGFibGUgPSB7XG4gICAgVVJJOiBVUkksXG4gICAgY29tcGFjdDogY29tcGFjdCxcbiAgICBzZXBhcmF0ZTogc2VwYXJhdGVcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjcuMFxuICovXG5leHBvcnQgdmFyIEZpbHRlcmFibGUgPSB7XG4gICAgVVJJOiBVUkksXG4gICAgbWFwOiBfbWFwLFxuICAgIGNvbXBhY3Q6IGNvbXBhY3QsXG4gICAgc2VwYXJhdGU6IHNlcGFyYXRlLFxuICAgIGZpbHRlcjogX2ZpbHRlcixcbiAgICBmaWx0ZXJNYXA6IF9maWx0ZXJNYXAsXG4gICAgcGFydGl0aW9uOiBfcGFydGl0aW9uLFxuICAgIHBhcnRpdGlvbk1hcDogX3BhcnRpdGlvbk1hcFxufTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuNy4wXG4gKi9cbmV4cG9ydCB2YXIgRmlsdGVyYWJsZVdpdGhJbmRleCA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICBtYXA6IF9tYXAsXG4gICAgbWFwV2l0aEluZGV4OiBfbWFwV2l0aEluZGV4LFxuICAgIGNvbXBhY3Q6IGNvbXBhY3QsXG4gICAgc2VwYXJhdGU6IHNlcGFyYXRlLFxuICAgIGZpbHRlcjogX2ZpbHRlcixcbiAgICBmaWx0ZXJNYXA6IF9maWx0ZXJNYXAsXG4gICAgcGFydGl0aW9uOiBfcGFydGl0aW9uLFxuICAgIHBhcnRpdGlvbk1hcDogX3BhcnRpdGlvbk1hcCxcbiAgICBwYXJ0aXRpb25NYXBXaXRoSW5kZXg6IF9wYXJ0aXRpb25NYXBXaXRoSW5kZXgsXG4gICAgcGFydGl0aW9uV2l0aEluZGV4OiBfcGFydGl0aW9uV2l0aEluZGV4LFxuICAgIGZpbHRlck1hcFdpdGhJbmRleDogX2ZpbHRlck1hcFdpdGhJbmRleCxcbiAgICBmaWx0ZXJXaXRoSW5kZXg6IF9maWx0ZXJXaXRoSW5kZXhcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjcuMFxuICovXG5leHBvcnQgdmFyIEZvbGRhYmxlID0ge1xuICAgIFVSSTogVVJJLFxuICAgIHJlZHVjZTogX3JlZHVjZSxcbiAgICBmb2xkTWFwOiBfZm9sZE1hcCxcbiAgICByZWR1Y2VSaWdodDogX3JlZHVjZVJpZ2h0XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi43LjBcbiAqL1xuZXhwb3J0IHZhciBGb2xkYWJsZVdpdGhJbmRleCA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICByZWR1Y2U6IF9yZWR1Y2UsXG4gICAgZm9sZE1hcDogX2ZvbGRNYXAsXG4gICAgcmVkdWNlUmlnaHQ6IF9yZWR1Y2VSaWdodCxcbiAgICByZWR1Y2VXaXRoSW5kZXg6IF9yZWR1Y2VXaXRoSW5kZXgsXG4gICAgZm9sZE1hcFdpdGhJbmRleDogX2ZvbGRNYXBXaXRoSW5kZXgsXG4gICAgcmVkdWNlUmlnaHRXaXRoSW5kZXg6IF9yZWR1Y2VSaWdodFdpdGhJbmRleFxufTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuNy4wXG4gKi9cbmV4cG9ydCB2YXIgVHJhdmVyc2FibGUgPSB7XG4gICAgVVJJOiBVUkksXG4gICAgbWFwOiBfbWFwLFxuICAgIHJlZHVjZTogX3JlZHVjZSxcbiAgICBmb2xkTWFwOiBfZm9sZE1hcCxcbiAgICByZWR1Y2VSaWdodDogX3JlZHVjZVJpZ2h0LFxuICAgIHRyYXZlcnNlOiBfdHJhdmVyc2UsXG4gICAgc2VxdWVuY2U6IHNlcXVlbmNlXG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi43LjBcbiAqL1xuZXhwb3J0IHZhciBUcmF2ZXJzYWJsZVdpdGhJbmRleCA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICBtYXA6IF9tYXAsXG4gICAgbWFwV2l0aEluZGV4OiBfbWFwV2l0aEluZGV4LFxuICAgIHJlZHVjZTogX3JlZHVjZSxcbiAgICBmb2xkTWFwOiBfZm9sZE1hcCxcbiAgICByZWR1Y2VSaWdodDogX3JlZHVjZVJpZ2h0LFxuICAgIHJlZHVjZVdpdGhJbmRleDogX3JlZHVjZVdpdGhJbmRleCxcbiAgICBmb2xkTWFwV2l0aEluZGV4OiBfZm9sZE1hcFdpdGhJbmRleCxcbiAgICByZWR1Y2VSaWdodFdpdGhJbmRleDogX3JlZHVjZVJpZ2h0V2l0aEluZGV4LFxuICAgIHRyYXZlcnNlOiBfdHJhdmVyc2UsXG4gICAgc2VxdWVuY2U6IHNlcXVlbmNlLFxuICAgIHRyYXZlcnNlV2l0aEluZGV4OiBfdHJhdmVyc2VXaXRoSW5kZXhcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBzZXF1ZW5jaW5nXG4gKiBAc2luY2UgMi4xMS4wXG4gKi9cbmV4cG9ydCB2YXIgY2hhaW5SZWNEZXB0aEZpcnN0ID0gZnVuY3Rpb24gKGYpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGEpIHtcbiAgICAgICAgdmFyIHRvZG8gPSBfX3NwcmVhZEFycmF5KFtdLCBmKGEpLCB0cnVlKTtcbiAgICAgICAgdmFyIG91dCA9IFtdO1xuICAgICAgICB3aGlsZSAodG9kby5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICB2YXIgZSA9IHRvZG8uc2hpZnQoKTtcbiAgICAgICAgICAgIGlmIChfLmlzTGVmdChlKSkge1xuICAgICAgICAgICAgICAgIHRvZG8udW5zaGlmdC5hcHBseSh0b2RvLCBmKGUubGVmdCkpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgb3V0LnB1c2goZS5yaWdodCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG91dDtcbiAgICB9O1xufTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIENoYWluUmVjRGVwdGhGaXJzdCA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICBtYXA6IF9tYXAsXG4gICAgYXA6IF9hcCxcbiAgICBjaGFpbjogZmxhdE1hcCxcbiAgICBjaGFpblJlYzogX2NoYWluUmVjRGVwdGhGaXJzdFxufTtcbi8qKlxuICogQGNhdGVnb3J5IHNlcXVlbmNpbmdcbiAqIEBzaW5jZSAyLjExLjBcbiAqL1xuZXhwb3J0IHZhciBjaGFpblJlY0JyZWFkdGhGaXJzdCA9IGZ1bmN0aW9uIChmKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhKSB7XG4gICAgICAgIHZhciBpbml0aWFsID0gZihhKTtcbiAgICAgICAgdmFyIHRvZG8gPSBbXTtcbiAgICAgICAgdmFyIG91dCA9IFtdO1xuICAgICAgICBmdW5jdGlvbiBnbyhlKSB7XG4gICAgICAgICAgICBpZiAoXy5pc0xlZnQoZSkpIHtcbiAgICAgICAgICAgICAgICBmKGUubGVmdCkuZm9yRWFjaChmdW5jdGlvbiAodikgeyByZXR1cm4gdG9kby5wdXNoKHYpOyB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIG91dC5wdXNoKGUucmlnaHQpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGZvciAodmFyIF9pID0gMCwgaW5pdGlhbF8xID0gaW5pdGlhbDsgX2kgPCBpbml0aWFsXzEubGVuZ3RoOyBfaSsrKSB7XG4gICAgICAgICAgICB2YXIgZSA9IGluaXRpYWxfMVtfaV07XG4gICAgICAgICAgICBnbyhlKTtcbiAgICAgICAgfVxuICAgICAgICB3aGlsZSAodG9kby5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICBnbyh0b2RvLnNoaWZ0KCkpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBvdXQ7XG4gICAgfTtcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjExLjBcbiAqL1xuZXhwb3J0IHZhciBDaGFpblJlY0JyZWFkdGhGaXJzdCA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICBtYXA6IF9tYXAsXG4gICAgYXA6IF9hcCxcbiAgICBjaGFpbjogZmxhdE1hcCxcbiAgICBjaGFpblJlYzogX2NoYWluUmVjQnJlYWR0aEZpcnN0XG59O1xudmFyIF93aXRoZXIgPSAvKiNfX1BVUkVfXyovIHdpdGhlckRlZmF1bHQoVHJhdmVyc2FibGUsIENvbXBhY3RhYmxlKTtcbnZhciBfd2lsdCA9IC8qI19fUFVSRV9fKi8gd2lsdERlZmF1bHQoVHJhdmVyc2FibGUsIENvbXBhY3RhYmxlKTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuNy4wXG4gKi9cbmV4cG9ydCB2YXIgV2l0aGVyYWJsZSA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICBtYXA6IF9tYXAsXG4gICAgY29tcGFjdDogY29tcGFjdCxcbiAgICBzZXBhcmF0ZTogc2VwYXJhdGUsXG4gICAgZmlsdGVyOiBfZmlsdGVyLFxuICAgIGZpbHRlck1hcDogX2ZpbHRlck1hcCxcbiAgICBwYXJ0aXRpb246IF9wYXJ0aXRpb24sXG4gICAgcGFydGl0aW9uTWFwOiBfcGFydGl0aW9uTWFwLFxuICAgIHJlZHVjZTogX3JlZHVjZSxcbiAgICBmb2xkTWFwOiBfZm9sZE1hcCxcbiAgICByZWR1Y2VSaWdodDogX3JlZHVjZVJpZ2h0LFxuICAgIHRyYXZlcnNlOiBfdHJhdmVyc2UsXG4gICAgc2VxdWVuY2U6IHNlcXVlbmNlLFxuICAgIHdpdGhlcjogX3dpdGhlcixcbiAgICB3aWx0OiBfd2lsdFxufTtcbi8qKlxuICogRmlsdGVyIHZhbHVlcyBpbnNpZGUgYSBjb250ZXh0LlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBwaXBlIH0gZnJvbSAnZnAtdHMvZnVuY3Rpb24nXG4gKiBpbXBvcnQgKiBhcyBSQSBmcm9tICdmcC10cy9SZWFkb25seUFycmF5J1xuICogaW1wb3J0ICogYXMgVCBmcm9tICdmcC10cy9UYXNrJ1xuICpcbiAqIGNvbnN0IGZpbHRlckUgPSBSQS5maWx0ZXJFKFQuQXBwbGljYXRpdmVQYXIpXG4gKiBhc3luYyBmdW5jdGlvbiB0ZXN0KCkge1xuICogICBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKFxuICogICAgIGF3YWl0IHBpcGUoXG4gKiAgICAgICBbLTEsIDIsIDNdLFxuICogICAgICAgZmlsdGVyRSgobikgPT4gVC5vZihuID4gMCkpXG4gKiAgICAgKSgpLFxuICogICAgIFsyLCAzXVxuICogICApXG4gKiB9XG4gKiB0ZXN0KClcbiAqXG4gKiBAc2luY2UgMi4xMS4wXG4gKi9cbmV4cG9ydCB2YXIgZmlsdGVyRSA9IC8qI19fUFVSRV9fKi8gZmlsdGVyRV8oV2l0aGVyYWJsZSk7XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjExLjBcbiAqL1xuZXhwb3J0IHZhciBGcm9tRWl0aGVyID0ge1xuICAgIFVSSTogVVJJLFxuICAgIGZyb21FaXRoZXI6IGZyb21FaXRoZXJcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBsaWZ0aW5nXG4gKiBAc2luY2UgMi4xMS4wXG4gKi9cbmV4cG9ydCB2YXIgZnJvbUVpdGhlcksgPSAvKiNfX1BVUkVfXyovIGZyb21FaXRoZXJLXyhGcm9tRWl0aGVyKTtcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8vIHVuc2FmZVxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLyoqXG4gKiBAY2F0ZWdvcnkgdW5zYWZlXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciB1bnNhZmVJbnNlcnRBdCA9IFJORUEudW5zYWZlSW5zZXJ0QXQ7XG4vKipcbiAqIEBjYXRlZ29yeSB1bnNhZmVcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIHVuc2FmZVVwZGF0ZUF0ID0gZnVuY3Rpb24gKGksIGEsIGFzKSB7XG4gICAgcmV0dXJuIGlzTm9uRW1wdHkoYXMpID8gUk5FQS51bnNhZmVVcGRhdGVBdChpLCBhLCBhcykgOiBhcztcbn07XG4vKipcbiAqIEBjYXRlZ29yeSB1bnNhZmVcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIHVuc2FmZURlbGV0ZUF0ID0gZnVuY3Rpb24gKGksIGFzKSB7XG4gICAgdmFyIHhzID0gYXMuc2xpY2UoKTtcbiAgICB4cy5zcGxpY2UoaSwgMSk7XG4gICAgcmV0dXJuIHhzO1xufTtcbi8qKlxuICogQGNhdGVnb3J5IGNvbnZlcnNpb25zXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciB0b0FycmF5ID0gZnVuY3Rpb24gKGFzKSB7IHJldHVybiBhcy5zbGljZSgpOyB9O1xuLyoqXG4gKiBAY2F0ZWdvcnkgY29udmVyc2lvbnNcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIGZyb21BcnJheSA9IGZ1bmN0aW9uIChhcykgeyByZXR1cm4gKGlzRW1wdHkoYXMpID8gZW1wdHkgOiBhcy5zbGljZSgpKTsgfTtcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8vIHV0aWxzXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vKipcbiAqIEFuIGVtcHR5IGFycmF5XG4gKlxuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgZW1wdHkgPSBSTkVBLmVtcHR5O1xuZXhwb3J0IGZ1bmN0aW9uIGV2ZXJ5KHByZWRpY2F0ZSkge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHsgcmV0dXJuIGFzLmV2ZXJ5KHByZWRpY2F0ZSk7IH07XG59XG4vKipcbiAqIENoZWNrIGlmIGEgcHJlZGljYXRlIGhvbGRzIHRydWUgZm9yIGFueSBhcnJheSBtZW1iZXIuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IHNvbWUgfSBmcm9tICdmcC10cy9SZWFkb25seUFycmF5J1xuICogaW1wb3J0IHsgcGlwZSB9IGZyb20gJ2ZwLXRzL2Z1bmN0aW9uJ1xuICpcbiAqIGNvbnN0IGlzUG9zaXRpdmUgPSAobjogbnVtYmVyKTogYm9vbGVhbiA9PiBuID4gMFxuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwocGlwZShbLTEsIC0yLCAzXSwgc29tZShpc1Bvc2l0aXZlKSksIHRydWUpXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKHBpcGUoWy0xLCAtMiwgLTNdLCBzb21lKGlzUG9zaXRpdmUpKSwgZmFsc2UpXG4gKlxuICogQHNpbmNlIDIuOS4wXG4gKi9cbmV4cG9ydCB2YXIgc29tZSA9IGZ1bmN0aW9uIChwcmVkaWNhdGUpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIHJldHVybiBhcy5zb21lKHByZWRpY2F0ZSk7XG4gICAgfTtcbn07XG4vKipcbiAqIEFsaWFzIG9mIFtgc29tZWBdKCNzb21lKVxuICpcbiAqIEBzaW5jZSAyLjExLjBcbiAqL1xuZXhwb3J0IHZhciBleGlzdHMgPSBzb21lO1xuLyoqXG4gKiBQbGFjZXMgYW4gZWxlbWVudCBpbiBiZXR3ZWVuIG1lbWJlcnMgb2YgYSBgUmVhZG9ubHlBcnJheWAsIHRoZW4gZm9sZHMgdGhlIHJlc3VsdHMgdXNpbmcgdGhlIHByb3ZpZGVkIGBNb25vaWRgLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgKiBhcyBTIGZyb20gJ2ZwLXRzL3N0cmluZydcbiAqIGltcG9ydCB7IGludGVyY2FsYXRlIH0gZnJvbSAnZnAtdHMvUmVhZG9ubHlBcnJheSdcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKGludGVyY2FsYXRlKFMuTW9ub2lkKSgnLScpKFsnYScsICdiJywgJ2MnXSksICdhLWItYycpXG4gKlxuICogQHNpbmNlIDIuMTIuMFxuICovXG5leHBvcnQgdmFyIGludGVyY2FsYXRlID0gZnVuY3Rpb24gKE0pIHtcbiAgICB2YXIgaW50ZXJjYWxhdGVNID0gUk5FQS5pbnRlcmNhbGF0ZShNKTtcbiAgICByZXR1cm4gZnVuY3Rpb24gKG1pZGRsZSkgeyByZXR1cm4gbWF0Y2goZnVuY3Rpb24gKCkgeyByZXR1cm4gTS5lbXB0eTsgfSwgaW50ZXJjYWxhdGVNKG1pZGRsZSkpOyB9O1xufTtcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8vIGRvIG5vdGF0aW9uXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vKipcbiAqIEBjYXRlZ29yeSBkbyBub3RhdGlvblxuICogQHNpbmNlIDIuOS4wXG4gKi9cbmV4cG9ydCB2YXIgRG8gPSAvKiNfX1BVUkVfXyovIG9mKF8uZW1wdHlSZWNvcmQpO1xuLyoqXG4gKiBAY2F0ZWdvcnkgZG8gbm90YXRpb25cbiAqIEBzaW5jZSAyLjguMFxuICovXG5leHBvcnQgdmFyIGJpbmRUbyA9IC8qI19fUFVSRV9fKi8gYmluZFRvXyhGdW5jdG9yKTtcbnZhciBsZXRfID0gLyojX19QVVJFX18qLyBsZXRfXyhGdW5jdG9yKTtcbmV4cG9ydCB7IFxuLyoqXG4gKiBAY2F0ZWdvcnkgZG8gbm90YXRpb25cbiAqIEBzaW5jZSAyLjEzLjBcbiAqL1xubGV0XyBhcyBsZXQgfTtcbi8qKlxuICogQGNhdGVnb3J5IGRvIG5vdGF0aW9uXG4gKiBAc2luY2UgMi44LjBcbiAqL1xuZXhwb3J0IHZhciBiaW5kID0gLyojX19QVVJFX18qLyBiaW5kXyhDaGFpbik7XG4vKipcbiAqIEBjYXRlZ29yeSBkbyBub3RhdGlvblxuICogQHNpbmNlIDIuOC4wXG4gKi9cbmV4cG9ydCB2YXIgYXBTID0gLyojX19QVVJFX18qLyBhcFNfKEFwcGx5KTtcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8vIGxlZ2FjeVxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLyoqXG4gKiBBbGlhcyBvZiBgZmxhdE1hcGAuXG4gKlxuICogQGNhdGVnb3J5IGxlZ2FjeVxuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgY2hhaW4gPSBmbGF0TWFwO1xuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLy8gZGVwcmVjYXRlZFxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLyoqXG4gKiBVc2UgYFJlYWRvbmx5Tm9uRW1wdHlBcnJheWAgbW9kdWxlIGluc3RlYWQuXG4gKlxuICogQGNhdGVnb3J5IHpvbmUgb2YgZGVhdGhcbiAqIEBzaW5jZSAyLjUuMFxuICogQGRlcHJlY2F0ZWRcbiAqL1xuZXhwb3J0IHZhciByYW5nZSA9IFJORUEucmFuZ2U7XG4vKipcbiAqIFVzZSBbYHByZXBlbmRgXSgjcHJlcGVuZCkgaW5zdGVhZC5cbiAqXG4gKiBAY2F0ZWdvcnkgem9uZSBvZiBkZWF0aFxuICogQHNpbmNlIDIuNS4wXG4gKiBAZGVwcmVjYXRlZFxuICovXG5leHBvcnQgdmFyIGNvbnMgPSBSTkVBLmNvbnM7XG4vKipcbiAqIFVzZSBbYGFwcGVuZGBdKCNhcHBlbmQpIGluc3RlYWQuXG4gKlxuICogQGNhdGVnb3J5IHpvbmUgb2YgZGVhdGhcbiAqIEBzaW5jZSAyLjUuMFxuICogQGRlcHJlY2F0ZWRcbiAqL1xuZXhwb3J0IHZhciBzbm9jID0gUk5FQS5zbm9jO1xuLyoqXG4gKiBVc2UgW2BwcmVwZW5kQWxsYF0oI3ByZXBlbmRhbGwpIGluc3RlYWQuXG4gKlxuICogQGNhdGVnb3J5IHpvbmUgb2YgZGVhdGhcbiAqIEBzaW5jZSAyLjkuMFxuICogQGRlcHJlY2F0ZWRcbiAqL1xuZXhwb3J0IHZhciBwcmVwZW5kVG9BbGwgPSBwcmVwZW5kQWxsO1xuLyoqXG4gKiBUaGlzIGluc3RhbmNlIGlzIGRlcHJlY2F0ZWQsIHVzZSBzbWFsbCwgc3BlY2lmaWMgaW5zdGFuY2VzIGluc3RlYWQuXG4gKiBGb3IgZXhhbXBsZSBpZiBhIGZ1bmN0aW9uIG5lZWRzIGEgYEZ1bmN0b3JgIGluc3RhbmNlLCBwYXNzIGBSQS5GdW5jdG9yYCBpbnN0ZWFkIG9mIGBSQS5yZWFkb25seUFycmF5YFxuICogKHdoZXJlIGBSQWAgaXMgZnJvbSBgaW1wb3J0IFJBIGZyb20gJ2ZwLXRzL1JlYWRvbmx5QXJyYXknYClcbiAqXG4gKiBAY2F0ZWdvcnkgem9uZSBvZiBkZWF0aFxuICogQHNpbmNlIDIuNS4wXG4gKiBAZGVwcmVjYXRlZFxuICovXG5leHBvcnQgdmFyIHJlYWRvbmx5QXJyYXkgPSB7XG4gICAgVVJJOiBVUkksXG4gICAgY29tcGFjdDogY29tcGFjdCxcbiAgICBzZXBhcmF0ZTogc2VwYXJhdGUsXG4gICAgbWFwOiBfbWFwLFxuICAgIGFwOiBfYXAsXG4gICAgb2Y6IG9mLFxuICAgIGNoYWluOiBmbGF0TWFwLFxuICAgIGZpbHRlcjogX2ZpbHRlcixcbiAgICBmaWx0ZXJNYXA6IF9maWx0ZXJNYXAsXG4gICAgcGFydGl0aW9uOiBfcGFydGl0aW9uLFxuICAgIHBhcnRpdGlvbk1hcDogX3BhcnRpdGlvbk1hcCxcbiAgICBtYXBXaXRoSW5kZXg6IF9tYXBXaXRoSW5kZXgsXG4gICAgcGFydGl0aW9uTWFwV2l0aEluZGV4OiBfcGFydGl0aW9uTWFwV2l0aEluZGV4LFxuICAgIHBhcnRpdGlvbldpdGhJbmRleDogX3BhcnRpdGlvbldpdGhJbmRleCxcbiAgICBmaWx0ZXJNYXBXaXRoSW5kZXg6IF9maWx0ZXJNYXBXaXRoSW5kZXgsXG4gICAgZmlsdGVyV2l0aEluZGV4OiBfZmlsdGVyV2l0aEluZGV4LFxuICAgIGFsdDogX2FsdCxcbiAgICB6ZXJvOiB6ZXJvLFxuICAgIHVuZm9sZDogdW5mb2xkLFxuICAgIHJlZHVjZTogX3JlZHVjZSxcbiAgICBmb2xkTWFwOiBfZm9sZE1hcCxcbiAgICByZWR1Y2VSaWdodDogX3JlZHVjZVJpZ2h0LFxuICAgIHRyYXZlcnNlOiBfdHJhdmVyc2UsXG4gICAgc2VxdWVuY2U6IHNlcXVlbmNlLFxuICAgIHJlZHVjZVdpdGhJbmRleDogX3JlZHVjZVdpdGhJbmRleCxcbiAgICBmb2xkTWFwV2l0aEluZGV4OiBfZm9sZE1hcFdpdGhJbmRleCxcbiAgICByZWR1Y2VSaWdodFdpdGhJbmRleDogX3JlZHVjZVJpZ2h0V2l0aEluZGV4LFxuICAgIHRyYXZlcnNlV2l0aEluZGV4OiBfdHJhdmVyc2VXaXRoSW5kZXgsXG4gICAgZXh0ZW5kOiBfZXh0ZW5kLFxuICAgIHdpdGhlcjogX3dpdGhlcixcbiAgICB3aWx0OiBfd2lsdFxufTtcbiIsCiAgInZhciBfX3NwcmVhZEFycmF5ID0gKHRoaXMgJiYgdGhpcy5fX3NwcmVhZEFycmF5KSB8fCBmdW5jdGlvbiAodG8sIGZyb20sIHBhY2spIHtcbiAgICBpZiAocGFjayB8fCBhcmd1bWVudHMubGVuZ3RoID09PSAyKSBmb3IgKHZhciBpID0gMCwgbCA9IGZyb20ubGVuZ3RoLCBhcjsgaSA8IGw7IGkrKykge1xuICAgICAgICBpZiAoYXIgfHwgIShpIGluIGZyb20pKSB7XG4gICAgICAgICAgICBpZiAoIWFyKSBhciA9IEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGZyb20sIDAsIGkpO1xuICAgICAgICAgICAgYXJbaV0gPSBmcm9tW2ldO1xuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiB0by5jb25jYXQoYXIgfHwgQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoZnJvbSkpO1xufTtcbmltcG9ydCB7IGFwRmlyc3QgYXMgYXBGaXJzdF8sIGFwUyBhcyBhcFNfLCBhcFNlY29uZCBhcyBhcFNlY29uZF8gfSBmcm9tICcuL0FwcGx5JztcbmltcG9ydCB7IGJpbmQgYXMgYmluZF8sIGNoYWluRmlyc3QgYXMgY2hhaW5GaXJzdF8gfSBmcm9tICcuL0NoYWluJztcbmltcG9ydCB7IGZyb21FcXVhbHMgfSBmcm9tICcuL0VxJztcbmltcG9ydCB7IGZyb21FaXRoZXJLIGFzIGZyb21FaXRoZXJLXyB9IGZyb20gJy4vRnJvbUVpdGhlcic7XG5pbXBvcnQgeyBkdWFsLCBpZGVudGl0eSwgcGlwZSB9IGZyb20gJy4vZnVuY3Rpb24nO1xuaW1wb3J0IHsgYmluZFRvIGFzIGJpbmRUb18sIGZsYXAgYXMgZmxhcF8sIGxldCBhcyBsZXRfXyB9IGZyb20gJy4vRnVuY3Rvcic7XG5pbXBvcnQgKiBhcyBfIGZyb20gJy4vaW50ZXJuYWwnO1xuaW1wb3J0ICogYXMgTiBmcm9tICcuL251bWJlcic7XG5pbXBvcnQgeyBmcm9tQ29tcGFyZSB9IGZyb20gJy4vT3JkJztcbmltcG9ydCAqIGFzIFJORUEgZnJvbSAnLi9SZWFkb25seU5vbkVtcHR5QXJyYXknO1xuaW1wb3J0IHsgc2VwYXJhdGVkIH0gZnJvbSAnLi9TZXBhcmF0ZWQnO1xuaW1wb3J0IHsgZmlsdGVyRSBhcyBmaWx0ZXJFXywgd2lsdERlZmF1bHQsIHdpdGhlckRlZmF1bHQgfSBmcm9tICcuL1dpdGhlcmFibGUnO1xuaW1wb3J0IHsgZ3VhcmQgYXMgZ3VhcmRfIH0gZnJvbSAnLi9aZXJvJztcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8vIHJlZmluZW1lbnRzXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vKipcbiAqIFRlc3Qgd2hldGhlciBhIGBSZWFkb25seUFycmF5YCBpcyBlbXB0eS5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgaXNFbXB0eSB9IGZyb20gJ2ZwLXRzL1JlYWRvbmx5QXJyYXknXG4gKlxuICogYXNzZXJ0LnN0cmljdEVxdWFsKGlzRW1wdHkoW10pLCB0cnVlKVxuICpcbiAqIEBjYXRlZ29yeSByZWZpbmVtZW50c1xuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgaXNFbXB0eSA9IGZ1bmN0aW9uIChhcykgeyByZXR1cm4gYXMubGVuZ3RoID09PSAwOyB9O1xuLyoqXG4gKiBUZXN0IHdoZXRoZXIgYSBgUmVhZG9ubHlBcnJheWAgaXMgbm9uIGVtcHR5LlxuICpcbiAqIEBjYXRlZ29yeSByZWZpbmVtZW50c1xuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgaXNOb25FbXB0eSA9IFJORUEuaXNOb25FbXB0eTtcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8vIGNvbnN0cnVjdG9yc1xuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLyoqXG4gKiBQcmVwZW5kIGFuIGVsZW1lbnQgdG8gdGhlIGZyb250IG9mIGEgYFJlYWRvbmx5QXJyYXlgLCBjcmVhdGluZyBhIG5ldyBgUmVhZG9ubHlOb25FbXB0eUFycmF5YC5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgcHJlcGVuZCB9IGZyb20gJ2ZwLXRzL1JlYWRvbmx5QXJyYXknXG4gKiBpbXBvcnQgeyBwaXBlIH0gZnJvbSAnZnAtdHMvZnVuY3Rpb24nXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChwaXBlKFsyLCAzLCA0XSwgcHJlcGVuZCgxKSksIFsxLCAyLCAzLCA0XSlcbiAqXG4gKiBAc2luY2UgMi4xMC4wXG4gKi9cbmV4cG9ydCB2YXIgcHJlcGVuZCA9IFJORUEucHJlcGVuZDtcbi8qKlxuICogTGVzcyBzdHJpY3QgdmVyc2lvbiBvZiBbYHByZXBlbmRgXSgjcHJlcGVuZCkuXG4gKlxuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIHByZXBlbmRXID0gUk5FQS5wcmVwZW5kVztcbi8qKlxuICogQXBwZW5kIGFuIGVsZW1lbnQgdG8gdGhlIGVuZCBvZiBhIGBSZWFkb25seUFycmF5YCwgY3JlYXRpbmcgYSBuZXcgYFJlYWRvbmx5Tm9uRW1wdHlBcnJheWAuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IGFwcGVuZCB9IGZyb20gJ2ZwLXRzL1JlYWRvbmx5QXJyYXknXG4gKiBpbXBvcnQgeyBwaXBlIH0gZnJvbSAnZnAtdHMvZnVuY3Rpb24nXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChwaXBlKFsxLCAyLCAzXSwgYXBwZW5kKDQpKSwgWzEsIDIsIDMsIDRdKVxuICpcbiAqIEBzaW5jZSAyLjEwLjBcbiAqL1xuZXhwb3J0IHZhciBhcHBlbmQgPSBSTkVBLmFwcGVuZDtcbi8qKlxuICogTGVzcyBzdHJpY3QgdmVyc2lvbiBvZiBbYGFwcGVuZGBdKCNhcHBlbmQpLlxuICpcbiAqIEBzaW5jZSAyLjExLjBcbiAqL1xuZXhwb3J0IHZhciBhcHBlbmRXID0gUk5FQS5hcHBlbmRXO1xuLyoqXG4gKiBSZXR1cm4gYSBgUmVhZG9ubHlBcnJheWAgb2YgbGVuZ3RoIGBuYCB3aXRoIGVsZW1lbnQgYGlgIGluaXRpYWxpemVkIHdpdGggYGYoaSlgLlxuICpcbiAqICoqTm90ZSoqLiBgbmAgaXMgbm9ybWFsaXplZCB0byBhIG5vbiBuZWdhdGl2ZSBpbnRlZ2VyLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBtYWtlQnkgfSBmcm9tICdmcC10cy9SZWFkb25seUFycmF5J1xuICpcbiAqIGNvbnN0IGRvdWJsZSA9IChuOiBudW1iZXIpOiBudW1iZXIgPT4gbiAqIDJcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwobWFrZUJ5KDUsIGRvdWJsZSksIFswLCAyLCA0LCA2LCA4XSlcbiAqXG4gKiBAY2F0ZWdvcnkgY29uc3RydWN0b3JzXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBtYWtlQnkgPSBmdW5jdGlvbiAobiwgZikgeyByZXR1cm4gKG4gPD0gMCA/IGVtcHR5IDogUk5FQS5tYWtlQnkoZikobikpOyB9O1xuLyoqXG4gKiBDcmVhdGUgYSBgUmVhZG9ubHlBcnJheWAgY29udGFpbmluZyBhIHZhbHVlIHJlcGVhdGVkIHRoZSBzcGVjaWZpZWQgbnVtYmVyIG9mIHRpbWVzLlxuICpcbiAqICoqTm90ZSoqLiBgbmAgaXMgbm9ybWFsaXplZCB0byBhIG5vbiBuZWdhdGl2ZSBpbnRlZ2VyLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyByZXBsaWNhdGUgfSBmcm9tICdmcC10cy9SZWFkb25seUFycmF5J1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwocmVwbGljYXRlKDMsICdhJyksIFsnYScsICdhJywgJ2EnXSlcbiAqXG4gKiBAY2F0ZWdvcnkgY29uc3RydWN0b3JzXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciByZXBsaWNhdGUgPSBmdW5jdGlvbiAobiwgYSkgeyByZXR1cm4gbWFrZUJ5KG4sIGZ1bmN0aW9uICgpIHsgcmV0dXJuIGE7IH0pOyB9O1xuZXhwb3J0IGZ1bmN0aW9uIGZyb21QcmVkaWNhdGUocHJlZGljYXRlKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhKSB7IHJldHVybiAocHJlZGljYXRlKGEpID8gW2FdIDogZW1wdHkpOyB9O1xufVxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLy8gY29udmVyc2lvbnNcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8qKlxuICogQGNhdGVnb3J5IGNvbnZlcnNpb25zXG4gKiBAc2luY2UgMi4xMS4wXG4gKi9cbmV4cG9ydCB2YXIgZnJvbU9wdGlvbiA9IGZ1bmN0aW9uIChtYSkgeyByZXR1cm4gKF8uaXNOb25lKG1hKSA/IGVtcHR5IDogW21hLnZhbHVlXSk7IH07XG4vKipcbiAqIFRyYW5zZm9ybXMgYW4gYEVpdGhlcmAgdG8gYSBgUmVhZG9ubHlBcnJheWAuXG4gKlxuICogQGNhdGVnb3J5IGNvbnZlcnNpb25zXG4gKiBAc2luY2UgMi4xMS4wXG4gKi9cbmV4cG9ydCB2YXIgZnJvbUVpdGhlciA9IGZ1bmN0aW9uIChlKSB7IHJldHVybiAoXy5pc0xlZnQoZSkgPyBlbXB0eSA6IFtlLnJpZ2h0XSk7IH07XG4vKipcbiAqIExlc3Mgc3RyaWN0IHZlcnNpb24gb2YgW2BtYXRjaGBdKCNtYXRjaCkuXG4gKlxuICogVGhlIGBXYCBzdWZmaXggKHNob3J0IGZvciAqKlcqKmlkZW5pbmcpIG1lYW5zIHRoYXQgdGhlIGhhbmRsZXIgcmV0dXJuIHR5cGVzIHdpbGwgYmUgbWVyZ2VkLlxuICpcbiAqIEBjYXRlZ29yeSBwYXR0ZXJuIG1hdGNoaW5nXG4gKiBAc2luY2UgMi4xMS4wXG4gKi9cbmV4cG9ydCB2YXIgbWF0Y2hXID0gZnVuY3Rpb24gKG9uRW1wdHksIG9uTm9uRW1wdHkpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIHJldHVybiBpc05vbkVtcHR5KGFzKSA/IG9uTm9uRW1wdHkoYXMpIDogb25FbXB0eSgpO1xuICAgIH07XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgcGF0dGVybiBtYXRjaGluZ1xuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIG1hdGNoID0gbWF0Y2hXO1xuLyoqXG4gKiBMZXNzIHN0cmljdCB2ZXJzaW9uIG9mIFtgbWF0Y2hMZWZ0YF0oI21hdGNobGVmdCkuXG4gKlxuICogQGNhdGVnb3J5IHBhdHRlcm4gbWF0Y2hpbmdcbiAqIEBzaW5jZSAyLjExLjBcbiAqL1xuZXhwb3J0IHZhciBtYXRjaExlZnRXID0gZnVuY3Rpb24gKG9uRW1wdHksIG9uTm9uRW1wdHkpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIHJldHVybiBpc05vbkVtcHR5KGFzKSA/IG9uTm9uRW1wdHkoUk5FQS5oZWFkKGFzKSwgUk5FQS50YWlsKGFzKSkgOiBvbkVtcHR5KCk7XG4gICAgfTtcbn07XG4vKipcbiAqIEJyZWFrIGEgYFJlYWRvbmx5QXJyYXlgIGludG8gaXRzIGZpcnN0IGVsZW1lbnQgYW5kIHJlbWFpbmluZyBlbGVtZW50cy5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgbWF0Y2hMZWZ0IH0gZnJvbSAnZnAtdHMvUmVhZG9ubHlBcnJheSdcbiAqXG4gKiBjb25zdCBsZW46IDxBPihhczogUmVhZG9ubHlBcnJheTxBPikgPT4gbnVtYmVyID0gbWF0Y2hMZWZ0KCgpID0+IDAsIChfLCB0YWlsKSA9PiAxICsgbGVuKHRhaWwpKVxuICogYXNzZXJ0LnN0cmljdEVxdWFsKGxlbihbMSwgMiwgM10pLCAzKVxuICpcbiAqIEBjYXRlZ29yeSBwYXR0ZXJuIG1hdGNoaW5nXG4gKiBAc2luY2UgMi4xMC4wXG4gKi9cbmV4cG9ydCB2YXIgbWF0Y2hMZWZ0ID0gbWF0Y2hMZWZ0Vztcbi8qKlxuICogQWxpYXMgb2YgW2BtYXRjaExlZnRgXSgjbWF0Y2hsZWZ0KS5cbiAqXG4gKiBAY2F0ZWdvcnkgcGF0dGVybiBtYXRjaGluZ1xuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgZm9sZExlZnQgPSBtYXRjaExlZnQ7XG4vKipcbiAqIExlc3Mgc3RyaWN0IHZlcnNpb24gb2YgW2BtYXRjaFJpZ2h0YF0oI21hdGNocmlnaHQpLlxuICpcbiAqIEBjYXRlZ29yeSBwYXR0ZXJuIG1hdGNoaW5nXG4gKiBAc2luY2UgMi4xMS4wXG4gKi9cbmV4cG9ydCB2YXIgbWF0Y2hSaWdodFcgPSBmdW5jdGlvbiAob25FbXB0eSwgb25Ob25FbXB0eSkge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgcmV0dXJuIGlzTm9uRW1wdHkoYXMpID8gb25Ob25FbXB0eShSTkVBLmluaXQoYXMpLCBSTkVBLmxhc3QoYXMpKSA6IG9uRW1wdHkoKTtcbiAgICB9O1xufTtcbi8qKlxuICogQnJlYWsgYSBgUmVhZG9ubHlBcnJheWAgaW50byBpdHMgaW5pdGlhbCBlbGVtZW50cyBhbmQgdGhlIGxhc3QgZWxlbWVudC5cbiAqXG4gKiBAY2F0ZWdvcnkgcGF0dGVybiBtYXRjaGluZ1xuICogQHNpbmNlIDIuMTAuMFxuICovXG5leHBvcnQgdmFyIG1hdGNoUmlnaHQgPSBtYXRjaFJpZ2h0Vztcbi8qKlxuICogQWxpYXMgb2YgW2BtYXRjaFJpZ2h0YF0oI21hdGNocmlnaHQpLlxuICpcbiAqIEBjYXRlZ29yeSBwYXR0ZXJuIG1hdGNoaW5nXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBmb2xkUmlnaHQgPSBtYXRjaFJpZ2h0O1xuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLy8gY29tYmluYXRvcnNcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8qKlxuICogQGNhdGVnb3J5IHNlcXVlbmNpbmdcbiAqIEBzaW5jZSAyLjcuMFxuICovXG5leHBvcnQgdmFyIGNoYWluV2l0aEluZGV4ID0gZnVuY3Rpb24gKGYpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIGlmIChpc0VtcHR5KGFzKSkge1xuICAgICAgICAgICAgcmV0dXJuIGVtcHR5O1xuICAgICAgICB9XG4gICAgICAgIHZhciBvdXQgPSBbXTtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBhcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgb3V0LnB1c2guYXBwbHkob3V0LCBmKGksIGFzW2ldKSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG91dDtcbiAgICB9O1xufTtcbi8qKlxuICogU2FtZSBhcyBgcmVkdWNlYCBidXQgaXQgY2FycmllcyBvdmVyIHRoZSBpbnRlcm1lZGlhdGUgc3RlcHMuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IHNjYW5MZWZ0IH0gZnJvbSAnZnAtdHMvUmVhZG9ubHlBcnJheSdcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKHNjYW5MZWZ0KDEwLCAoYiwgYTogbnVtYmVyKSA9PiBiIC0gYSkoWzEsIDIsIDNdKSwgWzEwLCA5LCA3LCA0XSlcbiAqXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBzY2FuTGVmdCA9IGZ1bmN0aW9uIChiLCBmKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykge1xuICAgICAgICB2YXIgbGVuID0gYXMubGVuZ3RoO1xuICAgICAgICB2YXIgb3V0ID0gbmV3IEFycmF5KGxlbiArIDEpO1xuICAgICAgICBvdXRbMF0gPSBiO1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGxlbjsgaSsrKSB7XG4gICAgICAgICAgICBvdXRbaSArIDFdID0gZihvdXRbaV0sIGFzW2ldKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gb3V0O1xuICAgIH07XG59O1xuLyoqXG4gKiBGb2xkIGFuIGFycmF5IGZyb20gdGhlIHJpZ2h0LCBrZWVwaW5nIGFsbCBpbnRlcm1lZGlhdGUgcmVzdWx0cyBpbnN0ZWFkIG9mIG9ubHkgdGhlIGZpbmFsIHJlc3VsdFxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBzY2FuUmlnaHQgfSBmcm9tICdmcC10cy9SZWFkb25seUFycmF5J1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoc2NhblJpZ2h0KDEwLCAoYTogbnVtYmVyLCBiKSA9PiBiIC0gYSkoWzEsIDIsIDNdKSwgWzQsIDUsIDcsIDEwXSlcbiAqXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBzY2FuUmlnaHQgPSBmdW5jdGlvbiAoYiwgZikge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgdmFyIGxlbiA9IGFzLmxlbmd0aDtcbiAgICAgICAgdmFyIG91dCA9IG5ldyBBcnJheShsZW4gKyAxKTtcbiAgICAgICAgb3V0W2xlbl0gPSBiO1xuICAgICAgICBmb3IgKHZhciBpID0gbGVuIC0gMTsgaSA+PSAwOyBpLS0pIHtcbiAgICAgICAgICAgIG91dFtpXSA9IGYoYXNbaV0sIG91dFtpICsgMV0pO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBvdXQ7XG4gICAgfTtcbn07XG4vKipcbiAqIENhbGN1bGF0ZSB0aGUgbnVtYmVyIG9mIGVsZW1lbnRzIGluIGEgYFJlYWRvbmx5QXJyYXlgLlxuICpcbiAqIEBzaW5jZSAyLjEwLjBcbiAqL1xuZXhwb3J0IHZhciBzaXplID0gZnVuY3Rpb24gKGFzKSB7IHJldHVybiBhcy5sZW5ndGg7IH07XG4vKipcbiAqIFRlc3Qgd2hldGhlciBhbiBhcnJheSBjb250YWlucyBhIHBhcnRpY3VsYXIgaW5kZXhcbiAqXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBpc091dE9mQm91bmQgPSBSTkVBLmlzT3V0T2ZCb3VuZDtcbmV4cG9ydCBmdW5jdGlvbiBsb29rdXAoaSwgYXMpIHtcbiAgICByZXR1cm4gYXMgPT09IHVuZGVmaW5lZCA/IGZ1bmN0aW9uIChhcykgeyByZXR1cm4gbG9va3VwKGksIGFzKTsgfSA6IGlzT3V0T2ZCb3VuZChpLCBhcykgPyBfLm5vbmUgOiBfLnNvbWUoYXNbaV0pO1xufVxuLyoqXG4gKiBHZXQgdGhlIGZpcnN0IGVsZW1lbnQgaW4gYW4gYXJyYXksIG9yIGBOb25lYCBpZiB0aGUgYXJyYXkgaXMgZW1wdHlcbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgaGVhZCB9IGZyb20gJ2ZwLXRzL1JlYWRvbmx5QXJyYXknXG4gKiBpbXBvcnQgeyBzb21lLCBub25lIH0gZnJvbSAnZnAtdHMvT3B0aW9uJ1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoaGVhZChbMSwgMiwgM10pLCBzb21lKDEpKVxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChoZWFkKFtdKSwgbm9uZSlcbiAqXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBoZWFkID0gZnVuY3Rpb24gKGFzKSB7IHJldHVybiAoaXNOb25FbXB0eShhcykgPyBfLnNvbWUoUk5FQS5oZWFkKGFzKSkgOiBfLm5vbmUpOyB9O1xuLyoqXG4gKiBHZXQgdGhlIGxhc3QgZWxlbWVudCBpbiBhbiBhcnJheSwgb3IgYE5vbmVgIGlmIHRoZSBhcnJheSBpcyBlbXB0eVxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBsYXN0IH0gZnJvbSAnZnAtdHMvUmVhZG9ubHlBcnJheSdcbiAqIGltcG9ydCB7IHNvbWUsIG5vbmUgfSBmcm9tICdmcC10cy9PcHRpb24nXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChsYXN0KFsxLCAyLCAzXSksIHNvbWUoMykpXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKGxhc3QoW10pLCBub25lKVxuICpcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIGxhc3QgPSBmdW5jdGlvbiAoYXMpIHsgcmV0dXJuIChpc05vbkVtcHR5KGFzKSA/IF8uc29tZShSTkVBLmxhc3QoYXMpKSA6IF8ubm9uZSk7IH07XG4vKipcbiAqIEdldCBhbGwgYnV0IHRoZSBmaXJzdCBlbGVtZW50IG9mIGFuIGFycmF5LCBjcmVhdGluZyBhIG5ldyBhcnJheSwgb3IgYE5vbmVgIGlmIHRoZSBhcnJheSBpcyBlbXB0eVxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyB0YWlsIH0gZnJvbSAnZnAtdHMvUmVhZG9ubHlBcnJheSdcbiAqIGltcG9ydCB7IHNvbWUsIG5vbmUgfSBmcm9tICdmcC10cy9PcHRpb24nXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbCh0YWlsKFsxLCAyLCAzXSksIHNvbWUoWzIsIDNdKSlcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwodGFpbChbXSksIG5vbmUpXG4gKlxuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgdGFpbCA9IGZ1bmN0aW9uIChhcykge1xuICAgIHJldHVybiBpc05vbkVtcHR5KGFzKSA/IF8uc29tZShSTkVBLnRhaWwoYXMpKSA6IF8ubm9uZTtcbn07XG4vKipcbiAqIEdldCBhbGwgYnV0IHRoZSBsYXN0IGVsZW1lbnQgb2YgYW4gYXJyYXksIGNyZWF0aW5nIGEgbmV3IGFycmF5LCBvciBgTm9uZWAgaWYgdGhlIGFycmF5IGlzIGVtcHR5XG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IGluaXQgfSBmcm9tICdmcC10cy9SZWFkb25seUFycmF5J1xuICogaW1wb3J0IHsgc29tZSwgbm9uZSB9IGZyb20gJ2ZwLXRzL09wdGlvbidcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKGluaXQoWzEsIDIsIDNdKSwgc29tZShbMSwgMl0pKVxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChpbml0KFtdKSwgbm9uZSlcbiAqXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBpbml0ID0gZnVuY3Rpb24gKGFzKSB7XG4gICAgcmV0dXJuIGlzTm9uRW1wdHkoYXMpID8gXy5zb21lKFJORUEuaW5pdChhcykpIDogXy5ub25lO1xufTtcbi8qKlxuICogS2VlcCBvbmx5IGEgbWF4IG51bWJlciBvZiBlbGVtZW50cyBmcm9tIHRoZSBzdGFydCBvZiBhbiBgUmVhZG9ubHlBcnJheWAsIGNyZWF0aW5nIGEgbmV3IGBSZWFkb25seUFycmF5YC5cbiAqXG4gKiAqKk5vdGUqKi4gYG5gIGlzIG5vcm1hbGl6ZWQgdG8gYSBub24gbmVnYXRpdmUgaW50ZWdlci5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0ICogYXMgUkEgZnJvbSAnZnAtdHMvUmVhZG9ubHlBcnJheSdcbiAqIGltcG9ydCB7IHBpcGUgfSBmcm9tICdmcC10cy9mdW5jdGlvbidcbiAqXG4gKiBjb25zdCBpbnB1dDogUmVhZG9ubHlBcnJheTxudW1iZXI+ID0gWzEsIDIsIDNdXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKHBpcGUoaW5wdXQsIFJBLnRha2VMZWZ0KDIpKSwgWzEsIDJdKVxuICpcbiAqIC8vIG91dCBvZiBib3VuZHNcbiAqIGFzc2VydC5zdHJpY3RFcXVhbChwaXBlKGlucHV0LCBSQS50YWtlTGVmdCg0KSksIGlucHV0KVxuICogYXNzZXJ0LnN0cmljdEVxdWFsKHBpcGUoaW5wdXQsIFJBLnRha2VMZWZ0KC0xKSksIGlucHV0KVxuICpcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIHRha2VMZWZ0ID0gZnVuY3Rpb24gKG4pIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIHJldHVybiBpc091dE9mQm91bmQobiwgYXMpID8gYXMgOiBuID09PSAwID8gZW1wdHkgOiBhcy5zbGljZSgwLCBuKTtcbiAgICB9O1xufTtcbi8qKlxuICogS2VlcCBvbmx5IGEgbWF4IG51bWJlciBvZiBlbGVtZW50cyBmcm9tIHRoZSBlbmQgb2YgYW4gYFJlYWRvbmx5QXJyYXlgLCBjcmVhdGluZyBhIG5ldyBgUmVhZG9ubHlBcnJheWAuXG4gKlxuICogKipOb3RlKiouIGBuYCBpcyBub3JtYWxpemVkIHRvIGEgbm9uIG5lZ2F0aXZlIGludGVnZXIuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCAqIGFzIFJBIGZyb20gJ2ZwLXRzL1JlYWRvbmx5QXJyYXknXG4gKiBpbXBvcnQgeyBwaXBlIH0gZnJvbSAnZnAtdHMvZnVuY3Rpb24nXG4gKlxuICogY29uc3QgaW5wdXQ6IFJlYWRvbmx5QXJyYXk8bnVtYmVyPiA9IFsxLCAyLCAzXVxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChwaXBlKGlucHV0LCBSQS50YWtlUmlnaHQoMikpLCBbMiwgM10pXG4gKlxuICogLy8gb3V0IG9mIGJvdW5kc1xuICogYXNzZXJ0LnN0cmljdEVxdWFsKHBpcGUoaW5wdXQsIFJBLnRha2VSaWdodCg0KSksIGlucHV0KVxuICogYXNzZXJ0LnN0cmljdEVxdWFsKHBpcGUoaW5wdXQsIFJBLnRha2VSaWdodCgtMSkpLCBpbnB1dClcbiAqXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciB0YWtlUmlnaHQgPSBmdW5jdGlvbiAobikge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgcmV0dXJuIGlzT3V0T2ZCb3VuZChuLCBhcykgPyBhcyA6IG4gPT09IDAgPyBlbXB0eSA6IGFzLnNsaWNlKC1uKTtcbiAgICB9O1xufTtcbmV4cG9ydCBmdW5jdGlvbiB0YWtlTGVmdFdoaWxlKHByZWRpY2F0ZSkge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgdmFyIG91dCA9IFtdO1xuICAgICAgICBmb3IgKHZhciBfaSA9IDAsIGFzXzEgPSBhczsgX2kgPCBhc18xLmxlbmd0aDsgX2krKykge1xuICAgICAgICAgICAgdmFyIGEgPSBhc18xW19pXTtcbiAgICAgICAgICAgIGlmICghcHJlZGljYXRlKGEpKSB7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBvdXQucHVzaChhKTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgbGVuID0gb3V0Lmxlbmd0aDtcbiAgICAgICAgcmV0dXJuIGxlbiA9PT0gYXMubGVuZ3RoID8gYXMgOiBsZW4gPT09IDAgPyBlbXB0eSA6IG91dDtcbiAgICB9O1xufVxudmFyIHNwYW5MZWZ0SW5kZXggPSBmdW5jdGlvbiAoYXMsIHByZWRpY2F0ZSkge1xuICAgIHZhciBsID0gYXMubGVuZ3RoO1xuICAgIHZhciBpID0gMDtcbiAgICBmb3IgKDsgaSA8IGw7IGkrKykge1xuICAgICAgICBpZiAoIXByZWRpY2F0ZShhc1tpXSkpIHtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiBpO1xufTtcbmV4cG9ydCBmdW5jdGlvbiBzcGFuTGVmdChwcmVkaWNhdGUpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIHZhciBfYSA9IHNwbGl0QXQoc3BhbkxlZnRJbmRleChhcywgcHJlZGljYXRlKSkoYXMpLCBpbml0ID0gX2FbMF0sIHJlc3QgPSBfYVsxXTtcbiAgICAgICAgcmV0dXJuIHsgaW5pdDogaW5pdCwgcmVzdDogcmVzdCB9O1xuICAgIH07XG59XG4vKipcbiAqIERyb3AgYSBtYXggbnVtYmVyIG9mIGVsZW1lbnRzIGZyb20gdGhlIHN0YXJ0IG9mIGFuIGBSZWFkb25seUFycmF5YCwgY3JlYXRpbmcgYSBuZXcgYFJlYWRvbmx5QXJyYXlgLlxuICpcbiAqICoqTm90ZSoqLiBgbmAgaXMgbm9ybWFsaXplZCB0byBhIG5vbiBuZWdhdGl2ZSBpbnRlZ2VyLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgKiBhcyBSQSBmcm9tICdmcC10cy9SZWFkb25seUFycmF5J1xuICogaW1wb3J0IHsgcGlwZSB9IGZyb20gJ2ZwLXRzL2Z1bmN0aW9uJ1xuICpcbiAqIGNvbnN0IGlucHV0OiBSZWFkb25seUFycmF5PG51bWJlcj4gPSBbMSwgMiwgM11cbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwocGlwZShpbnB1dCwgUkEuZHJvcExlZnQoMikpLCBbM10pXG4gKiBhc3NlcnQuc3RyaWN0RXF1YWwocGlwZShpbnB1dCwgUkEuZHJvcExlZnQoMCkpLCBpbnB1dClcbiAqIGFzc2VydC5zdHJpY3RFcXVhbChwaXBlKGlucHV0LCBSQS5kcm9wTGVmdCgtMSkpLCBpbnB1dClcbiAqXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBkcm9wTGVmdCA9IGZ1bmN0aW9uIChuKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykge1xuICAgICAgICByZXR1cm4gbiA8PSAwIHx8IGlzRW1wdHkoYXMpID8gYXMgOiBuID49IGFzLmxlbmd0aCA/IGVtcHR5IDogYXMuc2xpY2UobiwgYXMubGVuZ3RoKTtcbiAgICB9O1xufTtcbi8qKlxuICogRHJvcCBhIG1heCBudW1iZXIgb2YgZWxlbWVudHMgZnJvbSB0aGUgZW5kIG9mIGFuIGBSZWFkb25seUFycmF5YCwgY3JlYXRpbmcgYSBuZXcgYFJlYWRvbmx5QXJyYXlgLlxuICpcbiAqICoqTm90ZSoqLiBgbmAgaXMgbm9ybWFsaXplZCB0byBhIG5vbiBuZWdhdGl2ZSBpbnRlZ2VyLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgKiBhcyBSQSBmcm9tICdmcC10cy9SZWFkb25seUFycmF5J1xuICogaW1wb3J0IHsgcGlwZSB9IGZyb20gJ2ZwLXRzL2Z1bmN0aW9uJ1xuICpcbiAqIGNvbnN0IGlucHV0OiBSZWFkb25seUFycmF5PG51bWJlcj4gPSBbMSwgMiwgM11cbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwocGlwZShpbnB1dCwgUkEuZHJvcFJpZ2h0KDIpKSwgWzFdKVxuICogYXNzZXJ0LnN0cmljdEVxdWFsKHBpcGUoaW5wdXQsIFJBLmRyb3BSaWdodCgwKSksIGlucHV0KVxuICogYXNzZXJ0LnN0cmljdEVxdWFsKHBpcGUoaW5wdXQsIFJBLmRyb3BSaWdodCgtMSkpLCBpbnB1dClcbiAqXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBkcm9wUmlnaHQgPSBmdW5jdGlvbiAobikge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgcmV0dXJuIG4gPD0gMCB8fCBpc0VtcHR5KGFzKSA/IGFzIDogbiA+PSBhcy5sZW5ndGggPyBlbXB0eSA6IGFzLnNsaWNlKDAsIGFzLmxlbmd0aCAtIG4pO1xuICAgIH07XG59O1xuZXhwb3J0IGZ1bmN0aW9uIGRyb3BMZWZ0V2hpbGUocHJlZGljYXRlKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykge1xuICAgICAgICB2YXIgaSA9IHNwYW5MZWZ0SW5kZXgoYXMsIHByZWRpY2F0ZSk7XG4gICAgICAgIHJldHVybiBpID09PSAwID8gYXMgOiBpID09PSBhcy5sZW5ndGggPyBlbXB0eSA6IGFzLnNsaWNlKGkpO1xuICAgIH07XG59XG4vKipcbiAqIEZpbmQgdGhlIGZpcnN0IGluZGV4IGZvciB3aGljaCBhIHByZWRpY2F0ZSBob2xkc1xuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBmaW5kSW5kZXggfSBmcm9tICdmcC10cy9SZWFkb25seUFycmF5J1xuICogaW1wb3J0IHsgc29tZSwgbm9uZSB9IGZyb20gJ2ZwLXRzL09wdGlvbidcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKGZpbmRJbmRleCgobjogbnVtYmVyKSA9PiBuID09PSAyKShbMSwgMiwgM10pLCBzb21lKDEpKVxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChmaW5kSW5kZXgoKG46IG51bWJlcikgPT4gbiA9PT0gMikoW10pLCBub25lKVxuICpcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIGZpbmRJbmRleCA9IGZ1bmN0aW9uIChwcmVkaWNhdGUpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgYXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIGlmIChwcmVkaWNhdGUoYXNbaV0pKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIF8uc29tZShpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gXy5ub25lO1xuICAgIH07XG59O1xuZXhwb3J0IGZ1bmN0aW9uIGZpbmRGaXJzdChwcmVkaWNhdGUpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgYXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIGlmIChwcmVkaWNhdGUoYXNbaV0pKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIF8uc29tZShhc1tpXSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIF8ubm9uZTtcbiAgICB9O1xufVxuLyoqXG4gKiBGaW5kIHRoZSBmaXJzdCBlbGVtZW50IHJldHVybmVkIGJ5IGFuIG9wdGlvbiBiYXNlZCBzZWxlY3RvciBmdW5jdGlvblxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBmaW5kRmlyc3RNYXAgfSBmcm9tICdmcC10cy9SZWFkb25seUFycmF5J1xuICogaW1wb3J0IHsgc29tZSwgbm9uZSB9IGZyb20gJ2ZwLXRzL09wdGlvbidcbiAqXG4gKiBpbnRlcmZhY2UgUGVyc29uIHtcbiAqICAgcmVhZG9ubHkgbmFtZTogc3RyaW5nXG4gKiAgIHJlYWRvbmx5IGFnZT86IG51bWJlclxuICogfVxuICpcbiAqIGNvbnN0IHBlcnNvbnM6IFJlYWRvbmx5QXJyYXk8UGVyc29uPiA9IFt7IG5hbWU6ICdKb2huJyB9LCB7IG5hbWU6ICdNYXJ5JywgYWdlOiA0NSB9LCB7IG5hbWU6ICdKb2V5JywgYWdlOiAyOCB9XVxuICpcbiAqIC8vIHJldHVybnMgdGhlIG5hbWUgb2YgdGhlIGZpcnN0IHBlcnNvbiB0aGF0IGhhcyBhbiBhZ2VcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoZmluZEZpcnN0TWFwKChwOiBQZXJzb24pID0+IChwLmFnZSA9PT0gdW5kZWZpbmVkID8gbm9uZSA6IHNvbWUocC5uYW1lKSkpKHBlcnNvbnMpLCBzb21lKCdNYXJ5JykpXG4gKlxuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgZmluZEZpcnN0TWFwID0gZnVuY3Rpb24gKGYpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgYXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIHZhciBvdXQgPSBmKGFzW2ldKTtcbiAgICAgICAgICAgIGlmIChfLmlzU29tZShvdXQpKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG91dDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gXy5ub25lO1xuICAgIH07XG59O1xuZXhwb3J0IGZ1bmN0aW9uIGZpbmRMYXN0KHByZWRpY2F0ZSkge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgZm9yICh2YXIgaSA9IGFzLmxlbmd0aCAtIDE7IGkgPj0gMDsgaS0tKSB7XG4gICAgICAgICAgICBpZiAocHJlZGljYXRlKGFzW2ldKSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBfLnNvbWUoYXNbaV0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBfLm5vbmU7XG4gICAgfTtcbn1cbi8qKlxuICogRmluZCB0aGUgbGFzdCBlbGVtZW50IHJldHVybmVkIGJ5IGFuIG9wdGlvbiBiYXNlZCBzZWxlY3RvciBmdW5jdGlvblxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBmaW5kTGFzdE1hcCB9IGZyb20gJ2ZwLXRzL1JlYWRvbmx5QXJyYXknXG4gKiBpbXBvcnQgeyBzb21lLCBub25lIH0gZnJvbSAnZnAtdHMvT3B0aW9uJ1xuICpcbiAqIGludGVyZmFjZSBQZXJzb24ge1xuICogICByZWFkb25seSBuYW1lOiBzdHJpbmdcbiAqICAgcmVhZG9ubHkgYWdlPzogbnVtYmVyXG4gKiB9XG4gKlxuICogY29uc3QgcGVyc29uczogUmVhZG9ubHlBcnJheTxQZXJzb24+ID0gW3sgbmFtZTogJ0pvaG4nIH0sIHsgbmFtZTogJ01hcnknLCBhZ2U6IDQ1IH0sIHsgbmFtZTogJ0pvZXknLCBhZ2U6IDI4IH1dXG4gKlxuICogLy8gcmV0dXJucyB0aGUgbmFtZSBvZiB0aGUgbGFzdCBwZXJzb24gdGhhdCBoYXMgYW4gYWdlXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKGZpbmRMYXN0TWFwKChwOiBQZXJzb24pID0+IChwLmFnZSA9PT0gdW5kZWZpbmVkID8gbm9uZSA6IHNvbWUocC5uYW1lKSkpKHBlcnNvbnMpLCBzb21lKCdKb2V5JykpXG4gKlxuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgZmluZExhc3RNYXAgPSBmdW5jdGlvbiAoZikge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgZm9yICh2YXIgaSA9IGFzLmxlbmd0aCAtIDE7IGkgPj0gMDsgaS0tKSB7XG4gICAgICAgICAgICB2YXIgb3V0ID0gZihhc1tpXSk7XG4gICAgICAgICAgICBpZiAoXy5pc1NvbWUob3V0KSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBvdXQ7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIF8ubm9uZTtcbiAgICB9O1xufTtcbi8qKlxuICogUmV0dXJucyB0aGUgaW5kZXggb2YgdGhlIGxhc3QgZWxlbWVudCBvZiB0aGUgbGlzdCB3aGljaCBtYXRjaGVzIHRoZSBwcmVkaWNhdGVcbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgZmluZExhc3RJbmRleCB9IGZyb20gJ2ZwLXRzL1JlYWRvbmx5QXJyYXknXG4gKiBpbXBvcnQgeyBzb21lLCBub25lIH0gZnJvbSAnZnAtdHMvT3B0aW9uJ1xuICpcbiAqIGludGVyZmFjZSBYIHtcbiAqICAgcmVhZG9ubHkgYTogbnVtYmVyXG4gKiAgIHJlYWRvbmx5IGI6IG51bWJlclxuICogfVxuICogY29uc3QgeHM6IFJlYWRvbmx5QXJyYXk8WD4gPSBbeyBhOiAxLCBiOiAwIH0sIHsgYTogMSwgYjogMSB9XVxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChmaW5kTGFzdEluZGV4KCh4OiB7IHJlYWRvbmx5IGE6IG51bWJlciB9KSA9PiB4LmEgPT09IDEpKHhzKSwgc29tZSgxKSlcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoZmluZExhc3RJbmRleCgoeDogeyByZWFkb25seSBhOiBudW1iZXIgfSkgPT4geC5hID09PSA0KSh4cyksIG5vbmUpXG4gKlxuICpcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIGZpbmRMYXN0SW5kZXggPSBmdW5jdGlvbiAocHJlZGljYXRlKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykge1xuICAgICAgICBmb3IgKHZhciBpID0gYXMubGVuZ3RoIC0gMTsgaSA+PSAwOyBpLS0pIHtcbiAgICAgICAgICAgIGlmIChwcmVkaWNhdGUoYXNbaV0pKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIF8uc29tZShpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gXy5ub25lO1xuICAgIH07XG59O1xuLyoqXG4gKiBJbnNlcnQgYW4gZWxlbWVudCBhdCB0aGUgc3BlY2lmaWVkIGluZGV4LCBjcmVhdGluZyBhIG5ldyBhcnJheSwgb3IgcmV0dXJuaW5nIGBOb25lYCBpZiB0aGUgaW5kZXggaXMgb3V0IG9mIGJvdW5kc1xuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBpbnNlcnRBdCB9IGZyb20gJ2ZwLXRzL1JlYWRvbmx5QXJyYXknXG4gKiBpbXBvcnQgeyBzb21lIH0gZnJvbSAnZnAtdHMvT3B0aW9uJ1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoaW5zZXJ0QXQoMiwgNSkoWzEsIDIsIDMsIDRdKSwgc29tZShbMSwgMiwgNSwgMywgNF0pKVxuICpcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIGluc2VydEF0ID0gZnVuY3Rpb24gKGksIGEpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIHJldHVybiBpIDwgMCB8fCBpID4gYXMubGVuZ3RoID8gXy5ub25lIDogXy5zb21lKFJORUEudW5zYWZlSW5zZXJ0QXQoaSwgYSwgYXMpKTtcbiAgICB9O1xufTtcbi8qKlxuICogQ2hhbmdlIHRoZSBlbGVtZW50IGF0IHRoZSBzcGVjaWZpZWQgaW5kZXgsIGNyZWF0aW5nIGEgbmV3IGFycmF5LCBvciByZXR1cm5pbmcgYE5vbmVgIGlmIHRoZSBpbmRleCBpcyBvdXQgb2YgYm91bmRzXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IHVwZGF0ZUF0IH0gZnJvbSAnZnAtdHMvUmVhZG9ubHlBcnJheSdcbiAqIGltcG9ydCB7IHNvbWUsIG5vbmUgfSBmcm9tICdmcC10cy9PcHRpb24nXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbCh1cGRhdGVBdCgxLCAxKShbMSwgMiwgM10pLCBzb21lKFsxLCAxLCAzXSkpXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKHVwZGF0ZUF0KDEsIDEpKFtdKSwgbm9uZSlcbiAqXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciB1cGRhdGVBdCA9IGZ1bmN0aW9uIChpLCBhKSB7XG4gICAgcmV0dXJuIG1vZGlmeUF0KGksIGZ1bmN0aW9uICgpIHsgcmV0dXJuIGE7IH0pO1xufTtcbi8qKlxuICogRGVsZXRlIHRoZSBlbGVtZW50IGF0IHRoZSBzcGVjaWZpZWQgaW5kZXgsIGNyZWF0aW5nIGEgbmV3IGFycmF5LCBvciByZXR1cm5pbmcgYE5vbmVgIGlmIHRoZSBpbmRleCBpcyBvdXQgb2YgYm91bmRzXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IGRlbGV0ZUF0IH0gZnJvbSAnZnAtdHMvUmVhZG9ubHlBcnJheSdcbiAqIGltcG9ydCB7IHNvbWUsIG5vbmUgfSBmcm9tICdmcC10cy9PcHRpb24nXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChkZWxldGVBdCgwKShbMSwgMiwgM10pLCBzb21lKFsyLCAzXSkpXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKGRlbGV0ZUF0KDEpKFtdKSwgbm9uZSlcbiAqXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBkZWxldGVBdCA9IGZ1bmN0aW9uIChpKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykge1xuICAgICAgICByZXR1cm4gaXNPdXRPZkJvdW5kKGksIGFzKSA/IF8ubm9uZSA6IF8uc29tZSh1bnNhZmVEZWxldGVBdChpLCBhcykpO1xuICAgIH07XG59O1xuLyoqXG4gKiBBcHBseSBhIGZ1bmN0aW9uIHRvIHRoZSBlbGVtZW50IGF0IHRoZSBzcGVjaWZpZWQgaW5kZXgsIGNyZWF0aW5nIGEgbmV3IGFycmF5LCBvciByZXR1cm5pbmcgYE5vbmVgIGlmIHRoZSBpbmRleCBpcyBvdXRcbiAqIG9mIGJvdW5kc1xuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBtb2RpZnlBdCB9IGZyb20gJ2ZwLXRzL1JlYWRvbmx5QXJyYXknXG4gKiBpbXBvcnQgeyBzb21lLCBub25lIH0gZnJvbSAnZnAtdHMvT3B0aW9uJ1xuICpcbiAqIGNvbnN0IGRvdWJsZSA9ICh4OiBudW1iZXIpOiBudW1iZXIgPT4geCAqIDJcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwobW9kaWZ5QXQoMSwgZG91YmxlKShbMSwgMiwgM10pLCBzb21lKFsxLCA0LCAzXSkpXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKG1vZGlmeUF0KDEsIGRvdWJsZSkoW10pLCBub25lKVxuICpcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIG1vZGlmeUF0ID0gZnVuY3Rpb24gKGksIGYpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIHJldHVybiBpc091dE9mQm91bmQoaSwgYXMpID8gXy5ub25lIDogXy5zb21lKHVuc2FmZVVwZGF0ZUF0KGksIGYoYXNbaV0pLCBhcykpO1xuICAgIH07XG59O1xuLyoqXG4gKiBSZXZlcnNlIGFuIGFycmF5LCBjcmVhdGluZyBhIG5ldyBhcnJheVxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyByZXZlcnNlIH0gZnJvbSAnZnAtdHMvUmVhZG9ubHlBcnJheSdcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKHJldmVyc2UoWzEsIDIsIDNdKSwgWzMsIDIsIDFdKVxuICpcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIHJldmVyc2UgPSBmdW5jdGlvbiAoYXMpIHsgcmV0dXJuIChhcy5sZW5ndGggPD0gMSA/IGFzIDogYXMuc2xpY2UoKS5yZXZlcnNlKCkpOyB9O1xuLyoqXG4gKiBFeHRyYWN0cyBmcm9tIGFuIGFycmF5IG9mIGBFaXRoZXJgIGFsbCB0aGUgYFJpZ2h0YCBlbGVtZW50cy4gQWxsIHRoZSBgUmlnaHRgIGVsZW1lbnRzIGFyZSBleHRyYWN0ZWQgaW4gb3JkZXJcbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgcmlnaHRzIH0gZnJvbSAnZnAtdHMvUmVhZG9ubHlBcnJheSdcbiAqIGltcG9ydCB7IHJpZ2h0LCBsZWZ0IH0gZnJvbSAnZnAtdHMvRWl0aGVyJ1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwocmlnaHRzKFtyaWdodCgxKSwgbGVmdCgnZm9vJyksIHJpZ2h0KDIpXSksIFsxLCAyXSlcbiAqXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciByaWdodHMgPSBmdW5jdGlvbiAoYXMpIHtcbiAgICB2YXIgciA9IFtdO1xuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgYXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgdmFyIGEgPSBhc1tpXTtcbiAgICAgICAgaWYgKGEuX3RhZyA9PT0gJ1JpZ2h0Jykge1xuICAgICAgICAgICAgci5wdXNoKGEucmlnaHQpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiByO1xufTtcbi8qKlxuICogRXh0cmFjdHMgZnJvbSBhbiBhcnJheSBvZiBgRWl0aGVyYCBhbGwgdGhlIGBMZWZ0YCBlbGVtZW50cy4gQWxsIHRoZSBgTGVmdGAgZWxlbWVudHMgYXJlIGV4dHJhY3RlZCBpbiBvcmRlclxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBsZWZ0cyB9IGZyb20gJ2ZwLXRzL1JlYWRvbmx5QXJyYXknXG4gKiBpbXBvcnQgeyBsZWZ0LCByaWdodCB9IGZyb20gJ2ZwLXRzL0VpdGhlcidcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKGxlZnRzKFtyaWdodCgxKSwgbGVmdCgnZm9vJyksIHJpZ2h0KDIpXSksIFsnZm9vJ10pXG4gKlxuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgbGVmdHMgPSBmdW5jdGlvbiAoYXMpIHtcbiAgICB2YXIgciA9IFtdO1xuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgYXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgdmFyIGEgPSBhc1tpXTtcbiAgICAgICAgaWYgKGEuX3RhZyA9PT0gJ0xlZnQnKSB7XG4gICAgICAgICAgICByLnB1c2goYS5sZWZ0KTtcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gcjtcbn07XG4vKipcbiAqIFNvcnQgdGhlIGVsZW1lbnRzIG9mIGFuIGFycmF5IGluIGluY3JlYXNpbmcgb3JkZXIsIGNyZWF0aW5nIGEgbmV3IGFycmF5XG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IHNvcnQgfSBmcm9tICdmcC10cy9SZWFkb25seUFycmF5J1xuICogaW1wb3J0ICogYXMgTiBmcm9tICdmcC10cy9udW1iZXInXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChzb3J0KE4uT3JkKShbMywgMiwgMV0pLCBbMSwgMiwgM10pXG4gKlxuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgc29ydCA9IGZ1bmN0aW9uIChPKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykge1xuICAgICAgICByZXR1cm4gYXMubGVuZ3RoIDw9IDEgPyBhcyA6IGFzLnNsaWNlKCkuc29ydChPLmNvbXBhcmUpO1xuICAgIH07XG59O1xuLy8gVE9ETzogY3VycnkgYW5kIG1ha2UgZGF0YS1sYXN0IGluIHYzXG4vKipcbiAqIEFwcGx5IGEgZnVuY3Rpb24gdG8gcGFpcnMgb2YgZWxlbWVudHMgYXQgdGhlIHNhbWUgaW5kZXggaW4gdHdvIGFycmF5cywgY29sbGVjdGluZyB0aGUgcmVzdWx0cyBpbiBhIG5ldyBhcnJheS4gSWYgb25lXG4gKiBpbnB1dCBhcnJheSBpcyBzaG9ydCwgZXhjZXNzIGVsZW1lbnRzIG9mIHRoZSBsb25nZXIgYXJyYXkgYXJlIGRpc2NhcmRlZC5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgemlwV2l0aCB9IGZyb20gJ2ZwLXRzL1JlYWRvbmx5QXJyYXknXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbCh6aXBXaXRoKFsxLCAyLCAzXSwgWydhJywgJ2InLCAnYycsICdkJ10sIChuLCBzKSA9PiBzICsgbiksIFsnYTEnLCAnYjInLCAnYzMnXSlcbiAqXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciB6aXBXaXRoID0gZnVuY3Rpb24gKGZhLCBmYiwgZikge1xuICAgIHZhciBmYyA9IFtdO1xuICAgIHZhciBsZW4gPSBNYXRoLm1pbihmYS5sZW5ndGgsIGZiLmxlbmd0aCk7XG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBsZW47IGkrKykge1xuICAgICAgICBmY1tpXSA9IGYoZmFbaV0sIGZiW2ldKTtcbiAgICB9XG4gICAgcmV0dXJuIGZjO1xufTtcbmV4cG9ydCBmdW5jdGlvbiB6aXAoYXMsIGJzKSB7XG4gICAgaWYgKGJzID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIChicykgeyByZXR1cm4gemlwKGJzLCBhcyk7IH07XG4gICAgfVxuICAgIHJldHVybiB6aXBXaXRoKGFzLCBicywgZnVuY3Rpb24gKGEsIGIpIHsgcmV0dXJuIFthLCBiXTsgfSk7XG59XG4vKipcbiAqIFRoZSBmdW5jdGlvbiBpcyByZXZlcnNlIG9mIGB6aXBgLiBUYWtlcyBhbiBhcnJheSBvZiBwYWlycyBhbmQgcmV0dXJuIHR3byBjb3JyZXNwb25kaW5nIGFycmF5c1xuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyB1bnppcCB9IGZyb20gJ2ZwLXRzL1JlYWRvbmx5QXJyYXknXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbCh1bnppcChbWzEsICdhJ10sIFsyLCAnYiddLCBbMywgJ2MnXV0pLCBbWzEsIDIsIDNdLCBbJ2EnLCAnYicsICdjJ11dKVxuICpcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIHVuemlwID0gZnVuY3Rpb24gKGFzKSB7XG4gICAgdmFyIGZhID0gW107XG4gICAgdmFyIGZiID0gW107XG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBhcy5sZW5ndGg7IGkrKykge1xuICAgICAgICBmYVtpXSA9IGFzW2ldWzBdO1xuICAgICAgICBmYltpXSA9IGFzW2ldWzFdO1xuICAgIH1cbiAgICByZXR1cm4gW2ZhLCBmYl07XG59O1xuLyoqXG4gKiBQcmVwZW5kIGFuIGVsZW1lbnQgdG8gZXZlcnkgbWVtYmVyIG9mIGFuIGFycmF5XG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IHByZXBlbmRBbGwgfSBmcm9tICdmcC10cy9SZWFkb25seUFycmF5J1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwocHJlcGVuZEFsbCg5KShbMSwgMiwgMywgNF0pLCBbOSwgMSwgOSwgMiwgOSwgMywgOSwgNF0pXG4gKlxuICogQHNpbmNlIDIuMTAuMFxuICovXG5leHBvcnQgdmFyIHByZXBlbmRBbGwgPSBmdW5jdGlvbiAobWlkZGxlKSB7XG4gICAgdmFyIGYgPSBSTkVBLnByZXBlbmRBbGwobWlkZGxlKTtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7IHJldHVybiAoaXNOb25FbXB0eShhcykgPyBmKGFzKSA6IGFzKTsgfTtcbn07XG4vKipcbiAqIFBsYWNlcyBhbiBlbGVtZW50IGluIGJldHdlZW4gbWVtYmVycyBvZiBhbiBhcnJheVxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBpbnRlcnNwZXJzZSB9IGZyb20gJ2ZwLXRzL1JlYWRvbmx5QXJyYXknXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChpbnRlcnNwZXJzZSg5KShbMSwgMiwgMywgNF0pLCBbMSwgOSwgMiwgOSwgMywgOSwgNF0pXG4gKlxuICogQHNpbmNlIDIuOS4wXG4gKi9cbmV4cG9ydCB2YXIgaW50ZXJzcGVyc2UgPSBmdW5jdGlvbiAobWlkZGxlKSB7XG4gICAgdmFyIGYgPSBSTkVBLmludGVyc3BlcnNlKG1pZGRsZSk7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykgeyByZXR1cm4gKGlzTm9uRW1wdHkoYXMpID8gZihhcykgOiBhcyk7IH07XG59O1xuLyoqXG4gKiBSb3RhdGUgYSBgUmVhZG9ubHlBcnJheWAgYnkgYG5gIHN0ZXBzLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyByb3RhdGUgfSBmcm9tICdmcC10cy9SZWFkb25seUFycmF5J1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwocm90YXRlKDIpKFsxLCAyLCAzLCA0LCA1XSksIFs0LCA1LCAxLCAyLCAzXSlcbiAqXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciByb3RhdGUgPSBmdW5jdGlvbiAobikge1xuICAgIHZhciBmID0gUk5FQS5yb3RhdGUobik7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykgeyByZXR1cm4gKGlzTm9uRW1wdHkoYXMpID8gZihhcykgOiBhcyk7IH07XG59O1xuZXhwb3J0IGZ1bmN0aW9uIGVsZW0oRSkge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYSwgYXMpIHtcbiAgICAgICAgaWYgKGFzID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIHZhciBlbGVtRV8xID0gZWxlbShFKTtcbiAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHsgcmV0dXJuIGVsZW1FXzEoYSwgYXMpOyB9O1xuICAgICAgICB9XG4gICAgICAgIHZhciBwcmVkaWNhdGUgPSBmdW5jdGlvbiAoZWxlbWVudCkgeyByZXR1cm4gRS5lcXVhbHMoZWxlbWVudCwgYSk7IH07XG4gICAgICAgIHZhciBpID0gMDtcbiAgICAgICAgZm9yICg7IGkgPCBhcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgaWYgKHByZWRpY2F0ZShhc1tpXSkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfTtcbn1cbi8qKlxuICogUmVtb3ZlIGR1cGxpY2F0ZXMgZnJvbSBhbiBhcnJheSwga2VlcGluZyB0aGUgZmlyc3Qgb2NjdXJyZW5jZSBvZiBhbiBlbGVtZW50LlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyB1bmlxIH0gZnJvbSAnZnAtdHMvUmVhZG9ubHlBcnJheSdcbiAqIGltcG9ydCAqIGFzIE4gZnJvbSAnZnAtdHMvbnVtYmVyJ1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwodW5pcShOLkVxKShbMSwgMiwgMV0pLCBbMSwgMl0pXG4gKlxuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgdW5pcSA9IGZ1bmN0aW9uIChFKSB7XG4gICAgdmFyIGYgPSBSTkVBLnVuaXEoRSk7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykgeyByZXR1cm4gKGlzTm9uRW1wdHkoYXMpID8gZihhcykgOiBhcyk7IH07XG59O1xuLyoqXG4gKiBTb3J0IHRoZSBlbGVtZW50cyBvZiBhbiBhcnJheSBpbiBpbmNyZWFzaW5nIG9yZGVyLCB3aGVyZSBlbGVtZW50cyBhcmUgY29tcGFyZWQgdXNpbmcgZmlyc3QgYG9yZHNbMF1gLCB0aGVuIGBvcmRzWzFdYCxcbiAqIGV0Yy4uLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBzb3J0QnkgfSBmcm9tICdmcC10cy9SZWFkb25seUFycmF5J1xuICogaW1wb3J0IHsgY29udHJhbWFwIH0gZnJvbSAnZnAtdHMvT3JkJ1xuICogaW1wb3J0ICogYXMgUyBmcm9tICdmcC10cy9zdHJpbmcnXG4gKiBpbXBvcnQgKiBhcyBOIGZyb20gJ2ZwLXRzL251bWJlcidcbiAqIGltcG9ydCB7IHBpcGUgfSBmcm9tICdmcC10cy9mdW5jdGlvbidcbiAqXG4gKiBpbnRlcmZhY2UgUGVyc29uIHtcbiAqICAgcmVhZG9ubHkgbmFtZTogc3RyaW5nXG4gKiAgIHJlYWRvbmx5IGFnZTogbnVtYmVyXG4gKiB9XG4gKiBjb25zdCBieU5hbWUgPSBwaXBlKFMuT3JkLCBjb250cmFtYXAoKHA6IFBlcnNvbikgPT4gcC5uYW1lKSlcbiAqIGNvbnN0IGJ5QWdlID0gcGlwZShOLk9yZCwgY29udHJhbWFwKChwOiBQZXJzb24pID0+IHAuYWdlKSlcbiAqXG4gKiBjb25zdCBzb3J0QnlOYW1lQnlBZ2UgPSBzb3J0QnkoW2J5TmFtZSwgYnlBZ2VdKVxuICpcbiAqIGNvbnN0IHBlcnNvbnMgPSBbeyBuYW1lOiAnYScsIGFnZTogMSB9LCB7IG5hbWU6ICdiJywgYWdlOiAzIH0sIHsgbmFtZTogJ2MnLCBhZ2U6IDIgfSwgeyBuYW1lOiAnYicsIGFnZTogMiB9XVxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChzb3J0QnlOYW1lQnlBZ2UocGVyc29ucyksIFtcbiAqICAgeyBuYW1lOiAnYScsIGFnZTogMSB9LFxuICogICB7IG5hbWU6ICdiJywgYWdlOiAyIH0sXG4gKiAgIHsgbmFtZTogJ2InLCBhZ2U6IDMgfSxcbiAqICAgeyBuYW1lOiAnYycsIGFnZTogMiB9XG4gKiBdKVxuICpcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIHNvcnRCeSA9IGZ1bmN0aW9uIChvcmRzKSB7XG4gICAgdmFyIGYgPSBSTkVBLnNvcnRCeShvcmRzKTtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7IHJldHVybiAoaXNOb25FbXB0eShhcykgPyBmKGFzKSA6IGFzKTsgfTtcbn07XG4vKipcbiAqIEEgdXNlZnVsIHJlY3Vyc2lvbiBwYXR0ZXJuIGZvciBwcm9jZXNzaW5nIGEgYFJlYWRvbmx5QXJyYXlgIHRvIHByb2R1Y2UgYSBuZXcgYFJlYWRvbmx5QXJyYXlgLCBvZnRlbiB1c2VkIGZvciBcImNob3BwaW5nXCIgdXAgdGhlIGlucHV0XG4gKiBgUmVhZG9ubHlBcnJheWAuIFR5cGljYWxseSBgY2hvcGAgaXMgY2FsbGVkIHdpdGggc29tZSBmdW5jdGlvbiB0aGF0IHdpbGwgY29uc3VtZSBhbiBpbml0aWFsIHByZWZpeCBvZiB0aGUgYFJlYWRvbmx5QXJyYXlgIGFuZCBwcm9kdWNlIGFcbiAqIHZhbHVlIGFuZCB0aGUgdGFpbCBvZiB0aGUgYFJlYWRvbmx5QXJyYXlgLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBFcSB9IGZyb20gJ2ZwLXRzL0VxJ1xuICogaW1wb3J0ICogYXMgUkEgZnJvbSAnZnAtdHMvUmVhZG9ubHlBcnJheSdcbiAqIGltcG9ydCAqIGFzIE4gZnJvbSAnZnAtdHMvbnVtYmVyJ1xuICogaW1wb3J0IHsgcGlwZSB9IGZyb20gJ2ZwLXRzL2Z1bmN0aW9uJ1xuICpcbiAqIGNvbnN0IGdyb3VwID0gPEE+KFM6IEVxPEE+KTogKChhczogUmVhZG9ubHlBcnJheTxBPikgPT4gUmVhZG9ubHlBcnJheTxSZWFkb25seUFycmF5PEE+PikgPT4ge1xuICogICByZXR1cm4gUkEuY2hvcChhcyA9PiB7XG4gKiAgICAgY29uc3QgeyBpbml0LCByZXN0IH0gPSBwaXBlKGFzLCBSQS5zcGFuTGVmdCgoYTogQSkgPT4gUy5lcXVhbHMoYSwgYXNbMF0pKSlcbiAqICAgICByZXR1cm4gW2luaXQsIHJlc3RdXG4gKiAgIH0pXG4gKiB9XG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKGdyb3VwKE4uRXEpKFsxLCAxLCAyLCAzLCAzLCA0XSksIFtbMSwgMV0sIFsyXSwgWzMsIDNdLCBbNF1dKVxuICpcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIGNob3AgPSBmdW5jdGlvbiAoZikge1xuICAgIHZhciBnID0gUk5FQS5jaG9wKGYpO1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHsgcmV0dXJuIChpc05vbkVtcHR5KGFzKSA/IGcoYXMpIDogZW1wdHkpOyB9O1xufTtcbi8qKlxuICogU3BsaXRzIGEgYFJlYWRvbmx5QXJyYXlgIGludG8gdHdvIHBpZWNlcywgdGhlIGZpcnN0IHBpZWNlIGhhcyBtYXggYG5gIGVsZW1lbnRzLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBzcGxpdEF0IH0gZnJvbSAnZnAtdHMvUmVhZG9ubHlBcnJheSdcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKHNwbGl0QXQoMikoWzEsIDIsIDMsIDQsIDVdKSwgW1sxLCAyXSwgWzMsIDQsIDVdXSlcbiAqXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBzcGxpdEF0ID0gZnVuY3Rpb24gKG4pIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIHJldHVybiBuID49IDEgJiYgaXNOb25FbXB0eShhcykgPyBSTkVBLnNwbGl0QXQobikoYXMpIDogaXNFbXB0eShhcykgPyBbYXMsIGVtcHR5XSA6IFtlbXB0eSwgYXNdO1xuICAgIH07XG59O1xuLyoqXG4gKiBTcGxpdHMgYSBgUmVhZG9ubHlBcnJheWAgaW50byBsZW5ndGgtYG5gIHBpZWNlcy4gVGhlIGxhc3QgcGllY2Ugd2lsbCBiZSBzaG9ydGVyIGlmIGBuYCBkb2VzIG5vdCBldmVubHkgZGl2aWRlIHRoZSBsZW5ndGggb2ZcbiAqIHRoZSBgUmVhZG9ubHlBcnJheWAuIE5vdGUgdGhhdCBgY2h1bmtzT2YobikoW10pYCBpcyBgW11gLCBub3QgYFtbXV1gLiBUaGlzIGlzIGludGVudGlvbmFsLCBhbmQgaXMgY29uc2lzdGVudCB3aXRoIGEgcmVjdXJzaXZlXG4gKiBkZWZpbml0aW9uIG9mIGBjaHVua3NPZmA7IGl0IHNhdGlzZmllcyB0aGUgcHJvcGVydHkgdGhhdDpcbiAqXG4gKiBgYGB0c1xuICogY2h1bmtzT2YobikoeHMpLmNvbmNhdChjaHVua3NPZihuKSh5cykpID09IGNodW5rc09mKG4pKHhzLmNvbmNhdCh5cykpKVxuICogYGBgXG4gKlxuICogd2hlbmV2ZXIgYG5gIGV2ZW5seSBkaXZpZGVzIHRoZSBsZW5ndGggb2YgYGFzYC5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgY2h1bmtzT2YgfSBmcm9tICdmcC10cy9SZWFkb25seUFycmF5J1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoY2h1bmtzT2YoMikoWzEsIDIsIDMsIDQsIDVdKSwgW1sxLCAyXSwgWzMsIDRdLCBbNV1dKVxuICpcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIGNodW5rc09mID0gZnVuY3Rpb24gKG4pIHtcbiAgICB2YXIgZiA9IFJORUEuY2h1bmtzT2Yobik7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykgeyByZXR1cm4gKGlzTm9uRW1wdHkoYXMpID8gZihhcykgOiBlbXB0eSk7IH07XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgbGlmdGluZ1xuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIGZyb21PcHRpb25LID0gZnVuY3Rpb24gKGYpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgYSA9IFtdO1xuICAgICAgICBmb3IgKHZhciBfaSA9IDA7IF9pIDwgYXJndW1lbnRzLmxlbmd0aDsgX2krKykge1xuICAgICAgICAgICAgYVtfaV0gPSBhcmd1bWVudHNbX2ldO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBmcm9tT3B0aW9uKGYuYXBwbHkodm9pZCAwLCBhKSk7XG4gICAgfTtcbn07XG5leHBvcnQgZnVuY3Rpb24gY29tcHJlaGVuc2lvbihpbnB1dCwgZiwgZykge1xuICAgIGlmIChnID09PSB2b2lkIDApIHsgZyA9IGZ1bmN0aW9uICgpIHsgcmV0dXJuIHRydWU7IH07IH1cbiAgICB2YXIgZ28gPSBmdW5jdGlvbiAoc2NvcGUsIGlucHV0KSB7XG4gICAgICAgIHJldHVybiBpc05vbkVtcHR5KGlucHV0KVxuICAgICAgICAgICAgPyBmbGF0TWFwKFJORUEuaGVhZChpbnB1dCksIGZ1bmN0aW9uIChhKSB7IHJldHVybiBnbyhwaXBlKHNjb3BlLCBhcHBlbmQoYSkpLCBSTkVBLnRhaWwoaW5wdXQpKTsgfSlcbiAgICAgICAgICAgIDogZy5hcHBseSh2b2lkIDAsIHNjb3BlKSA/IFtmLmFwcGx5KHZvaWQgMCwgc2NvcGUpXVxuICAgICAgICAgICAgICAgIDogZW1wdHk7XG4gICAgfTtcbiAgICByZXR1cm4gZ28oZW1wdHksIGlucHV0KTtcbn1cbi8qKlxuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIGNvbmNhdFcgPSBmdW5jdGlvbiAoc2Vjb25kKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChmaXJzdCkge1xuICAgICAgICByZXR1cm4gaXNFbXB0eShmaXJzdCkgPyBzZWNvbmQgOiBpc0VtcHR5KHNlY29uZCkgPyBmaXJzdCA6IGZpcnN0LmNvbmNhdChzZWNvbmQpO1xuICAgIH07XG59O1xuLyoqXG4gKiBAc2luY2UgMi4xMS4wXG4gKi9cbmV4cG9ydCB2YXIgY29uY2F0ID0gY29uY2F0VztcbmV4cG9ydCBmdW5jdGlvbiB1bmlvbihFKSB7XG4gICAgdmFyIHVuaW9uRSA9IFJORUEudW5pb24oRSk7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChmaXJzdCwgc2Vjb25kKSB7XG4gICAgICAgIGlmIChzZWNvbmQgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgdmFyIHVuaW9uRV8xID0gdW5pb24oRSk7XG4gICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24gKHNlY29uZCkgeyByZXR1cm4gdW5pb25FXzEoc2Vjb25kLCBmaXJzdCk7IH07XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGlzTm9uRW1wdHkoZmlyc3QpICYmIGlzTm9uRW1wdHkoc2Vjb25kKSA/IHVuaW9uRShzZWNvbmQpKGZpcnN0KSA6IGlzTm9uRW1wdHkoZmlyc3QpID8gZmlyc3QgOiBzZWNvbmQ7XG4gICAgfTtcbn1cbmV4cG9ydCBmdW5jdGlvbiBpbnRlcnNlY3Rpb24oRSkge1xuICAgIHZhciBlbGVtRSA9IGVsZW0oRSk7XG4gICAgcmV0dXJuIGZ1bmN0aW9uICh4cywgeXMpIHtcbiAgICAgICAgaWYgKHlzID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIHZhciBpbnRlcnNlY3Rpb25FXzEgPSBpbnRlcnNlY3Rpb24oRSk7XG4gICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24gKHlzKSB7IHJldHVybiBpbnRlcnNlY3Rpb25FXzEoeXMsIHhzKTsgfTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4geHMuZmlsdGVyKGZ1bmN0aW9uIChhKSB7IHJldHVybiBlbGVtRShhLCB5cyk7IH0pO1xuICAgIH07XG59XG5leHBvcnQgZnVuY3Rpb24gZGlmZmVyZW5jZShFKSB7XG4gICAgdmFyIGVsZW1FID0gZWxlbShFKTtcbiAgICByZXR1cm4gZnVuY3Rpb24gKHhzLCB5cykge1xuICAgICAgICBpZiAoeXMgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgdmFyIGRpZmZlcmVuY2VFXzEgPSBkaWZmZXJlbmNlKEUpO1xuICAgICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uICh5cykgeyByZXR1cm4gZGlmZmVyZW5jZUVfMSh5cywgeHMpOyB9O1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB4cy5maWx0ZXIoZnVuY3Rpb24gKGEpIHsgcmV0dXJuICFlbGVtRShhLCB5cyk7IH0pO1xuICAgIH07XG59XG52YXIgX21hcCA9IGZ1bmN0aW9uIChmYSwgZikgeyByZXR1cm4gcGlwZShmYSwgbWFwKGYpKTsgfTtcbnZhciBfbWFwV2l0aEluZGV4ID0gZnVuY3Rpb24gKGZhLCBmKSB7IHJldHVybiBwaXBlKGZhLCBtYXBXaXRoSW5kZXgoZikpOyB9O1xudmFyIF9hcCA9IGZ1bmN0aW9uIChmYWIsIGZhKSB7IHJldHVybiBwaXBlKGZhYiwgYXAoZmEpKTsgfTtcbnZhciBfZmlsdGVyID0gZnVuY3Rpb24gKGZhLCBwcmVkaWNhdGUpIHtcbiAgICByZXR1cm4gcGlwZShmYSwgZmlsdGVyKHByZWRpY2F0ZSkpO1xufTtcbnZhciBfZmlsdGVyTWFwID0gZnVuY3Rpb24gKGZhLCBmKSB7IHJldHVybiBwaXBlKGZhLCBmaWx0ZXJNYXAoZikpOyB9O1xudmFyIF9wYXJ0aXRpb24gPSBmdW5jdGlvbiAoZmEsIHByZWRpY2F0ZSkge1xuICAgIHJldHVybiBwaXBlKGZhLCBwYXJ0aXRpb24ocHJlZGljYXRlKSk7XG59O1xudmFyIF9wYXJ0aXRpb25NYXAgPSBmdW5jdGlvbiAoZmEsIGYpIHsgcmV0dXJuIHBpcGUoZmEsIHBhcnRpdGlvbk1hcChmKSk7IH07XG52YXIgX3BhcnRpdGlvbldpdGhJbmRleCA9IGZ1bmN0aW9uIChmYSwgcHJlZGljYXRlV2l0aEluZGV4KSB7IHJldHVybiBwaXBlKGZhLCBwYXJ0aXRpb25XaXRoSW5kZXgocHJlZGljYXRlV2l0aEluZGV4KSk7IH07XG52YXIgX3BhcnRpdGlvbk1hcFdpdGhJbmRleCA9IGZ1bmN0aW9uIChmYSwgZikgeyByZXR1cm4gcGlwZShmYSwgcGFydGl0aW9uTWFwV2l0aEluZGV4KGYpKTsgfTtcbnZhciBfYWx0ID0gZnVuY3Rpb24gKGZhLCB0aGF0KSB7IHJldHVybiBwaXBlKGZhLCBhbHQodGhhdCkpOyB9O1xudmFyIF9yZWR1Y2UgPSBmdW5jdGlvbiAoZmEsIGIsIGYpIHsgcmV0dXJuIHBpcGUoZmEsIHJlZHVjZShiLCBmKSk7IH07XG52YXIgX2ZvbGRNYXAgPSBmdW5jdGlvbiAoTSkge1xuICAgIHZhciBmb2xkTWFwTSA9IGZvbGRNYXAoTSk7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChmYSwgZikgeyByZXR1cm4gcGlwZShmYSwgZm9sZE1hcE0oZikpOyB9O1xufTtcbnZhciBfcmVkdWNlUmlnaHQgPSBmdW5jdGlvbiAoZmEsIGIsIGYpIHsgcmV0dXJuIHBpcGUoZmEsIHJlZHVjZVJpZ2h0KGIsIGYpKTsgfTtcbnZhciBfcmVkdWNlV2l0aEluZGV4ID0gZnVuY3Rpb24gKGZhLCBiLCBmKSB7XG4gICAgcmV0dXJuIHBpcGUoZmEsIHJlZHVjZVdpdGhJbmRleChiLCBmKSk7XG59O1xudmFyIF9mb2xkTWFwV2l0aEluZGV4ID0gZnVuY3Rpb24gKE0pIHtcbiAgICB2YXIgZm9sZE1hcFdpdGhJbmRleE0gPSBmb2xkTWFwV2l0aEluZGV4KE0pO1xuICAgIHJldHVybiBmdW5jdGlvbiAoZmEsIGYpIHsgcmV0dXJuIHBpcGUoZmEsIGZvbGRNYXBXaXRoSW5kZXhNKGYpKTsgfTtcbn07XG52YXIgX3JlZHVjZVJpZ2h0V2l0aEluZGV4ID0gZnVuY3Rpb24gKGZhLCBiLCBmKSB7XG4gICAgcmV0dXJuIHBpcGUoZmEsIHJlZHVjZVJpZ2h0V2l0aEluZGV4KGIsIGYpKTtcbn07XG52YXIgX2ZpbHRlck1hcFdpdGhJbmRleCA9IGZ1bmN0aW9uIChmYSwgZikgeyByZXR1cm4gcGlwZShmYSwgZmlsdGVyTWFwV2l0aEluZGV4KGYpKTsgfTtcbnZhciBfZmlsdGVyV2l0aEluZGV4ID0gZnVuY3Rpb24gKGZhLCBwcmVkaWNhdGVXaXRoSW5kZXgpIHsgcmV0dXJuIHBpcGUoZmEsIGZpbHRlcldpdGhJbmRleChwcmVkaWNhdGVXaXRoSW5kZXgpKTsgfTtcbnZhciBfZXh0ZW5kID0gZnVuY3Rpb24gKGZhLCBmKSB7IHJldHVybiBwaXBlKGZhLCBleHRlbmQoZikpOyB9O1xudmFyIF90cmF2ZXJzZSA9IGZ1bmN0aW9uIChGKSB7XG4gICAgdmFyIHRyYXZlcnNlRiA9IHRyYXZlcnNlKEYpO1xuICAgIHJldHVybiBmdW5jdGlvbiAodGEsIGYpIHsgcmV0dXJuIHBpcGUodGEsIHRyYXZlcnNlRihmKSk7IH07XG59O1xuLyogaXN0YW5idWwgaWdub3JlIG5leHQgKi9cbnZhciBfdHJhdmVyc2VXaXRoSW5kZXggPSBmdW5jdGlvbiAoRikge1xuICAgIHZhciB0cmF2ZXJzZVdpdGhJbmRleEYgPSB0cmF2ZXJzZVdpdGhJbmRleChGKTtcbiAgICByZXR1cm4gZnVuY3Rpb24gKHRhLCBmKSB7IHJldHVybiBwaXBlKHRhLCB0cmF2ZXJzZVdpdGhJbmRleEYoZikpOyB9O1xufTtcbi8qKiBAaW50ZXJuYWwgKi9cbmV4cG9ydCB2YXIgX2NoYWluUmVjRGVwdGhGaXJzdCA9IGZ1bmN0aW9uIChhLCBmKSB7IHJldHVybiBwaXBlKGEsIGNoYWluUmVjRGVwdGhGaXJzdChmKSk7IH07XG4vKiogQGludGVybmFsICovXG5leHBvcnQgdmFyIF9jaGFpblJlY0JyZWFkdGhGaXJzdCA9IGZ1bmN0aW9uIChhLCBmKSB7IHJldHVybiBwaXBlKGEsIGNoYWluUmVjQnJlYWR0aEZpcnN0KGYpKTsgfTtcbi8qKlxuICogQGNhdGVnb3J5IGNvbnN0cnVjdG9yc1xuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgb2YgPSBSTkVBLm9mO1xuLyoqXG4gKiBAc2luY2UgMi43LjBcbiAqL1xuZXhwb3J0IHZhciB6ZXJvID0gZnVuY3Rpb24gKCkgeyByZXR1cm4gZW1wdHk7IH07XG4vKipcbiAqIExlc3Mgc3RyaWN0IHZlcnNpb24gb2YgW2BhbHRgXSgjYWx0KS5cbiAqXG4gKiBUaGUgYFdgIHN1ZmZpeCAoc2hvcnQgZm9yICoqVyoqaWRlbmluZykgbWVhbnMgdGhhdCB0aGUgcmV0dXJuIHR5cGVzIHdpbGwgYmUgbWVyZ2VkLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgKiBhcyBSQSBmcm9tICdmcC10cy9SZWFkb25seUFycmF5J1xuICogaW1wb3J0IHsgcGlwZSB9IGZyb20gJ2ZwLXRzL2Z1bmN0aW9uJ1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoXG4gKiAgIHBpcGUoXG4gKiAgICAgWzEsIDIsIDNdLFxuICogICAgIFJBLmFsdFcoKCkgPT4gWydhJywgJ2InXSlcbiAqICAgKSxcbiAqICAgWzEsIDIsIDMsICdhJywgJ2InXVxuICogKVxuICpcbiAqIEBjYXRlZ29yeSBlcnJvciBoYW5kbGluZ1xuICogQHNpbmNlIDIuOS4wXG4gKi9cbmV4cG9ydCB2YXIgYWx0VyA9IGZ1bmN0aW9uICh0aGF0KSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChmYSkge1xuICAgICAgICByZXR1cm4gZmEuY29uY2F0KHRoYXQoKSk7XG4gICAgfTtcbn07XG4vKipcbiAqIElkZW50aWZpZXMgYW4gYXNzb2NpYXRpdmUgb3BlcmF0aW9uIG9uIGEgdHlwZSBjb25zdHJ1Y3Rvci4gSXQgaXMgc2ltaWxhciB0byBgU2VtaWdyb3VwYCwgZXhjZXB0IHRoYXQgaXQgYXBwbGllcyB0b1xuICogdHlwZXMgb2Yga2luZCBgKiAtPiAqYC5cbiAqXG4gKiBJbiBjYXNlIG9mIGBSZWFkb25seUFycmF5YCBjb25jYXRlbmF0ZXMgdGhlIGlucHV0cyBpbnRvIGEgc2luZ2xlIGFycmF5LlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgKiBhcyBSQSBmcm9tICdmcC10cy9SZWFkb25seUFycmF5J1xuICogaW1wb3J0IHsgcGlwZSB9IGZyb20gJ2ZwLXRzL2Z1bmN0aW9uJ1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoXG4gKiAgIHBpcGUoXG4gKiAgICAgWzEsIDIsIDNdLFxuICogICAgIFJBLmFsdCgoKSA9PiBbNCwgNV0pXG4gKiAgICksXG4gKiAgIFsxLCAyLCAzLCA0LCA1XVxuICogKVxuICpcbiAqIEBjYXRlZ29yeSBlcnJvciBoYW5kbGluZ1xuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgYWx0ID0gYWx0Vztcbi8qKlxuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgYXAgPSBmdW5jdGlvbiAoZmEpIHtcbiAgICByZXR1cm4gZmxhdE1hcChmdW5jdGlvbiAoZikgeyByZXR1cm4gcGlwZShmYSwgbWFwKGYpKTsgfSk7XG59O1xuLyoqXG4gKiBDb21wb3NlcyBjb21wdXRhdGlvbnMgaW4gc2VxdWVuY2UsIHVzaW5nIHRoZSByZXR1cm4gdmFsdWUgb2Ygb25lIGNvbXB1dGF0aW9uIHRvIGRldGVybWluZSB0aGUgbmV4dCBjb21wdXRhdGlvbi5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0ICogYXMgUkEgZnJvbSAnZnAtdHMvUmVhZG9ubHlBcnJheSdcbiAqIGltcG9ydCB7IHBpcGUgfSBmcm9tICdmcC10cy9mdW5jdGlvbidcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKFxuICogICBwaXBlKFxuICogICAgIFsxLCAyLCAzXSxcbiAqICAgICBSQS5mbGF0TWFwKChuKSA9PiBbYGEke259YCwgYGIke259YF0pXG4gKiAgICksXG4gKiAgIFsnYTEnLCAnYjEnLCAnYTInLCAnYjInLCAnYTMnLCAnYjMnXVxuICogKVxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChcbiAqICAgcGlwZShcbiAqICAgICBbMSwgMiwgM10sXG4gKiAgICAgUkEuZmxhdE1hcCgoKSA9PiBbXSlcbiAqICAgKSxcbiAqICAgW11cbiAqIClcbiAqXG4gKiBAY2F0ZWdvcnkgc2VxdWVuY2luZ1xuICogQHNpbmNlIDIuMTQuMFxuICovXG5leHBvcnQgdmFyIGZsYXRNYXAgPSAvKiNfX1BVUkVfXyovIGR1YWwoMiwgZnVuY3Rpb24gKG1hLCBmKSB7XG4gICAgcmV0dXJuIHBpcGUobWEsIGNoYWluV2l0aEluZGV4KGZ1bmN0aW9uIChpLCBhKSB7IHJldHVybiBmKGEsIGkpOyB9KSk7XG59KTtcbi8qKlxuICogQGNhdGVnb3J5IHNlcXVlbmNpbmdcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIGZsYXR0ZW4gPSAvKiNfX1BVUkVfXyovIGZsYXRNYXAoaWRlbnRpdHkpO1xuLyoqXG4gKiBgbWFwYCBjYW4gYmUgdXNlZCB0byB0dXJuIGZ1bmN0aW9ucyBgKGE6IEEpID0+IEJgIGludG8gZnVuY3Rpb25zIGAoZmE6IEY8QT4pID0+IEY8Qj5gIHdob3NlIGFyZ3VtZW50IGFuZCByZXR1cm4gdHlwZXNcbiAqIHVzZSB0aGUgdHlwZSBjb25zdHJ1Y3RvciBgRmAgdG8gcmVwcmVzZW50IHNvbWUgY29tcHV0YXRpb25hbCBjb250ZXh0LlxuICpcbiAqIEBjYXRlZ29yeSBtYXBwaW5nXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBtYXAgPSBmdW5jdGlvbiAoZikgeyByZXR1cm4gZnVuY3Rpb24gKGZhKSB7XG4gICAgcmV0dXJuIGZhLm1hcChmdW5jdGlvbiAoYSkgeyByZXR1cm4gZihhKTsgfSk7XG59OyB9O1xuLyoqXG4gKiBAY2F0ZWdvcnkgbWFwcGluZ1xuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgbWFwV2l0aEluZGV4ID0gZnVuY3Rpb24gKGYpIHsgcmV0dXJuIGZ1bmN0aW9uIChmYSkge1xuICAgIHJldHVybiBmYS5tYXAoZnVuY3Rpb24gKGEsIGkpIHsgcmV0dXJuIGYoaSwgYSk7IH0pO1xufTsgfTtcbi8qKlxuICogQGNhdGVnb3J5IGZpbHRlcmluZ1xuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgc2VwYXJhdGUgPSBmdW5jdGlvbiAoZmEpIHtcbiAgICB2YXIgbGVmdCA9IFtdO1xuICAgIHZhciByaWdodCA9IFtdO1xuICAgIGZvciAodmFyIF9pID0gMCwgZmFfMSA9IGZhOyBfaSA8IGZhXzEubGVuZ3RoOyBfaSsrKSB7XG4gICAgICAgIHZhciBlID0gZmFfMVtfaV07XG4gICAgICAgIGlmIChlLl90YWcgPT09ICdMZWZ0Jykge1xuICAgICAgICAgICAgbGVmdC5wdXNoKGUubGVmdCk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICByaWdodC5wdXNoKGUucmlnaHQpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiBzZXBhcmF0ZWQobGVmdCwgcmlnaHQpO1xufTtcbi8qKlxuICogQGNhdGVnb3J5IGZpbHRlcmluZ1xuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgZmlsdGVyID0gZnVuY3Rpb24gKHByZWRpY2F0ZSkge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgcmV0dXJuIGFzLmZpbHRlcihwcmVkaWNhdGUpO1xuICAgIH07XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgZmlsdGVyaW5nXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBmaWx0ZXJNYXBXaXRoSW5kZXggPSBmdW5jdGlvbiAoZikge1xuICAgIHJldHVybiBmdW5jdGlvbiAoZmEpIHtcbiAgICAgICAgdmFyIG91dCA9IFtdO1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGZhLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICB2YXIgb3B0aW9uQiA9IGYoaSwgZmFbaV0pO1xuICAgICAgICAgICAgaWYgKF8uaXNTb21lKG9wdGlvbkIpKSB7XG4gICAgICAgICAgICAgICAgb3V0LnB1c2gob3B0aW9uQi52YWx1ZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG91dDtcbiAgICB9O1xufTtcbi8qKlxuICogQGNhdGVnb3J5IGZpbHRlcmluZ1xuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgZmlsdGVyTWFwID0gZnVuY3Rpb24gKGYpIHtcbiAgICByZXR1cm4gZmlsdGVyTWFwV2l0aEluZGV4KGZ1bmN0aW9uIChfLCBhKSB7IHJldHVybiBmKGEpOyB9KTtcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBmaWx0ZXJpbmdcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIGNvbXBhY3QgPSAvKiNfX1BVUkVfXyovIGZpbHRlck1hcChpZGVudGl0eSk7XG4vKipcbiAqIEBjYXRlZ29yeSBmaWx0ZXJpbmdcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIHBhcnRpdGlvbiA9IGZ1bmN0aW9uIChwcmVkaWNhdGUpIHtcbiAgICByZXR1cm4gcGFydGl0aW9uV2l0aEluZGV4KGZ1bmN0aW9uIChfLCBhKSB7IHJldHVybiBwcmVkaWNhdGUoYSk7IH0pO1xufTtcbi8qKlxuICogQGNhdGVnb3J5IGZpbHRlcmluZ1xuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgcGFydGl0aW9uV2l0aEluZGV4ID0gZnVuY3Rpb24gKHByZWRpY2F0ZVdpdGhJbmRleCkge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgdmFyIGxlZnQgPSBbXTtcbiAgICAgICAgdmFyIHJpZ2h0ID0gW107XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgYXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIHZhciBhID0gYXNbaV07XG4gICAgICAgICAgICBpZiAocHJlZGljYXRlV2l0aEluZGV4KGksIGEpKSB7XG4gICAgICAgICAgICAgICAgcmlnaHQucHVzaChhKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIGxlZnQucHVzaChhKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gc2VwYXJhdGVkKGxlZnQsIHJpZ2h0KTtcbiAgICB9O1xufTtcbi8qKlxuICogQGNhdGVnb3J5IGZpbHRlcmluZ1xuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgcGFydGl0aW9uTWFwID0gZnVuY3Rpb24gKGYpIHtcbiAgICByZXR1cm4gcGFydGl0aW9uTWFwV2l0aEluZGV4KGZ1bmN0aW9uIChfLCBhKSB7IHJldHVybiBmKGEpOyB9KTtcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBmaWx0ZXJpbmdcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIHBhcnRpdGlvbk1hcFdpdGhJbmRleCA9IGZ1bmN0aW9uIChmKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChmYSkge1xuICAgICAgICB2YXIgbGVmdCA9IFtdO1xuICAgICAgICB2YXIgcmlnaHQgPSBbXTtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBmYS5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgdmFyIGUgPSBmKGksIGZhW2ldKTtcbiAgICAgICAgICAgIGlmIChlLl90YWcgPT09ICdMZWZ0Jykge1xuICAgICAgICAgICAgICAgIGxlZnQucHVzaChlLmxlZnQpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgcmlnaHQucHVzaChlLnJpZ2h0KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gc2VwYXJhdGVkKGxlZnQsIHJpZ2h0KTtcbiAgICB9O1xufTtcbi8qKlxuICogQGNhdGVnb3J5IGZpbHRlcmluZ1xuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgZmlsdGVyV2l0aEluZGV4ID0gZnVuY3Rpb24gKHByZWRpY2F0ZVdpdGhJbmRleCkge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgcmV0dXJuIGFzLmZpbHRlcihmdW5jdGlvbiAoYSwgaSkgeyByZXR1cm4gcHJlZGljYXRlV2l0aEluZGV4KGksIGEpOyB9KTtcbiAgICB9O1xufTtcbi8qKlxuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgZXh0ZW5kID0gZnVuY3Rpb24gKGYpIHsgcmV0dXJuIGZ1bmN0aW9uICh3YSkge1xuICAgIHJldHVybiB3YS5tYXAoZnVuY3Rpb24gKF8sIGkpIHsgcmV0dXJuIGYod2Euc2xpY2UoaSkpOyB9KTtcbn07IH07XG4vKipcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIGR1cGxpY2F0ZSA9IC8qI19fUFVSRV9fKi8gZXh0ZW5kKGlkZW50aXR5KTtcbi8qKlxuICogQGNhdGVnb3J5IGZvbGRpbmdcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIGZvbGRNYXBXaXRoSW5kZXggPSBmdW5jdGlvbiAoTSkge1xuICAgIHJldHVybiBmdW5jdGlvbiAoZikge1xuICAgICAgICByZXR1cm4gZnVuY3Rpb24gKGZhKSB7XG4gICAgICAgICAgICByZXR1cm4gZmEucmVkdWNlKGZ1bmN0aW9uIChiLCBhLCBpKSB7IHJldHVybiBNLmNvbmNhdChiLCBmKGksIGEpKTsgfSwgTS5lbXB0eSk7XG4gICAgICAgIH07XG4gICAgfTtcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBmb2xkaW5nXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciByZWR1Y2UgPSBmdW5jdGlvbiAoYiwgZikge1xuICAgIHJldHVybiByZWR1Y2VXaXRoSW5kZXgoYiwgZnVuY3Rpb24gKF8sIGIsIGEpIHsgcmV0dXJuIGYoYiwgYSk7IH0pO1xufTtcbi8qKlxuICogQGNhdGVnb3J5IGZvbGRpbmdcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIGZvbGRNYXAgPSBmdW5jdGlvbiAoTSkge1xuICAgIHZhciBmb2xkTWFwV2l0aEluZGV4TSA9IGZvbGRNYXBXaXRoSW5kZXgoTSk7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChmKSB7IHJldHVybiBmb2xkTWFwV2l0aEluZGV4TShmdW5jdGlvbiAoXywgYSkgeyByZXR1cm4gZihhKTsgfSk7IH07XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgZm9sZGluZ1xuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgcmVkdWNlV2l0aEluZGV4ID0gZnVuY3Rpb24gKGIsIGYpIHsgcmV0dXJuIGZ1bmN0aW9uIChmYSkge1xuICAgIHZhciBsZW4gPSBmYS5sZW5ndGg7XG4gICAgdmFyIG91dCA9IGI7XG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBsZW47IGkrKykge1xuICAgICAgICBvdXQgPSBmKGksIG91dCwgZmFbaV0pO1xuICAgIH1cbiAgICByZXR1cm4gb3V0O1xufTsgfTtcbi8qKlxuICogQGNhdGVnb3J5IGZvbGRpbmdcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIHJlZHVjZVJpZ2h0ID0gZnVuY3Rpb24gKGIsIGYpIHtcbiAgICByZXR1cm4gcmVkdWNlUmlnaHRXaXRoSW5kZXgoYiwgZnVuY3Rpb24gKF8sIGEsIGIpIHsgcmV0dXJuIGYoYSwgYik7IH0pO1xufTtcbi8qKlxuICogQGNhdGVnb3J5IGZvbGRpbmdcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIHJlZHVjZVJpZ2h0V2l0aEluZGV4ID0gZnVuY3Rpb24gKGIsIGYpIHsgcmV0dXJuIGZ1bmN0aW9uIChmYSkge1xuICAgIHJldHVybiBmYS5yZWR1Y2VSaWdodChmdW5jdGlvbiAoYiwgYSwgaSkgeyByZXR1cm4gZihpLCBhLCBiKTsgfSwgYik7XG59OyB9O1xuLyoqXG4gKiBAY2F0ZWdvcnkgdHJhdmVyc2luZ1xuICogQHNpbmNlIDIuNi4zXG4gKi9cbmV4cG9ydCB2YXIgdHJhdmVyc2UgPSBmdW5jdGlvbiAoRikge1xuICAgIHZhciB0cmF2ZXJzZVdpdGhJbmRleEYgPSB0cmF2ZXJzZVdpdGhJbmRleChGKTtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGYpIHsgcmV0dXJuIHRyYXZlcnNlV2l0aEluZGV4RihmdW5jdGlvbiAoXywgYSkgeyByZXR1cm4gZihhKTsgfSk7IH07XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgdHJhdmVyc2luZ1xuICogQHNpbmNlIDIuNi4zXG4gKi9cbmV4cG9ydCB2YXIgc2VxdWVuY2UgPSBmdW5jdGlvbiAoRikge1xuICAgIHJldHVybiBmdW5jdGlvbiAodGEpIHtcbiAgICAgICAgcmV0dXJuIF9yZWR1Y2UodGEsIEYub2YoemVybygpKSwgZnVuY3Rpb24gKGZhcywgZmEpIHtcbiAgICAgICAgICAgIHJldHVybiBGLmFwKEYubWFwKGZhcywgZnVuY3Rpb24gKGFzKSB7IHJldHVybiBmdW5jdGlvbiAoYSkgeyByZXR1cm4gcGlwZShhcywgYXBwZW5kKGEpKTsgfTsgfSksIGZhKTtcbiAgICAgICAgfSk7XG4gICAgfTtcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBzZXF1ZW5jaW5nXG4gKiBAc2luY2UgMi42LjNcbiAqL1xuZXhwb3J0IHZhciB0cmF2ZXJzZVdpdGhJbmRleCA9IGZ1bmN0aW9uIChGKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChmKSB7XG4gICAgICAgIHJldHVybiByZWR1Y2VXaXRoSW5kZXgoRi5vZih6ZXJvKCkpLCBmdW5jdGlvbiAoaSwgZmJzLCBhKSB7XG4gICAgICAgICAgICByZXR1cm4gRi5hcChGLm1hcChmYnMsIGZ1bmN0aW9uIChicykgeyByZXR1cm4gZnVuY3Rpb24gKGIpIHsgcmV0dXJuIHBpcGUoYnMsIGFwcGVuZChiKSk7IH07IH0pLCBmKGksIGEpKTtcbiAgICAgICAgfSk7XG4gICAgfTtcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBmaWx0ZXJpbmdcbiAqIEBzaW5jZSAyLjYuNVxuICovXG5leHBvcnQgdmFyIHdpdGhlciA9IGZ1bmN0aW9uIChGKSB7XG4gICAgdmFyIF93aXRoZXJGID0gX3dpdGhlcihGKTtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGYpIHsgcmV0dXJuIGZ1bmN0aW9uIChmYSkgeyByZXR1cm4gX3dpdGhlckYoZmEsIGYpOyB9OyB9O1xufTtcbi8qKlxuICogQGNhdGVnb3J5IGZpbHRlcmluZ1xuICogQHNpbmNlIDIuNi41XG4gKi9cbmV4cG9ydCB2YXIgd2lsdCA9IGZ1bmN0aW9uIChGKSB7XG4gICAgdmFyIF93aWx0RiA9IF93aWx0KEYpO1xuICAgIHJldHVybiBmdW5jdGlvbiAoZikgeyByZXR1cm4gZnVuY3Rpb24gKGZhKSB7IHJldHVybiBfd2lsdEYoZmEsIGYpOyB9OyB9O1xufTtcbi8qKlxuICogQHNpbmNlIDIuNi42XG4gKi9cbmV4cG9ydCB2YXIgdW5mb2xkID0gZnVuY3Rpb24gKGIsIGYpIHtcbiAgICB2YXIgb3V0ID0gW107XG4gICAgdmFyIGJiID0gYjtcbiAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tY29uc3RhbnQtY29uZGl0aW9uXG4gICAgd2hpbGUgKHRydWUpIHtcbiAgICAgICAgdmFyIG10ID0gZihiYik7XG4gICAgICAgIGlmIChfLmlzU29tZShtdCkpIHtcbiAgICAgICAgICAgIHZhciBfYSA9IG10LnZhbHVlLCBhID0gX2FbMF0sIGJfMSA9IF9hWzFdO1xuICAgICAgICAgICAgb3V0LnB1c2goYSk7XG4gICAgICAgICAgICBiYiA9IGJfMTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiBvdXQ7XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgdHlwZSBsYW1iZGFzXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBVUkkgPSAnUmVhZG9ubHlBcnJheSc7XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIGdldFNob3cgPSBmdW5jdGlvbiAoUykgeyByZXR1cm4gKHtcbiAgICBzaG93OiBmdW5jdGlvbiAoYXMpIHsgcmV0dXJuIFwiW1wiLmNvbmNhdChhcy5tYXAoUy5zaG93KS5qb2luKCcsICcpLCBcIl1cIik7IH1cbn0pOyB9O1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBnZXRTZW1pZ3JvdXAgPSBmdW5jdGlvbiAoKSB7IHJldHVybiAoe1xuICAgIGNvbmNhdDogZnVuY3Rpb24gKGZpcnN0LCBzZWNvbmQpIHsgcmV0dXJuIChpc0VtcHR5KGZpcnN0KSA/IHNlY29uZCA6IGlzRW1wdHkoc2Vjb25kKSA/IGZpcnN0IDogZmlyc3QuY29uY2F0KHNlY29uZCkpOyB9XG59KTsgfTtcbi8qKlxuICogUmV0dXJucyBhIGBNb25vaWRgIGZvciBgUmVhZG9ubHlBcnJheTxBPmAuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IGdldE1vbm9pZCB9IGZyb20gJ2ZwLXRzL1JlYWRvbmx5QXJyYXknXG4gKlxuICogY29uc3QgTSA9IGdldE1vbm9pZDxudW1iZXI+KClcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoTS5jb25jYXQoWzEsIDJdLCBbMywgNF0pLCBbMSwgMiwgMywgNF0pXG4gKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgZ2V0TW9ub2lkID0gZnVuY3Rpb24gKCkgeyByZXR1cm4gKHtcbiAgICBjb25jYXQ6IGdldFNlbWlncm91cCgpLmNvbmNhdCxcbiAgICBlbXB0eTogZW1wdHlcbn0pOyB9O1xuLyoqXG4gKiBEZXJpdmVzIGFuIGBFcWAgb3ZlciB0aGUgYFJlYWRvbmx5QXJyYXlgIG9mIGEgZ2l2ZW4gZWxlbWVudCB0eXBlIGZyb20gdGhlIGBFcWAgb2YgdGhhdCB0eXBlLiBUaGUgZGVyaXZlZCBgRXFgIGRlZmluZXMgdHdvXG4gKiBhcnJheXMgYXMgZXF1YWwgaWYgYWxsIGVsZW1lbnRzIG9mIGJvdGggYXJyYXlzIGFyZSBjb21wYXJlZCBlcXVhbCBwYWlyd2lzZSB3aXRoIHRoZSBnaXZlbiBgRWAuIEluIGNhc2Ugb2YgYXJyYXlzIG9mXG4gKiBkaWZmZXJlbnQgbGVuZ3RocywgdGhlIHJlc3VsdCBpcyBub24gZXF1YWxpdHkuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCAqIGFzIFMgZnJvbSAnZnAtdHMvc3RyaW5nJ1xuICogaW1wb3J0IHsgZ2V0RXEgfSBmcm9tICdmcC10cy9SZWFkb25seUFycmF5J1xuICpcbiAqIGNvbnN0IEUgPSBnZXRFcShTLkVxKVxuICogYXNzZXJ0LnN0cmljdEVxdWFsKEUuZXF1YWxzKFsnYScsICdiJ10sIFsnYScsICdiJ10pLCB0cnVlKVxuICogYXNzZXJ0LnN0cmljdEVxdWFsKEUuZXF1YWxzKFsnYSddLCBbXSksIGZhbHNlKVxuICpcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIGdldEVxID0gZnVuY3Rpb24gKEUpIHtcbiAgICByZXR1cm4gZnJvbUVxdWFscyhmdW5jdGlvbiAoeHMsIHlzKSB7IHJldHVybiB4cy5sZW5ndGggPT09IHlzLmxlbmd0aCAmJiB4cy5ldmVyeShmdW5jdGlvbiAoeCwgaSkgeyByZXR1cm4gRS5lcXVhbHMoeCwgeXNbaV0pOyB9KTsgfSk7XG59O1xuLyoqXG4gKiBEZXJpdmVzIGFuIGBPcmRgIG92ZXIgdGhlIGBSZWFkb25seUFycmF5YCBvZiBhIGdpdmVuIGVsZW1lbnQgdHlwZSBmcm9tIHRoZSBgT3JkYCBvZiB0aGF0IHR5cGUuIFRoZSBvcmRlcmluZyBiZXR3ZWVuIHR3byBzdWNoXG4gKiBhcnJheXMgaXMgZXF1YWwgdG86IHRoZSBmaXJzdCBub24gZXF1YWwgY29tcGFyaXNvbiBvZiBlYWNoIGFycmF5cyBlbGVtZW50cyB0YWtlbiBwYWlyd2lzZSBpbiBpbmNyZWFzaW5nIG9yZGVyLCBpblxuICogY2FzZSBvZiBlcXVhbGl0eSBvdmVyIGFsbCB0aGUgcGFpcndpc2UgZWxlbWVudHM7IHRoZSBsb25nZXN0IGFycmF5IGlzIGNvbnNpZGVyZWQgdGhlIGdyZWF0ZXN0LCBpZiBib3RoIGFycmF5cyBoYXZlXG4gKiB0aGUgc2FtZSBsZW5ndGgsIHRoZSByZXN1bHQgaXMgZXF1YWxpdHkuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IGdldE9yZCB9IGZyb20gJ2ZwLXRzL1JlYWRvbmx5QXJyYXknXG4gKiBpbXBvcnQgKiBhcyBTIGZyb20gJ2ZwLXRzL3N0cmluZydcbiAqXG4gKiBjb25zdCBPID0gZ2V0T3JkKFMuT3JkKVxuICogYXNzZXJ0LnN0cmljdEVxdWFsKE8uY29tcGFyZShbJ2InXSwgWydhJ10pLCAxKVxuICogYXNzZXJ0LnN0cmljdEVxdWFsKE8uY29tcGFyZShbJ2EnXSwgWydhJ10pLCAwKVxuICogYXNzZXJ0LnN0cmljdEVxdWFsKE8uY29tcGFyZShbJ2EnXSwgWydiJ10pLCAtMSlcbiAqXG4gKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgZ2V0T3JkID0gZnVuY3Rpb24gKE8pIHtcbiAgICByZXR1cm4gZnJvbUNvbXBhcmUoZnVuY3Rpb24gKGEsIGIpIHtcbiAgICAgICAgdmFyIGFMZW4gPSBhLmxlbmd0aDtcbiAgICAgICAgdmFyIGJMZW4gPSBiLmxlbmd0aDtcbiAgICAgICAgdmFyIGxlbiA9IE1hdGgubWluKGFMZW4sIGJMZW4pO1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGxlbjsgaSsrKSB7XG4gICAgICAgICAgICB2YXIgb3JkZXJpbmcgPSBPLmNvbXBhcmUoYVtpXSwgYltpXSk7XG4gICAgICAgICAgICBpZiAob3JkZXJpbmcgIT09IDApIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gb3JkZXJpbmc7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIE4uT3JkLmNvbXBhcmUoYUxlbiwgYkxlbik7XG4gICAgfSk7XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi4xMS4wXG4gKi9cbmV4cG9ydCB2YXIgZ2V0VW5pb25TZW1pZ3JvdXAgPSBmdW5jdGlvbiAoRSkge1xuICAgIHZhciB1bmlvbkUgPSB1bmlvbihFKTtcbiAgICByZXR1cm4ge1xuICAgICAgICBjb25jYXQ6IGZ1bmN0aW9uIChmaXJzdCwgc2Vjb25kKSB7IHJldHVybiB1bmlvbkUoc2Vjb25kKShmaXJzdCk7IH1cbiAgICB9O1xufTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIGdldFVuaW9uTW9ub2lkID0gZnVuY3Rpb24gKEUpIHsgcmV0dXJuICh7XG4gICAgY29uY2F0OiBnZXRVbmlvblNlbWlncm91cChFKS5jb25jYXQsXG4gICAgZW1wdHk6IGVtcHR5XG59KTsgfTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIGdldEludGVyc2VjdGlvblNlbWlncm91cCA9IGZ1bmN0aW9uIChFKSB7XG4gICAgdmFyIGludGVyc2VjdGlvbkUgPSBpbnRlcnNlY3Rpb24oRSk7XG4gICAgcmV0dXJuIHtcbiAgICAgICAgY29uY2F0OiBmdW5jdGlvbiAoZmlyc3QsIHNlY29uZCkgeyByZXR1cm4gaW50ZXJzZWN0aW9uRShzZWNvbmQpKGZpcnN0KTsgfVxuICAgIH07XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi4xMS4wXG4gKi9cbmV4cG9ydCB2YXIgZ2V0RGlmZmVyZW5jZU1hZ21hID0gZnVuY3Rpb24gKEUpIHtcbiAgICB2YXIgZGlmZmVyZW5jZUUgPSBkaWZmZXJlbmNlKEUpO1xuICAgIHJldHVybiB7XG4gICAgICAgIGNvbmNhdDogZnVuY3Rpb24gKGZpcnN0LCBzZWNvbmQpIHsgcmV0dXJuIGRpZmZlcmVuY2VFKHNlY29uZCkoZmlyc3QpOyB9XG4gICAgfTtcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjcuMFxuICovXG5leHBvcnQgdmFyIEZ1bmN0b3IgPSB7XG4gICAgVVJJOiBVUkksXG4gICAgbWFwOiBfbWFwXG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgbWFwcGluZ1xuICogQHNpbmNlIDIuMTAuMFxuICovXG5leHBvcnQgdmFyIGZsYXAgPSAvKiNfX1BVUkVfXyovIGZsYXBfKEZ1bmN0b3IpO1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi4xMC4wXG4gKi9cbmV4cG9ydCB2YXIgUG9pbnRlZCA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICBvZjogb2Zcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjcuMFxuICovXG5leHBvcnQgdmFyIEZ1bmN0b3JXaXRoSW5kZXggPSB7XG4gICAgVVJJOiBVUkksXG4gICAgbWFwOiBfbWFwLFxuICAgIG1hcFdpdGhJbmRleDogX21hcFdpdGhJbmRleFxufTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuMTAuMFxuICovXG5leHBvcnQgdmFyIEFwcGx5ID0ge1xuICAgIFVSSTogVVJJLFxuICAgIG1hcDogX21hcCxcbiAgICBhcDogX2FwXG59O1xuLyoqXG4gKiBDb21iaW5lIHR3byBlZmZlY3RmdWwgYWN0aW9ucywga2VlcGluZyBvbmx5IHRoZSByZXN1bHQgb2YgdGhlIGZpcnN0LlxuICpcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIGFwRmlyc3QgPSAvKiNfX1BVUkVfXyovIGFwRmlyc3RfKEFwcGx5KTtcbi8qKlxuICogQ29tYmluZSB0d28gZWZmZWN0ZnVsIGFjdGlvbnMsIGtlZXBpbmcgb25seSB0aGUgcmVzdWx0IG9mIHRoZSBzZWNvbmQuXG4gKlxuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgYXBTZWNvbmQgPSAvKiNfX1BVUkVfXyovIGFwU2Vjb25kXyhBcHBseSk7XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjcuMFxuICovXG5leHBvcnQgdmFyIEFwcGxpY2F0aXZlID0ge1xuICAgIFVSSTogVVJJLFxuICAgIG1hcDogX21hcCxcbiAgICBhcDogX2FwLFxuICAgIG9mOiBvZlxufTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuMTAuMFxuICovXG5leHBvcnQgdmFyIENoYWluID0ge1xuICAgIFVSSTogVVJJLFxuICAgIG1hcDogX21hcCxcbiAgICBhcDogX2FwLFxuICAgIGNoYWluOiBmbGF0TWFwXG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi43LjBcbiAqL1xuZXhwb3J0IHZhciBNb25hZCA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICBtYXA6IF9tYXAsXG4gICAgYXA6IF9hcCxcbiAgICBvZjogb2YsXG4gICAgY2hhaW46IGZsYXRNYXBcbn07XG4vKipcbiAqIENvbXBvc2VzIGNvbXB1dGF0aW9ucyBpbiBzZXF1ZW5jZSwgdXNpbmcgdGhlIHJldHVybiB2YWx1ZSBvZiBvbmUgY29tcHV0YXRpb24gdG8gZGV0ZXJtaW5lIHRoZSBuZXh0IGNvbXB1dGF0aW9uIGFuZFxuICoga2VlcGluZyBvbmx5IHRoZSByZXN1bHQgb2YgdGhlIGZpcnN0LlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgKiBhcyBSQSBmcm9tICdmcC10cy9SZWFkb25seUFycmF5J1xuICogaW1wb3J0IHsgcGlwZSB9IGZyb20gJ2ZwLXRzL2Z1bmN0aW9uJ1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoXG4gKiAgIHBpcGUoXG4gKiAgICAgWzEsIDIsIDNdLFxuICogICAgIFJBLmNoYWluRmlyc3QoKCkgPT4gWydhJywgJ2InXSlcbiAqICAgKSxcbiAqICAgWzEsIDEsIDIsIDIsIDMsIDNdXG4gKiApXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKFxuICogICBwaXBlKFxuICogICAgIFsxLCAyLCAzXSxcbiAqICAgICBSQS5jaGFpbkZpcnN0KCgpID0+IFtdKVxuICogICApLFxuICogICBbXVxuICogKVxuICpcbiAqIEBjYXRlZ29yeSBzZXF1ZW5jaW5nXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBjaGFpbkZpcnN0ID0gXG4vKiNfX1BVUkVfXyovIGNoYWluRmlyc3RfKENoYWluKTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuNy4wXG4gKi9cbmV4cG9ydCB2YXIgVW5mb2xkYWJsZSA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICB1bmZvbGQ6IHVuZm9sZFxufTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuNy4wXG4gKi9cbmV4cG9ydCB2YXIgQWx0ID0ge1xuICAgIFVSSTogVVJJLFxuICAgIG1hcDogX21hcCxcbiAgICBhbHQ6IF9hbHRcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjExLjBcbiAqL1xuZXhwb3J0IHZhciBaZXJvID0ge1xuICAgIFVSSTogVVJJLFxuICAgIHplcm86IHplcm9cbn07XG4vKipcbiAqIEBjYXRlZ29yeSBkbyBub3RhdGlvblxuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIGd1YXJkID0gLyojX19QVVJFX18qLyBndWFyZF8oWmVybywgUG9pbnRlZCk7XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjcuMFxuICovXG5leHBvcnQgdmFyIEFsdGVybmF0aXZlID0ge1xuICAgIFVSSTogVVJJLFxuICAgIG1hcDogX21hcCxcbiAgICBhcDogX2FwLFxuICAgIG9mOiBvZixcbiAgICBhbHQ6IF9hbHQsXG4gICAgemVybzogemVyb1xufTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuNy4wXG4gKi9cbmV4cG9ydCB2YXIgRXh0ZW5kID0ge1xuICAgIFVSSTogVVJJLFxuICAgIG1hcDogX21hcCxcbiAgICBleHRlbmQ6IF9leHRlbmRcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjcuMFxuICovXG5leHBvcnQgdmFyIENvbXBhY3RhYmxlID0ge1xuICAgIFVSSTogVVJJLFxuICAgIGNvbXBhY3Q6IGNvbXBhY3QsXG4gICAgc2VwYXJhdGU6IHNlcGFyYXRlXG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi43LjBcbiAqL1xuZXhwb3J0IHZhciBGaWx0ZXJhYmxlID0ge1xuICAgIFVSSTogVVJJLFxuICAgIG1hcDogX21hcCxcbiAgICBjb21wYWN0OiBjb21wYWN0LFxuICAgIHNlcGFyYXRlOiBzZXBhcmF0ZSxcbiAgICBmaWx0ZXI6IF9maWx0ZXIsXG4gICAgZmlsdGVyTWFwOiBfZmlsdGVyTWFwLFxuICAgIHBhcnRpdGlvbjogX3BhcnRpdGlvbixcbiAgICBwYXJ0aXRpb25NYXA6IF9wYXJ0aXRpb25NYXBcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjcuMFxuICovXG5leHBvcnQgdmFyIEZpbHRlcmFibGVXaXRoSW5kZXggPSB7XG4gICAgVVJJOiBVUkksXG4gICAgbWFwOiBfbWFwLFxuICAgIG1hcFdpdGhJbmRleDogX21hcFdpdGhJbmRleCxcbiAgICBjb21wYWN0OiBjb21wYWN0LFxuICAgIHNlcGFyYXRlOiBzZXBhcmF0ZSxcbiAgICBmaWx0ZXI6IF9maWx0ZXIsXG4gICAgZmlsdGVyTWFwOiBfZmlsdGVyTWFwLFxuICAgIHBhcnRpdGlvbjogX3BhcnRpdGlvbixcbiAgICBwYXJ0aXRpb25NYXA6IF9wYXJ0aXRpb25NYXAsXG4gICAgcGFydGl0aW9uTWFwV2l0aEluZGV4OiBfcGFydGl0aW9uTWFwV2l0aEluZGV4LFxuICAgIHBhcnRpdGlvbldpdGhJbmRleDogX3BhcnRpdGlvbldpdGhJbmRleCxcbiAgICBmaWx0ZXJNYXBXaXRoSW5kZXg6IF9maWx0ZXJNYXBXaXRoSW5kZXgsXG4gICAgZmlsdGVyV2l0aEluZGV4OiBfZmlsdGVyV2l0aEluZGV4XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi43LjBcbiAqL1xuZXhwb3J0IHZhciBGb2xkYWJsZSA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICByZWR1Y2U6IF9yZWR1Y2UsXG4gICAgZm9sZE1hcDogX2ZvbGRNYXAsXG4gICAgcmVkdWNlUmlnaHQ6IF9yZWR1Y2VSaWdodFxufTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuNy4wXG4gKi9cbmV4cG9ydCB2YXIgRm9sZGFibGVXaXRoSW5kZXggPSB7XG4gICAgVVJJOiBVUkksXG4gICAgcmVkdWNlOiBfcmVkdWNlLFxuICAgIGZvbGRNYXA6IF9mb2xkTWFwLFxuICAgIHJlZHVjZVJpZ2h0OiBfcmVkdWNlUmlnaHQsXG4gICAgcmVkdWNlV2l0aEluZGV4OiBfcmVkdWNlV2l0aEluZGV4LFxuICAgIGZvbGRNYXBXaXRoSW5kZXg6IF9mb2xkTWFwV2l0aEluZGV4LFxuICAgIHJlZHVjZVJpZ2h0V2l0aEluZGV4OiBfcmVkdWNlUmlnaHRXaXRoSW5kZXhcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjcuMFxuICovXG5leHBvcnQgdmFyIFRyYXZlcnNhYmxlID0ge1xuICAgIFVSSTogVVJJLFxuICAgIG1hcDogX21hcCxcbiAgICByZWR1Y2U6IF9yZWR1Y2UsXG4gICAgZm9sZE1hcDogX2ZvbGRNYXAsXG4gICAgcmVkdWNlUmlnaHQ6IF9yZWR1Y2VSaWdodCxcbiAgICB0cmF2ZXJzZTogX3RyYXZlcnNlLFxuICAgIHNlcXVlbmNlOiBzZXF1ZW5jZVxufTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuNy4wXG4gKi9cbmV4cG9ydCB2YXIgVHJhdmVyc2FibGVXaXRoSW5kZXggPSB7XG4gICAgVVJJOiBVUkksXG4gICAgbWFwOiBfbWFwLFxuICAgIG1hcFdpdGhJbmRleDogX21hcFdpdGhJbmRleCxcbiAgICByZWR1Y2U6IF9yZWR1Y2UsXG4gICAgZm9sZE1hcDogX2ZvbGRNYXAsXG4gICAgcmVkdWNlUmlnaHQ6IF9yZWR1Y2VSaWdodCxcbiAgICByZWR1Y2VXaXRoSW5kZXg6IF9yZWR1Y2VXaXRoSW5kZXgsXG4gICAgZm9sZE1hcFdpdGhJbmRleDogX2ZvbGRNYXBXaXRoSW5kZXgsXG4gICAgcmVkdWNlUmlnaHRXaXRoSW5kZXg6IF9yZWR1Y2VSaWdodFdpdGhJbmRleCxcbiAgICB0cmF2ZXJzZTogX3RyYXZlcnNlLFxuICAgIHNlcXVlbmNlOiBzZXF1ZW5jZSxcbiAgICB0cmF2ZXJzZVdpdGhJbmRleDogX3RyYXZlcnNlV2l0aEluZGV4XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgc2VxdWVuY2luZ1xuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIGNoYWluUmVjRGVwdGhGaXJzdCA9IGZ1bmN0aW9uIChmKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhKSB7XG4gICAgICAgIHZhciB0b2RvID0gX19zcHJlYWRBcnJheShbXSwgZihhKSwgdHJ1ZSk7XG4gICAgICAgIHZhciBvdXQgPSBbXTtcbiAgICAgICAgd2hpbGUgKHRvZG8ubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgdmFyIGUgPSB0b2RvLnNoaWZ0KCk7XG4gICAgICAgICAgICBpZiAoXy5pc0xlZnQoZSkpIHtcbiAgICAgICAgICAgICAgICB0b2RvLnVuc2hpZnQuYXBwbHkodG9kbywgZihlLmxlZnQpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIG91dC5wdXNoKGUucmlnaHQpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBvdXQ7XG4gICAgfTtcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjExLjBcbiAqL1xuZXhwb3J0IHZhciBDaGFpblJlY0RlcHRoRmlyc3QgPSB7XG4gICAgVVJJOiBVUkksXG4gICAgbWFwOiBfbWFwLFxuICAgIGFwOiBfYXAsXG4gICAgY2hhaW46IGZsYXRNYXAsXG4gICAgY2hhaW5SZWM6IF9jaGFpblJlY0RlcHRoRmlyc3Rcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBzZXF1ZW5jaW5nXG4gKiBAc2luY2UgMi4xMS4wXG4gKi9cbmV4cG9ydCB2YXIgY2hhaW5SZWNCcmVhZHRoRmlyc3QgPSBmdW5jdGlvbiAoZikge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYSkge1xuICAgICAgICB2YXIgaW5pdGlhbCA9IGYoYSk7XG4gICAgICAgIHZhciB0b2RvID0gW107XG4gICAgICAgIHZhciBvdXQgPSBbXTtcbiAgICAgICAgZnVuY3Rpb24gZ28oZSkge1xuICAgICAgICAgICAgaWYgKF8uaXNMZWZ0KGUpKSB7XG4gICAgICAgICAgICAgICAgZihlLmxlZnQpLmZvckVhY2goZnVuY3Rpb24gKHYpIHsgcmV0dXJuIHRvZG8ucHVzaCh2KTsgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBvdXQucHVzaChlLnJpZ2h0KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBmb3IgKHZhciBfaSA9IDAsIGluaXRpYWxfMSA9IGluaXRpYWw7IF9pIDwgaW5pdGlhbF8xLmxlbmd0aDsgX2krKykge1xuICAgICAgICAgICAgdmFyIGUgPSBpbml0aWFsXzFbX2ldO1xuICAgICAgICAgICAgZ28oZSk7XG4gICAgICAgIH1cbiAgICAgICAgd2hpbGUgKHRvZG8ubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgZ28odG9kby5zaGlmdCgpKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gb3V0O1xuICAgIH07XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi4xMS4wXG4gKi9cbmV4cG9ydCB2YXIgQ2hhaW5SZWNCcmVhZHRoRmlyc3QgPSB7XG4gICAgVVJJOiBVUkksXG4gICAgbWFwOiBfbWFwLFxuICAgIGFwOiBfYXAsXG4gICAgY2hhaW46IGZsYXRNYXAsXG4gICAgY2hhaW5SZWM6IF9jaGFpblJlY0JyZWFkdGhGaXJzdFxufTtcbnZhciBfd2l0aGVyID0gLyojX19QVVJFX18qLyB3aXRoZXJEZWZhdWx0KFRyYXZlcnNhYmxlLCBDb21wYWN0YWJsZSk7XG52YXIgX3dpbHQgPSAvKiNfX1BVUkVfXyovIHdpbHREZWZhdWx0KFRyYXZlcnNhYmxlLCBDb21wYWN0YWJsZSk7XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjcuMFxuICovXG5leHBvcnQgdmFyIFdpdGhlcmFibGUgPSB7XG4gICAgVVJJOiBVUkksXG4gICAgbWFwOiBfbWFwLFxuICAgIGNvbXBhY3Q6IGNvbXBhY3QsXG4gICAgc2VwYXJhdGU6IHNlcGFyYXRlLFxuICAgIGZpbHRlcjogX2ZpbHRlcixcbiAgICBmaWx0ZXJNYXA6IF9maWx0ZXJNYXAsXG4gICAgcGFydGl0aW9uOiBfcGFydGl0aW9uLFxuICAgIHBhcnRpdGlvbk1hcDogX3BhcnRpdGlvbk1hcCxcbiAgICByZWR1Y2U6IF9yZWR1Y2UsXG4gICAgZm9sZE1hcDogX2ZvbGRNYXAsXG4gICAgcmVkdWNlUmlnaHQ6IF9yZWR1Y2VSaWdodCxcbiAgICB0cmF2ZXJzZTogX3RyYXZlcnNlLFxuICAgIHNlcXVlbmNlOiBzZXF1ZW5jZSxcbiAgICB3aXRoZXI6IF93aXRoZXIsXG4gICAgd2lsdDogX3dpbHRcbn07XG4vKipcbiAqIEZpbHRlciB2YWx1ZXMgaW5zaWRlIGEgY29udGV4dC5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgcGlwZSB9IGZyb20gJ2ZwLXRzL2Z1bmN0aW9uJ1xuICogaW1wb3J0ICogYXMgUkEgZnJvbSAnZnAtdHMvUmVhZG9ubHlBcnJheSdcbiAqIGltcG9ydCAqIGFzIFQgZnJvbSAnZnAtdHMvVGFzaydcbiAqXG4gKiBjb25zdCBmaWx0ZXJFID0gUkEuZmlsdGVyRShULkFwcGxpY2F0aXZlUGFyKVxuICogYXN5bmMgZnVuY3Rpb24gdGVzdCgpIHtcbiAqICAgYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChcbiAqICAgICBhd2FpdCBwaXBlKFxuICogICAgICAgWy0xLCAyLCAzXSxcbiAqICAgICAgIGZpbHRlckUoKG4pID0+IFQub2YobiA+IDApKVxuICogICAgICkoKSxcbiAqICAgICBbMiwgM11cbiAqICAgKVxuICogfVxuICogdGVzdCgpXG4gKlxuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIGZpbHRlckUgPSAvKiNfX1BVUkVfXyovIGZpbHRlckVfKFdpdGhlcmFibGUpO1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi4xMS4wXG4gKi9cbmV4cG9ydCB2YXIgRnJvbUVpdGhlciA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICBmcm9tRWl0aGVyOiBmcm9tRWl0aGVyXG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgbGlmdGluZ1xuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIGZyb21FaXRoZXJLID0gLyojX19QVVJFX18qLyBmcm9tRWl0aGVyS18oRnJvbUVpdGhlcik7XG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vLyB1bnNhZmVcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8qKlxuICogQGNhdGVnb3J5IHVuc2FmZVxuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgdW5zYWZlSW5zZXJ0QXQgPSBSTkVBLnVuc2FmZUluc2VydEF0O1xuLyoqXG4gKiBAY2F0ZWdvcnkgdW5zYWZlXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciB1bnNhZmVVcGRhdGVBdCA9IGZ1bmN0aW9uIChpLCBhLCBhcykge1xuICAgIHJldHVybiBpc05vbkVtcHR5KGFzKSA/IFJORUEudW5zYWZlVXBkYXRlQXQoaSwgYSwgYXMpIDogYXM7XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgdW5zYWZlXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciB1bnNhZmVEZWxldGVBdCA9IGZ1bmN0aW9uIChpLCBhcykge1xuICAgIHZhciB4cyA9IGFzLnNsaWNlKCk7XG4gICAgeHMuc3BsaWNlKGksIDEpO1xuICAgIHJldHVybiB4cztcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBjb252ZXJzaW9uc1xuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgdG9BcnJheSA9IGZ1bmN0aW9uIChhcykgeyByZXR1cm4gYXMuc2xpY2UoKTsgfTtcbi8qKlxuICogQGNhdGVnb3J5IGNvbnZlcnNpb25zXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBmcm9tQXJyYXkgPSBmdW5jdGlvbiAoYXMpIHsgcmV0dXJuIChpc0VtcHR5KGFzKSA/IGVtcHR5IDogYXMuc2xpY2UoKSk7IH07XG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vLyB1dGlsc1xuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLyoqXG4gKiBBbiBlbXB0eSBhcnJheVxuICpcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIGVtcHR5ID0gUk5FQS5lbXB0eTtcbmV4cG9ydCBmdW5jdGlvbiBldmVyeShwcmVkaWNhdGUpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7IHJldHVybiBhcy5ldmVyeShwcmVkaWNhdGUpOyB9O1xufVxuLyoqXG4gKiBDaGVjayBpZiBhIHByZWRpY2F0ZSBob2xkcyB0cnVlIGZvciBhbnkgYXJyYXkgbWVtYmVyLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBzb21lIH0gZnJvbSAnZnAtdHMvUmVhZG9ubHlBcnJheSdcbiAqIGltcG9ydCB7IHBpcGUgfSBmcm9tICdmcC10cy9mdW5jdGlvbidcbiAqXG4gKiBjb25zdCBpc1Bvc2l0aXZlID0gKG46IG51bWJlcik6IGJvb2xlYW4gPT4gbiA+IDBcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKHBpcGUoWy0xLCAtMiwgM10sIHNvbWUoaXNQb3NpdGl2ZSkpLCB0cnVlKVxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChwaXBlKFstMSwgLTIsIC0zXSwgc29tZShpc1Bvc2l0aXZlKSksIGZhbHNlKVxuICpcbiAqIEBzaW5jZSAyLjkuMFxuICovXG5leHBvcnQgdmFyIHNvbWUgPSBmdW5jdGlvbiAocHJlZGljYXRlKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykge1xuICAgICAgICByZXR1cm4gYXMuc29tZShwcmVkaWNhdGUpO1xuICAgIH07XG59O1xuLyoqXG4gKiBBbGlhcyBvZiBbYHNvbWVgXSgjc29tZSlcbiAqXG4gKiBAc2luY2UgMi4xMS4wXG4gKi9cbmV4cG9ydCB2YXIgZXhpc3RzID0gc29tZTtcbi8qKlxuICogUGxhY2VzIGFuIGVsZW1lbnQgaW4gYmV0d2VlbiBtZW1iZXJzIG9mIGEgYFJlYWRvbmx5QXJyYXlgLCB0aGVuIGZvbGRzIHRoZSByZXN1bHRzIHVzaW5nIHRoZSBwcm92aWRlZCBgTW9ub2lkYC5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0ICogYXMgUyBmcm9tICdmcC10cy9zdHJpbmcnXG4gKiBpbXBvcnQgeyBpbnRlcmNhbGF0ZSB9IGZyb20gJ2ZwLXRzL1JlYWRvbmx5QXJyYXknXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChpbnRlcmNhbGF0ZShTLk1vbm9pZCkoJy0nKShbJ2EnLCAnYicsICdjJ10pLCAnYS1iLWMnKVxuICpcbiAqIEBzaW5jZSAyLjEyLjBcbiAqL1xuZXhwb3J0IHZhciBpbnRlcmNhbGF0ZSA9IGZ1bmN0aW9uIChNKSB7XG4gICAgdmFyIGludGVyY2FsYXRlTSA9IFJORUEuaW50ZXJjYWxhdGUoTSk7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChtaWRkbGUpIHsgcmV0dXJuIG1hdGNoKGZ1bmN0aW9uICgpIHsgcmV0dXJuIE0uZW1wdHk7IH0sIGludGVyY2FsYXRlTShtaWRkbGUpKTsgfTtcbn07XG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vLyBkbyBub3RhdGlvblxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLyoqXG4gKiBAY2F0ZWdvcnkgZG8gbm90YXRpb25cbiAqIEBzaW5jZSAyLjkuMFxuICovXG5leHBvcnQgdmFyIERvID0gLyojX19QVVJFX18qLyBvZihfLmVtcHR5UmVjb3JkKTtcbi8qKlxuICogQGNhdGVnb3J5IGRvIG5vdGF0aW9uXG4gKiBAc2luY2UgMi44LjBcbiAqL1xuZXhwb3J0IHZhciBiaW5kVG8gPSAvKiNfX1BVUkVfXyovIGJpbmRUb18oRnVuY3Rvcik7XG52YXIgbGV0XyA9IC8qI19fUFVSRV9fKi8gbGV0X18oRnVuY3Rvcik7XG5leHBvcnQgeyBcbi8qKlxuICogQGNhdGVnb3J5IGRvIG5vdGF0aW9uXG4gKiBAc2luY2UgMi4xMy4wXG4gKi9cbmxldF8gYXMgbGV0IH07XG4vKipcbiAqIEBjYXRlZ29yeSBkbyBub3RhdGlvblxuICogQHNpbmNlIDIuOC4wXG4gKi9cbmV4cG9ydCB2YXIgYmluZCA9IC8qI19fUFVSRV9fKi8gYmluZF8oQ2hhaW4pO1xuLyoqXG4gKiBAY2F0ZWdvcnkgZG8gbm90YXRpb25cbiAqIEBzaW5jZSAyLjguMFxuICovXG5leHBvcnQgdmFyIGFwUyA9IC8qI19fUFVSRV9fKi8gYXBTXyhBcHBseSk7XG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vLyBsZWdhY3lcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8qKlxuICogQWxpYXMgb2YgYGZsYXRNYXBgLlxuICpcbiAqIEBjYXRlZ29yeSBsZWdhY3lcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIGNoYWluID0gZmxhdE1hcDtcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8vIGRlcHJlY2F0ZWRcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8qKlxuICogVXNlIGBSZWFkb25seU5vbkVtcHR5QXJyYXlgIG1vZHVsZSBpbnN0ZWFkLlxuICpcbiAqIEBjYXRlZ29yeSB6b25lIG9mIGRlYXRoXG4gKiBAc2luY2UgMi41LjBcbiAqIEBkZXByZWNhdGVkXG4gKi9cbmV4cG9ydCB2YXIgcmFuZ2UgPSBSTkVBLnJhbmdlO1xuLyoqXG4gKiBVc2UgW2BwcmVwZW5kYF0oI3ByZXBlbmQpIGluc3RlYWQuXG4gKlxuICogQGNhdGVnb3J5IHpvbmUgb2YgZGVhdGhcbiAqIEBzaW5jZSAyLjUuMFxuICogQGRlcHJlY2F0ZWRcbiAqL1xuZXhwb3J0IHZhciBjb25zID0gUk5FQS5jb25zO1xuLyoqXG4gKiBVc2UgW2BhcHBlbmRgXSgjYXBwZW5kKSBpbnN0ZWFkLlxuICpcbiAqIEBjYXRlZ29yeSB6b25lIG9mIGRlYXRoXG4gKiBAc2luY2UgMi41LjBcbiAqIEBkZXByZWNhdGVkXG4gKi9cbmV4cG9ydCB2YXIgc25vYyA9IFJORUEuc25vYztcbi8qKlxuICogVXNlIFtgcHJlcGVuZEFsbGBdKCNwcmVwZW5kYWxsKSBpbnN0ZWFkLlxuICpcbiAqIEBjYXRlZ29yeSB6b25lIG9mIGRlYXRoXG4gKiBAc2luY2UgMi45LjBcbiAqIEBkZXByZWNhdGVkXG4gKi9cbmV4cG9ydCB2YXIgcHJlcGVuZFRvQWxsID0gcHJlcGVuZEFsbDtcbi8qKlxuICogVGhpcyBpbnN0YW5jZSBpcyBkZXByZWNhdGVkLCB1c2Ugc21hbGwsIHNwZWNpZmljIGluc3RhbmNlcyBpbnN0ZWFkLlxuICogRm9yIGV4YW1wbGUgaWYgYSBmdW5jdGlvbiBuZWVkcyBhIGBGdW5jdG9yYCBpbnN0YW5jZSwgcGFzcyBgUkEuRnVuY3RvcmAgaW5zdGVhZCBvZiBgUkEucmVhZG9ubHlBcnJheWBcbiAqICh3aGVyZSBgUkFgIGlzIGZyb20gYGltcG9ydCBSQSBmcm9tICdmcC10cy9SZWFkb25seUFycmF5J2ApXG4gKlxuICogQGNhdGVnb3J5IHpvbmUgb2YgZGVhdGhcbiAqIEBzaW5jZSAyLjUuMFxuICogQGRlcHJlY2F0ZWRcbiAqL1xuZXhwb3J0IHZhciByZWFkb25seUFycmF5ID0ge1xuICAgIFVSSTogVVJJLFxuICAgIGNvbXBhY3Q6IGNvbXBhY3QsXG4gICAgc2VwYXJhdGU6IHNlcGFyYXRlLFxuICAgIG1hcDogX21hcCxcbiAgICBhcDogX2FwLFxuICAgIG9mOiBvZixcbiAgICBjaGFpbjogZmxhdE1hcCxcbiAgICBmaWx0ZXI6IF9maWx0ZXIsXG4gICAgZmlsdGVyTWFwOiBfZmlsdGVyTWFwLFxuICAgIHBhcnRpdGlvbjogX3BhcnRpdGlvbixcbiAgICBwYXJ0aXRpb25NYXA6IF9wYXJ0aXRpb25NYXAsXG4gICAgbWFwV2l0aEluZGV4OiBfbWFwV2l0aEluZGV4LFxuICAgIHBhcnRpdGlvbk1hcFdpdGhJbmRleDogX3BhcnRpdGlvbk1hcFdpdGhJbmRleCxcbiAgICBwYXJ0aXRpb25XaXRoSW5kZXg6IF9wYXJ0aXRpb25XaXRoSW5kZXgsXG4gICAgZmlsdGVyTWFwV2l0aEluZGV4OiBfZmlsdGVyTWFwV2l0aEluZGV4LFxuICAgIGZpbHRlcldpdGhJbmRleDogX2ZpbHRlcldpdGhJbmRleCxcbiAgICBhbHQ6IF9hbHQsXG4gICAgemVybzogemVybyxcbiAgICB1bmZvbGQ6IHVuZm9sZCxcbiAgICByZWR1Y2U6IF9yZWR1Y2UsXG4gICAgZm9sZE1hcDogX2ZvbGRNYXAsXG4gICAgcmVkdWNlUmlnaHQ6IF9yZWR1Y2VSaWdodCxcbiAgICB0cmF2ZXJzZTogX3RyYXZlcnNlLFxuICAgIHNlcXVlbmNlOiBzZXF1ZW5jZSxcbiAgICByZWR1Y2VXaXRoSW5kZXg6IF9yZWR1Y2VXaXRoSW5kZXgsXG4gICAgZm9sZE1hcFdpdGhJbmRleDogX2ZvbGRNYXBXaXRoSW5kZXgsXG4gICAgcmVkdWNlUmlnaHRXaXRoSW5kZXg6IF9yZWR1Y2VSaWdodFdpdGhJbmRleCxcbiAgICB0cmF2ZXJzZVdpdGhJbmRleDogX3RyYXZlcnNlV2l0aEluZGV4LFxuICAgIGV4dGVuZDogX2V4dGVuZCxcbiAgICB3aXRoZXI6IF93aXRoZXIsXG4gICAgd2lsdDogX3dpbHRcbn07XG4iLAogICJ2YXIgX19zcHJlYWRBcnJheSA9ICh0aGlzICYmIHRoaXMuX19zcHJlYWRBcnJheSkgfHwgZnVuY3Rpb24gKHRvLCBmcm9tLCBwYWNrKSB7XG4gICAgaWYgKHBhY2sgfHwgYXJndW1lbnRzLmxlbmd0aCA9PT0gMikgZm9yICh2YXIgaSA9IDAsIGwgPSBmcm9tLmxlbmd0aCwgYXI7IGkgPCBsOyBpKyspIHtcbiAgICAgICAgaWYgKGFyIHx8ICEoaSBpbiBmcm9tKSkge1xuICAgICAgICAgICAgaWYgKCFhcikgYXIgPSBBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChmcm9tLCAwLCBpKTtcbiAgICAgICAgICAgIGFyW2ldID0gZnJvbVtpXTtcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gdG8uY29uY2F0KGFyIHx8IEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGZyb20pKTtcbn07XG5pbXBvcnQgeyBhcEZpcnN0IGFzIGFwRmlyc3RfLCBhcFMgYXMgYXBTXywgYXBTZWNvbmQgYXMgYXBTZWNvbmRfIH0gZnJvbSAnLi9BcHBseSc7XG5pbXBvcnQgeyBiaW5kIGFzIGJpbmRfLCBjaGFpbkZpcnN0IGFzIGNoYWluRmlyc3RfIH0gZnJvbSAnLi9DaGFpbic7XG5pbXBvcnQgeyBmcm9tRXF1YWxzIH0gZnJvbSAnLi9FcSc7XG5pbXBvcnQgeyBmcm9tRWl0aGVySyBhcyBmcm9tRWl0aGVyS18gfSBmcm9tICcuL0Zyb21FaXRoZXInO1xuaW1wb3J0IHsgZHVhbCwgaWRlbnRpdHksIHBpcGUgfSBmcm9tICcuL2Z1bmN0aW9uJztcbmltcG9ydCB7IGJpbmRUbyBhcyBiaW5kVG9fLCBmbGFwIGFzIGZsYXBfLCBsZXQgYXMgbGV0X18gfSBmcm9tICcuL0Z1bmN0b3InO1xuaW1wb3J0ICogYXMgXyBmcm9tICcuL2ludGVybmFsJztcbmltcG9ydCAqIGFzIE4gZnJvbSAnLi9udW1iZXInO1xuaW1wb3J0IHsgZnJvbUNvbXBhcmUgfSBmcm9tICcuL09yZCc7XG5pbXBvcnQgKiBhcyBSTkVBIGZyb20gJy4vUmVhZG9ubHlOb25FbXB0eUFycmF5JztcbmltcG9ydCB7IHNlcGFyYXRlZCB9IGZyb20gJy4vU2VwYXJhdGVkJztcbmltcG9ydCB7IGZpbHRlckUgYXMgZmlsdGVyRV8sIHdpbHREZWZhdWx0LCB3aXRoZXJEZWZhdWx0IH0gZnJvbSAnLi9XaXRoZXJhYmxlJztcbmltcG9ydCB7IGd1YXJkIGFzIGd1YXJkXyB9IGZyb20gJy4vWmVybyc7XG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vLyByZWZpbmVtZW50c1xuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLyoqXG4gKiBUZXN0IHdoZXRoZXIgYSBgUmVhZG9ubHlBcnJheWAgaXMgZW1wdHkuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IGlzRW1wdHkgfSBmcm9tICdmcC10cy9SZWFkb25seUFycmF5J1xuICpcbiAqIGFzc2VydC5zdHJpY3RFcXVhbChpc0VtcHR5KFtdKSwgdHJ1ZSlcbiAqXG4gKiBAY2F0ZWdvcnkgcmVmaW5lbWVudHNcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIGlzRW1wdHkgPSBmdW5jdGlvbiAoYXMpIHsgcmV0dXJuIGFzLmxlbmd0aCA9PT0gMDsgfTtcbi8qKlxuICogVGVzdCB3aGV0aGVyIGEgYFJlYWRvbmx5QXJyYXlgIGlzIG5vbiBlbXB0eS5cbiAqXG4gKiBAY2F0ZWdvcnkgcmVmaW5lbWVudHNcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIGlzTm9uRW1wdHkgPSBSTkVBLmlzTm9uRW1wdHk7XG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vLyBjb25zdHJ1Y3RvcnNcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8qKlxuICogUHJlcGVuZCBhbiBlbGVtZW50IHRvIHRoZSBmcm9udCBvZiBhIGBSZWFkb25seUFycmF5YCwgY3JlYXRpbmcgYSBuZXcgYFJlYWRvbmx5Tm9uRW1wdHlBcnJheWAuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IHByZXBlbmQgfSBmcm9tICdmcC10cy9SZWFkb25seUFycmF5J1xuICogaW1wb3J0IHsgcGlwZSB9IGZyb20gJ2ZwLXRzL2Z1bmN0aW9uJ1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwocGlwZShbMiwgMywgNF0sIHByZXBlbmQoMSkpLCBbMSwgMiwgMywgNF0pXG4gKlxuICogQHNpbmNlIDIuMTAuMFxuICovXG5leHBvcnQgdmFyIHByZXBlbmQgPSBSTkVBLnByZXBlbmQ7XG4vKipcbiAqIExlc3Mgc3RyaWN0IHZlcnNpb24gb2YgW2BwcmVwZW5kYF0oI3ByZXBlbmQpLlxuICpcbiAqIEBzaW5jZSAyLjExLjBcbiAqL1xuZXhwb3J0IHZhciBwcmVwZW5kVyA9IFJORUEucHJlcGVuZFc7XG4vKipcbiAqIEFwcGVuZCBhbiBlbGVtZW50IHRvIHRoZSBlbmQgb2YgYSBgUmVhZG9ubHlBcnJheWAsIGNyZWF0aW5nIGEgbmV3IGBSZWFkb25seU5vbkVtcHR5QXJyYXlgLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBhcHBlbmQgfSBmcm9tICdmcC10cy9SZWFkb25seUFycmF5J1xuICogaW1wb3J0IHsgcGlwZSB9IGZyb20gJ2ZwLXRzL2Z1bmN0aW9uJ1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwocGlwZShbMSwgMiwgM10sIGFwcGVuZCg0KSksIFsxLCAyLCAzLCA0XSlcbiAqXG4gKiBAc2luY2UgMi4xMC4wXG4gKi9cbmV4cG9ydCB2YXIgYXBwZW5kID0gUk5FQS5hcHBlbmQ7XG4vKipcbiAqIExlc3Mgc3RyaWN0IHZlcnNpb24gb2YgW2BhcHBlbmRgXSgjYXBwZW5kKS5cbiAqXG4gKiBAc2luY2UgMi4xMS4wXG4gKi9cbmV4cG9ydCB2YXIgYXBwZW5kVyA9IFJORUEuYXBwZW5kVztcbi8qKlxuICogUmV0dXJuIGEgYFJlYWRvbmx5QXJyYXlgIG9mIGxlbmd0aCBgbmAgd2l0aCBlbGVtZW50IGBpYCBpbml0aWFsaXplZCB3aXRoIGBmKGkpYC5cbiAqXG4gKiAqKk5vdGUqKi4gYG5gIGlzIG5vcm1hbGl6ZWQgdG8gYSBub24gbmVnYXRpdmUgaW50ZWdlci5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgbWFrZUJ5IH0gZnJvbSAnZnAtdHMvUmVhZG9ubHlBcnJheSdcbiAqXG4gKiBjb25zdCBkb3VibGUgPSAobjogbnVtYmVyKTogbnVtYmVyID0+IG4gKiAyXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKG1ha2VCeSg1LCBkb3VibGUpLCBbMCwgMiwgNCwgNiwgOF0pXG4gKlxuICogQGNhdGVnb3J5IGNvbnN0cnVjdG9yc1xuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgbWFrZUJ5ID0gZnVuY3Rpb24gKG4sIGYpIHsgcmV0dXJuIChuIDw9IDAgPyBlbXB0eSA6IFJORUEubWFrZUJ5KGYpKG4pKTsgfTtcbi8qKlxuICogQ3JlYXRlIGEgYFJlYWRvbmx5QXJyYXlgIGNvbnRhaW5pbmcgYSB2YWx1ZSByZXBlYXRlZCB0aGUgc3BlY2lmaWVkIG51bWJlciBvZiB0aW1lcy5cbiAqXG4gKiAqKk5vdGUqKi4gYG5gIGlzIG5vcm1hbGl6ZWQgdG8gYSBub24gbmVnYXRpdmUgaW50ZWdlci5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgcmVwbGljYXRlIH0gZnJvbSAnZnAtdHMvUmVhZG9ubHlBcnJheSdcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKHJlcGxpY2F0ZSgzLCAnYScpLCBbJ2EnLCAnYScsICdhJ10pXG4gKlxuICogQGNhdGVnb3J5IGNvbnN0cnVjdG9yc1xuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgcmVwbGljYXRlID0gZnVuY3Rpb24gKG4sIGEpIHsgcmV0dXJuIG1ha2VCeShuLCBmdW5jdGlvbiAoKSB7IHJldHVybiBhOyB9KTsgfTtcbmV4cG9ydCBmdW5jdGlvbiBmcm9tUHJlZGljYXRlKHByZWRpY2F0ZSkge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYSkgeyByZXR1cm4gKHByZWRpY2F0ZShhKSA/IFthXSA6IGVtcHR5KTsgfTtcbn1cbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8vIGNvbnZlcnNpb25zXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vKipcbiAqIEBjYXRlZ29yeSBjb252ZXJzaW9uc1xuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIGZyb21PcHRpb24gPSBmdW5jdGlvbiAobWEpIHsgcmV0dXJuIChfLmlzTm9uZShtYSkgPyBlbXB0eSA6IFttYS52YWx1ZV0pOyB9O1xuLyoqXG4gKiBUcmFuc2Zvcm1zIGFuIGBFaXRoZXJgIHRvIGEgYFJlYWRvbmx5QXJyYXlgLlxuICpcbiAqIEBjYXRlZ29yeSBjb252ZXJzaW9uc1xuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIGZyb21FaXRoZXIgPSBmdW5jdGlvbiAoZSkgeyByZXR1cm4gKF8uaXNMZWZ0KGUpID8gZW1wdHkgOiBbZS5yaWdodF0pOyB9O1xuLyoqXG4gKiBMZXNzIHN0cmljdCB2ZXJzaW9uIG9mIFtgbWF0Y2hgXSgjbWF0Y2gpLlxuICpcbiAqIFRoZSBgV2Agc3VmZml4IChzaG9ydCBmb3IgKipXKippZGVuaW5nKSBtZWFucyB0aGF0IHRoZSBoYW5kbGVyIHJldHVybiB0eXBlcyB3aWxsIGJlIG1lcmdlZC5cbiAqXG4gKiBAY2F0ZWdvcnkgcGF0dGVybiBtYXRjaGluZ1xuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIG1hdGNoVyA9IGZ1bmN0aW9uIChvbkVtcHR5LCBvbk5vbkVtcHR5KSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykge1xuICAgICAgICByZXR1cm4gaXNOb25FbXB0eShhcykgPyBvbk5vbkVtcHR5KGFzKSA6IG9uRW1wdHkoKTtcbiAgICB9O1xufTtcbi8qKlxuICogQGNhdGVnb3J5IHBhdHRlcm4gbWF0Y2hpbmdcbiAqIEBzaW5jZSAyLjExLjBcbiAqL1xuZXhwb3J0IHZhciBtYXRjaCA9IG1hdGNoVztcbi8qKlxuICogTGVzcyBzdHJpY3QgdmVyc2lvbiBvZiBbYG1hdGNoTGVmdGBdKCNtYXRjaGxlZnQpLlxuICpcbiAqIEBjYXRlZ29yeSBwYXR0ZXJuIG1hdGNoaW5nXG4gKiBAc2luY2UgMi4xMS4wXG4gKi9cbmV4cG9ydCB2YXIgbWF0Y2hMZWZ0VyA9IGZ1bmN0aW9uIChvbkVtcHR5LCBvbk5vbkVtcHR5KSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykge1xuICAgICAgICByZXR1cm4gaXNOb25FbXB0eShhcykgPyBvbk5vbkVtcHR5KFJORUEuaGVhZChhcyksIFJORUEudGFpbChhcykpIDogb25FbXB0eSgpO1xuICAgIH07XG59O1xuLyoqXG4gKiBCcmVhayBhIGBSZWFkb25seUFycmF5YCBpbnRvIGl0cyBmaXJzdCBlbGVtZW50IGFuZCByZW1haW5pbmcgZWxlbWVudHMuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IG1hdGNoTGVmdCB9IGZyb20gJ2ZwLXRzL1JlYWRvbmx5QXJyYXknXG4gKlxuICogY29uc3QgbGVuOiA8QT4oYXM6IFJlYWRvbmx5QXJyYXk8QT4pID0+IG51bWJlciA9IG1hdGNoTGVmdCgoKSA9PiAwLCAoXywgdGFpbCkgPT4gMSArIGxlbih0YWlsKSlcbiAqIGFzc2VydC5zdHJpY3RFcXVhbChsZW4oWzEsIDIsIDNdKSwgMylcbiAqXG4gKiBAY2F0ZWdvcnkgcGF0dGVybiBtYXRjaGluZ1xuICogQHNpbmNlIDIuMTAuMFxuICovXG5leHBvcnQgdmFyIG1hdGNoTGVmdCA9IG1hdGNoTGVmdFc7XG4vKipcbiAqIEFsaWFzIG9mIFtgbWF0Y2hMZWZ0YF0oI21hdGNobGVmdCkuXG4gKlxuICogQGNhdGVnb3J5IHBhdHRlcm4gbWF0Y2hpbmdcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIGZvbGRMZWZ0ID0gbWF0Y2hMZWZ0O1xuLyoqXG4gKiBMZXNzIHN0cmljdCB2ZXJzaW9uIG9mIFtgbWF0Y2hSaWdodGBdKCNtYXRjaHJpZ2h0KS5cbiAqXG4gKiBAY2F0ZWdvcnkgcGF0dGVybiBtYXRjaGluZ1xuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIG1hdGNoUmlnaHRXID0gZnVuY3Rpb24gKG9uRW1wdHksIG9uTm9uRW1wdHkpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIHJldHVybiBpc05vbkVtcHR5KGFzKSA/IG9uTm9uRW1wdHkoUk5FQS5pbml0KGFzKSwgUk5FQS5sYXN0KGFzKSkgOiBvbkVtcHR5KCk7XG4gICAgfTtcbn07XG4vKipcbiAqIEJyZWFrIGEgYFJlYWRvbmx5QXJyYXlgIGludG8gaXRzIGluaXRpYWwgZWxlbWVudHMgYW5kIHRoZSBsYXN0IGVsZW1lbnQuXG4gKlxuICogQGNhdGVnb3J5IHBhdHRlcm4gbWF0Y2hpbmdcbiAqIEBzaW5jZSAyLjEwLjBcbiAqL1xuZXhwb3J0IHZhciBtYXRjaFJpZ2h0ID0gbWF0Y2hSaWdodFc7XG4vKipcbiAqIEFsaWFzIG9mIFtgbWF0Y2hSaWdodGBdKCNtYXRjaHJpZ2h0KS5cbiAqXG4gKiBAY2F0ZWdvcnkgcGF0dGVybiBtYXRjaGluZ1xuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgZm9sZFJpZ2h0ID0gbWF0Y2hSaWdodDtcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8vIGNvbWJpbmF0b3JzXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vKipcbiAqIEBjYXRlZ29yeSBzZXF1ZW5jaW5nXG4gKiBAc2luY2UgMi43LjBcbiAqL1xuZXhwb3J0IHZhciBjaGFpbldpdGhJbmRleCA9IGZ1bmN0aW9uIChmKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykge1xuICAgICAgICBpZiAoaXNFbXB0eShhcykpIHtcbiAgICAgICAgICAgIHJldHVybiBlbXB0eTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgb3V0ID0gW107XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgYXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIG91dC5wdXNoLmFwcGx5KG91dCwgZihpLCBhc1tpXSkpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBvdXQ7XG4gICAgfTtcbn07XG4vKipcbiAqIFNhbWUgYXMgYHJlZHVjZWAgYnV0IGl0IGNhcnJpZXMgb3ZlciB0aGUgaW50ZXJtZWRpYXRlIHN0ZXBzLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBzY2FuTGVmdCB9IGZyb20gJ2ZwLXRzL1JlYWRvbmx5QXJyYXknXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChzY2FuTGVmdCgxMCwgKGIsIGE6IG51bWJlcikgPT4gYiAtIGEpKFsxLCAyLCAzXSksIFsxMCwgOSwgNywgNF0pXG4gKlxuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgc2NhbkxlZnQgPSBmdW5jdGlvbiAoYiwgZikge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgdmFyIGxlbiA9IGFzLmxlbmd0aDtcbiAgICAgICAgdmFyIG91dCA9IG5ldyBBcnJheShsZW4gKyAxKTtcbiAgICAgICAgb3V0WzBdID0gYjtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBsZW47IGkrKykge1xuICAgICAgICAgICAgb3V0W2kgKyAxXSA9IGYob3V0W2ldLCBhc1tpXSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG91dDtcbiAgICB9O1xufTtcbi8qKlxuICogRm9sZCBhbiBhcnJheSBmcm9tIHRoZSByaWdodCwga2VlcGluZyBhbGwgaW50ZXJtZWRpYXRlIHJlc3VsdHMgaW5zdGVhZCBvZiBvbmx5IHRoZSBmaW5hbCByZXN1bHRcbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgc2NhblJpZ2h0IH0gZnJvbSAnZnAtdHMvUmVhZG9ubHlBcnJheSdcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKHNjYW5SaWdodCgxMCwgKGE6IG51bWJlciwgYikgPT4gYiAtIGEpKFsxLCAyLCAzXSksIFs0LCA1LCA3LCAxMF0pXG4gKlxuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgc2NhblJpZ2h0ID0gZnVuY3Rpb24gKGIsIGYpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIHZhciBsZW4gPSBhcy5sZW5ndGg7XG4gICAgICAgIHZhciBvdXQgPSBuZXcgQXJyYXkobGVuICsgMSk7XG4gICAgICAgIG91dFtsZW5dID0gYjtcbiAgICAgICAgZm9yICh2YXIgaSA9IGxlbiAtIDE7IGkgPj0gMDsgaS0tKSB7XG4gICAgICAgICAgICBvdXRbaV0gPSBmKGFzW2ldLCBvdXRbaSArIDFdKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gb3V0O1xuICAgIH07XG59O1xuLyoqXG4gKiBDYWxjdWxhdGUgdGhlIG51bWJlciBvZiBlbGVtZW50cyBpbiBhIGBSZWFkb25seUFycmF5YC5cbiAqXG4gKiBAc2luY2UgMi4xMC4wXG4gKi9cbmV4cG9ydCB2YXIgc2l6ZSA9IGZ1bmN0aW9uIChhcykgeyByZXR1cm4gYXMubGVuZ3RoOyB9O1xuLyoqXG4gKiBUZXN0IHdoZXRoZXIgYW4gYXJyYXkgY29udGFpbnMgYSBwYXJ0aWN1bGFyIGluZGV4XG4gKlxuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgaXNPdXRPZkJvdW5kID0gUk5FQS5pc091dE9mQm91bmQ7XG5leHBvcnQgZnVuY3Rpb24gbG9va3VwKGksIGFzKSB7XG4gICAgcmV0dXJuIGFzID09PSB1bmRlZmluZWQgPyBmdW5jdGlvbiAoYXMpIHsgcmV0dXJuIGxvb2t1cChpLCBhcyk7IH0gOiBpc091dE9mQm91bmQoaSwgYXMpID8gXy5ub25lIDogXy5zb21lKGFzW2ldKTtcbn1cbi8qKlxuICogR2V0IHRoZSBmaXJzdCBlbGVtZW50IGluIGFuIGFycmF5LCBvciBgTm9uZWAgaWYgdGhlIGFycmF5IGlzIGVtcHR5XG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IGhlYWQgfSBmcm9tICdmcC10cy9SZWFkb25seUFycmF5J1xuICogaW1wb3J0IHsgc29tZSwgbm9uZSB9IGZyb20gJ2ZwLXRzL09wdGlvbidcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKGhlYWQoWzEsIDIsIDNdKSwgc29tZSgxKSlcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoaGVhZChbXSksIG5vbmUpXG4gKlxuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgaGVhZCA9IGZ1bmN0aW9uIChhcykgeyByZXR1cm4gKGlzTm9uRW1wdHkoYXMpID8gXy5zb21lKFJORUEuaGVhZChhcykpIDogXy5ub25lKTsgfTtcbi8qKlxuICogR2V0IHRoZSBsYXN0IGVsZW1lbnQgaW4gYW4gYXJyYXksIG9yIGBOb25lYCBpZiB0aGUgYXJyYXkgaXMgZW1wdHlcbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgbGFzdCB9IGZyb20gJ2ZwLXRzL1JlYWRvbmx5QXJyYXknXG4gKiBpbXBvcnQgeyBzb21lLCBub25lIH0gZnJvbSAnZnAtdHMvT3B0aW9uJ1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwobGFzdChbMSwgMiwgM10pLCBzb21lKDMpKVxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChsYXN0KFtdKSwgbm9uZSlcbiAqXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBsYXN0ID0gZnVuY3Rpb24gKGFzKSB7IHJldHVybiAoaXNOb25FbXB0eShhcykgPyBfLnNvbWUoUk5FQS5sYXN0KGFzKSkgOiBfLm5vbmUpOyB9O1xuLyoqXG4gKiBHZXQgYWxsIGJ1dCB0aGUgZmlyc3QgZWxlbWVudCBvZiBhbiBhcnJheSwgY3JlYXRpbmcgYSBuZXcgYXJyYXksIG9yIGBOb25lYCBpZiB0aGUgYXJyYXkgaXMgZW1wdHlcbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgdGFpbCB9IGZyb20gJ2ZwLXRzL1JlYWRvbmx5QXJyYXknXG4gKiBpbXBvcnQgeyBzb21lLCBub25lIH0gZnJvbSAnZnAtdHMvT3B0aW9uJ1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwodGFpbChbMSwgMiwgM10pLCBzb21lKFsyLCAzXSkpXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKHRhaWwoW10pLCBub25lKVxuICpcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIHRhaWwgPSBmdW5jdGlvbiAoYXMpIHtcbiAgICByZXR1cm4gaXNOb25FbXB0eShhcykgPyBfLnNvbWUoUk5FQS50YWlsKGFzKSkgOiBfLm5vbmU7XG59O1xuLyoqXG4gKiBHZXQgYWxsIGJ1dCB0aGUgbGFzdCBlbGVtZW50IG9mIGFuIGFycmF5LCBjcmVhdGluZyBhIG5ldyBhcnJheSwgb3IgYE5vbmVgIGlmIHRoZSBhcnJheSBpcyBlbXB0eVxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBpbml0IH0gZnJvbSAnZnAtdHMvUmVhZG9ubHlBcnJheSdcbiAqIGltcG9ydCB7IHNvbWUsIG5vbmUgfSBmcm9tICdmcC10cy9PcHRpb24nXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChpbml0KFsxLCAyLCAzXSksIHNvbWUoWzEsIDJdKSlcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoaW5pdChbXSksIG5vbmUpXG4gKlxuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgaW5pdCA9IGZ1bmN0aW9uIChhcykge1xuICAgIHJldHVybiBpc05vbkVtcHR5KGFzKSA/IF8uc29tZShSTkVBLmluaXQoYXMpKSA6IF8ubm9uZTtcbn07XG4vKipcbiAqIEtlZXAgb25seSBhIG1heCBudW1iZXIgb2YgZWxlbWVudHMgZnJvbSB0aGUgc3RhcnQgb2YgYW4gYFJlYWRvbmx5QXJyYXlgLCBjcmVhdGluZyBhIG5ldyBgUmVhZG9ubHlBcnJheWAuXG4gKlxuICogKipOb3RlKiouIGBuYCBpcyBub3JtYWxpemVkIHRvIGEgbm9uIG5lZ2F0aXZlIGludGVnZXIuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCAqIGFzIFJBIGZyb20gJ2ZwLXRzL1JlYWRvbmx5QXJyYXknXG4gKiBpbXBvcnQgeyBwaXBlIH0gZnJvbSAnZnAtdHMvZnVuY3Rpb24nXG4gKlxuICogY29uc3QgaW5wdXQ6IFJlYWRvbmx5QXJyYXk8bnVtYmVyPiA9IFsxLCAyLCAzXVxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChwaXBlKGlucHV0LCBSQS50YWtlTGVmdCgyKSksIFsxLCAyXSlcbiAqXG4gKiAvLyBvdXQgb2YgYm91bmRzXG4gKiBhc3NlcnQuc3RyaWN0RXF1YWwocGlwZShpbnB1dCwgUkEudGFrZUxlZnQoNCkpLCBpbnB1dClcbiAqIGFzc2VydC5zdHJpY3RFcXVhbChwaXBlKGlucHV0LCBSQS50YWtlTGVmdCgtMSkpLCBpbnB1dClcbiAqXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciB0YWtlTGVmdCA9IGZ1bmN0aW9uIChuKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykge1xuICAgICAgICByZXR1cm4gaXNPdXRPZkJvdW5kKG4sIGFzKSA/IGFzIDogbiA9PT0gMCA/IGVtcHR5IDogYXMuc2xpY2UoMCwgbik7XG4gICAgfTtcbn07XG4vKipcbiAqIEtlZXAgb25seSBhIG1heCBudW1iZXIgb2YgZWxlbWVudHMgZnJvbSB0aGUgZW5kIG9mIGFuIGBSZWFkb25seUFycmF5YCwgY3JlYXRpbmcgYSBuZXcgYFJlYWRvbmx5QXJyYXlgLlxuICpcbiAqICoqTm90ZSoqLiBgbmAgaXMgbm9ybWFsaXplZCB0byBhIG5vbiBuZWdhdGl2ZSBpbnRlZ2VyLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgKiBhcyBSQSBmcm9tICdmcC10cy9SZWFkb25seUFycmF5J1xuICogaW1wb3J0IHsgcGlwZSB9IGZyb20gJ2ZwLXRzL2Z1bmN0aW9uJ1xuICpcbiAqIGNvbnN0IGlucHV0OiBSZWFkb25seUFycmF5PG51bWJlcj4gPSBbMSwgMiwgM11cbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwocGlwZShpbnB1dCwgUkEudGFrZVJpZ2h0KDIpKSwgWzIsIDNdKVxuICpcbiAqIC8vIG91dCBvZiBib3VuZHNcbiAqIGFzc2VydC5zdHJpY3RFcXVhbChwaXBlKGlucHV0LCBSQS50YWtlUmlnaHQoNCkpLCBpbnB1dClcbiAqIGFzc2VydC5zdHJpY3RFcXVhbChwaXBlKGlucHV0LCBSQS50YWtlUmlnaHQoLTEpKSwgaW5wdXQpXG4gKlxuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgdGFrZVJpZ2h0ID0gZnVuY3Rpb24gKG4pIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIHJldHVybiBpc091dE9mQm91bmQobiwgYXMpID8gYXMgOiBuID09PSAwID8gZW1wdHkgOiBhcy5zbGljZSgtbik7XG4gICAgfTtcbn07XG5leHBvcnQgZnVuY3Rpb24gdGFrZUxlZnRXaGlsZShwcmVkaWNhdGUpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIHZhciBvdXQgPSBbXTtcbiAgICAgICAgZm9yICh2YXIgX2kgPSAwLCBhc18xID0gYXM7IF9pIDwgYXNfMS5sZW5ndGg7IF9pKyspIHtcbiAgICAgICAgICAgIHZhciBhID0gYXNfMVtfaV07XG4gICAgICAgICAgICBpZiAoIXByZWRpY2F0ZShhKSkge1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgb3V0LnB1c2goYSk7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGxlbiA9IG91dC5sZW5ndGg7XG4gICAgICAgIHJldHVybiBsZW4gPT09IGFzLmxlbmd0aCA/IGFzIDogbGVuID09PSAwID8gZW1wdHkgOiBvdXQ7XG4gICAgfTtcbn1cbnZhciBzcGFuTGVmdEluZGV4ID0gZnVuY3Rpb24gKGFzLCBwcmVkaWNhdGUpIHtcbiAgICB2YXIgbCA9IGFzLmxlbmd0aDtcbiAgICB2YXIgaSA9IDA7XG4gICAgZm9yICg7IGkgPCBsOyBpKyspIHtcbiAgICAgICAgaWYgKCFwcmVkaWNhdGUoYXNbaV0pKSB7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gaTtcbn07XG5leHBvcnQgZnVuY3Rpb24gc3BhbkxlZnQocHJlZGljYXRlKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykge1xuICAgICAgICB2YXIgX2EgPSBzcGxpdEF0KHNwYW5MZWZ0SW5kZXgoYXMsIHByZWRpY2F0ZSkpKGFzKSwgaW5pdCA9IF9hWzBdLCByZXN0ID0gX2FbMV07XG4gICAgICAgIHJldHVybiB7IGluaXQ6IGluaXQsIHJlc3Q6IHJlc3QgfTtcbiAgICB9O1xufVxuLyoqXG4gKiBEcm9wIGEgbWF4IG51bWJlciBvZiBlbGVtZW50cyBmcm9tIHRoZSBzdGFydCBvZiBhbiBgUmVhZG9ubHlBcnJheWAsIGNyZWF0aW5nIGEgbmV3IGBSZWFkb25seUFycmF5YC5cbiAqXG4gKiAqKk5vdGUqKi4gYG5gIGlzIG5vcm1hbGl6ZWQgdG8gYSBub24gbmVnYXRpdmUgaW50ZWdlci5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0ICogYXMgUkEgZnJvbSAnZnAtdHMvUmVhZG9ubHlBcnJheSdcbiAqIGltcG9ydCB7IHBpcGUgfSBmcm9tICdmcC10cy9mdW5jdGlvbidcbiAqXG4gKiBjb25zdCBpbnB1dDogUmVhZG9ubHlBcnJheTxudW1iZXI+ID0gWzEsIDIsIDNdXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKHBpcGUoaW5wdXQsIFJBLmRyb3BMZWZ0KDIpKSwgWzNdKVxuICogYXNzZXJ0LnN0cmljdEVxdWFsKHBpcGUoaW5wdXQsIFJBLmRyb3BMZWZ0KDApKSwgaW5wdXQpXG4gKiBhc3NlcnQuc3RyaWN0RXF1YWwocGlwZShpbnB1dCwgUkEuZHJvcExlZnQoLTEpKSwgaW5wdXQpXG4gKlxuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgZHJvcExlZnQgPSBmdW5jdGlvbiAobikge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgcmV0dXJuIG4gPD0gMCB8fCBpc0VtcHR5KGFzKSA/IGFzIDogbiA+PSBhcy5sZW5ndGggPyBlbXB0eSA6IGFzLnNsaWNlKG4sIGFzLmxlbmd0aCk7XG4gICAgfTtcbn07XG4vKipcbiAqIERyb3AgYSBtYXggbnVtYmVyIG9mIGVsZW1lbnRzIGZyb20gdGhlIGVuZCBvZiBhbiBgUmVhZG9ubHlBcnJheWAsIGNyZWF0aW5nIGEgbmV3IGBSZWFkb25seUFycmF5YC5cbiAqXG4gKiAqKk5vdGUqKi4gYG5gIGlzIG5vcm1hbGl6ZWQgdG8gYSBub24gbmVnYXRpdmUgaW50ZWdlci5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0ICogYXMgUkEgZnJvbSAnZnAtdHMvUmVhZG9ubHlBcnJheSdcbiAqIGltcG9ydCB7IHBpcGUgfSBmcm9tICdmcC10cy9mdW5jdGlvbidcbiAqXG4gKiBjb25zdCBpbnB1dDogUmVhZG9ubHlBcnJheTxudW1iZXI+ID0gWzEsIDIsIDNdXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKHBpcGUoaW5wdXQsIFJBLmRyb3BSaWdodCgyKSksIFsxXSlcbiAqIGFzc2VydC5zdHJpY3RFcXVhbChwaXBlKGlucHV0LCBSQS5kcm9wUmlnaHQoMCkpLCBpbnB1dClcbiAqIGFzc2VydC5zdHJpY3RFcXVhbChwaXBlKGlucHV0LCBSQS5kcm9wUmlnaHQoLTEpKSwgaW5wdXQpXG4gKlxuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgZHJvcFJpZ2h0ID0gZnVuY3Rpb24gKG4pIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIHJldHVybiBuIDw9IDAgfHwgaXNFbXB0eShhcykgPyBhcyA6IG4gPj0gYXMubGVuZ3RoID8gZW1wdHkgOiBhcy5zbGljZSgwLCBhcy5sZW5ndGggLSBuKTtcbiAgICB9O1xufTtcbmV4cG9ydCBmdW5jdGlvbiBkcm9wTGVmdFdoaWxlKHByZWRpY2F0ZSkge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgdmFyIGkgPSBzcGFuTGVmdEluZGV4KGFzLCBwcmVkaWNhdGUpO1xuICAgICAgICByZXR1cm4gaSA9PT0gMCA/IGFzIDogaSA9PT0gYXMubGVuZ3RoID8gZW1wdHkgOiBhcy5zbGljZShpKTtcbiAgICB9O1xufVxuLyoqXG4gKiBGaW5kIHRoZSBmaXJzdCBpbmRleCBmb3Igd2hpY2ggYSBwcmVkaWNhdGUgaG9sZHNcbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgZmluZEluZGV4IH0gZnJvbSAnZnAtdHMvUmVhZG9ubHlBcnJheSdcbiAqIGltcG9ydCB7IHNvbWUsIG5vbmUgfSBmcm9tICdmcC10cy9PcHRpb24nXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChmaW5kSW5kZXgoKG46IG51bWJlcikgPT4gbiA9PT0gMikoWzEsIDIsIDNdKSwgc29tZSgxKSlcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoZmluZEluZGV4KChuOiBudW1iZXIpID0+IG4gPT09IDIpKFtdKSwgbm9uZSlcbiAqXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBmaW5kSW5kZXggPSBmdW5jdGlvbiAocHJlZGljYXRlKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykge1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGFzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICBpZiAocHJlZGljYXRlKGFzW2ldKSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBfLnNvbWUoaSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIF8ubm9uZTtcbiAgICB9O1xufTtcbmV4cG9ydCBmdW5jdGlvbiBmaW5kRmlyc3QocHJlZGljYXRlKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykge1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGFzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICBpZiAocHJlZGljYXRlKGFzW2ldKSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBfLnNvbWUoYXNbaV0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBfLm5vbmU7XG4gICAgfTtcbn1cbi8qKlxuICogRmluZCB0aGUgZmlyc3QgZWxlbWVudCByZXR1cm5lZCBieSBhbiBvcHRpb24gYmFzZWQgc2VsZWN0b3IgZnVuY3Rpb25cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgZmluZEZpcnN0TWFwIH0gZnJvbSAnZnAtdHMvUmVhZG9ubHlBcnJheSdcbiAqIGltcG9ydCB7IHNvbWUsIG5vbmUgfSBmcm9tICdmcC10cy9PcHRpb24nXG4gKlxuICogaW50ZXJmYWNlIFBlcnNvbiB7XG4gKiAgIHJlYWRvbmx5IG5hbWU6IHN0cmluZ1xuICogICByZWFkb25seSBhZ2U/OiBudW1iZXJcbiAqIH1cbiAqXG4gKiBjb25zdCBwZXJzb25zOiBSZWFkb25seUFycmF5PFBlcnNvbj4gPSBbeyBuYW1lOiAnSm9obicgfSwgeyBuYW1lOiAnTWFyeScsIGFnZTogNDUgfSwgeyBuYW1lOiAnSm9leScsIGFnZTogMjggfV1cbiAqXG4gKiAvLyByZXR1cm5zIHRoZSBuYW1lIG9mIHRoZSBmaXJzdCBwZXJzb24gdGhhdCBoYXMgYW4gYWdlXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKGZpbmRGaXJzdE1hcCgocDogUGVyc29uKSA9PiAocC5hZ2UgPT09IHVuZGVmaW5lZCA/IG5vbmUgOiBzb21lKHAubmFtZSkpKShwZXJzb25zKSwgc29tZSgnTWFyeScpKVxuICpcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIGZpbmRGaXJzdE1hcCA9IGZ1bmN0aW9uIChmKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykge1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGFzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICB2YXIgb3V0ID0gZihhc1tpXSk7XG4gICAgICAgICAgICBpZiAoXy5pc1NvbWUob3V0KSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBvdXQ7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIF8ubm9uZTtcbiAgICB9O1xufTtcbmV4cG9ydCBmdW5jdGlvbiBmaW5kTGFzdChwcmVkaWNhdGUpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIGZvciAodmFyIGkgPSBhcy5sZW5ndGggLSAxOyBpID49IDA7IGktLSkge1xuICAgICAgICAgICAgaWYgKHByZWRpY2F0ZShhc1tpXSkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gXy5zb21lKGFzW2ldKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gXy5ub25lO1xuICAgIH07XG59XG4vKipcbiAqIEZpbmQgdGhlIGxhc3QgZWxlbWVudCByZXR1cm5lZCBieSBhbiBvcHRpb24gYmFzZWQgc2VsZWN0b3IgZnVuY3Rpb25cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgZmluZExhc3RNYXAgfSBmcm9tICdmcC10cy9SZWFkb25seUFycmF5J1xuICogaW1wb3J0IHsgc29tZSwgbm9uZSB9IGZyb20gJ2ZwLXRzL09wdGlvbidcbiAqXG4gKiBpbnRlcmZhY2UgUGVyc29uIHtcbiAqICAgcmVhZG9ubHkgbmFtZTogc3RyaW5nXG4gKiAgIHJlYWRvbmx5IGFnZT86IG51bWJlclxuICogfVxuICpcbiAqIGNvbnN0IHBlcnNvbnM6IFJlYWRvbmx5QXJyYXk8UGVyc29uPiA9IFt7IG5hbWU6ICdKb2huJyB9LCB7IG5hbWU6ICdNYXJ5JywgYWdlOiA0NSB9LCB7IG5hbWU6ICdKb2V5JywgYWdlOiAyOCB9XVxuICpcbiAqIC8vIHJldHVybnMgdGhlIG5hbWUgb2YgdGhlIGxhc3QgcGVyc29uIHRoYXQgaGFzIGFuIGFnZVxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChmaW5kTGFzdE1hcCgocDogUGVyc29uKSA9PiAocC5hZ2UgPT09IHVuZGVmaW5lZCA/IG5vbmUgOiBzb21lKHAubmFtZSkpKShwZXJzb25zKSwgc29tZSgnSm9leScpKVxuICpcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIGZpbmRMYXN0TWFwID0gZnVuY3Rpb24gKGYpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIGZvciAodmFyIGkgPSBhcy5sZW5ndGggLSAxOyBpID49IDA7IGktLSkge1xuICAgICAgICAgICAgdmFyIG91dCA9IGYoYXNbaV0pO1xuICAgICAgICAgICAgaWYgKF8uaXNTb21lKG91dCkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gb3V0O1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBfLm5vbmU7XG4gICAgfTtcbn07XG4vKipcbiAqIFJldHVybnMgdGhlIGluZGV4IG9mIHRoZSBsYXN0IGVsZW1lbnQgb2YgdGhlIGxpc3Qgd2hpY2ggbWF0Y2hlcyB0aGUgcHJlZGljYXRlXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IGZpbmRMYXN0SW5kZXggfSBmcm9tICdmcC10cy9SZWFkb25seUFycmF5J1xuICogaW1wb3J0IHsgc29tZSwgbm9uZSB9IGZyb20gJ2ZwLXRzL09wdGlvbidcbiAqXG4gKiBpbnRlcmZhY2UgWCB7XG4gKiAgIHJlYWRvbmx5IGE6IG51bWJlclxuICogICByZWFkb25seSBiOiBudW1iZXJcbiAqIH1cbiAqIGNvbnN0IHhzOiBSZWFkb25seUFycmF5PFg+ID0gW3sgYTogMSwgYjogMCB9LCB7IGE6IDEsIGI6IDEgfV1cbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoZmluZExhc3RJbmRleCgoeDogeyByZWFkb25seSBhOiBudW1iZXIgfSkgPT4geC5hID09PSAxKSh4cyksIHNvbWUoMSkpXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKGZpbmRMYXN0SW5kZXgoKHg6IHsgcmVhZG9ubHkgYTogbnVtYmVyIH0pID0+IHguYSA9PT0gNCkoeHMpLCBub25lKVxuICpcbiAqXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBmaW5kTGFzdEluZGV4ID0gZnVuY3Rpb24gKHByZWRpY2F0ZSkge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgZm9yICh2YXIgaSA9IGFzLmxlbmd0aCAtIDE7IGkgPj0gMDsgaS0tKSB7XG4gICAgICAgICAgICBpZiAocHJlZGljYXRlKGFzW2ldKSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBfLnNvbWUoaSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIF8ubm9uZTtcbiAgICB9O1xufTtcbi8qKlxuICogSW5zZXJ0IGFuIGVsZW1lbnQgYXQgdGhlIHNwZWNpZmllZCBpbmRleCwgY3JlYXRpbmcgYSBuZXcgYXJyYXksIG9yIHJldHVybmluZyBgTm9uZWAgaWYgdGhlIGluZGV4IGlzIG91dCBvZiBib3VuZHNcbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgaW5zZXJ0QXQgfSBmcm9tICdmcC10cy9SZWFkb25seUFycmF5J1xuICogaW1wb3J0IHsgc29tZSB9IGZyb20gJ2ZwLXRzL09wdGlvbidcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKGluc2VydEF0KDIsIDUpKFsxLCAyLCAzLCA0XSksIHNvbWUoWzEsIDIsIDUsIDMsIDRdKSlcbiAqXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBpbnNlcnRBdCA9IGZ1bmN0aW9uIChpLCBhKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykge1xuICAgICAgICByZXR1cm4gaSA8IDAgfHwgaSA+IGFzLmxlbmd0aCA/IF8ubm9uZSA6IF8uc29tZShSTkVBLnVuc2FmZUluc2VydEF0KGksIGEsIGFzKSk7XG4gICAgfTtcbn07XG4vKipcbiAqIENoYW5nZSB0aGUgZWxlbWVudCBhdCB0aGUgc3BlY2lmaWVkIGluZGV4LCBjcmVhdGluZyBhIG5ldyBhcnJheSwgb3IgcmV0dXJuaW5nIGBOb25lYCBpZiB0aGUgaW5kZXggaXMgb3V0IG9mIGJvdW5kc1xuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyB1cGRhdGVBdCB9IGZyb20gJ2ZwLXRzL1JlYWRvbmx5QXJyYXknXG4gKiBpbXBvcnQgeyBzb21lLCBub25lIH0gZnJvbSAnZnAtdHMvT3B0aW9uJ1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwodXBkYXRlQXQoMSwgMSkoWzEsIDIsIDNdKSwgc29tZShbMSwgMSwgM10pKVxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbCh1cGRhdGVBdCgxLCAxKShbXSksIG5vbmUpXG4gKlxuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgdXBkYXRlQXQgPSBmdW5jdGlvbiAoaSwgYSkge1xuICAgIHJldHVybiBtb2RpZnlBdChpLCBmdW5jdGlvbiAoKSB7IHJldHVybiBhOyB9KTtcbn07XG4vKipcbiAqIERlbGV0ZSB0aGUgZWxlbWVudCBhdCB0aGUgc3BlY2lmaWVkIGluZGV4LCBjcmVhdGluZyBhIG5ldyBhcnJheSwgb3IgcmV0dXJuaW5nIGBOb25lYCBpZiB0aGUgaW5kZXggaXMgb3V0IG9mIGJvdW5kc1xuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBkZWxldGVBdCB9IGZyb20gJ2ZwLXRzL1JlYWRvbmx5QXJyYXknXG4gKiBpbXBvcnQgeyBzb21lLCBub25lIH0gZnJvbSAnZnAtdHMvT3B0aW9uJ1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoZGVsZXRlQXQoMCkoWzEsIDIsIDNdKSwgc29tZShbMiwgM10pKVxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChkZWxldGVBdCgxKShbXSksIG5vbmUpXG4gKlxuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgZGVsZXRlQXQgPSBmdW5jdGlvbiAoaSkge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgcmV0dXJuIGlzT3V0T2ZCb3VuZChpLCBhcykgPyBfLm5vbmUgOiBfLnNvbWUodW5zYWZlRGVsZXRlQXQoaSwgYXMpKTtcbiAgICB9O1xufTtcbi8qKlxuICogQXBwbHkgYSBmdW5jdGlvbiB0byB0aGUgZWxlbWVudCBhdCB0aGUgc3BlY2lmaWVkIGluZGV4LCBjcmVhdGluZyBhIG5ldyBhcnJheSwgb3IgcmV0dXJuaW5nIGBOb25lYCBpZiB0aGUgaW5kZXggaXMgb3V0XG4gKiBvZiBib3VuZHNcbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgbW9kaWZ5QXQgfSBmcm9tICdmcC10cy9SZWFkb25seUFycmF5J1xuICogaW1wb3J0IHsgc29tZSwgbm9uZSB9IGZyb20gJ2ZwLXRzL09wdGlvbidcbiAqXG4gKiBjb25zdCBkb3VibGUgPSAoeDogbnVtYmVyKTogbnVtYmVyID0+IHggKiAyXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKG1vZGlmeUF0KDEsIGRvdWJsZSkoWzEsIDIsIDNdKSwgc29tZShbMSwgNCwgM10pKVxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChtb2RpZnlBdCgxLCBkb3VibGUpKFtdKSwgbm9uZSlcbiAqXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBtb2RpZnlBdCA9IGZ1bmN0aW9uIChpLCBmKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykge1xuICAgICAgICByZXR1cm4gaXNPdXRPZkJvdW5kKGksIGFzKSA/IF8ubm9uZSA6IF8uc29tZSh1bnNhZmVVcGRhdGVBdChpLCBmKGFzW2ldKSwgYXMpKTtcbiAgICB9O1xufTtcbi8qKlxuICogUmV2ZXJzZSBhbiBhcnJheSwgY3JlYXRpbmcgYSBuZXcgYXJyYXlcbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgcmV2ZXJzZSB9IGZyb20gJ2ZwLXRzL1JlYWRvbmx5QXJyYXknXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChyZXZlcnNlKFsxLCAyLCAzXSksIFszLCAyLCAxXSlcbiAqXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciByZXZlcnNlID0gZnVuY3Rpb24gKGFzKSB7IHJldHVybiAoYXMubGVuZ3RoIDw9IDEgPyBhcyA6IGFzLnNsaWNlKCkucmV2ZXJzZSgpKTsgfTtcbi8qKlxuICogRXh0cmFjdHMgZnJvbSBhbiBhcnJheSBvZiBgRWl0aGVyYCBhbGwgdGhlIGBSaWdodGAgZWxlbWVudHMuIEFsbCB0aGUgYFJpZ2h0YCBlbGVtZW50cyBhcmUgZXh0cmFjdGVkIGluIG9yZGVyXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IHJpZ2h0cyB9IGZyb20gJ2ZwLXRzL1JlYWRvbmx5QXJyYXknXG4gKiBpbXBvcnQgeyByaWdodCwgbGVmdCB9IGZyb20gJ2ZwLXRzL0VpdGhlcidcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKHJpZ2h0cyhbcmlnaHQoMSksIGxlZnQoJ2ZvbycpLCByaWdodCgyKV0pLCBbMSwgMl0pXG4gKlxuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgcmlnaHRzID0gZnVuY3Rpb24gKGFzKSB7XG4gICAgdmFyIHIgPSBbXTtcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IGFzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIHZhciBhID0gYXNbaV07XG4gICAgICAgIGlmIChhLl90YWcgPT09ICdSaWdodCcpIHtcbiAgICAgICAgICAgIHIucHVzaChhLnJpZ2h0KTtcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gcjtcbn07XG4vKipcbiAqIEV4dHJhY3RzIGZyb20gYW4gYXJyYXkgb2YgYEVpdGhlcmAgYWxsIHRoZSBgTGVmdGAgZWxlbWVudHMuIEFsbCB0aGUgYExlZnRgIGVsZW1lbnRzIGFyZSBleHRyYWN0ZWQgaW4gb3JkZXJcbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgbGVmdHMgfSBmcm9tICdmcC10cy9SZWFkb25seUFycmF5J1xuICogaW1wb3J0IHsgbGVmdCwgcmlnaHQgfSBmcm9tICdmcC10cy9FaXRoZXInXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChsZWZ0cyhbcmlnaHQoMSksIGxlZnQoJ2ZvbycpLCByaWdodCgyKV0pLCBbJ2ZvbyddKVxuICpcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIGxlZnRzID0gZnVuY3Rpb24gKGFzKSB7XG4gICAgdmFyIHIgPSBbXTtcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IGFzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIHZhciBhID0gYXNbaV07XG4gICAgICAgIGlmIChhLl90YWcgPT09ICdMZWZ0Jykge1xuICAgICAgICAgICAgci5wdXNoKGEubGVmdCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHI7XG59O1xuLyoqXG4gKiBTb3J0IHRoZSBlbGVtZW50cyBvZiBhbiBhcnJheSBpbiBpbmNyZWFzaW5nIG9yZGVyLCBjcmVhdGluZyBhIG5ldyBhcnJheVxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBzb3J0IH0gZnJvbSAnZnAtdHMvUmVhZG9ubHlBcnJheSdcbiAqIGltcG9ydCAqIGFzIE4gZnJvbSAnZnAtdHMvbnVtYmVyJ1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoc29ydChOLk9yZCkoWzMsIDIsIDFdKSwgWzEsIDIsIDNdKVxuICpcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIHNvcnQgPSBmdW5jdGlvbiAoTykge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgcmV0dXJuIGFzLmxlbmd0aCA8PSAxID8gYXMgOiBhcy5zbGljZSgpLnNvcnQoTy5jb21wYXJlKTtcbiAgICB9O1xufTtcbi8vIFRPRE86IGN1cnJ5IGFuZCBtYWtlIGRhdGEtbGFzdCBpbiB2M1xuLyoqXG4gKiBBcHBseSBhIGZ1bmN0aW9uIHRvIHBhaXJzIG9mIGVsZW1lbnRzIGF0IHRoZSBzYW1lIGluZGV4IGluIHR3byBhcnJheXMsIGNvbGxlY3RpbmcgdGhlIHJlc3VsdHMgaW4gYSBuZXcgYXJyYXkuIElmIG9uZVxuICogaW5wdXQgYXJyYXkgaXMgc2hvcnQsIGV4Y2VzcyBlbGVtZW50cyBvZiB0aGUgbG9uZ2VyIGFycmF5IGFyZSBkaXNjYXJkZWQuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IHppcFdpdGggfSBmcm9tICdmcC10cy9SZWFkb25seUFycmF5J1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoemlwV2l0aChbMSwgMiwgM10sIFsnYScsICdiJywgJ2MnLCAnZCddLCAobiwgcykgPT4gcyArIG4pLCBbJ2ExJywgJ2IyJywgJ2MzJ10pXG4gKlxuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgemlwV2l0aCA9IGZ1bmN0aW9uIChmYSwgZmIsIGYpIHtcbiAgICB2YXIgZmMgPSBbXTtcbiAgICB2YXIgbGVuID0gTWF0aC5taW4oZmEubGVuZ3RoLCBmYi5sZW5ndGgpO1xuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbGVuOyBpKyspIHtcbiAgICAgICAgZmNbaV0gPSBmKGZhW2ldLCBmYltpXSk7XG4gICAgfVxuICAgIHJldHVybiBmYztcbn07XG5leHBvcnQgZnVuY3Rpb24gemlwKGFzLCBicykge1xuICAgIGlmIChicyA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgIHJldHVybiBmdW5jdGlvbiAoYnMpIHsgcmV0dXJuIHppcChicywgYXMpOyB9O1xuICAgIH1cbiAgICByZXR1cm4gemlwV2l0aChhcywgYnMsIGZ1bmN0aW9uIChhLCBiKSB7IHJldHVybiBbYSwgYl07IH0pO1xufVxuLyoqXG4gKiBUaGUgZnVuY3Rpb24gaXMgcmV2ZXJzZSBvZiBgemlwYC4gVGFrZXMgYW4gYXJyYXkgb2YgcGFpcnMgYW5kIHJldHVybiB0d28gY29ycmVzcG9uZGluZyBhcnJheXNcbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgdW56aXAgfSBmcm9tICdmcC10cy9SZWFkb25seUFycmF5J1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwodW56aXAoW1sxLCAnYSddLCBbMiwgJ2InXSwgWzMsICdjJ11dKSwgW1sxLCAyLCAzXSwgWydhJywgJ2InLCAnYyddXSlcbiAqXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciB1bnppcCA9IGZ1bmN0aW9uIChhcykge1xuICAgIHZhciBmYSA9IFtdO1xuICAgIHZhciBmYiA9IFtdO1xuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgYXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgZmFbaV0gPSBhc1tpXVswXTtcbiAgICAgICAgZmJbaV0gPSBhc1tpXVsxXTtcbiAgICB9XG4gICAgcmV0dXJuIFtmYSwgZmJdO1xufTtcbi8qKlxuICogUHJlcGVuZCBhbiBlbGVtZW50IHRvIGV2ZXJ5IG1lbWJlciBvZiBhbiBhcnJheVxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBwcmVwZW5kQWxsIH0gZnJvbSAnZnAtdHMvUmVhZG9ubHlBcnJheSdcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKHByZXBlbmRBbGwoOSkoWzEsIDIsIDMsIDRdKSwgWzksIDEsIDksIDIsIDksIDMsIDksIDRdKVxuICpcbiAqIEBzaW5jZSAyLjEwLjBcbiAqL1xuZXhwb3J0IHZhciBwcmVwZW5kQWxsID0gZnVuY3Rpb24gKG1pZGRsZSkge1xuICAgIHZhciBmID0gUk5FQS5wcmVwZW5kQWxsKG1pZGRsZSk7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykgeyByZXR1cm4gKGlzTm9uRW1wdHkoYXMpID8gZihhcykgOiBhcyk7IH07XG59O1xuLyoqXG4gKiBQbGFjZXMgYW4gZWxlbWVudCBpbiBiZXR3ZWVuIG1lbWJlcnMgb2YgYW4gYXJyYXlcbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgaW50ZXJzcGVyc2UgfSBmcm9tICdmcC10cy9SZWFkb25seUFycmF5J1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoaW50ZXJzcGVyc2UoOSkoWzEsIDIsIDMsIDRdKSwgWzEsIDksIDIsIDksIDMsIDksIDRdKVxuICpcbiAqIEBzaW5jZSAyLjkuMFxuICovXG5leHBvcnQgdmFyIGludGVyc3BlcnNlID0gZnVuY3Rpb24gKG1pZGRsZSkge1xuICAgIHZhciBmID0gUk5FQS5pbnRlcnNwZXJzZShtaWRkbGUpO1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHsgcmV0dXJuIChpc05vbkVtcHR5KGFzKSA/IGYoYXMpIDogYXMpOyB9O1xufTtcbi8qKlxuICogUm90YXRlIGEgYFJlYWRvbmx5QXJyYXlgIGJ5IGBuYCBzdGVwcy5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgcm90YXRlIH0gZnJvbSAnZnAtdHMvUmVhZG9ubHlBcnJheSdcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKHJvdGF0ZSgyKShbMSwgMiwgMywgNCwgNV0pLCBbNCwgNSwgMSwgMiwgM10pXG4gKlxuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgcm90YXRlID0gZnVuY3Rpb24gKG4pIHtcbiAgICB2YXIgZiA9IFJORUEucm90YXRlKG4pO1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHsgcmV0dXJuIChpc05vbkVtcHR5KGFzKSA/IGYoYXMpIDogYXMpOyB9O1xufTtcbmV4cG9ydCBmdW5jdGlvbiBlbGVtKEUpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGEsIGFzKSB7XG4gICAgICAgIGlmIChhcyA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICB2YXIgZWxlbUVfMSA9IGVsZW0oRSk7XG4gICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7IHJldHVybiBlbGVtRV8xKGEsIGFzKTsgfTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgcHJlZGljYXRlID0gZnVuY3Rpb24gKGVsZW1lbnQpIHsgcmV0dXJuIEUuZXF1YWxzKGVsZW1lbnQsIGEpOyB9O1xuICAgICAgICB2YXIgaSA9IDA7XG4gICAgICAgIGZvciAoOyBpIDwgYXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIGlmIChwcmVkaWNhdGUoYXNbaV0pKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH07XG59XG4vKipcbiAqIFJlbW92ZSBkdXBsaWNhdGVzIGZyb20gYW4gYXJyYXksIGtlZXBpbmcgdGhlIGZpcnN0IG9jY3VycmVuY2Ugb2YgYW4gZWxlbWVudC5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgdW5pcSB9IGZyb20gJ2ZwLXRzL1JlYWRvbmx5QXJyYXknXG4gKiBpbXBvcnQgKiBhcyBOIGZyb20gJ2ZwLXRzL251bWJlcidcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKHVuaXEoTi5FcSkoWzEsIDIsIDFdKSwgWzEsIDJdKVxuICpcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIHVuaXEgPSBmdW5jdGlvbiAoRSkge1xuICAgIHZhciBmID0gUk5FQS51bmlxKEUpO1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHsgcmV0dXJuIChpc05vbkVtcHR5KGFzKSA/IGYoYXMpIDogYXMpOyB9O1xufTtcbi8qKlxuICogU29ydCB0aGUgZWxlbWVudHMgb2YgYW4gYXJyYXkgaW4gaW5jcmVhc2luZyBvcmRlciwgd2hlcmUgZWxlbWVudHMgYXJlIGNvbXBhcmVkIHVzaW5nIGZpcnN0IGBvcmRzWzBdYCwgdGhlbiBgb3Jkc1sxXWAsXG4gKiBldGMuLi5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgc29ydEJ5IH0gZnJvbSAnZnAtdHMvUmVhZG9ubHlBcnJheSdcbiAqIGltcG9ydCB7IGNvbnRyYW1hcCB9IGZyb20gJ2ZwLXRzL09yZCdcbiAqIGltcG9ydCAqIGFzIFMgZnJvbSAnZnAtdHMvc3RyaW5nJ1xuICogaW1wb3J0ICogYXMgTiBmcm9tICdmcC10cy9udW1iZXInXG4gKiBpbXBvcnQgeyBwaXBlIH0gZnJvbSAnZnAtdHMvZnVuY3Rpb24nXG4gKlxuICogaW50ZXJmYWNlIFBlcnNvbiB7XG4gKiAgIHJlYWRvbmx5IG5hbWU6IHN0cmluZ1xuICogICByZWFkb25seSBhZ2U6IG51bWJlclxuICogfVxuICogY29uc3QgYnlOYW1lID0gcGlwZShTLk9yZCwgY29udHJhbWFwKChwOiBQZXJzb24pID0+IHAubmFtZSkpXG4gKiBjb25zdCBieUFnZSA9IHBpcGUoTi5PcmQsIGNvbnRyYW1hcCgocDogUGVyc29uKSA9PiBwLmFnZSkpXG4gKlxuICogY29uc3Qgc29ydEJ5TmFtZUJ5QWdlID0gc29ydEJ5KFtieU5hbWUsIGJ5QWdlXSlcbiAqXG4gKiBjb25zdCBwZXJzb25zID0gW3sgbmFtZTogJ2EnLCBhZ2U6IDEgfSwgeyBuYW1lOiAnYicsIGFnZTogMyB9LCB7IG5hbWU6ICdjJywgYWdlOiAyIH0sIHsgbmFtZTogJ2InLCBhZ2U6IDIgfV1cbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoc29ydEJ5TmFtZUJ5QWdlKHBlcnNvbnMpLCBbXG4gKiAgIHsgbmFtZTogJ2EnLCBhZ2U6IDEgfSxcbiAqICAgeyBuYW1lOiAnYicsIGFnZTogMiB9LFxuICogICB7IG5hbWU6ICdiJywgYWdlOiAzIH0sXG4gKiAgIHsgbmFtZTogJ2MnLCBhZ2U6IDIgfVxuICogXSlcbiAqXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBzb3J0QnkgPSBmdW5jdGlvbiAob3Jkcykge1xuICAgIHZhciBmID0gUk5FQS5zb3J0Qnkob3Jkcyk7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykgeyByZXR1cm4gKGlzTm9uRW1wdHkoYXMpID8gZihhcykgOiBhcyk7IH07XG59O1xuLyoqXG4gKiBBIHVzZWZ1bCByZWN1cnNpb24gcGF0dGVybiBmb3IgcHJvY2Vzc2luZyBhIGBSZWFkb25seUFycmF5YCB0byBwcm9kdWNlIGEgbmV3IGBSZWFkb25seUFycmF5YCwgb2Z0ZW4gdXNlZCBmb3IgXCJjaG9wcGluZ1wiIHVwIHRoZSBpbnB1dFxuICogYFJlYWRvbmx5QXJyYXlgLiBUeXBpY2FsbHkgYGNob3BgIGlzIGNhbGxlZCB3aXRoIHNvbWUgZnVuY3Rpb24gdGhhdCB3aWxsIGNvbnN1bWUgYW4gaW5pdGlhbCBwcmVmaXggb2YgdGhlIGBSZWFkb25seUFycmF5YCBhbmQgcHJvZHVjZSBhXG4gKiB2YWx1ZSBhbmQgdGhlIHRhaWwgb2YgdGhlIGBSZWFkb25seUFycmF5YC5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgRXEgfSBmcm9tICdmcC10cy9FcSdcbiAqIGltcG9ydCAqIGFzIFJBIGZyb20gJ2ZwLXRzL1JlYWRvbmx5QXJyYXknXG4gKiBpbXBvcnQgKiBhcyBOIGZyb20gJ2ZwLXRzL251bWJlcidcbiAqIGltcG9ydCB7IHBpcGUgfSBmcm9tICdmcC10cy9mdW5jdGlvbidcbiAqXG4gKiBjb25zdCBncm91cCA9IDxBPihTOiBFcTxBPik6ICgoYXM6IFJlYWRvbmx5QXJyYXk8QT4pID0+IFJlYWRvbmx5QXJyYXk8UmVhZG9ubHlBcnJheTxBPj4pID0+IHtcbiAqICAgcmV0dXJuIFJBLmNob3AoYXMgPT4ge1xuICogICAgIGNvbnN0IHsgaW5pdCwgcmVzdCB9ID0gcGlwZShhcywgUkEuc3BhbkxlZnQoKGE6IEEpID0+IFMuZXF1YWxzKGEsIGFzWzBdKSkpXG4gKiAgICAgcmV0dXJuIFtpbml0LCByZXN0XVxuICogICB9KVxuICogfVxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChncm91cChOLkVxKShbMSwgMSwgMiwgMywgMywgNF0pLCBbWzEsIDFdLCBbMl0sIFszLCAzXSwgWzRdXSlcbiAqXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBjaG9wID0gZnVuY3Rpb24gKGYpIHtcbiAgICB2YXIgZyA9IFJORUEuY2hvcChmKTtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7IHJldHVybiAoaXNOb25FbXB0eShhcykgPyBnKGFzKSA6IGVtcHR5KTsgfTtcbn07XG4vKipcbiAqIFNwbGl0cyBhIGBSZWFkb25seUFycmF5YCBpbnRvIHR3byBwaWVjZXMsIHRoZSBmaXJzdCBwaWVjZSBoYXMgbWF4IGBuYCBlbGVtZW50cy5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgc3BsaXRBdCB9IGZyb20gJ2ZwLXRzL1JlYWRvbmx5QXJyYXknXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChzcGxpdEF0KDIpKFsxLCAyLCAzLCA0LCA1XSksIFtbMSwgMl0sIFszLCA0LCA1XV0pXG4gKlxuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgc3BsaXRBdCA9IGZ1bmN0aW9uIChuKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykge1xuICAgICAgICByZXR1cm4gbiA+PSAxICYmIGlzTm9uRW1wdHkoYXMpID8gUk5FQS5zcGxpdEF0KG4pKGFzKSA6IGlzRW1wdHkoYXMpID8gW2FzLCBlbXB0eV0gOiBbZW1wdHksIGFzXTtcbiAgICB9O1xufTtcbi8qKlxuICogU3BsaXRzIGEgYFJlYWRvbmx5QXJyYXlgIGludG8gbGVuZ3RoLWBuYCBwaWVjZXMuIFRoZSBsYXN0IHBpZWNlIHdpbGwgYmUgc2hvcnRlciBpZiBgbmAgZG9lcyBub3QgZXZlbmx5IGRpdmlkZSB0aGUgbGVuZ3RoIG9mXG4gKiB0aGUgYFJlYWRvbmx5QXJyYXlgLiBOb3RlIHRoYXQgYGNodW5rc09mKG4pKFtdKWAgaXMgYFtdYCwgbm90IGBbW11dYC4gVGhpcyBpcyBpbnRlbnRpb25hbCwgYW5kIGlzIGNvbnNpc3RlbnQgd2l0aCBhIHJlY3Vyc2l2ZVxuICogZGVmaW5pdGlvbiBvZiBgY2h1bmtzT2ZgOyBpdCBzYXRpc2ZpZXMgdGhlIHByb3BlcnR5IHRoYXQ6XG4gKlxuICogYGBgdHNcbiAqIGNodW5rc09mKG4pKHhzKS5jb25jYXQoY2h1bmtzT2YobikoeXMpKSA9PSBjaHVua3NPZihuKSh4cy5jb25jYXQoeXMpKSlcbiAqIGBgYFxuICpcbiAqIHdoZW5ldmVyIGBuYCBldmVubHkgZGl2aWRlcyB0aGUgbGVuZ3RoIG9mIGBhc2AuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IGNodW5rc09mIH0gZnJvbSAnZnAtdHMvUmVhZG9ubHlBcnJheSdcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKGNodW5rc09mKDIpKFsxLCAyLCAzLCA0LCA1XSksIFtbMSwgMl0sIFszLCA0XSwgWzVdXSlcbiAqXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBjaHVua3NPZiA9IGZ1bmN0aW9uIChuKSB7XG4gICAgdmFyIGYgPSBSTkVBLmNodW5rc09mKG4pO1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHsgcmV0dXJuIChpc05vbkVtcHR5KGFzKSA/IGYoYXMpIDogZW1wdHkpOyB9O1xufTtcbi8qKlxuICogQGNhdGVnb3J5IGxpZnRpbmdcbiAqIEBzaW5jZSAyLjExLjBcbiAqL1xuZXhwb3J0IHZhciBmcm9tT3B0aW9uSyA9IGZ1bmN0aW9uIChmKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIGEgPSBbXTtcbiAgICAgICAgZm9yICh2YXIgX2kgPSAwOyBfaSA8IGFyZ3VtZW50cy5sZW5ndGg7IF9pKyspIHtcbiAgICAgICAgICAgIGFbX2ldID0gYXJndW1lbnRzW19pXTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gZnJvbU9wdGlvbihmLmFwcGx5KHZvaWQgMCwgYSkpO1xuICAgIH07XG59O1xuZXhwb3J0IGZ1bmN0aW9uIGNvbXByZWhlbnNpb24oaW5wdXQsIGYsIGcpIHtcbiAgICBpZiAoZyA9PT0gdm9pZCAwKSB7IGcgPSBmdW5jdGlvbiAoKSB7IHJldHVybiB0cnVlOyB9OyB9XG4gICAgdmFyIGdvID0gZnVuY3Rpb24gKHNjb3BlLCBpbnB1dCkge1xuICAgICAgICByZXR1cm4gaXNOb25FbXB0eShpbnB1dClcbiAgICAgICAgICAgID8gZmxhdE1hcChSTkVBLmhlYWQoaW5wdXQpLCBmdW5jdGlvbiAoYSkgeyByZXR1cm4gZ28ocGlwZShzY29wZSwgYXBwZW5kKGEpKSwgUk5FQS50YWlsKGlucHV0KSk7IH0pXG4gICAgICAgICAgICA6IGcuYXBwbHkodm9pZCAwLCBzY29wZSkgPyBbZi5hcHBseSh2b2lkIDAsIHNjb3BlKV1cbiAgICAgICAgICAgICAgICA6IGVtcHR5O1xuICAgIH07XG4gICAgcmV0dXJuIGdvKGVtcHR5LCBpbnB1dCk7XG59XG4vKipcbiAqIEBzaW5jZSAyLjExLjBcbiAqL1xuZXhwb3J0IHZhciBjb25jYXRXID0gZnVuY3Rpb24gKHNlY29uZCkge1xuICAgIHJldHVybiBmdW5jdGlvbiAoZmlyc3QpIHtcbiAgICAgICAgcmV0dXJuIGlzRW1wdHkoZmlyc3QpID8gc2Vjb25kIDogaXNFbXB0eShzZWNvbmQpID8gZmlyc3QgOiBmaXJzdC5jb25jYXQoc2Vjb25kKTtcbiAgICB9O1xufTtcbi8qKlxuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIGNvbmNhdCA9IGNvbmNhdFc7XG5leHBvcnQgZnVuY3Rpb24gdW5pb24oRSkge1xuICAgIHZhciB1bmlvbkUgPSBSTkVBLnVuaW9uKEUpO1xuICAgIHJldHVybiBmdW5jdGlvbiAoZmlyc3QsIHNlY29uZCkge1xuICAgICAgICBpZiAoc2Vjb25kID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIHZhciB1bmlvbkVfMSA9IHVuaW9uKEUpO1xuICAgICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIChzZWNvbmQpIHsgcmV0dXJuIHVuaW9uRV8xKHNlY29uZCwgZmlyc3QpOyB9O1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBpc05vbkVtcHR5KGZpcnN0KSAmJiBpc05vbkVtcHR5KHNlY29uZCkgPyB1bmlvbkUoc2Vjb25kKShmaXJzdCkgOiBpc05vbkVtcHR5KGZpcnN0KSA/IGZpcnN0IDogc2Vjb25kO1xuICAgIH07XG59XG5leHBvcnQgZnVuY3Rpb24gaW50ZXJzZWN0aW9uKEUpIHtcbiAgICB2YXIgZWxlbUUgPSBlbGVtKEUpO1xuICAgIHJldHVybiBmdW5jdGlvbiAoeHMsIHlzKSB7XG4gICAgICAgIGlmICh5cyA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICB2YXIgaW50ZXJzZWN0aW9uRV8xID0gaW50ZXJzZWN0aW9uKEUpO1xuICAgICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uICh5cykgeyByZXR1cm4gaW50ZXJzZWN0aW9uRV8xKHlzLCB4cyk7IH07XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHhzLmZpbHRlcihmdW5jdGlvbiAoYSkgeyByZXR1cm4gZWxlbUUoYSwgeXMpOyB9KTtcbiAgICB9O1xufVxuZXhwb3J0IGZ1bmN0aW9uIGRpZmZlcmVuY2UoRSkge1xuICAgIHZhciBlbGVtRSA9IGVsZW0oRSk7XG4gICAgcmV0dXJuIGZ1bmN0aW9uICh4cywgeXMpIHtcbiAgICAgICAgaWYgKHlzID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIHZhciBkaWZmZXJlbmNlRV8xID0gZGlmZmVyZW5jZShFKTtcbiAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbiAoeXMpIHsgcmV0dXJuIGRpZmZlcmVuY2VFXzEoeXMsIHhzKTsgfTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4geHMuZmlsdGVyKGZ1bmN0aW9uIChhKSB7IHJldHVybiAhZWxlbUUoYSwgeXMpOyB9KTtcbiAgICB9O1xufVxudmFyIF9tYXAgPSBmdW5jdGlvbiAoZmEsIGYpIHsgcmV0dXJuIHBpcGUoZmEsIG1hcChmKSk7IH07XG52YXIgX21hcFdpdGhJbmRleCA9IGZ1bmN0aW9uIChmYSwgZikgeyByZXR1cm4gcGlwZShmYSwgbWFwV2l0aEluZGV4KGYpKTsgfTtcbnZhciBfYXAgPSBmdW5jdGlvbiAoZmFiLCBmYSkgeyByZXR1cm4gcGlwZShmYWIsIGFwKGZhKSk7IH07XG52YXIgX2ZpbHRlciA9IGZ1bmN0aW9uIChmYSwgcHJlZGljYXRlKSB7XG4gICAgcmV0dXJuIHBpcGUoZmEsIGZpbHRlcihwcmVkaWNhdGUpKTtcbn07XG52YXIgX2ZpbHRlck1hcCA9IGZ1bmN0aW9uIChmYSwgZikgeyByZXR1cm4gcGlwZShmYSwgZmlsdGVyTWFwKGYpKTsgfTtcbnZhciBfcGFydGl0aW9uID0gZnVuY3Rpb24gKGZhLCBwcmVkaWNhdGUpIHtcbiAgICByZXR1cm4gcGlwZShmYSwgcGFydGl0aW9uKHByZWRpY2F0ZSkpO1xufTtcbnZhciBfcGFydGl0aW9uTWFwID0gZnVuY3Rpb24gKGZhLCBmKSB7IHJldHVybiBwaXBlKGZhLCBwYXJ0aXRpb25NYXAoZikpOyB9O1xudmFyIF9wYXJ0aXRpb25XaXRoSW5kZXggPSBmdW5jdGlvbiAoZmEsIHByZWRpY2F0ZVdpdGhJbmRleCkgeyByZXR1cm4gcGlwZShmYSwgcGFydGl0aW9uV2l0aEluZGV4KHByZWRpY2F0ZVdpdGhJbmRleCkpOyB9O1xudmFyIF9wYXJ0aXRpb25NYXBXaXRoSW5kZXggPSBmdW5jdGlvbiAoZmEsIGYpIHsgcmV0dXJuIHBpcGUoZmEsIHBhcnRpdGlvbk1hcFdpdGhJbmRleChmKSk7IH07XG52YXIgX2FsdCA9IGZ1bmN0aW9uIChmYSwgdGhhdCkgeyByZXR1cm4gcGlwZShmYSwgYWx0KHRoYXQpKTsgfTtcbnZhciBfcmVkdWNlID0gZnVuY3Rpb24gKGZhLCBiLCBmKSB7IHJldHVybiBwaXBlKGZhLCByZWR1Y2UoYiwgZikpOyB9O1xudmFyIF9mb2xkTWFwID0gZnVuY3Rpb24gKE0pIHtcbiAgICB2YXIgZm9sZE1hcE0gPSBmb2xkTWFwKE0pO1xuICAgIHJldHVybiBmdW5jdGlvbiAoZmEsIGYpIHsgcmV0dXJuIHBpcGUoZmEsIGZvbGRNYXBNKGYpKTsgfTtcbn07XG52YXIgX3JlZHVjZVJpZ2h0ID0gZnVuY3Rpb24gKGZhLCBiLCBmKSB7IHJldHVybiBwaXBlKGZhLCByZWR1Y2VSaWdodChiLCBmKSk7IH07XG52YXIgX3JlZHVjZVdpdGhJbmRleCA9IGZ1bmN0aW9uIChmYSwgYiwgZikge1xuICAgIHJldHVybiBwaXBlKGZhLCByZWR1Y2VXaXRoSW5kZXgoYiwgZikpO1xufTtcbnZhciBfZm9sZE1hcFdpdGhJbmRleCA9IGZ1bmN0aW9uIChNKSB7XG4gICAgdmFyIGZvbGRNYXBXaXRoSW5kZXhNID0gZm9sZE1hcFdpdGhJbmRleChNKTtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGZhLCBmKSB7IHJldHVybiBwaXBlKGZhLCBmb2xkTWFwV2l0aEluZGV4TShmKSk7IH07XG59O1xudmFyIF9yZWR1Y2VSaWdodFdpdGhJbmRleCA9IGZ1bmN0aW9uIChmYSwgYiwgZikge1xuICAgIHJldHVybiBwaXBlKGZhLCByZWR1Y2VSaWdodFdpdGhJbmRleChiLCBmKSk7XG59O1xudmFyIF9maWx0ZXJNYXBXaXRoSW5kZXggPSBmdW5jdGlvbiAoZmEsIGYpIHsgcmV0dXJuIHBpcGUoZmEsIGZpbHRlck1hcFdpdGhJbmRleChmKSk7IH07XG52YXIgX2ZpbHRlcldpdGhJbmRleCA9IGZ1bmN0aW9uIChmYSwgcHJlZGljYXRlV2l0aEluZGV4KSB7IHJldHVybiBwaXBlKGZhLCBmaWx0ZXJXaXRoSW5kZXgocHJlZGljYXRlV2l0aEluZGV4KSk7IH07XG52YXIgX2V4dGVuZCA9IGZ1bmN0aW9uIChmYSwgZikgeyByZXR1cm4gcGlwZShmYSwgZXh0ZW5kKGYpKTsgfTtcbnZhciBfdHJhdmVyc2UgPSBmdW5jdGlvbiAoRikge1xuICAgIHZhciB0cmF2ZXJzZUYgPSB0cmF2ZXJzZShGKTtcbiAgICByZXR1cm4gZnVuY3Rpb24gKHRhLCBmKSB7IHJldHVybiBwaXBlKHRhLCB0cmF2ZXJzZUYoZikpOyB9O1xufTtcbi8qIGlzdGFuYnVsIGlnbm9yZSBuZXh0ICovXG52YXIgX3RyYXZlcnNlV2l0aEluZGV4ID0gZnVuY3Rpb24gKEYpIHtcbiAgICB2YXIgdHJhdmVyc2VXaXRoSW5kZXhGID0gdHJhdmVyc2VXaXRoSW5kZXgoRik7XG4gICAgcmV0dXJuIGZ1bmN0aW9uICh0YSwgZikgeyByZXR1cm4gcGlwZSh0YSwgdHJhdmVyc2VXaXRoSW5kZXhGKGYpKTsgfTtcbn07XG4vKiogQGludGVybmFsICovXG5leHBvcnQgdmFyIF9jaGFpblJlY0RlcHRoRmlyc3QgPSBmdW5jdGlvbiAoYSwgZikgeyByZXR1cm4gcGlwZShhLCBjaGFpblJlY0RlcHRoRmlyc3QoZikpOyB9O1xuLyoqIEBpbnRlcm5hbCAqL1xuZXhwb3J0IHZhciBfY2hhaW5SZWNCcmVhZHRoRmlyc3QgPSBmdW5jdGlvbiAoYSwgZikgeyByZXR1cm4gcGlwZShhLCBjaGFpblJlY0JyZWFkdGhGaXJzdChmKSk7IH07XG4vKipcbiAqIEBjYXRlZ29yeSBjb25zdHJ1Y3RvcnNcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIG9mID0gUk5FQS5vZjtcbi8qKlxuICogQHNpbmNlIDIuNy4wXG4gKi9cbmV4cG9ydCB2YXIgemVybyA9IGZ1bmN0aW9uICgpIHsgcmV0dXJuIGVtcHR5OyB9O1xuLyoqXG4gKiBMZXNzIHN0cmljdCB2ZXJzaW9uIG9mIFtgYWx0YF0oI2FsdCkuXG4gKlxuICogVGhlIGBXYCBzdWZmaXggKHNob3J0IGZvciAqKlcqKmlkZW5pbmcpIG1lYW5zIHRoYXQgdGhlIHJldHVybiB0eXBlcyB3aWxsIGJlIG1lcmdlZC5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0ICogYXMgUkEgZnJvbSAnZnAtdHMvUmVhZG9ubHlBcnJheSdcbiAqIGltcG9ydCB7IHBpcGUgfSBmcm9tICdmcC10cy9mdW5jdGlvbidcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKFxuICogICBwaXBlKFxuICogICAgIFsxLCAyLCAzXSxcbiAqICAgICBSQS5hbHRXKCgpID0+IFsnYScsICdiJ10pXG4gKiAgICksXG4gKiAgIFsxLCAyLCAzLCAnYScsICdiJ11cbiAqIClcbiAqXG4gKiBAY2F0ZWdvcnkgZXJyb3IgaGFuZGxpbmdcbiAqIEBzaW5jZSAyLjkuMFxuICovXG5leHBvcnQgdmFyIGFsdFcgPSBmdW5jdGlvbiAodGhhdCkge1xuICAgIHJldHVybiBmdW5jdGlvbiAoZmEpIHtcbiAgICAgICAgcmV0dXJuIGZhLmNvbmNhdCh0aGF0KCkpO1xuICAgIH07XG59O1xuLyoqXG4gKiBJZGVudGlmaWVzIGFuIGFzc29jaWF0aXZlIG9wZXJhdGlvbiBvbiBhIHR5cGUgY29uc3RydWN0b3IuIEl0IGlzIHNpbWlsYXIgdG8gYFNlbWlncm91cGAsIGV4Y2VwdCB0aGF0IGl0IGFwcGxpZXMgdG9cbiAqIHR5cGVzIG9mIGtpbmQgYCogLT4gKmAuXG4gKlxuICogSW4gY2FzZSBvZiBgUmVhZG9ubHlBcnJheWAgY29uY2F0ZW5hdGVzIHRoZSBpbnB1dHMgaW50byBhIHNpbmdsZSBhcnJheS5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0ICogYXMgUkEgZnJvbSAnZnAtdHMvUmVhZG9ubHlBcnJheSdcbiAqIGltcG9ydCB7IHBpcGUgfSBmcm9tICdmcC10cy9mdW5jdGlvbidcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKFxuICogICBwaXBlKFxuICogICAgIFsxLCAyLCAzXSxcbiAqICAgICBSQS5hbHQoKCkgPT4gWzQsIDVdKVxuICogICApLFxuICogICBbMSwgMiwgMywgNCwgNV1cbiAqIClcbiAqXG4gKiBAY2F0ZWdvcnkgZXJyb3IgaGFuZGxpbmdcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIGFsdCA9IGFsdFc7XG4vKipcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIGFwID0gZnVuY3Rpb24gKGZhKSB7XG4gICAgcmV0dXJuIGZsYXRNYXAoZnVuY3Rpb24gKGYpIHsgcmV0dXJuIHBpcGUoZmEsIG1hcChmKSk7IH0pO1xufTtcbi8qKlxuICogQ29tcG9zZXMgY29tcHV0YXRpb25zIGluIHNlcXVlbmNlLCB1c2luZyB0aGUgcmV0dXJuIHZhbHVlIG9mIG9uZSBjb21wdXRhdGlvbiB0byBkZXRlcm1pbmUgdGhlIG5leHQgY29tcHV0YXRpb24uXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCAqIGFzIFJBIGZyb20gJ2ZwLXRzL1JlYWRvbmx5QXJyYXknXG4gKiBpbXBvcnQgeyBwaXBlIH0gZnJvbSAnZnAtdHMvZnVuY3Rpb24nXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChcbiAqICAgcGlwZShcbiAqICAgICBbMSwgMiwgM10sXG4gKiAgICAgUkEuZmxhdE1hcCgobikgPT4gW2BhJHtufWAsIGBiJHtufWBdKVxuICogICApLFxuICogICBbJ2ExJywgJ2IxJywgJ2EyJywgJ2IyJywgJ2EzJywgJ2IzJ11cbiAqIClcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoXG4gKiAgIHBpcGUoXG4gKiAgICAgWzEsIDIsIDNdLFxuICogICAgIFJBLmZsYXRNYXAoKCkgPT4gW10pXG4gKiAgICksXG4gKiAgIFtdXG4gKiApXG4gKlxuICogQGNhdGVnb3J5IHNlcXVlbmNpbmdcbiAqIEBzaW5jZSAyLjE0LjBcbiAqL1xuZXhwb3J0IHZhciBmbGF0TWFwID0gLyojX19QVVJFX18qLyBkdWFsKDIsIGZ1bmN0aW9uIChtYSwgZikge1xuICAgIHJldHVybiBwaXBlKG1hLCBjaGFpbldpdGhJbmRleChmdW5jdGlvbiAoaSwgYSkgeyByZXR1cm4gZihhLCBpKTsgfSkpO1xufSk7XG4vKipcbiAqIEBjYXRlZ29yeSBzZXF1ZW5jaW5nXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBmbGF0dGVuID0gLyojX19QVVJFX18qLyBmbGF0TWFwKGlkZW50aXR5KTtcbi8qKlxuICogYG1hcGAgY2FuIGJlIHVzZWQgdG8gdHVybiBmdW5jdGlvbnMgYChhOiBBKSA9PiBCYCBpbnRvIGZ1bmN0aW9ucyBgKGZhOiBGPEE+KSA9PiBGPEI+YCB3aG9zZSBhcmd1bWVudCBhbmQgcmV0dXJuIHR5cGVzXG4gKiB1c2UgdGhlIHR5cGUgY29uc3RydWN0b3IgYEZgIHRvIHJlcHJlc2VudCBzb21lIGNvbXB1dGF0aW9uYWwgY29udGV4dC5cbiAqXG4gKiBAY2F0ZWdvcnkgbWFwcGluZ1xuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgbWFwID0gZnVuY3Rpb24gKGYpIHsgcmV0dXJuIGZ1bmN0aW9uIChmYSkge1xuICAgIHJldHVybiBmYS5tYXAoZnVuY3Rpb24gKGEpIHsgcmV0dXJuIGYoYSk7IH0pO1xufTsgfTtcbi8qKlxuICogQGNhdGVnb3J5IG1hcHBpbmdcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIG1hcFdpdGhJbmRleCA9IGZ1bmN0aW9uIChmKSB7IHJldHVybiBmdW5jdGlvbiAoZmEpIHtcbiAgICByZXR1cm4gZmEubWFwKGZ1bmN0aW9uIChhLCBpKSB7IHJldHVybiBmKGksIGEpOyB9KTtcbn07IH07XG4vKipcbiAqIEBjYXRlZ29yeSBmaWx0ZXJpbmdcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIHNlcGFyYXRlID0gZnVuY3Rpb24gKGZhKSB7XG4gICAgdmFyIGxlZnQgPSBbXTtcbiAgICB2YXIgcmlnaHQgPSBbXTtcbiAgICBmb3IgKHZhciBfaSA9IDAsIGZhXzEgPSBmYTsgX2kgPCBmYV8xLmxlbmd0aDsgX2krKykge1xuICAgICAgICB2YXIgZSA9IGZhXzFbX2ldO1xuICAgICAgICBpZiAoZS5fdGFnID09PSAnTGVmdCcpIHtcbiAgICAgICAgICAgIGxlZnQucHVzaChlLmxlZnQpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgcmlnaHQucHVzaChlLnJpZ2h0KTtcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gc2VwYXJhdGVkKGxlZnQsIHJpZ2h0KTtcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBmaWx0ZXJpbmdcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIGZpbHRlciA9IGZ1bmN0aW9uIChwcmVkaWNhdGUpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIHJldHVybiBhcy5maWx0ZXIocHJlZGljYXRlKTtcbiAgICB9O1xufTtcbi8qKlxuICogQGNhdGVnb3J5IGZpbHRlcmluZ1xuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgZmlsdGVyTWFwV2l0aEluZGV4ID0gZnVuY3Rpb24gKGYpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGZhKSB7XG4gICAgICAgIHZhciBvdXQgPSBbXTtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBmYS5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgdmFyIG9wdGlvbkIgPSBmKGksIGZhW2ldKTtcbiAgICAgICAgICAgIGlmIChfLmlzU29tZShvcHRpb25CKSkge1xuICAgICAgICAgICAgICAgIG91dC5wdXNoKG9wdGlvbkIudmFsdWUpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBvdXQ7XG4gICAgfTtcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBmaWx0ZXJpbmdcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIGZpbHRlck1hcCA9IGZ1bmN0aW9uIChmKSB7XG4gICAgcmV0dXJuIGZpbHRlck1hcFdpdGhJbmRleChmdW5jdGlvbiAoXywgYSkgeyByZXR1cm4gZihhKTsgfSk7XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgZmlsdGVyaW5nXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBjb21wYWN0ID0gLyojX19QVVJFX18qLyBmaWx0ZXJNYXAoaWRlbnRpdHkpO1xuLyoqXG4gKiBAY2F0ZWdvcnkgZmlsdGVyaW5nXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBwYXJ0aXRpb24gPSBmdW5jdGlvbiAocHJlZGljYXRlKSB7XG4gICAgcmV0dXJuIHBhcnRpdGlvbldpdGhJbmRleChmdW5jdGlvbiAoXywgYSkgeyByZXR1cm4gcHJlZGljYXRlKGEpOyB9KTtcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBmaWx0ZXJpbmdcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIHBhcnRpdGlvbldpdGhJbmRleCA9IGZ1bmN0aW9uIChwcmVkaWNhdGVXaXRoSW5kZXgpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIHZhciBsZWZ0ID0gW107XG4gICAgICAgIHZhciByaWdodCA9IFtdO1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGFzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICB2YXIgYSA9IGFzW2ldO1xuICAgICAgICAgICAgaWYgKHByZWRpY2F0ZVdpdGhJbmRleChpLCBhKSkge1xuICAgICAgICAgICAgICAgIHJpZ2h0LnB1c2goYSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBsZWZ0LnB1c2goYSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHNlcGFyYXRlZChsZWZ0LCByaWdodCk7XG4gICAgfTtcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBmaWx0ZXJpbmdcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIHBhcnRpdGlvbk1hcCA9IGZ1bmN0aW9uIChmKSB7XG4gICAgcmV0dXJuIHBhcnRpdGlvbk1hcFdpdGhJbmRleChmdW5jdGlvbiAoXywgYSkgeyByZXR1cm4gZihhKTsgfSk7XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgZmlsdGVyaW5nXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBwYXJ0aXRpb25NYXBXaXRoSW5kZXggPSBmdW5jdGlvbiAoZikge1xuICAgIHJldHVybiBmdW5jdGlvbiAoZmEpIHtcbiAgICAgICAgdmFyIGxlZnQgPSBbXTtcbiAgICAgICAgdmFyIHJpZ2h0ID0gW107XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgZmEubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIHZhciBlID0gZihpLCBmYVtpXSk7XG4gICAgICAgICAgICBpZiAoZS5fdGFnID09PSAnTGVmdCcpIHtcbiAgICAgICAgICAgICAgICBsZWZ0LnB1c2goZS5sZWZ0KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHJpZ2h0LnB1c2goZS5yaWdodCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHNlcGFyYXRlZChsZWZ0LCByaWdodCk7XG4gICAgfTtcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBmaWx0ZXJpbmdcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIGZpbHRlcldpdGhJbmRleCA9IGZ1bmN0aW9uIChwcmVkaWNhdGVXaXRoSW5kZXgpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIHJldHVybiBhcy5maWx0ZXIoZnVuY3Rpb24gKGEsIGkpIHsgcmV0dXJuIHByZWRpY2F0ZVdpdGhJbmRleChpLCBhKTsgfSk7XG4gICAgfTtcbn07XG4vKipcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIGV4dGVuZCA9IGZ1bmN0aW9uIChmKSB7IHJldHVybiBmdW5jdGlvbiAod2EpIHtcbiAgICByZXR1cm4gd2EubWFwKGZ1bmN0aW9uIChfLCBpKSB7IHJldHVybiBmKHdhLnNsaWNlKGkpKTsgfSk7XG59OyB9O1xuLyoqXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBkdXBsaWNhdGUgPSAvKiNfX1BVUkVfXyovIGV4dGVuZChpZGVudGl0eSk7XG4vKipcbiAqIEBjYXRlZ29yeSBmb2xkaW5nXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBmb2xkTWFwV2l0aEluZGV4ID0gZnVuY3Rpb24gKE0pIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGYpIHtcbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIChmYSkge1xuICAgICAgICAgICAgcmV0dXJuIGZhLnJlZHVjZShmdW5jdGlvbiAoYiwgYSwgaSkgeyByZXR1cm4gTS5jb25jYXQoYiwgZihpLCBhKSk7IH0sIE0uZW1wdHkpO1xuICAgICAgICB9O1xuICAgIH07XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgZm9sZGluZ1xuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgcmVkdWNlID0gZnVuY3Rpb24gKGIsIGYpIHtcbiAgICByZXR1cm4gcmVkdWNlV2l0aEluZGV4KGIsIGZ1bmN0aW9uIChfLCBiLCBhKSB7IHJldHVybiBmKGIsIGEpOyB9KTtcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBmb2xkaW5nXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBmb2xkTWFwID0gZnVuY3Rpb24gKE0pIHtcbiAgICB2YXIgZm9sZE1hcFdpdGhJbmRleE0gPSBmb2xkTWFwV2l0aEluZGV4KE0pO1xuICAgIHJldHVybiBmdW5jdGlvbiAoZikgeyByZXR1cm4gZm9sZE1hcFdpdGhJbmRleE0oZnVuY3Rpb24gKF8sIGEpIHsgcmV0dXJuIGYoYSk7IH0pOyB9O1xufTtcbi8qKlxuICogQGNhdGVnb3J5IGZvbGRpbmdcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIHJlZHVjZVdpdGhJbmRleCA9IGZ1bmN0aW9uIChiLCBmKSB7IHJldHVybiBmdW5jdGlvbiAoZmEpIHtcbiAgICB2YXIgbGVuID0gZmEubGVuZ3RoO1xuICAgIHZhciBvdXQgPSBiO1xuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbGVuOyBpKyspIHtcbiAgICAgICAgb3V0ID0gZihpLCBvdXQsIGZhW2ldKTtcbiAgICB9XG4gICAgcmV0dXJuIG91dDtcbn07IH07XG4vKipcbiAqIEBjYXRlZ29yeSBmb2xkaW5nXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciByZWR1Y2VSaWdodCA9IGZ1bmN0aW9uIChiLCBmKSB7XG4gICAgcmV0dXJuIHJlZHVjZVJpZ2h0V2l0aEluZGV4KGIsIGZ1bmN0aW9uIChfLCBhLCBiKSB7IHJldHVybiBmKGEsIGIpOyB9KTtcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBmb2xkaW5nXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciByZWR1Y2VSaWdodFdpdGhJbmRleCA9IGZ1bmN0aW9uIChiLCBmKSB7IHJldHVybiBmdW5jdGlvbiAoZmEpIHtcbiAgICByZXR1cm4gZmEucmVkdWNlUmlnaHQoZnVuY3Rpb24gKGIsIGEsIGkpIHsgcmV0dXJuIGYoaSwgYSwgYik7IH0sIGIpO1xufTsgfTtcbi8qKlxuICogQGNhdGVnb3J5IHRyYXZlcnNpbmdcbiAqIEBzaW5jZSAyLjYuM1xuICovXG5leHBvcnQgdmFyIHRyYXZlcnNlID0gZnVuY3Rpb24gKEYpIHtcbiAgICB2YXIgdHJhdmVyc2VXaXRoSW5kZXhGID0gdHJhdmVyc2VXaXRoSW5kZXgoRik7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChmKSB7IHJldHVybiB0cmF2ZXJzZVdpdGhJbmRleEYoZnVuY3Rpb24gKF8sIGEpIHsgcmV0dXJuIGYoYSk7IH0pOyB9O1xufTtcbi8qKlxuICogQGNhdGVnb3J5IHRyYXZlcnNpbmdcbiAqIEBzaW5jZSAyLjYuM1xuICovXG5leHBvcnQgdmFyIHNlcXVlbmNlID0gZnVuY3Rpb24gKEYpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKHRhKSB7XG4gICAgICAgIHJldHVybiBfcmVkdWNlKHRhLCBGLm9mKHplcm8oKSksIGZ1bmN0aW9uIChmYXMsIGZhKSB7XG4gICAgICAgICAgICByZXR1cm4gRi5hcChGLm1hcChmYXMsIGZ1bmN0aW9uIChhcykgeyByZXR1cm4gZnVuY3Rpb24gKGEpIHsgcmV0dXJuIHBpcGUoYXMsIGFwcGVuZChhKSk7IH07IH0pLCBmYSk7XG4gICAgICAgIH0pO1xuICAgIH07XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgc2VxdWVuY2luZ1xuICogQHNpbmNlIDIuNi4zXG4gKi9cbmV4cG9ydCB2YXIgdHJhdmVyc2VXaXRoSW5kZXggPSBmdW5jdGlvbiAoRikge1xuICAgIHJldHVybiBmdW5jdGlvbiAoZikge1xuICAgICAgICByZXR1cm4gcmVkdWNlV2l0aEluZGV4KEYub2YoemVybygpKSwgZnVuY3Rpb24gKGksIGZicywgYSkge1xuICAgICAgICAgICAgcmV0dXJuIEYuYXAoRi5tYXAoZmJzLCBmdW5jdGlvbiAoYnMpIHsgcmV0dXJuIGZ1bmN0aW9uIChiKSB7IHJldHVybiBwaXBlKGJzLCBhcHBlbmQoYikpOyB9OyB9KSwgZihpLCBhKSk7XG4gICAgICAgIH0pO1xuICAgIH07XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgZmlsdGVyaW5nXG4gKiBAc2luY2UgMi42LjVcbiAqL1xuZXhwb3J0IHZhciB3aXRoZXIgPSBmdW5jdGlvbiAoRikge1xuICAgIHZhciBfd2l0aGVyRiA9IF93aXRoZXIoRik7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChmKSB7IHJldHVybiBmdW5jdGlvbiAoZmEpIHsgcmV0dXJuIF93aXRoZXJGKGZhLCBmKTsgfTsgfTtcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBmaWx0ZXJpbmdcbiAqIEBzaW5jZSAyLjYuNVxuICovXG5leHBvcnQgdmFyIHdpbHQgPSBmdW5jdGlvbiAoRikge1xuICAgIHZhciBfd2lsdEYgPSBfd2lsdChGKTtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGYpIHsgcmV0dXJuIGZ1bmN0aW9uIChmYSkgeyByZXR1cm4gX3dpbHRGKGZhLCBmKTsgfTsgfTtcbn07XG4vKipcbiAqIEBzaW5jZSAyLjYuNlxuICovXG5leHBvcnQgdmFyIHVuZm9sZCA9IGZ1bmN0aW9uIChiLCBmKSB7XG4gICAgdmFyIG91dCA9IFtdO1xuICAgIHZhciBiYiA9IGI7XG4gICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG5vLWNvbnN0YW50LWNvbmRpdGlvblxuICAgIHdoaWxlICh0cnVlKSB7XG4gICAgICAgIHZhciBtdCA9IGYoYmIpO1xuICAgICAgICBpZiAoXy5pc1NvbWUobXQpKSB7XG4gICAgICAgICAgICB2YXIgX2EgPSBtdC52YWx1ZSwgYSA9IF9hWzBdLCBiXzEgPSBfYVsxXTtcbiAgICAgICAgICAgIG91dC5wdXNoKGEpO1xuICAgICAgICAgICAgYmIgPSBiXzE7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gb3V0O1xufTtcbi8qKlxuICogQGNhdGVnb3J5IHR5cGUgbGFtYmRhc1xuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgVVJJID0gJ1JlYWRvbmx5QXJyYXknO1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBnZXRTaG93ID0gZnVuY3Rpb24gKFMpIHsgcmV0dXJuICh7XG4gICAgc2hvdzogZnVuY3Rpb24gKGFzKSB7IHJldHVybiBcIltcIi5jb25jYXQoYXMubWFwKFMuc2hvdykuam9pbignLCAnKSwgXCJdXCIpOyB9XG59KTsgfTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgZ2V0U2VtaWdyb3VwID0gZnVuY3Rpb24gKCkgeyByZXR1cm4gKHtcbiAgICBjb25jYXQ6IGZ1bmN0aW9uIChmaXJzdCwgc2Vjb25kKSB7IHJldHVybiAoaXNFbXB0eShmaXJzdCkgPyBzZWNvbmQgOiBpc0VtcHR5KHNlY29uZCkgPyBmaXJzdCA6IGZpcnN0LmNvbmNhdChzZWNvbmQpKTsgfVxufSk7IH07XG4vKipcbiAqIFJldHVybnMgYSBgTW9ub2lkYCBmb3IgYFJlYWRvbmx5QXJyYXk8QT5gLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBnZXRNb25vaWQgfSBmcm9tICdmcC10cy9SZWFkb25seUFycmF5J1xuICpcbiAqIGNvbnN0IE0gPSBnZXRNb25vaWQ8bnVtYmVyPigpXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKE0uY29uY2F0KFsxLCAyXSwgWzMsIDRdKSwgWzEsIDIsIDMsIDRdKVxuICpcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIGdldE1vbm9pZCA9IGZ1bmN0aW9uICgpIHsgcmV0dXJuICh7XG4gICAgY29uY2F0OiBnZXRTZW1pZ3JvdXAoKS5jb25jYXQsXG4gICAgZW1wdHk6IGVtcHR5XG59KTsgfTtcbi8qKlxuICogRGVyaXZlcyBhbiBgRXFgIG92ZXIgdGhlIGBSZWFkb25seUFycmF5YCBvZiBhIGdpdmVuIGVsZW1lbnQgdHlwZSBmcm9tIHRoZSBgRXFgIG9mIHRoYXQgdHlwZS4gVGhlIGRlcml2ZWQgYEVxYCBkZWZpbmVzIHR3b1xuICogYXJyYXlzIGFzIGVxdWFsIGlmIGFsbCBlbGVtZW50cyBvZiBib3RoIGFycmF5cyBhcmUgY29tcGFyZWQgZXF1YWwgcGFpcndpc2Ugd2l0aCB0aGUgZ2l2ZW4gYEVgLiBJbiBjYXNlIG9mIGFycmF5cyBvZlxuICogZGlmZmVyZW50IGxlbmd0aHMsIHRoZSByZXN1bHQgaXMgbm9uIGVxdWFsaXR5LlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgKiBhcyBTIGZyb20gJ2ZwLXRzL3N0cmluZydcbiAqIGltcG9ydCB7IGdldEVxIH0gZnJvbSAnZnAtdHMvUmVhZG9ubHlBcnJheSdcbiAqXG4gKiBjb25zdCBFID0gZ2V0RXEoUy5FcSlcbiAqIGFzc2VydC5zdHJpY3RFcXVhbChFLmVxdWFscyhbJ2EnLCAnYiddLCBbJ2EnLCAnYiddKSwgdHJ1ZSlcbiAqIGFzc2VydC5zdHJpY3RFcXVhbChFLmVxdWFscyhbJ2EnXSwgW10pLCBmYWxzZSlcbiAqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBnZXRFcSA9IGZ1bmN0aW9uIChFKSB7XG4gICAgcmV0dXJuIGZyb21FcXVhbHMoZnVuY3Rpb24gKHhzLCB5cykgeyByZXR1cm4geHMubGVuZ3RoID09PSB5cy5sZW5ndGggJiYgeHMuZXZlcnkoZnVuY3Rpb24gKHgsIGkpIHsgcmV0dXJuIEUuZXF1YWxzKHgsIHlzW2ldKTsgfSk7IH0pO1xufTtcbi8qKlxuICogRGVyaXZlcyBhbiBgT3JkYCBvdmVyIHRoZSBgUmVhZG9ubHlBcnJheWAgb2YgYSBnaXZlbiBlbGVtZW50IHR5cGUgZnJvbSB0aGUgYE9yZGAgb2YgdGhhdCB0eXBlLiBUaGUgb3JkZXJpbmcgYmV0d2VlbiB0d28gc3VjaFxuICogYXJyYXlzIGlzIGVxdWFsIHRvOiB0aGUgZmlyc3Qgbm9uIGVxdWFsIGNvbXBhcmlzb24gb2YgZWFjaCBhcnJheXMgZWxlbWVudHMgdGFrZW4gcGFpcndpc2UgaW4gaW5jcmVhc2luZyBvcmRlciwgaW5cbiAqIGNhc2Ugb2YgZXF1YWxpdHkgb3ZlciBhbGwgdGhlIHBhaXJ3aXNlIGVsZW1lbnRzOyB0aGUgbG9uZ2VzdCBhcnJheSBpcyBjb25zaWRlcmVkIHRoZSBncmVhdGVzdCwgaWYgYm90aCBhcnJheXMgaGF2ZVxuICogdGhlIHNhbWUgbGVuZ3RoLCB0aGUgcmVzdWx0IGlzIGVxdWFsaXR5LlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBnZXRPcmQgfSBmcm9tICdmcC10cy9SZWFkb25seUFycmF5J1xuICogaW1wb3J0ICogYXMgUyBmcm9tICdmcC10cy9zdHJpbmcnXG4gKlxuICogY29uc3QgTyA9IGdldE9yZChTLk9yZClcbiAqIGFzc2VydC5zdHJpY3RFcXVhbChPLmNvbXBhcmUoWydiJ10sIFsnYSddKSwgMSlcbiAqIGFzc2VydC5zdHJpY3RFcXVhbChPLmNvbXBhcmUoWydhJ10sIFsnYSddKSwgMClcbiAqIGFzc2VydC5zdHJpY3RFcXVhbChPLmNvbXBhcmUoWydhJ10sIFsnYiddKSwgLTEpXG4gKlxuICpcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIGdldE9yZCA9IGZ1bmN0aW9uIChPKSB7XG4gICAgcmV0dXJuIGZyb21Db21wYXJlKGZ1bmN0aW9uIChhLCBiKSB7XG4gICAgICAgIHZhciBhTGVuID0gYS5sZW5ndGg7XG4gICAgICAgIHZhciBiTGVuID0gYi5sZW5ndGg7XG4gICAgICAgIHZhciBsZW4gPSBNYXRoLm1pbihhTGVuLCBiTGVuKTtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBsZW47IGkrKykge1xuICAgICAgICAgICAgdmFyIG9yZGVyaW5nID0gTy5jb21wYXJlKGFbaV0sIGJbaV0pO1xuICAgICAgICAgICAgaWYgKG9yZGVyaW5nICE9PSAwKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG9yZGVyaW5nO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBOLk9yZC5jb21wYXJlKGFMZW4sIGJMZW4pO1xuICAgIH0pO1xufTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIGdldFVuaW9uU2VtaWdyb3VwID0gZnVuY3Rpb24gKEUpIHtcbiAgICB2YXIgdW5pb25FID0gdW5pb24oRSk7XG4gICAgcmV0dXJuIHtcbiAgICAgICAgY29uY2F0OiBmdW5jdGlvbiAoZmlyc3QsIHNlY29uZCkgeyByZXR1cm4gdW5pb25FKHNlY29uZCkoZmlyc3QpOyB9XG4gICAgfTtcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjExLjBcbiAqL1xuZXhwb3J0IHZhciBnZXRVbmlvbk1vbm9pZCA9IGZ1bmN0aW9uIChFKSB7IHJldHVybiAoe1xuICAgIGNvbmNhdDogZ2V0VW5pb25TZW1pZ3JvdXAoRSkuY29uY2F0LFxuICAgIGVtcHR5OiBlbXB0eVxufSk7IH07XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjExLjBcbiAqL1xuZXhwb3J0IHZhciBnZXRJbnRlcnNlY3Rpb25TZW1pZ3JvdXAgPSBmdW5jdGlvbiAoRSkge1xuICAgIHZhciBpbnRlcnNlY3Rpb25FID0gaW50ZXJzZWN0aW9uKEUpO1xuICAgIHJldHVybiB7XG4gICAgICAgIGNvbmNhdDogZnVuY3Rpb24gKGZpcnN0LCBzZWNvbmQpIHsgcmV0dXJuIGludGVyc2VjdGlvbkUoc2Vjb25kKShmaXJzdCk7IH1cbiAgICB9O1xufTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIGdldERpZmZlcmVuY2VNYWdtYSA9IGZ1bmN0aW9uIChFKSB7XG4gICAgdmFyIGRpZmZlcmVuY2VFID0gZGlmZmVyZW5jZShFKTtcbiAgICByZXR1cm4ge1xuICAgICAgICBjb25jYXQ6IGZ1bmN0aW9uIChmaXJzdCwgc2Vjb25kKSB7IHJldHVybiBkaWZmZXJlbmNlRShzZWNvbmQpKGZpcnN0KTsgfVxuICAgIH07XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi43LjBcbiAqL1xuZXhwb3J0IHZhciBGdW5jdG9yID0ge1xuICAgIFVSSTogVVJJLFxuICAgIG1hcDogX21hcFxufTtcbi8qKlxuICogQGNhdGVnb3J5IG1hcHBpbmdcbiAqIEBzaW5jZSAyLjEwLjBcbiAqL1xuZXhwb3J0IHZhciBmbGFwID0gLyojX19QVVJFX18qLyBmbGFwXyhGdW5jdG9yKTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuMTAuMFxuICovXG5leHBvcnQgdmFyIFBvaW50ZWQgPSB7XG4gICAgVVJJOiBVUkksXG4gICAgb2Y6IG9mXG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi43LjBcbiAqL1xuZXhwb3J0IHZhciBGdW5jdG9yV2l0aEluZGV4ID0ge1xuICAgIFVSSTogVVJJLFxuICAgIG1hcDogX21hcCxcbiAgICBtYXBXaXRoSW5kZXg6IF9tYXBXaXRoSW5kZXhcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjEwLjBcbiAqL1xuZXhwb3J0IHZhciBBcHBseSA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICBtYXA6IF9tYXAsXG4gICAgYXA6IF9hcFxufTtcbi8qKlxuICogQ29tYmluZSB0d28gZWZmZWN0ZnVsIGFjdGlvbnMsIGtlZXBpbmcgb25seSB0aGUgcmVzdWx0IG9mIHRoZSBmaXJzdC5cbiAqXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBhcEZpcnN0ID0gLyojX19QVVJFX18qLyBhcEZpcnN0XyhBcHBseSk7XG4vKipcbiAqIENvbWJpbmUgdHdvIGVmZmVjdGZ1bCBhY3Rpb25zLCBrZWVwaW5nIG9ubHkgdGhlIHJlc3VsdCBvZiB0aGUgc2Vjb25kLlxuICpcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIGFwU2Vjb25kID0gLyojX19QVVJFX18qLyBhcFNlY29uZF8oQXBwbHkpO1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi43LjBcbiAqL1xuZXhwb3J0IHZhciBBcHBsaWNhdGl2ZSA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICBtYXA6IF9tYXAsXG4gICAgYXA6IF9hcCxcbiAgICBvZjogb2Zcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjEwLjBcbiAqL1xuZXhwb3J0IHZhciBDaGFpbiA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICBtYXA6IF9tYXAsXG4gICAgYXA6IF9hcCxcbiAgICBjaGFpbjogZmxhdE1hcFxufTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuNy4wXG4gKi9cbmV4cG9ydCB2YXIgTW9uYWQgPSB7XG4gICAgVVJJOiBVUkksXG4gICAgbWFwOiBfbWFwLFxuICAgIGFwOiBfYXAsXG4gICAgb2Y6IG9mLFxuICAgIGNoYWluOiBmbGF0TWFwXG59O1xuLyoqXG4gKiBDb21wb3NlcyBjb21wdXRhdGlvbnMgaW4gc2VxdWVuY2UsIHVzaW5nIHRoZSByZXR1cm4gdmFsdWUgb2Ygb25lIGNvbXB1dGF0aW9uIHRvIGRldGVybWluZSB0aGUgbmV4dCBjb21wdXRhdGlvbiBhbmRcbiAqIGtlZXBpbmcgb25seSB0aGUgcmVzdWx0IG9mIHRoZSBmaXJzdC5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0ICogYXMgUkEgZnJvbSAnZnAtdHMvUmVhZG9ubHlBcnJheSdcbiAqIGltcG9ydCB7IHBpcGUgfSBmcm9tICdmcC10cy9mdW5jdGlvbidcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKFxuICogICBwaXBlKFxuICogICAgIFsxLCAyLCAzXSxcbiAqICAgICBSQS5jaGFpbkZpcnN0KCgpID0+IFsnYScsICdiJ10pXG4gKiAgICksXG4gKiAgIFsxLCAxLCAyLCAyLCAzLCAzXVxuICogKVxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChcbiAqICAgcGlwZShcbiAqICAgICBbMSwgMiwgM10sXG4gKiAgICAgUkEuY2hhaW5GaXJzdCgoKSA9PiBbXSlcbiAqICAgKSxcbiAqICAgW11cbiAqIClcbiAqXG4gKiBAY2F0ZWdvcnkgc2VxdWVuY2luZ1xuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgY2hhaW5GaXJzdCA9IFxuLyojX19QVVJFX18qLyBjaGFpbkZpcnN0XyhDaGFpbik7XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjcuMFxuICovXG5leHBvcnQgdmFyIFVuZm9sZGFibGUgPSB7XG4gICAgVVJJOiBVUkksXG4gICAgdW5mb2xkOiB1bmZvbGRcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjcuMFxuICovXG5leHBvcnQgdmFyIEFsdCA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICBtYXA6IF9tYXAsXG4gICAgYWx0OiBfYWx0XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi4xMS4wXG4gKi9cbmV4cG9ydCB2YXIgWmVybyA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICB6ZXJvOiB6ZXJvXG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgZG8gbm90YXRpb25cbiAqIEBzaW5jZSAyLjExLjBcbiAqL1xuZXhwb3J0IHZhciBndWFyZCA9IC8qI19fUFVSRV9fKi8gZ3VhcmRfKFplcm8sIFBvaW50ZWQpO1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi43LjBcbiAqL1xuZXhwb3J0IHZhciBBbHRlcm5hdGl2ZSA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICBtYXA6IF9tYXAsXG4gICAgYXA6IF9hcCxcbiAgICBvZjogb2YsXG4gICAgYWx0OiBfYWx0LFxuICAgIHplcm86IHplcm9cbn07XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjcuMFxuICovXG5leHBvcnQgdmFyIEV4dGVuZCA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICBtYXA6IF9tYXAsXG4gICAgZXh0ZW5kOiBfZXh0ZW5kXG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi43LjBcbiAqL1xuZXhwb3J0IHZhciBDb21wYWN0YWJsZSA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICBjb21wYWN0OiBjb21wYWN0LFxuICAgIHNlcGFyYXRlOiBzZXBhcmF0ZVxufTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuNy4wXG4gKi9cbmV4cG9ydCB2YXIgRmlsdGVyYWJsZSA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICBtYXA6IF9tYXAsXG4gICAgY29tcGFjdDogY29tcGFjdCxcbiAgICBzZXBhcmF0ZTogc2VwYXJhdGUsXG4gICAgZmlsdGVyOiBfZmlsdGVyLFxuICAgIGZpbHRlck1hcDogX2ZpbHRlck1hcCxcbiAgICBwYXJ0aXRpb246IF9wYXJ0aXRpb24sXG4gICAgcGFydGl0aW9uTWFwOiBfcGFydGl0aW9uTWFwXG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi43LjBcbiAqL1xuZXhwb3J0IHZhciBGaWx0ZXJhYmxlV2l0aEluZGV4ID0ge1xuICAgIFVSSTogVVJJLFxuICAgIG1hcDogX21hcCxcbiAgICBtYXBXaXRoSW5kZXg6IF9tYXBXaXRoSW5kZXgsXG4gICAgY29tcGFjdDogY29tcGFjdCxcbiAgICBzZXBhcmF0ZTogc2VwYXJhdGUsXG4gICAgZmlsdGVyOiBfZmlsdGVyLFxuICAgIGZpbHRlck1hcDogX2ZpbHRlck1hcCxcbiAgICBwYXJ0aXRpb246IF9wYXJ0aXRpb24sXG4gICAgcGFydGl0aW9uTWFwOiBfcGFydGl0aW9uTWFwLFxuICAgIHBhcnRpdGlvbk1hcFdpdGhJbmRleDogX3BhcnRpdGlvbk1hcFdpdGhJbmRleCxcbiAgICBwYXJ0aXRpb25XaXRoSW5kZXg6IF9wYXJ0aXRpb25XaXRoSW5kZXgsXG4gICAgZmlsdGVyTWFwV2l0aEluZGV4OiBfZmlsdGVyTWFwV2l0aEluZGV4LFxuICAgIGZpbHRlcldpdGhJbmRleDogX2ZpbHRlcldpdGhJbmRleFxufTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuNy4wXG4gKi9cbmV4cG9ydCB2YXIgRm9sZGFibGUgPSB7XG4gICAgVVJJOiBVUkksXG4gICAgcmVkdWNlOiBfcmVkdWNlLFxuICAgIGZvbGRNYXA6IF9mb2xkTWFwLFxuICAgIHJlZHVjZVJpZ2h0OiBfcmVkdWNlUmlnaHRcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjcuMFxuICovXG5leHBvcnQgdmFyIEZvbGRhYmxlV2l0aEluZGV4ID0ge1xuICAgIFVSSTogVVJJLFxuICAgIHJlZHVjZTogX3JlZHVjZSxcbiAgICBmb2xkTWFwOiBfZm9sZE1hcCxcbiAgICByZWR1Y2VSaWdodDogX3JlZHVjZVJpZ2h0LFxuICAgIHJlZHVjZVdpdGhJbmRleDogX3JlZHVjZVdpdGhJbmRleCxcbiAgICBmb2xkTWFwV2l0aEluZGV4OiBfZm9sZE1hcFdpdGhJbmRleCxcbiAgICByZWR1Y2VSaWdodFdpdGhJbmRleDogX3JlZHVjZVJpZ2h0V2l0aEluZGV4XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi43LjBcbiAqL1xuZXhwb3J0IHZhciBUcmF2ZXJzYWJsZSA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICBtYXA6IF9tYXAsXG4gICAgcmVkdWNlOiBfcmVkdWNlLFxuICAgIGZvbGRNYXA6IF9mb2xkTWFwLFxuICAgIHJlZHVjZVJpZ2h0OiBfcmVkdWNlUmlnaHQsXG4gICAgdHJhdmVyc2U6IF90cmF2ZXJzZSxcbiAgICBzZXF1ZW5jZTogc2VxdWVuY2Vcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjcuMFxuICovXG5leHBvcnQgdmFyIFRyYXZlcnNhYmxlV2l0aEluZGV4ID0ge1xuICAgIFVSSTogVVJJLFxuICAgIG1hcDogX21hcCxcbiAgICBtYXBXaXRoSW5kZXg6IF9tYXBXaXRoSW5kZXgsXG4gICAgcmVkdWNlOiBfcmVkdWNlLFxuICAgIGZvbGRNYXA6IF9mb2xkTWFwLFxuICAgIHJlZHVjZVJpZ2h0OiBfcmVkdWNlUmlnaHQsXG4gICAgcmVkdWNlV2l0aEluZGV4OiBfcmVkdWNlV2l0aEluZGV4LFxuICAgIGZvbGRNYXBXaXRoSW5kZXg6IF9mb2xkTWFwV2l0aEluZGV4LFxuICAgIHJlZHVjZVJpZ2h0V2l0aEluZGV4OiBfcmVkdWNlUmlnaHRXaXRoSW5kZXgsXG4gICAgdHJhdmVyc2U6IF90cmF2ZXJzZSxcbiAgICBzZXF1ZW5jZTogc2VxdWVuY2UsXG4gICAgdHJhdmVyc2VXaXRoSW5kZXg6IF90cmF2ZXJzZVdpdGhJbmRleFxufTtcbi8qKlxuICogQGNhdGVnb3J5IHNlcXVlbmNpbmdcbiAqIEBzaW5jZSAyLjExLjBcbiAqL1xuZXhwb3J0IHZhciBjaGFpblJlY0RlcHRoRmlyc3QgPSBmdW5jdGlvbiAoZikge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYSkge1xuICAgICAgICB2YXIgdG9kbyA9IF9fc3ByZWFkQXJyYXkoW10sIGYoYSksIHRydWUpO1xuICAgICAgICB2YXIgb3V0ID0gW107XG4gICAgICAgIHdoaWxlICh0b2RvLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgIHZhciBlID0gdG9kby5zaGlmdCgpO1xuICAgICAgICAgICAgaWYgKF8uaXNMZWZ0KGUpKSB7XG4gICAgICAgICAgICAgICAgdG9kby51bnNoaWZ0LmFwcGx5KHRvZG8sIGYoZS5sZWZ0KSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBvdXQucHVzaChlLnJpZ2h0KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gb3V0O1xuICAgIH07XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi4xMS4wXG4gKi9cbmV4cG9ydCB2YXIgQ2hhaW5SZWNEZXB0aEZpcnN0ID0ge1xuICAgIFVSSTogVVJJLFxuICAgIG1hcDogX21hcCxcbiAgICBhcDogX2FwLFxuICAgIGNoYWluOiBmbGF0TWFwLFxuICAgIGNoYWluUmVjOiBfY2hhaW5SZWNEZXB0aEZpcnN0XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgc2VxdWVuY2luZ1xuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIGNoYWluUmVjQnJlYWR0aEZpcnN0ID0gZnVuY3Rpb24gKGYpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGEpIHtcbiAgICAgICAgdmFyIGluaXRpYWwgPSBmKGEpO1xuICAgICAgICB2YXIgdG9kbyA9IFtdO1xuICAgICAgICB2YXIgb3V0ID0gW107XG4gICAgICAgIGZ1bmN0aW9uIGdvKGUpIHtcbiAgICAgICAgICAgIGlmIChfLmlzTGVmdChlKSkge1xuICAgICAgICAgICAgICAgIGYoZS5sZWZ0KS5mb3JFYWNoKGZ1bmN0aW9uICh2KSB7IHJldHVybiB0b2RvLnB1c2godik7IH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgb3V0LnB1c2goZS5yaWdodCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZm9yICh2YXIgX2kgPSAwLCBpbml0aWFsXzEgPSBpbml0aWFsOyBfaSA8IGluaXRpYWxfMS5sZW5ndGg7IF9pKyspIHtcbiAgICAgICAgICAgIHZhciBlID0gaW5pdGlhbF8xW19pXTtcbiAgICAgICAgICAgIGdvKGUpO1xuICAgICAgICB9XG4gICAgICAgIHdoaWxlICh0b2RvLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgIGdvKHRvZG8uc2hpZnQoKSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG91dDtcbiAgICB9O1xufTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIENoYWluUmVjQnJlYWR0aEZpcnN0ID0ge1xuICAgIFVSSTogVVJJLFxuICAgIG1hcDogX21hcCxcbiAgICBhcDogX2FwLFxuICAgIGNoYWluOiBmbGF0TWFwLFxuICAgIGNoYWluUmVjOiBfY2hhaW5SZWNCcmVhZHRoRmlyc3Rcbn07XG52YXIgX3dpdGhlciA9IC8qI19fUFVSRV9fKi8gd2l0aGVyRGVmYXVsdChUcmF2ZXJzYWJsZSwgQ29tcGFjdGFibGUpO1xudmFyIF93aWx0ID0gLyojX19QVVJFX18qLyB3aWx0RGVmYXVsdChUcmF2ZXJzYWJsZSwgQ29tcGFjdGFibGUpO1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi43LjBcbiAqL1xuZXhwb3J0IHZhciBXaXRoZXJhYmxlID0ge1xuICAgIFVSSTogVVJJLFxuICAgIG1hcDogX21hcCxcbiAgICBjb21wYWN0OiBjb21wYWN0LFxuICAgIHNlcGFyYXRlOiBzZXBhcmF0ZSxcbiAgICBmaWx0ZXI6IF9maWx0ZXIsXG4gICAgZmlsdGVyTWFwOiBfZmlsdGVyTWFwLFxuICAgIHBhcnRpdGlvbjogX3BhcnRpdGlvbixcbiAgICBwYXJ0aXRpb25NYXA6IF9wYXJ0aXRpb25NYXAsXG4gICAgcmVkdWNlOiBfcmVkdWNlLFxuICAgIGZvbGRNYXA6IF9mb2xkTWFwLFxuICAgIHJlZHVjZVJpZ2h0OiBfcmVkdWNlUmlnaHQsXG4gICAgdHJhdmVyc2U6IF90cmF2ZXJzZSxcbiAgICBzZXF1ZW5jZTogc2VxdWVuY2UsXG4gICAgd2l0aGVyOiBfd2l0aGVyLFxuICAgIHdpbHQ6IF93aWx0XG59O1xuLyoqXG4gKiBGaWx0ZXIgdmFsdWVzIGluc2lkZSBhIGNvbnRleHQuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IHBpcGUgfSBmcm9tICdmcC10cy9mdW5jdGlvbidcbiAqIGltcG9ydCAqIGFzIFJBIGZyb20gJ2ZwLXRzL1JlYWRvbmx5QXJyYXknXG4gKiBpbXBvcnQgKiBhcyBUIGZyb20gJ2ZwLXRzL1Rhc2snXG4gKlxuICogY29uc3QgZmlsdGVyRSA9IFJBLmZpbHRlckUoVC5BcHBsaWNhdGl2ZVBhcilcbiAqIGFzeW5jIGZ1bmN0aW9uIHRlc3QoKSB7XG4gKiAgIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoXG4gKiAgICAgYXdhaXQgcGlwZShcbiAqICAgICAgIFstMSwgMiwgM10sXG4gKiAgICAgICBmaWx0ZXJFKChuKSA9PiBULm9mKG4gPiAwKSlcbiAqICAgICApKCksXG4gKiAgICAgWzIsIDNdXG4gKiAgIClcbiAqIH1cbiAqIHRlc3QoKVxuICpcbiAqIEBzaW5jZSAyLjExLjBcbiAqL1xuZXhwb3J0IHZhciBmaWx0ZXJFID0gLyojX19QVVJFX18qLyBmaWx0ZXJFXyhXaXRoZXJhYmxlKTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIEZyb21FaXRoZXIgPSB7XG4gICAgVVJJOiBVUkksXG4gICAgZnJvbUVpdGhlcjogZnJvbUVpdGhlclxufTtcbi8qKlxuICogQGNhdGVnb3J5IGxpZnRpbmdcbiAqIEBzaW5jZSAyLjExLjBcbiAqL1xuZXhwb3J0IHZhciBmcm9tRWl0aGVySyA9IC8qI19fUFVSRV9fKi8gZnJvbUVpdGhlcktfKEZyb21FaXRoZXIpO1xuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLy8gdW5zYWZlXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vKipcbiAqIEBjYXRlZ29yeSB1bnNhZmVcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIHVuc2FmZUluc2VydEF0ID0gUk5FQS51bnNhZmVJbnNlcnRBdDtcbi8qKlxuICogQGNhdGVnb3J5IHVuc2FmZVxuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgdW5zYWZlVXBkYXRlQXQgPSBmdW5jdGlvbiAoaSwgYSwgYXMpIHtcbiAgICByZXR1cm4gaXNOb25FbXB0eShhcykgPyBSTkVBLnVuc2FmZVVwZGF0ZUF0KGksIGEsIGFzKSA6IGFzO1xufTtcbi8qKlxuICogQGNhdGVnb3J5IHVuc2FmZVxuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgdW5zYWZlRGVsZXRlQXQgPSBmdW5jdGlvbiAoaSwgYXMpIHtcbiAgICB2YXIgeHMgPSBhcy5zbGljZSgpO1xuICAgIHhzLnNwbGljZShpLCAxKTtcbiAgICByZXR1cm4geHM7XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgY29udmVyc2lvbnNcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIHRvQXJyYXkgPSBmdW5jdGlvbiAoYXMpIHsgcmV0dXJuIGFzLnNsaWNlKCk7IH07XG4vKipcbiAqIEBjYXRlZ29yeSBjb252ZXJzaW9uc1xuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgZnJvbUFycmF5ID0gZnVuY3Rpb24gKGFzKSB7IHJldHVybiAoaXNFbXB0eShhcykgPyBlbXB0eSA6IGFzLnNsaWNlKCkpOyB9O1xuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLy8gdXRpbHNcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8qKlxuICogQW4gZW1wdHkgYXJyYXlcbiAqXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBlbXB0eSA9IFJORUEuZW1wdHk7XG5leHBvcnQgZnVuY3Rpb24gZXZlcnkocHJlZGljYXRlKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykgeyByZXR1cm4gYXMuZXZlcnkocHJlZGljYXRlKTsgfTtcbn1cbi8qKlxuICogQ2hlY2sgaWYgYSBwcmVkaWNhdGUgaG9sZHMgdHJ1ZSBmb3IgYW55IGFycmF5IG1lbWJlci5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgc29tZSB9IGZyb20gJ2ZwLXRzL1JlYWRvbmx5QXJyYXknXG4gKiBpbXBvcnQgeyBwaXBlIH0gZnJvbSAnZnAtdHMvZnVuY3Rpb24nXG4gKlxuICogY29uc3QgaXNQb3NpdGl2ZSA9IChuOiBudW1iZXIpOiBib29sZWFuID0+IG4gPiAwXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChwaXBlKFstMSwgLTIsIDNdLCBzb21lKGlzUG9zaXRpdmUpKSwgdHJ1ZSlcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwocGlwZShbLTEsIC0yLCAtM10sIHNvbWUoaXNQb3NpdGl2ZSkpLCBmYWxzZSlcbiAqXG4gKiBAc2luY2UgMi45LjBcbiAqL1xuZXhwb3J0IHZhciBzb21lID0gZnVuY3Rpb24gKHByZWRpY2F0ZSkge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgcmV0dXJuIGFzLnNvbWUocHJlZGljYXRlKTtcbiAgICB9O1xufTtcbi8qKlxuICogQWxpYXMgb2YgW2Bzb21lYF0oI3NvbWUpXG4gKlxuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIGV4aXN0cyA9IHNvbWU7XG4vKipcbiAqIFBsYWNlcyBhbiBlbGVtZW50IGluIGJldHdlZW4gbWVtYmVycyBvZiBhIGBSZWFkb25seUFycmF5YCwgdGhlbiBmb2xkcyB0aGUgcmVzdWx0cyB1c2luZyB0aGUgcHJvdmlkZWQgYE1vbm9pZGAuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCAqIGFzIFMgZnJvbSAnZnAtdHMvc3RyaW5nJ1xuICogaW1wb3J0IHsgaW50ZXJjYWxhdGUgfSBmcm9tICdmcC10cy9SZWFkb25seUFycmF5J1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoaW50ZXJjYWxhdGUoUy5Nb25vaWQpKCctJykoWydhJywgJ2InLCAnYyddKSwgJ2EtYi1jJylcbiAqXG4gKiBAc2luY2UgMi4xMi4wXG4gKi9cbmV4cG9ydCB2YXIgaW50ZXJjYWxhdGUgPSBmdW5jdGlvbiAoTSkge1xuICAgIHZhciBpbnRlcmNhbGF0ZU0gPSBSTkVBLmludGVyY2FsYXRlKE0pO1xuICAgIHJldHVybiBmdW5jdGlvbiAobWlkZGxlKSB7IHJldHVybiBtYXRjaChmdW5jdGlvbiAoKSB7IHJldHVybiBNLmVtcHR5OyB9LCBpbnRlcmNhbGF0ZU0obWlkZGxlKSk7IH07XG59O1xuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLy8gZG8gbm90YXRpb25cbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8qKlxuICogQGNhdGVnb3J5IGRvIG5vdGF0aW9uXG4gKiBAc2luY2UgMi45LjBcbiAqL1xuZXhwb3J0IHZhciBEbyA9IC8qI19fUFVSRV9fKi8gb2YoXy5lbXB0eVJlY29yZCk7XG4vKipcbiAqIEBjYXRlZ29yeSBkbyBub3RhdGlvblxuICogQHNpbmNlIDIuOC4wXG4gKi9cbmV4cG9ydCB2YXIgYmluZFRvID0gLyojX19QVVJFX18qLyBiaW5kVG9fKEZ1bmN0b3IpO1xudmFyIGxldF8gPSAvKiNfX1BVUkVfXyovIGxldF9fKEZ1bmN0b3IpO1xuZXhwb3J0IHsgXG4vKipcbiAqIEBjYXRlZ29yeSBkbyBub3RhdGlvblxuICogQHNpbmNlIDIuMTMuMFxuICovXG5sZXRfIGFzIGxldCB9O1xuLyoqXG4gKiBAY2F0ZWdvcnkgZG8gbm90YXRpb25cbiAqIEBzaW5jZSAyLjguMFxuICovXG5leHBvcnQgdmFyIGJpbmQgPSAvKiNfX1BVUkVfXyovIGJpbmRfKENoYWluKTtcbi8qKlxuICogQGNhdGVnb3J5IGRvIG5vdGF0aW9uXG4gKiBAc2luY2UgMi44LjBcbiAqL1xuZXhwb3J0IHZhciBhcFMgPSAvKiNfX1BVUkVfXyovIGFwU18oQXBwbHkpO1xuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLy8gbGVnYWN5XG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vKipcbiAqIEFsaWFzIG9mIGBmbGF0TWFwYC5cbiAqXG4gKiBAY2F0ZWdvcnkgbGVnYWN5XG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBjaGFpbiA9IGZsYXRNYXA7XG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vLyBkZXByZWNhdGVkXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vKipcbiAqIFVzZSBgUmVhZG9ubHlOb25FbXB0eUFycmF5YCBtb2R1bGUgaW5zdGVhZC5cbiAqXG4gKiBAY2F0ZWdvcnkgem9uZSBvZiBkZWF0aFxuICogQHNpbmNlIDIuNS4wXG4gKiBAZGVwcmVjYXRlZFxuICovXG5leHBvcnQgdmFyIHJhbmdlID0gUk5FQS5yYW5nZTtcbi8qKlxuICogVXNlIFtgcHJlcGVuZGBdKCNwcmVwZW5kKSBpbnN0ZWFkLlxuICpcbiAqIEBjYXRlZ29yeSB6b25lIG9mIGRlYXRoXG4gKiBAc2luY2UgMi41LjBcbiAqIEBkZXByZWNhdGVkXG4gKi9cbmV4cG9ydCB2YXIgY29ucyA9IFJORUEuY29ucztcbi8qKlxuICogVXNlIFtgYXBwZW5kYF0oI2FwcGVuZCkgaW5zdGVhZC5cbiAqXG4gKiBAY2F0ZWdvcnkgem9uZSBvZiBkZWF0aFxuICogQHNpbmNlIDIuNS4wXG4gKiBAZGVwcmVjYXRlZFxuICovXG5leHBvcnQgdmFyIHNub2MgPSBSTkVBLnNub2M7XG4vKipcbiAqIFVzZSBbYHByZXBlbmRBbGxgXSgjcHJlcGVuZGFsbCkgaW5zdGVhZC5cbiAqXG4gKiBAY2F0ZWdvcnkgem9uZSBvZiBkZWF0aFxuICogQHNpbmNlIDIuOS4wXG4gKiBAZGVwcmVjYXRlZFxuICovXG5leHBvcnQgdmFyIHByZXBlbmRUb0FsbCA9IHByZXBlbmRBbGw7XG4vKipcbiAqIFRoaXMgaW5zdGFuY2UgaXMgZGVwcmVjYXRlZCwgdXNlIHNtYWxsLCBzcGVjaWZpYyBpbnN0YW5jZXMgaW5zdGVhZC5cbiAqIEZvciBleGFtcGxlIGlmIGEgZnVuY3Rpb24gbmVlZHMgYSBgRnVuY3RvcmAgaW5zdGFuY2UsIHBhc3MgYFJBLkZ1bmN0b3JgIGluc3RlYWQgb2YgYFJBLnJlYWRvbmx5QXJyYXlgXG4gKiAod2hlcmUgYFJBYCBpcyBmcm9tIGBpbXBvcnQgUkEgZnJvbSAnZnAtdHMvUmVhZG9ubHlBcnJheSdgKVxuICpcbiAqIEBjYXRlZ29yeSB6b25lIG9mIGRlYXRoXG4gKiBAc2luY2UgMi41LjBcbiAqIEBkZXByZWNhdGVkXG4gKi9cbmV4cG9ydCB2YXIgcmVhZG9ubHlBcnJheSA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICBjb21wYWN0OiBjb21wYWN0LFxuICAgIHNlcGFyYXRlOiBzZXBhcmF0ZSxcbiAgICBtYXA6IF9tYXAsXG4gICAgYXA6IF9hcCxcbiAgICBvZjogb2YsXG4gICAgY2hhaW46IGZsYXRNYXAsXG4gICAgZmlsdGVyOiBfZmlsdGVyLFxuICAgIGZpbHRlck1hcDogX2ZpbHRlck1hcCxcbiAgICBwYXJ0aXRpb246IF9wYXJ0aXRpb24sXG4gICAgcGFydGl0aW9uTWFwOiBfcGFydGl0aW9uTWFwLFxuICAgIG1hcFdpdGhJbmRleDogX21hcFdpdGhJbmRleCxcbiAgICBwYXJ0aXRpb25NYXBXaXRoSW5kZXg6IF9wYXJ0aXRpb25NYXBXaXRoSW5kZXgsXG4gICAgcGFydGl0aW9uV2l0aEluZGV4OiBfcGFydGl0aW9uV2l0aEluZGV4LFxuICAgIGZpbHRlck1hcFdpdGhJbmRleDogX2ZpbHRlck1hcFdpdGhJbmRleCxcbiAgICBmaWx0ZXJXaXRoSW5kZXg6IF9maWx0ZXJXaXRoSW5kZXgsXG4gICAgYWx0OiBfYWx0LFxuICAgIHplcm86IHplcm8sXG4gICAgdW5mb2xkOiB1bmZvbGQsXG4gICAgcmVkdWNlOiBfcmVkdWNlLFxuICAgIGZvbGRNYXA6IF9mb2xkTWFwLFxuICAgIHJlZHVjZVJpZ2h0OiBfcmVkdWNlUmlnaHQsXG4gICAgdHJhdmVyc2U6IF90cmF2ZXJzZSxcbiAgICBzZXF1ZW5jZTogc2VxdWVuY2UsXG4gICAgcmVkdWNlV2l0aEluZGV4OiBfcmVkdWNlV2l0aEluZGV4LFxuICAgIGZvbGRNYXBXaXRoSW5kZXg6IF9mb2xkTWFwV2l0aEluZGV4LFxuICAgIHJlZHVjZVJpZ2h0V2l0aEluZGV4OiBfcmVkdWNlUmlnaHRXaXRoSW5kZXgsXG4gICAgdHJhdmVyc2VXaXRoSW5kZXg6IF90cmF2ZXJzZVdpdGhJbmRleCxcbiAgICBleHRlbmQ6IF9leHRlbmQsXG4gICAgd2l0aGVyOiBfd2l0aGVyLFxuICAgIHdpbHQ6IF93aWx0XG59O1xuIiwKICAidmFyIF9fc3ByZWFkQXJyYXkgPSAodGhpcyAmJiB0aGlzLl9fc3ByZWFkQXJyYXkpIHx8IGZ1bmN0aW9uICh0bywgZnJvbSwgcGFjaykge1xuICAgIGlmIChwYWNrIHx8IGFyZ3VtZW50cy5sZW5ndGggPT09IDIpIGZvciAodmFyIGkgPSAwLCBsID0gZnJvbS5sZW5ndGgsIGFyOyBpIDwgbDsgaSsrKSB7XG4gICAgICAgIGlmIChhciB8fCAhKGkgaW4gZnJvbSkpIHtcbiAgICAgICAgICAgIGlmICghYXIpIGFyID0gQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoZnJvbSwgMCwgaSk7XG4gICAgICAgICAgICBhcltpXSA9IGZyb21baV07XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHRvLmNvbmNhdChhciB8fCBBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChmcm9tKSk7XG59O1xuaW1wb3J0IHsgYXBGaXJzdCBhcyBhcEZpcnN0XywgYXBTIGFzIGFwU18sIGFwU2Vjb25kIGFzIGFwU2Vjb25kXyB9IGZyb20gJy4vQXBwbHknO1xuaW1wb3J0IHsgYmluZCBhcyBiaW5kXywgY2hhaW5GaXJzdCBhcyBjaGFpbkZpcnN0XyB9IGZyb20gJy4vQ2hhaW4nO1xuaW1wb3J0IHsgZnJvbUVxdWFscyB9IGZyb20gJy4vRXEnO1xuaW1wb3J0IHsgZnJvbUVpdGhlcksgYXMgZnJvbUVpdGhlcktfIH0gZnJvbSAnLi9Gcm9tRWl0aGVyJztcbmltcG9ydCB7IGR1YWwsIGlkZW50aXR5LCBwaXBlIH0gZnJvbSAnLi9mdW5jdGlvbic7XG5pbXBvcnQgeyBiaW5kVG8gYXMgYmluZFRvXywgZmxhcCBhcyBmbGFwXywgbGV0IGFzIGxldF9fIH0gZnJvbSAnLi9GdW5jdG9yJztcbmltcG9ydCAqIGFzIF8gZnJvbSAnLi9pbnRlcm5hbCc7XG5pbXBvcnQgKiBhcyBOIGZyb20gJy4vbnVtYmVyJztcbmltcG9ydCB7IGZyb21Db21wYXJlIH0gZnJvbSAnLi9PcmQnO1xuaW1wb3J0ICogYXMgUk5FQSBmcm9tICcuL1JlYWRvbmx5Tm9uRW1wdHlBcnJheSc7XG5pbXBvcnQgeyBzZXBhcmF0ZWQgfSBmcm9tICcuL1NlcGFyYXRlZCc7XG5pbXBvcnQgeyBmaWx0ZXJFIGFzIGZpbHRlckVfLCB3aWx0RGVmYXVsdCwgd2l0aGVyRGVmYXVsdCB9IGZyb20gJy4vV2l0aGVyYWJsZSc7XG5pbXBvcnQgeyBndWFyZCBhcyBndWFyZF8gfSBmcm9tICcuL1plcm8nO1xuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLy8gcmVmaW5lbWVudHNcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8qKlxuICogVGVzdCB3aGV0aGVyIGEgYFJlYWRvbmx5QXJyYXlgIGlzIGVtcHR5LlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBpc0VtcHR5IH0gZnJvbSAnZnAtdHMvUmVhZG9ubHlBcnJheSdcbiAqXG4gKiBhc3NlcnQuc3RyaWN0RXF1YWwoaXNFbXB0eShbXSksIHRydWUpXG4gKlxuICogQGNhdGVnb3J5IHJlZmluZW1lbnRzXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBpc0VtcHR5ID0gZnVuY3Rpb24gKGFzKSB7IHJldHVybiBhcy5sZW5ndGggPT09IDA7IH07XG4vKipcbiAqIFRlc3Qgd2hldGhlciBhIGBSZWFkb25seUFycmF5YCBpcyBub24gZW1wdHkuXG4gKlxuICogQGNhdGVnb3J5IHJlZmluZW1lbnRzXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBpc05vbkVtcHR5ID0gUk5FQS5pc05vbkVtcHR5O1xuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLy8gY29uc3RydWN0b3JzXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vKipcbiAqIFByZXBlbmQgYW4gZWxlbWVudCB0byB0aGUgZnJvbnQgb2YgYSBgUmVhZG9ubHlBcnJheWAsIGNyZWF0aW5nIGEgbmV3IGBSZWFkb25seU5vbkVtcHR5QXJyYXlgLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBwcmVwZW5kIH0gZnJvbSAnZnAtdHMvUmVhZG9ubHlBcnJheSdcbiAqIGltcG9ydCB7IHBpcGUgfSBmcm9tICdmcC10cy9mdW5jdGlvbidcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKHBpcGUoWzIsIDMsIDRdLCBwcmVwZW5kKDEpKSwgWzEsIDIsIDMsIDRdKVxuICpcbiAqIEBzaW5jZSAyLjEwLjBcbiAqL1xuZXhwb3J0IHZhciBwcmVwZW5kID0gUk5FQS5wcmVwZW5kO1xuLyoqXG4gKiBMZXNzIHN0cmljdCB2ZXJzaW9uIG9mIFtgcHJlcGVuZGBdKCNwcmVwZW5kKS5cbiAqXG4gKiBAc2luY2UgMi4xMS4wXG4gKi9cbmV4cG9ydCB2YXIgcHJlcGVuZFcgPSBSTkVBLnByZXBlbmRXO1xuLyoqXG4gKiBBcHBlbmQgYW4gZWxlbWVudCB0byB0aGUgZW5kIG9mIGEgYFJlYWRvbmx5QXJyYXlgLCBjcmVhdGluZyBhIG5ldyBgUmVhZG9ubHlOb25FbXB0eUFycmF5YC5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgYXBwZW5kIH0gZnJvbSAnZnAtdHMvUmVhZG9ubHlBcnJheSdcbiAqIGltcG9ydCB7IHBpcGUgfSBmcm9tICdmcC10cy9mdW5jdGlvbidcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKHBpcGUoWzEsIDIsIDNdLCBhcHBlbmQoNCkpLCBbMSwgMiwgMywgNF0pXG4gKlxuICogQHNpbmNlIDIuMTAuMFxuICovXG5leHBvcnQgdmFyIGFwcGVuZCA9IFJORUEuYXBwZW5kO1xuLyoqXG4gKiBMZXNzIHN0cmljdCB2ZXJzaW9uIG9mIFtgYXBwZW5kYF0oI2FwcGVuZCkuXG4gKlxuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIGFwcGVuZFcgPSBSTkVBLmFwcGVuZFc7XG4vKipcbiAqIFJldHVybiBhIGBSZWFkb25seUFycmF5YCBvZiBsZW5ndGggYG5gIHdpdGggZWxlbWVudCBgaWAgaW5pdGlhbGl6ZWQgd2l0aCBgZihpKWAuXG4gKlxuICogKipOb3RlKiouIGBuYCBpcyBub3JtYWxpemVkIHRvIGEgbm9uIG5lZ2F0aXZlIGludGVnZXIuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IG1ha2VCeSB9IGZyb20gJ2ZwLXRzL1JlYWRvbmx5QXJyYXknXG4gKlxuICogY29uc3QgZG91YmxlID0gKG46IG51bWJlcik6IG51bWJlciA9PiBuICogMlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChtYWtlQnkoNSwgZG91YmxlKSwgWzAsIDIsIDQsIDYsIDhdKVxuICpcbiAqIEBjYXRlZ29yeSBjb25zdHJ1Y3RvcnNcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIG1ha2VCeSA9IGZ1bmN0aW9uIChuLCBmKSB7IHJldHVybiAobiA8PSAwID8gZW1wdHkgOiBSTkVBLm1ha2VCeShmKShuKSk7IH07XG4vKipcbiAqIENyZWF0ZSBhIGBSZWFkb25seUFycmF5YCBjb250YWluaW5nIGEgdmFsdWUgcmVwZWF0ZWQgdGhlIHNwZWNpZmllZCBudW1iZXIgb2YgdGltZXMuXG4gKlxuICogKipOb3RlKiouIGBuYCBpcyBub3JtYWxpemVkIHRvIGEgbm9uIG5lZ2F0aXZlIGludGVnZXIuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IHJlcGxpY2F0ZSB9IGZyb20gJ2ZwLXRzL1JlYWRvbmx5QXJyYXknXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChyZXBsaWNhdGUoMywgJ2EnKSwgWydhJywgJ2EnLCAnYSddKVxuICpcbiAqIEBjYXRlZ29yeSBjb25zdHJ1Y3RvcnNcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIHJlcGxpY2F0ZSA9IGZ1bmN0aW9uIChuLCBhKSB7IHJldHVybiBtYWtlQnkobiwgZnVuY3Rpb24gKCkgeyByZXR1cm4gYTsgfSk7IH07XG5leHBvcnQgZnVuY3Rpb24gZnJvbVByZWRpY2F0ZShwcmVkaWNhdGUpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGEpIHsgcmV0dXJuIChwcmVkaWNhdGUoYSkgPyBbYV0gOiBlbXB0eSk7IH07XG59XG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vLyBjb252ZXJzaW9uc1xuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLyoqXG4gKiBAY2F0ZWdvcnkgY29udmVyc2lvbnNcbiAqIEBzaW5jZSAyLjExLjBcbiAqL1xuZXhwb3J0IHZhciBmcm9tT3B0aW9uID0gZnVuY3Rpb24gKG1hKSB7IHJldHVybiAoXy5pc05vbmUobWEpID8gZW1wdHkgOiBbbWEudmFsdWVdKTsgfTtcbi8qKlxuICogVHJhbnNmb3JtcyBhbiBgRWl0aGVyYCB0byBhIGBSZWFkb25seUFycmF5YC5cbiAqXG4gKiBAY2F0ZWdvcnkgY29udmVyc2lvbnNcbiAqIEBzaW5jZSAyLjExLjBcbiAqL1xuZXhwb3J0IHZhciBmcm9tRWl0aGVyID0gZnVuY3Rpb24gKGUpIHsgcmV0dXJuIChfLmlzTGVmdChlKSA/IGVtcHR5IDogW2UucmlnaHRdKTsgfTtcbi8qKlxuICogTGVzcyBzdHJpY3QgdmVyc2lvbiBvZiBbYG1hdGNoYF0oI21hdGNoKS5cbiAqXG4gKiBUaGUgYFdgIHN1ZmZpeCAoc2hvcnQgZm9yICoqVyoqaWRlbmluZykgbWVhbnMgdGhhdCB0aGUgaGFuZGxlciByZXR1cm4gdHlwZXMgd2lsbCBiZSBtZXJnZWQuXG4gKlxuICogQGNhdGVnb3J5IHBhdHRlcm4gbWF0Y2hpbmdcbiAqIEBzaW5jZSAyLjExLjBcbiAqL1xuZXhwb3J0IHZhciBtYXRjaFcgPSBmdW5jdGlvbiAob25FbXB0eSwgb25Ob25FbXB0eSkge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgcmV0dXJuIGlzTm9uRW1wdHkoYXMpID8gb25Ob25FbXB0eShhcykgOiBvbkVtcHR5KCk7XG4gICAgfTtcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBwYXR0ZXJuIG1hdGNoaW5nXG4gKiBAc2luY2UgMi4xMS4wXG4gKi9cbmV4cG9ydCB2YXIgbWF0Y2ggPSBtYXRjaFc7XG4vKipcbiAqIExlc3Mgc3RyaWN0IHZlcnNpb24gb2YgW2BtYXRjaExlZnRgXSgjbWF0Y2hsZWZ0KS5cbiAqXG4gKiBAY2F0ZWdvcnkgcGF0dGVybiBtYXRjaGluZ1xuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIG1hdGNoTGVmdFcgPSBmdW5jdGlvbiAob25FbXB0eSwgb25Ob25FbXB0eSkge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgcmV0dXJuIGlzTm9uRW1wdHkoYXMpID8gb25Ob25FbXB0eShSTkVBLmhlYWQoYXMpLCBSTkVBLnRhaWwoYXMpKSA6IG9uRW1wdHkoKTtcbiAgICB9O1xufTtcbi8qKlxuICogQnJlYWsgYSBgUmVhZG9ubHlBcnJheWAgaW50byBpdHMgZmlyc3QgZWxlbWVudCBhbmQgcmVtYWluaW5nIGVsZW1lbnRzLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBtYXRjaExlZnQgfSBmcm9tICdmcC10cy9SZWFkb25seUFycmF5J1xuICpcbiAqIGNvbnN0IGxlbjogPEE+KGFzOiBSZWFkb25seUFycmF5PEE+KSA9PiBudW1iZXIgPSBtYXRjaExlZnQoKCkgPT4gMCwgKF8sIHRhaWwpID0+IDEgKyBsZW4odGFpbCkpXG4gKiBhc3NlcnQuc3RyaWN0RXF1YWwobGVuKFsxLCAyLCAzXSksIDMpXG4gKlxuICogQGNhdGVnb3J5IHBhdHRlcm4gbWF0Y2hpbmdcbiAqIEBzaW5jZSAyLjEwLjBcbiAqL1xuZXhwb3J0IHZhciBtYXRjaExlZnQgPSBtYXRjaExlZnRXO1xuLyoqXG4gKiBBbGlhcyBvZiBbYG1hdGNoTGVmdGBdKCNtYXRjaGxlZnQpLlxuICpcbiAqIEBjYXRlZ29yeSBwYXR0ZXJuIG1hdGNoaW5nXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBmb2xkTGVmdCA9IG1hdGNoTGVmdDtcbi8qKlxuICogTGVzcyBzdHJpY3QgdmVyc2lvbiBvZiBbYG1hdGNoUmlnaHRgXSgjbWF0Y2hyaWdodCkuXG4gKlxuICogQGNhdGVnb3J5IHBhdHRlcm4gbWF0Y2hpbmdcbiAqIEBzaW5jZSAyLjExLjBcbiAqL1xuZXhwb3J0IHZhciBtYXRjaFJpZ2h0VyA9IGZ1bmN0aW9uIChvbkVtcHR5LCBvbk5vbkVtcHR5KSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykge1xuICAgICAgICByZXR1cm4gaXNOb25FbXB0eShhcykgPyBvbk5vbkVtcHR5KFJORUEuaW5pdChhcyksIFJORUEubGFzdChhcykpIDogb25FbXB0eSgpO1xuICAgIH07XG59O1xuLyoqXG4gKiBCcmVhayBhIGBSZWFkb25seUFycmF5YCBpbnRvIGl0cyBpbml0aWFsIGVsZW1lbnRzIGFuZCB0aGUgbGFzdCBlbGVtZW50LlxuICpcbiAqIEBjYXRlZ29yeSBwYXR0ZXJuIG1hdGNoaW5nXG4gKiBAc2luY2UgMi4xMC4wXG4gKi9cbmV4cG9ydCB2YXIgbWF0Y2hSaWdodCA9IG1hdGNoUmlnaHRXO1xuLyoqXG4gKiBBbGlhcyBvZiBbYG1hdGNoUmlnaHRgXSgjbWF0Y2hyaWdodCkuXG4gKlxuICogQGNhdGVnb3J5IHBhdHRlcm4gbWF0Y2hpbmdcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIGZvbGRSaWdodCA9IG1hdGNoUmlnaHQ7XG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vLyBjb21iaW5hdG9yc1xuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLyoqXG4gKiBAY2F0ZWdvcnkgc2VxdWVuY2luZ1xuICogQHNpbmNlIDIuNy4wXG4gKi9cbmV4cG9ydCB2YXIgY2hhaW5XaXRoSW5kZXggPSBmdW5jdGlvbiAoZikge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgaWYgKGlzRW1wdHkoYXMpKSB7XG4gICAgICAgICAgICByZXR1cm4gZW1wdHk7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIG91dCA9IFtdO1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGFzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICBvdXQucHVzaC5hcHBseShvdXQsIGYoaSwgYXNbaV0pKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gb3V0O1xuICAgIH07XG59O1xuLyoqXG4gKiBTYW1lIGFzIGByZWR1Y2VgIGJ1dCBpdCBjYXJyaWVzIG92ZXIgdGhlIGludGVybWVkaWF0ZSBzdGVwcy5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgc2NhbkxlZnQgfSBmcm9tICdmcC10cy9SZWFkb25seUFycmF5J1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoc2NhbkxlZnQoMTAsIChiLCBhOiBudW1iZXIpID0+IGIgLSBhKShbMSwgMiwgM10pLCBbMTAsIDksIDcsIDRdKVxuICpcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIHNjYW5MZWZ0ID0gZnVuY3Rpb24gKGIsIGYpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIHZhciBsZW4gPSBhcy5sZW5ndGg7XG4gICAgICAgIHZhciBvdXQgPSBuZXcgQXJyYXkobGVuICsgMSk7XG4gICAgICAgIG91dFswXSA9IGI7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbGVuOyBpKyspIHtcbiAgICAgICAgICAgIG91dFtpICsgMV0gPSBmKG91dFtpXSwgYXNbaV0pO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBvdXQ7XG4gICAgfTtcbn07XG4vKipcbiAqIEZvbGQgYW4gYXJyYXkgZnJvbSB0aGUgcmlnaHQsIGtlZXBpbmcgYWxsIGludGVybWVkaWF0ZSByZXN1bHRzIGluc3RlYWQgb2Ygb25seSB0aGUgZmluYWwgcmVzdWx0XG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IHNjYW5SaWdodCB9IGZyb20gJ2ZwLXRzL1JlYWRvbmx5QXJyYXknXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChzY2FuUmlnaHQoMTAsIChhOiBudW1iZXIsIGIpID0+IGIgLSBhKShbMSwgMiwgM10pLCBbNCwgNSwgNywgMTBdKVxuICpcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIHNjYW5SaWdodCA9IGZ1bmN0aW9uIChiLCBmKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykge1xuICAgICAgICB2YXIgbGVuID0gYXMubGVuZ3RoO1xuICAgICAgICB2YXIgb3V0ID0gbmV3IEFycmF5KGxlbiArIDEpO1xuICAgICAgICBvdXRbbGVuXSA9IGI7XG4gICAgICAgIGZvciAodmFyIGkgPSBsZW4gLSAxOyBpID49IDA7IGktLSkge1xuICAgICAgICAgICAgb3V0W2ldID0gZihhc1tpXSwgb3V0W2kgKyAxXSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG91dDtcbiAgICB9O1xufTtcbi8qKlxuICogQ2FsY3VsYXRlIHRoZSBudW1iZXIgb2YgZWxlbWVudHMgaW4gYSBgUmVhZG9ubHlBcnJheWAuXG4gKlxuICogQHNpbmNlIDIuMTAuMFxuICovXG5leHBvcnQgdmFyIHNpemUgPSBmdW5jdGlvbiAoYXMpIHsgcmV0dXJuIGFzLmxlbmd0aDsgfTtcbi8qKlxuICogVGVzdCB3aGV0aGVyIGFuIGFycmF5IGNvbnRhaW5zIGEgcGFydGljdWxhciBpbmRleFxuICpcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIGlzT3V0T2ZCb3VuZCA9IFJORUEuaXNPdXRPZkJvdW5kO1xuZXhwb3J0IGZ1bmN0aW9uIGxvb2t1cChpLCBhcykge1xuICAgIHJldHVybiBhcyA9PT0gdW5kZWZpbmVkID8gZnVuY3Rpb24gKGFzKSB7IHJldHVybiBsb29rdXAoaSwgYXMpOyB9IDogaXNPdXRPZkJvdW5kKGksIGFzKSA/IF8ubm9uZSA6IF8uc29tZShhc1tpXSk7XG59XG4vKipcbiAqIEdldCB0aGUgZmlyc3QgZWxlbWVudCBpbiBhbiBhcnJheSwgb3IgYE5vbmVgIGlmIHRoZSBhcnJheSBpcyBlbXB0eVxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBoZWFkIH0gZnJvbSAnZnAtdHMvUmVhZG9ubHlBcnJheSdcbiAqIGltcG9ydCB7IHNvbWUsIG5vbmUgfSBmcm9tICdmcC10cy9PcHRpb24nXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChoZWFkKFsxLCAyLCAzXSksIHNvbWUoMSkpXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKGhlYWQoW10pLCBub25lKVxuICpcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIGhlYWQgPSBmdW5jdGlvbiAoYXMpIHsgcmV0dXJuIChpc05vbkVtcHR5KGFzKSA/IF8uc29tZShSTkVBLmhlYWQoYXMpKSA6IF8ubm9uZSk7IH07XG4vKipcbiAqIEdldCB0aGUgbGFzdCBlbGVtZW50IGluIGFuIGFycmF5LCBvciBgTm9uZWAgaWYgdGhlIGFycmF5IGlzIGVtcHR5XG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IGxhc3QgfSBmcm9tICdmcC10cy9SZWFkb25seUFycmF5J1xuICogaW1wb3J0IHsgc29tZSwgbm9uZSB9IGZyb20gJ2ZwLXRzL09wdGlvbidcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKGxhc3QoWzEsIDIsIDNdKSwgc29tZSgzKSlcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwobGFzdChbXSksIG5vbmUpXG4gKlxuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgbGFzdCA9IGZ1bmN0aW9uIChhcykgeyByZXR1cm4gKGlzTm9uRW1wdHkoYXMpID8gXy5zb21lKFJORUEubGFzdChhcykpIDogXy5ub25lKTsgfTtcbi8qKlxuICogR2V0IGFsbCBidXQgdGhlIGZpcnN0IGVsZW1lbnQgb2YgYW4gYXJyYXksIGNyZWF0aW5nIGEgbmV3IGFycmF5LCBvciBgTm9uZWAgaWYgdGhlIGFycmF5IGlzIGVtcHR5XG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IHRhaWwgfSBmcm9tICdmcC10cy9SZWFkb25seUFycmF5J1xuICogaW1wb3J0IHsgc29tZSwgbm9uZSB9IGZyb20gJ2ZwLXRzL09wdGlvbidcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKHRhaWwoWzEsIDIsIDNdKSwgc29tZShbMiwgM10pKVxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbCh0YWlsKFtdKSwgbm9uZSlcbiAqXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciB0YWlsID0gZnVuY3Rpb24gKGFzKSB7XG4gICAgcmV0dXJuIGlzTm9uRW1wdHkoYXMpID8gXy5zb21lKFJORUEudGFpbChhcykpIDogXy5ub25lO1xufTtcbi8qKlxuICogR2V0IGFsbCBidXQgdGhlIGxhc3QgZWxlbWVudCBvZiBhbiBhcnJheSwgY3JlYXRpbmcgYSBuZXcgYXJyYXksIG9yIGBOb25lYCBpZiB0aGUgYXJyYXkgaXMgZW1wdHlcbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgaW5pdCB9IGZyb20gJ2ZwLXRzL1JlYWRvbmx5QXJyYXknXG4gKiBpbXBvcnQgeyBzb21lLCBub25lIH0gZnJvbSAnZnAtdHMvT3B0aW9uJ1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoaW5pdChbMSwgMiwgM10pLCBzb21lKFsxLCAyXSkpXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKGluaXQoW10pLCBub25lKVxuICpcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIGluaXQgPSBmdW5jdGlvbiAoYXMpIHtcbiAgICByZXR1cm4gaXNOb25FbXB0eShhcykgPyBfLnNvbWUoUk5FQS5pbml0KGFzKSkgOiBfLm5vbmU7XG59O1xuLyoqXG4gKiBLZWVwIG9ubHkgYSBtYXggbnVtYmVyIG9mIGVsZW1lbnRzIGZyb20gdGhlIHN0YXJ0IG9mIGFuIGBSZWFkb25seUFycmF5YCwgY3JlYXRpbmcgYSBuZXcgYFJlYWRvbmx5QXJyYXlgLlxuICpcbiAqICoqTm90ZSoqLiBgbmAgaXMgbm9ybWFsaXplZCB0byBhIG5vbiBuZWdhdGl2ZSBpbnRlZ2VyLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgKiBhcyBSQSBmcm9tICdmcC10cy9SZWFkb25seUFycmF5J1xuICogaW1wb3J0IHsgcGlwZSB9IGZyb20gJ2ZwLXRzL2Z1bmN0aW9uJ1xuICpcbiAqIGNvbnN0IGlucHV0OiBSZWFkb25seUFycmF5PG51bWJlcj4gPSBbMSwgMiwgM11cbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwocGlwZShpbnB1dCwgUkEudGFrZUxlZnQoMikpLCBbMSwgMl0pXG4gKlxuICogLy8gb3V0IG9mIGJvdW5kc1xuICogYXNzZXJ0LnN0cmljdEVxdWFsKHBpcGUoaW5wdXQsIFJBLnRha2VMZWZ0KDQpKSwgaW5wdXQpXG4gKiBhc3NlcnQuc3RyaWN0RXF1YWwocGlwZShpbnB1dCwgUkEudGFrZUxlZnQoLTEpKSwgaW5wdXQpXG4gKlxuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgdGFrZUxlZnQgPSBmdW5jdGlvbiAobikge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgcmV0dXJuIGlzT3V0T2ZCb3VuZChuLCBhcykgPyBhcyA6IG4gPT09IDAgPyBlbXB0eSA6IGFzLnNsaWNlKDAsIG4pO1xuICAgIH07XG59O1xuLyoqXG4gKiBLZWVwIG9ubHkgYSBtYXggbnVtYmVyIG9mIGVsZW1lbnRzIGZyb20gdGhlIGVuZCBvZiBhbiBgUmVhZG9ubHlBcnJheWAsIGNyZWF0aW5nIGEgbmV3IGBSZWFkb25seUFycmF5YC5cbiAqXG4gKiAqKk5vdGUqKi4gYG5gIGlzIG5vcm1hbGl6ZWQgdG8gYSBub24gbmVnYXRpdmUgaW50ZWdlci5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0ICogYXMgUkEgZnJvbSAnZnAtdHMvUmVhZG9ubHlBcnJheSdcbiAqIGltcG9ydCB7IHBpcGUgfSBmcm9tICdmcC10cy9mdW5jdGlvbidcbiAqXG4gKiBjb25zdCBpbnB1dDogUmVhZG9ubHlBcnJheTxudW1iZXI+ID0gWzEsIDIsIDNdXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKHBpcGUoaW5wdXQsIFJBLnRha2VSaWdodCgyKSksIFsyLCAzXSlcbiAqXG4gKiAvLyBvdXQgb2YgYm91bmRzXG4gKiBhc3NlcnQuc3RyaWN0RXF1YWwocGlwZShpbnB1dCwgUkEudGFrZVJpZ2h0KDQpKSwgaW5wdXQpXG4gKiBhc3NlcnQuc3RyaWN0RXF1YWwocGlwZShpbnB1dCwgUkEudGFrZVJpZ2h0KC0xKSksIGlucHV0KVxuICpcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIHRha2VSaWdodCA9IGZ1bmN0aW9uIChuKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykge1xuICAgICAgICByZXR1cm4gaXNPdXRPZkJvdW5kKG4sIGFzKSA/IGFzIDogbiA9PT0gMCA/IGVtcHR5IDogYXMuc2xpY2UoLW4pO1xuICAgIH07XG59O1xuZXhwb3J0IGZ1bmN0aW9uIHRha2VMZWZ0V2hpbGUocHJlZGljYXRlKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykge1xuICAgICAgICB2YXIgb3V0ID0gW107XG4gICAgICAgIGZvciAodmFyIF9pID0gMCwgYXNfMSA9IGFzOyBfaSA8IGFzXzEubGVuZ3RoOyBfaSsrKSB7XG4gICAgICAgICAgICB2YXIgYSA9IGFzXzFbX2ldO1xuICAgICAgICAgICAgaWYgKCFwcmVkaWNhdGUoYSkpIHtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIG91dC5wdXNoKGEpO1xuICAgICAgICB9XG4gICAgICAgIHZhciBsZW4gPSBvdXQubGVuZ3RoO1xuICAgICAgICByZXR1cm4gbGVuID09PSBhcy5sZW5ndGggPyBhcyA6IGxlbiA9PT0gMCA/IGVtcHR5IDogb3V0O1xuICAgIH07XG59XG52YXIgc3BhbkxlZnRJbmRleCA9IGZ1bmN0aW9uIChhcywgcHJlZGljYXRlKSB7XG4gICAgdmFyIGwgPSBhcy5sZW5ndGg7XG4gICAgdmFyIGkgPSAwO1xuICAgIGZvciAoOyBpIDwgbDsgaSsrKSB7XG4gICAgICAgIGlmICghcHJlZGljYXRlKGFzW2ldKSkge1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIGk7XG59O1xuZXhwb3J0IGZ1bmN0aW9uIHNwYW5MZWZ0KHByZWRpY2F0ZSkge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgdmFyIF9hID0gc3BsaXRBdChzcGFuTGVmdEluZGV4KGFzLCBwcmVkaWNhdGUpKShhcyksIGluaXQgPSBfYVswXSwgcmVzdCA9IF9hWzFdO1xuICAgICAgICByZXR1cm4geyBpbml0OiBpbml0LCByZXN0OiByZXN0IH07XG4gICAgfTtcbn1cbi8qKlxuICogRHJvcCBhIG1heCBudW1iZXIgb2YgZWxlbWVudHMgZnJvbSB0aGUgc3RhcnQgb2YgYW4gYFJlYWRvbmx5QXJyYXlgLCBjcmVhdGluZyBhIG5ldyBgUmVhZG9ubHlBcnJheWAuXG4gKlxuICogKipOb3RlKiouIGBuYCBpcyBub3JtYWxpemVkIHRvIGEgbm9uIG5lZ2F0aXZlIGludGVnZXIuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCAqIGFzIFJBIGZyb20gJ2ZwLXRzL1JlYWRvbmx5QXJyYXknXG4gKiBpbXBvcnQgeyBwaXBlIH0gZnJvbSAnZnAtdHMvZnVuY3Rpb24nXG4gKlxuICogY29uc3QgaW5wdXQ6IFJlYWRvbmx5QXJyYXk8bnVtYmVyPiA9IFsxLCAyLCAzXVxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChwaXBlKGlucHV0LCBSQS5kcm9wTGVmdCgyKSksIFszXSlcbiAqIGFzc2VydC5zdHJpY3RFcXVhbChwaXBlKGlucHV0LCBSQS5kcm9wTGVmdCgwKSksIGlucHV0KVxuICogYXNzZXJ0LnN0cmljdEVxdWFsKHBpcGUoaW5wdXQsIFJBLmRyb3BMZWZ0KC0xKSksIGlucHV0KVxuICpcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIGRyb3BMZWZ0ID0gZnVuY3Rpb24gKG4pIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIHJldHVybiBuIDw9IDAgfHwgaXNFbXB0eShhcykgPyBhcyA6IG4gPj0gYXMubGVuZ3RoID8gZW1wdHkgOiBhcy5zbGljZShuLCBhcy5sZW5ndGgpO1xuICAgIH07XG59O1xuLyoqXG4gKiBEcm9wIGEgbWF4IG51bWJlciBvZiBlbGVtZW50cyBmcm9tIHRoZSBlbmQgb2YgYW4gYFJlYWRvbmx5QXJyYXlgLCBjcmVhdGluZyBhIG5ldyBgUmVhZG9ubHlBcnJheWAuXG4gKlxuICogKipOb3RlKiouIGBuYCBpcyBub3JtYWxpemVkIHRvIGEgbm9uIG5lZ2F0aXZlIGludGVnZXIuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCAqIGFzIFJBIGZyb20gJ2ZwLXRzL1JlYWRvbmx5QXJyYXknXG4gKiBpbXBvcnQgeyBwaXBlIH0gZnJvbSAnZnAtdHMvZnVuY3Rpb24nXG4gKlxuICogY29uc3QgaW5wdXQ6IFJlYWRvbmx5QXJyYXk8bnVtYmVyPiA9IFsxLCAyLCAzXVxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChwaXBlKGlucHV0LCBSQS5kcm9wUmlnaHQoMikpLCBbMV0pXG4gKiBhc3NlcnQuc3RyaWN0RXF1YWwocGlwZShpbnB1dCwgUkEuZHJvcFJpZ2h0KDApKSwgaW5wdXQpXG4gKiBhc3NlcnQuc3RyaWN0RXF1YWwocGlwZShpbnB1dCwgUkEuZHJvcFJpZ2h0KC0xKSksIGlucHV0KVxuICpcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIGRyb3BSaWdodCA9IGZ1bmN0aW9uIChuKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykge1xuICAgICAgICByZXR1cm4gbiA8PSAwIHx8IGlzRW1wdHkoYXMpID8gYXMgOiBuID49IGFzLmxlbmd0aCA/IGVtcHR5IDogYXMuc2xpY2UoMCwgYXMubGVuZ3RoIC0gbik7XG4gICAgfTtcbn07XG5leHBvcnQgZnVuY3Rpb24gZHJvcExlZnRXaGlsZShwcmVkaWNhdGUpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIHZhciBpID0gc3BhbkxlZnRJbmRleChhcywgcHJlZGljYXRlKTtcbiAgICAgICAgcmV0dXJuIGkgPT09IDAgPyBhcyA6IGkgPT09IGFzLmxlbmd0aCA/IGVtcHR5IDogYXMuc2xpY2UoaSk7XG4gICAgfTtcbn1cbi8qKlxuICogRmluZCB0aGUgZmlyc3QgaW5kZXggZm9yIHdoaWNoIGEgcHJlZGljYXRlIGhvbGRzXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IGZpbmRJbmRleCB9IGZyb20gJ2ZwLXRzL1JlYWRvbmx5QXJyYXknXG4gKiBpbXBvcnQgeyBzb21lLCBub25lIH0gZnJvbSAnZnAtdHMvT3B0aW9uJ1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoZmluZEluZGV4KChuOiBudW1iZXIpID0+IG4gPT09IDIpKFsxLCAyLCAzXSksIHNvbWUoMSkpXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKGZpbmRJbmRleCgobjogbnVtYmVyKSA9PiBuID09PSAyKShbXSksIG5vbmUpXG4gKlxuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgZmluZEluZGV4ID0gZnVuY3Rpb24gKHByZWRpY2F0ZSkge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBhcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgaWYgKHByZWRpY2F0ZShhc1tpXSkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gXy5zb21lKGkpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBfLm5vbmU7XG4gICAgfTtcbn07XG5leHBvcnQgZnVuY3Rpb24gZmluZEZpcnN0KHByZWRpY2F0ZSkge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBhcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgaWYgKHByZWRpY2F0ZShhc1tpXSkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gXy5zb21lKGFzW2ldKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gXy5ub25lO1xuICAgIH07XG59XG4vKipcbiAqIEZpbmQgdGhlIGZpcnN0IGVsZW1lbnQgcmV0dXJuZWQgYnkgYW4gb3B0aW9uIGJhc2VkIHNlbGVjdG9yIGZ1bmN0aW9uXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IGZpbmRGaXJzdE1hcCB9IGZyb20gJ2ZwLXRzL1JlYWRvbmx5QXJyYXknXG4gKiBpbXBvcnQgeyBzb21lLCBub25lIH0gZnJvbSAnZnAtdHMvT3B0aW9uJ1xuICpcbiAqIGludGVyZmFjZSBQZXJzb24ge1xuICogICByZWFkb25seSBuYW1lOiBzdHJpbmdcbiAqICAgcmVhZG9ubHkgYWdlPzogbnVtYmVyXG4gKiB9XG4gKlxuICogY29uc3QgcGVyc29uczogUmVhZG9ubHlBcnJheTxQZXJzb24+ID0gW3sgbmFtZTogJ0pvaG4nIH0sIHsgbmFtZTogJ01hcnknLCBhZ2U6IDQ1IH0sIHsgbmFtZTogJ0pvZXknLCBhZ2U6IDI4IH1dXG4gKlxuICogLy8gcmV0dXJucyB0aGUgbmFtZSBvZiB0aGUgZmlyc3QgcGVyc29uIHRoYXQgaGFzIGFuIGFnZVxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChmaW5kRmlyc3RNYXAoKHA6IFBlcnNvbikgPT4gKHAuYWdlID09PSB1bmRlZmluZWQgPyBub25lIDogc29tZShwLm5hbWUpKSkocGVyc29ucyksIHNvbWUoJ01hcnknKSlcbiAqXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBmaW5kRmlyc3RNYXAgPSBmdW5jdGlvbiAoZikge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBhcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgdmFyIG91dCA9IGYoYXNbaV0pO1xuICAgICAgICAgICAgaWYgKF8uaXNTb21lKG91dCkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gb3V0O1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBfLm5vbmU7XG4gICAgfTtcbn07XG5leHBvcnQgZnVuY3Rpb24gZmluZExhc3QocHJlZGljYXRlKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykge1xuICAgICAgICBmb3IgKHZhciBpID0gYXMubGVuZ3RoIC0gMTsgaSA+PSAwOyBpLS0pIHtcbiAgICAgICAgICAgIGlmIChwcmVkaWNhdGUoYXNbaV0pKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIF8uc29tZShhc1tpXSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIF8ubm9uZTtcbiAgICB9O1xufVxuLyoqXG4gKiBGaW5kIHRoZSBsYXN0IGVsZW1lbnQgcmV0dXJuZWQgYnkgYW4gb3B0aW9uIGJhc2VkIHNlbGVjdG9yIGZ1bmN0aW9uXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IGZpbmRMYXN0TWFwIH0gZnJvbSAnZnAtdHMvUmVhZG9ubHlBcnJheSdcbiAqIGltcG9ydCB7IHNvbWUsIG5vbmUgfSBmcm9tICdmcC10cy9PcHRpb24nXG4gKlxuICogaW50ZXJmYWNlIFBlcnNvbiB7XG4gKiAgIHJlYWRvbmx5IG5hbWU6IHN0cmluZ1xuICogICByZWFkb25seSBhZ2U/OiBudW1iZXJcbiAqIH1cbiAqXG4gKiBjb25zdCBwZXJzb25zOiBSZWFkb25seUFycmF5PFBlcnNvbj4gPSBbeyBuYW1lOiAnSm9obicgfSwgeyBuYW1lOiAnTWFyeScsIGFnZTogNDUgfSwgeyBuYW1lOiAnSm9leScsIGFnZTogMjggfV1cbiAqXG4gKiAvLyByZXR1cm5zIHRoZSBuYW1lIG9mIHRoZSBsYXN0IHBlcnNvbiB0aGF0IGhhcyBhbiBhZ2VcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoZmluZExhc3RNYXAoKHA6IFBlcnNvbikgPT4gKHAuYWdlID09PSB1bmRlZmluZWQgPyBub25lIDogc29tZShwLm5hbWUpKSkocGVyc29ucyksIHNvbWUoJ0pvZXknKSlcbiAqXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBmaW5kTGFzdE1hcCA9IGZ1bmN0aW9uIChmKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykge1xuICAgICAgICBmb3IgKHZhciBpID0gYXMubGVuZ3RoIC0gMTsgaSA+PSAwOyBpLS0pIHtcbiAgICAgICAgICAgIHZhciBvdXQgPSBmKGFzW2ldKTtcbiAgICAgICAgICAgIGlmIChfLmlzU29tZShvdXQpKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG91dDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gXy5ub25lO1xuICAgIH07XG59O1xuLyoqXG4gKiBSZXR1cm5zIHRoZSBpbmRleCBvZiB0aGUgbGFzdCBlbGVtZW50IG9mIHRoZSBsaXN0IHdoaWNoIG1hdGNoZXMgdGhlIHByZWRpY2F0ZVxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBmaW5kTGFzdEluZGV4IH0gZnJvbSAnZnAtdHMvUmVhZG9ubHlBcnJheSdcbiAqIGltcG9ydCB7IHNvbWUsIG5vbmUgfSBmcm9tICdmcC10cy9PcHRpb24nXG4gKlxuICogaW50ZXJmYWNlIFgge1xuICogICByZWFkb25seSBhOiBudW1iZXJcbiAqICAgcmVhZG9ubHkgYjogbnVtYmVyXG4gKiB9XG4gKiBjb25zdCB4czogUmVhZG9ubHlBcnJheTxYPiA9IFt7IGE6IDEsIGI6IDAgfSwgeyBhOiAxLCBiOiAxIH1dXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKGZpbmRMYXN0SW5kZXgoKHg6IHsgcmVhZG9ubHkgYTogbnVtYmVyIH0pID0+IHguYSA9PT0gMSkoeHMpLCBzb21lKDEpKVxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChmaW5kTGFzdEluZGV4KCh4OiB7IHJlYWRvbmx5IGE6IG51bWJlciB9KSA9PiB4LmEgPT09IDQpKHhzKSwgbm9uZSlcbiAqXG4gKlxuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgZmluZExhc3RJbmRleCA9IGZ1bmN0aW9uIChwcmVkaWNhdGUpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIGZvciAodmFyIGkgPSBhcy5sZW5ndGggLSAxOyBpID49IDA7IGktLSkge1xuICAgICAgICAgICAgaWYgKHByZWRpY2F0ZShhc1tpXSkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gXy5zb21lKGkpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBfLm5vbmU7XG4gICAgfTtcbn07XG4vKipcbiAqIEluc2VydCBhbiBlbGVtZW50IGF0IHRoZSBzcGVjaWZpZWQgaW5kZXgsIGNyZWF0aW5nIGEgbmV3IGFycmF5LCBvciByZXR1cm5pbmcgYE5vbmVgIGlmIHRoZSBpbmRleCBpcyBvdXQgb2YgYm91bmRzXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IGluc2VydEF0IH0gZnJvbSAnZnAtdHMvUmVhZG9ubHlBcnJheSdcbiAqIGltcG9ydCB7IHNvbWUgfSBmcm9tICdmcC10cy9PcHRpb24nXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChpbnNlcnRBdCgyLCA1KShbMSwgMiwgMywgNF0pLCBzb21lKFsxLCAyLCA1LCAzLCA0XSkpXG4gKlxuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgaW5zZXJ0QXQgPSBmdW5jdGlvbiAoaSwgYSkge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgcmV0dXJuIGkgPCAwIHx8IGkgPiBhcy5sZW5ndGggPyBfLm5vbmUgOiBfLnNvbWUoUk5FQS51bnNhZmVJbnNlcnRBdChpLCBhLCBhcykpO1xuICAgIH07XG59O1xuLyoqXG4gKiBDaGFuZ2UgdGhlIGVsZW1lbnQgYXQgdGhlIHNwZWNpZmllZCBpbmRleCwgY3JlYXRpbmcgYSBuZXcgYXJyYXksIG9yIHJldHVybmluZyBgTm9uZWAgaWYgdGhlIGluZGV4IGlzIG91dCBvZiBib3VuZHNcbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgdXBkYXRlQXQgfSBmcm9tICdmcC10cy9SZWFkb25seUFycmF5J1xuICogaW1wb3J0IHsgc29tZSwgbm9uZSB9IGZyb20gJ2ZwLXRzL09wdGlvbidcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKHVwZGF0ZUF0KDEsIDEpKFsxLCAyLCAzXSksIHNvbWUoWzEsIDEsIDNdKSlcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwodXBkYXRlQXQoMSwgMSkoW10pLCBub25lKVxuICpcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIHVwZGF0ZUF0ID0gZnVuY3Rpb24gKGksIGEpIHtcbiAgICByZXR1cm4gbW9kaWZ5QXQoaSwgZnVuY3Rpb24gKCkgeyByZXR1cm4gYTsgfSk7XG59O1xuLyoqXG4gKiBEZWxldGUgdGhlIGVsZW1lbnQgYXQgdGhlIHNwZWNpZmllZCBpbmRleCwgY3JlYXRpbmcgYSBuZXcgYXJyYXksIG9yIHJldHVybmluZyBgTm9uZWAgaWYgdGhlIGluZGV4IGlzIG91dCBvZiBib3VuZHNcbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgZGVsZXRlQXQgfSBmcm9tICdmcC10cy9SZWFkb25seUFycmF5J1xuICogaW1wb3J0IHsgc29tZSwgbm9uZSB9IGZyb20gJ2ZwLXRzL09wdGlvbidcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKGRlbGV0ZUF0KDApKFsxLCAyLCAzXSksIHNvbWUoWzIsIDNdKSlcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoZGVsZXRlQXQoMSkoW10pLCBub25lKVxuICpcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIGRlbGV0ZUF0ID0gZnVuY3Rpb24gKGkpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIHJldHVybiBpc091dE9mQm91bmQoaSwgYXMpID8gXy5ub25lIDogXy5zb21lKHVuc2FmZURlbGV0ZUF0KGksIGFzKSk7XG4gICAgfTtcbn07XG4vKipcbiAqIEFwcGx5IGEgZnVuY3Rpb24gdG8gdGhlIGVsZW1lbnQgYXQgdGhlIHNwZWNpZmllZCBpbmRleCwgY3JlYXRpbmcgYSBuZXcgYXJyYXksIG9yIHJldHVybmluZyBgTm9uZWAgaWYgdGhlIGluZGV4IGlzIG91dFxuICogb2YgYm91bmRzXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IG1vZGlmeUF0IH0gZnJvbSAnZnAtdHMvUmVhZG9ubHlBcnJheSdcbiAqIGltcG9ydCB7IHNvbWUsIG5vbmUgfSBmcm9tICdmcC10cy9PcHRpb24nXG4gKlxuICogY29uc3QgZG91YmxlID0gKHg6IG51bWJlcik6IG51bWJlciA9PiB4ICogMlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChtb2RpZnlBdCgxLCBkb3VibGUpKFsxLCAyLCAzXSksIHNvbWUoWzEsIDQsIDNdKSlcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwobW9kaWZ5QXQoMSwgZG91YmxlKShbXSksIG5vbmUpXG4gKlxuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgbW9kaWZ5QXQgPSBmdW5jdGlvbiAoaSwgZikge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgcmV0dXJuIGlzT3V0T2ZCb3VuZChpLCBhcykgPyBfLm5vbmUgOiBfLnNvbWUodW5zYWZlVXBkYXRlQXQoaSwgZihhc1tpXSksIGFzKSk7XG4gICAgfTtcbn07XG4vKipcbiAqIFJldmVyc2UgYW4gYXJyYXksIGNyZWF0aW5nIGEgbmV3IGFycmF5XG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IHJldmVyc2UgfSBmcm9tICdmcC10cy9SZWFkb25seUFycmF5J1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwocmV2ZXJzZShbMSwgMiwgM10pLCBbMywgMiwgMV0pXG4gKlxuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgcmV2ZXJzZSA9IGZ1bmN0aW9uIChhcykgeyByZXR1cm4gKGFzLmxlbmd0aCA8PSAxID8gYXMgOiBhcy5zbGljZSgpLnJldmVyc2UoKSk7IH07XG4vKipcbiAqIEV4dHJhY3RzIGZyb20gYW4gYXJyYXkgb2YgYEVpdGhlcmAgYWxsIHRoZSBgUmlnaHRgIGVsZW1lbnRzLiBBbGwgdGhlIGBSaWdodGAgZWxlbWVudHMgYXJlIGV4dHJhY3RlZCBpbiBvcmRlclxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyByaWdodHMgfSBmcm9tICdmcC10cy9SZWFkb25seUFycmF5J1xuICogaW1wb3J0IHsgcmlnaHQsIGxlZnQgfSBmcm9tICdmcC10cy9FaXRoZXInXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChyaWdodHMoW3JpZ2h0KDEpLCBsZWZ0KCdmb28nKSwgcmlnaHQoMildKSwgWzEsIDJdKVxuICpcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIHJpZ2h0cyA9IGZ1bmN0aW9uIChhcykge1xuICAgIHZhciByID0gW107XG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBhcy5sZW5ndGg7IGkrKykge1xuICAgICAgICB2YXIgYSA9IGFzW2ldO1xuICAgICAgICBpZiAoYS5fdGFnID09PSAnUmlnaHQnKSB7XG4gICAgICAgICAgICByLnB1c2goYS5yaWdodCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHI7XG59O1xuLyoqXG4gKiBFeHRyYWN0cyBmcm9tIGFuIGFycmF5IG9mIGBFaXRoZXJgIGFsbCB0aGUgYExlZnRgIGVsZW1lbnRzLiBBbGwgdGhlIGBMZWZ0YCBlbGVtZW50cyBhcmUgZXh0cmFjdGVkIGluIG9yZGVyXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IGxlZnRzIH0gZnJvbSAnZnAtdHMvUmVhZG9ubHlBcnJheSdcbiAqIGltcG9ydCB7IGxlZnQsIHJpZ2h0IH0gZnJvbSAnZnAtdHMvRWl0aGVyJ1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwobGVmdHMoW3JpZ2h0KDEpLCBsZWZ0KCdmb28nKSwgcmlnaHQoMildKSwgWydmb28nXSlcbiAqXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBsZWZ0cyA9IGZ1bmN0aW9uIChhcykge1xuICAgIHZhciByID0gW107XG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBhcy5sZW5ndGg7IGkrKykge1xuICAgICAgICB2YXIgYSA9IGFzW2ldO1xuICAgICAgICBpZiAoYS5fdGFnID09PSAnTGVmdCcpIHtcbiAgICAgICAgICAgIHIucHVzaChhLmxlZnQpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiByO1xufTtcbi8qKlxuICogU29ydCB0aGUgZWxlbWVudHMgb2YgYW4gYXJyYXkgaW4gaW5jcmVhc2luZyBvcmRlciwgY3JlYXRpbmcgYSBuZXcgYXJyYXlcbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgc29ydCB9IGZyb20gJ2ZwLXRzL1JlYWRvbmx5QXJyYXknXG4gKiBpbXBvcnQgKiBhcyBOIGZyb20gJ2ZwLXRzL251bWJlcidcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKHNvcnQoTi5PcmQpKFszLCAyLCAxXSksIFsxLCAyLCAzXSlcbiAqXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBzb3J0ID0gZnVuY3Rpb24gKE8pIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIHJldHVybiBhcy5sZW5ndGggPD0gMSA/IGFzIDogYXMuc2xpY2UoKS5zb3J0KE8uY29tcGFyZSk7XG4gICAgfTtcbn07XG4vLyBUT0RPOiBjdXJyeSBhbmQgbWFrZSBkYXRhLWxhc3QgaW4gdjNcbi8qKlxuICogQXBwbHkgYSBmdW5jdGlvbiB0byBwYWlycyBvZiBlbGVtZW50cyBhdCB0aGUgc2FtZSBpbmRleCBpbiB0d28gYXJyYXlzLCBjb2xsZWN0aW5nIHRoZSByZXN1bHRzIGluIGEgbmV3IGFycmF5LiBJZiBvbmVcbiAqIGlucHV0IGFycmF5IGlzIHNob3J0LCBleGNlc3MgZWxlbWVudHMgb2YgdGhlIGxvbmdlciBhcnJheSBhcmUgZGlzY2FyZGVkLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyB6aXBXaXRoIH0gZnJvbSAnZnAtdHMvUmVhZG9ubHlBcnJheSdcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKHppcFdpdGgoWzEsIDIsIDNdLCBbJ2EnLCAnYicsICdjJywgJ2QnXSwgKG4sIHMpID0+IHMgKyBuKSwgWydhMScsICdiMicsICdjMyddKVxuICpcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIHppcFdpdGggPSBmdW5jdGlvbiAoZmEsIGZiLCBmKSB7XG4gICAgdmFyIGZjID0gW107XG4gICAgdmFyIGxlbiA9IE1hdGgubWluKGZhLmxlbmd0aCwgZmIubGVuZ3RoKTtcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IGxlbjsgaSsrKSB7XG4gICAgICAgIGZjW2ldID0gZihmYVtpXSwgZmJbaV0pO1xuICAgIH1cbiAgICByZXR1cm4gZmM7XG59O1xuZXhwb3J0IGZ1bmN0aW9uIHppcChhcywgYnMpIHtcbiAgICBpZiAoYnMgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICByZXR1cm4gZnVuY3Rpb24gKGJzKSB7IHJldHVybiB6aXAoYnMsIGFzKTsgfTtcbiAgICB9XG4gICAgcmV0dXJuIHppcFdpdGgoYXMsIGJzLCBmdW5jdGlvbiAoYSwgYikgeyByZXR1cm4gW2EsIGJdOyB9KTtcbn1cbi8qKlxuICogVGhlIGZ1bmN0aW9uIGlzIHJldmVyc2Ugb2YgYHppcGAuIFRha2VzIGFuIGFycmF5IG9mIHBhaXJzIGFuZCByZXR1cm4gdHdvIGNvcnJlc3BvbmRpbmcgYXJyYXlzXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IHVuemlwIH0gZnJvbSAnZnAtdHMvUmVhZG9ubHlBcnJheSdcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKHVuemlwKFtbMSwgJ2EnXSwgWzIsICdiJ10sIFszLCAnYyddXSksIFtbMSwgMiwgM10sIFsnYScsICdiJywgJ2MnXV0pXG4gKlxuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgdW56aXAgPSBmdW5jdGlvbiAoYXMpIHtcbiAgICB2YXIgZmEgPSBbXTtcbiAgICB2YXIgZmIgPSBbXTtcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IGFzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIGZhW2ldID0gYXNbaV1bMF07XG4gICAgICAgIGZiW2ldID0gYXNbaV1bMV07XG4gICAgfVxuICAgIHJldHVybiBbZmEsIGZiXTtcbn07XG4vKipcbiAqIFByZXBlbmQgYW4gZWxlbWVudCB0byBldmVyeSBtZW1iZXIgb2YgYW4gYXJyYXlcbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgcHJlcGVuZEFsbCB9IGZyb20gJ2ZwLXRzL1JlYWRvbmx5QXJyYXknXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChwcmVwZW5kQWxsKDkpKFsxLCAyLCAzLCA0XSksIFs5LCAxLCA5LCAyLCA5LCAzLCA5LCA0XSlcbiAqXG4gKiBAc2luY2UgMi4xMC4wXG4gKi9cbmV4cG9ydCB2YXIgcHJlcGVuZEFsbCA9IGZ1bmN0aW9uIChtaWRkbGUpIHtcbiAgICB2YXIgZiA9IFJORUEucHJlcGVuZEFsbChtaWRkbGUpO1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHsgcmV0dXJuIChpc05vbkVtcHR5KGFzKSA/IGYoYXMpIDogYXMpOyB9O1xufTtcbi8qKlxuICogUGxhY2VzIGFuIGVsZW1lbnQgaW4gYmV0d2VlbiBtZW1iZXJzIG9mIGFuIGFycmF5XG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IGludGVyc3BlcnNlIH0gZnJvbSAnZnAtdHMvUmVhZG9ubHlBcnJheSdcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKGludGVyc3BlcnNlKDkpKFsxLCAyLCAzLCA0XSksIFsxLCA5LCAyLCA5LCAzLCA5LCA0XSlcbiAqXG4gKiBAc2luY2UgMi45LjBcbiAqL1xuZXhwb3J0IHZhciBpbnRlcnNwZXJzZSA9IGZ1bmN0aW9uIChtaWRkbGUpIHtcbiAgICB2YXIgZiA9IFJORUEuaW50ZXJzcGVyc2UobWlkZGxlKTtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7IHJldHVybiAoaXNOb25FbXB0eShhcykgPyBmKGFzKSA6IGFzKTsgfTtcbn07XG4vKipcbiAqIFJvdGF0ZSBhIGBSZWFkb25seUFycmF5YCBieSBgbmAgc3RlcHMuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IHJvdGF0ZSB9IGZyb20gJ2ZwLXRzL1JlYWRvbmx5QXJyYXknXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChyb3RhdGUoMikoWzEsIDIsIDMsIDQsIDVdKSwgWzQsIDUsIDEsIDIsIDNdKVxuICpcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIHJvdGF0ZSA9IGZ1bmN0aW9uIChuKSB7XG4gICAgdmFyIGYgPSBSTkVBLnJvdGF0ZShuKTtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7IHJldHVybiAoaXNOb25FbXB0eShhcykgPyBmKGFzKSA6IGFzKTsgfTtcbn07XG5leHBvcnQgZnVuY3Rpb24gZWxlbShFKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhLCBhcykge1xuICAgICAgICBpZiAoYXMgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgdmFyIGVsZW1FXzEgPSBlbGVtKEUpO1xuICAgICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIChhcykgeyByZXR1cm4gZWxlbUVfMShhLCBhcyk7IH07XG4gICAgICAgIH1cbiAgICAgICAgdmFyIHByZWRpY2F0ZSA9IGZ1bmN0aW9uIChlbGVtZW50KSB7IHJldHVybiBFLmVxdWFscyhlbGVtZW50LCBhKTsgfTtcbiAgICAgICAgdmFyIGkgPSAwO1xuICAgICAgICBmb3IgKDsgaSA8IGFzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICBpZiAocHJlZGljYXRlKGFzW2ldKSkge1xuICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9O1xufVxuLyoqXG4gKiBSZW1vdmUgZHVwbGljYXRlcyBmcm9tIGFuIGFycmF5LCBrZWVwaW5nIHRoZSBmaXJzdCBvY2N1cnJlbmNlIG9mIGFuIGVsZW1lbnQuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IHVuaXEgfSBmcm9tICdmcC10cy9SZWFkb25seUFycmF5J1xuICogaW1wb3J0ICogYXMgTiBmcm9tICdmcC10cy9udW1iZXInXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbCh1bmlxKE4uRXEpKFsxLCAyLCAxXSksIFsxLCAyXSlcbiAqXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciB1bmlxID0gZnVuY3Rpb24gKEUpIHtcbiAgICB2YXIgZiA9IFJORUEudW5pcShFKTtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7IHJldHVybiAoaXNOb25FbXB0eShhcykgPyBmKGFzKSA6IGFzKTsgfTtcbn07XG4vKipcbiAqIFNvcnQgdGhlIGVsZW1lbnRzIG9mIGFuIGFycmF5IGluIGluY3JlYXNpbmcgb3JkZXIsIHdoZXJlIGVsZW1lbnRzIGFyZSBjb21wYXJlZCB1c2luZyBmaXJzdCBgb3Jkc1swXWAsIHRoZW4gYG9yZHNbMV1gLFxuICogZXRjLi4uXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IHNvcnRCeSB9IGZyb20gJ2ZwLXRzL1JlYWRvbmx5QXJyYXknXG4gKiBpbXBvcnQgeyBjb250cmFtYXAgfSBmcm9tICdmcC10cy9PcmQnXG4gKiBpbXBvcnQgKiBhcyBTIGZyb20gJ2ZwLXRzL3N0cmluZydcbiAqIGltcG9ydCAqIGFzIE4gZnJvbSAnZnAtdHMvbnVtYmVyJ1xuICogaW1wb3J0IHsgcGlwZSB9IGZyb20gJ2ZwLXRzL2Z1bmN0aW9uJ1xuICpcbiAqIGludGVyZmFjZSBQZXJzb24ge1xuICogICByZWFkb25seSBuYW1lOiBzdHJpbmdcbiAqICAgcmVhZG9ubHkgYWdlOiBudW1iZXJcbiAqIH1cbiAqIGNvbnN0IGJ5TmFtZSA9IHBpcGUoUy5PcmQsIGNvbnRyYW1hcCgocDogUGVyc29uKSA9PiBwLm5hbWUpKVxuICogY29uc3QgYnlBZ2UgPSBwaXBlKE4uT3JkLCBjb250cmFtYXAoKHA6IFBlcnNvbikgPT4gcC5hZ2UpKVxuICpcbiAqIGNvbnN0IHNvcnRCeU5hbWVCeUFnZSA9IHNvcnRCeShbYnlOYW1lLCBieUFnZV0pXG4gKlxuICogY29uc3QgcGVyc29ucyA9IFt7IG5hbWU6ICdhJywgYWdlOiAxIH0sIHsgbmFtZTogJ2InLCBhZ2U6IDMgfSwgeyBuYW1lOiAnYycsIGFnZTogMiB9LCB7IG5hbWU6ICdiJywgYWdlOiAyIH1dXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKHNvcnRCeU5hbWVCeUFnZShwZXJzb25zKSwgW1xuICogICB7IG5hbWU6ICdhJywgYWdlOiAxIH0sXG4gKiAgIHsgbmFtZTogJ2InLCBhZ2U6IDIgfSxcbiAqICAgeyBuYW1lOiAnYicsIGFnZTogMyB9LFxuICogICB7IG5hbWU6ICdjJywgYWdlOiAyIH1cbiAqIF0pXG4gKlxuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgc29ydEJ5ID0gZnVuY3Rpb24gKG9yZHMpIHtcbiAgICB2YXIgZiA9IFJORUEuc29ydEJ5KG9yZHMpO1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHsgcmV0dXJuIChpc05vbkVtcHR5KGFzKSA/IGYoYXMpIDogYXMpOyB9O1xufTtcbi8qKlxuICogQSB1c2VmdWwgcmVjdXJzaW9uIHBhdHRlcm4gZm9yIHByb2Nlc3NpbmcgYSBgUmVhZG9ubHlBcnJheWAgdG8gcHJvZHVjZSBhIG5ldyBgUmVhZG9ubHlBcnJheWAsIG9mdGVuIHVzZWQgZm9yIFwiY2hvcHBpbmdcIiB1cCB0aGUgaW5wdXRcbiAqIGBSZWFkb25seUFycmF5YC4gVHlwaWNhbGx5IGBjaG9wYCBpcyBjYWxsZWQgd2l0aCBzb21lIGZ1bmN0aW9uIHRoYXQgd2lsbCBjb25zdW1lIGFuIGluaXRpYWwgcHJlZml4IG9mIHRoZSBgUmVhZG9ubHlBcnJheWAgYW5kIHByb2R1Y2UgYVxuICogdmFsdWUgYW5kIHRoZSB0YWlsIG9mIHRoZSBgUmVhZG9ubHlBcnJheWAuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IEVxIH0gZnJvbSAnZnAtdHMvRXEnXG4gKiBpbXBvcnQgKiBhcyBSQSBmcm9tICdmcC10cy9SZWFkb25seUFycmF5J1xuICogaW1wb3J0ICogYXMgTiBmcm9tICdmcC10cy9udW1iZXInXG4gKiBpbXBvcnQgeyBwaXBlIH0gZnJvbSAnZnAtdHMvZnVuY3Rpb24nXG4gKlxuICogY29uc3QgZ3JvdXAgPSA8QT4oUzogRXE8QT4pOiAoKGFzOiBSZWFkb25seUFycmF5PEE+KSA9PiBSZWFkb25seUFycmF5PFJlYWRvbmx5QXJyYXk8QT4+KSA9PiB7XG4gKiAgIHJldHVybiBSQS5jaG9wKGFzID0+IHtcbiAqICAgICBjb25zdCB7IGluaXQsIHJlc3QgfSA9IHBpcGUoYXMsIFJBLnNwYW5MZWZ0KChhOiBBKSA9PiBTLmVxdWFscyhhLCBhc1swXSkpKVxuICogICAgIHJldHVybiBbaW5pdCwgcmVzdF1cbiAqICAgfSlcbiAqIH1cbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoZ3JvdXAoTi5FcSkoWzEsIDEsIDIsIDMsIDMsIDRdKSwgW1sxLCAxXSwgWzJdLCBbMywgM10sIFs0XV0pXG4gKlxuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgY2hvcCA9IGZ1bmN0aW9uIChmKSB7XG4gICAgdmFyIGcgPSBSTkVBLmNob3AoZik7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykgeyByZXR1cm4gKGlzTm9uRW1wdHkoYXMpID8gZyhhcykgOiBlbXB0eSk7IH07XG59O1xuLyoqXG4gKiBTcGxpdHMgYSBgUmVhZG9ubHlBcnJheWAgaW50byB0d28gcGllY2VzLCB0aGUgZmlyc3QgcGllY2UgaGFzIG1heCBgbmAgZWxlbWVudHMuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IHNwbGl0QXQgfSBmcm9tICdmcC10cy9SZWFkb25seUFycmF5J1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoc3BsaXRBdCgyKShbMSwgMiwgMywgNCwgNV0pLCBbWzEsIDJdLCBbMywgNCwgNV1dKVxuICpcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIHNwbGl0QXQgPSBmdW5jdGlvbiAobikge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgcmV0dXJuIG4gPj0gMSAmJiBpc05vbkVtcHR5KGFzKSA/IFJORUEuc3BsaXRBdChuKShhcykgOiBpc0VtcHR5KGFzKSA/IFthcywgZW1wdHldIDogW2VtcHR5LCBhc107XG4gICAgfTtcbn07XG4vKipcbiAqIFNwbGl0cyBhIGBSZWFkb25seUFycmF5YCBpbnRvIGxlbmd0aC1gbmAgcGllY2VzLiBUaGUgbGFzdCBwaWVjZSB3aWxsIGJlIHNob3J0ZXIgaWYgYG5gIGRvZXMgbm90IGV2ZW5seSBkaXZpZGUgdGhlIGxlbmd0aCBvZlxuICogdGhlIGBSZWFkb25seUFycmF5YC4gTm90ZSB0aGF0IGBjaHVua3NPZihuKShbXSlgIGlzIGBbXWAsIG5vdCBgW1tdXWAuIFRoaXMgaXMgaW50ZW50aW9uYWwsIGFuZCBpcyBjb25zaXN0ZW50IHdpdGggYSByZWN1cnNpdmVcbiAqIGRlZmluaXRpb24gb2YgYGNodW5rc09mYDsgaXQgc2F0aXNmaWVzIHRoZSBwcm9wZXJ0eSB0aGF0OlxuICpcbiAqIGBgYHRzXG4gKiBjaHVua3NPZihuKSh4cykuY29uY2F0KGNodW5rc09mKG4pKHlzKSkgPT0gY2h1bmtzT2YobikoeHMuY29uY2F0KHlzKSkpXG4gKiBgYGBcbiAqXG4gKiB3aGVuZXZlciBgbmAgZXZlbmx5IGRpdmlkZXMgdGhlIGxlbmd0aCBvZiBgYXNgLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBjaHVua3NPZiB9IGZyb20gJ2ZwLXRzL1JlYWRvbmx5QXJyYXknXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChjaHVua3NPZigyKShbMSwgMiwgMywgNCwgNV0pLCBbWzEsIDJdLCBbMywgNF0sIFs1XV0pXG4gKlxuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgY2h1bmtzT2YgPSBmdW5jdGlvbiAobikge1xuICAgIHZhciBmID0gUk5FQS5jaHVua3NPZihuKTtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7IHJldHVybiAoaXNOb25FbXB0eShhcykgPyBmKGFzKSA6IGVtcHR5KTsgfTtcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBsaWZ0aW5nXG4gKiBAc2luY2UgMi4xMS4wXG4gKi9cbmV4cG9ydCB2YXIgZnJvbU9wdGlvbksgPSBmdW5jdGlvbiAoZikge1xuICAgIHJldHVybiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBhID0gW107XG4gICAgICAgIGZvciAodmFyIF9pID0gMDsgX2kgPCBhcmd1bWVudHMubGVuZ3RoOyBfaSsrKSB7XG4gICAgICAgICAgICBhW19pXSA9IGFyZ3VtZW50c1tfaV07XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGZyb21PcHRpb24oZi5hcHBseSh2b2lkIDAsIGEpKTtcbiAgICB9O1xufTtcbmV4cG9ydCBmdW5jdGlvbiBjb21wcmVoZW5zaW9uKGlucHV0LCBmLCBnKSB7XG4gICAgaWYgKGcgPT09IHZvaWQgMCkgeyBnID0gZnVuY3Rpb24gKCkgeyByZXR1cm4gdHJ1ZTsgfTsgfVxuICAgIHZhciBnbyA9IGZ1bmN0aW9uIChzY29wZSwgaW5wdXQpIHtcbiAgICAgICAgcmV0dXJuIGlzTm9uRW1wdHkoaW5wdXQpXG4gICAgICAgICAgICA/IGZsYXRNYXAoUk5FQS5oZWFkKGlucHV0KSwgZnVuY3Rpb24gKGEpIHsgcmV0dXJuIGdvKHBpcGUoc2NvcGUsIGFwcGVuZChhKSksIFJORUEudGFpbChpbnB1dCkpOyB9KVxuICAgICAgICAgICAgOiBnLmFwcGx5KHZvaWQgMCwgc2NvcGUpID8gW2YuYXBwbHkodm9pZCAwLCBzY29wZSldXG4gICAgICAgICAgICAgICAgOiBlbXB0eTtcbiAgICB9O1xuICAgIHJldHVybiBnbyhlbXB0eSwgaW5wdXQpO1xufVxuLyoqXG4gKiBAc2luY2UgMi4xMS4wXG4gKi9cbmV4cG9ydCB2YXIgY29uY2F0VyA9IGZ1bmN0aW9uIChzZWNvbmQpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGZpcnN0KSB7XG4gICAgICAgIHJldHVybiBpc0VtcHR5KGZpcnN0KSA/IHNlY29uZCA6IGlzRW1wdHkoc2Vjb25kKSA/IGZpcnN0IDogZmlyc3QuY29uY2F0KHNlY29uZCk7XG4gICAgfTtcbn07XG4vKipcbiAqIEBzaW5jZSAyLjExLjBcbiAqL1xuZXhwb3J0IHZhciBjb25jYXQgPSBjb25jYXRXO1xuZXhwb3J0IGZ1bmN0aW9uIHVuaW9uKEUpIHtcbiAgICB2YXIgdW5pb25FID0gUk5FQS51bmlvbihFKTtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGZpcnN0LCBzZWNvbmQpIHtcbiAgICAgICAgaWYgKHNlY29uZCA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICB2YXIgdW5pb25FXzEgPSB1bmlvbihFKTtcbiAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbiAoc2Vjb25kKSB7IHJldHVybiB1bmlvbkVfMShzZWNvbmQsIGZpcnN0KTsgfTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gaXNOb25FbXB0eShmaXJzdCkgJiYgaXNOb25FbXB0eShzZWNvbmQpID8gdW5pb25FKHNlY29uZCkoZmlyc3QpIDogaXNOb25FbXB0eShmaXJzdCkgPyBmaXJzdCA6IHNlY29uZDtcbiAgICB9O1xufVxuZXhwb3J0IGZ1bmN0aW9uIGludGVyc2VjdGlvbihFKSB7XG4gICAgdmFyIGVsZW1FID0gZWxlbShFKTtcbiAgICByZXR1cm4gZnVuY3Rpb24gKHhzLCB5cykge1xuICAgICAgICBpZiAoeXMgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgdmFyIGludGVyc2VjdGlvbkVfMSA9IGludGVyc2VjdGlvbihFKTtcbiAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbiAoeXMpIHsgcmV0dXJuIGludGVyc2VjdGlvbkVfMSh5cywgeHMpOyB9O1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB4cy5maWx0ZXIoZnVuY3Rpb24gKGEpIHsgcmV0dXJuIGVsZW1FKGEsIHlzKTsgfSk7XG4gICAgfTtcbn1cbmV4cG9ydCBmdW5jdGlvbiBkaWZmZXJlbmNlKEUpIHtcbiAgICB2YXIgZWxlbUUgPSBlbGVtKEUpO1xuICAgIHJldHVybiBmdW5jdGlvbiAoeHMsIHlzKSB7XG4gICAgICAgIGlmICh5cyA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICB2YXIgZGlmZmVyZW5jZUVfMSA9IGRpZmZlcmVuY2UoRSk7XG4gICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24gKHlzKSB7IHJldHVybiBkaWZmZXJlbmNlRV8xKHlzLCB4cyk7IH07XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHhzLmZpbHRlcihmdW5jdGlvbiAoYSkgeyByZXR1cm4gIWVsZW1FKGEsIHlzKTsgfSk7XG4gICAgfTtcbn1cbnZhciBfbWFwID0gZnVuY3Rpb24gKGZhLCBmKSB7IHJldHVybiBwaXBlKGZhLCBtYXAoZikpOyB9O1xudmFyIF9tYXBXaXRoSW5kZXggPSBmdW5jdGlvbiAoZmEsIGYpIHsgcmV0dXJuIHBpcGUoZmEsIG1hcFdpdGhJbmRleChmKSk7IH07XG52YXIgX2FwID0gZnVuY3Rpb24gKGZhYiwgZmEpIHsgcmV0dXJuIHBpcGUoZmFiLCBhcChmYSkpOyB9O1xudmFyIF9maWx0ZXIgPSBmdW5jdGlvbiAoZmEsIHByZWRpY2F0ZSkge1xuICAgIHJldHVybiBwaXBlKGZhLCBmaWx0ZXIocHJlZGljYXRlKSk7XG59O1xudmFyIF9maWx0ZXJNYXAgPSBmdW5jdGlvbiAoZmEsIGYpIHsgcmV0dXJuIHBpcGUoZmEsIGZpbHRlck1hcChmKSk7IH07XG52YXIgX3BhcnRpdGlvbiA9IGZ1bmN0aW9uIChmYSwgcHJlZGljYXRlKSB7XG4gICAgcmV0dXJuIHBpcGUoZmEsIHBhcnRpdGlvbihwcmVkaWNhdGUpKTtcbn07XG52YXIgX3BhcnRpdGlvbk1hcCA9IGZ1bmN0aW9uIChmYSwgZikgeyByZXR1cm4gcGlwZShmYSwgcGFydGl0aW9uTWFwKGYpKTsgfTtcbnZhciBfcGFydGl0aW9uV2l0aEluZGV4ID0gZnVuY3Rpb24gKGZhLCBwcmVkaWNhdGVXaXRoSW5kZXgpIHsgcmV0dXJuIHBpcGUoZmEsIHBhcnRpdGlvbldpdGhJbmRleChwcmVkaWNhdGVXaXRoSW5kZXgpKTsgfTtcbnZhciBfcGFydGl0aW9uTWFwV2l0aEluZGV4ID0gZnVuY3Rpb24gKGZhLCBmKSB7IHJldHVybiBwaXBlKGZhLCBwYXJ0aXRpb25NYXBXaXRoSW5kZXgoZikpOyB9O1xudmFyIF9hbHQgPSBmdW5jdGlvbiAoZmEsIHRoYXQpIHsgcmV0dXJuIHBpcGUoZmEsIGFsdCh0aGF0KSk7IH07XG52YXIgX3JlZHVjZSA9IGZ1bmN0aW9uIChmYSwgYiwgZikgeyByZXR1cm4gcGlwZShmYSwgcmVkdWNlKGIsIGYpKTsgfTtcbnZhciBfZm9sZE1hcCA9IGZ1bmN0aW9uIChNKSB7XG4gICAgdmFyIGZvbGRNYXBNID0gZm9sZE1hcChNKTtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGZhLCBmKSB7IHJldHVybiBwaXBlKGZhLCBmb2xkTWFwTShmKSk7IH07XG59O1xudmFyIF9yZWR1Y2VSaWdodCA9IGZ1bmN0aW9uIChmYSwgYiwgZikgeyByZXR1cm4gcGlwZShmYSwgcmVkdWNlUmlnaHQoYiwgZikpOyB9O1xudmFyIF9yZWR1Y2VXaXRoSW5kZXggPSBmdW5jdGlvbiAoZmEsIGIsIGYpIHtcbiAgICByZXR1cm4gcGlwZShmYSwgcmVkdWNlV2l0aEluZGV4KGIsIGYpKTtcbn07XG52YXIgX2ZvbGRNYXBXaXRoSW5kZXggPSBmdW5jdGlvbiAoTSkge1xuICAgIHZhciBmb2xkTWFwV2l0aEluZGV4TSA9IGZvbGRNYXBXaXRoSW5kZXgoTSk7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChmYSwgZikgeyByZXR1cm4gcGlwZShmYSwgZm9sZE1hcFdpdGhJbmRleE0oZikpOyB9O1xufTtcbnZhciBfcmVkdWNlUmlnaHRXaXRoSW5kZXggPSBmdW5jdGlvbiAoZmEsIGIsIGYpIHtcbiAgICByZXR1cm4gcGlwZShmYSwgcmVkdWNlUmlnaHRXaXRoSW5kZXgoYiwgZikpO1xufTtcbnZhciBfZmlsdGVyTWFwV2l0aEluZGV4ID0gZnVuY3Rpb24gKGZhLCBmKSB7IHJldHVybiBwaXBlKGZhLCBmaWx0ZXJNYXBXaXRoSW5kZXgoZikpOyB9O1xudmFyIF9maWx0ZXJXaXRoSW5kZXggPSBmdW5jdGlvbiAoZmEsIHByZWRpY2F0ZVdpdGhJbmRleCkgeyByZXR1cm4gcGlwZShmYSwgZmlsdGVyV2l0aEluZGV4KHByZWRpY2F0ZVdpdGhJbmRleCkpOyB9O1xudmFyIF9leHRlbmQgPSBmdW5jdGlvbiAoZmEsIGYpIHsgcmV0dXJuIHBpcGUoZmEsIGV4dGVuZChmKSk7IH07XG52YXIgX3RyYXZlcnNlID0gZnVuY3Rpb24gKEYpIHtcbiAgICB2YXIgdHJhdmVyc2VGID0gdHJhdmVyc2UoRik7XG4gICAgcmV0dXJuIGZ1bmN0aW9uICh0YSwgZikgeyByZXR1cm4gcGlwZSh0YSwgdHJhdmVyc2VGKGYpKTsgfTtcbn07XG4vKiBpc3RhbmJ1bCBpZ25vcmUgbmV4dCAqL1xudmFyIF90cmF2ZXJzZVdpdGhJbmRleCA9IGZ1bmN0aW9uIChGKSB7XG4gICAgdmFyIHRyYXZlcnNlV2l0aEluZGV4RiA9IHRyYXZlcnNlV2l0aEluZGV4KEYpO1xuICAgIHJldHVybiBmdW5jdGlvbiAodGEsIGYpIHsgcmV0dXJuIHBpcGUodGEsIHRyYXZlcnNlV2l0aEluZGV4RihmKSk7IH07XG59O1xuLyoqIEBpbnRlcm5hbCAqL1xuZXhwb3J0IHZhciBfY2hhaW5SZWNEZXB0aEZpcnN0ID0gZnVuY3Rpb24gKGEsIGYpIHsgcmV0dXJuIHBpcGUoYSwgY2hhaW5SZWNEZXB0aEZpcnN0KGYpKTsgfTtcbi8qKiBAaW50ZXJuYWwgKi9cbmV4cG9ydCB2YXIgX2NoYWluUmVjQnJlYWR0aEZpcnN0ID0gZnVuY3Rpb24gKGEsIGYpIHsgcmV0dXJuIHBpcGUoYSwgY2hhaW5SZWNCcmVhZHRoRmlyc3QoZikpOyB9O1xuLyoqXG4gKiBAY2F0ZWdvcnkgY29uc3RydWN0b3JzXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBvZiA9IFJORUEub2Y7XG4vKipcbiAqIEBzaW5jZSAyLjcuMFxuICovXG5leHBvcnQgdmFyIHplcm8gPSBmdW5jdGlvbiAoKSB7IHJldHVybiBlbXB0eTsgfTtcbi8qKlxuICogTGVzcyBzdHJpY3QgdmVyc2lvbiBvZiBbYGFsdGBdKCNhbHQpLlxuICpcbiAqIFRoZSBgV2Agc3VmZml4IChzaG9ydCBmb3IgKipXKippZGVuaW5nKSBtZWFucyB0aGF0IHRoZSByZXR1cm4gdHlwZXMgd2lsbCBiZSBtZXJnZWQuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCAqIGFzIFJBIGZyb20gJ2ZwLXRzL1JlYWRvbmx5QXJyYXknXG4gKiBpbXBvcnQgeyBwaXBlIH0gZnJvbSAnZnAtdHMvZnVuY3Rpb24nXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChcbiAqICAgcGlwZShcbiAqICAgICBbMSwgMiwgM10sXG4gKiAgICAgUkEuYWx0VygoKSA9PiBbJ2EnLCAnYiddKVxuICogICApLFxuICogICBbMSwgMiwgMywgJ2EnLCAnYiddXG4gKiApXG4gKlxuICogQGNhdGVnb3J5IGVycm9yIGhhbmRsaW5nXG4gKiBAc2luY2UgMi45LjBcbiAqL1xuZXhwb3J0IHZhciBhbHRXID0gZnVuY3Rpb24gKHRoYXQpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGZhKSB7XG4gICAgICAgIHJldHVybiBmYS5jb25jYXQodGhhdCgpKTtcbiAgICB9O1xufTtcbi8qKlxuICogSWRlbnRpZmllcyBhbiBhc3NvY2lhdGl2ZSBvcGVyYXRpb24gb24gYSB0eXBlIGNvbnN0cnVjdG9yLiBJdCBpcyBzaW1pbGFyIHRvIGBTZW1pZ3JvdXBgLCBleGNlcHQgdGhhdCBpdCBhcHBsaWVzIHRvXG4gKiB0eXBlcyBvZiBraW5kIGAqIC0+ICpgLlxuICpcbiAqIEluIGNhc2Ugb2YgYFJlYWRvbmx5QXJyYXlgIGNvbmNhdGVuYXRlcyB0aGUgaW5wdXRzIGludG8gYSBzaW5nbGUgYXJyYXkuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCAqIGFzIFJBIGZyb20gJ2ZwLXRzL1JlYWRvbmx5QXJyYXknXG4gKiBpbXBvcnQgeyBwaXBlIH0gZnJvbSAnZnAtdHMvZnVuY3Rpb24nXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChcbiAqICAgcGlwZShcbiAqICAgICBbMSwgMiwgM10sXG4gKiAgICAgUkEuYWx0KCgpID0+IFs0LCA1XSlcbiAqICAgKSxcbiAqICAgWzEsIDIsIDMsIDQsIDVdXG4gKiApXG4gKlxuICogQGNhdGVnb3J5IGVycm9yIGhhbmRsaW5nXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBhbHQgPSBhbHRXO1xuLyoqXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBhcCA9IGZ1bmN0aW9uIChmYSkge1xuICAgIHJldHVybiBmbGF0TWFwKGZ1bmN0aW9uIChmKSB7IHJldHVybiBwaXBlKGZhLCBtYXAoZikpOyB9KTtcbn07XG4vKipcbiAqIENvbXBvc2VzIGNvbXB1dGF0aW9ucyBpbiBzZXF1ZW5jZSwgdXNpbmcgdGhlIHJldHVybiB2YWx1ZSBvZiBvbmUgY29tcHV0YXRpb24gdG8gZGV0ZXJtaW5lIHRoZSBuZXh0IGNvbXB1dGF0aW9uLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgKiBhcyBSQSBmcm9tICdmcC10cy9SZWFkb25seUFycmF5J1xuICogaW1wb3J0IHsgcGlwZSB9IGZyb20gJ2ZwLXRzL2Z1bmN0aW9uJ1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoXG4gKiAgIHBpcGUoXG4gKiAgICAgWzEsIDIsIDNdLFxuICogICAgIFJBLmZsYXRNYXAoKG4pID0+IFtgYSR7bn1gLCBgYiR7bn1gXSlcbiAqICAgKSxcbiAqICAgWydhMScsICdiMScsICdhMicsICdiMicsICdhMycsICdiMyddXG4gKiApXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKFxuICogICBwaXBlKFxuICogICAgIFsxLCAyLCAzXSxcbiAqICAgICBSQS5mbGF0TWFwKCgpID0+IFtdKVxuICogICApLFxuICogICBbXVxuICogKVxuICpcbiAqIEBjYXRlZ29yeSBzZXF1ZW5jaW5nXG4gKiBAc2luY2UgMi4xNC4wXG4gKi9cbmV4cG9ydCB2YXIgZmxhdE1hcCA9IC8qI19fUFVSRV9fKi8gZHVhbCgyLCBmdW5jdGlvbiAobWEsIGYpIHtcbiAgICByZXR1cm4gcGlwZShtYSwgY2hhaW5XaXRoSW5kZXgoZnVuY3Rpb24gKGksIGEpIHsgcmV0dXJuIGYoYSwgaSk7IH0pKTtcbn0pO1xuLyoqXG4gKiBAY2F0ZWdvcnkgc2VxdWVuY2luZ1xuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgZmxhdHRlbiA9IC8qI19fUFVSRV9fKi8gZmxhdE1hcChpZGVudGl0eSk7XG4vKipcbiAqIGBtYXBgIGNhbiBiZSB1c2VkIHRvIHR1cm4gZnVuY3Rpb25zIGAoYTogQSkgPT4gQmAgaW50byBmdW5jdGlvbnMgYChmYTogRjxBPikgPT4gRjxCPmAgd2hvc2UgYXJndW1lbnQgYW5kIHJldHVybiB0eXBlc1xuICogdXNlIHRoZSB0eXBlIGNvbnN0cnVjdG9yIGBGYCB0byByZXByZXNlbnQgc29tZSBjb21wdXRhdGlvbmFsIGNvbnRleHQuXG4gKlxuICogQGNhdGVnb3J5IG1hcHBpbmdcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIG1hcCA9IGZ1bmN0aW9uIChmKSB7IHJldHVybiBmdW5jdGlvbiAoZmEpIHtcbiAgICByZXR1cm4gZmEubWFwKGZ1bmN0aW9uIChhKSB7IHJldHVybiBmKGEpOyB9KTtcbn07IH07XG4vKipcbiAqIEBjYXRlZ29yeSBtYXBwaW5nXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBtYXBXaXRoSW5kZXggPSBmdW5jdGlvbiAoZikgeyByZXR1cm4gZnVuY3Rpb24gKGZhKSB7XG4gICAgcmV0dXJuIGZhLm1hcChmdW5jdGlvbiAoYSwgaSkgeyByZXR1cm4gZihpLCBhKTsgfSk7XG59OyB9O1xuLyoqXG4gKiBAY2F0ZWdvcnkgZmlsdGVyaW5nXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBzZXBhcmF0ZSA9IGZ1bmN0aW9uIChmYSkge1xuICAgIHZhciBsZWZ0ID0gW107XG4gICAgdmFyIHJpZ2h0ID0gW107XG4gICAgZm9yICh2YXIgX2kgPSAwLCBmYV8xID0gZmE7IF9pIDwgZmFfMS5sZW5ndGg7IF9pKyspIHtcbiAgICAgICAgdmFyIGUgPSBmYV8xW19pXTtcbiAgICAgICAgaWYgKGUuX3RhZyA9PT0gJ0xlZnQnKSB7XG4gICAgICAgICAgICBsZWZ0LnB1c2goZS5sZWZ0KTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHJpZ2h0LnB1c2goZS5yaWdodCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHNlcGFyYXRlZChsZWZ0LCByaWdodCk7XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgZmlsdGVyaW5nXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBmaWx0ZXIgPSBmdW5jdGlvbiAocHJlZGljYXRlKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykge1xuICAgICAgICByZXR1cm4gYXMuZmlsdGVyKHByZWRpY2F0ZSk7XG4gICAgfTtcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBmaWx0ZXJpbmdcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIGZpbHRlck1hcFdpdGhJbmRleCA9IGZ1bmN0aW9uIChmKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChmYSkge1xuICAgICAgICB2YXIgb3V0ID0gW107XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgZmEubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIHZhciBvcHRpb25CID0gZihpLCBmYVtpXSk7XG4gICAgICAgICAgICBpZiAoXy5pc1NvbWUob3B0aW9uQikpIHtcbiAgICAgICAgICAgICAgICBvdXQucHVzaChvcHRpb25CLnZhbHVlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gb3V0O1xuICAgIH07XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgZmlsdGVyaW5nXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBmaWx0ZXJNYXAgPSBmdW5jdGlvbiAoZikge1xuICAgIHJldHVybiBmaWx0ZXJNYXBXaXRoSW5kZXgoZnVuY3Rpb24gKF8sIGEpIHsgcmV0dXJuIGYoYSk7IH0pO1xufTtcbi8qKlxuICogQGNhdGVnb3J5IGZpbHRlcmluZ1xuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgY29tcGFjdCA9IC8qI19fUFVSRV9fKi8gZmlsdGVyTWFwKGlkZW50aXR5KTtcbi8qKlxuICogQGNhdGVnb3J5IGZpbHRlcmluZ1xuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgcGFydGl0aW9uID0gZnVuY3Rpb24gKHByZWRpY2F0ZSkge1xuICAgIHJldHVybiBwYXJ0aXRpb25XaXRoSW5kZXgoZnVuY3Rpb24gKF8sIGEpIHsgcmV0dXJuIHByZWRpY2F0ZShhKTsgfSk7XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgZmlsdGVyaW5nXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBwYXJ0aXRpb25XaXRoSW5kZXggPSBmdW5jdGlvbiAocHJlZGljYXRlV2l0aEluZGV4KSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykge1xuICAgICAgICB2YXIgbGVmdCA9IFtdO1xuICAgICAgICB2YXIgcmlnaHQgPSBbXTtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBhcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgdmFyIGEgPSBhc1tpXTtcbiAgICAgICAgICAgIGlmIChwcmVkaWNhdGVXaXRoSW5kZXgoaSwgYSkpIHtcbiAgICAgICAgICAgICAgICByaWdodC5wdXNoKGEpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgbGVmdC5wdXNoKGEpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBzZXBhcmF0ZWQobGVmdCwgcmlnaHQpO1xuICAgIH07XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgZmlsdGVyaW5nXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBwYXJ0aXRpb25NYXAgPSBmdW5jdGlvbiAoZikge1xuICAgIHJldHVybiBwYXJ0aXRpb25NYXBXaXRoSW5kZXgoZnVuY3Rpb24gKF8sIGEpIHsgcmV0dXJuIGYoYSk7IH0pO1xufTtcbi8qKlxuICogQGNhdGVnb3J5IGZpbHRlcmluZ1xuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgcGFydGl0aW9uTWFwV2l0aEluZGV4ID0gZnVuY3Rpb24gKGYpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGZhKSB7XG4gICAgICAgIHZhciBsZWZ0ID0gW107XG4gICAgICAgIHZhciByaWdodCA9IFtdO1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGZhLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICB2YXIgZSA9IGYoaSwgZmFbaV0pO1xuICAgICAgICAgICAgaWYgKGUuX3RhZyA9PT0gJ0xlZnQnKSB7XG4gICAgICAgICAgICAgICAgbGVmdC5wdXNoKGUubGVmdCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICByaWdodC5wdXNoKGUucmlnaHQpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBzZXBhcmF0ZWQobGVmdCwgcmlnaHQpO1xuICAgIH07XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgZmlsdGVyaW5nXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBmaWx0ZXJXaXRoSW5kZXggPSBmdW5jdGlvbiAocHJlZGljYXRlV2l0aEluZGV4KSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykge1xuICAgICAgICByZXR1cm4gYXMuZmlsdGVyKGZ1bmN0aW9uIChhLCBpKSB7IHJldHVybiBwcmVkaWNhdGVXaXRoSW5kZXgoaSwgYSk7IH0pO1xuICAgIH07XG59O1xuLyoqXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBleHRlbmQgPSBmdW5jdGlvbiAoZikgeyByZXR1cm4gZnVuY3Rpb24gKHdhKSB7XG4gICAgcmV0dXJuIHdhLm1hcChmdW5jdGlvbiAoXywgaSkgeyByZXR1cm4gZih3YS5zbGljZShpKSk7IH0pO1xufTsgfTtcbi8qKlxuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgZHVwbGljYXRlID0gLyojX19QVVJFX18qLyBleHRlbmQoaWRlbnRpdHkpO1xuLyoqXG4gKiBAY2F0ZWdvcnkgZm9sZGluZ1xuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgZm9sZE1hcFdpdGhJbmRleCA9IGZ1bmN0aW9uIChNKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChmKSB7XG4gICAgICAgIHJldHVybiBmdW5jdGlvbiAoZmEpIHtcbiAgICAgICAgICAgIHJldHVybiBmYS5yZWR1Y2UoZnVuY3Rpb24gKGIsIGEsIGkpIHsgcmV0dXJuIE0uY29uY2F0KGIsIGYoaSwgYSkpOyB9LCBNLmVtcHR5KTtcbiAgICAgICAgfTtcbiAgICB9O1xufTtcbi8qKlxuICogQGNhdGVnb3J5IGZvbGRpbmdcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIHJlZHVjZSA9IGZ1bmN0aW9uIChiLCBmKSB7XG4gICAgcmV0dXJuIHJlZHVjZVdpdGhJbmRleChiLCBmdW5jdGlvbiAoXywgYiwgYSkgeyByZXR1cm4gZihiLCBhKTsgfSk7XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgZm9sZGluZ1xuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgZm9sZE1hcCA9IGZ1bmN0aW9uIChNKSB7XG4gICAgdmFyIGZvbGRNYXBXaXRoSW5kZXhNID0gZm9sZE1hcFdpdGhJbmRleChNKTtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGYpIHsgcmV0dXJuIGZvbGRNYXBXaXRoSW5kZXhNKGZ1bmN0aW9uIChfLCBhKSB7IHJldHVybiBmKGEpOyB9KTsgfTtcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBmb2xkaW5nXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciByZWR1Y2VXaXRoSW5kZXggPSBmdW5jdGlvbiAoYiwgZikgeyByZXR1cm4gZnVuY3Rpb24gKGZhKSB7XG4gICAgdmFyIGxlbiA9IGZhLmxlbmd0aDtcbiAgICB2YXIgb3V0ID0gYjtcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IGxlbjsgaSsrKSB7XG4gICAgICAgIG91dCA9IGYoaSwgb3V0LCBmYVtpXSk7XG4gICAgfVxuICAgIHJldHVybiBvdXQ7XG59OyB9O1xuLyoqXG4gKiBAY2F0ZWdvcnkgZm9sZGluZ1xuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgcmVkdWNlUmlnaHQgPSBmdW5jdGlvbiAoYiwgZikge1xuICAgIHJldHVybiByZWR1Y2VSaWdodFdpdGhJbmRleChiLCBmdW5jdGlvbiAoXywgYSwgYikgeyByZXR1cm4gZihhLCBiKTsgfSk7XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgZm9sZGluZ1xuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgcmVkdWNlUmlnaHRXaXRoSW5kZXggPSBmdW5jdGlvbiAoYiwgZikgeyByZXR1cm4gZnVuY3Rpb24gKGZhKSB7XG4gICAgcmV0dXJuIGZhLnJlZHVjZVJpZ2h0KGZ1bmN0aW9uIChiLCBhLCBpKSB7IHJldHVybiBmKGksIGEsIGIpOyB9LCBiKTtcbn07IH07XG4vKipcbiAqIEBjYXRlZ29yeSB0cmF2ZXJzaW5nXG4gKiBAc2luY2UgMi42LjNcbiAqL1xuZXhwb3J0IHZhciB0cmF2ZXJzZSA9IGZ1bmN0aW9uIChGKSB7XG4gICAgdmFyIHRyYXZlcnNlV2l0aEluZGV4RiA9IHRyYXZlcnNlV2l0aEluZGV4KEYpO1xuICAgIHJldHVybiBmdW5jdGlvbiAoZikgeyByZXR1cm4gdHJhdmVyc2VXaXRoSW5kZXhGKGZ1bmN0aW9uIChfLCBhKSB7IHJldHVybiBmKGEpOyB9KTsgfTtcbn07XG4vKipcbiAqIEBjYXRlZ29yeSB0cmF2ZXJzaW5nXG4gKiBAc2luY2UgMi42LjNcbiAqL1xuZXhwb3J0IHZhciBzZXF1ZW5jZSA9IGZ1bmN0aW9uIChGKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uICh0YSkge1xuICAgICAgICByZXR1cm4gX3JlZHVjZSh0YSwgRi5vZih6ZXJvKCkpLCBmdW5jdGlvbiAoZmFzLCBmYSkge1xuICAgICAgICAgICAgcmV0dXJuIEYuYXAoRi5tYXAoZmFzLCBmdW5jdGlvbiAoYXMpIHsgcmV0dXJuIGZ1bmN0aW9uIChhKSB7IHJldHVybiBwaXBlKGFzLCBhcHBlbmQoYSkpOyB9OyB9KSwgZmEpO1xuICAgICAgICB9KTtcbiAgICB9O1xufTtcbi8qKlxuICogQGNhdGVnb3J5IHNlcXVlbmNpbmdcbiAqIEBzaW5jZSAyLjYuM1xuICovXG5leHBvcnQgdmFyIHRyYXZlcnNlV2l0aEluZGV4ID0gZnVuY3Rpb24gKEYpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGYpIHtcbiAgICAgICAgcmV0dXJuIHJlZHVjZVdpdGhJbmRleChGLm9mKHplcm8oKSksIGZ1bmN0aW9uIChpLCBmYnMsIGEpIHtcbiAgICAgICAgICAgIHJldHVybiBGLmFwKEYubWFwKGZicywgZnVuY3Rpb24gKGJzKSB7IHJldHVybiBmdW5jdGlvbiAoYikgeyByZXR1cm4gcGlwZShicywgYXBwZW5kKGIpKTsgfTsgfSksIGYoaSwgYSkpO1xuICAgICAgICB9KTtcbiAgICB9O1xufTtcbi8qKlxuICogQGNhdGVnb3J5IGZpbHRlcmluZ1xuICogQHNpbmNlIDIuNi41XG4gKi9cbmV4cG9ydCB2YXIgd2l0aGVyID0gZnVuY3Rpb24gKEYpIHtcbiAgICB2YXIgX3dpdGhlckYgPSBfd2l0aGVyKEYpO1xuICAgIHJldHVybiBmdW5jdGlvbiAoZikgeyByZXR1cm4gZnVuY3Rpb24gKGZhKSB7IHJldHVybiBfd2l0aGVyRihmYSwgZik7IH07IH07XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgZmlsdGVyaW5nXG4gKiBAc2luY2UgMi42LjVcbiAqL1xuZXhwb3J0IHZhciB3aWx0ID0gZnVuY3Rpb24gKEYpIHtcbiAgICB2YXIgX3dpbHRGID0gX3dpbHQoRik7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChmKSB7IHJldHVybiBmdW5jdGlvbiAoZmEpIHsgcmV0dXJuIF93aWx0RihmYSwgZik7IH07IH07XG59O1xuLyoqXG4gKiBAc2luY2UgMi42LjZcbiAqL1xuZXhwb3J0IHZhciB1bmZvbGQgPSBmdW5jdGlvbiAoYiwgZikge1xuICAgIHZhciBvdXQgPSBbXTtcbiAgICB2YXIgYmIgPSBiO1xuICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBuby1jb25zdGFudC1jb25kaXRpb25cbiAgICB3aGlsZSAodHJ1ZSkge1xuICAgICAgICB2YXIgbXQgPSBmKGJiKTtcbiAgICAgICAgaWYgKF8uaXNTb21lKG10KSkge1xuICAgICAgICAgICAgdmFyIF9hID0gbXQudmFsdWUsIGEgPSBfYVswXSwgYl8xID0gX2FbMV07XG4gICAgICAgICAgICBvdXQucHVzaChhKTtcbiAgICAgICAgICAgIGJiID0gYl8xO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIG91dDtcbn07XG4vKipcbiAqIEBjYXRlZ29yeSB0eXBlIGxhbWJkYXNcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIFVSSSA9ICdSZWFkb25seUFycmF5Jztcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgZ2V0U2hvdyA9IGZ1bmN0aW9uIChTKSB7IHJldHVybiAoe1xuICAgIHNob3c6IGZ1bmN0aW9uIChhcykgeyByZXR1cm4gXCJbXCIuY29uY2F0KGFzLm1hcChTLnNob3cpLmpvaW4oJywgJyksIFwiXVwiKTsgfVxufSk7IH07XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIGdldFNlbWlncm91cCA9IGZ1bmN0aW9uICgpIHsgcmV0dXJuICh7XG4gICAgY29uY2F0OiBmdW5jdGlvbiAoZmlyc3QsIHNlY29uZCkgeyByZXR1cm4gKGlzRW1wdHkoZmlyc3QpID8gc2Vjb25kIDogaXNFbXB0eShzZWNvbmQpID8gZmlyc3QgOiBmaXJzdC5jb25jYXQoc2Vjb25kKSk7IH1cbn0pOyB9O1xuLyoqXG4gKiBSZXR1cm5zIGEgYE1vbm9pZGAgZm9yIGBSZWFkb25seUFycmF5PEE+YC5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgZ2V0TW9ub2lkIH0gZnJvbSAnZnAtdHMvUmVhZG9ubHlBcnJheSdcbiAqXG4gKiBjb25zdCBNID0gZ2V0TW9ub2lkPG51bWJlcj4oKVxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChNLmNvbmNhdChbMSwgMl0sIFszLCA0XSksIFsxLCAyLCAzLCA0XSlcbiAqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBnZXRNb25vaWQgPSBmdW5jdGlvbiAoKSB7IHJldHVybiAoe1xuICAgIGNvbmNhdDogZ2V0U2VtaWdyb3VwKCkuY29uY2F0LFxuICAgIGVtcHR5OiBlbXB0eVxufSk7IH07XG4vKipcbiAqIERlcml2ZXMgYW4gYEVxYCBvdmVyIHRoZSBgUmVhZG9ubHlBcnJheWAgb2YgYSBnaXZlbiBlbGVtZW50IHR5cGUgZnJvbSB0aGUgYEVxYCBvZiB0aGF0IHR5cGUuIFRoZSBkZXJpdmVkIGBFcWAgZGVmaW5lcyB0d29cbiAqIGFycmF5cyBhcyBlcXVhbCBpZiBhbGwgZWxlbWVudHMgb2YgYm90aCBhcnJheXMgYXJlIGNvbXBhcmVkIGVxdWFsIHBhaXJ3aXNlIHdpdGggdGhlIGdpdmVuIGBFYC4gSW4gY2FzZSBvZiBhcnJheXMgb2ZcbiAqIGRpZmZlcmVudCBsZW5ndGhzLCB0aGUgcmVzdWx0IGlzIG5vbiBlcXVhbGl0eS5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0ICogYXMgUyBmcm9tICdmcC10cy9zdHJpbmcnXG4gKiBpbXBvcnQgeyBnZXRFcSB9IGZyb20gJ2ZwLXRzL1JlYWRvbmx5QXJyYXknXG4gKlxuICogY29uc3QgRSA9IGdldEVxKFMuRXEpXG4gKiBhc3NlcnQuc3RyaWN0RXF1YWwoRS5lcXVhbHMoWydhJywgJ2InXSwgWydhJywgJ2InXSksIHRydWUpXG4gKiBhc3NlcnQuc3RyaWN0RXF1YWwoRS5lcXVhbHMoWydhJ10sIFtdKSwgZmFsc2UpXG4gKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgZ2V0RXEgPSBmdW5jdGlvbiAoRSkge1xuICAgIHJldHVybiBmcm9tRXF1YWxzKGZ1bmN0aW9uICh4cywgeXMpIHsgcmV0dXJuIHhzLmxlbmd0aCA9PT0geXMubGVuZ3RoICYmIHhzLmV2ZXJ5KGZ1bmN0aW9uICh4LCBpKSB7IHJldHVybiBFLmVxdWFscyh4LCB5c1tpXSk7IH0pOyB9KTtcbn07XG4vKipcbiAqIERlcml2ZXMgYW4gYE9yZGAgb3ZlciB0aGUgYFJlYWRvbmx5QXJyYXlgIG9mIGEgZ2l2ZW4gZWxlbWVudCB0eXBlIGZyb20gdGhlIGBPcmRgIG9mIHRoYXQgdHlwZS4gVGhlIG9yZGVyaW5nIGJldHdlZW4gdHdvIHN1Y2hcbiAqIGFycmF5cyBpcyBlcXVhbCB0bzogdGhlIGZpcnN0IG5vbiBlcXVhbCBjb21wYXJpc29uIG9mIGVhY2ggYXJyYXlzIGVsZW1lbnRzIHRha2VuIHBhaXJ3aXNlIGluIGluY3JlYXNpbmcgb3JkZXIsIGluXG4gKiBjYXNlIG9mIGVxdWFsaXR5IG92ZXIgYWxsIHRoZSBwYWlyd2lzZSBlbGVtZW50czsgdGhlIGxvbmdlc3QgYXJyYXkgaXMgY29uc2lkZXJlZCB0aGUgZ3JlYXRlc3QsIGlmIGJvdGggYXJyYXlzIGhhdmVcbiAqIHRoZSBzYW1lIGxlbmd0aCwgdGhlIHJlc3VsdCBpcyBlcXVhbGl0eS5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgZ2V0T3JkIH0gZnJvbSAnZnAtdHMvUmVhZG9ubHlBcnJheSdcbiAqIGltcG9ydCAqIGFzIFMgZnJvbSAnZnAtdHMvc3RyaW5nJ1xuICpcbiAqIGNvbnN0IE8gPSBnZXRPcmQoUy5PcmQpXG4gKiBhc3NlcnQuc3RyaWN0RXF1YWwoTy5jb21wYXJlKFsnYiddLCBbJ2EnXSksIDEpXG4gKiBhc3NlcnQuc3RyaWN0RXF1YWwoTy5jb21wYXJlKFsnYSddLCBbJ2EnXSksIDApXG4gKiBhc3NlcnQuc3RyaWN0RXF1YWwoTy5jb21wYXJlKFsnYSddLCBbJ2InXSksIC0xKVxuICpcbiAqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBnZXRPcmQgPSBmdW5jdGlvbiAoTykge1xuICAgIHJldHVybiBmcm9tQ29tcGFyZShmdW5jdGlvbiAoYSwgYikge1xuICAgICAgICB2YXIgYUxlbiA9IGEubGVuZ3RoO1xuICAgICAgICB2YXIgYkxlbiA9IGIubGVuZ3RoO1xuICAgICAgICB2YXIgbGVuID0gTWF0aC5taW4oYUxlbiwgYkxlbik7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbGVuOyBpKyspIHtcbiAgICAgICAgICAgIHZhciBvcmRlcmluZyA9IE8uY29tcGFyZShhW2ldLCBiW2ldKTtcbiAgICAgICAgICAgIGlmIChvcmRlcmluZyAhPT0gMCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBvcmRlcmluZztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gTi5PcmQuY29tcGFyZShhTGVuLCBiTGVuKTtcbiAgICB9KTtcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjExLjBcbiAqL1xuZXhwb3J0IHZhciBnZXRVbmlvblNlbWlncm91cCA9IGZ1bmN0aW9uIChFKSB7XG4gICAgdmFyIHVuaW9uRSA9IHVuaW9uKEUpO1xuICAgIHJldHVybiB7XG4gICAgICAgIGNvbmNhdDogZnVuY3Rpb24gKGZpcnN0LCBzZWNvbmQpIHsgcmV0dXJuIHVuaW9uRShzZWNvbmQpKGZpcnN0KTsgfVxuICAgIH07XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi4xMS4wXG4gKi9cbmV4cG9ydCB2YXIgZ2V0VW5pb25Nb25vaWQgPSBmdW5jdGlvbiAoRSkgeyByZXR1cm4gKHtcbiAgICBjb25jYXQ6IGdldFVuaW9uU2VtaWdyb3VwKEUpLmNvbmNhdCxcbiAgICBlbXB0eTogZW1wdHlcbn0pOyB9O1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi4xMS4wXG4gKi9cbmV4cG9ydCB2YXIgZ2V0SW50ZXJzZWN0aW9uU2VtaWdyb3VwID0gZnVuY3Rpb24gKEUpIHtcbiAgICB2YXIgaW50ZXJzZWN0aW9uRSA9IGludGVyc2VjdGlvbihFKTtcbiAgICByZXR1cm4ge1xuICAgICAgICBjb25jYXQ6IGZ1bmN0aW9uIChmaXJzdCwgc2Vjb25kKSB7IHJldHVybiBpbnRlcnNlY3Rpb25FKHNlY29uZCkoZmlyc3QpOyB9XG4gICAgfTtcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjExLjBcbiAqL1xuZXhwb3J0IHZhciBnZXREaWZmZXJlbmNlTWFnbWEgPSBmdW5jdGlvbiAoRSkge1xuICAgIHZhciBkaWZmZXJlbmNlRSA9IGRpZmZlcmVuY2UoRSk7XG4gICAgcmV0dXJuIHtcbiAgICAgICAgY29uY2F0OiBmdW5jdGlvbiAoZmlyc3QsIHNlY29uZCkgeyByZXR1cm4gZGlmZmVyZW5jZUUoc2Vjb25kKShmaXJzdCk7IH1cbiAgICB9O1xufTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuNy4wXG4gKi9cbmV4cG9ydCB2YXIgRnVuY3RvciA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICBtYXA6IF9tYXBcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBtYXBwaW5nXG4gKiBAc2luY2UgMi4xMC4wXG4gKi9cbmV4cG9ydCB2YXIgZmxhcCA9IC8qI19fUFVSRV9fKi8gZmxhcF8oRnVuY3Rvcik7XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjEwLjBcbiAqL1xuZXhwb3J0IHZhciBQb2ludGVkID0ge1xuICAgIFVSSTogVVJJLFxuICAgIG9mOiBvZlxufTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuNy4wXG4gKi9cbmV4cG9ydCB2YXIgRnVuY3RvcldpdGhJbmRleCA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICBtYXA6IF9tYXAsXG4gICAgbWFwV2l0aEluZGV4OiBfbWFwV2l0aEluZGV4XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi4xMC4wXG4gKi9cbmV4cG9ydCB2YXIgQXBwbHkgPSB7XG4gICAgVVJJOiBVUkksXG4gICAgbWFwOiBfbWFwLFxuICAgIGFwOiBfYXBcbn07XG4vKipcbiAqIENvbWJpbmUgdHdvIGVmZmVjdGZ1bCBhY3Rpb25zLCBrZWVwaW5nIG9ubHkgdGhlIHJlc3VsdCBvZiB0aGUgZmlyc3QuXG4gKlxuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgYXBGaXJzdCA9IC8qI19fUFVSRV9fKi8gYXBGaXJzdF8oQXBwbHkpO1xuLyoqXG4gKiBDb21iaW5lIHR3byBlZmZlY3RmdWwgYWN0aW9ucywga2VlcGluZyBvbmx5IHRoZSByZXN1bHQgb2YgdGhlIHNlY29uZC5cbiAqXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBhcFNlY29uZCA9IC8qI19fUFVSRV9fKi8gYXBTZWNvbmRfKEFwcGx5KTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuNy4wXG4gKi9cbmV4cG9ydCB2YXIgQXBwbGljYXRpdmUgPSB7XG4gICAgVVJJOiBVUkksXG4gICAgbWFwOiBfbWFwLFxuICAgIGFwOiBfYXAsXG4gICAgb2Y6IG9mXG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi4xMC4wXG4gKi9cbmV4cG9ydCB2YXIgQ2hhaW4gPSB7XG4gICAgVVJJOiBVUkksXG4gICAgbWFwOiBfbWFwLFxuICAgIGFwOiBfYXAsXG4gICAgY2hhaW46IGZsYXRNYXBcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjcuMFxuICovXG5leHBvcnQgdmFyIE1vbmFkID0ge1xuICAgIFVSSTogVVJJLFxuICAgIG1hcDogX21hcCxcbiAgICBhcDogX2FwLFxuICAgIG9mOiBvZixcbiAgICBjaGFpbjogZmxhdE1hcFxufTtcbi8qKlxuICogQ29tcG9zZXMgY29tcHV0YXRpb25zIGluIHNlcXVlbmNlLCB1c2luZyB0aGUgcmV0dXJuIHZhbHVlIG9mIG9uZSBjb21wdXRhdGlvbiB0byBkZXRlcm1pbmUgdGhlIG5leHQgY29tcHV0YXRpb24gYW5kXG4gKiBrZWVwaW5nIG9ubHkgdGhlIHJlc3VsdCBvZiB0aGUgZmlyc3QuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCAqIGFzIFJBIGZyb20gJ2ZwLXRzL1JlYWRvbmx5QXJyYXknXG4gKiBpbXBvcnQgeyBwaXBlIH0gZnJvbSAnZnAtdHMvZnVuY3Rpb24nXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChcbiAqICAgcGlwZShcbiAqICAgICBbMSwgMiwgM10sXG4gKiAgICAgUkEuY2hhaW5GaXJzdCgoKSA9PiBbJ2EnLCAnYiddKVxuICogICApLFxuICogICBbMSwgMSwgMiwgMiwgMywgM11cbiAqIClcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoXG4gKiAgIHBpcGUoXG4gKiAgICAgWzEsIDIsIDNdLFxuICogICAgIFJBLmNoYWluRmlyc3QoKCkgPT4gW10pXG4gKiAgICksXG4gKiAgIFtdXG4gKiApXG4gKlxuICogQGNhdGVnb3J5IHNlcXVlbmNpbmdcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIGNoYWluRmlyc3QgPSBcbi8qI19fUFVSRV9fKi8gY2hhaW5GaXJzdF8oQ2hhaW4pO1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi43LjBcbiAqL1xuZXhwb3J0IHZhciBVbmZvbGRhYmxlID0ge1xuICAgIFVSSTogVVJJLFxuICAgIHVuZm9sZDogdW5mb2xkXG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi43LjBcbiAqL1xuZXhwb3J0IHZhciBBbHQgPSB7XG4gICAgVVJJOiBVUkksXG4gICAgbWFwOiBfbWFwLFxuICAgIGFsdDogX2FsdFxufTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIFplcm8gPSB7XG4gICAgVVJJOiBVUkksXG4gICAgemVybzogemVyb1xufTtcbi8qKlxuICogQGNhdGVnb3J5IGRvIG5vdGF0aW9uXG4gKiBAc2luY2UgMi4xMS4wXG4gKi9cbmV4cG9ydCB2YXIgZ3VhcmQgPSAvKiNfX1BVUkVfXyovIGd1YXJkXyhaZXJvLCBQb2ludGVkKTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuNy4wXG4gKi9cbmV4cG9ydCB2YXIgQWx0ZXJuYXRpdmUgPSB7XG4gICAgVVJJOiBVUkksXG4gICAgbWFwOiBfbWFwLFxuICAgIGFwOiBfYXAsXG4gICAgb2Y6IG9mLFxuICAgIGFsdDogX2FsdCxcbiAgICB6ZXJvOiB6ZXJvXG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi43LjBcbiAqL1xuZXhwb3J0IHZhciBFeHRlbmQgPSB7XG4gICAgVVJJOiBVUkksXG4gICAgbWFwOiBfbWFwLFxuICAgIGV4dGVuZDogX2V4dGVuZFxufTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuNy4wXG4gKi9cbmV4cG9ydCB2YXIgQ29tcGFjdGFibGUgPSB7XG4gICAgVVJJOiBVUkksXG4gICAgY29tcGFjdDogY29tcGFjdCxcbiAgICBzZXBhcmF0ZTogc2VwYXJhdGVcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjcuMFxuICovXG5leHBvcnQgdmFyIEZpbHRlcmFibGUgPSB7XG4gICAgVVJJOiBVUkksXG4gICAgbWFwOiBfbWFwLFxuICAgIGNvbXBhY3Q6IGNvbXBhY3QsXG4gICAgc2VwYXJhdGU6IHNlcGFyYXRlLFxuICAgIGZpbHRlcjogX2ZpbHRlcixcbiAgICBmaWx0ZXJNYXA6IF9maWx0ZXJNYXAsXG4gICAgcGFydGl0aW9uOiBfcGFydGl0aW9uLFxuICAgIHBhcnRpdGlvbk1hcDogX3BhcnRpdGlvbk1hcFxufTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuNy4wXG4gKi9cbmV4cG9ydCB2YXIgRmlsdGVyYWJsZVdpdGhJbmRleCA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICBtYXA6IF9tYXAsXG4gICAgbWFwV2l0aEluZGV4OiBfbWFwV2l0aEluZGV4LFxuICAgIGNvbXBhY3Q6IGNvbXBhY3QsXG4gICAgc2VwYXJhdGU6IHNlcGFyYXRlLFxuICAgIGZpbHRlcjogX2ZpbHRlcixcbiAgICBmaWx0ZXJNYXA6IF9maWx0ZXJNYXAsXG4gICAgcGFydGl0aW9uOiBfcGFydGl0aW9uLFxuICAgIHBhcnRpdGlvbk1hcDogX3BhcnRpdGlvbk1hcCxcbiAgICBwYXJ0aXRpb25NYXBXaXRoSW5kZXg6IF9wYXJ0aXRpb25NYXBXaXRoSW5kZXgsXG4gICAgcGFydGl0aW9uV2l0aEluZGV4OiBfcGFydGl0aW9uV2l0aEluZGV4LFxuICAgIGZpbHRlck1hcFdpdGhJbmRleDogX2ZpbHRlck1hcFdpdGhJbmRleCxcbiAgICBmaWx0ZXJXaXRoSW5kZXg6IF9maWx0ZXJXaXRoSW5kZXhcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjcuMFxuICovXG5leHBvcnQgdmFyIEZvbGRhYmxlID0ge1xuICAgIFVSSTogVVJJLFxuICAgIHJlZHVjZTogX3JlZHVjZSxcbiAgICBmb2xkTWFwOiBfZm9sZE1hcCxcbiAgICByZWR1Y2VSaWdodDogX3JlZHVjZVJpZ2h0XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi43LjBcbiAqL1xuZXhwb3J0IHZhciBGb2xkYWJsZVdpdGhJbmRleCA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICByZWR1Y2U6IF9yZWR1Y2UsXG4gICAgZm9sZE1hcDogX2ZvbGRNYXAsXG4gICAgcmVkdWNlUmlnaHQ6IF9yZWR1Y2VSaWdodCxcbiAgICByZWR1Y2VXaXRoSW5kZXg6IF9yZWR1Y2VXaXRoSW5kZXgsXG4gICAgZm9sZE1hcFdpdGhJbmRleDogX2ZvbGRNYXBXaXRoSW5kZXgsXG4gICAgcmVkdWNlUmlnaHRXaXRoSW5kZXg6IF9yZWR1Y2VSaWdodFdpdGhJbmRleFxufTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuNy4wXG4gKi9cbmV4cG9ydCB2YXIgVHJhdmVyc2FibGUgPSB7XG4gICAgVVJJOiBVUkksXG4gICAgbWFwOiBfbWFwLFxuICAgIHJlZHVjZTogX3JlZHVjZSxcbiAgICBmb2xkTWFwOiBfZm9sZE1hcCxcbiAgICByZWR1Y2VSaWdodDogX3JlZHVjZVJpZ2h0LFxuICAgIHRyYXZlcnNlOiBfdHJhdmVyc2UsXG4gICAgc2VxdWVuY2U6IHNlcXVlbmNlXG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi43LjBcbiAqL1xuZXhwb3J0IHZhciBUcmF2ZXJzYWJsZVdpdGhJbmRleCA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICBtYXA6IF9tYXAsXG4gICAgbWFwV2l0aEluZGV4OiBfbWFwV2l0aEluZGV4LFxuICAgIHJlZHVjZTogX3JlZHVjZSxcbiAgICBmb2xkTWFwOiBfZm9sZE1hcCxcbiAgICByZWR1Y2VSaWdodDogX3JlZHVjZVJpZ2h0LFxuICAgIHJlZHVjZVdpdGhJbmRleDogX3JlZHVjZVdpdGhJbmRleCxcbiAgICBmb2xkTWFwV2l0aEluZGV4OiBfZm9sZE1hcFdpdGhJbmRleCxcbiAgICByZWR1Y2VSaWdodFdpdGhJbmRleDogX3JlZHVjZVJpZ2h0V2l0aEluZGV4LFxuICAgIHRyYXZlcnNlOiBfdHJhdmVyc2UsXG4gICAgc2VxdWVuY2U6IHNlcXVlbmNlLFxuICAgIHRyYXZlcnNlV2l0aEluZGV4OiBfdHJhdmVyc2VXaXRoSW5kZXhcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBzZXF1ZW5jaW5nXG4gKiBAc2luY2UgMi4xMS4wXG4gKi9cbmV4cG9ydCB2YXIgY2hhaW5SZWNEZXB0aEZpcnN0ID0gZnVuY3Rpb24gKGYpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGEpIHtcbiAgICAgICAgdmFyIHRvZG8gPSBfX3NwcmVhZEFycmF5KFtdLCBmKGEpLCB0cnVlKTtcbiAgICAgICAgdmFyIG91dCA9IFtdO1xuICAgICAgICB3aGlsZSAodG9kby5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICB2YXIgZSA9IHRvZG8uc2hpZnQoKTtcbiAgICAgICAgICAgIGlmIChfLmlzTGVmdChlKSkge1xuICAgICAgICAgICAgICAgIHRvZG8udW5zaGlmdC5hcHBseSh0b2RvLCBmKGUubGVmdCkpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgb3V0LnB1c2goZS5yaWdodCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG91dDtcbiAgICB9O1xufTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIENoYWluUmVjRGVwdGhGaXJzdCA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICBtYXA6IF9tYXAsXG4gICAgYXA6IF9hcCxcbiAgICBjaGFpbjogZmxhdE1hcCxcbiAgICBjaGFpblJlYzogX2NoYWluUmVjRGVwdGhGaXJzdFxufTtcbi8qKlxuICogQGNhdGVnb3J5IHNlcXVlbmNpbmdcbiAqIEBzaW5jZSAyLjExLjBcbiAqL1xuZXhwb3J0IHZhciBjaGFpblJlY0JyZWFkdGhGaXJzdCA9IGZ1bmN0aW9uIChmKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhKSB7XG4gICAgICAgIHZhciBpbml0aWFsID0gZihhKTtcbiAgICAgICAgdmFyIHRvZG8gPSBbXTtcbiAgICAgICAgdmFyIG91dCA9IFtdO1xuICAgICAgICBmdW5jdGlvbiBnbyhlKSB7XG4gICAgICAgICAgICBpZiAoXy5pc0xlZnQoZSkpIHtcbiAgICAgICAgICAgICAgICBmKGUubGVmdCkuZm9yRWFjaChmdW5jdGlvbiAodikgeyByZXR1cm4gdG9kby5wdXNoKHYpOyB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIG91dC5wdXNoKGUucmlnaHQpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGZvciAodmFyIF9pID0gMCwgaW5pdGlhbF8xID0gaW5pdGlhbDsgX2kgPCBpbml0aWFsXzEubGVuZ3RoOyBfaSsrKSB7XG4gICAgICAgICAgICB2YXIgZSA9IGluaXRpYWxfMVtfaV07XG4gICAgICAgICAgICBnbyhlKTtcbiAgICAgICAgfVxuICAgICAgICB3aGlsZSAodG9kby5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICBnbyh0b2RvLnNoaWZ0KCkpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBvdXQ7XG4gICAgfTtcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjExLjBcbiAqL1xuZXhwb3J0IHZhciBDaGFpblJlY0JyZWFkdGhGaXJzdCA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICBtYXA6IF9tYXAsXG4gICAgYXA6IF9hcCxcbiAgICBjaGFpbjogZmxhdE1hcCxcbiAgICBjaGFpblJlYzogX2NoYWluUmVjQnJlYWR0aEZpcnN0XG59O1xudmFyIF93aXRoZXIgPSAvKiNfX1BVUkVfXyovIHdpdGhlckRlZmF1bHQoVHJhdmVyc2FibGUsIENvbXBhY3RhYmxlKTtcbnZhciBfd2lsdCA9IC8qI19fUFVSRV9fKi8gd2lsdERlZmF1bHQoVHJhdmVyc2FibGUsIENvbXBhY3RhYmxlKTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuNy4wXG4gKi9cbmV4cG9ydCB2YXIgV2l0aGVyYWJsZSA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICBtYXA6IF9tYXAsXG4gICAgY29tcGFjdDogY29tcGFjdCxcbiAgICBzZXBhcmF0ZTogc2VwYXJhdGUsXG4gICAgZmlsdGVyOiBfZmlsdGVyLFxuICAgIGZpbHRlck1hcDogX2ZpbHRlck1hcCxcbiAgICBwYXJ0aXRpb246IF9wYXJ0aXRpb24sXG4gICAgcGFydGl0aW9uTWFwOiBfcGFydGl0aW9uTWFwLFxuICAgIHJlZHVjZTogX3JlZHVjZSxcbiAgICBmb2xkTWFwOiBfZm9sZE1hcCxcbiAgICByZWR1Y2VSaWdodDogX3JlZHVjZVJpZ2h0LFxuICAgIHRyYXZlcnNlOiBfdHJhdmVyc2UsXG4gICAgc2VxdWVuY2U6IHNlcXVlbmNlLFxuICAgIHdpdGhlcjogX3dpdGhlcixcbiAgICB3aWx0OiBfd2lsdFxufTtcbi8qKlxuICogRmlsdGVyIHZhbHVlcyBpbnNpZGUgYSBjb250ZXh0LlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBwaXBlIH0gZnJvbSAnZnAtdHMvZnVuY3Rpb24nXG4gKiBpbXBvcnQgKiBhcyBSQSBmcm9tICdmcC10cy9SZWFkb25seUFycmF5J1xuICogaW1wb3J0ICogYXMgVCBmcm9tICdmcC10cy9UYXNrJ1xuICpcbiAqIGNvbnN0IGZpbHRlckUgPSBSQS5maWx0ZXJFKFQuQXBwbGljYXRpdmVQYXIpXG4gKiBhc3luYyBmdW5jdGlvbiB0ZXN0KCkge1xuICogICBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKFxuICogICAgIGF3YWl0IHBpcGUoXG4gKiAgICAgICBbLTEsIDIsIDNdLFxuICogICAgICAgZmlsdGVyRSgobikgPT4gVC5vZihuID4gMCkpXG4gKiAgICAgKSgpLFxuICogICAgIFsyLCAzXVxuICogICApXG4gKiB9XG4gKiB0ZXN0KClcbiAqXG4gKiBAc2luY2UgMi4xMS4wXG4gKi9cbmV4cG9ydCB2YXIgZmlsdGVyRSA9IC8qI19fUFVSRV9fKi8gZmlsdGVyRV8oV2l0aGVyYWJsZSk7XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjExLjBcbiAqL1xuZXhwb3J0IHZhciBGcm9tRWl0aGVyID0ge1xuICAgIFVSSTogVVJJLFxuICAgIGZyb21FaXRoZXI6IGZyb21FaXRoZXJcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBsaWZ0aW5nXG4gKiBAc2luY2UgMi4xMS4wXG4gKi9cbmV4cG9ydCB2YXIgZnJvbUVpdGhlcksgPSAvKiNfX1BVUkVfXyovIGZyb21FaXRoZXJLXyhGcm9tRWl0aGVyKTtcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8vIHVuc2FmZVxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLyoqXG4gKiBAY2F0ZWdvcnkgdW5zYWZlXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciB1bnNhZmVJbnNlcnRBdCA9IFJORUEudW5zYWZlSW5zZXJ0QXQ7XG4vKipcbiAqIEBjYXRlZ29yeSB1bnNhZmVcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIHVuc2FmZVVwZGF0ZUF0ID0gZnVuY3Rpb24gKGksIGEsIGFzKSB7XG4gICAgcmV0dXJuIGlzTm9uRW1wdHkoYXMpID8gUk5FQS51bnNhZmVVcGRhdGVBdChpLCBhLCBhcykgOiBhcztcbn07XG4vKipcbiAqIEBjYXRlZ29yeSB1bnNhZmVcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIHVuc2FmZURlbGV0ZUF0ID0gZnVuY3Rpb24gKGksIGFzKSB7XG4gICAgdmFyIHhzID0gYXMuc2xpY2UoKTtcbiAgICB4cy5zcGxpY2UoaSwgMSk7XG4gICAgcmV0dXJuIHhzO1xufTtcbi8qKlxuICogQGNhdGVnb3J5IGNvbnZlcnNpb25zXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciB0b0FycmF5ID0gZnVuY3Rpb24gKGFzKSB7IHJldHVybiBhcy5zbGljZSgpOyB9O1xuLyoqXG4gKiBAY2F0ZWdvcnkgY29udmVyc2lvbnNcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIGZyb21BcnJheSA9IGZ1bmN0aW9uIChhcykgeyByZXR1cm4gKGlzRW1wdHkoYXMpID8gZW1wdHkgOiBhcy5zbGljZSgpKTsgfTtcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8vIHV0aWxzXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vKipcbiAqIEFuIGVtcHR5IGFycmF5XG4gKlxuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgZW1wdHkgPSBSTkVBLmVtcHR5O1xuZXhwb3J0IGZ1bmN0aW9uIGV2ZXJ5KHByZWRpY2F0ZSkge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHsgcmV0dXJuIGFzLmV2ZXJ5KHByZWRpY2F0ZSk7IH07XG59XG4vKipcbiAqIENoZWNrIGlmIGEgcHJlZGljYXRlIGhvbGRzIHRydWUgZm9yIGFueSBhcnJheSBtZW1iZXIuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IHNvbWUgfSBmcm9tICdmcC10cy9SZWFkb25seUFycmF5J1xuICogaW1wb3J0IHsgcGlwZSB9IGZyb20gJ2ZwLXRzL2Z1bmN0aW9uJ1xuICpcbiAqIGNvbnN0IGlzUG9zaXRpdmUgPSAobjogbnVtYmVyKTogYm9vbGVhbiA9PiBuID4gMFxuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwocGlwZShbLTEsIC0yLCAzXSwgc29tZShpc1Bvc2l0aXZlKSksIHRydWUpXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKHBpcGUoWy0xLCAtMiwgLTNdLCBzb21lKGlzUG9zaXRpdmUpKSwgZmFsc2UpXG4gKlxuICogQHNpbmNlIDIuOS4wXG4gKi9cbmV4cG9ydCB2YXIgc29tZSA9IGZ1bmN0aW9uIChwcmVkaWNhdGUpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIHJldHVybiBhcy5zb21lKHByZWRpY2F0ZSk7XG4gICAgfTtcbn07XG4vKipcbiAqIEFsaWFzIG9mIFtgc29tZWBdKCNzb21lKVxuICpcbiAqIEBzaW5jZSAyLjExLjBcbiAqL1xuZXhwb3J0IHZhciBleGlzdHMgPSBzb21lO1xuLyoqXG4gKiBQbGFjZXMgYW4gZWxlbWVudCBpbiBiZXR3ZWVuIG1lbWJlcnMgb2YgYSBgUmVhZG9ubHlBcnJheWAsIHRoZW4gZm9sZHMgdGhlIHJlc3VsdHMgdXNpbmcgdGhlIHByb3ZpZGVkIGBNb25vaWRgLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgKiBhcyBTIGZyb20gJ2ZwLXRzL3N0cmluZydcbiAqIGltcG9ydCB7IGludGVyY2FsYXRlIH0gZnJvbSAnZnAtdHMvUmVhZG9ubHlBcnJheSdcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKGludGVyY2FsYXRlKFMuTW9ub2lkKSgnLScpKFsnYScsICdiJywgJ2MnXSksICdhLWItYycpXG4gKlxuICogQHNpbmNlIDIuMTIuMFxuICovXG5leHBvcnQgdmFyIGludGVyY2FsYXRlID0gZnVuY3Rpb24gKE0pIHtcbiAgICB2YXIgaW50ZXJjYWxhdGVNID0gUk5FQS5pbnRlcmNhbGF0ZShNKTtcbiAgICByZXR1cm4gZnVuY3Rpb24gKG1pZGRsZSkgeyByZXR1cm4gbWF0Y2goZnVuY3Rpb24gKCkgeyByZXR1cm4gTS5lbXB0eTsgfSwgaW50ZXJjYWxhdGVNKG1pZGRsZSkpOyB9O1xufTtcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8vIGRvIG5vdGF0aW9uXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vKipcbiAqIEBjYXRlZ29yeSBkbyBub3RhdGlvblxuICogQHNpbmNlIDIuOS4wXG4gKi9cbmV4cG9ydCB2YXIgRG8gPSAvKiNfX1BVUkVfXyovIG9mKF8uZW1wdHlSZWNvcmQpO1xuLyoqXG4gKiBAY2F0ZWdvcnkgZG8gbm90YXRpb25cbiAqIEBzaW5jZSAyLjguMFxuICovXG5leHBvcnQgdmFyIGJpbmRUbyA9IC8qI19fUFVSRV9fKi8gYmluZFRvXyhGdW5jdG9yKTtcbnZhciBsZXRfID0gLyojX19QVVJFX18qLyBsZXRfXyhGdW5jdG9yKTtcbmV4cG9ydCB7IFxuLyoqXG4gKiBAY2F0ZWdvcnkgZG8gbm90YXRpb25cbiAqIEBzaW5jZSAyLjEzLjBcbiAqL1xubGV0XyBhcyBsZXQgfTtcbi8qKlxuICogQGNhdGVnb3J5IGRvIG5vdGF0aW9uXG4gKiBAc2luY2UgMi44LjBcbiAqL1xuZXhwb3J0IHZhciBiaW5kID0gLyojX19QVVJFX18qLyBiaW5kXyhDaGFpbik7XG4vKipcbiAqIEBjYXRlZ29yeSBkbyBub3RhdGlvblxuICogQHNpbmNlIDIuOC4wXG4gKi9cbmV4cG9ydCB2YXIgYXBTID0gLyojX19QVVJFX18qLyBhcFNfKEFwcGx5KTtcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8vIGxlZ2FjeVxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLyoqXG4gKiBBbGlhcyBvZiBgZmxhdE1hcGAuXG4gKlxuICogQGNhdGVnb3J5IGxlZ2FjeVxuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgY2hhaW4gPSBmbGF0TWFwO1xuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLy8gZGVwcmVjYXRlZFxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLyoqXG4gKiBVc2UgYFJlYWRvbmx5Tm9uRW1wdHlBcnJheWAgbW9kdWxlIGluc3RlYWQuXG4gKlxuICogQGNhdGVnb3J5IHpvbmUgb2YgZGVhdGhcbiAqIEBzaW5jZSAyLjUuMFxuICogQGRlcHJlY2F0ZWRcbiAqL1xuZXhwb3J0IHZhciByYW5nZSA9IFJORUEucmFuZ2U7XG4vKipcbiAqIFVzZSBbYHByZXBlbmRgXSgjcHJlcGVuZCkgaW5zdGVhZC5cbiAqXG4gKiBAY2F0ZWdvcnkgem9uZSBvZiBkZWF0aFxuICogQHNpbmNlIDIuNS4wXG4gKiBAZGVwcmVjYXRlZFxuICovXG5leHBvcnQgdmFyIGNvbnMgPSBSTkVBLmNvbnM7XG4vKipcbiAqIFVzZSBbYGFwcGVuZGBdKCNhcHBlbmQpIGluc3RlYWQuXG4gKlxuICogQGNhdGVnb3J5IHpvbmUgb2YgZGVhdGhcbiAqIEBzaW5jZSAyLjUuMFxuICogQGRlcHJlY2F0ZWRcbiAqL1xuZXhwb3J0IHZhciBzbm9jID0gUk5FQS5zbm9jO1xuLyoqXG4gKiBVc2UgW2BwcmVwZW5kQWxsYF0oI3ByZXBlbmRhbGwpIGluc3RlYWQuXG4gKlxuICogQGNhdGVnb3J5IHpvbmUgb2YgZGVhdGhcbiAqIEBzaW5jZSAyLjkuMFxuICogQGRlcHJlY2F0ZWRcbiAqL1xuZXhwb3J0IHZhciBwcmVwZW5kVG9BbGwgPSBwcmVwZW5kQWxsO1xuLyoqXG4gKiBUaGlzIGluc3RhbmNlIGlzIGRlcHJlY2F0ZWQsIHVzZSBzbWFsbCwgc3BlY2lmaWMgaW5zdGFuY2VzIGluc3RlYWQuXG4gKiBGb3IgZXhhbXBsZSBpZiBhIGZ1bmN0aW9uIG5lZWRzIGEgYEZ1bmN0b3JgIGluc3RhbmNlLCBwYXNzIGBSQS5GdW5jdG9yYCBpbnN0ZWFkIG9mIGBSQS5yZWFkb25seUFycmF5YFxuICogKHdoZXJlIGBSQWAgaXMgZnJvbSBgaW1wb3J0IFJBIGZyb20gJ2ZwLXRzL1JlYWRvbmx5QXJyYXknYClcbiAqXG4gKiBAY2F0ZWdvcnkgem9uZSBvZiBkZWF0aFxuICogQHNpbmNlIDIuNS4wXG4gKiBAZGVwcmVjYXRlZFxuICovXG5leHBvcnQgdmFyIHJlYWRvbmx5QXJyYXkgPSB7XG4gICAgVVJJOiBVUkksXG4gICAgY29tcGFjdDogY29tcGFjdCxcbiAgICBzZXBhcmF0ZTogc2VwYXJhdGUsXG4gICAgbWFwOiBfbWFwLFxuICAgIGFwOiBfYXAsXG4gICAgb2Y6IG9mLFxuICAgIGNoYWluOiBmbGF0TWFwLFxuICAgIGZpbHRlcjogX2ZpbHRlcixcbiAgICBmaWx0ZXJNYXA6IF9maWx0ZXJNYXAsXG4gICAgcGFydGl0aW9uOiBfcGFydGl0aW9uLFxuICAgIHBhcnRpdGlvbk1hcDogX3BhcnRpdGlvbk1hcCxcbiAgICBtYXBXaXRoSW5kZXg6IF9tYXBXaXRoSW5kZXgsXG4gICAgcGFydGl0aW9uTWFwV2l0aEluZGV4OiBfcGFydGl0aW9uTWFwV2l0aEluZGV4LFxuICAgIHBhcnRpdGlvbldpdGhJbmRleDogX3BhcnRpdGlvbldpdGhJbmRleCxcbiAgICBmaWx0ZXJNYXBXaXRoSW5kZXg6IF9maWx0ZXJNYXBXaXRoSW5kZXgsXG4gICAgZmlsdGVyV2l0aEluZGV4OiBfZmlsdGVyV2l0aEluZGV4LFxuICAgIGFsdDogX2FsdCxcbiAgICB6ZXJvOiB6ZXJvLFxuICAgIHVuZm9sZDogdW5mb2xkLFxuICAgIHJlZHVjZTogX3JlZHVjZSxcbiAgICBmb2xkTWFwOiBfZm9sZE1hcCxcbiAgICByZWR1Y2VSaWdodDogX3JlZHVjZVJpZ2h0LFxuICAgIHRyYXZlcnNlOiBfdHJhdmVyc2UsXG4gICAgc2VxdWVuY2U6IHNlcXVlbmNlLFxuICAgIHJlZHVjZVdpdGhJbmRleDogX3JlZHVjZVdpdGhJbmRleCxcbiAgICBmb2xkTWFwV2l0aEluZGV4OiBfZm9sZE1hcFdpdGhJbmRleCxcbiAgICByZWR1Y2VSaWdodFdpdGhJbmRleDogX3JlZHVjZVJpZ2h0V2l0aEluZGV4LFxuICAgIHRyYXZlcnNlV2l0aEluZGV4OiBfdHJhdmVyc2VXaXRoSW5kZXgsXG4gICAgZXh0ZW5kOiBfZXh0ZW5kLFxuICAgIHdpdGhlcjogX3dpdGhlcixcbiAgICB3aWx0OiBfd2lsdFxufTtcbiIsCiAgInZhciBfX3NwcmVhZEFycmF5ID0gKHRoaXMgJiYgdGhpcy5fX3NwcmVhZEFycmF5KSB8fCBmdW5jdGlvbiAodG8sIGZyb20sIHBhY2spIHtcbiAgICBpZiAocGFjayB8fCBhcmd1bWVudHMubGVuZ3RoID09PSAyKSBmb3IgKHZhciBpID0gMCwgbCA9IGZyb20ubGVuZ3RoLCBhcjsgaSA8IGw7IGkrKykge1xuICAgICAgICBpZiAoYXIgfHwgIShpIGluIGZyb20pKSB7XG4gICAgICAgICAgICBpZiAoIWFyKSBhciA9IEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGZyb20sIDAsIGkpO1xuICAgICAgICAgICAgYXJbaV0gPSBmcm9tW2ldO1xuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiB0by5jb25jYXQoYXIgfHwgQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoZnJvbSkpO1xufTtcbmltcG9ydCB7IGFwRmlyc3QgYXMgYXBGaXJzdF8sIGFwUyBhcyBhcFNfLCBhcFNlY29uZCBhcyBhcFNlY29uZF8gfSBmcm9tICcuL0FwcGx5JztcbmltcG9ydCB7IGJpbmQgYXMgYmluZF8sIGNoYWluRmlyc3QgYXMgY2hhaW5GaXJzdF8gfSBmcm9tICcuL0NoYWluJztcbmltcG9ydCB7IGZyb21FcXVhbHMgfSBmcm9tICcuL0VxJztcbmltcG9ydCB7IGZyb21FaXRoZXJLIGFzIGZyb21FaXRoZXJLXyB9IGZyb20gJy4vRnJvbUVpdGhlcic7XG5pbXBvcnQgeyBkdWFsLCBpZGVudGl0eSwgcGlwZSB9IGZyb20gJy4vZnVuY3Rpb24nO1xuaW1wb3J0IHsgYmluZFRvIGFzIGJpbmRUb18sIGZsYXAgYXMgZmxhcF8sIGxldCBhcyBsZXRfXyB9IGZyb20gJy4vRnVuY3Rvcic7XG5pbXBvcnQgKiBhcyBfIGZyb20gJy4vaW50ZXJuYWwnO1xuaW1wb3J0ICogYXMgTiBmcm9tICcuL251bWJlcic7XG5pbXBvcnQgeyBmcm9tQ29tcGFyZSB9IGZyb20gJy4vT3JkJztcbmltcG9ydCAqIGFzIFJORUEgZnJvbSAnLi9SZWFkb25seU5vbkVtcHR5QXJyYXknO1xuaW1wb3J0IHsgc2VwYXJhdGVkIH0gZnJvbSAnLi9TZXBhcmF0ZWQnO1xuaW1wb3J0IHsgZmlsdGVyRSBhcyBmaWx0ZXJFXywgd2lsdERlZmF1bHQsIHdpdGhlckRlZmF1bHQgfSBmcm9tICcuL1dpdGhlcmFibGUnO1xuaW1wb3J0IHsgZ3VhcmQgYXMgZ3VhcmRfIH0gZnJvbSAnLi9aZXJvJztcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8vIHJlZmluZW1lbnRzXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vKipcbiAqIFRlc3Qgd2hldGhlciBhIGBSZWFkb25seUFycmF5YCBpcyBlbXB0eS5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgaXNFbXB0eSB9IGZyb20gJ2ZwLXRzL1JlYWRvbmx5QXJyYXknXG4gKlxuICogYXNzZXJ0LnN0cmljdEVxdWFsKGlzRW1wdHkoW10pLCB0cnVlKVxuICpcbiAqIEBjYXRlZ29yeSByZWZpbmVtZW50c1xuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgaXNFbXB0eSA9IGZ1bmN0aW9uIChhcykgeyByZXR1cm4gYXMubGVuZ3RoID09PSAwOyB9O1xuLyoqXG4gKiBUZXN0IHdoZXRoZXIgYSBgUmVhZG9ubHlBcnJheWAgaXMgbm9uIGVtcHR5LlxuICpcbiAqIEBjYXRlZ29yeSByZWZpbmVtZW50c1xuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgaXNOb25FbXB0eSA9IFJORUEuaXNOb25FbXB0eTtcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8vIGNvbnN0cnVjdG9yc1xuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLyoqXG4gKiBQcmVwZW5kIGFuIGVsZW1lbnQgdG8gdGhlIGZyb250IG9mIGEgYFJlYWRvbmx5QXJyYXlgLCBjcmVhdGluZyBhIG5ldyBgUmVhZG9ubHlOb25FbXB0eUFycmF5YC5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgcHJlcGVuZCB9IGZyb20gJ2ZwLXRzL1JlYWRvbmx5QXJyYXknXG4gKiBpbXBvcnQgeyBwaXBlIH0gZnJvbSAnZnAtdHMvZnVuY3Rpb24nXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChwaXBlKFsyLCAzLCA0XSwgcHJlcGVuZCgxKSksIFsxLCAyLCAzLCA0XSlcbiAqXG4gKiBAc2luY2UgMi4xMC4wXG4gKi9cbmV4cG9ydCB2YXIgcHJlcGVuZCA9IFJORUEucHJlcGVuZDtcbi8qKlxuICogTGVzcyBzdHJpY3QgdmVyc2lvbiBvZiBbYHByZXBlbmRgXSgjcHJlcGVuZCkuXG4gKlxuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIHByZXBlbmRXID0gUk5FQS5wcmVwZW5kVztcbi8qKlxuICogQXBwZW5kIGFuIGVsZW1lbnQgdG8gdGhlIGVuZCBvZiBhIGBSZWFkb25seUFycmF5YCwgY3JlYXRpbmcgYSBuZXcgYFJlYWRvbmx5Tm9uRW1wdHlBcnJheWAuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IGFwcGVuZCB9IGZyb20gJ2ZwLXRzL1JlYWRvbmx5QXJyYXknXG4gKiBpbXBvcnQgeyBwaXBlIH0gZnJvbSAnZnAtdHMvZnVuY3Rpb24nXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChwaXBlKFsxLCAyLCAzXSwgYXBwZW5kKDQpKSwgWzEsIDIsIDMsIDRdKVxuICpcbiAqIEBzaW5jZSAyLjEwLjBcbiAqL1xuZXhwb3J0IHZhciBhcHBlbmQgPSBSTkVBLmFwcGVuZDtcbi8qKlxuICogTGVzcyBzdHJpY3QgdmVyc2lvbiBvZiBbYGFwcGVuZGBdKCNhcHBlbmQpLlxuICpcbiAqIEBzaW5jZSAyLjExLjBcbiAqL1xuZXhwb3J0IHZhciBhcHBlbmRXID0gUk5FQS5hcHBlbmRXO1xuLyoqXG4gKiBSZXR1cm4gYSBgUmVhZG9ubHlBcnJheWAgb2YgbGVuZ3RoIGBuYCB3aXRoIGVsZW1lbnQgYGlgIGluaXRpYWxpemVkIHdpdGggYGYoaSlgLlxuICpcbiAqICoqTm90ZSoqLiBgbmAgaXMgbm9ybWFsaXplZCB0byBhIG5vbiBuZWdhdGl2ZSBpbnRlZ2VyLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBtYWtlQnkgfSBmcm9tICdmcC10cy9SZWFkb25seUFycmF5J1xuICpcbiAqIGNvbnN0IGRvdWJsZSA9IChuOiBudW1iZXIpOiBudW1iZXIgPT4gbiAqIDJcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwobWFrZUJ5KDUsIGRvdWJsZSksIFswLCAyLCA0LCA2LCA4XSlcbiAqXG4gKiBAY2F0ZWdvcnkgY29uc3RydWN0b3JzXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBtYWtlQnkgPSBmdW5jdGlvbiAobiwgZikgeyByZXR1cm4gKG4gPD0gMCA/IGVtcHR5IDogUk5FQS5tYWtlQnkoZikobikpOyB9O1xuLyoqXG4gKiBDcmVhdGUgYSBgUmVhZG9ubHlBcnJheWAgY29udGFpbmluZyBhIHZhbHVlIHJlcGVhdGVkIHRoZSBzcGVjaWZpZWQgbnVtYmVyIG9mIHRpbWVzLlxuICpcbiAqICoqTm90ZSoqLiBgbmAgaXMgbm9ybWFsaXplZCB0byBhIG5vbiBuZWdhdGl2ZSBpbnRlZ2VyLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyByZXBsaWNhdGUgfSBmcm9tICdmcC10cy9SZWFkb25seUFycmF5J1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwocmVwbGljYXRlKDMsICdhJyksIFsnYScsICdhJywgJ2EnXSlcbiAqXG4gKiBAY2F0ZWdvcnkgY29uc3RydWN0b3JzXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciByZXBsaWNhdGUgPSBmdW5jdGlvbiAobiwgYSkgeyByZXR1cm4gbWFrZUJ5KG4sIGZ1bmN0aW9uICgpIHsgcmV0dXJuIGE7IH0pOyB9O1xuZXhwb3J0IGZ1bmN0aW9uIGZyb21QcmVkaWNhdGUocHJlZGljYXRlKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhKSB7IHJldHVybiAocHJlZGljYXRlKGEpID8gW2FdIDogZW1wdHkpOyB9O1xufVxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLy8gY29udmVyc2lvbnNcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8qKlxuICogQGNhdGVnb3J5IGNvbnZlcnNpb25zXG4gKiBAc2luY2UgMi4xMS4wXG4gKi9cbmV4cG9ydCB2YXIgZnJvbU9wdGlvbiA9IGZ1bmN0aW9uIChtYSkgeyByZXR1cm4gKF8uaXNOb25lKG1hKSA/IGVtcHR5IDogW21hLnZhbHVlXSk7IH07XG4vKipcbiAqIFRyYW5zZm9ybXMgYW4gYEVpdGhlcmAgdG8gYSBgUmVhZG9ubHlBcnJheWAuXG4gKlxuICogQGNhdGVnb3J5IGNvbnZlcnNpb25zXG4gKiBAc2luY2UgMi4xMS4wXG4gKi9cbmV4cG9ydCB2YXIgZnJvbUVpdGhlciA9IGZ1bmN0aW9uIChlKSB7IHJldHVybiAoXy5pc0xlZnQoZSkgPyBlbXB0eSA6IFtlLnJpZ2h0XSk7IH07XG4vKipcbiAqIExlc3Mgc3RyaWN0IHZlcnNpb24gb2YgW2BtYXRjaGBdKCNtYXRjaCkuXG4gKlxuICogVGhlIGBXYCBzdWZmaXggKHNob3J0IGZvciAqKlcqKmlkZW5pbmcpIG1lYW5zIHRoYXQgdGhlIGhhbmRsZXIgcmV0dXJuIHR5cGVzIHdpbGwgYmUgbWVyZ2VkLlxuICpcbiAqIEBjYXRlZ29yeSBwYXR0ZXJuIG1hdGNoaW5nXG4gKiBAc2luY2UgMi4xMS4wXG4gKi9cbmV4cG9ydCB2YXIgbWF0Y2hXID0gZnVuY3Rpb24gKG9uRW1wdHksIG9uTm9uRW1wdHkpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIHJldHVybiBpc05vbkVtcHR5KGFzKSA/IG9uTm9uRW1wdHkoYXMpIDogb25FbXB0eSgpO1xuICAgIH07XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgcGF0dGVybiBtYXRjaGluZ1xuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIG1hdGNoID0gbWF0Y2hXO1xuLyoqXG4gKiBMZXNzIHN0cmljdCB2ZXJzaW9uIG9mIFtgbWF0Y2hMZWZ0YF0oI21hdGNobGVmdCkuXG4gKlxuICogQGNhdGVnb3J5IHBhdHRlcm4gbWF0Y2hpbmdcbiAqIEBzaW5jZSAyLjExLjBcbiAqL1xuZXhwb3J0IHZhciBtYXRjaExlZnRXID0gZnVuY3Rpb24gKG9uRW1wdHksIG9uTm9uRW1wdHkpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIHJldHVybiBpc05vbkVtcHR5KGFzKSA/IG9uTm9uRW1wdHkoUk5FQS5oZWFkKGFzKSwgUk5FQS50YWlsKGFzKSkgOiBvbkVtcHR5KCk7XG4gICAgfTtcbn07XG4vKipcbiAqIEJyZWFrIGEgYFJlYWRvbmx5QXJyYXlgIGludG8gaXRzIGZpcnN0IGVsZW1lbnQgYW5kIHJlbWFpbmluZyBlbGVtZW50cy5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgbWF0Y2hMZWZ0IH0gZnJvbSAnZnAtdHMvUmVhZG9ubHlBcnJheSdcbiAqXG4gKiBjb25zdCBsZW46IDxBPihhczogUmVhZG9ubHlBcnJheTxBPikgPT4gbnVtYmVyID0gbWF0Y2hMZWZ0KCgpID0+IDAsIChfLCB0YWlsKSA9PiAxICsgbGVuKHRhaWwpKVxuICogYXNzZXJ0LnN0cmljdEVxdWFsKGxlbihbMSwgMiwgM10pLCAzKVxuICpcbiAqIEBjYXRlZ29yeSBwYXR0ZXJuIG1hdGNoaW5nXG4gKiBAc2luY2UgMi4xMC4wXG4gKi9cbmV4cG9ydCB2YXIgbWF0Y2hMZWZ0ID0gbWF0Y2hMZWZ0Vztcbi8qKlxuICogQWxpYXMgb2YgW2BtYXRjaExlZnRgXSgjbWF0Y2hsZWZ0KS5cbiAqXG4gKiBAY2F0ZWdvcnkgcGF0dGVybiBtYXRjaGluZ1xuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgZm9sZExlZnQgPSBtYXRjaExlZnQ7XG4vKipcbiAqIExlc3Mgc3RyaWN0IHZlcnNpb24gb2YgW2BtYXRjaFJpZ2h0YF0oI21hdGNocmlnaHQpLlxuICpcbiAqIEBjYXRlZ29yeSBwYXR0ZXJuIG1hdGNoaW5nXG4gKiBAc2luY2UgMi4xMS4wXG4gKi9cbmV4cG9ydCB2YXIgbWF0Y2hSaWdodFcgPSBmdW5jdGlvbiAob25FbXB0eSwgb25Ob25FbXB0eSkge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgcmV0dXJuIGlzTm9uRW1wdHkoYXMpID8gb25Ob25FbXB0eShSTkVBLmluaXQoYXMpLCBSTkVBLmxhc3QoYXMpKSA6IG9uRW1wdHkoKTtcbiAgICB9O1xufTtcbi8qKlxuICogQnJlYWsgYSBgUmVhZG9ubHlBcnJheWAgaW50byBpdHMgaW5pdGlhbCBlbGVtZW50cyBhbmQgdGhlIGxhc3QgZWxlbWVudC5cbiAqXG4gKiBAY2F0ZWdvcnkgcGF0dGVybiBtYXRjaGluZ1xuICogQHNpbmNlIDIuMTAuMFxuICovXG5leHBvcnQgdmFyIG1hdGNoUmlnaHQgPSBtYXRjaFJpZ2h0Vztcbi8qKlxuICogQWxpYXMgb2YgW2BtYXRjaFJpZ2h0YF0oI21hdGNocmlnaHQpLlxuICpcbiAqIEBjYXRlZ29yeSBwYXR0ZXJuIG1hdGNoaW5nXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBmb2xkUmlnaHQgPSBtYXRjaFJpZ2h0O1xuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLy8gY29tYmluYXRvcnNcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8qKlxuICogQGNhdGVnb3J5IHNlcXVlbmNpbmdcbiAqIEBzaW5jZSAyLjcuMFxuICovXG5leHBvcnQgdmFyIGNoYWluV2l0aEluZGV4ID0gZnVuY3Rpb24gKGYpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIGlmIChpc0VtcHR5KGFzKSkge1xuICAgICAgICAgICAgcmV0dXJuIGVtcHR5O1xuICAgICAgICB9XG4gICAgICAgIHZhciBvdXQgPSBbXTtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBhcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgb3V0LnB1c2guYXBwbHkob3V0LCBmKGksIGFzW2ldKSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG91dDtcbiAgICB9O1xufTtcbi8qKlxuICogU2FtZSBhcyBgcmVkdWNlYCBidXQgaXQgY2FycmllcyBvdmVyIHRoZSBpbnRlcm1lZGlhdGUgc3RlcHMuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IHNjYW5MZWZ0IH0gZnJvbSAnZnAtdHMvUmVhZG9ubHlBcnJheSdcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKHNjYW5MZWZ0KDEwLCAoYiwgYTogbnVtYmVyKSA9PiBiIC0gYSkoWzEsIDIsIDNdKSwgWzEwLCA5LCA3LCA0XSlcbiAqXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBzY2FuTGVmdCA9IGZ1bmN0aW9uIChiLCBmKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykge1xuICAgICAgICB2YXIgbGVuID0gYXMubGVuZ3RoO1xuICAgICAgICB2YXIgb3V0ID0gbmV3IEFycmF5KGxlbiArIDEpO1xuICAgICAgICBvdXRbMF0gPSBiO1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGxlbjsgaSsrKSB7XG4gICAgICAgICAgICBvdXRbaSArIDFdID0gZihvdXRbaV0sIGFzW2ldKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gb3V0O1xuICAgIH07XG59O1xuLyoqXG4gKiBGb2xkIGFuIGFycmF5IGZyb20gdGhlIHJpZ2h0LCBrZWVwaW5nIGFsbCBpbnRlcm1lZGlhdGUgcmVzdWx0cyBpbnN0ZWFkIG9mIG9ubHkgdGhlIGZpbmFsIHJlc3VsdFxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBzY2FuUmlnaHQgfSBmcm9tICdmcC10cy9SZWFkb25seUFycmF5J1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoc2NhblJpZ2h0KDEwLCAoYTogbnVtYmVyLCBiKSA9PiBiIC0gYSkoWzEsIDIsIDNdKSwgWzQsIDUsIDcsIDEwXSlcbiAqXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBzY2FuUmlnaHQgPSBmdW5jdGlvbiAoYiwgZikge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgdmFyIGxlbiA9IGFzLmxlbmd0aDtcbiAgICAgICAgdmFyIG91dCA9IG5ldyBBcnJheShsZW4gKyAxKTtcbiAgICAgICAgb3V0W2xlbl0gPSBiO1xuICAgICAgICBmb3IgKHZhciBpID0gbGVuIC0gMTsgaSA+PSAwOyBpLS0pIHtcbiAgICAgICAgICAgIG91dFtpXSA9IGYoYXNbaV0sIG91dFtpICsgMV0pO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBvdXQ7XG4gICAgfTtcbn07XG4vKipcbiAqIENhbGN1bGF0ZSB0aGUgbnVtYmVyIG9mIGVsZW1lbnRzIGluIGEgYFJlYWRvbmx5QXJyYXlgLlxuICpcbiAqIEBzaW5jZSAyLjEwLjBcbiAqL1xuZXhwb3J0IHZhciBzaXplID0gZnVuY3Rpb24gKGFzKSB7IHJldHVybiBhcy5sZW5ndGg7IH07XG4vKipcbiAqIFRlc3Qgd2hldGhlciBhbiBhcnJheSBjb250YWlucyBhIHBhcnRpY3VsYXIgaW5kZXhcbiAqXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBpc091dE9mQm91bmQgPSBSTkVBLmlzT3V0T2ZCb3VuZDtcbmV4cG9ydCBmdW5jdGlvbiBsb29rdXAoaSwgYXMpIHtcbiAgICByZXR1cm4gYXMgPT09IHVuZGVmaW5lZCA/IGZ1bmN0aW9uIChhcykgeyByZXR1cm4gbG9va3VwKGksIGFzKTsgfSA6IGlzT3V0T2ZCb3VuZChpLCBhcykgPyBfLm5vbmUgOiBfLnNvbWUoYXNbaV0pO1xufVxuLyoqXG4gKiBHZXQgdGhlIGZpcnN0IGVsZW1lbnQgaW4gYW4gYXJyYXksIG9yIGBOb25lYCBpZiB0aGUgYXJyYXkgaXMgZW1wdHlcbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgaGVhZCB9IGZyb20gJ2ZwLXRzL1JlYWRvbmx5QXJyYXknXG4gKiBpbXBvcnQgeyBzb21lLCBub25lIH0gZnJvbSAnZnAtdHMvT3B0aW9uJ1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoaGVhZChbMSwgMiwgM10pLCBzb21lKDEpKVxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChoZWFkKFtdKSwgbm9uZSlcbiAqXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBoZWFkID0gZnVuY3Rpb24gKGFzKSB7IHJldHVybiAoaXNOb25FbXB0eShhcykgPyBfLnNvbWUoUk5FQS5oZWFkKGFzKSkgOiBfLm5vbmUpOyB9O1xuLyoqXG4gKiBHZXQgdGhlIGxhc3QgZWxlbWVudCBpbiBhbiBhcnJheSwgb3IgYE5vbmVgIGlmIHRoZSBhcnJheSBpcyBlbXB0eVxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBsYXN0IH0gZnJvbSAnZnAtdHMvUmVhZG9ubHlBcnJheSdcbiAqIGltcG9ydCB7IHNvbWUsIG5vbmUgfSBmcm9tICdmcC10cy9PcHRpb24nXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChsYXN0KFsxLCAyLCAzXSksIHNvbWUoMykpXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKGxhc3QoW10pLCBub25lKVxuICpcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIGxhc3QgPSBmdW5jdGlvbiAoYXMpIHsgcmV0dXJuIChpc05vbkVtcHR5KGFzKSA/IF8uc29tZShSTkVBLmxhc3QoYXMpKSA6IF8ubm9uZSk7IH07XG4vKipcbiAqIEdldCBhbGwgYnV0IHRoZSBmaXJzdCBlbGVtZW50IG9mIGFuIGFycmF5LCBjcmVhdGluZyBhIG5ldyBhcnJheSwgb3IgYE5vbmVgIGlmIHRoZSBhcnJheSBpcyBlbXB0eVxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyB0YWlsIH0gZnJvbSAnZnAtdHMvUmVhZG9ubHlBcnJheSdcbiAqIGltcG9ydCB7IHNvbWUsIG5vbmUgfSBmcm9tICdmcC10cy9PcHRpb24nXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbCh0YWlsKFsxLCAyLCAzXSksIHNvbWUoWzIsIDNdKSlcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwodGFpbChbXSksIG5vbmUpXG4gKlxuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgdGFpbCA9IGZ1bmN0aW9uIChhcykge1xuICAgIHJldHVybiBpc05vbkVtcHR5KGFzKSA/IF8uc29tZShSTkVBLnRhaWwoYXMpKSA6IF8ubm9uZTtcbn07XG4vKipcbiAqIEdldCBhbGwgYnV0IHRoZSBsYXN0IGVsZW1lbnQgb2YgYW4gYXJyYXksIGNyZWF0aW5nIGEgbmV3IGFycmF5LCBvciBgTm9uZWAgaWYgdGhlIGFycmF5IGlzIGVtcHR5XG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IGluaXQgfSBmcm9tICdmcC10cy9SZWFkb25seUFycmF5J1xuICogaW1wb3J0IHsgc29tZSwgbm9uZSB9IGZyb20gJ2ZwLXRzL09wdGlvbidcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKGluaXQoWzEsIDIsIDNdKSwgc29tZShbMSwgMl0pKVxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChpbml0KFtdKSwgbm9uZSlcbiAqXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBpbml0ID0gZnVuY3Rpb24gKGFzKSB7XG4gICAgcmV0dXJuIGlzTm9uRW1wdHkoYXMpID8gXy5zb21lKFJORUEuaW5pdChhcykpIDogXy5ub25lO1xufTtcbi8qKlxuICogS2VlcCBvbmx5IGEgbWF4IG51bWJlciBvZiBlbGVtZW50cyBmcm9tIHRoZSBzdGFydCBvZiBhbiBgUmVhZG9ubHlBcnJheWAsIGNyZWF0aW5nIGEgbmV3IGBSZWFkb25seUFycmF5YC5cbiAqXG4gKiAqKk5vdGUqKi4gYG5gIGlzIG5vcm1hbGl6ZWQgdG8gYSBub24gbmVnYXRpdmUgaW50ZWdlci5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0ICogYXMgUkEgZnJvbSAnZnAtdHMvUmVhZG9ubHlBcnJheSdcbiAqIGltcG9ydCB7IHBpcGUgfSBmcm9tICdmcC10cy9mdW5jdGlvbidcbiAqXG4gKiBjb25zdCBpbnB1dDogUmVhZG9ubHlBcnJheTxudW1iZXI+ID0gWzEsIDIsIDNdXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKHBpcGUoaW5wdXQsIFJBLnRha2VMZWZ0KDIpKSwgWzEsIDJdKVxuICpcbiAqIC8vIG91dCBvZiBib3VuZHNcbiAqIGFzc2VydC5zdHJpY3RFcXVhbChwaXBlKGlucHV0LCBSQS50YWtlTGVmdCg0KSksIGlucHV0KVxuICogYXNzZXJ0LnN0cmljdEVxdWFsKHBpcGUoaW5wdXQsIFJBLnRha2VMZWZ0KC0xKSksIGlucHV0KVxuICpcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIHRha2VMZWZ0ID0gZnVuY3Rpb24gKG4pIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIHJldHVybiBpc091dE9mQm91bmQobiwgYXMpID8gYXMgOiBuID09PSAwID8gZW1wdHkgOiBhcy5zbGljZSgwLCBuKTtcbiAgICB9O1xufTtcbi8qKlxuICogS2VlcCBvbmx5IGEgbWF4IG51bWJlciBvZiBlbGVtZW50cyBmcm9tIHRoZSBlbmQgb2YgYW4gYFJlYWRvbmx5QXJyYXlgLCBjcmVhdGluZyBhIG5ldyBgUmVhZG9ubHlBcnJheWAuXG4gKlxuICogKipOb3RlKiouIGBuYCBpcyBub3JtYWxpemVkIHRvIGEgbm9uIG5lZ2F0aXZlIGludGVnZXIuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCAqIGFzIFJBIGZyb20gJ2ZwLXRzL1JlYWRvbmx5QXJyYXknXG4gKiBpbXBvcnQgeyBwaXBlIH0gZnJvbSAnZnAtdHMvZnVuY3Rpb24nXG4gKlxuICogY29uc3QgaW5wdXQ6IFJlYWRvbmx5QXJyYXk8bnVtYmVyPiA9IFsxLCAyLCAzXVxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChwaXBlKGlucHV0LCBSQS50YWtlUmlnaHQoMikpLCBbMiwgM10pXG4gKlxuICogLy8gb3V0IG9mIGJvdW5kc1xuICogYXNzZXJ0LnN0cmljdEVxdWFsKHBpcGUoaW5wdXQsIFJBLnRha2VSaWdodCg0KSksIGlucHV0KVxuICogYXNzZXJ0LnN0cmljdEVxdWFsKHBpcGUoaW5wdXQsIFJBLnRha2VSaWdodCgtMSkpLCBpbnB1dClcbiAqXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciB0YWtlUmlnaHQgPSBmdW5jdGlvbiAobikge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgcmV0dXJuIGlzT3V0T2ZCb3VuZChuLCBhcykgPyBhcyA6IG4gPT09IDAgPyBlbXB0eSA6IGFzLnNsaWNlKC1uKTtcbiAgICB9O1xufTtcbmV4cG9ydCBmdW5jdGlvbiB0YWtlTGVmdFdoaWxlKHByZWRpY2F0ZSkge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgdmFyIG91dCA9IFtdO1xuICAgICAgICBmb3IgKHZhciBfaSA9IDAsIGFzXzEgPSBhczsgX2kgPCBhc18xLmxlbmd0aDsgX2krKykge1xuICAgICAgICAgICAgdmFyIGEgPSBhc18xW19pXTtcbiAgICAgICAgICAgIGlmICghcHJlZGljYXRlKGEpKSB7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBvdXQucHVzaChhKTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgbGVuID0gb3V0Lmxlbmd0aDtcbiAgICAgICAgcmV0dXJuIGxlbiA9PT0gYXMubGVuZ3RoID8gYXMgOiBsZW4gPT09IDAgPyBlbXB0eSA6IG91dDtcbiAgICB9O1xufVxudmFyIHNwYW5MZWZ0SW5kZXggPSBmdW5jdGlvbiAoYXMsIHByZWRpY2F0ZSkge1xuICAgIHZhciBsID0gYXMubGVuZ3RoO1xuICAgIHZhciBpID0gMDtcbiAgICBmb3IgKDsgaSA8IGw7IGkrKykge1xuICAgICAgICBpZiAoIXByZWRpY2F0ZShhc1tpXSkpIHtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiBpO1xufTtcbmV4cG9ydCBmdW5jdGlvbiBzcGFuTGVmdChwcmVkaWNhdGUpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIHZhciBfYSA9IHNwbGl0QXQoc3BhbkxlZnRJbmRleChhcywgcHJlZGljYXRlKSkoYXMpLCBpbml0ID0gX2FbMF0sIHJlc3QgPSBfYVsxXTtcbiAgICAgICAgcmV0dXJuIHsgaW5pdDogaW5pdCwgcmVzdDogcmVzdCB9O1xuICAgIH07XG59XG4vKipcbiAqIERyb3AgYSBtYXggbnVtYmVyIG9mIGVsZW1lbnRzIGZyb20gdGhlIHN0YXJ0IG9mIGFuIGBSZWFkb25seUFycmF5YCwgY3JlYXRpbmcgYSBuZXcgYFJlYWRvbmx5QXJyYXlgLlxuICpcbiAqICoqTm90ZSoqLiBgbmAgaXMgbm9ybWFsaXplZCB0byBhIG5vbiBuZWdhdGl2ZSBpbnRlZ2VyLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgKiBhcyBSQSBmcm9tICdmcC10cy9SZWFkb25seUFycmF5J1xuICogaW1wb3J0IHsgcGlwZSB9IGZyb20gJ2ZwLXRzL2Z1bmN0aW9uJ1xuICpcbiAqIGNvbnN0IGlucHV0OiBSZWFkb25seUFycmF5PG51bWJlcj4gPSBbMSwgMiwgM11cbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwocGlwZShpbnB1dCwgUkEuZHJvcExlZnQoMikpLCBbM10pXG4gKiBhc3NlcnQuc3RyaWN0RXF1YWwocGlwZShpbnB1dCwgUkEuZHJvcExlZnQoMCkpLCBpbnB1dClcbiAqIGFzc2VydC5zdHJpY3RFcXVhbChwaXBlKGlucHV0LCBSQS5kcm9wTGVmdCgtMSkpLCBpbnB1dClcbiAqXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBkcm9wTGVmdCA9IGZ1bmN0aW9uIChuKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykge1xuICAgICAgICByZXR1cm4gbiA8PSAwIHx8IGlzRW1wdHkoYXMpID8gYXMgOiBuID49IGFzLmxlbmd0aCA/IGVtcHR5IDogYXMuc2xpY2UobiwgYXMubGVuZ3RoKTtcbiAgICB9O1xufTtcbi8qKlxuICogRHJvcCBhIG1heCBudW1iZXIgb2YgZWxlbWVudHMgZnJvbSB0aGUgZW5kIG9mIGFuIGBSZWFkb25seUFycmF5YCwgY3JlYXRpbmcgYSBuZXcgYFJlYWRvbmx5QXJyYXlgLlxuICpcbiAqICoqTm90ZSoqLiBgbmAgaXMgbm9ybWFsaXplZCB0byBhIG5vbiBuZWdhdGl2ZSBpbnRlZ2VyLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgKiBhcyBSQSBmcm9tICdmcC10cy9SZWFkb25seUFycmF5J1xuICogaW1wb3J0IHsgcGlwZSB9IGZyb20gJ2ZwLXRzL2Z1bmN0aW9uJ1xuICpcbiAqIGNvbnN0IGlucHV0OiBSZWFkb25seUFycmF5PG51bWJlcj4gPSBbMSwgMiwgM11cbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwocGlwZShpbnB1dCwgUkEuZHJvcFJpZ2h0KDIpKSwgWzFdKVxuICogYXNzZXJ0LnN0cmljdEVxdWFsKHBpcGUoaW5wdXQsIFJBLmRyb3BSaWdodCgwKSksIGlucHV0KVxuICogYXNzZXJ0LnN0cmljdEVxdWFsKHBpcGUoaW5wdXQsIFJBLmRyb3BSaWdodCgtMSkpLCBpbnB1dClcbiAqXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBkcm9wUmlnaHQgPSBmdW5jdGlvbiAobikge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgcmV0dXJuIG4gPD0gMCB8fCBpc0VtcHR5KGFzKSA/IGFzIDogbiA+PSBhcy5sZW5ndGggPyBlbXB0eSA6IGFzLnNsaWNlKDAsIGFzLmxlbmd0aCAtIG4pO1xuICAgIH07XG59O1xuZXhwb3J0IGZ1bmN0aW9uIGRyb3BMZWZ0V2hpbGUocHJlZGljYXRlKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykge1xuICAgICAgICB2YXIgaSA9IHNwYW5MZWZ0SW5kZXgoYXMsIHByZWRpY2F0ZSk7XG4gICAgICAgIHJldHVybiBpID09PSAwID8gYXMgOiBpID09PSBhcy5sZW5ndGggPyBlbXB0eSA6IGFzLnNsaWNlKGkpO1xuICAgIH07XG59XG4vKipcbiAqIEZpbmQgdGhlIGZpcnN0IGluZGV4IGZvciB3aGljaCBhIHByZWRpY2F0ZSBob2xkc1xuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBmaW5kSW5kZXggfSBmcm9tICdmcC10cy9SZWFkb25seUFycmF5J1xuICogaW1wb3J0IHsgc29tZSwgbm9uZSB9IGZyb20gJ2ZwLXRzL09wdGlvbidcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKGZpbmRJbmRleCgobjogbnVtYmVyKSA9PiBuID09PSAyKShbMSwgMiwgM10pLCBzb21lKDEpKVxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChmaW5kSW5kZXgoKG46IG51bWJlcikgPT4gbiA9PT0gMikoW10pLCBub25lKVxuICpcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIGZpbmRJbmRleCA9IGZ1bmN0aW9uIChwcmVkaWNhdGUpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgYXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIGlmIChwcmVkaWNhdGUoYXNbaV0pKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIF8uc29tZShpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gXy5ub25lO1xuICAgIH07XG59O1xuZXhwb3J0IGZ1bmN0aW9uIGZpbmRGaXJzdChwcmVkaWNhdGUpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgYXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIGlmIChwcmVkaWNhdGUoYXNbaV0pKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIF8uc29tZShhc1tpXSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIF8ubm9uZTtcbiAgICB9O1xufVxuLyoqXG4gKiBGaW5kIHRoZSBmaXJzdCBlbGVtZW50IHJldHVybmVkIGJ5IGFuIG9wdGlvbiBiYXNlZCBzZWxlY3RvciBmdW5jdGlvblxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBmaW5kRmlyc3RNYXAgfSBmcm9tICdmcC10cy9SZWFkb25seUFycmF5J1xuICogaW1wb3J0IHsgc29tZSwgbm9uZSB9IGZyb20gJ2ZwLXRzL09wdGlvbidcbiAqXG4gKiBpbnRlcmZhY2UgUGVyc29uIHtcbiAqICAgcmVhZG9ubHkgbmFtZTogc3RyaW5nXG4gKiAgIHJlYWRvbmx5IGFnZT86IG51bWJlclxuICogfVxuICpcbiAqIGNvbnN0IHBlcnNvbnM6IFJlYWRvbmx5QXJyYXk8UGVyc29uPiA9IFt7IG5hbWU6ICdKb2huJyB9LCB7IG5hbWU6ICdNYXJ5JywgYWdlOiA0NSB9LCB7IG5hbWU6ICdKb2V5JywgYWdlOiAyOCB9XVxuICpcbiAqIC8vIHJldHVybnMgdGhlIG5hbWUgb2YgdGhlIGZpcnN0IHBlcnNvbiB0aGF0IGhhcyBhbiBhZ2VcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoZmluZEZpcnN0TWFwKChwOiBQZXJzb24pID0+IChwLmFnZSA9PT0gdW5kZWZpbmVkID8gbm9uZSA6IHNvbWUocC5uYW1lKSkpKHBlcnNvbnMpLCBzb21lKCdNYXJ5JykpXG4gKlxuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgZmluZEZpcnN0TWFwID0gZnVuY3Rpb24gKGYpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgYXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIHZhciBvdXQgPSBmKGFzW2ldKTtcbiAgICAgICAgICAgIGlmIChfLmlzU29tZShvdXQpKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG91dDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gXy5ub25lO1xuICAgIH07XG59O1xuZXhwb3J0IGZ1bmN0aW9uIGZpbmRMYXN0KHByZWRpY2F0ZSkge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgZm9yICh2YXIgaSA9IGFzLmxlbmd0aCAtIDE7IGkgPj0gMDsgaS0tKSB7XG4gICAgICAgICAgICBpZiAocHJlZGljYXRlKGFzW2ldKSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBfLnNvbWUoYXNbaV0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBfLm5vbmU7XG4gICAgfTtcbn1cbi8qKlxuICogRmluZCB0aGUgbGFzdCBlbGVtZW50IHJldHVybmVkIGJ5IGFuIG9wdGlvbiBiYXNlZCBzZWxlY3RvciBmdW5jdGlvblxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBmaW5kTGFzdE1hcCB9IGZyb20gJ2ZwLXRzL1JlYWRvbmx5QXJyYXknXG4gKiBpbXBvcnQgeyBzb21lLCBub25lIH0gZnJvbSAnZnAtdHMvT3B0aW9uJ1xuICpcbiAqIGludGVyZmFjZSBQZXJzb24ge1xuICogICByZWFkb25seSBuYW1lOiBzdHJpbmdcbiAqICAgcmVhZG9ubHkgYWdlPzogbnVtYmVyXG4gKiB9XG4gKlxuICogY29uc3QgcGVyc29uczogUmVhZG9ubHlBcnJheTxQZXJzb24+ID0gW3sgbmFtZTogJ0pvaG4nIH0sIHsgbmFtZTogJ01hcnknLCBhZ2U6IDQ1IH0sIHsgbmFtZTogJ0pvZXknLCBhZ2U6IDI4IH1dXG4gKlxuICogLy8gcmV0dXJucyB0aGUgbmFtZSBvZiB0aGUgbGFzdCBwZXJzb24gdGhhdCBoYXMgYW4gYWdlXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKGZpbmRMYXN0TWFwKChwOiBQZXJzb24pID0+IChwLmFnZSA9PT0gdW5kZWZpbmVkID8gbm9uZSA6IHNvbWUocC5uYW1lKSkpKHBlcnNvbnMpLCBzb21lKCdKb2V5JykpXG4gKlxuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgZmluZExhc3RNYXAgPSBmdW5jdGlvbiAoZikge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgZm9yICh2YXIgaSA9IGFzLmxlbmd0aCAtIDE7IGkgPj0gMDsgaS0tKSB7XG4gICAgICAgICAgICB2YXIgb3V0ID0gZihhc1tpXSk7XG4gICAgICAgICAgICBpZiAoXy5pc1NvbWUob3V0KSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBvdXQ7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIF8ubm9uZTtcbiAgICB9O1xufTtcbi8qKlxuICogUmV0dXJucyB0aGUgaW5kZXggb2YgdGhlIGxhc3QgZWxlbWVudCBvZiB0aGUgbGlzdCB3aGljaCBtYXRjaGVzIHRoZSBwcmVkaWNhdGVcbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgZmluZExhc3RJbmRleCB9IGZyb20gJ2ZwLXRzL1JlYWRvbmx5QXJyYXknXG4gKiBpbXBvcnQgeyBzb21lLCBub25lIH0gZnJvbSAnZnAtdHMvT3B0aW9uJ1xuICpcbiAqIGludGVyZmFjZSBYIHtcbiAqICAgcmVhZG9ubHkgYTogbnVtYmVyXG4gKiAgIHJlYWRvbmx5IGI6IG51bWJlclxuICogfVxuICogY29uc3QgeHM6IFJlYWRvbmx5QXJyYXk8WD4gPSBbeyBhOiAxLCBiOiAwIH0sIHsgYTogMSwgYjogMSB9XVxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChmaW5kTGFzdEluZGV4KCh4OiB7IHJlYWRvbmx5IGE6IG51bWJlciB9KSA9PiB4LmEgPT09IDEpKHhzKSwgc29tZSgxKSlcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoZmluZExhc3RJbmRleCgoeDogeyByZWFkb25seSBhOiBudW1iZXIgfSkgPT4geC5hID09PSA0KSh4cyksIG5vbmUpXG4gKlxuICpcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIGZpbmRMYXN0SW5kZXggPSBmdW5jdGlvbiAocHJlZGljYXRlKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykge1xuICAgICAgICBmb3IgKHZhciBpID0gYXMubGVuZ3RoIC0gMTsgaSA+PSAwOyBpLS0pIHtcbiAgICAgICAgICAgIGlmIChwcmVkaWNhdGUoYXNbaV0pKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIF8uc29tZShpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gXy5ub25lO1xuICAgIH07XG59O1xuLyoqXG4gKiBJbnNlcnQgYW4gZWxlbWVudCBhdCB0aGUgc3BlY2lmaWVkIGluZGV4LCBjcmVhdGluZyBhIG5ldyBhcnJheSwgb3IgcmV0dXJuaW5nIGBOb25lYCBpZiB0aGUgaW5kZXggaXMgb3V0IG9mIGJvdW5kc1xuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBpbnNlcnRBdCB9IGZyb20gJ2ZwLXRzL1JlYWRvbmx5QXJyYXknXG4gKiBpbXBvcnQgeyBzb21lIH0gZnJvbSAnZnAtdHMvT3B0aW9uJ1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoaW5zZXJ0QXQoMiwgNSkoWzEsIDIsIDMsIDRdKSwgc29tZShbMSwgMiwgNSwgMywgNF0pKVxuICpcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIGluc2VydEF0ID0gZnVuY3Rpb24gKGksIGEpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIHJldHVybiBpIDwgMCB8fCBpID4gYXMubGVuZ3RoID8gXy5ub25lIDogXy5zb21lKFJORUEudW5zYWZlSW5zZXJ0QXQoaSwgYSwgYXMpKTtcbiAgICB9O1xufTtcbi8qKlxuICogQ2hhbmdlIHRoZSBlbGVtZW50IGF0IHRoZSBzcGVjaWZpZWQgaW5kZXgsIGNyZWF0aW5nIGEgbmV3IGFycmF5LCBvciByZXR1cm5pbmcgYE5vbmVgIGlmIHRoZSBpbmRleCBpcyBvdXQgb2YgYm91bmRzXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IHVwZGF0ZUF0IH0gZnJvbSAnZnAtdHMvUmVhZG9ubHlBcnJheSdcbiAqIGltcG9ydCB7IHNvbWUsIG5vbmUgfSBmcm9tICdmcC10cy9PcHRpb24nXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbCh1cGRhdGVBdCgxLCAxKShbMSwgMiwgM10pLCBzb21lKFsxLCAxLCAzXSkpXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKHVwZGF0ZUF0KDEsIDEpKFtdKSwgbm9uZSlcbiAqXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciB1cGRhdGVBdCA9IGZ1bmN0aW9uIChpLCBhKSB7XG4gICAgcmV0dXJuIG1vZGlmeUF0KGksIGZ1bmN0aW9uICgpIHsgcmV0dXJuIGE7IH0pO1xufTtcbi8qKlxuICogRGVsZXRlIHRoZSBlbGVtZW50IGF0IHRoZSBzcGVjaWZpZWQgaW5kZXgsIGNyZWF0aW5nIGEgbmV3IGFycmF5LCBvciByZXR1cm5pbmcgYE5vbmVgIGlmIHRoZSBpbmRleCBpcyBvdXQgb2YgYm91bmRzXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IGRlbGV0ZUF0IH0gZnJvbSAnZnAtdHMvUmVhZG9ubHlBcnJheSdcbiAqIGltcG9ydCB7IHNvbWUsIG5vbmUgfSBmcm9tICdmcC10cy9PcHRpb24nXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChkZWxldGVBdCgwKShbMSwgMiwgM10pLCBzb21lKFsyLCAzXSkpXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKGRlbGV0ZUF0KDEpKFtdKSwgbm9uZSlcbiAqXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBkZWxldGVBdCA9IGZ1bmN0aW9uIChpKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykge1xuICAgICAgICByZXR1cm4gaXNPdXRPZkJvdW5kKGksIGFzKSA/IF8ubm9uZSA6IF8uc29tZSh1bnNhZmVEZWxldGVBdChpLCBhcykpO1xuICAgIH07XG59O1xuLyoqXG4gKiBBcHBseSBhIGZ1bmN0aW9uIHRvIHRoZSBlbGVtZW50IGF0IHRoZSBzcGVjaWZpZWQgaW5kZXgsIGNyZWF0aW5nIGEgbmV3IGFycmF5LCBvciByZXR1cm5pbmcgYE5vbmVgIGlmIHRoZSBpbmRleCBpcyBvdXRcbiAqIG9mIGJvdW5kc1xuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBtb2RpZnlBdCB9IGZyb20gJ2ZwLXRzL1JlYWRvbmx5QXJyYXknXG4gKiBpbXBvcnQgeyBzb21lLCBub25lIH0gZnJvbSAnZnAtdHMvT3B0aW9uJ1xuICpcbiAqIGNvbnN0IGRvdWJsZSA9ICh4OiBudW1iZXIpOiBudW1iZXIgPT4geCAqIDJcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwobW9kaWZ5QXQoMSwgZG91YmxlKShbMSwgMiwgM10pLCBzb21lKFsxLCA0LCAzXSkpXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKG1vZGlmeUF0KDEsIGRvdWJsZSkoW10pLCBub25lKVxuICpcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIG1vZGlmeUF0ID0gZnVuY3Rpb24gKGksIGYpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIHJldHVybiBpc091dE9mQm91bmQoaSwgYXMpID8gXy5ub25lIDogXy5zb21lKHVuc2FmZVVwZGF0ZUF0KGksIGYoYXNbaV0pLCBhcykpO1xuICAgIH07XG59O1xuLyoqXG4gKiBSZXZlcnNlIGFuIGFycmF5LCBjcmVhdGluZyBhIG5ldyBhcnJheVxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyByZXZlcnNlIH0gZnJvbSAnZnAtdHMvUmVhZG9ubHlBcnJheSdcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKHJldmVyc2UoWzEsIDIsIDNdKSwgWzMsIDIsIDFdKVxuICpcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIHJldmVyc2UgPSBmdW5jdGlvbiAoYXMpIHsgcmV0dXJuIChhcy5sZW5ndGggPD0gMSA/IGFzIDogYXMuc2xpY2UoKS5yZXZlcnNlKCkpOyB9O1xuLyoqXG4gKiBFeHRyYWN0cyBmcm9tIGFuIGFycmF5IG9mIGBFaXRoZXJgIGFsbCB0aGUgYFJpZ2h0YCBlbGVtZW50cy4gQWxsIHRoZSBgUmlnaHRgIGVsZW1lbnRzIGFyZSBleHRyYWN0ZWQgaW4gb3JkZXJcbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgcmlnaHRzIH0gZnJvbSAnZnAtdHMvUmVhZG9ubHlBcnJheSdcbiAqIGltcG9ydCB7IHJpZ2h0LCBsZWZ0IH0gZnJvbSAnZnAtdHMvRWl0aGVyJ1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwocmlnaHRzKFtyaWdodCgxKSwgbGVmdCgnZm9vJyksIHJpZ2h0KDIpXSksIFsxLCAyXSlcbiAqXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciByaWdodHMgPSBmdW5jdGlvbiAoYXMpIHtcbiAgICB2YXIgciA9IFtdO1xuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgYXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgdmFyIGEgPSBhc1tpXTtcbiAgICAgICAgaWYgKGEuX3RhZyA9PT0gJ1JpZ2h0Jykge1xuICAgICAgICAgICAgci5wdXNoKGEucmlnaHQpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiByO1xufTtcbi8qKlxuICogRXh0cmFjdHMgZnJvbSBhbiBhcnJheSBvZiBgRWl0aGVyYCBhbGwgdGhlIGBMZWZ0YCBlbGVtZW50cy4gQWxsIHRoZSBgTGVmdGAgZWxlbWVudHMgYXJlIGV4dHJhY3RlZCBpbiBvcmRlclxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBsZWZ0cyB9IGZyb20gJ2ZwLXRzL1JlYWRvbmx5QXJyYXknXG4gKiBpbXBvcnQgeyBsZWZ0LCByaWdodCB9IGZyb20gJ2ZwLXRzL0VpdGhlcidcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKGxlZnRzKFtyaWdodCgxKSwgbGVmdCgnZm9vJyksIHJpZ2h0KDIpXSksIFsnZm9vJ10pXG4gKlxuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgbGVmdHMgPSBmdW5jdGlvbiAoYXMpIHtcbiAgICB2YXIgciA9IFtdO1xuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgYXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgdmFyIGEgPSBhc1tpXTtcbiAgICAgICAgaWYgKGEuX3RhZyA9PT0gJ0xlZnQnKSB7XG4gICAgICAgICAgICByLnB1c2goYS5sZWZ0KTtcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gcjtcbn07XG4vKipcbiAqIFNvcnQgdGhlIGVsZW1lbnRzIG9mIGFuIGFycmF5IGluIGluY3JlYXNpbmcgb3JkZXIsIGNyZWF0aW5nIGEgbmV3IGFycmF5XG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IHNvcnQgfSBmcm9tICdmcC10cy9SZWFkb25seUFycmF5J1xuICogaW1wb3J0ICogYXMgTiBmcm9tICdmcC10cy9udW1iZXInXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChzb3J0KE4uT3JkKShbMywgMiwgMV0pLCBbMSwgMiwgM10pXG4gKlxuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgc29ydCA9IGZ1bmN0aW9uIChPKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykge1xuICAgICAgICByZXR1cm4gYXMubGVuZ3RoIDw9IDEgPyBhcyA6IGFzLnNsaWNlKCkuc29ydChPLmNvbXBhcmUpO1xuICAgIH07XG59O1xuLy8gVE9ETzogY3VycnkgYW5kIG1ha2UgZGF0YS1sYXN0IGluIHYzXG4vKipcbiAqIEFwcGx5IGEgZnVuY3Rpb24gdG8gcGFpcnMgb2YgZWxlbWVudHMgYXQgdGhlIHNhbWUgaW5kZXggaW4gdHdvIGFycmF5cywgY29sbGVjdGluZyB0aGUgcmVzdWx0cyBpbiBhIG5ldyBhcnJheS4gSWYgb25lXG4gKiBpbnB1dCBhcnJheSBpcyBzaG9ydCwgZXhjZXNzIGVsZW1lbnRzIG9mIHRoZSBsb25nZXIgYXJyYXkgYXJlIGRpc2NhcmRlZC5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgemlwV2l0aCB9IGZyb20gJ2ZwLXRzL1JlYWRvbmx5QXJyYXknXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbCh6aXBXaXRoKFsxLCAyLCAzXSwgWydhJywgJ2InLCAnYycsICdkJ10sIChuLCBzKSA9PiBzICsgbiksIFsnYTEnLCAnYjInLCAnYzMnXSlcbiAqXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciB6aXBXaXRoID0gZnVuY3Rpb24gKGZhLCBmYiwgZikge1xuICAgIHZhciBmYyA9IFtdO1xuICAgIHZhciBsZW4gPSBNYXRoLm1pbihmYS5sZW5ndGgsIGZiLmxlbmd0aCk7XG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBsZW47IGkrKykge1xuICAgICAgICBmY1tpXSA9IGYoZmFbaV0sIGZiW2ldKTtcbiAgICB9XG4gICAgcmV0dXJuIGZjO1xufTtcbmV4cG9ydCBmdW5jdGlvbiB6aXAoYXMsIGJzKSB7XG4gICAgaWYgKGJzID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIChicykgeyByZXR1cm4gemlwKGJzLCBhcyk7IH07XG4gICAgfVxuICAgIHJldHVybiB6aXBXaXRoKGFzLCBicywgZnVuY3Rpb24gKGEsIGIpIHsgcmV0dXJuIFthLCBiXTsgfSk7XG59XG4vKipcbiAqIFRoZSBmdW5jdGlvbiBpcyByZXZlcnNlIG9mIGB6aXBgLiBUYWtlcyBhbiBhcnJheSBvZiBwYWlycyBhbmQgcmV0dXJuIHR3byBjb3JyZXNwb25kaW5nIGFycmF5c1xuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyB1bnppcCB9IGZyb20gJ2ZwLXRzL1JlYWRvbmx5QXJyYXknXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbCh1bnppcChbWzEsICdhJ10sIFsyLCAnYiddLCBbMywgJ2MnXV0pLCBbWzEsIDIsIDNdLCBbJ2EnLCAnYicsICdjJ11dKVxuICpcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIHVuemlwID0gZnVuY3Rpb24gKGFzKSB7XG4gICAgdmFyIGZhID0gW107XG4gICAgdmFyIGZiID0gW107XG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBhcy5sZW5ndGg7IGkrKykge1xuICAgICAgICBmYVtpXSA9IGFzW2ldWzBdO1xuICAgICAgICBmYltpXSA9IGFzW2ldWzFdO1xuICAgIH1cbiAgICByZXR1cm4gW2ZhLCBmYl07XG59O1xuLyoqXG4gKiBQcmVwZW5kIGFuIGVsZW1lbnQgdG8gZXZlcnkgbWVtYmVyIG9mIGFuIGFycmF5XG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IHByZXBlbmRBbGwgfSBmcm9tICdmcC10cy9SZWFkb25seUFycmF5J1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwocHJlcGVuZEFsbCg5KShbMSwgMiwgMywgNF0pLCBbOSwgMSwgOSwgMiwgOSwgMywgOSwgNF0pXG4gKlxuICogQHNpbmNlIDIuMTAuMFxuICovXG5leHBvcnQgdmFyIHByZXBlbmRBbGwgPSBmdW5jdGlvbiAobWlkZGxlKSB7XG4gICAgdmFyIGYgPSBSTkVBLnByZXBlbmRBbGwobWlkZGxlKTtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7IHJldHVybiAoaXNOb25FbXB0eShhcykgPyBmKGFzKSA6IGFzKTsgfTtcbn07XG4vKipcbiAqIFBsYWNlcyBhbiBlbGVtZW50IGluIGJldHdlZW4gbWVtYmVycyBvZiBhbiBhcnJheVxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBpbnRlcnNwZXJzZSB9IGZyb20gJ2ZwLXRzL1JlYWRvbmx5QXJyYXknXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChpbnRlcnNwZXJzZSg5KShbMSwgMiwgMywgNF0pLCBbMSwgOSwgMiwgOSwgMywgOSwgNF0pXG4gKlxuICogQHNpbmNlIDIuOS4wXG4gKi9cbmV4cG9ydCB2YXIgaW50ZXJzcGVyc2UgPSBmdW5jdGlvbiAobWlkZGxlKSB7XG4gICAgdmFyIGYgPSBSTkVBLmludGVyc3BlcnNlKG1pZGRsZSk7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykgeyByZXR1cm4gKGlzTm9uRW1wdHkoYXMpID8gZihhcykgOiBhcyk7IH07XG59O1xuLyoqXG4gKiBSb3RhdGUgYSBgUmVhZG9ubHlBcnJheWAgYnkgYG5gIHN0ZXBzLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyByb3RhdGUgfSBmcm9tICdmcC10cy9SZWFkb25seUFycmF5J1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwocm90YXRlKDIpKFsxLCAyLCAzLCA0LCA1XSksIFs0LCA1LCAxLCAyLCAzXSlcbiAqXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciByb3RhdGUgPSBmdW5jdGlvbiAobikge1xuICAgIHZhciBmID0gUk5FQS5yb3RhdGUobik7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykgeyByZXR1cm4gKGlzTm9uRW1wdHkoYXMpID8gZihhcykgOiBhcyk7IH07XG59O1xuZXhwb3J0IGZ1bmN0aW9uIGVsZW0oRSkge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYSwgYXMpIHtcbiAgICAgICAgaWYgKGFzID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIHZhciBlbGVtRV8xID0gZWxlbShFKTtcbiAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHsgcmV0dXJuIGVsZW1FXzEoYSwgYXMpOyB9O1xuICAgICAgICB9XG4gICAgICAgIHZhciBwcmVkaWNhdGUgPSBmdW5jdGlvbiAoZWxlbWVudCkgeyByZXR1cm4gRS5lcXVhbHMoZWxlbWVudCwgYSk7IH07XG4gICAgICAgIHZhciBpID0gMDtcbiAgICAgICAgZm9yICg7IGkgPCBhcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgaWYgKHByZWRpY2F0ZShhc1tpXSkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfTtcbn1cbi8qKlxuICogUmVtb3ZlIGR1cGxpY2F0ZXMgZnJvbSBhbiBhcnJheSwga2VlcGluZyB0aGUgZmlyc3Qgb2NjdXJyZW5jZSBvZiBhbiBlbGVtZW50LlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyB1bmlxIH0gZnJvbSAnZnAtdHMvUmVhZG9ubHlBcnJheSdcbiAqIGltcG9ydCAqIGFzIE4gZnJvbSAnZnAtdHMvbnVtYmVyJ1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwodW5pcShOLkVxKShbMSwgMiwgMV0pLCBbMSwgMl0pXG4gKlxuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgdW5pcSA9IGZ1bmN0aW9uIChFKSB7XG4gICAgdmFyIGYgPSBSTkVBLnVuaXEoRSk7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykgeyByZXR1cm4gKGlzTm9uRW1wdHkoYXMpID8gZihhcykgOiBhcyk7IH07XG59O1xuLyoqXG4gKiBTb3J0IHRoZSBlbGVtZW50cyBvZiBhbiBhcnJheSBpbiBpbmNyZWFzaW5nIG9yZGVyLCB3aGVyZSBlbGVtZW50cyBhcmUgY29tcGFyZWQgdXNpbmcgZmlyc3QgYG9yZHNbMF1gLCB0aGVuIGBvcmRzWzFdYCxcbiAqIGV0Yy4uLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBzb3J0QnkgfSBmcm9tICdmcC10cy9SZWFkb25seUFycmF5J1xuICogaW1wb3J0IHsgY29udHJhbWFwIH0gZnJvbSAnZnAtdHMvT3JkJ1xuICogaW1wb3J0ICogYXMgUyBmcm9tICdmcC10cy9zdHJpbmcnXG4gKiBpbXBvcnQgKiBhcyBOIGZyb20gJ2ZwLXRzL251bWJlcidcbiAqIGltcG9ydCB7IHBpcGUgfSBmcm9tICdmcC10cy9mdW5jdGlvbidcbiAqXG4gKiBpbnRlcmZhY2UgUGVyc29uIHtcbiAqICAgcmVhZG9ubHkgbmFtZTogc3RyaW5nXG4gKiAgIHJlYWRvbmx5IGFnZTogbnVtYmVyXG4gKiB9XG4gKiBjb25zdCBieU5hbWUgPSBwaXBlKFMuT3JkLCBjb250cmFtYXAoKHA6IFBlcnNvbikgPT4gcC5uYW1lKSlcbiAqIGNvbnN0IGJ5QWdlID0gcGlwZShOLk9yZCwgY29udHJhbWFwKChwOiBQZXJzb24pID0+IHAuYWdlKSlcbiAqXG4gKiBjb25zdCBzb3J0QnlOYW1lQnlBZ2UgPSBzb3J0QnkoW2J5TmFtZSwgYnlBZ2VdKVxuICpcbiAqIGNvbnN0IHBlcnNvbnMgPSBbeyBuYW1lOiAnYScsIGFnZTogMSB9LCB7IG5hbWU6ICdiJywgYWdlOiAzIH0sIHsgbmFtZTogJ2MnLCBhZ2U6IDIgfSwgeyBuYW1lOiAnYicsIGFnZTogMiB9XVxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChzb3J0QnlOYW1lQnlBZ2UocGVyc29ucyksIFtcbiAqICAgeyBuYW1lOiAnYScsIGFnZTogMSB9LFxuICogICB7IG5hbWU6ICdiJywgYWdlOiAyIH0sXG4gKiAgIHsgbmFtZTogJ2InLCBhZ2U6IDMgfSxcbiAqICAgeyBuYW1lOiAnYycsIGFnZTogMiB9XG4gKiBdKVxuICpcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIHNvcnRCeSA9IGZ1bmN0aW9uIChvcmRzKSB7XG4gICAgdmFyIGYgPSBSTkVBLnNvcnRCeShvcmRzKTtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7IHJldHVybiAoaXNOb25FbXB0eShhcykgPyBmKGFzKSA6IGFzKTsgfTtcbn07XG4vKipcbiAqIEEgdXNlZnVsIHJlY3Vyc2lvbiBwYXR0ZXJuIGZvciBwcm9jZXNzaW5nIGEgYFJlYWRvbmx5QXJyYXlgIHRvIHByb2R1Y2UgYSBuZXcgYFJlYWRvbmx5QXJyYXlgLCBvZnRlbiB1c2VkIGZvciBcImNob3BwaW5nXCIgdXAgdGhlIGlucHV0XG4gKiBgUmVhZG9ubHlBcnJheWAuIFR5cGljYWxseSBgY2hvcGAgaXMgY2FsbGVkIHdpdGggc29tZSBmdW5jdGlvbiB0aGF0IHdpbGwgY29uc3VtZSBhbiBpbml0aWFsIHByZWZpeCBvZiB0aGUgYFJlYWRvbmx5QXJyYXlgIGFuZCBwcm9kdWNlIGFcbiAqIHZhbHVlIGFuZCB0aGUgdGFpbCBvZiB0aGUgYFJlYWRvbmx5QXJyYXlgLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBFcSB9IGZyb20gJ2ZwLXRzL0VxJ1xuICogaW1wb3J0ICogYXMgUkEgZnJvbSAnZnAtdHMvUmVhZG9ubHlBcnJheSdcbiAqIGltcG9ydCAqIGFzIE4gZnJvbSAnZnAtdHMvbnVtYmVyJ1xuICogaW1wb3J0IHsgcGlwZSB9IGZyb20gJ2ZwLXRzL2Z1bmN0aW9uJ1xuICpcbiAqIGNvbnN0IGdyb3VwID0gPEE+KFM6IEVxPEE+KTogKChhczogUmVhZG9ubHlBcnJheTxBPikgPT4gUmVhZG9ubHlBcnJheTxSZWFkb25seUFycmF5PEE+PikgPT4ge1xuICogICByZXR1cm4gUkEuY2hvcChhcyA9PiB7XG4gKiAgICAgY29uc3QgeyBpbml0LCByZXN0IH0gPSBwaXBlKGFzLCBSQS5zcGFuTGVmdCgoYTogQSkgPT4gUy5lcXVhbHMoYSwgYXNbMF0pKSlcbiAqICAgICByZXR1cm4gW2luaXQsIHJlc3RdXG4gKiAgIH0pXG4gKiB9XG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKGdyb3VwKE4uRXEpKFsxLCAxLCAyLCAzLCAzLCA0XSksIFtbMSwgMV0sIFsyXSwgWzMsIDNdLCBbNF1dKVxuICpcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIGNob3AgPSBmdW5jdGlvbiAoZikge1xuICAgIHZhciBnID0gUk5FQS5jaG9wKGYpO1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHsgcmV0dXJuIChpc05vbkVtcHR5KGFzKSA/IGcoYXMpIDogZW1wdHkpOyB9O1xufTtcbi8qKlxuICogU3BsaXRzIGEgYFJlYWRvbmx5QXJyYXlgIGludG8gdHdvIHBpZWNlcywgdGhlIGZpcnN0IHBpZWNlIGhhcyBtYXggYG5gIGVsZW1lbnRzLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBzcGxpdEF0IH0gZnJvbSAnZnAtdHMvUmVhZG9ubHlBcnJheSdcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKHNwbGl0QXQoMikoWzEsIDIsIDMsIDQsIDVdKSwgW1sxLCAyXSwgWzMsIDQsIDVdXSlcbiAqXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBzcGxpdEF0ID0gZnVuY3Rpb24gKG4pIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIHJldHVybiBuID49IDEgJiYgaXNOb25FbXB0eShhcykgPyBSTkVBLnNwbGl0QXQobikoYXMpIDogaXNFbXB0eShhcykgPyBbYXMsIGVtcHR5XSA6IFtlbXB0eSwgYXNdO1xuICAgIH07XG59O1xuLyoqXG4gKiBTcGxpdHMgYSBgUmVhZG9ubHlBcnJheWAgaW50byBsZW5ndGgtYG5gIHBpZWNlcy4gVGhlIGxhc3QgcGllY2Ugd2lsbCBiZSBzaG9ydGVyIGlmIGBuYCBkb2VzIG5vdCBldmVubHkgZGl2aWRlIHRoZSBsZW5ndGggb2ZcbiAqIHRoZSBgUmVhZG9ubHlBcnJheWAuIE5vdGUgdGhhdCBgY2h1bmtzT2YobikoW10pYCBpcyBgW11gLCBub3QgYFtbXV1gLiBUaGlzIGlzIGludGVudGlvbmFsLCBhbmQgaXMgY29uc2lzdGVudCB3aXRoIGEgcmVjdXJzaXZlXG4gKiBkZWZpbml0aW9uIG9mIGBjaHVua3NPZmA7IGl0IHNhdGlzZmllcyB0aGUgcHJvcGVydHkgdGhhdDpcbiAqXG4gKiBgYGB0c1xuICogY2h1bmtzT2YobikoeHMpLmNvbmNhdChjaHVua3NPZihuKSh5cykpID09IGNodW5rc09mKG4pKHhzLmNvbmNhdCh5cykpKVxuICogYGBgXG4gKlxuICogd2hlbmV2ZXIgYG5gIGV2ZW5seSBkaXZpZGVzIHRoZSBsZW5ndGggb2YgYGFzYC5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgY2h1bmtzT2YgfSBmcm9tICdmcC10cy9SZWFkb25seUFycmF5J1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoY2h1bmtzT2YoMikoWzEsIDIsIDMsIDQsIDVdKSwgW1sxLCAyXSwgWzMsIDRdLCBbNV1dKVxuICpcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIGNodW5rc09mID0gZnVuY3Rpb24gKG4pIHtcbiAgICB2YXIgZiA9IFJORUEuY2h1bmtzT2Yobik7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykgeyByZXR1cm4gKGlzTm9uRW1wdHkoYXMpID8gZihhcykgOiBlbXB0eSk7IH07XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgbGlmdGluZ1xuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIGZyb21PcHRpb25LID0gZnVuY3Rpb24gKGYpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgYSA9IFtdO1xuICAgICAgICBmb3IgKHZhciBfaSA9IDA7IF9pIDwgYXJndW1lbnRzLmxlbmd0aDsgX2krKykge1xuICAgICAgICAgICAgYVtfaV0gPSBhcmd1bWVudHNbX2ldO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBmcm9tT3B0aW9uKGYuYXBwbHkodm9pZCAwLCBhKSk7XG4gICAgfTtcbn07XG5leHBvcnQgZnVuY3Rpb24gY29tcHJlaGVuc2lvbihpbnB1dCwgZiwgZykge1xuICAgIGlmIChnID09PSB2b2lkIDApIHsgZyA9IGZ1bmN0aW9uICgpIHsgcmV0dXJuIHRydWU7IH07IH1cbiAgICB2YXIgZ28gPSBmdW5jdGlvbiAoc2NvcGUsIGlucHV0KSB7XG4gICAgICAgIHJldHVybiBpc05vbkVtcHR5KGlucHV0KVxuICAgICAgICAgICAgPyBmbGF0TWFwKFJORUEuaGVhZChpbnB1dCksIGZ1bmN0aW9uIChhKSB7IHJldHVybiBnbyhwaXBlKHNjb3BlLCBhcHBlbmQoYSkpLCBSTkVBLnRhaWwoaW5wdXQpKTsgfSlcbiAgICAgICAgICAgIDogZy5hcHBseSh2b2lkIDAsIHNjb3BlKSA/IFtmLmFwcGx5KHZvaWQgMCwgc2NvcGUpXVxuICAgICAgICAgICAgICAgIDogZW1wdHk7XG4gICAgfTtcbiAgICByZXR1cm4gZ28oZW1wdHksIGlucHV0KTtcbn1cbi8qKlxuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIGNvbmNhdFcgPSBmdW5jdGlvbiAoc2Vjb25kKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChmaXJzdCkge1xuICAgICAgICByZXR1cm4gaXNFbXB0eShmaXJzdCkgPyBzZWNvbmQgOiBpc0VtcHR5KHNlY29uZCkgPyBmaXJzdCA6IGZpcnN0LmNvbmNhdChzZWNvbmQpO1xuICAgIH07XG59O1xuLyoqXG4gKiBAc2luY2UgMi4xMS4wXG4gKi9cbmV4cG9ydCB2YXIgY29uY2F0ID0gY29uY2F0VztcbmV4cG9ydCBmdW5jdGlvbiB1bmlvbihFKSB7XG4gICAgdmFyIHVuaW9uRSA9IFJORUEudW5pb24oRSk7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChmaXJzdCwgc2Vjb25kKSB7XG4gICAgICAgIGlmIChzZWNvbmQgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgdmFyIHVuaW9uRV8xID0gdW5pb24oRSk7XG4gICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24gKHNlY29uZCkgeyByZXR1cm4gdW5pb25FXzEoc2Vjb25kLCBmaXJzdCk7IH07XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGlzTm9uRW1wdHkoZmlyc3QpICYmIGlzTm9uRW1wdHkoc2Vjb25kKSA/IHVuaW9uRShzZWNvbmQpKGZpcnN0KSA6IGlzTm9uRW1wdHkoZmlyc3QpID8gZmlyc3QgOiBzZWNvbmQ7XG4gICAgfTtcbn1cbmV4cG9ydCBmdW5jdGlvbiBpbnRlcnNlY3Rpb24oRSkge1xuICAgIHZhciBlbGVtRSA9IGVsZW0oRSk7XG4gICAgcmV0dXJuIGZ1bmN0aW9uICh4cywgeXMpIHtcbiAgICAgICAgaWYgKHlzID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIHZhciBpbnRlcnNlY3Rpb25FXzEgPSBpbnRlcnNlY3Rpb24oRSk7XG4gICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24gKHlzKSB7IHJldHVybiBpbnRlcnNlY3Rpb25FXzEoeXMsIHhzKTsgfTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4geHMuZmlsdGVyKGZ1bmN0aW9uIChhKSB7IHJldHVybiBlbGVtRShhLCB5cyk7IH0pO1xuICAgIH07XG59XG5leHBvcnQgZnVuY3Rpb24gZGlmZmVyZW5jZShFKSB7XG4gICAgdmFyIGVsZW1FID0gZWxlbShFKTtcbiAgICByZXR1cm4gZnVuY3Rpb24gKHhzLCB5cykge1xuICAgICAgICBpZiAoeXMgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgdmFyIGRpZmZlcmVuY2VFXzEgPSBkaWZmZXJlbmNlKEUpO1xuICAgICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uICh5cykgeyByZXR1cm4gZGlmZmVyZW5jZUVfMSh5cywgeHMpOyB9O1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB4cy5maWx0ZXIoZnVuY3Rpb24gKGEpIHsgcmV0dXJuICFlbGVtRShhLCB5cyk7IH0pO1xuICAgIH07XG59XG52YXIgX21hcCA9IGZ1bmN0aW9uIChmYSwgZikgeyByZXR1cm4gcGlwZShmYSwgbWFwKGYpKTsgfTtcbnZhciBfbWFwV2l0aEluZGV4ID0gZnVuY3Rpb24gKGZhLCBmKSB7IHJldHVybiBwaXBlKGZhLCBtYXBXaXRoSW5kZXgoZikpOyB9O1xudmFyIF9hcCA9IGZ1bmN0aW9uIChmYWIsIGZhKSB7IHJldHVybiBwaXBlKGZhYiwgYXAoZmEpKTsgfTtcbnZhciBfZmlsdGVyID0gZnVuY3Rpb24gKGZhLCBwcmVkaWNhdGUpIHtcbiAgICByZXR1cm4gcGlwZShmYSwgZmlsdGVyKHByZWRpY2F0ZSkpO1xufTtcbnZhciBfZmlsdGVyTWFwID0gZnVuY3Rpb24gKGZhLCBmKSB7IHJldHVybiBwaXBlKGZhLCBmaWx0ZXJNYXAoZikpOyB9O1xudmFyIF9wYXJ0aXRpb24gPSBmdW5jdGlvbiAoZmEsIHByZWRpY2F0ZSkge1xuICAgIHJldHVybiBwaXBlKGZhLCBwYXJ0aXRpb24ocHJlZGljYXRlKSk7XG59O1xudmFyIF9wYXJ0aXRpb25NYXAgPSBmdW5jdGlvbiAoZmEsIGYpIHsgcmV0dXJuIHBpcGUoZmEsIHBhcnRpdGlvbk1hcChmKSk7IH07XG52YXIgX3BhcnRpdGlvbldpdGhJbmRleCA9IGZ1bmN0aW9uIChmYSwgcHJlZGljYXRlV2l0aEluZGV4KSB7IHJldHVybiBwaXBlKGZhLCBwYXJ0aXRpb25XaXRoSW5kZXgocHJlZGljYXRlV2l0aEluZGV4KSk7IH07XG52YXIgX3BhcnRpdGlvbk1hcFdpdGhJbmRleCA9IGZ1bmN0aW9uIChmYSwgZikgeyByZXR1cm4gcGlwZShmYSwgcGFydGl0aW9uTWFwV2l0aEluZGV4KGYpKTsgfTtcbnZhciBfYWx0ID0gZnVuY3Rpb24gKGZhLCB0aGF0KSB7IHJldHVybiBwaXBlKGZhLCBhbHQodGhhdCkpOyB9O1xudmFyIF9yZWR1Y2UgPSBmdW5jdGlvbiAoZmEsIGIsIGYpIHsgcmV0dXJuIHBpcGUoZmEsIHJlZHVjZShiLCBmKSk7IH07XG52YXIgX2ZvbGRNYXAgPSBmdW5jdGlvbiAoTSkge1xuICAgIHZhciBmb2xkTWFwTSA9IGZvbGRNYXAoTSk7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChmYSwgZikgeyByZXR1cm4gcGlwZShmYSwgZm9sZE1hcE0oZikpOyB9O1xufTtcbnZhciBfcmVkdWNlUmlnaHQgPSBmdW5jdGlvbiAoZmEsIGIsIGYpIHsgcmV0dXJuIHBpcGUoZmEsIHJlZHVjZVJpZ2h0KGIsIGYpKTsgfTtcbnZhciBfcmVkdWNlV2l0aEluZGV4ID0gZnVuY3Rpb24gKGZhLCBiLCBmKSB7XG4gICAgcmV0dXJuIHBpcGUoZmEsIHJlZHVjZVdpdGhJbmRleChiLCBmKSk7XG59O1xudmFyIF9mb2xkTWFwV2l0aEluZGV4ID0gZnVuY3Rpb24gKE0pIHtcbiAgICB2YXIgZm9sZE1hcFdpdGhJbmRleE0gPSBmb2xkTWFwV2l0aEluZGV4KE0pO1xuICAgIHJldHVybiBmdW5jdGlvbiAoZmEsIGYpIHsgcmV0dXJuIHBpcGUoZmEsIGZvbGRNYXBXaXRoSW5kZXhNKGYpKTsgfTtcbn07XG52YXIgX3JlZHVjZVJpZ2h0V2l0aEluZGV4ID0gZnVuY3Rpb24gKGZhLCBiLCBmKSB7XG4gICAgcmV0dXJuIHBpcGUoZmEsIHJlZHVjZVJpZ2h0V2l0aEluZGV4KGIsIGYpKTtcbn07XG52YXIgX2ZpbHRlck1hcFdpdGhJbmRleCA9IGZ1bmN0aW9uIChmYSwgZikgeyByZXR1cm4gcGlwZShmYSwgZmlsdGVyTWFwV2l0aEluZGV4KGYpKTsgfTtcbnZhciBfZmlsdGVyV2l0aEluZGV4ID0gZnVuY3Rpb24gKGZhLCBwcmVkaWNhdGVXaXRoSW5kZXgpIHsgcmV0dXJuIHBpcGUoZmEsIGZpbHRlcldpdGhJbmRleChwcmVkaWNhdGVXaXRoSW5kZXgpKTsgfTtcbnZhciBfZXh0ZW5kID0gZnVuY3Rpb24gKGZhLCBmKSB7IHJldHVybiBwaXBlKGZhLCBleHRlbmQoZikpOyB9O1xudmFyIF90cmF2ZXJzZSA9IGZ1bmN0aW9uIChGKSB7XG4gICAgdmFyIHRyYXZlcnNlRiA9IHRyYXZlcnNlKEYpO1xuICAgIHJldHVybiBmdW5jdGlvbiAodGEsIGYpIHsgcmV0dXJuIHBpcGUodGEsIHRyYXZlcnNlRihmKSk7IH07XG59O1xuLyogaXN0YW5idWwgaWdub3JlIG5leHQgKi9cbnZhciBfdHJhdmVyc2VXaXRoSW5kZXggPSBmdW5jdGlvbiAoRikge1xuICAgIHZhciB0cmF2ZXJzZVdpdGhJbmRleEYgPSB0cmF2ZXJzZVdpdGhJbmRleChGKTtcbiAgICByZXR1cm4gZnVuY3Rpb24gKHRhLCBmKSB7IHJldHVybiBwaXBlKHRhLCB0cmF2ZXJzZVdpdGhJbmRleEYoZikpOyB9O1xufTtcbi8qKiBAaW50ZXJuYWwgKi9cbmV4cG9ydCB2YXIgX2NoYWluUmVjRGVwdGhGaXJzdCA9IGZ1bmN0aW9uIChhLCBmKSB7IHJldHVybiBwaXBlKGEsIGNoYWluUmVjRGVwdGhGaXJzdChmKSk7IH07XG4vKiogQGludGVybmFsICovXG5leHBvcnQgdmFyIF9jaGFpblJlY0JyZWFkdGhGaXJzdCA9IGZ1bmN0aW9uIChhLCBmKSB7IHJldHVybiBwaXBlKGEsIGNoYWluUmVjQnJlYWR0aEZpcnN0KGYpKTsgfTtcbi8qKlxuICogQGNhdGVnb3J5IGNvbnN0cnVjdG9yc1xuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgb2YgPSBSTkVBLm9mO1xuLyoqXG4gKiBAc2luY2UgMi43LjBcbiAqL1xuZXhwb3J0IHZhciB6ZXJvID0gZnVuY3Rpb24gKCkgeyByZXR1cm4gZW1wdHk7IH07XG4vKipcbiAqIExlc3Mgc3RyaWN0IHZlcnNpb24gb2YgW2BhbHRgXSgjYWx0KS5cbiAqXG4gKiBUaGUgYFdgIHN1ZmZpeCAoc2hvcnQgZm9yICoqVyoqaWRlbmluZykgbWVhbnMgdGhhdCB0aGUgcmV0dXJuIHR5cGVzIHdpbGwgYmUgbWVyZ2VkLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgKiBhcyBSQSBmcm9tICdmcC10cy9SZWFkb25seUFycmF5J1xuICogaW1wb3J0IHsgcGlwZSB9IGZyb20gJ2ZwLXRzL2Z1bmN0aW9uJ1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoXG4gKiAgIHBpcGUoXG4gKiAgICAgWzEsIDIsIDNdLFxuICogICAgIFJBLmFsdFcoKCkgPT4gWydhJywgJ2InXSlcbiAqICAgKSxcbiAqICAgWzEsIDIsIDMsICdhJywgJ2InXVxuICogKVxuICpcbiAqIEBjYXRlZ29yeSBlcnJvciBoYW5kbGluZ1xuICogQHNpbmNlIDIuOS4wXG4gKi9cbmV4cG9ydCB2YXIgYWx0VyA9IGZ1bmN0aW9uICh0aGF0KSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChmYSkge1xuICAgICAgICByZXR1cm4gZmEuY29uY2F0KHRoYXQoKSk7XG4gICAgfTtcbn07XG4vKipcbiAqIElkZW50aWZpZXMgYW4gYXNzb2NpYXRpdmUgb3BlcmF0aW9uIG9uIGEgdHlwZSBjb25zdHJ1Y3Rvci4gSXQgaXMgc2ltaWxhciB0byBgU2VtaWdyb3VwYCwgZXhjZXB0IHRoYXQgaXQgYXBwbGllcyB0b1xuICogdHlwZXMgb2Yga2luZCBgKiAtPiAqYC5cbiAqXG4gKiBJbiBjYXNlIG9mIGBSZWFkb25seUFycmF5YCBjb25jYXRlbmF0ZXMgdGhlIGlucHV0cyBpbnRvIGEgc2luZ2xlIGFycmF5LlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgKiBhcyBSQSBmcm9tICdmcC10cy9SZWFkb25seUFycmF5J1xuICogaW1wb3J0IHsgcGlwZSB9IGZyb20gJ2ZwLXRzL2Z1bmN0aW9uJ1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoXG4gKiAgIHBpcGUoXG4gKiAgICAgWzEsIDIsIDNdLFxuICogICAgIFJBLmFsdCgoKSA9PiBbNCwgNV0pXG4gKiAgICksXG4gKiAgIFsxLCAyLCAzLCA0LCA1XVxuICogKVxuICpcbiAqIEBjYXRlZ29yeSBlcnJvciBoYW5kbGluZ1xuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgYWx0ID0gYWx0Vztcbi8qKlxuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgYXAgPSBmdW5jdGlvbiAoZmEpIHtcbiAgICByZXR1cm4gZmxhdE1hcChmdW5jdGlvbiAoZikgeyByZXR1cm4gcGlwZShmYSwgbWFwKGYpKTsgfSk7XG59O1xuLyoqXG4gKiBDb21wb3NlcyBjb21wdXRhdGlvbnMgaW4gc2VxdWVuY2UsIHVzaW5nIHRoZSByZXR1cm4gdmFsdWUgb2Ygb25lIGNvbXB1dGF0aW9uIHRvIGRldGVybWluZSB0aGUgbmV4dCBjb21wdXRhdGlvbi5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0ICogYXMgUkEgZnJvbSAnZnAtdHMvUmVhZG9ubHlBcnJheSdcbiAqIGltcG9ydCB7IHBpcGUgfSBmcm9tICdmcC10cy9mdW5jdGlvbidcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKFxuICogICBwaXBlKFxuICogICAgIFsxLCAyLCAzXSxcbiAqICAgICBSQS5mbGF0TWFwKChuKSA9PiBbYGEke259YCwgYGIke259YF0pXG4gKiAgICksXG4gKiAgIFsnYTEnLCAnYjEnLCAnYTInLCAnYjInLCAnYTMnLCAnYjMnXVxuICogKVxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChcbiAqICAgcGlwZShcbiAqICAgICBbMSwgMiwgM10sXG4gKiAgICAgUkEuZmxhdE1hcCgoKSA9PiBbXSlcbiAqICAgKSxcbiAqICAgW11cbiAqIClcbiAqXG4gKiBAY2F0ZWdvcnkgc2VxdWVuY2luZ1xuICogQHNpbmNlIDIuMTQuMFxuICovXG5leHBvcnQgdmFyIGZsYXRNYXAgPSAvKiNfX1BVUkVfXyovIGR1YWwoMiwgZnVuY3Rpb24gKG1hLCBmKSB7XG4gICAgcmV0dXJuIHBpcGUobWEsIGNoYWluV2l0aEluZGV4KGZ1bmN0aW9uIChpLCBhKSB7IHJldHVybiBmKGEsIGkpOyB9KSk7XG59KTtcbi8qKlxuICogQGNhdGVnb3J5IHNlcXVlbmNpbmdcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIGZsYXR0ZW4gPSAvKiNfX1BVUkVfXyovIGZsYXRNYXAoaWRlbnRpdHkpO1xuLyoqXG4gKiBgbWFwYCBjYW4gYmUgdXNlZCB0byB0dXJuIGZ1bmN0aW9ucyBgKGE6IEEpID0+IEJgIGludG8gZnVuY3Rpb25zIGAoZmE6IEY8QT4pID0+IEY8Qj5gIHdob3NlIGFyZ3VtZW50IGFuZCByZXR1cm4gdHlwZXNcbiAqIHVzZSB0aGUgdHlwZSBjb25zdHJ1Y3RvciBgRmAgdG8gcmVwcmVzZW50IHNvbWUgY29tcHV0YXRpb25hbCBjb250ZXh0LlxuICpcbiAqIEBjYXRlZ29yeSBtYXBwaW5nXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBtYXAgPSBmdW5jdGlvbiAoZikgeyByZXR1cm4gZnVuY3Rpb24gKGZhKSB7XG4gICAgcmV0dXJuIGZhLm1hcChmdW5jdGlvbiAoYSkgeyByZXR1cm4gZihhKTsgfSk7XG59OyB9O1xuLyoqXG4gKiBAY2F0ZWdvcnkgbWFwcGluZ1xuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgbWFwV2l0aEluZGV4ID0gZnVuY3Rpb24gKGYpIHsgcmV0dXJuIGZ1bmN0aW9uIChmYSkge1xuICAgIHJldHVybiBmYS5tYXAoZnVuY3Rpb24gKGEsIGkpIHsgcmV0dXJuIGYoaSwgYSk7IH0pO1xufTsgfTtcbi8qKlxuICogQGNhdGVnb3J5IGZpbHRlcmluZ1xuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgc2VwYXJhdGUgPSBmdW5jdGlvbiAoZmEpIHtcbiAgICB2YXIgbGVmdCA9IFtdO1xuICAgIHZhciByaWdodCA9IFtdO1xuICAgIGZvciAodmFyIF9pID0gMCwgZmFfMSA9IGZhOyBfaSA8IGZhXzEubGVuZ3RoOyBfaSsrKSB7XG4gICAgICAgIHZhciBlID0gZmFfMVtfaV07XG4gICAgICAgIGlmIChlLl90YWcgPT09ICdMZWZ0Jykge1xuICAgICAgICAgICAgbGVmdC5wdXNoKGUubGVmdCk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICByaWdodC5wdXNoKGUucmlnaHQpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiBzZXBhcmF0ZWQobGVmdCwgcmlnaHQpO1xufTtcbi8qKlxuICogQGNhdGVnb3J5IGZpbHRlcmluZ1xuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgZmlsdGVyID0gZnVuY3Rpb24gKHByZWRpY2F0ZSkge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgcmV0dXJuIGFzLmZpbHRlcihwcmVkaWNhdGUpO1xuICAgIH07XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgZmlsdGVyaW5nXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBmaWx0ZXJNYXBXaXRoSW5kZXggPSBmdW5jdGlvbiAoZikge1xuICAgIHJldHVybiBmdW5jdGlvbiAoZmEpIHtcbiAgICAgICAgdmFyIG91dCA9IFtdO1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGZhLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICB2YXIgb3B0aW9uQiA9IGYoaSwgZmFbaV0pO1xuICAgICAgICAgICAgaWYgKF8uaXNTb21lKG9wdGlvbkIpKSB7XG4gICAgICAgICAgICAgICAgb3V0LnB1c2gob3B0aW9uQi52YWx1ZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG91dDtcbiAgICB9O1xufTtcbi8qKlxuICogQGNhdGVnb3J5IGZpbHRlcmluZ1xuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgZmlsdGVyTWFwID0gZnVuY3Rpb24gKGYpIHtcbiAgICByZXR1cm4gZmlsdGVyTWFwV2l0aEluZGV4KGZ1bmN0aW9uIChfLCBhKSB7IHJldHVybiBmKGEpOyB9KTtcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBmaWx0ZXJpbmdcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIGNvbXBhY3QgPSAvKiNfX1BVUkVfXyovIGZpbHRlck1hcChpZGVudGl0eSk7XG4vKipcbiAqIEBjYXRlZ29yeSBmaWx0ZXJpbmdcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIHBhcnRpdGlvbiA9IGZ1bmN0aW9uIChwcmVkaWNhdGUpIHtcbiAgICByZXR1cm4gcGFydGl0aW9uV2l0aEluZGV4KGZ1bmN0aW9uIChfLCBhKSB7IHJldHVybiBwcmVkaWNhdGUoYSk7IH0pO1xufTtcbi8qKlxuICogQGNhdGVnb3J5IGZpbHRlcmluZ1xuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgcGFydGl0aW9uV2l0aEluZGV4ID0gZnVuY3Rpb24gKHByZWRpY2F0ZVdpdGhJbmRleCkge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgdmFyIGxlZnQgPSBbXTtcbiAgICAgICAgdmFyIHJpZ2h0ID0gW107XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgYXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIHZhciBhID0gYXNbaV07XG4gICAgICAgICAgICBpZiAocHJlZGljYXRlV2l0aEluZGV4KGksIGEpKSB7XG4gICAgICAgICAgICAgICAgcmlnaHQucHVzaChhKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIGxlZnQucHVzaChhKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gc2VwYXJhdGVkKGxlZnQsIHJpZ2h0KTtcbiAgICB9O1xufTtcbi8qKlxuICogQGNhdGVnb3J5IGZpbHRlcmluZ1xuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgcGFydGl0aW9uTWFwID0gZnVuY3Rpb24gKGYpIHtcbiAgICByZXR1cm4gcGFydGl0aW9uTWFwV2l0aEluZGV4KGZ1bmN0aW9uIChfLCBhKSB7IHJldHVybiBmKGEpOyB9KTtcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBmaWx0ZXJpbmdcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIHBhcnRpdGlvbk1hcFdpdGhJbmRleCA9IGZ1bmN0aW9uIChmKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChmYSkge1xuICAgICAgICB2YXIgbGVmdCA9IFtdO1xuICAgICAgICB2YXIgcmlnaHQgPSBbXTtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBmYS5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgdmFyIGUgPSBmKGksIGZhW2ldKTtcbiAgICAgICAgICAgIGlmIChlLl90YWcgPT09ICdMZWZ0Jykge1xuICAgICAgICAgICAgICAgIGxlZnQucHVzaChlLmxlZnQpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgcmlnaHQucHVzaChlLnJpZ2h0KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gc2VwYXJhdGVkKGxlZnQsIHJpZ2h0KTtcbiAgICB9O1xufTtcbi8qKlxuICogQGNhdGVnb3J5IGZpbHRlcmluZ1xuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgZmlsdGVyV2l0aEluZGV4ID0gZnVuY3Rpb24gKHByZWRpY2F0ZVdpdGhJbmRleCkge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgcmV0dXJuIGFzLmZpbHRlcihmdW5jdGlvbiAoYSwgaSkgeyByZXR1cm4gcHJlZGljYXRlV2l0aEluZGV4KGksIGEpOyB9KTtcbiAgICB9O1xufTtcbi8qKlxuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgZXh0ZW5kID0gZnVuY3Rpb24gKGYpIHsgcmV0dXJuIGZ1bmN0aW9uICh3YSkge1xuICAgIHJldHVybiB3YS5tYXAoZnVuY3Rpb24gKF8sIGkpIHsgcmV0dXJuIGYod2Euc2xpY2UoaSkpOyB9KTtcbn07IH07XG4vKipcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIGR1cGxpY2F0ZSA9IC8qI19fUFVSRV9fKi8gZXh0ZW5kKGlkZW50aXR5KTtcbi8qKlxuICogQGNhdGVnb3J5IGZvbGRpbmdcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIGZvbGRNYXBXaXRoSW5kZXggPSBmdW5jdGlvbiAoTSkge1xuICAgIHJldHVybiBmdW5jdGlvbiAoZikge1xuICAgICAgICByZXR1cm4gZnVuY3Rpb24gKGZhKSB7XG4gICAgICAgICAgICByZXR1cm4gZmEucmVkdWNlKGZ1bmN0aW9uIChiLCBhLCBpKSB7IHJldHVybiBNLmNvbmNhdChiLCBmKGksIGEpKTsgfSwgTS5lbXB0eSk7XG4gICAgICAgIH07XG4gICAgfTtcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBmb2xkaW5nXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciByZWR1Y2UgPSBmdW5jdGlvbiAoYiwgZikge1xuICAgIHJldHVybiByZWR1Y2VXaXRoSW5kZXgoYiwgZnVuY3Rpb24gKF8sIGIsIGEpIHsgcmV0dXJuIGYoYiwgYSk7IH0pO1xufTtcbi8qKlxuICogQGNhdGVnb3J5IGZvbGRpbmdcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIGZvbGRNYXAgPSBmdW5jdGlvbiAoTSkge1xuICAgIHZhciBmb2xkTWFwV2l0aEluZGV4TSA9IGZvbGRNYXBXaXRoSW5kZXgoTSk7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChmKSB7IHJldHVybiBmb2xkTWFwV2l0aEluZGV4TShmdW5jdGlvbiAoXywgYSkgeyByZXR1cm4gZihhKTsgfSk7IH07XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgZm9sZGluZ1xuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgcmVkdWNlV2l0aEluZGV4ID0gZnVuY3Rpb24gKGIsIGYpIHsgcmV0dXJuIGZ1bmN0aW9uIChmYSkge1xuICAgIHZhciBsZW4gPSBmYS5sZW5ndGg7XG4gICAgdmFyIG91dCA9IGI7XG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBsZW47IGkrKykge1xuICAgICAgICBvdXQgPSBmKGksIG91dCwgZmFbaV0pO1xuICAgIH1cbiAgICByZXR1cm4gb3V0O1xufTsgfTtcbi8qKlxuICogQGNhdGVnb3J5IGZvbGRpbmdcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIHJlZHVjZVJpZ2h0ID0gZnVuY3Rpb24gKGIsIGYpIHtcbiAgICByZXR1cm4gcmVkdWNlUmlnaHRXaXRoSW5kZXgoYiwgZnVuY3Rpb24gKF8sIGEsIGIpIHsgcmV0dXJuIGYoYSwgYik7IH0pO1xufTtcbi8qKlxuICogQGNhdGVnb3J5IGZvbGRpbmdcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIHJlZHVjZVJpZ2h0V2l0aEluZGV4ID0gZnVuY3Rpb24gKGIsIGYpIHsgcmV0dXJuIGZ1bmN0aW9uIChmYSkge1xuICAgIHJldHVybiBmYS5yZWR1Y2VSaWdodChmdW5jdGlvbiAoYiwgYSwgaSkgeyByZXR1cm4gZihpLCBhLCBiKTsgfSwgYik7XG59OyB9O1xuLyoqXG4gKiBAY2F0ZWdvcnkgdHJhdmVyc2luZ1xuICogQHNpbmNlIDIuNi4zXG4gKi9cbmV4cG9ydCB2YXIgdHJhdmVyc2UgPSBmdW5jdGlvbiAoRikge1xuICAgIHZhciB0cmF2ZXJzZVdpdGhJbmRleEYgPSB0cmF2ZXJzZVdpdGhJbmRleChGKTtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGYpIHsgcmV0dXJuIHRyYXZlcnNlV2l0aEluZGV4RihmdW5jdGlvbiAoXywgYSkgeyByZXR1cm4gZihhKTsgfSk7IH07XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgdHJhdmVyc2luZ1xuICogQHNpbmNlIDIuNi4zXG4gKi9cbmV4cG9ydCB2YXIgc2VxdWVuY2UgPSBmdW5jdGlvbiAoRikge1xuICAgIHJldHVybiBmdW5jdGlvbiAodGEpIHtcbiAgICAgICAgcmV0dXJuIF9yZWR1Y2UodGEsIEYub2YoemVybygpKSwgZnVuY3Rpb24gKGZhcywgZmEpIHtcbiAgICAgICAgICAgIHJldHVybiBGLmFwKEYubWFwKGZhcywgZnVuY3Rpb24gKGFzKSB7IHJldHVybiBmdW5jdGlvbiAoYSkgeyByZXR1cm4gcGlwZShhcywgYXBwZW5kKGEpKTsgfTsgfSksIGZhKTtcbiAgICAgICAgfSk7XG4gICAgfTtcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBzZXF1ZW5jaW5nXG4gKiBAc2luY2UgMi42LjNcbiAqL1xuZXhwb3J0IHZhciB0cmF2ZXJzZVdpdGhJbmRleCA9IGZ1bmN0aW9uIChGKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChmKSB7XG4gICAgICAgIHJldHVybiByZWR1Y2VXaXRoSW5kZXgoRi5vZih6ZXJvKCkpLCBmdW5jdGlvbiAoaSwgZmJzLCBhKSB7XG4gICAgICAgICAgICByZXR1cm4gRi5hcChGLm1hcChmYnMsIGZ1bmN0aW9uIChicykgeyByZXR1cm4gZnVuY3Rpb24gKGIpIHsgcmV0dXJuIHBpcGUoYnMsIGFwcGVuZChiKSk7IH07IH0pLCBmKGksIGEpKTtcbiAgICAgICAgfSk7XG4gICAgfTtcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBmaWx0ZXJpbmdcbiAqIEBzaW5jZSAyLjYuNVxuICovXG5leHBvcnQgdmFyIHdpdGhlciA9IGZ1bmN0aW9uIChGKSB7XG4gICAgdmFyIF93aXRoZXJGID0gX3dpdGhlcihGKTtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGYpIHsgcmV0dXJuIGZ1bmN0aW9uIChmYSkgeyByZXR1cm4gX3dpdGhlckYoZmEsIGYpOyB9OyB9O1xufTtcbi8qKlxuICogQGNhdGVnb3J5IGZpbHRlcmluZ1xuICogQHNpbmNlIDIuNi41XG4gKi9cbmV4cG9ydCB2YXIgd2lsdCA9IGZ1bmN0aW9uIChGKSB7XG4gICAgdmFyIF93aWx0RiA9IF93aWx0KEYpO1xuICAgIHJldHVybiBmdW5jdGlvbiAoZikgeyByZXR1cm4gZnVuY3Rpb24gKGZhKSB7IHJldHVybiBfd2lsdEYoZmEsIGYpOyB9OyB9O1xufTtcbi8qKlxuICogQHNpbmNlIDIuNi42XG4gKi9cbmV4cG9ydCB2YXIgdW5mb2xkID0gZnVuY3Rpb24gKGIsIGYpIHtcbiAgICB2YXIgb3V0ID0gW107XG4gICAgdmFyIGJiID0gYjtcbiAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tY29uc3RhbnQtY29uZGl0aW9uXG4gICAgd2hpbGUgKHRydWUpIHtcbiAgICAgICAgdmFyIG10ID0gZihiYik7XG4gICAgICAgIGlmIChfLmlzU29tZShtdCkpIHtcbiAgICAgICAgICAgIHZhciBfYSA9IG10LnZhbHVlLCBhID0gX2FbMF0sIGJfMSA9IF9hWzFdO1xuICAgICAgICAgICAgb3V0LnB1c2goYSk7XG4gICAgICAgICAgICBiYiA9IGJfMTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiBvdXQ7XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgdHlwZSBsYW1iZGFzXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBVUkkgPSAnUmVhZG9ubHlBcnJheSc7XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIGdldFNob3cgPSBmdW5jdGlvbiAoUykgeyByZXR1cm4gKHtcbiAgICBzaG93OiBmdW5jdGlvbiAoYXMpIHsgcmV0dXJuIFwiW1wiLmNvbmNhdChhcy5tYXAoUy5zaG93KS5qb2luKCcsICcpLCBcIl1cIik7IH1cbn0pOyB9O1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBnZXRTZW1pZ3JvdXAgPSBmdW5jdGlvbiAoKSB7IHJldHVybiAoe1xuICAgIGNvbmNhdDogZnVuY3Rpb24gKGZpcnN0LCBzZWNvbmQpIHsgcmV0dXJuIChpc0VtcHR5KGZpcnN0KSA/IHNlY29uZCA6IGlzRW1wdHkoc2Vjb25kKSA/IGZpcnN0IDogZmlyc3QuY29uY2F0KHNlY29uZCkpOyB9XG59KTsgfTtcbi8qKlxuICogUmV0dXJucyBhIGBNb25vaWRgIGZvciBgUmVhZG9ubHlBcnJheTxBPmAuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IGdldE1vbm9pZCB9IGZyb20gJ2ZwLXRzL1JlYWRvbmx5QXJyYXknXG4gKlxuICogY29uc3QgTSA9IGdldE1vbm9pZDxudW1iZXI+KClcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoTS5jb25jYXQoWzEsIDJdLCBbMywgNF0pLCBbMSwgMiwgMywgNF0pXG4gKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgZ2V0TW9ub2lkID0gZnVuY3Rpb24gKCkgeyByZXR1cm4gKHtcbiAgICBjb25jYXQ6IGdldFNlbWlncm91cCgpLmNvbmNhdCxcbiAgICBlbXB0eTogZW1wdHlcbn0pOyB9O1xuLyoqXG4gKiBEZXJpdmVzIGFuIGBFcWAgb3ZlciB0aGUgYFJlYWRvbmx5QXJyYXlgIG9mIGEgZ2l2ZW4gZWxlbWVudCB0eXBlIGZyb20gdGhlIGBFcWAgb2YgdGhhdCB0eXBlLiBUaGUgZGVyaXZlZCBgRXFgIGRlZmluZXMgdHdvXG4gKiBhcnJheXMgYXMgZXF1YWwgaWYgYWxsIGVsZW1lbnRzIG9mIGJvdGggYXJyYXlzIGFyZSBjb21wYXJlZCBlcXVhbCBwYWlyd2lzZSB3aXRoIHRoZSBnaXZlbiBgRWAuIEluIGNhc2Ugb2YgYXJyYXlzIG9mXG4gKiBkaWZmZXJlbnQgbGVuZ3RocywgdGhlIHJlc3VsdCBpcyBub24gZXF1YWxpdHkuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCAqIGFzIFMgZnJvbSAnZnAtdHMvc3RyaW5nJ1xuICogaW1wb3J0IHsgZ2V0RXEgfSBmcm9tICdmcC10cy9SZWFkb25seUFycmF5J1xuICpcbiAqIGNvbnN0IEUgPSBnZXRFcShTLkVxKVxuICogYXNzZXJ0LnN0cmljdEVxdWFsKEUuZXF1YWxzKFsnYScsICdiJ10sIFsnYScsICdiJ10pLCB0cnVlKVxuICogYXNzZXJ0LnN0cmljdEVxdWFsKEUuZXF1YWxzKFsnYSddLCBbXSksIGZhbHNlKVxuICpcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIGdldEVxID0gZnVuY3Rpb24gKEUpIHtcbiAgICByZXR1cm4gZnJvbUVxdWFscyhmdW5jdGlvbiAoeHMsIHlzKSB7IHJldHVybiB4cy5sZW5ndGggPT09IHlzLmxlbmd0aCAmJiB4cy5ldmVyeShmdW5jdGlvbiAoeCwgaSkgeyByZXR1cm4gRS5lcXVhbHMoeCwgeXNbaV0pOyB9KTsgfSk7XG59O1xuLyoqXG4gKiBEZXJpdmVzIGFuIGBPcmRgIG92ZXIgdGhlIGBSZWFkb25seUFycmF5YCBvZiBhIGdpdmVuIGVsZW1lbnQgdHlwZSBmcm9tIHRoZSBgT3JkYCBvZiB0aGF0IHR5cGUuIFRoZSBvcmRlcmluZyBiZXR3ZWVuIHR3byBzdWNoXG4gKiBhcnJheXMgaXMgZXF1YWwgdG86IHRoZSBmaXJzdCBub24gZXF1YWwgY29tcGFyaXNvbiBvZiBlYWNoIGFycmF5cyBlbGVtZW50cyB0YWtlbiBwYWlyd2lzZSBpbiBpbmNyZWFzaW5nIG9yZGVyLCBpblxuICogY2FzZSBvZiBlcXVhbGl0eSBvdmVyIGFsbCB0aGUgcGFpcndpc2UgZWxlbWVudHM7IHRoZSBsb25nZXN0IGFycmF5IGlzIGNvbnNpZGVyZWQgdGhlIGdyZWF0ZXN0LCBpZiBib3RoIGFycmF5cyBoYXZlXG4gKiB0aGUgc2FtZSBsZW5ndGgsIHRoZSByZXN1bHQgaXMgZXF1YWxpdHkuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IGdldE9yZCB9IGZyb20gJ2ZwLXRzL1JlYWRvbmx5QXJyYXknXG4gKiBpbXBvcnQgKiBhcyBTIGZyb20gJ2ZwLXRzL3N0cmluZydcbiAqXG4gKiBjb25zdCBPID0gZ2V0T3JkKFMuT3JkKVxuICogYXNzZXJ0LnN0cmljdEVxdWFsKE8uY29tcGFyZShbJ2InXSwgWydhJ10pLCAxKVxuICogYXNzZXJ0LnN0cmljdEVxdWFsKE8uY29tcGFyZShbJ2EnXSwgWydhJ10pLCAwKVxuICogYXNzZXJ0LnN0cmljdEVxdWFsKE8uY29tcGFyZShbJ2EnXSwgWydiJ10pLCAtMSlcbiAqXG4gKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgZ2V0T3JkID0gZnVuY3Rpb24gKE8pIHtcbiAgICByZXR1cm4gZnJvbUNvbXBhcmUoZnVuY3Rpb24gKGEsIGIpIHtcbiAgICAgICAgdmFyIGFMZW4gPSBhLmxlbmd0aDtcbiAgICAgICAgdmFyIGJMZW4gPSBiLmxlbmd0aDtcbiAgICAgICAgdmFyIGxlbiA9IE1hdGgubWluKGFMZW4sIGJMZW4pO1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGxlbjsgaSsrKSB7XG4gICAgICAgICAgICB2YXIgb3JkZXJpbmcgPSBPLmNvbXBhcmUoYVtpXSwgYltpXSk7XG4gICAgICAgICAgICBpZiAob3JkZXJpbmcgIT09IDApIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gb3JkZXJpbmc7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIE4uT3JkLmNvbXBhcmUoYUxlbiwgYkxlbik7XG4gICAgfSk7XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi4xMS4wXG4gKi9cbmV4cG9ydCB2YXIgZ2V0VW5pb25TZW1pZ3JvdXAgPSBmdW5jdGlvbiAoRSkge1xuICAgIHZhciB1bmlvbkUgPSB1bmlvbihFKTtcbiAgICByZXR1cm4ge1xuICAgICAgICBjb25jYXQ6IGZ1bmN0aW9uIChmaXJzdCwgc2Vjb25kKSB7IHJldHVybiB1bmlvbkUoc2Vjb25kKShmaXJzdCk7IH1cbiAgICB9O1xufTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIGdldFVuaW9uTW9ub2lkID0gZnVuY3Rpb24gKEUpIHsgcmV0dXJuICh7XG4gICAgY29uY2F0OiBnZXRVbmlvblNlbWlncm91cChFKS5jb25jYXQsXG4gICAgZW1wdHk6IGVtcHR5XG59KTsgfTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIGdldEludGVyc2VjdGlvblNlbWlncm91cCA9IGZ1bmN0aW9uIChFKSB7XG4gICAgdmFyIGludGVyc2VjdGlvbkUgPSBpbnRlcnNlY3Rpb24oRSk7XG4gICAgcmV0dXJuIHtcbiAgICAgICAgY29uY2F0OiBmdW5jdGlvbiAoZmlyc3QsIHNlY29uZCkgeyByZXR1cm4gaW50ZXJzZWN0aW9uRShzZWNvbmQpKGZpcnN0KTsgfVxuICAgIH07XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi4xMS4wXG4gKi9cbmV4cG9ydCB2YXIgZ2V0RGlmZmVyZW5jZU1hZ21hID0gZnVuY3Rpb24gKEUpIHtcbiAgICB2YXIgZGlmZmVyZW5jZUUgPSBkaWZmZXJlbmNlKEUpO1xuICAgIHJldHVybiB7XG4gICAgICAgIGNvbmNhdDogZnVuY3Rpb24gKGZpcnN0LCBzZWNvbmQpIHsgcmV0dXJuIGRpZmZlcmVuY2VFKHNlY29uZCkoZmlyc3QpOyB9XG4gICAgfTtcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjcuMFxuICovXG5leHBvcnQgdmFyIEZ1bmN0b3IgPSB7XG4gICAgVVJJOiBVUkksXG4gICAgbWFwOiBfbWFwXG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgbWFwcGluZ1xuICogQHNpbmNlIDIuMTAuMFxuICovXG5leHBvcnQgdmFyIGZsYXAgPSAvKiNfX1BVUkVfXyovIGZsYXBfKEZ1bmN0b3IpO1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi4xMC4wXG4gKi9cbmV4cG9ydCB2YXIgUG9pbnRlZCA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICBvZjogb2Zcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjcuMFxuICovXG5leHBvcnQgdmFyIEZ1bmN0b3JXaXRoSW5kZXggPSB7XG4gICAgVVJJOiBVUkksXG4gICAgbWFwOiBfbWFwLFxuICAgIG1hcFdpdGhJbmRleDogX21hcFdpdGhJbmRleFxufTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuMTAuMFxuICovXG5leHBvcnQgdmFyIEFwcGx5ID0ge1xuICAgIFVSSTogVVJJLFxuICAgIG1hcDogX21hcCxcbiAgICBhcDogX2FwXG59O1xuLyoqXG4gKiBDb21iaW5lIHR3byBlZmZlY3RmdWwgYWN0aW9ucywga2VlcGluZyBvbmx5IHRoZSByZXN1bHQgb2YgdGhlIGZpcnN0LlxuICpcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIGFwRmlyc3QgPSAvKiNfX1BVUkVfXyovIGFwRmlyc3RfKEFwcGx5KTtcbi8qKlxuICogQ29tYmluZSB0d28gZWZmZWN0ZnVsIGFjdGlvbnMsIGtlZXBpbmcgb25seSB0aGUgcmVzdWx0IG9mIHRoZSBzZWNvbmQuXG4gKlxuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgYXBTZWNvbmQgPSAvKiNfX1BVUkVfXyovIGFwU2Vjb25kXyhBcHBseSk7XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjcuMFxuICovXG5leHBvcnQgdmFyIEFwcGxpY2F0aXZlID0ge1xuICAgIFVSSTogVVJJLFxuICAgIG1hcDogX21hcCxcbiAgICBhcDogX2FwLFxuICAgIG9mOiBvZlxufTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuMTAuMFxuICovXG5leHBvcnQgdmFyIENoYWluID0ge1xuICAgIFVSSTogVVJJLFxuICAgIG1hcDogX21hcCxcbiAgICBhcDogX2FwLFxuICAgIGNoYWluOiBmbGF0TWFwXG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi43LjBcbiAqL1xuZXhwb3J0IHZhciBNb25hZCA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICBtYXA6IF9tYXAsXG4gICAgYXA6IF9hcCxcbiAgICBvZjogb2YsXG4gICAgY2hhaW46IGZsYXRNYXBcbn07XG4vKipcbiAqIENvbXBvc2VzIGNvbXB1dGF0aW9ucyBpbiBzZXF1ZW5jZSwgdXNpbmcgdGhlIHJldHVybiB2YWx1ZSBvZiBvbmUgY29tcHV0YXRpb24gdG8gZGV0ZXJtaW5lIHRoZSBuZXh0IGNvbXB1dGF0aW9uIGFuZFxuICoga2VlcGluZyBvbmx5IHRoZSByZXN1bHQgb2YgdGhlIGZpcnN0LlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgKiBhcyBSQSBmcm9tICdmcC10cy9SZWFkb25seUFycmF5J1xuICogaW1wb3J0IHsgcGlwZSB9IGZyb20gJ2ZwLXRzL2Z1bmN0aW9uJ1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoXG4gKiAgIHBpcGUoXG4gKiAgICAgWzEsIDIsIDNdLFxuICogICAgIFJBLmNoYWluRmlyc3QoKCkgPT4gWydhJywgJ2InXSlcbiAqICAgKSxcbiAqICAgWzEsIDEsIDIsIDIsIDMsIDNdXG4gKiApXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKFxuICogICBwaXBlKFxuICogICAgIFsxLCAyLCAzXSxcbiAqICAgICBSQS5jaGFpbkZpcnN0KCgpID0+IFtdKVxuICogICApLFxuICogICBbXVxuICogKVxuICpcbiAqIEBjYXRlZ29yeSBzZXF1ZW5jaW5nXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBjaGFpbkZpcnN0ID0gXG4vKiNfX1BVUkVfXyovIGNoYWluRmlyc3RfKENoYWluKTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuNy4wXG4gKi9cbmV4cG9ydCB2YXIgVW5mb2xkYWJsZSA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICB1bmZvbGQ6IHVuZm9sZFxufTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuNy4wXG4gKi9cbmV4cG9ydCB2YXIgQWx0ID0ge1xuICAgIFVSSTogVVJJLFxuICAgIG1hcDogX21hcCxcbiAgICBhbHQ6IF9hbHRcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjExLjBcbiAqL1xuZXhwb3J0IHZhciBaZXJvID0ge1xuICAgIFVSSTogVVJJLFxuICAgIHplcm86IHplcm9cbn07XG4vKipcbiAqIEBjYXRlZ29yeSBkbyBub3RhdGlvblxuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIGd1YXJkID0gLyojX19QVVJFX18qLyBndWFyZF8oWmVybywgUG9pbnRlZCk7XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjcuMFxuICovXG5leHBvcnQgdmFyIEFsdGVybmF0aXZlID0ge1xuICAgIFVSSTogVVJJLFxuICAgIG1hcDogX21hcCxcbiAgICBhcDogX2FwLFxuICAgIG9mOiBvZixcbiAgICBhbHQ6IF9hbHQsXG4gICAgemVybzogemVyb1xufTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuNy4wXG4gKi9cbmV4cG9ydCB2YXIgRXh0ZW5kID0ge1xuICAgIFVSSTogVVJJLFxuICAgIG1hcDogX21hcCxcbiAgICBleHRlbmQ6IF9leHRlbmRcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjcuMFxuICovXG5leHBvcnQgdmFyIENvbXBhY3RhYmxlID0ge1xuICAgIFVSSTogVVJJLFxuICAgIGNvbXBhY3Q6IGNvbXBhY3QsXG4gICAgc2VwYXJhdGU6IHNlcGFyYXRlXG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi43LjBcbiAqL1xuZXhwb3J0IHZhciBGaWx0ZXJhYmxlID0ge1xuICAgIFVSSTogVVJJLFxuICAgIG1hcDogX21hcCxcbiAgICBjb21wYWN0OiBjb21wYWN0LFxuICAgIHNlcGFyYXRlOiBzZXBhcmF0ZSxcbiAgICBmaWx0ZXI6IF9maWx0ZXIsXG4gICAgZmlsdGVyTWFwOiBfZmlsdGVyTWFwLFxuICAgIHBhcnRpdGlvbjogX3BhcnRpdGlvbixcbiAgICBwYXJ0aXRpb25NYXA6IF9wYXJ0aXRpb25NYXBcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjcuMFxuICovXG5leHBvcnQgdmFyIEZpbHRlcmFibGVXaXRoSW5kZXggPSB7XG4gICAgVVJJOiBVUkksXG4gICAgbWFwOiBfbWFwLFxuICAgIG1hcFdpdGhJbmRleDogX21hcFdpdGhJbmRleCxcbiAgICBjb21wYWN0OiBjb21wYWN0LFxuICAgIHNlcGFyYXRlOiBzZXBhcmF0ZSxcbiAgICBmaWx0ZXI6IF9maWx0ZXIsXG4gICAgZmlsdGVyTWFwOiBfZmlsdGVyTWFwLFxuICAgIHBhcnRpdGlvbjogX3BhcnRpdGlvbixcbiAgICBwYXJ0aXRpb25NYXA6IF9wYXJ0aXRpb25NYXAsXG4gICAgcGFydGl0aW9uTWFwV2l0aEluZGV4OiBfcGFydGl0aW9uTWFwV2l0aEluZGV4LFxuICAgIHBhcnRpdGlvbldpdGhJbmRleDogX3BhcnRpdGlvbldpdGhJbmRleCxcbiAgICBmaWx0ZXJNYXBXaXRoSW5kZXg6IF9maWx0ZXJNYXBXaXRoSW5kZXgsXG4gICAgZmlsdGVyV2l0aEluZGV4OiBfZmlsdGVyV2l0aEluZGV4XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi43LjBcbiAqL1xuZXhwb3J0IHZhciBGb2xkYWJsZSA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICByZWR1Y2U6IF9yZWR1Y2UsXG4gICAgZm9sZE1hcDogX2ZvbGRNYXAsXG4gICAgcmVkdWNlUmlnaHQ6IF9yZWR1Y2VSaWdodFxufTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuNy4wXG4gKi9cbmV4cG9ydCB2YXIgRm9sZGFibGVXaXRoSW5kZXggPSB7XG4gICAgVVJJOiBVUkksXG4gICAgcmVkdWNlOiBfcmVkdWNlLFxuICAgIGZvbGRNYXA6IF9mb2xkTWFwLFxuICAgIHJlZHVjZVJpZ2h0OiBfcmVkdWNlUmlnaHQsXG4gICAgcmVkdWNlV2l0aEluZGV4OiBfcmVkdWNlV2l0aEluZGV4LFxuICAgIGZvbGRNYXBXaXRoSW5kZXg6IF9mb2xkTWFwV2l0aEluZGV4LFxuICAgIHJlZHVjZVJpZ2h0V2l0aEluZGV4OiBfcmVkdWNlUmlnaHRXaXRoSW5kZXhcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjcuMFxuICovXG5leHBvcnQgdmFyIFRyYXZlcnNhYmxlID0ge1xuICAgIFVSSTogVVJJLFxuICAgIG1hcDogX21hcCxcbiAgICByZWR1Y2U6IF9yZWR1Y2UsXG4gICAgZm9sZE1hcDogX2ZvbGRNYXAsXG4gICAgcmVkdWNlUmlnaHQ6IF9yZWR1Y2VSaWdodCxcbiAgICB0cmF2ZXJzZTogX3RyYXZlcnNlLFxuICAgIHNlcXVlbmNlOiBzZXF1ZW5jZVxufTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuNy4wXG4gKi9cbmV4cG9ydCB2YXIgVHJhdmVyc2FibGVXaXRoSW5kZXggPSB7XG4gICAgVVJJOiBVUkksXG4gICAgbWFwOiBfbWFwLFxuICAgIG1hcFdpdGhJbmRleDogX21hcFdpdGhJbmRleCxcbiAgICByZWR1Y2U6IF9yZWR1Y2UsXG4gICAgZm9sZE1hcDogX2ZvbGRNYXAsXG4gICAgcmVkdWNlUmlnaHQ6IF9yZWR1Y2VSaWdodCxcbiAgICByZWR1Y2VXaXRoSW5kZXg6IF9yZWR1Y2VXaXRoSW5kZXgsXG4gICAgZm9sZE1hcFdpdGhJbmRleDogX2ZvbGRNYXBXaXRoSW5kZXgsXG4gICAgcmVkdWNlUmlnaHRXaXRoSW5kZXg6IF9yZWR1Y2VSaWdodFdpdGhJbmRleCxcbiAgICB0cmF2ZXJzZTogX3RyYXZlcnNlLFxuICAgIHNlcXVlbmNlOiBzZXF1ZW5jZSxcbiAgICB0cmF2ZXJzZVdpdGhJbmRleDogX3RyYXZlcnNlV2l0aEluZGV4XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgc2VxdWVuY2luZ1xuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIGNoYWluUmVjRGVwdGhGaXJzdCA9IGZ1bmN0aW9uIChmKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhKSB7XG4gICAgICAgIHZhciB0b2RvID0gX19zcHJlYWRBcnJheShbXSwgZihhKSwgdHJ1ZSk7XG4gICAgICAgIHZhciBvdXQgPSBbXTtcbiAgICAgICAgd2hpbGUgKHRvZG8ubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgdmFyIGUgPSB0b2RvLnNoaWZ0KCk7XG4gICAgICAgICAgICBpZiAoXy5pc0xlZnQoZSkpIHtcbiAgICAgICAgICAgICAgICB0b2RvLnVuc2hpZnQuYXBwbHkodG9kbywgZihlLmxlZnQpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIG91dC5wdXNoKGUucmlnaHQpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBvdXQ7XG4gICAgfTtcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjExLjBcbiAqL1xuZXhwb3J0IHZhciBDaGFpblJlY0RlcHRoRmlyc3QgPSB7XG4gICAgVVJJOiBVUkksXG4gICAgbWFwOiBfbWFwLFxuICAgIGFwOiBfYXAsXG4gICAgY2hhaW46IGZsYXRNYXAsXG4gICAgY2hhaW5SZWM6IF9jaGFpblJlY0RlcHRoRmlyc3Rcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBzZXF1ZW5jaW5nXG4gKiBAc2luY2UgMi4xMS4wXG4gKi9cbmV4cG9ydCB2YXIgY2hhaW5SZWNCcmVhZHRoRmlyc3QgPSBmdW5jdGlvbiAoZikge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYSkge1xuICAgICAgICB2YXIgaW5pdGlhbCA9IGYoYSk7XG4gICAgICAgIHZhciB0b2RvID0gW107XG4gICAgICAgIHZhciBvdXQgPSBbXTtcbiAgICAgICAgZnVuY3Rpb24gZ28oZSkge1xuICAgICAgICAgICAgaWYgKF8uaXNMZWZ0KGUpKSB7XG4gICAgICAgICAgICAgICAgZihlLmxlZnQpLmZvckVhY2goZnVuY3Rpb24gKHYpIHsgcmV0dXJuIHRvZG8ucHVzaCh2KTsgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBvdXQucHVzaChlLnJpZ2h0KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBmb3IgKHZhciBfaSA9IDAsIGluaXRpYWxfMSA9IGluaXRpYWw7IF9pIDwgaW5pdGlhbF8xLmxlbmd0aDsgX2krKykge1xuICAgICAgICAgICAgdmFyIGUgPSBpbml0aWFsXzFbX2ldO1xuICAgICAgICAgICAgZ28oZSk7XG4gICAgICAgIH1cbiAgICAgICAgd2hpbGUgKHRvZG8ubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgZ28odG9kby5zaGlmdCgpKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gb3V0O1xuICAgIH07XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi4xMS4wXG4gKi9cbmV4cG9ydCB2YXIgQ2hhaW5SZWNCcmVhZHRoRmlyc3QgPSB7XG4gICAgVVJJOiBVUkksXG4gICAgbWFwOiBfbWFwLFxuICAgIGFwOiBfYXAsXG4gICAgY2hhaW46IGZsYXRNYXAsXG4gICAgY2hhaW5SZWM6IF9jaGFpblJlY0JyZWFkdGhGaXJzdFxufTtcbnZhciBfd2l0aGVyID0gLyojX19QVVJFX18qLyB3aXRoZXJEZWZhdWx0KFRyYXZlcnNhYmxlLCBDb21wYWN0YWJsZSk7XG52YXIgX3dpbHQgPSAvKiNfX1BVUkVfXyovIHdpbHREZWZhdWx0KFRyYXZlcnNhYmxlLCBDb21wYWN0YWJsZSk7XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjcuMFxuICovXG5leHBvcnQgdmFyIFdpdGhlcmFibGUgPSB7XG4gICAgVVJJOiBVUkksXG4gICAgbWFwOiBfbWFwLFxuICAgIGNvbXBhY3Q6IGNvbXBhY3QsXG4gICAgc2VwYXJhdGU6IHNlcGFyYXRlLFxuICAgIGZpbHRlcjogX2ZpbHRlcixcbiAgICBmaWx0ZXJNYXA6IF9maWx0ZXJNYXAsXG4gICAgcGFydGl0aW9uOiBfcGFydGl0aW9uLFxuICAgIHBhcnRpdGlvbk1hcDogX3BhcnRpdGlvbk1hcCxcbiAgICByZWR1Y2U6IF9yZWR1Y2UsXG4gICAgZm9sZE1hcDogX2ZvbGRNYXAsXG4gICAgcmVkdWNlUmlnaHQ6IF9yZWR1Y2VSaWdodCxcbiAgICB0cmF2ZXJzZTogX3RyYXZlcnNlLFxuICAgIHNlcXVlbmNlOiBzZXF1ZW5jZSxcbiAgICB3aXRoZXI6IF93aXRoZXIsXG4gICAgd2lsdDogX3dpbHRcbn07XG4vKipcbiAqIEZpbHRlciB2YWx1ZXMgaW5zaWRlIGEgY29udGV4dC5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgcGlwZSB9IGZyb20gJ2ZwLXRzL2Z1bmN0aW9uJ1xuICogaW1wb3J0ICogYXMgUkEgZnJvbSAnZnAtdHMvUmVhZG9ubHlBcnJheSdcbiAqIGltcG9ydCAqIGFzIFQgZnJvbSAnZnAtdHMvVGFzaydcbiAqXG4gKiBjb25zdCBmaWx0ZXJFID0gUkEuZmlsdGVyRShULkFwcGxpY2F0aXZlUGFyKVxuICogYXN5bmMgZnVuY3Rpb24gdGVzdCgpIHtcbiAqICAgYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChcbiAqICAgICBhd2FpdCBwaXBlKFxuICogICAgICAgWy0xLCAyLCAzXSxcbiAqICAgICAgIGZpbHRlckUoKG4pID0+IFQub2YobiA+IDApKVxuICogICAgICkoKSxcbiAqICAgICBbMiwgM11cbiAqICAgKVxuICogfVxuICogdGVzdCgpXG4gKlxuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIGZpbHRlckUgPSAvKiNfX1BVUkVfXyovIGZpbHRlckVfKFdpdGhlcmFibGUpO1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi4xMS4wXG4gKi9cbmV4cG9ydCB2YXIgRnJvbUVpdGhlciA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICBmcm9tRWl0aGVyOiBmcm9tRWl0aGVyXG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgbGlmdGluZ1xuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIGZyb21FaXRoZXJLID0gLyojX19QVVJFX18qLyBmcm9tRWl0aGVyS18oRnJvbUVpdGhlcik7XG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vLyB1bnNhZmVcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8qKlxuICogQGNhdGVnb3J5IHVuc2FmZVxuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgdW5zYWZlSW5zZXJ0QXQgPSBSTkVBLnVuc2FmZUluc2VydEF0O1xuLyoqXG4gKiBAY2F0ZWdvcnkgdW5zYWZlXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciB1bnNhZmVVcGRhdGVBdCA9IGZ1bmN0aW9uIChpLCBhLCBhcykge1xuICAgIHJldHVybiBpc05vbkVtcHR5KGFzKSA/IFJORUEudW5zYWZlVXBkYXRlQXQoaSwgYSwgYXMpIDogYXM7XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgdW5zYWZlXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciB1bnNhZmVEZWxldGVBdCA9IGZ1bmN0aW9uIChpLCBhcykge1xuICAgIHZhciB4cyA9IGFzLnNsaWNlKCk7XG4gICAgeHMuc3BsaWNlKGksIDEpO1xuICAgIHJldHVybiB4cztcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBjb252ZXJzaW9uc1xuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgdG9BcnJheSA9IGZ1bmN0aW9uIChhcykgeyByZXR1cm4gYXMuc2xpY2UoKTsgfTtcbi8qKlxuICogQGNhdGVnb3J5IGNvbnZlcnNpb25zXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBmcm9tQXJyYXkgPSBmdW5jdGlvbiAoYXMpIHsgcmV0dXJuIChpc0VtcHR5KGFzKSA/IGVtcHR5IDogYXMuc2xpY2UoKSk7IH07XG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vLyB1dGlsc1xuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLyoqXG4gKiBBbiBlbXB0eSBhcnJheVxuICpcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIGVtcHR5ID0gUk5FQS5lbXB0eTtcbmV4cG9ydCBmdW5jdGlvbiBldmVyeShwcmVkaWNhdGUpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7IHJldHVybiBhcy5ldmVyeShwcmVkaWNhdGUpOyB9O1xufVxuLyoqXG4gKiBDaGVjayBpZiBhIHByZWRpY2F0ZSBob2xkcyB0cnVlIGZvciBhbnkgYXJyYXkgbWVtYmVyLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBzb21lIH0gZnJvbSAnZnAtdHMvUmVhZG9ubHlBcnJheSdcbiAqIGltcG9ydCB7IHBpcGUgfSBmcm9tICdmcC10cy9mdW5jdGlvbidcbiAqXG4gKiBjb25zdCBpc1Bvc2l0aXZlID0gKG46IG51bWJlcik6IGJvb2xlYW4gPT4gbiA+IDBcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKHBpcGUoWy0xLCAtMiwgM10sIHNvbWUoaXNQb3NpdGl2ZSkpLCB0cnVlKVxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChwaXBlKFstMSwgLTIsIC0zXSwgc29tZShpc1Bvc2l0aXZlKSksIGZhbHNlKVxuICpcbiAqIEBzaW5jZSAyLjkuMFxuICovXG5leHBvcnQgdmFyIHNvbWUgPSBmdW5jdGlvbiAocHJlZGljYXRlKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykge1xuICAgICAgICByZXR1cm4gYXMuc29tZShwcmVkaWNhdGUpO1xuICAgIH07XG59O1xuLyoqXG4gKiBBbGlhcyBvZiBbYHNvbWVgXSgjc29tZSlcbiAqXG4gKiBAc2luY2UgMi4xMS4wXG4gKi9cbmV4cG9ydCB2YXIgZXhpc3RzID0gc29tZTtcbi8qKlxuICogUGxhY2VzIGFuIGVsZW1lbnQgaW4gYmV0d2VlbiBtZW1iZXJzIG9mIGEgYFJlYWRvbmx5QXJyYXlgLCB0aGVuIGZvbGRzIHRoZSByZXN1bHRzIHVzaW5nIHRoZSBwcm92aWRlZCBgTW9ub2lkYC5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0ICogYXMgUyBmcm9tICdmcC10cy9zdHJpbmcnXG4gKiBpbXBvcnQgeyBpbnRlcmNhbGF0ZSB9IGZyb20gJ2ZwLXRzL1JlYWRvbmx5QXJyYXknXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChpbnRlcmNhbGF0ZShTLk1vbm9pZCkoJy0nKShbJ2EnLCAnYicsICdjJ10pLCAnYS1iLWMnKVxuICpcbiAqIEBzaW5jZSAyLjEyLjBcbiAqL1xuZXhwb3J0IHZhciBpbnRlcmNhbGF0ZSA9IGZ1bmN0aW9uIChNKSB7XG4gICAgdmFyIGludGVyY2FsYXRlTSA9IFJORUEuaW50ZXJjYWxhdGUoTSk7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChtaWRkbGUpIHsgcmV0dXJuIG1hdGNoKGZ1bmN0aW9uICgpIHsgcmV0dXJuIE0uZW1wdHk7IH0sIGludGVyY2FsYXRlTShtaWRkbGUpKTsgfTtcbn07XG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vLyBkbyBub3RhdGlvblxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLyoqXG4gKiBAY2F0ZWdvcnkgZG8gbm90YXRpb25cbiAqIEBzaW5jZSAyLjkuMFxuICovXG5leHBvcnQgdmFyIERvID0gLyojX19QVVJFX18qLyBvZihfLmVtcHR5UmVjb3JkKTtcbi8qKlxuICogQGNhdGVnb3J5IGRvIG5vdGF0aW9uXG4gKiBAc2luY2UgMi44LjBcbiAqL1xuZXhwb3J0IHZhciBiaW5kVG8gPSAvKiNfX1BVUkVfXyovIGJpbmRUb18oRnVuY3Rvcik7XG52YXIgbGV0XyA9IC8qI19fUFVSRV9fKi8gbGV0X18oRnVuY3Rvcik7XG5leHBvcnQgeyBcbi8qKlxuICogQGNhdGVnb3J5IGRvIG5vdGF0aW9uXG4gKiBAc2luY2UgMi4xMy4wXG4gKi9cbmxldF8gYXMgbGV0IH07XG4vKipcbiAqIEBjYXRlZ29yeSBkbyBub3RhdGlvblxuICogQHNpbmNlIDIuOC4wXG4gKi9cbmV4cG9ydCB2YXIgYmluZCA9IC8qI19fUFVSRV9fKi8gYmluZF8oQ2hhaW4pO1xuLyoqXG4gKiBAY2F0ZWdvcnkgZG8gbm90YXRpb25cbiAqIEBzaW5jZSAyLjguMFxuICovXG5leHBvcnQgdmFyIGFwUyA9IC8qI19fUFVSRV9fKi8gYXBTXyhBcHBseSk7XG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vLyBsZWdhY3lcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8qKlxuICogQWxpYXMgb2YgYGZsYXRNYXBgLlxuICpcbiAqIEBjYXRlZ29yeSBsZWdhY3lcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIGNoYWluID0gZmxhdE1hcDtcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8vIGRlcHJlY2F0ZWRcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8qKlxuICogVXNlIGBSZWFkb25seU5vbkVtcHR5QXJyYXlgIG1vZHVsZSBpbnN0ZWFkLlxuICpcbiAqIEBjYXRlZ29yeSB6b25lIG9mIGRlYXRoXG4gKiBAc2luY2UgMi41LjBcbiAqIEBkZXByZWNhdGVkXG4gKi9cbmV4cG9ydCB2YXIgcmFuZ2UgPSBSTkVBLnJhbmdlO1xuLyoqXG4gKiBVc2UgW2BwcmVwZW5kYF0oI3ByZXBlbmQpIGluc3RlYWQuXG4gKlxuICogQGNhdGVnb3J5IHpvbmUgb2YgZGVhdGhcbiAqIEBzaW5jZSAyLjUuMFxuICogQGRlcHJlY2F0ZWRcbiAqL1xuZXhwb3J0IHZhciBjb25zID0gUk5FQS5jb25zO1xuLyoqXG4gKiBVc2UgW2BhcHBlbmRgXSgjYXBwZW5kKSBpbnN0ZWFkLlxuICpcbiAqIEBjYXRlZ29yeSB6b25lIG9mIGRlYXRoXG4gKiBAc2luY2UgMi41LjBcbiAqIEBkZXByZWNhdGVkXG4gKi9cbmV4cG9ydCB2YXIgc25vYyA9IFJORUEuc25vYztcbi8qKlxuICogVXNlIFtgcHJlcGVuZEFsbGBdKCNwcmVwZW5kYWxsKSBpbnN0ZWFkLlxuICpcbiAqIEBjYXRlZ29yeSB6b25lIG9mIGRlYXRoXG4gKiBAc2luY2UgMi45LjBcbiAqIEBkZXByZWNhdGVkXG4gKi9cbmV4cG9ydCB2YXIgcHJlcGVuZFRvQWxsID0gcHJlcGVuZEFsbDtcbi8qKlxuICogVGhpcyBpbnN0YW5jZSBpcyBkZXByZWNhdGVkLCB1c2Ugc21hbGwsIHNwZWNpZmljIGluc3RhbmNlcyBpbnN0ZWFkLlxuICogRm9yIGV4YW1wbGUgaWYgYSBmdW5jdGlvbiBuZWVkcyBhIGBGdW5jdG9yYCBpbnN0YW5jZSwgcGFzcyBgUkEuRnVuY3RvcmAgaW5zdGVhZCBvZiBgUkEucmVhZG9ubHlBcnJheWBcbiAqICh3aGVyZSBgUkFgIGlzIGZyb20gYGltcG9ydCBSQSBmcm9tICdmcC10cy9SZWFkb25seUFycmF5J2ApXG4gKlxuICogQGNhdGVnb3J5IHpvbmUgb2YgZGVhdGhcbiAqIEBzaW5jZSAyLjUuMFxuICogQGRlcHJlY2F0ZWRcbiAqL1xuZXhwb3J0IHZhciByZWFkb25seUFycmF5ID0ge1xuICAgIFVSSTogVVJJLFxuICAgIGNvbXBhY3Q6IGNvbXBhY3QsXG4gICAgc2VwYXJhdGU6IHNlcGFyYXRlLFxuICAgIG1hcDogX21hcCxcbiAgICBhcDogX2FwLFxuICAgIG9mOiBvZixcbiAgICBjaGFpbjogZmxhdE1hcCxcbiAgICBmaWx0ZXI6IF9maWx0ZXIsXG4gICAgZmlsdGVyTWFwOiBfZmlsdGVyTWFwLFxuICAgIHBhcnRpdGlvbjogX3BhcnRpdGlvbixcbiAgICBwYXJ0aXRpb25NYXA6IF9wYXJ0aXRpb25NYXAsXG4gICAgbWFwV2l0aEluZGV4OiBfbWFwV2l0aEluZGV4LFxuICAgIHBhcnRpdGlvbk1hcFdpdGhJbmRleDogX3BhcnRpdGlvbk1hcFdpdGhJbmRleCxcbiAgICBwYXJ0aXRpb25XaXRoSW5kZXg6IF9wYXJ0aXRpb25XaXRoSW5kZXgsXG4gICAgZmlsdGVyTWFwV2l0aEluZGV4OiBfZmlsdGVyTWFwV2l0aEluZGV4LFxuICAgIGZpbHRlcldpdGhJbmRleDogX2ZpbHRlcldpdGhJbmRleCxcbiAgICBhbHQ6IF9hbHQsXG4gICAgemVybzogemVybyxcbiAgICB1bmZvbGQ6IHVuZm9sZCxcbiAgICByZWR1Y2U6IF9yZWR1Y2UsXG4gICAgZm9sZE1hcDogX2ZvbGRNYXAsXG4gICAgcmVkdWNlUmlnaHQ6IF9yZWR1Y2VSaWdodCxcbiAgICB0cmF2ZXJzZTogX3RyYXZlcnNlLFxuICAgIHNlcXVlbmNlOiBzZXF1ZW5jZSxcbiAgICByZWR1Y2VXaXRoSW5kZXg6IF9yZWR1Y2VXaXRoSW5kZXgsXG4gICAgZm9sZE1hcFdpdGhJbmRleDogX2ZvbGRNYXBXaXRoSW5kZXgsXG4gICAgcmVkdWNlUmlnaHRXaXRoSW5kZXg6IF9yZWR1Y2VSaWdodFdpdGhJbmRleCxcbiAgICB0cmF2ZXJzZVdpdGhJbmRleDogX3RyYXZlcnNlV2l0aEluZGV4LFxuICAgIGV4dGVuZDogX2V4dGVuZCxcbiAgICB3aXRoZXI6IF93aXRoZXIsXG4gICAgd2lsdDogX3dpbHRcbn07XG4iLAogICJ2YXIgX19zcHJlYWRBcnJheSA9ICh0aGlzICYmIHRoaXMuX19zcHJlYWRBcnJheSkgfHwgZnVuY3Rpb24gKHRvLCBmcm9tLCBwYWNrKSB7XG4gICAgaWYgKHBhY2sgfHwgYXJndW1lbnRzLmxlbmd0aCA9PT0gMikgZm9yICh2YXIgaSA9IDAsIGwgPSBmcm9tLmxlbmd0aCwgYXI7IGkgPCBsOyBpKyspIHtcbiAgICAgICAgaWYgKGFyIHx8ICEoaSBpbiBmcm9tKSkge1xuICAgICAgICAgICAgaWYgKCFhcikgYXIgPSBBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChmcm9tLCAwLCBpKTtcbiAgICAgICAgICAgIGFyW2ldID0gZnJvbVtpXTtcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gdG8uY29uY2F0KGFyIHx8IEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGZyb20pKTtcbn07XG5pbXBvcnQgeyBhcEZpcnN0IGFzIGFwRmlyc3RfLCBhcFMgYXMgYXBTXywgYXBTZWNvbmQgYXMgYXBTZWNvbmRfIH0gZnJvbSAnLi9BcHBseSc7XG5pbXBvcnQgeyBiaW5kIGFzIGJpbmRfLCBjaGFpbkZpcnN0IGFzIGNoYWluRmlyc3RfIH0gZnJvbSAnLi9DaGFpbic7XG5pbXBvcnQgeyBmcm9tRXF1YWxzIH0gZnJvbSAnLi9FcSc7XG5pbXBvcnQgeyBmcm9tRWl0aGVySyBhcyBmcm9tRWl0aGVyS18gfSBmcm9tICcuL0Zyb21FaXRoZXInO1xuaW1wb3J0IHsgZHVhbCwgaWRlbnRpdHksIHBpcGUgfSBmcm9tICcuL2Z1bmN0aW9uJztcbmltcG9ydCB7IGJpbmRUbyBhcyBiaW5kVG9fLCBmbGFwIGFzIGZsYXBfLCBsZXQgYXMgbGV0X18gfSBmcm9tICcuL0Z1bmN0b3InO1xuaW1wb3J0ICogYXMgXyBmcm9tICcuL2ludGVybmFsJztcbmltcG9ydCAqIGFzIE4gZnJvbSAnLi9udW1iZXInO1xuaW1wb3J0IHsgZnJvbUNvbXBhcmUgfSBmcm9tICcuL09yZCc7XG5pbXBvcnQgKiBhcyBSTkVBIGZyb20gJy4vUmVhZG9ubHlOb25FbXB0eUFycmF5JztcbmltcG9ydCB7IHNlcGFyYXRlZCB9IGZyb20gJy4vU2VwYXJhdGVkJztcbmltcG9ydCB7IGZpbHRlckUgYXMgZmlsdGVyRV8sIHdpbHREZWZhdWx0LCB3aXRoZXJEZWZhdWx0IH0gZnJvbSAnLi9XaXRoZXJhYmxlJztcbmltcG9ydCB7IGd1YXJkIGFzIGd1YXJkXyB9IGZyb20gJy4vWmVybyc7XG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vLyByZWZpbmVtZW50c1xuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLyoqXG4gKiBUZXN0IHdoZXRoZXIgYSBgUmVhZG9ubHlBcnJheWAgaXMgZW1wdHkuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IGlzRW1wdHkgfSBmcm9tICdmcC10cy9SZWFkb25seUFycmF5J1xuICpcbiAqIGFzc2VydC5zdHJpY3RFcXVhbChpc0VtcHR5KFtdKSwgdHJ1ZSlcbiAqXG4gKiBAY2F0ZWdvcnkgcmVmaW5lbWVudHNcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIGlzRW1wdHkgPSBmdW5jdGlvbiAoYXMpIHsgcmV0dXJuIGFzLmxlbmd0aCA9PT0gMDsgfTtcbi8qKlxuICogVGVzdCB3aGV0aGVyIGEgYFJlYWRvbmx5QXJyYXlgIGlzIG5vbiBlbXB0eS5cbiAqXG4gKiBAY2F0ZWdvcnkgcmVmaW5lbWVudHNcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIGlzTm9uRW1wdHkgPSBSTkVBLmlzTm9uRW1wdHk7XG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vLyBjb25zdHJ1Y3RvcnNcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8qKlxuICogUHJlcGVuZCBhbiBlbGVtZW50IHRvIHRoZSBmcm9udCBvZiBhIGBSZWFkb25seUFycmF5YCwgY3JlYXRpbmcgYSBuZXcgYFJlYWRvbmx5Tm9uRW1wdHlBcnJheWAuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IHByZXBlbmQgfSBmcm9tICdmcC10cy9SZWFkb25seUFycmF5J1xuICogaW1wb3J0IHsgcGlwZSB9IGZyb20gJ2ZwLXRzL2Z1bmN0aW9uJ1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwocGlwZShbMiwgMywgNF0sIHByZXBlbmQoMSkpLCBbMSwgMiwgMywgNF0pXG4gKlxuICogQHNpbmNlIDIuMTAuMFxuICovXG5leHBvcnQgdmFyIHByZXBlbmQgPSBSTkVBLnByZXBlbmQ7XG4vKipcbiAqIExlc3Mgc3RyaWN0IHZlcnNpb24gb2YgW2BwcmVwZW5kYF0oI3ByZXBlbmQpLlxuICpcbiAqIEBzaW5jZSAyLjExLjBcbiAqL1xuZXhwb3J0IHZhciBwcmVwZW5kVyA9IFJORUEucHJlcGVuZFc7XG4vKipcbiAqIEFwcGVuZCBhbiBlbGVtZW50IHRvIHRoZSBlbmQgb2YgYSBgUmVhZG9ubHlBcnJheWAsIGNyZWF0aW5nIGEgbmV3IGBSZWFkb25seU5vbkVtcHR5QXJyYXlgLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBhcHBlbmQgfSBmcm9tICdmcC10cy9SZWFkb25seUFycmF5J1xuICogaW1wb3J0IHsgcGlwZSB9IGZyb20gJ2ZwLXRzL2Z1bmN0aW9uJ1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwocGlwZShbMSwgMiwgM10sIGFwcGVuZCg0KSksIFsxLCAyLCAzLCA0XSlcbiAqXG4gKiBAc2luY2UgMi4xMC4wXG4gKi9cbmV4cG9ydCB2YXIgYXBwZW5kID0gUk5FQS5hcHBlbmQ7XG4vKipcbiAqIExlc3Mgc3RyaWN0IHZlcnNpb24gb2YgW2BhcHBlbmRgXSgjYXBwZW5kKS5cbiAqXG4gKiBAc2luY2UgMi4xMS4wXG4gKi9cbmV4cG9ydCB2YXIgYXBwZW5kVyA9IFJORUEuYXBwZW5kVztcbi8qKlxuICogUmV0dXJuIGEgYFJlYWRvbmx5QXJyYXlgIG9mIGxlbmd0aCBgbmAgd2l0aCBlbGVtZW50IGBpYCBpbml0aWFsaXplZCB3aXRoIGBmKGkpYC5cbiAqXG4gKiAqKk5vdGUqKi4gYG5gIGlzIG5vcm1hbGl6ZWQgdG8gYSBub24gbmVnYXRpdmUgaW50ZWdlci5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgbWFrZUJ5IH0gZnJvbSAnZnAtdHMvUmVhZG9ubHlBcnJheSdcbiAqXG4gKiBjb25zdCBkb3VibGUgPSAobjogbnVtYmVyKTogbnVtYmVyID0+IG4gKiAyXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKG1ha2VCeSg1LCBkb3VibGUpLCBbMCwgMiwgNCwgNiwgOF0pXG4gKlxuICogQGNhdGVnb3J5IGNvbnN0cnVjdG9yc1xuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgbWFrZUJ5ID0gZnVuY3Rpb24gKG4sIGYpIHsgcmV0dXJuIChuIDw9IDAgPyBlbXB0eSA6IFJORUEubWFrZUJ5KGYpKG4pKTsgfTtcbi8qKlxuICogQ3JlYXRlIGEgYFJlYWRvbmx5QXJyYXlgIGNvbnRhaW5pbmcgYSB2YWx1ZSByZXBlYXRlZCB0aGUgc3BlY2lmaWVkIG51bWJlciBvZiB0aW1lcy5cbiAqXG4gKiAqKk5vdGUqKi4gYG5gIGlzIG5vcm1hbGl6ZWQgdG8gYSBub24gbmVnYXRpdmUgaW50ZWdlci5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgcmVwbGljYXRlIH0gZnJvbSAnZnAtdHMvUmVhZG9ubHlBcnJheSdcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKHJlcGxpY2F0ZSgzLCAnYScpLCBbJ2EnLCAnYScsICdhJ10pXG4gKlxuICogQGNhdGVnb3J5IGNvbnN0cnVjdG9yc1xuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgcmVwbGljYXRlID0gZnVuY3Rpb24gKG4sIGEpIHsgcmV0dXJuIG1ha2VCeShuLCBmdW5jdGlvbiAoKSB7IHJldHVybiBhOyB9KTsgfTtcbmV4cG9ydCBmdW5jdGlvbiBmcm9tUHJlZGljYXRlKHByZWRpY2F0ZSkge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYSkgeyByZXR1cm4gKHByZWRpY2F0ZShhKSA/IFthXSA6IGVtcHR5KTsgfTtcbn1cbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8vIGNvbnZlcnNpb25zXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vKipcbiAqIEBjYXRlZ29yeSBjb252ZXJzaW9uc1xuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIGZyb21PcHRpb24gPSBmdW5jdGlvbiAobWEpIHsgcmV0dXJuIChfLmlzTm9uZShtYSkgPyBlbXB0eSA6IFttYS52YWx1ZV0pOyB9O1xuLyoqXG4gKiBUcmFuc2Zvcm1zIGFuIGBFaXRoZXJgIHRvIGEgYFJlYWRvbmx5QXJyYXlgLlxuICpcbiAqIEBjYXRlZ29yeSBjb252ZXJzaW9uc1xuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIGZyb21FaXRoZXIgPSBmdW5jdGlvbiAoZSkgeyByZXR1cm4gKF8uaXNMZWZ0KGUpID8gZW1wdHkgOiBbZS5yaWdodF0pOyB9O1xuLyoqXG4gKiBMZXNzIHN0cmljdCB2ZXJzaW9uIG9mIFtgbWF0Y2hgXSgjbWF0Y2gpLlxuICpcbiAqIFRoZSBgV2Agc3VmZml4IChzaG9ydCBmb3IgKipXKippZGVuaW5nKSBtZWFucyB0aGF0IHRoZSBoYW5kbGVyIHJldHVybiB0eXBlcyB3aWxsIGJlIG1lcmdlZC5cbiAqXG4gKiBAY2F0ZWdvcnkgcGF0dGVybiBtYXRjaGluZ1xuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIG1hdGNoVyA9IGZ1bmN0aW9uIChvbkVtcHR5LCBvbk5vbkVtcHR5KSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykge1xuICAgICAgICByZXR1cm4gaXNOb25FbXB0eShhcykgPyBvbk5vbkVtcHR5KGFzKSA6IG9uRW1wdHkoKTtcbiAgICB9O1xufTtcbi8qKlxuICogQGNhdGVnb3J5IHBhdHRlcm4gbWF0Y2hpbmdcbiAqIEBzaW5jZSAyLjExLjBcbiAqL1xuZXhwb3J0IHZhciBtYXRjaCA9IG1hdGNoVztcbi8qKlxuICogTGVzcyBzdHJpY3QgdmVyc2lvbiBvZiBbYG1hdGNoTGVmdGBdKCNtYXRjaGxlZnQpLlxuICpcbiAqIEBjYXRlZ29yeSBwYXR0ZXJuIG1hdGNoaW5nXG4gKiBAc2luY2UgMi4xMS4wXG4gKi9cbmV4cG9ydCB2YXIgbWF0Y2hMZWZ0VyA9IGZ1bmN0aW9uIChvbkVtcHR5LCBvbk5vbkVtcHR5KSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykge1xuICAgICAgICByZXR1cm4gaXNOb25FbXB0eShhcykgPyBvbk5vbkVtcHR5KFJORUEuaGVhZChhcyksIFJORUEudGFpbChhcykpIDogb25FbXB0eSgpO1xuICAgIH07XG59O1xuLyoqXG4gKiBCcmVhayBhIGBSZWFkb25seUFycmF5YCBpbnRvIGl0cyBmaXJzdCBlbGVtZW50IGFuZCByZW1haW5pbmcgZWxlbWVudHMuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IG1hdGNoTGVmdCB9IGZyb20gJ2ZwLXRzL1JlYWRvbmx5QXJyYXknXG4gKlxuICogY29uc3QgbGVuOiA8QT4oYXM6IFJlYWRvbmx5QXJyYXk8QT4pID0+IG51bWJlciA9IG1hdGNoTGVmdCgoKSA9PiAwLCAoXywgdGFpbCkgPT4gMSArIGxlbih0YWlsKSlcbiAqIGFzc2VydC5zdHJpY3RFcXVhbChsZW4oWzEsIDIsIDNdKSwgMylcbiAqXG4gKiBAY2F0ZWdvcnkgcGF0dGVybiBtYXRjaGluZ1xuICogQHNpbmNlIDIuMTAuMFxuICovXG5leHBvcnQgdmFyIG1hdGNoTGVmdCA9IG1hdGNoTGVmdFc7XG4vKipcbiAqIEFsaWFzIG9mIFtgbWF0Y2hMZWZ0YF0oI21hdGNobGVmdCkuXG4gKlxuICogQGNhdGVnb3J5IHBhdHRlcm4gbWF0Y2hpbmdcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIGZvbGRMZWZ0ID0gbWF0Y2hMZWZ0O1xuLyoqXG4gKiBMZXNzIHN0cmljdCB2ZXJzaW9uIG9mIFtgbWF0Y2hSaWdodGBdKCNtYXRjaHJpZ2h0KS5cbiAqXG4gKiBAY2F0ZWdvcnkgcGF0dGVybiBtYXRjaGluZ1xuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIG1hdGNoUmlnaHRXID0gZnVuY3Rpb24gKG9uRW1wdHksIG9uTm9uRW1wdHkpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIHJldHVybiBpc05vbkVtcHR5KGFzKSA/IG9uTm9uRW1wdHkoUk5FQS5pbml0KGFzKSwgUk5FQS5sYXN0KGFzKSkgOiBvbkVtcHR5KCk7XG4gICAgfTtcbn07XG4vKipcbiAqIEJyZWFrIGEgYFJlYWRvbmx5QXJyYXlgIGludG8gaXRzIGluaXRpYWwgZWxlbWVudHMgYW5kIHRoZSBsYXN0IGVsZW1lbnQuXG4gKlxuICogQGNhdGVnb3J5IHBhdHRlcm4gbWF0Y2hpbmdcbiAqIEBzaW5jZSAyLjEwLjBcbiAqL1xuZXhwb3J0IHZhciBtYXRjaFJpZ2h0ID0gbWF0Y2hSaWdodFc7XG4vKipcbiAqIEFsaWFzIG9mIFtgbWF0Y2hSaWdodGBdKCNtYXRjaHJpZ2h0KS5cbiAqXG4gKiBAY2F0ZWdvcnkgcGF0dGVybiBtYXRjaGluZ1xuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgZm9sZFJpZ2h0ID0gbWF0Y2hSaWdodDtcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8vIGNvbWJpbmF0b3JzXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vKipcbiAqIEBjYXRlZ29yeSBzZXF1ZW5jaW5nXG4gKiBAc2luY2UgMi43LjBcbiAqL1xuZXhwb3J0IHZhciBjaGFpbldpdGhJbmRleCA9IGZ1bmN0aW9uIChmKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykge1xuICAgICAgICBpZiAoaXNFbXB0eShhcykpIHtcbiAgICAgICAgICAgIHJldHVybiBlbXB0eTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgb3V0ID0gW107XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgYXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIG91dC5wdXNoLmFwcGx5KG91dCwgZihpLCBhc1tpXSkpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBvdXQ7XG4gICAgfTtcbn07XG4vKipcbiAqIFNhbWUgYXMgYHJlZHVjZWAgYnV0IGl0IGNhcnJpZXMgb3ZlciB0aGUgaW50ZXJtZWRpYXRlIHN0ZXBzLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBzY2FuTGVmdCB9IGZyb20gJ2ZwLXRzL1JlYWRvbmx5QXJyYXknXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChzY2FuTGVmdCgxMCwgKGIsIGE6IG51bWJlcikgPT4gYiAtIGEpKFsxLCAyLCAzXSksIFsxMCwgOSwgNywgNF0pXG4gKlxuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgc2NhbkxlZnQgPSBmdW5jdGlvbiAoYiwgZikge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgdmFyIGxlbiA9IGFzLmxlbmd0aDtcbiAgICAgICAgdmFyIG91dCA9IG5ldyBBcnJheShsZW4gKyAxKTtcbiAgICAgICAgb3V0WzBdID0gYjtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBsZW47IGkrKykge1xuICAgICAgICAgICAgb3V0W2kgKyAxXSA9IGYob3V0W2ldLCBhc1tpXSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG91dDtcbiAgICB9O1xufTtcbi8qKlxuICogRm9sZCBhbiBhcnJheSBmcm9tIHRoZSByaWdodCwga2VlcGluZyBhbGwgaW50ZXJtZWRpYXRlIHJlc3VsdHMgaW5zdGVhZCBvZiBvbmx5IHRoZSBmaW5hbCByZXN1bHRcbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgc2NhblJpZ2h0IH0gZnJvbSAnZnAtdHMvUmVhZG9ubHlBcnJheSdcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKHNjYW5SaWdodCgxMCwgKGE6IG51bWJlciwgYikgPT4gYiAtIGEpKFsxLCAyLCAzXSksIFs0LCA1LCA3LCAxMF0pXG4gKlxuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgc2NhblJpZ2h0ID0gZnVuY3Rpb24gKGIsIGYpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIHZhciBsZW4gPSBhcy5sZW5ndGg7XG4gICAgICAgIHZhciBvdXQgPSBuZXcgQXJyYXkobGVuICsgMSk7XG4gICAgICAgIG91dFtsZW5dID0gYjtcbiAgICAgICAgZm9yICh2YXIgaSA9IGxlbiAtIDE7IGkgPj0gMDsgaS0tKSB7XG4gICAgICAgICAgICBvdXRbaV0gPSBmKGFzW2ldLCBvdXRbaSArIDFdKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gb3V0O1xuICAgIH07XG59O1xuLyoqXG4gKiBDYWxjdWxhdGUgdGhlIG51bWJlciBvZiBlbGVtZW50cyBpbiBhIGBSZWFkb25seUFycmF5YC5cbiAqXG4gKiBAc2luY2UgMi4xMC4wXG4gKi9cbmV4cG9ydCB2YXIgc2l6ZSA9IGZ1bmN0aW9uIChhcykgeyByZXR1cm4gYXMubGVuZ3RoOyB9O1xuLyoqXG4gKiBUZXN0IHdoZXRoZXIgYW4gYXJyYXkgY29udGFpbnMgYSBwYXJ0aWN1bGFyIGluZGV4XG4gKlxuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgaXNPdXRPZkJvdW5kID0gUk5FQS5pc091dE9mQm91bmQ7XG5leHBvcnQgZnVuY3Rpb24gbG9va3VwKGksIGFzKSB7XG4gICAgcmV0dXJuIGFzID09PSB1bmRlZmluZWQgPyBmdW5jdGlvbiAoYXMpIHsgcmV0dXJuIGxvb2t1cChpLCBhcyk7IH0gOiBpc091dE9mQm91bmQoaSwgYXMpID8gXy5ub25lIDogXy5zb21lKGFzW2ldKTtcbn1cbi8qKlxuICogR2V0IHRoZSBmaXJzdCBlbGVtZW50IGluIGFuIGFycmF5LCBvciBgTm9uZWAgaWYgdGhlIGFycmF5IGlzIGVtcHR5XG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IGhlYWQgfSBmcm9tICdmcC10cy9SZWFkb25seUFycmF5J1xuICogaW1wb3J0IHsgc29tZSwgbm9uZSB9IGZyb20gJ2ZwLXRzL09wdGlvbidcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKGhlYWQoWzEsIDIsIDNdKSwgc29tZSgxKSlcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoaGVhZChbXSksIG5vbmUpXG4gKlxuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgaGVhZCA9IGZ1bmN0aW9uIChhcykgeyByZXR1cm4gKGlzTm9uRW1wdHkoYXMpID8gXy5zb21lKFJORUEuaGVhZChhcykpIDogXy5ub25lKTsgfTtcbi8qKlxuICogR2V0IHRoZSBsYXN0IGVsZW1lbnQgaW4gYW4gYXJyYXksIG9yIGBOb25lYCBpZiB0aGUgYXJyYXkgaXMgZW1wdHlcbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgbGFzdCB9IGZyb20gJ2ZwLXRzL1JlYWRvbmx5QXJyYXknXG4gKiBpbXBvcnQgeyBzb21lLCBub25lIH0gZnJvbSAnZnAtdHMvT3B0aW9uJ1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwobGFzdChbMSwgMiwgM10pLCBzb21lKDMpKVxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChsYXN0KFtdKSwgbm9uZSlcbiAqXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBsYXN0ID0gZnVuY3Rpb24gKGFzKSB7IHJldHVybiAoaXNOb25FbXB0eShhcykgPyBfLnNvbWUoUk5FQS5sYXN0KGFzKSkgOiBfLm5vbmUpOyB9O1xuLyoqXG4gKiBHZXQgYWxsIGJ1dCB0aGUgZmlyc3QgZWxlbWVudCBvZiBhbiBhcnJheSwgY3JlYXRpbmcgYSBuZXcgYXJyYXksIG9yIGBOb25lYCBpZiB0aGUgYXJyYXkgaXMgZW1wdHlcbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgdGFpbCB9IGZyb20gJ2ZwLXRzL1JlYWRvbmx5QXJyYXknXG4gKiBpbXBvcnQgeyBzb21lLCBub25lIH0gZnJvbSAnZnAtdHMvT3B0aW9uJ1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwodGFpbChbMSwgMiwgM10pLCBzb21lKFsyLCAzXSkpXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKHRhaWwoW10pLCBub25lKVxuICpcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIHRhaWwgPSBmdW5jdGlvbiAoYXMpIHtcbiAgICByZXR1cm4gaXNOb25FbXB0eShhcykgPyBfLnNvbWUoUk5FQS50YWlsKGFzKSkgOiBfLm5vbmU7XG59O1xuLyoqXG4gKiBHZXQgYWxsIGJ1dCB0aGUgbGFzdCBlbGVtZW50IG9mIGFuIGFycmF5LCBjcmVhdGluZyBhIG5ldyBhcnJheSwgb3IgYE5vbmVgIGlmIHRoZSBhcnJheSBpcyBlbXB0eVxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBpbml0IH0gZnJvbSAnZnAtdHMvUmVhZG9ubHlBcnJheSdcbiAqIGltcG9ydCB7IHNvbWUsIG5vbmUgfSBmcm9tICdmcC10cy9PcHRpb24nXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChpbml0KFsxLCAyLCAzXSksIHNvbWUoWzEsIDJdKSlcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoaW5pdChbXSksIG5vbmUpXG4gKlxuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgaW5pdCA9IGZ1bmN0aW9uIChhcykge1xuICAgIHJldHVybiBpc05vbkVtcHR5KGFzKSA/IF8uc29tZShSTkVBLmluaXQoYXMpKSA6IF8ubm9uZTtcbn07XG4vKipcbiAqIEtlZXAgb25seSBhIG1heCBudW1iZXIgb2YgZWxlbWVudHMgZnJvbSB0aGUgc3RhcnQgb2YgYW4gYFJlYWRvbmx5QXJyYXlgLCBjcmVhdGluZyBhIG5ldyBgUmVhZG9ubHlBcnJheWAuXG4gKlxuICogKipOb3RlKiouIGBuYCBpcyBub3JtYWxpemVkIHRvIGEgbm9uIG5lZ2F0aXZlIGludGVnZXIuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCAqIGFzIFJBIGZyb20gJ2ZwLXRzL1JlYWRvbmx5QXJyYXknXG4gKiBpbXBvcnQgeyBwaXBlIH0gZnJvbSAnZnAtdHMvZnVuY3Rpb24nXG4gKlxuICogY29uc3QgaW5wdXQ6IFJlYWRvbmx5QXJyYXk8bnVtYmVyPiA9IFsxLCAyLCAzXVxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChwaXBlKGlucHV0LCBSQS50YWtlTGVmdCgyKSksIFsxLCAyXSlcbiAqXG4gKiAvLyBvdXQgb2YgYm91bmRzXG4gKiBhc3NlcnQuc3RyaWN0RXF1YWwocGlwZShpbnB1dCwgUkEudGFrZUxlZnQoNCkpLCBpbnB1dClcbiAqIGFzc2VydC5zdHJpY3RFcXVhbChwaXBlKGlucHV0LCBSQS50YWtlTGVmdCgtMSkpLCBpbnB1dClcbiAqXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciB0YWtlTGVmdCA9IGZ1bmN0aW9uIChuKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykge1xuICAgICAgICByZXR1cm4gaXNPdXRPZkJvdW5kKG4sIGFzKSA/IGFzIDogbiA9PT0gMCA/IGVtcHR5IDogYXMuc2xpY2UoMCwgbik7XG4gICAgfTtcbn07XG4vKipcbiAqIEtlZXAgb25seSBhIG1heCBudW1iZXIgb2YgZWxlbWVudHMgZnJvbSB0aGUgZW5kIG9mIGFuIGBSZWFkb25seUFycmF5YCwgY3JlYXRpbmcgYSBuZXcgYFJlYWRvbmx5QXJyYXlgLlxuICpcbiAqICoqTm90ZSoqLiBgbmAgaXMgbm9ybWFsaXplZCB0byBhIG5vbiBuZWdhdGl2ZSBpbnRlZ2VyLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgKiBhcyBSQSBmcm9tICdmcC10cy9SZWFkb25seUFycmF5J1xuICogaW1wb3J0IHsgcGlwZSB9IGZyb20gJ2ZwLXRzL2Z1bmN0aW9uJ1xuICpcbiAqIGNvbnN0IGlucHV0OiBSZWFkb25seUFycmF5PG51bWJlcj4gPSBbMSwgMiwgM11cbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwocGlwZShpbnB1dCwgUkEudGFrZVJpZ2h0KDIpKSwgWzIsIDNdKVxuICpcbiAqIC8vIG91dCBvZiBib3VuZHNcbiAqIGFzc2VydC5zdHJpY3RFcXVhbChwaXBlKGlucHV0LCBSQS50YWtlUmlnaHQoNCkpLCBpbnB1dClcbiAqIGFzc2VydC5zdHJpY3RFcXVhbChwaXBlKGlucHV0LCBSQS50YWtlUmlnaHQoLTEpKSwgaW5wdXQpXG4gKlxuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgdGFrZVJpZ2h0ID0gZnVuY3Rpb24gKG4pIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIHJldHVybiBpc091dE9mQm91bmQobiwgYXMpID8gYXMgOiBuID09PSAwID8gZW1wdHkgOiBhcy5zbGljZSgtbik7XG4gICAgfTtcbn07XG5leHBvcnQgZnVuY3Rpb24gdGFrZUxlZnRXaGlsZShwcmVkaWNhdGUpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIHZhciBvdXQgPSBbXTtcbiAgICAgICAgZm9yICh2YXIgX2kgPSAwLCBhc18xID0gYXM7IF9pIDwgYXNfMS5sZW5ndGg7IF9pKyspIHtcbiAgICAgICAgICAgIHZhciBhID0gYXNfMVtfaV07XG4gICAgICAgICAgICBpZiAoIXByZWRpY2F0ZShhKSkge1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgb3V0LnB1c2goYSk7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGxlbiA9IG91dC5sZW5ndGg7XG4gICAgICAgIHJldHVybiBsZW4gPT09IGFzLmxlbmd0aCA/IGFzIDogbGVuID09PSAwID8gZW1wdHkgOiBvdXQ7XG4gICAgfTtcbn1cbnZhciBzcGFuTGVmdEluZGV4ID0gZnVuY3Rpb24gKGFzLCBwcmVkaWNhdGUpIHtcbiAgICB2YXIgbCA9IGFzLmxlbmd0aDtcbiAgICB2YXIgaSA9IDA7XG4gICAgZm9yICg7IGkgPCBsOyBpKyspIHtcbiAgICAgICAgaWYgKCFwcmVkaWNhdGUoYXNbaV0pKSB7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gaTtcbn07XG5leHBvcnQgZnVuY3Rpb24gc3BhbkxlZnQocHJlZGljYXRlKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykge1xuICAgICAgICB2YXIgX2EgPSBzcGxpdEF0KHNwYW5MZWZ0SW5kZXgoYXMsIHByZWRpY2F0ZSkpKGFzKSwgaW5pdCA9IF9hWzBdLCByZXN0ID0gX2FbMV07XG4gICAgICAgIHJldHVybiB7IGluaXQ6IGluaXQsIHJlc3Q6IHJlc3QgfTtcbiAgICB9O1xufVxuLyoqXG4gKiBEcm9wIGEgbWF4IG51bWJlciBvZiBlbGVtZW50cyBmcm9tIHRoZSBzdGFydCBvZiBhbiBgUmVhZG9ubHlBcnJheWAsIGNyZWF0aW5nIGEgbmV3IGBSZWFkb25seUFycmF5YC5cbiAqXG4gKiAqKk5vdGUqKi4gYG5gIGlzIG5vcm1hbGl6ZWQgdG8gYSBub24gbmVnYXRpdmUgaW50ZWdlci5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0ICogYXMgUkEgZnJvbSAnZnAtdHMvUmVhZG9ubHlBcnJheSdcbiAqIGltcG9ydCB7IHBpcGUgfSBmcm9tICdmcC10cy9mdW5jdGlvbidcbiAqXG4gKiBjb25zdCBpbnB1dDogUmVhZG9ubHlBcnJheTxudW1iZXI+ID0gWzEsIDIsIDNdXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKHBpcGUoaW5wdXQsIFJBLmRyb3BMZWZ0KDIpKSwgWzNdKVxuICogYXNzZXJ0LnN0cmljdEVxdWFsKHBpcGUoaW5wdXQsIFJBLmRyb3BMZWZ0KDApKSwgaW5wdXQpXG4gKiBhc3NlcnQuc3RyaWN0RXF1YWwocGlwZShpbnB1dCwgUkEuZHJvcExlZnQoLTEpKSwgaW5wdXQpXG4gKlxuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgZHJvcExlZnQgPSBmdW5jdGlvbiAobikge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgcmV0dXJuIG4gPD0gMCB8fCBpc0VtcHR5KGFzKSA/IGFzIDogbiA+PSBhcy5sZW5ndGggPyBlbXB0eSA6IGFzLnNsaWNlKG4sIGFzLmxlbmd0aCk7XG4gICAgfTtcbn07XG4vKipcbiAqIERyb3AgYSBtYXggbnVtYmVyIG9mIGVsZW1lbnRzIGZyb20gdGhlIGVuZCBvZiBhbiBgUmVhZG9ubHlBcnJheWAsIGNyZWF0aW5nIGEgbmV3IGBSZWFkb25seUFycmF5YC5cbiAqXG4gKiAqKk5vdGUqKi4gYG5gIGlzIG5vcm1hbGl6ZWQgdG8gYSBub24gbmVnYXRpdmUgaW50ZWdlci5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0ICogYXMgUkEgZnJvbSAnZnAtdHMvUmVhZG9ubHlBcnJheSdcbiAqIGltcG9ydCB7IHBpcGUgfSBmcm9tICdmcC10cy9mdW5jdGlvbidcbiAqXG4gKiBjb25zdCBpbnB1dDogUmVhZG9ubHlBcnJheTxudW1iZXI+ID0gWzEsIDIsIDNdXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKHBpcGUoaW5wdXQsIFJBLmRyb3BSaWdodCgyKSksIFsxXSlcbiAqIGFzc2VydC5zdHJpY3RFcXVhbChwaXBlKGlucHV0LCBSQS5kcm9wUmlnaHQoMCkpLCBpbnB1dClcbiAqIGFzc2VydC5zdHJpY3RFcXVhbChwaXBlKGlucHV0LCBSQS5kcm9wUmlnaHQoLTEpKSwgaW5wdXQpXG4gKlxuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgZHJvcFJpZ2h0ID0gZnVuY3Rpb24gKG4pIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIHJldHVybiBuIDw9IDAgfHwgaXNFbXB0eShhcykgPyBhcyA6IG4gPj0gYXMubGVuZ3RoID8gZW1wdHkgOiBhcy5zbGljZSgwLCBhcy5sZW5ndGggLSBuKTtcbiAgICB9O1xufTtcbmV4cG9ydCBmdW5jdGlvbiBkcm9wTGVmdFdoaWxlKHByZWRpY2F0ZSkge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgdmFyIGkgPSBzcGFuTGVmdEluZGV4KGFzLCBwcmVkaWNhdGUpO1xuICAgICAgICByZXR1cm4gaSA9PT0gMCA/IGFzIDogaSA9PT0gYXMubGVuZ3RoID8gZW1wdHkgOiBhcy5zbGljZShpKTtcbiAgICB9O1xufVxuLyoqXG4gKiBGaW5kIHRoZSBmaXJzdCBpbmRleCBmb3Igd2hpY2ggYSBwcmVkaWNhdGUgaG9sZHNcbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgZmluZEluZGV4IH0gZnJvbSAnZnAtdHMvUmVhZG9ubHlBcnJheSdcbiAqIGltcG9ydCB7IHNvbWUsIG5vbmUgfSBmcm9tICdmcC10cy9PcHRpb24nXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChmaW5kSW5kZXgoKG46IG51bWJlcikgPT4gbiA9PT0gMikoWzEsIDIsIDNdKSwgc29tZSgxKSlcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoZmluZEluZGV4KChuOiBudW1iZXIpID0+IG4gPT09IDIpKFtdKSwgbm9uZSlcbiAqXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBmaW5kSW5kZXggPSBmdW5jdGlvbiAocHJlZGljYXRlKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykge1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGFzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICBpZiAocHJlZGljYXRlKGFzW2ldKSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBfLnNvbWUoaSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIF8ubm9uZTtcbiAgICB9O1xufTtcbmV4cG9ydCBmdW5jdGlvbiBmaW5kRmlyc3QocHJlZGljYXRlKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykge1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGFzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICBpZiAocHJlZGljYXRlKGFzW2ldKSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBfLnNvbWUoYXNbaV0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBfLm5vbmU7XG4gICAgfTtcbn1cbi8qKlxuICogRmluZCB0aGUgZmlyc3QgZWxlbWVudCByZXR1cm5lZCBieSBhbiBvcHRpb24gYmFzZWQgc2VsZWN0b3IgZnVuY3Rpb25cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgZmluZEZpcnN0TWFwIH0gZnJvbSAnZnAtdHMvUmVhZG9ubHlBcnJheSdcbiAqIGltcG9ydCB7IHNvbWUsIG5vbmUgfSBmcm9tICdmcC10cy9PcHRpb24nXG4gKlxuICogaW50ZXJmYWNlIFBlcnNvbiB7XG4gKiAgIHJlYWRvbmx5IG5hbWU6IHN0cmluZ1xuICogICByZWFkb25seSBhZ2U/OiBudW1iZXJcbiAqIH1cbiAqXG4gKiBjb25zdCBwZXJzb25zOiBSZWFkb25seUFycmF5PFBlcnNvbj4gPSBbeyBuYW1lOiAnSm9obicgfSwgeyBuYW1lOiAnTWFyeScsIGFnZTogNDUgfSwgeyBuYW1lOiAnSm9leScsIGFnZTogMjggfV1cbiAqXG4gKiAvLyByZXR1cm5zIHRoZSBuYW1lIG9mIHRoZSBmaXJzdCBwZXJzb24gdGhhdCBoYXMgYW4gYWdlXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKGZpbmRGaXJzdE1hcCgocDogUGVyc29uKSA9PiAocC5hZ2UgPT09IHVuZGVmaW5lZCA/IG5vbmUgOiBzb21lKHAubmFtZSkpKShwZXJzb25zKSwgc29tZSgnTWFyeScpKVxuICpcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIGZpbmRGaXJzdE1hcCA9IGZ1bmN0aW9uIChmKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykge1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGFzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICB2YXIgb3V0ID0gZihhc1tpXSk7XG4gICAgICAgICAgICBpZiAoXy5pc1NvbWUob3V0KSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBvdXQ7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIF8ubm9uZTtcbiAgICB9O1xufTtcbmV4cG9ydCBmdW5jdGlvbiBmaW5kTGFzdChwcmVkaWNhdGUpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIGZvciAodmFyIGkgPSBhcy5sZW5ndGggLSAxOyBpID49IDA7IGktLSkge1xuICAgICAgICAgICAgaWYgKHByZWRpY2F0ZShhc1tpXSkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gXy5zb21lKGFzW2ldKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gXy5ub25lO1xuICAgIH07XG59XG4vKipcbiAqIEZpbmQgdGhlIGxhc3QgZWxlbWVudCByZXR1cm5lZCBieSBhbiBvcHRpb24gYmFzZWQgc2VsZWN0b3IgZnVuY3Rpb25cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgZmluZExhc3RNYXAgfSBmcm9tICdmcC10cy9SZWFkb25seUFycmF5J1xuICogaW1wb3J0IHsgc29tZSwgbm9uZSB9IGZyb20gJ2ZwLXRzL09wdGlvbidcbiAqXG4gKiBpbnRlcmZhY2UgUGVyc29uIHtcbiAqICAgcmVhZG9ubHkgbmFtZTogc3RyaW5nXG4gKiAgIHJlYWRvbmx5IGFnZT86IG51bWJlclxuICogfVxuICpcbiAqIGNvbnN0IHBlcnNvbnM6IFJlYWRvbmx5QXJyYXk8UGVyc29uPiA9IFt7IG5hbWU6ICdKb2huJyB9LCB7IG5hbWU6ICdNYXJ5JywgYWdlOiA0NSB9LCB7IG5hbWU6ICdKb2V5JywgYWdlOiAyOCB9XVxuICpcbiAqIC8vIHJldHVybnMgdGhlIG5hbWUgb2YgdGhlIGxhc3QgcGVyc29uIHRoYXQgaGFzIGFuIGFnZVxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChmaW5kTGFzdE1hcCgocDogUGVyc29uKSA9PiAocC5hZ2UgPT09IHVuZGVmaW5lZCA/IG5vbmUgOiBzb21lKHAubmFtZSkpKShwZXJzb25zKSwgc29tZSgnSm9leScpKVxuICpcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIGZpbmRMYXN0TWFwID0gZnVuY3Rpb24gKGYpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIGZvciAodmFyIGkgPSBhcy5sZW5ndGggLSAxOyBpID49IDA7IGktLSkge1xuICAgICAgICAgICAgdmFyIG91dCA9IGYoYXNbaV0pO1xuICAgICAgICAgICAgaWYgKF8uaXNTb21lKG91dCkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gb3V0O1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBfLm5vbmU7XG4gICAgfTtcbn07XG4vKipcbiAqIFJldHVybnMgdGhlIGluZGV4IG9mIHRoZSBsYXN0IGVsZW1lbnQgb2YgdGhlIGxpc3Qgd2hpY2ggbWF0Y2hlcyB0aGUgcHJlZGljYXRlXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IGZpbmRMYXN0SW5kZXggfSBmcm9tICdmcC10cy9SZWFkb25seUFycmF5J1xuICogaW1wb3J0IHsgc29tZSwgbm9uZSB9IGZyb20gJ2ZwLXRzL09wdGlvbidcbiAqXG4gKiBpbnRlcmZhY2UgWCB7XG4gKiAgIHJlYWRvbmx5IGE6IG51bWJlclxuICogICByZWFkb25seSBiOiBudW1iZXJcbiAqIH1cbiAqIGNvbnN0IHhzOiBSZWFkb25seUFycmF5PFg+ID0gW3sgYTogMSwgYjogMCB9LCB7IGE6IDEsIGI6IDEgfV1cbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoZmluZExhc3RJbmRleCgoeDogeyByZWFkb25seSBhOiBudW1iZXIgfSkgPT4geC5hID09PSAxKSh4cyksIHNvbWUoMSkpXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKGZpbmRMYXN0SW5kZXgoKHg6IHsgcmVhZG9ubHkgYTogbnVtYmVyIH0pID0+IHguYSA9PT0gNCkoeHMpLCBub25lKVxuICpcbiAqXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBmaW5kTGFzdEluZGV4ID0gZnVuY3Rpb24gKHByZWRpY2F0ZSkge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgZm9yICh2YXIgaSA9IGFzLmxlbmd0aCAtIDE7IGkgPj0gMDsgaS0tKSB7XG4gICAgICAgICAgICBpZiAocHJlZGljYXRlKGFzW2ldKSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBfLnNvbWUoaSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIF8ubm9uZTtcbiAgICB9O1xufTtcbi8qKlxuICogSW5zZXJ0IGFuIGVsZW1lbnQgYXQgdGhlIHNwZWNpZmllZCBpbmRleCwgY3JlYXRpbmcgYSBuZXcgYXJyYXksIG9yIHJldHVybmluZyBgTm9uZWAgaWYgdGhlIGluZGV4IGlzIG91dCBvZiBib3VuZHNcbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgaW5zZXJ0QXQgfSBmcm9tICdmcC10cy9SZWFkb25seUFycmF5J1xuICogaW1wb3J0IHsgc29tZSB9IGZyb20gJ2ZwLXRzL09wdGlvbidcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKGluc2VydEF0KDIsIDUpKFsxLCAyLCAzLCA0XSksIHNvbWUoWzEsIDIsIDUsIDMsIDRdKSlcbiAqXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBpbnNlcnRBdCA9IGZ1bmN0aW9uIChpLCBhKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykge1xuICAgICAgICByZXR1cm4gaSA8IDAgfHwgaSA+IGFzLmxlbmd0aCA/IF8ubm9uZSA6IF8uc29tZShSTkVBLnVuc2FmZUluc2VydEF0KGksIGEsIGFzKSk7XG4gICAgfTtcbn07XG4vKipcbiAqIENoYW5nZSB0aGUgZWxlbWVudCBhdCB0aGUgc3BlY2lmaWVkIGluZGV4LCBjcmVhdGluZyBhIG5ldyBhcnJheSwgb3IgcmV0dXJuaW5nIGBOb25lYCBpZiB0aGUgaW5kZXggaXMgb3V0IG9mIGJvdW5kc1xuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyB1cGRhdGVBdCB9IGZyb20gJ2ZwLXRzL1JlYWRvbmx5QXJyYXknXG4gKiBpbXBvcnQgeyBzb21lLCBub25lIH0gZnJvbSAnZnAtdHMvT3B0aW9uJ1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwodXBkYXRlQXQoMSwgMSkoWzEsIDIsIDNdKSwgc29tZShbMSwgMSwgM10pKVxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbCh1cGRhdGVBdCgxLCAxKShbXSksIG5vbmUpXG4gKlxuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgdXBkYXRlQXQgPSBmdW5jdGlvbiAoaSwgYSkge1xuICAgIHJldHVybiBtb2RpZnlBdChpLCBmdW5jdGlvbiAoKSB7IHJldHVybiBhOyB9KTtcbn07XG4vKipcbiAqIERlbGV0ZSB0aGUgZWxlbWVudCBhdCB0aGUgc3BlY2lmaWVkIGluZGV4LCBjcmVhdGluZyBhIG5ldyBhcnJheSwgb3IgcmV0dXJuaW5nIGBOb25lYCBpZiB0aGUgaW5kZXggaXMgb3V0IG9mIGJvdW5kc1xuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBkZWxldGVBdCB9IGZyb20gJ2ZwLXRzL1JlYWRvbmx5QXJyYXknXG4gKiBpbXBvcnQgeyBzb21lLCBub25lIH0gZnJvbSAnZnAtdHMvT3B0aW9uJ1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoZGVsZXRlQXQoMCkoWzEsIDIsIDNdKSwgc29tZShbMiwgM10pKVxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChkZWxldGVBdCgxKShbXSksIG5vbmUpXG4gKlxuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgZGVsZXRlQXQgPSBmdW5jdGlvbiAoaSkge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgcmV0dXJuIGlzT3V0T2ZCb3VuZChpLCBhcykgPyBfLm5vbmUgOiBfLnNvbWUodW5zYWZlRGVsZXRlQXQoaSwgYXMpKTtcbiAgICB9O1xufTtcbi8qKlxuICogQXBwbHkgYSBmdW5jdGlvbiB0byB0aGUgZWxlbWVudCBhdCB0aGUgc3BlY2lmaWVkIGluZGV4LCBjcmVhdGluZyBhIG5ldyBhcnJheSwgb3IgcmV0dXJuaW5nIGBOb25lYCBpZiB0aGUgaW5kZXggaXMgb3V0XG4gKiBvZiBib3VuZHNcbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgbW9kaWZ5QXQgfSBmcm9tICdmcC10cy9SZWFkb25seUFycmF5J1xuICogaW1wb3J0IHsgc29tZSwgbm9uZSB9IGZyb20gJ2ZwLXRzL09wdGlvbidcbiAqXG4gKiBjb25zdCBkb3VibGUgPSAoeDogbnVtYmVyKTogbnVtYmVyID0+IHggKiAyXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKG1vZGlmeUF0KDEsIGRvdWJsZSkoWzEsIDIsIDNdKSwgc29tZShbMSwgNCwgM10pKVxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChtb2RpZnlBdCgxLCBkb3VibGUpKFtdKSwgbm9uZSlcbiAqXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBtb2RpZnlBdCA9IGZ1bmN0aW9uIChpLCBmKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykge1xuICAgICAgICByZXR1cm4gaXNPdXRPZkJvdW5kKGksIGFzKSA/IF8ubm9uZSA6IF8uc29tZSh1bnNhZmVVcGRhdGVBdChpLCBmKGFzW2ldKSwgYXMpKTtcbiAgICB9O1xufTtcbi8qKlxuICogUmV2ZXJzZSBhbiBhcnJheSwgY3JlYXRpbmcgYSBuZXcgYXJyYXlcbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgcmV2ZXJzZSB9IGZyb20gJ2ZwLXRzL1JlYWRvbmx5QXJyYXknXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChyZXZlcnNlKFsxLCAyLCAzXSksIFszLCAyLCAxXSlcbiAqXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciByZXZlcnNlID0gZnVuY3Rpb24gKGFzKSB7IHJldHVybiAoYXMubGVuZ3RoIDw9IDEgPyBhcyA6IGFzLnNsaWNlKCkucmV2ZXJzZSgpKTsgfTtcbi8qKlxuICogRXh0cmFjdHMgZnJvbSBhbiBhcnJheSBvZiBgRWl0aGVyYCBhbGwgdGhlIGBSaWdodGAgZWxlbWVudHMuIEFsbCB0aGUgYFJpZ2h0YCBlbGVtZW50cyBhcmUgZXh0cmFjdGVkIGluIG9yZGVyXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IHJpZ2h0cyB9IGZyb20gJ2ZwLXRzL1JlYWRvbmx5QXJyYXknXG4gKiBpbXBvcnQgeyByaWdodCwgbGVmdCB9IGZyb20gJ2ZwLXRzL0VpdGhlcidcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKHJpZ2h0cyhbcmlnaHQoMSksIGxlZnQoJ2ZvbycpLCByaWdodCgyKV0pLCBbMSwgMl0pXG4gKlxuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgcmlnaHRzID0gZnVuY3Rpb24gKGFzKSB7XG4gICAgdmFyIHIgPSBbXTtcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IGFzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIHZhciBhID0gYXNbaV07XG4gICAgICAgIGlmIChhLl90YWcgPT09ICdSaWdodCcpIHtcbiAgICAgICAgICAgIHIucHVzaChhLnJpZ2h0KTtcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gcjtcbn07XG4vKipcbiAqIEV4dHJhY3RzIGZyb20gYW4gYXJyYXkgb2YgYEVpdGhlcmAgYWxsIHRoZSBgTGVmdGAgZWxlbWVudHMuIEFsbCB0aGUgYExlZnRgIGVsZW1lbnRzIGFyZSBleHRyYWN0ZWQgaW4gb3JkZXJcbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgbGVmdHMgfSBmcm9tICdmcC10cy9SZWFkb25seUFycmF5J1xuICogaW1wb3J0IHsgbGVmdCwgcmlnaHQgfSBmcm9tICdmcC10cy9FaXRoZXInXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChsZWZ0cyhbcmlnaHQoMSksIGxlZnQoJ2ZvbycpLCByaWdodCgyKV0pLCBbJ2ZvbyddKVxuICpcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIGxlZnRzID0gZnVuY3Rpb24gKGFzKSB7XG4gICAgdmFyIHIgPSBbXTtcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IGFzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIHZhciBhID0gYXNbaV07XG4gICAgICAgIGlmIChhLl90YWcgPT09ICdMZWZ0Jykge1xuICAgICAgICAgICAgci5wdXNoKGEubGVmdCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHI7XG59O1xuLyoqXG4gKiBTb3J0IHRoZSBlbGVtZW50cyBvZiBhbiBhcnJheSBpbiBpbmNyZWFzaW5nIG9yZGVyLCBjcmVhdGluZyBhIG5ldyBhcnJheVxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBzb3J0IH0gZnJvbSAnZnAtdHMvUmVhZG9ubHlBcnJheSdcbiAqIGltcG9ydCAqIGFzIE4gZnJvbSAnZnAtdHMvbnVtYmVyJ1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoc29ydChOLk9yZCkoWzMsIDIsIDFdKSwgWzEsIDIsIDNdKVxuICpcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIHNvcnQgPSBmdW5jdGlvbiAoTykge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgcmV0dXJuIGFzLmxlbmd0aCA8PSAxID8gYXMgOiBhcy5zbGljZSgpLnNvcnQoTy5jb21wYXJlKTtcbiAgICB9O1xufTtcbi8vIFRPRE86IGN1cnJ5IGFuZCBtYWtlIGRhdGEtbGFzdCBpbiB2M1xuLyoqXG4gKiBBcHBseSBhIGZ1bmN0aW9uIHRvIHBhaXJzIG9mIGVsZW1lbnRzIGF0IHRoZSBzYW1lIGluZGV4IGluIHR3byBhcnJheXMsIGNvbGxlY3RpbmcgdGhlIHJlc3VsdHMgaW4gYSBuZXcgYXJyYXkuIElmIG9uZVxuICogaW5wdXQgYXJyYXkgaXMgc2hvcnQsIGV4Y2VzcyBlbGVtZW50cyBvZiB0aGUgbG9uZ2VyIGFycmF5IGFyZSBkaXNjYXJkZWQuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IHppcFdpdGggfSBmcm9tICdmcC10cy9SZWFkb25seUFycmF5J1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoemlwV2l0aChbMSwgMiwgM10sIFsnYScsICdiJywgJ2MnLCAnZCddLCAobiwgcykgPT4gcyArIG4pLCBbJ2ExJywgJ2IyJywgJ2MzJ10pXG4gKlxuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgemlwV2l0aCA9IGZ1bmN0aW9uIChmYSwgZmIsIGYpIHtcbiAgICB2YXIgZmMgPSBbXTtcbiAgICB2YXIgbGVuID0gTWF0aC5taW4oZmEubGVuZ3RoLCBmYi5sZW5ndGgpO1xuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbGVuOyBpKyspIHtcbiAgICAgICAgZmNbaV0gPSBmKGZhW2ldLCBmYltpXSk7XG4gICAgfVxuICAgIHJldHVybiBmYztcbn07XG5leHBvcnQgZnVuY3Rpb24gemlwKGFzLCBicykge1xuICAgIGlmIChicyA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgIHJldHVybiBmdW5jdGlvbiAoYnMpIHsgcmV0dXJuIHppcChicywgYXMpOyB9O1xuICAgIH1cbiAgICByZXR1cm4gemlwV2l0aChhcywgYnMsIGZ1bmN0aW9uIChhLCBiKSB7IHJldHVybiBbYSwgYl07IH0pO1xufVxuLyoqXG4gKiBUaGUgZnVuY3Rpb24gaXMgcmV2ZXJzZSBvZiBgemlwYC4gVGFrZXMgYW4gYXJyYXkgb2YgcGFpcnMgYW5kIHJldHVybiB0d28gY29ycmVzcG9uZGluZyBhcnJheXNcbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgdW56aXAgfSBmcm9tICdmcC10cy9SZWFkb25seUFycmF5J1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwodW56aXAoW1sxLCAnYSddLCBbMiwgJ2InXSwgWzMsICdjJ11dKSwgW1sxLCAyLCAzXSwgWydhJywgJ2InLCAnYyddXSlcbiAqXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciB1bnppcCA9IGZ1bmN0aW9uIChhcykge1xuICAgIHZhciBmYSA9IFtdO1xuICAgIHZhciBmYiA9IFtdO1xuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgYXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgZmFbaV0gPSBhc1tpXVswXTtcbiAgICAgICAgZmJbaV0gPSBhc1tpXVsxXTtcbiAgICB9XG4gICAgcmV0dXJuIFtmYSwgZmJdO1xufTtcbi8qKlxuICogUHJlcGVuZCBhbiBlbGVtZW50IHRvIGV2ZXJ5IG1lbWJlciBvZiBhbiBhcnJheVxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBwcmVwZW5kQWxsIH0gZnJvbSAnZnAtdHMvUmVhZG9ubHlBcnJheSdcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKHByZXBlbmRBbGwoOSkoWzEsIDIsIDMsIDRdKSwgWzksIDEsIDksIDIsIDksIDMsIDksIDRdKVxuICpcbiAqIEBzaW5jZSAyLjEwLjBcbiAqL1xuZXhwb3J0IHZhciBwcmVwZW5kQWxsID0gZnVuY3Rpb24gKG1pZGRsZSkge1xuICAgIHZhciBmID0gUk5FQS5wcmVwZW5kQWxsKG1pZGRsZSk7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykgeyByZXR1cm4gKGlzTm9uRW1wdHkoYXMpID8gZihhcykgOiBhcyk7IH07XG59O1xuLyoqXG4gKiBQbGFjZXMgYW4gZWxlbWVudCBpbiBiZXR3ZWVuIG1lbWJlcnMgb2YgYW4gYXJyYXlcbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgaW50ZXJzcGVyc2UgfSBmcm9tICdmcC10cy9SZWFkb25seUFycmF5J1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoaW50ZXJzcGVyc2UoOSkoWzEsIDIsIDMsIDRdKSwgWzEsIDksIDIsIDksIDMsIDksIDRdKVxuICpcbiAqIEBzaW5jZSAyLjkuMFxuICovXG5leHBvcnQgdmFyIGludGVyc3BlcnNlID0gZnVuY3Rpb24gKG1pZGRsZSkge1xuICAgIHZhciBmID0gUk5FQS5pbnRlcnNwZXJzZShtaWRkbGUpO1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHsgcmV0dXJuIChpc05vbkVtcHR5KGFzKSA/IGYoYXMpIDogYXMpOyB9O1xufTtcbi8qKlxuICogUm90YXRlIGEgYFJlYWRvbmx5QXJyYXlgIGJ5IGBuYCBzdGVwcy5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgcm90YXRlIH0gZnJvbSAnZnAtdHMvUmVhZG9ubHlBcnJheSdcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKHJvdGF0ZSgyKShbMSwgMiwgMywgNCwgNV0pLCBbNCwgNSwgMSwgMiwgM10pXG4gKlxuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgcm90YXRlID0gZnVuY3Rpb24gKG4pIHtcbiAgICB2YXIgZiA9IFJORUEucm90YXRlKG4pO1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHsgcmV0dXJuIChpc05vbkVtcHR5KGFzKSA/IGYoYXMpIDogYXMpOyB9O1xufTtcbmV4cG9ydCBmdW5jdGlvbiBlbGVtKEUpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGEsIGFzKSB7XG4gICAgICAgIGlmIChhcyA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICB2YXIgZWxlbUVfMSA9IGVsZW0oRSk7XG4gICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7IHJldHVybiBlbGVtRV8xKGEsIGFzKTsgfTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgcHJlZGljYXRlID0gZnVuY3Rpb24gKGVsZW1lbnQpIHsgcmV0dXJuIEUuZXF1YWxzKGVsZW1lbnQsIGEpOyB9O1xuICAgICAgICB2YXIgaSA9IDA7XG4gICAgICAgIGZvciAoOyBpIDwgYXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIGlmIChwcmVkaWNhdGUoYXNbaV0pKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH07XG59XG4vKipcbiAqIFJlbW92ZSBkdXBsaWNhdGVzIGZyb20gYW4gYXJyYXksIGtlZXBpbmcgdGhlIGZpcnN0IG9jY3VycmVuY2Ugb2YgYW4gZWxlbWVudC5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgdW5pcSB9IGZyb20gJ2ZwLXRzL1JlYWRvbmx5QXJyYXknXG4gKiBpbXBvcnQgKiBhcyBOIGZyb20gJ2ZwLXRzL251bWJlcidcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKHVuaXEoTi5FcSkoWzEsIDIsIDFdKSwgWzEsIDJdKVxuICpcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIHVuaXEgPSBmdW5jdGlvbiAoRSkge1xuICAgIHZhciBmID0gUk5FQS51bmlxKEUpO1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHsgcmV0dXJuIChpc05vbkVtcHR5KGFzKSA/IGYoYXMpIDogYXMpOyB9O1xufTtcbi8qKlxuICogU29ydCB0aGUgZWxlbWVudHMgb2YgYW4gYXJyYXkgaW4gaW5jcmVhc2luZyBvcmRlciwgd2hlcmUgZWxlbWVudHMgYXJlIGNvbXBhcmVkIHVzaW5nIGZpcnN0IGBvcmRzWzBdYCwgdGhlbiBgb3Jkc1sxXWAsXG4gKiBldGMuLi5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgc29ydEJ5IH0gZnJvbSAnZnAtdHMvUmVhZG9ubHlBcnJheSdcbiAqIGltcG9ydCB7IGNvbnRyYW1hcCB9IGZyb20gJ2ZwLXRzL09yZCdcbiAqIGltcG9ydCAqIGFzIFMgZnJvbSAnZnAtdHMvc3RyaW5nJ1xuICogaW1wb3J0ICogYXMgTiBmcm9tICdmcC10cy9udW1iZXInXG4gKiBpbXBvcnQgeyBwaXBlIH0gZnJvbSAnZnAtdHMvZnVuY3Rpb24nXG4gKlxuICogaW50ZXJmYWNlIFBlcnNvbiB7XG4gKiAgIHJlYWRvbmx5IG5hbWU6IHN0cmluZ1xuICogICByZWFkb25seSBhZ2U6IG51bWJlclxuICogfVxuICogY29uc3QgYnlOYW1lID0gcGlwZShTLk9yZCwgY29udHJhbWFwKChwOiBQZXJzb24pID0+IHAubmFtZSkpXG4gKiBjb25zdCBieUFnZSA9IHBpcGUoTi5PcmQsIGNvbnRyYW1hcCgocDogUGVyc29uKSA9PiBwLmFnZSkpXG4gKlxuICogY29uc3Qgc29ydEJ5TmFtZUJ5QWdlID0gc29ydEJ5KFtieU5hbWUsIGJ5QWdlXSlcbiAqXG4gKiBjb25zdCBwZXJzb25zID0gW3sgbmFtZTogJ2EnLCBhZ2U6IDEgfSwgeyBuYW1lOiAnYicsIGFnZTogMyB9LCB7IG5hbWU6ICdjJywgYWdlOiAyIH0sIHsgbmFtZTogJ2InLCBhZ2U6IDIgfV1cbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoc29ydEJ5TmFtZUJ5QWdlKHBlcnNvbnMpLCBbXG4gKiAgIHsgbmFtZTogJ2EnLCBhZ2U6IDEgfSxcbiAqICAgeyBuYW1lOiAnYicsIGFnZTogMiB9LFxuICogICB7IG5hbWU6ICdiJywgYWdlOiAzIH0sXG4gKiAgIHsgbmFtZTogJ2MnLCBhZ2U6IDIgfVxuICogXSlcbiAqXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBzb3J0QnkgPSBmdW5jdGlvbiAob3Jkcykge1xuICAgIHZhciBmID0gUk5FQS5zb3J0Qnkob3Jkcyk7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykgeyByZXR1cm4gKGlzTm9uRW1wdHkoYXMpID8gZihhcykgOiBhcyk7IH07XG59O1xuLyoqXG4gKiBBIHVzZWZ1bCByZWN1cnNpb24gcGF0dGVybiBmb3IgcHJvY2Vzc2luZyBhIGBSZWFkb25seUFycmF5YCB0byBwcm9kdWNlIGEgbmV3IGBSZWFkb25seUFycmF5YCwgb2Z0ZW4gdXNlZCBmb3IgXCJjaG9wcGluZ1wiIHVwIHRoZSBpbnB1dFxuICogYFJlYWRvbmx5QXJyYXlgLiBUeXBpY2FsbHkgYGNob3BgIGlzIGNhbGxlZCB3aXRoIHNvbWUgZnVuY3Rpb24gdGhhdCB3aWxsIGNvbnN1bWUgYW4gaW5pdGlhbCBwcmVmaXggb2YgdGhlIGBSZWFkb25seUFycmF5YCBhbmQgcHJvZHVjZSBhXG4gKiB2YWx1ZSBhbmQgdGhlIHRhaWwgb2YgdGhlIGBSZWFkb25seUFycmF5YC5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgRXEgfSBmcm9tICdmcC10cy9FcSdcbiAqIGltcG9ydCAqIGFzIFJBIGZyb20gJ2ZwLXRzL1JlYWRvbmx5QXJyYXknXG4gKiBpbXBvcnQgKiBhcyBOIGZyb20gJ2ZwLXRzL251bWJlcidcbiAqIGltcG9ydCB7IHBpcGUgfSBmcm9tICdmcC10cy9mdW5jdGlvbidcbiAqXG4gKiBjb25zdCBncm91cCA9IDxBPihTOiBFcTxBPik6ICgoYXM6IFJlYWRvbmx5QXJyYXk8QT4pID0+IFJlYWRvbmx5QXJyYXk8UmVhZG9ubHlBcnJheTxBPj4pID0+IHtcbiAqICAgcmV0dXJuIFJBLmNob3AoYXMgPT4ge1xuICogICAgIGNvbnN0IHsgaW5pdCwgcmVzdCB9ID0gcGlwZShhcywgUkEuc3BhbkxlZnQoKGE6IEEpID0+IFMuZXF1YWxzKGEsIGFzWzBdKSkpXG4gKiAgICAgcmV0dXJuIFtpbml0LCByZXN0XVxuICogICB9KVxuICogfVxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChncm91cChOLkVxKShbMSwgMSwgMiwgMywgMywgNF0pLCBbWzEsIDFdLCBbMl0sIFszLCAzXSwgWzRdXSlcbiAqXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBjaG9wID0gZnVuY3Rpb24gKGYpIHtcbiAgICB2YXIgZyA9IFJORUEuY2hvcChmKTtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7IHJldHVybiAoaXNOb25FbXB0eShhcykgPyBnKGFzKSA6IGVtcHR5KTsgfTtcbn07XG4vKipcbiAqIFNwbGl0cyBhIGBSZWFkb25seUFycmF5YCBpbnRvIHR3byBwaWVjZXMsIHRoZSBmaXJzdCBwaWVjZSBoYXMgbWF4IGBuYCBlbGVtZW50cy5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgc3BsaXRBdCB9IGZyb20gJ2ZwLXRzL1JlYWRvbmx5QXJyYXknXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChzcGxpdEF0KDIpKFsxLCAyLCAzLCA0LCA1XSksIFtbMSwgMl0sIFszLCA0LCA1XV0pXG4gKlxuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgc3BsaXRBdCA9IGZ1bmN0aW9uIChuKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykge1xuICAgICAgICByZXR1cm4gbiA+PSAxICYmIGlzTm9uRW1wdHkoYXMpID8gUk5FQS5zcGxpdEF0KG4pKGFzKSA6IGlzRW1wdHkoYXMpID8gW2FzLCBlbXB0eV0gOiBbZW1wdHksIGFzXTtcbiAgICB9O1xufTtcbi8qKlxuICogU3BsaXRzIGEgYFJlYWRvbmx5QXJyYXlgIGludG8gbGVuZ3RoLWBuYCBwaWVjZXMuIFRoZSBsYXN0IHBpZWNlIHdpbGwgYmUgc2hvcnRlciBpZiBgbmAgZG9lcyBub3QgZXZlbmx5IGRpdmlkZSB0aGUgbGVuZ3RoIG9mXG4gKiB0aGUgYFJlYWRvbmx5QXJyYXlgLiBOb3RlIHRoYXQgYGNodW5rc09mKG4pKFtdKWAgaXMgYFtdYCwgbm90IGBbW11dYC4gVGhpcyBpcyBpbnRlbnRpb25hbCwgYW5kIGlzIGNvbnNpc3RlbnQgd2l0aCBhIHJlY3Vyc2l2ZVxuICogZGVmaW5pdGlvbiBvZiBgY2h1bmtzT2ZgOyBpdCBzYXRpc2ZpZXMgdGhlIHByb3BlcnR5IHRoYXQ6XG4gKlxuICogYGBgdHNcbiAqIGNodW5rc09mKG4pKHhzKS5jb25jYXQoY2h1bmtzT2YobikoeXMpKSA9PSBjaHVua3NPZihuKSh4cy5jb25jYXQoeXMpKSlcbiAqIGBgYFxuICpcbiAqIHdoZW5ldmVyIGBuYCBldmVubHkgZGl2aWRlcyB0aGUgbGVuZ3RoIG9mIGBhc2AuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IGNodW5rc09mIH0gZnJvbSAnZnAtdHMvUmVhZG9ubHlBcnJheSdcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKGNodW5rc09mKDIpKFsxLCAyLCAzLCA0LCA1XSksIFtbMSwgMl0sIFszLCA0XSwgWzVdXSlcbiAqXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBjaHVua3NPZiA9IGZ1bmN0aW9uIChuKSB7XG4gICAgdmFyIGYgPSBSTkVBLmNodW5rc09mKG4pO1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHsgcmV0dXJuIChpc05vbkVtcHR5KGFzKSA/IGYoYXMpIDogZW1wdHkpOyB9O1xufTtcbi8qKlxuICogQGNhdGVnb3J5IGxpZnRpbmdcbiAqIEBzaW5jZSAyLjExLjBcbiAqL1xuZXhwb3J0IHZhciBmcm9tT3B0aW9uSyA9IGZ1bmN0aW9uIChmKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIGEgPSBbXTtcbiAgICAgICAgZm9yICh2YXIgX2kgPSAwOyBfaSA8IGFyZ3VtZW50cy5sZW5ndGg7IF9pKyspIHtcbiAgICAgICAgICAgIGFbX2ldID0gYXJndW1lbnRzW19pXTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gZnJvbU9wdGlvbihmLmFwcGx5KHZvaWQgMCwgYSkpO1xuICAgIH07XG59O1xuZXhwb3J0IGZ1bmN0aW9uIGNvbXByZWhlbnNpb24oaW5wdXQsIGYsIGcpIHtcbiAgICBpZiAoZyA9PT0gdm9pZCAwKSB7IGcgPSBmdW5jdGlvbiAoKSB7IHJldHVybiB0cnVlOyB9OyB9XG4gICAgdmFyIGdvID0gZnVuY3Rpb24gKHNjb3BlLCBpbnB1dCkge1xuICAgICAgICByZXR1cm4gaXNOb25FbXB0eShpbnB1dClcbiAgICAgICAgICAgID8gZmxhdE1hcChSTkVBLmhlYWQoaW5wdXQpLCBmdW5jdGlvbiAoYSkgeyByZXR1cm4gZ28ocGlwZShzY29wZSwgYXBwZW5kKGEpKSwgUk5FQS50YWlsKGlucHV0KSk7IH0pXG4gICAgICAgICAgICA6IGcuYXBwbHkodm9pZCAwLCBzY29wZSkgPyBbZi5hcHBseSh2b2lkIDAsIHNjb3BlKV1cbiAgICAgICAgICAgICAgICA6IGVtcHR5O1xuICAgIH07XG4gICAgcmV0dXJuIGdvKGVtcHR5LCBpbnB1dCk7XG59XG4vKipcbiAqIEBzaW5jZSAyLjExLjBcbiAqL1xuZXhwb3J0IHZhciBjb25jYXRXID0gZnVuY3Rpb24gKHNlY29uZCkge1xuICAgIHJldHVybiBmdW5jdGlvbiAoZmlyc3QpIHtcbiAgICAgICAgcmV0dXJuIGlzRW1wdHkoZmlyc3QpID8gc2Vjb25kIDogaXNFbXB0eShzZWNvbmQpID8gZmlyc3QgOiBmaXJzdC5jb25jYXQoc2Vjb25kKTtcbiAgICB9O1xufTtcbi8qKlxuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIGNvbmNhdCA9IGNvbmNhdFc7XG5leHBvcnQgZnVuY3Rpb24gdW5pb24oRSkge1xuICAgIHZhciB1bmlvbkUgPSBSTkVBLnVuaW9uKEUpO1xuICAgIHJldHVybiBmdW5jdGlvbiAoZmlyc3QsIHNlY29uZCkge1xuICAgICAgICBpZiAoc2Vjb25kID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIHZhciB1bmlvbkVfMSA9IHVuaW9uKEUpO1xuICAgICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIChzZWNvbmQpIHsgcmV0dXJuIHVuaW9uRV8xKHNlY29uZCwgZmlyc3QpOyB9O1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBpc05vbkVtcHR5KGZpcnN0KSAmJiBpc05vbkVtcHR5KHNlY29uZCkgPyB1bmlvbkUoc2Vjb25kKShmaXJzdCkgOiBpc05vbkVtcHR5KGZpcnN0KSA/IGZpcnN0IDogc2Vjb25kO1xuICAgIH07XG59XG5leHBvcnQgZnVuY3Rpb24gaW50ZXJzZWN0aW9uKEUpIHtcbiAgICB2YXIgZWxlbUUgPSBlbGVtKEUpO1xuICAgIHJldHVybiBmdW5jdGlvbiAoeHMsIHlzKSB7XG4gICAgICAgIGlmICh5cyA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICB2YXIgaW50ZXJzZWN0aW9uRV8xID0gaW50ZXJzZWN0aW9uKEUpO1xuICAgICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uICh5cykgeyByZXR1cm4gaW50ZXJzZWN0aW9uRV8xKHlzLCB4cyk7IH07XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHhzLmZpbHRlcihmdW5jdGlvbiAoYSkgeyByZXR1cm4gZWxlbUUoYSwgeXMpOyB9KTtcbiAgICB9O1xufVxuZXhwb3J0IGZ1bmN0aW9uIGRpZmZlcmVuY2UoRSkge1xuICAgIHZhciBlbGVtRSA9IGVsZW0oRSk7XG4gICAgcmV0dXJuIGZ1bmN0aW9uICh4cywgeXMpIHtcbiAgICAgICAgaWYgKHlzID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIHZhciBkaWZmZXJlbmNlRV8xID0gZGlmZmVyZW5jZShFKTtcbiAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbiAoeXMpIHsgcmV0dXJuIGRpZmZlcmVuY2VFXzEoeXMsIHhzKTsgfTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4geHMuZmlsdGVyKGZ1bmN0aW9uIChhKSB7IHJldHVybiAhZWxlbUUoYSwgeXMpOyB9KTtcbiAgICB9O1xufVxudmFyIF9tYXAgPSBmdW5jdGlvbiAoZmEsIGYpIHsgcmV0dXJuIHBpcGUoZmEsIG1hcChmKSk7IH07XG52YXIgX21hcFdpdGhJbmRleCA9IGZ1bmN0aW9uIChmYSwgZikgeyByZXR1cm4gcGlwZShmYSwgbWFwV2l0aEluZGV4KGYpKTsgfTtcbnZhciBfYXAgPSBmdW5jdGlvbiAoZmFiLCBmYSkgeyByZXR1cm4gcGlwZShmYWIsIGFwKGZhKSk7IH07XG52YXIgX2ZpbHRlciA9IGZ1bmN0aW9uIChmYSwgcHJlZGljYXRlKSB7XG4gICAgcmV0dXJuIHBpcGUoZmEsIGZpbHRlcihwcmVkaWNhdGUpKTtcbn07XG52YXIgX2ZpbHRlck1hcCA9IGZ1bmN0aW9uIChmYSwgZikgeyByZXR1cm4gcGlwZShmYSwgZmlsdGVyTWFwKGYpKTsgfTtcbnZhciBfcGFydGl0aW9uID0gZnVuY3Rpb24gKGZhLCBwcmVkaWNhdGUpIHtcbiAgICByZXR1cm4gcGlwZShmYSwgcGFydGl0aW9uKHByZWRpY2F0ZSkpO1xufTtcbnZhciBfcGFydGl0aW9uTWFwID0gZnVuY3Rpb24gKGZhLCBmKSB7IHJldHVybiBwaXBlKGZhLCBwYXJ0aXRpb25NYXAoZikpOyB9O1xudmFyIF9wYXJ0aXRpb25XaXRoSW5kZXggPSBmdW5jdGlvbiAoZmEsIHByZWRpY2F0ZVdpdGhJbmRleCkgeyByZXR1cm4gcGlwZShmYSwgcGFydGl0aW9uV2l0aEluZGV4KHByZWRpY2F0ZVdpdGhJbmRleCkpOyB9O1xudmFyIF9wYXJ0aXRpb25NYXBXaXRoSW5kZXggPSBmdW5jdGlvbiAoZmEsIGYpIHsgcmV0dXJuIHBpcGUoZmEsIHBhcnRpdGlvbk1hcFdpdGhJbmRleChmKSk7IH07XG52YXIgX2FsdCA9IGZ1bmN0aW9uIChmYSwgdGhhdCkgeyByZXR1cm4gcGlwZShmYSwgYWx0KHRoYXQpKTsgfTtcbnZhciBfcmVkdWNlID0gZnVuY3Rpb24gKGZhLCBiLCBmKSB7IHJldHVybiBwaXBlKGZhLCByZWR1Y2UoYiwgZikpOyB9O1xudmFyIF9mb2xkTWFwID0gZnVuY3Rpb24gKE0pIHtcbiAgICB2YXIgZm9sZE1hcE0gPSBmb2xkTWFwKE0pO1xuICAgIHJldHVybiBmdW5jdGlvbiAoZmEsIGYpIHsgcmV0dXJuIHBpcGUoZmEsIGZvbGRNYXBNKGYpKTsgfTtcbn07XG52YXIgX3JlZHVjZVJpZ2h0ID0gZnVuY3Rpb24gKGZhLCBiLCBmKSB7IHJldHVybiBwaXBlKGZhLCByZWR1Y2VSaWdodChiLCBmKSk7IH07XG52YXIgX3JlZHVjZVdpdGhJbmRleCA9IGZ1bmN0aW9uIChmYSwgYiwgZikge1xuICAgIHJldHVybiBwaXBlKGZhLCByZWR1Y2VXaXRoSW5kZXgoYiwgZikpO1xufTtcbnZhciBfZm9sZE1hcFdpdGhJbmRleCA9IGZ1bmN0aW9uIChNKSB7XG4gICAgdmFyIGZvbGRNYXBXaXRoSW5kZXhNID0gZm9sZE1hcFdpdGhJbmRleChNKTtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGZhLCBmKSB7IHJldHVybiBwaXBlKGZhLCBmb2xkTWFwV2l0aEluZGV4TShmKSk7IH07XG59O1xudmFyIF9yZWR1Y2VSaWdodFdpdGhJbmRleCA9IGZ1bmN0aW9uIChmYSwgYiwgZikge1xuICAgIHJldHVybiBwaXBlKGZhLCByZWR1Y2VSaWdodFdpdGhJbmRleChiLCBmKSk7XG59O1xudmFyIF9maWx0ZXJNYXBXaXRoSW5kZXggPSBmdW5jdGlvbiAoZmEsIGYpIHsgcmV0dXJuIHBpcGUoZmEsIGZpbHRlck1hcFdpdGhJbmRleChmKSk7IH07XG52YXIgX2ZpbHRlcldpdGhJbmRleCA9IGZ1bmN0aW9uIChmYSwgcHJlZGljYXRlV2l0aEluZGV4KSB7IHJldHVybiBwaXBlKGZhLCBmaWx0ZXJXaXRoSW5kZXgocHJlZGljYXRlV2l0aEluZGV4KSk7IH07XG52YXIgX2V4dGVuZCA9IGZ1bmN0aW9uIChmYSwgZikgeyByZXR1cm4gcGlwZShmYSwgZXh0ZW5kKGYpKTsgfTtcbnZhciBfdHJhdmVyc2UgPSBmdW5jdGlvbiAoRikge1xuICAgIHZhciB0cmF2ZXJzZUYgPSB0cmF2ZXJzZShGKTtcbiAgICByZXR1cm4gZnVuY3Rpb24gKHRhLCBmKSB7IHJldHVybiBwaXBlKHRhLCB0cmF2ZXJzZUYoZikpOyB9O1xufTtcbi8qIGlzdGFuYnVsIGlnbm9yZSBuZXh0ICovXG52YXIgX3RyYXZlcnNlV2l0aEluZGV4ID0gZnVuY3Rpb24gKEYpIHtcbiAgICB2YXIgdHJhdmVyc2VXaXRoSW5kZXhGID0gdHJhdmVyc2VXaXRoSW5kZXgoRik7XG4gICAgcmV0dXJuIGZ1bmN0aW9uICh0YSwgZikgeyByZXR1cm4gcGlwZSh0YSwgdHJhdmVyc2VXaXRoSW5kZXhGKGYpKTsgfTtcbn07XG4vKiogQGludGVybmFsICovXG5leHBvcnQgdmFyIF9jaGFpblJlY0RlcHRoRmlyc3QgPSBmdW5jdGlvbiAoYSwgZikgeyByZXR1cm4gcGlwZShhLCBjaGFpblJlY0RlcHRoRmlyc3QoZikpOyB9O1xuLyoqIEBpbnRlcm5hbCAqL1xuZXhwb3J0IHZhciBfY2hhaW5SZWNCcmVhZHRoRmlyc3QgPSBmdW5jdGlvbiAoYSwgZikgeyByZXR1cm4gcGlwZShhLCBjaGFpblJlY0JyZWFkdGhGaXJzdChmKSk7IH07XG4vKipcbiAqIEBjYXRlZ29yeSBjb25zdHJ1Y3RvcnNcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIG9mID0gUk5FQS5vZjtcbi8qKlxuICogQHNpbmNlIDIuNy4wXG4gKi9cbmV4cG9ydCB2YXIgemVybyA9IGZ1bmN0aW9uICgpIHsgcmV0dXJuIGVtcHR5OyB9O1xuLyoqXG4gKiBMZXNzIHN0cmljdCB2ZXJzaW9uIG9mIFtgYWx0YF0oI2FsdCkuXG4gKlxuICogVGhlIGBXYCBzdWZmaXggKHNob3J0IGZvciAqKlcqKmlkZW5pbmcpIG1lYW5zIHRoYXQgdGhlIHJldHVybiB0eXBlcyB3aWxsIGJlIG1lcmdlZC5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0ICogYXMgUkEgZnJvbSAnZnAtdHMvUmVhZG9ubHlBcnJheSdcbiAqIGltcG9ydCB7IHBpcGUgfSBmcm9tICdmcC10cy9mdW5jdGlvbidcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKFxuICogICBwaXBlKFxuICogICAgIFsxLCAyLCAzXSxcbiAqICAgICBSQS5hbHRXKCgpID0+IFsnYScsICdiJ10pXG4gKiAgICksXG4gKiAgIFsxLCAyLCAzLCAnYScsICdiJ11cbiAqIClcbiAqXG4gKiBAY2F0ZWdvcnkgZXJyb3IgaGFuZGxpbmdcbiAqIEBzaW5jZSAyLjkuMFxuICovXG5leHBvcnQgdmFyIGFsdFcgPSBmdW5jdGlvbiAodGhhdCkge1xuICAgIHJldHVybiBmdW5jdGlvbiAoZmEpIHtcbiAgICAgICAgcmV0dXJuIGZhLmNvbmNhdCh0aGF0KCkpO1xuICAgIH07XG59O1xuLyoqXG4gKiBJZGVudGlmaWVzIGFuIGFzc29jaWF0aXZlIG9wZXJhdGlvbiBvbiBhIHR5cGUgY29uc3RydWN0b3IuIEl0IGlzIHNpbWlsYXIgdG8gYFNlbWlncm91cGAsIGV4Y2VwdCB0aGF0IGl0IGFwcGxpZXMgdG9cbiAqIHR5cGVzIG9mIGtpbmQgYCogLT4gKmAuXG4gKlxuICogSW4gY2FzZSBvZiBgUmVhZG9ubHlBcnJheWAgY29uY2F0ZW5hdGVzIHRoZSBpbnB1dHMgaW50byBhIHNpbmdsZSBhcnJheS5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0ICogYXMgUkEgZnJvbSAnZnAtdHMvUmVhZG9ubHlBcnJheSdcbiAqIGltcG9ydCB7IHBpcGUgfSBmcm9tICdmcC10cy9mdW5jdGlvbidcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKFxuICogICBwaXBlKFxuICogICAgIFsxLCAyLCAzXSxcbiAqICAgICBSQS5hbHQoKCkgPT4gWzQsIDVdKVxuICogICApLFxuICogICBbMSwgMiwgMywgNCwgNV1cbiAqIClcbiAqXG4gKiBAY2F0ZWdvcnkgZXJyb3IgaGFuZGxpbmdcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIGFsdCA9IGFsdFc7XG4vKipcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIGFwID0gZnVuY3Rpb24gKGZhKSB7XG4gICAgcmV0dXJuIGZsYXRNYXAoZnVuY3Rpb24gKGYpIHsgcmV0dXJuIHBpcGUoZmEsIG1hcChmKSk7IH0pO1xufTtcbi8qKlxuICogQ29tcG9zZXMgY29tcHV0YXRpb25zIGluIHNlcXVlbmNlLCB1c2luZyB0aGUgcmV0dXJuIHZhbHVlIG9mIG9uZSBjb21wdXRhdGlvbiB0byBkZXRlcm1pbmUgdGhlIG5leHQgY29tcHV0YXRpb24uXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCAqIGFzIFJBIGZyb20gJ2ZwLXRzL1JlYWRvbmx5QXJyYXknXG4gKiBpbXBvcnQgeyBwaXBlIH0gZnJvbSAnZnAtdHMvZnVuY3Rpb24nXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChcbiAqICAgcGlwZShcbiAqICAgICBbMSwgMiwgM10sXG4gKiAgICAgUkEuZmxhdE1hcCgobikgPT4gW2BhJHtufWAsIGBiJHtufWBdKVxuICogICApLFxuICogICBbJ2ExJywgJ2IxJywgJ2EyJywgJ2IyJywgJ2EzJywgJ2IzJ11cbiAqIClcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoXG4gKiAgIHBpcGUoXG4gKiAgICAgWzEsIDIsIDNdLFxuICogICAgIFJBLmZsYXRNYXAoKCkgPT4gW10pXG4gKiAgICksXG4gKiAgIFtdXG4gKiApXG4gKlxuICogQGNhdGVnb3J5IHNlcXVlbmNpbmdcbiAqIEBzaW5jZSAyLjE0LjBcbiAqL1xuZXhwb3J0IHZhciBmbGF0TWFwID0gLyojX19QVVJFX18qLyBkdWFsKDIsIGZ1bmN0aW9uIChtYSwgZikge1xuICAgIHJldHVybiBwaXBlKG1hLCBjaGFpbldpdGhJbmRleChmdW5jdGlvbiAoaSwgYSkgeyByZXR1cm4gZihhLCBpKTsgfSkpO1xufSk7XG4vKipcbiAqIEBjYXRlZ29yeSBzZXF1ZW5jaW5nXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBmbGF0dGVuID0gLyojX19QVVJFX18qLyBmbGF0TWFwKGlkZW50aXR5KTtcbi8qKlxuICogYG1hcGAgY2FuIGJlIHVzZWQgdG8gdHVybiBmdW5jdGlvbnMgYChhOiBBKSA9PiBCYCBpbnRvIGZ1bmN0aW9ucyBgKGZhOiBGPEE+KSA9PiBGPEI+YCB3aG9zZSBhcmd1bWVudCBhbmQgcmV0dXJuIHR5cGVzXG4gKiB1c2UgdGhlIHR5cGUgY29uc3RydWN0b3IgYEZgIHRvIHJlcHJlc2VudCBzb21lIGNvbXB1dGF0aW9uYWwgY29udGV4dC5cbiAqXG4gKiBAY2F0ZWdvcnkgbWFwcGluZ1xuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgbWFwID0gZnVuY3Rpb24gKGYpIHsgcmV0dXJuIGZ1bmN0aW9uIChmYSkge1xuICAgIHJldHVybiBmYS5tYXAoZnVuY3Rpb24gKGEpIHsgcmV0dXJuIGYoYSk7IH0pO1xufTsgfTtcbi8qKlxuICogQGNhdGVnb3J5IG1hcHBpbmdcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIG1hcFdpdGhJbmRleCA9IGZ1bmN0aW9uIChmKSB7IHJldHVybiBmdW5jdGlvbiAoZmEpIHtcbiAgICByZXR1cm4gZmEubWFwKGZ1bmN0aW9uIChhLCBpKSB7IHJldHVybiBmKGksIGEpOyB9KTtcbn07IH07XG4vKipcbiAqIEBjYXRlZ29yeSBmaWx0ZXJpbmdcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIHNlcGFyYXRlID0gZnVuY3Rpb24gKGZhKSB7XG4gICAgdmFyIGxlZnQgPSBbXTtcbiAgICB2YXIgcmlnaHQgPSBbXTtcbiAgICBmb3IgKHZhciBfaSA9IDAsIGZhXzEgPSBmYTsgX2kgPCBmYV8xLmxlbmd0aDsgX2krKykge1xuICAgICAgICB2YXIgZSA9IGZhXzFbX2ldO1xuICAgICAgICBpZiAoZS5fdGFnID09PSAnTGVmdCcpIHtcbiAgICAgICAgICAgIGxlZnQucHVzaChlLmxlZnQpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgcmlnaHQucHVzaChlLnJpZ2h0KTtcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gc2VwYXJhdGVkKGxlZnQsIHJpZ2h0KTtcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBmaWx0ZXJpbmdcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIGZpbHRlciA9IGZ1bmN0aW9uIChwcmVkaWNhdGUpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIHJldHVybiBhcy5maWx0ZXIocHJlZGljYXRlKTtcbiAgICB9O1xufTtcbi8qKlxuICogQGNhdGVnb3J5IGZpbHRlcmluZ1xuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgZmlsdGVyTWFwV2l0aEluZGV4ID0gZnVuY3Rpb24gKGYpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGZhKSB7XG4gICAgICAgIHZhciBvdXQgPSBbXTtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBmYS5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgdmFyIG9wdGlvbkIgPSBmKGksIGZhW2ldKTtcbiAgICAgICAgICAgIGlmIChfLmlzU29tZShvcHRpb25CKSkge1xuICAgICAgICAgICAgICAgIG91dC5wdXNoKG9wdGlvbkIudmFsdWUpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBvdXQ7XG4gICAgfTtcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBmaWx0ZXJpbmdcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIGZpbHRlck1hcCA9IGZ1bmN0aW9uIChmKSB7XG4gICAgcmV0dXJuIGZpbHRlck1hcFdpdGhJbmRleChmdW5jdGlvbiAoXywgYSkgeyByZXR1cm4gZihhKTsgfSk7XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgZmlsdGVyaW5nXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBjb21wYWN0ID0gLyojX19QVVJFX18qLyBmaWx0ZXJNYXAoaWRlbnRpdHkpO1xuLyoqXG4gKiBAY2F0ZWdvcnkgZmlsdGVyaW5nXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBwYXJ0aXRpb24gPSBmdW5jdGlvbiAocHJlZGljYXRlKSB7XG4gICAgcmV0dXJuIHBhcnRpdGlvbldpdGhJbmRleChmdW5jdGlvbiAoXywgYSkgeyByZXR1cm4gcHJlZGljYXRlKGEpOyB9KTtcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBmaWx0ZXJpbmdcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIHBhcnRpdGlvbldpdGhJbmRleCA9IGZ1bmN0aW9uIChwcmVkaWNhdGVXaXRoSW5kZXgpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIHZhciBsZWZ0ID0gW107XG4gICAgICAgIHZhciByaWdodCA9IFtdO1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGFzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICB2YXIgYSA9IGFzW2ldO1xuICAgICAgICAgICAgaWYgKHByZWRpY2F0ZVdpdGhJbmRleChpLCBhKSkge1xuICAgICAgICAgICAgICAgIHJpZ2h0LnB1c2goYSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBsZWZ0LnB1c2goYSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHNlcGFyYXRlZChsZWZ0LCByaWdodCk7XG4gICAgfTtcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBmaWx0ZXJpbmdcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIHBhcnRpdGlvbk1hcCA9IGZ1bmN0aW9uIChmKSB7XG4gICAgcmV0dXJuIHBhcnRpdGlvbk1hcFdpdGhJbmRleChmdW5jdGlvbiAoXywgYSkgeyByZXR1cm4gZihhKTsgfSk7XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgZmlsdGVyaW5nXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBwYXJ0aXRpb25NYXBXaXRoSW5kZXggPSBmdW5jdGlvbiAoZikge1xuICAgIHJldHVybiBmdW5jdGlvbiAoZmEpIHtcbiAgICAgICAgdmFyIGxlZnQgPSBbXTtcbiAgICAgICAgdmFyIHJpZ2h0ID0gW107XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgZmEubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIHZhciBlID0gZihpLCBmYVtpXSk7XG4gICAgICAgICAgICBpZiAoZS5fdGFnID09PSAnTGVmdCcpIHtcbiAgICAgICAgICAgICAgICBsZWZ0LnB1c2goZS5sZWZ0KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHJpZ2h0LnB1c2goZS5yaWdodCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHNlcGFyYXRlZChsZWZ0LCByaWdodCk7XG4gICAgfTtcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBmaWx0ZXJpbmdcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIGZpbHRlcldpdGhJbmRleCA9IGZ1bmN0aW9uIChwcmVkaWNhdGVXaXRoSW5kZXgpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIHJldHVybiBhcy5maWx0ZXIoZnVuY3Rpb24gKGEsIGkpIHsgcmV0dXJuIHByZWRpY2F0ZVdpdGhJbmRleChpLCBhKTsgfSk7XG4gICAgfTtcbn07XG4vKipcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIGV4dGVuZCA9IGZ1bmN0aW9uIChmKSB7IHJldHVybiBmdW5jdGlvbiAod2EpIHtcbiAgICByZXR1cm4gd2EubWFwKGZ1bmN0aW9uIChfLCBpKSB7IHJldHVybiBmKHdhLnNsaWNlKGkpKTsgfSk7XG59OyB9O1xuLyoqXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBkdXBsaWNhdGUgPSAvKiNfX1BVUkVfXyovIGV4dGVuZChpZGVudGl0eSk7XG4vKipcbiAqIEBjYXRlZ29yeSBmb2xkaW5nXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBmb2xkTWFwV2l0aEluZGV4ID0gZnVuY3Rpb24gKE0pIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGYpIHtcbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIChmYSkge1xuICAgICAgICAgICAgcmV0dXJuIGZhLnJlZHVjZShmdW5jdGlvbiAoYiwgYSwgaSkgeyByZXR1cm4gTS5jb25jYXQoYiwgZihpLCBhKSk7IH0sIE0uZW1wdHkpO1xuICAgICAgICB9O1xuICAgIH07XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgZm9sZGluZ1xuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgcmVkdWNlID0gZnVuY3Rpb24gKGIsIGYpIHtcbiAgICByZXR1cm4gcmVkdWNlV2l0aEluZGV4KGIsIGZ1bmN0aW9uIChfLCBiLCBhKSB7IHJldHVybiBmKGIsIGEpOyB9KTtcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBmb2xkaW5nXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBmb2xkTWFwID0gZnVuY3Rpb24gKE0pIHtcbiAgICB2YXIgZm9sZE1hcFdpdGhJbmRleE0gPSBmb2xkTWFwV2l0aEluZGV4KE0pO1xuICAgIHJldHVybiBmdW5jdGlvbiAoZikgeyByZXR1cm4gZm9sZE1hcFdpdGhJbmRleE0oZnVuY3Rpb24gKF8sIGEpIHsgcmV0dXJuIGYoYSk7IH0pOyB9O1xufTtcbi8qKlxuICogQGNhdGVnb3J5IGZvbGRpbmdcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIHJlZHVjZVdpdGhJbmRleCA9IGZ1bmN0aW9uIChiLCBmKSB7IHJldHVybiBmdW5jdGlvbiAoZmEpIHtcbiAgICB2YXIgbGVuID0gZmEubGVuZ3RoO1xuICAgIHZhciBvdXQgPSBiO1xuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbGVuOyBpKyspIHtcbiAgICAgICAgb3V0ID0gZihpLCBvdXQsIGZhW2ldKTtcbiAgICB9XG4gICAgcmV0dXJuIG91dDtcbn07IH07XG4vKipcbiAqIEBjYXRlZ29yeSBmb2xkaW5nXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciByZWR1Y2VSaWdodCA9IGZ1bmN0aW9uIChiLCBmKSB7XG4gICAgcmV0dXJuIHJlZHVjZVJpZ2h0V2l0aEluZGV4KGIsIGZ1bmN0aW9uIChfLCBhLCBiKSB7IHJldHVybiBmKGEsIGIpOyB9KTtcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBmb2xkaW5nXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciByZWR1Y2VSaWdodFdpdGhJbmRleCA9IGZ1bmN0aW9uIChiLCBmKSB7IHJldHVybiBmdW5jdGlvbiAoZmEpIHtcbiAgICByZXR1cm4gZmEucmVkdWNlUmlnaHQoZnVuY3Rpb24gKGIsIGEsIGkpIHsgcmV0dXJuIGYoaSwgYSwgYik7IH0sIGIpO1xufTsgfTtcbi8qKlxuICogQGNhdGVnb3J5IHRyYXZlcnNpbmdcbiAqIEBzaW5jZSAyLjYuM1xuICovXG5leHBvcnQgdmFyIHRyYXZlcnNlID0gZnVuY3Rpb24gKEYpIHtcbiAgICB2YXIgdHJhdmVyc2VXaXRoSW5kZXhGID0gdHJhdmVyc2VXaXRoSW5kZXgoRik7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChmKSB7IHJldHVybiB0cmF2ZXJzZVdpdGhJbmRleEYoZnVuY3Rpb24gKF8sIGEpIHsgcmV0dXJuIGYoYSk7IH0pOyB9O1xufTtcbi8qKlxuICogQGNhdGVnb3J5IHRyYXZlcnNpbmdcbiAqIEBzaW5jZSAyLjYuM1xuICovXG5leHBvcnQgdmFyIHNlcXVlbmNlID0gZnVuY3Rpb24gKEYpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKHRhKSB7XG4gICAgICAgIHJldHVybiBfcmVkdWNlKHRhLCBGLm9mKHplcm8oKSksIGZ1bmN0aW9uIChmYXMsIGZhKSB7XG4gICAgICAgICAgICByZXR1cm4gRi5hcChGLm1hcChmYXMsIGZ1bmN0aW9uIChhcykgeyByZXR1cm4gZnVuY3Rpb24gKGEpIHsgcmV0dXJuIHBpcGUoYXMsIGFwcGVuZChhKSk7IH07IH0pLCBmYSk7XG4gICAgICAgIH0pO1xuICAgIH07XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgc2VxdWVuY2luZ1xuICogQHNpbmNlIDIuNi4zXG4gKi9cbmV4cG9ydCB2YXIgdHJhdmVyc2VXaXRoSW5kZXggPSBmdW5jdGlvbiAoRikge1xuICAgIHJldHVybiBmdW5jdGlvbiAoZikge1xuICAgICAgICByZXR1cm4gcmVkdWNlV2l0aEluZGV4KEYub2YoemVybygpKSwgZnVuY3Rpb24gKGksIGZicywgYSkge1xuICAgICAgICAgICAgcmV0dXJuIEYuYXAoRi5tYXAoZmJzLCBmdW5jdGlvbiAoYnMpIHsgcmV0dXJuIGZ1bmN0aW9uIChiKSB7IHJldHVybiBwaXBlKGJzLCBhcHBlbmQoYikpOyB9OyB9KSwgZihpLCBhKSk7XG4gICAgICAgIH0pO1xuICAgIH07XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgZmlsdGVyaW5nXG4gKiBAc2luY2UgMi42LjVcbiAqL1xuZXhwb3J0IHZhciB3aXRoZXIgPSBmdW5jdGlvbiAoRikge1xuICAgIHZhciBfd2l0aGVyRiA9IF93aXRoZXIoRik7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChmKSB7IHJldHVybiBmdW5jdGlvbiAoZmEpIHsgcmV0dXJuIF93aXRoZXJGKGZhLCBmKTsgfTsgfTtcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBmaWx0ZXJpbmdcbiAqIEBzaW5jZSAyLjYuNVxuICovXG5leHBvcnQgdmFyIHdpbHQgPSBmdW5jdGlvbiAoRikge1xuICAgIHZhciBfd2lsdEYgPSBfd2lsdChGKTtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGYpIHsgcmV0dXJuIGZ1bmN0aW9uIChmYSkgeyByZXR1cm4gX3dpbHRGKGZhLCBmKTsgfTsgfTtcbn07XG4vKipcbiAqIEBzaW5jZSAyLjYuNlxuICovXG5leHBvcnQgdmFyIHVuZm9sZCA9IGZ1bmN0aW9uIChiLCBmKSB7XG4gICAgdmFyIG91dCA9IFtdO1xuICAgIHZhciBiYiA9IGI7XG4gICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG5vLWNvbnN0YW50LWNvbmRpdGlvblxuICAgIHdoaWxlICh0cnVlKSB7XG4gICAgICAgIHZhciBtdCA9IGYoYmIpO1xuICAgICAgICBpZiAoXy5pc1NvbWUobXQpKSB7XG4gICAgICAgICAgICB2YXIgX2EgPSBtdC52YWx1ZSwgYSA9IF9hWzBdLCBiXzEgPSBfYVsxXTtcbiAgICAgICAgICAgIG91dC5wdXNoKGEpO1xuICAgICAgICAgICAgYmIgPSBiXzE7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gb3V0O1xufTtcbi8qKlxuICogQGNhdGVnb3J5IHR5cGUgbGFtYmRhc1xuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgVVJJID0gJ1JlYWRvbmx5QXJyYXknO1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBnZXRTaG93ID0gZnVuY3Rpb24gKFMpIHsgcmV0dXJuICh7XG4gICAgc2hvdzogZnVuY3Rpb24gKGFzKSB7IHJldHVybiBcIltcIi5jb25jYXQoYXMubWFwKFMuc2hvdykuam9pbignLCAnKSwgXCJdXCIpOyB9XG59KTsgfTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgZ2V0U2VtaWdyb3VwID0gZnVuY3Rpb24gKCkgeyByZXR1cm4gKHtcbiAgICBjb25jYXQ6IGZ1bmN0aW9uIChmaXJzdCwgc2Vjb25kKSB7IHJldHVybiAoaXNFbXB0eShmaXJzdCkgPyBzZWNvbmQgOiBpc0VtcHR5KHNlY29uZCkgPyBmaXJzdCA6IGZpcnN0LmNvbmNhdChzZWNvbmQpKTsgfVxufSk7IH07XG4vKipcbiAqIFJldHVybnMgYSBgTW9ub2lkYCBmb3IgYFJlYWRvbmx5QXJyYXk8QT5gLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBnZXRNb25vaWQgfSBmcm9tICdmcC10cy9SZWFkb25seUFycmF5J1xuICpcbiAqIGNvbnN0IE0gPSBnZXRNb25vaWQ8bnVtYmVyPigpXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKE0uY29uY2F0KFsxLCAyXSwgWzMsIDRdKSwgWzEsIDIsIDMsIDRdKVxuICpcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIGdldE1vbm9pZCA9IGZ1bmN0aW9uICgpIHsgcmV0dXJuICh7XG4gICAgY29uY2F0OiBnZXRTZW1pZ3JvdXAoKS5jb25jYXQsXG4gICAgZW1wdHk6IGVtcHR5XG59KTsgfTtcbi8qKlxuICogRGVyaXZlcyBhbiBgRXFgIG92ZXIgdGhlIGBSZWFkb25seUFycmF5YCBvZiBhIGdpdmVuIGVsZW1lbnQgdHlwZSBmcm9tIHRoZSBgRXFgIG9mIHRoYXQgdHlwZS4gVGhlIGRlcml2ZWQgYEVxYCBkZWZpbmVzIHR3b1xuICogYXJyYXlzIGFzIGVxdWFsIGlmIGFsbCBlbGVtZW50cyBvZiBib3RoIGFycmF5cyBhcmUgY29tcGFyZWQgZXF1YWwgcGFpcndpc2Ugd2l0aCB0aGUgZ2l2ZW4gYEVgLiBJbiBjYXNlIG9mIGFycmF5cyBvZlxuICogZGlmZmVyZW50IGxlbmd0aHMsIHRoZSByZXN1bHQgaXMgbm9uIGVxdWFsaXR5LlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgKiBhcyBTIGZyb20gJ2ZwLXRzL3N0cmluZydcbiAqIGltcG9ydCB7IGdldEVxIH0gZnJvbSAnZnAtdHMvUmVhZG9ubHlBcnJheSdcbiAqXG4gKiBjb25zdCBFID0gZ2V0RXEoUy5FcSlcbiAqIGFzc2VydC5zdHJpY3RFcXVhbChFLmVxdWFscyhbJ2EnLCAnYiddLCBbJ2EnLCAnYiddKSwgdHJ1ZSlcbiAqIGFzc2VydC5zdHJpY3RFcXVhbChFLmVxdWFscyhbJ2EnXSwgW10pLCBmYWxzZSlcbiAqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBnZXRFcSA9IGZ1bmN0aW9uIChFKSB7XG4gICAgcmV0dXJuIGZyb21FcXVhbHMoZnVuY3Rpb24gKHhzLCB5cykgeyByZXR1cm4geHMubGVuZ3RoID09PSB5cy5sZW5ndGggJiYgeHMuZXZlcnkoZnVuY3Rpb24gKHgsIGkpIHsgcmV0dXJuIEUuZXF1YWxzKHgsIHlzW2ldKTsgfSk7IH0pO1xufTtcbi8qKlxuICogRGVyaXZlcyBhbiBgT3JkYCBvdmVyIHRoZSBgUmVhZG9ubHlBcnJheWAgb2YgYSBnaXZlbiBlbGVtZW50IHR5cGUgZnJvbSB0aGUgYE9yZGAgb2YgdGhhdCB0eXBlLiBUaGUgb3JkZXJpbmcgYmV0d2VlbiB0d28gc3VjaFxuICogYXJyYXlzIGlzIGVxdWFsIHRvOiB0aGUgZmlyc3Qgbm9uIGVxdWFsIGNvbXBhcmlzb24gb2YgZWFjaCBhcnJheXMgZWxlbWVudHMgdGFrZW4gcGFpcndpc2UgaW4gaW5jcmVhc2luZyBvcmRlciwgaW5cbiAqIGNhc2Ugb2YgZXF1YWxpdHkgb3ZlciBhbGwgdGhlIHBhaXJ3aXNlIGVsZW1lbnRzOyB0aGUgbG9uZ2VzdCBhcnJheSBpcyBjb25zaWRlcmVkIHRoZSBncmVhdGVzdCwgaWYgYm90aCBhcnJheXMgaGF2ZVxuICogdGhlIHNhbWUgbGVuZ3RoLCB0aGUgcmVzdWx0IGlzIGVxdWFsaXR5LlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBnZXRPcmQgfSBmcm9tICdmcC10cy9SZWFkb25seUFycmF5J1xuICogaW1wb3J0ICogYXMgUyBmcm9tICdmcC10cy9zdHJpbmcnXG4gKlxuICogY29uc3QgTyA9IGdldE9yZChTLk9yZClcbiAqIGFzc2VydC5zdHJpY3RFcXVhbChPLmNvbXBhcmUoWydiJ10sIFsnYSddKSwgMSlcbiAqIGFzc2VydC5zdHJpY3RFcXVhbChPLmNvbXBhcmUoWydhJ10sIFsnYSddKSwgMClcbiAqIGFzc2VydC5zdHJpY3RFcXVhbChPLmNvbXBhcmUoWydhJ10sIFsnYiddKSwgLTEpXG4gKlxuICpcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIGdldE9yZCA9IGZ1bmN0aW9uIChPKSB7XG4gICAgcmV0dXJuIGZyb21Db21wYXJlKGZ1bmN0aW9uIChhLCBiKSB7XG4gICAgICAgIHZhciBhTGVuID0gYS5sZW5ndGg7XG4gICAgICAgIHZhciBiTGVuID0gYi5sZW5ndGg7XG4gICAgICAgIHZhciBsZW4gPSBNYXRoLm1pbihhTGVuLCBiTGVuKTtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBsZW47IGkrKykge1xuICAgICAgICAgICAgdmFyIG9yZGVyaW5nID0gTy5jb21wYXJlKGFbaV0sIGJbaV0pO1xuICAgICAgICAgICAgaWYgKG9yZGVyaW5nICE9PSAwKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG9yZGVyaW5nO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBOLk9yZC5jb21wYXJlKGFMZW4sIGJMZW4pO1xuICAgIH0pO1xufTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIGdldFVuaW9uU2VtaWdyb3VwID0gZnVuY3Rpb24gKEUpIHtcbiAgICB2YXIgdW5pb25FID0gdW5pb24oRSk7XG4gICAgcmV0dXJuIHtcbiAgICAgICAgY29uY2F0OiBmdW5jdGlvbiAoZmlyc3QsIHNlY29uZCkgeyByZXR1cm4gdW5pb25FKHNlY29uZCkoZmlyc3QpOyB9XG4gICAgfTtcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjExLjBcbiAqL1xuZXhwb3J0IHZhciBnZXRVbmlvbk1vbm9pZCA9IGZ1bmN0aW9uIChFKSB7IHJldHVybiAoe1xuICAgIGNvbmNhdDogZ2V0VW5pb25TZW1pZ3JvdXAoRSkuY29uY2F0LFxuICAgIGVtcHR5OiBlbXB0eVxufSk7IH07XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjExLjBcbiAqL1xuZXhwb3J0IHZhciBnZXRJbnRlcnNlY3Rpb25TZW1pZ3JvdXAgPSBmdW5jdGlvbiAoRSkge1xuICAgIHZhciBpbnRlcnNlY3Rpb25FID0gaW50ZXJzZWN0aW9uKEUpO1xuICAgIHJldHVybiB7XG4gICAgICAgIGNvbmNhdDogZnVuY3Rpb24gKGZpcnN0LCBzZWNvbmQpIHsgcmV0dXJuIGludGVyc2VjdGlvbkUoc2Vjb25kKShmaXJzdCk7IH1cbiAgICB9O1xufTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIGdldERpZmZlcmVuY2VNYWdtYSA9IGZ1bmN0aW9uIChFKSB7XG4gICAgdmFyIGRpZmZlcmVuY2VFID0gZGlmZmVyZW5jZShFKTtcbiAgICByZXR1cm4ge1xuICAgICAgICBjb25jYXQ6IGZ1bmN0aW9uIChmaXJzdCwgc2Vjb25kKSB7IHJldHVybiBkaWZmZXJlbmNlRShzZWNvbmQpKGZpcnN0KTsgfVxuICAgIH07XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi43LjBcbiAqL1xuZXhwb3J0IHZhciBGdW5jdG9yID0ge1xuICAgIFVSSTogVVJJLFxuICAgIG1hcDogX21hcFxufTtcbi8qKlxuICogQGNhdGVnb3J5IG1hcHBpbmdcbiAqIEBzaW5jZSAyLjEwLjBcbiAqL1xuZXhwb3J0IHZhciBmbGFwID0gLyojX19QVVJFX18qLyBmbGFwXyhGdW5jdG9yKTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuMTAuMFxuICovXG5leHBvcnQgdmFyIFBvaW50ZWQgPSB7XG4gICAgVVJJOiBVUkksXG4gICAgb2Y6IG9mXG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi43LjBcbiAqL1xuZXhwb3J0IHZhciBGdW5jdG9yV2l0aEluZGV4ID0ge1xuICAgIFVSSTogVVJJLFxuICAgIG1hcDogX21hcCxcbiAgICBtYXBXaXRoSW5kZXg6IF9tYXBXaXRoSW5kZXhcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjEwLjBcbiAqL1xuZXhwb3J0IHZhciBBcHBseSA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICBtYXA6IF9tYXAsXG4gICAgYXA6IF9hcFxufTtcbi8qKlxuICogQ29tYmluZSB0d28gZWZmZWN0ZnVsIGFjdGlvbnMsIGtlZXBpbmcgb25seSB0aGUgcmVzdWx0IG9mIHRoZSBmaXJzdC5cbiAqXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBhcEZpcnN0ID0gLyojX19QVVJFX18qLyBhcEZpcnN0XyhBcHBseSk7XG4vKipcbiAqIENvbWJpbmUgdHdvIGVmZmVjdGZ1bCBhY3Rpb25zLCBrZWVwaW5nIG9ubHkgdGhlIHJlc3VsdCBvZiB0aGUgc2Vjb25kLlxuICpcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIGFwU2Vjb25kID0gLyojX19QVVJFX18qLyBhcFNlY29uZF8oQXBwbHkpO1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi43LjBcbiAqL1xuZXhwb3J0IHZhciBBcHBsaWNhdGl2ZSA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICBtYXA6IF9tYXAsXG4gICAgYXA6IF9hcCxcbiAgICBvZjogb2Zcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjEwLjBcbiAqL1xuZXhwb3J0IHZhciBDaGFpbiA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICBtYXA6IF9tYXAsXG4gICAgYXA6IF9hcCxcbiAgICBjaGFpbjogZmxhdE1hcFxufTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuNy4wXG4gKi9cbmV4cG9ydCB2YXIgTW9uYWQgPSB7XG4gICAgVVJJOiBVUkksXG4gICAgbWFwOiBfbWFwLFxuICAgIGFwOiBfYXAsXG4gICAgb2Y6IG9mLFxuICAgIGNoYWluOiBmbGF0TWFwXG59O1xuLyoqXG4gKiBDb21wb3NlcyBjb21wdXRhdGlvbnMgaW4gc2VxdWVuY2UsIHVzaW5nIHRoZSByZXR1cm4gdmFsdWUgb2Ygb25lIGNvbXB1dGF0aW9uIHRvIGRldGVybWluZSB0aGUgbmV4dCBjb21wdXRhdGlvbiBhbmRcbiAqIGtlZXBpbmcgb25seSB0aGUgcmVzdWx0IG9mIHRoZSBmaXJzdC5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0ICogYXMgUkEgZnJvbSAnZnAtdHMvUmVhZG9ubHlBcnJheSdcbiAqIGltcG9ydCB7IHBpcGUgfSBmcm9tICdmcC10cy9mdW5jdGlvbidcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKFxuICogICBwaXBlKFxuICogICAgIFsxLCAyLCAzXSxcbiAqICAgICBSQS5jaGFpbkZpcnN0KCgpID0+IFsnYScsICdiJ10pXG4gKiAgICksXG4gKiAgIFsxLCAxLCAyLCAyLCAzLCAzXVxuICogKVxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChcbiAqICAgcGlwZShcbiAqICAgICBbMSwgMiwgM10sXG4gKiAgICAgUkEuY2hhaW5GaXJzdCgoKSA9PiBbXSlcbiAqICAgKSxcbiAqICAgW11cbiAqIClcbiAqXG4gKiBAY2F0ZWdvcnkgc2VxdWVuY2luZ1xuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgY2hhaW5GaXJzdCA9IFxuLyojX19QVVJFX18qLyBjaGFpbkZpcnN0XyhDaGFpbik7XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjcuMFxuICovXG5leHBvcnQgdmFyIFVuZm9sZGFibGUgPSB7XG4gICAgVVJJOiBVUkksXG4gICAgdW5mb2xkOiB1bmZvbGRcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjcuMFxuICovXG5leHBvcnQgdmFyIEFsdCA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICBtYXA6IF9tYXAsXG4gICAgYWx0OiBfYWx0XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi4xMS4wXG4gKi9cbmV4cG9ydCB2YXIgWmVybyA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICB6ZXJvOiB6ZXJvXG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgZG8gbm90YXRpb25cbiAqIEBzaW5jZSAyLjExLjBcbiAqL1xuZXhwb3J0IHZhciBndWFyZCA9IC8qI19fUFVSRV9fKi8gZ3VhcmRfKFplcm8sIFBvaW50ZWQpO1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi43LjBcbiAqL1xuZXhwb3J0IHZhciBBbHRlcm5hdGl2ZSA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICBtYXA6IF9tYXAsXG4gICAgYXA6IF9hcCxcbiAgICBvZjogb2YsXG4gICAgYWx0OiBfYWx0LFxuICAgIHplcm86IHplcm9cbn07XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjcuMFxuICovXG5leHBvcnQgdmFyIEV4dGVuZCA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICBtYXA6IF9tYXAsXG4gICAgZXh0ZW5kOiBfZXh0ZW5kXG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi43LjBcbiAqL1xuZXhwb3J0IHZhciBDb21wYWN0YWJsZSA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICBjb21wYWN0OiBjb21wYWN0LFxuICAgIHNlcGFyYXRlOiBzZXBhcmF0ZVxufTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuNy4wXG4gKi9cbmV4cG9ydCB2YXIgRmlsdGVyYWJsZSA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICBtYXA6IF9tYXAsXG4gICAgY29tcGFjdDogY29tcGFjdCxcbiAgICBzZXBhcmF0ZTogc2VwYXJhdGUsXG4gICAgZmlsdGVyOiBfZmlsdGVyLFxuICAgIGZpbHRlck1hcDogX2ZpbHRlck1hcCxcbiAgICBwYXJ0aXRpb246IF9wYXJ0aXRpb24sXG4gICAgcGFydGl0aW9uTWFwOiBfcGFydGl0aW9uTWFwXG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi43LjBcbiAqL1xuZXhwb3J0IHZhciBGaWx0ZXJhYmxlV2l0aEluZGV4ID0ge1xuICAgIFVSSTogVVJJLFxuICAgIG1hcDogX21hcCxcbiAgICBtYXBXaXRoSW5kZXg6IF9tYXBXaXRoSW5kZXgsXG4gICAgY29tcGFjdDogY29tcGFjdCxcbiAgICBzZXBhcmF0ZTogc2VwYXJhdGUsXG4gICAgZmlsdGVyOiBfZmlsdGVyLFxuICAgIGZpbHRlck1hcDogX2ZpbHRlck1hcCxcbiAgICBwYXJ0aXRpb246IF9wYXJ0aXRpb24sXG4gICAgcGFydGl0aW9uTWFwOiBfcGFydGl0aW9uTWFwLFxuICAgIHBhcnRpdGlvbk1hcFdpdGhJbmRleDogX3BhcnRpdGlvbk1hcFdpdGhJbmRleCxcbiAgICBwYXJ0aXRpb25XaXRoSW5kZXg6IF9wYXJ0aXRpb25XaXRoSW5kZXgsXG4gICAgZmlsdGVyTWFwV2l0aEluZGV4OiBfZmlsdGVyTWFwV2l0aEluZGV4LFxuICAgIGZpbHRlcldpdGhJbmRleDogX2ZpbHRlcldpdGhJbmRleFxufTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuNy4wXG4gKi9cbmV4cG9ydCB2YXIgRm9sZGFibGUgPSB7XG4gICAgVVJJOiBVUkksXG4gICAgcmVkdWNlOiBfcmVkdWNlLFxuICAgIGZvbGRNYXA6IF9mb2xkTWFwLFxuICAgIHJlZHVjZVJpZ2h0OiBfcmVkdWNlUmlnaHRcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjcuMFxuICovXG5leHBvcnQgdmFyIEZvbGRhYmxlV2l0aEluZGV4ID0ge1xuICAgIFVSSTogVVJJLFxuICAgIHJlZHVjZTogX3JlZHVjZSxcbiAgICBmb2xkTWFwOiBfZm9sZE1hcCxcbiAgICByZWR1Y2VSaWdodDogX3JlZHVjZVJpZ2h0LFxuICAgIHJlZHVjZVdpdGhJbmRleDogX3JlZHVjZVdpdGhJbmRleCxcbiAgICBmb2xkTWFwV2l0aEluZGV4OiBfZm9sZE1hcFdpdGhJbmRleCxcbiAgICByZWR1Y2VSaWdodFdpdGhJbmRleDogX3JlZHVjZVJpZ2h0V2l0aEluZGV4XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi43LjBcbiAqL1xuZXhwb3J0IHZhciBUcmF2ZXJzYWJsZSA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICBtYXA6IF9tYXAsXG4gICAgcmVkdWNlOiBfcmVkdWNlLFxuICAgIGZvbGRNYXA6IF9mb2xkTWFwLFxuICAgIHJlZHVjZVJpZ2h0OiBfcmVkdWNlUmlnaHQsXG4gICAgdHJhdmVyc2U6IF90cmF2ZXJzZSxcbiAgICBzZXF1ZW5jZTogc2VxdWVuY2Vcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjcuMFxuICovXG5leHBvcnQgdmFyIFRyYXZlcnNhYmxlV2l0aEluZGV4ID0ge1xuICAgIFVSSTogVVJJLFxuICAgIG1hcDogX21hcCxcbiAgICBtYXBXaXRoSW5kZXg6IF9tYXBXaXRoSW5kZXgsXG4gICAgcmVkdWNlOiBfcmVkdWNlLFxuICAgIGZvbGRNYXA6IF9mb2xkTWFwLFxuICAgIHJlZHVjZVJpZ2h0OiBfcmVkdWNlUmlnaHQsXG4gICAgcmVkdWNlV2l0aEluZGV4OiBfcmVkdWNlV2l0aEluZGV4LFxuICAgIGZvbGRNYXBXaXRoSW5kZXg6IF9mb2xkTWFwV2l0aEluZGV4LFxuICAgIHJlZHVjZVJpZ2h0V2l0aEluZGV4OiBfcmVkdWNlUmlnaHRXaXRoSW5kZXgsXG4gICAgdHJhdmVyc2U6IF90cmF2ZXJzZSxcbiAgICBzZXF1ZW5jZTogc2VxdWVuY2UsXG4gICAgdHJhdmVyc2VXaXRoSW5kZXg6IF90cmF2ZXJzZVdpdGhJbmRleFxufTtcbi8qKlxuICogQGNhdGVnb3J5IHNlcXVlbmNpbmdcbiAqIEBzaW5jZSAyLjExLjBcbiAqL1xuZXhwb3J0IHZhciBjaGFpblJlY0RlcHRoRmlyc3QgPSBmdW5jdGlvbiAoZikge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYSkge1xuICAgICAgICB2YXIgdG9kbyA9IF9fc3ByZWFkQXJyYXkoW10sIGYoYSksIHRydWUpO1xuICAgICAgICB2YXIgb3V0ID0gW107XG4gICAgICAgIHdoaWxlICh0b2RvLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgIHZhciBlID0gdG9kby5zaGlmdCgpO1xuICAgICAgICAgICAgaWYgKF8uaXNMZWZ0KGUpKSB7XG4gICAgICAgICAgICAgICAgdG9kby51bnNoaWZ0LmFwcGx5KHRvZG8sIGYoZS5sZWZ0KSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBvdXQucHVzaChlLnJpZ2h0KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gb3V0O1xuICAgIH07XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi4xMS4wXG4gKi9cbmV4cG9ydCB2YXIgQ2hhaW5SZWNEZXB0aEZpcnN0ID0ge1xuICAgIFVSSTogVVJJLFxuICAgIG1hcDogX21hcCxcbiAgICBhcDogX2FwLFxuICAgIGNoYWluOiBmbGF0TWFwLFxuICAgIGNoYWluUmVjOiBfY2hhaW5SZWNEZXB0aEZpcnN0XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgc2VxdWVuY2luZ1xuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIGNoYWluUmVjQnJlYWR0aEZpcnN0ID0gZnVuY3Rpb24gKGYpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGEpIHtcbiAgICAgICAgdmFyIGluaXRpYWwgPSBmKGEpO1xuICAgICAgICB2YXIgdG9kbyA9IFtdO1xuICAgICAgICB2YXIgb3V0ID0gW107XG4gICAgICAgIGZ1bmN0aW9uIGdvKGUpIHtcbiAgICAgICAgICAgIGlmIChfLmlzTGVmdChlKSkge1xuICAgICAgICAgICAgICAgIGYoZS5sZWZ0KS5mb3JFYWNoKGZ1bmN0aW9uICh2KSB7IHJldHVybiB0b2RvLnB1c2godik7IH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgb3V0LnB1c2goZS5yaWdodCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZm9yICh2YXIgX2kgPSAwLCBpbml0aWFsXzEgPSBpbml0aWFsOyBfaSA8IGluaXRpYWxfMS5sZW5ndGg7IF9pKyspIHtcbiAgICAgICAgICAgIHZhciBlID0gaW5pdGlhbF8xW19pXTtcbiAgICAgICAgICAgIGdvKGUpO1xuICAgICAgICB9XG4gICAgICAgIHdoaWxlICh0b2RvLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgIGdvKHRvZG8uc2hpZnQoKSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG91dDtcbiAgICB9O1xufTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIENoYWluUmVjQnJlYWR0aEZpcnN0ID0ge1xuICAgIFVSSTogVVJJLFxuICAgIG1hcDogX21hcCxcbiAgICBhcDogX2FwLFxuICAgIGNoYWluOiBmbGF0TWFwLFxuICAgIGNoYWluUmVjOiBfY2hhaW5SZWNCcmVhZHRoRmlyc3Rcbn07XG52YXIgX3dpdGhlciA9IC8qI19fUFVSRV9fKi8gd2l0aGVyRGVmYXVsdChUcmF2ZXJzYWJsZSwgQ29tcGFjdGFibGUpO1xudmFyIF93aWx0ID0gLyojX19QVVJFX18qLyB3aWx0RGVmYXVsdChUcmF2ZXJzYWJsZSwgQ29tcGFjdGFibGUpO1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi43LjBcbiAqL1xuZXhwb3J0IHZhciBXaXRoZXJhYmxlID0ge1xuICAgIFVSSTogVVJJLFxuICAgIG1hcDogX21hcCxcbiAgICBjb21wYWN0OiBjb21wYWN0LFxuICAgIHNlcGFyYXRlOiBzZXBhcmF0ZSxcbiAgICBmaWx0ZXI6IF9maWx0ZXIsXG4gICAgZmlsdGVyTWFwOiBfZmlsdGVyTWFwLFxuICAgIHBhcnRpdGlvbjogX3BhcnRpdGlvbixcbiAgICBwYXJ0aXRpb25NYXA6IF9wYXJ0aXRpb25NYXAsXG4gICAgcmVkdWNlOiBfcmVkdWNlLFxuICAgIGZvbGRNYXA6IF9mb2xkTWFwLFxuICAgIHJlZHVjZVJpZ2h0OiBfcmVkdWNlUmlnaHQsXG4gICAgdHJhdmVyc2U6IF90cmF2ZXJzZSxcbiAgICBzZXF1ZW5jZTogc2VxdWVuY2UsXG4gICAgd2l0aGVyOiBfd2l0aGVyLFxuICAgIHdpbHQ6IF93aWx0XG59O1xuLyoqXG4gKiBGaWx0ZXIgdmFsdWVzIGluc2lkZSBhIGNvbnRleHQuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IHBpcGUgfSBmcm9tICdmcC10cy9mdW5jdGlvbidcbiAqIGltcG9ydCAqIGFzIFJBIGZyb20gJ2ZwLXRzL1JlYWRvbmx5QXJyYXknXG4gKiBpbXBvcnQgKiBhcyBUIGZyb20gJ2ZwLXRzL1Rhc2snXG4gKlxuICogY29uc3QgZmlsdGVyRSA9IFJBLmZpbHRlckUoVC5BcHBsaWNhdGl2ZVBhcilcbiAqIGFzeW5jIGZ1bmN0aW9uIHRlc3QoKSB7XG4gKiAgIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoXG4gKiAgICAgYXdhaXQgcGlwZShcbiAqICAgICAgIFstMSwgMiwgM10sXG4gKiAgICAgICBmaWx0ZXJFKChuKSA9PiBULm9mKG4gPiAwKSlcbiAqICAgICApKCksXG4gKiAgICAgWzIsIDNdXG4gKiAgIClcbiAqIH1cbiAqIHRlc3QoKVxuICpcbiAqIEBzaW5jZSAyLjExLjBcbiAqL1xuZXhwb3J0IHZhciBmaWx0ZXJFID0gLyojX19QVVJFX18qLyBmaWx0ZXJFXyhXaXRoZXJhYmxlKTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIEZyb21FaXRoZXIgPSB7XG4gICAgVVJJOiBVUkksXG4gICAgZnJvbUVpdGhlcjogZnJvbUVpdGhlclxufTtcbi8qKlxuICogQGNhdGVnb3J5IGxpZnRpbmdcbiAqIEBzaW5jZSAyLjExLjBcbiAqL1xuZXhwb3J0IHZhciBmcm9tRWl0aGVySyA9IC8qI19fUFVSRV9fKi8gZnJvbUVpdGhlcktfKEZyb21FaXRoZXIpO1xuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLy8gdW5zYWZlXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vKipcbiAqIEBjYXRlZ29yeSB1bnNhZmVcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIHVuc2FmZUluc2VydEF0ID0gUk5FQS51bnNhZmVJbnNlcnRBdDtcbi8qKlxuICogQGNhdGVnb3J5IHVuc2FmZVxuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgdW5zYWZlVXBkYXRlQXQgPSBmdW5jdGlvbiAoaSwgYSwgYXMpIHtcbiAgICByZXR1cm4gaXNOb25FbXB0eShhcykgPyBSTkVBLnVuc2FmZVVwZGF0ZUF0KGksIGEsIGFzKSA6IGFzO1xufTtcbi8qKlxuICogQGNhdGVnb3J5IHVuc2FmZVxuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgdW5zYWZlRGVsZXRlQXQgPSBmdW5jdGlvbiAoaSwgYXMpIHtcbiAgICB2YXIgeHMgPSBhcy5zbGljZSgpO1xuICAgIHhzLnNwbGljZShpLCAxKTtcbiAgICByZXR1cm4geHM7XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgY29udmVyc2lvbnNcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIHRvQXJyYXkgPSBmdW5jdGlvbiAoYXMpIHsgcmV0dXJuIGFzLnNsaWNlKCk7IH07XG4vKipcbiAqIEBjYXRlZ29yeSBjb252ZXJzaW9uc1xuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgZnJvbUFycmF5ID0gZnVuY3Rpb24gKGFzKSB7IHJldHVybiAoaXNFbXB0eShhcykgPyBlbXB0eSA6IGFzLnNsaWNlKCkpOyB9O1xuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLy8gdXRpbHNcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8qKlxuICogQW4gZW1wdHkgYXJyYXlcbiAqXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBlbXB0eSA9IFJORUEuZW1wdHk7XG5leHBvcnQgZnVuY3Rpb24gZXZlcnkocHJlZGljYXRlKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykgeyByZXR1cm4gYXMuZXZlcnkocHJlZGljYXRlKTsgfTtcbn1cbi8qKlxuICogQ2hlY2sgaWYgYSBwcmVkaWNhdGUgaG9sZHMgdHJ1ZSBmb3IgYW55IGFycmF5IG1lbWJlci5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgc29tZSB9IGZyb20gJ2ZwLXRzL1JlYWRvbmx5QXJyYXknXG4gKiBpbXBvcnQgeyBwaXBlIH0gZnJvbSAnZnAtdHMvZnVuY3Rpb24nXG4gKlxuICogY29uc3QgaXNQb3NpdGl2ZSA9IChuOiBudW1iZXIpOiBib29sZWFuID0+IG4gPiAwXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChwaXBlKFstMSwgLTIsIDNdLCBzb21lKGlzUG9zaXRpdmUpKSwgdHJ1ZSlcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwocGlwZShbLTEsIC0yLCAtM10sIHNvbWUoaXNQb3NpdGl2ZSkpLCBmYWxzZSlcbiAqXG4gKiBAc2luY2UgMi45LjBcbiAqL1xuZXhwb3J0IHZhciBzb21lID0gZnVuY3Rpb24gKHByZWRpY2F0ZSkge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgcmV0dXJuIGFzLnNvbWUocHJlZGljYXRlKTtcbiAgICB9O1xufTtcbi8qKlxuICogQWxpYXMgb2YgW2Bzb21lYF0oI3NvbWUpXG4gKlxuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIGV4aXN0cyA9IHNvbWU7XG4vKipcbiAqIFBsYWNlcyBhbiBlbGVtZW50IGluIGJldHdlZW4gbWVtYmVycyBvZiBhIGBSZWFkb25seUFycmF5YCwgdGhlbiBmb2xkcyB0aGUgcmVzdWx0cyB1c2luZyB0aGUgcHJvdmlkZWQgYE1vbm9pZGAuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCAqIGFzIFMgZnJvbSAnZnAtdHMvc3RyaW5nJ1xuICogaW1wb3J0IHsgaW50ZXJjYWxhdGUgfSBmcm9tICdmcC10cy9SZWFkb25seUFycmF5J1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoaW50ZXJjYWxhdGUoUy5Nb25vaWQpKCctJykoWydhJywgJ2InLCAnYyddKSwgJ2EtYi1jJylcbiAqXG4gKiBAc2luY2UgMi4xMi4wXG4gKi9cbmV4cG9ydCB2YXIgaW50ZXJjYWxhdGUgPSBmdW5jdGlvbiAoTSkge1xuICAgIHZhciBpbnRlcmNhbGF0ZU0gPSBSTkVBLmludGVyY2FsYXRlKE0pO1xuICAgIHJldHVybiBmdW5jdGlvbiAobWlkZGxlKSB7IHJldHVybiBtYXRjaChmdW5jdGlvbiAoKSB7IHJldHVybiBNLmVtcHR5OyB9LCBpbnRlcmNhbGF0ZU0obWlkZGxlKSk7IH07XG59O1xuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLy8gZG8gbm90YXRpb25cbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8qKlxuICogQGNhdGVnb3J5IGRvIG5vdGF0aW9uXG4gKiBAc2luY2UgMi45LjBcbiAqL1xuZXhwb3J0IHZhciBEbyA9IC8qI19fUFVSRV9fKi8gb2YoXy5lbXB0eVJlY29yZCk7XG4vKipcbiAqIEBjYXRlZ29yeSBkbyBub3RhdGlvblxuICogQHNpbmNlIDIuOC4wXG4gKi9cbmV4cG9ydCB2YXIgYmluZFRvID0gLyojX19QVVJFX18qLyBiaW5kVG9fKEZ1bmN0b3IpO1xudmFyIGxldF8gPSAvKiNfX1BVUkVfXyovIGxldF9fKEZ1bmN0b3IpO1xuZXhwb3J0IHsgXG4vKipcbiAqIEBjYXRlZ29yeSBkbyBub3RhdGlvblxuICogQHNpbmNlIDIuMTMuMFxuICovXG5sZXRfIGFzIGxldCB9O1xuLyoqXG4gKiBAY2F0ZWdvcnkgZG8gbm90YXRpb25cbiAqIEBzaW5jZSAyLjguMFxuICovXG5leHBvcnQgdmFyIGJpbmQgPSAvKiNfX1BVUkVfXyovIGJpbmRfKENoYWluKTtcbi8qKlxuICogQGNhdGVnb3J5IGRvIG5vdGF0aW9uXG4gKiBAc2luY2UgMi44LjBcbiAqL1xuZXhwb3J0IHZhciBhcFMgPSAvKiNfX1BVUkVfXyovIGFwU18oQXBwbHkpO1xuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLy8gbGVnYWN5XG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vKipcbiAqIEFsaWFzIG9mIGBmbGF0TWFwYC5cbiAqXG4gKiBAY2F0ZWdvcnkgbGVnYWN5XG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBjaGFpbiA9IGZsYXRNYXA7XG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vLyBkZXByZWNhdGVkXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vKipcbiAqIFVzZSBgUmVhZG9ubHlOb25FbXB0eUFycmF5YCBtb2R1bGUgaW5zdGVhZC5cbiAqXG4gKiBAY2F0ZWdvcnkgem9uZSBvZiBkZWF0aFxuICogQHNpbmNlIDIuNS4wXG4gKiBAZGVwcmVjYXRlZFxuICovXG5leHBvcnQgdmFyIHJhbmdlID0gUk5FQS5yYW5nZTtcbi8qKlxuICogVXNlIFtgcHJlcGVuZGBdKCNwcmVwZW5kKSBpbnN0ZWFkLlxuICpcbiAqIEBjYXRlZ29yeSB6b25lIG9mIGRlYXRoXG4gKiBAc2luY2UgMi41LjBcbiAqIEBkZXByZWNhdGVkXG4gKi9cbmV4cG9ydCB2YXIgY29ucyA9IFJORUEuY29ucztcbi8qKlxuICogVXNlIFtgYXBwZW5kYF0oI2FwcGVuZCkgaW5zdGVhZC5cbiAqXG4gKiBAY2F0ZWdvcnkgem9uZSBvZiBkZWF0aFxuICogQHNpbmNlIDIuNS4wXG4gKiBAZGVwcmVjYXRlZFxuICovXG5leHBvcnQgdmFyIHNub2MgPSBSTkVBLnNub2M7XG4vKipcbiAqIFVzZSBbYHByZXBlbmRBbGxgXSgjcHJlcGVuZGFsbCkgaW5zdGVhZC5cbiAqXG4gKiBAY2F0ZWdvcnkgem9uZSBvZiBkZWF0aFxuICogQHNpbmNlIDIuOS4wXG4gKiBAZGVwcmVjYXRlZFxuICovXG5leHBvcnQgdmFyIHByZXBlbmRUb0FsbCA9IHByZXBlbmRBbGw7XG4vKipcbiAqIFRoaXMgaW5zdGFuY2UgaXMgZGVwcmVjYXRlZCwgdXNlIHNtYWxsLCBzcGVjaWZpYyBpbnN0YW5jZXMgaW5zdGVhZC5cbiAqIEZvciBleGFtcGxlIGlmIGEgZnVuY3Rpb24gbmVlZHMgYSBgRnVuY3RvcmAgaW5zdGFuY2UsIHBhc3MgYFJBLkZ1bmN0b3JgIGluc3RlYWQgb2YgYFJBLnJlYWRvbmx5QXJyYXlgXG4gKiAod2hlcmUgYFJBYCBpcyBmcm9tIGBpbXBvcnQgUkEgZnJvbSAnZnAtdHMvUmVhZG9ubHlBcnJheSdgKVxuICpcbiAqIEBjYXRlZ29yeSB6b25lIG9mIGRlYXRoXG4gKiBAc2luY2UgMi41LjBcbiAqIEBkZXByZWNhdGVkXG4gKi9cbmV4cG9ydCB2YXIgcmVhZG9ubHlBcnJheSA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICBjb21wYWN0OiBjb21wYWN0LFxuICAgIHNlcGFyYXRlOiBzZXBhcmF0ZSxcbiAgICBtYXA6IF9tYXAsXG4gICAgYXA6IF9hcCxcbiAgICBvZjogb2YsXG4gICAgY2hhaW46IGZsYXRNYXAsXG4gICAgZmlsdGVyOiBfZmlsdGVyLFxuICAgIGZpbHRlck1hcDogX2ZpbHRlck1hcCxcbiAgICBwYXJ0aXRpb246IF9wYXJ0aXRpb24sXG4gICAgcGFydGl0aW9uTWFwOiBfcGFydGl0aW9uTWFwLFxuICAgIG1hcFdpdGhJbmRleDogX21hcFdpdGhJbmRleCxcbiAgICBwYXJ0aXRpb25NYXBXaXRoSW5kZXg6IF9wYXJ0aXRpb25NYXBXaXRoSW5kZXgsXG4gICAgcGFydGl0aW9uV2l0aEluZGV4OiBfcGFydGl0aW9uV2l0aEluZGV4LFxuICAgIGZpbHRlck1hcFdpdGhJbmRleDogX2ZpbHRlck1hcFdpdGhJbmRleCxcbiAgICBmaWx0ZXJXaXRoSW5kZXg6IF9maWx0ZXJXaXRoSW5kZXgsXG4gICAgYWx0OiBfYWx0LFxuICAgIHplcm86IHplcm8sXG4gICAgdW5mb2xkOiB1bmZvbGQsXG4gICAgcmVkdWNlOiBfcmVkdWNlLFxuICAgIGZvbGRNYXA6IF9mb2xkTWFwLFxuICAgIHJlZHVjZVJpZ2h0OiBfcmVkdWNlUmlnaHQsXG4gICAgdHJhdmVyc2U6IF90cmF2ZXJzZSxcbiAgICBzZXF1ZW5jZTogc2VxdWVuY2UsXG4gICAgcmVkdWNlV2l0aEluZGV4OiBfcmVkdWNlV2l0aEluZGV4LFxuICAgIGZvbGRNYXBXaXRoSW5kZXg6IF9mb2xkTWFwV2l0aEluZGV4LFxuICAgIHJlZHVjZVJpZ2h0V2l0aEluZGV4OiBfcmVkdWNlUmlnaHRXaXRoSW5kZXgsXG4gICAgdHJhdmVyc2VXaXRoSW5kZXg6IF90cmF2ZXJzZVdpdGhJbmRleCxcbiAgICBleHRlbmQ6IF9leHRlbmQsXG4gICAgd2l0aGVyOiBfd2l0aGVyLFxuICAgIHdpbHQ6IF93aWx0XG59O1xuIiwKICAidmFyIF9fc3ByZWFkQXJyYXkgPSAodGhpcyAmJiB0aGlzLl9fc3ByZWFkQXJyYXkpIHx8IGZ1bmN0aW9uICh0bywgZnJvbSwgcGFjaykge1xuICAgIGlmIChwYWNrIHx8IGFyZ3VtZW50cy5sZW5ndGggPT09IDIpIGZvciAodmFyIGkgPSAwLCBsID0gZnJvbS5sZW5ndGgsIGFyOyBpIDwgbDsgaSsrKSB7XG4gICAgICAgIGlmIChhciB8fCAhKGkgaW4gZnJvbSkpIHtcbiAgICAgICAgICAgIGlmICghYXIpIGFyID0gQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoZnJvbSwgMCwgaSk7XG4gICAgICAgICAgICBhcltpXSA9IGZyb21baV07XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHRvLmNvbmNhdChhciB8fCBBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChmcm9tKSk7XG59O1xuaW1wb3J0IHsgYXBGaXJzdCBhcyBhcEZpcnN0XywgYXBTIGFzIGFwU18sIGFwU2Vjb25kIGFzIGFwU2Vjb25kXyB9IGZyb20gJy4vQXBwbHknO1xuaW1wb3J0IHsgYmluZCBhcyBiaW5kXywgY2hhaW5GaXJzdCBhcyBjaGFpbkZpcnN0XyB9IGZyb20gJy4vQ2hhaW4nO1xuaW1wb3J0IHsgZnJvbUVxdWFscyB9IGZyb20gJy4vRXEnO1xuaW1wb3J0IHsgZnJvbUVpdGhlcksgYXMgZnJvbUVpdGhlcktfIH0gZnJvbSAnLi9Gcm9tRWl0aGVyJztcbmltcG9ydCB7IGR1YWwsIGlkZW50aXR5LCBwaXBlIH0gZnJvbSAnLi9mdW5jdGlvbic7XG5pbXBvcnQgeyBiaW5kVG8gYXMgYmluZFRvXywgZmxhcCBhcyBmbGFwXywgbGV0IGFzIGxldF9fIH0gZnJvbSAnLi9GdW5jdG9yJztcbmltcG9ydCAqIGFzIF8gZnJvbSAnLi9pbnRlcm5hbCc7XG5pbXBvcnQgKiBhcyBOIGZyb20gJy4vbnVtYmVyJztcbmltcG9ydCB7IGZyb21Db21wYXJlIH0gZnJvbSAnLi9PcmQnO1xuaW1wb3J0ICogYXMgUk5FQSBmcm9tICcuL1JlYWRvbmx5Tm9uRW1wdHlBcnJheSc7XG5pbXBvcnQgeyBzZXBhcmF0ZWQgfSBmcm9tICcuL1NlcGFyYXRlZCc7XG5pbXBvcnQgeyBmaWx0ZXJFIGFzIGZpbHRlckVfLCB3aWx0RGVmYXVsdCwgd2l0aGVyRGVmYXVsdCB9IGZyb20gJy4vV2l0aGVyYWJsZSc7XG5pbXBvcnQgeyBndWFyZCBhcyBndWFyZF8gfSBmcm9tICcuL1plcm8nO1xuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLy8gcmVmaW5lbWVudHNcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8qKlxuICogVGVzdCB3aGV0aGVyIGEgYFJlYWRvbmx5QXJyYXlgIGlzIGVtcHR5LlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBpc0VtcHR5IH0gZnJvbSAnZnAtdHMvUmVhZG9ubHlBcnJheSdcbiAqXG4gKiBhc3NlcnQuc3RyaWN0RXF1YWwoaXNFbXB0eShbXSksIHRydWUpXG4gKlxuICogQGNhdGVnb3J5IHJlZmluZW1lbnRzXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBpc0VtcHR5ID0gZnVuY3Rpb24gKGFzKSB7IHJldHVybiBhcy5sZW5ndGggPT09IDA7IH07XG4vKipcbiAqIFRlc3Qgd2hldGhlciBhIGBSZWFkb25seUFycmF5YCBpcyBub24gZW1wdHkuXG4gKlxuICogQGNhdGVnb3J5IHJlZmluZW1lbnRzXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBpc05vbkVtcHR5ID0gUk5FQS5pc05vbkVtcHR5O1xuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLy8gY29uc3RydWN0b3JzXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vKipcbiAqIFByZXBlbmQgYW4gZWxlbWVudCB0byB0aGUgZnJvbnQgb2YgYSBgUmVhZG9ubHlBcnJheWAsIGNyZWF0aW5nIGEgbmV3IGBSZWFkb25seU5vbkVtcHR5QXJyYXlgLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBwcmVwZW5kIH0gZnJvbSAnZnAtdHMvUmVhZG9ubHlBcnJheSdcbiAqIGltcG9ydCB7IHBpcGUgfSBmcm9tICdmcC10cy9mdW5jdGlvbidcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKHBpcGUoWzIsIDMsIDRdLCBwcmVwZW5kKDEpKSwgWzEsIDIsIDMsIDRdKVxuICpcbiAqIEBzaW5jZSAyLjEwLjBcbiAqL1xuZXhwb3J0IHZhciBwcmVwZW5kID0gUk5FQS5wcmVwZW5kO1xuLyoqXG4gKiBMZXNzIHN0cmljdCB2ZXJzaW9uIG9mIFtgcHJlcGVuZGBdKCNwcmVwZW5kKS5cbiAqXG4gKiBAc2luY2UgMi4xMS4wXG4gKi9cbmV4cG9ydCB2YXIgcHJlcGVuZFcgPSBSTkVBLnByZXBlbmRXO1xuLyoqXG4gKiBBcHBlbmQgYW4gZWxlbWVudCB0byB0aGUgZW5kIG9mIGEgYFJlYWRvbmx5QXJyYXlgLCBjcmVhdGluZyBhIG5ldyBgUmVhZG9ubHlOb25FbXB0eUFycmF5YC5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgYXBwZW5kIH0gZnJvbSAnZnAtdHMvUmVhZG9ubHlBcnJheSdcbiAqIGltcG9ydCB7IHBpcGUgfSBmcm9tICdmcC10cy9mdW5jdGlvbidcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKHBpcGUoWzEsIDIsIDNdLCBhcHBlbmQoNCkpLCBbMSwgMiwgMywgNF0pXG4gKlxuICogQHNpbmNlIDIuMTAuMFxuICovXG5leHBvcnQgdmFyIGFwcGVuZCA9IFJORUEuYXBwZW5kO1xuLyoqXG4gKiBMZXNzIHN0cmljdCB2ZXJzaW9uIG9mIFtgYXBwZW5kYF0oI2FwcGVuZCkuXG4gKlxuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIGFwcGVuZFcgPSBSTkVBLmFwcGVuZFc7XG4vKipcbiAqIFJldHVybiBhIGBSZWFkb25seUFycmF5YCBvZiBsZW5ndGggYG5gIHdpdGggZWxlbWVudCBgaWAgaW5pdGlhbGl6ZWQgd2l0aCBgZihpKWAuXG4gKlxuICogKipOb3RlKiouIGBuYCBpcyBub3JtYWxpemVkIHRvIGEgbm9uIG5lZ2F0aXZlIGludGVnZXIuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IG1ha2VCeSB9IGZyb20gJ2ZwLXRzL1JlYWRvbmx5QXJyYXknXG4gKlxuICogY29uc3QgZG91YmxlID0gKG46IG51bWJlcik6IG51bWJlciA9PiBuICogMlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChtYWtlQnkoNSwgZG91YmxlKSwgWzAsIDIsIDQsIDYsIDhdKVxuICpcbiAqIEBjYXRlZ29yeSBjb25zdHJ1Y3RvcnNcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIG1ha2VCeSA9IGZ1bmN0aW9uIChuLCBmKSB7IHJldHVybiAobiA8PSAwID8gZW1wdHkgOiBSTkVBLm1ha2VCeShmKShuKSk7IH07XG4vKipcbiAqIENyZWF0ZSBhIGBSZWFkb25seUFycmF5YCBjb250YWluaW5nIGEgdmFsdWUgcmVwZWF0ZWQgdGhlIHNwZWNpZmllZCBudW1iZXIgb2YgdGltZXMuXG4gKlxuICogKipOb3RlKiouIGBuYCBpcyBub3JtYWxpemVkIHRvIGEgbm9uIG5lZ2F0aXZlIGludGVnZXIuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IHJlcGxpY2F0ZSB9IGZyb20gJ2ZwLXRzL1JlYWRvbmx5QXJyYXknXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChyZXBsaWNhdGUoMywgJ2EnKSwgWydhJywgJ2EnLCAnYSddKVxuICpcbiAqIEBjYXRlZ29yeSBjb25zdHJ1Y3RvcnNcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIHJlcGxpY2F0ZSA9IGZ1bmN0aW9uIChuLCBhKSB7IHJldHVybiBtYWtlQnkobiwgZnVuY3Rpb24gKCkgeyByZXR1cm4gYTsgfSk7IH07XG5leHBvcnQgZnVuY3Rpb24gZnJvbVByZWRpY2F0ZShwcmVkaWNhdGUpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGEpIHsgcmV0dXJuIChwcmVkaWNhdGUoYSkgPyBbYV0gOiBlbXB0eSk7IH07XG59XG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vLyBjb252ZXJzaW9uc1xuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLyoqXG4gKiBAY2F0ZWdvcnkgY29udmVyc2lvbnNcbiAqIEBzaW5jZSAyLjExLjBcbiAqL1xuZXhwb3J0IHZhciBmcm9tT3B0aW9uID0gZnVuY3Rpb24gKG1hKSB7IHJldHVybiAoXy5pc05vbmUobWEpID8gZW1wdHkgOiBbbWEudmFsdWVdKTsgfTtcbi8qKlxuICogVHJhbnNmb3JtcyBhbiBgRWl0aGVyYCB0byBhIGBSZWFkb25seUFycmF5YC5cbiAqXG4gKiBAY2F0ZWdvcnkgY29udmVyc2lvbnNcbiAqIEBzaW5jZSAyLjExLjBcbiAqL1xuZXhwb3J0IHZhciBmcm9tRWl0aGVyID0gZnVuY3Rpb24gKGUpIHsgcmV0dXJuIChfLmlzTGVmdChlKSA/IGVtcHR5IDogW2UucmlnaHRdKTsgfTtcbi8qKlxuICogTGVzcyBzdHJpY3QgdmVyc2lvbiBvZiBbYG1hdGNoYF0oI21hdGNoKS5cbiAqXG4gKiBUaGUgYFdgIHN1ZmZpeCAoc2hvcnQgZm9yICoqVyoqaWRlbmluZykgbWVhbnMgdGhhdCB0aGUgaGFuZGxlciByZXR1cm4gdHlwZXMgd2lsbCBiZSBtZXJnZWQuXG4gKlxuICogQGNhdGVnb3J5IHBhdHRlcm4gbWF0Y2hpbmdcbiAqIEBzaW5jZSAyLjExLjBcbiAqL1xuZXhwb3J0IHZhciBtYXRjaFcgPSBmdW5jdGlvbiAob25FbXB0eSwgb25Ob25FbXB0eSkge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgcmV0dXJuIGlzTm9uRW1wdHkoYXMpID8gb25Ob25FbXB0eShhcykgOiBvbkVtcHR5KCk7XG4gICAgfTtcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBwYXR0ZXJuIG1hdGNoaW5nXG4gKiBAc2luY2UgMi4xMS4wXG4gKi9cbmV4cG9ydCB2YXIgbWF0Y2ggPSBtYXRjaFc7XG4vKipcbiAqIExlc3Mgc3RyaWN0IHZlcnNpb24gb2YgW2BtYXRjaExlZnRgXSgjbWF0Y2hsZWZ0KS5cbiAqXG4gKiBAY2F0ZWdvcnkgcGF0dGVybiBtYXRjaGluZ1xuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIG1hdGNoTGVmdFcgPSBmdW5jdGlvbiAob25FbXB0eSwgb25Ob25FbXB0eSkge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgcmV0dXJuIGlzTm9uRW1wdHkoYXMpID8gb25Ob25FbXB0eShSTkVBLmhlYWQoYXMpLCBSTkVBLnRhaWwoYXMpKSA6IG9uRW1wdHkoKTtcbiAgICB9O1xufTtcbi8qKlxuICogQnJlYWsgYSBgUmVhZG9ubHlBcnJheWAgaW50byBpdHMgZmlyc3QgZWxlbWVudCBhbmQgcmVtYWluaW5nIGVsZW1lbnRzLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBtYXRjaExlZnQgfSBmcm9tICdmcC10cy9SZWFkb25seUFycmF5J1xuICpcbiAqIGNvbnN0IGxlbjogPEE+KGFzOiBSZWFkb25seUFycmF5PEE+KSA9PiBudW1iZXIgPSBtYXRjaExlZnQoKCkgPT4gMCwgKF8sIHRhaWwpID0+IDEgKyBsZW4odGFpbCkpXG4gKiBhc3NlcnQuc3RyaWN0RXF1YWwobGVuKFsxLCAyLCAzXSksIDMpXG4gKlxuICogQGNhdGVnb3J5IHBhdHRlcm4gbWF0Y2hpbmdcbiAqIEBzaW5jZSAyLjEwLjBcbiAqL1xuZXhwb3J0IHZhciBtYXRjaExlZnQgPSBtYXRjaExlZnRXO1xuLyoqXG4gKiBBbGlhcyBvZiBbYG1hdGNoTGVmdGBdKCNtYXRjaGxlZnQpLlxuICpcbiAqIEBjYXRlZ29yeSBwYXR0ZXJuIG1hdGNoaW5nXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBmb2xkTGVmdCA9IG1hdGNoTGVmdDtcbi8qKlxuICogTGVzcyBzdHJpY3QgdmVyc2lvbiBvZiBbYG1hdGNoUmlnaHRgXSgjbWF0Y2hyaWdodCkuXG4gKlxuICogQGNhdGVnb3J5IHBhdHRlcm4gbWF0Y2hpbmdcbiAqIEBzaW5jZSAyLjExLjBcbiAqL1xuZXhwb3J0IHZhciBtYXRjaFJpZ2h0VyA9IGZ1bmN0aW9uIChvbkVtcHR5LCBvbk5vbkVtcHR5KSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykge1xuICAgICAgICByZXR1cm4gaXNOb25FbXB0eShhcykgPyBvbk5vbkVtcHR5KFJORUEuaW5pdChhcyksIFJORUEubGFzdChhcykpIDogb25FbXB0eSgpO1xuICAgIH07XG59O1xuLyoqXG4gKiBCcmVhayBhIGBSZWFkb25seUFycmF5YCBpbnRvIGl0cyBpbml0aWFsIGVsZW1lbnRzIGFuZCB0aGUgbGFzdCBlbGVtZW50LlxuICpcbiAqIEBjYXRlZ29yeSBwYXR0ZXJuIG1hdGNoaW5nXG4gKiBAc2luY2UgMi4xMC4wXG4gKi9cbmV4cG9ydCB2YXIgbWF0Y2hSaWdodCA9IG1hdGNoUmlnaHRXO1xuLyoqXG4gKiBBbGlhcyBvZiBbYG1hdGNoUmlnaHRgXSgjbWF0Y2hyaWdodCkuXG4gKlxuICogQGNhdGVnb3J5IHBhdHRlcm4gbWF0Y2hpbmdcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIGZvbGRSaWdodCA9IG1hdGNoUmlnaHQ7XG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vLyBjb21iaW5hdG9yc1xuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLyoqXG4gKiBAY2F0ZWdvcnkgc2VxdWVuY2luZ1xuICogQHNpbmNlIDIuNy4wXG4gKi9cbmV4cG9ydCB2YXIgY2hhaW5XaXRoSW5kZXggPSBmdW5jdGlvbiAoZikge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgaWYgKGlzRW1wdHkoYXMpKSB7XG4gICAgICAgICAgICByZXR1cm4gZW1wdHk7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIG91dCA9IFtdO1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGFzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICBvdXQucHVzaC5hcHBseShvdXQsIGYoaSwgYXNbaV0pKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gb3V0O1xuICAgIH07XG59O1xuLyoqXG4gKiBTYW1lIGFzIGByZWR1Y2VgIGJ1dCBpdCBjYXJyaWVzIG92ZXIgdGhlIGludGVybWVkaWF0ZSBzdGVwcy5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgc2NhbkxlZnQgfSBmcm9tICdmcC10cy9SZWFkb25seUFycmF5J1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoc2NhbkxlZnQoMTAsIChiLCBhOiBudW1iZXIpID0+IGIgLSBhKShbMSwgMiwgM10pLCBbMTAsIDksIDcsIDRdKVxuICpcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIHNjYW5MZWZ0ID0gZnVuY3Rpb24gKGIsIGYpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIHZhciBsZW4gPSBhcy5sZW5ndGg7XG4gICAgICAgIHZhciBvdXQgPSBuZXcgQXJyYXkobGVuICsgMSk7XG4gICAgICAgIG91dFswXSA9IGI7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbGVuOyBpKyspIHtcbiAgICAgICAgICAgIG91dFtpICsgMV0gPSBmKG91dFtpXSwgYXNbaV0pO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBvdXQ7XG4gICAgfTtcbn07XG4vKipcbiAqIEZvbGQgYW4gYXJyYXkgZnJvbSB0aGUgcmlnaHQsIGtlZXBpbmcgYWxsIGludGVybWVkaWF0ZSByZXN1bHRzIGluc3RlYWQgb2Ygb25seSB0aGUgZmluYWwgcmVzdWx0XG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IHNjYW5SaWdodCB9IGZyb20gJ2ZwLXRzL1JlYWRvbmx5QXJyYXknXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChzY2FuUmlnaHQoMTAsIChhOiBudW1iZXIsIGIpID0+IGIgLSBhKShbMSwgMiwgM10pLCBbNCwgNSwgNywgMTBdKVxuICpcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIHNjYW5SaWdodCA9IGZ1bmN0aW9uIChiLCBmKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykge1xuICAgICAgICB2YXIgbGVuID0gYXMubGVuZ3RoO1xuICAgICAgICB2YXIgb3V0ID0gbmV3IEFycmF5KGxlbiArIDEpO1xuICAgICAgICBvdXRbbGVuXSA9IGI7XG4gICAgICAgIGZvciAodmFyIGkgPSBsZW4gLSAxOyBpID49IDA7IGktLSkge1xuICAgICAgICAgICAgb3V0W2ldID0gZihhc1tpXSwgb3V0W2kgKyAxXSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG91dDtcbiAgICB9O1xufTtcbi8qKlxuICogQ2FsY3VsYXRlIHRoZSBudW1iZXIgb2YgZWxlbWVudHMgaW4gYSBgUmVhZG9ubHlBcnJheWAuXG4gKlxuICogQHNpbmNlIDIuMTAuMFxuICovXG5leHBvcnQgdmFyIHNpemUgPSBmdW5jdGlvbiAoYXMpIHsgcmV0dXJuIGFzLmxlbmd0aDsgfTtcbi8qKlxuICogVGVzdCB3aGV0aGVyIGFuIGFycmF5IGNvbnRhaW5zIGEgcGFydGljdWxhciBpbmRleFxuICpcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIGlzT3V0T2ZCb3VuZCA9IFJORUEuaXNPdXRPZkJvdW5kO1xuZXhwb3J0IGZ1bmN0aW9uIGxvb2t1cChpLCBhcykge1xuICAgIHJldHVybiBhcyA9PT0gdW5kZWZpbmVkID8gZnVuY3Rpb24gKGFzKSB7IHJldHVybiBsb29rdXAoaSwgYXMpOyB9IDogaXNPdXRPZkJvdW5kKGksIGFzKSA/IF8ubm9uZSA6IF8uc29tZShhc1tpXSk7XG59XG4vKipcbiAqIEdldCB0aGUgZmlyc3QgZWxlbWVudCBpbiBhbiBhcnJheSwgb3IgYE5vbmVgIGlmIHRoZSBhcnJheSBpcyBlbXB0eVxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBoZWFkIH0gZnJvbSAnZnAtdHMvUmVhZG9ubHlBcnJheSdcbiAqIGltcG9ydCB7IHNvbWUsIG5vbmUgfSBmcm9tICdmcC10cy9PcHRpb24nXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChoZWFkKFsxLCAyLCAzXSksIHNvbWUoMSkpXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKGhlYWQoW10pLCBub25lKVxuICpcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIGhlYWQgPSBmdW5jdGlvbiAoYXMpIHsgcmV0dXJuIChpc05vbkVtcHR5KGFzKSA/IF8uc29tZShSTkVBLmhlYWQoYXMpKSA6IF8ubm9uZSk7IH07XG4vKipcbiAqIEdldCB0aGUgbGFzdCBlbGVtZW50IGluIGFuIGFycmF5LCBvciBgTm9uZWAgaWYgdGhlIGFycmF5IGlzIGVtcHR5XG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IGxhc3QgfSBmcm9tICdmcC10cy9SZWFkb25seUFycmF5J1xuICogaW1wb3J0IHsgc29tZSwgbm9uZSB9IGZyb20gJ2ZwLXRzL09wdGlvbidcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKGxhc3QoWzEsIDIsIDNdKSwgc29tZSgzKSlcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwobGFzdChbXSksIG5vbmUpXG4gKlxuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgbGFzdCA9IGZ1bmN0aW9uIChhcykgeyByZXR1cm4gKGlzTm9uRW1wdHkoYXMpID8gXy5zb21lKFJORUEubGFzdChhcykpIDogXy5ub25lKTsgfTtcbi8qKlxuICogR2V0IGFsbCBidXQgdGhlIGZpcnN0IGVsZW1lbnQgb2YgYW4gYXJyYXksIGNyZWF0aW5nIGEgbmV3IGFycmF5LCBvciBgTm9uZWAgaWYgdGhlIGFycmF5IGlzIGVtcHR5XG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IHRhaWwgfSBmcm9tICdmcC10cy9SZWFkb25seUFycmF5J1xuICogaW1wb3J0IHsgc29tZSwgbm9uZSB9IGZyb20gJ2ZwLXRzL09wdGlvbidcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKHRhaWwoWzEsIDIsIDNdKSwgc29tZShbMiwgM10pKVxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbCh0YWlsKFtdKSwgbm9uZSlcbiAqXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciB0YWlsID0gZnVuY3Rpb24gKGFzKSB7XG4gICAgcmV0dXJuIGlzTm9uRW1wdHkoYXMpID8gXy5zb21lKFJORUEudGFpbChhcykpIDogXy5ub25lO1xufTtcbi8qKlxuICogR2V0IGFsbCBidXQgdGhlIGxhc3QgZWxlbWVudCBvZiBhbiBhcnJheSwgY3JlYXRpbmcgYSBuZXcgYXJyYXksIG9yIGBOb25lYCBpZiB0aGUgYXJyYXkgaXMgZW1wdHlcbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgaW5pdCB9IGZyb20gJ2ZwLXRzL1JlYWRvbmx5QXJyYXknXG4gKiBpbXBvcnQgeyBzb21lLCBub25lIH0gZnJvbSAnZnAtdHMvT3B0aW9uJ1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoaW5pdChbMSwgMiwgM10pLCBzb21lKFsxLCAyXSkpXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKGluaXQoW10pLCBub25lKVxuICpcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIGluaXQgPSBmdW5jdGlvbiAoYXMpIHtcbiAgICByZXR1cm4gaXNOb25FbXB0eShhcykgPyBfLnNvbWUoUk5FQS5pbml0KGFzKSkgOiBfLm5vbmU7XG59O1xuLyoqXG4gKiBLZWVwIG9ubHkgYSBtYXggbnVtYmVyIG9mIGVsZW1lbnRzIGZyb20gdGhlIHN0YXJ0IG9mIGFuIGBSZWFkb25seUFycmF5YCwgY3JlYXRpbmcgYSBuZXcgYFJlYWRvbmx5QXJyYXlgLlxuICpcbiAqICoqTm90ZSoqLiBgbmAgaXMgbm9ybWFsaXplZCB0byBhIG5vbiBuZWdhdGl2ZSBpbnRlZ2VyLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgKiBhcyBSQSBmcm9tICdmcC10cy9SZWFkb25seUFycmF5J1xuICogaW1wb3J0IHsgcGlwZSB9IGZyb20gJ2ZwLXRzL2Z1bmN0aW9uJ1xuICpcbiAqIGNvbnN0IGlucHV0OiBSZWFkb25seUFycmF5PG51bWJlcj4gPSBbMSwgMiwgM11cbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwocGlwZShpbnB1dCwgUkEudGFrZUxlZnQoMikpLCBbMSwgMl0pXG4gKlxuICogLy8gb3V0IG9mIGJvdW5kc1xuICogYXNzZXJ0LnN0cmljdEVxdWFsKHBpcGUoaW5wdXQsIFJBLnRha2VMZWZ0KDQpKSwgaW5wdXQpXG4gKiBhc3NlcnQuc3RyaWN0RXF1YWwocGlwZShpbnB1dCwgUkEudGFrZUxlZnQoLTEpKSwgaW5wdXQpXG4gKlxuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgdGFrZUxlZnQgPSBmdW5jdGlvbiAobikge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgcmV0dXJuIGlzT3V0T2ZCb3VuZChuLCBhcykgPyBhcyA6IG4gPT09IDAgPyBlbXB0eSA6IGFzLnNsaWNlKDAsIG4pO1xuICAgIH07XG59O1xuLyoqXG4gKiBLZWVwIG9ubHkgYSBtYXggbnVtYmVyIG9mIGVsZW1lbnRzIGZyb20gdGhlIGVuZCBvZiBhbiBgUmVhZG9ubHlBcnJheWAsIGNyZWF0aW5nIGEgbmV3IGBSZWFkb25seUFycmF5YC5cbiAqXG4gKiAqKk5vdGUqKi4gYG5gIGlzIG5vcm1hbGl6ZWQgdG8gYSBub24gbmVnYXRpdmUgaW50ZWdlci5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0ICogYXMgUkEgZnJvbSAnZnAtdHMvUmVhZG9ubHlBcnJheSdcbiAqIGltcG9ydCB7IHBpcGUgfSBmcm9tICdmcC10cy9mdW5jdGlvbidcbiAqXG4gKiBjb25zdCBpbnB1dDogUmVhZG9ubHlBcnJheTxudW1iZXI+ID0gWzEsIDIsIDNdXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKHBpcGUoaW5wdXQsIFJBLnRha2VSaWdodCgyKSksIFsyLCAzXSlcbiAqXG4gKiAvLyBvdXQgb2YgYm91bmRzXG4gKiBhc3NlcnQuc3RyaWN0RXF1YWwocGlwZShpbnB1dCwgUkEudGFrZVJpZ2h0KDQpKSwgaW5wdXQpXG4gKiBhc3NlcnQuc3RyaWN0RXF1YWwocGlwZShpbnB1dCwgUkEudGFrZVJpZ2h0KC0xKSksIGlucHV0KVxuICpcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIHRha2VSaWdodCA9IGZ1bmN0aW9uIChuKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykge1xuICAgICAgICByZXR1cm4gaXNPdXRPZkJvdW5kKG4sIGFzKSA/IGFzIDogbiA9PT0gMCA/IGVtcHR5IDogYXMuc2xpY2UoLW4pO1xuICAgIH07XG59O1xuZXhwb3J0IGZ1bmN0aW9uIHRha2VMZWZ0V2hpbGUocHJlZGljYXRlKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykge1xuICAgICAgICB2YXIgb3V0ID0gW107XG4gICAgICAgIGZvciAodmFyIF9pID0gMCwgYXNfMSA9IGFzOyBfaSA8IGFzXzEubGVuZ3RoOyBfaSsrKSB7XG4gICAgICAgICAgICB2YXIgYSA9IGFzXzFbX2ldO1xuICAgICAgICAgICAgaWYgKCFwcmVkaWNhdGUoYSkpIHtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIG91dC5wdXNoKGEpO1xuICAgICAgICB9XG4gICAgICAgIHZhciBsZW4gPSBvdXQubGVuZ3RoO1xuICAgICAgICByZXR1cm4gbGVuID09PSBhcy5sZW5ndGggPyBhcyA6IGxlbiA9PT0gMCA/IGVtcHR5IDogb3V0O1xuICAgIH07XG59XG52YXIgc3BhbkxlZnRJbmRleCA9IGZ1bmN0aW9uIChhcywgcHJlZGljYXRlKSB7XG4gICAgdmFyIGwgPSBhcy5sZW5ndGg7XG4gICAgdmFyIGkgPSAwO1xuICAgIGZvciAoOyBpIDwgbDsgaSsrKSB7XG4gICAgICAgIGlmICghcHJlZGljYXRlKGFzW2ldKSkge1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIGk7XG59O1xuZXhwb3J0IGZ1bmN0aW9uIHNwYW5MZWZ0KHByZWRpY2F0ZSkge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgdmFyIF9hID0gc3BsaXRBdChzcGFuTGVmdEluZGV4KGFzLCBwcmVkaWNhdGUpKShhcyksIGluaXQgPSBfYVswXSwgcmVzdCA9IF9hWzFdO1xuICAgICAgICByZXR1cm4geyBpbml0OiBpbml0LCByZXN0OiByZXN0IH07XG4gICAgfTtcbn1cbi8qKlxuICogRHJvcCBhIG1heCBudW1iZXIgb2YgZWxlbWVudHMgZnJvbSB0aGUgc3RhcnQgb2YgYW4gYFJlYWRvbmx5QXJyYXlgLCBjcmVhdGluZyBhIG5ldyBgUmVhZG9ubHlBcnJheWAuXG4gKlxuICogKipOb3RlKiouIGBuYCBpcyBub3JtYWxpemVkIHRvIGEgbm9uIG5lZ2F0aXZlIGludGVnZXIuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCAqIGFzIFJBIGZyb20gJ2ZwLXRzL1JlYWRvbmx5QXJyYXknXG4gKiBpbXBvcnQgeyBwaXBlIH0gZnJvbSAnZnAtdHMvZnVuY3Rpb24nXG4gKlxuICogY29uc3QgaW5wdXQ6IFJlYWRvbmx5QXJyYXk8bnVtYmVyPiA9IFsxLCAyLCAzXVxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChwaXBlKGlucHV0LCBSQS5kcm9wTGVmdCgyKSksIFszXSlcbiAqIGFzc2VydC5zdHJpY3RFcXVhbChwaXBlKGlucHV0LCBSQS5kcm9wTGVmdCgwKSksIGlucHV0KVxuICogYXNzZXJ0LnN0cmljdEVxdWFsKHBpcGUoaW5wdXQsIFJBLmRyb3BMZWZ0KC0xKSksIGlucHV0KVxuICpcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIGRyb3BMZWZ0ID0gZnVuY3Rpb24gKG4pIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIHJldHVybiBuIDw9IDAgfHwgaXNFbXB0eShhcykgPyBhcyA6IG4gPj0gYXMubGVuZ3RoID8gZW1wdHkgOiBhcy5zbGljZShuLCBhcy5sZW5ndGgpO1xuICAgIH07XG59O1xuLyoqXG4gKiBEcm9wIGEgbWF4IG51bWJlciBvZiBlbGVtZW50cyBmcm9tIHRoZSBlbmQgb2YgYW4gYFJlYWRvbmx5QXJyYXlgLCBjcmVhdGluZyBhIG5ldyBgUmVhZG9ubHlBcnJheWAuXG4gKlxuICogKipOb3RlKiouIGBuYCBpcyBub3JtYWxpemVkIHRvIGEgbm9uIG5lZ2F0aXZlIGludGVnZXIuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCAqIGFzIFJBIGZyb20gJ2ZwLXRzL1JlYWRvbmx5QXJyYXknXG4gKiBpbXBvcnQgeyBwaXBlIH0gZnJvbSAnZnAtdHMvZnVuY3Rpb24nXG4gKlxuICogY29uc3QgaW5wdXQ6IFJlYWRvbmx5QXJyYXk8bnVtYmVyPiA9IFsxLCAyLCAzXVxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChwaXBlKGlucHV0LCBSQS5kcm9wUmlnaHQoMikpLCBbMV0pXG4gKiBhc3NlcnQuc3RyaWN0RXF1YWwocGlwZShpbnB1dCwgUkEuZHJvcFJpZ2h0KDApKSwgaW5wdXQpXG4gKiBhc3NlcnQuc3RyaWN0RXF1YWwocGlwZShpbnB1dCwgUkEuZHJvcFJpZ2h0KC0xKSksIGlucHV0KVxuICpcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIGRyb3BSaWdodCA9IGZ1bmN0aW9uIChuKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykge1xuICAgICAgICByZXR1cm4gbiA8PSAwIHx8IGlzRW1wdHkoYXMpID8gYXMgOiBuID49IGFzLmxlbmd0aCA/IGVtcHR5IDogYXMuc2xpY2UoMCwgYXMubGVuZ3RoIC0gbik7XG4gICAgfTtcbn07XG5leHBvcnQgZnVuY3Rpb24gZHJvcExlZnRXaGlsZShwcmVkaWNhdGUpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIHZhciBpID0gc3BhbkxlZnRJbmRleChhcywgcHJlZGljYXRlKTtcbiAgICAgICAgcmV0dXJuIGkgPT09IDAgPyBhcyA6IGkgPT09IGFzLmxlbmd0aCA/IGVtcHR5IDogYXMuc2xpY2UoaSk7XG4gICAgfTtcbn1cbi8qKlxuICogRmluZCB0aGUgZmlyc3QgaW5kZXggZm9yIHdoaWNoIGEgcHJlZGljYXRlIGhvbGRzXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IGZpbmRJbmRleCB9IGZyb20gJ2ZwLXRzL1JlYWRvbmx5QXJyYXknXG4gKiBpbXBvcnQgeyBzb21lLCBub25lIH0gZnJvbSAnZnAtdHMvT3B0aW9uJ1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoZmluZEluZGV4KChuOiBudW1iZXIpID0+IG4gPT09IDIpKFsxLCAyLCAzXSksIHNvbWUoMSkpXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKGZpbmRJbmRleCgobjogbnVtYmVyKSA9PiBuID09PSAyKShbXSksIG5vbmUpXG4gKlxuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgZmluZEluZGV4ID0gZnVuY3Rpb24gKHByZWRpY2F0ZSkge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBhcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgaWYgKHByZWRpY2F0ZShhc1tpXSkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gXy5zb21lKGkpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBfLm5vbmU7XG4gICAgfTtcbn07XG5leHBvcnQgZnVuY3Rpb24gZmluZEZpcnN0KHByZWRpY2F0ZSkge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBhcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgaWYgKHByZWRpY2F0ZShhc1tpXSkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gXy5zb21lKGFzW2ldKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gXy5ub25lO1xuICAgIH07XG59XG4vKipcbiAqIEZpbmQgdGhlIGZpcnN0IGVsZW1lbnQgcmV0dXJuZWQgYnkgYW4gb3B0aW9uIGJhc2VkIHNlbGVjdG9yIGZ1bmN0aW9uXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IGZpbmRGaXJzdE1hcCB9IGZyb20gJ2ZwLXRzL1JlYWRvbmx5QXJyYXknXG4gKiBpbXBvcnQgeyBzb21lLCBub25lIH0gZnJvbSAnZnAtdHMvT3B0aW9uJ1xuICpcbiAqIGludGVyZmFjZSBQZXJzb24ge1xuICogICByZWFkb25seSBuYW1lOiBzdHJpbmdcbiAqICAgcmVhZG9ubHkgYWdlPzogbnVtYmVyXG4gKiB9XG4gKlxuICogY29uc3QgcGVyc29uczogUmVhZG9ubHlBcnJheTxQZXJzb24+ID0gW3sgbmFtZTogJ0pvaG4nIH0sIHsgbmFtZTogJ01hcnknLCBhZ2U6IDQ1IH0sIHsgbmFtZTogJ0pvZXknLCBhZ2U6IDI4IH1dXG4gKlxuICogLy8gcmV0dXJucyB0aGUgbmFtZSBvZiB0aGUgZmlyc3QgcGVyc29uIHRoYXQgaGFzIGFuIGFnZVxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChmaW5kRmlyc3RNYXAoKHA6IFBlcnNvbikgPT4gKHAuYWdlID09PSB1bmRlZmluZWQgPyBub25lIDogc29tZShwLm5hbWUpKSkocGVyc29ucyksIHNvbWUoJ01hcnknKSlcbiAqXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBmaW5kRmlyc3RNYXAgPSBmdW5jdGlvbiAoZikge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBhcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgdmFyIG91dCA9IGYoYXNbaV0pO1xuICAgICAgICAgICAgaWYgKF8uaXNTb21lKG91dCkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gb3V0O1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBfLm5vbmU7XG4gICAgfTtcbn07XG5leHBvcnQgZnVuY3Rpb24gZmluZExhc3QocHJlZGljYXRlKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykge1xuICAgICAgICBmb3IgKHZhciBpID0gYXMubGVuZ3RoIC0gMTsgaSA+PSAwOyBpLS0pIHtcbiAgICAgICAgICAgIGlmIChwcmVkaWNhdGUoYXNbaV0pKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIF8uc29tZShhc1tpXSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIF8ubm9uZTtcbiAgICB9O1xufVxuLyoqXG4gKiBGaW5kIHRoZSBsYXN0IGVsZW1lbnQgcmV0dXJuZWQgYnkgYW4gb3B0aW9uIGJhc2VkIHNlbGVjdG9yIGZ1bmN0aW9uXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IGZpbmRMYXN0TWFwIH0gZnJvbSAnZnAtdHMvUmVhZG9ubHlBcnJheSdcbiAqIGltcG9ydCB7IHNvbWUsIG5vbmUgfSBmcm9tICdmcC10cy9PcHRpb24nXG4gKlxuICogaW50ZXJmYWNlIFBlcnNvbiB7XG4gKiAgIHJlYWRvbmx5IG5hbWU6IHN0cmluZ1xuICogICByZWFkb25seSBhZ2U/OiBudW1iZXJcbiAqIH1cbiAqXG4gKiBjb25zdCBwZXJzb25zOiBSZWFkb25seUFycmF5PFBlcnNvbj4gPSBbeyBuYW1lOiAnSm9obicgfSwgeyBuYW1lOiAnTWFyeScsIGFnZTogNDUgfSwgeyBuYW1lOiAnSm9leScsIGFnZTogMjggfV1cbiAqXG4gKiAvLyByZXR1cm5zIHRoZSBuYW1lIG9mIHRoZSBsYXN0IHBlcnNvbiB0aGF0IGhhcyBhbiBhZ2VcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoZmluZExhc3RNYXAoKHA6IFBlcnNvbikgPT4gKHAuYWdlID09PSB1bmRlZmluZWQgPyBub25lIDogc29tZShwLm5hbWUpKSkocGVyc29ucyksIHNvbWUoJ0pvZXknKSlcbiAqXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBmaW5kTGFzdE1hcCA9IGZ1bmN0aW9uIChmKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykge1xuICAgICAgICBmb3IgKHZhciBpID0gYXMubGVuZ3RoIC0gMTsgaSA+PSAwOyBpLS0pIHtcbiAgICAgICAgICAgIHZhciBvdXQgPSBmKGFzW2ldKTtcbiAgICAgICAgICAgIGlmIChfLmlzU29tZShvdXQpKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG91dDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gXy5ub25lO1xuICAgIH07XG59O1xuLyoqXG4gKiBSZXR1cm5zIHRoZSBpbmRleCBvZiB0aGUgbGFzdCBlbGVtZW50IG9mIHRoZSBsaXN0IHdoaWNoIG1hdGNoZXMgdGhlIHByZWRpY2F0ZVxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBmaW5kTGFzdEluZGV4IH0gZnJvbSAnZnAtdHMvUmVhZG9ubHlBcnJheSdcbiAqIGltcG9ydCB7IHNvbWUsIG5vbmUgfSBmcm9tICdmcC10cy9PcHRpb24nXG4gKlxuICogaW50ZXJmYWNlIFgge1xuICogICByZWFkb25seSBhOiBudW1iZXJcbiAqICAgcmVhZG9ubHkgYjogbnVtYmVyXG4gKiB9XG4gKiBjb25zdCB4czogUmVhZG9ubHlBcnJheTxYPiA9IFt7IGE6IDEsIGI6IDAgfSwgeyBhOiAxLCBiOiAxIH1dXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKGZpbmRMYXN0SW5kZXgoKHg6IHsgcmVhZG9ubHkgYTogbnVtYmVyIH0pID0+IHguYSA9PT0gMSkoeHMpLCBzb21lKDEpKVxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChmaW5kTGFzdEluZGV4KCh4OiB7IHJlYWRvbmx5IGE6IG51bWJlciB9KSA9PiB4LmEgPT09IDQpKHhzKSwgbm9uZSlcbiAqXG4gKlxuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgZmluZExhc3RJbmRleCA9IGZ1bmN0aW9uIChwcmVkaWNhdGUpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIGZvciAodmFyIGkgPSBhcy5sZW5ndGggLSAxOyBpID49IDA7IGktLSkge1xuICAgICAgICAgICAgaWYgKHByZWRpY2F0ZShhc1tpXSkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gXy5zb21lKGkpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBfLm5vbmU7XG4gICAgfTtcbn07XG4vKipcbiAqIEluc2VydCBhbiBlbGVtZW50IGF0IHRoZSBzcGVjaWZpZWQgaW5kZXgsIGNyZWF0aW5nIGEgbmV3IGFycmF5LCBvciByZXR1cm5pbmcgYE5vbmVgIGlmIHRoZSBpbmRleCBpcyBvdXQgb2YgYm91bmRzXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IGluc2VydEF0IH0gZnJvbSAnZnAtdHMvUmVhZG9ubHlBcnJheSdcbiAqIGltcG9ydCB7IHNvbWUgfSBmcm9tICdmcC10cy9PcHRpb24nXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChpbnNlcnRBdCgyLCA1KShbMSwgMiwgMywgNF0pLCBzb21lKFsxLCAyLCA1LCAzLCA0XSkpXG4gKlxuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgaW5zZXJ0QXQgPSBmdW5jdGlvbiAoaSwgYSkge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgcmV0dXJuIGkgPCAwIHx8IGkgPiBhcy5sZW5ndGggPyBfLm5vbmUgOiBfLnNvbWUoUk5FQS51bnNhZmVJbnNlcnRBdChpLCBhLCBhcykpO1xuICAgIH07XG59O1xuLyoqXG4gKiBDaGFuZ2UgdGhlIGVsZW1lbnQgYXQgdGhlIHNwZWNpZmllZCBpbmRleCwgY3JlYXRpbmcgYSBuZXcgYXJyYXksIG9yIHJldHVybmluZyBgTm9uZWAgaWYgdGhlIGluZGV4IGlzIG91dCBvZiBib3VuZHNcbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgdXBkYXRlQXQgfSBmcm9tICdmcC10cy9SZWFkb25seUFycmF5J1xuICogaW1wb3J0IHsgc29tZSwgbm9uZSB9IGZyb20gJ2ZwLXRzL09wdGlvbidcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKHVwZGF0ZUF0KDEsIDEpKFsxLCAyLCAzXSksIHNvbWUoWzEsIDEsIDNdKSlcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwodXBkYXRlQXQoMSwgMSkoW10pLCBub25lKVxuICpcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIHVwZGF0ZUF0ID0gZnVuY3Rpb24gKGksIGEpIHtcbiAgICByZXR1cm4gbW9kaWZ5QXQoaSwgZnVuY3Rpb24gKCkgeyByZXR1cm4gYTsgfSk7XG59O1xuLyoqXG4gKiBEZWxldGUgdGhlIGVsZW1lbnQgYXQgdGhlIHNwZWNpZmllZCBpbmRleCwgY3JlYXRpbmcgYSBuZXcgYXJyYXksIG9yIHJldHVybmluZyBgTm9uZWAgaWYgdGhlIGluZGV4IGlzIG91dCBvZiBib3VuZHNcbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgZGVsZXRlQXQgfSBmcm9tICdmcC10cy9SZWFkb25seUFycmF5J1xuICogaW1wb3J0IHsgc29tZSwgbm9uZSB9IGZyb20gJ2ZwLXRzL09wdGlvbidcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKGRlbGV0ZUF0KDApKFsxLCAyLCAzXSksIHNvbWUoWzIsIDNdKSlcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoZGVsZXRlQXQoMSkoW10pLCBub25lKVxuICpcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIGRlbGV0ZUF0ID0gZnVuY3Rpb24gKGkpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIHJldHVybiBpc091dE9mQm91bmQoaSwgYXMpID8gXy5ub25lIDogXy5zb21lKHVuc2FmZURlbGV0ZUF0KGksIGFzKSk7XG4gICAgfTtcbn07XG4vKipcbiAqIEFwcGx5IGEgZnVuY3Rpb24gdG8gdGhlIGVsZW1lbnQgYXQgdGhlIHNwZWNpZmllZCBpbmRleCwgY3JlYXRpbmcgYSBuZXcgYXJyYXksIG9yIHJldHVybmluZyBgTm9uZWAgaWYgdGhlIGluZGV4IGlzIG91dFxuICogb2YgYm91bmRzXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IG1vZGlmeUF0IH0gZnJvbSAnZnAtdHMvUmVhZG9ubHlBcnJheSdcbiAqIGltcG9ydCB7IHNvbWUsIG5vbmUgfSBmcm9tICdmcC10cy9PcHRpb24nXG4gKlxuICogY29uc3QgZG91YmxlID0gKHg6IG51bWJlcik6IG51bWJlciA9PiB4ICogMlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChtb2RpZnlBdCgxLCBkb3VibGUpKFsxLCAyLCAzXSksIHNvbWUoWzEsIDQsIDNdKSlcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwobW9kaWZ5QXQoMSwgZG91YmxlKShbXSksIG5vbmUpXG4gKlxuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgbW9kaWZ5QXQgPSBmdW5jdGlvbiAoaSwgZikge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgcmV0dXJuIGlzT3V0T2ZCb3VuZChpLCBhcykgPyBfLm5vbmUgOiBfLnNvbWUodW5zYWZlVXBkYXRlQXQoaSwgZihhc1tpXSksIGFzKSk7XG4gICAgfTtcbn07XG4vKipcbiAqIFJldmVyc2UgYW4gYXJyYXksIGNyZWF0aW5nIGEgbmV3IGFycmF5XG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IHJldmVyc2UgfSBmcm9tICdmcC10cy9SZWFkb25seUFycmF5J1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwocmV2ZXJzZShbMSwgMiwgM10pLCBbMywgMiwgMV0pXG4gKlxuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgcmV2ZXJzZSA9IGZ1bmN0aW9uIChhcykgeyByZXR1cm4gKGFzLmxlbmd0aCA8PSAxID8gYXMgOiBhcy5zbGljZSgpLnJldmVyc2UoKSk7IH07XG4vKipcbiAqIEV4dHJhY3RzIGZyb20gYW4gYXJyYXkgb2YgYEVpdGhlcmAgYWxsIHRoZSBgUmlnaHRgIGVsZW1lbnRzLiBBbGwgdGhlIGBSaWdodGAgZWxlbWVudHMgYXJlIGV4dHJhY3RlZCBpbiBvcmRlclxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyByaWdodHMgfSBmcm9tICdmcC10cy9SZWFkb25seUFycmF5J1xuICogaW1wb3J0IHsgcmlnaHQsIGxlZnQgfSBmcm9tICdmcC10cy9FaXRoZXInXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChyaWdodHMoW3JpZ2h0KDEpLCBsZWZ0KCdmb28nKSwgcmlnaHQoMildKSwgWzEsIDJdKVxuICpcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIHJpZ2h0cyA9IGZ1bmN0aW9uIChhcykge1xuICAgIHZhciByID0gW107XG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBhcy5sZW5ndGg7IGkrKykge1xuICAgICAgICB2YXIgYSA9IGFzW2ldO1xuICAgICAgICBpZiAoYS5fdGFnID09PSAnUmlnaHQnKSB7XG4gICAgICAgICAgICByLnB1c2goYS5yaWdodCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHI7XG59O1xuLyoqXG4gKiBFeHRyYWN0cyBmcm9tIGFuIGFycmF5IG9mIGBFaXRoZXJgIGFsbCB0aGUgYExlZnRgIGVsZW1lbnRzLiBBbGwgdGhlIGBMZWZ0YCBlbGVtZW50cyBhcmUgZXh0cmFjdGVkIGluIG9yZGVyXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IGxlZnRzIH0gZnJvbSAnZnAtdHMvUmVhZG9ubHlBcnJheSdcbiAqIGltcG9ydCB7IGxlZnQsIHJpZ2h0IH0gZnJvbSAnZnAtdHMvRWl0aGVyJ1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwobGVmdHMoW3JpZ2h0KDEpLCBsZWZ0KCdmb28nKSwgcmlnaHQoMildKSwgWydmb28nXSlcbiAqXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBsZWZ0cyA9IGZ1bmN0aW9uIChhcykge1xuICAgIHZhciByID0gW107XG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBhcy5sZW5ndGg7IGkrKykge1xuICAgICAgICB2YXIgYSA9IGFzW2ldO1xuICAgICAgICBpZiAoYS5fdGFnID09PSAnTGVmdCcpIHtcbiAgICAgICAgICAgIHIucHVzaChhLmxlZnQpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiByO1xufTtcbi8qKlxuICogU29ydCB0aGUgZWxlbWVudHMgb2YgYW4gYXJyYXkgaW4gaW5jcmVhc2luZyBvcmRlciwgY3JlYXRpbmcgYSBuZXcgYXJyYXlcbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgc29ydCB9IGZyb20gJ2ZwLXRzL1JlYWRvbmx5QXJyYXknXG4gKiBpbXBvcnQgKiBhcyBOIGZyb20gJ2ZwLXRzL251bWJlcidcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKHNvcnQoTi5PcmQpKFszLCAyLCAxXSksIFsxLCAyLCAzXSlcbiAqXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBzb3J0ID0gZnVuY3Rpb24gKE8pIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIHJldHVybiBhcy5sZW5ndGggPD0gMSA/IGFzIDogYXMuc2xpY2UoKS5zb3J0KE8uY29tcGFyZSk7XG4gICAgfTtcbn07XG4vLyBUT0RPOiBjdXJyeSBhbmQgbWFrZSBkYXRhLWxhc3QgaW4gdjNcbi8qKlxuICogQXBwbHkgYSBmdW5jdGlvbiB0byBwYWlycyBvZiBlbGVtZW50cyBhdCB0aGUgc2FtZSBpbmRleCBpbiB0d28gYXJyYXlzLCBjb2xsZWN0aW5nIHRoZSByZXN1bHRzIGluIGEgbmV3IGFycmF5LiBJZiBvbmVcbiAqIGlucHV0IGFycmF5IGlzIHNob3J0LCBleGNlc3MgZWxlbWVudHMgb2YgdGhlIGxvbmdlciBhcnJheSBhcmUgZGlzY2FyZGVkLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyB6aXBXaXRoIH0gZnJvbSAnZnAtdHMvUmVhZG9ubHlBcnJheSdcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKHppcFdpdGgoWzEsIDIsIDNdLCBbJ2EnLCAnYicsICdjJywgJ2QnXSwgKG4sIHMpID0+IHMgKyBuKSwgWydhMScsICdiMicsICdjMyddKVxuICpcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIHppcFdpdGggPSBmdW5jdGlvbiAoZmEsIGZiLCBmKSB7XG4gICAgdmFyIGZjID0gW107XG4gICAgdmFyIGxlbiA9IE1hdGgubWluKGZhLmxlbmd0aCwgZmIubGVuZ3RoKTtcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IGxlbjsgaSsrKSB7XG4gICAgICAgIGZjW2ldID0gZihmYVtpXSwgZmJbaV0pO1xuICAgIH1cbiAgICByZXR1cm4gZmM7XG59O1xuZXhwb3J0IGZ1bmN0aW9uIHppcChhcywgYnMpIHtcbiAgICBpZiAoYnMgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICByZXR1cm4gZnVuY3Rpb24gKGJzKSB7IHJldHVybiB6aXAoYnMsIGFzKTsgfTtcbiAgICB9XG4gICAgcmV0dXJuIHppcFdpdGgoYXMsIGJzLCBmdW5jdGlvbiAoYSwgYikgeyByZXR1cm4gW2EsIGJdOyB9KTtcbn1cbi8qKlxuICogVGhlIGZ1bmN0aW9uIGlzIHJldmVyc2Ugb2YgYHppcGAuIFRha2VzIGFuIGFycmF5IG9mIHBhaXJzIGFuZCByZXR1cm4gdHdvIGNvcnJlc3BvbmRpbmcgYXJyYXlzXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IHVuemlwIH0gZnJvbSAnZnAtdHMvUmVhZG9ubHlBcnJheSdcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKHVuemlwKFtbMSwgJ2EnXSwgWzIsICdiJ10sIFszLCAnYyddXSksIFtbMSwgMiwgM10sIFsnYScsICdiJywgJ2MnXV0pXG4gKlxuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgdW56aXAgPSBmdW5jdGlvbiAoYXMpIHtcbiAgICB2YXIgZmEgPSBbXTtcbiAgICB2YXIgZmIgPSBbXTtcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IGFzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIGZhW2ldID0gYXNbaV1bMF07XG4gICAgICAgIGZiW2ldID0gYXNbaV1bMV07XG4gICAgfVxuICAgIHJldHVybiBbZmEsIGZiXTtcbn07XG4vKipcbiAqIFByZXBlbmQgYW4gZWxlbWVudCB0byBldmVyeSBtZW1iZXIgb2YgYW4gYXJyYXlcbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgcHJlcGVuZEFsbCB9IGZyb20gJ2ZwLXRzL1JlYWRvbmx5QXJyYXknXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChwcmVwZW5kQWxsKDkpKFsxLCAyLCAzLCA0XSksIFs5LCAxLCA5LCAyLCA5LCAzLCA5LCA0XSlcbiAqXG4gKiBAc2luY2UgMi4xMC4wXG4gKi9cbmV4cG9ydCB2YXIgcHJlcGVuZEFsbCA9IGZ1bmN0aW9uIChtaWRkbGUpIHtcbiAgICB2YXIgZiA9IFJORUEucHJlcGVuZEFsbChtaWRkbGUpO1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHsgcmV0dXJuIChpc05vbkVtcHR5KGFzKSA/IGYoYXMpIDogYXMpOyB9O1xufTtcbi8qKlxuICogUGxhY2VzIGFuIGVsZW1lbnQgaW4gYmV0d2VlbiBtZW1iZXJzIG9mIGFuIGFycmF5XG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IGludGVyc3BlcnNlIH0gZnJvbSAnZnAtdHMvUmVhZG9ubHlBcnJheSdcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKGludGVyc3BlcnNlKDkpKFsxLCAyLCAzLCA0XSksIFsxLCA5LCAyLCA5LCAzLCA5LCA0XSlcbiAqXG4gKiBAc2luY2UgMi45LjBcbiAqL1xuZXhwb3J0IHZhciBpbnRlcnNwZXJzZSA9IGZ1bmN0aW9uIChtaWRkbGUpIHtcbiAgICB2YXIgZiA9IFJORUEuaW50ZXJzcGVyc2UobWlkZGxlKTtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7IHJldHVybiAoaXNOb25FbXB0eShhcykgPyBmKGFzKSA6IGFzKTsgfTtcbn07XG4vKipcbiAqIFJvdGF0ZSBhIGBSZWFkb25seUFycmF5YCBieSBgbmAgc3RlcHMuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IHJvdGF0ZSB9IGZyb20gJ2ZwLXRzL1JlYWRvbmx5QXJyYXknXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChyb3RhdGUoMikoWzEsIDIsIDMsIDQsIDVdKSwgWzQsIDUsIDEsIDIsIDNdKVxuICpcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIHJvdGF0ZSA9IGZ1bmN0aW9uIChuKSB7XG4gICAgdmFyIGYgPSBSTkVBLnJvdGF0ZShuKTtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7IHJldHVybiAoaXNOb25FbXB0eShhcykgPyBmKGFzKSA6IGFzKTsgfTtcbn07XG5leHBvcnQgZnVuY3Rpb24gZWxlbShFKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhLCBhcykge1xuICAgICAgICBpZiAoYXMgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgdmFyIGVsZW1FXzEgPSBlbGVtKEUpO1xuICAgICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIChhcykgeyByZXR1cm4gZWxlbUVfMShhLCBhcyk7IH07XG4gICAgICAgIH1cbiAgICAgICAgdmFyIHByZWRpY2F0ZSA9IGZ1bmN0aW9uIChlbGVtZW50KSB7IHJldHVybiBFLmVxdWFscyhlbGVtZW50LCBhKTsgfTtcbiAgICAgICAgdmFyIGkgPSAwO1xuICAgICAgICBmb3IgKDsgaSA8IGFzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICBpZiAocHJlZGljYXRlKGFzW2ldKSkge1xuICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9O1xufVxuLyoqXG4gKiBSZW1vdmUgZHVwbGljYXRlcyBmcm9tIGFuIGFycmF5LCBrZWVwaW5nIHRoZSBmaXJzdCBvY2N1cnJlbmNlIG9mIGFuIGVsZW1lbnQuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IHVuaXEgfSBmcm9tICdmcC10cy9SZWFkb25seUFycmF5J1xuICogaW1wb3J0ICogYXMgTiBmcm9tICdmcC10cy9udW1iZXInXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbCh1bmlxKE4uRXEpKFsxLCAyLCAxXSksIFsxLCAyXSlcbiAqXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciB1bmlxID0gZnVuY3Rpb24gKEUpIHtcbiAgICB2YXIgZiA9IFJORUEudW5pcShFKTtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7IHJldHVybiAoaXNOb25FbXB0eShhcykgPyBmKGFzKSA6IGFzKTsgfTtcbn07XG4vKipcbiAqIFNvcnQgdGhlIGVsZW1lbnRzIG9mIGFuIGFycmF5IGluIGluY3JlYXNpbmcgb3JkZXIsIHdoZXJlIGVsZW1lbnRzIGFyZSBjb21wYXJlZCB1c2luZyBmaXJzdCBgb3Jkc1swXWAsIHRoZW4gYG9yZHNbMV1gLFxuICogZXRjLi4uXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IHNvcnRCeSB9IGZyb20gJ2ZwLXRzL1JlYWRvbmx5QXJyYXknXG4gKiBpbXBvcnQgeyBjb250cmFtYXAgfSBmcm9tICdmcC10cy9PcmQnXG4gKiBpbXBvcnQgKiBhcyBTIGZyb20gJ2ZwLXRzL3N0cmluZydcbiAqIGltcG9ydCAqIGFzIE4gZnJvbSAnZnAtdHMvbnVtYmVyJ1xuICogaW1wb3J0IHsgcGlwZSB9IGZyb20gJ2ZwLXRzL2Z1bmN0aW9uJ1xuICpcbiAqIGludGVyZmFjZSBQZXJzb24ge1xuICogICByZWFkb25seSBuYW1lOiBzdHJpbmdcbiAqICAgcmVhZG9ubHkgYWdlOiBudW1iZXJcbiAqIH1cbiAqIGNvbnN0IGJ5TmFtZSA9IHBpcGUoUy5PcmQsIGNvbnRyYW1hcCgocDogUGVyc29uKSA9PiBwLm5hbWUpKVxuICogY29uc3QgYnlBZ2UgPSBwaXBlKE4uT3JkLCBjb250cmFtYXAoKHA6IFBlcnNvbikgPT4gcC5hZ2UpKVxuICpcbiAqIGNvbnN0IHNvcnRCeU5hbWVCeUFnZSA9IHNvcnRCeShbYnlOYW1lLCBieUFnZV0pXG4gKlxuICogY29uc3QgcGVyc29ucyA9IFt7IG5hbWU6ICdhJywgYWdlOiAxIH0sIHsgbmFtZTogJ2InLCBhZ2U6IDMgfSwgeyBuYW1lOiAnYycsIGFnZTogMiB9LCB7IG5hbWU6ICdiJywgYWdlOiAyIH1dXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKHNvcnRCeU5hbWVCeUFnZShwZXJzb25zKSwgW1xuICogICB7IG5hbWU6ICdhJywgYWdlOiAxIH0sXG4gKiAgIHsgbmFtZTogJ2InLCBhZ2U6IDIgfSxcbiAqICAgeyBuYW1lOiAnYicsIGFnZTogMyB9LFxuICogICB7IG5hbWU6ICdjJywgYWdlOiAyIH1cbiAqIF0pXG4gKlxuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgc29ydEJ5ID0gZnVuY3Rpb24gKG9yZHMpIHtcbiAgICB2YXIgZiA9IFJORUEuc29ydEJ5KG9yZHMpO1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHsgcmV0dXJuIChpc05vbkVtcHR5KGFzKSA/IGYoYXMpIDogYXMpOyB9O1xufTtcbi8qKlxuICogQSB1c2VmdWwgcmVjdXJzaW9uIHBhdHRlcm4gZm9yIHByb2Nlc3NpbmcgYSBgUmVhZG9ubHlBcnJheWAgdG8gcHJvZHVjZSBhIG5ldyBgUmVhZG9ubHlBcnJheWAsIG9mdGVuIHVzZWQgZm9yIFwiY2hvcHBpbmdcIiB1cCB0aGUgaW5wdXRcbiAqIGBSZWFkb25seUFycmF5YC4gVHlwaWNhbGx5IGBjaG9wYCBpcyBjYWxsZWQgd2l0aCBzb21lIGZ1bmN0aW9uIHRoYXQgd2lsbCBjb25zdW1lIGFuIGluaXRpYWwgcHJlZml4IG9mIHRoZSBgUmVhZG9ubHlBcnJheWAgYW5kIHByb2R1Y2UgYVxuICogdmFsdWUgYW5kIHRoZSB0YWlsIG9mIHRoZSBgUmVhZG9ubHlBcnJheWAuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IEVxIH0gZnJvbSAnZnAtdHMvRXEnXG4gKiBpbXBvcnQgKiBhcyBSQSBmcm9tICdmcC10cy9SZWFkb25seUFycmF5J1xuICogaW1wb3J0ICogYXMgTiBmcm9tICdmcC10cy9udW1iZXInXG4gKiBpbXBvcnQgeyBwaXBlIH0gZnJvbSAnZnAtdHMvZnVuY3Rpb24nXG4gKlxuICogY29uc3QgZ3JvdXAgPSA8QT4oUzogRXE8QT4pOiAoKGFzOiBSZWFkb25seUFycmF5PEE+KSA9PiBSZWFkb25seUFycmF5PFJlYWRvbmx5QXJyYXk8QT4+KSA9PiB7XG4gKiAgIHJldHVybiBSQS5jaG9wKGFzID0+IHtcbiAqICAgICBjb25zdCB7IGluaXQsIHJlc3QgfSA9IHBpcGUoYXMsIFJBLnNwYW5MZWZ0KChhOiBBKSA9PiBTLmVxdWFscyhhLCBhc1swXSkpKVxuICogICAgIHJldHVybiBbaW5pdCwgcmVzdF1cbiAqICAgfSlcbiAqIH1cbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoZ3JvdXAoTi5FcSkoWzEsIDEsIDIsIDMsIDMsIDRdKSwgW1sxLCAxXSwgWzJdLCBbMywgM10sIFs0XV0pXG4gKlxuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgY2hvcCA9IGZ1bmN0aW9uIChmKSB7XG4gICAgdmFyIGcgPSBSTkVBLmNob3AoZik7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykgeyByZXR1cm4gKGlzTm9uRW1wdHkoYXMpID8gZyhhcykgOiBlbXB0eSk7IH07XG59O1xuLyoqXG4gKiBTcGxpdHMgYSBgUmVhZG9ubHlBcnJheWAgaW50byB0d28gcGllY2VzLCB0aGUgZmlyc3QgcGllY2UgaGFzIG1heCBgbmAgZWxlbWVudHMuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IHNwbGl0QXQgfSBmcm9tICdmcC10cy9SZWFkb25seUFycmF5J1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoc3BsaXRBdCgyKShbMSwgMiwgMywgNCwgNV0pLCBbWzEsIDJdLCBbMywgNCwgNV1dKVxuICpcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIHNwbGl0QXQgPSBmdW5jdGlvbiAobikge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgcmV0dXJuIG4gPj0gMSAmJiBpc05vbkVtcHR5KGFzKSA/IFJORUEuc3BsaXRBdChuKShhcykgOiBpc0VtcHR5KGFzKSA/IFthcywgZW1wdHldIDogW2VtcHR5LCBhc107XG4gICAgfTtcbn07XG4vKipcbiAqIFNwbGl0cyBhIGBSZWFkb25seUFycmF5YCBpbnRvIGxlbmd0aC1gbmAgcGllY2VzLiBUaGUgbGFzdCBwaWVjZSB3aWxsIGJlIHNob3J0ZXIgaWYgYG5gIGRvZXMgbm90IGV2ZW5seSBkaXZpZGUgdGhlIGxlbmd0aCBvZlxuICogdGhlIGBSZWFkb25seUFycmF5YC4gTm90ZSB0aGF0IGBjaHVua3NPZihuKShbXSlgIGlzIGBbXWAsIG5vdCBgW1tdXWAuIFRoaXMgaXMgaW50ZW50aW9uYWwsIGFuZCBpcyBjb25zaXN0ZW50IHdpdGggYSByZWN1cnNpdmVcbiAqIGRlZmluaXRpb24gb2YgYGNodW5rc09mYDsgaXQgc2F0aXNmaWVzIHRoZSBwcm9wZXJ0eSB0aGF0OlxuICpcbiAqIGBgYHRzXG4gKiBjaHVua3NPZihuKSh4cykuY29uY2F0KGNodW5rc09mKG4pKHlzKSkgPT0gY2h1bmtzT2YobikoeHMuY29uY2F0KHlzKSkpXG4gKiBgYGBcbiAqXG4gKiB3aGVuZXZlciBgbmAgZXZlbmx5IGRpdmlkZXMgdGhlIGxlbmd0aCBvZiBgYXNgLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBjaHVua3NPZiB9IGZyb20gJ2ZwLXRzL1JlYWRvbmx5QXJyYXknXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChjaHVua3NPZigyKShbMSwgMiwgMywgNCwgNV0pLCBbWzEsIDJdLCBbMywgNF0sIFs1XV0pXG4gKlxuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgY2h1bmtzT2YgPSBmdW5jdGlvbiAobikge1xuICAgIHZhciBmID0gUk5FQS5jaHVua3NPZihuKTtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7IHJldHVybiAoaXNOb25FbXB0eShhcykgPyBmKGFzKSA6IGVtcHR5KTsgfTtcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBsaWZ0aW5nXG4gKiBAc2luY2UgMi4xMS4wXG4gKi9cbmV4cG9ydCB2YXIgZnJvbU9wdGlvbksgPSBmdW5jdGlvbiAoZikge1xuICAgIHJldHVybiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBhID0gW107XG4gICAgICAgIGZvciAodmFyIF9pID0gMDsgX2kgPCBhcmd1bWVudHMubGVuZ3RoOyBfaSsrKSB7XG4gICAgICAgICAgICBhW19pXSA9IGFyZ3VtZW50c1tfaV07XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGZyb21PcHRpb24oZi5hcHBseSh2b2lkIDAsIGEpKTtcbiAgICB9O1xufTtcbmV4cG9ydCBmdW5jdGlvbiBjb21wcmVoZW5zaW9uKGlucHV0LCBmLCBnKSB7XG4gICAgaWYgKGcgPT09IHZvaWQgMCkgeyBnID0gZnVuY3Rpb24gKCkgeyByZXR1cm4gdHJ1ZTsgfTsgfVxuICAgIHZhciBnbyA9IGZ1bmN0aW9uIChzY29wZSwgaW5wdXQpIHtcbiAgICAgICAgcmV0dXJuIGlzTm9uRW1wdHkoaW5wdXQpXG4gICAgICAgICAgICA/IGZsYXRNYXAoUk5FQS5oZWFkKGlucHV0KSwgZnVuY3Rpb24gKGEpIHsgcmV0dXJuIGdvKHBpcGUoc2NvcGUsIGFwcGVuZChhKSksIFJORUEudGFpbChpbnB1dCkpOyB9KVxuICAgICAgICAgICAgOiBnLmFwcGx5KHZvaWQgMCwgc2NvcGUpID8gW2YuYXBwbHkodm9pZCAwLCBzY29wZSldXG4gICAgICAgICAgICAgICAgOiBlbXB0eTtcbiAgICB9O1xuICAgIHJldHVybiBnbyhlbXB0eSwgaW5wdXQpO1xufVxuLyoqXG4gKiBAc2luY2UgMi4xMS4wXG4gKi9cbmV4cG9ydCB2YXIgY29uY2F0VyA9IGZ1bmN0aW9uIChzZWNvbmQpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGZpcnN0KSB7XG4gICAgICAgIHJldHVybiBpc0VtcHR5KGZpcnN0KSA/IHNlY29uZCA6IGlzRW1wdHkoc2Vjb25kKSA/IGZpcnN0IDogZmlyc3QuY29uY2F0KHNlY29uZCk7XG4gICAgfTtcbn07XG4vKipcbiAqIEBzaW5jZSAyLjExLjBcbiAqL1xuZXhwb3J0IHZhciBjb25jYXQgPSBjb25jYXRXO1xuZXhwb3J0IGZ1bmN0aW9uIHVuaW9uKEUpIHtcbiAgICB2YXIgdW5pb25FID0gUk5FQS51bmlvbihFKTtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGZpcnN0LCBzZWNvbmQpIHtcbiAgICAgICAgaWYgKHNlY29uZCA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICB2YXIgdW5pb25FXzEgPSB1bmlvbihFKTtcbiAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbiAoc2Vjb25kKSB7IHJldHVybiB1bmlvbkVfMShzZWNvbmQsIGZpcnN0KTsgfTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gaXNOb25FbXB0eShmaXJzdCkgJiYgaXNOb25FbXB0eShzZWNvbmQpID8gdW5pb25FKHNlY29uZCkoZmlyc3QpIDogaXNOb25FbXB0eShmaXJzdCkgPyBmaXJzdCA6IHNlY29uZDtcbiAgICB9O1xufVxuZXhwb3J0IGZ1bmN0aW9uIGludGVyc2VjdGlvbihFKSB7XG4gICAgdmFyIGVsZW1FID0gZWxlbShFKTtcbiAgICByZXR1cm4gZnVuY3Rpb24gKHhzLCB5cykge1xuICAgICAgICBpZiAoeXMgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgdmFyIGludGVyc2VjdGlvbkVfMSA9IGludGVyc2VjdGlvbihFKTtcbiAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbiAoeXMpIHsgcmV0dXJuIGludGVyc2VjdGlvbkVfMSh5cywgeHMpOyB9O1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB4cy5maWx0ZXIoZnVuY3Rpb24gKGEpIHsgcmV0dXJuIGVsZW1FKGEsIHlzKTsgfSk7XG4gICAgfTtcbn1cbmV4cG9ydCBmdW5jdGlvbiBkaWZmZXJlbmNlKEUpIHtcbiAgICB2YXIgZWxlbUUgPSBlbGVtKEUpO1xuICAgIHJldHVybiBmdW5jdGlvbiAoeHMsIHlzKSB7XG4gICAgICAgIGlmICh5cyA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICB2YXIgZGlmZmVyZW5jZUVfMSA9IGRpZmZlcmVuY2UoRSk7XG4gICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24gKHlzKSB7IHJldHVybiBkaWZmZXJlbmNlRV8xKHlzLCB4cyk7IH07XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHhzLmZpbHRlcihmdW5jdGlvbiAoYSkgeyByZXR1cm4gIWVsZW1FKGEsIHlzKTsgfSk7XG4gICAgfTtcbn1cbnZhciBfbWFwID0gZnVuY3Rpb24gKGZhLCBmKSB7IHJldHVybiBwaXBlKGZhLCBtYXAoZikpOyB9O1xudmFyIF9tYXBXaXRoSW5kZXggPSBmdW5jdGlvbiAoZmEsIGYpIHsgcmV0dXJuIHBpcGUoZmEsIG1hcFdpdGhJbmRleChmKSk7IH07XG52YXIgX2FwID0gZnVuY3Rpb24gKGZhYiwgZmEpIHsgcmV0dXJuIHBpcGUoZmFiLCBhcChmYSkpOyB9O1xudmFyIF9maWx0ZXIgPSBmdW5jdGlvbiAoZmEsIHByZWRpY2F0ZSkge1xuICAgIHJldHVybiBwaXBlKGZhLCBmaWx0ZXIocHJlZGljYXRlKSk7XG59O1xudmFyIF9maWx0ZXJNYXAgPSBmdW5jdGlvbiAoZmEsIGYpIHsgcmV0dXJuIHBpcGUoZmEsIGZpbHRlck1hcChmKSk7IH07XG52YXIgX3BhcnRpdGlvbiA9IGZ1bmN0aW9uIChmYSwgcHJlZGljYXRlKSB7XG4gICAgcmV0dXJuIHBpcGUoZmEsIHBhcnRpdGlvbihwcmVkaWNhdGUpKTtcbn07XG52YXIgX3BhcnRpdGlvbk1hcCA9IGZ1bmN0aW9uIChmYSwgZikgeyByZXR1cm4gcGlwZShmYSwgcGFydGl0aW9uTWFwKGYpKTsgfTtcbnZhciBfcGFydGl0aW9uV2l0aEluZGV4ID0gZnVuY3Rpb24gKGZhLCBwcmVkaWNhdGVXaXRoSW5kZXgpIHsgcmV0dXJuIHBpcGUoZmEsIHBhcnRpdGlvbldpdGhJbmRleChwcmVkaWNhdGVXaXRoSW5kZXgpKTsgfTtcbnZhciBfcGFydGl0aW9uTWFwV2l0aEluZGV4ID0gZnVuY3Rpb24gKGZhLCBmKSB7IHJldHVybiBwaXBlKGZhLCBwYXJ0aXRpb25NYXBXaXRoSW5kZXgoZikpOyB9O1xudmFyIF9hbHQgPSBmdW5jdGlvbiAoZmEsIHRoYXQpIHsgcmV0dXJuIHBpcGUoZmEsIGFsdCh0aGF0KSk7IH07XG52YXIgX3JlZHVjZSA9IGZ1bmN0aW9uIChmYSwgYiwgZikgeyByZXR1cm4gcGlwZShmYSwgcmVkdWNlKGIsIGYpKTsgfTtcbnZhciBfZm9sZE1hcCA9IGZ1bmN0aW9uIChNKSB7XG4gICAgdmFyIGZvbGRNYXBNID0gZm9sZE1hcChNKTtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGZhLCBmKSB7IHJldHVybiBwaXBlKGZhLCBmb2xkTWFwTShmKSk7IH07XG59O1xudmFyIF9yZWR1Y2VSaWdodCA9IGZ1bmN0aW9uIChmYSwgYiwgZikgeyByZXR1cm4gcGlwZShmYSwgcmVkdWNlUmlnaHQoYiwgZikpOyB9O1xudmFyIF9yZWR1Y2VXaXRoSW5kZXggPSBmdW5jdGlvbiAoZmEsIGIsIGYpIHtcbiAgICByZXR1cm4gcGlwZShmYSwgcmVkdWNlV2l0aEluZGV4KGIsIGYpKTtcbn07XG52YXIgX2ZvbGRNYXBXaXRoSW5kZXggPSBmdW5jdGlvbiAoTSkge1xuICAgIHZhciBmb2xkTWFwV2l0aEluZGV4TSA9IGZvbGRNYXBXaXRoSW5kZXgoTSk7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChmYSwgZikgeyByZXR1cm4gcGlwZShmYSwgZm9sZE1hcFdpdGhJbmRleE0oZikpOyB9O1xufTtcbnZhciBfcmVkdWNlUmlnaHRXaXRoSW5kZXggPSBmdW5jdGlvbiAoZmEsIGIsIGYpIHtcbiAgICByZXR1cm4gcGlwZShmYSwgcmVkdWNlUmlnaHRXaXRoSW5kZXgoYiwgZikpO1xufTtcbnZhciBfZmlsdGVyTWFwV2l0aEluZGV4ID0gZnVuY3Rpb24gKGZhLCBmKSB7IHJldHVybiBwaXBlKGZhLCBmaWx0ZXJNYXBXaXRoSW5kZXgoZikpOyB9O1xudmFyIF9maWx0ZXJXaXRoSW5kZXggPSBmdW5jdGlvbiAoZmEsIHByZWRpY2F0ZVdpdGhJbmRleCkgeyByZXR1cm4gcGlwZShmYSwgZmlsdGVyV2l0aEluZGV4KHByZWRpY2F0ZVdpdGhJbmRleCkpOyB9O1xudmFyIF9leHRlbmQgPSBmdW5jdGlvbiAoZmEsIGYpIHsgcmV0dXJuIHBpcGUoZmEsIGV4dGVuZChmKSk7IH07XG52YXIgX3RyYXZlcnNlID0gZnVuY3Rpb24gKEYpIHtcbiAgICB2YXIgdHJhdmVyc2VGID0gdHJhdmVyc2UoRik7XG4gICAgcmV0dXJuIGZ1bmN0aW9uICh0YSwgZikgeyByZXR1cm4gcGlwZSh0YSwgdHJhdmVyc2VGKGYpKTsgfTtcbn07XG4vKiBpc3RhbmJ1bCBpZ25vcmUgbmV4dCAqL1xudmFyIF90cmF2ZXJzZVdpdGhJbmRleCA9IGZ1bmN0aW9uIChGKSB7XG4gICAgdmFyIHRyYXZlcnNlV2l0aEluZGV4RiA9IHRyYXZlcnNlV2l0aEluZGV4KEYpO1xuICAgIHJldHVybiBmdW5jdGlvbiAodGEsIGYpIHsgcmV0dXJuIHBpcGUodGEsIHRyYXZlcnNlV2l0aEluZGV4RihmKSk7IH07XG59O1xuLyoqIEBpbnRlcm5hbCAqL1xuZXhwb3J0IHZhciBfY2hhaW5SZWNEZXB0aEZpcnN0ID0gZnVuY3Rpb24gKGEsIGYpIHsgcmV0dXJuIHBpcGUoYSwgY2hhaW5SZWNEZXB0aEZpcnN0KGYpKTsgfTtcbi8qKiBAaW50ZXJuYWwgKi9cbmV4cG9ydCB2YXIgX2NoYWluUmVjQnJlYWR0aEZpcnN0ID0gZnVuY3Rpb24gKGEsIGYpIHsgcmV0dXJuIHBpcGUoYSwgY2hhaW5SZWNCcmVhZHRoRmlyc3QoZikpOyB9O1xuLyoqXG4gKiBAY2F0ZWdvcnkgY29uc3RydWN0b3JzXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBvZiA9IFJORUEub2Y7XG4vKipcbiAqIEBzaW5jZSAyLjcuMFxuICovXG5leHBvcnQgdmFyIHplcm8gPSBmdW5jdGlvbiAoKSB7IHJldHVybiBlbXB0eTsgfTtcbi8qKlxuICogTGVzcyBzdHJpY3QgdmVyc2lvbiBvZiBbYGFsdGBdKCNhbHQpLlxuICpcbiAqIFRoZSBgV2Agc3VmZml4IChzaG9ydCBmb3IgKipXKippZGVuaW5nKSBtZWFucyB0aGF0IHRoZSByZXR1cm4gdHlwZXMgd2lsbCBiZSBtZXJnZWQuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCAqIGFzIFJBIGZyb20gJ2ZwLXRzL1JlYWRvbmx5QXJyYXknXG4gKiBpbXBvcnQgeyBwaXBlIH0gZnJvbSAnZnAtdHMvZnVuY3Rpb24nXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChcbiAqICAgcGlwZShcbiAqICAgICBbMSwgMiwgM10sXG4gKiAgICAgUkEuYWx0VygoKSA9PiBbJ2EnLCAnYiddKVxuICogICApLFxuICogICBbMSwgMiwgMywgJ2EnLCAnYiddXG4gKiApXG4gKlxuICogQGNhdGVnb3J5IGVycm9yIGhhbmRsaW5nXG4gKiBAc2luY2UgMi45LjBcbiAqL1xuZXhwb3J0IHZhciBhbHRXID0gZnVuY3Rpb24gKHRoYXQpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGZhKSB7XG4gICAgICAgIHJldHVybiBmYS5jb25jYXQodGhhdCgpKTtcbiAgICB9O1xufTtcbi8qKlxuICogSWRlbnRpZmllcyBhbiBhc3NvY2lhdGl2ZSBvcGVyYXRpb24gb24gYSB0eXBlIGNvbnN0cnVjdG9yLiBJdCBpcyBzaW1pbGFyIHRvIGBTZW1pZ3JvdXBgLCBleGNlcHQgdGhhdCBpdCBhcHBsaWVzIHRvXG4gKiB0eXBlcyBvZiBraW5kIGAqIC0+ICpgLlxuICpcbiAqIEluIGNhc2Ugb2YgYFJlYWRvbmx5QXJyYXlgIGNvbmNhdGVuYXRlcyB0aGUgaW5wdXRzIGludG8gYSBzaW5nbGUgYXJyYXkuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCAqIGFzIFJBIGZyb20gJ2ZwLXRzL1JlYWRvbmx5QXJyYXknXG4gKiBpbXBvcnQgeyBwaXBlIH0gZnJvbSAnZnAtdHMvZnVuY3Rpb24nXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChcbiAqICAgcGlwZShcbiAqICAgICBbMSwgMiwgM10sXG4gKiAgICAgUkEuYWx0KCgpID0+IFs0LCA1XSlcbiAqICAgKSxcbiAqICAgWzEsIDIsIDMsIDQsIDVdXG4gKiApXG4gKlxuICogQGNhdGVnb3J5IGVycm9yIGhhbmRsaW5nXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBhbHQgPSBhbHRXO1xuLyoqXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBhcCA9IGZ1bmN0aW9uIChmYSkge1xuICAgIHJldHVybiBmbGF0TWFwKGZ1bmN0aW9uIChmKSB7IHJldHVybiBwaXBlKGZhLCBtYXAoZikpOyB9KTtcbn07XG4vKipcbiAqIENvbXBvc2VzIGNvbXB1dGF0aW9ucyBpbiBzZXF1ZW5jZSwgdXNpbmcgdGhlIHJldHVybiB2YWx1ZSBvZiBvbmUgY29tcHV0YXRpb24gdG8gZGV0ZXJtaW5lIHRoZSBuZXh0IGNvbXB1dGF0aW9uLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgKiBhcyBSQSBmcm9tICdmcC10cy9SZWFkb25seUFycmF5J1xuICogaW1wb3J0IHsgcGlwZSB9IGZyb20gJ2ZwLXRzL2Z1bmN0aW9uJ1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoXG4gKiAgIHBpcGUoXG4gKiAgICAgWzEsIDIsIDNdLFxuICogICAgIFJBLmZsYXRNYXAoKG4pID0+IFtgYSR7bn1gLCBgYiR7bn1gXSlcbiAqICAgKSxcbiAqICAgWydhMScsICdiMScsICdhMicsICdiMicsICdhMycsICdiMyddXG4gKiApXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKFxuICogICBwaXBlKFxuICogICAgIFsxLCAyLCAzXSxcbiAqICAgICBSQS5mbGF0TWFwKCgpID0+IFtdKVxuICogICApLFxuICogICBbXVxuICogKVxuICpcbiAqIEBjYXRlZ29yeSBzZXF1ZW5jaW5nXG4gKiBAc2luY2UgMi4xNC4wXG4gKi9cbmV4cG9ydCB2YXIgZmxhdE1hcCA9IC8qI19fUFVSRV9fKi8gZHVhbCgyLCBmdW5jdGlvbiAobWEsIGYpIHtcbiAgICByZXR1cm4gcGlwZShtYSwgY2hhaW5XaXRoSW5kZXgoZnVuY3Rpb24gKGksIGEpIHsgcmV0dXJuIGYoYSwgaSk7IH0pKTtcbn0pO1xuLyoqXG4gKiBAY2F0ZWdvcnkgc2VxdWVuY2luZ1xuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgZmxhdHRlbiA9IC8qI19fUFVSRV9fKi8gZmxhdE1hcChpZGVudGl0eSk7XG4vKipcbiAqIGBtYXBgIGNhbiBiZSB1c2VkIHRvIHR1cm4gZnVuY3Rpb25zIGAoYTogQSkgPT4gQmAgaW50byBmdW5jdGlvbnMgYChmYTogRjxBPikgPT4gRjxCPmAgd2hvc2UgYXJndW1lbnQgYW5kIHJldHVybiB0eXBlc1xuICogdXNlIHRoZSB0eXBlIGNvbnN0cnVjdG9yIGBGYCB0byByZXByZXNlbnQgc29tZSBjb21wdXRhdGlvbmFsIGNvbnRleHQuXG4gKlxuICogQGNhdGVnb3J5IG1hcHBpbmdcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIG1hcCA9IGZ1bmN0aW9uIChmKSB7IHJldHVybiBmdW5jdGlvbiAoZmEpIHtcbiAgICByZXR1cm4gZmEubWFwKGZ1bmN0aW9uIChhKSB7IHJldHVybiBmKGEpOyB9KTtcbn07IH07XG4vKipcbiAqIEBjYXRlZ29yeSBtYXBwaW5nXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBtYXBXaXRoSW5kZXggPSBmdW5jdGlvbiAoZikgeyByZXR1cm4gZnVuY3Rpb24gKGZhKSB7XG4gICAgcmV0dXJuIGZhLm1hcChmdW5jdGlvbiAoYSwgaSkgeyByZXR1cm4gZihpLCBhKTsgfSk7XG59OyB9O1xuLyoqXG4gKiBAY2F0ZWdvcnkgZmlsdGVyaW5nXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBzZXBhcmF0ZSA9IGZ1bmN0aW9uIChmYSkge1xuICAgIHZhciBsZWZ0ID0gW107XG4gICAgdmFyIHJpZ2h0ID0gW107XG4gICAgZm9yICh2YXIgX2kgPSAwLCBmYV8xID0gZmE7IF9pIDwgZmFfMS5sZW5ndGg7IF9pKyspIHtcbiAgICAgICAgdmFyIGUgPSBmYV8xW19pXTtcbiAgICAgICAgaWYgKGUuX3RhZyA9PT0gJ0xlZnQnKSB7XG4gICAgICAgICAgICBsZWZ0LnB1c2goZS5sZWZ0KTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHJpZ2h0LnB1c2goZS5yaWdodCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHNlcGFyYXRlZChsZWZ0LCByaWdodCk7XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgZmlsdGVyaW5nXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBmaWx0ZXIgPSBmdW5jdGlvbiAocHJlZGljYXRlKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykge1xuICAgICAgICByZXR1cm4gYXMuZmlsdGVyKHByZWRpY2F0ZSk7XG4gICAgfTtcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBmaWx0ZXJpbmdcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIGZpbHRlck1hcFdpdGhJbmRleCA9IGZ1bmN0aW9uIChmKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChmYSkge1xuICAgICAgICB2YXIgb3V0ID0gW107XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgZmEubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIHZhciBvcHRpb25CID0gZihpLCBmYVtpXSk7XG4gICAgICAgICAgICBpZiAoXy5pc1NvbWUob3B0aW9uQikpIHtcbiAgICAgICAgICAgICAgICBvdXQucHVzaChvcHRpb25CLnZhbHVlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gb3V0O1xuICAgIH07XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgZmlsdGVyaW5nXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBmaWx0ZXJNYXAgPSBmdW5jdGlvbiAoZikge1xuICAgIHJldHVybiBmaWx0ZXJNYXBXaXRoSW5kZXgoZnVuY3Rpb24gKF8sIGEpIHsgcmV0dXJuIGYoYSk7IH0pO1xufTtcbi8qKlxuICogQGNhdGVnb3J5IGZpbHRlcmluZ1xuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgY29tcGFjdCA9IC8qI19fUFVSRV9fKi8gZmlsdGVyTWFwKGlkZW50aXR5KTtcbi8qKlxuICogQGNhdGVnb3J5IGZpbHRlcmluZ1xuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgcGFydGl0aW9uID0gZnVuY3Rpb24gKHByZWRpY2F0ZSkge1xuICAgIHJldHVybiBwYXJ0aXRpb25XaXRoSW5kZXgoZnVuY3Rpb24gKF8sIGEpIHsgcmV0dXJuIHByZWRpY2F0ZShhKTsgfSk7XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgZmlsdGVyaW5nXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBwYXJ0aXRpb25XaXRoSW5kZXggPSBmdW5jdGlvbiAocHJlZGljYXRlV2l0aEluZGV4KSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykge1xuICAgICAgICB2YXIgbGVmdCA9IFtdO1xuICAgICAgICB2YXIgcmlnaHQgPSBbXTtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBhcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgdmFyIGEgPSBhc1tpXTtcbiAgICAgICAgICAgIGlmIChwcmVkaWNhdGVXaXRoSW5kZXgoaSwgYSkpIHtcbiAgICAgICAgICAgICAgICByaWdodC5wdXNoKGEpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgbGVmdC5wdXNoKGEpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBzZXBhcmF0ZWQobGVmdCwgcmlnaHQpO1xuICAgIH07XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgZmlsdGVyaW5nXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBwYXJ0aXRpb25NYXAgPSBmdW5jdGlvbiAoZikge1xuICAgIHJldHVybiBwYXJ0aXRpb25NYXBXaXRoSW5kZXgoZnVuY3Rpb24gKF8sIGEpIHsgcmV0dXJuIGYoYSk7IH0pO1xufTtcbi8qKlxuICogQGNhdGVnb3J5IGZpbHRlcmluZ1xuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgcGFydGl0aW9uTWFwV2l0aEluZGV4ID0gZnVuY3Rpb24gKGYpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGZhKSB7XG4gICAgICAgIHZhciBsZWZ0ID0gW107XG4gICAgICAgIHZhciByaWdodCA9IFtdO1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGZhLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICB2YXIgZSA9IGYoaSwgZmFbaV0pO1xuICAgICAgICAgICAgaWYgKGUuX3RhZyA9PT0gJ0xlZnQnKSB7XG4gICAgICAgICAgICAgICAgbGVmdC5wdXNoKGUubGVmdCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICByaWdodC5wdXNoKGUucmlnaHQpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBzZXBhcmF0ZWQobGVmdCwgcmlnaHQpO1xuICAgIH07XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgZmlsdGVyaW5nXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBmaWx0ZXJXaXRoSW5kZXggPSBmdW5jdGlvbiAocHJlZGljYXRlV2l0aEluZGV4KSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykge1xuICAgICAgICByZXR1cm4gYXMuZmlsdGVyKGZ1bmN0aW9uIChhLCBpKSB7IHJldHVybiBwcmVkaWNhdGVXaXRoSW5kZXgoaSwgYSk7IH0pO1xuICAgIH07XG59O1xuLyoqXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBleHRlbmQgPSBmdW5jdGlvbiAoZikgeyByZXR1cm4gZnVuY3Rpb24gKHdhKSB7XG4gICAgcmV0dXJuIHdhLm1hcChmdW5jdGlvbiAoXywgaSkgeyByZXR1cm4gZih3YS5zbGljZShpKSk7IH0pO1xufTsgfTtcbi8qKlxuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgZHVwbGljYXRlID0gLyojX19QVVJFX18qLyBleHRlbmQoaWRlbnRpdHkpO1xuLyoqXG4gKiBAY2F0ZWdvcnkgZm9sZGluZ1xuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgZm9sZE1hcFdpdGhJbmRleCA9IGZ1bmN0aW9uIChNKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChmKSB7XG4gICAgICAgIHJldHVybiBmdW5jdGlvbiAoZmEpIHtcbiAgICAgICAgICAgIHJldHVybiBmYS5yZWR1Y2UoZnVuY3Rpb24gKGIsIGEsIGkpIHsgcmV0dXJuIE0uY29uY2F0KGIsIGYoaSwgYSkpOyB9LCBNLmVtcHR5KTtcbiAgICAgICAgfTtcbiAgICB9O1xufTtcbi8qKlxuICogQGNhdGVnb3J5IGZvbGRpbmdcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIHJlZHVjZSA9IGZ1bmN0aW9uIChiLCBmKSB7XG4gICAgcmV0dXJuIHJlZHVjZVdpdGhJbmRleChiLCBmdW5jdGlvbiAoXywgYiwgYSkgeyByZXR1cm4gZihiLCBhKTsgfSk7XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgZm9sZGluZ1xuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgZm9sZE1hcCA9IGZ1bmN0aW9uIChNKSB7XG4gICAgdmFyIGZvbGRNYXBXaXRoSW5kZXhNID0gZm9sZE1hcFdpdGhJbmRleChNKTtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGYpIHsgcmV0dXJuIGZvbGRNYXBXaXRoSW5kZXhNKGZ1bmN0aW9uIChfLCBhKSB7IHJldHVybiBmKGEpOyB9KTsgfTtcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBmb2xkaW5nXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciByZWR1Y2VXaXRoSW5kZXggPSBmdW5jdGlvbiAoYiwgZikgeyByZXR1cm4gZnVuY3Rpb24gKGZhKSB7XG4gICAgdmFyIGxlbiA9IGZhLmxlbmd0aDtcbiAgICB2YXIgb3V0ID0gYjtcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IGxlbjsgaSsrKSB7XG4gICAgICAgIG91dCA9IGYoaSwgb3V0LCBmYVtpXSk7XG4gICAgfVxuICAgIHJldHVybiBvdXQ7XG59OyB9O1xuLyoqXG4gKiBAY2F0ZWdvcnkgZm9sZGluZ1xuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgcmVkdWNlUmlnaHQgPSBmdW5jdGlvbiAoYiwgZikge1xuICAgIHJldHVybiByZWR1Y2VSaWdodFdpdGhJbmRleChiLCBmdW5jdGlvbiAoXywgYSwgYikgeyByZXR1cm4gZihhLCBiKTsgfSk7XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgZm9sZGluZ1xuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgcmVkdWNlUmlnaHRXaXRoSW5kZXggPSBmdW5jdGlvbiAoYiwgZikgeyByZXR1cm4gZnVuY3Rpb24gKGZhKSB7XG4gICAgcmV0dXJuIGZhLnJlZHVjZVJpZ2h0KGZ1bmN0aW9uIChiLCBhLCBpKSB7IHJldHVybiBmKGksIGEsIGIpOyB9LCBiKTtcbn07IH07XG4vKipcbiAqIEBjYXRlZ29yeSB0cmF2ZXJzaW5nXG4gKiBAc2luY2UgMi42LjNcbiAqL1xuZXhwb3J0IHZhciB0cmF2ZXJzZSA9IGZ1bmN0aW9uIChGKSB7XG4gICAgdmFyIHRyYXZlcnNlV2l0aEluZGV4RiA9IHRyYXZlcnNlV2l0aEluZGV4KEYpO1xuICAgIHJldHVybiBmdW5jdGlvbiAoZikgeyByZXR1cm4gdHJhdmVyc2VXaXRoSW5kZXhGKGZ1bmN0aW9uIChfLCBhKSB7IHJldHVybiBmKGEpOyB9KTsgfTtcbn07XG4vKipcbiAqIEBjYXRlZ29yeSB0cmF2ZXJzaW5nXG4gKiBAc2luY2UgMi42LjNcbiAqL1xuZXhwb3J0IHZhciBzZXF1ZW5jZSA9IGZ1bmN0aW9uIChGKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uICh0YSkge1xuICAgICAgICByZXR1cm4gX3JlZHVjZSh0YSwgRi5vZih6ZXJvKCkpLCBmdW5jdGlvbiAoZmFzLCBmYSkge1xuICAgICAgICAgICAgcmV0dXJuIEYuYXAoRi5tYXAoZmFzLCBmdW5jdGlvbiAoYXMpIHsgcmV0dXJuIGZ1bmN0aW9uIChhKSB7IHJldHVybiBwaXBlKGFzLCBhcHBlbmQoYSkpOyB9OyB9KSwgZmEpO1xuICAgICAgICB9KTtcbiAgICB9O1xufTtcbi8qKlxuICogQGNhdGVnb3J5IHNlcXVlbmNpbmdcbiAqIEBzaW5jZSAyLjYuM1xuICovXG5leHBvcnQgdmFyIHRyYXZlcnNlV2l0aEluZGV4ID0gZnVuY3Rpb24gKEYpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGYpIHtcbiAgICAgICAgcmV0dXJuIHJlZHVjZVdpdGhJbmRleChGLm9mKHplcm8oKSksIGZ1bmN0aW9uIChpLCBmYnMsIGEpIHtcbiAgICAgICAgICAgIHJldHVybiBGLmFwKEYubWFwKGZicywgZnVuY3Rpb24gKGJzKSB7IHJldHVybiBmdW5jdGlvbiAoYikgeyByZXR1cm4gcGlwZShicywgYXBwZW5kKGIpKTsgfTsgfSksIGYoaSwgYSkpO1xuICAgICAgICB9KTtcbiAgICB9O1xufTtcbi8qKlxuICogQGNhdGVnb3J5IGZpbHRlcmluZ1xuICogQHNpbmNlIDIuNi41XG4gKi9cbmV4cG9ydCB2YXIgd2l0aGVyID0gZnVuY3Rpb24gKEYpIHtcbiAgICB2YXIgX3dpdGhlckYgPSBfd2l0aGVyKEYpO1xuICAgIHJldHVybiBmdW5jdGlvbiAoZikgeyByZXR1cm4gZnVuY3Rpb24gKGZhKSB7IHJldHVybiBfd2l0aGVyRihmYSwgZik7IH07IH07XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgZmlsdGVyaW5nXG4gKiBAc2luY2UgMi42LjVcbiAqL1xuZXhwb3J0IHZhciB3aWx0ID0gZnVuY3Rpb24gKEYpIHtcbiAgICB2YXIgX3dpbHRGID0gX3dpbHQoRik7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChmKSB7IHJldHVybiBmdW5jdGlvbiAoZmEpIHsgcmV0dXJuIF93aWx0RihmYSwgZik7IH07IH07XG59O1xuLyoqXG4gKiBAc2luY2UgMi42LjZcbiAqL1xuZXhwb3J0IHZhciB1bmZvbGQgPSBmdW5jdGlvbiAoYiwgZikge1xuICAgIHZhciBvdXQgPSBbXTtcbiAgICB2YXIgYmIgPSBiO1xuICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBuby1jb25zdGFudC1jb25kaXRpb25cbiAgICB3aGlsZSAodHJ1ZSkge1xuICAgICAgICB2YXIgbXQgPSBmKGJiKTtcbiAgICAgICAgaWYgKF8uaXNTb21lKG10KSkge1xuICAgICAgICAgICAgdmFyIF9hID0gbXQudmFsdWUsIGEgPSBfYVswXSwgYl8xID0gX2FbMV07XG4gICAgICAgICAgICBvdXQucHVzaChhKTtcbiAgICAgICAgICAgIGJiID0gYl8xO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIG91dDtcbn07XG4vKipcbiAqIEBjYXRlZ29yeSB0eXBlIGxhbWJkYXNcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIFVSSSA9ICdSZWFkb25seUFycmF5Jztcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgZ2V0U2hvdyA9IGZ1bmN0aW9uIChTKSB7IHJldHVybiAoe1xuICAgIHNob3c6IGZ1bmN0aW9uIChhcykgeyByZXR1cm4gXCJbXCIuY29uY2F0KGFzLm1hcChTLnNob3cpLmpvaW4oJywgJyksIFwiXVwiKTsgfVxufSk7IH07XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIGdldFNlbWlncm91cCA9IGZ1bmN0aW9uICgpIHsgcmV0dXJuICh7XG4gICAgY29uY2F0OiBmdW5jdGlvbiAoZmlyc3QsIHNlY29uZCkgeyByZXR1cm4gKGlzRW1wdHkoZmlyc3QpID8gc2Vjb25kIDogaXNFbXB0eShzZWNvbmQpID8gZmlyc3QgOiBmaXJzdC5jb25jYXQoc2Vjb25kKSk7IH1cbn0pOyB9O1xuLyoqXG4gKiBSZXR1cm5zIGEgYE1vbm9pZGAgZm9yIGBSZWFkb25seUFycmF5PEE+YC5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgZ2V0TW9ub2lkIH0gZnJvbSAnZnAtdHMvUmVhZG9ubHlBcnJheSdcbiAqXG4gKiBjb25zdCBNID0gZ2V0TW9ub2lkPG51bWJlcj4oKVxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChNLmNvbmNhdChbMSwgMl0sIFszLCA0XSksIFsxLCAyLCAzLCA0XSlcbiAqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBnZXRNb25vaWQgPSBmdW5jdGlvbiAoKSB7IHJldHVybiAoe1xuICAgIGNvbmNhdDogZ2V0U2VtaWdyb3VwKCkuY29uY2F0LFxuICAgIGVtcHR5OiBlbXB0eVxufSk7IH07XG4vKipcbiAqIERlcml2ZXMgYW4gYEVxYCBvdmVyIHRoZSBgUmVhZG9ubHlBcnJheWAgb2YgYSBnaXZlbiBlbGVtZW50IHR5cGUgZnJvbSB0aGUgYEVxYCBvZiB0aGF0IHR5cGUuIFRoZSBkZXJpdmVkIGBFcWAgZGVmaW5lcyB0d29cbiAqIGFycmF5cyBhcyBlcXVhbCBpZiBhbGwgZWxlbWVudHMgb2YgYm90aCBhcnJheXMgYXJlIGNvbXBhcmVkIGVxdWFsIHBhaXJ3aXNlIHdpdGggdGhlIGdpdmVuIGBFYC4gSW4gY2FzZSBvZiBhcnJheXMgb2ZcbiAqIGRpZmZlcmVudCBsZW5ndGhzLCB0aGUgcmVzdWx0IGlzIG5vbiBlcXVhbGl0eS5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0ICogYXMgUyBmcm9tICdmcC10cy9zdHJpbmcnXG4gKiBpbXBvcnQgeyBnZXRFcSB9IGZyb20gJ2ZwLXRzL1JlYWRvbmx5QXJyYXknXG4gKlxuICogY29uc3QgRSA9IGdldEVxKFMuRXEpXG4gKiBhc3NlcnQuc3RyaWN0RXF1YWwoRS5lcXVhbHMoWydhJywgJ2InXSwgWydhJywgJ2InXSksIHRydWUpXG4gKiBhc3NlcnQuc3RyaWN0RXF1YWwoRS5lcXVhbHMoWydhJ10sIFtdKSwgZmFsc2UpXG4gKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgZ2V0RXEgPSBmdW5jdGlvbiAoRSkge1xuICAgIHJldHVybiBmcm9tRXF1YWxzKGZ1bmN0aW9uICh4cywgeXMpIHsgcmV0dXJuIHhzLmxlbmd0aCA9PT0geXMubGVuZ3RoICYmIHhzLmV2ZXJ5KGZ1bmN0aW9uICh4LCBpKSB7IHJldHVybiBFLmVxdWFscyh4LCB5c1tpXSk7IH0pOyB9KTtcbn07XG4vKipcbiAqIERlcml2ZXMgYW4gYE9yZGAgb3ZlciB0aGUgYFJlYWRvbmx5QXJyYXlgIG9mIGEgZ2l2ZW4gZWxlbWVudCB0eXBlIGZyb20gdGhlIGBPcmRgIG9mIHRoYXQgdHlwZS4gVGhlIG9yZGVyaW5nIGJldHdlZW4gdHdvIHN1Y2hcbiAqIGFycmF5cyBpcyBlcXVhbCB0bzogdGhlIGZpcnN0IG5vbiBlcXVhbCBjb21wYXJpc29uIG9mIGVhY2ggYXJyYXlzIGVsZW1lbnRzIHRha2VuIHBhaXJ3aXNlIGluIGluY3JlYXNpbmcgb3JkZXIsIGluXG4gKiBjYXNlIG9mIGVxdWFsaXR5IG92ZXIgYWxsIHRoZSBwYWlyd2lzZSBlbGVtZW50czsgdGhlIGxvbmdlc3QgYXJyYXkgaXMgY29uc2lkZXJlZCB0aGUgZ3JlYXRlc3QsIGlmIGJvdGggYXJyYXlzIGhhdmVcbiAqIHRoZSBzYW1lIGxlbmd0aCwgdGhlIHJlc3VsdCBpcyBlcXVhbGl0eS5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgZ2V0T3JkIH0gZnJvbSAnZnAtdHMvUmVhZG9ubHlBcnJheSdcbiAqIGltcG9ydCAqIGFzIFMgZnJvbSAnZnAtdHMvc3RyaW5nJ1xuICpcbiAqIGNvbnN0IE8gPSBnZXRPcmQoUy5PcmQpXG4gKiBhc3NlcnQuc3RyaWN0RXF1YWwoTy5jb21wYXJlKFsnYiddLCBbJ2EnXSksIDEpXG4gKiBhc3NlcnQuc3RyaWN0RXF1YWwoTy5jb21wYXJlKFsnYSddLCBbJ2EnXSksIDApXG4gKiBhc3NlcnQuc3RyaWN0RXF1YWwoTy5jb21wYXJlKFsnYSddLCBbJ2InXSksIC0xKVxuICpcbiAqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBnZXRPcmQgPSBmdW5jdGlvbiAoTykge1xuICAgIHJldHVybiBmcm9tQ29tcGFyZShmdW5jdGlvbiAoYSwgYikge1xuICAgICAgICB2YXIgYUxlbiA9IGEubGVuZ3RoO1xuICAgICAgICB2YXIgYkxlbiA9IGIubGVuZ3RoO1xuICAgICAgICB2YXIgbGVuID0gTWF0aC5taW4oYUxlbiwgYkxlbik7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbGVuOyBpKyspIHtcbiAgICAgICAgICAgIHZhciBvcmRlcmluZyA9IE8uY29tcGFyZShhW2ldLCBiW2ldKTtcbiAgICAgICAgICAgIGlmIChvcmRlcmluZyAhPT0gMCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBvcmRlcmluZztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gTi5PcmQuY29tcGFyZShhTGVuLCBiTGVuKTtcbiAgICB9KTtcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjExLjBcbiAqL1xuZXhwb3J0IHZhciBnZXRVbmlvblNlbWlncm91cCA9IGZ1bmN0aW9uIChFKSB7XG4gICAgdmFyIHVuaW9uRSA9IHVuaW9uKEUpO1xuICAgIHJldHVybiB7XG4gICAgICAgIGNvbmNhdDogZnVuY3Rpb24gKGZpcnN0LCBzZWNvbmQpIHsgcmV0dXJuIHVuaW9uRShzZWNvbmQpKGZpcnN0KTsgfVxuICAgIH07XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi4xMS4wXG4gKi9cbmV4cG9ydCB2YXIgZ2V0VW5pb25Nb25vaWQgPSBmdW5jdGlvbiAoRSkgeyByZXR1cm4gKHtcbiAgICBjb25jYXQ6IGdldFVuaW9uU2VtaWdyb3VwKEUpLmNvbmNhdCxcbiAgICBlbXB0eTogZW1wdHlcbn0pOyB9O1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi4xMS4wXG4gKi9cbmV4cG9ydCB2YXIgZ2V0SW50ZXJzZWN0aW9uU2VtaWdyb3VwID0gZnVuY3Rpb24gKEUpIHtcbiAgICB2YXIgaW50ZXJzZWN0aW9uRSA9IGludGVyc2VjdGlvbihFKTtcbiAgICByZXR1cm4ge1xuICAgICAgICBjb25jYXQ6IGZ1bmN0aW9uIChmaXJzdCwgc2Vjb25kKSB7IHJldHVybiBpbnRlcnNlY3Rpb25FKHNlY29uZCkoZmlyc3QpOyB9XG4gICAgfTtcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjExLjBcbiAqL1xuZXhwb3J0IHZhciBnZXREaWZmZXJlbmNlTWFnbWEgPSBmdW5jdGlvbiAoRSkge1xuICAgIHZhciBkaWZmZXJlbmNlRSA9IGRpZmZlcmVuY2UoRSk7XG4gICAgcmV0dXJuIHtcbiAgICAgICAgY29uY2F0OiBmdW5jdGlvbiAoZmlyc3QsIHNlY29uZCkgeyByZXR1cm4gZGlmZmVyZW5jZUUoc2Vjb25kKShmaXJzdCk7IH1cbiAgICB9O1xufTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuNy4wXG4gKi9cbmV4cG9ydCB2YXIgRnVuY3RvciA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICBtYXA6IF9tYXBcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBtYXBwaW5nXG4gKiBAc2luY2UgMi4xMC4wXG4gKi9cbmV4cG9ydCB2YXIgZmxhcCA9IC8qI19fUFVSRV9fKi8gZmxhcF8oRnVuY3Rvcik7XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjEwLjBcbiAqL1xuZXhwb3J0IHZhciBQb2ludGVkID0ge1xuICAgIFVSSTogVVJJLFxuICAgIG9mOiBvZlxufTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuNy4wXG4gKi9cbmV4cG9ydCB2YXIgRnVuY3RvcldpdGhJbmRleCA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICBtYXA6IF9tYXAsXG4gICAgbWFwV2l0aEluZGV4OiBfbWFwV2l0aEluZGV4XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi4xMC4wXG4gKi9cbmV4cG9ydCB2YXIgQXBwbHkgPSB7XG4gICAgVVJJOiBVUkksXG4gICAgbWFwOiBfbWFwLFxuICAgIGFwOiBfYXBcbn07XG4vKipcbiAqIENvbWJpbmUgdHdvIGVmZmVjdGZ1bCBhY3Rpb25zLCBrZWVwaW5nIG9ubHkgdGhlIHJlc3VsdCBvZiB0aGUgZmlyc3QuXG4gKlxuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgYXBGaXJzdCA9IC8qI19fUFVSRV9fKi8gYXBGaXJzdF8oQXBwbHkpO1xuLyoqXG4gKiBDb21iaW5lIHR3byBlZmZlY3RmdWwgYWN0aW9ucywga2VlcGluZyBvbmx5IHRoZSByZXN1bHQgb2YgdGhlIHNlY29uZC5cbiAqXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBhcFNlY29uZCA9IC8qI19fUFVSRV9fKi8gYXBTZWNvbmRfKEFwcGx5KTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuNy4wXG4gKi9cbmV4cG9ydCB2YXIgQXBwbGljYXRpdmUgPSB7XG4gICAgVVJJOiBVUkksXG4gICAgbWFwOiBfbWFwLFxuICAgIGFwOiBfYXAsXG4gICAgb2Y6IG9mXG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi4xMC4wXG4gKi9cbmV4cG9ydCB2YXIgQ2hhaW4gPSB7XG4gICAgVVJJOiBVUkksXG4gICAgbWFwOiBfbWFwLFxuICAgIGFwOiBfYXAsXG4gICAgY2hhaW46IGZsYXRNYXBcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjcuMFxuICovXG5leHBvcnQgdmFyIE1vbmFkID0ge1xuICAgIFVSSTogVVJJLFxuICAgIG1hcDogX21hcCxcbiAgICBhcDogX2FwLFxuICAgIG9mOiBvZixcbiAgICBjaGFpbjogZmxhdE1hcFxufTtcbi8qKlxuICogQ29tcG9zZXMgY29tcHV0YXRpb25zIGluIHNlcXVlbmNlLCB1c2luZyB0aGUgcmV0dXJuIHZhbHVlIG9mIG9uZSBjb21wdXRhdGlvbiB0byBkZXRlcm1pbmUgdGhlIG5leHQgY29tcHV0YXRpb24gYW5kXG4gKiBrZWVwaW5nIG9ubHkgdGhlIHJlc3VsdCBvZiB0aGUgZmlyc3QuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCAqIGFzIFJBIGZyb20gJ2ZwLXRzL1JlYWRvbmx5QXJyYXknXG4gKiBpbXBvcnQgeyBwaXBlIH0gZnJvbSAnZnAtdHMvZnVuY3Rpb24nXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChcbiAqICAgcGlwZShcbiAqICAgICBbMSwgMiwgM10sXG4gKiAgICAgUkEuY2hhaW5GaXJzdCgoKSA9PiBbJ2EnLCAnYiddKVxuICogICApLFxuICogICBbMSwgMSwgMiwgMiwgMywgM11cbiAqIClcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoXG4gKiAgIHBpcGUoXG4gKiAgICAgWzEsIDIsIDNdLFxuICogICAgIFJBLmNoYWluRmlyc3QoKCkgPT4gW10pXG4gKiAgICksXG4gKiAgIFtdXG4gKiApXG4gKlxuICogQGNhdGVnb3J5IHNlcXVlbmNpbmdcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIGNoYWluRmlyc3QgPSBcbi8qI19fUFVSRV9fKi8gY2hhaW5GaXJzdF8oQ2hhaW4pO1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi43LjBcbiAqL1xuZXhwb3J0IHZhciBVbmZvbGRhYmxlID0ge1xuICAgIFVSSTogVVJJLFxuICAgIHVuZm9sZDogdW5mb2xkXG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi43LjBcbiAqL1xuZXhwb3J0IHZhciBBbHQgPSB7XG4gICAgVVJJOiBVUkksXG4gICAgbWFwOiBfbWFwLFxuICAgIGFsdDogX2FsdFxufTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIFplcm8gPSB7XG4gICAgVVJJOiBVUkksXG4gICAgemVybzogemVyb1xufTtcbi8qKlxuICogQGNhdGVnb3J5IGRvIG5vdGF0aW9uXG4gKiBAc2luY2UgMi4xMS4wXG4gKi9cbmV4cG9ydCB2YXIgZ3VhcmQgPSAvKiNfX1BVUkVfXyovIGd1YXJkXyhaZXJvLCBQb2ludGVkKTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuNy4wXG4gKi9cbmV4cG9ydCB2YXIgQWx0ZXJuYXRpdmUgPSB7XG4gICAgVVJJOiBVUkksXG4gICAgbWFwOiBfbWFwLFxuICAgIGFwOiBfYXAsXG4gICAgb2Y6IG9mLFxuICAgIGFsdDogX2FsdCxcbiAgICB6ZXJvOiB6ZXJvXG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi43LjBcbiAqL1xuZXhwb3J0IHZhciBFeHRlbmQgPSB7XG4gICAgVVJJOiBVUkksXG4gICAgbWFwOiBfbWFwLFxuICAgIGV4dGVuZDogX2V4dGVuZFxufTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuNy4wXG4gKi9cbmV4cG9ydCB2YXIgQ29tcGFjdGFibGUgPSB7XG4gICAgVVJJOiBVUkksXG4gICAgY29tcGFjdDogY29tcGFjdCxcbiAgICBzZXBhcmF0ZTogc2VwYXJhdGVcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjcuMFxuICovXG5leHBvcnQgdmFyIEZpbHRlcmFibGUgPSB7XG4gICAgVVJJOiBVUkksXG4gICAgbWFwOiBfbWFwLFxuICAgIGNvbXBhY3Q6IGNvbXBhY3QsXG4gICAgc2VwYXJhdGU6IHNlcGFyYXRlLFxuICAgIGZpbHRlcjogX2ZpbHRlcixcbiAgICBmaWx0ZXJNYXA6IF9maWx0ZXJNYXAsXG4gICAgcGFydGl0aW9uOiBfcGFydGl0aW9uLFxuICAgIHBhcnRpdGlvbk1hcDogX3BhcnRpdGlvbk1hcFxufTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuNy4wXG4gKi9cbmV4cG9ydCB2YXIgRmlsdGVyYWJsZVdpdGhJbmRleCA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICBtYXA6IF9tYXAsXG4gICAgbWFwV2l0aEluZGV4OiBfbWFwV2l0aEluZGV4LFxuICAgIGNvbXBhY3Q6IGNvbXBhY3QsXG4gICAgc2VwYXJhdGU6IHNlcGFyYXRlLFxuICAgIGZpbHRlcjogX2ZpbHRlcixcbiAgICBmaWx0ZXJNYXA6IF9maWx0ZXJNYXAsXG4gICAgcGFydGl0aW9uOiBfcGFydGl0aW9uLFxuICAgIHBhcnRpdGlvbk1hcDogX3BhcnRpdGlvbk1hcCxcbiAgICBwYXJ0aXRpb25NYXBXaXRoSW5kZXg6IF9wYXJ0aXRpb25NYXBXaXRoSW5kZXgsXG4gICAgcGFydGl0aW9uV2l0aEluZGV4OiBfcGFydGl0aW9uV2l0aEluZGV4LFxuICAgIGZpbHRlck1hcFdpdGhJbmRleDogX2ZpbHRlck1hcFdpdGhJbmRleCxcbiAgICBmaWx0ZXJXaXRoSW5kZXg6IF9maWx0ZXJXaXRoSW5kZXhcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjcuMFxuICovXG5leHBvcnQgdmFyIEZvbGRhYmxlID0ge1xuICAgIFVSSTogVVJJLFxuICAgIHJlZHVjZTogX3JlZHVjZSxcbiAgICBmb2xkTWFwOiBfZm9sZE1hcCxcbiAgICByZWR1Y2VSaWdodDogX3JlZHVjZVJpZ2h0XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi43LjBcbiAqL1xuZXhwb3J0IHZhciBGb2xkYWJsZVdpdGhJbmRleCA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICByZWR1Y2U6IF9yZWR1Y2UsXG4gICAgZm9sZE1hcDogX2ZvbGRNYXAsXG4gICAgcmVkdWNlUmlnaHQ6IF9yZWR1Y2VSaWdodCxcbiAgICByZWR1Y2VXaXRoSW5kZXg6IF9yZWR1Y2VXaXRoSW5kZXgsXG4gICAgZm9sZE1hcFdpdGhJbmRleDogX2ZvbGRNYXBXaXRoSW5kZXgsXG4gICAgcmVkdWNlUmlnaHRXaXRoSW5kZXg6IF9yZWR1Y2VSaWdodFdpdGhJbmRleFxufTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuNy4wXG4gKi9cbmV4cG9ydCB2YXIgVHJhdmVyc2FibGUgPSB7XG4gICAgVVJJOiBVUkksXG4gICAgbWFwOiBfbWFwLFxuICAgIHJlZHVjZTogX3JlZHVjZSxcbiAgICBmb2xkTWFwOiBfZm9sZE1hcCxcbiAgICByZWR1Y2VSaWdodDogX3JlZHVjZVJpZ2h0LFxuICAgIHRyYXZlcnNlOiBfdHJhdmVyc2UsXG4gICAgc2VxdWVuY2U6IHNlcXVlbmNlXG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi43LjBcbiAqL1xuZXhwb3J0IHZhciBUcmF2ZXJzYWJsZVdpdGhJbmRleCA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICBtYXA6IF9tYXAsXG4gICAgbWFwV2l0aEluZGV4OiBfbWFwV2l0aEluZGV4LFxuICAgIHJlZHVjZTogX3JlZHVjZSxcbiAgICBmb2xkTWFwOiBfZm9sZE1hcCxcbiAgICByZWR1Y2VSaWdodDogX3JlZHVjZVJpZ2h0LFxuICAgIHJlZHVjZVdpdGhJbmRleDogX3JlZHVjZVdpdGhJbmRleCxcbiAgICBmb2xkTWFwV2l0aEluZGV4OiBfZm9sZE1hcFdpdGhJbmRleCxcbiAgICByZWR1Y2VSaWdodFdpdGhJbmRleDogX3JlZHVjZVJpZ2h0V2l0aEluZGV4LFxuICAgIHRyYXZlcnNlOiBfdHJhdmVyc2UsXG4gICAgc2VxdWVuY2U6IHNlcXVlbmNlLFxuICAgIHRyYXZlcnNlV2l0aEluZGV4OiBfdHJhdmVyc2VXaXRoSW5kZXhcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBzZXF1ZW5jaW5nXG4gKiBAc2luY2UgMi4xMS4wXG4gKi9cbmV4cG9ydCB2YXIgY2hhaW5SZWNEZXB0aEZpcnN0ID0gZnVuY3Rpb24gKGYpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGEpIHtcbiAgICAgICAgdmFyIHRvZG8gPSBfX3NwcmVhZEFycmF5KFtdLCBmKGEpLCB0cnVlKTtcbiAgICAgICAgdmFyIG91dCA9IFtdO1xuICAgICAgICB3aGlsZSAodG9kby5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICB2YXIgZSA9IHRvZG8uc2hpZnQoKTtcbiAgICAgICAgICAgIGlmIChfLmlzTGVmdChlKSkge1xuICAgICAgICAgICAgICAgIHRvZG8udW5zaGlmdC5hcHBseSh0b2RvLCBmKGUubGVmdCkpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgb3V0LnB1c2goZS5yaWdodCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG91dDtcbiAgICB9O1xufTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIENoYWluUmVjRGVwdGhGaXJzdCA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICBtYXA6IF9tYXAsXG4gICAgYXA6IF9hcCxcbiAgICBjaGFpbjogZmxhdE1hcCxcbiAgICBjaGFpblJlYzogX2NoYWluUmVjRGVwdGhGaXJzdFxufTtcbi8qKlxuICogQGNhdGVnb3J5IHNlcXVlbmNpbmdcbiAqIEBzaW5jZSAyLjExLjBcbiAqL1xuZXhwb3J0IHZhciBjaGFpblJlY0JyZWFkdGhGaXJzdCA9IGZ1bmN0aW9uIChmKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhKSB7XG4gICAgICAgIHZhciBpbml0aWFsID0gZihhKTtcbiAgICAgICAgdmFyIHRvZG8gPSBbXTtcbiAgICAgICAgdmFyIG91dCA9IFtdO1xuICAgICAgICBmdW5jdGlvbiBnbyhlKSB7XG4gICAgICAgICAgICBpZiAoXy5pc0xlZnQoZSkpIHtcbiAgICAgICAgICAgICAgICBmKGUubGVmdCkuZm9yRWFjaChmdW5jdGlvbiAodikgeyByZXR1cm4gdG9kby5wdXNoKHYpOyB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIG91dC5wdXNoKGUucmlnaHQpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGZvciAodmFyIF9pID0gMCwgaW5pdGlhbF8xID0gaW5pdGlhbDsgX2kgPCBpbml0aWFsXzEubGVuZ3RoOyBfaSsrKSB7XG4gICAgICAgICAgICB2YXIgZSA9IGluaXRpYWxfMVtfaV07XG4gICAgICAgICAgICBnbyhlKTtcbiAgICAgICAgfVxuICAgICAgICB3aGlsZSAodG9kby5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICBnbyh0b2RvLnNoaWZ0KCkpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBvdXQ7XG4gICAgfTtcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjExLjBcbiAqL1xuZXhwb3J0IHZhciBDaGFpblJlY0JyZWFkdGhGaXJzdCA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICBtYXA6IF9tYXAsXG4gICAgYXA6IF9hcCxcbiAgICBjaGFpbjogZmxhdE1hcCxcbiAgICBjaGFpblJlYzogX2NoYWluUmVjQnJlYWR0aEZpcnN0XG59O1xudmFyIF93aXRoZXIgPSAvKiNfX1BVUkVfXyovIHdpdGhlckRlZmF1bHQoVHJhdmVyc2FibGUsIENvbXBhY3RhYmxlKTtcbnZhciBfd2lsdCA9IC8qI19fUFVSRV9fKi8gd2lsdERlZmF1bHQoVHJhdmVyc2FibGUsIENvbXBhY3RhYmxlKTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuNy4wXG4gKi9cbmV4cG9ydCB2YXIgV2l0aGVyYWJsZSA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICBtYXA6IF9tYXAsXG4gICAgY29tcGFjdDogY29tcGFjdCxcbiAgICBzZXBhcmF0ZTogc2VwYXJhdGUsXG4gICAgZmlsdGVyOiBfZmlsdGVyLFxuICAgIGZpbHRlck1hcDogX2ZpbHRlck1hcCxcbiAgICBwYXJ0aXRpb246IF9wYXJ0aXRpb24sXG4gICAgcGFydGl0aW9uTWFwOiBfcGFydGl0aW9uTWFwLFxuICAgIHJlZHVjZTogX3JlZHVjZSxcbiAgICBmb2xkTWFwOiBfZm9sZE1hcCxcbiAgICByZWR1Y2VSaWdodDogX3JlZHVjZVJpZ2h0LFxuICAgIHRyYXZlcnNlOiBfdHJhdmVyc2UsXG4gICAgc2VxdWVuY2U6IHNlcXVlbmNlLFxuICAgIHdpdGhlcjogX3dpdGhlcixcbiAgICB3aWx0OiBfd2lsdFxufTtcbi8qKlxuICogRmlsdGVyIHZhbHVlcyBpbnNpZGUgYSBjb250ZXh0LlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBwaXBlIH0gZnJvbSAnZnAtdHMvZnVuY3Rpb24nXG4gKiBpbXBvcnQgKiBhcyBSQSBmcm9tICdmcC10cy9SZWFkb25seUFycmF5J1xuICogaW1wb3J0ICogYXMgVCBmcm9tICdmcC10cy9UYXNrJ1xuICpcbiAqIGNvbnN0IGZpbHRlckUgPSBSQS5maWx0ZXJFKFQuQXBwbGljYXRpdmVQYXIpXG4gKiBhc3luYyBmdW5jdGlvbiB0ZXN0KCkge1xuICogICBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKFxuICogICAgIGF3YWl0IHBpcGUoXG4gKiAgICAgICBbLTEsIDIsIDNdLFxuICogICAgICAgZmlsdGVyRSgobikgPT4gVC5vZihuID4gMCkpXG4gKiAgICAgKSgpLFxuICogICAgIFsyLCAzXVxuICogICApXG4gKiB9XG4gKiB0ZXN0KClcbiAqXG4gKiBAc2luY2UgMi4xMS4wXG4gKi9cbmV4cG9ydCB2YXIgZmlsdGVyRSA9IC8qI19fUFVSRV9fKi8gZmlsdGVyRV8oV2l0aGVyYWJsZSk7XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjExLjBcbiAqL1xuZXhwb3J0IHZhciBGcm9tRWl0aGVyID0ge1xuICAgIFVSSTogVVJJLFxuICAgIGZyb21FaXRoZXI6IGZyb21FaXRoZXJcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBsaWZ0aW5nXG4gKiBAc2luY2UgMi4xMS4wXG4gKi9cbmV4cG9ydCB2YXIgZnJvbUVpdGhlcksgPSAvKiNfX1BVUkVfXyovIGZyb21FaXRoZXJLXyhGcm9tRWl0aGVyKTtcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8vIHVuc2FmZVxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLyoqXG4gKiBAY2F0ZWdvcnkgdW5zYWZlXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciB1bnNhZmVJbnNlcnRBdCA9IFJORUEudW5zYWZlSW5zZXJ0QXQ7XG4vKipcbiAqIEBjYXRlZ29yeSB1bnNhZmVcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIHVuc2FmZVVwZGF0ZUF0ID0gZnVuY3Rpb24gKGksIGEsIGFzKSB7XG4gICAgcmV0dXJuIGlzTm9uRW1wdHkoYXMpID8gUk5FQS51bnNhZmVVcGRhdGVBdChpLCBhLCBhcykgOiBhcztcbn07XG4vKipcbiAqIEBjYXRlZ29yeSB1bnNhZmVcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIHVuc2FmZURlbGV0ZUF0ID0gZnVuY3Rpb24gKGksIGFzKSB7XG4gICAgdmFyIHhzID0gYXMuc2xpY2UoKTtcbiAgICB4cy5zcGxpY2UoaSwgMSk7XG4gICAgcmV0dXJuIHhzO1xufTtcbi8qKlxuICogQGNhdGVnb3J5IGNvbnZlcnNpb25zXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciB0b0FycmF5ID0gZnVuY3Rpb24gKGFzKSB7IHJldHVybiBhcy5zbGljZSgpOyB9O1xuLyoqXG4gKiBAY2F0ZWdvcnkgY29udmVyc2lvbnNcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIGZyb21BcnJheSA9IGZ1bmN0aW9uIChhcykgeyByZXR1cm4gKGlzRW1wdHkoYXMpID8gZW1wdHkgOiBhcy5zbGljZSgpKTsgfTtcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8vIHV0aWxzXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vKipcbiAqIEFuIGVtcHR5IGFycmF5XG4gKlxuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgZW1wdHkgPSBSTkVBLmVtcHR5O1xuZXhwb3J0IGZ1bmN0aW9uIGV2ZXJ5KHByZWRpY2F0ZSkge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHsgcmV0dXJuIGFzLmV2ZXJ5KHByZWRpY2F0ZSk7IH07XG59XG4vKipcbiAqIENoZWNrIGlmIGEgcHJlZGljYXRlIGhvbGRzIHRydWUgZm9yIGFueSBhcnJheSBtZW1iZXIuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IHNvbWUgfSBmcm9tICdmcC10cy9SZWFkb25seUFycmF5J1xuICogaW1wb3J0IHsgcGlwZSB9IGZyb20gJ2ZwLXRzL2Z1bmN0aW9uJ1xuICpcbiAqIGNvbnN0IGlzUG9zaXRpdmUgPSAobjogbnVtYmVyKTogYm9vbGVhbiA9PiBuID4gMFxuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwocGlwZShbLTEsIC0yLCAzXSwgc29tZShpc1Bvc2l0aXZlKSksIHRydWUpXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKHBpcGUoWy0xLCAtMiwgLTNdLCBzb21lKGlzUG9zaXRpdmUpKSwgZmFsc2UpXG4gKlxuICogQHNpbmNlIDIuOS4wXG4gKi9cbmV4cG9ydCB2YXIgc29tZSA9IGZ1bmN0aW9uIChwcmVkaWNhdGUpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIHJldHVybiBhcy5zb21lKHByZWRpY2F0ZSk7XG4gICAgfTtcbn07XG4vKipcbiAqIEFsaWFzIG9mIFtgc29tZWBdKCNzb21lKVxuICpcbiAqIEBzaW5jZSAyLjExLjBcbiAqL1xuZXhwb3J0IHZhciBleGlzdHMgPSBzb21lO1xuLyoqXG4gKiBQbGFjZXMgYW4gZWxlbWVudCBpbiBiZXR3ZWVuIG1lbWJlcnMgb2YgYSBgUmVhZG9ubHlBcnJheWAsIHRoZW4gZm9sZHMgdGhlIHJlc3VsdHMgdXNpbmcgdGhlIHByb3ZpZGVkIGBNb25vaWRgLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgKiBhcyBTIGZyb20gJ2ZwLXRzL3N0cmluZydcbiAqIGltcG9ydCB7IGludGVyY2FsYXRlIH0gZnJvbSAnZnAtdHMvUmVhZG9ubHlBcnJheSdcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKGludGVyY2FsYXRlKFMuTW9ub2lkKSgnLScpKFsnYScsICdiJywgJ2MnXSksICdhLWItYycpXG4gKlxuICogQHNpbmNlIDIuMTIuMFxuICovXG5leHBvcnQgdmFyIGludGVyY2FsYXRlID0gZnVuY3Rpb24gKE0pIHtcbiAgICB2YXIgaW50ZXJjYWxhdGVNID0gUk5FQS5pbnRlcmNhbGF0ZShNKTtcbiAgICByZXR1cm4gZnVuY3Rpb24gKG1pZGRsZSkgeyByZXR1cm4gbWF0Y2goZnVuY3Rpb24gKCkgeyByZXR1cm4gTS5lbXB0eTsgfSwgaW50ZXJjYWxhdGVNKG1pZGRsZSkpOyB9O1xufTtcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8vIGRvIG5vdGF0aW9uXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vKipcbiAqIEBjYXRlZ29yeSBkbyBub3RhdGlvblxuICogQHNpbmNlIDIuOS4wXG4gKi9cbmV4cG9ydCB2YXIgRG8gPSAvKiNfX1BVUkVfXyovIG9mKF8uZW1wdHlSZWNvcmQpO1xuLyoqXG4gKiBAY2F0ZWdvcnkgZG8gbm90YXRpb25cbiAqIEBzaW5jZSAyLjguMFxuICovXG5leHBvcnQgdmFyIGJpbmRUbyA9IC8qI19fUFVSRV9fKi8gYmluZFRvXyhGdW5jdG9yKTtcbnZhciBsZXRfID0gLyojX19QVVJFX18qLyBsZXRfXyhGdW5jdG9yKTtcbmV4cG9ydCB7IFxuLyoqXG4gKiBAY2F0ZWdvcnkgZG8gbm90YXRpb25cbiAqIEBzaW5jZSAyLjEzLjBcbiAqL1xubGV0XyBhcyBsZXQgfTtcbi8qKlxuICogQGNhdGVnb3J5IGRvIG5vdGF0aW9uXG4gKiBAc2luY2UgMi44LjBcbiAqL1xuZXhwb3J0IHZhciBiaW5kID0gLyojX19QVVJFX18qLyBiaW5kXyhDaGFpbik7XG4vKipcbiAqIEBjYXRlZ29yeSBkbyBub3RhdGlvblxuICogQHNpbmNlIDIuOC4wXG4gKi9cbmV4cG9ydCB2YXIgYXBTID0gLyojX19QVVJFX18qLyBhcFNfKEFwcGx5KTtcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8vIGxlZ2FjeVxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLyoqXG4gKiBBbGlhcyBvZiBgZmxhdE1hcGAuXG4gKlxuICogQGNhdGVnb3J5IGxlZ2FjeVxuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgY2hhaW4gPSBmbGF0TWFwO1xuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLy8gZGVwcmVjYXRlZFxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLyoqXG4gKiBVc2UgYFJlYWRvbmx5Tm9uRW1wdHlBcnJheWAgbW9kdWxlIGluc3RlYWQuXG4gKlxuICogQGNhdGVnb3J5IHpvbmUgb2YgZGVhdGhcbiAqIEBzaW5jZSAyLjUuMFxuICogQGRlcHJlY2F0ZWRcbiAqL1xuZXhwb3J0IHZhciByYW5nZSA9IFJORUEucmFuZ2U7XG4vKipcbiAqIFVzZSBbYHByZXBlbmRgXSgjcHJlcGVuZCkgaW5zdGVhZC5cbiAqXG4gKiBAY2F0ZWdvcnkgem9uZSBvZiBkZWF0aFxuICogQHNpbmNlIDIuNS4wXG4gKiBAZGVwcmVjYXRlZFxuICovXG5leHBvcnQgdmFyIGNvbnMgPSBSTkVBLmNvbnM7XG4vKipcbiAqIFVzZSBbYGFwcGVuZGBdKCNhcHBlbmQpIGluc3RlYWQuXG4gKlxuICogQGNhdGVnb3J5IHpvbmUgb2YgZGVhdGhcbiAqIEBzaW5jZSAyLjUuMFxuICogQGRlcHJlY2F0ZWRcbiAqL1xuZXhwb3J0IHZhciBzbm9jID0gUk5FQS5zbm9jO1xuLyoqXG4gKiBVc2UgW2BwcmVwZW5kQWxsYF0oI3ByZXBlbmRhbGwpIGluc3RlYWQuXG4gKlxuICogQGNhdGVnb3J5IHpvbmUgb2YgZGVhdGhcbiAqIEBzaW5jZSAyLjkuMFxuICogQGRlcHJlY2F0ZWRcbiAqL1xuZXhwb3J0IHZhciBwcmVwZW5kVG9BbGwgPSBwcmVwZW5kQWxsO1xuLyoqXG4gKiBUaGlzIGluc3RhbmNlIGlzIGRlcHJlY2F0ZWQsIHVzZSBzbWFsbCwgc3BlY2lmaWMgaW5zdGFuY2VzIGluc3RlYWQuXG4gKiBGb3IgZXhhbXBsZSBpZiBhIGZ1bmN0aW9uIG5lZWRzIGEgYEZ1bmN0b3JgIGluc3RhbmNlLCBwYXNzIGBSQS5GdW5jdG9yYCBpbnN0ZWFkIG9mIGBSQS5yZWFkb25seUFycmF5YFxuICogKHdoZXJlIGBSQWAgaXMgZnJvbSBgaW1wb3J0IFJBIGZyb20gJ2ZwLXRzL1JlYWRvbmx5QXJyYXknYClcbiAqXG4gKiBAY2F0ZWdvcnkgem9uZSBvZiBkZWF0aFxuICogQHNpbmNlIDIuNS4wXG4gKiBAZGVwcmVjYXRlZFxuICovXG5leHBvcnQgdmFyIHJlYWRvbmx5QXJyYXkgPSB7XG4gICAgVVJJOiBVUkksXG4gICAgY29tcGFjdDogY29tcGFjdCxcbiAgICBzZXBhcmF0ZTogc2VwYXJhdGUsXG4gICAgbWFwOiBfbWFwLFxuICAgIGFwOiBfYXAsXG4gICAgb2Y6IG9mLFxuICAgIGNoYWluOiBmbGF0TWFwLFxuICAgIGZpbHRlcjogX2ZpbHRlcixcbiAgICBmaWx0ZXJNYXA6IF9maWx0ZXJNYXAsXG4gICAgcGFydGl0aW9uOiBfcGFydGl0aW9uLFxuICAgIHBhcnRpdGlvbk1hcDogX3BhcnRpdGlvbk1hcCxcbiAgICBtYXBXaXRoSW5kZXg6IF9tYXBXaXRoSW5kZXgsXG4gICAgcGFydGl0aW9uTWFwV2l0aEluZGV4OiBfcGFydGl0aW9uTWFwV2l0aEluZGV4LFxuICAgIHBhcnRpdGlvbldpdGhJbmRleDogX3BhcnRpdGlvbldpdGhJbmRleCxcbiAgICBmaWx0ZXJNYXBXaXRoSW5kZXg6IF9maWx0ZXJNYXBXaXRoSW5kZXgsXG4gICAgZmlsdGVyV2l0aEluZGV4OiBfZmlsdGVyV2l0aEluZGV4LFxuICAgIGFsdDogX2FsdCxcbiAgICB6ZXJvOiB6ZXJvLFxuICAgIHVuZm9sZDogdW5mb2xkLFxuICAgIHJlZHVjZTogX3JlZHVjZSxcbiAgICBmb2xkTWFwOiBfZm9sZE1hcCxcbiAgICByZWR1Y2VSaWdodDogX3JlZHVjZVJpZ2h0LFxuICAgIHRyYXZlcnNlOiBfdHJhdmVyc2UsXG4gICAgc2VxdWVuY2U6IHNlcXVlbmNlLFxuICAgIHJlZHVjZVdpdGhJbmRleDogX3JlZHVjZVdpdGhJbmRleCxcbiAgICBmb2xkTWFwV2l0aEluZGV4OiBfZm9sZE1hcFdpdGhJbmRleCxcbiAgICByZWR1Y2VSaWdodFdpdGhJbmRleDogX3JlZHVjZVJpZ2h0V2l0aEluZGV4LFxuICAgIHRyYXZlcnNlV2l0aEluZGV4OiBfdHJhdmVyc2VXaXRoSW5kZXgsXG4gICAgZXh0ZW5kOiBfZXh0ZW5kLFxuICAgIHdpdGhlcjogX3dpdGhlcixcbiAgICB3aWx0OiBfd2lsdFxufTtcbiIsCiAgInZhciBfX3NwcmVhZEFycmF5ID0gKHRoaXMgJiYgdGhpcy5fX3NwcmVhZEFycmF5KSB8fCBmdW5jdGlvbiAodG8sIGZyb20sIHBhY2spIHtcbiAgICBpZiAocGFjayB8fCBhcmd1bWVudHMubGVuZ3RoID09PSAyKSBmb3IgKHZhciBpID0gMCwgbCA9IGZyb20ubGVuZ3RoLCBhcjsgaSA8IGw7IGkrKykge1xuICAgICAgICBpZiAoYXIgfHwgIShpIGluIGZyb20pKSB7XG4gICAgICAgICAgICBpZiAoIWFyKSBhciA9IEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGZyb20sIDAsIGkpO1xuICAgICAgICAgICAgYXJbaV0gPSBmcm9tW2ldO1xuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiB0by5jb25jYXQoYXIgfHwgQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoZnJvbSkpO1xufTtcbmltcG9ydCB7IGFwRmlyc3QgYXMgYXBGaXJzdF8sIGFwUyBhcyBhcFNfLCBhcFNlY29uZCBhcyBhcFNlY29uZF8gfSBmcm9tICcuL0FwcGx5JztcbmltcG9ydCB7IGJpbmQgYXMgYmluZF8sIGNoYWluRmlyc3QgYXMgY2hhaW5GaXJzdF8gfSBmcm9tICcuL0NoYWluJztcbmltcG9ydCB7IGZyb21FcXVhbHMgfSBmcm9tICcuL0VxJztcbmltcG9ydCB7IGZyb21FaXRoZXJLIGFzIGZyb21FaXRoZXJLXyB9IGZyb20gJy4vRnJvbUVpdGhlcic7XG5pbXBvcnQgeyBkdWFsLCBpZGVudGl0eSwgcGlwZSB9IGZyb20gJy4vZnVuY3Rpb24nO1xuaW1wb3J0IHsgYmluZFRvIGFzIGJpbmRUb18sIGZsYXAgYXMgZmxhcF8sIGxldCBhcyBsZXRfXyB9IGZyb20gJy4vRnVuY3Rvcic7XG5pbXBvcnQgKiBhcyBfIGZyb20gJy4vaW50ZXJuYWwnO1xuaW1wb3J0ICogYXMgTiBmcm9tICcuL251bWJlcic7XG5pbXBvcnQgeyBmcm9tQ29tcGFyZSB9IGZyb20gJy4vT3JkJztcbmltcG9ydCAqIGFzIFJORUEgZnJvbSAnLi9SZWFkb25seU5vbkVtcHR5QXJyYXknO1xuaW1wb3J0IHsgc2VwYXJhdGVkIH0gZnJvbSAnLi9TZXBhcmF0ZWQnO1xuaW1wb3J0IHsgZmlsdGVyRSBhcyBmaWx0ZXJFXywgd2lsdERlZmF1bHQsIHdpdGhlckRlZmF1bHQgfSBmcm9tICcuL1dpdGhlcmFibGUnO1xuaW1wb3J0IHsgZ3VhcmQgYXMgZ3VhcmRfIH0gZnJvbSAnLi9aZXJvJztcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8vIHJlZmluZW1lbnRzXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vKipcbiAqIFRlc3Qgd2hldGhlciBhIGBSZWFkb25seUFycmF5YCBpcyBlbXB0eS5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgaXNFbXB0eSB9IGZyb20gJ2ZwLXRzL1JlYWRvbmx5QXJyYXknXG4gKlxuICogYXNzZXJ0LnN0cmljdEVxdWFsKGlzRW1wdHkoW10pLCB0cnVlKVxuICpcbiAqIEBjYXRlZ29yeSByZWZpbmVtZW50c1xuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgaXNFbXB0eSA9IGZ1bmN0aW9uIChhcykgeyByZXR1cm4gYXMubGVuZ3RoID09PSAwOyB9O1xuLyoqXG4gKiBUZXN0IHdoZXRoZXIgYSBgUmVhZG9ubHlBcnJheWAgaXMgbm9uIGVtcHR5LlxuICpcbiAqIEBjYXRlZ29yeSByZWZpbmVtZW50c1xuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgaXNOb25FbXB0eSA9IFJORUEuaXNOb25FbXB0eTtcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8vIGNvbnN0cnVjdG9yc1xuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLyoqXG4gKiBQcmVwZW5kIGFuIGVsZW1lbnQgdG8gdGhlIGZyb250IG9mIGEgYFJlYWRvbmx5QXJyYXlgLCBjcmVhdGluZyBhIG5ldyBgUmVhZG9ubHlOb25FbXB0eUFycmF5YC5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgcHJlcGVuZCB9IGZyb20gJ2ZwLXRzL1JlYWRvbmx5QXJyYXknXG4gKiBpbXBvcnQgeyBwaXBlIH0gZnJvbSAnZnAtdHMvZnVuY3Rpb24nXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChwaXBlKFsyLCAzLCA0XSwgcHJlcGVuZCgxKSksIFsxLCAyLCAzLCA0XSlcbiAqXG4gKiBAc2luY2UgMi4xMC4wXG4gKi9cbmV4cG9ydCB2YXIgcHJlcGVuZCA9IFJORUEucHJlcGVuZDtcbi8qKlxuICogTGVzcyBzdHJpY3QgdmVyc2lvbiBvZiBbYHByZXBlbmRgXSgjcHJlcGVuZCkuXG4gKlxuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIHByZXBlbmRXID0gUk5FQS5wcmVwZW5kVztcbi8qKlxuICogQXBwZW5kIGFuIGVsZW1lbnQgdG8gdGhlIGVuZCBvZiBhIGBSZWFkb25seUFycmF5YCwgY3JlYXRpbmcgYSBuZXcgYFJlYWRvbmx5Tm9uRW1wdHlBcnJheWAuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IGFwcGVuZCB9IGZyb20gJ2ZwLXRzL1JlYWRvbmx5QXJyYXknXG4gKiBpbXBvcnQgeyBwaXBlIH0gZnJvbSAnZnAtdHMvZnVuY3Rpb24nXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChwaXBlKFsxLCAyLCAzXSwgYXBwZW5kKDQpKSwgWzEsIDIsIDMsIDRdKVxuICpcbiAqIEBzaW5jZSAyLjEwLjBcbiAqL1xuZXhwb3J0IHZhciBhcHBlbmQgPSBSTkVBLmFwcGVuZDtcbi8qKlxuICogTGVzcyBzdHJpY3QgdmVyc2lvbiBvZiBbYGFwcGVuZGBdKCNhcHBlbmQpLlxuICpcbiAqIEBzaW5jZSAyLjExLjBcbiAqL1xuZXhwb3J0IHZhciBhcHBlbmRXID0gUk5FQS5hcHBlbmRXO1xuLyoqXG4gKiBSZXR1cm4gYSBgUmVhZG9ubHlBcnJheWAgb2YgbGVuZ3RoIGBuYCB3aXRoIGVsZW1lbnQgYGlgIGluaXRpYWxpemVkIHdpdGggYGYoaSlgLlxuICpcbiAqICoqTm90ZSoqLiBgbmAgaXMgbm9ybWFsaXplZCB0byBhIG5vbiBuZWdhdGl2ZSBpbnRlZ2VyLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBtYWtlQnkgfSBmcm9tICdmcC10cy9SZWFkb25seUFycmF5J1xuICpcbiAqIGNvbnN0IGRvdWJsZSA9IChuOiBudW1iZXIpOiBudW1iZXIgPT4gbiAqIDJcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwobWFrZUJ5KDUsIGRvdWJsZSksIFswLCAyLCA0LCA2LCA4XSlcbiAqXG4gKiBAY2F0ZWdvcnkgY29uc3RydWN0b3JzXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBtYWtlQnkgPSBmdW5jdGlvbiAobiwgZikgeyByZXR1cm4gKG4gPD0gMCA/IGVtcHR5IDogUk5FQS5tYWtlQnkoZikobikpOyB9O1xuLyoqXG4gKiBDcmVhdGUgYSBgUmVhZG9ubHlBcnJheWAgY29udGFpbmluZyBhIHZhbHVlIHJlcGVhdGVkIHRoZSBzcGVjaWZpZWQgbnVtYmVyIG9mIHRpbWVzLlxuICpcbiAqICoqTm90ZSoqLiBgbmAgaXMgbm9ybWFsaXplZCB0byBhIG5vbiBuZWdhdGl2ZSBpbnRlZ2VyLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyByZXBsaWNhdGUgfSBmcm9tICdmcC10cy9SZWFkb25seUFycmF5J1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwocmVwbGljYXRlKDMsICdhJyksIFsnYScsICdhJywgJ2EnXSlcbiAqXG4gKiBAY2F0ZWdvcnkgY29uc3RydWN0b3JzXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciByZXBsaWNhdGUgPSBmdW5jdGlvbiAobiwgYSkgeyByZXR1cm4gbWFrZUJ5KG4sIGZ1bmN0aW9uICgpIHsgcmV0dXJuIGE7IH0pOyB9O1xuZXhwb3J0IGZ1bmN0aW9uIGZyb21QcmVkaWNhdGUocHJlZGljYXRlKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhKSB7IHJldHVybiAocHJlZGljYXRlKGEpID8gW2FdIDogZW1wdHkpOyB9O1xufVxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLy8gY29udmVyc2lvbnNcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8qKlxuICogQGNhdGVnb3J5IGNvbnZlcnNpb25zXG4gKiBAc2luY2UgMi4xMS4wXG4gKi9cbmV4cG9ydCB2YXIgZnJvbU9wdGlvbiA9IGZ1bmN0aW9uIChtYSkgeyByZXR1cm4gKF8uaXNOb25lKG1hKSA/IGVtcHR5IDogW21hLnZhbHVlXSk7IH07XG4vKipcbiAqIFRyYW5zZm9ybXMgYW4gYEVpdGhlcmAgdG8gYSBgUmVhZG9ubHlBcnJheWAuXG4gKlxuICogQGNhdGVnb3J5IGNvbnZlcnNpb25zXG4gKiBAc2luY2UgMi4xMS4wXG4gKi9cbmV4cG9ydCB2YXIgZnJvbUVpdGhlciA9IGZ1bmN0aW9uIChlKSB7IHJldHVybiAoXy5pc0xlZnQoZSkgPyBlbXB0eSA6IFtlLnJpZ2h0XSk7IH07XG4vKipcbiAqIExlc3Mgc3RyaWN0IHZlcnNpb24gb2YgW2BtYXRjaGBdKCNtYXRjaCkuXG4gKlxuICogVGhlIGBXYCBzdWZmaXggKHNob3J0IGZvciAqKlcqKmlkZW5pbmcpIG1lYW5zIHRoYXQgdGhlIGhhbmRsZXIgcmV0dXJuIHR5cGVzIHdpbGwgYmUgbWVyZ2VkLlxuICpcbiAqIEBjYXRlZ29yeSBwYXR0ZXJuIG1hdGNoaW5nXG4gKiBAc2luY2UgMi4xMS4wXG4gKi9cbmV4cG9ydCB2YXIgbWF0Y2hXID0gZnVuY3Rpb24gKG9uRW1wdHksIG9uTm9uRW1wdHkpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIHJldHVybiBpc05vbkVtcHR5KGFzKSA/IG9uTm9uRW1wdHkoYXMpIDogb25FbXB0eSgpO1xuICAgIH07XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgcGF0dGVybiBtYXRjaGluZ1xuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIG1hdGNoID0gbWF0Y2hXO1xuLyoqXG4gKiBMZXNzIHN0cmljdCB2ZXJzaW9uIG9mIFtgbWF0Y2hMZWZ0YF0oI21hdGNobGVmdCkuXG4gKlxuICogQGNhdGVnb3J5IHBhdHRlcm4gbWF0Y2hpbmdcbiAqIEBzaW5jZSAyLjExLjBcbiAqL1xuZXhwb3J0IHZhciBtYXRjaExlZnRXID0gZnVuY3Rpb24gKG9uRW1wdHksIG9uTm9uRW1wdHkpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIHJldHVybiBpc05vbkVtcHR5KGFzKSA/IG9uTm9uRW1wdHkoUk5FQS5oZWFkKGFzKSwgUk5FQS50YWlsKGFzKSkgOiBvbkVtcHR5KCk7XG4gICAgfTtcbn07XG4vKipcbiAqIEJyZWFrIGEgYFJlYWRvbmx5QXJyYXlgIGludG8gaXRzIGZpcnN0IGVsZW1lbnQgYW5kIHJlbWFpbmluZyBlbGVtZW50cy5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgbWF0Y2hMZWZ0IH0gZnJvbSAnZnAtdHMvUmVhZG9ubHlBcnJheSdcbiAqXG4gKiBjb25zdCBsZW46IDxBPihhczogUmVhZG9ubHlBcnJheTxBPikgPT4gbnVtYmVyID0gbWF0Y2hMZWZ0KCgpID0+IDAsIChfLCB0YWlsKSA9PiAxICsgbGVuKHRhaWwpKVxuICogYXNzZXJ0LnN0cmljdEVxdWFsKGxlbihbMSwgMiwgM10pLCAzKVxuICpcbiAqIEBjYXRlZ29yeSBwYXR0ZXJuIG1hdGNoaW5nXG4gKiBAc2luY2UgMi4xMC4wXG4gKi9cbmV4cG9ydCB2YXIgbWF0Y2hMZWZ0ID0gbWF0Y2hMZWZ0Vztcbi8qKlxuICogQWxpYXMgb2YgW2BtYXRjaExlZnRgXSgjbWF0Y2hsZWZ0KS5cbiAqXG4gKiBAY2F0ZWdvcnkgcGF0dGVybiBtYXRjaGluZ1xuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgZm9sZExlZnQgPSBtYXRjaExlZnQ7XG4vKipcbiAqIExlc3Mgc3RyaWN0IHZlcnNpb24gb2YgW2BtYXRjaFJpZ2h0YF0oI21hdGNocmlnaHQpLlxuICpcbiAqIEBjYXRlZ29yeSBwYXR0ZXJuIG1hdGNoaW5nXG4gKiBAc2luY2UgMi4xMS4wXG4gKi9cbmV4cG9ydCB2YXIgbWF0Y2hSaWdodFcgPSBmdW5jdGlvbiAob25FbXB0eSwgb25Ob25FbXB0eSkge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgcmV0dXJuIGlzTm9uRW1wdHkoYXMpID8gb25Ob25FbXB0eShSTkVBLmluaXQoYXMpLCBSTkVBLmxhc3QoYXMpKSA6IG9uRW1wdHkoKTtcbiAgICB9O1xufTtcbi8qKlxuICogQnJlYWsgYSBgUmVhZG9ubHlBcnJheWAgaW50byBpdHMgaW5pdGlhbCBlbGVtZW50cyBhbmQgdGhlIGxhc3QgZWxlbWVudC5cbiAqXG4gKiBAY2F0ZWdvcnkgcGF0dGVybiBtYXRjaGluZ1xuICogQHNpbmNlIDIuMTAuMFxuICovXG5leHBvcnQgdmFyIG1hdGNoUmlnaHQgPSBtYXRjaFJpZ2h0Vztcbi8qKlxuICogQWxpYXMgb2YgW2BtYXRjaFJpZ2h0YF0oI21hdGNocmlnaHQpLlxuICpcbiAqIEBjYXRlZ29yeSBwYXR0ZXJuIG1hdGNoaW5nXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBmb2xkUmlnaHQgPSBtYXRjaFJpZ2h0O1xuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLy8gY29tYmluYXRvcnNcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8qKlxuICogQGNhdGVnb3J5IHNlcXVlbmNpbmdcbiAqIEBzaW5jZSAyLjcuMFxuICovXG5leHBvcnQgdmFyIGNoYWluV2l0aEluZGV4ID0gZnVuY3Rpb24gKGYpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIGlmIChpc0VtcHR5KGFzKSkge1xuICAgICAgICAgICAgcmV0dXJuIGVtcHR5O1xuICAgICAgICB9XG4gICAgICAgIHZhciBvdXQgPSBbXTtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBhcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgb3V0LnB1c2guYXBwbHkob3V0LCBmKGksIGFzW2ldKSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG91dDtcbiAgICB9O1xufTtcbi8qKlxuICogU2FtZSBhcyBgcmVkdWNlYCBidXQgaXQgY2FycmllcyBvdmVyIHRoZSBpbnRlcm1lZGlhdGUgc3RlcHMuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IHNjYW5MZWZ0IH0gZnJvbSAnZnAtdHMvUmVhZG9ubHlBcnJheSdcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKHNjYW5MZWZ0KDEwLCAoYiwgYTogbnVtYmVyKSA9PiBiIC0gYSkoWzEsIDIsIDNdKSwgWzEwLCA5LCA3LCA0XSlcbiAqXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBzY2FuTGVmdCA9IGZ1bmN0aW9uIChiLCBmKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykge1xuICAgICAgICB2YXIgbGVuID0gYXMubGVuZ3RoO1xuICAgICAgICB2YXIgb3V0ID0gbmV3IEFycmF5KGxlbiArIDEpO1xuICAgICAgICBvdXRbMF0gPSBiO1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGxlbjsgaSsrKSB7XG4gICAgICAgICAgICBvdXRbaSArIDFdID0gZihvdXRbaV0sIGFzW2ldKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gb3V0O1xuICAgIH07XG59O1xuLyoqXG4gKiBGb2xkIGFuIGFycmF5IGZyb20gdGhlIHJpZ2h0LCBrZWVwaW5nIGFsbCBpbnRlcm1lZGlhdGUgcmVzdWx0cyBpbnN0ZWFkIG9mIG9ubHkgdGhlIGZpbmFsIHJlc3VsdFxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBzY2FuUmlnaHQgfSBmcm9tICdmcC10cy9SZWFkb25seUFycmF5J1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoc2NhblJpZ2h0KDEwLCAoYTogbnVtYmVyLCBiKSA9PiBiIC0gYSkoWzEsIDIsIDNdKSwgWzQsIDUsIDcsIDEwXSlcbiAqXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBzY2FuUmlnaHQgPSBmdW5jdGlvbiAoYiwgZikge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgdmFyIGxlbiA9IGFzLmxlbmd0aDtcbiAgICAgICAgdmFyIG91dCA9IG5ldyBBcnJheShsZW4gKyAxKTtcbiAgICAgICAgb3V0W2xlbl0gPSBiO1xuICAgICAgICBmb3IgKHZhciBpID0gbGVuIC0gMTsgaSA+PSAwOyBpLS0pIHtcbiAgICAgICAgICAgIG91dFtpXSA9IGYoYXNbaV0sIG91dFtpICsgMV0pO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBvdXQ7XG4gICAgfTtcbn07XG4vKipcbiAqIENhbGN1bGF0ZSB0aGUgbnVtYmVyIG9mIGVsZW1lbnRzIGluIGEgYFJlYWRvbmx5QXJyYXlgLlxuICpcbiAqIEBzaW5jZSAyLjEwLjBcbiAqL1xuZXhwb3J0IHZhciBzaXplID0gZnVuY3Rpb24gKGFzKSB7IHJldHVybiBhcy5sZW5ndGg7IH07XG4vKipcbiAqIFRlc3Qgd2hldGhlciBhbiBhcnJheSBjb250YWlucyBhIHBhcnRpY3VsYXIgaW5kZXhcbiAqXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBpc091dE9mQm91bmQgPSBSTkVBLmlzT3V0T2ZCb3VuZDtcbmV4cG9ydCBmdW5jdGlvbiBsb29rdXAoaSwgYXMpIHtcbiAgICByZXR1cm4gYXMgPT09IHVuZGVmaW5lZCA/IGZ1bmN0aW9uIChhcykgeyByZXR1cm4gbG9va3VwKGksIGFzKTsgfSA6IGlzT3V0T2ZCb3VuZChpLCBhcykgPyBfLm5vbmUgOiBfLnNvbWUoYXNbaV0pO1xufVxuLyoqXG4gKiBHZXQgdGhlIGZpcnN0IGVsZW1lbnQgaW4gYW4gYXJyYXksIG9yIGBOb25lYCBpZiB0aGUgYXJyYXkgaXMgZW1wdHlcbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgaGVhZCB9IGZyb20gJ2ZwLXRzL1JlYWRvbmx5QXJyYXknXG4gKiBpbXBvcnQgeyBzb21lLCBub25lIH0gZnJvbSAnZnAtdHMvT3B0aW9uJ1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoaGVhZChbMSwgMiwgM10pLCBzb21lKDEpKVxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChoZWFkKFtdKSwgbm9uZSlcbiAqXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBoZWFkID0gZnVuY3Rpb24gKGFzKSB7IHJldHVybiAoaXNOb25FbXB0eShhcykgPyBfLnNvbWUoUk5FQS5oZWFkKGFzKSkgOiBfLm5vbmUpOyB9O1xuLyoqXG4gKiBHZXQgdGhlIGxhc3QgZWxlbWVudCBpbiBhbiBhcnJheSwgb3IgYE5vbmVgIGlmIHRoZSBhcnJheSBpcyBlbXB0eVxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBsYXN0IH0gZnJvbSAnZnAtdHMvUmVhZG9ubHlBcnJheSdcbiAqIGltcG9ydCB7IHNvbWUsIG5vbmUgfSBmcm9tICdmcC10cy9PcHRpb24nXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChsYXN0KFsxLCAyLCAzXSksIHNvbWUoMykpXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKGxhc3QoW10pLCBub25lKVxuICpcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIGxhc3QgPSBmdW5jdGlvbiAoYXMpIHsgcmV0dXJuIChpc05vbkVtcHR5KGFzKSA/IF8uc29tZShSTkVBLmxhc3QoYXMpKSA6IF8ubm9uZSk7IH07XG4vKipcbiAqIEdldCBhbGwgYnV0IHRoZSBmaXJzdCBlbGVtZW50IG9mIGFuIGFycmF5LCBjcmVhdGluZyBhIG5ldyBhcnJheSwgb3IgYE5vbmVgIGlmIHRoZSBhcnJheSBpcyBlbXB0eVxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyB0YWlsIH0gZnJvbSAnZnAtdHMvUmVhZG9ubHlBcnJheSdcbiAqIGltcG9ydCB7IHNvbWUsIG5vbmUgfSBmcm9tICdmcC10cy9PcHRpb24nXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbCh0YWlsKFsxLCAyLCAzXSksIHNvbWUoWzIsIDNdKSlcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwodGFpbChbXSksIG5vbmUpXG4gKlxuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgdGFpbCA9IGZ1bmN0aW9uIChhcykge1xuICAgIHJldHVybiBpc05vbkVtcHR5KGFzKSA/IF8uc29tZShSTkVBLnRhaWwoYXMpKSA6IF8ubm9uZTtcbn07XG4vKipcbiAqIEdldCBhbGwgYnV0IHRoZSBsYXN0IGVsZW1lbnQgb2YgYW4gYXJyYXksIGNyZWF0aW5nIGEgbmV3IGFycmF5LCBvciBgTm9uZWAgaWYgdGhlIGFycmF5IGlzIGVtcHR5XG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IGluaXQgfSBmcm9tICdmcC10cy9SZWFkb25seUFycmF5J1xuICogaW1wb3J0IHsgc29tZSwgbm9uZSB9IGZyb20gJ2ZwLXRzL09wdGlvbidcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKGluaXQoWzEsIDIsIDNdKSwgc29tZShbMSwgMl0pKVxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChpbml0KFtdKSwgbm9uZSlcbiAqXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBpbml0ID0gZnVuY3Rpb24gKGFzKSB7XG4gICAgcmV0dXJuIGlzTm9uRW1wdHkoYXMpID8gXy5zb21lKFJORUEuaW5pdChhcykpIDogXy5ub25lO1xufTtcbi8qKlxuICogS2VlcCBvbmx5IGEgbWF4IG51bWJlciBvZiBlbGVtZW50cyBmcm9tIHRoZSBzdGFydCBvZiBhbiBgUmVhZG9ubHlBcnJheWAsIGNyZWF0aW5nIGEgbmV3IGBSZWFkb25seUFycmF5YC5cbiAqXG4gKiAqKk5vdGUqKi4gYG5gIGlzIG5vcm1hbGl6ZWQgdG8gYSBub24gbmVnYXRpdmUgaW50ZWdlci5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0ICogYXMgUkEgZnJvbSAnZnAtdHMvUmVhZG9ubHlBcnJheSdcbiAqIGltcG9ydCB7IHBpcGUgfSBmcm9tICdmcC10cy9mdW5jdGlvbidcbiAqXG4gKiBjb25zdCBpbnB1dDogUmVhZG9ubHlBcnJheTxudW1iZXI+ID0gWzEsIDIsIDNdXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKHBpcGUoaW5wdXQsIFJBLnRha2VMZWZ0KDIpKSwgWzEsIDJdKVxuICpcbiAqIC8vIG91dCBvZiBib3VuZHNcbiAqIGFzc2VydC5zdHJpY3RFcXVhbChwaXBlKGlucHV0LCBSQS50YWtlTGVmdCg0KSksIGlucHV0KVxuICogYXNzZXJ0LnN0cmljdEVxdWFsKHBpcGUoaW5wdXQsIFJBLnRha2VMZWZ0KC0xKSksIGlucHV0KVxuICpcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIHRha2VMZWZ0ID0gZnVuY3Rpb24gKG4pIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIHJldHVybiBpc091dE9mQm91bmQobiwgYXMpID8gYXMgOiBuID09PSAwID8gZW1wdHkgOiBhcy5zbGljZSgwLCBuKTtcbiAgICB9O1xufTtcbi8qKlxuICogS2VlcCBvbmx5IGEgbWF4IG51bWJlciBvZiBlbGVtZW50cyBmcm9tIHRoZSBlbmQgb2YgYW4gYFJlYWRvbmx5QXJyYXlgLCBjcmVhdGluZyBhIG5ldyBgUmVhZG9ubHlBcnJheWAuXG4gKlxuICogKipOb3RlKiouIGBuYCBpcyBub3JtYWxpemVkIHRvIGEgbm9uIG5lZ2F0aXZlIGludGVnZXIuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCAqIGFzIFJBIGZyb20gJ2ZwLXRzL1JlYWRvbmx5QXJyYXknXG4gKiBpbXBvcnQgeyBwaXBlIH0gZnJvbSAnZnAtdHMvZnVuY3Rpb24nXG4gKlxuICogY29uc3QgaW5wdXQ6IFJlYWRvbmx5QXJyYXk8bnVtYmVyPiA9IFsxLCAyLCAzXVxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChwaXBlKGlucHV0LCBSQS50YWtlUmlnaHQoMikpLCBbMiwgM10pXG4gKlxuICogLy8gb3V0IG9mIGJvdW5kc1xuICogYXNzZXJ0LnN0cmljdEVxdWFsKHBpcGUoaW5wdXQsIFJBLnRha2VSaWdodCg0KSksIGlucHV0KVxuICogYXNzZXJ0LnN0cmljdEVxdWFsKHBpcGUoaW5wdXQsIFJBLnRha2VSaWdodCgtMSkpLCBpbnB1dClcbiAqXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciB0YWtlUmlnaHQgPSBmdW5jdGlvbiAobikge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgcmV0dXJuIGlzT3V0T2ZCb3VuZChuLCBhcykgPyBhcyA6IG4gPT09IDAgPyBlbXB0eSA6IGFzLnNsaWNlKC1uKTtcbiAgICB9O1xufTtcbmV4cG9ydCBmdW5jdGlvbiB0YWtlTGVmdFdoaWxlKHByZWRpY2F0ZSkge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgdmFyIG91dCA9IFtdO1xuICAgICAgICBmb3IgKHZhciBfaSA9IDAsIGFzXzEgPSBhczsgX2kgPCBhc18xLmxlbmd0aDsgX2krKykge1xuICAgICAgICAgICAgdmFyIGEgPSBhc18xW19pXTtcbiAgICAgICAgICAgIGlmICghcHJlZGljYXRlKGEpKSB7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBvdXQucHVzaChhKTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgbGVuID0gb3V0Lmxlbmd0aDtcbiAgICAgICAgcmV0dXJuIGxlbiA9PT0gYXMubGVuZ3RoID8gYXMgOiBsZW4gPT09IDAgPyBlbXB0eSA6IG91dDtcbiAgICB9O1xufVxudmFyIHNwYW5MZWZ0SW5kZXggPSBmdW5jdGlvbiAoYXMsIHByZWRpY2F0ZSkge1xuICAgIHZhciBsID0gYXMubGVuZ3RoO1xuICAgIHZhciBpID0gMDtcbiAgICBmb3IgKDsgaSA8IGw7IGkrKykge1xuICAgICAgICBpZiAoIXByZWRpY2F0ZShhc1tpXSkpIHtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiBpO1xufTtcbmV4cG9ydCBmdW5jdGlvbiBzcGFuTGVmdChwcmVkaWNhdGUpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIHZhciBfYSA9IHNwbGl0QXQoc3BhbkxlZnRJbmRleChhcywgcHJlZGljYXRlKSkoYXMpLCBpbml0ID0gX2FbMF0sIHJlc3QgPSBfYVsxXTtcbiAgICAgICAgcmV0dXJuIHsgaW5pdDogaW5pdCwgcmVzdDogcmVzdCB9O1xuICAgIH07XG59XG4vKipcbiAqIERyb3AgYSBtYXggbnVtYmVyIG9mIGVsZW1lbnRzIGZyb20gdGhlIHN0YXJ0IG9mIGFuIGBSZWFkb25seUFycmF5YCwgY3JlYXRpbmcgYSBuZXcgYFJlYWRvbmx5QXJyYXlgLlxuICpcbiAqICoqTm90ZSoqLiBgbmAgaXMgbm9ybWFsaXplZCB0byBhIG5vbiBuZWdhdGl2ZSBpbnRlZ2VyLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgKiBhcyBSQSBmcm9tICdmcC10cy9SZWFkb25seUFycmF5J1xuICogaW1wb3J0IHsgcGlwZSB9IGZyb20gJ2ZwLXRzL2Z1bmN0aW9uJ1xuICpcbiAqIGNvbnN0IGlucHV0OiBSZWFkb25seUFycmF5PG51bWJlcj4gPSBbMSwgMiwgM11cbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwocGlwZShpbnB1dCwgUkEuZHJvcExlZnQoMikpLCBbM10pXG4gKiBhc3NlcnQuc3RyaWN0RXF1YWwocGlwZShpbnB1dCwgUkEuZHJvcExlZnQoMCkpLCBpbnB1dClcbiAqIGFzc2VydC5zdHJpY3RFcXVhbChwaXBlKGlucHV0LCBSQS5kcm9wTGVmdCgtMSkpLCBpbnB1dClcbiAqXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBkcm9wTGVmdCA9IGZ1bmN0aW9uIChuKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykge1xuICAgICAgICByZXR1cm4gbiA8PSAwIHx8IGlzRW1wdHkoYXMpID8gYXMgOiBuID49IGFzLmxlbmd0aCA/IGVtcHR5IDogYXMuc2xpY2UobiwgYXMubGVuZ3RoKTtcbiAgICB9O1xufTtcbi8qKlxuICogRHJvcCBhIG1heCBudW1iZXIgb2YgZWxlbWVudHMgZnJvbSB0aGUgZW5kIG9mIGFuIGBSZWFkb25seUFycmF5YCwgY3JlYXRpbmcgYSBuZXcgYFJlYWRvbmx5QXJyYXlgLlxuICpcbiAqICoqTm90ZSoqLiBgbmAgaXMgbm9ybWFsaXplZCB0byBhIG5vbiBuZWdhdGl2ZSBpbnRlZ2VyLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgKiBhcyBSQSBmcm9tICdmcC10cy9SZWFkb25seUFycmF5J1xuICogaW1wb3J0IHsgcGlwZSB9IGZyb20gJ2ZwLXRzL2Z1bmN0aW9uJ1xuICpcbiAqIGNvbnN0IGlucHV0OiBSZWFkb25seUFycmF5PG51bWJlcj4gPSBbMSwgMiwgM11cbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwocGlwZShpbnB1dCwgUkEuZHJvcFJpZ2h0KDIpKSwgWzFdKVxuICogYXNzZXJ0LnN0cmljdEVxdWFsKHBpcGUoaW5wdXQsIFJBLmRyb3BSaWdodCgwKSksIGlucHV0KVxuICogYXNzZXJ0LnN0cmljdEVxdWFsKHBpcGUoaW5wdXQsIFJBLmRyb3BSaWdodCgtMSkpLCBpbnB1dClcbiAqXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBkcm9wUmlnaHQgPSBmdW5jdGlvbiAobikge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgcmV0dXJuIG4gPD0gMCB8fCBpc0VtcHR5KGFzKSA/IGFzIDogbiA+PSBhcy5sZW5ndGggPyBlbXB0eSA6IGFzLnNsaWNlKDAsIGFzLmxlbmd0aCAtIG4pO1xuICAgIH07XG59O1xuZXhwb3J0IGZ1bmN0aW9uIGRyb3BMZWZ0V2hpbGUocHJlZGljYXRlKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykge1xuICAgICAgICB2YXIgaSA9IHNwYW5MZWZ0SW5kZXgoYXMsIHByZWRpY2F0ZSk7XG4gICAgICAgIHJldHVybiBpID09PSAwID8gYXMgOiBpID09PSBhcy5sZW5ndGggPyBlbXB0eSA6IGFzLnNsaWNlKGkpO1xuICAgIH07XG59XG4vKipcbiAqIEZpbmQgdGhlIGZpcnN0IGluZGV4IGZvciB3aGljaCBhIHByZWRpY2F0ZSBob2xkc1xuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBmaW5kSW5kZXggfSBmcm9tICdmcC10cy9SZWFkb25seUFycmF5J1xuICogaW1wb3J0IHsgc29tZSwgbm9uZSB9IGZyb20gJ2ZwLXRzL09wdGlvbidcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKGZpbmRJbmRleCgobjogbnVtYmVyKSA9PiBuID09PSAyKShbMSwgMiwgM10pLCBzb21lKDEpKVxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChmaW5kSW5kZXgoKG46IG51bWJlcikgPT4gbiA9PT0gMikoW10pLCBub25lKVxuICpcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIGZpbmRJbmRleCA9IGZ1bmN0aW9uIChwcmVkaWNhdGUpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgYXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIGlmIChwcmVkaWNhdGUoYXNbaV0pKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIF8uc29tZShpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gXy5ub25lO1xuICAgIH07XG59O1xuZXhwb3J0IGZ1bmN0aW9uIGZpbmRGaXJzdChwcmVkaWNhdGUpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgYXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIGlmIChwcmVkaWNhdGUoYXNbaV0pKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIF8uc29tZShhc1tpXSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIF8ubm9uZTtcbiAgICB9O1xufVxuLyoqXG4gKiBGaW5kIHRoZSBmaXJzdCBlbGVtZW50IHJldHVybmVkIGJ5IGFuIG9wdGlvbiBiYXNlZCBzZWxlY3RvciBmdW5jdGlvblxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBmaW5kRmlyc3RNYXAgfSBmcm9tICdmcC10cy9SZWFkb25seUFycmF5J1xuICogaW1wb3J0IHsgc29tZSwgbm9uZSB9IGZyb20gJ2ZwLXRzL09wdGlvbidcbiAqXG4gKiBpbnRlcmZhY2UgUGVyc29uIHtcbiAqICAgcmVhZG9ubHkgbmFtZTogc3RyaW5nXG4gKiAgIHJlYWRvbmx5IGFnZT86IG51bWJlclxuICogfVxuICpcbiAqIGNvbnN0IHBlcnNvbnM6IFJlYWRvbmx5QXJyYXk8UGVyc29uPiA9IFt7IG5hbWU6ICdKb2huJyB9LCB7IG5hbWU6ICdNYXJ5JywgYWdlOiA0NSB9LCB7IG5hbWU6ICdKb2V5JywgYWdlOiAyOCB9XVxuICpcbiAqIC8vIHJldHVybnMgdGhlIG5hbWUgb2YgdGhlIGZpcnN0IHBlcnNvbiB0aGF0IGhhcyBhbiBhZ2VcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoZmluZEZpcnN0TWFwKChwOiBQZXJzb24pID0+IChwLmFnZSA9PT0gdW5kZWZpbmVkID8gbm9uZSA6IHNvbWUocC5uYW1lKSkpKHBlcnNvbnMpLCBzb21lKCdNYXJ5JykpXG4gKlxuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgZmluZEZpcnN0TWFwID0gZnVuY3Rpb24gKGYpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgYXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIHZhciBvdXQgPSBmKGFzW2ldKTtcbiAgICAgICAgICAgIGlmIChfLmlzU29tZShvdXQpKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG91dDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gXy5ub25lO1xuICAgIH07XG59O1xuZXhwb3J0IGZ1bmN0aW9uIGZpbmRMYXN0KHByZWRpY2F0ZSkge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgZm9yICh2YXIgaSA9IGFzLmxlbmd0aCAtIDE7IGkgPj0gMDsgaS0tKSB7XG4gICAgICAgICAgICBpZiAocHJlZGljYXRlKGFzW2ldKSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBfLnNvbWUoYXNbaV0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBfLm5vbmU7XG4gICAgfTtcbn1cbi8qKlxuICogRmluZCB0aGUgbGFzdCBlbGVtZW50IHJldHVybmVkIGJ5IGFuIG9wdGlvbiBiYXNlZCBzZWxlY3RvciBmdW5jdGlvblxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBmaW5kTGFzdE1hcCB9IGZyb20gJ2ZwLXRzL1JlYWRvbmx5QXJyYXknXG4gKiBpbXBvcnQgeyBzb21lLCBub25lIH0gZnJvbSAnZnAtdHMvT3B0aW9uJ1xuICpcbiAqIGludGVyZmFjZSBQZXJzb24ge1xuICogICByZWFkb25seSBuYW1lOiBzdHJpbmdcbiAqICAgcmVhZG9ubHkgYWdlPzogbnVtYmVyXG4gKiB9XG4gKlxuICogY29uc3QgcGVyc29uczogUmVhZG9ubHlBcnJheTxQZXJzb24+ID0gW3sgbmFtZTogJ0pvaG4nIH0sIHsgbmFtZTogJ01hcnknLCBhZ2U6IDQ1IH0sIHsgbmFtZTogJ0pvZXknLCBhZ2U6IDI4IH1dXG4gKlxuICogLy8gcmV0dXJucyB0aGUgbmFtZSBvZiB0aGUgbGFzdCBwZXJzb24gdGhhdCBoYXMgYW4gYWdlXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKGZpbmRMYXN0TWFwKChwOiBQZXJzb24pID0+IChwLmFnZSA9PT0gdW5kZWZpbmVkID8gbm9uZSA6IHNvbWUocC5uYW1lKSkpKHBlcnNvbnMpLCBzb21lKCdKb2V5JykpXG4gKlxuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgZmluZExhc3RNYXAgPSBmdW5jdGlvbiAoZikge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgZm9yICh2YXIgaSA9IGFzLmxlbmd0aCAtIDE7IGkgPj0gMDsgaS0tKSB7XG4gICAgICAgICAgICB2YXIgb3V0ID0gZihhc1tpXSk7XG4gICAgICAgICAgICBpZiAoXy5pc1NvbWUob3V0KSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBvdXQ7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIF8ubm9uZTtcbiAgICB9O1xufTtcbi8qKlxuICogUmV0dXJucyB0aGUgaW5kZXggb2YgdGhlIGxhc3QgZWxlbWVudCBvZiB0aGUgbGlzdCB3aGljaCBtYXRjaGVzIHRoZSBwcmVkaWNhdGVcbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgZmluZExhc3RJbmRleCB9IGZyb20gJ2ZwLXRzL1JlYWRvbmx5QXJyYXknXG4gKiBpbXBvcnQgeyBzb21lLCBub25lIH0gZnJvbSAnZnAtdHMvT3B0aW9uJ1xuICpcbiAqIGludGVyZmFjZSBYIHtcbiAqICAgcmVhZG9ubHkgYTogbnVtYmVyXG4gKiAgIHJlYWRvbmx5IGI6IG51bWJlclxuICogfVxuICogY29uc3QgeHM6IFJlYWRvbmx5QXJyYXk8WD4gPSBbeyBhOiAxLCBiOiAwIH0sIHsgYTogMSwgYjogMSB9XVxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChmaW5kTGFzdEluZGV4KCh4OiB7IHJlYWRvbmx5IGE6IG51bWJlciB9KSA9PiB4LmEgPT09IDEpKHhzKSwgc29tZSgxKSlcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoZmluZExhc3RJbmRleCgoeDogeyByZWFkb25seSBhOiBudW1iZXIgfSkgPT4geC5hID09PSA0KSh4cyksIG5vbmUpXG4gKlxuICpcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIGZpbmRMYXN0SW5kZXggPSBmdW5jdGlvbiAocHJlZGljYXRlKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykge1xuICAgICAgICBmb3IgKHZhciBpID0gYXMubGVuZ3RoIC0gMTsgaSA+PSAwOyBpLS0pIHtcbiAgICAgICAgICAgIGlmIChwcmVkaWNhdGUoYXNbaV0pKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIF8uc29tZShpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gXy5ub25lO1xuICAgIH07XG59O1xuLyoqXG4gKiBJbnNlcnQgYW4gZWxlbWVudCBhdCB0aGUgc3BlY2lmaWVkIGluZGV4LCBjcmVhdGluZyBhIG5ldyBhcnJheSwgb3IgcmV0dXJuaW5nIGBOb25lYCBpZiB0aGUgaW5kZXggaXMgb3V0IG9mIGJvdW5kc1xuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBpbnNlcnRBdCB9IGZyb20gJ2ZwLXRzL1JlYWRvbmx5QXJyYXknXG4gKiBpbXBvcnQgeyBzb21lIH0gZnJvbSAnZnAtdHMvT3B0aW9uJ1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoaW5zZXJ0QXQoMiwgNSkoWzEsIDIsIDMsIDRdKSwgc29tZShbMSwgMiwgNSwgMywgNF0pKVxuICpcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIGluc2VydEF0ID0gZnVuY3Rpb24gKGksIGEpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIHJldHVybiBpIDwgMCB8fCBpID4gYXMubGVuZ3RoID8gXy5ub25lIDogXy5zb21lKFJORUEudW5zYWZlSW5zZXJ0QXQoaSwgYSwgYXMpKTtcbiAgICB9O1xufTtcbi8qKlxuICogQ2hhbmdlIHRoZSBlbGVtZW50IGF0IHRoZSBzcGVjaWZpZWQgaW5kZXgsIGNyZWF0aW5nIGEgbmV3IGFycmF5LCBvciByZXR1cm5pbmcgYE5vbmVgIGlmIHRoZSBpbmRleCBpcyBvdXQgb2YgYm91bmRzXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IHVwZGF0ZUF0IH0gZnJvbSAnZnAtdHMvUmVhZG9ubHlBcnJheSdcbiAqIGltcG9ydCB7IHNvbWUsIG5vbmUgfSBmcm9tICdmcC10cy9PcHRpb24nXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbCh1cGRhdGVBdCgxLCAxKShbMSwgMiwgM10pLCBzb21lKFsxLCAxLCAzXSkpXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKHVwZGF0ZUF0KDEsIDEpKFtdKSwgbm9uZSlcbiAqXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciB1cGRhdGVBdCA9IGZ1bmN0aW9uIChpLCBhKSB7XG4gICAgcmV0dXJuIG1vZGlmeUF0KGksIGZ1bmN0aW9uICgpIHsgcmV0dXJuIGE7IH0pO1xufTtcbi8qKlxuICogRGVsZXRlIHRoZSBlbGVtZW50IGF0IHRoZSBzcGVjaWZpZWQgaW5kZXgsIGNyZWF0aW5nIGEgbmV3IGFycmF5LCBvciByZXR1cm5pbmcgYE5vbmVgIGlmIHRoZSBpbmRleCBpcyBvdXQgb2YgYm91bmRzXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IGRlbGV0ZUF0IH0gZnJvbSAnZnAtdHMvUmVhZG9ubHlBcnJheSdcbiAqIGltcG9ydCB7IHNvbWUsIG5vbmUgfSBmcm9tICdmcC10cy9PcHRpb24nXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChkZWxldGVBdCgwKShbMSwgMiwgM10pLCBzb21lKFsyLCAzXSkpXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKGRlbGV0ZUF0KDEpKFtdKSwgbm9uZSlcbiAqXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBkZWxldGVBdCA9IGZ1bmN0aW9uIChpKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykge1xuICAgICAgICByZXR1cm4gaXNPdXRPZkJvdW5kKGksIGFzKSA/IF8ubm9uZSA6IF8uc29tZSh1bnNhZmVEZWxldGVBdChpLCBhcykpO1xuICAgIH07XG59O1xuLyoqXG4gKiBBcHBseSBhIGZ1bmN0aW9uIHRvIHRoZSBlbGVtZW50IGF0IHRoZSBzcGVjaWZpZWQgaW5kZXgsIGNyZWF0aW5nIGEgbmV3IGFycmF5LCBvciByZXR1cm5pbmcgYE5vbmVgIGlmIHRoZSBpbmRleCBpcyBvdXRcbiAqIG9mIGJvdW5kc1xuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBtb2RpZnlBdCB9IGZyb20gJ2ZwLXRzL1JlYWRvbmx5QXJyYXknXG4gKiBpbXBvcnQgeyBzb21lLCBub25lIH0gZnJvbSAnZnAtdHMvT3B0aW9uJ1xuICpcbiAqIGNvbnN0IGRvdWJsZSA9ICh4OiBudW1iZXIpOiBudW1iZXIgPT4geCAqIDJcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwobW9kaWZ5QXQoMSwgZG91YmxlKShbMSwgMiwgM10pLCBzb21lKFsxLCA0LCAzXSkpXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKG1vZGlmeUF0KDEsIGRvdWJsZSkoW10pLCBub25lKVxuICpcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIG1vZGlmeUF0ID0gZnVuY3Rpb24gKGksIGYpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIHJldHVybiBpc091dE9mQm91bmQoaSwgYXMpID8gXy5ub25lIDogXy5zb21lKHVuc2FmZVVwZGF0ZUF0KGksIGYoYXNbaV0pLCBhcykpO1xuICAgIH07XG59O1xuLyoqXG4gKiBSZXZlcnNlIGFuIGFycmF5LCBjcmVhdGluZyBhIG5ldyBhcnJheVxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyByZXZlcnNlIH0gZnJvbSAnZnAtdHMvUmVhZG9ubHlBcnJheSdcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKHJldmVyc2UoWzEsIDIsIDNdKSwgWzMsIDIsIDFdKVxuICpcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIHJldmVyc2UgPSBmdW5jdGlvbiAoYXMpIHsgcmV0dXJuIChhcy5sZW5ndGggPD0gMSA/IGFzIDogYXMuc2xpY2UoKS5yZXZlcnNlKCkpOyB9O1xuLyoqXG4gKiBFeHRyYWN0cyBmcm9tIGFuIGFycmF5IG9mIGBFaXRoZXJgIGFsbCB0aGUgYFJpZ2h0YCBlbGVtZW50cy4gQWxsIHRoZSBgUmlnaHRgIGVsZW1lbnRzIGFyZSBleHRyYWN0ZWQgaW4gb3JkZXJcbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgcmlnaHRzIH0gZnJvbSAnZnAtdHMvUmVhZG9ubHlBcnJheSdcbiAqIGltcG9ydCB7IHJpZ2h0LCBsZWZ0IH0gZnJvbSAnZnAtdHMvRWl0aGVyJ1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwocmlnaHRzKFtyaWdodCgxKSwgbGVmdCgnZm9vJyksIHJpZ2h0KDIpXSksIFsxLCAyXSlcbiAqXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciByaWdodHMgPSBmdW5jdGlvbiAoYXMpIHtcbiAgICB2YXIgciA9IFtdO1xuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgYXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgdmFyIGEgPSBhc1tpXTtcbiAgICAgICAgaWYgKGEuX3RhZyA9PT0gJ1JpZ2h0Jykge1xuICAgICAgICAgICAgci5wdXNoKGEucmlnaHQpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiByO1xufTtcbi8qKlxuICogRXh0cmFjdHMgZnJvbSBhbiBhcnJheSBvZiBgRWl0aGVyYCBhbGwgdGhlIGBMZWZ0YCBlbGVtZW50cy4gQWxsIHRoZSBgTGVmdGAgZWxlbWVudHMgYXJlIGV4dHJhY3RlZCBpbiBvcmRlclxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBsZWZ0cyB9IGZyb20gJ2ZwLXRzL1JlYWRvbmx5QXJyYXknXG4gKiBpbXBvcnQgeyBsZWZ0LCByaWdodCB9IGZyb20gJ2ZwLXRzL0VpdGhlcidcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKGxlZnRzKFtyaWdodCgxKSwgbGVmdCgnZm9vJyksIHJpZ2h0KDIpXSksIFsnZm9vJ10pXG4gKlxuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgbGVmdHMgPSBmdW5jdGlvbiAoYXMpIHtcbiAgICB2YXIgciA9IFtdO1xuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgYXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgdmFyIGEgPSBhc1tpXTtcbiAgICAgICAgaWYgKGEuX3RhZyA9PT0gJ0xlZnQnKSB7XG4gICAgICAgICAgICByLnB1c2goYS5sZWZ0KTtcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gcjtcbn07XG4vKipcbiAqIFNvcnQgdGhlIGVsZW1lbnRzIG9mIGFuIGFycmF5IGluIGluY3JlYXNpbmcgb3JkZXIsIGNyZWF0aW5nIGEgbmV3IGFycmF5XG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IHNvcnQgfSBmcm9tICdmcC10cy9SZWFkb25seUFycmF5J1xuICogaW1wb3J0ICogYXMgTiBmcm9tICdmcC10cy9udW1iZXInXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChzb3J0KE4uT3JkKShbMywgMiwgMV0pLCBbMSwgMiwgM10pXG4gKlxuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgc29ydCA9IGZ1bmN0aW9uIChPKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykge1xuICAgICAgICByZXR1cm4gYXMubGVuZ3RoIDw9IDEgPyBhcyA6IGFzLnNsaWNlKCkuc29ydChPLmNvbXBhcmUpO1xuICAgIH07XG59O1xuLy8gVE9ETzogY3VycnkgYW5kIG1ha2UgZGF0YS1sYXN0IGluIHYzXG4vKipcbiAqIEFwcGx5IGEgZnVuY3Rpb24gdG8gcGFpcnMgb2YgZWxlbWVudHMgYXQgdGhlIHNhbWUgaW5kZXggaW4gdHdvIGFycmF5cywgY29sbGVjdGluZyB0aGUgcmVzdWx0cyBpbiBhIG5ldyBhcnJheS4gSWYgb25lXG4gKiBpbnB1dCBhcnJheSBpcyBzaG9ydCwgZXhjZXNzIGVsZW1lbnRzIG9mIHRoZSBsb25nZXIgYXJyYXkgYXJlIGRpc2NhcmRlZC5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgemlwV2l0aCB9IGZyb20gJ2ZwLXRzL1JlYWRvbmx5QXJyYXknXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbCh6aXBXaXRoKFsxLCAyLCAzXSwgWydhJywgJ2InLCAnYycsICdkJ10sIChuLCBzKSA9PiBzICsgbiksIFsnYTEnLCAnYjInLCAnYzMnXSlcbiAqXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciB6aXBXaXRoID0gZnVuY3Rpb24gKGZhLCBmYiwgZikge1xuICAgIHZhciBmYyA9IFtdO1xuICAgIHZhciBsZW4gPSBNYXRoLm1pbihmYS5sZW5ndGgsIGZiLmxlbmd0aCk7XG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBsZW47IGkrKykge1xuICAgICAgICBmY1tpXSA9IGYoZmFbaV0sIGZiW2ldKTtcbiAgICB9XG4gICAgcmV0dXJuIGZjO1xufTtcbmV4cG9ydCBmdW5jdGlvbiB6aXAoYXMsIGJzKSB7XG4gICAgaWYgKGJzID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIChicykgeyByZXR1cm4gemlwKGJzLCBhcyk7IH07XG4gICAgfVxuICAgIHJldHVybiB6aXBXaXRoKGFzLCBicywgZnVuY3Rpb24gKGEsIGIpIHsgcmV0dXJuIFthLCBiXTsgfSk7XG59XG4vKipcbiAqIFRoZSBmdW5jdGlvbiBpcyByZXZlcnNlIG9mIGB6aXBgLiBUYWtlcyBhbiBhcnJheSBvZiBwYWlycyBhbmQgcmV0dXJuIHR3byBjb3JyZXNwb25kaW5nIGFycmF5c1xuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyB1bnppcCB9IGZyb20gJ2ZwLXRzL1JlYWRvbmx5QXJyYXknXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbCh1bnppcChbWzEsICdhJ10sIFsyLCAnYiddLCBbMywgJ2MnXV0pLCBbWzEsIDIsIDNdLCBbJ2EnLCAnYicsICdjJ11dKVxuICpcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIHVuemlwID0gZnVuY3Rpb24gKGFzKSB7XG4gICAgdmFyIGZhID0gW107XG4gICAgdmFyIGZiID0gW107XG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBhcy5sZW5ndGg7IGkrKykge1xuICAgICAgICBmYVtpXSA9IGFzW2ldWzBdO1xuICAgICAgICBmYltpXSA9IGFzW2ldWzFdO1xuICAgIH1cbiAgICByZXR1cm4gW2ZhLCBmYl07XG59O1xuLyoqXG4gKiBQcmVwZW5kIGFuIGVsZW1lbnQgdG8gZXZlcnkgbWVtYmVyIG9mIGFuIGFycmF5XG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IHByZXBlbmRBbGwgfSBmcm9tICdmcC10cy9SZWFkb25seUFycmF5J1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwocHJlcGVuZEFsbCg5KShbMSwgMiwgMywgNF0pLCBbOSwgMSwgOSwgMiwgOSwgMywgOSwgNF0pXG4gKlxuICogQHNpbmNlIDIuMTAuMFxuICovXG5leHBvcnQgdmFyIHByZXBlbmRBbGwgPSBmdW5jdGlvbiAobWlkZGxlKSB7XG4gICAgdmFyIGYgPSBSTkVBLnByZXBlbmRBbGwobWlkZGxlKTtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7IHJldHVybiAoaXNOb25FbXB0eShhcykgPyBmKGFzKSA6IGFzKTsgfTtcbn07XG4vKipcbiAqIFBsYWNlcyBhbiBlbGVtZW50IGluIGJldHdlZW4gbWVtYmVycyBvZiBhbiBhcnJheVxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBpbnRlcnNwZXJzZSB9IGZyb20gJ2ZwLXRzL1JlYWRvbmx5QXJyYXknXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChpbnRlcnNwZXJzZSg5KShbMSwgMiwgMywgNF0pLCBbMSwgOSwgMiwgOSwgMywgOSwgNF0pXG4gKlxuICogQHNpbmNlIDIuOS4wXG4gKi9cbmV4cG9ydCB2YXIgaW50ZXJzcGVyc2UgPSBmdW5jdGlvbiAobWlkZGxlKSB7XG4gICAgdmFyIGYgPSBSTkVBLmludGVyc3BlcnNlKG1pZGRsZSk7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykgeyByZXR1cm4gKGlzTm9uRW1wdHkoYXMpID8gZihhcykgOiBhcyk7IH07XG59O1xuLyoqXG4gKiBSb3RhdGUgYSBgUmVhZG9ubHlBcnJheWAgYnkgYG5gIHN0ZXBzLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyByb3RhdGUgfSBmcm9tICdmcC10cy9SZWFkb25seUFycmF5J1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwocm90YXRlKDIpKFsxLCAyLCAzLCA0LCA1XSksIFs0LCA1LCAxLCAyLCAzXSlcbiAqXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciByb3RhdGUgPSBmdW5jdGlvbiAobikge1xuICAgIHZhciBmID0gUk5FQS5yb3RhdGUobik7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykgeyByZXR1cm4gKGlzTm9uRW1wdHkoYXMpID8gZihhcykgOiBhcyk7IH07XG59O1xuZXhwb3J0IGZ1bmN0aW9uIGVsZW0oRSkge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYSwgYXMpIHtcbiAgICAgICAgaWYgKGFzID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIHZhciBlbGVtRV8xID0gZWxlbShFKTtcbiAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHsgcmV0dXJuIGVsZW1FXzEoYSwgYXMpOyB9O1xuICAgICAgICB9XG4gICAgICAgIHZhciBwcmVkaWNhdGUgPSBmdW5jdGlvbiAoZWxlbWVudCkgeyByZXR1cm4gRS5lcXVhbHMoZWxlbWVudCwgYSk7IH07XG4gICAgICAgIHZhciBpID0gMDtcbiAgICAgICAgZm9yICg7IGkgPCBhcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgaWYgKHByZWRpY2F0ZShhc1tpXSkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfTtcbn1cbi8qKlxuICogUmVtb3ZlIGR1cGxpY2F0ZXMgZnJvbSBhbiBhcnJheSwga2VlcGluZyB0aGUgZmlyc3Qgb2NjdXJyZW5jZSBvZiBhbiBlbGVtZW50LlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyB1bmlxIH0gZnJvbSAnZnAtdHMvUmVhZG9ubHlBcnJheSdcbiAqIGltcG9ydCAqIGFzIE4gZnJvbSAnZnAtdHMvbnVtYmVyJ1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwodW5pcShOLkVxKShbMSwgMiwgMV0pLCBbMSwgMl0pXG4gKlxuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgdW5pcSA9IGZ1bmN0aW9uIChFKSB7XG4gICAgdmFyIGYgPSBSTkVBLnVuaXEoRSk7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykgeyByZXR1cm4gKGlzTm9uRW1wdHkoYXMpID8gZihhcykgOiBhcyk7IH07XG59O1xuLyoqXG4gKiBTb3J0IHRoZSBlbGVtZW50cyBvZiBhbiBhcnJheSBpbiBpbmNyZWFzaW5nIG9yZGVyLCB3aGVyZSBlbGVtZW50cyBhcmUgY29tcGFyZWQgdXNpbmcgZmlyc3QgYG9yZHNbMF1gLCB0aGVuIGBvcmRzWzFdYCxcbiAqIGV0Yy4uLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBzb3J0QnkgfSBmcm9tICdmcC10cy9SZWFkb25seUFycmF5J1xuICogaW1wb3J0IHsgY29udHJhbWFwIH0gZnJvbSAnZnAtdHMvT3JkJ1xuICogaW1wb3J0ICogYXMgUyBmcm9tICdmcC10cy9zdHJpbmcnXG4gKiBpbXBvcnQgKiBhcyBOIGZyb20gJ2ZwLXRzL251bWJlcidcbiAqIGltcG9ydCB7IHBpcGUgfSBmcm9tICdmcC10cy9mdW5jdGlvbidcbiAqXG4gKiBpbnRlcmZhY2UgUGVyc29uIHtcbiAqICAgcmVhZG9ubHkgbmFtZTogc3RyaW5nXG4gKiAgIHJlYWRvbmx5IGFnZTogbnVtYmVyXG4gKiB9XG4gKiBjb25zdCBieU5hbWUgPSBwaXBlKFMuT3JkLCBjb250cmFtYXAoKHA6IFBlcnNvbikgPT4gcC5uYW1lKSlcbiAqIGNvbnN0IGJ5QWdlID0gcGlwZShOLk9yZCwgY29udHJhbWFwKChwOiBQZXJzb24pID0+IHAuYWdlKSlcbiAqXG4gKiBjb25zdCBzb3J0QnlOYW1lQnlBZ2UgPSBzb3J0QnkoW2J5TmFtZSwgYnlBZ2VdKVxuICpcbiAqIGNvbnN0IHBlcnNvbnMgPSBbeyBuYW1lOiAnYScsIGFnZTogMSB9LCB7IG5hbWU6ICdiJywgYWdlOiAzIH0sIHsgbmFtZTogJ2MnLCBhZ2U6IDIgfSwgeyBuYW1lOiAnYicsIGFnZTogMiB9XVxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChzb3J0QnlOYW1lQnlBZ2UocGVyc29ucyksIFtcbiAqICAgeyBuYW1lOiAnYScsIGFnZTogMSB9LFxuICogICB7IG5hbWU6ICdiJywgYWdlOiAyIH0sXG4gKiAgIHsgbmFtZTogJ2InLCBhZ2U6IDMgfSxcbiAqICAgeyBuYW1lOiAnYycsIGFnZTogMiB9XG4gKiBdKVxuICpcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIHNvcnRCeSA9IGZ1bmN0aW9uIChvcmRzKSB7XG4gICAgdmFyIGYgPSBSTkVBLnNvcnRCeShvcmRzKTtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7IHJldHVybiAoaXNOb25FbXB0eShhcykgPyBmKGFzKSA6IGFzKTsgfTtcbn07XG4vKipcbiAqIEEgdXNlZnVsIHJlY3Vyc2lvbiBwYXR0ZXJuIGZvciBwcm9jZXNzaW5nIGEgYFJlYWRvbmx5QXJyYXlgIHRvIHByb2R1Y2UgYSBuZXcgYFJlYWRvbmx5QXJyYXlgLCBvZnRlbiB1c2VkIGZvciBcImNob3BwaW5nXCIgdXAgdGhlIGlucHV0XG4gKiBgUmVhZG9ubHlBcnJheWAuIFR5cGljYWxseSBgY2hvcGAgaXMgY2FsbGVkIHdpdGggc29tZSBmdW5jdGlvbiB0aGF0IHdpbGwgY29uc3VtZSBhbiBpbml0aWFsIHByZWZpeCBvZiB0aGUgYFJlYWRvbmx5QXJyYXlgIGFuZCBwcm9kdWNlIGFcbiAqIHZhbHVlIGFuZCB0aGUgdGFpbCBvZiB0aGUgYFJlYWRvbmx5QXJyYXlgLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBFcSB9IGZyb20gJ2ZwLXRzL0VxJ1xuICogaW1wb3J0ICogYXMgUkEgZnJvbSAnZnAtdHMvUmVhZG9ubHlBcnJheSdcbiAqIGltcG9ydCAqIGFzIE4gZnJvbSAnZnAtdHMvbnVtYmVyJ1xuICogaW1wb3J0IHsgcGlwZSB9IGZyb20gJ2ZwLXRzL2Z1bmN0aW9uJ1xuICpcbiAqIGNvbnN0IGdyb3VwID0gPEE+KFM6IEVxPEE+KTogKChhczogUmVhZG9ubHlBcnJheTxBPikgPT4gUmVhZG9ubHlBcnJheTxSZWFkb25seUFycmF5PEE+PikgPT4ge1xuICogICByZXR1cm4gUkEuY2hvcChhcyA9PiB7XG4gKiAgICAgY29uc3QgeyBpbml0LCByZXN0IH0gPSBwaXBlKGFzLCBSQS5zcGFuTGVmdCgoYTogQSkgPT4gUy5lcXVhbHMoYSwgYXNbMF0pKSlcbiAqICAgICByZXR1cm4gW2luaXQsIHJlc3RdXG4gKiAgIH0pXG4gKiB9XG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKGdyb3VwKE4uRXEpKFsxLCAxLCAyLCAzLCAzLCA0XSksIFtbMSwgMV0sIFsyXSwgWzMsIDNdLCBbNF1dKVxuICpcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIGNob3AgPSBmdW5jdGlvbiAoZikge1xuICAgIHZhciBnID0gUk5FQS5jaG9wKGYpO1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHsgcmV0dXJuIChpc05vbkVtcHR5KGFzKSA/IGcoYXMpIDogZW1wdHkpOyB9O1xufTtcbi8qKlxuICogU3BsaXRzIGEgYFJlYWRvbmx5QXJyYXlgIGludG8gdHdvIHBpZWNlcywgdGhlIGZpcnN0IHBpZWNlIGhhcyBtYXggYG5gIGVsZW1lbnRzLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBzcGxpdEF0IH0gZnJvbSAnZnAtdHMvUmVhZG9ubHlBcnJheSdcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKHNwbGl0QXQoMikoWzEsIDIsIDMsIDQsIDVdKSwgW1sxLCAyXSwgWzMsIDQsIDVdXSlcbiAqXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBzcGxpdEF0ID0gZnVuY3Rpb24gKG4pIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIHJldHVybiBuID49IDEgJiYgaXNOb25FbXB0eShhcykgPyBSTkVBLnNwbGl0QXQobikoYXMpIDogaXNFbXB0eShhcykgPyBbYXMsIGVtcHR5XSA6IFtlbXB0eSwgYXNdO1xuICAgIH07XG59O1xuLyoqXG4gKiBTcGxpdHMgYSBgUmVhZG9ubHlBcnJheWAgaW50byBsZW5ndGgtYG5gIHBpZWNlcy4gVGhlIGxhc3QgcGllY2Ugd2lsbCBiZSBzaG9ydGVyIGlmIGBuYCBkb2VzIG5vdCBldmVubHkgZGl2aWRlIHRoZSBsZW5ndGggb2ZcbiAqIHRoZSBgUmVhZG9ubHlBcnJheWAuIE5vdGUgdGhhdCBgY2h1bmtzT2YobikoW10pYCBpcyBgW11gLCBub3QgYFtbXV1gLiBUaGlzIGlzIGludGVudGlvbmFsLCBhbmQgaXMgY29uc2lzdGVudCB3aXRoIGEgcmVjdXJzaXZlXG4gKiBkZWZpbml0aW9uIG9mIGBjaHVua3NPZmA7IGl0IHNhdGlzZmllcyB0aGUgcHJvcGVydHkgdGhhdDpcbiAqXG4gKiBgYGB0c1xuICogY2h1bmtzT2YobikoeHMpLmNvbmNhdChjaHVua3NPZihuKSh5cykpID09IGNodW5rc09mKG4pKHhzLmNvbmNhdCh5cykpKVxuICogYGBgXG4gKlxuICogd2hlbmV2ZXIgYG5gIGV2ZW5seSBkaXZpZGVzIHRoZSBsZW5ndGggb2YgYGFzYC5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgY2h1bmtzT2YgfSBmcm9tICdmcC10cy9SZWFkb25seUFycmF5J1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoY2h1bmtzT2YoMikoWzEsIDIsIDMsIDQsIDVdKSwgW1sxLCAyXSwgWzMsIDRdLCBbNV1dKVxuICpcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIGNodW5rc09mID0gZnVuY3Rpb24gKG4pIHtcbiAgICB2YXIgZiA9IFJORUEuY2h1bmtzT2Yobik7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykgeyByZXR1cm4gKGlzTm9uRW1wdHkoYXMpID8gZihhcykgOiBlbXB0eSk7IH07XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgbGlmdGluZ1xuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIGZyb21PcHRpb25LID0gZnVuY3Rpb24gKGYpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgYSA9IFtdO1xuICAgICAgICBmb3IgKHZhciBfaSA9IDA7IF9pIDwgYXJndW1lbnRzLmxlbmd0aDsgX2krKykge1xuICAgICAgICAgICAgYVtfaV0gPSBhcmd1bWVudHNbX2ldO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBmcm9tT3B0aW9uKGYuYXBwbHkodm9pZCAwLCBhKSk7XG4gICAgfTtcbn07XG5leHBvcnQgZnVuY3Rpb24gY29tcHJlaGVuc2lvbihpbnB1dCwgZiwgZykge1xuICAgIGlmIChnID09PSB2b2lkIDApIHsgZyA9IGZ1bmN0aW9uICgpIHsgcmV0dXJuIHRydWU7IH07IH1cbiAgICB2YXIgZ28gPSBmdW5jdGlvbiAoc2NvcGUsIGlucHV0KSB7XG4gICAgICAgIHJldHVybiBpc05vbkVtcHR5KGlucHV0KVxuICAgICAgICAgICAgPyBmbGF0TWFwKFJORUEuaGVhZChpbnB1dCksIGZ1bmN0aW9uIChhKSB7IHJldHVybiBnbyhwaXBlKHNjb3BlLCBhcHBlbmQoYSkpLCBSTkVBLnRhaWwoaW5wdXQpKTsgfSlcbiAgICAgICAgICAgIDogZy5hcHBseSh2b2lkIDAsIHNjb3BlKSA/IFtmLmFwcGx5KHZvaWQgMCwgc2NvcGUpXVxuICAgICAgICAgICAgICAgIDogZW1wdHk7XG4gICAgfTtcbiAgICByZXR1cm4gZ28oZW1wdHksIGlucHV0KTtcbn1cbi8qKlxuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIGNvbmNhdFcgPSBmdW5jdGlvbiAoc2Vjb25kKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChmaXJzdCkge1xuICAgICAgICByZXR1cm4gaXNFbXB0eShmaXJzdCkgPyBzZWNvbmQgOiBpc0VtcHR5KHNlY29uZCkgPyBmaXJzdCA6IGZpcnN0LmNvbmNhdChzZWNvbmQpO1xuICAgIH07XG59O1xuLyoqXG4gKiBAc2luY2UgMi4xMS4wXG4gKi9cbmV4cG9ydCB2YXIgY29uY2F0ID0gY29uY2F0VztcbmV4cG9ydCBmdW5jdGlvbiB1bmlvbihFKSB7XG4gICAgdmFyIHVuaW9uRSA9IFJORUEudW5pb24oRSk7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChmaXJzdCwgc2Vjb25kKSB7XG4gICAgICAgIGlmIChzZWNvbmQgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgdmFyIHVuaW9uRV8xID0gdW5pb24oRSk7XG4gICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24gKHNlY29uZCkgeyByZXR1cm4gdW5pb25FXzEoc2Vjb25kLCBmaXJzdCk7IH07XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGlzTm9uRW1wdHkoZmlyc3QpICYmIGlzTm9uRW1wdHkoc2Vjb25kKSA/IHVuaW9uRShzZWNvbmQpKGZpcnN0KSA6IGlzTm9uRW1wdHkoZmlyc3QpID8gZmlyc3QgOiBzZWNvbmQ7XG4gICAgfTtcbn1cbmV4cG9ydCBmdW5jdGlvbiBpbnRlcnNlY3Rpb24oRSkge1xuICAgIHZhciBlbGVtRSA9IGVsZW0oRSk7XG4gICAgcmV0dXJuIGZ1bmN0aW9uICh4cywgeXMpIHtcbiAgICAgICAgaWYgKHlzID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIHZhciBpbnRlcnNlY3Rpb25FXzEgPSBpbnRlcnNlY3Rpb24oRSk7XG4gICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24gKHlzKSB7IHJldHVybiBpbnRlcnNlY3Rpb25FXzEoeXMsIHhzKTsgfTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4geHMuZmlsdGVyKGZ1bmN0aW9uIChhKSB7IHJldHVybiBlbGVtRShhLCB5cyk7IH0pO1xuICAgIH07XG59XG5leHBvcnQgZnVuY3Rpb24gZGlmZmVyZW5jZShFKSB7XG4gICAgdmFyIGVsZW1FID0gZWxlbShFKTtcbiAgICByZXR1cm4gZnVuY3Rpb24gKHhzLCB5cykge1xuICAgICAgICBpZiAoeXMgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgdmFyIGRpZmZlcmVuY2VFXzEgPSBkaWZmZXJlbmNlKEUpO1xuICAgICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uICh5cykgeyByZXR1cm4gZGlmZmVyZW5jZUVfMSh5cywgeHMpOyB9O1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB4cy5maWx0ZXIoZnVuY3Rpb24gKGEpIHsgcmV0dXJuICFlbGVtRShhLCB5cyk7IH0pO1xuICAgIH07XG59XG52YXIgX21hcCA9IGZ1bmN0aW9uIChmYSwgZikgeyByZXR1cm4gcGlwZShmYSwgbWFwKGYpKTsgfTtcbnZhciBfbWFwV2l0aEluZGV4ID0gZnVuY3Rpb24gKGZhLCBmKSB7IHJldHVybiBwaXBlKGZhLCBtYXBXaXRoSW5kZXgoZikpOyB9O1xudmFyIF9hcCA9IGZ1bmN0aW9uIChmYWIsIGZhKSB7IHJldHVybiBwaXBlKGZhYiwgYXAoZmEpKTsgfTtcbnZhciBfZmlsdGVyID0gZnVuY3Rpb24gKGZhLCBwcmVkaWNhdGUpIHtcbiAgICByZXR1cm4gcGlwZShmYSwgZmlsdGVyKHByZWRpY2F0ZSkpO1xufTtcbnZhciBfZmlsdGVyTWFwID0gZnVuY3Rpb24gKGZhLCBmKSB7IHJldHVybiBwaXBlKGZhLCBmaWx0ZXJNYXAoZikpOyB9O1xudmFyIF9wYXJ0aXRpb24gPSBmdW5jdGlvbiAoZmEsIHByZWRpY2F0ZSkge1xuICAgIHJldHVybiBwaXBlKGZhLCBwYXJ0aXRpb24ocHJlZGljYXRlKSk7XG59O1xudmFyIF9wYXJ0aXRpb25NYXAgPSBmdW5jdGlvbiAoZmEsIGYpIHsgcmV0dXJuIHBpcGUoZmEsIHBhcnRpdGlvbk1hcChmKSk7IH07XG52YXIgX3BhcnRpdGlvbldpdGhJbmRleCA9IGZ1bmN0aW9uIChmYSwgcHJlZGljYXRlV2l0aEluZGV4KSB7IHJldHVybiBwaXBlKGZhLCBwYXJ0aXRpb25XaXRoSW5kZXgocHJlZGljYXRlV2l0aEluZGV4KSk7IH07XG52YXIgX3BhcnRpdGlvbk1hcFdpdGhJbmRleCA9IGZ1bmN0aW9uIChmYSwgZikgeyByZXR1cm4gcGlwZShmYSwgcGFydGl0aW9uTWFwV2l0aEluZGV4KGYpKTsgfTtcbnZhciBfYWx0ID0gZnVuY3Rpb24gKGZhLCB0aGF0KSB7IHJldHVybiBwaXBlKGZhLCBhbHQodGhhdCkpOyB9O1xudmFyIF9yZWR1Y2UgPSBmdW5jdGlvbiAoZmEsIGIsIGYpIHsgcmV0dXJuIHBpcGUoZmEsIHJlZHVjZShiLCBmKSk7IH07XG52YXIgX2ZvbGRNYXAgPSBmdW5jdGlvbiAoTSkge1xuICAgIHZhciBmb2xkTWFwTSA9IGZvbGRNYXAoTSk7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChmYSwgZikgeyByZXR1cm4gcGlwZShmYSwgZm9sZE1hcE0oZikpOyB9O1xufTtcbnZhciBfcmVkdWNlUmlnaHQgPSBmdW5jdGlvbiAoZmEsIGIsIGYpIHsgcmV0dXJuIHBpcGUoZmEsIHJlZHVjZVJpZ2h0KGIsIGYpKTsgfTtcbnZhciBfcmVkdWNlV2l0aEluZGV4ID0gZnVuY3Rpb24gKGZhLCBiLCBmKSB7XG4gICAgcmV0dXJuIHBpcGUoZmEsIHJlZHVjZVdpdGhJbmRleChiLCBmKSk7XG59O1xudmFyIF9mb2xkTWFwV2l0aEluZGV4ID0gZnVuY3Rpb24gKE0pIHtcbiAgICB2YXIgZm9sZE1hcFdpdGhJbmRleE0gPSBmb2xkTWFwV2l0aEluZGV4KE0pO1xuICAgIHJldHVybiBmdW5jdGlvbiAoZmEsIGYpIHsgcmV0dXJuIHBpcGUoZmEsIGZvbGRNYXBXaXRoSW5kZXhNKGYpKTsgfTtcbn07XG52YXIgX3JlZHVjZVJpZ2h0V2l0aEluZGV4ID0gZnVuY3Rpb24gKGZhLCBiLCBmKSB7XG4gICAgcmV0dXJuIHBpcGUoZmEsIHJlZHVjZVJpZ2h0V2l0aEluZGV4KGIsIGYpKTtcbn07XG52YXIgX2ZpbHRlck1hcFdpdGhJbmRleCA9IGZ1bmN0aW9uIChmYSwgZikgeyByZXR1cm4gcGlwZShmYSwgZmlsdGVyTWFwV2l0aEluZGV4KGYpKTsgfTtcbnZhciBfZmlsdGVyV2l0aEluZGV4ID0gZnVuY3Rpb24gKGZhLCBwcmVkaWNhdGVXaXRoSW5kZXgpIHsgcmV0dXJuIHBpcGUoZmEsIGZpbHRlcldpdGhJbmRleChwcmVkaWNhdGVXaXRoSW5kZXgpKTsgfTtcbnZhciBfZXh0ZW5kID0gZnVuY3Rpb24gKGZhLCBmKSB7IHJldHVybiBwaXBlKGZhLCBleHRlbmQoZikpOyB9O1xudmFyIF90cmF2ZXJzZSA9IGZ1bmN0aW9uIChGKSB7XG4gICAgdmFyIHRyYXZlcnNlRiA9IHRyYXZlcnNlKEYpO1xuICAgIHJldHVybiBmdW5jdGlvbiAodGEsIGYpIHsgcmV0dXJuIHBpcGUodGEsIHRyYXZlcnNlRihmKSk7IH07XG59O1xuLyogaXN0YW5idWwgaWdub3JlIG5leHQgKi9cbnZhciBfdHJhdmVyc2VXaXRoSW5kZXggPSBmdW5jdGlvbiAoRikge1xuICAgIHZhciB0cmF2ZXJzZVdpdGhJbmRleEYgPSB0cmF2ZXJzZVdpdGhJbmRleChGKTtcbiAgICByZXR1cm4gZnVuY3Rpb24gKHRhLCBmKSB7IHJldHVybiBwaXBlKHRhLCB0cmF2ZXJzZVdpdGhJbmRleEYoZikpOyB9O1xufTtcbi8qKiBAaW50ZXJuYWwgKi9cbmV4cG9ydCB2YXIgX2NoYWluUmVjRGVwdGhGaXJzdCA9IGZ1bmN0aW9uIChhLCBmKSB7IHJldHVybiBwaXBlKGEsIGNoYWluUmVjRGVwdGhGaXJzdChmKSk7IH07XG4vKiogQGludGVybmFsICovXG5leHBvcnQgdmFyIF9jaGFpblJlY0JyZWFkdGhGaXJzdCA9IGZ1bmN0aW9uIChhLCBmKSB7IHJldHVybiBwaXBlKGEsIGNoYWluUmVjQnJlYWR0aEZpcnN0KGYpKTsgfTtcbi8qKlxuICogQGNhdGVnb3J5IGNvbnN0cnVjdG9yc1xuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgb2YgPSBSTkVBLm9mO1xuLyoqXG4gKiBAc2luY2UgMi43LjBcbiAqL1xuZXhwb3J0IHZhciB6ZXJvID0gZnVuY3Rpb24gKCkgeyByZXR1cm4gZW1wdHk7IH07XG4vKipcbiAqIExlc3Mgc3RyaWN0IHZlcnNpb24gb2YgW2BhbHRgXSgjYWx0KS5cbiAqXG4gKiBUaGUgYFdgIHN1ZmZpeCAoc2hvcnQgZm9yICoqVyoqaWRlbmluZykgbWVhbnMgdGhhdCB0aGUgcmV0dXJuIHR5cGVzIHdpbGwgYmUgbWVyZ2VkLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgKiBhcyBSQSBmcm9tICdmcC10cy9SZWFkb25seUFycmF5J1xuICogaW1wb3J0IHsgcGlwZSB9IGZyb20gJ2ZwLXRzL2Z1bmN0aW9uJ1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoXG4gKiAgIHBpcGUoXG4gKiAgICAgWzEsIDIsIDNdLFxuICogICAgIFJBLmFsdFcoKCkgPT4gWydhJywgJ2InXSlcbiAqICAgKSxcbiAqICAgWzEsIDIsIDMsICdhJywgJ2InXVxuICogKVxuICpcbiAqIEBjYXRlZ29yeSBlcnJvciBoYW5kbGluZ1xuICogQHNpbmNlIDIuOS4wXG4gKi9cbmV4cG9ydCB2YXIgYWx0VyA9IGZ1bmN0aW9uICh0aGF0KSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChmYSkge1xuICAgICAgICByZXR1cm4gZmEuY29uY2F0KHRoYXQoKSk7XG4gICAgfTtcbn07XG4vKipcbiAqIElkZW50aWZpZXMgYW4gYXNzb2NpYXRpdmUgb3BlcmF0aW9uIG9uIGEgdHlwZSBjb25zdHJ1Y3Rvci4gSXQgaXMgc2ltaWxhciB0byBgU2VtaWdyb3VwYCwgZXhjZXB0IHRoYXQgaXQgYXBwbGllcyB0b1xuICogdHlwZXMgb2Yga2luZCBgKiAtPiAqYC5cbiAqXG4gKiBJbiBjYXNlIG9mIGBSZWFkb25seUFycmF5YCBjb25jYXRlbmF0ZXMgdGhlIGlucHV0cyBpbnRvIGEgc2luZ2xlIGFycmF5LlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgKiBhcyBSQSBmcm9tICdmcC10cy9SZWFkb25seUFycmF5J1xuICogaW1wb3J0IHsgcGlwZSB9IGZyb20gJ2ZwLXRzL2Z1bmN0aW9uJ1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoXG4gKiAgIHBpcGUoXG4gKiAgICAgWzEsIDIsIDNdLFxuICogICAgIFJBLmFsdCgoKSA9PiBbNCwgNV0pXG4gKiAgICksXG4gKiAgIFsxLCAyLCAzLCA0LCA1XVxuICogKVxuICpcbiAqIEBjYXRlZ29yeSBlcnJvciBoYW5kbGluZ1xuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgYWx0ID0gYWx0Vztcbi8qKlxuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgYXAgPSBmdW5jdGlvbiAoZmEpIHtcbiAgICByZXR1cm4gZmxhdE1hcChmdW5jdGlvbiAoZikgeyByZXR1cm4gcGlwZShmYSwgbWFwKGYpKTsgfSk7XG59O1xuLyoqXG4gKiBDb21wb3NlcyBjb21wdXRhdGlvbnMgaW4gc2VxdWVuY2UsIHVzaW5nIHRoZSByZXR1cm4gdmFsdWUgb2Ygb25lIGNvbXB1dGF0aW9uIHRvIGRldGVybWluZSB0aGUgbmV4dCBjb21wdXRhdGlvbi5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0ICogYXMgUkEgZnJvbSAnZnAtdHMvUmVhZG9ubHlBcnJheSdcbiAqIGltcG9ydCB7IHBpcGUgfSBmcm9tICdmcC10cy9mdW5jdGlvbidcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKFxuICogICBwaXBlKFxuICogICAgIFsxLCAyLCAzXSxcbiAqICAgICBSQS5mbGF0TWFwKChuKSA9PiBbYGEke259YCwgYGIke259YF0pXG4gKiAgICksXG4gKiAgIFsnYTEnLCAnYjEnLCAnYTInLCAnYjInLCAnYTMnLCAnYjMnXVxuICogKVxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChcbiAqICAgcGlwZShcbiAqICAgICBbMSwgMiwgM10sXG4gKiAgICAgUkEuZmxhdE1hcCgoKSA9PiBbXSlcbiAqICAgKSxcbiAqICAgW11cbiAqIClcbiAqXG4gKiBAY2F0ZWdvcnkgc2VxdWVuY2luZ1xuICogQHNpbmNlIDIuMTQuMFxuICovXG5leHBvcnQgdmFyIGZsYXRNYXAgPSAvKiNfX1BVUkVfXyovIGR1YWwoMiwgZnVuY3Rpb24gKG1hLCBmKSB7XG4gICAgcmV0dXJuIHBpcGUobWEsIGNoYWluV2l0aEluZGV4KGZ1bmN0aW9uIChpLCBhKSB7IHJldHVybiBmKGEsIGkpOyB9KSk7XG59KTtcbi8qKlxuICogQGNhdGVnb3J5IHNlcXVlbmNpbmdcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIGZsYXR0ZW4gPSAvKiNfX1BVUkVfXyovIGZsYXRNYXAoaWRlbnRpdHkpO1xuLyoqXG4gKiBgbWFwYCBjYW4gYmUgdXNlZCB0byB0dXJuIGZ1bmN0aW9ucyBgKGE6IEEpID0+IEJgIGludG8gZnVuY3Rpb25zIGAoZmE6IEY8QT4pID0+IEY8Qj5gIHdob3NlIGFyZ3VtZW50IGFuZCByZXR1cm4gdHlwZXNcbiAqIHVzZSB0aGUgdHlwZSBjb25zdHJ1Y3RvciBgRmAgdG8gcmVwcmVzZW50IHNvbWUgY29tcHV0YXRpb25hbCBjb250ZXh0LlxuICpcbiAqIEBjYXRlZ29yeSBtYXBwaW5nXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBtYXAgPSBmdW5jdGlvbiAoZikgeyByZXR1cm4gZnVuY3Rpb24gKGZhKSB7XG4gICAgcmV0dXJuIGZhLm1hcChmdW5jdGlvbiAoYSkgeyByZXR1cm4gZihhKTsgfSk7XG59OyB9O1xuLyoqXG4gKiBAY2F0ZWdvcnkgbWFwcGluZ1xuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgbWFwV2l0aEluZGV4ID0gZnVuY3Rpb24gKGYpIHsgcmV0dXJuIGZ1bmN0aW9uIChmYSkge1xuICAgIHJldHVybiBmYS5tYXAoZnVuY3Rpb24gKGEsIGkpIHsgcmV0dXJuIGYoaSwgYSk7IH0pO1xufTsgfTtcbi8qKlxuICogQGNhdGVnb3J5IGZpbHRlcmluZ1xuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgc2VwYXJhdGUgPSBmdW5jdGlvbiAoZmEpIHtcbiAgICB2YXIgbGVmdCA9IFtdO1xuICAgIHZhciByaWdodCA9IFtdO1xuICAgIGZvciAodmFyIF9pID0gMCwgZmFfMSA9IGZhOyBfaSA8IGZhXzEubGVuZ3RoOyBfaSsrKSB7XG4gICAgICAgIHZhciBlID0gZmFfMVtfaV07XG4gICAgICAgIGlmIChlLl90YWcgPT09ICdMZWZ0Jykge1xuICAgICAgICAgICAgbGVmdC5wdXNoKGUubGVmdCk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICByaWdodC5wdXNoKGUucmlnaHQpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiBzZXBhcmF0ZWQobGVmdCwgcmlnaHQpO1xufTtcbi8qKlxuICogQGNhdGVnb3J5IGZpbHRlcmluZ1xuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgZmlsdGVyID0gZnVuY3Rpb24gKHByZWRpY2F0ZSkge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgcmV0dXJuIGFzLmZpbHRlcihwcmVkaWNhdGUpO1xuICAgIH07XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgZmlsdGVyaW5nXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBmaWx0ZXJNYXBXaXRoSW5kZXggPSBmdW5jdGlvbiAoZikge1xuICAgIHJldHVybiBmdW5jdGlvbiAoZmEpIHtcbiAgICAgICAgdmFyIG91dCA9IFtdO1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGZhLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICB2YXIgb3B0aW9uQiA9IGYoaSwgZmFbaV0pO1xuICAgICAgICAgICAgaWYgKF8uaXNTb21lKG9wdGlvbkIpKSB7XG4gICAgICAgICAgICAgICAgb3V0LnB1c2gob3B0aW9uQi52YWx1ZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG91dDtcbiAgICB9O1xufTtcbi8qKlxuICogQGNhdGVnb3J5IGZpbHRlcmluZ1xuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgZmlsdGVyTWFwID0gZnVuY3Rpb24gKGYpIHtcbiAgICByZXR1cm4gZmlsdGVyTWFwV2l0aEluZGV4KGZ1bmN0aW9uIChfLCBhKSB7IHJldHVybiBmKGEpOyB9KTtcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBmaWx0ZXJpbmdcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIGNvbXBhY3QgPSAvKiNfX1BVUkVfXyovIGZpbHRlck1hcChpZGVudGl0eSk7XG4vKipcbiAqIEBjYXRlZ29yeSBmaWx0ZXJpbmdcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIHBhcnRpdGlvbiA9IGZ1bmN0aW9uIChwcmVkaWNhdGUpIHtcbiAgICByZXR1cm4gcGFydGl0aW9uV2l0aEluZGV4KGZ1bmN0aW9uIChfLCBhKSB7IHJldHVybiBwcmVkaWNhdGUoYSk7IH0pO1xufTtcbi8qKlxuICogQGNhdGVnb3J5IGZpbHRlcmluZ1xuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgcGFydGl0aW9uV2l0aEluZGV4ID0gZnVuY3Rpb24gKHByZWRpY2F0ZVdpdGhJbmRleCkge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgdmFyIGxlZnQgPSBbXTtcbiAgICAgICAgdmFyIHJpZ2h0ID0gW107XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgYXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIHZhciBhID0gYXNbaV07XG4gICAgICAgICAgICBpZiAocHJlZGljYXRlV2l0aEluZGV4KGksIGEpKSB7XG4gICAgICAgICAgICAgICAgcmlnaHQucHVzaChhKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIGxlZnQucHVzaChhKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gc2VwYXJhdGVkKGxlZnQsIHJpZ2h0KTtcbiAgICB9O1xufTtcbi8qKlxuICogQGNhdGVnb3J5IGZpbHRlcmluZ1xuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgcGFydGl0aW9uTWFwID0gZnVuY3Rpb24gKGYpIHtcbiAgICByZXR1cm4gcGFydGl0aW9uTWFwV2l0aEluZGV4KGZ1bmN0aW9uIChfLCBhKSB7IHJldHVybiBmKGEpOyB9KTtcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBmaWx0ZXJpbmdcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIHBhcnRpdGlvbk1hcFdpdGhJbmRleCA9IGZ1bmN0aW9uIChmKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChmYSkge1xuICAgICAgICB2YXIgbGVmdCA9IFtdO1xuICAgICAgICB2YXIgcmlnaHQgPSBbXTtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBmYS5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgdmFyIGUgPSBmKGksIGZhW2ldKTtcbiAgICAgICAgICAgIGlmIChlLl90YWcgPT09ICdMZWZ0Jykge1xuICAgICAgICAgICAgICAgIGxlZnQucHVzaChlLmxlZnQpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgcmlnaHQucHVzaChlLnJpZ2h0KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gc2VwYXJhdGVkKGxlZnQsIHJpZ2h0KTtcbiAgICB9O1xufTtcbi8qKlxuICogQGNhdGVnb3J5IGZpbHRlcmluZ1xuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgZmlsdGVyV2l0aEluZGV4ID0gZnVuY3Rpb24gKHByZWRpY2F0ZVdpdGhJbmRleCkge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgcmV0dXJuIGFzLmZpbHRlcihmdW5jdGlvbiAoYSwgaSkgeyByZXR1cm4gcHJlZGljYXRlV2l0aEluZGV4KGksIGEpOyB9KTtcbiAgICB9O1xufTtcbi8qKlxuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgZXh0ZW5kID0gZnVuY3Rpb24gKGYpIHsgcmV0dXJuIGZ1bmN0aW9uICh3YSkge1xuICAgIHJldHVybiB3YS5tYXAoZnVuY3Rpb24gKF8sIGkpIHsgcmV0dXJuIGYod2Euc2xpY2UoaSkpOyB9KTtcbn07IH07XG4vKipcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIGR1cGxpY2F0ZSA9IC8qI19fUFVSRV9fKi8gZXh0ZW5kKGlkZW50aXR5KTtcbi8qKlxuICogQGNhdGVnb3J5IGZvbGRpbmdcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIGZvbGRNYXBXaXRoSW5kZXggPSBmdW5jdGlvbiAoTSkge1xuICAgIHJldHVybiBmdW5jdGlvbiAoZikge1xuICAgICAgICByZXR1cm4gZnVuY3Rpb24gKGZhKSB7XG4gICAgICAgICAgICByZXR1cm4gZmEucmVkdWNlKGZ1bmN0aW9uIChiLCBhLCBpKSB7IHJldHVybiBNLmNvbmNhdChiLCBmKGksIGEpKTsgfSwgTS5lbXB0eSk7XG4gICAgICAgIH07XG4gICAgfTtcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBmb2xkaW5nXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciByZWR1Y2UgPSBmdW5jdGlvbiAoYiwgZikge1xuICAgIHJldHVybiByZWR1Y2VXaXRoSW5kZXgoYiwgZnVuY3Rpb24gKF8sIGIsIGEpIHsgcmV0dXJuIGYoYiwgYSk7IH0pO1xufTtcbi8qKlxuICogQGNhdGVnb3J5IGZvbGRpbmdcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIGZvbGRNYXAgPSBmdW5jdGlvbiAoTSkge1xuICAgIHZhciBmb2xkTWFwV2l0aEluZGV4TSA9IGZvbGRNYXBXaXRoSW5kZXgoTSk7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChmKSB7IHJldHVybiBmb2xkTWFwV2l0aEluZGV4TShmdW5jdGlvbiAoXywgYSkgeyByZXR1cm4gZihhKTsgfSk7IH07XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgZm9sZGluZ1xuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgcmVkdWNlV2l0aEluZGV4ID0gZnVuY3Rpb24gKGIsIGYpIHsgcmV0dXJuIGZ1bmN0aW9uIChmYSkge1xuICAgIHZhciBsZW4gPSBmYS5sZW5ndGg7XG4gICAgdmFyIG91dCA9IGI7XG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBsZW47IGkrKykge1xuICAgICAgICBvdXQgPSBmKGksIG91dCwgZmFbaV0pO1xuICAgIH1cbiAgICByZXR1cm4gb3V0O1xufTsgfTtcbi8qKlxuICogQGNhdGVnb3J5IGZvbGRpbmdcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIHJlZHVjZVJpZ2h0ID0gZnVuY3Rpb24gKGIsIGYpIHtcbiAgICByZXR1cm4gcmVkdWNlUmlnaHRXaXRoSW5kZXgoYiwgZnVuY3Rpb24gKF8sIGEsIGIpIHsgcmV0dXJuIGYoYSwgYik7IH0pO1xufTtcbi8qKlxuICogQGNhdGVnb3J5IGZvbGRpbmdcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIHJlZHVjZVJpZ2h0V2l0aEluZGV4ID0gZnVuY3Rpb24gKGIsIGYpIHsgcmV0dXJuIGZ1bmN0aW9uIChmYSkge1xuICAgIHJldHVybiBmYS5yZWR1Y2VSaWdodChmdW5jdGlvbiAoYiwgYSwgaSkgeyByZXR1cm4gZihpLCBhLCBiKTsgfSwgYik7XG59OyB9O1xuLyoqXG4gKiBAY2F0ZWdvcnkgdHJhdmVyc2luZ1xuICogQHNpbmNlIDIuNi4zXG4gKi9cbmV4cG9ydCB2YXIgdHJhdmVyc2UgPSBmdW5jdGlvbiAoRikge1xuICAgIHZhciB0cmF2ZXJzZVdpdGhJbmRleEYgPSB0cmF2ZXJzZVdpdGhJbmRleChGKTtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGYpIHsgcmV0dXJuIHRyYXZlcnNlV2l0aEluZGV4RihmdW5jdGlvbiAoXywgYSkgeyByZXR1cm4gZihhKTsgfSk7IH07XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgdHJhdmVyc2luZ1xuICogQHNpbmNlIDIuNi4zXG4gKi9cbmV4cG9ydCB2YXIgc2VxdWVuY2UgPSBmdW5jdGlvbiAoRikge1xuICAgIHJldHVybiBmdW5jdGlvbiAodGEpIHtcbiAgICAgICAgcmV0dXJuIF9yZWR1Y2UodGEsIEYub2YoemVybygpKSwgZnVuY3Rpb24gKGZhcywgZmEpIHtcbiAgICAgICAgICAgIHJldHVybiBGLmFwKEYubWFwKGZhcywgZnVuY3Rpb24gKGFzKSB7IHJldHVybiBmdW5jdGlvbiAoYSkgeyByZXR1cm4gcGlwZShhcywgYXBwZW5kKGEpKTsgfTsgfSksIGZhKTtcbiAgICAgICAgfSk7XG4gICAgfTtcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBzZXF1ZW5jaW5nXG4gKiBAc2luY2UgMi42LjNcbiAqL1xuZXhwb3J0IHZhciB0cmF2ZXJzZVdpdGhJbmRleCA9IGZ1bmN0aW9uIChGKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChmKSB7XG4gICAgICAgIHJldHVybiByZWR1Y2VXaXRoSW5kZXgoRi5vZih6ZXJvKCkpLCBmdW5jdGlvbiAoaSwgZmJzLCBhKSB7XG4gICAgICAgICAgICByZXR1cm4gRi5hcChGLm1hcChmYnMsIGZ1bmN0aW9uIChicykgeyByZXR1cm4gZnVuY3Rpb24gKGIpIHsgcmV0dXJuIHBpcGUoYnMsIGFwcGVuZChiKSk7IH07IH0pLCBmKGksIGEpKTtcbiAgICAgICAgfSk7XG4gICAgfTtcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBmaWx0ZXJpbmdcbiAqIEBzaW5jZSAyLjYuNVxuICovXG5leHBvcnQgdmFyIHdpdGhlciA9IGZ1bmN0aW9uIChGKSB7XG4gICAgdmFyIF93aXRoZXJGID0gX3dpdGhlcihGKTtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGYpIHsgcmV0dXJuIGZ1bmN0aW9uIChmYSkgeyByZXR1cm4gX3dpdGhlckYoZmEsIGYpOyB9OyB9O1xufTtcbi8qKlxuICogQGNhdGVnb3J5IGZpbHRlcmluZ1xuICogQHNpbmNlIDIuNi41XG4gKi9cbmV4cG9ydCB2YXIgd2lsdCA9IGZ1bmN0aW9uIChGKSB7XG4gICAgdmFyIF93aWx0RiA9IF93aWx0KEYpO1xuICAgIHJldHVybiBmdW5jdGlvbiAoZikgeyByZXR1cm4gZnVuY3Rpb24gKGZhKSB7IHJldHVybiBfd2lsdEYoZmEsIGYpOyB9OyB9O1xufTtcbi8qKlxuICogQHNpbmNlIDIuNi42XG4gKi9cbmV4cG9ydCB2YXIgdW5mb2xkID0gZnVuY3Rpb24gKGIsIGYpIHtcbiAgICB2YXIgb3V0ID0gW107XG4gICAgdmFyIGJiID0gYjtcbiAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tY29uc3RhbnQtY29uZGl0aW9uXG4gICAgd2hpbGUgKHRydWUpIHtcbiAgICAgICAgdmFyIG10ID0gZihiYik7XG4gICAgICAgIGlmIChfLmlzU29tZShtdCkpIHtcbiAgICAgICAgICAgIHZhciBfYSA9IG10LnZhbHVlLCBhID0gX2FbMF0sIGJfMSA9IF9hWzFdO1xuICAgICAgICAgICAgb3V0LnB1c2goYSk7XG4gICAgICAgICAgICBiYiA9IGJfMTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiBvdXQ7XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgdHlwZSBsYW1iZGFzXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBVUkkgPSAnUmVhZG9ubHlBcnJheSc7XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIGdldFNob3cgPSBmdW5jdGlvbiAoUykgeyByZXR1cm4gKHtcbiAgICBzaG93OiBmdW5jdGlvbiAoYXMpIHsgcmV0dXJuIFwiW1wiLmNvbmNhdChhcy5tYXAoUy5zaG93KS5qb2luKCcsICcpLCBcIl1cIik7IH1cbn0pOyB9O1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBnZXRTZW1pZ3JvdXAgPSBmdW5jdGlvbiAoKSB7IHJldHVybiAoe1xuICAgIGNvbmNhdDogZnVuY3Rpb24gKGZpcnN0LCBzZWNvbmQpIHsgcmV0dXJuIChpc0VtcHR5KGZpcnN0KSA/IHNlY29uZCA6IGlzRW1wdHkoc2Vjb25kKSA/IGZpcnN0IDogZmlyc3QuY29uY2F0KHNlY29uZCkpOyB9XG59KTsgfTtcbi8qKlxuICogUmV0dXJucyBhIGBNb25vaWRgIGZvciBgUmVhZG9ubHlBcnJheTxBPmAuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IGdldE1vbm9pZCB9IGZyb20gJ2ZwLXRzL1JlYWRvbmx5QXJyYXknXG4gKlxuICogY29uc3QgTSA9IGdldE1vbm9pZDxudW1iZXI+KClcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoTS5jb25jYXQoWzEsIDJdLCBbMywgNF0pLCBbMSwgMiwgMywgNF0pXG4gKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgZ2V0TW9ub2lkID0gZnVuY3Rpb24gKCkgeyByZXR1cm4gKHtcbiAgICBjb25jYXQ6IGdldFNlbWlncm91cCgpLmNvbmNhdCxcbiAgICBlbXB0eTogZW1wdHlcbn0pOyB9O1xuLyoqXG4gKiBEZXJpdmVzIGFuIGBFcWAgb3ZlciB0aGUgYFJlYWRvbmx5QXJyYXlgIG9mIGEgZ2l2ZW4gZWxlbWVudCB0eXBlIGZyb20gdGhlIGBFcWAgb2YgdGhhdCB0eXBlLiBUaGUgZGVyaXZlZCBgRXFgIGRlZmluZXMgdHdvXG4gKiBhcnJheXMgYXMgZXF1YWwgaWYgYWxsIGVsZW1lbnRzIG9mIGJvdGggYXJyYXlzIGFyZSBjb21wYXJlZCBlcXVhbCBwYWlyd2lzZSB3aXRoIHRoZSBnaXZlbiBgRWAuIEluIGNhc2Ugb2YgYXJyYXlzIG9mXG4gKiBkaWZmZXJlbnQgbGVuZ3RocywgdGhlIHJlc3VsdCBpcyBub24gZXF1YWxpdHkuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCAqIGFzIFMgZnJvbSAnZnAtdHMvc3RyaW5nJ1xuICogaW1wb3J0IHsgZ2V0RXEgfSBmcm9tICdmcC10cy9SZWFkb25seUFycmF5J1xuICpcbiAqIGNvbnN0IEUgPSBnZXRFcShTLkVxKVxuICogYXNzZXJ0LnN0cmljdEVxdWFsKEUuZXF1YWxzKFsnYScsICdiJ10sIFsnYScsICdiJ10pLCB0cnVlKVxuICogYXNzZXJ0LnN0cmljdEVxdWFsKEUuZXF1YWxzKFsnYSddLCBbXSksIGZhbHNlKVxuICpcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIGdldEVxID0gZnVuY3Rpb24gKEUpIHtcbiAgICByZXR1cm4gZnJvbUVxdWFscyhmdW5jdGlvbiAoeHMsIHlzKSB7IHJldHVybiB4cy5sZW5ndGggPT09IHlzLmxlbmd0aCAmJiB4cy5ldmVyeShmdW5jdGlvbiAoeCwgaSkgeyByZXR1cm4gRS5lcXVhbHMoeCwgeXNbaV0pOyB9KTsgfSk7XG59O1xuLyoqXG4gKiBEZXJpdmVzIGFuIGBPcmRgIG92ZXIgdGhlIGBSZWFkb25seUFycmF5YCBvZiBhIGdpdmVuIGVsZW1lbnQgdHlwZSBmcm9tIHRoZSBgT3JkYCBvZiB0aGF0IHR5cGUuIFRoZSBvcmRlcmluZyBiZXR3ZWVuIHR3byBzdWNoXG4gKiBhcnJheXMgaXMgZXF1YWwgdG86IHRoZSBmaXJzdCBub24gZXF1YWwgY29tcGFyaXNvbiBvZiBlYWNoIGFycmF5cyBlbGVtZW50cyB0YWtlbiBwYWlyd2lzZSBpbiBpbmNyZWFzaW5nIG9yZGVyLCBpblxuICogY2FzZSBvZiBlcXVhbGl0eSBvdmVyIGFsbCB0aGUgcGFpcndpc2UgZWxlbWVudHM7IHRoZSBsb25nZXN0IGFycmF5IGlzIGNvbnNpZGVyZWQgdGhlIGdyZWF0ZXN0LCBpZiBib3RoIGFycmF5cyBoYXZlXG4gKiB0aGUgc2FtZSBsZW5ndGgsIHRoZSByZXN1bHQgaXMgZXF1YWxpdHkuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IGdldE9yZCB9IGZyb20gJ2ZwLXRzL1JlYWRvbmx5QXJyYXknXG4gKiBpbXBvcnQgKiBhcyBTIGZyb20gJ2ZwLXRzL3N0cmluZydcbiAqXG4gKiBjb25zdCBPID0gZ2V0T3JkKFMuT3JkKVxuICogYXNzZXJ0LnN0cmljdEVxdWFsKE8uY29tcGFyZShbJ2InXSwgWydhJ10pLCAxKVxuICogYXNzZXJ0LnN0cmljdEVxdWFsKE8uY29tcGFyZShbJ2EnXSwgWydhJ10pLCAwKVxuICogYXNzZXJ0LnN0cmljdEVxdWFsKE8uY29tcGFyZShbJ2EnXSwgWydiJ10pLCAtMSlcbiAqXG4gKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgZ2V0T3JkID0gZnVuY3Rpb24gKE8pIHtcbiAgICByZXR1cm4gZnJvbUNvbXBhcmUoZnVuY3Rpb24gKGEsIGIpIHtcbiAgICAgICAgdmFyIGFMZW4gPSBhLmxlbmd0aDtcbiAgICAgICAgdmFyIGJMZW4gPSBiLmxlbmd0aDtcbiAgICAgICAgdmFyIGxlbiA9IE1hdGgubWluKGFMZW4sIGJMZW4pO1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGxlbjsgaSsrKSB7XG4gICAgICAgICAgICB2YXIgb3JkZXJpbmcgPSBPLmNvbXBhcmUoYVtpXSwgYltpXSk7XG4gICAgICAgICAgICBpZiAob3JkZXJpbmcgIT09IDApIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gb3JkZXJpbmc7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIE4uT3JkLmNvbXBhcmUoYUxlbiwgYkxlbik7XG4gICAgfSk7XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi4xMS4wXG4gKi9cbmV4cG9ydCB2YXIgZ2V0VW5pb25TZW1pZ3JvdXAgPSBmdW5jdGlvbiAoRSkge1xuICAgIHZhciB1bmlvbkUgPSB1bmlvbihFKTtcbiAgICByZXR1cm4ge1xuICAgICAgICBjb25jYXQ6IGZ1bmN0aW9uIChmaXJzdCwgc2Vjb25kKSB7IHJldHVybiB1bmlvbkUoc2Vjb25kKShmaXJzdCk7IH1cbiAgICB9O1xufTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIGdldFVuaW9uTW9ub2lkID0gZnVuY3Rpb24gKEUpIHsgcmV0dXJuICh7XG4gICAgY29uY2F0OiBnZXRVbmlvblNlbWlncm91cChFKS5jb25jYXQsXG4gICAgZW1wdHk6IGVtcHR5XG59KTsgfTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIGdldEludGVyc2VjdGlvblNlbWlncm91cCA9IGZ1bmN0aW9uIChFKSB7XG4gICAgdmFyIGludGVyc2VjdGlvbkUgPSBpbnRlcnNlY3Rpb24oRSk7XG4gICAgcmV0dXJuIHtcbiAgICAgICAgY29uY2F0OiBmdW5jdGlvbiAoZmlyc3QsIHNlY29uZCkgeyByZXR1cm4gaW50ZXJzZWN0aW9uRShzZWNvbmQpKGZpcnN0KTsgfVxuICAgIH07XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi4xMS4wXG4gKi9cbmV4cG9ydCB2YXIgZ2V0RGlmZmVyZW5jZU1hZ21hID0gZnVuY3Rpb24gKEUpIHtcbiAgICB2YXIgZGlmZmVyZW5jZUUgPSBkaWZmZXJlbmNlKEUpO1xuICAgIHJldHVybiB7XG4gICAgICAgIGNvbmNhdDogZnVuY3Rpb24gKGZpcnN0LCBzZWNvbmQpIHsgcmV0dXJuIGRpZmZlcmVuY2VFKHNlY29uZCkoZmlyc3QpOyB9XG4gICAgfTtcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjcuMFxuICovXG5leHBvcnQgdmFyIEZ1bmN0b3IgPSB7XG4gICAgVVJJOiBVUkksXG4gICAgbWFwOiBfbWFwXG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgbWFwcGluZ1xuICogQHNpbmNlIDIuMTAuMFxuICovXG5leHBvcnQgdmFyIGZsYXAgPSAvKiNfX1BVUkVfXyovIGZsYXBfKEZ1bmN0b3IpO1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi4xMC4wXG4gKi9cbmV4cG9ydCB2YXIgUG9pbnRlZCA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICBvZjogb2Zcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjcuMFxuICovXG5leHBvcnQgdmFyIEZ1bmN0b3JXaXRoSW5kZXggPSB7XG4gICAgVVJJOiBVUkksXG4gICAgbWFwOiBfbWFwLFxuICAgIG1hcFdpdGhJbmRleDogX21hcFdpdGhJbmRleFxufTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuMTAuMFxuICovXG5leHBvcnQgdmFyIEFwcGx5ID0ge1xuICAgIFVSSTogVVJJLFxuICAgIG1hcDogX21hcCxcbiAgICBhcDogX2FwXG59O1xuLyoqXG4gKiBDb21iaW5lIHR3byBlZmZlY3RmdWwgYWN0aW9ucywga2VlcGluZyBvbmx5IHRoZSByZXN1bHQgb2YgdGhlIGZpcnN0LlxuICpcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIGFwRmlyc3QgPSAvKiNfX1BVUkVfXyovIGFwRmlyc3RfKEFwcGx5KTtcbi8qKlxuICogQ29tYmluZSB0d28gZWZmZWN0ZnVsIGFjdGlvbnMsIGtlZXBpbmcgb25seSB0aGUgcmVzdWx0IG9mIHRoZSBzZWNvbmQuXG4gKlxuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgYXBTZWNvbmQgPSAvKiNfX1BVUkVfXyovIGFwU2Vjb25kXyhBcHBseSk7XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjcuMFxuICovXG5leHBvcnQgdmFyIEFwcGxpY2F0aXZlID0ge1xuICAgIFVSSTogVVJJLFxuICAgIG1hcDogX21hcCxcbiAgICBhcDogX2FwLFxuICAgIG9mOiBvZlxufTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuMTAuMFxuICovXG5leHBvcnQgdmFyIENoYWluID0ge1xuICAgIFVSSTogVVJJLFxuICAgIG1hcDogX21hcCxcbiAgICBhcDogX2FwLFxuICAgIGNoYWluOiBmbGF0TWFwXG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi43LjBcbiAqL1xuZXhwb3J0IHZhciBNb25hZCA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICBtYXA6IF9tYXAsXG4gICAgYXA6IF9hcCxcbiAgICBvZjogb2YsXG4gICAgY2hhaW46IGZsYXRNYXBcbn07XG4vKipcbiAqIENvbXBvc2VzIGNvbXB1dGF0aW9ucyBpbiBzZXF1ZW5jZSwgdXNpbmcgdGhlIHJldHVybiB2YWx1ZSBvZiBvbmUgY29tcHV0YXRpb24gdG8gZGV0ZXJtaW5lIHRoZSBuZXh0IGNvbXB1dGF0aW9uIGFuZFxuICoga2VlcGluZyBvbmx5IHRoZSByZXN1bHQgb2YgdGhlIGZpcnN0LlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgKiBhcyBSQSBmcm9tICdmcC10cy9SZWFkb25seUFycmF5J1xuICogaW1wb3J0IHsgcGlwZSB9IGZyb20gJ2ZwLXRzL2Z1bmN0aW9uJ1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoXG4gKiAgIHBpcGUoXG4gKiAgICAgWzEsIDIsIDNdLFxuICogICAgIFJBLmNoYWluRmlyc3QoKCkgPT4gWydhJywgJ2InXSlcbiAqICAgKSxcbiAqICAgWzEsIDEsIDIsIDIsIDMsIDNdXG4gKiApXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKFxuICogICBwaXBlKFxuICogICAgIFsxLCAyLCAzXSxcbiAqICAgICBSQS5jaGFpbkZpcnN0KCgpID0+IFtdKVxuICogICApLFxuICogICBbXVxuICogKVxuICpcbiAqIEBjYXRlZ29yeSBzZXF1ZW5jaW5nXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBjaGFpbkZpcnN0ID0gXG4vKiNfX1BVUkVfXyovIGNoYWluRmlyc3RfKENoYWluKTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuNy4wXG4gKi9cbmV4cG9ydCB2YXIgVW5mb2xkYWJsZSA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICB1bmZvbGQ6IHVuZm9sZFxufTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuNy4wXG4gKi9cbmV4cG9ydCB2YXIgQWx0ID0ge1xuICAgIFVSSTogVVJJLFxuICAgIG1hcDogX21hcCxcbiAgICBhbHQ6IF9hbHRcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjExLjBcbiAqL1xuZXhwb3J0IHZhciBaZXJvID0ge1xuICAgIFVSSTogVVJJLFxuICAgIHplcm86IHplcm9cbn07XG4vKipcbiAqIEBjYXRlZ29yeSBkbyBub3RhdGlvblxuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIGd1YXJkID0gLyojX19QVVJFX18qLyBndWFyZF8oWmVybywgUG9pbnRlZCk7XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjcuMFxuICovXG5leHBvcnQgdmFyIEFsdGVybmF0aXZlID0ge1xuICAgIFVSSTogVVJJLFxuICAgIG1hcDogX21hcCxcbiAgICBhcDogX2FwLFxuICAgIG9mOiBvZixcbiAgICBhbHQ6IF9hbHQsXG4gICAgemVybzogemVyb1xufTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuNy4wXG4gKi9cbmV4cG9ydCB2YXIgRXh0ZW5kID0ge1xuICAgIFVSSTogVVJJLFxuICAgIG1hcDogX21hcCxcbiAgICBleHRlbmQ6IF9leHRlbmRcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjcuMFxuICovXG5leHBvcnQgdmFyIENvbXBhY3RhYmxlID0ge1xuICAgIFVSSTogVVJJLFxuICAgIGNvbXBhY3Q6IGNvbXBhY3QsXG4gICAgc2VwYXJhdGU6IHNlcGFyYXRlXG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi43LjBcbiAqL1xuZXhwb3J0IHZhciBGaWx0ZXJhYmxlID0ge1xuICAgIFVSSTogVVJJLFxuICAgIG1hcDogX21hcCxcbiAgICBjb21wYWN0OiBjb21wYWN0LFxuICAgIHNlcGFyYXRlOiBzZXBhcmF0ZSxcbiAgICBmaWx0ZXI6IF9maWx0ZXIsXG4gICAgZmlsdGVyTWFwOiBfZmlsdGVyTWFwLFxuICAgIHBhcnRpdGlvbjogX3BhcnRpdGlvbixcbiAgICBwYXJ0aXRpb25NYXA6IF9wYXJ0aXRpb25NYXBcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjcuMFxuICovXG5leHBvcnQgdmFyIEZpbHRlcmFibGVXaXRoSW5kZXggPSB7XG4gICAgVVJJOiBVUkksXG4gICAgbWFwOiBfbWFwLFxuICAgIG1hcFdpdGhJbmRleDogX21hcFdpdGhJbmRleCxcbiAgICBjb21wYWN0OiBjb21wYWN0LFxuICAgIHNlcGFyYXRlOiBzZXBhcmF0ZSxcbiAgICBmaWx0ZXI6IF9maWx0ZXIsXG4gICAgZmlsdGVyTWFwOiBfZmlsdGVyTWFwLFxuICAgIHBhcnRpdGlvbjogX3BhcnRpdGlvbixcbiAgICBwYXJ0aXRpb25NYXA6IF9wYXJ0aXRpb25NYXAsXG4gICAgcGFydGl0aW9uTWFwV2l0aEluZGV4OiBfcGFydGl0aW9uTWFwV2l0aEluZGV4LFxuICAgIHBhcnRpdGlvbldpdGhJbmRleDogX3BhcnRpdGlvbldpdGhJbmRleCxcbiAgICBmaWx0ZXJNYXBXaXRoSW5kZXg6IF9maWx0ZXJNYXBXaXRoSW5kZXgsXG4gICAgZmlsdGVyV2l0aEluZGV4OiBfZmlsdGVyV2l0aEluZGV4XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi43LjBcbiAqL1xuZXhwb3J0IHZhciBGb2xkYWJsZSA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICByZWR1Y2U6IF9yZWR1Y2UsXG4gICAgZm9sZE1hcDogX2ZvbGRNYXAsXG4gICAgcmVkdWNlUmlnaHQ6IF9yZWR1Y2VSaWdodFxufTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuNy4wXG4gKi9cbmV4cG9ydCB2YXIgRm9sZGFibGVXaXRoSW5kZXggPSB7XG4gICAgVVJJOiBVUkksXG4gICAgcmVkdWNlOiBfcmVkdWNlLFxuICAgIGZvbGRNYXA6IF9mb2xkTWFwLFxuICAgIHJlZHVjZVJpZ2h0OiBfcmVkdWNlUmlnaHQsXG4gICAgcmVkdWNlV2l0aEluZGV4OiBfcmVkdWNlV2l0aEluZGV4LFxuICAgIGZvbGRNYXBXaXRoSW5kZXg6IF9mb2xkTWFwV2l0aEluZGV4LFxuICAgIHJlZHVjZVJpZ2h0V2l0aEluZGV4OiBfcmVkdWNlUmlnaHRXaXRoSW5kZXhcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjcuMFxuICovXG5leHBvcnQgdmFyIFRyYXZlcnNhYmxlID0ge1xuICAgIFVSSTogVVJJLFxuICAgIG1hcDogX21hcCxcbiAgICByZWR1Y2U6IF9yZWR1Y2UsXG4gICAgZm9sZE1hcDogX2ZvbGRNYXAsXG4gICAgcmVkdWNlUmlnaHQ6IF9yZWR1Y2VSaWdodCxcbiAgICB0cmF2ZXJzZTogX3RyYXZlcnNlLFxuICAgIHNlcXVlbmNlOiBzZXF1ZW5jZVxufTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuNy4wXG4gKi9cbmV4cG9ydCB2YXIgVHJhdmVyc2FibGVXaXRoSW5kZXggPSB7XG4gICAgVVJJOiBVUkksXG4gICAgbWFwOiBfbWFwLFxuICAgIG1hcFdpdGhJbmRleDogX21hcFdpdGhJbmRleCxcbiAgICByZWR1Y2U6IF9yZWR1Y2UsXG4gICAgZm9sZE1hcDogX2ZvbGRNYXAsXG4gICAgcmVkdWNlUmlnaHQ6IF9yZWR1Y2VSaWdodCxcbiAgICByZWR1Y2VXaXRoSW5kZXg6IF9yZWR1Y2VXaXRoSW5kZXgsXG4gICAgZm9sZE1hcFdpdGhJbmRleDogX2ZvbGRNYXBXaXRoSW5kZXgsXG4gICAgcmVkdWNlUmlnaHRXaXRoSW5kZXg6IF9yZWR1Y2VSaWdodFdpdGhJbmRleCxcbiAgICB0cmF2ZXJzZTogX3RyYXZlcnNlLFxuICAgIHNlcXVlbmNlOiBzZXF1ZW5jZSxcbiAgICB0cmF2ZXJzZVdpdGhJbmRleDogX3RyYXZlcnNlV2l0aEluZGV4XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgc2VxdWVuY2luZ1xuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIGNoYWluUmVjRGVwdGhGaXJzdCA9IGZ1bmN0aW9uIChmKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhKSB7XG4gICAgICAgIHZhciB0b2RvID0gX19zcHJlYWRBcnJheShbXSwgZihhKSwgdHJ1ZSk7XG4gICAgICAgIHZhciBvdXQgPSBbXTtcbiAgICAgICAgd2hpbGUgKHRvZG8ubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgdmFyIGUgPSB0b2RvLnNoaWZ0KCk7XG4gICAgICAgICAgICBpZiAoXy5pc0xlZnQoZSkpIHtcbiAgICAgICAgICAgICAgICB0b2RvLnVuc2hpZnQuYXBwbHkodG9kbywgZihlLmxlZnQpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIG91dC5wdXNoKGUucmlnaHQpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBvdXQ7XG4gICAgfTtcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjExLjBcbiAqL1xuZXhwb3J0IHZhciBDaGFpblJlY0RlcHRoRmlyc3QgPSB7XG4gICAgVVJJOiBVUkksXG4gICAgbWFwOiBfbWFwLFxuICAgIGFwOiBfYXAsXG4gICAgY2hhaW46IGZsYXRNYXAsXG4gICAgY2hhaW5SZWM6IF9jaGFpblJlY0RlcHRoRmlyc3Rcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBzZXF1ZW5jaW5nXG4gKiBAc2luY2UgMi4xMS4wXG4gKi9cbmV4cG9ydCB2YXIgY2hhaW5SZWNCcmVhZHRoRmlyc3QgPSBmdW5jdGlvbiAoZikge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYSkge1xuICAgICAgICB2YXIgaW5pdGlhbCA9IGYoYSk7XG4gICAgICAgIHZhciB0b2RvID0gW107XG4gICAgICAgIHZhciBvdXQgPSBbXTtcbiAgICAgICAgZnVuY3Rpb24gZ28oZSkge1xuICAgICAgICAgICAgaWYgKF8uaXNMZWZ0KGUpKSB7XG4gICAgICAgICAgICAgICAgZihlLmxlZnQpLmZvckVhY2goZnVuY3Rpb24gKHYpIHsgcmV0dXJuIHRvZG8ucHVzaCh2KTsgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBvdXQucHVzaChlLnJpZ2h0KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBmb3IgKHZhciBfaSA9IDAsIGluaXRpYWxfMSA9IGluaXRpYWw7IF9pIDwgaW5pdGlhbF8xLmxlbmd0aDsgX2krKykge1xuICAgICAgICAgICAgdmFyIGUgPSBpbml0aWFsXzFbX2ldO1xuICAgICAgICAgICAgZ28oZSk7XG4gICAgICAgIH1cbiAgICAgICAgd2hpbGUgKHRvZG8ubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgZ28odG9kby5zaGlmdCgpKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gb3V0O1xuICAgIH07XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi4xMS4wXG4gKi9cbmV4cG9ydCB2YXIgQ2hhaW5SZWNCcmVhZHRoRmlyc3QgPSB7XG4gICAgVVJJOiBVUkksXG4gICAgbWFwOiBfbWFwLFxuICAgIGFwOiBfYXAsXG4gICAgY2hhaW46IGZsYXRNYXAsXG4gICAgY2hhaW5SZWM6IF9jaGFpblJlY0JyZWFkdGhGaXJzdFxufTtcbnZhciBfd2l0aGVyID0gLyojX19QVVJFX18qLyB3aXRoZXJEZWZhdWx0KFRyYXZlcnNhYmxlLCBDb21wYWN0YWJsZSk7XG52YXIgX3dpbHQgPSAvKiNfX1BVUkVfXyovIHdpbHREZWZhdWx0KFRyYXZlcnNhYmxlLCBDb21wYWN0YWJsZSk7XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjcuMFxuICovXG5leHBvcnQgdmFyIFdpdGhlcmFibGUgPSB7XG4gICAgVVJJOiBVUkksXG4gICAgbWFwOiBfbWFwLFxuICAgIGNvbXBhY3Q6IGNvbXBhY3QsXG4gICAgc2VwYXJhdGU6IHNlcGFyYXRlLFxuICAgIGZpbHRlcjogX2ZpbHRlcixcbiAgICBmaWx0ZXJNYXA6IF9maWx0ZXJNYXAsXG4gICAgcGFydGl0aW9uOiBfcGFydGl0aW9uLFxuICAgIHBhcnRpdGlvbk1hcDogX3BhcnRpdGlvbk1hcCxcbiAgICByZWR1Y2U6IF9yZWR1Y2UsXG4gICAgZm9sZE1hcDogX2ZvbGRNYXAsXG4gICAgcmVkdWNlUmlnaHQ6IF9yZWR1Y2VSaWdodCxcbiAgICB0cmF2ZXJzZTogX3RyYXZlcnNlLFxuICAgIHNlcXVlbmNlOiBzZXF1ZW5jZSxcbiAgICB3aXRoZXI6IF93aXRoZXIsXG4gICAgd2lsdDogX3dpbHRcbn07XG4vKipcbiAqIEZpbHRlciB2YWx1ZXMgaW5zaWRlIGEgY29udGV4dC5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgcGlwZSB9IGZyb20gJ2ZwLXRzL2Z1bmN0aW9uJ1xuICogaW1wb3J0ICogYXMgUkEgZnJvbSAnZnAtdHMvUmVhZG9ubHlBcnJheSdcbiAqIGltcG9ydCAqIGFzIFQgZnJvbSAnZnAtdHMvVGFzaydcbiAqXG4gKiBjb25zdCBmaWx0ZXJFID0gUkEuZmlsdGVyRShULkFwcGxpY2F0aXZlUGFyKVxuICogYXN5bmMgZnVuY3Rpb24gdGVzdCgpIHtcbiAqICAgYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChcbiAqICAgICBhd2FpdCBwaXBlKFxuICogICAgICAgWy0xLCAyLCAzXSxcbiAqICAgICAgIGZpbHRlckUoKG4pID0+IFQub2YobiA+IDApKVxuICogICAgICkoKSxcbiAqICAgICBbMiwgM11cbiAqICAgKVxuICogfVxuICogdGVzdCgpXG4gKlxuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIGZpbHRlckUgPSAvKiNfX1BVUkVfXyovIGZpbHRlckVfKFdpdGhlcmFibGUpO1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi4xMS4wXG4gKi9cbmV4cG9ydCB2YXIgRnJvbUVpdGhlciA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICBmcm9tRWl0aGVyOiBmcm9tRWl0aGVyXG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgbGlmdGluZ1xuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIGZyb21FaXRoZXJLID0gLyojX19QVVJFX18qLyBmcm9tRWl0aGVyS18oRnJvbUVpdGhlcik7XG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vLyB1bnNhZmVcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8qKlxuICogQGNhdGVnb3J5IHVuc2FmZVxuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgdW5zYWZlSW5zZXJ0QXQgPSBSTkVBLnVuc2FmZUluc2VydEF0O1xuLyoqXG4gKiBAY2F0ZWdvcnkgdW5zYWZlXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciB1bnNhZmVVcGRhdGVBdCA9IGZ1bmN0aW9uIChpLCBhLCBhcykge1xuICAgIHJldHVybiBpc05vbkVtcHR5KGFzKSA/IFJORUEudW5zYWZlVXBkYXRlQXQoaSwgYSwgYXMpIDogYXM7XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgdW5zYWZlXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciB1bnNhZmVEZWxldGVBdCA9IGZ1bmN0aW9uIChpLCBhcykge1xuICAgIHZhciB4cyA9IGFzLnNsaWNlKCk7XG4gICAgeHMuc3BsaWNlKGksIDEpO1xuICAgIHJldHVybiB4cztcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBjb252ZXJzaW9uc1xuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgdG9BcnJheSA9IGZ1bmN0aW9uIChhcykgeyByZXR1cm4gYXMuc2xpY2UoKTsgfTtcbi8qKlxuICogQGNhdGVnb3J5IGNvbnZlcnNpb25zXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBmcm9tQXJyYXkgPSBmdW5jdGlvbiAoYXMpIHsgcmV0dXJuIChpc0VtcHR5KGFzKSA/IGVtcHR5IDogYXMuc2xpY2UoKSk7IH07XG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vLyB1dGlsc1xuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLyoqXG4gKiBBbiBlbXB0eSBhcnJheVxuICpcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIGVtcHR5ID0gUk5FQS5lbXB0eTtcbmV4cG9ydCBmdW5jdGlvbiBldmVyeShwcmVkaWNhdGUpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7IHJldHVybiBhcy5ldmVyeShwcmVkaWNhdGUpOyB9O1xufVxuLyoqXG4gKiBDaGVjayBpZiBhIHByZWRpY2F0ZSBob2xkcyB0cnVlIGZvciBhbnkgYXJyYXkgbWVtYmVyLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBzb21lIH0gZnJvbSAnZnAtdHMvUmVhZG9ubHlBcnJheSdcbiAqIGltcG9ydCB7IHBpcGUgfSBmcm9tICdmcC10cy9mdW5jdGlvbidcbiAqXG4gKiBjb25zdCBpc1Bvc2l0aXZlID0gKG46IG51bWJlcik6IGJvb2xlYW4gPT4gbiA+IDBcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKHBpcGUoWy0xLCAtMiwgM10sIHNvbWUoaXNQb3NpdGl2ZSkpLCB0cnVlKVxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChwaXBlKFstMSwgLTIsIC0zXSwgc29tZShpc1Bvc2l0aXZlKSksIGZhbHNlKVxuICpcbiAqIEBzaW5jZSAyLjkuMFxuICovXG5leHBvcnQgdmFyIHNvbWUgPSBmdW5jdGlvbiAocHJlZGljYXRlKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykge1xuICAgICAgICByZXR1cm4gYXMuc29tZShwcmVkaWNhdGUpO1xuICAgIH07XG59O1xuLyoqXG4gKiBBbGlhcyBvZiBbYHNvbWVgXSgjc29tZSlcbiAqXG4gKiBAc2luY2UgMi4xMS4wXG4gKi9cbmV4cG9ydCB2YXIgZXhpc3RzID0gc29tZTtcbi8qKlxuICogUGxhY2VzIGFuIGVsZW1lbnQgaW4gYmV0d2VlbiBtZW1iZXJzIG9mIGEgYFJlYWRvbmx5QXJyYXlgLCB0aGVuIGZvbGRzIHRoZSByZXN1bHRzIHVzaW5nIHRoZSBwcm92aWRlZCBgTW9ub2lkYC5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0ICogYXMgUyBmcm9tICdmcC10cy9zdHJpbmcnXG4gKiBpbXBvcnQgeyBpbnRlcmNhbGF0ZSB9IGZyb20gJ2ZwLXRzL1JlYWRvbmx5QXJyYXknXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChpbnRlcmNhbGF0ZShTLk1vbm9pZCkoJy0nKShbJ2EnLCAnYicsICdjJ10pLCAnYS1iLWMnKVxuICpcbiAqIEBzaW5jZSAyLjEyLjBcbiAqL1xuZXhwb3J0IHZhciBpbnRlcmNhbGF0ZSA9IGZ1bmN0aW9uIChNKSB7XG4gICAgdmFyIGludGVyY2FsYXRlTSA9IFJORUEuaW50ZXJjYWxhdGUoTSk7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChtaWRkbGUpIHsgcmV0dXJuIG1hdGNoKGZ1bmN0aW9uICgpIHsgcmV0dXJuIE0uZW1wdHk7IH0sIGludGVyY2FsYXRlTShtaWRkbGUpKTsgfTtcbn07XG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vLyBkbyBub3RhdGlvblxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLyoqXG4gKiBAY2F0ZWdvcnkgZG8gbm90YXRpb25cbiAqIEBzaW5jZSAyLjkuMFxuICovXG5leHBvcnQgdmFyIERvID0gLyojX19QVVJFX18qLyBvZihfLmVtcHR5UmVjb3JkKTtcbi8qKlxuICogQGNhdGVnb3J5IGRvIG5vdGF0aW9uXG4gKiBAc2luY2UgMi44LjBcbiAqL1xuZXhwb3J0IHZhciBiaW5kVG8gPSAvKiNfX1BVUkVfXyovIGJpbmRUb18oRnVuY3Rvcik7XG52YXIgbGV0XyA9IC8qI19fUFVSRV9fKi8gbGV0X18oRnVuY3Rvcik7XG5leHBvcnQgeyBcbi8qKlxuICogQGNhdGVnb3J5IGRvIG5vdGF0aW9uXG4gKiBAc2luY2UgMi4xMy4wXG4gKi9cbmxldF8gYXMgbGV0IH07XG4vKipcbiAqIEBjYXRlZ29yeSBkbyBub3RhdGlvblxuICogQHNpbmNlIDIuOC4wXG4gKi9cbmV4cG9ydCB2YXIgYmluZCA9IC8qI19fUFVSRV9fKi8gYmluZF8oQ2hhaW4pO1xuLyoqXG4gKiBAY2F0ZWdvcnkgZG8gbm90YXRpb25cbiAqIEBzaW5jZSAyLjguMFxuICovXG5leHBvcnQgdmFyIGFwUyA9IC8qI19fUFVSRV9fKi8gYXBTXyhBcHBseSk7XG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vLyBsZWdhY3lcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8qKlxuICogQWxpYXMgb2YgYGZsYXRNYXBgLlxuICpcbiAqIEBjYXRlZ29yeSBsZWdhY3lcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIGNoYWluID0gZmxhdE1hcDtcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8vIGRlcHJlY2F0ZWRcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8qKlxuICogVXNlIGBSZWFkb25seU5vbkVtcHR5QXJyYXlgIG1vZHVsZSBpbnN0ZWFkLlxuICpcbiAqIEBjYXRlZ29yeSB6b25lIG9mIGRlYXRoXG4gKiBAc2luY2UgMi41LjBcbiAqIEBkZXByZWNhdGVkXG4gKi9cbmV4cG9ydCB2YXIgcmFuZ2UgPSBSTkVBLnJhbmdlO1xuLyoqXG4gKiBVc2UgW2BwcmVwZW5kYF0oI3ByZXBlbmQpIGluc3RlYWQuXG4gKlxuICogQGNhdGVnb3J5IHpvbmUgb2YgZGVhdGhcbiAqIEBzaW5jZSAyLjUuMFxuICogQGRlcHJlY2F0ZWRcbiAqL1xuZXhwb3J0IHZhciBjb25zID0gUk5FQS5jb25zO1xuLyoqXG4gKiBVc2UgW2BhcHBlbmRgXSgjYXBwZW5kKSBpbnN0ZWFkLlxuICpcbiAqIEBjYXRlZ29yeSB6b25lIG9mIGRlYXRoXG4gKiBAc2luY2UgMi41LjBcbiAqIEBkZXByZWNhdGVkXG4gKi9cbmV4cG9ydCB2YXIgc25vYyA9IFJORUEuc25vYztcbi8qKlxuICogVXNlIFtgcHJlcGVuZEFsbGBdKCNwcmVwZW5kYWxsKSBpbnN0ZWFkLlxuICpcbiAqIEBjYXRlZ29yeSB6b25lIG9mIGRlYXRoXG4gKiBAc2luY2UgMi45LjBcbiAqIEBkZXByZWNhdGVkXG4gKi9cbmV4cG9ydCB2YXIgcHJlcGVuZFRvQWxsID0gcHJlcGVuZEFsbDtcbi8qKlxuICogVGhpcyBpbnN0YW5jZSBpcyBkZXByZWNhdGVkLCB1c2Ugc21hbGwsIHNwZWNpZmljIGluc3RhbmNlcyBpbnN0ZWFkLlxuICogRm9yIGV4YW1wbGUgaWYgYSBmdW5jdGlvbiBuZWVkcyBhIGBGdW5jdG9yYCBpbnN0YW5jZSwgcGFzcyBgUkEuRnVuY3RvcmAgaW5zdGVhZCBvZiBgUkEucmVhZG9ubHlBcnJheWBcbiAqICh3aGVyZSBgUkFgIGlzIGZyb20gYGltcG9ydCBSQSBmcm9tICdmcC10cy9SZWFkb25seUFycmF5J2ApXG4gKlxuICogQGNhdGVnb3J5IHpvbmUgb2YgZGVhdGhcbiAqIEBzaW5jZSAyLjUuMFxuICogQGRlcHJlY2F0ZWRcbiAqL1xuZXhwb3J0IHZhciByZWFkb25seUFycmF5ID0ge1xuICAgIFVSSTogVVJJLFxuICAgIGNvbXBhY3Q6IGNvbXBhY3QsXG4gICAgc2VwYXJhdGU6IHNlcGFyYXRlLFxuICAgIG1hcDogX21hcCxcbiAgICBhcDogX2FwLFxuICAgIG9mOiBvZixcbiAgICBjaGFpbjogZmxhdE1hcCxcbiAgICBmaWx0ZXI6IF9maWx0ZXIsXG4gICAgZmlsdGVyTWFwOiBfZmlsdGVyTWFwLFxuICAgIHBhcnRpdGlvbjogX3BhcnRpdGlvbixcbiAgICBwYXJ0aXRpb25NYXA6IF9wYXJ0aXRpb25NYXAsXG4gICAgbWFwV2l0aEluZGV4OiBfbWFwV2l0aEluZGV4LFxuICAgIHBhcnRpdGlvbk1hcFdpdGhJbmRleDogX3BhcnRpdGlvbk1hcFdpdGhJbmRleCxcbiAgICBwYXJ0aXRpb25XaXRoSW5kZXg6IF9wYXJ0aXRpb25XaXRoSW5kZXgsXG4gICAgZmlsdGVyTWFwV2l0aEluZGV4OiBfZmlsdGVyTWFwV2l0aEluZGV4LFxuICAgIGZpbHRlcldpdGhJbmRleDogX2ZpbHRlcldpdGhJbmRleCxcbiAgICBhbHQ6IF9hbHQsXG4gICAgemVybzogemVybyxcbiAgICB1bmZvbGQ6IHVuZm9sZCxcbiAgICByZWR1Y2U6IF9yZWR1Y2UsXG4gICAgZm9sZE1hcDogX2ZvbGRNYXAsXG4gICAgcmVkdWNlUmlnaHQ6IF9yZWR1Y2VSaWdodCxcbiAgICB0cmF2ZXJzZTogX3RyYXZlcnNlLFxuICAgIHNlcXVlbmNlOiBzZXF1ZW5jZSxcbiAgICByZWR1Y2VXaXRoSW5kZXg6IF9yZWR1Y2VXaXRoSW5kZXgsXG4gICAgZm9sZE1hcFdpdGhJbmRleDogX2ZvbGRNYXBXaXRoSW5kZXgsXG4gICAgcmVkdWNlUmlnaHRXaXRoSW5kZXg6IF9yZWR1Y2VSaWdodFdpdGhJbmRleCxcbiAgICB0cmF2ZXJzZVdpdGhJbmRleDogX3RyYXZlcnNlV2l0aEluZGV4LFxuICAgIGV4dGVuZDogX2V4dGVuZCxcbiAgICB3aXRoZXI6IF93aXRoZXIsXG4gICAgd2lsdDogX3dpbHRcbn07XG4iLAogICJ2YXIgX19zcHJlYWRBcnJheSA9ICh0aGlzICYmIHRoaXMuX19zcHJlYWRBcnJheSkgfHwgZnVuY3Rpb24gKHRvLCBmcm9tLCBwYWNrKSB7XG4gICAgaWYgKHBhY2sgfHwgYXJndW1lbnRzLmxlbmd0aCA9PT0gMikgZm9yICh2YXIgaSA9IDAsIGwgPSBmcm9tLmxlbmd0aCwgYXI7IGkgPCBsOyBpKyspIHtcbiAgICAgICAgaWYgKGFyIHx8ICEoaSBpbiBmcm9tKSkge1xuICAgICAgICAgICAgaWYgKCFhcikgYXIgPSBBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChmcm9tLCAwLCBpKTtcbiAgICAgICAgICAgIGFyW2ldID0gZnJvbVtpXTtcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gdG8uY29uY2F0KGFyIHx8IEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGZyb20pKTtcbn07XG5pbXBvcnQgeyBhcEZpcnN0IGFzIGFwRmlyc3RfLCBhcFMgYXMgYXBTXywgYXBTZWNvbmQgYXMgYXBTZWNvbmRfIH0gZnJvbSAnLi9BcHBseSc7XG5pbXBvcnQgeyBiaW5kIGFzIGJpbmRfLCBjaGFpbkZpcnN0IGFzIGNoYWluRmlyc3RfIH0gZnJvbSAnLi9DaGFpbic7XG5pbXBvcnQgeyBmcm9tRXF1YWxzIH0gZnJvbSAnLi9FcSc7XG5pbXBvcnQgeyBmcm9tRWl0aGVySyBhcyBmcm9tRWl0aGVyS18gfSBmcm9tICcuL0Zyb21FaXRoZXInO1xuaW1wb3J0IHsgZHVhbCwgaWRlbnRpdHksIHBpcGUgfSBmcm9tICcuL2Z1bmN0aW9uJztcbmltcG9ydCB7IGJpbmRUbyBhcyBiaW5kVG9fLCBmbGFwIGFzIGZsYXBfLCBsZXQgYXMgbGV0X18gfSBmcm9tICcuL0Z1bmN0b3InO1xuaW1wb3J0ICogYXMgXyBmcm9tICcuL2ludGVybmFsJztcbmltcG9ydCAqIGFzIE4gZnJvbSAnLi9udW1iZXInO1xuaW1wb3J0IHsgZnJvbUNvbXBhcmUgfSBmcm9tICcuL09yZCc7XG5pbXBvcnQgKiBhcyBSTkVBIGZyb20gJy4vUmVhZG9ubHlOb25FbXB0eUFycmF5JztcbmltcG9ydCB7IHNlcGFyYXRlZCB9IGZyb20gJy4vU2VwYXJhdGVkJztcbmltcG9ydCB7IGZpbHRlckUgYXMgZmlsdGVyRV8sIHdpbHREZWZhdWx0LCB3aXRoZXJEZWZhdWx0IH0gZnJvbSAnLi9XaXRoZXJhYmxlJztcbmltcG9ydCB7IGd1YXJkIGFzIGd1YXJkXyB9IGZyb20gJy4vWmVybyc7XG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vLyByZWZpbmVtZW50c1xuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLyoqXG4gKiBUZXN0IHdoZXRoZXIgYSBgUmVhZG9ubHlBcnJheWAgaXMgZW1wdHkuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IGlzRW1wdHkgfSBmcm9tICdmcC10cy9SZWFkb25seUFycmF5J1xuICpcbiAqIGFzc2VydC5zdHJpY3RFcXVhbChpc0VtcHR5KFtdKSwgdHJ1ZSlcbiAqXG4gKiBAY2F0ZWdvcnkgcmVmaW5lbWVudHNcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIGlzRW1wdHkgPSBmdW5jdGlvbiAoYXMpIHsgcmV0dXJuIGFzLmxlbmd0aCA9PT0gMDsgfTtcbi8qKlxuICogVGVzdCB3aGV0aGVyIGEgYFJlYWRvbmx5QXJyYXlgIGlzIG5vbiBlbXB0eS5cbiAqXG4gKiBAY2F0ZWdvcnkgcmVmaW5lbWVudHNcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIGlzTm9uRW1wdHkgPSBSTkVBLmlzTm9uRW1wdHk7XG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vLyBjb25zdHJ1Y3RvcnNcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8qKlxuICogUHJlcGVuZCBhbiBlbGVtZW50IHRvIHRoZSBmcm9udCBvZiBhIGBSZWFkb25seUFycmF5YCwgY3JlYXRpbmcgYSBuZXcgYFJlYWRvbmx5Tm9uRW1wdHlBcnJheWAuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IHByZXBlbmQgfSBmcm9tICdmcC10cy9SZWFkb25seUFycmF5J1xuICogaW1wb3J0IHsgcGlwZSB9IGZyb20gJ2ZwLXRzL2Z1bmN0aW9uJ1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwocGlwZShbMiwgMywgNF0sIHByZXBlbmQoMSkpLCBbMSwgMiwgMywgNF0pXG4gKlxuICogQHNpbmNlIDIuMTAuMFxuICovXG5leHBvcnQgdmFyIHByZXBlbmQgPSBSTkVBLnByZXBlbmQ7XG4vKipcbiAqIExlc3Mgc3RyaWN0IHZlcnNpb24gb2YgW2BwcmVwZW5kYF0oI3ByZXBlbmQpLlxuICpcbiAqIEBzaW5jZSAyLjExLjBcbiAqL1xuZXhwb3J0IHZhciBwcmVwZW5kVyA9IFJORUEucHJlcGVuZFc7XG4vKipcbiAqIEFwcGVuZCBhbiBlbGVtZW50IHRvIHRoZSBlbmQgb2YgYSBgUmVhZG9ubHlBcnJheWAsIGNyZWF0aW5nIGEgbmV3IGBSZWFkb25seU5vbkVtcHR5QXJyYXlgLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBhcHBlbmQgfSBmcm9tICdmcC10cy9SZWFkb25seUFycmF5J1xuICogaW1wb3J0IHsgcGlwZSB9IGZyb20gJ2ZwLXRzL2Z1bmN0aW9uJ1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwocGlwZShbMSwgMiwgM10sIGFwcGVuZCg0KSksIFsxLCAyLCAzLCA0XSlcbiAqXG4gKiBAc2luY2UgMi4xMC4wXG4gKi9cbmV4cG9ydCB2YXIgYXBwZW5kID0gUk5FQS5hcHBlbmQ7XG4vKipcbiAqIExlc3Mgc3RyaWN0IHZlcnNpb24gb2YgW2BhcHBlbmRgXSgjYXBwZW5kKS5cbiAqXG4gKiBAc2luY2UgMi4xMS4wXG4gKi9cbmV4cG9ydCB2YXIgYXBwZW5kVyA9IFJORUEuYXBwZW5kVztcbi8qKlxuICogUmV0dXJuIGEgYFJlYWRvbmx5QXJyYXlgIG9mIGxlbmd0aCBgbmAgd2l0aCBlbGVtZW50IGBpYCBpbml0aWFsaXplZCB3aXRoIGBmKGkpYC5cbiAqXG4gKiAqKk5vdGUqKi4gYG5gIGlzIG5vcm1hbGl6ZWQgdG8gYSBub24gbmVnYXRpdmUgaW50ZWdlci5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgbWFrZUJ5IH0gZnJvbSAnZnAtdHMvUmVhZG9ubHlBcnJheSdcbiAqXG4gKiBjb25zdCBkb3VibGUgPSAobjogbnVtYmVyKTogbnVtYmVyID0+IG4gKiAyXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKG1ha2VCeSg1LCBkb3VibGUpLCBbMCwgMiwgNCwgNiwgOF0pXG4gKlxuICogQGNhdGVnb3J5IGNvbnN0cnVjdG9yc1xuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgbWFrZUJ5ID0gZnVuY3Rpb24gKG4sIGYpIHsgcmV0dXJuIChuIDw9IDAgPyBlbXB0eSA6IFJORUEubWFrZUJ5KGYpKG4pKTsgfTtcbi8qKlxuICogQ3JlYXRlIGEgYFJlYWRvbmx5QXJyYXlgIGNvbnRhaW5pbmcgYSB2YWx1ZSByZXBlYXRlZCB0aGUgc3BlY2lmaWVkIG51bWJlciBvZiB0aW1lcy5cbiAqXG4gKiAqKk5vdGUqKi4gYG5gIGlzIG5vcm1hbGl6ZWQgdG8gYSBub24gbmVnYXRpdmUgaW50ZWdlci5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgcmVwbGljYXRlIH0gZnJvbSAnZnAtdHMvUmVhZG9ubHlBcnJheSdcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKHJlcGxpY2F0ZSgzLCAnYScpLCBbJ2EnLCAnYScsICdhJ10pXG4gKlxuICogQGNhdGVnb3J5IGNvbnN0cnVjdG9yc1xuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgcmVwbGljYXRlID0gZnVuY3Rpb24gKG4sIGEpIHsgcmV0dXJuIG1ha2VCeShuLCBmdW5jdGlvbiAoKSB7IHJldHVybiBhOyB9KTsgfTtcbmV4cG9ydCBmdW5jdGlvbiBmcm9tUHJlZGljYXRlKHByZWRpY2F0ZSkge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYSkgeyByZXR1cm4gKHByZWRpY2F0ZShhKSA/IFthXSA6IGVtcHR5KTsgfTtcbn1cbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8vIGNvbnZlcnNpb25zXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vKipcbiAqIEBjYXRlZ29yeSBjb252ZXJzaW9uc1xuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIGZyb21PcHRpb24gPSBmdW5jdGlvbiAobWEpIHsgcmV0dXJuIChfLmlzTm9uZShtYSkgPyBlbXB0eSA6IFttYS52YWx1ZV0pOyB9O1xuLyoqXG4gKiBUcmFuc2Zvcm1zIGFuIGBFaXRoZXJgIHRvIGEgYFJlYWRvbmx5QXJyYXlgLlxuICpcbiAqIEBjYXRlZ29yeSBjb252ZXJzaW9uc1xuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIGZyb21FaXRoZXIgPSBmdW5jdGlvbiAoZSkgeyByZXR1cm4gKF8uaXNMZWZ0KGUpID8gZW1wdHkgOiBbZS5yaWdodF0pOyB9O1xuLyoqXG4gKiBMZXNzIHN0cmljdCB2ZXJzaW9uIG9mIFtgbWF0Y2hgXSgjbWF0Y2gpLlxuICpcbiAqIFRoZSBgV2Agc3VmZml4IChzaG9ydCBmb3IgKipXKippZGVuaW5nKSBtZWFucyB0aGF0IHRoZSBoYW5kbGVyIHJldHVybiB0eXBlcyB3aWxsIGJlIG1lcmdlZC5cbiAqXG4gKiBAY2F0ZWdvcnkgcGF0dGVybiBtYXRjaGluZ1xuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIG1hdGNoVyA9IGZ1bmN0aW9uIChvbkVtcHR5LCBvbk5vbkVtcHR5KSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykge1xuICAgICAgICByZXR1cm4gaXNOb25FbXB0eShhcykgPyBvbk5vbkVtcHR5KGFzKSA6IG9uRW1wdHkoKTtcbiAgICB9O1xufTtcbi8qKlxuICogQGNhdGVnb3J5IHBhdHRlcm4gbWF0Y2hpbmdcbiAqIEBzaW5jZSAyLjExLjBcbiAqL1xuZXhwb3J0IHZhciBtYXRjaCA9IG1hdGNoVztcbi8qKlxuICogTGVzcyBzdHJpY3QgdmVyc2lvbiBvZiBbYG1hdGNoTGVmdGBdKCNtYXRjaGxlZnQpLlxuICpcbiAqIEBjYXRlZ29yeSBwYXR0ZXJuIG1hdGNoaW5nXG4gKiBAc2luY2UgMi4xMS4wXG4gKi9cbmV4cG9ydCB2YXIgbWF0Y2hMZWZ0VyA9IGZ1bmN0aW9uIChvbkVtcHR5LCBvbk5vbkVtcHR5KSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykge1xuICAgICAgICByZXR1cm4gaXNOb25FbXB0eShhcykgPyBvbk5vbkVtcHR5KFJORUEuaGVhZChhcyksIFJORUEudGFpbChhcykpIDogb25FbXB0eSgpO1xuICAgIH07XG59O1xuLyoqXG4gKiBCcmVhayBhIGBSZWFkb25seUFycmF5YCBpbnRvIGl0cyBmaXJzdCBlbGVtZW50IGFuZCByZW1haW5pbmcgZWxlbWVudHMuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IG1hdGNoTGVmdCB9IGZyb20gJ2ZwLXRzL1JlYWRvbmx5QXJyYXknXG4gKlxuICogY29uc3QgbGVuOiA8QT4oYXM6IFJlYWRvbmx5QXJyYXk8QT4pID0+IG51bWJlciA9IG1hdGNoTGVmdCgoKSA9PiAwLCAoXywgdGFpbCkgPT4gMSArIGxlbih0YWlsKSlcbiAqIGFzc2VydC5zdHJpY3RFcXVhbChsZW4oWzEsIDIsIDNdKSwgMylcbiAqXG4gKiBAY2F0ZWdvcnkgcGF0dGVybiBtYXRjaGluZ1xuICogQHNpbmNlIDIuMTAuMFxuICovXG5leHBvcnQgdmFyIG1hdGNoTGVmdCA9IG1hdGNoTGVmdFc7XG4vKipcbiAqIEFsaWFzIG9mIFtgbWF0Y2hMZWZ0YF0oI21hdGNobGVmdCkuXG4gKlxuICogQGNhdGVnb3J5IHBhdHRlcm4gbWF0Y2hpbmdcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIGZvbGRMZWZ0ID0gbWF0Y2hMZWZ0O1xuLyoqXG4gKiBMZXNzIHN0cmljdCB2ZXJzaW9uIG9mIFtgbWF0Y2hSaWdodGBdKCNtYXRjaHJpZ2h0KS5cbiAqXG4gKiBAY2F0ZWdvcnkgcGF0dGVybiBtYXRjaGluZ1xuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIG1hdGNoUmlnaHRXID0gZnVuY3Rpb24gKG9uRW1wdHksIG9uTm9uRW1wdHkpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIHJldHVybiBpc05vbkVtcHR5KGFzKSA/IG9uTm9uRW1wdHkoUk5FQS5pbml0KGFzKSwgUk5FQS5sYXN0KGFzKSkgOiBvbkVtcHR5KCk7XG4gICAgfTtcbn07XG4vKipcbiAqIEJyZWFrIGEgYFJlYWRvbmx5QXJyYXlgIGludG8gaXRzIGluaXRpYWwgZWxlbWVudHMgYW5kIHRoZSBsYXN0IGVsZW1lbnQuXG4gKlxuICogQGNhdGVnb3J5IHBhdHRlcm4gbWF0Y2hpbmdcbiAqIEBzaW5jZSAyLjEwLjBcbiAqL1xuZXhwb3J0IHZhciBtYXRjaFJpZ2h0ID0gbWF0Y2hSaWdodFc7XG4vKipcbiAqIEFsaWFzIG9mIFtgbWF0Y2hSaWdodGBdKCNtYXRjaHJpZ2h0KS5cbiAqXG4gKiBAY2F0ZWdvcnkgcGF0dGVybiBtYXRjaGluZ1xuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgZm9sZFJpZ2h0ID0gbWF0Y2hSaWdodDtcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8vIGNvbWJpbmF0b3JzXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vKipcbiAqIEBjYXRlZ29yeSBzZXF1ZW5jaW5nXG4gKiBAc2luY2UgMi43LjBcbiAqL1xuZXhwb3J0IHZhciBjaGFpbldpdGhJbmRleCA9IGZ1bmN0aW9uIChmKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykge1xuICAgICAgICBpZiAoaXNFbXB0eShhcykpIHtcbiAgICAgICAgICAgIHJldHVybiBlbXB0eTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgb3V0ID0gW107XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgYXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIG91dC5wdXNoLmFwcGx5KG91dCwgZihpLCBhc1tpXSkpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBvdXQ7XG4gICAgfTtcbn07XG4vKipcbiAqIFNhbWUgYXMgYHJlZHVjZWAgYnV0IGl0IGNhcnJpZXMgb3ZlciB0aGUgaW50ZXJtZWRpYXRlIHN0ZXBzLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBzY2FuTGVmdCB9IGZyb20gJ2ZwLXRzL1JlYWRvbmx5QXJyYXknXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChzY2FuTGVmdCgxMCwgKGIsIGE6IG51bWJlcikgPT4gYiAtIGEpKFsxLCAyLCAzXSksIFsxMCwgOSwgNywgNF0pXG4gKlxuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgc2NhbkxlZnQgPSBmdW5jdGlvbiAoYiwgZikge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgdmFyIGxlbiA9IGFzLmxlbmd0aDtcbiAgICAgICAgdmFyIG91dCA9IG5ldyBBcnJheShsZW4gKyAxKTtcbiAgICAgICAgb3V0WzBdID0gYjtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBsZW47IGkrKykge1xuICAgICAgICAgICAgb3V0W2kgKyAxXSA9IGYob3V0W2ldLCBhc1tpXSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG91dDtcbiAgICB9O1xufTtcbi8qKlxuICogRm9sZCBhbiBhcnJheSBmcm9tIHRoZSByaWdodCwga2VlcGluZyBhbGwgaW50ZXJtZWRpYXRlIHJlc3VsdHMgaW5zdGVhZCBvZiBvbmx5IHRoZSBmaW5hbCByZXN1bHRcbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgc2NhblJpZ2h0IH0gZnJvbSAnZnAtdHMvUmVhZG9ubHlBcnJheSdcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKHNjYW5SaWdodCgxMCwgKGE6IG51bWJlciwgYikgPT4gYiAtIGEpKFsxLCAyLCAzXSksIFs0LCA1LCA3LCAxMF0pXG4gKlxuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgc2NhblJpZ2h0ID0gZnVuY3Rpb24gKGIsIGYpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIHZhciBsZW4gPSBhcy5sZW5ndGg7XG4gICAgICAgIHZhciBvdXQgPSBuZXcgQXJyYXkobGVuICsgMSk7XG4gICAgICAgIG91dFtsZW5dID0gYjtcbiAgICAgICAgZm9yICh2YXIgaSA9IGxlbiAtIDE7IGkgPj0gMDsgaS0tKSB7XG4gICAgICAgICAgICBvdXRbaV0gPSBmKGFzW2ldLCBvdXRbaSArIDFdKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gb3V0O1xuICAgIH07XG59O1xuLyoqXG4gKiBDYWxjdWxhdGUgdGhlIG51bWJlciBvZiBlbGVtZW50cyBpbiBhIGBSZWFkb25seUFycmF5YC5cbiAqXG4gKiBAc2luY2UgMi4xMC4wXG4gKi9cbmV4cG9ydCB2YXIgc2l6ZSA9IGZ1bmN0aW9uIChhcykgeyByZXR1cm4gYXMubGVuZ3RoOyB9O1xuLyoqXG4gKiBUZXN0IHdoZXRoZXIgYW4gYXJyYXkgY29udGFpbnMgYSBwYXJ0aWN1bGFyIGluZGV4XG4gKlxuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgaXNPdXRPZkJvdW5kID0gUk5FQS5pc091dE9mQm91bmQ7XG5leHBvcnQgZnVuY3Rpb24gbG9va3VwKGksIGFzKSB7XG4gICAgcmV0dXJuIGFzID09PSB1bmRlZmluZWQgPyBmdW5jdGlvbiAoYXMpIHsgcmV0dXJuIGxvb2t1cChpLCBhcyk7IH0gOiBpc091dE9mQm91bmQoaSwgYXMpID8gXy5ub25lIDogXy5zb21lKGFzW2ldKTtcbn1cbi8qKlxuICogR2V0IHRoZSBmaXJzdCBlbGVtZW50IGluIGFuIGFycmF5LCBvciBgTm9uZWAgaWYgdGhlIGFycmF5IGlzIGVtcHR5XG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IGhlYWQgfSBmcm9tICdmcC10cy9SZWFkb25seUFycmF5J1xuICogaW1wb3J0IHsgc29tZSwgbm9uZSB9IGZyb20gJ2ZwLXRzL09wdGlvbidcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKGhlYWQoWzEsIDIsIDNdKSwgc29tZSgxKSlcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoaGVhZChbXSksIG5vbmUpXG4gKlxuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgaGVhZCA9IGZ1bmN0aW9uIChhcykgeyByZXR1cm4gKGlzTm9uRW1wdHkoYXMpID8gXy5zb21lKFJORUEuaGVhZChhcykpIDogXy5ub25lKTsgfTtcbi8qKlxuICogR2V0IHRoZSBsYXN0IGVsZW1lbnQgaW4gYW4gYXJyYXksIG9yIGBOb25lYCBpZiB0aGUgYXJyYXkgaXMgZW1wdHlcbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgbGFzdCB9IGZyb20gJ2ZwLXRzL1JlYWRvbmx5QXJyYXknXG4gKiBpbXBvcnQgeyBzb21lLCBub25lIH0gZnJvbSAnZnAtdHMvT3B0aW9uJ1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwobGFzdChbMSwgMiwgM10pLCBzb21lKDMpKVxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChsYXN0KFtdKSwgbm9uZSlcbiAqXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBsYXN0ID0gZnVuY3Rpb24gKGFzKSB7IHJldHVybiAoaXNOb25FbXB0eShhcykgPyBfLnNvbWUoUk5FQS5sYXN0KGFzKSkgOiBfLm5vbmUpOyB9O1xuLyoqXG4gKiBHZXQgYWxsIGJ1dCB0aGUgZmlyc3QgZWxlbWVudCBvZiBhbiBhcnJheSwgY3JlYXRpbmcgYSBuZXcgYXJyYXksIG9yIGBOb25lYCBpZiB0aGUgYXJyYXkgaXMgZW1wdHlcbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgdGFpbCB9IGZyb20gJ2ZwLXRzL1JlYWRvbmx5QXJyYXknXG4gKiBpbXBvcnQgeyBzb21lLCBub25lIH0gZnJvbSAnZnAtdHMvT3B0aW9uJ1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwodGFpbChbMSwgMiwgM10pLCBzb21lKFsyLCAzXSkpXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKHRhaWwoW10pLCBub25lKVxuICpcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIHRhaWwgPSBmdW5jdGlvbiAoYXMpIHtcbiAgICByZXR1cm4gaXNOb25FbXB0eShhcykgPyBfLnNvbWUoUk5FQS50YWlsKGFzKSkgOiBfLm5vbmU7XG59O1xuLyoqXG4gKiBHZXQgYWxsIGJ1dCB0aGUgbGFzdCBlbGVtZW50IG9mIGFuIGFycmF5LCBjcmVhdGluZyBhIG5ldyBhcnJheSwgb3IgYE5vbmVgIGlmIHRoZSBhcnJheSBpcyBlbXB0eVxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBpbml0IH0gZnJvbSAnZnAtdHMvUmVhZG9ubHlBcnJheSdcbiAqIGltcG9ydCB7IHNvbWUsIG5vbmUgfSBmcm9tICdmcC10cy9PcHRpb24nXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChpbml0KFsxLCAyLCAzXSksIHNvbWUoWzEsIDJdKSlcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoaW5pdChbXSksIG5vbmUpXG4gKlxuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgaW5pdCA9IGZ1bmN0aW9uIChhcykge1xuICAgIHJldHVybiBpc05vbkVtcHR5KGFzKSA/IF8uc29tZShSTkVBLmluaXQoYXMpKSA6IF8ubm9uZTtcbn07XG4vKipcbiAqIEtlZXAgb25seSBhIG1heCBudW1iZXIgb2YgZWxlbWVudHMgZnJvbSB0aGUgc3RhcnQgb2YgYW4gYFJlYWRvbmx5QXJyYXlgLCBjcmVhdGluZyBhIG5ldyBgUmVhZG9ubHlBcnJheWAuXG4gKlxuICogKipOb3RlKiouIGBuYCBpcyBub3JtYWxpemVkIHRvIGEgbm9uIG5lZ2F0aXZlIGludGVnZXIuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCAqIGFzIFJBIGZyb20gJ2ZwLXRzL1JlYWRvbmx5QXJyYXknXG4gKiBpbXBvcnQgeyBwaXBlIH0gZnJvbSAnZnAtdHMvZnVuY3Rpb24nXG4gKlxuICogY29uc3QgaW5wdXQ6IFJlYWRvbmx5QXJyYXk8bnVtYmVyPiA9IFsxLCAyLCAzXVxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChwaXBlKGlucHV0LCBSQS50YWtlTGVmdCgyKSksIFsxLCAyXSlcbiAqXG4gKiAvLyBvdXQgb2YgYm91bmRzXG4gKiBhc3NlcnQuc3RyaWN0RXF1YWwocGlwZShpbnB1dCwgUkEudGFrZUxlZnQoNCkpLCBpbnB1dClcbiAqIGFzc2VydC5zdHJpY3RFcXVhbChwaXBlKGlucHV0LCBSQS50YWtlTGVmdCgtMSkpLCBpbnB1dClcbiAqXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciB0YWtlTGVmdCA9IGZ1bmN0aW9uIChuKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykge1xuICAgICAgICByZXR1cm4gaXNPdXRPZkJvdW5kKG4sIGFzKSA/IGFzIDogbiA9PT0gMCA/IGVtcHR5IDogYXMuc2xpY2UoMCwgbik7XG4gICAgfTtcbn07XG4vKipcbiAqIEtlZXAgb25seSBhIG1heCBudW1iZXIgb2YgZWxlbWVudHMgZnJvbSB0aGUgZW5kIG9mIGFuIGBSZWFkb25seUFycmF5YCwgY3JlYXRpbmcgYSBuZXcgYFJlYWRvbmx5QXJyYXlgLlxuICpcbiAqICoqTm90ZSoqLiBgbmAgaXMgbm9ybWFsaXplZCB0byBhIG5vbiBuZWdhdGl2ZSBpbnRlZ2VyLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgKiBhcyBSQSBmcm9tICdmcC10cy9SZWFkb25seUFycmF5J1xuICogaW1wb3J0IHsgcGlwZSB9IGZyb20gJ2ZwLXRzL2Z1bmN0aW9uJ1xuICpcbiAqIGNvbnN0IGlucHV0OiBSZWFkb25seUFycmF5PG51bWJlcj4gPSBbMSwgMiwgM11cbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwocGlwZShpbnB1dCwgUkEudGFrZVJpZ2h0KDIpKSwgWzIsIDNdKVxuICpcbiAqIC8vIG91dCBvZiBib3VuZHNcbiAqIGFzc2VydC5zdHJpY3RFcXVhbChwaXBlKGlucHV0LCBSQS50YWtlUmlnaHQoNCkpLCBpbnB1dClcbiAqIGFzc2VydC5zdHJpY3RFcXVhbChwaXBlKGlucHV0LCBSQS50YWtlUmlnaHQoLTEpKSwgaW5wdXQpXG4gKlxuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgdGFrZVJpZ2h0ID0gZnVuY3Rpb24gKG4pIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIHJldHVybiBpc091dE9mQm91bmQobiwgYXMpID8gYXMgOiBuID09PSAwID8gZW1wdHkgOiBhcy5zbGljZSgtbik7XG4gICAgfTtcbn07XG5leHBvcnQgZnVuY3Rpb24gdGFrZUxlZnRXaGlsZShwcmVkaWNhdGUpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIHZhciBvdXQgPSBbXTtcbiAgICAgICAgZm9yICh2YXIgX2kgPSAwLCBhc18xID0gYXM7IF9pIDwgYXNfMS5sZW5ndGg7IF9pKyspIHtcbiAgICAgICAgICAgIHZhciBhID0gYXNfMVtfaV07XG4gICAgICAgICAgICBpZiAoIXByZWRpY2F0ZShhKSkge1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgb3V0LnB1c2goYSk7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGxlbiA9IG91dC5sZW5ndGg7XG4gICAgICAgIHJldHVybiBsZW4gPT09IGFzLmxlbmd0aCA/IGFzIDogbGVuID09PSAwID8gZW1wdHkgOiBvdXQ7XG4gICAgfTtcbn1cbnZhciBzcGFuTGVmdEluZGV4ID0gZnVuY3Rpb24gKGFzLCBwcmVkaWNhdGUpIHtcbiAgICB2YXIgbCA9IGFzLmxlbmd0aDtcbiAgICB2YXIgaSA9IDA7XG4gICAgZm9yICg7IGkgPCBsOyBpKyspIHtcbiAgICAgICAgaWYgKCFwcmVkaWNhdGUoYXNbaV0pKSB7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gaTtcbn07XG5leHBvcnQgZnVuY3Rpb24gc3BhbkxlZnQocHJlZGljYXRlKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykge1xuICAgICAgICB2YXIgX2EgPSBzcGxpdEF0KHNwYW5MZWZ0SW5kZXgoYXMsIHByZWRpY2F0ZSkpKGFzKSwgaW5pdCA9IF9hWzBdLCByZXN0ID0gX2FbMV07XG4gICAgICAgIHJldHVybiB7IGluaXQ6IGluaXQsIHJlc3Q6IHJlc3QgfTtcbiAgICB9O1xufVxuLyoqXG4gKiBEcm9wIGEgbWF4IG51bWJlciBvZiBlbGVtZW50cyBmcm9tIHRoZSBzdGFydCBvZiBhbiBgUmVhZG9ubHlBcnJheWAsIGNyZWF0aW5nIGEgbmV3IGBSZWFkb25seUFycmF5YC5cbiAqXG4gKiAqKk5vdGUqKi4gYG5gIGlzIG5vcm1hbGl6ZWQgdG8gYSBub24gbmVnYXRpdmUgaW50ZWdlci5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0ICogYXMgUkEgZnJvbSAnZnAtdHMvUmVhZG9ubHlBcnJheSdcbiAqIGltcG9ydCB7IHBpcGUgfSBmcm9tICdmcC10cy9mdW5jdGlvbidcbiAqXG4gKiBjb25zdCBpbnB1dDogUmVhZG9ubHlBcnJheTxudW1iZXI+ID0gWzEsIDIsIDNdXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKHBpcGUoaW5wdXQsIFJBLmRyb3BMZWZ0KDIpKSwgWzNdKVxuICogYXNzZXJ0LnN0cmljdEVxdWFsKHBpcGUoaW5wdXQsIFJBLmRyb3BMZWZ0KDApKSwgaW5wdXQpXG4gKiBhc3NlcnQuc3RyaWN0RXF1YWwocGlwZShpbnB1dCwgUkEuZHJvcExlZnQoLTEpKSwgaW5wdXQpXG4gKlxuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgZHJvcExlZnQgPSBmdW5jdGlvbiAobikge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgcmV0dXJuIG4gPD0gMCB8fCBpc0VtcHR5KGFzKSA/IGFzIDogbiA+PSBhcy5sZW5ndGggPyBlbXB0eSA6IGFzLnNsaWNlKG4sIGFzLmxlbmd0aCk7XG4gICAgfTtcbn07XG4vKipcbiAqIERyb3AgYSBtYXggbnVtYmVyIG9mIGVsZW1lbnRzIGZyb20gdGhlIGVuZCBvZiBhbiBgUmVhZG9ubHlBcnJheWAsIGNyZWF0aW5nIGEgbmV3IGBSZWFkb25seUFycmF5YC5cbiAqXG4gKiAqKk5vdGUqKi4gYG5gIGlzIG5vcm1hbGl6ZWQgdG8gYSBub24gbmVnYXRpdmUgaW50ZWdlci5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0ICogYXMgUkEgZnJvbSAnZnAtdHMvUmVhZG9ubHlBcnJheSdcbiAqIGltcG9ydCB7IHBpcGUgfSBmcm9tICdmcC10cy9mdW5jdGlvbidcbiAqXG4gKiBjb25zdCBpbnB1dDogUmVhZG9ubHlBcnJheTxudW1iZXI+ID0gWzEsIDIsIDNdXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKHBpcGUoaW5wdXQsIFJBLmRyb3BSaWdodCgyKSksIFsxXSlcbiAqIGFzc2VydC5zdHJpY3RFcXVhbChwaXBlKGlucHV0LCBSQS5kcm9wUmlnaHQoMCkpLCBpbnB1dClcbiAqIGFzc2VydC5zdHJpY3RFcXVhbChwaXBlKGlucHV0LCBSQS5kcm9wUmlnaHQoLTEpKSwgaW5wdXQpXG4gKlxuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgZHJvcFJpZ2h0ID0gZnVuY3Rpb24gKG4pIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIHJldHVybiBuIDw9IDAgfHwgaXNFbXB0eShhcykgPyBhcyA6IG4gPj0gYXMubGVuZ3RoID8gZW1wdHkgOiBhcy5zbGljZSgwLCBhcy5sZW5ndGggLSBuKTtcbiAgICB9O1xufTtcbmV4cG9ydCBmdW5jdGlvbiBkcm9wTGVmdFdoaWxlKHByZWRpY2F0ZSkge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgdmFyIGkgPSBzcGFuTGVmdEluZGV4KGFzLCBwcmVkaWNhdGUpO1xuICAgICAgICByZXR1cm4gaSA9PT0gMCA/IGFzIDogaSA9PT0gYXMubGVuZ3RoID8gZW1wdHkgOiBhcy5zbGljZShpKTtcbiAgICB9O1xufVxuLyoqXG4gKiBGaW5kIHRoZSBmaXJzdCBpbmRleCBmb3Igd2hpY2ggYSBwcmVkaWNhdGUgaG9sZHNcbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgZmluZEluZGV4IH0gZnJvbSAnZnAtdHMvUmVhZG9ubHlBcnJheSdcbiAqIGltcG9ydCB7IHNvbWUsIG5vbmUgfSBmcm9tICdmcC10cy9PcHRpb24nXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChmaW5kSW5kZXgoKG46IG51bWJlcikgPT4gbiA9PT0gMikoWzEsIDIsIDNdKSwgc29tZSgxKSlcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoZmluZEluZGV4KChuOiBudW1iZXIpID0+IG4gPT09IDIpKFtdKSwgbm9uZSlcbiAqXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBmaW5kSW5kZXggPSBmdW5jdGlvbiAocHJlZGljYXRlKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykge1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGFzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICBpZiAocHJlZGljYXRlKGFzW2ldKSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBfLnNvbWUoaSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIF8ubm9uZTtcbiAgICB9O1xufTtcbmV4cG9ydCBmdW5jdGlvbiBmaW5kRmlyc3QocHJlZGljYXRlKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykge1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGFzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICBpZiAocHJlZGljYXRlKGFzW2ldKSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBfLnNvbWUoYXNbaV0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBfLm5vbmU7XG4gICAgfTtcbn1cbi8qKlxuICogRmluZCB0aGUgZmlyc3QgZWxlbWVudCByZXR1cm5lZCBieSBhbiBvcHRpb24gYmFzZWQgc2VsZWN0b3IgZnVuY3Rpb25cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgZmluZEZpcnN0TWFwIH0gZnJvbSAnZnAtdHMvUmVhZG9ubHlBcnJheSdcbiAqIGltcG9ydCB7IHNvbWUsIG5vbmUgfSBmcm9tICdmcC10cy9PcHRpb24nXG4gKlxuICogaW50ZXJmYWNlIFBlcnNvbiB7XG4gKiAgIHJlYWRvbmx5IG5hbWU6IHN0cmluZ1xuICogICByZWFkb25seSBhZ2U/OiBudW1iZXJcbiAqIH1cbiAqXG4gKiBjb25zdCBwZXJzb25zOiBSZWFkb25seUFycmF5PFBlcnNvbj4gPSBbeyBuYW1lOiAnSm9obicgfSwgeyBuYW1lOiAnTWFyeScsIGFnZTogNDUgfSwgeyBuYW1lOiAnSm9leScsIGFnZTogMjggfV1cbiAqXG4gKiAvLyByZXR1cm5zIHRoZSBuYW1lIG9mIHRoZSBmaXJzdCBwZXJzb24gdGhhdCBoYXMgYW4gYWdlXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKGZpbmRGaXJzdE1hcCgocDogUGVyc29uKSA9PiAocC5hZ2UgPT09IHVuZGVmaW5lZCA/IG5vbmUgOiBzb21lKHAubmFtZSkpKShwZXJzb25zKSwgc29tZSgnTWFyeScpKVxuICpcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIGZpbmRGaXJzdE1hcCA9IGZ1bmN0aW9uIChmKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykge1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGFzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICB2YXIgb3V0ID0gZihhc1tpXSk7XG4gICAgICAgICAgICBpZiAoXy5pc1NvbWUob3V0KSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBvdXQ7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIF8ubm9uZTtcbiAgICB9O1xufTtcbmV4cG9ydCBmdW5jdGlvbiBmaW5kTGFzdChwcmVkaWNhdGUpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIGZvciAodmFyIGkgPSBhcy5sZW5ndGggLSAxOyBpID49IDA7IGktLSkge1xuICAgICAgICAgICAgaWYgKHByZWRpY2F0ZShhc1tpXSkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gXy5zb21lKGFzW2ldKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gXy5ub25lO1xuICAgIH07XG59XG4vKipcbiAqIEZpbmQgdGhlIGxhc3QgZWxlbWVudCByZXR1cm5lZCBieSBhbiBvcHRpb24gYmFzZWQgc2VsZWN0b3IgZnVuY3Rpb25cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgZmluZExhc3RNYXAgfSBmcm9tICdmcC10cy9SZWFkb25seUFycmF5J1xuICogaW1wb3J0IHsgc29tZSwgbm9uZSB9IGZyb20gJ2ZwLXRzL09wdGlvbidcbiAqXG4gKiBpbnRlcmZhY2UgUGVyc29uIHtcbiAqICAgcmVhZG9ubHkgbmFtZTogc3RyaW5nXG4gKiAgIHJlYWRvbmx5IGFnZT86IG51bWJlclxuICogfVxuICpcbiAqIGNvbnN0IHBlcnNvbnM6IFJlYWRvbmx5QXJyYXk8UGVyc29uPiA9IFt7IG5hbWU6ICdKb2huJyB9LCB7IG5hbWU6ICdNYXJ5JywgYWdlOiA0NSB9LCB7IG5hbWU6ICdKb2V5JywgYWdlOiAyOCB9XVxuICpcbiAqIC8vIHJldHVybnMgdGhlIG5hbWUgb2YgdGhlIGxhc3QgcGVyc29uIHRoYXQgaGFzIGFuIGFnZVxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChmaW5kTGFzdE1hcCgocDogUGVyc29uKSA9PiAocC5hZ2UgPT09IHVuZGVmaW5lZCA/IG5vbmUgOiBzb21lKHAubmFtZSkpKShwZXJzb25zKSwgc29tZSgnSm9leScpKVxuICpcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIGZpbmRMYXN0TWFwID0gZnVuY3Rpb24gKGYpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIGZvciAodmFyIGkgPSBhcy5sZW5ndGggLSAxOyBpID49IDA7IGktLSkge1xuICAgICAgICAgICAgdmFyIG91dCA9IGYoYXNbaV0pO1xuICAgICAgICAgICAgaWYgKF8uaXNTb21lKG91dCkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gb3V0O1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBfLm5vbmU7XG4gICAgfTtcbn07XG4vKipcbiAqIFJldHVybnMgdGhlIGluZGV4IG9mIHRoZSBsYXN0IGVsZW1lbnQgb2YgdGhlIGxpc3Qgd2hpY2ggbWF0Y2hlcyB0aGUgcHJlZGljYXRlXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IGZpbmRMYXN0SW5kZXggfSBmcm9tICdmcC10cy9SZWFkb25seUFycmF5J1xuICogaW1wb3J0IHsgc29tZSwgbm9uZSB9IGZyb20gJ2ZwLXRzL09wdGlvbidcbiAqXG4gKiBpbnRlcmZhY2UgWCB7XG4gKiAgIHJlYWRvbmx5IGE6IG51bWJlclxuICogICByZWFkb25seSBiOiBudW1iZXJcbiAqIH1cbiAqIGNvbnN0IHhzOiBSZWFkb25seUFycmF5PFg+ID0gW3sgYTogMSwgYjogMCB9LCB7IGE6IDEsIGI6IDEgfV1cbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoZmluZExhc3RJbmRleCgoeDogeyByZWFkb25seSBhOiBudW1iZXIgfSkgPT4geC5hID09PSAxKSh4cyksIHNvbWUoMSkpXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKGZpbmRMYXN0SW5kZXgoKHg6IHsgcmVhZG9ubHkgYTogbnVtYmVyIH0pID0+IHguYSA9PT0gNCkoeHMpLCBub25lKVxuICpcbiAqXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBmaW5kTGFzdEluZGV4ID0gZnVuY3Rpb24gKHByZWRpY2F0ZSkge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgZm9yICh2YXIgaSA9IGFzLmxlbmd0aCAtIDE7IGkgPj0gMDsgaS0tKSB7XG4gICAgICAgICAgICBpZiAocHJlZGljYXRlKGFzW2ldKSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBfLnNvbWUoaSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIF8ubm9uZTtcbiAgICB9O1xufTtcbi8qKlxuICogSW5zZXJ0IGFuIGVsZW1lbnQgYXQgdGhlIHNwZWNpZmllZCBpbmRleCwgY3JlYXRpbmcgYSBuZXcgYXJyYXksIG9yIHJldHVybmluZyBgTm9uZWAgaWYgdGhlIGluZGV4IGlzIG91dCBvZiBib3VuZHNcbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgaW5zZXJ0QXQgfSBmcm9tICdmcC10cy9SZWFkb25seUFycmF5J1xuICogaW1wb3J0IHsgc29tZSB9IGZyb20gJ2ZwLXRzL09wdGlvbidcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKGluc2VydEF0KDIsIDUpKFsxLCAyLCAzLCA0XSksIHNvbWUoWzEsIDIsIDUsIDMsIDRdKSlcbiAqXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBpbnNlcnRBdCA9IGZ1bmN0aW9uIChpLCBhKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykge1xuICAgICAgICByZXR1cm4gaSA8IDAgfHwgaSA+IGFzLmxlbmd0aCA/IF8ubm9uZSA6IF8uc29tZShSTkVBLnVuc2FmZUluc2VydEF0KGksIGEsIGFzKSk7XG4gICAgfTtcbn07XG4vKipcbiAqIENoYW5nZSB0aGUgZWxlbWVudCBhdCB0aGUgc3BlY2lmaWVkIGluZGV4LCBjcmVhdGluZyBhIG5ldyBhcnJheSwgb3IgcmV0dXJuaW5nIGBOb25lYCBpZiB0aGUgaW5kZXggaXMgb3V0IG9mIGJvdW5kc1xuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyB1cGRhdGVBdCB9IGZyb20gJ2ZwLXRzL1JlYWRvbmx5QXJyYXknXG4gKiBpbXBvcnQgeyBzb21lLCBub25lIH0gZnJvbSAnZnAtdHMvT3B0aW9uJ1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwodXBkYXRlQXQoMSwgMSkoWzEsIDIsIDNdKSwgc29tZShbMSwgMSwgM10pKVxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbCh1cGRhdGVBdCgxLCAxKShbXSksIG5vbmUpXG4gKlxuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgdXBkYXRlQXQgPSBmdW5jdGlvbiAoaSwgYSkge1xuICAgIHJldHVybiBtb2RpZnlBdChpLCBmdW5jdGlvbiAoKSB7IHJldHVybiBhOyB9KTtcbn07XG4vKipcbiAqIERlbGV0ZSB0aGUgZWxlbWVudCBhdCB0aGUgc3BlY2lmaWVkIGluZGV4LCBjcmVhdGluZyBhIG5ldyBhcnJheSwgb3IgcmV0dXJuaW5nIGBOb25lYCBpZiB0aGUgaW5kZXggaXMgb3V0IG9mIGJvdW5kc1xuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBkZWxldGVBdCB9IGZyb20gJ2ZwLXRzL1JlYWRvbmx5QXJyYXknXG4gKiBpbXBvcnQgeyBzb21lLCBub25lIH0gZnJvbSAnZnAtdHMvT3B0aW9uJ1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoZGVsZXRlQXQoMCkoWzEsIDIsIDNdKSwgc29tZShbMiwgM10pKVxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChkZWxldGVBdCgxKShbXSksIG5vbmUpXG4gKlxuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgZGVsZXRlQXQgPSBmdW5jdGlvbiAoaSkge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgcmV0dXJuIGlzT3V0T2ZCb3VuZChpLCBhcykgPyBfLm5vbmUgOiBfLnNvbWUodW5zYWZlRGVsZXRlQXQoaSwgYXMpKTtcbiAgICB9O1xufTtcbi8qKlxuICogQXBwbHkgYSBmdW5jdGlvbiB0byB0aGUgZWxlbWVudCBhdCB0aGUgc3BlY2lmaWVkIGluZGV4LCBjcmVhdGluZyBhIG5ldyBhcnJheSwgb3IgcmV0dXJuaW5nIGBOb25lYCBpZiB0aGUgaW5kZXggaXMgb3V0XG4gKiBvZiBib3VuZHNcbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgbW9kaWZ5QXQgfSBmcm9tICdmcC10cy9SZWFkb25seUFycmF5J1xuICogaW1wb3J0IHsgc29tZSwgbm9uZSB9IGZyb20gJ2ZwLXRzL09wdGlvbidcbiAqXG4gKiBjb25zdCBkb3VibGUgPSAoeDogbnVtYmVyKTogbnVtYmVyID0+IHggKiAyXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKG1vZGlmeUF0KDEsIGRvdWJsZSkoWzEsIDIsIDNdKSwgc29tZShbMSwgNCwgM10pKVxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChtb2RpZnlBdCgxLCBkb3VibGUpKFtdKSwgbm9uZSlcbiAqXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBtb2RpZnlBdCA9IGZ1bmN0aW9uIChpLCBmKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykge1xuICAgICAgICByZXR1cm4gaXNPdXRPZkJvdW5kKGksIGFzKSA/IF8ubm9uZSA6IF8uc29tZSh1bnNhZmVVcGRhdGVBdChpLCBmKGFzW2ldKSwgYXMpKTtcbiAgICB9O1xufTtcbi8qKlxuICogUmV2ZXJzZSBhbiBhcnJheSwgY3JlYXRpbmcgYSBuZXcgYXJyYXlcbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgcmV2ZXJzZSB9IGZyb20gJ2ZwLXRzL1JlYWRvbmx5QXJyYXknXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChyZXZlcnNlKFsxLCAyLCAzXSksIFszLCAyLCAxXSlcbiAqXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciByZXZlcnNlID0gZnVuY3Rpb24gKGFzKSB7IHJldHVybiAoYXMubGVuZ3RoIDw9IDEgPyBhcyA6IGFzLnNsaWNlKCkucmV2ZXJzZSgpKTsgfTtcbi8qKlxuICogRXh0cmFjdHMgZnJvbSBhbiBhcnJheSBvZiBgRWl0aGVyYCBhbGwgdGhlIGBSaWdodGAgZWxlbWVudHMuIEFsbCB0aGUgYFJpZ2h0YCBlbGVtZW50cyBhcmUgZXh0cmFjdGVkIGluIG9yZGVyXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IHJpZ2h0cyB9IGZyb20gJ2ZwLXRzL1JlYWRvbmx5QXJyYXknXG4gKiBpbXBvcnQgeyByaWdodCwgbGVmdCB9IGZyb20gJ2ZwLXRzL0VpdGhlcidcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKHJpZ2h0cyhbcmlnaHQoMSksIGxlZnQoJ2ZvbycpLCByaWdodCgyKV0pLCBbMSwgMl0pXG4gKlxuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgcmlnaHRzID0gZnVuY3Rpb24gKGFzKSB7XG4gICAgdmFyIHIgPSBbXTtcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IGFzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIHZhciBhID0gYXNbaV07XG4gICAgICAgIGlmIChhLl90YWcgPT09ICdSaWdodCcpIHtcbiAgICAgICAgICAgIHIucHVzaChhLnJpZ2h0KTtcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gcjtcbn07XG4vKipcbiAqIEV4dHJhY3RzIGZyb20gYW4gYXJyYXkgb2YgYEVpdGhlcmAgYWxsIHRoZSBgTGVmdGAgZWxlbWVudHMuIEFsbCB0aGUgYExlZnRgIGVsZW1lbnRzIGFyZSBleHRyYWN0ZWQgaW4gb3JkZXJcbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgbGVmdHMgfSBmcm9tICdmcC10cy9SZWFkb25seUFycmF5J1xuICogaW1wb3J0IHsgbGVmdCwgcmlnaHQgfSBmcm9tICdmcC10cy9FaXRoZXInXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChsZWZ0cyhbcmlnaHQoMSksIGxlZnQoJ2ZvbycpLCByaWdodCgyKV0pLCBbJ2ZvbyddKVxuICpcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIGxlZnRzID0gZnVuY3Rpb24gKGFzKSB7XG4gICAgdmFyIHIgPSBbXTtcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IGFzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIHZhciBhID0gYXNbaV07XG4gICAgICAgIGlmIChhLl90YWcgPT09ICdMZWZ0Jykge1xuICAgICAgICAgICAgci5wdXNoKGEubGVmdCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHI7XG59O1xuLyoqXG4gKiBTb3J0IHRoZSBlbGVtZW50cyBvZiBhbiBhcnJheSBpbiBpbmNyZWFzaW5nIG9yZGVyLCBjcmVhdGluZyBhIG5ldyBhcnJheVxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBzb3J0IH0gZnJvbSAnZnAtdHMvUmVhZG9ubHlBcnJheSdcbiAqIGltcG9ydCAqIGFzIE4gZnJvbSAnZnAtdHMvbnVtYmVyJ1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoc29ydChOLk9yZCkoWzMsIDIsIDFdKSwgWzEsIDIsIDNdKVxuICpcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIHNvcnQgPSBmdW5jdGlvbiAoTykge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgcmV0dXJuIGFzLmxlbmd0aCA8PSAxID8gYXMgOiBhcy5zbGljZSgpLnNvcnQoTy5jb21wYXJlKTtcbiAgICB9O1xufTtcbi8vIFRPRE86IGN1cnJ5IGFuZCBtYWtlIGRhdGEtbGFzdCBpbiB2M1xuLyoqXG4gKiBBcHBseSBhIGZ1bmN0aW9uIHRvIHBhaXJzIG9mIGVsZW1lbnRzIGF0IHRoZSBzYW1lIGluZGV4IGluIHR3byBhcnJheXMsIGNvbGxlY3RpbmcgdGhlIHJlc3VsdHMgaW4gYSBuZXcgYXJyYXkuIElmIG9uZVxuICogaW5wdXQgYXJyYXkgaXMgc2hvcnQsIGV4Y2VzcyBlbGVtZW50cyBvZiB0aGUgbG9uZ2VyIGFycmF5IGFyZSBkaXNjYXJkZWQuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IHppcFdpdGggfSBmcm9tICdmcC10cy9SZWFkb25seUFycmF5J1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoemlwV2l0aChbMSwgMiwgM10sIFsnYScsICdiJywgJ2MnLCAnZCddLCAobiwgcykgPT4gcyArIG4pLCBbJ2ExJywgJ2IyJywgJ2MzJ10pXG4gKlxuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgemlwV2l0aCA9IGZ1bmN0aW9uIChmYSwgZmIsIGYpIHtcbiAgICB2YXIgZmMgPSBbXTtcbiAgICB2YXIgbGVuID0gTWF0aC5taW4oZmEubGVuZ3RoLCBmYi5sZW5ndGgpO1xuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbGVuOyBpKyspIHtcbiAgICAgICAgZmNbaV0gPSBmKGZhW2ldLCBmYltpXSk7XG4gICAgfVxuICAgIHJldHVybiBmYztcbn07XG5leHBvcnQgZnVuY3Rpb24gemlwKGFzLCBicykge1xuICAgIGlmIChicyA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgIHJldHVybiBmdW5jdGlvbiAoYnMpIHsgcmV0dXJuIHppcChicywgYXMpOyB9O1xuICAgIH1cbiAgICByZXR1cm4gemlwV2l0aChhcywgYnMsIGZ1bmN0aW9uIChhLCBiKSB7IHJldHVybiBbYSwgYl07IH0pO1xufVxuLyoqXG4gKiBUaGUgZnVuY3Rpb24gaXMgcmV2ZXJzZSBvZiBgemlwYC4gVGFrZXMgYW4gYXJyYXkgb2YgcGFpcnMgYW5kIHJldHVybiB0d28gY29ycmVzcG9uZGluZyBhcnJheXNcbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgdW56aXAgfSBmcm9tICdmcC10cy9SZWFkb25seUFycmF5J1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwodW56aXAoW1sxLCAnYSddLCBbMiwgJ2InXSwgWzMsICdjJ11dKSwgW1sxLCAyLCAzXSwgWydhJywgJ2InLCAnYyddXSlcbiAqXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciB1bnppcCA9IGZ1bmN0aW9uIChhcykge1xuICAgIHZhciBmYSA9IFtdO1xuICAgIHZhciBmYiA9IFtdO1xuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgYXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgZmFbaV0gPSBhc1tpXVswXTtcbiAgICAgICAgZmJbaV0gPSBhc1tpXVsxXTtcbiAgICB9XG4gICAgcmV0dXJuIFtmYSwgZmJdO1xufTtcbi8qKlxuICogUHJlcGVuZCBhbiBlbGVtZW50IHRvIGV2ZXJ5IG1lbWJlciBvZiBhbiBhcnJheVxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBwcmVwZW5kQWxsIH0gZnJvbSAnZnAtdHMvUmVhZG9ubHlBcnJheSdcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKHByZXBlbmRBbGwoOSkoWzEsIDIsIDMsIDRdKSwgWzksIDEsIDksIDIsIDksIDMsIDksIDRdKVxuICpcbiAqIEBzaW5jZSAyLjEwLjBcbiAqL1xuZXhwb3J0IHZhciBwcmVwZW5kQWxsID0gZnVuY3Rpb24gKG1pZGRsZSkge1xuICAgIHZhciBmID0gUk5FQS5wcmVwZW5kQWxsKG1pZGRsZSk7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykgeyByZXR1cm4gKGlzTm9uRW1wdHkoYXMpID8gZihhcykgOiBhcyk7IH07XG59O1xuLyoqXG4gKiBQbGFjZXMgYW4gZWxlbWVudCBpbiBiZXR3ZWVuIG1lbWJlcnMgb2YgYW4gYXJyYXlcbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgaW50ZXJzcGVyc2UgfSBmcm9tICdmcC10cy9SZWFkb25seUFycmF5J1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoaW50ZXJzcGVyc2UoOSkoWzEsIDIsIDMsIDRdKSwgWzEsIDksIDIsIDksIDMsIDksIDRdKVxuICpcbiAqIEBzaW5jZSAyLjkuMFxuICovXG5leHBvcnQgdmFyIGludGVyc3BlcnNlID0gZnVuY3Rpb24gKG1pZGRsZSkge1xuICAgIHZhciBmID0gUk5FQS5pbnRlcnNwZXJzZShtaWRkbGUpO1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHsgcmV0dXJuIChpc05vbkVtcHR5KGFzKSA/IGYoYXMpIDogYXMpOyB9O1xufTtcbi8qKlxuICogUm90YXRlIGEgYFJlYWRvbmx5QXJyYXlgIGJ5IGBuYCBzdGVwcy5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgcm90YXRlIH0gZnJvbSAnZnAtdHMvUmVhZG9ubHlBcnJheSdcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKHJvdGF0ZSgyKShbMSwgMiwgMywgNCwgNV0pLCBbNCwgNSwgMSwgMiwgM10pXG4gKlxuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgcm90YXRlID0gZnVuY3Rpb24gKG4pIHtcbiAgICB2YXIgZiA9IFJORUEucm90YXRlKG4pO1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHsgcmV0dXJuIChpc05vbkVtcHR5KGFzKSA/IGYoYXMpIDogYXMpOyB9O1xufTtcbmV4cG9ydCBmdW5jdGlvbiBlbGVtKEUpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGEsIGFzKSB7XG4gICAgICAgIGlmIChhcyA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICB2YXIgZWxlbUVfMSA9IGVsZW0oRSk7XG4gICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7IHJldHVybiBlbGVtRV8xKGEsIGFzKTsgfTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgcHJlZGljYXRlID0gZnVuY3Rpb24gKGVsZW1lbnQpIHsgcmV0dXJuIEUuZXF1YWxzKGVsZW1lbnQsIGEpOyB9O1xuICAgICAgICB2YXIgaSA9IDA7XG4gICAgICAgIGZvciAoOyBpIDwgYXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIGlmIChwcmVkaWNhdGUoYXNbaV0pKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH07XG59XG4vKipcbiAqIFJlbW92ZSBkdXBsaWNhdGVzIGZyb20gYW4gYXJyYXksIGtlZXBpbmcgdGhlIGZpcnN0IG9jY3VycmVuY2Ugb2YgYW4gZWxlbWVudC5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgdW5pcSB9IGZyb20gJ2ZwLXRzL1JlYWRvbmx5QXJyYXknXG4gKiBpbXBvcnQgKiBhcyBOIGZyb20gJ2ZwLXRzL251bWJlcidcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKHVuaXEoTi5FcSkoWzEsIDIsIDFdKSwgWzEsIDJdKVxuICpcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIHVuaXEgPSBmdW5jdGlvbiAoRSkge1xuICAgIHZhciBmID0gUk5FQS51bmlxKEUpO1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHsgcmV0dXJuIChpc05vbkVtcHR5KGFzKSA/IGYoYXMpIDogYXMpOyB9O1xufTtcbi8qKlxuICogU29ydCB0aGUgZWxlbWVudHMgb2YgYW4gYXJyYXkgaW4gaW5jcmVhc2luZyBvcmRlciwgd2hlcmUgZWxlbWVudHMgYXJlIGNvbXBhcmVkIHVzaW5nIGZpcnN0IGBvcmRzWzBdYCwgdGhlbiBgb3Jkc1sxXWAsXG4gKiBldGMuLi5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgc29ydEJ5IH0gZnJvbSAnZnAtdHMvUmVhZG9ubHlBcnJheSdcbiAqIGltcG9ydCB7IGNvbnRyYW1hcCB9IGZyb20gJ2ZwLXRzL09yZCdcbiAqIGltcG9ydCAqIGFzIFMgZnJvbSAnZnAtdHMvc3RyaW5nJ1xuICogaW1wb3J0ICogYXMgTiBmcm9tICdmcC10cy9udW1iZXInXG4gKiBpbXBvcnQgeyBwaXBlIH0gZnJvbSAnZnAtdHMvZnVuY3Rpb24nXG4gKlxuICogaW50ZXJmYWNlIFBlcnNvbiB7XG4gKiAgIHJlYWRvbmx5IG5hbWU6IHN0cmluZ1xuICogICByZWFkb25seSBhZ2U6IG51bWJlclxuICogfVxuICogY29uc3QgYnlOYW1lID0gcGlwZShTLk9yZCwgY29udHJhbWFwKChwOiBQZXJzb24pID0+IHAubmFtZSkpXG4gKiBjb25zdCBieUFnZSA9IHBpcGUoTi5PcmQsIGNvbnRyYW1hcCgocDogUGVyc29uKSA9PiBwLmFnZSkpXG4gKlxuICogY29uc3Qgc29ydEJ5TmFtZUJ5QWdlID0gc29ydEJ5KFtieU5hbWUsIGJ5QWdlXSlcbiAqXG4gKiBjb25zdCBwZXJzb25zID0gW3sgbmFtZTogJ2EnLCBhZ2U6IDEgfSwgeyBuYW1lOiAnYicsIGFnZTogMyB9LCB7IG5hbWU6ICdjJywgYWdlOiAyIH0sIHsgbmFtZTogJ2InLCBhZ2U6IDIgfV1cbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoc29ydEJ5TmFtZUJ5QWdlKHBlcnNvbnMpLCBbXG4gKiAgIHsgbmFtZTogJ2EnLCBhZ2U6IDEgfSxcbiAqICAgeyBuYW1lOiAnYicsIGFnZTogMiB9LFxuICogICB7IG5hbWU6ICdiJywgYWdlOiAzIH0sXG4gKiAgIHsgbmFtZTogJ2MnLCBhZ2U6IDIgfVxuICogXSlcbiAqXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBzb3J0QnkgPSBmdW5jdGlvbiAob3Jkcykge1xuICAgIHZhciBmID0gUk5FQS5zb3J0Qnkob3Jkcyk7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykgeyByZXR1cm4gKGlzTm9uRW1wdHkoYXMpID8gZihhcykgOiBhcyk7IH07XG59O1xuLyoqXG4gKiBBIHVzZWZ1bCByZWN1cnNpb24gcGF0dGVybiBmb3IgcHJvY2Vzc2luZyBhIGBSZWFkb25seUFycmF5YCB0byBwcm9kdWNlIGEgbmV3IGBSZWFkb25seUFycmF5YCwgb2Z0ZW4gdXNlZCBmb3IgXCJjaG9wcGluZ1wiIHVwIHRoZSBpbnB1dFxuICogYFJlYWRvbmx5QXJyYXlgLiBUeXBpY2FsbHkgYGNob3BgIGlzIGNhbGxlZCB3aXRoIHNvbWUgZnVuY3Rpb24gdGhhdCB3aWxsIGNvbnN1bWUgYW4gaW5pdGlhbCBwcmVmaXggb2YgdGhlIGBSZWFkb25seUFycmF5YCBhbmQgcHJvZHVjZSBhXG4gKiB2YWx1ZSBhbmQgdGhlIHRhaWwgb2YgdGhlIGBSZWFkb25seUFycmF5YC5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgRXEgfSBmcm9tICdmcC10cy9FcSdcbiAqIGltcG9ydCAqIGFzIFJBIGZyb20gJ2ZwLXRzL1JlYWRvbmx5QXJyYXknXG4gKiBpbXBvcnQgKiBhcyBOIGZyb20gJ2ZwLXRzL251bWJlcidcbiAqIGltcG9ydCB7IHBpcGUgfSBmcm9tICdmcC10cy9mdW5jdGlvbidcbiAqXG4gKiBjb25zdCBncm91cCA9IDxBPihTOiBFcTxBPik6ICgoYXM6IFJlYWRvbmx5QXJyYXk8QT4pID0+IFJlYWRvbmx5QXJyYXk8UmVhZG9ubHlBcnJheTxBPj4pID0+IHtcbiAqICAgcmV0dXJuIFJBLmNob3AoYXMgPT4ge1xuICogICAgIGNvbnN0IHsgaW5pdCwgcmVzdCB9ID0gcGlwZShhcywgUkEuc3BhbkxlZnQoKGE6IEEpID0+IFMuZXF1YWxzKGEsIGFzWzBdKSkpXG4gKiAgICAgcmV0dXJuIFtpbml0LCByZXN0XVxuICogICB9KVxuICogfVxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChncm91cChOLkVxKShbMSwgMSwgMiwgMywgMywgNF0pLCBbWzEsIDFdLCBbMl0sIFszLCAzXSwgWzRdXSlcbiAqXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBjaG9wID0gZnVuY3Rpb24gKGYpIHtcbiAgICB2YXIgZyA9IFJORUEuY2hvcChmKTtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7IHJldHVybiAoaXNOb25FbXB0eShhcykgPyBnKGFzKSA6IGVtcHR5KTsgfTtcbn07XG4vKipcbiAqIFNwbGl0cyBhIGBSZWFkb25seUFycmF5YCBpbnRvIHR3byBwaWVjZXMsIHRoZSBmaXJzdCBwaWVjZSBoYXMgbWF4IGBuYCBlbGVtZW50cy5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgc3BsaXRBdCB9IGZyb20gJ2ZwLXRzL1JlYWRvbmx5QXJyYXknXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChzcGxpdEF0KDIpKFsxLCAyLCAzLCA0LCA1XSksIFtbMSwgMl0sIFszLCA0LCA1XV0pXG4gKlxuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgc3BsaXRBdCA9IGZ1bmN0aW9uIChuKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykge1xuICAgICAgICByZXR1cm4gbiA+PSAxICYmIGlzTm9uRW1wdHkoYXMpID8gUk5FQS5zcGxpdEF0KG4pKGFzKSA6IGlzRW1wdHkoYXMpID8gW2FzLCBlbXB0eV0gOiBbZW1wdHksIGFzXTtcbiAgICB9O1xufTtcbi8qKlxuICogU3BsaXRzIGEgYFJlYWRvbmx5QXJyYXlgIGludG8gbGVuZ3RoLWBuYCBwaWVjZXMuIFRoZSBsYXN0IHBpZWNlIHdpbGwgYmUgc2hvcnRlciBpZiBgbmAgZG9lcyBub3QgZXZlbmx5IGRpdmlkZSB0aGUgbGVuZ3RoIG9mXG4gKiB0aGUgYFJlYWRvbmx5QXJyYXlgLiBOb3RlIHRoYXQgYGNodW5rc09mKG4pKFtdKWAgaXMgYFtdYCwgbm90IGBbW11dYC4gVGhpcyBpcyBpbnRlbnRpb25hbCwgYW5kIGlzIGNvbnNpc3RlbnQgd2l0aCBhIHJlY3Vyc2l2ZVxuICogZGVmaW5pdGlvbiBvZiBgY2h1bmtzT2ZgOyBpdCBzYXRpc2ZpZXMgdGhlIHByb3BlcnR5IHRoYXQ6XG4gKlxuICogYGBgdHNcbiAqIGNodW5rc09mKG4pKHhzKS5jb25jYXQoY2h1bmtzT2YobikoeXMpKSA9PSBjaHVua3NPZihuKSh4cy5jb25jYXQoeXMpKSlcbiAqIGBgYFxuICpcbiAqIHdoZW5ldmVyIGBuYCBldmVubHkgZGl2aWRlcyB0aGUgbGVuZ3RoIG9mIGBhc2AuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IGNodW5rc09mIH0gZnJvbSAnZnAtdHMvUmVhZG9ubHlBcnJheSdcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKGNodW5rc09mKDIpKFsxLCAyLCAzLCA0LCA1XSksIFtbMSwgMl0sIFszLCA0XSwgWzVdXSlcbiAqXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBjaHVua3NPZiA9IGZ1bmN0aW9uIChuKSB7XG4gICAgdmFyIGYgPSBSTkVBLmNodW5rc09mKG4pO1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHsgcmV0dXJuIChpc05vbkVtcHR5KGFzKSA/IGYoYXMpIDogZW1wdHkpOyB9O1xufTtcbi8qKlxuICogQGNhdGVnb3J5IGxpZnRpbmdcbiAqIEBzaW5jZSAyLjExLjBcbiAqL1xuZXhwb3J0IHZhciBmcm9tT3B0aW9uSyA9IGZ1bmN0aW9uIChmKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIGEgPSBbXTtcbiAgICAgICAgZm9yICh2YXIgX2kgPSAwOyBfaSA8IGFyZ3VtZW50cy5sZW5ndGg7IF9pKyspIHtcbiAgICAgICAgICAgIGFbX2ldID0gYXJndW1lbnRzW19pXTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gZnJvbU9wdGlvbihmLmFwcGx5KHZvaWQgMCwgYSkpO1xuICAgIH07XG59O1xuZXhwb3J0IGZ1bmN0aW9uIGNvbXByZWhlbnNpb24oaW5wdXQsIGYsIGcpIHtcbiAgICBpZiAoZyA9PT0gdm9pZCAwKSB7IGcgPSBmdW5jdGlvbiAoKSB7IHJldHVybiB0cnVlOyB9OyB9XG4gICAgdmFyIGdvID0gZnVuY3Rpb24gKHNjb3BlLCBpbnB1dCkge1xuICAgICAgICByZXR1cm4gaXNOb25FbXB0eShpbnB1dClcbiAgICAgICAgICAgID8gZmxhdE1hcChSTkVBLmhlYWQoaW5wdXQpLCBmdW5jdGlvbiAoYSkgeyByZXR1cm4gZ28ocGlwZShzY29wZSwgYXBwZW5kKGEpKSwgUk5FQS50YWlsKGlucHV0KSk7IH0pXG4gICAgICAgICAgICA6IGcuYXBwbHkodm9pZCAwLCBzY29wZSkgPyBbZi5hcHBseSh2b2lkIDAsIHNjb3BlKV1cbiAgICAgICAgICAgICAgICA6IGVtcHR5O1xuICAgIH07XG4gICAgcmV0dXJuIGdvKGVtcHR5LCBpbnB1dCk7XG59XG4vKipcbiAqIEBzaW5jZSAyLjExLjBcbiAqL1xuZXhwb3J0IHZhciBjb25jYXRXID0gZnVuY3Rpb24gKHNlY29uZCkge1xuICAgIHJldHVybiBmdW5jdGlvbiAoZmlyc3QpIHtcbiAgICAgICAgcmV0dXJuIGlzRW1wdHkoZmlyc3QpID8gc2Vjb25kIDogaXNFbXB0eShzZWNvbmQpID8gZmlyc3QgOiBmaXJzdC5jb25jYXQoc2Vjb25kKTtcbiAgICB9O1xufTtcbi8qKlxuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIGNvbmNhdCA9IGNvbmNhdFc7XG5leHBvcnQgZnVuY3Rpb24gdW5pb24oRSkge1xuICAgIHZhciB1bmlvbkUgPSBSTkVBLnVuaW9uKEUpO1xuICAgIHJldHVybiBmdW5jdGlvbiAoZmlyc3QsIHNlY29uZCkge1xuICAgICAgICBpZiAoc2Vjb25kID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIHZhciB1bmlvbkVfMSA9IHVuaW9uKEUpO1xuICAgICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIChzZWNvbmQpIHsgcmV0dXJuIHVuaW9uRV8xKHNlY29uZCwgZmlyc3QpOyB9O1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBpc05vbkVtcHR5KGZpcnN0KSAmJiBpc05vbkVtcHR5KHNlY29uZCkgPyB1bmlvbkUoc2Vjb25kKShmaXJzdCkgOiBpc05vbkVtcHR5KGZpcnN0KSA/IGZpcnN0IDogc2Vjb25kO1xuICAgIH07XG59XG5leHBvcnQgZnVuY3Rpb24gaW50ZXJzZWN0aW9uKEUpIHtcbiAgICB2YXIgZWxlbUUgPSBlbGVtKEUpO1xuICAgIHJldHVybiBmdW5jdGlvbiAoeHMsIHlzKSB7XG4gICAgICAgIGlmICh5cyA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICB2YXIgaW50ZXJzZWN0aW9uRV8xID0gaW50ZXJzZWN0aW9uKEUpO1xuICAgICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uICh5cykgeyByZXR1cm4gaW50ZXJzZWN0aW9uRV8xKHlzLCB4cyk7IH07XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHhzLmZpbHRlcihmdW5jdGlvbiAoYSkgeyByZXR1cm4gZWxlbUUoYSwgeXMpOyB9KTtcbiAgICB9O1xufVxuZXhwb3J0IGZ1bmN0aW9uIGRpZmZlcmVuY2UoRSkge1xuICAgIHZhciBlbGVtRSA9IGVsZW0oRSk7XG4gICAgcmV0dXJuIGZ1bmN0aW9uICh4cywgeXMpIHtcbiAgICAgICAgaWYgKHlzID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIHZhciBkaWZmZXJlbmNlRV8xID0gZGlmZmVyZW5jZShFKTtcbiAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbiAoeXMpIHsgcmV0dXJuIGRpZmZlcmVuY2VFXzEoeXMsIHhzKTsgfTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4geHMuZmlsdGVyKGZ1bmN0aW9uIChhKSB7IHJldHVybiAhZWxlbUUoYSwgeXMpOyB9KTtcbiAgICB9O1xufVxudmFyIF9tYXAgPSBmdW5jdGlvbiAoZmEsIGYpIHsgcmV0dXJuIHBpcGUoZmEsIG1hcChmKSk7IH07XG52YXIgX21hcFdpdGhJbmRleCA9IGZ1bmN0aW9uIChmYSwgZikgeyByZXR1cm4gcGlwZShmYSwgbWFwV2l0aEluZGV4KGYpKTsgfTtcbnZhciBfYXAgPSBmdW5jdGlvbiAoZmFiLCBmYSkgeyByZXR1cm4gcGlwZShmYWIsIGFwKGZhKSk7IH07XG52YXIgX2ZpbHRlciA9IGZ1bmN0aW9uIChmYSwgcHJlZGljYXRlKSB7XG4gICAgcmV0dXJuIHBpcGUoZmEsIGZpbHRlcihwcmVkaWNhdGUpKTtcbn07XG52YXIgX2ZpbHRlck1hcCA9IGZ1bmN0aW9uIChmYSwgZikgeyByZXR1cm4gcGlwZShmYSwgZmlsdGVyTWFwKGYpKTsgfTtcbnZhciBfcGFydGl0aW9uID0gZnVuY3Rpb24gKGZhLCBwcmVkaWNhdGUpIHtcbiAgICByZXR1cm4gcGlwZShmYSwgcGFydGl0aW9uKHByZWRpY2F0ZSkpO1xufTtcbnZhciBfcGFydGl0aW9uTWFwID0gZnVuY3Rpb24gKGZhLCBmKSB7IHJldHVybiBwaXBlKGZhLCBwYXJ0aXRpb25NYXAoZikpOyB9O1xudmFyIF9wYXJ0aXRpb25XaXRoSW5kZXggPSBmdW5jdGlvbiAoZmEsIHByZWRpY2F0ZVdpdGhJbmRleCkgeyByZXR1cm4gcGlwZShmYSwgcGFydGl0aW9uV2l0aEluZGV4KHByZWRpY2F0ZVdpdGhJbmRleCkpOyB9O1xudmFyIF9wYXJ0aXRpb25NYXBXaXRoSW5kZXggPSBmdW5jdGlvbiAoZmEsIGYpIHsgcmV0dXJuIHBpcGUoZmEsIHBhcnRpdGlvbk1hcFdpdGhJbmRleChmKSk7IH07XG52YXIgX2FsdCA9IGZ1bmN0aW9uIChmYSwgdGhhdCkgeyByZXR1cm4gcGlwZShmYSwgYWx0KHRoYXQpKTsgfTtcbnZhciBfcmVkdWNlID0gZnVuY3Rpb24gKGZhLCBiLCBmKSB7IHJldHVybiBwaXBlKGZhLCByZWR1Y2UoYiwgZikpOyB9O1xudmFyIF9mb2xkTWFwID0gZnVuY3Rpb24gKE0pIHtcbiAgICB2YXIgZm9sZE1hcE0gPSBmb2xkTWFwKE0pO1xuICAgIHJldHVybiBmdW5jdGlvbiAoZmEsIGYpIHsgcmV0dXJuIHBpcGUoZmEsIGZvbGRNYXBNKGYpKTsgfTtcbn07XG52YXIgX3JlZHVjZVJpZ2h0ID0gZnVuY3Rpb24gKGZhLCBiLCBmKSB7IHJldHVybiBwaXBlKGZhLCByZWR1Y2VSaWdodChiLCBmKSk7IH07XG52YXIgX3JlZHVjZVdpdGhJbmRleCA9IGZ1bmN0aW9uIChmYSwgYiwgZikge1xuICAgIHJldHVybiBwaXBlKGZhLCByZWR1Y2VXaXRoSW5kZXgoYiwgZikpO1xufTtcbnZhciBfZm9sZE1hcFdpdGhJbmRleCA9IGZ1bmN0aW9uIChNKSB7XG4gICAgdmFyIGZvbGRNYXBXaXRoSW5kZXhNID0gZm9sZE1hcFdpdGhJbmRleChNKTtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGZhLCBmKSB7IHJldHVybiBwaXBlKGZhLCBmb2xkTWFwV2l0aEluZGV4TShmKSk7IH07XG59O1xudmFyIF9yZWR1Y2VSaWdodFdpdGhJbmRleCA9IGZ1bmN0aW9uIChmYSwgYiwgZikge1xuICAgIHJldHVybiBwaXBlKGZhLCByZWR1Y2VSaWdodFdpdGhJbmRleChiLCBmKSk7XG59O1xudmFyIF9maWx0ZXJNYXBXaXRoSW5kZXggPSBmdW5jdGlvbiAoZmEsIGYpIHsgcmV0dXJuIHBpcGUoZmEsIGZpbHRlck1hcFdpdGhJbmRleChmKSk7IH07XG52YXIgX2ZpbHRlcldpdGhJbmRleCA9IGZ1bmN0aW9uIChmYSwgcHJlZGljYXRlV2l0aEluZGV4KSB7IHJldHVybiBwaXBlKGZhLCBmaWx0ZXJXaXRoSW5kZXgocHJlZGljYXRlV2l0aEluZGV4KSk7IH07XG52YXIgX2V4dGVuZCA9IGZ1bmN0aW9uIChmYSwgZikgeyByZXR1cm4gcGlwZShmYSwgZXh0ZW5kKGYpKTsgfTtcbnZhciBfdHJhdmVyc2UgPSBmdW5jdGlvbiAoRikge1xuICAgIHZhciB0cmF2ZXJzZUYgPSB0cmF2ZXJzZShGKTtcbiAgICByZXR1cm4gZnVuY3Rpb24gKHRhLCBmKSB7IHJldHVybiBwaXBlKHRhLCB0cmF2ZXJzZUYoZikpOyB9O1xufTtcbi8qIGlzdGFuYnVsIGlnbm9yZSBuZXh0ICovXG52YXIgX3RyYXZlcnNlV2l0aEluZGV4ID0gZnVuY3Rpb24gKEYpIHtcbiAgICB2YXIgdHJhdmVyc2VXaXRoSW5kZXhGID0gdHJhdmVyc2VXaXRoSW5kZXgoRik7XG4gICAgcmV0dXJuIGZ1bmN0aW9uICh0YSwgZikgeyByZXR1cm4gcGlwZSh0YSwgdHJhdmVyc2VXaXRoSW5kZXhGKGYpKTsgfTtcbn07XG4vKiogQGludGVybmFsICovXG5leHBvcnQgdmFyIF9jaGFpblJlY0RlcHRoRmlyc3QgPSBmdW5jdGlvbiAoYSwgZikgeyByZXR1cm4gcGlwZShhLCBjaGFpblJlY0RlcHRoRmlyc3QoZikpOyB9O1xuLyoqIEBpbnRlcm5hbCAqL1xuZXhwb3J0IHZhciBfY2hhaW5SZWNCcmVhZHRoRmlyc3QgPSBmdW5jdGlvbiAoYSwgZikgeyByZXR1cm4gcGlwZShhLCBjaGFpblJlY0JyZWFkdGhGaXJzdChmKSk7IH07XG4vKipcbiAqIEBjYXRlZ29yeSBjb25zdHJ1Y3RvcnNcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIG9mID0gUk5FQS5vZjtcbi8qKlxuICogQHNpbmNlIDIuNy4wXG4gKi9cbmV4cG9ydCB2YXIgemVybyA9IGZ1bmN0aW9uICgpIHsgcmV0dXJuIGVtcHR5OyB9O1xuLyoqXG4gKiBMZXNzIHN0cmljdCB2ZXJzaW9uIG9mIFtgYWx0YF0oI2FsdCkuXG4gKlxuICogVGhlIGBXYCBzdWZmaXggKHNob3J0IGZvciAqKlcqKmlkZW5pbmcpIG1lYW5zIHRoYXQgdGhlIHJldHVybiB0eXBlcyB3aWxsIGJlIG1lcmdlZC5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0ICogYXMgUkEgZnJvbSAnZnAtdHMvUmVhZG9ubHlBcnJheSdcbiAqIGltcG9ydCB7IHBpcGUgfSBmcm9tICdmcC10cy9mdW5jdGlvbidcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKFxuICogICBwaXBlKFxuICogICAgIFsxLCAyLCAzXSxcbiAqICAgICBSQS5hbHRXKCgpID0+IFsnYScsICdiJ10pXG4gKiAgICksXG4gKiAgIFsxLCAyLCAzLCAnYScsICdiJ11cbiAqIClcbiAqXG4gKiBAY2F0ZWdvcnkgZXJyb3IgaGFuZGxpbmdcbiAqIEBzaW5jZSAyLjkuMFxuICovXG5leHBvcnQgdmFyIGFsdFcgPSBmdW5jdGlvbiAodGhhdCkge1xuICAgIHJldHVybiBmdW5jdGlvbiAoZmEpIHtcbiAgICAgICAgcmV0dXJuIGZhLmNvbmNhdCh0aGF0KCkpO1xuICAgIH07XG59O1xuLyoqXG4gKiBJZGVudGlmaWVzIGFuIGFzc29jaWF0aXZlIG9wZXJhdGlvbiBvbiBhIHR5cGUgY29uc3RydWN0b3IuIEl0IGlzIHNpbWlsYXIgdG8gYFNlbWlncm91cGAsIGV4Y2VwdCB0aGF0IGl0IGFwcGxpZXMgdG9cbiAqIHR5cGVzIG9mIGtpbmQgYCogLT4gKmAuXG4gKlxuICogSW4gY2FzZSBvZiBgUmVhZG9ubHlBcnJheWAgY29uY2F0ZW5hdGVzIHRoZSBpbnB1dHMgaW50byBhIHNpbmdsZSBhcnJheS5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0ICogYXMgUkEgZnJvbSAnZnAtdHMvUmVhZG9ubHlBcnJheSdcbiAqIGltcG9ydCB7IHBpcGUgfSBmcm9tICdmcC10cy9mdW5jdGlvbidcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKFxuICogICBwaXBlKFxuICogICAgIFsxLCAyLCAzXSxcbiAqICAgICBSQS5hbHQoKCkgPT4gWzQsIDVdKVxuICogICApLFxuICogICBbMSwgMiwgMywgNCwgNV1cbiAqIClcbiAqXG4gKiBAY2F0ZWdvcnkgZXJyb3IgaGFuZGxpbmdcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIGFsdCA9IGFsdFc7XG4vKipcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIGFwID0gZnVuY3Rpb24gKGZhKSB7XG4gICAgcmV0dXJuIGZsYXRNYXAoZnVuY3Rpb24gKGYpIHsgcmV0dXJuIHBpcGUoZmEsIG1hcChmKSk7IH0pO1xufTtcbi8qKlxuICogQ29tcG9zZXMgY29tcHV0YXRpb25zIGluIHNlcXVlbmNlLCB1c2luZyB0aGUgcmV0dXJuIHZhbHVlIG9mIG9uZSBjb21wdXRhdGlvbiB0byBkZXRlcm1pbmUgdGhlIG5leHQgY29tcHV0YXRpb24uXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCAqIGFzIFJBIGZyb20gJ2ZwLXRzL1JlYWRvbmx5QXJyYXknXG4gKiBpbXBvcnQgeyBwaXBlIH0gZnJvbSAnZnAtdHMvZnVuY3Rpb24nXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChcbiAqICAgcGlwZShcbiAqICAgICBbMSwgMiwgM10sXG4gKiAgICAgUkEuZmxhdE1hcCgobikgPT4gW2BhJHtufWAsIGBiJHtufWBdKVxuICogICApLFxuICogICBbJ2ExJywgJ2IxJywgJ2EyJywgJ2IyJywgJ2EzJywgJ2IzJ11cbiAqIClcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoXG4gKiAgIHBpcGUoXG4gKiAgICAgWzEsIDIsIDNdLFxuICogICAgIFJBLmZsYXRNYXAoKCkgPT4gW10pXG4gKiAgICksXG4gKiAgIFtdXG4gKiApXG4gKlxuICogQGNhdGVnb3J5IHNlcXVlbmNpbmdcbiAqIEBzaW5jZSAyLjE0LjBcbiAqL1xuZXhwb3J0IHZhciBmbGF0TWFwID0gLyojX19QVVJFX18qLyBkdWFsKDIsIGZ1bmN0aW9uIChtYSwgZikge1xuICAgIHJldHVybiBwaXBlKG1hLCBjaGFpbldpdGhJbmRleChmdW5jdGlvbiAoaSwgYSkgeyByZXR1cm4gZihhLCBpKTsgfSkpO1xufSk7XG4vKipcbiAqIEBjYXRlZ29yeSBzZXF1ZW5jaW5nXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBmbGF0dGVuID0gLyojX19QVVJFX18qLyBmbGF0TWFwKGlkZW50aXR5KTtcbi8qKlxuICogYG1hcGAgY2FuIGJlIHVzZWQgdG8gdHVybiBmdW5jdGlvbnMgYChhOiBBKSA9PiBCYCBpbnRvIGZ1bmN0aW9ucyBgKGZhOiBGPEE+KSA9PiBGPEI+YCB3aG9zZSBhcmd1bWVudCBhbmQgcmV0dXJuIHR5cGVzXG4gKiB1c2UgdGhlIHR5cGUgY29uc3RydWN0b3IgYEZgIHRvIHJlcHJlc2VudCBzb21lIGNvbXB1dGF0aW9uYWwgY29udGV4dC5cbiAqXG4gKiBAY2F0ZWdvcnkgbWFwcGluZ1xuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgbWFwID0gZnVuY3Rpb24gKGYpIHsgcmV0dXJuIGZ1bmN0aW9uIChmYSkge1xuICAgIHJldHVybiBmYS5tYXAoZnVuY3Rpb24gKGEpIHsgcmV0dXJuIGYoYSk7IH0pO1xufTsgfTtcbi8qKlxuICogQGNhdGVnb3J5IG1hcHBpbmdcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIG1hcFdpdGhJbmRleCA9IGZ1bmN0aW9uIChmKSB7IHJldHVybiBmdW5jdGlvbiAoZmEpIHtcbiAgICByZXR1cm4gZmEubWFwKGZ1bmN0aW9uIChhLCBpKSB7IHJldHVybiBmKGksIGEpOyB9KTtcbn07IH07XG4vKipcbiAqIEBjYXRlZ29yeSBmaWx0ZXJpbmdcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIHNlcGFyYXRlID0gZnVuY3Rpb24gKGZhKSB7XG4gICAgdmFyIGxlZnQgPSBbXTtcbiAgICB2YXIgcmlnaHQgPSBbXTtcbiAgICBmb3IgKHZhciBfaSA9IDAsIGZhXzEgPSBmYTsgX2kgPCBmYV8xLmxlbmd0aDsgX2krKykge1xuICAgICAgICB2YXIgZSA9IGZhXzFbX2ldO1xuICAgICAgICBpZiAoZS5fdGFnID09PSAnTGVmdCcpIHtcbiAgICAgICAgICAgIGxlZnQucHVzaChlLmxlZnQpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgcmlnaHQucHVzaChlLnJpZ2h0KTtcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gc2VwYXJhdGVkKGxlZnQsIHJpZ2h0KTtcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBmaWx0ZXJpbmdcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIGZpbHRlciA9IGZ1bmN0aW9uIChwcmVkaWNhdGUpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIHJldHVybiBhcy5maWx0ZXIocHJlZGljYXRlKTtcbiAgICB9O1xufTtcbi8qKlxuICogQGNhdGVnb3J5IGZpbHRlcmluZ1xuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgZmlsdGVyTWFwV2l0aEluZGV4ID0gZnVuY3Rpb24gKGYpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGZhKSB7XG4gICAgICAgIHZhciBvdXQgPSBbXTtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBmYS5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgdmFyIG9wdGlvbkIgPSBmKGksIGZhW2ldKTtcbiAgICAgICAgICAgIGlmIChfLmlzU29tZShvcHRpb25CKSkge1xuICAgICAgICAgICAgICAgIG91dC5wdXNoKG9wdGlvbkIudmFsdWUpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBvdXQ7XG4gICAgfTtcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBmaWx0ZXJpbmdcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIGZpbHRlck1hcCA9IGZ1bmN0aW9uIChmKSB7XG4gICAgcmV0dXJuIGZpbHRlck1hcFdpdGhJbmRleChmdW5jdGlvbiAoXywgYSkgeyByZXR1cm4gZihhKTsgfSk7XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgZmlsdGVyaW5nXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBjb21wYWN0ID0gLyojX19QVVJFX18qLyBmaWx0ZXJNYXAoaWRlbnRpdHkpO1xuLyoqXG4gKiBAY2F0ZWdvcnkgZmlsdGVyaW5nXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBwYXJ0aXRpb24gPSBmdW5jdGlvbiAocHJlZGljYXRlKSB7XG4gICAgcmV0dXJuIHBhcnRpdGlvbldpdGhJbmRleChmdW5jdGlvbiAoXywgYSkgeyByZXR1cm4gcHJlZGljYXRlKGEpOyB9KTtcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBmaWx0ZXJpbmdcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIHBhcnRpdGlvbldpdGhJbmRleCA9IGZ1bmN0aW9uIChwcmVkaWNhdGVXaXRoSW5kZXgpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIHZhciBsZWZ0ID0gW107XG4gICAgICAgIHZhciByaWdodCA9IFtdO1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGFzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICB2YXIgYSA9IGFzW2ldO1xuICAgICAgICAgICAgaWYgKHByZWRpY2F0ZVdpdGhJbmRleChpLCBhKSkge1xuICAgICAgICAgICAgICAgIHJpZ2h0LnB1c2goYSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBsZWZ0LnB1c2goYSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHNlcGFyYXRlZChsZWZ0LCByaWdodCk7XG4gICAgfTtcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBmaWx0ZXJpbmdcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIHBhcnRpdGlvbk1hcCA9IGZ1bmN0aW9uIChmKSB7XG4gICAgcmV0dXJuIHBhcnRpdGlvbk1hcFdpdGhJbmRleChmdW5jdGlvbiAoXywgYSkgeyByZXR1cm4gZihhKTsgfSk7XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgZmlsdGVyaW5nXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBwYXJ0aXRpb25NYXBXaXRoSW5kZXggPSBmdW5jdGlvbiAoZikge1xuICAgIHJldHVybiBmdW5jdGlvbiAoZmEpIHtcbiAgICAgICAgdmFyIGxlZnQgPSBbXTtcbiAgICAgICAgdmFyIHJpZ2h0ID0gW107XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgZmEubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIHZhciBlID0gZihpLCBmYVtpXSk7XG4gICAgICAgICAgICBpZiAoZS5fdGFnID09PSAnTGVmdCcpIHtcbiAgICAgICAgICAgICAgICBsZWZ0LnB1c2goZS5sZWZ0KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHJpZ2h0LnB1c2goZS5yaWdodCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHNlcGFyYXRlZChsZWZ0LCByaWdodCk7XG4gICAgfTtcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBmaWx0ZXJpbmdcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIGZpbHRlcldpdGhJbmRleCA9IGZ1bmN0aW9uIChwcmVkaWNhdGVXaXRoSW5kZXgpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIHJldHVybiBhcy5maWx0ZXIoZnVuY3Rpb24gKGEsIGkpIHsgcmV0dXJuIHByZWRpY2F0ZVdpdGhJbmRleChpLCBhKTsgfSk7XG4gICAgfTtcbn07XG4vKipcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIGV4dGVuZCA9IGZ1bmN0aW9uIChmKSB7IHJldHVybiBmdW5jdGlvbiAod2EpIHtcbiAgICByZXR1cm4gd2EubWFwKGZ1bmN0aW9uIChfLCBpKSB7IHJldHVybiBmKHdhLnNsaWNlKGkpKTsgfSk7XG59OyB9O1xuLyoqXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBkdXBsaWNhdGUgPSAvKiNfX1BVUkVfXyovIGV4dGVuZChpZGVudGl0eSk7XG4vKipcbiAqIEBjYXRlZ29yeSBmb2xkaW5nXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBmb2xkTWFwV2l0aEluZGV4ID0gZnVuY3Rpb24gKE0pIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGYpIHtcbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIChmYSkge1xuICAgICAgICAgICAgcmV0dXJuIGZhLnJlZHVjZShmdW5jdGlvbiAoYiwgYSwgaSkgeyByZXR1cm4gTS5jb25jYXQoYiwgZihpLCBhKSk7IH0sIE0uZW1wdHkpO1xuICAgICAgICB9O1xuICAgIH07XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgZm9sZGluZ1xuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgcmVkdWNlID0gZnVuY3Rpb24gKGIsIGYpIHtcbiAgICByZXR1cm4gcmVkdWNlV2l0aEluZGV4KGIsIGZ1bmN0aW9uIChfLCBiLCBhKSB7IHJldHVybiBmKGIsIGEpOyB9KTtcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBmb2xkaW5nXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBmb2xkTWFwID0gZnVuY3Rpb24gKE0pIHtcbiAgICB2YXIgZm9sZE1hcFdpdGhJbmRleE0gPSBmb2xkTWFwV2l0aEluZGV4KE0pO1xuICAgIHJldHVybiBmdW5jdGlvbiAoZikgeyByZXR1cm4gZm9sZE1hcFdpdGhJbmRleE0oZnVuY3Rpb24gKF8sIGEpIHsgcmV0dXJuIGYoYSk7IH0pOyB9O1xufTtcbi8qKlxuICogQGNhdGVnb3J5IGZvbGRpbmdcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIHJlZHVjZVdpdGhJbmRleCA9IGZ1bmN0aW9uIChiLCBmKSB7IHJldHVybiBmdW5jdGlvbiAoZmEpIHtcbiAgICB2YXIgbGVuID0gZmEubGVuZ3RoO1xuICAgIHZhciBvdXQgPSBiO1xuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbGVuOyBpKyspIHtcbiAgICAgICAgb3V0ID0gZihpLCBvdXQsIGZhW2ldKTtcbiAgICB9XG4gICAgcmV0dXJuIG91dDtcbn07IH07XG4vKipcbiAqIEBjYXRlZ29yeSBmb2xkaW5nXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciByZWR1Y2VSaWdodCA9IGZ1bmN0aW9uIChiLCBmKSB7XG4gICAgcmV0dXJuIHJlZHVjZVJpZ2h0V2l0aEluZGV4KGIsIGZ1bmN0aW9uIChfLCBhLCBiKSB7IHJldHVybiBmKGEsIGIpOyB9KTtcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBmb2xkaW5nXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciByZWR1Y2VSaWdodFdpdGhJbmRleCA9IGZ1bmN0aW9uIChiLCBmKSB7IHJldHVybiBmdW5jdGlvbiAoZmEpIHtcbiAgICByZXR1cm4gZmEucmVkdWNlUmlnaHQoZnVuY3Rpb24gKGIsIGEsIGkpIHsgcmV0dXJuIGYoaSwgYSwgYik7IH0sIGIpO1xufTsgfTtcbi8qKlxuICogQGNhdGVnb3J5IHRyYXZlcnNpbmdcbiAqIEBzaW5jZSAyLjYuM1xuICovXG5leHBvcnQgdmFyIHRyYXZlcnNlID0gZnVuY3Rpb24gKEYpIHtcbiAgICB2YXIgdHJhdmVyc2VXaXRoSW5kZXhGID0gdHJhdmVyc2VXaXRoSW5kZXgoRik7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChmKSB7IHJldHVybiB0cmF2ZXJzZVdpdGhJbmRleEYoZnVuY3Rpb24gKF8sIGEpIHsgcmV0dXJuIGYoYSk7IH0pOyB9O1xufTtcbi8qKlxuICogQGNhdGVnb3J5IHRyYXZlcnNpbmdcbiAqIEBzaW5jZSAyLjYuM1xuICovXG5leHBvcnQgdmFyIHNlcXVlbmNlID0gZnVuY3Rpb24gKEYpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKHRhKSB7XG4gICAgICAgIHJldHVybiBfcmVkdWNlKHRhLCBGLm9mKHplcm8oKSksIGZ1bmN0aW9uIChmYXMsIGZhKSB7XG4gICAgICAgICAgICByZXR1cm4gRi5hcChGLm1hcChmYXMsIGZ1bmN0aW9uIChhcykgeyByZXR1cm4gZnVuY3Rpb24gKGEpIHsgcmV0dXJuIHBpcGUoYXMsIGFwcGVuZChhKSk7IH07IH0pLCBmYSk7XG4gICAgICAgIH0pO1xuICAgIH07XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgc2VxdWVuY2luZ1xuICogQHNpbmNlIDIuNi4zXG4gKi9cbmV4cG9ydCB2YXIgdHJhdmVyc2VXaXRoSW5kZXggPSBmdW5jdGlvbiAoRikge1xuICAgIHJldHVybiBmdW5jdGlvbiAoZikge1xuICAgICAgICByZXR1cm4gcmVkdWNlV2l0aEluZGV4KEYub2YoemVybygpKSwgZnVuY3Rpb24gKGksIGZicywgYSkge1xuICAgICAgICAgICAgcmV0dXJuIEYuYXAoRi5tYXAoZmJzLCBmdW5jdGlvbiAoYnMpIHsgcmV0dXJuIGZ1bmN0aW9uIChiKSB7IHJldHVybiBwaXBlKGJzLCBhcHBlbmQoYikpOyB9OyB9KSwgZihpLCBhKSk7XG4gICAgICAgIH0pO1xuICAgIH07XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgZmlsdGVyaW5nXG4gKiBAc2luY2UgMi42LjVcbiAqL1xuZXhwb3J0IHZhciB3aXRoZXIgPSBmdW5jdGlvbiAoRikge1xuICAgIHZhciBfd2l0aGVyRiA9IF93aXRoZXIoRik7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChmKSB7IHJldHVybiBmdW5jdGlvbiAoZmEpIHsgcmV0dXJuIF93aXRoZXJGKGZhLCBmKTsgfTsgfTtcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBmaWx0ZXJpbmdcbiAqIEBzaW5jZSAyLjYuNVxuICovXG5leHBvcnQgdmFyIHdpbHQgPSBmdW5jdGlvbiAoRikge1xuICAgIHZhciBfd2lsdEYgPSBfd2lsdChGKTtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGYpIHsgcmV0dXJuIGZ1bmN0aW9uIChmYSkgeyByZXR1cm4gX3dpbHRGKGZhLCBmKTsgfTsgfTtcbn07XG4vKipcbiAqIEBzaW5jZSAyLjYuNlxuICovXG5leHBvcnQgdmFyIHVuZm9sZCA9IGZ1bmN0aW9uIChiLCBmKSB7XG4gICAgdmFyIG91dCA9IFtdO1xuICAgIHZhciBiYiA9IGI7XG4gICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG5vLWNvbnN0YW50LWNvbmRpdGlvblxuICAgIHdoaWxlICh0cnVlKSB7XG4gICAgICAgIHZhciBtdCA9IGYoYmIpO1xuICAgICAgICBpZiAoXy5pc1NvbWUobXQpKSB7XG4gICAgICAgICAgICB2YXIgX2EgPSBtdC52YWx1ZSwgYSA9IF9hWzBdLCBiXzEgPSBfYVsxXTtcbiAgICAgICAgICAgIG91dC5wdXNoKGEpO1xuICAgICAgICAgICAgYmIgPSBiXzE7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gb3V0O1xufTtcbi8qKlxuICogQGNhdGVnb3J5IHR5cGUgbGFtYmRhc1xuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgVVJJID0gJ1JlYWRvbmx5QXJyYXknO1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBnZXRTaG93ID0gZnVuY3Rpb24gKFMpIHsgcmV0dXJuICh7XG4gICAgc2hvdzogZnVuY3Rpb24gKGFzKSB7IHJldHVybiBcIltcIi5jb25jYXQoYXMubWFwKFMuc2hvdykuam9pbignLCAnKSwgXCJdXCIpOyB9XG59KTsgfTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgZ2V0U2VtaWdyb3VwID0gZnVuY3Rpb24gKCkgeyByZXR1cm4gKHtcbiAgICBjb25jYXQ6IGZ1bmN0aW9uIChmaXJzdCwgc2Vjb25kKSB7IHJldHVybiAoaXNFbXB0eShmaXJzdCkgPyBzZWNvbmQgOiBpc0VtcHR5KHNlY29uZCkgPyBmaXJzdCA6IGZpcnN0LmNvbmNhdChzZWNvbmQpKTsgfVxufSk7IH07XG4vKipcbiAqIFJldHVybnMgYSBgTW9ub2lkYCBmb3IgYFJlYWRvbmx5QXJyYXk8QT5gLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBnZXRNb25vaWQgfSBmcm9tICdmcC10cy9SZWFkb25seUFycmF5J1xuICpcbiAqIGNvbnN0IE0gPSBnZXRNb25vaWQ8bnVtYmVyPigpXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKE0uY29uY2F0KFsxLCAyXSwgWzMsIDRdKSwgWzEsIDIsIDMsIDRdKVxuICpcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIGdldE1vbm9pZCA9IGZ1bmN0aW9uICgpIHsgcmV0dXJuICh7XG4gICAgY29uY2F0OiBnZXRTZW1pZ3JvdXAoKS5jb25jYXQsXG4gICAgZW1wdHk6IGVtcHR5XG59KTsgfTtcbi8qKlxuICogRGVyaXZlcyBhbiBgRXFgIG92ZXIgdGhlIGBSZWFkb25seUFycmF5YCBvZiBhIGdpdmVuIGVsZW1lbnQgdHlwZSBmcm9tIHRoZSBgRXFgIG9mIHRoYXQgdHlwZS4gVGhlIGRlcml2ZWQgYEVxYCBkZWZpbmVzIHR3b1xuICogYXJyYXlzIGFzIGVxdWFsIGlmIGFsbCBlbGVtZW50cyBvZiBib3RoIGFycmF5cyBhcmUgY29tcGFyZWQgZXF1YWwgcGFpcndpc2Ugd2l0aCB0aGUgZ2l2ZW4gYEVgLiBJbiBjYXNlIG9mIGFycmF5cyBvZlxuICogZGlmZmVyZW50IGxlbmd0aHMsIHRoZSByZXN1bHQgaXMgbm9uIGVxdWFsaXR5LlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgKiBhcyBTIGZyb20gJ2ZwLXRzL3N0cmluZydcbiAqIGltcG9ydCB7IGdldEVxIH0gZnJvbSAnZnAtdHMvUmVhZG9ubHlBcnJheSdcbiAqXG4gKiBjb25zdCBFID0gZ2V0RXEoUy5FcSlcbiAqIGFzc2VydC5zdHJpY3RFcXVhbChFLmVxdWFscyhbJ2EnLCAnYiddLCBbJ2EnLCAnYiddKSwgdHJ1ZSlcbiAqIGFzc2VydC5zdHJpY3RFcXVhbChFLmVxdWFscyhbJ2EnXSwgW10pLCBmYWxzZSlcbiAqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBnZXRFcSA9IGZ1bmN0aW9uIChFKSB7XG4gICAgcmV0dXJuIGZyb21FcXVhbHMoZnVuY3Rpb24gKHhzLCB5cykgeyByZXR1cm4geHMubGVuZ3RoID09PSB5cy5sZW5ndGggJiYgeHMuZXZlcnkoZnVuY3Rpb24gKHgsIGkpIHsgcmV0dXJuIEUuZXF1YWxzKHgsIHlzW2ldKTsgfSk7IH0pO1xufTtcbi8qKlxuICogRGVyaXZlcyBhbiBgT3JkYCBvdmVyIHRoZSBgUmVhZG9ubHlBcnJheWAgb2YgYSBnaXZlbiBlbGVtZW50IHR5cGUgZnJvbSB0aGUgYE9yZGAgb2YgdGhhdCB0eXBlLiBUaGUgb3JkZXJpbmcgYmV0d2VlbiB0d28gc3VjaFxuICogYXJyYXlzIGlzIGVxdWFsIHRvOiB0aGUgZmlyc3Qgbm9uIGVxdWFsIGNvbXBhcmlzb24gb2YgZWFjaCBhcnJheXMgZWxlbWVudHMgdGFrZW4gcGFpcndpc2UgaW4gaW5jcmVhc2luZyBvcmRlciwgaW5cbiAqIGNhc2Ugb2YgZXF1YWxpdHkgb3ZlciBhbGwgdGhlIHBhaXJ3aXNlIGVsZW1lbnRzOyB0aGUgbG9uZ2VzdCBhcnJheSBpcyBjb25zaWRlcmVkIHRoZSBncmVhdGVzdCwgaWYgYm90aCBhcnJheXMgaGF2ZVxuICogdGhlIHNhbWUgbGVuZ3RoLCB0aGUgcmVzdWx0IGlzIGVxdWFsaXR5LlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBnZXRPcmQgfSBmcm9tICdmcC10cy9SZWFkb25seUFycmF5J1xuICogaW1wb3J0ICogYXMgUyBmcm9tICdmcC10cy9zdHJpbmcnXG4gKlxuICogY29uc3QgTyA9IGdldE9yZChTLk9yZClcbiAqIGFzc2VydC5zdHJpY3RFcXVhbChPLmNvbXBhcmUoWydiJ10sIFsnYSddKSwgMSlcbiAqIGFzc2VydC5zdHJpY3RFcXVhbChPLmNvbXBhcmUoWydhJ10sIFsnYSddKSwgMClcbiAqIGFzc2VydC5zdHJpY3RFcXVhbChPLmNvbXBhcmUoWydhJ10sIFsnYiddKSwgLTEpXG4gKlxuICpcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIGdldE9yZCA9IGZ1bmN0aW9uIChPKSB7XG4gICAgcmV0dXJuIGZyb21Db21wYXJlKGZ1bmN0aW9uIChhLCBiKSB7XG4gICAgICAgIHZhciBhTGVuID0gYS5sZW5ndGg7XG4gICAgICAgIHZhciBiTGVuID0gYi5sZW5ndGg7XG4gICAgICAgIHZhciBsZW4gPSBNYXRoLm1pbihhTGVuLCBiTGVuKTtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBsZW47IGkrKykge1xuICAgICAgICAgICAgdmFyIG9yZGVyaW5nID0gTy5jb21wYXJlKGFbaV0sIGJbaV0pO1xuICAgICAgICAgICAgaWYgKG9yZGVyaW5nICE9PSAwKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG9yZGVyaW5nO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBOLk9yZC5jb21wYXJlKGFMZW4sIGJMZW4pO1xuICAgIH0pO1xufTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIGdldFVuaW9uU2VtaWdyb3VwID0gZnVuY3Rpb24gKEUpIHtcbiAgICB2YXIgdW5pb25FID0gdW5pb24oRSk7XG4gICAgcmV0dXJuIHtcbiAgICAgICAgY29uY2F0OiBmdW5jdGlvbiAoZmlyc3QsIHNlY29uZCkgeyByZXR1cm4gdW5pb25FKHNlY29uZCkoZmlyc3QpOyB9XG4gICAgfTtcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjExLjBcbiAqL1xuZXhwb3J0IHZhciBnZXRVbmlvbk1vbm9pZCA9IGZ1bmN0aW9uIChFKSB7IHJldHVybiAoe1xuICAgIGNvbmNhdDogZ2V0VW5pb25TZW1pZ3JvdXAoRSkuY29uY2F0LFxuICAgIGVtcHR5OiBlbXB0eVxufSk7IH07XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjExLjBcbiAqL1xuZXhwb3J0IHZhciBnZXRJbnRlcnNlY3Rpb25TZW1pZ3JvdXAgPSBmdW5jdGlvbiAoRSkge1xuICAgIHZhciBpbnRlcnNlY3Rpb25FID0gaW50ZXJzZWN0aW9uKEUpO1xuICAgIHJldHVybiB7XG4gICAgICAgIGNvbmNhdDogZnVuY3Rpb24gKGZpcnN0LCBzZWNvbmQpIHsgcmV0dXJuIGludGVyc2VjdGlvbkUoc2Vjb25kKShmaXJzdCk7IH1cbiAgICB9O1xufTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIGdldERpZmZlcmVuY2VNYWdtYSA9IGZ1bmN0aW9uIChFKSB7XG4gICAgdmFyIGRpZmZlcmVuY2VFID0gZGlmZmVyZW5jZShFKTtcbiAgICByZXR1cm4ge1xuICAgICAgICBjb25jYXQ6IGZ1bmN0aW9uIChmaXJzdCwgc2Vjb25kKSB7IHJldHVybiBkaWZmZXJlbmNlRShzZWNvbmQpKGZpcnN0KTsgfVxuICAgIH07XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi43LjBcbiAqL1xuZXhwb3J0IHZhciBGdW5jdG9yID0ge1xuICAgIFVSSTogVVJJLFxuICAgIG1hcDogX21hcFxufTtcbi8qKlxuICogQGNhdGVnb3J5IG1hcHBpbmdcbiAqIEBzaW5jZSAyLjEwLjBcbiAqL1xuZXhwb3J0IHZhciBmbGFwID0gLyojX19QVVJFX18qLyBmbGFwXyhGdW5jdG9yKTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuMTAuMFxuICovXG5leHBvcnQgdmFyIFBvaW50ZWQgPSB7XG4gICAgVVJJOiBVUkksXG4gICAgb2Y6IG9mXG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi43LjBcbiAqL1xuZXhwb3J0IHZhciBGdW5jdG9yV2l0aEluZGV4ID0ge1xuICAgIFVSSTogVVJJLFxuICAgIG1hcDogX21hcCxcbiAgICBtYXBXaXRoSW5kZXg6IF9tYXBXaXRoSW5kZXhcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjEwLjBcbiAqL1xuZXhwb3J0IHZhciBBcHBseSA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICBtYXA6IF9tYXAsXG4gICAgYXA6IF9hcFxufTtcbi8qKlxuICogQ29tYmluZSB0d28gZWZmZWN0ZnVsIGFjdGlvbnMsIGtlZXBpbmcgb25seSB0aGUgcmVzdWx0IG9mIHRoZSBmaXJzdC5cbiAqXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBhcEZpcnN0ID0gLyojX19QVVJFX18qLyBhcEZpcnN0XyhBcHBseSk7XG4vKipcbiAqIENvbWJpbmUgdHdvIGVmZmVjdGZ1bCBhY3Rpb25zLCBrZWVwaW5nIG9ubHkgdGhlIHJlc3VsdCBvZiB0aGUgc2Vjb25kLlxuICpcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIGFwU2Vjb25kID0gLyojX19QVVJFX18qLyBhcFNlY29uZF8oQXBwbHkpO1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi43LjBcbiAqL1xuZXhwb3J0IHZhciBBcHBsaWNhdGl2ZSA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICBtYXA6IF9tYXAsXG4gICAgYXA6IF9hcCxcbiAgICBvZjogb2Zcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjEwLjBcbiAqL1xuZXhwb3J0IHZhciBDaGFpbiA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICBtYXA6IF9tYXAsXG4gICAgYXA6IF9hcCxcbiAgICBjaGFpbjogZmxhdE1hcFxufTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuNy4wXG4gKi9cbmV4cG9ydCB2YXIgTW9uYWQgPSB7XG4gICAgVVJJOiBVUkksXG4gICAgbWFwOiBfbWFwLFxuICAgIGFwOiBfYXAsXG4gICAgb2Y6IG9mLFxuICAgIGNoYWluOiBmbGF0TWFwXG59O1xuLyoqXG4gKiBDb21wb3NlcyBjb21wdXRhdGlvbnMgaW4gc2VxdWVuY2UsIHVzaW5nIHRoZSByZXR1cm4gdmFsdWUgb2Ygb25lIGNvbXB1dGF0aW9uIHRvIGRldGVybWluZSB0aGUgbmV4dCBjb21wdXRhdGlvbiBhbmRcbiAqIGtlZXBpbmcgb25seSB0aGUgcmVzdWx0IG9mIHRoZSBmaXJzdC5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0ICogYXMgUkEgZnJvbSAnZnAtdHMvUmVhZG9ubHlBcnJheSdcbiAqIGltcG9ydCB7IHBpcGUgfSBmcm9tICdmcC10cy9mdW5jdGlvbidcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKFxuICogICBwaXBlKFxuICogICAgIFsxLCAyLCAzXSxcbiAqICAgICBSQS5jaGFpbkZpcnN0KCgpID0+IFsnYScsICdiJ10pXG4gKiAgICksXG4gKiAgIFsxLCAxLCAyLCAyLCAzLCAzXVxuICogKVxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChcbiAqICAgcGlwZShcbiAqICAgICBbMSwgMiwgM10sXG4gKiAgICAgUkEuY2hhaW5GaXJzdCgoKSA9PiBbXSlcbiAqICAgKSxcbiAqICAgW11cbiAqIClcbiAqXG4gKiBAY2F0ZWdvcnkgc2VxdWVuY2luZ1xuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgY2hhaW5GaXJzdCA9IFxuLyojX19QVVJFX18qLyBjaGFpbkZpcnN0XyhDaGFpbik7XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjcuMFxuICovXG5leHBvcnQgdmFyIFVuZm9sZGFibGUgPSB7XG4gICAgVVJJOiBVUkksXG4gICAgdW5mb2xkOiB1bmZvbGRcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjcuMFxuICovXG5leHBvcnQgdmFyIEFsdCA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICBtYXA6IF9tYXAsXG4gICAgYWx0OiBfYWx0XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi4xMS4wXG4gKi9cbmV4cG9ydCB2YXIgWmVybyA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICB6ZXJvOiB6ZXJvXG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgZG8gbm90YXRpb25cbiAqIEBzaW5jZSAyLjExLjBcbiAqL1xuZXhwb3J0IHZhciBndWFyZCA9IC8qI19fUFVSRV9fKi8gZ3VhcmRfKFplcm8sIFBvaW50ZWQpO1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi43LjBcbiAqL1xuZXhwb3J0IHZhciBBbHRlcm5hdGl2ZSA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICBtYXA6IF9tYXAsXG4gICAgYXA6IF9hcCxcbiAgICBvZjogb2YsXG4gICAgYWx0OiBfYWx0LFxuICAgIHplcm86IHplcm9cbn07XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjcuMFxuICovXG5leHBvcnQgdmFyIEV4dGVuZCA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICBtYXA6IF9tYXAsXG4gICAgZXh0ZW5kOiBfZXh0ZW5kXG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi43LjBcbiAqL1xuZXhwb3J0IHZhciBDb21wYWN0YWJsZSA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICBjb21wYWN0OiBjb21wYWN0LFxuICAgIHNlcGFyYXRlOiBzZXBhcmF0ZVxufTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuNy4wXG4gKi9cbmV4cG9ydCB2YXIgRmlsdGVyYWJsZSA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICBtYXA6IF9tYXAsXG4gICAgY29tcGFjdDogY29tcGFjdCxcbiAgICBzZXBhcmF0ZTogc2VwYXJhdGUsXG4gICAgZmlsdGVyOiBfZmlsdGVyLFxuICAgIGZpbHRlck1hcDogX2ZpbHRlck1hcCxcbiAgICBwYXJ0aXRpb246IF9wYXJ0aXRpb24sXG4gICAgcGFydGl0aW9uTWFwOiBfcGFydGl0aW9uTWFwXG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi43LjBcbiAqL1xuZXhwb3J0IHZhciBGaWx0ZXJhYmxlV2l0aEluZGV4ID0ge1xuICAgIFVSSTogVVJJLFxuICAgIG1hcDogX21hcCxcbiAgICBtYXBXaXRoSW5kZXg6IF9tYXBXaXRoSW5kZXgsXG4gICAgY29tcGFjdDogY29tcGFjdCxcbiAgICBzZXBhcmF0ZTogc2VwYXJhdGUsXG4gICAgZmlsdGVyOiBfZmlsdGVyLFxuICAgIGZpbHRlck1hcDogX2ZpbHRlck1hcCxcbiAgICBwYXJ0aXRpb246IF9wYXJ0aXRpb24sXG4gICAgcGFydGl0aW9uTWFwOiBfcGFydGl0aW9uTWFwLFxuICAgIHBhcnRpdGlvbk1hcFdpdGhJbmRleDogX3BhcnRpdGlvbk1hcFdpdGhJbmRleCxcbiAgICBwYXJ0aXRpb25XaXRoSW5kZXg6IF9wYXJ0aXRpb25XaXRoSW5kZXgsXG4gICAgZmlsdGVyTWFwV2l0aEluZGV4OiBfZmlsdGVyTWFwV2l0aEluZGV4LFxuICAgIGZpbHRlcldpdGhJbmRleDogX2ZpbHRlcldpdGhJbmRleFxufTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuNy4wXG4gKi9cbmV4cG9ydCB2YXIgRm9sZGFibGUgPSB7XG4gICAgVVJJOiBVUkksXG4gICAgcmVkdWNlOiBfcmVkdWNlLFxuICAgIGZvbGRNYXA6IF9mb2xkTWFwLFxuICAgIHJlZHVjZVJpZ2h0OiBfcmVkdWNlUmlnaHRcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjcuMFxuICovXG5leHBvcnQgdmFyIEZvbGRhYmxlV2l0aEluZGV4ID0ge1xuICAgIFVSSTogVVJJLFxuICAgIHJlZHVjZTogX3JlZHVjZSxcbiAgICBmb2xkTWFwOiBfZm9sZE1hcCxcbiAgICByZWR1Y2VSaWdodDogX3JlZHVjZVJpZ2h0LFxuICAgIHJlZHVjZVdpdGhJbmRleDogX3JlZHVjZVdpdGhJbmRleCxcbiAgICBmb2xkTWFwV2l0aEluZGV4OiBfZm9sZE1hcFdpdGhJbmRleCxcbiAgICByZWR1Y2VSaWdodFdpdGhJbmRleDogX3JlZHVjZVJpZ2h0V2l0aEluZGV4XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi43LjBcbiAqL1xuZXhwb3J0IHZhciBUcmF2ZXJzYWJsZSA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICBtYXA6IF9tYXAsXG4gICAgcmVkdWNlOiBfcmVkdWNlLFxuICAgIGZvbGRNYXA6IF9mb2xkTWFwLFxuICAgIHJlZHVjZVJpZ2h0OiBfcmVkdWNlUmlnaHQsXG4gICAgdHJhdmVyc2U6IF90cmF2ZXJzZSxcbiAgICBzZXF1ZW5jZTogc2VxdWVuY2Vcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjcuMFxuICovXG5leHBvcnQgdmFyIFRyYXZlcnNhYmxlV2l0aEluZGV4ID0ge1xuICAgIFVSSTogVVJJLFxuICAgIG1hcDogX21hcCxcbiAgICBtYXBXaXRoSW5kZXg6IF9tYXBXaXRoSW5kZXgsXG4gICAgcmVkdWNlOiBfcmVkdWNlLFxuICAgIGZvbGRNYXA6IF9mb2xkTWFwLFxuICAgIHJlZHVjZVJpZ2h0OiBfcmVkdWNlUmlnaHQsXG4gICAgcmVkdWNlV2l0aEluZGV4OiBfcmVkdWNlV2l0aEluZGV4LFxuICAgIGZvbGRNYXBXaXRoSW5kZXg6IF9mb2xkTWFwV2l0aEluZGV4LFxuICAgIHJlZHVjZVJpZ2h0V2l0aEluZGV4OiBfcmVkdWNlUmlnaHRXaXRoSW5kZXgsXG4gICAgdHJhdmVyc2U6IF90cmF2ZXJzZSxcbiAgICBzZXF1ZW5jZTogc2VxdWVuY2UsXG4gICAgdHJhdmVyc2VXaXRoSW5kZXg6IF90cmF2ZXJzZVdpdGhJbmRleFxufTtcbi8qKlxuICogQGNhdGVnb3J5IHNlcXVlbmNpbmdcbiAqIEBzaW5jZSAyLjExLjBcbiAqL1xuZXhwb3J0IHZhciBjaGFpblJlY0RlcHRoRmlyc3QgPSBmdW5jdGlvbiAoZikge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYSkge1xuICAgICAgICB2YXIgdG9kbyA9IF9fc3ByZWFkQXJyYXkoW10sIGYoYSksIHRydWUpO1xuICAgICAgICB2YXIgb3V0ID0gW107XG4gICAgICAgIHdoaWxlICh0b2RvLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgIHZhciBlID0gdG9kby5zaGlmdCgpO1xuICAgICAgICAgICAgaWYgKF8uaXNMZWZ0KGUpKSB7XG4gICAgICAgICAgICAgICAgdG9kby51bnNoaWZ0LmFwcGx5KHRvZG8sIGYoZS5sZWZ0KSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBvdXQucHVzaChlLnJpZ2h0KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gb3V0O1xuICAgIH07XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi4xMS4wXG4gKi9cbmV4cG9ydCB2YXIgQ2hhaW5SZWNEZXB0aEZpcnN0ID0ge1xuICAgIFVSSTogVVJJLFxuICAgIG1hcDogX21hcCxcbiAgICBhcDogX2FwLFxuICAgIGNoYWluOiBmbGF0TWFwLFxuICAgIGNoYWluUmVjOiBfY2hhaW5SZWNEZXB0aEZpcnN0XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgc2VxdWVuY2luZ1xuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIGNoYWluUmVjQnJlYWR0aEZpcnN0ID0gZnVuY3Rpb24gKGYpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGEpIHtcbiAgICAgICAgdmFyIGluaXRpYWwgPSBmKGEpO1xuICAgICAgICB2YXIgdG9kbyA9IFtdO1xuICAgICAgICB2YXIgb3V0ID0gW107XG4gICAgICAgIGZ1bmN0aW9uIGdvKGUpIHtcbiAgICAgICAgICAgIGlmIChfLmlzTGVmdChlKSkge1xuICAgICAgICAgICAgICAgIGYoZS5sZWZ0KS5mb3JFYWNoKGZ1bmN0aW9uICh2KSB7IHJldHVybiB0b2RvLnB1c2godik7IH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgb3V0LnB1c2goZS5yaWdodCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZm9yICh2YXIgX2kgPSAwLCBpbml0aWFsXzEgPSBpbml0aWFsOyBfaSA8IGluaXRpYWxfMS5sZW5ndGg7IF9pKyspIHtcbiAgICAgICAgICAgIHZhciBlID0gaW5pdGlhbF8xW19pXTtcbiAgICAgICAgICAgIGdvKGUpO1xuICAgICAgICB9XG4gICAgICAgIHdoaWxlICh0b2RvLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgIGdvKHRvZG8uc2hpZnQoKSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG91dDtcbiAgICB9O1xufTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIENoYWluUmVjQnJlYWR0aEZpcnN0ID0ge1xuICAgIFVSSTogVVJJLFxuICAgIG1hcDogX21hcCxcbiAgICBhcDogX2FwLFxuICAgIGNoYWluOiBmbGF0TWFwLFxuICAgIGNoYWluUmVjOiBfY2hhaW5SZWNCcmVhZHRoRmlyc3Rcbn07XG52YXIgX3dpdGhlciA9IC8qI19fUFVSRV9fKi8gd2l0aGVyRGVmYXVsdChUcmF2ZXJzYWJsZSwgQ29tcGFjdGFibGUpO1xudmFyIF93aWx0ID0gLyojX19QVVJFX18qLyB3aWx0RGVmYXVsdChUcmF2ZXJzYWJsZSwgQ29tcGFjdGFibGUpO1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi43LjBcbiAqL1xuZXhwb3J0IHZhciBXaXRoZXJhYmxlID0ge1xuICAgIFVSSTogVVJJLFxuICAgIG1hcDogX21hcCxcbiAgICBjb21wYWN0OiBjb21wYWN0LFxuICAgIHNlcGFyYXRlOiBzZXBhcmF0ZSxcbiAgICBmaWx0ZXI6IF9maWx0ZXIsXG4gICAgZmlsdGVyTWFwOiBfZmlsdGVyTWFwLFxuICAgIHBhcnRpdGlvbjogX3BhcnRpdGlvbixcbiAgICBwYXJ0aXRpb25NYXA6IF9wYXJ0aXRpb25NYXAsXG4gICAgcmVkdWNlOiBfcmVkdWNlLFxuICAgIGZvbGRNYXA6IF9mb2xkTWFwLFxuICAgIHJlZHVjZVJpZ2h0OiBfcmVkdWNlUmlnaHQsXG4gICAgdHJhdmVyc2U6IF90cmF2ZXJzZSxcbiAgICBzZXF1ZW5jZTogc2VxdWVuY2UsXG4gICAgd2l0aGVyOiBfd2l0aGVyLFxuICAgIHdpbHQ6IF93aWx0XG59O1xuLyoqXG4gKiBGaWx0ZXIgdmFsdWVzIGluc2lkZSBhIGNvbnRleHQuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IHBpcGUgfSBmcm9tICdmcC10cy9mdW5jdGlvbidcbiAqIGltcG9ydCAqIGFzIFJBIGZyb20gJ2ZwLXRzL1JlYWRvbmx5QXJyYXknXG4gKiBpbXBvcnQgKiBhcyBUIGZyb20gJ2ZwLXRzL1Rhc2snXG4gKlxuICogY29uc3QgZmlsdGVyRSA9IFJBLmZpbHRlckUoVC5BcHBsaWNhdGl2ZVBhcilcbiAqIGFzeW5jIGZ1bmN0aW9uIHRlc3QoKSB7XG4gKiAgIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoXG4gKiAgICAgYXdhaXQgcGlwZShcbiAqICAgICAgIFstMSwgMiwgM10sXG4gKiAgICAgICBmaWx0ZXJFKChuKSA9PiBULm9mKG4gPiAwKSlcbiAqICAgICApKCksXG4gKiAgICAgWzIsIDNdXG4gKiAgIClcbiAqIH1cbiAqIHRlc3QoKVxuICpcbiAqIEBzaW5jZSAyLjExLjBcbiAqL1xuZXhwb3J0IHZhciBmaWx0ZXJFID0gLyojX19QVVJFX18qLyBmaWx0ZXJFXyhXaXRoZXJhYmxlKTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIEZyb21FaXRoZXIgPSB7XG4gICAgVVJJOiBVUkksXG4gICAgZnJvbUVpdGhlcjogZnJvbUVpdGhlclxufTtcbi8qKlxuICogQGNhdGVnb3J5IGxpZnRpbmdcbiAqIEBzaW5jZSAyLjExLjBcbiAqL1xuZXhwb3J0IHZhciBmcm9tRWl0aGVySyA9IC8qI19fUFVSRV9fKi8gZnJvbUVpdGhlcktfKEZyb21FaXRoZXIpO1xuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLy8gdW5zYWZlXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vKipcbiAqIEBjYXRlZ29yeSB1bnNhZmVcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIHVuc2FmZUluc2VydEF0ID0gUk5FQS51bnNhZmVJbnNlcnRBdDtcbi8qKlxuICogQGNhdGVnb3J5IHVuc2FmZVxuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgdW5zYWZlVXBkYXRlQXQgPSBmdW5jdGlvbiAoaSwgYSwgYXMpIHtcbiAgICByZXR1cm4gaXNOb25FbXB0eShhcykgPyBSTkVBLnVuc2FmZVVwZGF0ZUF0KGksIGEsIGFzKSA6IGFzO1xufTtcbi8qKlxuICogQGNhdGVnb3J5IHVuc2FmZVxuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgdW5zYWZlRGVsZXRlQXQgPSBmdW5jdGlvbiAoaSwgYXMpIHtcbiAgICB2YXIgeHMgPSBhcy5zbGljZSgpO1xuICAgIHhzLnNwbGljZShpLCAxKTtcbiAgICByZXR1cm4geHM7XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgY29udmVyc2lvbnNcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIHRvQXJyYXkgPSBmdW5jdGlvbiAoYXMpIHsgcmV0dXJuIGFzLnNsaWNlKCk7IH07XG4vKipcbiAqIEBjYXRlZ29yeSBjb252ZXJzaW9uc1xuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgZnJvbUFycmF5ID0gZnVuY3Rpb24gKGFzKSB7IHJldHVybiAoaXNFbXB0eShhcykgPyBlbXB0eSA6IGFzLnNsaWNlKCkpOyB9O1xuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLy8gdXRpbHNcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8qKlxuICogQW4gZW1wdHkgYXJyYXlcbiAqXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBlbXB0eSA9IFJORUEuZW1wdHk7XG5leHBvcnQgZnVuY3Rpb24gZXZlcnkocHJlZGljYXRlKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykgeyByZXR1cm4gYXMuZXZlcnkocHJlZGljYXRlKTsgfTtcbn1cbi8qKlxuICogQ2hlY2sgaWYgYSBwcmVkaWNhdGUgaG9sZHMgdHJ1ZSBmb3IgYW55IGFycmF5IG1lbWJlci5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgc29tZSB9IGZyb20gJ2ZwLXRzL1JlYWRvbmx5QXJyYXknXG4gKiBpbXBvcnQgeyBwaXBlIH0gZnJvbSAnZnAtdHMvZnVuY3Rpb24nXG4gKlxuICogY29uc3QgaXNQb3NpdGl2ZSA9IChuOiBudW1iZXIpOiBib29sZWFuID0+IG4gPiAwXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChwaXBlKFstMSwgLTIsIDNdLCBzb21lKGlzUG9zaXRpdmUpKSwgdHJ1ZSlcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwocGlwZShbLTEsIC0yLCAtM10sIHNvbWUoaXNQb3NpdGl2ZSkpLCBmYWxzZSlcbiAqXG4gKiBAc2luY2UgMi45LjBcbiAqL1xuZXhwb3J0IHZhciBzb21lID0gZnVuY3Rpb24gKHByZWRpY2F0ZSkge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgcmV0dXJuIGFzLnNvbWUocHJlZGljYXRlKTtcbiAgICB9O1xufTtcbi8qKlxuICogQWxpYXMgb2YgW2Bzb21lYF0oI3NvbWUpXG4gKlxuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIGV4aXN0cyA9IHNvbWU7XG4vKipcbiAqIFBsYWNlcyBhbiBlbGVtZW50IGluIGJldHdlZW4gbWVtYmVycyBvZiBhIGBSZWFkb25seUFycmF5YCwgdGhlbiBmb2xkcyB0aGUgcmVzdWx0cyB1c2luZyB0aGUgcHJvdmlkZWQgYE1vbm9pZGAuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCAqIGFzIFMgZnJvbSAnZnAtdHMvc3RyaW5nJ1xuICogaW1wb3J0IHsgaW50ZXJjYWxhdGUgfSBmcm9tICdmcC10cy9SZWFkb25seUFycmF5J1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoaW50ZXJjYWxhdGUoUy5Nb25vaWQpKCctJykoWydhJywgJ2InLCAnYyddKSwgJ2EtYi1jJylcbiAqXG4gKiBAc2luY2UgMi4xMi4wXG4gKi9cbmV4cG9ydCB2YXIgaW50ZXJjYWxhdGUgPSBmdW5jdGlvbiAoTSkge1xuICAgIHZhciBpbnRlcmNhbGF0ZU0gPSBSTkVBLmludGVyY2FsYXRlKE0pO1xuICAgIHJldHVybiBmdW5jdGlvbiAobWlkZGxlKSB7IHJldHVybiBtYXRjaChmdW5jdGlvbiAoKSB7IHJldHVybiBNLmVtcHR5OyB9LCBpbnRlcmNhbGF0ZU0obWlkZGxlKSk7IH07XG59O1xuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLy8gZG8gbm90YXRpb25cbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8qKlxuICogQGNhdGVnb3J5IGRvIG5vdGF0aW9uXG4gKiBAc2luY2UgMi45LjBcbiAqL1xuZXhwb3J0IHZhciBEbyA9IC8qI19fUFVSRV9fKi8gb2YoXy5lbXB0eVJlY29yZCk7XG4vKipcbiAqIEBjYXRlZ29yeSBkbyBub3RhdGlvblxuICogQHNpbmNlIDIuOC4wXG4gKi9cbmV4cG9ydCB2YXIgYmluZFRvID0gLyojX19QVVJFX18qLyBiaW5kVG9fKEZ1bmN0b3IpO1xudmFyIGxldF8gPSAvKiNfX1BVUkVfXyovIGxldF9fKEZ1bmN0b3IpO1xuZXhwb3J0IHsgXG4vKipcbiAqIEBjYXRlZ29yeSBkbyBub3RhdGlvblxuICogQHNpbmNlIDIuMTMuMFxuICovXG5sZXRfIGFzIGxldCB9O1xuLyoqXG4gKiBAY2F0ZWdvcnkgZG8gbm90YXRpb25cbiAqIEBzaW5jZSAyLjguMFxuICovXG5leHBvcnQgdmFyIGJpbmQgPSAvKiNfX1BVUkVfXyovIGJpbmRfKENoYWluKTtcbi8qKlxuICogQGNhdGVnb3J5IGRvIG5vdGF0aW9uXG4gKiBAc2luY2UgMi44LjBcbiAqL1xuZXhwb3J0IHZhciBhcFMgPSAvKiNfX1BVUkVfXyovIGFwU18oQXBwbHkpO1xuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLy8gbGVnYWN5XG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vKipcbiAqIEFsaWFzIG9mIGBmbGF0TWFwYC5cbiAqXG4gKiBAY2F0ZWdvcnkgbGVnYWN5XG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBjaGFpbiA9IGZsYXRNYXA7XG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vLyBkZXByZWNhdGVkXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vKipcbiAqIFVzZSBgUmVhZG9ubHlOb25FbXB0eUFycmF5YCBtb2R1bGUgaW5zdGVhZC5cbiAqXG4gKiBAY2F0ZWdvcnkgem9uZSBvZiBkZWF0aFxuICogQHNpbmNlIDIuNS4wXG4gKiBAZGVwcmVjYXRlZFxuICovXG5leHBvcnQgdmFyIHJhbmdlID0gUk5FQS5yYW5nZTtcbi8qKlxuICogVXNlIFtgcHJlcGVuZGBdKCNwcmVwZW5kKSBpbnN0ZWFkLlxuICpcbiAqIEBjYXRlZ29yeSB6b25lIG9mIGRlYXRoXG4gKiBAc2luY2UgMi41LjBcbiAqIEBkZXByZWNhdGVkXG4gKi9cbmV4cG9ydCB2YXIgY29ucyA9IFJORUEuY29ucztcbi8qKlxuICogVXNlIFtgYXBwZW5kYF0oI2FwcGVuZCkgaW5zdGVhZC5cbiAqXG4gKiBAY2F0ZWdvcnkgem9uZSBvZiBkZWF0aFxuICogQHNpbmNlIDIuNS4wXG4gKiBAZGVwcmVjYXRlZFxuICovXG5leHBvcnQgdmFyIHNub2MgPSBSTkVBLnNub2M7XG4vKipcbiAqIFVzZSBbYHByZXBlbmRBbGxgXSgjcHJlcGVuZGFsbCkgaW5zdGVhZC5cbiAqXG4gKiBAY2F0ZWdvcnkgem9uZSBvZiBkZWF0aFxuICogQHNpbmNlIDIuOS4wXG4gKiBAZGVwcmVjYXRlZFxuICovXG5leHBvcnQgdmFyIHByZXBlbmRUb0FsbCA9IHByZXBlbmRBbGw7XG4vKipcbiAqIFRoaXMgaW5zdGFuY2UgaXMgZGVwcmVjYXRlZCwgdXNlIHNtYWxsLCBzcGVjaWZpYyBpbnN0YW5jZXMgaW5zdGVhZC5cbiAqIEZvciBleGFtcGxlIGlmIGEgZnVuY3Rpb24gbmVlZHMgYSBgRnVuY3RvcmAgaW5zdGFuY2UsIHBhc3MgYFJBLkZ1bmN0b3JgIGluc3RlYWQgb2YgYFJBLnJlYWRvbmx5QXJyYXlgXG4gKiAod2hlcmUgYFJBYCBpcyBmcm9tIGBpbXBvcnQgUkEgZnJvbSAnZnAtdHMvUmVhZG9ubHlBcnJheSdgKVxuICpcbiAqIEBjYXRlZ29yeSB6b25lIG9mIGRlYXRoXG4gKiBAc2luY2UgMi41LjBcbiAqIEBkZXByZWNhdGVkXG4gKi9cbmV4cG9ydCB2YXIgcmVhZG9ubHlBcnJheSA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICBjb21wYWN0OiBjb21wYWN0LFxuICAgIHNlcGFyYXRlOiBzZXBhcmF0ZSxcbiAgICBtYXA6IF9tYXAsXG4gICAgYXA6IF9hcCxcbiAgICBvZjogb2YsXG4gICAgY2hhaW46IGZsYXRNYXAsXG4gICAgZmlsdGVyOiBfZmlsdGVyLFxuICAgIGZpbHRlck1hcDogX2ZpbHRlck1hcCxcbiAgICBwYXJ0aXRpb246IF9wYXJ0aXRpb24sXG4gICAgcGFydGl0aW9uTWFwOiBfcGFydGl0aW9uTWFwLFxuICAgIG1hcFdpdGhJbmRleDogX21hcFdpdGhJbmRleCxcbiAgICBwYXJ0aXRpb25NYXBXaXRoSW5kZXg6IF9wYXJ0aXRpb25NYXBXaXRoSW5kZXgsXG4gICAgcGFydGl0aW9uV2l0aEluZGV4OiBfcGFydGl0aW9uV2l0aEluZGV4LFxuICAgIGZpbHRlck1hcFdpdGhJbmRleDogX2ZpbHRlck1hcFdpdGhJbmRleCxcbiAgICBmaWx0ZXJXaXRoSW5kZXg6IF9maWx0ZXJXaXRoSW5kZXgsXG4gICAgYWx0OiBfYWx0LFxuICAgIHplcm86IHplcm8sXG4gICAgdW5mb2xkOiB1bmZvbGQsXG4gICAgcmVkdWNlOiBfcmVkdWNlLFxuICAgIGZvbGRNYXA6IF9mb2xkTWFwLFxuICAgIHJlZHVjZVJpZ2h0OiBfcmVkdWNlUmlnaHQsXG4gICAgdHJhdmVyc2U6IF90cmF2ZXJzZSxcbiAgICBzZXF1ZW5jZTogc2VxdWVuY2UsXG4gICAgcmVkdWNlV2l0aEluZGV4OiBfcmVkdWNlV2l0aEluZGV4LFxuICAgIGZvbGRNYXBXaXRoSW5kZXg6IF9mb2xkTWFwV2l0aEluZGV4LFxuICAgIHJlZHVjZVJpZ2h0V2l0aEluZGV4OiBfcmVkdWNlUmlnaHRXaXRoSW5kZXgsXG4gICAgdHJhdmVyc2VXaXRoSW5kZXg6IF90cmF2ZXJzZVdpdGhJbmRleCxcbiAgICBleHRlbmQ6IF9leHRlbmQsXG4gICAgd2l0aGVyOiBfd2l0aGVyLFxuICAgIHdpbHQ6IF93aWx0XG59O1xuIiwKICAidmFyIF9fc3ByZWFkQXJyYXkgPSAodGhpcyAmJiB0aGlzLl9fc3ByZWFkQXJyYXkpIHx8IGZ1bmN0aW9uICh0bywgZnJvbSwgcGFjaykge1xuICAgIGlmIChwYWNrIHx8IGFyZ3VtZW50cy5sZW5ndGggPT09IDIpIGZvciAodmFyIGkgPSAwLCBsID0gZnJvbS5sZW5ndGgsIGFyOyBpIDwgbDsgaSsrKSB7XG4gICAgICAgIGlmIChhciB8fCAhKGkgaW4gZnJvbSkpIHtcbiAgICAgICAgICAgIGlmICghYXIpIGFyID0gQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoZnJvbSwgMCwgaSk7XG4gICAgICAgICAgICBhcltpXSA9IGZyb21baV07XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHRvLmNvbmNhdChhciB8fCBBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChmcm9tKSk7XG59O1xuaW1wb3J0IHsgYXBGaXJzdCBhcyBhcEZpcnN0XywgYXBTIGFzIGFwU18sIGFwU2Vjb25kIGFzIGFwU2Vjb25kXyB9IGZyb20gJy4vQXBwbHknO1xuaW1wb3J0IHsgYmluZCBhcyBiaW5kXywgY2hhaW5GaXJzdCBhcyBjaGFpbkZpcnN0XyB9IGZyb20gJy4vQ2hhaW4nO1xuaW1wb3J0IHsgZnJvbUVxdWFscyB9IGZyb20gJy4vRXEnO1xuaW1wb3J0IHsgZnJvbUVpdGhlcksgYXMgZnJvbUVpdGhlcktfIH0gZnJvbSAnLi9Gcm9tRWl0aGVyJztcbmltcG9ydCB7IGR1YWwsIGlkZW50aXR5LCBwaXBlIH0gZnJvbSAnLi9mdW5jdGlvbic7XG5pbXBvcnQgeyBiaW5kVG8gYXMgYmluZFRvXywgZmxhcCBhcyBmbGFwXywgbGV0IGFzIGxldF9fIH0gZnJvbSAnLi9GdW5jdG9yJztcbmltcG9ydCAqIGFzIF8gZnJvbSAnLi9pbnRlcm5hbCc7XG5pbXBvcnQgKiBhcyBOIGZyb20gJy4vbnVtYmVyJztcbmltcG9ydCB7IGZyb21Db21wYXJlIH0gZnJvbSAnLi9PcmQnO1xuaW1wb3J0ICogYXMgUk5FQSBmcm9tICcuL1JlYWRvbmx5Tm9uRW1wdHlBcnJheSc7XG5pbXBvcnQgeyBzZXBhcmF0ZWQgfSBmcm9tICcuL1NlcGFyYXRlZCc7XG5pbXBvcnQgeyBmaWx0ZXJFIGFzIGZpbHRlckVfLCB3aWx0RGVmYXVsdCwgd2l0aGVyRGVmYXVsdCB9IGZyb20gJy4vV2l0aGVyYWJsZSc7XG5pbXBvcnQgeyBndWFyZCBhcyBndWFyZF8gfSBmcm9tICcuL1plcm8nO1xuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLy8gcmVmaW5lbWVudHNcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8qKlxuICogVGVzdCB3aGV0aGVyIGEgYFJlYWRvbmx5QXJyYXlgIGlzIGVtcHR5LlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBpc0VtcHR5IH0gZnJvbSAnZnAtdHMvUmVhZG9ubHlBcnJheSdcbiAqXG4gKiBhc3NlcnQuc3RyaWN0RXF1YWwoaXNFbXB0eShbXSksIHRydWUpXG4gKlxuICogQGNhdGVnb3J5IHJlZmluZW1lbnRzXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBpc0VtcHR5ID0gZnVuY3Rpb24gKGFzKSB7IHJldHVybiBhcy5sZW5ndGggPT09IDA7IH07XG4vKipcbiAqIFRlc3Qgd2hldGhlciBhIGBSZWFkb25seUFycmF5YCBpcyBub24gZW1wdHkuXG4gKlxuICogQGNhdGVnb3J5IHJlZmluZW1lbnRzXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBpc05vbkVtcHR5ID0gUk5FQS5pc05vbkVtcHR5O1xuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLy8gY29uc3RydWN0b3JzXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vKipcbiAqIFByZXBlbmQgYW4gZWxlbWVudCB0byB0aGUgZnJvbnQgb2YgYSBgUmVhZG9ubHlBcnJheWAsIGNyZWF0aW5nIGEgbmV3IGBSZWFkb25seU5vbkVtcHR5QXJyYXlgLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBwcmVwZW5kIH0gZnJvbSAnZnAtdHMvUmVhZG9ubHlBcnJheSdcbiAqIGltcG9ydCB7IHBpcGUgfSBmcm9tICdmcC10cy9mdW5jdGlvbidcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKHBpcGUoWzIsIDMsIDRdLCBwcmVwZW5kKDEpKSwgWzEsIDIsIDMsIDRdKVxuICpcbiAqIEBzaW5jZSAyLjEwLjBcbiAqL1xuZXhwb3J0IHZhciBwcmVwZW5kID0gUk5FQS5wcmVwZW5kO1xuLyoqXG4gKiBMZXNzIHN0cmljdCB2ZXJzaW9uIG9mIFtgcHJlcGVuZGBdKCNwcmVwZW5kKS5cbiAqXG4gKiBAc2luY2UgMi4xMS4wXG4gKi9cbmV4cG9ydCB2YXIgcHJlcGVuZFcgPSBSTkVBLnByZXBlbmRXO1xuLyoqXG4gKiBBcHBlbmQgYW4gZWxlbWVudCB0byB0aGUgZW5kIG9mIGEgYFJlYWRvbmx5QXJyYXlgLCBjcmVhdGluZyBhIG5ldyBgUmVhZG9ubHlOb25FbXB0eUFycmF5YC5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgYXBwZW5kIH0gZnJvbSAnZnAtdHMvUmVhZG9ubHlBcnJheSdcbiAqIGltcG9ydCB7IHBpcGUgfSBmcm9tICdmcC10cy9mdW5jdGlvbidcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKHBpcGUoWzEsIDIsIDNdLCBhcHBlbmQoNCkpLCBbMSwgMiwgMywgNF0pXG4gKlxuICogQHNpbmNlIDIuMTAuMFxuICovXG5leHBvcnQgdmFyIGFwcGVuZCA9IFJORUEuYXBwZW5kO1xuLyoqXG4gKiBMZXNzIHN0cmljdCB2ZXJzaW9uIG9mIFtgYXBwZW5kYF0oI2FwcGVuZCkuXG4gKlxuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIGFwcGVuZFcgPSBSTkVBLmFwcGVuZFc7XG4vKipcbiAqIFJldHVybiBhIGBSZWFkb25seUFycmF5YCBvZiBsZW5ndGggYG5gIHdpdGggZWxlbWVudCBgaWAgaW5pdGlhbGl6ZWQgd2l0aCBgZihpKWAuXG4gKlxuICogKipOb3RlKiouIGBuYCBpcyBub3JtYWxpemVkIHRvIGEgbm9uIG5lZ2F0aXZlIGludGVnZXIuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IG1ha2VCeSB9IGZyb20gJ2ZwLXRzL1JlYWRvbmx5QXJyYXknXG4gKlxuICogY29uc3QgZG91YmxlID0gKG46IG51bWJlcik6IG51bWJlciA9PiBuICogMlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChtYWtlQnkoNSwgZG91YmxlKSwgWzAsIDIsIDQsIDYsIDhdKVxuICpcbiAqIEBjYXRlZ29yeSBjb25zdHJ1Y3RvcnNcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIG1ha2VCeSA9IGZ1bmN0aW9uIChuLCBmKSB7IHJldHVybiAobiA8PSAwID8gZW1wdHkgOiBSTkVBLm1ha2VCeShmKShuKSk7IH07XG4vKipcbiAqIENyZWF0ZSBhIGBSZWFkb25seUFycmF5YCBjb250YWluaW5nIGEgdmFsdWUgcmVwZWF0ZWQgdGhlIHNwZWNpZmllZCBudW1iZXIgb2YgdGltZXMuXG4gKlxuICogKipOb3RlKiouIGBuYCBpcyBub3JtYWxpemVkIHRvIGEgbm9uIG5lZ2F0aXZlIGludGVnZXIuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IHJlcGxpY2F0ZSB9IGZyb20gJ2ZwLXRzL1JlYWRvbmx5QXJyYXknXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChyZXBsaWNhdGUoMywgJ2EnKSwgWydhJywgJ2EnLCAnYSddKVxuICpcbiAqIEBjYXRlZ29yeSBjb25zdHJ1Y3RvcnNcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIHJlcGxpY2F0ZSA9IGZ1bmN0aW9uIChuLCBhKSB7IHJldHVybiBtYWtlQnkobiwgZnVuY3Rpb24gKCkgeyByZXR1cm4gYTsgfSk7IH07XG5leHBvcnQgZnVuY3Rpb24gZnJvbVByZWRpY2F0ZShwcmVkaWNhdGUpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGEpIHsgcmV0dXJuIChwcmVkaWNhdGUoYSkgPyBbYV0gOiBlbXB0eSk7IH07XG59XG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vLyBjb252ZXJzaW9uc1xuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLyoqXG4gKiBAY2F0ZWdvcnkgY29udmVyc2lvbnNcbiAqIEBzaW5jZSAyLjExLjBcbiAqL1xuZXhwb3J0IHZhciBmcm9tT3B0aW9uID0gZnVuY3Rpb24gKG1hKSB7IHJldHVybiAoXy5pc05vbmUobWEpID8gZW1wdHkgOiBbbWEudmFsdWVdKTsgfTtcbi8qKlxuICogVHJhbnNmb3JtcyBhbiBgRWl0aGVyYCB0byBhIGBSZWFkb25seUFycmF5YC5cbiAqXG4gKiBAY2F0ZWdvcnkgY29udmVyc2lvbnNcbiAqIEBzaW5jZSAyLjExLjBcbiAqL1xuZXhwb3J0IHZhciBmcm9tRWl0aGVyID0gZnVuY3Rpb24gKGUpIHsgcmV0dXJuIChfLmlzTGVmdChlKSA/IGVtcHR5IDogW2UucmlnaHRdKTsgfTtcbi8qKlxuICogTGVzcyBzdHJpY3QgdmVyc2lvbiBvZiBbYG1hdGNoYF0oI21hdGNoKS5cbiAqXG4gKiBUaGUgYFdgIHN1ZmZpeCAoc2hvcnQgZm9yICoqVyoqaWRlbmluZykgbWVhbnMgdGhhdCB0aGUgaGFuZGxlciByZXR1cm4gdHlwZXMgd2lsbCBiZSBtZXJnZWQuXG4gKlxuICogQGNhdGVnb3J5IHBhdHRlcm4gbWF0Y2hpbmdcbiAqIEBzaW5jZSAyLjExLjBcbiAqL1xuZXhwb3J0IHZhciBtYXRjaFcgPSBmdW5jdGlvbiAob25FbXB0eSwgb25Ob25FbXB0eSkge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgcmV0dXJuIGlzTm9uRW1wdHkoYXMpID8gb25Ob25FbXB0eShhcykgOiBvbkVtcHR5KCk7XG4gICAgfTtcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBwYXR0ZXJuIG1hdGNoaW5nXG4gKiBAc2luY2UgMi4xMS4wXG4gKi9cbmV4cG9ydCB2YXIgbWF0Y2ggPSBtYXRjaFc7XG4vKipcbiAqIExlc3Mgc3RyaWN0IHZlcnNpb24gb2YgW2BtYXRjaExlZnRgXSgjbWF0Y2hsZWZ0KS5cbiAqXG4gKiBAY2F0ZWdvcnkgcGF0dGVybiBtYXRjaGluZ1xuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIG1hdGNoTGVmdFcgPSBmdW5jdGlvbiAob25FbXB0eSwgb25Ob25FbXB0eSkge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgcmV0dXJuIGlzTm9uRW1wdHkoYXMpID8gb25Ob25FbXB0eShSTkVBLmhlYWQoYXMpLCBSTkVBLnRhaWwoYXMpKSA6IG9uRW1wdHkoKTtcbiAgICB9O1xufTtcbi8qKlxuICogQnJlYWsgYSBgUmVhZG9ubHlBcnJheWAgaW50byBpdHMgZmlyc3QgZWxlbWVudCBhbmQgcmVtYWluaW5nIGVsZW1lbnRzLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBtYXRjaExlZnQgfSBmcm9tICdmcC10cy9SZWFkb25seUFycmF5J1xuICpcbiAqIGNvbnN0IGxlbjogPEE+KGFzOiBSZWFkb25seUFycmF5PEE+KSA9PiBudW1iZXIgPSBtYXRjaExlZnQoKCkgPT4gMCwgKF8sIHRhaWwpID0+IDEgKyBsZW4odGFpbCkpXG4gKiBhc3NlcnQuc3RyaWN0RXF1YWwobGVuKFsxLCAyLCAzXSksIDMpXG4gKlxuICogQGNhdGVnb3J5IHBhdHRlcm4gbWF0Y2hpbmdcbiAqIEBzaW5jZSAyLjEwLjBcbiAqL1xuZXhwb3J0IHZhciBtYXRjaExlZnQgPSBtYXRjaExlZnRXO1xuLyoqXG4gKiBBbGlhcyBvZiBbYG1hdGNoTGVmdGBdKCNtYXRjaGxlZnQpLlxuICpcbiAqIEBjYXRlZ29yeSBwYXR0ZXJuIG1hdGNoaW5nXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBmb2xkTGVmdCA9IG1hdGNoTGVmdDtcbi8qKlxuICogTGVzcyBzdHJpY3QgdmVyc2lvbiBvZiBbYG1hdGNoUmlnaHRgXSgjbWF0Y2hyaWdodCkuXG4gKlxuICogQGNhdGVnb3J5IHBhdHRlcm4gbWF0Y2hpbmdcbiAqIEBzaW5jZSAyLjExLjBcbiAqL1xuZXhwb3J0IHZhciBtYXRjaFJpZ2h0VyA9IGZ1bmN0aW9uIChvbkVtcHR5LCBvbk5vbkVtcHR5KSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykge1xuICAgICAgICByZXR1cm4gaXNOb25FbXB0eShhcykgPyBvbk5vbkVtcHR5KFJORUEuaW5pdChhcyksIFJORUEubGFzdChhcykpIDogb25FbXB0eSgpO1xuICAgIH07XG59O1xuLyoqXG4gKiBCcmVhayBhIGBSZWFkb25seUFycmF5YCBpbnRvIGl0cyBpbml0aWFsIGVsZW1lbnRzIGFuZCB0aGUgbGFzdCBlbGVtZW50LlxuICpcbiAqIEBjYXRlZ29yeSBwYXR0ZXJuIG1hdGNoaW5nXG4gKiBAc2luY2UgMi4xMC4wXG4gKi9cbmV4cG9ydCB2YXIgbWF0Y2hSaWdodCA9IG1hdGNoUmlnaHRXO1xuLyoqXG4gKiBBbGlhcyBvZiBbYG1hdGNoUmlnaHRgXSgjbWF0Y2hyaWdodCkuXG4gKlxuICogQGNhdGVnb3J5IHBhdHRlcm4gbWF0Y2hpbmdcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIGZvbGRSaWdodCA9IG1hdGNoUmlnaHQ7XG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vLyBjb21iaW5hdG9yc1xuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLyoqXG4gKiBAY2F0ZWdvcnkgc2VxdWVuY2luZ1xuICogQHNpbmNlIDIuNy4wXG4gKi9cbmV4cG9ydCB2YXIgY2hhaW5XaXRoSW5kZXggPSBmdW5jdGlvbiAoZikge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgaWYgKGlzRW1wdHkoYXMpKSB7XG4gICAgICAgICAgICByZXR1cm4gZW1wdHk7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIG91dCA9IFtdO1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGFzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICBvdXQucHVzaC5hcHBseShvdXQsIGYoaSwgYXNbaV0pKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gb3V0O1xuICAgIH07XG59O1xuLyoqXG4gKiBTYW1lIGFzIGByZWR1Y2VgIGJ1dCBpdCBjYXJyaWVzIG92ZXIgdGhlIGludGVybWVkaWF0ZSBzdGVwcy5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgc2NhbkxlZnQgfSBmcm9tICdmcC10cy9SZWFkb25seUFycmF5J1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoc2NhbkxlZnQoMTAsIChiLCBhOiBudW1iZXIpID0+IGIgLSBhKShbMSwgMiwgM10pLCBbMTAsIDksIDcsIDRdKVxuICpcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIHNjYW5MZWZ0ID0gZnVuY3Rpb24gKGIsIGYpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIHZhciBsZW4gPSBhcy5sZW5ndGg7XG4gICAgICAgIHZhciBvdXQgPSBuZXcgQXJyYXkobGVuICsgMSk7XG4gICAgICAgIG91dFswXSA9IGI7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbGVuOyBpKyspIHtcbiAgICAgICAgICAgIG91dFtpICsgMV0gPSBmKG91dFtpXSwgYXNbaV0pO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBvdXQ7XG4gICAgfTtcbn07XG4vKipcbiAqIEZvbGQgYW4gYXJyYXkgZnJvbSB0aGUgcmlnaHQsIGtlZXBpbmcgYWxsIGludGVybWVkaWF0ZSByZXN1bHRzIGluc3RlYWQgb2Ygb25seSB0aGUgZmluYWwgcmVzdWx0XG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IHNjYW5SaWdodCB9IGZyb20gJ2ZwLXRzL1JlYWRvbmx5QXJyYXknXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChzY2FuUmlnaHQoMTAsIChhOiBudW1iZXIsIGIpID0+IGIgLSBhKShbMSwgMiwgM10pLCBbNCwgNSwgNywgMTBdKVxuICpcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIHNjYW5SaWdodCA9IGZ1bmN0aW9uIChiLCBmKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykge1xuICAgICAgICB2YXIgbGVuID0gYXMubGVuZ3RoO1xuICAgICAgICB2YXIgb3V0ID0gbmV3IEFycmF5KGxlbiArIDEpO1xuICAgICAgICBvdXRbbGVuXSA9IGI7XG4gICAgICAgIGZvciAodmFyIGkgPSBsZW4gLSAxOyBpID49IDA7IGktLSkge1xuICAgICAgICAgICAgb3V0W2ldID0gZihhc1tpXSwgb3V0W2kgKyAxXSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG91dDtcbiAgICB9O1xufTtcbi8qKlxuICogQ2FsY3VsYXRlIHRoZSBudW1iZXIgb2YgZWxlbWVudHMgaW4gYSBgUmVhZG9ubHlBcnJheWAuXG4gKlxuICogQHNpbmNlIDIuMTAuMFxuICovXG5leHBvcnQgdmFyIHNpemUgPSBmdW5jdGlvbiAoYXMpIHsgcmV0dXJuIGFzLmxlbmd0aDsgfTtcbi8qKlxuICogVGVzdCB3aGV0aGVyIGFuIGFycmF5IGNvbnRhaW5zIGEgcGFydGljdWxhciBpbmRleFxuICpcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIGlzT3V0T2ZCb3VuZCA9IFJORUEuaXNPdXRPZkJvdW5kO1xuZXhwb3J0IGZ1bmN0aW9uIGxvb2t1cChpLCBhcykge1xuICAgIHJldHVybiBhcyA9PT0gdW5kZWZpbmVkID8gZnVuY3Rpb24gKGFzKSB7IHJldHVybiBsb29rdXAoaSwgYXMpOyB9IDogaXNPdXRPZkJvdW5kKGksIGFzKSA/IF8ubm9uZSA6IF8uc29tZShhc1tpXSk7XG59XG4vKipcbiAqIEdldCB0aGUgZmlyc3QgZWxlbWVudCBpbiBhbiBhcnJheSwgb3IgYE5vbmVgIGlmIHRoZSBhcnJheSBpcyBlbXB0eVxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBoZWFkIH0gZnJvbSAnZnAtdHMvUmVhZG9ubHlBcnJheSdcbiAqIGltcG9ydCB7IHNvbWUsIG5vbmUgfSBmcm9tICdmcC10cy9PcHRpb24nXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChoZWFkKFsxLCAyLCAzXSksIHNvbWUoMSkpXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKGhlYWQoW10pLCBub25lKVxuICpcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIGhlYWQgPSBmdW5jdGlvbiAoYXMpIHsgcmV0dXJuIChpc05vbkVtcHR5KGFzKSA/IF8uc29tZShSTkVBLmhlYWQoYXMpKSA6IF8ubm9uZSk7IH07XG4vKipcbiAqIEdldCB0aGUgbGFzdCBlbGVtZW50IGluIGFuIGFycmF5LCBvciBgTm9uZWAgaWYgdGhlIGFycmF5IGlzIGVtcHR5XG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IGxhc3QgfSBmcm9tICdmcC10cy9SZWFkb25seUFycmF5J1xuICogaW1wb3J0IHsgc29tZSwgbm9uZSB9IGZyb20gJ2ZwLXRzL09wdGlvbidcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKGxhc3QoWzEsIDIsIDNdKSwgc29tZSgzKSlcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwobGFzdChbXSksIG5vbmUpXG4gKlxuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgbGFzdCA9IGZ1bmN0aW9uIChhcykgeyByZXR1cm4gKGlzTm9uRW1wdHkoYXMpID8gXy5zb21lKFJORUEubGFzdChhcykpIDogXy5ub25lKTsgfTtcbi8qKlxuICogR2V0IGFsbCBidXQgdGhlIGZpcnN0IGVsZW1lbnQgb2YgYW4gYXJyYXksIGNyZWF0aW5nIGEgbmV3IGFycmF5LCBvciBgTm9uZWAgaWYgdGhlIGFycmF5IGlzIGVtcHR5XG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IHRhaWwgfSBmcm9tICdmcC10cy9SZWFkb25seUFycmF5J1xuICogaW1wb3J0IHsgc29tZSwgbm9uZSB9IGZyb20gJ2ZwLXRzL09wdGlvbidcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKHRhaWwoWzEsIDIsIDNdKSwgc29tZShbMiwgM10pKVxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbCh0YWlsKFtdKSwgbm9uZSlcbiAqXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciB0YWlsID0gZnVuY3Rpb24gKGFzKSB7XG4gICAgcmV0dXJuIGlzTm9uRW1wdHkoYXMpID8gXy5zb21lKFJORUEudGFpbChhcykpIDogXy5ub25lO1xufTtcbi8qKlxuICogR2V0IGFsbCBidXQgdGhlIGxhc3QgZWxlbWVudCBvZiBhbiBhcnJheSwgY3JlYXRpbmcgYSBuZXcgYXJyYXksIG9yIGBOb25lYCBpZiB0aGUgYXJyYXkgaXMgZW1wdHlcbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgaW5pdCB9IGZyb20gJ2ZwLXRzL1JlYWRvbmx5QXJyYXknXG4gKiBpbXBvcnQgeyBzb21lLCBub25lIH0gZnJvbSAnZnAtdHMvT3B0aW9uJ1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoaW5pdChbMSwgMiwgM10pLCBzb21lKFsxLCAyXSkpXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKGluaXQoW10pLCBub25lKVxuICpcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIGluaXQgPSBmdW5jdGlvbiAoYXMpIHtcbiAgICByZXR1cm4gaXNOb25FbXB0eShhcykgPyBfLnNvbWUoUk5FQS5pbml0KGFzKSkgOiBfLm5vbmU7XG59O1xuLyoqXG4gKiBLZWVwIG9ubHkgYSBtYXggbnVtYmVyIG9mIGVsZW1lbnRzIGZyb20gdGhlIHN0YXJ0IG9mIGFuIGBSZWFkb25seUFycmF5YCwgY3JlYXRpbmcgYSBuZXcgYFJlYWRvbmx5QXJyYXlgLlxuICpcbiAqICoqTm90ZSoqLiBgbmAgaXMgbm9ybWFsaXplZCB0byBhIG5vbiBuZWdhdGl2ZSBpbnRlZ2VyLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgKiBhcyBSQSBmcm9tICdmcC10cy9SZWFkb25seUFycmF5J1xuICogaW1wb3J0IHsgcGlwZSB9IGZyb20gJ2ZwLXRzL2Z1bmN0aW9uJ1xuICpcbiAqIGNvbnN0IGlucHV0OiBSZWFkb25seUFycmF5PG51bWJlcj4gPSBbMSwgMiwgM11cbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwocGlwZShpbnB1dCwgUkEudGFrZUxlZnQoMikpLCBbMSwgMl0pXG4gKlxuICogLy8gb3V0IG9mIGJvdW5kc1xuICogYXNzZXJ0LnN0cmljdEVxdWFsKHBpcGUoaW5wdXQsIFJBLnRha2VMZWZ0KDQpKSwgaW5wdXQpXG4gKiBhc3NlcnQuc3RyaWN0RXF1YWwocGlwZShpbnB1dCwgUkEudGFrZUxlZnQoLTEpKSwgaW5wdXQpXG4gKlxuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgdGFrZUxlZnQgPSBmdW5jdGlvbiAobikge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgcmV0dXJuIGlzT3V0T2ZCb3VuZChuLCBhcykgPyBhcyA6IG4gPT09IDAgPyBlbXB0eSA6IGFzLnNsaWNlKDAsIG4pO1xuICAgIH07XG59O1xuLyoqXG4gKiBLZWVwIG9ubHkgYSBtYXggbnVtYmVyIG9mIGVsZW1lbnRzIGZyb20gdGhlIGVuZCBvZiBhbiBgUmVhZG9ubHlBcnJheWAsIGNyZWF0aW5nIGEgbmV3IGBSZWFkb25seUFycmF5YC5cbiAqXG4gKiAqKk5vdGUqKi4gYG5gIGlzIG5vcm1hbGl6ZWQgdG8gYSBub24gbmVnYXRpdmUgaW50ZWdlci5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0ICogYXMgUkEgZnJvbSAnZnAtdHMvUmVhZG9ubHlBcnJheSdcbiAqIGltcG9ydCB7IHBpcGUgfSBmcm9tICdmcC10cy9mdW5jdGlvbidcbiAqXG4gKiBjb25zdCBpbnB1dDogUmVhZG9ubHlBcnJheTxudW1iZXI+ID0gWzEsIDIsIDNdXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKHBpcGUoaW5wdXQsIFJBLnRha2VSaWdodCgyKSksIFsyLCAzXSlcbiAqXG4gKiAvLyBvdXQgb2YgYm91bmRzXG4gKiBhc3NlcnQuc3RyaWN0RXF1YWwocGlwZShpbnB1dCwgUkEudGFrZVJpZ2h0KDQpKSwgaW5wdXQpXG4gKiBhc3NlcnQuc3RyaWN0RXF1YWwocGlwZShpbnB1dCwgUkEudGFrZVJpZ2h0KC0xKSksIGlucHV0KVxuICpcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIHRha2VSaWdodCA9IGZ1bmN0aW9uIChuKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykge1xuICAgICAgICByZXR1cm4gaXNPdXRPZkJvdW5kKG4sIGFzKSA/IGFzIDogbiA9PT0gMCA/IGVtcHR5IDogYXMuc2xpY2UoLW4pO1xuICAgIH07XG59O1xuZXhwb3J0IGZ1bmN0aW9uIHRha2VMZWZ0V2hpbGUocHJlZGljYXRlKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykge1xuICAgICAgICB2YXIgb3V0ID0gW107XG4gICAgICAgIGZvciAodmFyIF9pID0gMCwgYXNfMSA9IGFzOyBfaSA8IGFzXzEubGVuZ3RoOyBfaSsrKSB7XG4gICAgICAgICAgICB2YXIgYSA9IGFzXzFbX2ldO1xuICAgICAgICAgICAgaWYgKCFwcmVkaWNhdGUoYSkpIHtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIG91dC5wdXNoKGEpO1xuICAgICAgICB9XG4gICAgICAgIHZhciBsZW4gPSBvdXQubGVuZ3RoO1xuICAgICAgICByZXR1cm4gbGVuID09PSBhcy5sZW5ndGggPyBhcyA6IGxlbiA9PT0gMCA/IGVtcHR5IDogb3V0O1xuICAgIH07XG59XG52YXIgc3BhbkxlZnRJbmRleCA9IGZ1bmN0aW9uIChhcywgcHJlZGljYXRlKSB7XG4gICAgdmFyIGwgPSBhcy5sZW5ndGg7XG4gICAgdmFyIGkgPSAwO1xuICAgIGZvciAoOyBpIDwgbDsgaSsrKSB7XG4gICAgICAgIGlmICghcHJlZGljYXRlKGFzW2ldKSkge1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIGk7XG59O1xuZXhwb3J0IGZ1bmN0aW9uIHNwYW5MZWZ0KHByZWRpY2F0ZSkge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgdmFyIF9hID0gc3BsaXRBdChzcGFuTGVmdEluZGV4KGFzLCBwcmVkaWNhdGUpKShhcyksIGluaXQgPSBfYVswXSwgcmVzdCA9IF9hWzFdO1xuICAgICAgICByZXR1cm4geyBpbml0OiBpbml0LCByZXN0OiByZXN0IH07XG4gICAgfTtcbn1cbi8qKlxuICogRHJvcCBhIG1heCBudW1iZXIgb2YgZWxlbWVudHMgZnJvbSB0aGUgc3RhcnQgb2YgYW4gYFJlYWRvbmx5QXJyYXlgLCBjcmVhdGluZyBhIG5ldyBgUmVhZG9ubHlBcnJheWAuXG4gKlxuICogKipOb3RlKiouIGBuYCBpcyBub3JtYWxpemVkIHRvIGEgbm9uIG5lZ2F0aXZlIGludGVnZXIuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCAqIGFzIFJBIGZyb20gJ2ZwLXRzL1JlYWRvbmx5QXJyYXknXG4gKiBpbXBvcnQgeyBwaXBlIH0gZnJvbSAnZnAtdHMvZnVuY3Rpb24nXG4gKlxuICogY29uc3QgaW5wdXQ6IFJlYWRvbmx5QXJyYXk8bnVtYmVyPiA9IFsxLCAyLCAzXVxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChwaXBlKGlucHV0LCBSQS5kcm9wTGVmdCgyKSksIFszXSlcbiAqIGFzc2VydC5zdHJpY3RFcXVhbChwaXBlKGlucHV0LCBSQS5kcm9wTGVmdCgwKSksIGlucHV0KVxuICogYXNzZXJ0LnN0cmljdEVxdWFsKHBpcGUoaW5wdXQsIFJBLmRyb3BMZWZ0KC0xKSksIGlucHV0KVxuICpcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIGRyb3BMZWZ0ID0gZnVuY3Rpb24gKG4pIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIHJldHVybiBuIDw9IDAgfHwgaXNFbXB0eShhcykgPyBhcyA6IG4gPj0gYXMubGVuZ3RoID8gZW1wdHkgOiBhcy5zbGljZShuLCBhcy5sZW5ndGgpO1xuICAgIH07XG59O1xuLyoqXG4gKiBEcm9wIGEgbWF4IG51bWJlciBvZiBlbGVtZW50cyBmcm9tIHRoZSBlbmQgb2YgYW4gYFJlYWRvbmx5QXJyYXlgLCBjcmVhdGluZyBhIG5ldyBgUmVhZG9ubHlBcnJheWAuXG4gKlxuICogKipOb3RlKiouIGBuYCBpcyBub3JtYWxpemVkIHRvIGEgbm9uIG5lZ2F0aXZlIGludGVnZXIuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCAqIGFzIFJBIGZyb20gJ2ZwLXRzL1JlYWRvbmx5QXJyYXknXG4gKiBpbXBvcnQgeyBwaXBlIH0gZnJvbSAnZnAtdHMvZnVuY3Rpb24nXG4gKlxuICogY29uc3QgaW5wdXQ6IFJlYWRvbmx5QXJyYXk8bnVtYmVyPiA9IFsxLCAyLCAzXVxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChwaXBlKGlucHV0LCBSQS5kcm9wUmlnaHQoMikpLCBbMV0pXG4gKiBhc3NlcnQuc3RyaWN0RXF1YWwocGlwZShpbnB1dCwgUkEuZHJvcFJpZ2h0KDApKSwgaW5wdXQpXG4gKiBhc3NlcnQuc3RyaWN0RXF1YWwocGlwZShpbnB1dCwgUkEuZHJvcFJpZ2h0KC0xKSksIGlucHV0KVxuICpcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIGRyb3BSaWdodCA9IGZ1bmN0aW9uIChuKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykge1xuICAgICAgICByZXR1cm4gbiA8PSAwIHx8IGlzRW1wdHkoYXMpID8gYXMgOiBuID49IGFzLmxlbmd0aCA/IGVtcHR5IDogYXMuc2xpY2UoMCwgYXMubGVuZ3RoIC0gbik7XG4gICAgfTtcbn07XG5leHBvcnQgZnVuY3Rpb24gZHJvcExlZnRXaGlsZShwcmVkaWNhdGUpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIHZhciBpID0gc3BhbkxlZnRJbmRleChhcywgcHJlZGljYXRlKTtcbiAgICAgICAgcmV0dXJuIGkgPT09IDAgPyBhcyA6IGkgPT09IGFzLmxlbmd0aCA/IGVtcHR5IDogYXMuc2xpY2UoaSk7XG4gICAgfTtcbn1cbi8qKlxuICogRmluZCB0aGUgZmlyc3QgaW5kZXggZm9yIHdoaWNoIGEgcHJlZGljYXRlIGhvbGRzXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IGZpbmRJbmRleCB9IGZyb20gJ2ZwLXRzL1JlYWRvbmx5QXJyYXknXG4gKiBpbXBvcnQgeyBzb21lLCBub25lIH0gZnJvbSAnZnAtdHMvT3B0aW9uJ1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoZmluZEluZGV4KChuOiBudW1iZXIpID0+IG4gPT09IDIpKFsxLCAyLCAzXSksIHNvbWUoMSkpXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKGZpbmRJbmRleCgobjogbnVtYmVyKSA9PiBuID09PSAyKShbXSksIG5vbmUpXG4gKlxuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgZmluZEluZGV4ID0gZnVuY3Rpb24gKHByZWRpY2F0ZSkge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBhcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgaWYgKHByZWRpY2F0ZShhc1tpXSkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gXy5zb21lKGkpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBfLm5vbmU7XG4gICAgfTtcbn07XG5leHBvcnQgZnVuY3Rpb24gZmluZEZpcnN0KHByZWRpY2F0ZSkge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBhcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgaWYgKHByZWRpY2F0ZShhc1tpXSkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gXy5zb21lKGFzW2ldKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gXy5ub25lO1xuICAgIH07XG59XG4vKipcbiAqIEZpbmQgdGhlIGZpcnN0IGVsZW1lbnQgcmV0dXJuZWQgYnkgYW4gb3B0aW9uIGJhc2VkIHNlbGVjdG9yIGZ1bmN0aW9uXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IGZpbmRGaXJzdE1hcCB9IGZyb20gJ2ZwLXRzL1JlYWRvbmx5QXJyYXknXG4gKiBpbXBvcnQgeyBzb21lLCBub25lIH0gZnJvbSAnZnAtdHMvT3B0aW9uJ1xuICpcbiAqIGludGVyZmFjZSBQZXJzb24ge1xuICogICByZWFkb25seSBuYW1lOiBzdHJpbmdcbiAqICAgcmVhZG9ubHkgYWdlPzogbnVtYmVyXG4gKiB9XG4gKlxuICogY29uc3QgcGVyc29uczogUmVhZG9ubHlBcnJheTxQZXJzb24+ID0gW3sgbmFtZTogJ0pvaG4nIH0sIHsgbmFtZTogJ01hcnknLCBhZ2U6IDQ1IH0sIHsgbmFtZTogJ0pvZXknLCBhZ2U6IDI4IH1dXG4gKlxuICogLy8gcmV0dXJucyB0aGUgbmFtZSBvZiB0aGUgZmlyc3QgcGVyc29uIHRoYXQgaGFzIGFuIGFnZVxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChmaW5kRmlyc3RNYXAoKHA6IFBlcnNvbikgPT4gKHAuYWdlID09PSB1bmRlZmluZWQgPyBub25lIDogc29tZShwLm5hbWUpKSkocGVyc29ucyksIHNvbWUoJ01hcnknKSlcbiAqXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBmaW5kRmlyc3RNYXAgPSBmdW5jdGlvbiAoZikge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBhcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgdmFyIG91dCA9IGYoYXNbaV0pO1xuICAgICAgICAgICAgaWYgKF8uaXNTb21lKG91dCkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gb3V0O1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBfLm5vbmU7XG4gICAgfTtcbn07XG5leHBvcnQgZnVuY3Rpb24gZmluZExhc3QocHJlZGljYXRlKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykge1xuICAgICAgICBmb3IgKHZhciBpID0gYXMubGVuZ3RoIC0gMTsgaSA+PSAwOyBpLS0pIHtcbiAgICAgICAgICAgIGlmIChwcmVkaWNhdGUoYXNbaV0pKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIF8uc29tZShhc1tpXSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIF8ubm9uZTtcbiAgICB9O1xufVxuLyoqXG4gKiBGaW5kIHRoZSBsYXN0IGVsZW1lbnQgcmV0dXJuZWQgYnkgYW4gb3B0aW9uIGJhc2VkIHNlbGVjdG9yIGZ1bmN0aW9uXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IGZpbmRMYXN0TWFwIH0gZnJvbSAnZnAtdHMvUmVhZG9ubHlBcnJheSdcbiAqIGltcG9ydCB7IHNvbWUsIG5vbmUgfSBmcm9tICdmcC10cy9PcHRpb24nXG4gKlxuICogaW50ZXJmYWNlIFBlcnNvbiB7XG4gKiAgIHJlYWRvbmx5IG5hbWU6IHN0cmluZ1xuICogICByZWFkb25seSBhZ2U/OiBudW1iZXJcbiAqIH1cbiAqXG4gKiBjb25zdCBwZXJzb25zOiBSZWFkb25seUFycmF5PFBlcnNvbj4gPSBbeyBuYW1lOiAnSm9obicgfSwgeyBuYW1lOiAnTWFyeScsIGFnZTogNDUgfSwgeyBuYW1lOiAnSm9leScsIGFnZTogMjggfV1cbiAqXG4gKiAvLyByZXR1cm5zIHRoZSBuYW1lIG9mIHRoZSBsYXN0IHBlcnNvbiB0aGF0IGhhcyBhbiBhZ2VcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoZmluZExhc3RNYXAoKHA6IFBlcnNvbikgPT4gKHAuYWdlID09PSB1bmRlZmluZWQgPyBub25lIDogc29tZShwLm5hbWUpKSkocGVyc29ucyksIHNvbWUoJ0pvZXknKSlcbiAqXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBmaW5kTGFzdE1hcCA9IGZ1bmN0aW9uIChmKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykge1xuICAgICAgICBmb3IgKHZhciBpID0gYXMubGVuZ3RoIC0gMTsgaSA+PSAwOyBpLS0pIHtcbiAgICAgICAgICAgIHZhciBvdXQgPSBmKGFzW2ldKTtcbiAgICAgICAgICAgIGlmIChfLmlzU29tZShvdXQpKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG91dDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gXy5ub25lO1xuICAgIH07XG59O1xuLyoqXG4gKiBSZXR1cm5zIHRoZSBpbmRleCBvZiB0aGUgbGFzdCBlbGVtZW50IG9mIHRoZSBsaXN0IHdoaWNoIG1hdGNoZXMgdGhlIHByZWRpY2F0ZVxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBmaW5kTGFzdEluZGV4IH0gZnJvbSAnZnAtdHMvUmVhZG9ubHlBcnJheSdcbiAqIGltcG9ydCB7IHNvbWUsIG5vbmUgfSBmcm9tICdmcC10cy9PcHRpb24nXG4gKlxuICogaW50ZXJmYWNlIFgge1xuICogICByZWFkb25seSBhOiBudW1iZXJcbiAqICAgcmVhZG9ubHkgYjogbnVtYmVyXG4gKiB9XG4gKiBjb25zdCB4czogUmVhZG9ubHlBcnJheTxYPiA9IFt7IGE6IDEsIGI6IDAgfSwgeyBhOiAxLCBiOiAxIH1dXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKGZpbmRMYXN0SW5kZXgoKHg6IHsgcmVhZG9ubHkgYTogbnVtYmVyIH0pID0+IHguYSA9PT0gMSkoeHMpLCBzb21lKDEpKVxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChmaW5kTGFzdEluZGV4KCh4OiB7IHJlYWRvbmx5IGE6IG51bWJlciB9KSA9PiB4LmEgPT09IDQpKHhzKSwgbm9uZSlcbiAqXG4gKlxuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgZmluZExhc3RJbmRleCA9IGZ1bmN0aW9uIChwcmVkaWNhdGUpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIGZvciAodmFyIGkgPSBhcy5sZW5ndGggLSAxOyBpID49IDA7IGktLSkge1xuICAgICAgICAgICAgaWYgKHByZWRpY2F0ZShhc1tpXSkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gXy5zb21lKGkpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBfLm5vbmU7XG4gICAgfTtcbn07XG4vKipcbiAqIEluc2VydCBhbiBlbGVtZW50IGF0IHRoZSBzcGVjaWZpZWQgaW5kZXgsIGNyZWF0aW5nIGEgbmV3IGFycmF5LCBvciByZXR1cm5pbmcgYE5vbmVgIGlmIHRoZSBpbmRleCBpcyBvdXQgb2YgYm91bmRzXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IGluc2VydEF0IH0gZnJvbSAnZnAtdHMvUmVhZG9ubHlBcnJheSdcbiAqIGltcG9ydCB7IHNvbWUgfSBmcm9tICdmcC10cy9PcHRpb24nXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChpbnNlcnRBdCgyLCA1KShbMSwgMiwgMywgNF0pLCBzb21lKFsxLCAyLCA1LCAzLCA0XSkpXG4gKlxuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgaW5zZXJ0QXQgPSBmdW5jdGlvbiAoaSwgYSkge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgcmV0dXJuIGkgPCAwIHx8IGkgPiBhcy5sZW5ndGggPyBfLm5vbmUgOiBfLnNvbWUoUk5FQS51bnNhZmVJbnNlcnRBdChpLCBhLCBhcykpO1xuICAgIH07XG59O1xuLyoqXG4gKiBDaGFuZ2UgdGhlIGVsZW1lbnQgYXQgdGhlIHNwZWNpZmllZCBpbmRleCwgY3JlYXRpbmcgYSBuZXcgYXJyYXksIG9yIHJldHVybmluZyBgTm9uZWAgaWYgdGhlIGluZGV4IGlzIG91dCBvZiBib3VuZHNcbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgdXBkYXRlQXQgfSBmcm9tICdmcC10cy9SZWFkb25seUFycmF5J1xuICogaW1wb3J0IHsgc29tZSwgbm9uZSB9IGZyb20gJ2ZwLXRzL09wdGlvbidcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKHVwZGF0ZUF0KDEsIDEpKFsxLCAyLCAzXSksIHNvbWUoWzEsIDEsIDNdKSlcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwodXBkYXRlQXQoMSwgMSkoW10pLCBub25lKVxuICpcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIHVwZGF0ZUF0ID0gZnVuY3Rpb24gKGksIGEpIHtcbiAgICByZXR1cm4gbW9kaWZ5QXQoaSwgZnVuY3Rpb24gKCkgeyByZXR1cm4gYTsgfSk7XG59O1xuLyoqXG4gKiBEZWxldGUgdGhlIGVsZW1lbnQgYXQgdGhlIHNwZWNpZmllZCBpbmRleCwgY3JlYXRpbmcgYSBuZXcgYXJyYXksIG9yIHJldHVybmluZyBgTm9uZWAgaWYgdGhlIGluZGV4IGlzIG91dCBvZiBib3VuZHNcbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgZGVsZXRlQXQgfSBmcm9tICdmcC10cy9SZWFkb25seUFycmF5J1xuICogaW1wb3J0IHsgc29tZSwgbm9uZSB9IGZyb20gJ2ZwLXRzL09wdGlvbidcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKGRlbGV0ZUF0KDApKFsxLCAyLCAzXSksIHNvbWUoWzIsIDNdKSlcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoZGVsZXRlQXQoMSkoW10pLCBub25lKVxuICpcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIGRlbGV0ZUF0ID0gZnVuY3Rpb24gKGkpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIHJldHVybiBpc091dE9mQm91bmQoaSwgYXMpID8gXy5ub25lIDogXy5zb21lKHVuc2FmZURlbGV0ZUF0KGksIGFzKSk7XG4gICAgfTtcbn07XG4vKipcbiAqIEFwcGx5IGEgZnVuY3Rpb24gdG8gdGhlIGVsZW1lbnQgYXQgdGhlIHNwZWNpZmllZCBpbmRleCwgY3JlYXRpbmcgYSBuZXcgYXJyYXksIG9yIHJldHVybmluZyBgTm9uZWAgaWYgdGhlIGluZGV4IGlzIG91dFxuICogb2YgYm91bmRzXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IG1vZGlmeUF0IH0gZnJvbSAnZnAtdHMvUmVhZG9ubHlBcnJheSdcbiAqIGltcG9ydCB7IHNvbWUsIG5vbmUgfSBmcm9tICdmcC10cy9PcHRpb24nXG4gKlxuICogY29uc3QgZG91YmxlID0gKHg6IG51bWJlcik6IG51bWJlciA9PiB4ICogMlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChtb2RpZnlBdCgxLCBkb3VibGUpKFsxLCAyLCAzXSksIHNvbWUoWzEsIDQsIDNdKSlcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwobW9kaWZ5QXQoMSwgZG91YmxlKShbXSksIG5vbmUpXG4gKlxuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgbW9kaWZ5QXQgPSBmdW5jdGlvbiAoaSwgZikge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgcmV0dXJuIGlzT3V0T2ZCb3VuZChpLCBhcykgPyBfLm5vbmUgOiBfLnNvbWUodW5zYWZlVXBkYXRlQXQoaSwgZihhc1tpXSksIGFzKSk7XG4gICAgfTtcbn07XG4vKipcbiAqIFJldmVyc2UgYW4gYXJyYXksIGNyZWF0aW5nIGEgbmV3IGFycmF5XG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IHJldmVyc2UgfSBmcm9tICdmcC10cy9SZWFkb25seUFycmF5J1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwocmV2ZXJzZShbMSwgMiwgM10pLCBbMywgMiwgMV0pXG4gKlxuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgcmV2ZXJzZSA9IGZ1bmN0aW9uIChhcykgeyByZXR1cm4gKGFzLmxlbmd0aCA8PSAxID8gYXMgOiBhcy5zbGljZSgpLnJldmVyc2UoKSk7IH07XG4vKipcbiAqIEV4dHJhY3RzIGZyb20gYW4gYXJyYXkgb2YgYEVpdGhlcmAgYWxsIHRoZSBgUmlnaHRgIGVsZW1lbnRzLiBBbGwgdGhlIGBSaWdodGAgZWxlbWVudHMgYXJlIGV4dHJhY3RlZCBpbiBvcmRlclxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyByaWdodHMgfSBmcm9tICdmcC10cy9SZWFkb25seUFycmF5J1xuICogaW1wb3J0IHsgcmlnaHQsIGxlZnQgfSBmcm9tICdmcC10cy9FaXRoZXInXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChyaWdodHMoW3JpZ2h0KDEpLCBsZWZ0KCdmb28nKSwgcmlnaHQoMildKSwgWzEsIDJdKVxuICpcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIHJpZ2h0cyA9IGZ1bmN0aW9uIChhcykge1xuICAgIHZhciByID0gW107XG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBhcy5sZW5ndGg7IGkrKykge1xuICAgICAgICB2YXIgYSA9IGFzW2ldO1xuICAgICAgICBpZiAoYS5fdGFnID09PSAnUmlnaHQnKSB7XG4gICAgICAgICAgICByLnB1c2goYS5yaWdodCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHI7XG59O1xuLyoqXG4gKiBFeHRyYWN0cyBmcm9tIGFuIGFycmF5IG9mIGBFaXRoZXJgIGFsbCB0aGUgYExlZnRgIGVsZW1lbnRzLiBBbGwgdGhlIGBMZWZ0YCBlbGVtZW50cyBhcmUgZXh0cmFjdGVkIGluIG9yZGVyXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IGxlZnRzIH0gZnJvbSAnZnAtdHMvUmVhZG9ubHlBcnJheSdcbiAqIGltcG9ydCB7IGxlZnQsIHJpZ2h0IH0gZnJvbSAnZnAtdHMvRWl0aGVyJ1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwobGVmdHMoW3JpZ2h0KDEpLCBsZWZ0KCdmb28nKSwgcmlnaHQoMildKSwgWydmb28nXSlcbiAqXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBsZWZ0cyA9IGZ1bmN0aW9uIChhcykge1xuICAgIHZhciByID0gW107XG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBhcy5sZW5ndGg7IGkrKykge1xuICAgICAgICB2YXIgYSA9IGFzW2ldO1xuICAgICAgICBpZiAoYS5fdGFnID09PSAnTGVmdCcpIHtcbiAgICAgICAgICAgIHIucHVzaChhLmxlZnQpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiByO1xufTtcbi8qKlxuICogU29ydCB0aGUgZWxlbWVudHMgb2YgYW4gYXJyYXkgaW4gaW5jcmVhc2luZyBvcmRlciwgY3JlYXRpbmcgYSBuZXcgYXJyYXlcbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgc29ydCB9IGZyb20gJ2ZwLXRzL1JlYWRvbmx5QXJyYXknXG4gKiBpbXBvcnQgKiBhcyBOIGZyb20gJ2ZwLXRzL251bWJlcidcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKHNvcnQoTi5PcmQpKFszLCAyLCAxXSksIFsxLCAyLCAzXSlcbiAqXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBzb3J0ID0gZnVuY3Rpb24gKE8pIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIHJldHVybiBhcy5sZW5ndGggPD0gMSA/IGFzIDogYXMuc2xpY2UoKS5zb3J0KE8uY29tcGFyZSk7XG4gICAgfTtcbn07XG4vLyBUT0RPOiBjdXJyeSBhbmQgbWFrZSBkYXRhLWxhc3QgaW4gdjNcbi8qKlxuICogQXBwbHkgYSBmdW5jdGlvbiB0byBwYWlycyBvZiBlbGVtZW50cyBhdCB0aGUgc2FtZSBpbmRleCBpbiB0d28gYXJyYXlzLCBjb2xsZWN0aW5nIHRoZSByZXN1bHRzIGluIGEgbmV3IGFycmF5LiBJZiBvbmVcbiAqIGlucHV0IGFycmF5IGlzIHNob3J0LCBleGNlc3MgZWxlbWVudHMgb2YgdGhlIGxvbmdlciBhcnJheSBhcmUgZGlzY2FyZGVkLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyB6aXBXaXRoIH0gZnJvbSAnZnAtdHMvUmVhZG9ubHlBcnJheSdcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKHppcFdpdGgoWzEsIDIsIDNdLCBbJ2EnLCAnYicsICdjJywgJ2QnXSwgKG4sIHMpID0+IHMgKyBuKSwgWydhMScsICdiMicsICdjMyddKVxuICpcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIHppcFdpdGggPSBmdW5jdGlvbiAoZmEsIGZiLCBmKSB7XG4gICAgdmFyIGZjID0gW107XG4gICAgdmFyIGxlbiA9IE1hdGgubWluKGZhLmxlbmd0aCwgZmIubGVuZ3RoKTtcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IGxlbjsgaSsrKSB7XG4gICAgICAgIGZjW2ldID0gZihmYVtpXSwgZmJbaV0pO1xuICAgIH1cbiAgICByZXR1cm4gZmM7XG59O1xuZXhwb3J0IGZ1bmN0aW9uIHppcChhcywgYnMpIHtcbiAgICBpZiAoYnMgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICByZXR1cm4gZnVuY3Rpb24gKGJzKSB7IHJldHVybiB6aXAoYnMsIGFzKTsgfTtcbiAgICB9XG4gICAgcmV0dXJuIHppcFdpdGgoYXMsIGJzLCBmdW5jdGlvbiAoYSwgYikgeyByZXR1cm4gW2EsIGJdOyB9KTtcbn1cbi8qKlxuICogVGhlIGZ1bmN0aW9uIGlzIHJldmVyc2Ugb2YgYHppcGAuIFRha2VzIGFuIGFycmF5IG9mIHBhaXJzIGFuZCByZXR1cm4gdHdvIGNvcnJlc3BvbmRpbmcgYXJyYXlzXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IHVuemlwIH0gZnJvbSAnZnAtdHMvUmVhZG9ubHlBcnJheSdcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKHVuemlwKFtbMSwgJ2EnXSwgWzIsICdiJ10sIFszLCAnYyddXSksIFtbMSwgMiwgM10sIFsnYScsICdiJywgJ2MnXV0pXG4gKlxuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgdW56aXAgPSBmdW5jdGlvbiAoYXMpIHtcbiAgICB2YXIgZmEgPSBbXTtcbiAgICB2YXIgZmIgPSBbXTtcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IGFzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIGZhW2ldID0gYXNbaV1bMF07XG4gICAgICAgIGZiW2ldID0gYXNbaV1bMV07XG4gICAgfVxuICAgIHJldHVybiBbZmEsIGZiXTtcbn07XG4vKipcbiAqIFByZXBlbmQgYW4gZWxlbWVudCB0byBldmVyeSBtZW1iZXIgb2YgYW4gYXJyYXlcbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgcHJlcGVuZEFsbCB9IGZyb20gJ2ZwLXRzL1JlYWRvbmx5QXJyYXknXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChwcmVwZW5kQWxsKDkpKFsxLCAyLCAzLCA0XSksIFs5LCAxLCA5LCAyLCA5LCAzLCA5LCA0XSlcbiAqXG4gKiBAc2luY2UgMi4xMC4wXG4gKi9cbmV4cG9ydCB2YXIgcHJlcGVuZEFsbCA9IGZ1bmN0aW9uIChtaWRkbGUpIHtcbiAgICB2YXIgZiA9IFJORUEucHJlcGVuZEFsbChtaWRkbGUpO1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHsgcmV0dXJuIChpc05vbkVtcHR5KGFzKSA/IGYoYXMpIDogYXMpOyB9O1xufTtcbi8qKlxuICogUGxhY2VzIGFuIGVsZW1lbnQgaW4gYmV0d2VlbiBtZW1iZXJzIG9mIGFuIGFycmF5XG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IGludGVyc3BlcnNlIH0gZnJvbSAnZnAtdHMvUmVhZG9ubHlBcnJheSdcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKGludGVyc3BlcnNlKDkpKFsxLCAyLCAzLCA0XSksIFsxLCA5LCAyLCA5LCAzLCA5LCA0XSlcbiAqXG4gKiBAc2luY2UgMi45LjBcbiAqL1xuZXhwb3J0IHZhciBpbnRlcnNwZXJzZSA9IGZ1bmN0aW9uIChtaWRkbGUpIHtcbiAgICB2YXIgZiA9IFJORUEuaW50ZXJzcGVyc2UobWlkZGxlKTtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7IHJldHVybiAoaXNOb25FbXB0eShhcykgPyBmKGFzKSA6IGFzKTsgfTtcbn07XG4vKipcbiAqIFJvdGF0ZSBhIGBSZWFkb25seUFycmF5YCBieSBgbmAgc3RlcHMuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IHJvdGF0ZSB9IGZyb20gJ2ZwLXRzL1JlYWRvbmx5QXJyYXknXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChyb3RhdGUoMikoWzEsIDIsIDMsIDQsIDVdKSwgWzQsIDUsIDEsIDIsIDNdKVxuICpcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIHJvdGF0ZSA9IGZ1bmN0aW9uIChuKSB7XG4gICAgdmFyIGYgPSBSTkVBLnJvdGF0ZShuKTtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7IHJldHVybiAoaXNOb25FbXB0eShhcykgPyBmKGFzKSA6IGFzKTsgfTtcbn07XG5leHBvcnQgZnVuY3Rpb24gZWxlbShFKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhLCBhcykge1xuICAgICAgICBpZiAoYXMgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgdmFyIGVsZW1FXzEgPSBlbGVtKEUpO1xuICAgICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIChhcykgeyByZXR1cm4gZWxlbUVfMShhLCBhcyk7IH07XG4gICAgICAgIH1cbiAgICAgICAgdmFyIHByZWRpY2F0ZSA9IGZ1bmN0aW9uIChlbGVtZW50KSB7IHJldHVybiBFLmVxdWFscyhlbGVtZW50LCBhKTsgfTtcbiAgICAgICAgdmFyIGkgPSAwO1xuICAgICAgICBmb3IgKDsgaSA8IGFzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICBpZiAocHJlZGljYXRlKGFzW2ldKSkge1xuICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9O1xufVxuLyoqXG4gKiBSZW1vdmUgZHVwbGljYXRlcyBmcm9tIGFuIGFycmF5LCBrZWVwaW5nIHRoZSBmaXJzdCBvY2N1cnJlbmNlIG9mIGFuIGVsZW1lbnQuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IHVuaXEgfSBmcm9tICdmcC10cy9SZWFkb25seUFycmF5J1xuICogaW1wb3J0ICogYXMgTiBmcm9tICdmcC10cy9udW1iZXInXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbCh1bmlxKE4uRXEpKFsxLCAyLCAxXSksIFsxLCAyXSlcbiAqXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciB1bmlxID0gZnVuY3Rpb24gKEUpIHtcbiAgICB2YXIgZiA9IFJORUEudW5pcShFKTtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7IHJldHVybiAoaXNOb25FbXB0eShhcykgPyBmKGFzKSA6IGFzKTsgfTtcbn07XG4vKipcbiAqIFNvcnQgdGhlIGVsZW1lbnRzIG9mIGFuIGFycmF5IGluIGluY3JlYXNpbmcgb3JkZXIsIHdoZXJlIGVsZW1lbnRzIGFyZSBjb21wYXJlZCB1c2luZyBmaXJzdCBgb3Jkc1swXWAsIHRoZW4gYG9yZHNbMV1gLFxuICogZXRjLi4uXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IHNvcnRCeSB9IGZyb20gJ2ZwLXRzL1JlYWRvbmx5QXJyYXknXG4gKiBpbXBvcnQgeyBjb250cmFtYXAgfSBmcm9tICdmcC10cy9PcmQnXG4gKiBpbXBvcnQgKiBhcyBTIGZyb20gJ2ZwLXRzL3N0cmluZydcbiAqIGltcG9ydCAqIGFzIE4gZnJvbSAnZnAtdHMvbnVtYmVyJ1xuICogaW1wb3J0IHsgcGlwZSB9IGZyb20gJ2ZwLXRzL2Z1bmN0aW9uJ1xuICpcbiAqIGludGVyZmFjZSBQZXJzb24ge1xuICogICByZWFkb25seSBuYW1lOiBzdHJpbmdcbiAqICAgcmVhZG9ubHkgYWdlOiBudW1iZXJcbiAqIH1cbiAqIGNvbnN0IGJ5TmFtZSA9IHBpcGUoUy5PcmQsIGNvbnRyYW1hcCgocDogUGVyc29uKSA9PiBwLm5hbWUpKVxuICogY29uc3QgYnlBZ2UgPSBwaXBlKE4uT3JkLCBjb250cmFtYXAoKHA6IFBlcnNvbikgPT4gcC5hZ2UpKVxuICpcbiAqIGNvbnN0IHNvcnRCeU5hbWVCeUFnZSA9IHNvcnRCeShbYnlOYW1lLCBieUFnZV0pXG4gKlxuICogY29uc3QgcGVyc29ucyA9IFt7IG5hbWU6ICdhJywgYWdlOiAxIH0sIHsgbmFtZTogJ2InLCBhZ2U6IDMgfSwgeyBuYW1lOiAnYycsIGFnZTogMiB9LCB7IG5hbWU6ICdiJywgYWdlOiAyIH1dXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKHNvcnRCeU5hbWVCeUFnZShwZXJzb25zKSwgW1xuICogICB7IG5hbWU6ICdhJywgYWdlOiAxIH0sXG4gKiAgIHsgbmFtZTogJ2InLCBhZ2U6IDIgfSxcbiAqICAgeyBuYW1lOiAnYicsIGFnZTogMyB9LFxuICogICB7IG5hbWU6ICdjJywgYWdlOiAyIH1cbiAqIF0pXG4gKlxuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgc29ydEJ5ID0gZnVuY3Rpb24gKG9yZHMpIHtcbiAgICB2YXIgZiA9IFJORUEuc29ydEJ5KG9yZHMpO1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHsgcmV0dXJuIChpc05vbkVtcHR5KGFzKSA/IGYoYXMpIDogYXMpOyB9O1xufTtcbi8qKlxuICogQSB1c2VmdWwgcmVjdXJzaW9uIHBhdHRlcm4gZm9yIHByb2Nlc3NpbmcgYSBgUmVhZG9ubHlBcnJheWAgdG8gcHJvZHVjZSBhIG5ldyBgUmVhZG9ubHlBcnJheWAsIG9mdGVuIHVzZWQgZm9yIFwiY2hvcHBpbmdcIiB1cCB0aGUgaW5wdXRcbiAqIGBSZWFkb25seUFycmF5YC4gVHlwaWNhbGx5IGBjaG9wYCBpcyBjYWxsZWQgd2l0aCBzb21lIGZ1bmN0aW9uIHRoYXQgd2lsbCBjb25zdW1lIGFuIGluaXRpYWwgcHJlZml4IG9mIHRoZSBgUmVhZG9ubHlBcnJheWAgYW5kIHByb2R1Y2UgYVxuICogdmFsdWUgYW5kIHRoZSB0YWlsIG9mIHRoZSBgUmVhZG9ubHlBcnJheWAuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IEVxIH0gZnJvbSAnZnAtdHMvRXEnXG4gKiBpbXBvcnQgKiBhcyBSQSBmcm9tICdmcC10cy9SZWFkb25seUFycmF5J1xuICogaW1wb3J0ICogYXMgTiBmcm9tICdmcC10cy9udW1iZXInXG4gKiBpbXBvcnQgeyBwaXBlIH0gZnJvbSAnZnAtdHMvZnVuY3Rpb24nXG4gKlxuICogY29uc3QgZ3JvdXAgPSA8QT4oUzogRXE8QT4pOiAoKGFzOiBSZWFkb25seUFycmF5PEE+KSA9PiBSZWFkb25seUFycmF5PFJlYWRvbmx5QXJyYXk8QT4+KSA9PiB7XG4gKiAgIHJldHVybiBSQS5jaG9wKGFzID0+IHtcbiAqICAgICBjb25zdCB7IGluaXQsIHJlc3QgfSA9IHBpcGUoYXMsIFJBLnNwYW5MZWZ0KChhOiBBKSA9PiBTLmVxdWFscyhhLCBhc1swXSkpKVxuICogICAgIHJldHVybiBbaW5pdCwgcmVzdF1cbiAqICAgfSlcbiAqIH1cbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoZ3JvdXAoTi5FcSkoWzEsIDEsIDIsIDMsIDMsIDRdKSwgW1sxLCAxXSwgWzJdLCBbMywgM10sIFs0XV0pXG4gKlxuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgY2hvcCA9IGZ1bmN0aW9uIChmKSB7XG4gICAgdmFyIGcgPSBSTkVBLmNob3AoZik7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykgeyByZXR1cm4gKGlzTm9uRW1wdHkoYXMpID8gZyhhcykgOiBlbXB0eSk7IH07XG59O1xuLyoqXG4gKiBTcGxpdHMgYSBgUmVhZG9ubHlBcnJheWAgaW50byB0d28gcGllY2VzLCB0aGUgZmlyc3QgcGllY2UgaGFzIG1heCBgbmAgZWxlbWVudHMuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IHNwbGl0QXQgfSBmcm9tICdmcC10cy9SZWFkb25seUFycmF5J1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoc3BsaXRBdCgyKShbMSwgMiwgMywgNCwgNV0pLCBbWzEsIDJdLCBbMywgNCwgNV1dKVxuICpcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIHNwbGl0QXQgPSBmdW5jdGlvbiAobikge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgcmV0dXJuIG4gPj0gMSAmJiBpc05vbkVtcHR5KGFzKSA/IFJORUEuc3BsaXRBdChuKShhcykgOiBpc0VtcHR5KGFzKSA/IFthcywgZW1wdHldIDogW2VtcHR5LCBhc107XG4gICAgfTtcbn07XG4vKipcbiAqIFNwbGl0cyBhIGBSZWFkb25seUFycmF5YCBpbnRvIGxlbmd0aC1gbmAgcGllY2VzLiBUaGUgbGFzdCBwaWVjZSB3aWxsIGJlIHNob3J0ZXIgaWYgYG5gIGRvZXMgbm90IGV2ZW5seSBkaXZpZGUgdGhlIGxlbmd0aCBvZlxuICogdGhlIGBSZWFkb25seUFycmF5YC4gTm90ZSB0aGF0IGBjaHVua3NPZihuKShbXSlgIGlzIGBbXWAsIG5vdCBgW1tdXWAuIFRoaXMgaXMgaW50ZW50aW9uYWwsIGFuZCBpcyBjb25zaXN0ZW50IHdpdGggYSByZWN1cnNpdmVcbiAqIGRlZmluaXRpb24gb2YgYGNodW5rc09mYDsgaXQgc2F0aXNmaWVzIHRoZSBwcm9wZXJ0eSB0aGF0OlxuICpcbiAqIGBgYHRzXG4gKiBjaHVua3NPZihuKSh4cykuY29uY2F0KGNodW5rc09mKG4pKHlzKSkgPT0gY2h1bmtzT2YobikoeHMuY29uY2F0KHlzKSkpXG4gKiBgYGBcbiAqXG4gKiB3aGVuZXZlciBgbmAgZXZlbmx5IGRpdmlkZXMgdGhlIGxlbmd0aCBvZiBgYXNgLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBjaHVua3NPZiB9IGZyb20gJ2ZwLXRzL1JlYWRvbmx5QXJyYXknXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChjaHVua3NPZigyKShbMSwgMiwgMywgNCwgNV0pLCBbWzEsIDJdLCBbMywgNF0sIFs1XV0pXG4gKlxuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgY2h1bmtzT2YgPSBmdW5jdGlvbiAobikge1xuICAgIHZhciBmID0gUk5FQS5jaHVua3NPZihuKTtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7IHJldHVybiAoaXNOb25FbXB0eShhcykgPyBmKGFzKSA6IGVtcHR5KTsgfTtcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBsaWZ0aW5nXG4gKiBAc2luY2UgMi4xMS4wXG4gKi9cbmV4cG9ydCB2YXIgZnJvbU9wdGlvbksgPSBmdW5jdGlvbiAoZikge1xuICAgIHJldHVybiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBhID0gW107XG4gICAgICAgIGZvciAodmFyIF9pID0gMDsgX2kgPCBhcmd1bWVudHMubGVuZ3RoOyBfaSsrKSB7XG4gICAgICAgICAgICBhW19pXSA9IGFyZ3VtZW50c1tfaV07XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGZyb21PcHRpb24oZi5hcHBseSh2b2lkIDAsIGEpKTtcbiAgICB9O1xufTtcbmV4cG9ydCBmdW5jdGlvbiBjb21wcmVoZW5zaW9uKGlucHV0LCBmLCBnKSB7XG4gICAgaWYgKGcgPT09IHZvaWQgMCkgeyBnID0gZnVuY3Rpb24gKCkgeyByZXR1cm4gdHJ1ZTsgfTsgfVxuICAgIHZhciBnbyA9IGZ1bmN0aW9uIChzY29wZSwgaW5wdXQpIHtcbiAgICAgICAgcmV0dXJuIGlzTm9uRW1wdHkoaW5wdXQpXG4gICAgICAgICAgICA/IGZsYXRNYXAoUk5FQS5oZWFkKGlucHV0KSwgZnVuY3Rpb24gKGEpIHsgcmV0dXJuIGdvKHBpcGUoc2NvcGUsIGFwcGVuZChhKSksIFJORUEudGFpbChpbnB1dCkpOyB9KVxuICAgICAgICAgICAgOiBnLmFwcGx5KHZvaWQgMCwgc2NvcGUpID8gW2YuYXBwbHkodm9pZCAwLCBzY29wZSldXG4gICAgICAgICAgICAgICAgOiBlbXB0eTtcbiAgICB9O1xuICAgIHJldHVybiBnbyhlbXB0eSwgaW5wdXQpO1xufVxuLyoqXG4gKiBAc2luY2UgMi4xMS4wXG4gKi9cbmV4cG9ydCB2YXIgY29uY2F0VyA9IGZ1bmN0aW9uIChzZWNvbmQpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGZpcnN0KSB7XG4gICAgICAgIHJldHVybiBpc0VtcHR5KGZpcnN0KSA/IHNlY29uZCA6IGlzRW1wdHkoc2Vjb25kKSA/IGZpcnN0IDogZmlyc3QuY29uY2F0KHNlY29uZCk7XG4gICAgfTtcbn07XG4vKipcbiAqIEBzaW5jZSAyLjExLjBcbiAqL1xuZXhwb3J0IHZhciBjb25jYXQgPSBjb25jYXRXO1xuZXhwb3J0IGZ1bmN0aW9uIHVuaW9uKEUpIHtcbiAgICB2YXIgdW5pb25FID0gUk5FQS51bmlvbihFKTtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGZpcnN0LCBzZWNvbmQpIHtcbiAgICAgICAgaWYgKHNlY29uZCA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICB2YXIgdW5pb25FXzEgPSB1bmlvbihFKTtcbiAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbiAoc2Vjb25kKSB7IHJldHVybiB1bmlvbkVfMShzZWNvbmQsIGZpcnN0KTsgfTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gaXNOb25FbXB0eShmaXJzdCkgJiYgaXNOb25FbXB0eShzZWNvbmQpID8gdW5pb25FKHNlY29uZCkoZmlyc3QpIDogaXNOb25FbXB0eShmaXJzdCkgPyBmaXJzdCA6IHNlY29uZDtcbiAgICB9O1xufVxuZXhwb3J0IGZ1bmN0aW9uIGludGVyc2VjdGlvbihFKSB7XG4gICAgdmFyIGVsZW1FID0gZWxlbShFKTtcbiAgICByZXR1cm4gZnVuY3Rpb24gKHhzLCB5cykge1xuICAgICAgICBpZiAoeXMgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgdmFyIGludGVyc2VjdGlvbkVfMSA9IGludGVyc2VjdGlvbihFKTtcbiAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbiAoeXMpIHsgcmV0dXJuIGludGVyc2VjdGlvbkVfMSh5cywgeHMpOyB9O1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB4cy5maWx0ZXIoZnVuY3Rpb24gKGEpIHsgcmV0dXJuIGVsZW1FKGEsIHlzKTsgfSk7XG4gICAgfTtcbn1cbmV4cG9ydCBmdW5jdGlvbiBkaWZmZXJlbmNlKEUpIHtcbiAgICB2YXIgZWxlbUUgPSBlbGVtKEUpO1xuICAgIHJldHVybiBmdW5jdGlvbiAoeHMsIHlzKSB7XG4gICAgICAgIGlmICh5cyA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICB2YXIgZGlmZmVyZW5jZUVfMSA9IGRpZmZlcmVuY2UoRSk7XG4gICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24gKHlzKSB7IHJldHVybiBkaWZmZXJlbmNlRV8xKHlzLCB4cyk7IH07XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHhzLmZpbHRlcihmdW5jdGlvbiAoYSkgeyByZXR1cm4gIWVsZW1FKGEsIHlzKTsgfSk7XG4gICAgfTtcbn1cbnZhciBfbWFwID0gZnVuY3Rpb24gKGZhLCBmKSB7IHJldHVybiBwaXBlKGZhLCBtYXAoZikpOyB9O1xudmFyIF9tYXBXaXRoSW5kZXggPSBmdW5jdGlvbiAoZmEsIGYpIHsgcmV0dXJuIHBpcGUoZmEsIG1hcFdpdGhJbmRleChmKSk7IH07XG52YXIgX2FwID0gZnVuY3Rpb24gKGZhYiwgZmEpIHsgcmV0dXJuIHBpcGUoZmFiLCBhcChmYSkpOyB9O1xudmFyIF9maWx0ZXIgPSBmdW5jdGlvbiAoZmEsIHByZWRpY2F0ZSkge1xuICAgIHJldHVybiBwaXBlKGZhLCBmaWx0ZXIocHJlZGljYXRlKSk7XG59O1xudmFyIF9maWx0ZXJNYXAgPSBmdW5jdGlvbiAoZmEsIGYpIHsgcmV0dXJuIHBpcGUoZmEsIGZpbHRlck1hcChmKSk7IH07XG52YXIgX3BhcnRpdGlvbiA9IGZ1bmN0aW9uIChmYSwgcHJlZGljYXRlKSB7XG4gICAgcmV0dXJuIHBpcGUoZmEsIHBhcnRpdGlvbihwcmVkaWNhdGUpKTtcbn07XG52YXIgX3BhcnRpdGlvbk1hcCA9IGZ1bmN0aW9uIChmYSwgZikgeyByZXR1cm4gcGlwZShmYSwgcGFydGl0aW9uTWFwKGYpKTsgfTtcbnZhciBfcGFydGl0aW9uV2l0aEluZGV4ID0gZnVuY3Rpb24gKGZhLCBwcmVkaWNhdGVXaXRoSW5kZXgpIHsgcmV0dXJuIHBpcGUoZmEsIHBhcnRpdGlvbldpdGhJbmRleChwcmVkaWNhdGVXaXRoSW5kZXgpKTsgfTtcbnZhciBfcGFydGl0aW9uTWFwV2l0aEluZGV4ID0gZnVuY3Rpb24gKGZhLCBmKSB7IHJldHVybiBwaXBlKGZhLCBwYXJ0aXRpb25NYXBXaXRoSW5kZXgoZikpOyB9O1xudmFyIF9hbHQgPSBmdW5jdGlvbiAoZmEsIHRoYXQpIHsgcmV0dXJuIHBpcGUoZmEsIGFsdCh0aGF0KSk7IH07XG52YXIgX3JlZHVjZSA9IGZ1bmN0aW9uIChmYSwgYiwgZikgeyByZXR1cm4gcGlwZShmYSwgcmVkdWNlKGIsIGYpKTsgfTtcbnZhciBfZm9sZE1hcCA9IGZ1bmN0aW9uIChNKSB7XG4gICAgdmFyIGZvbGRNYXBNID0gZm9sZE1hcChNKTtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGZhLCBmKSB7IHJldHVybiBwaXBlKGZhLCBmb2xkTWFwTShmKSk7IH07XG59O1xudmFyIF9yZWR1Y2VSaWdodCA9IGZ1bmN0aW9uIChmYSwgYiwgZikgeyByZXR1cm4gcGlwZShmYSwgcmVkdWNlUmlnaHQoYiwgZikpOyB9O1xudmFyIF9yZWR1Y2VXaXRoSW5kZXggPSBmdW5jdGlvbiAoZmEsIGIsIGYpIHtcbiAgICByZXR1cm4gcGlwZShmYSwgcmVkdWNlV2l0aEluZGV4KGIsIGYpKTtcbn07XG52YXIgX2ZvbGRNYXBXaXRoSW5kZXggPSBmdW5jdGlvbiAoTSkge1xuICAgIHZhciBmb2xkTWFwV2l0aEluZGV4TSA9IGZvbGRNYXBXaXRoSW5kZXgoTSk7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChmYSwgZikgeyByZXR1cm4gcGlwZShmYSwgZm9sZE1hcFdpdGhJbmRleE0oZikpOyB9O1xufTtcbnZhciBfcmVkdWNlUmlnaHRXaXRoSW5kZXggPSBmdW5jdGlvbiAoZmEsIGIsIGYpIHtcbiAgICByZXR1cm4gcGlwZShmYSwgcmVkdWNlUmlnaHRXaXRoSW5kZXgoYiwgZikpO1xufTtcbnZhciBfZmlsdGVyTWFwV2l0aEluZGV4ID0gZnVuY3Rpb24gKGZhLCBmKSB7IHJldHVybiBwaXBlKGZhLCBmaWx0ZXJNYXBXaXRoSW5kZXgoZikpOyB9O1xudmFyIF9maWx0ZXJXaXRoSW5kZXggPSBmdW5jdGlvbiAoZmEsIHByZWRpY2F0ZVdpdGhJbmRleCkgeyByZXR1cm4gcGlwZShmYSwgZmlsdGVyV2l0aEluZGV4KHByZWRpY2F0ZVdpdGhJbmRleCkpOyB9O1xudmFyIF9leHRlbmQgPSBmdW5jdGlvbiAoZmEsIGYpIHsgcmV0dXJuIHBpcGUoZmEsIGV4dGVuZChmKSk7IH07XG52YXIgX3RyYXZlcnNlID0gZnVuY3Rpb24gKEYpIHtcbiAgICB2YXIgdHJhdmVyc2VGID0gdHJhdmVyc2UoRik7XG4gICAgcmV0dXJuIGZ1bmN0aW9uICh0YSwgZikgeyByZXR1cm4gcGlwZSh0YSwgdHJhdmVyc2VGKGYpKTsgfTtcbn07XG4vKiBpc3RhbmJ1bCBpZ25vcmUgbmV4dCAqL1xudmFyIF90cmF2ZXJzZVdpdGhJbmRleCA9IGZ1bmN0aW9uIChGKSB7XG4gICAgdmFyIHRyYXZlcnNlV2l0aEluZGV4RiA9IHRyYXZlcnNlV2l0aEluZGV4KEYpO1xuICAgIHJldHVybiBmdW5jdGlvbiAodGEsIGYpIHsgcmV0dXJuIHBpcGUodGEsIHRyYXZlcnNlV2l0aEluZGV4RihmKSk7IH07XG59O1xuLyoqIEBpbnRlcm5hbCAqL1xuZXhwb3J0IHZhciBfY2hhaW5SZWNEZXB0aEZpcnN0ID0gZnVuY3Rpb24gKGEsIGYpIHsgcmV0dXJuIHBpcGUoYSwgY2hhaW5SZWNEZXB0aEZpcnN0KGYpKTsgfTtcbi8qKiBAaW50ZXJuYWwgKi9cbmV4cG9ydCB2YXIgX2NoYWluUmVjQnJlYWR0aEZpcnN0ID0gZnVuY3Rpb24gKGEsIGYpIHsgcmV0dXJuIHBpcGUoYSwgY2hhaW5SZWNCcmVhZHRoRmlyc3QoZikpOyB9O1xuLyoqXG4gKiBAY2F0ZWdvcnkgY29uc3RydWN0b3JzXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBvZiA9IFJORUEub2Y7XG4vKipcbiAqIEBzaW5jZSAyLjcuMFxuICovXG5leHBvcnQgdmFyIHplcm8gPSBmdW5jdGlvbiAoKSB7IHJldHVybiBlbXB0eTsgfTtcbi8qKlxuICogTGVzcyBzdHJpY3QgdmVyc2lvbiBvZiBbYGFsdGBdKCNhbHQpLlxuICpcbiAqIFRoZSBgV2Agc3VmZml4IChzaG9ydCBmb3IgKipXKippZGVuaW5nKSBtZWFucyB0aGF0IHRoZSByZXR1cm4gdHlwZXMgd2lsbCBiZSBtZXJnZWQuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCAqIGFzIFJBIGZyb20gJ2ZwLXRzL1JlYWRvbmx5QXJyYXknXG4gKiBpbXBvcnQgeyBwaXBlIH0gZnJvbSAnZnAtdHMvZnVuY3Rpb24nXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChcbiAqICAgcGlwZShcbiAqICAgICBbMSwgMiwgM10sXG4gKiAgICAgUkEuYWx0VygoKSA9PiBbJ2EnLCAnYiddKVxuICogICApLFxuICogICBbMSwgMiwgMywgJ2EnLCAnYiddXG4gKiApXG4gKlxuICogQGNhdGVnb3J5IGVycm9yIGhhbmRsaW5nXG4gKiBAc2luY2UgMi45LjBcbiAqL1xuZXhwb3J0IHZhciBhbHRXID0gZnVuY3Rpb24gKHRoYXQpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGZhKSB7XG4gICAgICAgIHJldHVybiBmYS5jb25jYXQodGhhdCgpKTtcbiAgICB9O1xufTtcbi8qKlxuICogSWRlbnRpZmllcyBhbiBhc3NvY2lhdGl2ZSBvcGVyYXRpb24gb24gYSB0eXBlIGNvbnN0cnVjdG9yLiBJdCBpcyBzaW1pbGFyIHRvIGBTZW1pZ3JvdXBgLCBleGNlcHQgdGhhdCBpdCBhcHBsaWVzIHRvXG4gKiB0eXBlcyBvZiBraW5kIGAqIC0+ICpgLlxuICpcbiAqIEluIGNhc2Ugb2YgYFJlYWRvbmx5QXJyYXlgIGNvbmNhdGVuYXRlcyB0aGUgaW5wdXRzIGludG8gYSBzaW5nbGUgYXJyYXkuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCAqIGFzIFJBIGZyb20gJ2ZwLXRzL1JlYWRvbmx5QXJyYXknXG4gKiBpbXBvcnQgeyBwaXBlIH0gZnJvbSAnZnAtdHMvZnVuY3Rpb24nXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChcbiAqICAgcGlwZShcbiAqICAgICBbMSwgMiwgM10sXG4gKiAgICAgUkEuYWx0KCgpID0+IFs0LCA1XSlcbiAqICAgKSxcbiAqICAgWzEsIDIsIDMsIDQsIDVdXG4gKiApXG4gKlxuICogQGNhdGVnb3J5IGVycm9yIGhhbmRsaW5nXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBhbHQgPSBhbHRXO1xuLyoqXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBhcCA9IGZ1bmN0aW9uIChmYSkge1xuICAgIHJldHVybiBmbGF0TWFwKGZ1bmN0aW9uIChmKSB7IHJldHVybiBwaXBlKGZhLCBtYXAoZikpOyB9KTtcbn07XG4vKipcbiAqIENvbXBvc2VzIGNvbXB1dGF0aW9ucyBpbiBzZXF1ZW5jZSwgdXNpbmcgdGhlIHJldHVybiB2YWx1ZSBvZiBvbmUgY29tcHV0YXRpb24gdG8gZGV0ZXJtaW5lIHRoZSBuZXh0IGNvbXB1dGF0aW9uLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgKiBhcyBSQSBmcm9tICdmcC10cy9SZWFkb25seUFycmF5J1xuICogaW1wb3J0IHsgcGlwZSB9IGZyb20gJ2ZwLXRzL2Z1bmN0aW9uJ1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoXG4gKiAgIHBpcGUoXG4gKiAgICAgWzEsIDIsIDNdLFxuICogICAgIFJBLmZsYXRNYXAoKG4pID0+IFtgYSR7bn1gLCBgYiR7bn1gXSlcbiAqICAgKSxcbiAqICAgWydhMScsICdiMScsICdhMicsICdiMicsICdhMycsICdiMyddXG4gKiApXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKFxuICogICBwaXBlKFxuICogICAgIFsxLCAyLCAzXSxcbiAqICAgICBSQS5mbGF0TWFwKCgpID0+IFtdKVxuICogICApLFxuICogICBbXVxuICogKVxuICpcbiAqIEBjYXRlZ29yeSBzZXF1ZW5jaW5nXG4gKiBAc2luY2UgMi4xNC4wXG4gKi9cbmV4cG9ydCB2YXIgZmxhdE1hcCA9IC8qI19fUFVSRV9fKi8gZHVhbCgyLCBmdW5jdGlvbiAobWEsIGYpIHtcbiAgICByZXR1cm4gcGlwZShtYSwgY2hhaW5XaXRoSW5kZXgoZnVuY3Rpb24gKGksIGEpIHsgcmV0dXJuIGYoYSwgaSk7IH0pKTtcbn0pO1xuLyoqXG4gKiBAY2F0ZWdvcnkgc2VxdWVuY2luZ1xuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgZmxhdHRlbiA9IC8qI19fUFVSRV9fKi8gZmxhdE1hcChpZGVudGl0eSk7XG4vKipcbiAqIGBtYXBgIGNhbiBiZSB1c2VkIHRvIHR1cm4gZnVuY3Rpb25zIGAoYTogQSkgPT4gQmAgaW50byBmdW5jdGlvbnMgYChmYTogRjxBPikgPT4gRjxCPmAgd2hvc2UgYXJndW1lbnQgYW5kIHJldHVybiB0eXBlc1xuICogdXNlIHRoZSB0eXBlIGNvbnN0cnVjdG9yIGBGYCB0byByZXByZXNlbnQgc29tZSBjb21wdXRhdGlvbmFsIGNvbnRleHQuXG4gKlxuICogQGNhdGVnb3J5IG1hcHBpbmdcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIG1hcCA9IGZ1bmN0aW9uIChmKSB7IHJldHVybiBmdW5jdGlvbiAoZmEpIHtcbiAgICByZXR1cm4gZmEubWFwKGZ1bmN0aW9uIChhKSB7IHJldHVybiBmKGEpOyB9KTtcbn07IH07XG4vKipcbiAqIEBjYXRlZ29yeSBtYXBwaW5nXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBtYXBXaXRoSW5kZXggPSBmdW5jdGlvbiAoZikgeyByZXR1cm4gZnVuY3Rpb24gKGZhKSB7XG4gICAgcmV0dXJuIGZhLm1hcChmdW5jdGlvbiAoYSwgaSkgeyByZXR1cm4gZihpLCBhKTsgfSk7XG59OyB9O1xuLyoqXG4gKiBAY2F0ZWdvcnkgZmlsdGVyaW5nXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBzZXBhcmF0ZSA9IGZ1bmN0aW9uIChmYSkge1xuICAgIHZhciBsZWZ0ID0gW107XG4gICAgdmFyIHJpZ2h0ID0gW107XG4gICAgZm9yICh2YXIgX2kgPSAwLCBmYV8xID0gZmE7IF9pIDwgZmFfMS5sZW5ndGg7IF9pKyspIHtcbiAgICAgICAgdmFyIGUgPSBmYV8xW19pXTtcbiAgICAgICAgaWYgKGUuX3RhZyA9PT0gJ0xlZnQnKSB7XG4gICAgICAgICAgICBsZWZ0LnB1c2goZS5sZWZ0KTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHJpZ2h0LnB1c2goZS5yaWdodCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHNlcGFyYXRlZChsZWZ0LCByaWdodCk7XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgZmlsdGVyaW5nXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBmaWx0ZXIgPSBmdW5jdGlvbiAocHJlZGljYXRlKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykge1xuICAgICAgICByZXR1cm4gYXMuZmlsdGVyKHByZWRpY2F0ZSk7XG4gICAgfTtcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBmaWx0ZXJpbmdcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIGZpbHRlck1hcFdpdGhJbmRleCA9IGZ1bmN0aW9uIChmKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChmYSkge1xuICAgICAgICB2YXIgb3V0ID0gW107XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgZmEubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIHZhciBvcHRpb25CID0gZihpLCBmYVtpXSk7XG4gICAgICAgICAgICBpZiAoXy5pc1NvbWUob3B0aW9uQikpIHtcbiAgICAgICAgICAgICAgICBvdXQucHVzaChvcHRpb25CLnZhbHVlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gb3V0O1xuICAgIH07XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgZmlsdGVyaW5nXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBmaWx0ZXJNYXAgPSBmdW5jdGlvbiAoZikge1xuICAgIHJldHVybiBmaWx0ZXJNYXBXaXRoSW5kZXgoZnVuY3Rpb24gKF8sIGEpIHsgcmV0dXJuIGYoYSk7IH0pO1xufTtcbi8qKlxuICogQGNhdGVnb3J5IGZpbHRlcmluZ1xuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgY29tcGFjdCA9IC8qI19fUFVSRV9fKi8gZmlsdGVyTWFwKGlkZW50aXR5KTtcbi8qKlxuICogQGNhdGVnb3J5IGZpbHRlcmluZ1xuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgcGFydGl0aW9uID0gZnVuY3Rpb24gKHByZWRpY2F0ZSkge1xuICAgIHJldHVybiBwYXJ0aXRpb25XaXRoSW5kZXgoZnVuY3Rpb24gKF8sIGEpIHsgcmV0dXJuIHByZWRpY2F0ZShhKTsgfSk7XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgZmlsdGVyaW5nXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBwYXJ0aXRpb25XaXRoSW5kZXggPSBmdW5jdGlvbiAocHJlZGljYXRlV2l0aEluZGV4KSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykge1xuICAgICAgICB2YXIgbGVmdCA9IFtdO1xuICAgICAgICB2YXIgcmlnaHQgPSBbXTtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBhcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgdmFyIGEgPSBhc1tpXTtcbiAgICAgICAgICAgIGlmIChwcmVkaWNhdGVXaXRoSW5kZXgoaSwgYSkpIHtcbiAgICAgICAgICAgICAgICByaWdodC5wdXNoKGEpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgbGVmdC5wdXNoKGEpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBzZXBhcmF0ZWQobGVmdCwgcmlnaHQpO1xuICAgIH07XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgZmlsdGVyaW5nXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBwYXJ0aXRpb25NYXAgPSBmdW5jdGlvbiAoZikge1xuICAgIHJldHVybiBwYXJ0aXRpb25NYXBXaXRoSW5kZXgoZnVuY3Rpb24gKF8sIGEpIHsgcmV0dXJuIGYoYSk7IH0pO1xufTtcbi8qKlxuICogQGNhdGVnb3J5IGZpbHRlcmluZ1xuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgcGFydGl0aW9uTWFwV2l0aEluZGV4ID0gZnVuY3Rpb24gKGYpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGZhKSB7XG4gICAgICAgIHZhciBsZWZ0ID0gW107XG4gICAgICAgIHZhciByaWdodCA9IFtdO1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGZhLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICB2YXIgZSA9IGYoaSwgZmFbaV0pO1xuICAgICAgICAgICAgaWYgKGUuX3RhZyA9PT0gJ0xlZnQnKSB7XG4gICAgICAgICAgICAgICAgbGVmdC5wdXNoKGUubGVmdCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICByaWdodC5wdXNoKGUucmlnaHQpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBzZXBhcmF0ZWQobGVmdCwgcmlnaHQpO1xuICAgIH07XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgZmlsdGVyaW5nXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBmaWx0ZXJXaXRoSW5kZXggPSBmdW5jdGlvbiAocHJlZGljYXRlV2l0aEluZGV4KSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykge1xuICAgICAgICByZXR1cm4gYXMuZmlsdGVyKGZ1bmN0aW9uIChhLCBpKSB7IHJldHVybiBwcmVkaWNhdGVXaXRoSW5kZXgoaSwgYSk7IH0pO1xuICAgIH07XG59O1xuLyoqXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBleHRlbmQgPSBmdW5jdGlvbiAoZikgeyByZXR1cm4gZnVuY3Rpb24gKHdhKSB7XG4gICAgcmV0dXJuIHdhLm1hcChmdW5jdGlvbiAoXywgaSkgeyByZXR1cm4gZih3YS5zbGljZShpKSk7IH0pO1xufTsgfTtcbi8qKlxuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgZHVwbGljYXRlID0gLyojX19QVVJFX18qLyBleHRlbmQoaWRlbnRpdHkpO1xuLyoqXG4gKiBAY2F0ZWdvcnkgZm9sZGluZ1xuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgZm9sZE1hcFdpdGhJbmRleCA9IGZ1bmN0aW9uIChNKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChmKSB7XG4gICAgICAgIHJldHVybiBmdW5jdGlvbiAoZmEpIHtcbiAgICAgICAgICAgIHJldHVybiBmYS5yZWR1Y2UoZnVuY3Rpb24gKGIsIGEsIGkpIHsgcmV0dXJuIE0uY29uY2F0KGIsIGYoaSwgYSkpOyB9LCBNLmVtcHR5KTtcbiAgICAgICAgfTtcbiAgICB9O1xufTtcbi8qKlxuICogQGNhdGVnb3J5IGZvbGRpbmdcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIHJlZHVjZSA9IGZ1bmN0aW9uIChiLCBmKSB7XG4gICAgcmV0dXJuIHJlZHVjZVdpdGhJbmRleChiLCBmdW5jdGlvbiAoXywgYiwgYSkgeyByZXR1cm4gZihiLCBhKTsgfSk7XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgZm9sZGluZ1xuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgZm9sZE1hcCA9IGZ1bmN0aW9uIChNKSB7XG4gICAgdmFyIGZvbGRNYXBXaXRoSW5kZXhNID0gZm9sZE1hcFdpdGhJbmRleChNKTtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGYpIHsgcmV0dXJuIGZvbGRNYXBXaXRoSW5kZXhNKGZ1bmN0aW9uIChfLCBhKSB7IHJldHVybiBmKGEpOyB9KTsgfTtcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBmb2xkaW5nXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciByZWR1Y2VXaXRoSW5kZXggPSBmdW5jdGlvbiAoYiwgZikgeyByZXR1cm4gZnVuY3Rpb24gKGZhKSB7XG4gICAgdmFyIGxlbiA9IGZhLmxlbmd0aDtcbiAgICB2YXIgb3V0ID0gYjtcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IGxlbjsgaSsrKSB7XG4gICAgICAgIG91dCA9IGYoaSwgb3V0LCBmYVtpXSk7XG4gICAgfVxuICAgIHJldHVybiBvdXQ7XG59OyB9O1xuLyoqXG4gKiBAY2F0ZWdvcnkgZm9sZGluZ1xuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgcmVkdWNlUmlnaHQgPSBmdW5jdGlvbiAoYiwgZikge1xuICAgIHJldHVybiByZWR1Y2VSaWdodFdpdGhJbmRleChiLCBmdW5jdGlvbiAoXywgYSwgYikgeyByZXR1cm4gZihhLCBiKTsgfSk7XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgZm9sZGluZ1xuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgcmVkdWNlUmlnaHRXaXRoSW5kZXggPSBmdW5jdGlvbiAoYiwgZikgeyByZXR1cm4gZnVuY3Rpb24gKGZhKSB7XG4gICAgcmV0dXJuIGZhLnJlZHVjZVJpZ2h0KGZ1bmN0aW9uIChiLCBhLCBpKSB7IHJldHVybiBmKGksIGEsIGIpOyB9LCBiKTtcbn07IH07XG4vKipcbiAqIEBjYXRlZ29yeSB0cmF2ZXJzaW5nXG4gKiBAc2luY2UgMi42LjNcbiAqL1xuZXhwb3J0IHZhciB0cmF2ZXJzZSA9IGZ1bmN0aW9uIChGKSB7XG4gICAgdmFyIHRyYXZlcnNlV2l0aEluZGV4RiA9IHRyYXZlcnNlV2l0aEluZGV4KEYpO1xuICAgIHJldHVybiBmdW5jdGlvbiAoZikgeyByZXR1cm4gdHJhdmVyc2VXaXRoSW5kZXhGKGZ1bmN0aW9uIChfLCBhKSB7IHJldHVybiBmKGEpOyB9KTsgfTtcbn07XG4vKipcbiAqIEBjYXRlZ29yeSB0cmF2ZXJzaW5nXG4gKiBAc2luY2UgMi42LjNcbiAqL1xuZXhwb3J0IHZhciBzZXF1ZW5jZSA9IGZ1bmN0aW9uIChGKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uICh0YSkge1xuICAgICAgICByZXR1cm4gX3JlZHVjZSh0YSwgRi5vZih6ZXJvKCkpLCBmdW5jdGlvbiAoZmFzLCBmYSkge1xuICAgICAgICAgICAgcmV0dXJuIEYuYXAoRi5tYXAoZmFzLCBmdW5jdGlvbiAoYXMpIHsgcmV0dXJuIGZ1bmN0aW9uIChhKSB7IHJldHVybiBwaXBlKGFzLCBhcHBlbmQoYSkpOyB9OyB9KSwgZmEpO1xuICAgICAgICB9KTtcbiAgICB9O1xufTtcbi8qKlxuICogQGNhdGVnb3J5IHNlcXVlbmNpbmdcbiAqIEBzaW5jZSAyLjYuM1xuICovXG5leHBvcnQgdmFyIHRyYXZlcnNlV2l0aEluZGV4ID0gZnVuY3Rpb24gKEYpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGYpIHtcbiAgICAgICAgcmV0dXJuIHJlZHVjZVdpdGhJbmRleChGLm9mKHplcm8oKSksIGZ1bmN0aW9uIChpLCBmYnMsIGEpIHtcbiAgICAgICAgICAgIHJldHVybiBGLmFwKEYubWFwKGZicywgZnVuY3Rpb24gKGJzKSB7IHJldHVybiBmdW5jdGlvbiAoYikgeyByZXR1cm4gcGlwZShicywgYXBwZW5kKGIpKTsgfTsgfSksIGYoaSwgYSkpO1xuICAgICAgICB9KTtcbiAgICB9O1xufTtcbi8qKlxuICogQGNhdGVnb3J5IGZpbHRlcmluZ1xuICogQHNpbmNlIDIuNi41XG4gKi9cbmV4cG9ydCB2YXIgd2l0aGVyID0gZnVuY3Rpb24gKEYpIHtcbiAgICB2YXIgX3dpdGhlckYgPSBfd2l0aGVyKEYpO1xuICAgIHJldHVybiBmdW5jdGlvbiAoZikgeyByZXR1cm4gZnVuY3Rpb24gKGZhKSB7IHJldHVybiBfd2l0aGVyRihmYSwgZik7IH07IH07XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgZmlsdGVyaW5nXG4gKiBAc2luY2UgMi42LjVcbiAqL1xuZXhwb3J0IHZhciB3aWx0ID0gZnVuY3Rpb24gKEYpIHtcbiAgICB2YXIgX3dpbHRGID0gX3dpbHQoRik7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChmKSB7IHJldHVybiBmdW5jdGlvbiAoZmEpIHsgcmV0dXJuIF93aWx0RihmYSwgZik7IH07IH07XG59O1xuLyoqXG4gKiBAc2luY2UgMi42LjZcbiAqL1xuZXhwb3J0IHZhciB1bmZvbGQgPSBmdW5jdGlvbiAoYiwgZikge1xuICAgIHZhciBvdXQgPSBbXTtcbiAgICB2YXIgYmIgPSBiO1xuICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBuby1jb25zdGFudC1jb25kaXRpb25cbiAgICB3aGlsZSAodHJ1ZSkge1xuICAgICAgICB2YXIgbXQgPSBmKGJiKTtcbiAgICAgICAgaWYgKF8uaXNTb21lKG10KSkge1xuICAgICAgICAgICAgdmFyIF9hID0gbXQudmFsdWUsIGEgPSBfYVswXSwgYl8xID0gX2FbMV07XG4gICAgICAgICAgICBvdXQucHVzaChhKTtcbiAgICAgICAgICAgIGJiID0gYl8xO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIG91dDtcbn07XG4vKipcbiAqIEBjYXRlZ29yeSB0eXBlIGxhbWJkYXNcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIFVSSSA9ICdSZWFkb25seUFycmF5Jztcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgZ2V0U2hvdyA9IGZ1bmN0aW9uIChTKSB7IHJldHVybiAoe1xuICAgIHNob3c6IGZ1bmN0aW9uIChhcykgeyByZXR1cm4gXCJbXCIuY29uY2F0KGFzLm1hcChTLnNob3cpLmpvaW4oJywgJyksIFwiXVwiKTsgfVxufSk7IH07XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIGdldFNlbWlncm91cCA9IGZ1bmN0aW9uICgpIHsgcmV0dXJuICh7XG4gICAgY29uY2F0OiBmdW5jdGlvbiAoZmlyc3QsIHNlY29uZCkgeyByZXR1cm4gKGlzRW1wdHkoZmlyc3QpID8gc2Vjb25kIDogaXNFbXB0eShzZWNvbmQpID8gZmlyc3QgOiBmaXJzdC5jb25jYXQoc2Vjb25kKSk7IH1cbn0pOyB9O1xuLyoqXG4gKiBSZXR1cm5zIGEgYE1vbm9pZGAgZm9yIGBSZWFkb25seUFycmF5PEE+YC5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgZ2V0TW9ub2lkIH0gZnJvbSAnZnAtdHMvUmVhZG9ubHlBcnJheSdcbiAqXG4gKiBjb25zdCBNID0gZ2V0TW9ub2lkPG51bWJlcj4oKVxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChNLmNvbmNhdChbMSwgMl0sIFszLCA0XSksIFsxLCAyLCAzLCA0XSlcbiAqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBnZXRNb25vaWQgPSBmdW5jdGlvbiAoKSB7IHJldHVybiAoe1xuICAgIGNvbmNhdDogZ2V0U2VtaWdyb3VwKCkuY29uY2F0LFxuICAgIGVtcHR5OiBlbXB0eVxufSk7IH07XG4vKipcbiAqIERlcml2ZXMgYW4gYEVxYCBvdmVyIHRoZSBgUmVhZG9ubHlBcnJheWAgb2YgYSBnaXZlbiBlbGVtZW50IHR5cGUgZnJvbSB0aGUgYEVxYCBvZiB0aGF0IHR5cGUuIFRoZSBkZXJpdmVkIGBFcWAgZGVmaW5lcyB0d29cbiAqIGFycmF5cyBhcyBlcXVhbCBpZiBhbGwgZWxlbWVudHMgb2YgYm90aCBhcnJheXMgYXJlIGNvbXBhcmVkIGVxdWFsIHBhaXJ3aXNlIHdpdGggdGhlIGdpdmVuIGBFYC4gSW4gY2FzZSBvZiBhcnJheXMgb2ZcbiAqIGRpZmZlcmVudCBsZW5ndGhzLCB0aGUgcmVzdWx0IGlzIG5vbiBlcXVhbGl0eS5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0ICogYXMgUyBmcm9tICdmcC10cy9zdHJpbmcnXG4gKiBpbXBvcnQgeyBnZXRFcSB9IGZyb20gJ2ZwLXRzL1JlYWRvbmx5QXJyYXknXG4gKlxuICogY29uc3QgRSA9IGdldEVxKFMuRXEpXG4gKiBhc3NlcnQuc3RyaWN0RXF1YWwoRS5lcXVhbHMoWydhJywgJ2InXSwgWydhJywgJ2InXSksIHRydWUpXG4gKiBhc3NlcnQuc3RyaWN0RXF1YWwoRS5lcXVhbHMoWydhJ10sIFtdKSwgZmFsc2UpXG4gKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgZ2V0RXEgPSBmdW5jdGlvbiAoRSkge1xuICAgIHJldHVybiBmcm9tRXF1YWxzKGZ1bmN0aW9uICh4cywgeXMpIHsgcmV0dXJuIHhzLmxlbmd0aCA9PT0geXMubGVuZ3RoICYmIHhzLmV2ZXJ5KGZ1bmN0aW9uICh4LCBpKSB7IHJldHVybiBFLmVxdWFscyh4LCB5c1tpXSk7IH0pOyB9KTtcbn07XG4vKipcbiAqIERlcml2ZXMgYW4gYE9yZGAgb3ZlciB0aGUgYFJlYWRvbmx5QXJyYXlgIG9mIGEgZ2l2ZW4gZWxlbWVudCB0eXBlIGZyb20gdGhlIGBPcmRgIG9mIHRoYXQgdHlwZS4gVGhlIG9yZGVyaW5nIGJldHdlZW4gdHdvIHN1Y2hcbiAqIGFycmF5cyBpcyBlcXVhbCB0bzogdGhlIGZpcnN0IG5vbiBlcXVhbCBjb21wYXJpc29uIG9mIGVhY2ggYXJyYXlzIGVsZW1lbnRzIHRha2VuIHBhaXJ3aXNlIGluIGluY3JlYXNpbmcgb3JkZXIsIGluXG4gKiBjYXNlIG9mIGVxdWFsaXR5IG92ZXIgYWxsIHRoZSBwYWlyd2lzZSBlbGVtZW50czsgdGhlIGxvbmdlc3QgYXJyYXkgaXMgY29uc2lkZXJlZCB0aGUgZ3JlYXRlc3QsIGlmIGJvdGggYXJyYXlzIGhhdmVcbiAqIHRoZSBzYW1lIGxlbmd0aCwgdGhlIHJlc3VsdCBpcyBlcXVhbGl0eS5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgZ2V0T3JkIH0gZnJvbSAnZnAtdHMvUmVhZG9ubHlBcnJheSdcbiAqIGltcG9ydCAqIGFzIFMgZnJvbSAnZnAtdHMvc3RyaW5nJ1xuICpcbiAqIGNvbnN0IE8gPSBnZXRPcmQoUy5PcmQpXG4gKiBhc3NlcnQuc3RyaWN0RXF1YWwoTy5jb21wYXJlKFsnYiddLCBbJ2EnXSksIDEpXG4gKiBhc3NlcnQuc3RyaWN0RXF1YWwoTy5jb21wYXJlKFsnYSddLCBbJ2EnXSksIDApXG4gKiBhc3NlcnQuc3RyaWN0RXF1YWwoTy5jb21wYXJlKFsnYSddLCBbJ2InXSksIC0xKVxuICpcbiAqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBnZXRPcmQgPSBmdW5jdGlvbiAoTykge1xuICAgIHJldHVybiBmcm9tQ29tcGFyZShmdW5jdGlvbiAoYSwgYikge1xuICAgICAgICB2YXIgYUxlbiA9IGEubGVuZ3RoO1xuICAgICAgICB2YXIgYkxlbiA9IGIubGVuZ3RoO1xuICAgICAgICB2YXIgbGVuID0gTWF0aC5taW4oYUxlbiwgYkxlbik7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbGVuOyBpKyspIHtcbiAgICAgICAgICAgIHZhciBvcmRlcmluZyA9IE8uY29tcGFyZShhW2ldLCBiW2ldKTtcbiAgICAgICAgICAgIGlmIChvcmRlcmluZyAhPT0gMCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBvcmRlcmluZztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gTi5PcmQuY29tcGFyZShhTGVuLCBiTGVuKTtcbiAgICB9KTtcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjExLjBcbiAqL1xuZXhwb3J0IHZhciBnZXRVbmlvblNlbWlncm91cCA9IGZ1bmN0aW9uIChFKSB7XG4gICAgdmFyIHVuaW9uRSA9IHVuaW9uKEUpO1xuICAgIHJldHVybiB7XG4gICAgICAgIGNvbmNhdDogZnVuY3Rpb24gKGZpcnN0LCBzZWNvbmQpIHsgcmV0dXJuIHVuaW9uRShzZWNvbmQpKGZpcnN0KTsgfVxuICAgIH07XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi4xMS4wXG4gKi9cbmV4cG9ydCB2YXIgZ2V0VW5pb25Nb25vaWQgPSBmdW5jdGlvbiAoRSkgeyByZXR1cm4gKHtcbiAgICBjb25jYXQ6IGdldFVuaW9uU2VtaWdyb3VwKEUpLmNvbmNhdCxcbiAgICBlbXB0eTogZW1wdHlcbn0pOyB9O1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi4xMS4wXG4gKi9cbmV4cG9ydCB2YXIgZ2V0SW50ZXJzZWN0aW9uU2VtaWdyb3VwID0gZnVuY3Rpb24gKEUpIHtcbiAgICB2YXIgaW50ZXJzZWN0aW9uRSA9IGludGVyc2VjdGlvbihFKTtcbiAgICByZXR1cm4ge1xuICAgICAgICBjb25jYXQ6IGZ1bmN0aW9uIChmaXJzdCwgc2Vjb25kKSB7IHJldHVybiBpbnRlcnNlY3Rpb25FKHNlY29uZCkoZmlyc3QpOyB9XG4gICAgfTtcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjExLjBcbiAqL1xuZXhwb3J0IHZhciBnZXREaWZmZXJlbmNlTWFnbWEgPSBmdW5jdGlvbiAoRSkge1xuICAgIHZhciBkaWZmZXJlbmNlRSA9IGRpZmZlcmVuY2UoRSk7XG4gICAgcmV0dXJuIHtcbiAgICAgICAgY29uY2F0OiBmdW5jdGlvbiAoZmlyc3QsIHNlY29uZCkgeyByZXR1cm4gZGlmZmVyZW5jZUUoc2Vjb25kKShmaXJzdCk7IH1cbiAgICB9O1xufTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuNy4wXG4gKi9cbmV4cG9ydCB2YXIgRnVuY3RvciA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICBtYXA6IF9tYXBcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBtYXBwaW5nXG4gKiBAc2luY2UgMi4xMC4wXG4gKi9cbmV4cG9ydCB2YXIgZmxhcCA9IC8qI19fUFVSRV9fKi8gZmxhcF8oRnVuY3Rvcik7XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjEwLjBcbiAqL1xuZXhwb3J0IHZhciBQb2ludGVkID0ge1xuICAgIFVSSTogVVJJLFxuICAgIG9mOiBvZlxufTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuNy4wXG4gKi9cbmV4cG9ydCB2YXIgRnVuY3RvcldpdGhJbmRleCA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICBtYXA6IF9tYXAsXG4gICAgbWFwV2l0aEluZGV4OiBfbWFwV2l0aEluZGV4XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi4xMC4wXG4gKi9cbmV4cG9ydCB2YXIgQXBwbHkgPSB7XG4gICAgVVJJOiBVUkksXG4gICAgbWFwOiBfbWFwLFxuICAgIGFwOiBfYXBcbn07XG4vKipcbiAqIENvbWJpbmUgdHdvIGVmZmVjdGZ1bCBhY3Rpb25zLCBrZWVwaW5nIG9ubHkgdGhlIHJlc3VsdCBvZiB0aGUgZmlyc3QuXG4gKlxuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgYXBGaXJzdCA9IC8qI19fUFVSRV9fKi8gYXBGaXJzdF8oQXBwbHkpO1xuLyoqXG4gKiBDb21iaW5lIHR3byBlZmZlY3RmdWwgYWN0aW9ucywga2VlcGluZyBvbmx5IHRoZSByZXN1bHQgb2YgdGhlIHNlY29uZC5cbiAqXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBhcFNlY29uZCA9IC8qI19fUFVSRV9fKi8gYXBTZWNvbmRfKEFwcGx5KTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuNy4wXG4gKi9cbmV4cG9ydCB2YXIgQXBwbGljYXRpdmUgPSB7XG4gICAgVVJJOiBVUkksXG4gICAgbWFwOiBfbWFwLFxuICAgIGFwOiBfYXAsXG4gICAgb2Y6IG9mXG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi4xMC4wXG4gKi9cbmV4cG9ydCB2YXIgQ2hhaW4gPSB7XG4gICAgVVJJOiBVUkksXG4gICAgbWFwOiBfbWFwLFxuICAgIGFwOiBfYXAsXG4gICAgY2hhaW46IGZsYXRNYXBcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjcuMFxuICovXG5leHBvcnQgdmFyIE1vbmFkID0ge1xuICAgIFVSSTogVVJJLFxuICAgIG1hcDogX21hcCxcbiAgICBhcDogX2FwLFxuICAgIG9mOiBvZixcbiAgICBjaGFpbjogZmxhdE1hcFxufTtcbi8qKlxuICogQ29tcG9zZXMgY29tcHV0YXRpb25zIGluIHNlcXVlbmNlLCB1c2luZyB0aGUgcmV0dXJuIHZhbHVlIG9mIG9uZSBjb21wdXRhdGlvbiB0byBkZXRlcm1pbmUgdGhlIG5leHQgY29tcHV0YXRpb24gYW5kXG4gKiBrZWVwaW5nIG9ubHkgdGhlIHJlc3VsdCBvZiB0aGUgZmlyc3QuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCAqIGFzIFJBIGZyb20gJ2ZwLXRzL1JlYWRvbmx5QXJyYXknXG4gKiBpbXBvcnQgeyBwaXBlIH0gZnJvbSAnZnAtdHMvZnVuY3Rpb24nXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChcbiAqICAgcGlwZShcbiAqICAgICBbMSwgMiwgM10sXG4gKiAgICAgUkEuY2hhaW5GaXJzdCgoKSA9PiBbJ2EnLCAnYiddKVxuICogICApLFxuICogICBbMSwgMSwgMiwgMiwgMywgM11cbiAqIClcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoXG4gKiAgIHBpcGUoXG4gKiAgICAgWzEsIDIsIDNdLFxuICogICAgIFJBLmNoYWluRmlyc3QoKCkgPT4gW10pXG4gKiAgICksXG4gKiAgIFtdXG4gKiApXG4gKlxuICogQGNhdGVnb3J5IHNlcXVlbmNpbmdcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIGNoYWluRmlyc3QgPSBcbi8qI19fUFVSRV9fKi8gY2hhaW5GaXJzdF8oQ2hhaW4pO1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi43LjBcbiAqL1xuZXhwb3J0IHZhciBVbmZvbGRhYmxlID0ge1xuICAgIFVSSTogVVJJLFxuICAgIHVuZm9sZDogdW5mb2xkXG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi43LjBcbiAqL1xuZXhwb3J0IHZhciBBbHQgPSB7XG4gICAgVVJJOiBVUkksXG4gICAgbWFwOiBfbWFwLFxuICAgIGFsdDogX2FsdFxufTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIFplcm8gPSB7XG4gICAgVVJJOiBVUkksXG4gICAgemVybzogemVyb1xufTtcbi8qKlxuICogQGNhdGVnb3J5IGRvIG5vdGF0aW9uXG4gKiBAc2luY2UgMi4xMS4wXG4gKi9cbmV4cG9ydCB2YXIgZ3VhcmQgPSAvKiNfX1BVUkVfXyovIGd1YXJkXyhaZXJvLCBQb2ludGVkKTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuNy4wXG4gKi9cbmV4cG9ydCB2YXIgQWx0ZXJuYXRpdmUgPSB7XG4gICAgVVJJOiBVUkksXG4gICAgbWFwOiBfbWFwLFxuICAgIGFwOiBfYXAsXG4gICAgb2Y6IG9mLFxuICAgIGFsdDogX2FsdCxcbiAgICB6ZXJvOiB6ZXJvXG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi43LjBcbiAqL1xuZXhwb3J0IHZhciBFeHRlbmQgPSB7XG4gICAgVVJJOiBVUkksXG4gICAgbWFwOiBfbWFwLFxuICAgIGV4dGVuZDogX2V4dGVuZFxufTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuNy4wXG4gKi9cbmV4cG9ydCB2YXIgQ29tcGFjdGFibGUgPSB7XG4gICAgVVJJOiBVUkksXG4gICAgY29tcGFjdDogY29tcGFjdCxcbiAgICBzZXBhcmF0ZTogc2VwYXJhdGVcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjcuMFxuICovXG5leHBvcnQgdmFyIEZpbHRlcmFibGUgPSB7XG4gICAgVVJJOiBVUkksXG4gICAgbWFwOiBfbWFwLFxuICAgIGNvbXBhY3Q6IGNvbXBhY3QsXG4gICAgc2VwYXJhdGU6IHNlcGFyYXRlLFxuICAgIGZpbHRlcjogX2ZpbHRlcixcbiAgICBmaWx0ZXJNYXA6IF9maWx0ZXJNYXAsXG4gICAgcGFydGl0aW9uOiBfcGFydGl0aW9uLFxuICAgIHBhcnRpdGlvbk1hcDogX3BhcnRpdGlvbk1hcFxufTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuNy4wXG4gKi9cbmV4cG9ydCB2YXIgRmlsdGVyYWJsZVdpdGhJbmRleCA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICBtYXA6IF9tYXAsXG4gICAgbWFwV2l0aEluZGV4OiBfbWFwV2l0aEluZGV4LFxuICAgIGNvbXBhY3Q6IGNvbXBhY3QsXG4gICAgc2VwYXJhdGU6IHNlcGFyYXRlLFxuICAgIGZpbHRlcjogX2ZpbHRlcixcbiAgICBmaWx0ZXJNYXA6IF9maWx0ZXJNYXAsXG4gICAgcGFydGl0aW9uOiBfcGFydGl0aW9uLFxuICAgIHBhcnRpdGlvbk1hcDogX3BhcnRpdGlvbk1hcCxcbiAgICBwYXJ0aXRpb25NYXBXaXRoSW5kZXg6IF9wYXJ0aXRpb25NYXBXaXRoSW5kZXgsXG4gICAgcGFydGl0aW9uV2l0aEluZGV4OiBfcGFydGl0aW9uV2l0aEluZGV4LFxuICAgIGZpbHRlck1hcFdpdGhJbmRleDogX2ZpbHRlck1hcFdpdGhJbmRleCxcbiAgICBmaWx0ZXJXaXRoSW5kZXg6IF9maWx0ZXJXaXRoSW5kZXhcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjcuMFxuICovXG5leHBvcnQgdmFyIEZvbGRhYmxlID0ge1xuICAgIFVSSTogVVJJLFxuICAgIHJlZHVjZTogX3JlZHVjZSxcbiAgICBmb2xkTWFwOiBfZm9sZE1hcCxcbiAgICByZWR1Y2VSaWdodDogX3JlZHVjZVJpZ2h0XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi43LjBcbiAqL1xuZXhwb3J0IHZhciBGb2xkYWJsZVdpdGhJbmRleCA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICByZWR1Y2U6IF9yZWR1Y2UsXG4gICAgZm9sZE1hcDogX2ZvbGRNYXAsXG4gICAgcmVkdWNlUmlnaHQ6IF9yZWR1Y2VSaWdodCxcbiAgICByZWR1Y2VXaXRoSW5kZXg6IF9yZWR1Y2VXaXRoSW5kZXgsXG4gICAgZm9sZE1hcFdpdGhJbmRleDogX2ZvbGRNYXBXaXRoSW5kZXgsXG4gICAgcmVkdWNlUmlnaHRXaXRoSW5kZXg6IF9yZWR1Y2VSaWdodFdpdGhJbmRleFxufTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuNy4wXG4gKi9cbmV4cG9ydCB2YXIgVHJhdmVyc2FibGUgPSB7XG4gICAgVVJJOiBVUkksXG4gICAgbWFwOiBfbWFwLFxuICAgIHJlZHVjZTogX3JlZHVjZSxcbiAgICBmb2xkTWFwOiBfZm9sZE1hcCxcbiAgICByZWR1Y2VSaWdodDogX3JlZHVjZVJpZ2h0LFxuICAgIHRyYXZlcnNlOiBfdHJhdmVyc2UsXG4gICAgc2VxdWVuY2U6IHNlcXVlbmNlXG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi43LjBcbiAqL1xuZXhwb3J0IHZhciBUcmF2ZXJzYWJsZVdpdGhJbmRleCA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICBtYXA6IF9tYXAsXG4gICAgbWFwV2l0aEluZGV4OiBfbWFwV2l0aEluZGV4LFxuICAgIHJlZHVjZTogX3JlZHVjZSxcbiAgICBmb2xkTWFwOiBfZm9sZE1hcCxcbiAgICByZWR1Y2VSaWdodDogX3JlZHVjZVJpZ2h0LFxuICAgIHJlZHVjZVdpdGhJbmRleDogX3JlZHVjZVdpdGhJbmRleCxcbiAgICBmb2xkTWFwV2l0aEluZGV4OiBfZm9sZE1hcFdpdGhJbmRleCxcbiAgICByZWR1Y2VSaWdodFdpdGhJbmRleDogX3JlZHVjZVJpZ2h0V2l0aEluZGV4LFxuICAgIHRyYXZlcnNlOiBfdHJhdmVyc2UsXG4gICAgc2VxdWVuY2U6IHNlcXVlbmNlLFxuICAgIHRyYXZlcnNlV2l0aEluZGV4OiBfdHJhdmVyc2VXaXRoSW5kZXhcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBzZXF1ZW5jaW5nXG4gKiBAc2luY2UgMi4xMS4wXG4gKi9cbmV4cG9ydCB2YXIgY2hhaW5SZWNEZXB0aEZpcnN0ID0gZnVuY3Rpb24gKGYpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGEpIHtcbiAgICAgICAgdmFyIHRvZG8gPSBfX3NwcmVhZEFycmF5KFtdLCBmKGEpLCB0cnVlKTtcbiAgICAgICAgdmFyIG91dCA9IFtdO1xuICAgICAgICB3aGlsZSAodG9kby5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICB2YXIgZSA9IHRvZG8uc2hpZnQoKTtcbiAgICAgICAgICAgIGlmIChfLmlzTGVmdChlKSkge1xuICAgICAgICAgICAgICAgIHRvZG8udW5zaGlmdC5hcHBseSh0b2RvLCBmKGUubGVmdCkpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgb3V0LnB1c2goZS5yaWdodCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG91dDtcbiAgICB9O1xufTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIENoYWluUmVjRGVwdGhGaXJzdCA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICBtYXA6IF9tYXAsXG4gICAgYXA6IF9hcCxcbiAgICBjaGFpbjogZmxhdE1hcCxcbiAgICBjaGFpblJlYzogX2NoYWluUmVjRGVwdGhGaXJzdFxufTtcbi8qKlxuICogQGNhdGVnb3J5IHNlcXVlbmNpbmdcbiAqIEBzaW5jZSAyLjExLjBcbiAqL1xuZXhwb3J0IHZhciBjaGFpblJlY0JyZWFkdGhGaXJzdCA9IGZ1bmN0aW9uIChmKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhKSB7XG4gICAgICAgIHZhciBpbml0aWFsID0gZihhKTtcbiAgICAgICAgdmFyIHRvZG8gPSBbXTtcbiAgICAgICAgdmFyIG91dCA9IFtdO1xuICAgICAgICBmdW5jdGlvbiBnbyhlKSB7XG4gICAgICAgICAgICBpZiAoXy5pc0xlZnQoZSkpIHtcbiAgICAgICAgICAgICAgICBmKGUubGVmdCkuZm9yRWFjaChmdW5jdGlvbiAodikgeyByZXR1cm4gdG9kby5wdXNoKHYpOyB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIG91dC5wdXNoKGUucmlnaHQpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGZvciAodmFyIF9pID0gMCwgaW5pdGlhbF8xID0gaW5pdGlhbDsgX2kgPCBpbml0aWFsXzEubGVuZ3RoOyBfaSsrKSB7XG4gICAgICAgICAgICB2YXIgZSA9IGluaXRpYWxfMVtfaV07XG4gICAgICAgICAgICBnbyhlKTtcbiAgICAgICAgfVxuICAgICAgICB3aGlsZSAodG9kby5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICBnbyh0b2RvLnNoaWZ0KCkpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBvdXQ7XG4gICAgfTtcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjExLjBcbiAqL1xuZXhwb3J0IHZhciBDaGFpblJlY0JyZWFkdGhGaXJzdCA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICBtYXA6IF9tYXAsXG4gICAgYXA6IF9hcCxcbiAgICBjaGFpbjogZmxhdE1hcCxcbiAgICBjaGFpblJlYzogX2NoYWluUmVjQnJlYWR0aEZpcnN0XG59O1xudmFyIF93aXRoZXIgPSAvKiNfX1BVUkVfXyovIHdpdGhlckRlZmF1bHQoVHJhdmVyc2FibGUsIENvbXBhY3RhYmxlKTtcbnZhciBfd2lsdCA9IC8qI19fUFVSRV9fKi8gd2lsdERlZmF1bHQoVHJhdmVyc2FibGUsIENvbXBhY3RhYmxlKTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuNy4wXG4gKi9cbmV4cG9ydCB2YXIgV2l0aGVyYWJsZSA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICBtYXA6IF9tYXAsXG4gICAgY29tcGFjdDogY29tcGFjdCxcbiAgICBzZXBhcmF0ZTogc2VwYXJhdGUsXG4gICAgZmlsdGVyOiBfZmlsdGVyLFxuICAgIGZpbHRlck1hcDogX2ZpbHRlck1hcCxcbiAgICBwYXJ0aXRpb246IF9wYXJ0aXRpb24sXG4gICAgcGFydGl0aW9uTWFwOiBfcGFydGl0aW9uTWFwLFxuICAgIHJlZHVjZTogX3JlZHVjZSxcbiAgICBmb2xkTWFwOiBfZm9sZE1hcCxcbiAgICByZWR1Y2VSaWdodDogX3JlZHVjZVJpZ2h0LFxuICAgIHRyYXZlcnNlOiBfdHJhdmVyc2UsXG4gICAgc2VxdWVuY2U6IHNlcXVlbmNlLFxuICAgIHdpdGhlcjogX3dpdGhlcixcbiAgICB3aWx0OiBfd2lsdFxufTtcbi8qKlxuICogRmlsdGVyIHZhbHVlcyBpbnNpZGUgYSBjb250ZXh0LlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBwaXBlIH0gZnJvbSAnZnAtdHMvZnVuY3Rpb24nXG4gKiBpbXBvcnQgKiBhcyBSQSBmcm9tICdmcC10cy9SZWFkb25seUFycmF5J1xuICogaW1wb3J0ICogYXMgVCBmcm9tICdmcC10cy9UYXNrJ1xuICpcbiAqIGNvbnN0IGZpbHRlckUgPSBSQS5maWx0ZXJFKFQuQXBwbGljYXRpdmVQYXIpXG4gKiBhc3luYyBmdW5jdGlvbiB0ZXN0KCkge1xuICogICBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKFxuICogICAgIGF3YWl0IHBpcGUoXG4gKiAgICAgICBbLTEsIDIsIDNdLFxuICogICAgICAgZmlsdGVyRSgobikgPT4gVC5vZihuID4gMCkpXG4gKiAgICAgKSgpLFxuICogICAgIFsyLCAzXVxuICogICApXG4gKiB9XG4gKiB0ZXN0KClcbiAqXG4gKiBAc2luY2UgMi4xMS4wXG4gKi9cbmV4cG9ydCB2YXIgZmlsdGVyRSA9IC8qI19fUFVSRV9fKi8gZmlsdGVyRV8oV2l0aGVyYWJsZSk7XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjExLjBcbiAqL1xuZXhwb3J0IHZhciBGcm9tRWl0aGVyID0ge1xuICAgIFVSSTogVVJJLFxuICAgIGZyb21FaXRoZXI6IGZyb21FaXRoZXJcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBsaWZ0aW5nXG4gKiBAc2luY2UgMi4xMS4wXG4gKi9cbmV4cG9ydCB2YXIgZnJvbUVpdGhlcksgPSAvKiNfX1BVUkVfXyovIGZyb21FaXRoZXJLXyhGcm9tRWl0aGVyKTtcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8vIHVuc2FmZVxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLyoqXG4gKiBAY2F0ZWdvcnkgdW5zYWZlXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciB1bnNhZmVJbnNlcnRBdCA9IFJORUEudW5zYWZlSW5zZXJ0QXQ7XG4vKipcbiAqIEBjYXRlZ29yeSB1bnNhZmVcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIHVuc2FmZVVwZGF0ZUF0ID0gZnVuY3Rpb24gKGksIGEsIGFzKSB7XG4gICAgcmV0dXJuIGlzTm9uRW1wdHkoYXMpID8gUk5FQS51bnNhZmVVcGRhdGVBdChpLCBhLCBhcykgOiBhcztcbn07XG4vKipcbiAqIEBjYXRlZ29yeSB1bnNhZmVcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIHVuc2FmZURlbGV0ZUF0ID0gZnVuY3Rpb24gKGksIGFzKSB7XG4gICAgdmFyIHhzID0gYXMuc2xpY2UoKTtcbiAgICB4cy5zcGxpY2UoaSwgMSk7XG4gICAgcmV0dXJuIHhzO1xufTtcbi8qKlxuICogQGNhdGVnb3J5IGNvbnZlcnNpb25zXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciB0b0FycmF5ID0gZnVuY3Rpb24gKGFzKSB7IHJldHVybiBhcy5zbGljZSgpOyB9O1xuLyoqXG4gKiBAY2F0ZWdvcnkgY29udmVyc2lvbnNcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIGZyb21BcnJheSA9IGZ1bmN0aW9uIChhcykgeyByZXR1cm4gKGlzRW1wdHkoYXMpID8gZW1wdHkgOiBhcy5zbGljZSgpKTsgfTtcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8vIHV0aWxzXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vKipcbiAqIEFuIGVtcHR5IGFycmF5XG4gKlxuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgZW1wdHkgPSBSTkVBLmVtcHR5O1xuZXhwb3J0IGZ1bmN0aW9uIGV2ZXJ5KHByZWRpY2F0ZSkge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHsgcmV0dXJuIGFzLmV2ZXJ5KHByZWRpY2F0ZSk7IH07XG59XG4vKipcbiAqIENoZWNrIGlmIGEgcHJlZGljYXRlIGhvbGRzIHRydWUgZm9yIGFueSBhcnJheSBtZW1iZXIuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IHNvbWUgfSBmcm9tICdmcC10cy9SZWFkb25seUFycmF5J1xuICogaW1wb3J0IHsgcGlwZSB9IGZyb20gJ2ZwLXRzL2Z1bmN0aW9uJ1xuICpcbiAqIGNvbnN0IGlzUG9zaXRpdmUgPSAobjogbnVtYmVyKTogYm9vbGVhbiA9PiBuID4gMFxuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwocGlwZShbLTEsIC0yLCAzXSwgc29tZShpc1Bvc2l0aXZlKSksIHRydWUpXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKHBpcGUoWy0xLCAtMiwgLTNdLCBzb21lKGlzUG9zaXRpdmUpKSwgZmFsc2UpXG4gKlxuICogQHNpbmNlIDIuOS4wXG4gKi9cbmV4cG9ydCB2YXIgc29tZSA9IGZ1bmN0aW9uIChwcmVkaWNhdGUpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIHJldHVybiBhcy5zb21lKHByZWRpY2F0ZSk7XG4gICAgfTtcbn07XG4vKipcbiAqIEFsaWFzIG9mIFtgc29tZWBdKCNzb21lKVxuICpcbiAqIEBzaW5jZSAyLjExLjBcbiAqL1xuZXhwb3J0IHZhciBleGlzdHMgPSBzb21lO1xuLyoqXG4gKiBQbGFjZXMgYW4gZWxlbWVudCBpbiBiZXR3ZWVuIG1lbWJlcnMgb2YgYSBgUmVhZG9ubHlBcnJheWAsIHRoZW4gZm9sZHMgdGhlIHJlc3VsdHMgdXNpbmcgdGhlIHByb3ZpZGVkIGBNb25vaWRgLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgKiBhcyBTIGZyb20gJ2ZwLXRzL3N0cmluZydcbiAqIGltcG9ydCB7IGludGVyY2FsYXRlIH0gZnJvbSAnZnAtdHMvUmVhZG9ubHlBcnJheSdcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKGludGVyY2FsYXRlKFMuTW9ub2lkKSgnLScpKFsnYScsICdiJywgJ2MnXSksICdhLWItYycpXG4gKlxuICogQHNpbmNlIDIuMTIuMFxuICovXG5leHBvcnQgdmFyIGludGVyY2FsYXRlID0gZnVuY3Rpb24gKE0pIHtcbiAgICB2YXIgaW50ZXJjYWxhdGVNID0gUk5FQS5pbnRlcmNhbGF0ZShNKTtcbiAgICByZXR1cm4gZnVuY3Rpb24gKG1pZGRsZSkgeyByZXR1cm4gbWF0Y2goZnVuY3Rpb24gKCkgeyByZXR1cm4gTS5lbXB0eTsgfSwgaW50ZXJjYWxhdGVNKG1pZGRsZSkpOyB9O1xufTtcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8vIGRvIG5vdGF0aW9uXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vKipcbiAqIEBjYXRlZ29yeSBkbyBub3RhdGlvblxuICogQHNpbmNlIDIuOS4wXG4gKi9cbmV4cG9ydCB2YXIgRG8gPSAvKiNfX1BVUkVfXyovIG9mKF8uZW1wdHlSZWNvcmQpO1xuLyoqXG4gKiBAY2F0ZWdvcnkgZG8gbm90YXRpb25cbiAqIEBzaW5jZSAyLjguMFxuICovXG5leHBvcnQgdmFyIGJpbmRUbyA9IC8qI19fUFVSRV9fKi8gYmluZFRvXyhGdW5jdG9yKTtcbnZhciBsZXRfID0gLyojX19QVVJFX18qLyBsZXRfXyhGdW5jdG9yKTtcbmV4cG9ydCB7IFxuLyoqXG4gKiBAY2F0ZWdvcnkgZG8gbm90YXRpb25cbiAqIEBzaW5jZSAyLjEzLjBcbiAqL1xubGV0XyBhcyBsZXQgfTtcbi8qKlxuICogQGNhdGVnb3J5IGRvIG5vdGF0aW9uXG4gKiBAc2luY2UgMi44LjBcbiAqL1xuZXhwb3J0IHZhciBiaW5kID0gLyojX19QVVJFX18qLyBiaW5kXyhDaGFpbik7XG4vKipcbiAqIEBjYXRlZ29yeSBkbyBub3RhdGlvblxuICogQHNpbmNlIDIuOC4wXG4gKi9cbmV4cG9ydCB2YXIgYXBTID0gLyojX19QVVJFX18qLyBhcFNfKEFwcGx5KTtcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8vIGxlZ2FjeVxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLyoqXG4gKiBBbGlhcyBvZiBgZmxhdE1hcGAuXG4gKlxuICogQGNhdGVnb3J5IGxlZ2FjeVxuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgY2hhaW4gPSBmbGF0TWFwO1xuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLy8gZGVwcmVjYXRlZFxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLyoqXG4gKiBVc2UgYFJlYWRvbmx5Tm9uRW1wdHlBcnJheWAgbW9kdWxlIGluc3RlYWQuXG4gKlxuICogQGNhdGVnb3J5IHpvbmUgb2YgZGVhdGhcbiAqIEBzaW5jZSAyLjUuMFxuICogQGRlcHJlY2F0ZWRcbiAqL1xuZXhwb3J0IHZhciByYW5nZSA9IFJORUEucmFuZ2U7XG4vKipcbiAqIFVzZSBbYHByZXBlbmRgXSgjcHJlcGVuZCkgaW5zdGVhZC5cbiAqXG4gKiBAY2F0ZWdvcnkgem9uZSBvZiBkZWF0aFxuICogQHNpbmNlIDIuNS4wXG4gKiBAZGVwcmVjYXRlZFxuICovXG5leHBvcnQgdmFyIGNvbnMgPSBSTkVBLmNvbnM7XG4vKipcbiAqIFVzZSBbYGFwcGVuZGBdKCNhcHBlbmQpIGluc3RlYWQuXG4gKlxuICogQGNhdGVnb3J5IHpvbmUgb2YgZGVhdGhcbiAqIEBzaW5jZSAyLjUuMFxuICogQGRlcHJlY2F0ZWRcbiAqL1xuZXhwb3J0IHZhciBzbm9jID0gUk5FQS5zbm9jO1xuLyoqXG4gKiBVc2UgW2BwcmVwZW5kQWxsYF0oI3ByZXBlbmRhbGwpIGluc3RlYWQuXG4gKlxuICogQGNhdGVnb3J5IHpvbmUgb2YgZGVhdGhcbiAqIEBzaW5jZSAyLjkuMFxuICogQGRlcHJlY2F0ZWRcbiAqL1xuZXhwb3J0IHZhciBwcmVwZW5kVG9BbGwgPSBwcmVwZW5kQWxsO1xuLyoqXG4gKiBUaGlzIGluc3RhbmNlIGlzIGRlcHJlY2F0ZWQsIHVzZSBzbWFsbCwgc3BlY2lmaWMgaW5zdGFuY2VzIGluc3RlYWQuXG4gKiBGb3IgZXhhbXBsZSBpZiBhIGZ1bmN0aW9uIG5lZWRzIGEgYEZ1bmN0b3JgIGluc3RhbmNlLCBwYXNzIGBSQS5GdW5jdG9yYCBpbnN0ZWFkIG9mIGBSQS5yZWFkb25seUFycmF5YFxuICogKHdoZXJlIGBSQWAgaXMgZnJvbSBgaW1wb3J0IFJBIGZyb20gJ2ZwLXRzL1JlYWRvbmx5QXJyYXknYClcbiAqXG4gKiBAY2F0ZWdvcnkgem9uZSBvZiBkZWF0aFxuICogQHNpbmNlIDIuNS4wXG4gKiBAZGVwcmVjYXRlZFxuICovXG5leHBvcnQgdmFyIHJlYWRvbmx5QXJyYXkgPSB7XG4gICAgVVJJOiBVUkksXG4gICAgY29tcGFjdDogY29tcGFjdCxcbiAgICBzZXBhcmF0ZTogc2VwYXJhdGUsXG4gICAgbWFwOiBfbWFwLFxuICAgIGFwOiBfYXAsXG4gICAgb2Y6IG9mLFxuICAgIGNoYWluOiBmbGF0TWFwLFxuICAgIGZpbHRlcjogX2ZpbHRlcixcbiAgICBmaWx0ZXJNYXA6IF9maWx0ZXJNYXAsXG4gICAgcGFydGl0aW9uOiBfcGFydGl0aW9uLFxuICAgIHBhcnRpdGlvbk1hcDogX3BhcnRpdGlvbk1hcCxcbiAgICBtYXBXaXRoSW5kZXg6IF9tYXBXaXRoSW5kZXgsXG4gICAgcGFydGl0aW9uTWFwV2l0aEluZGV4OiBfcGFydGl0aW9uTWFwV2l0aEluZGV4LFxuICAgIHBhcnRpdGlvbldpdGhJbmRleDogX3BhcnRpdGlvbldpdGhJbmRleCxcbiAgICBmaWx0ZXJNYXBXaXRoSW5kZXg6IF9maWx0ZXJNYXBXaXRoSW5kZXgsXG4gICAgZmlsdGVyV2l0aEluZGV4OiBfZmlsdGVyV2l0aEluZGV4LFxuICAgIGFsdDogX2FsdCxcbiAgICB6ZXJvOiB6ZXJvLFxuICAgIHVuZm9sZDogdW5mb2xkLFxuICAgIHJlZHVjZTogX3JlZHVjZSxcbiAgICBmb2xkTWFwOiBfZm9sZE1hcCxcbiAgICByZWR1Y2VSaWdodDogX3JlZHVjZVJpZ2h0LFxuICAgIHRyYXZlcnNlOiBfdHJhdmVyc2UsXG4gICAgc2VxdWVuY2U6IHNlcXVlbmNlLFxuICAgIHJlZHVjZVdpdGhJbmRleDogX3JlZHVjZVdpdGhJbmRleCxcbiAgICBmb2xkTWFwV2l0aEluZGV4OiBfZm9sZE1hcFdpdGhJbmRleCxcbiAgICByZWR1Y2VSaWdodFdpdGhJbmRleDogX3JlZHVjZVJpZ2h0V2l0aEluZGV4LFxuICAgIHRyYXZlcnNlV2l0aEluZGV4OiBfdHJhdmVyc2VXaXRoSW5kZXgsXG4gICAgZXh0ZW5kOiBfZXh0ZW5kLFxuICAgIHdpdGhlcjogX3dpdGhlcixcbiAgICB3aWx0OiBfd2lsdFxufTtcbiIsCiAgInZhciBfX3NwcmVhZEFycmF5ID0gKHRoaXMgJiYgdGhpcy5fX3NwcmVhZEFycmF5KSB8fCBmdW5jdGlvbiAodG8sIGZyb20sIHBhY2spIHtcbiAgICBpZiAocGFjayB8fCBhcmd1bWVudHMubGVuZ3RoID09PSAyKSBmb3IgKHZhciBpID0gMCwgbCA9IGZyb20ubGVuZ3RoLCBhcjsgaSA8IGw7IGkrKykge1xuICAgICAgICBpZiAoYXIgfHwgIShpIGluIGZyb20pKSB7XG4gICAgICAgICAgICBpZiAoIWFyKSBhciA9IEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGZyb20sIDAsIGkpO1xuICAgICAgICAgICAgYXJbaV0gPSBmcm9tW2ldO1xuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiB0by5jb25jYXQoYXIgfHwgQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoZnJvbSkpO1xufTtcbmltcG9ydCB7IGFwRmlyc3QgYXMgYXBGaXJzdF8sIGFwUyBhcyBhcFNfLCBhcFNlY29uZCBhcyBhcFNlY29uZF8gfSBmcm9tICcuL0FwcGx5JztcbmltcG9ydCB7IGJpbmQgYXMgYmluZF8sIGNoYWluRmlyc3QgYXMgY2hhaW5GaXJzdF8gfSBmcm9tICcuL0NoYWluJztcbmltcG9ydCB7IGZyb21FcXVhbHMgfSBmcm9tICcuL0VxJztcbmltcG9ydCB7IGZyb21FaXRoZXJLIGFzIGZyb21FaXRoZXJLXyB9IGZyb20gJy4vRnJvbUVpdGhlcic7XG5pbXBvcnQgeyBkdWFsLCBpZGVudGl0eSwgcGlwZSB9IGZyb20gJy4vZnVuY3Rpb24nO1xuaW1wb3J0IHsgYmluZFRvIGFzIGJpbmRUb18sIGZsYXAgYXMgZmxhcF8sIGxldCBhcyBsZXRfXyB9IGZyb20gJy4vRnVuY3Rvcic7XG5pbXBvcnQgKiBhcyBfIGZyb20gJy4vaW50ZXJuYWwnO1xuaW1wb3J0ICogYXMgTiBmcm9tICcuL251bWJlcic7XG5pbXBvcnQgeyBmcm9tQ29tcGFyZSB9IGZyb20gJy4vT3JkJztcbmltcG9ydCAqIGFzIFJORUEgZnJvbSAnLi9SZWFkb25seU5vbkVtcHR5QXJyYXknO1xuaW1wb3J0IHsgc2VwYXJhdGVkIH0gZnJvbSAnLi9TZXBhcmF0ZWQnO1xuaW1wb3J0IHsgZmlsdGVyRSBhcyBmaWx0ZXJFXywgd2lsdERlZmF1bHQsIHdpdGhlckRlZmF1bHQgfSBmcm9tICcuL1dpdGhlcmFibGUnO1xuaW1wb3J0IHsgZ3VhcmQgYXMgZ3VhcmRfIH0gZnJvbSAnLi9aZXJvJztcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8vIHJlZmluZW1lbnRzXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vKipcbiAqIFRlc3Qgd2hldGhlciBhIGBSZWFkb25seUFycmF5YCBpcyBlbXB0eS5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgaXNFbXB0eSB9IGZyb20gJ2ZwLXRzL1JlYWRvbmx5QXJyYXknXG4gKlxuICogYXNzZXJ0LnN0cmljdEVxdWFsKGlzRW1wdHkoW10pLCB0cnVlKVxuICpcbiAqIEBjYXRlZ29yeSByZWZpbmVtZW50c1xuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgaXNFbXB0eSA9IGZ1bmN0aW9uIChhcykgeyByZXR1cm4gYXMubGVuZ3RoID09PSAwOyB9O1xuLyoqXG4gKiBUZXN0IHdoZXRoZXIgYSBgUmVhZG9ubHlBcnJheWAgaXMgbm9uIGVtcHR5LlxuICpcbiAqIEBjYXRlZ29yeSByZWZpbmVtZW50c1xuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgaXNOb25FbXB0eSA9IFJORUEuaXNOb25FbXB0eTtcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8vIGNvbnN0cnVjdG9yc1xuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLyoqXG4gKiBQcmVwZW5kIGFuIGVsZW1lbnQgdG8gdGhlIGZyb250IG9mIGEgYFJlYWRvbmx5QXJyYXlgLCBjcmVhdGluZyBhIG5ldyBgUmVhZG9ubHlOb25FbXB0eUFycmF5YC5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgcHJlcGVuZCB9IGZyb20gJ2ZwLXRzL1JlYWRvbmx5QXJyYXknXG4gKiBpbXBvcnQgeyBwaXBlIH0gZnJvbSAnZnAtdHMvZnVuY3Rpb24nXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChwaXBlKFsyLCAzLCA0XSwgcHJlcGVuZCgxKSksIFsxLCAyLCAzLCA0XSlcbiAqXG4gKiBAc2luY2UgMi4xMC4wXG4gKi9cbmV4cG9ydCB2YXIgcHJlcGVuZCA9IFJORUEucHJlcGVuZDtcbi8qKlxuICogTGVzcyBzdHJpY3QgdmVyc2lvbiBvZiBbYHByZXBlbmRgXSgjcHJlcGVuZCkuXG4gKlxuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIHByZXBlbmRXID0gUk5FQS5wcmVwZW5kVztcbi8qKlxuICogQXBwZW5kIGFuIGVsZW1lbnQgdG8gdGhlIGVuZCBvZiBhIGBSZWFkb25seUFycmF5YCwgY3JlYXRpbmcgYSBuZXcgYFJlYWRvbmx5Tm9uRW1wdHlBcnJheWAuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IGFwcGVuZCB9IGZyb20gJ2ZwLXRzL1JlYWRvbmx5QXJyYXknXG4gKiBpbXBvcnQgeyBwaXBlIH0gZnJvbSAnZnAtdHMvZnVuY3Rpb24nXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChwaXBlKFsxLCAyLCAzXSwgYXBwZW5kKDQpKSwgWzEsIDIsIDMsIDRdKVxuICpcbiAqIEBzaW5jZSAyLjEwLjBcbiAqL1xuZXhwb3J0IHZhciBhcHBlbmQgPSBSTkVBLmFwcGVuZDtcbi8qKlxuICogTGVzcyBzdHJpY3QgdmVyc2lvbiBvZiBbYGFwcGVuZGBdKCNhcHBlbmQpLlxuICpcbiAqIEBzaW5jZSAyLjExLjBcbiAqL1xuZXhwb3J0IHZhciBhcHBlbmRXID0gUk5FQS5hcHBlbmRXO1xuLyoqXG4gKiBSZXR1cm4gYSBgUmVhZG9ubHlBcnJheWAgb2YgbGVuZ3RoIGBuYCB3aXRoIGVsZW1lbnQgYGlgIGluaXRpYWxpemVkIHdpdGggYGYoaSlgLlxuICpcbiAqICoqTm90ZSoqLiBgbmAgaXMgbm9ybWFsaXplZCB0byBhIG5vbiBuZWdhdGl2ZSBpbnRlZ2VyLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBtYWtlQnkgfSBmcm9tICdmcC10cy9SZWFkb25seUFycmF5J1xuICpcbiAqIGNvbnN0IGRvdWJsZSA9IChuOiBudW1iZXIpOiBudW1iZXIgPT4gbiAqIDJcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwobWFrZUJ5KDUsIGRvdWJsZSksIFswLCAyLCA0LCA2LCA4XSlcbiAqXG4gKiBAY2F0ZWdvcnkgY29uc3RydWN0b3JzXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBtYWtlQnkgPSBmdW5jdGlvbiAobiwgZikgeyByZXR1cm4gKG4gPD0gMCA/IGVtcHR5IDogUk5FQS5tYWtlQnkoZikobikpOyB9O1xuLyoqXG4gKiBDcmVhdGUgYSBgUmVhZG9ubHlBcnJheWAgY29udGFpbmluZyBhIHZhbHVlIHJlcGVhdGVkIHRoZSBzcGVjaWZpZWQgbnVtYmVyIG9mIHRpbWVzLlxuICpcbiAqICoqTm90ZSoqLiBgbmAgaXMgbm9ybWFsaXplZCB0byBhIG5vbiBuZWdhdGl2ZSBpbnRlZ2VyLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyByZXBsaWNhdGUgfSBmcm9tICdmcC10cy9SZWFkb25seUFycmF5J1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwocmVwbGljYXRlKDMsICdhJyksIFsnYScsICdhJywgJ2EnXSlcbiAqXG4gKiBAY2F0ZWdvcnkgY29uc3RydWN0b3JzXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciByZXBsaWNhdGUgPSBmdW5jdGlvbiAobiwgYSkgeyByZXR1cm4gbWFrZUJ5KG4sIGZ1bmN0aW9uICgpIHsgcmV0dXJuIGE7IH0pOyB9O1xuZXhwb3J0IGZ1bmN0aW9uIGZyb21QcmVkaWNhdGUocHJlZGljYXRlKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhKSB7IHJldHVybiAocHJlZGljYXRlKGEpID8gW2FdIDogZW1wdHkpOyB9O1xufVxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLy8gY29udmVyc2lvbnNcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8qKlxuICogQGNhdGVnb3J5IGNvbnZlcnNpb25zXG4gKiBAc2luY2UgMi4xMS4wXG4gKi9cbmV4cG9ydCB2YXIgZnJvbU9wdGlvbiA9IGZ1bmN0aW9uIChtYSkgeyByZXR1cm4gKF8uaXNOb25lKG1hKSA/IGVtcHR5IDogW21hLnZhbHVlXSk7IH07XG4vKipcbiAqIFRyYW5zZm9ybXMgYW4gYEVpdGhlcmAgdG8gYSBgUmVhZG9ubHlBcnJheWAuXG4gKlxuICogQGNhdGVnb3J5IGNvbnZlcnNpb25zXG4gKiBAc2luY2UgMi4xMS4wXG4gKi9cbmV4cG9ydCB2YXIgZnJvbUVpdGhlciA9IGZ1bmN0aW9uIChlKSB7IHJldHVybiAoXy5pc0xlZnQoZSkgPyBlbXB0eSA6IFtlLnJpZ2h0XSk7IH07XG4vKipcbiAqIExlc3Mgc3RyaWN0IHZlcnNpb24gb2YgW2BtYXRjaGBdKCNtYXRjaCkuXG4gKlxuICogVGhlIGBXYCBzdWZmaXggKHNob3J0IGZvciAqKlcqKmlkZW5pbmcpIG1lYW5zIHRoYXQgdGhlIGhhbmRsZXIgcmV0dXJuIHR5cGVzIHdpbGwgYmUgbWVyZ2VkLlxuICpcbiAqIEBjYXRlZ29yeSBwYXR0ZXJuIG1hdGNoaW5nXG4gKiBAc2luY2UgMi4xMS4wXG4gKi9cbmV4cG9ydCB2YXIgbWF0Y2hXID0gZnVuY3Rpb24gKG9uRW1wdHksIG9uTm9uRW1wdHkpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIHJldHVybiBpc05vbkVtcHR5KGFzKSA/IG9uTm9uRW1wdHkoYXMpIDogb25FbXB0eSgpO1xuICAgIH07XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgcGF0dGVybiBtYXRjaGluZ1xuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIG1hdGNoID0gbWF0Y2hXO1xuLyoqXG4gKiBMZXNzIHN0cmljdCB2ZXJzaW9uIG9mIFtgbWF0Y2hMZWZ0YF0oI21hdGNobGVmdCkuXG4gKlxuICogQGNhdGVnb3J5IHBhdHRlcm4gbWF0Y2hpbmdcbiAqIEBzaW5jZSAyLjExLjBcbiAqL1xuZXhwb3J0IHZhciBtYXRjaExlZnRXID0gZnVuY3Rpb24gKG9uRW1wdHksIG9uTm9uRW1wdHkpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIHJldHVybiBpc05vbkVtcHR5KGFzKSA/IG9uTm9uRW1wdHkoUk5FQS5oZWFkKGFzKSwgUk5FQS50YWlsKGFzKSkgOiBvbkVtcHR5KCk7XG4gICAgfTtcbn07XG4vKipcbiAqIEJyZWFrIGEgYFJlYWRvbmx5QXJyYXlgIGludG8gaXRzIGZpcnN0IGVsZW1lbnQgYW5kIHJlbWFpbmluZyBlbGVtZW50cy5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgbWF0Y2hMZWZ0IH0gZnJvbSAnZnAtdHMvUmVhZG9ubHlBcnJheSdcbiAqXG4gKiBjb25zdCBsZW46IDxBPihhczogUmVhZG9ubHlBcnJheTxBPikgPT4gbnVtYmVyID0gbWF0Y2hMZWZ0KCgpID0+IDAsIChfLCB0YWlsKSA9PiAxICsgbGVuKHRhaWwpKVxuICogYXNzZXJ0LnN0cmljdEVxdWFsKGxlbihbMSwgMiwgM10pLCAzKVxuICpcbiAqIEBjYXRlZ29yeSBwYXR0ZXJuIG1hdGNoaW5nXG4gKiBAc2luY2UgMi4xMC4wXG4gKi9cbmV4cG9ydCB2YXIgbWF0Y2hMZWZ0ID0gbWF0Y2hMZWZ0Vztcbi8qKlxuICogQWxpYXMgb2YgW2BtYXRjaExlZnRgXSgjbWF0Y2hsZWZ0KS5cbiAqXG4gKiBAY2F0ZWdvcnkgcGF0dGVybiBtYXRjaGluZ1xuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgZm9sZExlZnQgPSBtYXRjaExlZnQ7XG4vKipcbiAqIExlc3Mgc3RyaWN0IHZlcnNpb24gb2YgW2BtYXRjaFJpZ2h0YF0oI21hdGNocmlnaHQpLlxuICpcbiAqIEBjYXRlZ29yeSBwYXR0ZXJuIG1hdGNoaW5nXG4gKiBAc2luY2UgMi4xMS4wXG4gKi9cbmV4cG9ydCB2YXIgbWF0Y2hSaWdodFcgPSBmdW5jdGlvbiAob25FbXB0eSwgb25Ob25FbXB0eSkge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgcmV0dXJuIGlzTm9uRW1wdHkoYXMpID8gb25Ob25FbXB0eShSTkVBLmluaXQoYXMpLCBSTkVBLmxhc3QoYXMpKSA6IG9uRW1wdHkoKTtcbiAgICB9O1xufTtcbi8qKlxuICogQnJlYWsgYSBgUmVhZG9ubHlBcnJheWAgaW50byBpdHMgaW5pdGlhbCBlbGVtZW50cyBhbmQgdGhlIGxhc3QgZWxlbWVudC5cbiAqXG4gKiBAY2F0ZWdvcnkgcGF0dGVybiBtYXRjaGluZ1xuICogQHNpbmNlIDIuMTAuMFxuICovXG5leHBvcnQgdmFyIG1hdGNoUmlnaHQgPSBtYXRjaFJpZ2h0Vztcbi8qKlxuICogQWxpYXMgb2YgW2BtYXRjaFJpZ2h0YF0oI21hdGNocmlnaHQpLlxuICpcbiAqIEBjYXRlZ29yeSBwYXR0ZXJuIG1hdGNoaW5nXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBmb2xkUmlnaHQgPSBtYXRjaFJpZ2h0O1xuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLy8gY29tYmluYXRvcnNcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8qKlxuICogQGNhdGVnb3J5IHNlcXVlbmNpbmdcbiAqIEBzaW5jZSAyLjcuMFxuICovXG5leHBvcnQgdmFyIGNoYWluV2l0aEluZGV4ID0gZnVuY3Rpb24gKGYpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIGlmIChpc0VtcHR5KGFzKSkge1xuICAgICAgICAgICAgcmV0dXJuIGVtcHR5O1xuICAgICAgICB9XG4gICAgICAgIHZhciBvdXQgPSBbXTtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBhcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgb3V0LnB1c2guYXBwbHkob3V0LCBmKGksIGFzW2ldKSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG91dDtcbiAgICB9O1xufTtcbi8qKlxuICogU2FtZSBhcyBgcmVkdWNlYCBidXQgaXQgY2FycmllcyBvdmVyIHRoZSBpbnRlcm1lZGlhdGUgc3RlcHMuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IHNjYW5MZWZ0IH0gZnJvbSAnZnAtdHMvUmVhZG9ubHlBcnJheSdcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKHNjYW5MZWZ0KDEwLCAoYiwgYTogbnVtYmVyKSA9PiBiIC0gYSkoWzEsIDIsIDNdKSwgWzEwLCA5LCA3LCA0XSlcbiAqXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBzY2FuTGVmdCA9IGZ1bmN0aW9uIChiLCBmKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykge1xuICAgICAgICB2YXIgbGVuID0gYXMubGVuZ3RoO1xuICAgICAgICB2YXIgb3V0ID0gbmV3IEFycmF5KGxlbiArIDEpO1xuICAgICAgICBvdXRbMF0gPSBiO1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGxlbjsgaSsrKSB7XG4gICAgICAgICAgICBvdXRbaSArIDFdID0gZihvdXRbaV0sIGFzW2ldKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gb3V0O1xuICAgIH07XG59O1xuLyoqXG4gKiBGb2xkIGFuIGFycmF5IGZyb20gdGhlIHJpZ2h0LCBrZWVwaW5nIGFsbCBpbnRlcm1lZGlhdGUgcmVzdWx0cyBpbnN0ZWFkIG9mIG9ubHkgdGhlIGZpbmFsIHJlc3VsdFxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBzY2FuUmlnaHQgfSBmcm9tICdmcC10cy9SZWFkb25seUFycmF5J1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoc2NhblJpZ2h0KDEwLCAoYTogbnVtYmVyLCBiKSA9PiBiIC0gYSkoWzEsIDIsIDNdKSwgWzQsIDUsIDcsIDEwXSlcbiAqXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBzY2FuUmlnaHQgPSBmdW5jdGlvbiAoYiwgZikge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgdmFyIGxlbiA9IGFzLmxlbmd0aDtcbiAgICAgICAgdmFyIG91dCA9IG5ldyBBcnJheShsZW4gKyAxKTtcbiAgICAgICAgb3V0W2xlbl0gPSBiO1xuICAgICAgICBmb3IgKHZhciBpID0gbGVuIC0gMTsgaSA+PSAwOyBpLS0pIHtcbiAgICAgICAgICAgIG91dFtpXSA9IGYoYXNbaV0sIG91dFtpICsgMV0pO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBvdXQ7XG4gICAgfTtcbn07XG4vKipcbiAqIENhbGN1bGF0ZSB0aGUgbnVtYmVyIG9mIGVsZW1lbnRzIGluIGEgYFJlYWRvbmx5QXJyYXlgLlxuICpcbiAqIEBzaW5jZSAyLjEwLjBcbiAqL1xuZXhwb3J0IHZhciBzaXplID0gZnVuY3Rpb24gKGFzKSB7IHJldHVybiBhcy5sZW5ndGg7IH07XG4vKipcbiAqIFRlc3Qgd2hldGhlciBhbiBhcnJheSBjb250YWlucyBhIHBhcnRpY3VsYXIgaW5kZXhcbiAqXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBpc091dE9mQm91bmQgPSBSTkVBLmlzT3V0T2ZCb3VuZDtcbmV4cG9ydCBmdW5jdGlvbiBsb29rdXAoaSwgYXMpIHtcbiAgICByZXR1cm4gYXMgPT09IHVuZGVmaW5lZCA/IGZ1bmN0aW9uIChhcykgeyByZXR1cm4gbG9va3VwKGksIGFzKTsgfSA6IGlzT3V0T2ZCb3VuZChpLCBhcykgPyBfLm5vbmUgOiBfLnNvbWUoYXNbaV0pO1xufVxuLyoqXG4gKiBHZXQgdGhlIGZpcnN0IGVsZW1lbnQgaW4gYW4gYXJyYXksIG9yIGBOb25lYCBpZiB0aGUgYXJyYXkgaXMgZW1wdHlcbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgaGVhZCB9IGZyb20gJ2ZwLXRzL1JlYWRvbmx5QXJyYXknXG4gKiBpbXBvcnQgeyBzb21lLCBub25lIH0gZnJvbSAnZnAtdHMvT3B0aW9uJ1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoaGVhZChbMSwgMiwgM10pLCBzb21lKDEpKVxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChoZWFkKFtdKSwgbm9uZSlcbiAqXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBoZWFkID0gZnVuY3Rpb24gKGFzKSB7IHJldHVybiAoaXNOb25FbXB0eShhcykgPyBfLnNvbWUoUk5FQS5oZWFkKGFzKSkgOiBfLm5vbmUpOyB9O1xuLyoqXG4gKiBHZXQgdGhlIGxhc3QgZWxlbWVudCBpbiBhbiBhcnJheSwgb3IgYE5vbmVgIGlmIHRoZSBhcnJheSBpcyBlbXB0eVxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBsYXN0IH0gZnJvbSAnZnAtdHMvUmVhZG9ubHlBcnJheSdcbiAqIGltcG9ydCB7IHNvbWUsIG5vbmUgfSBmcm9tICdmcC10cy9PcHRpb24nXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChsYXN0KFsxLCAyLCAzXSksIHNvbWUoMykpXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKGxhc3QoW10pLCBub25lKVxuICpcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIGxhc3QgPSBmdW5jdGlvbiAoYXMpIHsgcmV0dXJuIChpc05vbkVtcHR5KGFzKSA/IF8uc29tZShSTkVBLmxhc3QoYXMpKSA6IF8ubm9uZSk7IH07XG4vKipcbiAqIEdldCBhbGwgYnV0IHRoZSBmaXJzdCBlbGVtZW50IG9mIGFuIGFycmF5LCBjcmVhdGluZyBhIG5ldyBhcnJheSwgb3IgYE5vbmVgIGlmIHRoZSBhcnJheSBpcyBlbXB0eVxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyB0YWlsIH0gZnJvbSAnZnAtdHMvUmVhZG9ubHlBcnJheSdcbiAqIGltcG9ydCB7IHNvbWUsIG5vbmUgfSBmcm9tICdmcC10cy9PcHRpb24nXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbCh0YWlsKFsxLCAyLCAzXSksIHNvbWUoWzIsIDNdKSlcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwodGFpbChbXSksIG5vbmUpXG4gKlxuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgdGFpbCA9IGZ1bmN0aW9uIChhcykge1xuICAgIHJldHVybiBpc05vbkVtcHR5KGFzKSA/IF8uc29tZShSTkVBLnRhaWwoYXMpKSA6IF8ubm9uZTtcbn07XG4vKipcbiAqIEdldCBhbGwgYnV0IHRoZSBsYXN0IGVsZW1lbnQgb2YgYW4gYXJyYXksIGNyZWF0aW5nIGEgbmV3IGFycmF5LCBvciBgTm9uZWAgaWYgdGhlIGFycmF5IGlzIGVtcHR5XG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IGluaXQgfSBmcm9tICdmcC10cy9SZWFkb25seUFycmF5J1xuICogaW1wb3J0IHsgc29tZSwgbm9uZSB9IGZyb20gJ2ZwLXRzL09wdGlvbidcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKGluaXQoWzEsIDIsIDNdKSwgc29tZShbMSwgMl0pKVxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChpbml0KFtdKSwgbm9uZSlcbiAqXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBpbml0ID0gZnVuY3Rpb24gKGFzKSB7XG4gICAgcmV0dXJuIGlzTm9uRW1wdHkoYXMpID8gXy5zb21lKFJORUEuaW5pdChhcykpIDogXy5ub25lO1xufTtcbi8qKlxuICogS2VlcCBvbmx5IGEgbWF4IG51bWJlciBvZiBlbGVtZW50cyBmcm9tIHRoZSBzdGFydCBvZiBhbiBgUmVhZG9ubHlBcnJheWAsIGNyZWF0aW5nIGEgbmV3IGBSZWFkb25seUFycmF5YC5cbiAqXG4gKiAqKk5vdGUqKi4gYG5gIGlzIG5vcm1hbGl6ZWQgdG8gYSBub24gbmVnYXRpdmUgaW50ZWdlci5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0ICogYXMgUkEgZnJvbSAnZnAtdHMvUmVhZG9ubHlBcnJheSdcbiAqIGltcG9ydCB7IHBpcGUgfSBmcm9tICdmcC10cy9mdW5jdGlvbidcbiAqXG4gKiBjb25zdCBpbnB1dDogUmVhZG9ubHlBcnJheTxudW1iZXI+ID0gWzEsIDIsIDNdXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKHBpcGUoaW5wdXQsIFJBLnRha2VMZWZ0KDIpKSwgWzEsIDJdKVxuICpcbiAqIC8vIG91dCBvZiBib3VuZHNcbiAqIGFzc2VydC5zdHJpY3RFcXVhbChwaXBlKGlucHV0LCBSQS50YWtlTGVmdCg0KSksIGlucHV0KVxuICogYXNzZXJ0LnN0cmljdEVxdWFsKHBpcGUoaW5wdXQsIFJBLnRha2VMZWZ0KC0xKSksIGlucHV0KVxuICpcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIHRha2VMZWZ0ID0gZnVuY3Rpb24gKG4pIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIHJldHVybiBpc091dE9mQm91bmQobiwgYXMpID8gYXMgOiBuID09PSAwID8gZW1wdHkgOiBhcy5zbGljZSgwLCBuKTtcbiAgICB9O1xufTtcbi8qKlxuICogS2VlcCBvbmx5IGEgbWF4IG51bWJlciBvZiBlbGVtZW50cyBmcm9tIHRoZSBlbmQgb2YgYW4gYFJlYWRvbmx5QXJyYXlgLCBjcmVhdGluZyBhIG5ldyBgUmVhZG9ubHlBcnJheWAuXG4gKlxuICogKipOb3RlKiouIGBuYCBpcyBub3JtYWxpemVkIHRvIGEgbm9uIG5lZ2F0aXZlIGludGVnZXIuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCAqIGFzIFJBIGZyb20gJ2ZwLXRzL1JlYWRvbmx5QXJyYXknXG4gKiBpbXBvcnQgeyBwaXBlIH0gZnJvbSAnZnAtdHMvZnVuY3Rpb24nXG4gKlxuICogY29uc3QgaW5wdXQ6IFJlYWRvbmx5QXJyYXk8bnVtYmVyPiA9IFsxLCAyLCAzXVxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChwaXBlKGlucHV0LCBSQS50YWtlUmlnaHQoMikpLCBbMiwgM10pXG4gKlxuICogLy8gb3V0IG9mIGJvdW5kc1xuICogYXNzZXJ0LnN0cmljdEVxdWFsKHBpcGUoaW5wdXQsIFJBLnRha2VSaWdodCg0KSksIGlucHV0KVxuICogYXNzZXJ0LnN0cmljdEVxdWFsKHBpcGUoaW5wdXQsIFJBLnRha2VSaWdodCgtMSkpLCBpbnB1dClcbiAqXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciB0YWtlUmlnaHQgPSBmdW5jdGlvbiAobikge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgcmV0dXJuIGlzT3V0T2ZCb3VuZChuLCBhcykgPyBhcyA6IG4gPT09IDAgPyBlbXB0eSA6IGFzLnNsaWNlKC1uKTtcbiAgICB9O1xufTtcbmV4cG9ydCBmdW5jdGlvbiB0YWtlTGVmdFdoaWxlKHByZWRpY2F0ZSkge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgdmFyIG91dCA9IFtdO1xuICAgICAgICBmb3IgKHZhciBfaSA9IDAsIGFzXzEgPSBhczsgX2kgPCBhc18xLmxlbmd0aDsgX2krKykge1xuICAgICAgICAgICAgdmFyIGEgPSBhc18xW19pXTtcbiAgICAgICAgICAgIGlmICghcHJlZGljYXRlKGEpKSB7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBvdXQucHVzaChhKTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgbGVuID0gb3V0Lmxlbmd0aDtcbiAgICAgICAgcmV0dXJuIGxlbiA9PT0gYXMubGVuZ3RoID8gYXMgOiBsZW4gPT09IDAgPyBlbXB0eSA6IG91dDtcbiAgICB9O1xufVxudmFyIHNwYW5MZWZ0SW5kZXggPSBmdW5jdGlvbiAoYXMsIHByZWRpY2F0ZSkge1xuICAgIHZhciBsID0gYXMubGVuZ3RoO1xuICAgIHZhciBpID0gMDtcbiAgICBmb3IgKDsgaSA8IGw7IGkrKykge1xuICAgICAgICBpZiAoIXByZWRpY2F0ZShhc1tpXSkpIHtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiBpO1xufTtcbmV4cG9ydCBmdW5jdGlvbiBzcGFuTGVmdChwcmVkaWNhdGUpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIHZhciBfYSA9IHNwbGl0QXQoc3BhbkxlZnRJbmRleChhcywgcHJlZGljYXRlKSkoYXMpLCBpbml0ID0gX2FbMF0sIHJlc3QgPSBfYVsxXTtcbiAgICAgICAgcmV0dXJuIHsgaW5pdDogaW5pdCwgcmVzdDogcmVzdCB9O1xuICAgIH07XG59XG4vKipcbiAqIERyb3AgYSBtYXggbnVtYmVyIG9mIGVsZW1lbnRzIGZyb20gdGhlIHN0YXJ0IG9mIGFuIGBSZWFkb25seUFycmF5YCwgY3JlYXRpbmcgYSBuZXcgYFJlYWRvbmx5QXJyYXlgLlxuICpcbiAqICoqTm90ZSoqLiBgbmAgaXMgbm9ybWFsaXplZCB0byBhIG5vbiBuZWdhdGl2ZSBpbnRlZ2VyLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgKiBhcyBSQSBmcm9tICdmcC10cy9SZWFkb25seUFycmF5J1xuICogaW1wb3J0IHsgcGlwZSB9IGZyb20gJ2ZwLXRzL2Z1bmN0aW9uJ1xuICpcbiAqIGNvbnN0IGlucHV0OiBSZWFkb25seUFycmF5PG51bWJlcj4gPSBbMSwgMiwgM11cbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwocGlwZShpbnB1dCwgUkEuZHJvcExlZnQoMikpLCBbM10pXG4gKiBhc3NlcnQuc3RyaWN0RXF1YWwocGlwZShpbnB1dCwgUkEuZHJvcExlZnQoMCkpLCBpbnB1dClcbiAqIGFzc2VydC5zdHJpY3RFcXVhbChwaXBlKGlucHV0LCBSQS5kcm9wTGVmdCgtMSkpLCBpbnB1dClcbiAqXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBkcm9wTGVmdCA9IGZ1bmN0aW9uIChuKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykge1xuICAgICAgICByZXR1cm4gbiA8PSAwIHx8IGlzRW1wdHkoYXMpID8gYXMgOiBuID49IGFzLmxlbmd0aCA/IGVtcHR5IDogYXMuc2xpY2UobiwgYXMubGVuZ3RoKTtcbiAgICB9O1xufTtcbi8qKlxuICogRHJvcCBhIG1heCBudW1iZXIgb2YgZWxlbWVudHMgZnJvbSB0aGUgZW5kIG9mIGFuIGBSZWFkb25seUFycmF5YCwgY3JlYXRpbmcgYSBuZXcgYFJlYWRvbmx5QXJyYXlgLlxuICpcbiAqICoqTm90ZSoqLiBgbmAgaXMgbm9ybWFsaXplZCB0byBhIG5vbiBuZWdhdGl2ZSBpbnRlZ2VyLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgKiBhcyBSQSBmcm9tICdmcC10cy9SZWFkb25seUFycmF5J1xuICogaW1wb3J0IHsgcGlwZSB9IGZyb20gJ2ZwLXRzL2Z1bmN0aW9uJ1xuICpcbiAqIGNvbnN0IGlucHV0OiBSZWFkb25seUFycmF5PG51bWJlcj4gPSBbMSwgMiwgM11cbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwocGlwZShpbnB1dCwgUkEuZHJvcFJpZ2h0KDIpKSwgWzFdKVxuICogYXNzZXJ0LnN0cmljdEVxdWFsKHBpcGUoaW5wdXQsIFJBLmRyb3BSaWdodCgwKSksIGlucHV0KVxuICogYXNzZXJ0LnN0cmljdEVxdWFsKHBpcGUoaW5wdXQsIFJBLmRyb3BSaWdodCgtMSkpLCBpbnB1dClcbiAqXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBkcm9wUmlnaHQgPSBmdW5jdGlvbiAobikge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgcmV0dXJuIG4gPD0gMCB8fCBpc0VtcHR5KGFzKSA/IGFzIDogbiA+PSBhcy5sZW5ndGggPyBlbXB0eSA6IGFzLnNsaWNlKDAsIGFzLmxlbmd0aCAtIG4pO1xuICAgIH07XG59O1xuZXhwb3J0IGZ1bmN0aW9uIGRyb3BMZWZ0V2hpbGUocHJlZGljYXRlKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykge1xuICAgICAgICB2YXIgaSA9IHNwYW5MZWZ0SW5kZXgoYXMsIHByZWRpY2F0ZSk7XG4gICAgICAgIHJldHVybiBpID09PSAwID8gYXMgOiBpID09PSBhcy5sZW5ndGggPyBlbXB0eSA6IGFzLnNsaWNlKGkpO1xuICAgIH07XG59XG4vKipcbiAqIEZpbmQgdGhlIGZpcnN0IGluZGV4IGZvciB3aGljaCBhIHByZWRpY2F0ZSBob2xkc1xuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBmaW5kSW5kZXggfSBmcm9tICdmcC10cy9SZWFkb25seUFycmF5J1xuICogaW1wb3J0IHsgc29tZSwgbm9uZSB9IGZyb20gJ2ZwLXRzL09wdGlvbidcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKGZpbmRJbmRleCgobjogbnVtYmVyKSA9PiBuID09PSAyKShbMSwgMiwgM10pLCBzb21lKDEpKVxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChmaW5kSW5kZXgoKG46IG51bWJlcikgPT4gbiA9PT0gMikoW10pLCBub25lKVxuICpcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIGZpbmRJbmRleCA9IGZ1bmN0aW9uIChwcmVkaWNhdGUpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgYXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIGlmIChwcmVkaWNhdGUoYXNbaV0pKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIF8uc29tZShpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gXy5ub25lO1xuICAgIH07XG59O1xuZXhwb3J0IGZ1bmN0aW9uIGZpbmRGaXJzdChwcmVkaWNhdGUpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgYXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIGlmIChwcmVkaWNhdGUoYXNbaV0pKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIF8uc29tZShhc1tpXSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIF8ubm9uZTtcbiAgICB9O1xufVxuLyoqXG4gKiBGaW5kIHRoZSBmaXJzdCBlbGVtZW50IHJldHVybmVkIGJ5IGFuIG9wdGlvbiBiYXNlZCBzZWxlY3RvciBmdW5jdGlvblxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBmaW5kRmlyc3RNYXAgfSBmcm9tICdmcC10cy9SZWFkb25seUFycmF5J1xuICogaW1wb3J0IHsgc29tZSwgbm9uZSB9IGZyb20gJ2ZwLXRzL09wdGlvbidcbiAqXG4gKiBpbnRlcmZhY2UgUGVyc29uIHtcbiAqICAgcmVhZG9ubHkgbmFtZTogc3RyaW5nXG4gKiAgIHJlYWRvbmx5IGFnZT86IG51bWJlclxuICogfVxuICpcbiAqIGNvbnN0IHBlcnNvbnM6IFJlYWRvbmx5QXJyYXk8UGVyc29uPiA9IFt7IG5hbWU6ICdKb2huJyB9LCB7IG5hbWU6ICdNYXJ5JywgYWdlOiA0NSB9LCB7IG5hbWU6ICdKb2V5JywgYWdlOiAyOCB9XVxuICpcbiAqIC8vIHJldHVybnMgdGhlIG5hbWUgb2YgdGhlIGZpcnN0IHBlcnNvbiB0aGF0IGhhcyBhbiBhZ2VcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoZmluZEZpcnN0TWFwKChwOiBQZXJzb24pID0+IChwLmFnZSA9PT0gdW5kZWZpbmVkID8gbm9uZSA6IHNvbWUocC5uYW1lKSkpKHBlcnNvbnMpLCBzb21lKCdNYXJ5JykpXG4gKlxuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgZmluZEZpcnN0TWFwID0gZnVuY3Rpb24gKGYpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgYXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIHZhciBvdXQgPSBmKGFzW2ldKTtcbiAgICAgICAgICAgIGlmIChfLmlzU29tZShvdXQpKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG91dDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gXy5ub25lO1xuICAgIH07XG59O1xuZXhwb3J0IGZ1bmN0aW9uIGZpbmRMYXN0KHByZWRpY2F0ZSkge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgZm9yICh2YXIgaSA9IGFzLmxlbmd0aCAtIDE7IGkgPj0gMDsgaS0tKSB7XG4gICAgICAgICAgICBpZiAocHJlZGljYXRlKGFzW2ldKSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBfLnNvbWUoYXNbaV0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBfLm5vbmU7XG4gICAgfTtcbn1cbi8qKlxuICogRmluZCB0aGUgbGFzdCBlbGVtZW50IHJldHVybmVkIGJ5IGFuIG9wdGlvbiBiYXNlZCBzZWxlY3RvciBmdW5jdGlvblxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBmaW5kTGFzdE1hcCB9IGZyb20gJ2ZwLXRzL1JlYWRvbmx5QXJyYXknXG4gKiBpbXBvcnQgeyBzb21lLCBub25lIH0gZnJvbSAnZnAtdHMvT3B0aW9uJ1xuICpcbiAqIGludGVyZmFjZSBQZXJzb24ge1xuICogICByZWFkb25seSBuYW1lOiBzdHJpbmdcbiAqICAgcmVhZG9ubHkgYWdlPzogbnVtYmVyXG4gKiB9XG4gKlxuICogY29uc3QgcGVyc29uczogUmVhZG9ubHlBcnJheTxQZXJzb24+ID0gW3sgbmFtZTogJ0pvaG4nIH0sIHsgbmFtZTogJ01hcnknLCBhZ2U6IDQ1IH0sIHsgbmFtZTogJ0pvZXknLCBhZ2U6IDI4IH1dXG4gKlxuICogLy8gcmV0dXJucyB0aGUgbmFtZSBvZiB0aGUgbGFzdCBwZXJzb24gdGhhdCBoYXMgYW4gYWdlXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKGZpbmRMYXN0TWFwKChwOiBQZXJzb24pID0+IChwLmFnZSA9PT0gdW5kZWZpbmVkID8gbm9uZSA6IHNvbWUocC5uYW1lKSkpKHBlcnNvbnMpLCBzb21lKCdKb2V5JykpXG4gKlxuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgZmluZExhc3RNYXAgPSBmdW5jdGlvbiAoZikge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgZm9yICh2YXIgaSA9IGFzLmxlbmd0aCAtIDE7IGkgPj0gMDsgaS0tKSB7XG4gICAgICAgICAgICB2YXIgb3V0ID0gZihhc1tpXSk7XG4gICAgICAgICAgICBpZiAoXy5pc1NvbWUob3V0KSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBvdXQ7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIF8ubm9uZTtcbiAgICB9O1xufTtcbi8qKlxuICogUmV0dXJucyB0aGUgaW5kZXggb2YgdGhlIGxhc3QgZWxlbWVudCBvZiB0aGUgbGlzdCB3aGljaCBtYXRjaGVzIHRoZSBwcmVkaWNhdGVcbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgZmluZExhc3RJbmRleCB9IGZyb20gJ2ZwLXRzL1JlYWRvbmx5QXJyYXknXG4gKiBpbXBvcnQgeyBzb21lLCBub25lIH0gZnJvbSAnZnAtdHMvT3B0aW9uJ1xuICpcbiAqIGludGVyZmFjZSBYIHtcbiAqICAgcmVhZG9ubHkgYTogbnVtYmVyXG4gKiAgIHJlYWRvbmx5IGI6IG51bWJlclxuICogfVxuICogY29uc3QgeHM6IFJlYWRvbmx5QXJyYXk8WD4gPSBbeyBhOiAxLCBiOiAwIH0sIHsgYTogMSwgYjogMSB9XVxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChmaW5kTGFzdEluZGV4KCh4OiB7IHJlYWRvbmx5IGE6IG51bWJlciB9KSA9PiB4LmEgPT09IDEpKHhzKSwgc29tZSgxKSlcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoZmluZExhc3RJbmRleCgoeDogeyByZWFkb25seSBhOiBudW1iZXIgfSkgPT4geC5hID09PSA0KSh4cyksIG5vbmUpXG4gKlxuICpcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIGZpbmRMYXN0SW5kZXggPSBmdW5jdGlvbiAocHJlZGljYXRlKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykge1xuICAgICAgICBmb3IgKHZhciBpID0gYXMubGVuZ3RoIC0gMTsgaSA+PSAwOyBpLS0pIHtcbiAgICAgICAgICAgIGlmIChwcmVkaWNhdGUoYXNbaV0pKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIF8uc29tZShpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gXy5ub25lO1xuICAgIH07XG59O1xuLyoqXG4gKiBJbnNlcnQgYW4gZWxlbWVudCBhdCB0aGUgc3BlY2lmaWVkIGluZGV4LCBjcmVhdGluZyBhIG5ldyBhcnJheSwgb3IgcmV0dXJuaW5nIGBOb25lYCBpZiB0aGUgaW5kZXggaXMgb3V0IG9mIGJvdW5kc1xuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBpbnNlcnRBdCB9IGZyb20gJ2ZwLXRzL1JlYWRvbmx5QXJyYXknXG4gKiBpbXBvcnQgeyBzb21lIH0gZnJvbSAnZnAtdHMvT3B0aW9uJ1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoaW5zZXJ0QXQoMiwgNSkoWzEsIDIsIDMsIDRdKSwgc29tZShbMSwgMiwgNSwgMywgNF0pKVxuICpcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIGluc2VydEF0ID0gZnVuY3Rpb24gKGksIGEpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIHJldHVybiBpIDwgMCB8fCBpID4gYXMubGVuZ3RoID8gXy5ub25lIDogXy5zb21lKFJORUEudW5zYWZlSW5zZXJ0QXQoaSwgYSwgYXMpKTtcbiAgICB9O1xufTtcbi8qKlxuICogQ2hhbmdlIHRoZSBlbGVtZW50IGF0IHRoZSBzcGVjaWZpZWQgaW5kZXgsIGNyZWF0aW5nIGEgbmV3IGFycmF5LCBvciByZXR1cm5pbmcgYE5vbmVgIGlmIHRoZSBpbmRleCBpcyBvdXQgb2YgYm91bmRzXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IHVwZGF0ZUF0IH0gZnJvbSAnZnAtdHMvUmVhZG9ubHlBcnJheSdcbiAqIGltcG9ydCB7IHNvbWUsIG5vbmUgfSBmcm9tICdmcC10cy9PcHRpb24nXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbCh1cGRhdGVBdCgxLCAxKShbMSwgMiwgM10pLCBzb21lKFsxLCAxLCAzXSkpXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKHVwZGF0ZUF0KDEsIDEpKFtdKSwgbm9uZSlcbiAqXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciB1cGRhdGVBdCA9IGZ1bmN0aW9uIChpLCBhKSB7XG4gICAgcmV0dXJuIG1vZGlmeUF0KGksIGZ1bmN0aW9uICgpIHsgcmV0dXJuIGE7IH0pO1xufTtcbi8qKlxuICogRGVsZXRlIHRoZSBlbGVtZW50IGF0IHRoZSBzcGVjaWZpZWQgaW5kZXgsIGNyZWF0aW5nIGEgbmV3IGFycmF5LCBvciByZXR1cm5pbmcgYE5vbmVgIGlmIHRoZSBpbmRleCBpcyBvdXQgb2YgYm91bmRzXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IGRlbGV0ZUF0IH0gZnJvbSAnZnAtdHMvUmVhZG9ubHlBcnJheSdcbiAqIGltcG9ydCB7IHNvbWUsIG5vbmUgfSBmcm9tICdmcC10cy9PcHRpb24nXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChkZWxldGVBdCgwKShbMSwgMiwgM10pLCBzb21lKFsyLCAzXSkpXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKGRlbGV0ZUF0KDEpKFtdKSwgbm9uZSlcbiAqXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBkZWxldGVBdCA9IGZ1bmN0aW9uIChpKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykge1xuICAgICAgICByZXR1cm4gaXNPdXRPZkJvdW5kKGksIGFzKSA/IF8ubm9uZSA6IF8uc29tZSh1bnNhZmVEZWxldGVBdChpLCBhcykpO1xuICAgIH07XG59O1xuLyoqXG4gKiBBcHBseSBhIGZ1bmN0aW9uIHRvIHRoZSBlbGVtZW50IGF0IHRoZSBzcGVjaWZpZWQgaW5kZXgsIGNyZWF0aW5nIGEgbmV3IGFycmF5LCBvciByZXR1cm5pbmcgYE5vbmVgIGlmIHRoZSBpbmRleCBpcyBvdXRcbiAqIG9mIGJvdW5kc1xuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBtb2RpZnlBdCB9IGZyb20gJ2ZwLXRzL1JlYWRvbmx5QXJyYXknXG4gKiBpbXBvcnQgeyBzb21lLCBub25lIH0gZnJvbSAnZnAtdHMvT3B0aW9uJ1xuICpcbiAqIGNvbnN0IGRvdWJsZSA9ICh4OiBudW1iZXIpOiBudW1iZXIgPT4geCAqIDJcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwobW9kaWZ5QXQoMSwgZG91YmxlKShbMSwgMiwgM10pLCBzb21lKFsxLCA0LCAzXSkpXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKG1vZGlmeUF0KDEsIGRvdWJsZSkoW10pLCBub25lKVxuICpcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIG1vZGlmeUF0ID0gZnVuY3Rpb24gKGksIGYpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIHJldHVybiBpc091dE9mQm91bmQoaSwgYXMpID8gXy5ub25lIDogXy5zb21lKHVuc2FmZVVwZGF0ZUF0KGksIGYoYXNbaV0pLCBhcykpO1xuICAgIH07XG59O1xuLyoqXG4gKiBSZXZlcnNlIGFuIGFycmF5LCBjcmVhdGluZyBhIG5ldyBhcnJheVxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyByZXZlcnNlIH0gZnJvbSAnZnAtdHMvUmVhZG9ubHlBcnJheSdcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKHJldmVyc2UoWzEsIDIsIDNdKSwgWzMsIDIsIDFdKVxuICpcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIHJldmVyc2UgPSBmdW5jdGlvbiAoYXMpIHsgcmV0dXJuIChhcy5sZW5ndGggPD0gMSA/IGFzIDogYXMuc2xpY2UoKS5yZXZlcnNlKCkpOyB9O1xuLyoqXG4gKiBFeHRyYWN0cyBmcm9tIGFuIGFycmF5IG9mIGBFaXRoZXJgIGFsbCB0aGUgYFJpZ2h0YCBlbGVtZW50cy4gQWxsIHRoZSBgUmlnaHRgIGVsZW1lbnRzIGFyZSBleHRyYWN0ZWQgaW4gb3JkZXJcbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgcmlnaHRzIH0gZnJvbSAnZnAtdHMvUmVhZG9ubHlBcnJheSdcbiAqIGltcG9ydCB7IHJpZ2h0LCBsZWZ0IH0gZnJvbSAnZnAtdHMvRWl0aGVyJ1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwocmlnaHRzKFtyaWdodCgxKSwgbGVmdCgnZm9vJyksIHJpZ2h0KDIpXSksIFsxLCAyXSlcbiAqXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciByaWdodHMgPSBmdW5jdGlvbiAoYXMpIHtcbiAgICB2YXIgciA9IFtdO1xuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgYXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgdmFyIGEgPSBhc1tpXTtcbiAgICAgICAgaWYgKGEuX3RhZyA9PT0gJ1JpZ2h0Jykge1xuICAgICAgICAgICAgci5wdXNoKGEucmlnaHQpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiByO1xufTtcbi8qKlxuICogRXh0cmFjdHMgZnJvbSBhbiBhcnJheSBvZiBgRWl0aGVyYCBhbGwgdGhlIGBMZWZ0YCBlbGVtZW50cy4gQWxsIHRoZSBgTGVmdGAgZWxlbWVudHMgYXJlIGV4dHJhY3RlZCBpbiBvcmRlclxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBsZWZ0cyB9IGZyb20gJ2ZwLXRzL1JlYWRvbmx5QXJyYXknXG4gKiBpbXBvcnQgeyBsZWZ0LCByaWdodCB9IGZyb20gJ2ZwLXRzL0VpdGhlcidcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKGxlZnRzKFtyaWdodCgxKSwgbGVmdCgnZm9vJyksIHJpZ2h0KDIpXSksIFsnZm9vJ10pXG4gKlxuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgbGVmdHMgPSBmdW5jdGlvbiAoYXMpIHtcbiAgICB2YXIgciA9IFtdO1xuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgYXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgdmFyIGEgPSBhc1tpXTtcbiAgICAgICAgaWYgKGEuX3RhZyA9PT0gJ0xlZnQnKSB7XG4gICAgICAgICAgICByLnB1c2goYS5sZWZ0KTtcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gcjtcbn07XG4vKipcbiAqIFNvcnQgdGhlIGVsZW1lbnRzIG9mIGFuIGFycmF5IGluIGluY3JlYXNpbmcgb3JkZXIsIGNyZWF0aW5nIGEgbmV3IGFycmF5XG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IHNvcnQgfSBmcm9tICdmcC10cy9SZWFkb25seUFycmF5J1xuICogaW1wb3J0ICogYXMgTiBmcm9tICdmcC10cy9udW1iZXInXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChzb3J0KE4uT3JkKShbMywgMiwgMV0pLCBbMSwgMiwgM10pXG4gKlxuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgc29ydCA9IGZ1bmN0aW9uIChPKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykge1xuICAgICAgICByZXR1cm4gYXMubGVuZ3RoIDw9IDEgPyBhcyA6IGFzLnNsaWNlKCkuc29ydChPLmNvbXBhcmUpO1xuICAgIH07XG59O1xuLy8gVE9ETzogY3VycnkgYW5kIG1ha2UgZGF0YS1sYXN0IGluIHYzXG4vKipcbiAqIEFwcGx5IGEgZnVuY3Rpb24gdG8gcGFpcnMgb2YgZWxlbWVudHMgYXQgdGhlIHNhbWUgaW5kZXggaW4gdHdvIGFycmF5cywgY29sbGVjdGluZyB0aGUgcmVzdWx0cyBpbiBhIG5ldyBhcnJheS4gSWYgb25lXG4gKiBpbnB1dCBhcnJheSBpcyBzaG9ydCwgZXhjZXNzIGVsZW1lbnRzIG9mIHRoZSBsb25nZXIgYXJyYXkgYXJlIGRpc2NhcmRlZC5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgemlwV2l0aCB9IGZyb20gJ2ZwLXRzL1JlYWRvbmx5QXJyYXknXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbCh6aXBXaXRoKFsxLCAyLCAzXSwgWydhJywgJ2InLCAnYycsICdkJ10sIChuLCBzKSA9PiBzICsgbiksIFsnYTEnLCAnYjInLCAnYzMnXSlcbiAqXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciB6aXBXaXRoID0gZnVuY3Rpb24gKGZhLCBmYiwgZikge1xuICAgIHZhciBmYyA9IFtdO1xuICAgIHZhciBsZW4gPSBNYXRoLm1pbihmYS5sZW5ndGgsIGZiLmxlbmd0aCk7XG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBsZW47IGkrKykge1xuICAgICAgICBmY1tpXSA9IGYoZmFbaV0sIGZiW2ldKTtcbiAgICB9XG4gICAgcmV0dXJuIGZjO1xufTtcbmV4cG9ydCBmdW5jdGlvbiB6aXAoYXMsIGJzKSB7XG4gICAgaWYgKGJzID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIChicykgeyByZXR1cm4gemlwKGJzLCBhcyk7IH07XG4gICAgfVxuICAgIHJldHVybiB6aXBXaXRoKGFzLCBicywgZnVuY3Rpb24gKGEsIGIpIHsgcmV0dXJuIFthLCBiXTsgfSk7XG59XG4vKipcbiAqIFRoZSBmdW5jdGlvbiBpcyByZXZlcnNlIG9mIGB6aXBgLiBUYWtlcyBhbiBhcnJheSBvZiBwYWlycyBhbmQgcmV0dXJuIHR3byBjb3JyZXNwb25kaW5nIGFycmF5c1xuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyB1bnppcCB9IGZyb20gJ2ZwLXRzL1JlYWRvbmx5QXJyYXknXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbCh1bnppcChbWzEsICdhJ10sIFsyLCAnYiddLCBbMywgJ2MnXV0pLCBbWzEsIDIsIDNdLCBbJ2EnLCAnYicsICdjJ11dKVxuICpcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIHVuemlwID0gZnVuY3Rpb24gKGFzKSB7XG4gICAgdmFyIGZhID0gW107XG4gICAgdmFyIGZiID0gW107XG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBhcy5sZW5ndGg7IGkrKykge1xuICAgICAgICBmYVtpXSA9IGFzW2ldWzBdO1xuICAgICAgICBmYltpXSA9IGFzW2ldWzFdO1xuICAgIH1cbiAgICByZXR1cm4gW2ZhLCBmYl07XG59O1xuLyoqXG4gKiBQcmVwZW5kIGFuIGVsZW1lbnQgdG8gZXZlcnkgbWVtYmVyIG9mIGFuIGFycmF5XG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IHByZXBlbmRBbGwgfSBmcm9tICdmcC10cy9SZWFkb25seUFycmF5J1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwocHJlcGVuZEFsbCg5KShbMSwgMiwgMywgNF0pLCBbOSwgMSwgOSwgMiwgOSwgMywgOSwgNF0pXG4gKlxuICogQHNpbmNlIDIuMTAuMFxuICovXG5leHBvcnQgdmFyIHByZXBlbmRBbGwgPSBmdW5jdGlvbiAobWlkZGxlKSB7XG4gICAgdmFyIGYgPSBSTkVBLnByZXBlbmRBbGwobWlkZGxlKTtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7IHJldHVybiAoaXNOb25FbXB0eShhcykgPyBmKGFzKSA6IGFzKTsgfTtcbn07XG4vKipcbiAqIFBsYWNlcyBhbiBlbGVtZW50IGluIGJldHdlZW4gbWVtYmVycyBvZiBhbiBhcnJheVxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBpbnRlcnNwZXJzZSB9IGZyb20gJ2ZwLXRzL1JlYWRvbmx5QXJyYXknXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChpbnRlcnNwZXJzZSg5KShbMSwgMiwgMywgNF0pLCBbMSwgOSwgMiwgOSwgMywgOSwgNF0pXG4gKlxuICogQHNpbmNlIDIuOS4wXG4gKi9cbmV4cG9ydCB2YXIgaW50ZXJzcGVyc2UgPSBmdW5jdGlvbiAobWlkZGxlKSB7XG4gICAgdmFyIGYgPSBSTkVBLmludGVyc3BlcnNlKG1pZGRsZSk7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykgeyByZXR1cm4gKGlzTm9uRW1wdHkoYXMpID8gZihhcykgOiBhcyk7IH07XG59O1xuLyoqXG4gKiBSb3RhdGUgYSBgUmVhZG9ubHlBcnJheWAgYnkgYG5gIHN0ZXBzLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyByb3RhdGUgfSBmcm9tICdmcC10cy9SZWFkb25seUFycmF5J1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwocm90YXRlKDIpKFsxLCAyLCAzLCA0LCA1XSksIFs0LCA1LCAxLCAyLCAzXSlcbiAqXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciByb3RhdGUgPSBmdW5jdGlvbiAobikge1xuICAgIHZhciBmID0gUk5FQS5yb3RhdGUobik7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykgeyByZXR1cm4gKGlzTm9uRW1wdHkoYXMpID8gZihhcykgOiBhcyk7IH07XG59O1xuZXhwb3J0IGZ1bmN0aW9uIGVsZW0oRSkge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYSwgYXMpIHtcbiAgICAgICAgaWYgKGFzID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIHZhciBlbGVtRV8xID0gZWxlbShFKTtcbiAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHsgcmV0dXJuIGVsZW1FXzEoYSwgYXMpOyB9O1xuICAgICAgICB9XG4gICAgICAgIHZhciBwcmVkaWNhdGUgPSBmdW5jdGlvbiAoZWxlbWVudCkgeyByZXR1cm4gRS5lcXVhbHMoZWxlbWVudCwgYSk7IH07XG4gICAgICAgIHZhciBpID0gMDtcbiAgICAgICAgZm9yICg7IGkgPCBhcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgaWYgKHByZWRpY2F0ZShhc1tpXSkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfTtcbn1cbi8qKlxuICogUmVtb3ZlIGR1cGxpY2F0ZXMgZnJvbSBhbiBhcnJheSwga2VlcGluZyB0aGUgZmlyc3Qgb2NjdXJyZW5jZSBvZiBhbiBlbGVtZW50LlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyB1bmlxIH0gZnJvbSAnZnAtdHMvUmVhZG9ubHlBcnJheSdcbiAqIGltcG9ydCAqIGFzIE4gZnJvbSAnZnAtdHMvbnVtYmVyJ1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwodW5pcShOLkVxKShbMSwgMiwgMV0pLCBbMSwgMl0pXG4gKlxuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgdW5pcSA9IGZ1bmN0aW9uIChFKSB7XG4gICAgdmFyIGYgPSBSTkVBLnVuaXEoRSk7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykgeyByZXR1cm4gKGlzTm9uRW1wdHkoYXMpID8gZihhcykgOiBhcyk7IH07XG59O1xuLyoqXG4gKiBTb3J0IHRoZSBlbGVtZW50cyBvZiBhbiBhcnJheSBpbiBpbmNyZWFzaW5nIG9yZGVyLCB3aGVyZSBlbGVtZW50cyBhcmUgY29tcGFyZWQgdXNpbmcgZmlyc3QgYG9yZHNbMF1gLCB0aGVuIGBvcmRzWzFdYCxcbiAqIGV0Yy4uLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBzb3J0QnkgfSBmcm9tICdmcC10cy9SZWFkb25seUFycmF5J1xuICogaW1wb3J0IHsgY29udHJhbWFwIH0gZnJvbSAnZnAtdHMvT3JkJ1xuICogaW1wb3J0ICogYXMgUyBmcm9tICdmcC10cy9zdHJpbmcnXG4gKiBpbXBvcnQgKiBhcyBOIGZyb20gJ2ZwLXRzL251bWJlcidcbiAqIGltcG9ydCB7IHBpcGUgfSBmcm9tICdmcC10cy9mdW5jdGlvbidcbiAqXG4gKiBpbnRlcmZhY2UgUGVyc29uIHtcbiAqICAgcmVhZG9ubHkgbmFtZTogc3RyaW5nXG4gKiAgIHJlYWRvbmx5IGFnZTogbnVtYmVyXG4gKiB9XG4gKiBjb25zdCBieU5hbWUgPSBwaXBlKFMuT3JkLCBjb250cmFtYXAoKHA6IFBlcnNvbikgPT4gcC5uYW1lKSlcbiAqIGNvbnN0IGJ5QWdlID0gcGlwZShOLk9yZCwgY29udHJhbWFwKChwOiBQZXJzb24pID0+IHAuYWdlKSlcbiAqXG4gKiBjb25zdCBzb3J0QnlOYW1lQnlBZ2UgPSBzb3J0QnkoW2J5TmFtZSwgYnlBZ2VdKVxuICpcbiAqIGNvbnN0IHBlcnNvbnMgPSBbeyBuYW1lOiAnYScsIGFnZTogMSB9LCB7IG5hbWU6ICdiJywgYWdlOiAzIH0sIHsgbmFtZTogJ2MnLCBhZ2U6IDIgfSwgeyBuYW1lOiAnYicsIGFnZTogMiB9XVxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChzb3J0QnlOYW1lQnlBZ2UocGVyc29ucyksIFtcbiAqICAgeyBuYW1lOiAnYScsIGFnZTogMSB9LFxuICogICB7IG5hbWU6ICdiJywgYWdlOiAyIH0sXG4gKiAgIHsgbmFtZTogJ2InLCBhZ2U6IDMgfSxcbiAqICAgeyBuYW1lOiAnYycsIGFnZTogMiB9XG4gKiBdKVxuICpcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIHNvcnRCeSA9IGZ1bmN0aW9uIChvcmRzKSB7XG4gICAgdmFyIGYgPSBSTkVBLnNvcnRCeShvcmRzKTtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7IHJldHVybiAoaXNOb25FbXB0eShhcykgPyBmKGFzKSA6IGFzKTsgfTtcbn07XG4vKipcbiAqIEEgdXNlZnVsIHJlY3Vyc2lvbiBwYXR0ZXJuIGZvciBwcm9jZXNzaW5nIGEgYFJlYWRvbmx5QXJyYXlgIHRvIHByb2R1Y2UgYSBuZXcgYFJlYWRvbmx5QXJyYXlgLCBvZnRlbiB1c2VkIGZvciBcImNob3BwaW5nXCIgdXAgdGhlIGlucHV0XG4gKiBgUmVhZG9ubHlBcnJheWAuIFR5cGljYWxseSBgY2hvcGAgaXMgY2FsbGVkIHdpdGggc29tZSBmdW5jdGlvbiB0aGF0IHdpbGwgY29uc3VtZSBhbiBpbml0aWFsIHByZWZpeCBvZiB0aGUgYFJlYWRvbmx5QXJyYXlgIGFuZCBwcm9kdWNlIGFcbiAqIHZhbHVlIGFuZCB0aGUgdGFpbCBvZiB0aGUgYFJlYWRvbmx5QXJyYXlgLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBFcSB9IGZyb20gJ2ZwLXRzL0VxJ1xuICogaW1wb3J0ICogYXMgUkEgZnJvbSAnZnAtdHMvUmVhZG9ubHlBcnJheSdcbiAqIGltcG9ydCAqIGFzIE4gZnJvbSAnZnAtdHMvbnVtYmVyJ1xuICogaW1wb3J0IHsgcGlwZSB9IGZyb20gJ2ZwLXRzL2Z1bmN0aW9uJ1xuICpcbiAqIGNvbnN0IGdyb3VwID0gPEE+KFM6IEVxPEE+KTogKChhczogUmVhZG9ubHlBcnJheTxBPikgPT4gUmVhZG9ubHlBcnJheTxSZWFkb25seUFycmF5PEE+PikgPT4ge1xuICogICByZXR1cm4gUkEuY2hvcChhcyA9PiB7XG4gKiAgICAgY29uc3QgeyBpbml0LCByZXN0IH0gPSBwaXBlKGFzLCBSQS5zcGFuTGVmdCgoYTogQSkgPT4gUy5lcXVhbHMoYSwgYXNbMF0pKSlcbiAqICAgICByZXR1cm4gW2luaXQsIHJlc3RdXG4gKiAgIH0pXG4gKiB9XG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKGdyb3VwKE4uRXEpKFsxLCAxLCAyLCAzLCAzLCA0XSksIFtbMSwgMV0sIFsyXSwgWzMsIDNdLCBbNF1dKVxuICpcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIGNob3AgPSBmdW5jdGlvbiAoZikge1xuICAgIHZhciBnID0gUk5FQS5jaG9wKGYpO1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHsgcmV0dXJuIChpc05vbkVtcHR5KGFzKSA/IGcoYXMpIDogZW1wdHkpOyB9O1xufTtcbi8qKlxuICogU3BsaXRzIGEgYFJlYWRvbmx5QXJyYXlgIGludG8gdHdvIHBpZWNlcywgdGhlIGZpcnN0IHBpZWNlIGhhcyBtYXggYG5gIGVsZW1lbnRzLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBzcGxpdEF0IH0gZnJvbSAnZnAtdHMvUmVhZG9ubHlBcnJheSdcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKHNwbGl0QXQoMikoWzEsIDIsIDMsIDQsIDVdKSwgW1sxLCAyXSwgWzMsIDQsIDVdXSlcbiAqXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBzcGxpdEF0ID0gZnVuY3Rpb24gKG4pIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIHJldHVybiBuID49IDEgJiYgaXNOb25FbXB0eShhcykgPyBSTkVBLnNwbGl0QXQobikoYXMpIDogaXNFbXB0eShhcykgPyBbYXMsIGVtcHR5XSA6IFtlbXB0eSwgYXNdO1xuICAgIH07XG59O1xuLyoqXG4gKiBTcGxpdHMgYSBgUmVhZG9ubHlBcnJheWAgaW50byBsZW5ndGgtYG5gIHBpZWNlcy4gVGhlIGxhc3QgcGllY2Ugd2lsbCBiZSBzaG9ydGVyIGlmIGBuYCBkb2VzIG5vdCBldmVubHkgZGl2aWRlIHRoZSBsZW5ndGggb2ZcbiAqIHRoZSBgUmVhZG9ubHlBcnJheWAuIE5vdGUgdGhhdCBgY2h1bmtzT2YobikoW10pYCBpcyBgW11gLCBub3QgYFtbXV1gLiBUaGlzIGlzIGludGVudGlvbmFsLCBhbmQgaXMgY29uc2lzdGVudCB3aXRoIGEgcmVjdXJzaXZlXG4gKiBkZWZpbml0aW9uIG9mIGBjaHVua3NPZmA7IGl0IHNhdGlzZmllcyB0aGUgcHJvcGVydHkgdGhhdDpcbiAqXG4gKiBgYGB0c1xuICogY2h1bmtzT2YobikoeHMpLmNvbmNhdChjaHVua3NPZihuKSh5cykpID09IGNodW5rc09mKG4pKHhzLmNvbmNhdCh5cykpKVxuICogYGBgXG4gKlxuICogd2hlbmV2ZXIgYG5gIGV2ZW5seSBkaXZpZGVzIHRoZSBsZW5ndGggb2YgYGFzYC5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgY2h1bmtzT2YgfSBmcm9tICdmcC10cy9SZWFkb25seUFycmF5J1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoY2h1bmtzT2YoMikoWzEsIDIsIDMsIDQsIDVdKSwgW1sxLCAyXSwgWzMsIDRdLCBbNV1dKVxuICpcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIGNodW5rc09mID0gZnVuY3Rpb24gKG4pIHtcbiAgICB2YXIgZiA9IFJORUEuY2h1bmtzT2Yobik7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykgeyByZXR1cm4gKGlzTm9uRW1wdHkoYXMpID8gZihhcykgOiBlbXB0eSk7IH07XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgbGlmdGluZ1xuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIGZyb21PcHRpb25LID0gZnVuY3Rpb24gKGYpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgYSA9IFtdO1xuICAgICAgICBmb3IgKHZhciBfaSA9IDA7IF9pIDwgYXJndW1lbnRzLmxlbmd0aDsgX2krKykge1xuICAgICAgICAgICAgYVtfaV0gPSBhcmd1bWVudHNbX2ldO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBmcm9tT3B0aW9uKGYuYXBwbHkodm9pZCAwLCBhKSk7XG4gICAgfTtcbn07XG5leHBvcnQgZnVuY3Rpb24gY29tcHJlaGVuc2lvbihpbnB1dCwgZiwgZykge1xuICAgIGlmIChnID09PSB2b2lkIDApIHsgZyA9IGZ1bmN0aW9uICgpIHsgcmV0dXJuIHRydWU7IH07IH1cbiAgICB2YXIgZ28gPSBmdW5jdGlvbiAoc2NvcGUsIGlucHV0KSB7XG4gICAgICAgIHJldHVybiBpc05vbkVtcHR5KGlucHV0KVxuICAgICAgICAgICAgPyBmbGF0TWFwKFJORUEuaGVhZChpbnB1dCksIGZ1bmN0aW9uIChhKSB7IHJldHVybiBnbyhwaXBlKHNjb3BlLCBhcHBlbmQoYSkpLCBSTkVBLnRhaWwoaW5wdXQpKTsgfSlcbiAgICAgICAgICAgIDogZy5hcHBseSh2b2lkIDAsIHNjb3BlKSA/IFtmLmFwcGx5KHZvaWQgMCwgc2NvcGUpXVxuICAgICAgICAgICAgICAgIDogZW1wdHk7XG4gICAgfTtcbiAgICByZXR1cm4gZ28oZW1wdHksIGlucHV0KTtcbn1cbi8qKlxuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIGNvbmNhdFcgPSBmdW5jdGlvbiAoc2Vjb25kKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChmaXJzdCkge1xuICAgICAgICByZXR1cm4gaXNFbXB0eShmaXJzdCkgPyBzZWNvbmQgOiBpc0VtcHR5KHNlY29uZCkgPyBmaXJzdCA6IGZpcnN0LmNvbmNhdChzZWNvbmQpO1xuICAgIH07XG59O1xuLyoqXG4gKiBAc2luY2UgMi4xMS4wXG4gKi9cbmV4cG9ydCB2YXIgY29uY2F0ID0gY29uY2F0VztcbmV4cG9ydCBmdW5jdGlvbiB1bmlvbihFKSB7XG4gICAgdmFyIHVuaW9uRSA9IFJORUEudW5pb24oRSk7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChmaXJzdCwgc2Vjb25kKSB7XG4gICAgICAgIGlmIChzZWNvbmQgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgdmFyIHVuaW9uRV8xID0gdW5pb24oRSk7XG4gICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24gKHNlY29uZCkgeyByZXR1cm4gdW5pb25FXzEoc2Vjb25kLCBmaXJzdCk7IH07XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGlzTm9uRW1wdHkoZmlyc3QpICYmIGlzTm9uRW1wdHkoc2Vjb25kKSA/IHVuaW9uRShzZWNvbmQpKGZpcnN0KSA6IGlzTm9uRW1wdHkoZmlyc3QpID8gZmlyc3QgOiBzZWNvbmQ7XG4gICAgfTtcbn1cbmV4cG9ydCBmdW5jdGlvbiBpbnRlcnNlY3Rpb24oRSkge1xuICAgIHZhciBlbGVtRSA9IGVsZW0oRSk7XG4gICAgcmV0dXJuIGZ1bmN0aW9uICh4cywgeXMpIHtcbiAgICAgICAgaWYgKHlzID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIHZhciBpbnRlcnNlY3Rpb25FXzEgPSBpbnRlcnNlY3Rpb24oRSk7XG4gICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24gKHlzKSB7IHJldHVybiBpbnRlcnNlY3Rpb25FXzEoeXMsIHhzKTsgfTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4geHMuZmlsdGVyKGZ1bmN0aW9uIChhKSB7IHJldHVybiBlbGVtRShhLCB5cyk7IH0pO1xuICAgIH07XG59XG5leHBvcnQgZnVuY3Rpb24gZGlmZmVyZW5jZShFKSB7XG4gICAgdmFyIGVsZW1FID0gZWxlbShFKTtcbiAgICByZXR1cm4gZnVuY3Rpb24gKHhzLCB5cykge1xuICAgICAgICBpZiAoeXMgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgdmFyIGRpZmZlcmVuY2VFXzEgPSBkaWZmZXJlbmNlKEUpO1xuICAgICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uICh5cykgeyByZXR1cm4gZGlmZmVyZW5jZUVfMSh5cywgeHMpOyB9O1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB4cy5maWx0ZXIoZnVuY3Rpb24gKGEpIHsgcmV0dXJuICFlbGVtRShhLCB5cyk7IH0pO1xuICAgIH07XG59XG52YXIgX21hcCA9IGZ1bmN0aW9uIChmYSwgZikgeyByZXR1cm4gcGlwZShmYSwgbWFwKGYpKTsgfTtcbnZhciBfbWFwV2l0aEluZGV4ID0gZnVuY3Rpb24gKGZhLCBmKSB7IHJldHVybiBwaXBlKGZhLCBtYXBXaXRoSW5kZXgoZikpOyB9O1xudmFyIF9hcCA9IGZ1bmN0aW9uIChmYWIsIGZhKSB7IHJldHVybiBwaXBlKGZhYiwgYXAoZmEpKTsgfTtcbnZhciBfZmlsdGVyID0gZnVuY3Rpb24gKGZhLCBwcmVkaWNhdGUpIHtcbiAgICByZXR1cm4gcGlwZShmYSwgZmlsdGVyKHByZWRpY2F0ZSkpO1xufTtcbnZhciBfZmlsdGVyTWFwID0gZnVuY3Rpb24gKGZhLCBmKSB7IHJldHVybiBwaXBlKGZhLCBmaWx0ZXJNYXAoZikpOyB9O1xudmFyIF9wYXJ0aXRpb24gPSBmdW5jdGlvbiAoZmEsIHByZWRpY2F0ZSkge1xuICAgIHJldHVybiBwaXBlKGZhLCBwYXJ0aXRpb24ocHJlZGljYXRlKSk7XG59O1xudmFyIF9wYXJ0aXRpb25NYXAgPSBmdW5jdGlvbiAoZmEsIGYpIHsgcmV0dXJuIHBpcGUoZmEsIHBhcnRpdGlvbk1hcChmKSk7IH07XG52YXIgX3BhcnRpdGlvbldpdGhJbmRleCA9IGZ1bmN0aW9uIChmYSwgcHJlZGljYXRlV2l0aEluZGV4KSB7IHJldHVybiBwaXBlKGZhLCBwYXJ0aXRpb25XaXRoSW5kZXgocHJlZGljYXRlV2l0aEluZGV4KSk7IH07XG52YXIgX3BhcnRpdGlvbk1hcFdpdGhJbmRleCA9IGZ1bmN0aW9uIChmYSwgZikgeyByZXR1cm4gcGlwZShmYSwgcGFydGl0aW9uTWFwV2l0aEluZGV4KGYpKTsgfTtcbnZhciBfYWx0ID0gZnVuY3Rpb24gKGZhLCB0aGF0KSB7IHJldHVybiBwaXBlKGZhLCBhbHQodGhhdCkpOyB9O1xudmFyIF9yZWR1Y2UgPSBmdW5jdGlvbiAoZmEsIGIsIGYpIHsgcmV0dXJuIHBpcGUoZmEsIHJlZHVjZShiLCBmKSk7IH07XG52YXIgX2ZvbGRNYXAgPSBmdW5jdGlvbiAoTSkge1xuICAgIHZhciBmb2xkTWFwTSA9IGZvbGRNYXAoTSk7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChmYSwgZikgeyByZXR1cm4gcGlwZShmYSwgZm9sZE1hcE0oZikpOyB9O1xufTtcbnZhciBfcmVkdWNlUmlnaHQgPSBmdW5jdGlvbiAoZmEsIGIsIGYpIHsgcmV0dXJuIHBpcGUoZmEsIHJlZHVjZVJpZ2h0KGIsIGYpKTsgfTtcbnZhciBfcmVkdWNlV2l0aEluZGV4ID0gZnVuY3Rpb24gKGZhLCBiLCBmKSB7XG4gICAgcmV0dXJuIHBpcGUoZmEsIHJlZHVjZVdpdGhJbmRleChiLCBmKSk7XG59O1xudmFyIF9mb2xkTWFwV2l0aEluZGV4ID0gZnVuY3Rpb24gKE0pIHtcbiAgICB2YXIgZm9sZE1hcFdpdGhJbmRleE0gPSBmb2xkTWFwV2l0aEluZGV4KE0pO1xuICAgIHJldHVybiBmdW5jdGlvbiAoZmEsIGYpIHsgcmV0dXJuIHBpcGUoZmEsIGZvbGRNYXBXaXRoSW5kZXhNKGYpKTsgfTtcbn07XG52YXIgX3JlZHVjZVJpZ2h0V2l0aEluZGV4ID0gZnVuY3Rpb24gKGZhLCBiLCBmKSB7XG4gICAgcmV0dXJuIHBpcGUoZmEsIHJlZHVjZVJpZ2h0V2l0aEluZGV4KGIsIGYpKTtcbn07XG52YXIgX2ZpbHRlck1hcFdpdGhJbmRleCA9IGZ1bmN0aW9uIChmYSwgZikgeyByZXR1cm4gcGlwZShmYSwgZmlsdGVyTWFwV2l0aEluZGV4KGYpKTsgfTtcbnZhciBfZmlsdGVyV2l0aEluZGV4ID0gZnVuY3Rpb24gKGZhLCBwcmVkaWNhdGVXaXRoSW5kZXgpIHsgcmV0dXJuIHBpcGUoZmEsIGZpbHRlcldpdGhJbmRleChwcmVkaWNhdGVXaXRoSW5kZXgpKTsgfTtcbnZhciBfZXh0ZW5kID0gZnVuY3Rpb24gKGZhLCBmKSB7IHJldHVybiBwaXBlKGZhLCBleHRlbmQoZikpOyB9O1xudmFyIF90cmF2ZXJzZSA9IGZ1bmN0aW9uIChGKSB7XG4gICAgdmFyIHRyYXZlcnNlRiA9IHRyYXZlcnNlKEYpO1xuICAgIHJldHVybiBmdW5jdGlvbiAodGEsIGYpIHsgcmV0dXJuIHBpcGUodGEsIHRyYXZlcnNlRihmKSk7IH07XG59O1xuLyogaXN0YW5idWwgaWdub3JlIG5leHQgKi9cbnZhciBfdHJhdmVyc2VXaXRoSW5kZXggPSBmdW5jdGlvbiAoRikge1xuICAgIHZhciB0cmF2ZXJzZVdpdGhJbmRleEYgPSB0cmF2ZXJzZVdpdGhJbmRleChGKTtcbiAgICByZXR1cm4gZnVuY3Rpb24gKHRhLCBmKSB7IHJldHVybiBwaXBlKHRhLCB0cmF2ZXJzZVdpdGhJbmRleEYoZikpOyB9O1xufTtcbi8qKiBAaW50ZXJuYWwgKi9cbmV4cG9ydCB2YXIgX2NoYWluUmVjRGVwdGhGaXJzdCA9IGZ1bmN0aW9uIChhLCBmKSB7IHJldHVybiBwaXBlKGEsIGNoYWluUmVjRGVwdGhGaXJzdChmKSk7IH07XG4vKiogQGludGVybmFsICovXG5leHBvcnQgdmFyIF9jaGFpblJlY0JyZWFkdGhGaXJzdCA9IGZ1bmN0aW9uIChhLCBmKSB7IHJldHVybiBwaXBlKGEsIGNoYWluUmVjQnJlYWR0aEZpcnN0KGYpKTsgfTtcbi8qKlxuICogQGNhdGVnb3J5IGNvbnN0cnVjdG9yc1xuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgb2YgPSBSTkVBLm9mO1xuLyoqXG4gKiBAc2luY2UgMi43LjBcbiAqL1xuZXhwb3J0IHZhciB6ZXJvID0gZnVuY3Rpb24gKCkgeyByZXR1cm4gZW1wdHk7IH07XG4vKipcbiAqIExlc3Mgc3RyaWN0IHZlcnNpb24gb2YgW2BhbHRgXSgjYWx0KS5cbiAqXG4gKiBUaGUgYFdgIHN1ZmZpeCAoc2hvcnQgZm9yICoqVyoqaWRlbmluZykgbWVhbnMgdGhhdCB0aGUgcmV0dXJuIHR5cGVzIHdpbGwgYmUgbWVyZ2VkLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgKiBhcyBSQSBmcm9tICdmcC10cy9SZWFkb25seUFycmF5J1xuICogaW1wb3J0IHsgcGlwZSB9IGZyb20gJ2ZwLXRzL2Z1bmN0aW9uJ1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoXG4gKiAgIHBpcGUoXG4gKiAgICAgWzEsIDIsIDNdLFxuICogICAgIFJBLmFsdFcoKCkgPT4gWydhJywgJ2InXSlcbiAqICAgKSxcbiAqICAgWzEsIDIsIDMsICdhJywgJ2InXVxuICogKVxuICpcbiAqIEBjYXRlZ29yeSBlcnJvciBoYW5kbGluZ1xuICogQHNpbmNlIDIuOS4wXG4gKi9cbmV4cG9ydCB2YXIgYWx0VyA9IGZ1bmN0aW9uICh0aGF0KSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChmYSkge1xuICAgICAgICByZXR1cm4gZmEuY29uY2F0KHRoYXQoKSk7XG4gICAgfTtcbn07XG4vKipcbiAqIElkZW50aWZpZXMgYW4gYXNzb2NpYXRpdmUgb3BlcmF0aW9uIG9uIGEgdHlwZSBjb25zdHJ1Y3Rvci4gSXQgaXMgc2ltaWxhciB0byBgU2VtaWdyb3VwYCwgZXhjZXB0IHRoYXQgaXQgYXBwbGllcyB0b1xuICogdHlwZXMgb2Yga2luZCBgKiAtPiAqYC5cbiAqXG4gKiBJbiBjYXNlIG9mIGBSZWFkb25seUFycmF5YCBjb25jYXRlbmF0ZXMgdGhlIGlucHV0cyBpbnRvIGEgc2luZ2xlIGFycmF5LlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgKiBhcyBSQSBmcm9tICdmcC10cy9SZWFkb25seUFycmF5J1xuICogaW1wb3J0IHsgcGlwZSB9IGZyb20gJ2ZwLXRzL2Z1bmN0aW9uJ1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoXG4gKiAgIHBpcGUoXG4gKiAgICAgWzEsIDIsIDNdLFxuICogICAgIFJBLmFsdCgoKSA9PiBbNCwgNV0pXG4gKiAgICksXG4gKiAgIFsxLCAyLCAzLCA0LCA1XVxuICogKVxuICpcbiAqIEBjYXRlZ29yeSBlcnJvciBoYW5kbGluZ1xuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgYWx0ID0gYWx0Vztcbi8qKlxuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgYXAgPSBmdW5jdGlvbiAoZmEpIHtcbiAgICByZXR1cm4gZmxhdE1hcChmdW5jdGlvbiAoZikgeyByZXR1cm4gcGlwZShmYSwgbWFwKGYpKTsgfSk7XG59O1xuLyoqXG4gKiBDb21wb3NlcyBjb21wdXRhdGlvbnMgaW4gc2VxdWVuY2UsIHVzaW5nIHRoZSByZXR1cm4gdmFsdWUgb2Ygb25lIGNvbXB1dGF0aW9uIHRvIGRldGVybWluZSB0aGUgbmV4dCBjb21wdXRhdGlvbi5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0ICogYXMgUkEgZnJvbSAnZnAtdHMvUmVhZG9ubHlBcnJheSdcbiAqIGltcG9ydCB7IHBpcGUgfSBmcm9tICdmcC10cy9mdW5jdGlvbidcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKFxuICogICBwaXBlKFxuICogICAgIFsxLCAyLCAzXSxcbiAqICAgICBSQS5mbGF0TWFwKChuKSA9PiBbYGEke259YCwgYGIke259YF0pXG4gKiAgICksXG4gKiAgIFsnYTEnLCAnYjEnLCAnYTInLCAnYjInLCAnYTMnLCAnYjMnXVxuICogKVxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChcbiAqICAgcGlwZShcbiAqICAgICBbMSwgMiwgM10sXG4gKiAgICAgUkEuZmxhdE1hcCgoKSA9PiBbXSlcbiAqICAgKSxcbiAqICAgW11cbiAqIClcbiAqXG4gKiBAY2F0ZWdvcnkgc2VxdWVuY2luZ1xuICogQHNpbmNlIDIuMTQuMFxuICovXG5leHBvcnQgdmFyIGZsYXRNYXAgPSAvKiNfX1BVUkVfXyovIGR1YWwoMiwgZnVuY3Rpb24gKG1hLCBmKSB7XG4gICAgcmV0dXJuIHBpcGUobWEsIGNoYWluV2l0aEluZGV4KGZ1bmN0aW9uIChpLCBhKSB7IHJldHVybiBmKGEsIGkpOyB9KSk7XG59KTtcbi8qKlxuICogQGNhdGVnb3J5IHNlcXVlbmNpbmdcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIGZsYXR0ZW4gPSAvKiNfX1BVUkVfXyovIGZsYXRNYXAoaWRlbnRpdHkpO1xuLyoqXG4gKiBgbWFwYCBjYW4gYmUgdXNlZCB0byB0dXJuIGZ1bmN0aW9ucyBgKGE6IEEpID0+IEJgIGludG8gZnVuY3Rpb25zIGAoZmE6IEY8QT4pID0+IEY8Qj5gIHdob3NlIGFyZ3VtZW50IGFuZCByZXR1cm4gdHlwZXNcbiAqIHVzZSB0aGUgdHlwZSBjb25zdHJ1Y3RvciBgRmAgdG8gcmVwcmVzZW50IHNvbWUgY29tcHV0YXRpb25hbCBjb250ZXh0LlxuICpcbiAqIEBjYXRlZ29yeSBtYXBwaW5nXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBtYXAgPSBmdW5jdGlvbiAoZikgeyByZXR1cm4gZnVuY3Rpb24gKGZhKSB7XG4gICAgcmV0dXJuIGZhLm1hcChmdW5jdGlvbiAoYSkgeyByZXR1cm4gZihhKTsgfSk7XG59OyB9O1xuLyoqXG4gKiBAY2F0ZWdvcnkgbWFwcGluZ1xuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgbWFwV2l0aEluZGV4ID0gZnVuY3Rpb24gKGYpIHsgcmV0dXJuIGZ1bmN0aW9uIChmYSkge1xuICAgIHJldHVybiBmYS5tYXAoZnVuY3Rpb24gKGEsIGkpIHsgcmV0dXJuIGYoaSwgYSk7IH0pO1xufTsgfTtcbi8qKlxuICogQGNhdGVnb3J5IGZpbHRlcmluZ1xuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgc2VwYXJhdGUgPSBmdW5jdGlvbiAoZmEpIHtcbiAgICB2YXIgbGVmdCA9IFtdO1xuICAgIHZhciByaWdodCA9IFtdO1xuICAgIGZvciAodmFyIF9pID0gMCwgZmFfMSA9IGZhOyBfaSA8IGZhXzEubGVuZ3RoOyBfaSsrKSB7XG4gICAgICAgIHZhciBlID0gZmFfMVtfaV07XG4gICAgICAgIGlmIChlLl90YWcgPT09ICdMZWZ0Jykge1xuICAgICAgICAgICAgbGVmdC5wdXNoKGUubGVmdCk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICByaWdodC5wdXNoKGUucmlnaHQpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiBzZXBhcmF0ZWQobGVmdCwgcmlnaHQpO1xufTtcbi8qKlxuICogQGNhdGVnb3J5IGZpbHRlcmluZ1xuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgZmlsdGVyID0gZnVuY3Rpb24gKHByZWRpY2F0ZSkge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgcmV0dXJuIGFzLmZpbHRlcihwcmVkaWNhdGUpO1xuICAgIH07XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgZmlsdGVyaW5nXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBmaWx0ZXJNYXBXaXRoSW5kZXggPSBmdW5jdGlvbiAoZikge1xuICAgIHJldHVybiBmdW5jdGlvbiAoZmEpIHtcbiAgICAgICAgdmFyIG91dCA9IFtdO1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGZhLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICB2YXIgb3B0aW9uQiA9IGYoaSwgZmFbaV0pO1xuICAgICAgICAgICAgaWYgKF8uaXNTb21lKG9wdGlvbkIpKSB7XG4gICAgICAgICAgICAgICAgb3V0LnB1c2gob3B0aW9uQi52YWx1ZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG91dDtcbiAgICB9O1xufTtcbi8qKlxuICogQGNhdGVnb3J5IGZpbHRlcmluZ1xuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgZmlsdGVyTWFwID0gZnVuY3Rpb24gKGYpIHtcbiAgICByZXR1cm4gZmlsdGVyTWFwV2l0aEluZGV4KGZ1bmN0aW9uIChfLCBhKSB7IHJldHVybiBmKGEpOyB9KTtcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBmaWx0ZXJpbmdcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIGNvbXBhY3QgPSAvKiNfX1BVUkVfXyovIGZpbHRlck1hcChpZGVudGl0eSk7XG4vKipcbiAqIEBjYXRlZ29yeSBmaWx0ZXJpbmdcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIHBhcnRpdGlvbiA9IGZ1bmN0aW9uIChwcmVkaWNhdGUpIHtcbiAgICByZXR1cm4gcGFydGl0aW9uV2l0aEluZGV4KGZ1bmN0aW9uIChfLCBhKSB7IHJldHVybiBwcmVkaWNhdGUoYSk7IH0pO1xufTtcbi8qKlxuICogQGNhdGVnb3J5IGZpbHRlcmluZ1xuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgcGFydGl0aW9uV2l0aEluZGV4ID0gZnVuY3Rpb24gKHByZWRpY2F0ZVdpdGhJbmRleCkge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgdmFyIGxlZnQgPSBbXTtcbiAgICAgICAgdmFyIHJpZ2h0ID0gW107XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgYXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIHZhciBhID0gYXNbaV07XG4gICAgICAgICAgICBpZiAocHJlZGljYXRlV2l0aEluZGV4KGksIGEpKSB7XG4gICAgICAgICAgICAgICAgcmlnaHQucHVzaChhKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIGxlZnQucHVzaChhKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gc2VwYXJhdGVkKGxlZnQsIHJpZ2h0KTtcbiAgICB9O1xufTtcbi8qKlxuICogQGNhdGVnb3J5IGZpbHRlcmluZ1xuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgcGFydGl0aW9uTWFwID0gZnVuY3Rpb24gKGYpIHtcbiAgICByZXR1cm4gcGFydGl0aW9uTWFwV2l0aEluZGV4KGZ1bmN0aW9uIChfLCBhKSB7IHJldHVybiBmKGEpOyB9KTtcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBmaWx0ZXJpbmdcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIHBhcnRpdGlvbk1hcFdpdGhJbmRleCA9IGZ1bmN0aW9uIChmKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChmYSkge1xuICAgICAgICB2YXIgbGVmdCA9IFtdO1xuICAgICAgICB2YXIgcmlnaHQgPSBbXTtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBmYS5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgdmFyIGUgPSBmKGksIGZhW2ldKTtcbiAgICAgICAgICAgIGlmIChlLl90YWcgPT09ICdMZWZ0Jykge1xuICAgICAgICAgICAgICAgIGxlZnQucHVzaChlLmxlZnQpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgcmlnaHQucHVzaChlLnJpZ2h0KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gc2VwYXJhdGVkKGxlZnQsIHJpZ2h0KTtcbiAgICB9O1xufTtcbi8qKlxuICogQGNhdGVnb3J5IGZpbHRlcmluZ1xuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgZmlsdGVyV2l0aEluZGV4ID0gZnVuY3Rpb24gKHByZWRpY2F0ZVdpdGhJbmRleCkge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgcmV0dXJuIGFzLmZpbHRlcihmdW5jdGlvbiAoYSwgaSkgeyByZXR1cm4gcHJlZGljYXRlV2l0aEluZGV4KGksIGEpOyB9KTtcbiAgICB9O1xufTtcbi8qKlxuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgZXh0ZW5kID0gZnVuY3Rpb24gKGYpIHsgcmV0dXJuIGZ1bmN0aW9uICh3YSkge1xuICAgIHJldHVybiB3YS5tYXAoZnVuY3Rpb24gKF8sIGkpIHsgcmV0dXJuIGYod2Euc2xpY2UoaSkpOyB9KTtcbn07IH07XG4vKipcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIGR1cGxpY2F0ZSA9IC8qI19fUFVSRV9fKi8gZXh0ZW5kKGlkZW50aXR5KTtcbi8qKlxuICogQGNhdGVnb3J5IGZvbGRpbmdcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIGZvbGRNYXBXaXRoSW5kZXggPSBmdW5jdGlvbiAoTSkge1xuICAgIHJldHVybiBmdW5jdGlvbiAoZikge1xuICAgICAgICByZXR1cm4gZnVuY3Rpb24gKGZhKSB7XG4gICAgICAgICAgICByZXR1cm4gZmEucmVkdWNlKGZ1bmN0aW9uIChiLCBhLCBpKSB7IHJldHVybiBNLmNvbmNhdChiLCBmKGksIGEpKTsgfSwgTS5lbXB0eSk7XG4gICAgICAgIH07XG4gICAgfTtcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBmb2xkaW5nXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciByZWR1Y2UgPSBmdW5jdGlvbiAoYiwgZikge1xuICAgIHJldHVybiByZWR1Y2VXaXRoSW5kZXgoYiwgZnVuY3Rpb24gKF8sIGIsIGEpIHsgcmV0dXJuIGYoYiwgYSk7IH0pO1xufTtcbi8qKlxuICogQGNhdGVnb3J5IGZvbGRpbmdcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIGZvbGRNYXAgPSBmdW5jdGlvbiAoTSkge1xuICAgIHZhciBmb2xkTWFwV2l0aEluZGV4TSA9IGZvbGRNYXBXaXRoSW5kZXgoTSk7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChmKSB7IHJldHVybiBmb2xkTWFwV2l0aEluZGV4TShmdW5jdGlvbiAoXywgYSkgeyByZXR1cm4gZihhKTsgfSk7IH07XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgZm9sZGluZ1xuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgcmVkdWNlV2l0aEluZGV4ID0gZnVuY3Rpb24gKGIsIGYpIHsgcmV0dXJuIGZ1bmN0aW9uIChmYSkge1xuICAgIHZhciBsZW4gPSBmYS5sZW5ndGg7XG4gICAgdmFyIG91dCA9IGI7XG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBsZW47IGkrKykge1xuICAgICAgICBvdXQgPSBmKGksIG91dCwgZmFbaV0pO1xuICAgIH1cbiAgICByZXR1cm4gb3V0O1xufTsgfTtcbi8qKlxuICogQGNhdGVnb3J5IGZvbGRpbmdcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIHJlZHVjZVJpZ2h0ID0gZnVuY3Rpb24gKGIsIGYpIHtcbiAgICByZXR1cm4gcmVkdWNlUmlnaHRXaXRoSW5kZXgoYiwgZnVuY3Rpb24gKF8sIGEsIGIpIHsgcmV0dXJuIGYoYSwgYik7IH0pO1xufTtcbi8qKlxuICogQGNhdGVnb3J5IGZvbGRpbmdcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIHJlZHVjZVJpZ2h0V2l0aEluZGV4ID0gZnVuY3Rpb24gKGIsIGYpIHsgcmV0dXJuIGZ1bmN0aW9uIChmYSkge1xuICAgIHJldHVybiBmYS5yZWR1Y2VSaWdodChmdW5jdGlvbiAoYiwgYSwgaSkgeyByZXR1cm4gZihpLCBhLCBiKTsgfSwgYik7XG59OyB9O1xuLyoqXG4gKiBAY2F0ZWdvcnkgdHJhdmVyc2luZ1xuICogQHNpbmNlIDIuNi4zXG4gKi9cbmV4cG9ydCB2YXIgdHJhdmVyc2UgPSBmdW5jdGlvbiAoRikge1xuICAgIHZhciB0cmF2ZXJzZVdpdGhJbmRleEYgPSB0cmF2ZXJzZVdpdGhJbmRleChGKTtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGYpIHsgcmV0dXJuIHRyYXZlcnNlV2l0aEluZGV4RihmdW5jdGlvbiAoXywgYSkgeyByZXR1cm4gZihhKTsgfSk7IH07XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgdHJhdmVyc2luZ1xuICogQHNpbmNlIDIuNi4zXG4gKi9cbmV4cG9ydCB2YXIgc2VxdWVuY2UgPSBmdW5jdGlvbiAoRikge1xuICAgIHJldHVybiBmdW5jdGlvbiAodGEpIHtcbiAgICAgICAgcmV0dXJuIF9yZWR1Y2UodGEsIEYub2YoemVybygpKSwgZnVuY3Rpb24gKGZhcywgZmEpIHtcbiAgICAgICAgICAgIHJldHVybiBGLmFwKEYubWFwKGZhcywgZnVuY3Rpb24gKGFzKSB7IHJldHVybiBmdW5jdGlvbiAoYSkgeyByZXR1cm4gcGlwZShhcywgYXBwZW5kKGEpKTsgfTsgfSksIGZhKTtcbiAgICAgICAgfSk7XG4gICAgfTtcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBzZXF1ZW5jaW5nXG4gKiBAc2luY2UgMi42LjNcbiAqL1xuZXhwb3J0IHZhciB0cmF2ZXJzZVdpdGhJbmRleCA9IGZ1bmN0aW9uIChGKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChmKSB7XG4gICAgICAgIHJldHVybiByZWR1Y2VXaXRoSW5kZXgoRi5vZih6ZXJvKCkpLCBmdW5jdGlvbiAoaSwgZmJzLCBhKSB7XG4gICAgICAgICAgICByZXR1cm4gRi5hcChGLm1hcChmYnMsIGZ1bmN0aW9uIChicykgeyByZXR1cm4gZnVuY3Rpb24gKGIpIHsgcmV0dXJuIHBpcGUoYnMsIGFwcGVuZChiKSk7IH07IH0pLCBmKGksIGEpKTtcbiAgICAgICAgfSk7XG4gICAgfTtcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBmaWx0ZXJpbmdcbiAqIEBzaW5jZSAyLjYuNVxuICovXG5leHBvcnQgdmFyIHdpdGhlciA9IGZ1bmN0aW9uIChGKSB7XG4gICAgdmFyIF93aXRoZXJGID0gX3dpdGhlcihGKTtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGYpIHsgcmV0dXJuIGZ1bmN0aW9uIChmYSkgeyByZXR1cm4gX3dpdGhlckYoZmEsIGYpOyB9OyB9O1xufTtcbi8qKlxuICogQGNhdGVnb3J5IGZpbHRlcmluZ1xuICogQHNpbmNlIDIuNi41XG4gKi9cbmV4cG9ydCB2YXIgd2lsdCA9IGZ1bmN0aW9uIChGKSB7XG4gICAgdmFyIF93aWx0RiA9IF93aWx0KEYpO1xuICAgIHJldHVybiBmdW5jdGlvbiAoZikgeyByZXR1cm4gZnVuY3Rpb24gKGZhKSB7IHJldHVybiBfd2lsdEYoZmEsIGYpOyB9OyB9O1xufTtcbi8qKlxuICogQHNpbmNlIDIuNi42XG4gKi9cbmV4cG9ydCB2YXIgdW5mb2xkID0gZnVuY3Rpb24gKGIsIGYpIHtcbiAgICB2YXIgb3V0ID0gW107XG4gICAgdmFyIGJiID0gYjtcbiAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tY29uc3RhbnQtY29uZGl0aW9uXG4gICAgd2hpbGUgKHRydWUpIHtcbiAgICAgICAgdmFyIG10ID0gZihiYik7XG4gICAgICAgIGlmIChfLmlzU29tZShtdCkpIHtcbiAgICAgICAgICAgIHZhciBfYSA9IG10LnZhbHVlLCBhID0gX2FbMF0sIGJfMSA9IF9hWzFdO1xuICAgICAgICAgICAgb3V0LnB1c2goYSk7XG4gICAgICAgICAgICBiYiA9IGJfMTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiBvdXQ7XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgdHlwZSBsYW1iZGFzXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBVUkkgPSAnUmVhZG9ubHlBcnJheSc7XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIGdldFNob3cgPSBmdW5jdGlvbiAoUykgeyByZXR1cm4gKHtcbiAgICBzaG93OiBmdW5jdGlvbiAoYXMpIHsgcmV0dXJuIFwiW1wiLmNvbmNhdChhcy5tYXAoUy5zaG93KS5qb2luKCcsICcpLCBcIl1cIik7IH1cbn0pOyB9O1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBnZXRTZW1pZ3JvdXAgPSBmdW5jdGlvbiAoKSB7IHJldHVybiAoe1xuICAgIGNvbmNhdDogZnVuY3Rpb24gKGZpcnN0LCBzZWNvbmQpIHsgcmV0dXJuIChpc0VtcHR5KGZpcnN0KSA/IHNlY29uZCA6IGlzRW1wdHkoc2Vjb25kKSA/IGZpcnN0IDogZmlyc3QuY29uY2F0KHNlY29uZCkpOyB9XG59KTsgfTtcbi8qKlxuICogUmV0dXJucyBhIGBNb25vaWRgIGZvciBgUmVhZG9ubHlBcnJheTxBPmAuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IGdldE1vbm9pZCB9IGZyb20gJ2ZwLXRzL1JlYWRvbmx5QXJyYXknXG4gKlxuICogY29uc3QgTSA9IGdldE1vbm9pZDxudW1iZXI+KClcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoTS5jb25jYXQoWzEsIDJdLCBbMywgNF0pLCBbMSwgMiwgMywgNF0pXG4gKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgZ2V0TW9ub2lkID0gZnVuY3Rpb24gKCkgeyByZXR1cm4gKHtcbiAgICBjb25jYXQ6IGdldFNlbWlncm91cCgpLmNvbmNhdCxcbiAgICBlbXB0eTogZW1wdHlcbn0pOyB9O1xuLyoqXG4gKiBEZXJpdmVzIGFuIGBFcWAgb3ZlciB0aGUgYFJlYWRvbmx5QXJyYXlgIG9mIGEgZ2l2ZW4gZWxlbWVudCB0eXBlIGZyb20gdGhlIGBFcWAgb2YgdGhhdCB0eXBlLiBUaGUgZGVyaXZlZCBgRXFgIGRlZmluZXMgdHdvXG4gKiBhcnJheXMgYXMgZXF1YWwgaWYgYWxsIGVsZW1lbnRzIG9mIGJvdGggYXJyYXlzIGFyZSBjb21wYXJlZCBlcXVhbCBwYWlyd2lzZSB3aXRoIHRoZSBnaXZlbiBgRWAuIEluIGNhc2Ugb2YgYXJyYXlzIG9mXG4gKiBkaWZmZXJlbnQgbGVuZ3RocywgdGhlIHJlc3VsdCBpcyBub24gZXF1YWxpdHkuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCAqIGFzIFMgZnJvbSAnZnAtdHMvc3RyaW5nJ1xuICogaW1wb3J0IHsgZ2V0RXEgfSBmcm9tICdmcC10cy9SZWFkb25seUFycmF5J1xuICpcbiAqIGNvbnN0IEUgPSBnZXRFcShTLkVxKVxuICogYXNzZXJ0LnN0cmljdEVxdWFsKEUuZXF1YWxzKFsnYScsICdiJ10sIFsnYScsICdiJ10pLCB0cnVlKVxuICogYXNzZXJ0LnN0cmljdEVxdWFsKEUuZXF1YWxzKFsnYSddLCBbXSksIGZhbHNlKVxuICpcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIGdldEVxID0gZnVuY3Rpb24gKEUpIHtcbiAgICByZXR1cm4gZnJvbUVxdWFscyhmdW5jdGlvbiAoeHMsIHlzKSB7IHJldHVybiB4cy5sZW5ndGggPT09IHlzLmxlbmd0aCAmJiB4cy5ldmVyeShmdW5jdGlvbiAoeCwgaSkgeyByZXR1cm4gRS5lcXVhbHMoeCwgeXNbaV0pOyB9KTsgfSk7XG59O1xuLyoqXG4gKiBEZXJpdmVzIGFuIGBPcmRgIG92ZXIgdGhlIGBSZWFkb25seUFycmF5YCBvZiBhIGdpdmVuIGVsZW1lbnQgdHlwZSBmcm9tIHRoZSBgT3JkYCBvZiB0aGF0IHR5cGUuIFRoZSBvcmRlcmluZyBiZXR3ZWVuIHR3byBzdWNoXG4gKiBhcnJheXMgaXMgZXF1YWwgdG86IHRoZSBmaXJzdCBub24gZXF1YWwgY29tcGFyaXNvbiBvZiBlYWNoIGFycmF5cyBlbGVtZW50cyB0YWtlbiBwYWlyd2lzZSBpbiBpbmNyZWFzaW5nIG9yZGVyLCBpblxuICogY2FzZSBvZiBlcXVhbGl0eSBvdmVyIGFsbCB0aGUgcGFpcndpc2UgZWxlbWVudHM7IHRoZSBsb25nZXN0IGFycmF5IGlzIGNvbnNpZGVyZWQgdGhlIGdyZWF0ZXN0LCBpZiBib3RoIGFycmF5cyBoYXZlXG4gKiB0aGUgc2FtZSBsZW5ndGgsIHRoZSByZXN1bHQgaXMgZXF1YWxpdHkuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IGdldE9yZCB9IGZyb20gJ2ZwLXRzL1JlYWRvbmx5QXJyYXknXG4gKiBpbXBvcnQgKiBhcyBTIGZyb20gJ2ZwLXRzL3N0cmluZydcbiAqXG4gKiBjb25zdCBPID0gZ2V0T3JkKFMuT3JkKVxuICogYXNzZXJ0LnN0cmljdEVxdWFsKE8uY29tcGFyZShbJ2InXSwgWydhJ10pLCAxKVxuICogYXNzZXJ0LnN0cmljdEVxdWFsKE8uY29tcGFyZShbJ2EnXSwgWydhJ10pLCAwKVxuICogYXNzZXJ0LnN0cmljdEVxdWFsKE8uY29tcGFyZShbJ2EnXSwgWydiJ10pLCAtMSlcbiAqXG4gKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgZ2V0T3JkID0gZnVuY3Rpb24gKE8pIHtcbiAgICByZXR1cm4gZnJvbUNvbXBhcmUoZnVuY3Rpb24gKGEsIGIpIHtcbiAgICAgICAgdmFyIGFMZW4gPSBhLmxlbmd0aDtcbiAgICAgICAgdmFyIGJMZW4gPSBiLmxlbmd0aDtcbiAgICAgICAgdmFyIGxlbiA9IE1hdGgubWluKGFMZW4sIGJMZW4pO1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGxlbjsgaSsrKSB7XG4gICAgICAgICAgICB2YXIgb3JkZXJpbmcgPSBPLmNvbXBhcmUoYVtpXSwgYltpXSk7XG4gICAgICAgICAgICBpZiAob3JkZXJpbmcgIT09IDApIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gb3JkZXJpbmc7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIE4uT3JkLmNvbXBhcmUoYUxlbiwgYkxlbik7XG4gICAgfSk7XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi4xMS4wXG4gKi9cbmV4cG9ydCB2YXIgZ2V0VW5pb25TZW1pZ3JvdXAgPSBmdW5jdGlvbiAoRSkge1xuICAgIHZhciB1bmlvbkUgPSB1bmlvbihFKTtcbiAgICByZXR1cm4ge1xuICAgICAgICBjb25jYXQ6IGZ1bmN0aW9uIChmaXJzdCwgc2Vjb25kKSB7IHJldHVybiB1bmlvbkUoc2Vjb25kKShmaXJzdCk7IH1cbiAgICB9O1xufTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIGdldFVuaW9uTW9ub2lkID0gZnVuY3Rpb24gKEUpIHsgcmV0dXJuICh7XG4gICAgY29uY2F0OiBnZXRVbmlvblNlbWlncm91cChFKS5jb25jYXQsXG4gICAgZW1wdHk6IGVtcHR5XG59KTsgfTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIGdldEludGVyc2VjdGlvblNlbWlncm91cCA9IGZ1bmN0aW9uIChFKSB7XG4gICAgdmFyIGludGVyc2VjdGlvbkUgPSBpbnRlcnNlY3Rpb24oRSk7XG4gICAgcmV0dXJuIHtcbiAgICAgICAgY29uY2F0OiBmdW5jdGlvbiAoZmlyc3QsIHNlY29uZCkgeyByZXR1cm4gaW50ZXJzZWN0aW9uRShzZWNvbmQpKGZpcnN0KTsgfVxuICAgIH07XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi4xMS4wXG4gKi9cbmV4cG9ydCB2YXIgZ2V0RGlmZmVyZW5jZU1hZ21hID0gZnVuY3Rpb24gKEUpIHtcbiAgICB2YXIgZGlmZmVyZW5jZUUgPSBkaWZmZXJlbmNlKEUpO1xuICAgIHJldHVybiB7XG4gICAgICAgIGNvbmNhdDogZnVuY3Rpb24gKGZpcnN0LCBzZWNvbmQpIHsgcmV0dXJuIGRpZmZlcmVuY2VFKHNlY29uZCkoZmlyc3QpOyB9XG4gICAgfTtcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjcuMFxuICovXG5leHBvcnQgdmFyIEZ1bmN0b3IgPSB7XG4gICAgVVJJOiBVUkksXG4gICAgbWFwOiBfbWFwXG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgbWFwcGluZ1xuICogQHNpbmNlIDIuMTAuMFxuICovXG5leHBvcnQgdmFyIGZsYXAgPSAvKiNfX1BVUkVfXyovIGZsYXBfKEZ1bmN0b3IpO1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi4xMC4wXG4gKi9cbmV4cG9ydCB2YXIgUG9pbnRlZCA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICBvZjogb2Zcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjcuMFxuICovXG5leHBvcnQgdmFyIEZ1bmN0b3JXaXRoSW5kZXggPSB7XG4gICAgVVJJOiBVUkksXG4gICAgbWFwOiBfbWFwLFxuICAgIG1hcFdpdGhJbmRleDogX21hcFdpdGhJbmRleFxufTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuMTAuMFxuICovXG5leHBvcnQgdmFyIEFwcGx5ID0ge1xuICAgIFVSSTogVVJJLFxuICAgIG1hcDogX21hcCxcbiAgICBhcDogX2FwXG59O1xuLyoqXG4gKiBDb21iaW5lIHR3byBlZmZlY3RmdWwgYWN0aW9ucywga2VlcGluZyBvbmx5IHRoZSByZXN1bHQgb2YgdGhlIGZpcnN0LlxuICpcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIGFwRmlyc3QgPSAvKiNfX1BVUkVfXyovIGFwRmlyc3RfKEFwcGx5KTtcbi8qKlxuICogQ29tYmluZSB0d28gZWZmZWN0ZnVsIGFjdGlvbnMsIGtlZXBpbmcgb25seSB0aGUgcmVzdWx0IG9mIHRoZSBzZWNvbmQuXG4gKlxuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgYXBTZWNvbmQgPSAvKiNfX1BVUkVfXyovIGFwU2Vjb25kXyhBcHBseSk7XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjcuMFxuICovXG5leHBvcnQgdmFyIEFwcGxpY2F0aXZlID0ge1xuICAgIFVSSTogVVJJLFxuICAgIG1hcDogX21hcCxcbiAgICBhcDogX2FwLFxuICAgIG9mOiBvZlxufTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuMTAuMFxuICovXG5leHBvcnQgdmFyIENoYWluID0ge1xuICAgIFVSSTogVVJJLFxuICAgIG1hcDogX21hcCxcbiAgICBhcDogX2FwLFxuICAgIGNoYWluOiBmbGF0TWFwXG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi43LjBcbiAqL1xuZXhwb3J0IHZhciBNb25hZCA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICBtYXA6IF9tYXAsXG4gICAgYXA6IF9hcCxcbiAgICBvZjogb2YsXG4gICAgY2hhaW46IGZsYXRNYXBcbn07XG4vKipcbiAqIENvbXBvc2VzIGNvbXB1dGF0aW9ucyBpbiBzZXF1ZW5jZSwgdXNpbmcgdGhlIHJldHVybiB2YWx1ZSBvZiBvbmUgY29tcHV0YXRpb24gdG8gZGV0ZXJtaW5lIHRoZSBuZXh0IGNvbXB1dGF0aW9uIGFuZFxuICoga2VlcGluZyBvbmx5IHRoZSByZXN1bHQgb2YgdGhlIGZpcnN0LlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgKiBhcyBSQSBmcm9tICdmcC10cy9SZWFkb25seUFycmF5J1xuICogaW1wb3J0IHsgcGlwZSB9IGZyb20gJ2ZwLXRzL2Z1bmN0aW9uJ1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoXG4gKiAgIHBpcGUoXG4gKiAgICAgWzEsIDIsIDNdLFxuICogICAgIFJBLmNoYWluRmlyc3QoKCkgPT4gWydhJywgJ2InXSlcbiAqICAgKSxcbiAqICAgWzEsIDEsIDIsIDIsIDMsIDNdXG4gKiApXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKFxuICogICBwaXBlKFxuICogICAgIFsxLCAyLCAzXSxcbiAqICAgICBSQS5jaGFpbkZpcnN0KCgpID0+IFtdKVxuICogICApLFxuICogICBbXVxuICogKVxuICpcbiAqIEBjYXRlZ29yeSBzZXF1ZW5jaW5nXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBjaGFpbkZpcnN0ID0gXG4vKiNfX1BVUkVfXyovIGNoYWluRmlyc3RfKENoYWluKTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuNy4wXG4gKi9cbmV4cG9ydCB2YXIgVW5mb2xkYWJsZSA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICB1bmZvbGQ6IHVuZm9sZFxufTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuNy4wXG4gKi9cbmV4cG9ydCB2YXIgQWx0ID0ge1xuICAgIFVSSTogVVJJLFxuICAgIG1hcDogX21hcCxcbiAgICBhbHQ6IF9hbHRcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjExLjBcbiAqL1xuZXhwb3J0IHZhciBaZXJvID0ge1xuICAgIFVSSTogVVJJLFxuICAgIHplcm86IHplcm9cbn07XG4vKipcbiAqIEBjYXRlZ29yeSBkbyBub3RhdGlvblxuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIGd1YXJkID0gLyojX19QVVJFX18qLyBndWFyZF8oWmVybywgUG9pbnRlZCk7XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjcuMFxuICovXG5leHBvcnQgdmFyIEFsdGVybmF0aXZlID0ge1xuICAgIFVSSTogVVJJLFxuICAgIG1hcDogX21hcCxcbiAgICBhcDogX2FwLFxuICAgIG9mOiBvZixcbiAgICBhbHQ6IF9hbHQsXG4gICAgemVybzogemVyb1xufTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuNy4wXG4gKi9cbmV4cG9ydCB2YXIgRXh0ZW5kID0ge1xuICAgIFVSSTogVVJJLFxuICAgIG1hcDogX21hcCxcbiAgICBleHRlbmQ6IF9leHRlbmRcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjcuMFxuICovXG5leHBvcnQgdmFyIENvbXBhY3RhYmxlID0ge1xuICAgIFVSSTogVVJJLFxuICAgIGNvbXBhY3Q6IGNvbXBhY3QsXG4gICAgc2VwYXJhdGU6IHNlcGFyYXRlXG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi43LjBcbiAqL1xuZXhwb3J0IHZhciBGaWx0ZXJhYmxlID0ge1xuICAgIFVSSTogVVJJLFxuICAgIG1hcDogX21hcCxcbiAgICBjb21wYWN0OiBjb21wYWN0LFxuICAgIHNlcGFyYXRlOiBzZXBhcmF0ZSxcbiAgICBmaWx0ZXI6IF9maWx0ZXIsXG4gICAgZmlsdGVyTWFwOiBfZmlsdGVyTWFwLFxuICAgIHBhcnRpdGlvbjogX3BhcnRpdGlvbixcbiAgICBwYXJ0aXRpb25NYXA6IF9wYXJ0aXRpb25NYXBcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjcuMFxuICovXG5leHBvcnQgdmFyIEZpbHRlcmFibGVXaXRoSW5kZXggPSB7XG4gICAgVVJJOiBVUkksXG4gICAgbWFwOiBfbWFwLFxuICAgIG1hcFdpdGhJbmRleDogX21hcFdpdGhJbmRleCxcbiAgICBjb21wYWN0OiBjb21wYWN0LFxuICAgIHNlcGFyYXRlOiBzZXBhcmF0ZSxcbiAgICBmaWx0ZXI6IF9maWx0ZXIsXG4gICAgZmlsdGVyTWFwOiBfZmlsdGVyTWFwLFxuICAgIHBhcnRpdGlvbjogX3BhcnRpdGlvbixcbiAgICBwYXJ0aXRpb25NYXA6IF9wYXJ0aXRpb25NYXAsXG4gICAgcGFydGl0aW9uTWFwV2l0aEluZGV4OiBfcGFydGl0aW9uTWFwV2l0aEluZGV4LFxuICAgIHBhcnRpdGlvbldpdGhJbmRleDogX3BhcnRpdGlvbldpdGhJbmRleCxcbiAgICBmaWx0ZXJNYXBXaXRoSW5kZXg6IF9maWx0ZXJNYXBXaXRoSW5kZXgsXG4gICAgZmlsdGVyV2l0aEluZGV4OiBfZmlsdGVyV2l0aEluZGV4XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi43LjBcbiAqL1xuZXhwb3J0IHZhciBGb2xkYWJsZSA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICByZWR1Y2U6IF9yZWR1Y2UsXG4gICAgZm9sZE1hcDogX2ZvbGRNYXAsXG4gICAgcmVkdWNlUmlnaHQ6IF9yZWR1Y2VSaWdodFxufTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuNy4wXG4gKi9cbmV4cG9ydCB2YXIgRm9sZGFibGVXaXRoSW5kZXggPSB7XG4gICAgVVJJOiBVUkksXG4gICAgcmVkdWNlOiBfcmVkdWNlLFxuICAgIGZvbGRNYXA6IF9mb2xkTWFwLFxuICAgIHJlZHVjZVJpZ2h0OiBfcmVkdWNlUmlnaHQsXG4gICAgcmVkdWNlV2l0aEluZGV4OiBfcmVkdWNlV2l0aEluZGV4LFxuICAgIGZvbGRNYXBXaXRoSW5kZXg6IF9mb2xkTWFwV2l0aEluZGV4LFxuICAgIHJlZHVjZVJpZ2h0V2l0aEluZGV4OiBfcmVkdWNlUmlnaHRXaXRoSW5kZXhcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjcuMFxuICovXG5leHBvcnQgdmFyIFRyYXZlcnNhYmxlID0ge1xuICAgIFVSSTogVVJJLFxuICAgIG1hcDogX21hcCxcbiAgICByZWR1Y2U6IF9yZWR1Y2UsXG4gICAgZm9sZE1hcDogX2ZvbGRNYXAsXG4gICAgcmVkdWNlUmlnaHQ6IF9yZWR1Y2VSaWdodCxcbiAgICB0cmF2ZXJzZTogX3RyYXZlcnNlLFxuICAgIHNlcXVlbmNlOiBzZXF1ZW5jZVxufTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuNy4wXG4gKi9cbmV4cG9ydCB2YXIgVHJhdmVyc2FibGVXaXRoSW5kZXggPSB7XG4gICAgVVJJOiBVUkksXG4gICAgbWFwOiBfbWFwLFxuICAgIG1hcFdpdGhJbmRleDogX21hcFdpdGhJbmRleCxcbiAgICByZWR1Y2U6IF9yZWR1Y2UsXG4gICAgZm9sZE1hcDogX2ZvbGRNYXAsXG4gICAgcmVkdWNlUmlnaHQ6IF9yZWR1Y2VSaWdodCxcbiAgICByZWR1Y2VXaXRoSW5kZXg6IF9yZWR1Y2VXaXRoSW5kZXgsXG4gICAgZm9sZE1hcFdpdGhJbmRleDogX2ZvbGRNYXBXaXRoSW5kZXgsXG4gICAgcmVkdWNlUmlnaHRXaXRoSW5kZXg6IF9yZWR1Y2VSaWdodFdpdGhJbmRleCxcbiAgICB0cmF2ZXJzZTogX3RyYXZlcnNlLFxuICAgIHNlcXVlbmNlOiBzZXF1ZW5jZSxcbiAgICB0cmF2ZXJzZVdpdGhJbmRleDogX3RyYXZlcnNlV2l0aEluZGV4XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgc2VxdWVuY2luZ1xuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIGNoYWluUmVjRGVwdGhGaXJzdCA9IGZ1bmN0aW9uIChmKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhKSB7XG4gICAgICAgIHZhciB0b2RvID0gX19zcHJlYWRBcnJheShbXSwgZihhKSwgdHJ1ZSk7XG4gICAgICAgIHZhciBvdXQgPSBbXTtcbiAgICAgICAgd2hpbGUgKHRvZG8ubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgdmFyIGUgPSB0b2RvLnNoaWZ0KCk7XG4gICAgICAgICAgICBpZiAoXy5pc0xlZnQoZSkpIHtcbiAgICAgICAgICAgICAgICB0b2RvLnVuc2hpZnQuYXBwbHkodG9kbywgZihlLmxlZnQpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIG91dC5wdXNoKGUucmlnaHQpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBvdXQ7XG4gICAgfTtcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjExLjBcbiAqL1xuZXhwb3J0IHZhciBDaGFpblJlY0RlcHRoRmlyc3QgPSB7XG4gICAgVVJJOiBVUkksXG4gICAgbWFwOiBfbWFwLFxuICAgIGFwOiBfYXAsXG4gICAgY2hhaW46IGZsYXRNYXAsXG4gICAgY2hhaW5SZWM6IF9jaGFpblJlY0RlcHRoRmlyc3Rcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBzZXF1ZW5jaW5nXG4gKiBAc2luY2UgMi4xMS4wXG4gKi9cbmV4cG9ydCB2YXIgY2hhaW5SZWNCcmVhZHRoRmlyc3QgPSBmdW5jdGlvbiAoZikge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYSkge1xuICAgICAgICB2YXIgaW5pdGlhbCA9IGYoYSk7XG4gICAgICAgIHZhciB0b2RvID0gW107XG4gICAgICAgIHZhciBvdXQgPSBbXTtcbiAgICAgICAgZnVuY3Rpb24gZ28oZSkge1xuICAgICAgICAgICAgaWYgKF8uaXNMZWZ0KGUpKSB7XG4gICAgICAgICAgICAgICAgZihlLmxlZnQpLmZvckVhY2goZnVuY3Rpb24gKHYpIHsgcmV0dXJuIHRvZG8ucHVzaCh2KTsgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBvdXQucHVzaChlLnJpZ2h0KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBmb3IgKHZhciBfaSA9IDAsIGluaXRpYWxfMSA9IGluaXRpYWw7IF9pIDwgaW5pdGlhbF8xLmxlbmd0aDsgX2krKykge1xuICAgICAgICAgICAgdmFyIGUgPSBpbml0aWFsXzFbX2ldO1xuICAgICAgICAgICAgZ28oZSk7XG4gICAgICAgIH1cbiAgICAgICAgd2hpbGUgKHRvZG8ubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgZ28odG9kby5zaGlmdCgpKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gb3V0O1xuICAgIH07XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi4xMS4wXG4gKi9cbmV4cG9ydCB2YXIgQ2hhaW5SZWNCcmVhZHRoRmlyc3QgPSB7XG4gICAgVVJJOiBVUkksXG4gICAgbWFwOiBfbWFwLFxuICAgIGFwOiBfYXAsXG4gICAgY2hhaW46IGZsYXRNYXAsXG4gICAgY2hhaW5SZWM6IF9jaGFpblJlY0JyZWFkdGhGaXJzdFxufTtcbnZhciBfd2l0aGVyID0gLyojX19QVVJFX18qLyB3aXRoZXJEZWZhdWx0KFRyYXZlcnNhYmxlLCBDb21wYWN0YWJsZSk7XG52YXIgX3dpbHQgPSAvKiNfX1BVUkVfXyovIHdpbHREZWZhdWx0KFRyYXZlcnNhYmxlLCBDb21wYWN0YWJsZSk7XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjcuMFxuICovXG5leHBvcnQgdmFyIFdpdGhlcmFibGUgPSB7XG4gICAgVVJJOiBVUkksXG4gICAgbWFwOiBfbWFwLFxuICAgIGNvbXBhY3Q6IGNvbXBhY3QsXG4gICAgc2VwYXJhdGU6IHNlcGFyYXRlLFxuICAgIGZpbHRlcjogX2ZpbHRlcixcbiAgICBmaWx0ZXJNYXA6IF9maWx0ZXJNYXAsXG4gICAgcGFydGl0aW9uOiBfcGFydGl0aW9uLFxuICAgIHBhcnRpdGlvbk1hcDogX3BhcnRpdGlvbk1hcCxcbiAgICByZWR1Y2U6IF9yZWR1Y2UsXG4gICAgZm9sZE1hcDogX2ZvbGRNYXAsXG4gICAgcmVkdWNlUmlnaHQ6IF9yZWR1Y2VSaWdodCxcbiAgICB0cmF2ZXJzZTogX3RyYXZlcnNlLFxuICAgIHNlcXVlbmNlOiBzZXF1ZW5jZSxcbiAgICB3aXRoZXI6IF93aXRoZXIsXG4gICAgd2lsdDogX3dpbHRcbn07XG4vKipcbiAqIEZpbHRlciB2YWx1ZXMgaW5zaWRlIGEgY29udGV4dC5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgcGlwZSB9IGZyb20gJ2ZwLXRzL2Z1bmN0aW9uJ1xuICogaW1wb3J0ICogYXMgUkEgZnJvbSAnZnAtdHMvUmVhZG9ubHlBcnJheSdcbiAqIGltcG9ydCAqIGFzIFQgZnJvbSAnZnAtdHMvVGFzaydcbiAqXG4gKiBjb25zdCBmaWx0ZXJFID0gUkEuZmlsdGVyRShULkFwcGxpY2F0aXZlUGFyKVxuICogYXN5bmMgZnVuY3Rpb24gdGVzdCgpIHtcbiAqICAgYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChcbiAqICAgICBhd2FpdCBwaXBlKFxuICogICAgICAgWy0xLCAyLCAzXSxcbiAqICAgICAgIGZpbHRlckUoKG4pID0+IFQub2YobiA+IDApKVxuICogICAgICkoKSxcbiAqICAgICBbMiwgM11cbiAqICAgKVxuICogfVxuICogdGVzdCgpXG4gKlxuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIGZpbHRlckUgPSAvKiNfX1BVUkVfXyovIGZpbHRlckVfKFdpdGhlcmFibGUpO1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi4xMS4wXG4gKi9cbmV4cG9ydCB2YXIgRnJvbUVpdGhlciA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICBmcm9tRWl0aGVyOiBmcm9tRWl0aGVyXG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgbGlmdGluZ1xuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIGZyb21FaXRoZXJLID0gLyojX19QVVJFX18qLyBmcm9tRWl0aGVyS18oRnJvbUVpdGhlcik7XG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vLyB1bnNhZmVcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8qKlxuICogQGNhdGVnb3J5IHVuc2FmZVxuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgdW5zYWZlSW5zZXJ0QXQgPSBSTkVBLnVuc2FmZUluc2VydEF0O1xuLyoqXG4gKiBAY2F0ZWdvcnkgdW5zYWZlXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciB1bnNhZmVVcGRhdGVBdCA9IGZ1bmN0aW9uIChpLCBhLCBhcykge1xuICAgIHJldHVybiBpc05vbkVtcHR5KGFzKSA/IFJORUEudW5zYWZlVXBkYXRlQXQoaSwgYSwgYXMpIDogYXM7XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgdW5zYWZlXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciB1bnNhZmVEZWxldGVBdCA9IGZ1bmN0aW9uIChpLCBhcykge1xuICAgIHZhciB4cyA9IGFzLnNsaWNlKCk7XG4gICAgeHMuc3BsaWNlKGksIDEpO1xuICAgIHJldHVybiB4cztcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBjb252ZXJzaW9uc1xuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgdG9BcnJheSA9IGZ1bmN0aW9uIChhcykgeyByZXR1cm4gYXMuc2xpY2UoKTsgfTtcbi8qKlxuICogQGNhdGVnb3J5IGNvbnZlcnNpb25zXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBmcm9tQXJyYXkgPSBmdW5jdGlvbiAoYXMpIHsgcmV0dXJuIChpc0VtcHR5KGFzKSA/IGVtcHR5IDogYXMuc2xpY2UoKSk7IH07XG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vLyB1dGlsc1xuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLyoqXG4gKiBBbiBlbXB0eSBhcnJheVxuICpcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIGVtcHR5ID0gUk5FQS5lbXB0eTtcbmV4cG9ydCBmdW5jdGlvbiBldmVyeShwcmVkaWNhdGUpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7IHJldHVybiBhcy5ldmVyeShwcmVkaWNhdGUpOyB9O1xufVxuLyoqXG4gKiBDaGVjayBpZiBhIHByZWRpY2F0ZSBob2xkcyB0cnVlIGZvciBhbnkgYXJyYXkgbWVtYmVyLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBzb21lIH0gZnJvbSAnZnAtdHMvUmVhZG9ubHlBcnJheSdcbiAqIGltcG9ydCB7IHBpcGUgfSBmcm9tICdmcC10cy9mdW5jdGlvbidcbiAqXG4gKiBjb25zdCBpc1Bvc2l0aXZlID0gKG46IG51bWJlcik6IGJvb2xlYW4gPT4gbiA+IDBcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKHBpcGUoWy0xLCAtMiwgM10sIHNvbWUoaXNQb3NpdGl2ZSkpLCB0cnVlKVxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChwaXBlKFstMSwgLTIsIC0zXSwgc29tZShpc1Bvc2l0aXZlKSksIGZhbHNlKVxuICpcbiAqIEBzaW5jZSAyLjkuMFxuICovXG5leHBvcnQgdmFyIHNvbWUgPSBmdW5jdGlvbiAocHJlZGljYXRlKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykge1xuICAgICAgICByZXR1cm4gYXMuc29tZShwcmVkaWNhdGUpO1xuICAgIH07XG59O1xuLyoqXG4gKiBBbGlhcyBvZiBbYHNvbWVgXSgjc29tZSlcbiAqXG4gKiBAc2luY2UgMi4xMS4wXG4gKi9cbmV4cG9ydCB2YXIgZXhpc3RzID0gc29tZTtcbi8qKlxuICogUGxhY2VzIGFuIGVsZW1lbnQgaW4gYmV0d2VlbiBtZW1iZXJzIG9mIGEgYFJlYWRvbmx5QXJyYXlgLCB0aGVuIGZvbGRzIHRoZSByZXN1bHRzIHVzaW5nIHRoZSBwcm92aWRlZCBgTW9ub2lkYC5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0ICogYXMgUyBmcm9tICdmcC10cy9zdHJpbmcnXG4gKiBpbXBvcnQgeyBpbnRlcmNhbGF0ZSB9IGZyb20gJ2ZwLXRzL1JlYWRvbmx5QXJyYXknXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChpbnRlcmNhbGF0ZShTLk1vbm9pZCkoJy0nKShbJ2EnLCAnYicsICdjJ10pLCAnYS1iLWMnKVxuICpcbiAqIEBzaW5jZSAyLjEyLjBcbiAqL1xuZXhwb3J0IHZhciBpbnRlcmNhbGF0ZSA9IGZ1bmN0aW9uIChNKSB7XG4gICAgdmFyIGludGVyY2FsYXRlTSA9IFJORUEuaW50ZXJjYWxhdGUoTSk7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChtaWRkbGUpIHsgcmV0dXJuIG1hdGNoKGZ1bmN0aW9uICgpIHsgcmV0dXJuIE0uZW1wdHk7IH0sIGludGVyY2FsYXRlTShtaWRkbGUpKTsgfTtcbn07XG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vLyBkbyBub3RhdGlvblxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLyoqXG4gKiBAY2F0ZWdvcnkgZG8gbm90YXRpb25cbiAqIEBzaW5jZSAyLjkuMFxuICovXG5leHBvcnQgdmFyIERvID0gLyojX19QVVJFX18qLyBvZihfLmVtcHR5UmVjb3JkKTtcbi8qKlxuICogQGNhdGVnb3J5IGRvIG5vdGF0aW9uXG4gKiBAc2luY2UgMi44LjBcbiAqL1xuZXhwb3J0IHZhciBiaW5kVG8gPSAvKiNfX1BVUkVfXyovIGJpbmRUb18oRnVuY3Rvcik7XG52YXIgbGV0XyA9IC8qI19fUFVSRV9fKi8gbGV0X18oRnVuY3Rvcik7XG5leHBvcnQgeyBcbi8qKlxuICogQGNhdGVnb3J5IGRvIG5vdGF0aW9uXG4gKiBAc2luY2UgMi4xMy4wXG4gKi9cbmxldF8gYXMgbGV0IH07XG4vKipcbiAqIEBjYXRlZ29yeSBkbyBub3RhdGlvblxuICogQHNpbmNlIDIuOC4wXG4gKi9cbmV4cG9ydCB2YXIgYmluZCA9IC8qI19fUFVSRV9fKi8gYmluZF8oQ2hhaW4pO1xuLyoqXG4gKiBAY2F0ZWdvcnkgZG8gbm90YXRpb25cbiAqIEBzaW5jZSAyLjguMFxuICovXG5leHBvcnQgdmFyIGFwUyA9IC8qI19fUFVSRV9fKi8gYXBTXyhBcHBseSk7XG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vLyBsZWdhY3lcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8qKlxuICogQWxpYXMgb2YgYGZsYXRNYXBgLlxuICpcbiAqIEBjYXRlZ29yeSBsZWdhY3lcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIGNoYWluID0gZmxhdE1hcDtcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8vIGRlcHJlY2F0ZWRcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8qKlxuICogVXNlIGBSZWFkb25seU5vbkVtcHR5QXJyYXlgIG1vZHVsZSBpbnN0ZWFkLlxuICpcbiAqIEBjYXRlZ29yeSB6b25lIG9mIGRlYXRoXG4gKiBAc2luY2UgMi41LjBcbiAqIEBkZXByZWNhdGVkXG4gKi9cbmV4cG9ydCB2YXIgcmFuZ2UgPSBSTkVBLnJhbmdlO1xuLyoqXG4gKiBVc2UgW2BwcmVwZW5kYF0oI3ByZXBlbmQpIGluc3RlYWQuXG4gKlxuICogQGNhdGVnb3J5IHpvbmUgb2YgZGVhdGhcbiAqIEBzaW5jZSAyLjUuMFxuICogQGRlcHJlY2F0ZWRcbiAqL1xuZXhwb3J0IHZhciBjb25zID0gUk5FQS5jb25zO1xuLyoqXG4gKiBVc2UgW2BhcHBlbmRgXSgjYXBwZW5kKSBpbnN0ZWFkLlxuICpcbiAqIEBjYXRlZ29yeSB6b25lIG9mIGRlYXRoXG4gKiBAc2luY2UgMi41LjBcbiAqIEBkZXByZWNhdGVkXG4gKi9cbmV4cG9ydCB2YXIgc25vYyA9IFJORUEuc25vYztcbi8qKlxuICogVXNlIFtgcHJlcGVuZEFsbGBdKCNwcmVwZW5kYWxsKSBpbnN0ZWFkLlxuICpcbiAqIEBjYXRlZ29yeSB6b25lIG9mIGRlYXRoXG4gKiBAc2luY2UgMi45LjBcbiAqIEBkZXByZWNhdGVkXG4gKi9cbmV4cG9ydCB2YXIgcHJlcGVuZFRvQWxsID0gcHJlcGVuZEFsbDtcbi8qKlxuICogVGhpcyBpbnN0YW5jZSBpcyBkZXByZWNhdGVkLCB1c2Ugc21hbGwsIHNwZWNpZmljIGluc3RhbmNlcyBpbnN0ZWFkLlxuICogRm9yIGV4YW1wbGUgaWYgYSBmdW5jdGlvbiBuZWVkcyBhIGBGdW5jdG9yYCBpbnN0YW5jZSwgcGFzcyBgUkEuRnVuY3RvcmAgaW5zdGVhZCBvZiBgUkEucmVhZG9ubHlBcnJheWBcbiAqICh3aGVyZSBgUkFgIGlzIGZyb20gYGltcG9ydCBSQSBmcm9tICdmcC10cy9SZWFkb25seUFycmF5J2ApXG4gKlxuICogQGNhdGVnb3J5IHpvbmUgb2YgZGVhdGhcbiAqIEBzaW5jZSAyLjUuMFxuICogQGRlcHJlY2F0ZWRcbiAqL1xuZXhwb3J0IHZhciByZWFkb25seUFycmF5ID0ge1xuICAgIFVSSTogVVJJLFxuICAgIGNvbXBhY3Q6IGNvbXBhY3QsXG4gICAgc2VwYXJhdGU6IHNlcGFyYXRlLFxuICAgIG1hcDogX21hcCxcbiAgICBhcDogX2FwLFxuICAgIG9mOiBvZixcbiAgICBjaGFpbjogZmxhdE1hcCxcbiAgICBmaWx0ZXI6IF9maWx0ZXIsXG4gICAgZmlsdGVyTWFwOiBfZmlsdGVyTWFwLFxuICAgIHBhcnRpdGlvbjogX3BhcnRpdGlvbixcbiAgICBwYXJ0aXRpb25NYXA6IF9wYXJ0aXRpb25NYXAsXG4gICAgbWFwV2l0aEluZGV4OiBfbWFwV2l0aEluZGV4LFxuICAgIHBhcnRpdGlvbk1hcFdpdGhJbmRleDogX3BhcnRpdGlvbk1hcFdpdGhJbmRleCxcbiAgICBwYXJ0aXRpb25XaXRoSW5kZXg6IF9wYXJ0aXRpb25XaXRoSW5kZXgsXG4gICAgZmlsdGVyTWFwV2l0aEluZGV4OiBfZmlsdGVyTWFwV2l0aEluZGV4LFxuICAgIGZpbHRlcldpdGhJbmRleDogX2ZpbHRlcldpdGhJbmRleCxcbiAgICBhbHQ6IF9hbHQsXG4gICAgemVybzogemVybyxcbiAgICB1bmZvbGQ6IHVuZm9sZCxcbiAgICByZWR1Y2U6IF9yZWR1Y2UsXG4gICAgZm9sZE1hcDogX2ZvbGRNYXAsXG4gICAgcmVkdWNlUmlnaHQ6IF9yZWR1Y2VSaWdodCxcbiAgICB0cmF2ZXJzZTogX3RyYXZlcnNlLFxuICAgIHNlcXVlbmNlOiBzZXF1ZW5jZSxcbiAgICByZWR1Y2VXaXRoSW5kZXg6IF9yZWR1Y2VXaXRoSW5kZXgsXG4gICAgZm9sZE1hcFdpdGhJbmRleDogX2ZvbGRNYXBXaXRoSW5kZXgsXG4gICAgcmVkdWNlUmlnaHRXaXRoSW5kZXg6IF9yZWR1Y2VSaWdodFdpdGhJbmRleCxcbiAgICB0cmF2ZXJzZVdpdGhJbmRleDogX3RyYXZlcnNlV2l0aEluZGV4LFxuICAgIGV4dGVuZDogX2V4dGVuZCxcbiAgICB3aXRoZXI6IF93aXRoZXIsXG4gICAgd2lsdDogX3dpbHRcbn07XG4iLAogICJ2YXIgX19zcHJlYWRBcnJheSA9ICh0aGlzICYmIHRoaXMuX19zcHJlYWRBcnJheSkgfHwgZnVuY3Rpb24gKHRvLCBmcm9tLCBwYWNrKSB7XG4gICAgaWYgKHBhY2sgfHwgYXJndW1lbnRzLmxlbmd0aCA9PT0gMikgZm9yICh2YXIgaSA9IDAsIGwgPSBmcm9tLmxlbmd0aCwgYXI7IGkgPCBsOyBpKyspIHtcbiAgICAgICAgaWYgKGFyIHx8ICEoaSBpbiBmcm9tKSkge1xuICAgICAgICAgICAgaWYgKCFhcikgYXIgPSBBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChmcm9tLCAwLCBpKTtcbiAgICAgICAgICAgIGFyW2ldID0gZnJvbVtpXTtcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gdG8uY29uY2F0KGFyIHx8IEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGZyb20pKTtcbn07XG5pbXBvcnQgeyBhcEZpcnN0IGFzIGFwRmlyc3RfLCBhcFMgYXMgYXBTXywgYXBTZWNvbmQgYXMgYXBTZWNvbmRfIH0gZnJvbSAnLi9BcHBseSc7XG5pbXBvcnQgeyBiaW5kIGFzIGJpbmRfLCBjaGFpbkZpcnN0IGFzIGNoYWluRmlyc3RfIH0gZnJvbSAnLi9DaGFpbic7XG5pbXBvcnQgeyBmcm9tRXF1YWxzIH0gZnJvbSAnLi9FcSc7XG5pbXBvcnQgeyBmcm9tRWl0aGVySyBhcyBmcm9tRWl0aGVyS18gfSBmcm9tICcuL0Zyb21FaXRoZXInO1xuaW1wb3J0IHsgZHVhbCwgaWRlbnRpdHksIHBpcGUgfSBmcm9tICcuL2Z1bmN0aW9uJztcbmltcG9ydCB7IGJpbmRUbyBhcyBiaW5kVG9fLCBmbGFwIGFzIGZsYXBfLCBsZXQgYXMgbGV0X18gfSBmcm9tICcuL0Z1bmN0b3InO1xuaW1wb3J0ICogYXMgXyBmcm9tICcuL2ludGVybmFsJztcbmltcG9ydCAqIGFzIE4gZnJvbSAnLi9udW1iZXInO1xuaW1wb3J0IHsgZnJvbUNvbXBhcmUgfSBmcm9tICcuL09yZCc7XG5pbXBvcnQgKiBhcyBSTkVBIGZyb20gJy4vUmVhZG9ubHlOb25FbXB0eUFycmF5JztcbmltcG9ydCB7IHNlcGFyYXRlZCB9IGZyb20gJy4vU2VwYXJhdGVkJztcbmltcG9ydCB7IGZpbHRlckUgYXMgZmlsdGVyRV8sIHdpbHREZWZhdWx0LCB3aXRoZXJEZWZhdWx0IH0gZnJvbSAnLi9XaXRoZXJhYmxlJztcbmltcG9ydCB7IGd1YXJkIGFzIGd1YXJkXyB9IGZyb20gJy4vWmVybyc7XG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vLyByZWZpbmVtZW50c1xuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLyoqXG4gKiBUZXN0IHdoZXRoZXIgYSBgUmVhZG9ubHlBcnJheWAgaXMgZW1wdHkuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IGlzRW1wdHkgfSBmcm9tICdmcC10cy9SZWFkb25seUFycmF5J1xuICpcbiAqIGFzc2VydC5zdHJpY3RFcXVhbChpc0VtcHR5KFtdKSwgdHJ1ZSlcbiAqXG4gKiBAY2F0ZWdvcnkgcmVmaW5lbWVudHNcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIGlzRW1wdHkgPSBmdW5jdGlvbiAoYXMpIHsgcmV0dXJuIGFzLmxlbmd0aCA9PT0gMDsgfTtcbi8qKlxuICogVGVzdCB3aGV0aGVyIGEgYFJlYWRvbmx5QXJyYXlgIGlzIG5vbiBlbXB0eS5cbiAqXG4gKiBAY2F0ZWdvcnkgcmVmaW5lbWVudHNcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIGlzTm9uRW1wdHkgPSBSTkVBLmlzTm9uRW1wdHk7XG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vLyBjb25zdHJ1Y3RvcnNcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8qKlxuICogUHJlcGVuZCBhbiBlbGVtZW50IHRvIHRoZSBmcm9udCBvZiBhIGBSZWFkb25seUFycmF5YCwgY3JlYXRpbmcgYSBuZXcgYFJlYWRvbmx5Tm9uRW1wdHlBcnJheWAuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IHByZXBlbmQgfSBmcm9tICdmcC10cy9SZWFkb25seUFycmF5J1xuICogaW1wb3J0IHsgcGlwZSB9IGZyb20gJ2ZwLXRzL2Z1bmN0aW9uJ1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwocGlwZShbMiwgMywgNF0sIHByZXBlbmQoMSkpLCBbMSwgMiwgMywgNF0pXG4gKlxuICogQHNpbmNlIDIuMTAuMFxuICovXG5leHBvcnQgdmFyIHByZXBlbmQgPSBSTkVBLnByZXBlbmQ7XG4vKipcbiAqIExlc3Mgc3RyaWN0IHZlcnNpb24gb2YgW2BwcmVwZW5kYF0oI3ByZXBlbmQpLlxuICpcbiAqIEBzaW5jZSAyLjExLjBcbiAqL1xuZXhwb3J0IHZhciBwcmVwZW5kVyA9IFJORUEucHJlcGVuZFc7XG4vKipcbiAqIEFwcGVuZCBhbiBlbGVtZW50IHRvIHRoZSBlbmQgb2YgYSBgUmVhZG9ubHlBcnJheWAsIGNyZWF0aW5nIGEgbmV3IGBSZWFkb25seU5vbkVtcHR5QXJyYXlgLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBhcHBlbmQgfSBmcm9tICdmcC10cy9SZWFkb25seUFycmF5J1xuICogaW1wb3J0IHsgcGlwZSB9IGZyb20gJ2ZwLXRzL2Z1bmN0aW9uJ1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwocGlwZShbMSwgMiwgM10sIGFwcGVuZCg0KSksIFsxLCAyLCAzLCA0XSlcbiAqXG4gKiBAc2luY2UgMi4xMC4wXG4gKi9cbmV4cG9ydCB2YXIgYXBwZW5kID0gUk5FQS5hcHBlbmQ7XG4vKipcbiAqIExlc3Mgc3RyaWN0IHZlcnNpb24gb2YgW2BhcHBlbmRgXSgjYXBwZW5kKS5cbiAqXG4gKiBAc2luY2UgMi4xMS4wXG4gKi9cbmV4cG9ydCB2YXIgYXBwZW5kVyA9IFJORUEuYXBwZW5kVztcbi8qKlxuICogUmV0dXJuIGEgYFJlYWRvbmx5QXJyYXlgIG9mIGxlbmd0aCBgbmAgd2l0aCBlbGVtZW50IGBpYCBpbml0aWFsaXplZCB3aXRoIGBmKGkpYC5cbiAqXG4gKiAqKk5vdGUqKi4gYG5gIGlzIG5vcm1hbGl6ZWQgdG8gYSBub24gbmVnYXRpdmUgaW50ZWdlci5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgbWFrZUJ5IH0gZnJvbSAnZnAtdHMvUmVhZG9ubHlBcnJheSdcbiAqXG4gKiBjb25zdCBkb3VibGUgPSAobjogbnVtYmVyKTogbnVtYmVyID0+IG4gKiAyXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKG1ha2VCeSg1LCBkb3VibGUpLCBbMCwgMiwgNCwgNiwgOF0pXG4gKlxuICogQGNhdGVnb3J5IGNvbnN0cnVjdG9yc1xuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgbWFrZUJ5ID0gZnVuY3Rpb24gKG4sIGYpIHsgcmV0dXJuIChuIDw9IDAgPyBlbXB0eSA6IFJORUEubWFrZUJ5KGYpKG4pKTsgfTtcbi8qKlxuICogQ3JlYXRlIGEgYFJlYWRvbmx5QXJyYXlgIGNvbnRhaW5pbmcgYSB2YWx1ZSByZXBlYXRlZCB0aGUgc3BlY2lmaWVkIG51bWJlciBvZiB0aW1lcy5cbiAqXG4gKiAqKk5vdGUqKi4gYG5gIGlzIG5vcm1hbGl6ZWQgdG8gYSBub24gbmVnYXRpdmUgaW50ZWdlci5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgcmVwbGljYXRlIH0gZnJvbSAnZnAtdHMvUmVhZG9ubHlBcnJheSdcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKHJlcGxpY2F0ZSgzLCAnYScpLCBbJ2EnLCAnYScsICdhJ10pXG4gKlxuICogQGNhdGVnb3J5IGNvbnN0cnVjdG9yc1xuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgcmVwbGljYXRlID0gZnVuY3Rpb24gKG4sIGEpIHsgcmV0dXJuIG1ha2VCeShuLCBmdW5jdGlvbiAoKSB7IHJldHVybiBhOyB9KTsgfTtcbmV4cG9ydCBmdW5jdGlvbiBmcm9tUHJlZGljYXRlKHByZWRpY2F0ZSkge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYSkgeyByZXR1cm4gKHByZWRpY2F0ZShhKSA/IFthXSA6IGVtcHR5KTsgfTtcbn1cbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8vIGNvbnZlcnNpb25zXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vKipcbiAqIEBjYXRlZ29yeSBjb252ZXJzaW9uc1xuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIGZyb21PcHRpb24gPSBmdW5jdGlvbiAobWEpIHsgcmV0dXJuIChfLmlzTm9uZShtYSkgPyBlbXB0eSA6IFttYS52YWx1ZV0pOyB9O1xuLyoqXG4gKiBUcmFuc2Zvcm1zIGFuIGBFaXRoZXJgIHRvIGEgYFJlYWRvbmx5QXJyYXlgLlxuICpcbiAqIEBjYXRlZ29yeSBjb252ZXJzaW9uc1xuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIGZyb21FaXRoZXIgPSBmdW5jdGlvbiAoZSkgeyByZXR1cm4gKF8uaXNMZWZ0KGUpID8gZW1wdHkgOiBbZS5yaWdodF0pOyB9O1xuLyoqXG4gKiBMZXNzIHN0cmljdCB2ZXJzaW9uIG9mIFtgbWF0Y2hgXSgjbWF0Y2gpLlxuICpcbiAqIFRoZSBgV2Agc3VmZml4IChzaG9ydCBmb3IgKipXKippZGVuaW5nKSBtZWFucyB0aGF0IHRoZSBoYW5kbGVyIHJldHVybiB0eXBlcyB3aWxsIGJlIG1lcmdlZC5cbiAqXG4gKiBAY2F0ZWdvcnkgcGF0dGVybiBtYXRjaGluZ1xuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIG1hdGNoVyA9IGZ1bmN0aW9uIChvbkVtcHR5LCBvbk5vbkVtcHR5KSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykge1xuICAgICAgICByZXR1cm4gaXNOb25FbXB0eShhcykgPyBvbk5vbkVtcHR5KGFzKSA6IG9uRW1wdHkoKTtcbiAgICB9O1xufTtcbi8qKlxuICogQGNhdGVnb3J5IHBhdHRlcm4gbWF0Y2hpbmdcbiAqIEBzaW5jZSAyLjExLjBcbiAqL1xuZXhwb3J0IHZhciBtYXRjaCA9IG1hdGNoVztcbi8qKlxuICogTGVzcyBzdHJpY3QgdmVyc2lvbiBvZiBbYG1hdGNoTGVmdGBdKCNtYXRjaGxlZnQpLlxuICpcbiAqIEBjYXRlZ29yeSBwYXR0ZXJuIG1hdGNoaW5nXG4gKiBAc2luY2UgMi4xMS4wXG4gKi9cbmV4cG9ydCB2YXIgbWF0Y2hMZWZ0VyA9IGZ1bmN0aW9uIChvbkVtcHR5LCBvbk5vbkVtcHR5KSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykge1xuICAgICAgICByZXR1cm4gaXNOb25FbXB0eShhcykgPyBvbk5vbkVtcHR5KFJORUEuaGVhZChhcyksIFJORUEudGFpbChhcykpIDogb25FbXB0eSgpO1xuICAgIH07XG59O1xuLyoqXG4gKiBCcmVhayBhIGBSZWFkb25seUFycmF5YCBpbnRvIGl0cyBmaXJzdCBlbGVtZW50IGFuZCByZW1haW5pbmcgZWxlbWVudHMuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IG1hdGNoTGVmdCB9IGZyb20gJ2ZwLXRzL1JlYWRvbmx5QXJyYXknXG4gKlxuICogY29uc3QgbGVuOiA8QT4oYXM6IFJlYWRvbmx5QXJyYXk8QT4pID0+IG51bWJlciA9IG1hdGNoTGVmdCgoKSA9PiAwLCAoXywgdGFpbCkgPT4gMSArIGxlbih0YWlsKSlcbiAqIGFzc2VydC5zdHJpY3RFcXVhbChsZW4oWzEsIDIsIDNdKSwgMylcbiAqXG4gKiBAY2F0ZWdvcnkgcGF0dGVybiBtYXRjaGluZ1xuICogQHNpbmNlIDIuMTAuMFxuICovXG5leHBvcnQgdmFyIG1hdGNoTGVmdCA9IG1hdGNoTGVmdFc7XG4vKipcbiAqIEFsaWFzIG9mIFtgbWF0Y2hMZWZ0YF0oI21hdGNobGVmdCkuXG4gKlxuICogQGNhdGVnb3J5IHBhdHRlcm4gbWF0Y2hpbmdcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIGZvbGRMZWZ0ID0gbWF0Y2hMZWZ0O1xuLyoqXG4gKiBMZXNzIHN0cmljdCB2ZXJzaW9uIG9mIFtgbWF0Y2hSaWdodGBdKCNtYXRjaHJpZ2h0KS5cbiAqXG4gKiBAY2F0ZWdvcnkgcGF0dGVybiBtYXRjaGluZ1xuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIG1hdGNoUmlnaHRXID0gZnVuY3Rpb24gKG9uRW1wdHksIG9uTm9uRW1wdHkpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIHJldHVybiBpc05vbkVtcHR5KGFzKSA/IG9uTm9uRW1wdHkoUk5FQS5pbml0KGFzKSwgUk5FQS5sYXN0KGFzKSkgOiBvbkVtcHR5KCk7XG4gICAgfTtcbn07XG4vKipcbiAqIEJyZWFrIGEgYFJlYWRvbmx5QXJyYXlgIGludG8gaXRzIGluaXRpYWwgZWxlbWVudHMgYW5kIHRoZSBsYXN0IGVsZW1lbnQuXG4gKlxuICogQGNhdGVnb3J5IHBhdHRlcm4gbWF0Y2hpbmdcbiAqIEBzaW5jZSAyLjEwLjBcbiAqL1xuZXhwb3J0IHZhciBtYXRjaFJpZ2h0ID0gbWF0Y2hSaWdodFc7XG4vKipcbiAqIEFsaWFzIG9mIFtgbWF0Y2hSaWdodGBdKCNtYXRjaHJpZ2h0KS5cbiAqXG4gKiBAY2F0ZWdvcnkgcGF0dGVybiBtYXRjaGluZ1xuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgZm9sZFJpZ2h0ID0gbWF0Y2hSaWdodDtcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8vIGNvbWJpbmF0b3JzXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vKipcbiAqIEBjYXRlZ29yeSBzZXF1ZW5jaW5nXG4gKiBAc2luY2UgMi43LjBcbiAqL1xuZXhwb3J0IHZhciBjaGFpbldpdGhJbmRleCA9IGZ1bmN0aW9uIChmKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykge1xuICAgICAgICBpZiAoaXNFbXB0eShhcykpIHtcbiAgICAgICAgICAgIHJldHVybiBlbXB0eTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgb3V0ID0gW107XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgYXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIG91dC5wdXNoLmFwcGx5KG91dCwgZihpLCBhc1tpXSkpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBvdXQ7XG4gICAgfTtcbn07XG4vKipcbiAqIFNhbWUgYXMgYHJlZHVjZWAgYnV0IGl0IGNhcnJpZXMgb3ZlciB0aGUgaW50ZXJtZWRpYXRlIHN0ZXBzLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBzY2FuTGVmdCB9IGZyb20gJ2ZwLXRzL1JlYWRvbmx5QXJyYXknXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChzY2FuTGVmdCgxMCwgKGIsIGE6IG51bWJlcikgPT4gYiAtIGEpKFsxLCAyLCAzXSksIFsxMCwgOSwgNywgNF0pXG4gKlxuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgc2NhbkxlZnQgPSBmdW5jdGlvbiAoYiwgZikge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgdmFyIGxlbiA9IGFzLmxlbmd0aDtcbiAgICAgICAgdmFyIG91dCA9IG5ldyBBcnJheShsZW4gKyAxKTtcbiAgICAgICAgb3V0WzBdID0gYjtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBsZW47IGkrKykge1xuICAgICAgICAgICAgb3V0W2kgKyAxXSA9IGYob3V0W2ldLCBhc1tpXSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG91dDtcbiAgICB9O1xufTtcbi8qKlxuICogRm9sZCBhbiBhcnJheSBmcm9tIHRoZSByaWdodCwga2VlcGluZyBhbGwgaW50ZXJtZWRpYXRlIHJlc3VsdHMgaW5zdGVhZCBvZiBvbmx5IHRoZSBmaW5hbCByZXN1bHRcbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgc2NhblJpZ2h0IH0gZnJvbSAnZnAtdHMvUmVhZG9ubHlBcnJheSdcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKHNjYW5SaWdodCgxMCwgKGE6IG51bWJlciwgYikgPT4gYiAtIGEpKFsxLCAyLCAzXSksIFs0LCA1LCA3LCAxMF0pXG4gKlxuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgc2NhblJpZ2h0ID0gZnVuY3Rpb24gKGIsIGYpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIHZhciBsZW4gPSBhcy5sZW5ndGg7XG4gICAgICAgIHZhciBvdXQgPSBuZXcgQXJyYXkobGVuICsgMSk7XG4gICAgICAgIG91dFtsZW5dID0gYjtcbiAgICAgICAgZm9yICh2YXIgaSA9IGxlbiAtIDE7IGkgPj0gMDsgaS0tKSB7XG4gICAgICAgICAgICBvdXRbaV0gPSBmKGFzW2ldLCBvdXRbaSArIDFdKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gb3V0O1xuICAgIH07XG59O1xuLyoqXG4gKiBDYWxjdWxhdGUgdGhlIG51bWJlciBvZiBlbGVtZW50cyBpbiBhIGBSZWFkb25seUFycmF5YC5cbiAqXG4gKiBAc2luY2UgMi4xMC4wXG4gKi9cbmV4cG9ydCB2YXIgc2l6ZSA9IGZ1bmN0aW9uIChhcykgeyByZXR1cm4gYXMubGVuZ3RoOyB9O1xuLyoqXG4gKiBUZXN0IHdoZXRoZXIgYW4gYXJyYXkgY29udGFpbnMgYSBwYXJ0aWN1bGFyIGluZGV4XG4gKlxuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgaXNPdXRPZkJvdW5kID0gUk5FQS5pc091dE9mQm91bmQ7XG5leHBvcnQgZnVuY3Rpb24gbG9va3VwKGksIGFzKSB7XG4gICAgcmV0dXJuIGFzID09PSB1bmRlZmluZWQgPyBmdW5jdGlvbiAoYXMpIHsgcmV0dXJuIGxvb2t1cChpLCBhcyk7IH0gOiBpc091dE9mQm91bmQoaSwgYXMpID8gXy5ub25lIDogXy5zb21lKGFzW2ldKTtcbn1cbi8qKlxuICogR2V0IHRoZSBmaXJzdCBlbGVtZW50IGluIGFuIGFycmF5LCBvciBgTm9uZWAgaWYgdGhlIGFycmF5IGlzIGVtcHR5XG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IGhlYWQgfSBmcm9tICdmcC10cy9SZWFkb25seUFycmF5J1xuICogaW1wb3J0IHsgc29tZSwgbm9uZSB9IGZyb20gJ2ZwLXRzL09wdGlvbidcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKGhlYWQoWzEsIDIsIDNdKSwgc29tZSgxKSlcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoaGVhZChbXSksIG5vbmUpXG4gKlxuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgaGVhZCA9IGZ1bmN0aW9uIChhcykgeyByZXR1cm4gKGlzTm9uRW1wdHkoYXMpID8gXy5zb21lKFJORUEuaGVhZChhcykpIDogXy5ub25lKTsgfTtcbi8qKlxuICogR2V0IHRoZSBsYXN0IGVsZW1lbnQgaW4gYW4gYXJyYXksIG9yIGBOb25lYCBpZiB0aGUgYXJyYXkgaXMgZW1wdHlcbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgbGFzdCB9IGZyb20gJ2ZwLXRzL1JlYWRvbmx5QXJyYXknXG4gKiBpbXBvcnQgeyBzb21lLCBub25lIH0gZnJvbSAnZnAtdHMvT3B0aW9uJ1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwobGFzdChbMSwgMiwgM10pLCBzb21lKDMpKVxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChsYXN0KFtdKSwgbm9uZSlcbiAqXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBsYXN0ID0gZnVuY3Rpb24gKGFzKSB7IHJldHVybiAoaXNOb25FbXB0eShhcykgPyBfLnNvbWUoUk5FQS5sYXN0KGFzKSkgOiBfLm5vbmUpOyB9O1xuLyoqXG4gKiBHZXQgYWxsIGJ1dCB0aGUgZmlyc3QgZWxlbWVudCBvZiBhbiBhcnJheSwgY3JlYXRpbmcgYSBuZXcgYXJyYXksIG9yIGBOb25lYCBpZiB0aGUgYXJyYXkgaXMgZW1wdHlcbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgdGFpbCB9IGZyb20gJ2ZwLXRzL1JlYWRvbmx5QXJyYXknXG4gKiBpbXBvcnQgeyBzb21lLCBub25lIH0gZnJvbSAnZnAtdHMvT3B0aW9uJ1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwodGFpbChbMSwgMiwgM10pLCBzb21lKFsyLCAzXSkpXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKHRhaWwoW10pLCBub25lKVxuICpcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIHRhaWwgPSBmdW5jdGlvbiAoYXMpIHtcbiAgICByZXR1cm4gaXNOb25FbXB0eShhcykgPyBfLnNvbWUoUk5FQS50YWlsKGFzKSkgOiBfLm5vbmU7XG59O1xuLyoqXG4gKiBHZXQgYWxsIGJ1dCB0aGUgbGFzdCBlbGVtZW50IG9mIGFuIGFycmF5LCBjcmVhdGluZyBhIG5ldyBhcnJheSwgb3IgYE5vbmVgIGlmIHRoZSBhcnJheSBpcyBlbXB0eVxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBpbml0IH0gZnJvbSAnZnAtdHMvUmVhZG9ubHlBcnJheSdcbiAqIGltcG9ydCB7IHNvbWUsIG5vbmUgfSBmcm9tICdmcC10cy9PcHRpb24nXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChpbml0KFsxLCAyLCAzXSksIHNvbWUoWzEsIDJdKSlcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoaW5pdChbXSksIG5vbmUpXG4gKlxuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgaW5pdCA9IGZ1bmN0aW9uIChhcykge1xuICAgIHJldHVybiBpc05vbkVtcHR5KGFzKSA/IF8uc29tZShSTkVBLmluaXQoYXMpKSA6IF8ubm9uZTtcbn07XG4vKipcbiAqIEtlZXAgb25seSBhIG1heCBudW1iZXIgb2YgZWxlbWVudHMgZnJvbSB0aGUgc3RhcnQgb2YgYW4gYFJlYWRvbmx5QXJyYXlgLCBjcmVhdGluZyBhIG5ldyBgUmVhZG9ubHlBcnJheWAuXG4gKlxuICogKipOb3RlKiouIGBuYCBpcyBub3JtYWxpemVkIHRvIGEgbm9uIG5lZ2F0aXZlIGludGVnZXIuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCAqIGFzIFJBIGZyb20gJ2ZwLXRzL1JlYWRvbmx5QXJyYXknXG4gKiBpbXBvcnQgeyBwaXBlIH0gZnJvbSAnZnAtdHMvZnVuY3Rpb24nXG4gKlxuICogY29uc3QgaW5wdXQ6IFJlYWRvbmx5QXJyYXk8bnVtYmVyPiA9IFsxLCAyLCAzXVxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChwaXBlKGlucHV0LCBSQS50YWtlTGVmdCgyKSksIFsxLCAyXSlcbiAqXG4gKiAvLyBvdXQgb2YgYm91bmRzXG4gKiBhc3NlcnQuc3RyaWN0RXF1YWwocGlwZShpbnB1dCwgUkEudGFrZUxlZnQoNCkpLCBpbnB1dClcbiAqIGFzc2VydC5zdHJpY3RFcXVhbChwaXBlKGlucHV0LCBSQS50YWtlTGVmdCgtMSkpLCBpbnB1dClcbiAqXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciB0YWtlTGVmdCA9IGZ1bmN0aW9uIChuKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykge1xuICAgICAgICByZXR1cm4gaXNPdXRPZkJvdW5kKG4sIGFzKSA/IGFzIDogbiA9PT0gMCA/IGVtcHR5IDogYXMuc2xpY2UoMCwgbik7XG4gICAgfTtcbn07XG4vKipcbiAqIEtlZXAgb25seSBhIG1heCBudW1iZXIgb2YgZWxlbWVudHMgZnJvbSB0aGUgZW5kIG9mIGFuIGBSZWFkb25seUFycmF5YCwgY3JlYXRpbmcgYSBuZXcgYFJlYWRvbmx5QXJyYXlgLlxuICpcbiAqICoqTm90ZSoqLiBgbmAgaXMgbm9ybWFsaXplZCB0byBhIG5vbiBuZWdhdGl2ZSBpbnRlZ2VyLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgKiBhcyBSQSBmcm9tICdmcC10cy9SZWFkb25seUFycmF5J1xuICogaW1wb3J0IHsgcGlwZSB9IGZyb20gJ2ZwLXRzL2Z1bmN0aW9uJ1xuICpcbiAqIGNvbnN0IGlucHV0OiBSZWFkb25seUFycmF5PG51bWJlcj4gPSBbMSwgMiwgM11cbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwocGlwZShpbnB1dCwgUkEudGFrZVJpZ2h0KDIpKSwgWzIsIDNdKVxuICpcbiAqIC8vIG91dCBvZiBib3VuZHNcbiAqIGFzc2VydC5zdHJpY3RFcXVhbChwaXBlKGlucHV0LCBSQS50YWtlUmlnaHQoNCkpLCBpbnB1dClcbiAqIGFzc2VydC5zdHJpY3RFcXVhbChwaXBlKGlucHV0LCBSQS50YWtlUmlnaHQoLTEpKSwgaW5wdXQpXG4gKlxuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgdGFrZVJpZ2h0ID0gZnVuY3Rpb24gKG4pIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIHJldHVybiBpc091dE9mQm91bmQobiwgYXMpID8gYXMgOiBuID09PSAwID8gZW1wdHkgOiBhcy5zbGljZSgtbik7XG4gICAgfTtcbn07XG5leHBvcnQgZnVuY3Rpb24gdGFrZUxlZnRXaGlsZShwcmVkaWNhdGUpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIHZhciBvdXQgPSBbXTtcbiAgICAgICAgZm9yICh2YXIgX2kgPSAwLCBhc18xID0gYXM7IF9pIDwgYXNfMS5sZW5ndGg7IF9pKyspIHtcbiAgICAgICAgICAgIHZhciBhID0gYXNfMVtfaV07XG4gICAgICAgICAgICBpZiAoIXByZWRpY2F0ZShhKSkge1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgb3V0LnB1c2goYSk7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGxlbiA9IG91dC5sZW5ndGg7XG4gICAgICAgIHJldHVybiBsZW4gPT09IGFzLmxlbmd0aCA/IGFzIDogbGVuID09PSAwID8gZW1wdHkgOiBvdXQ7XG4gICAgfTtcbn1cbnZhciBzcGFuTGVmdEluZGV4ID0gZnVuY3Rpb24gKGFzLCBwcmVkaWNhdGUpIHtcbiAgICB2YXIgbCA9IGFzLmxlbmd0aDtcbiAgICB2YXIgaSA9IDA7XG4gICAgZm9yICg7IGkgPCBsOyBpKyspIHtcbiAgICAgICAgaWYgKCFwcmVkaWNhdGUoYXNbaV0pKSB7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gaTtcbn07XG5leHBvcnQgZnVuY3Rpb24gc3BhbkxlZnQocHJlZGljYXRlKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykge1xuICAgICAgICB2YXIgX2EgPSBzcGxpdEF0KHNwYW5MZWZ0SW5kZXgoYXMsIHByZWRpY2F0ZSkpKGFzKSwgaW5pdCA9IF9hWzBdLCByZXN0ID0gX2FbMV07XG4gICAgICAgIHJldHVybiB7IGluaXQ6IGluaXQsIHJlc3Q6IHJlc3QgfTtcbiAgICB9O1xufVxuLyoqXG4gKiBEcm9wIGEgbWF4IG51bWJlciBvZiBlbGVtZW50cyBmcm9tIHRoZSBzdGFydCBvZiBhbiBgUmVhZG9ubHlBcnJheWAsIGNyZWF0aW5nIGEgbmV3IGBSZWFkb25seUFycmF5YC5cbiAqXG4gKiAqKk5vdGUqKi4gYG5gIGlzIG5vcm1hbGl6ZWQgdG8gYSBub24gbmVnYXRpdmUgaW50ZWdlci5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0ICogYXMgUkEgZnJvbSAnZnAtdHMvUmVhZG9ubHlBcnJheSdcbiAqIGltcG9ydCB7IHBpcGUgfSBmcm9tICdmcC10cy9mdW5jdGlvbidcbiAqXG4gKiBjb25zdCBpbnB1dDogUmVhZG9ubHlBcnJheTxudW1iZXI+ID0gWzEsIDIsIDNdXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKHBpcGUoaW5wdXQsIFJBLmRyb3BMZWZ0KDIpKSwgWzNdKVxuICogYXNzZXJ0LnN0cmljdEVxdWFsKHBpcGUoaW5wdXQsIFJBLmRyb3BMZWZ0KDApKSwgaW5wdXQpXG4gKiBhc3NlcnQuc3RyaWN0RXF1YWwocGlwZShpbnB1dCwgUkEuZHJvcExlZnQoLTEpKSwgaW5wdXQpXG4gKlxuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgZHJvcExlZnQgPSBmdW5jdGlvbiAobikge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgcmV0dXJuIG4gPD0gMCB8fCBpc0VtcHR5KGFzKSA/IGFzIDogbiA+PSBhcy5sZW5ndGggPyBlbXB0eSA6IGFzLnNsaWNlKG4sIGFzLmxlbmd0aCk7XG4gICAgfTtcbn07XG4vKipcbiAqIERyb3AgYSBtYXggbnVtYmVyIG9mIGVsZW1lbnRzIGZyb20gdGhlIGVuZCBvZiBhbiBgUmVhZG9ubHlBcnJheWAsIGNyZWF0aW5nIGEgbmV3IGBSZWFkb25seUFycmF5YC5cbiAqXG4gKiAqKk5vdGUqKi4gYG5gIGlzIG5vcm1hbGl6ZWQgdG8gYSBub24gbmVnYXRpdmUgaW50ZWdlci5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0ICogYXMgUkEgZnJvbSAnZnAtdHMvUmVhZG9ubHlBcnJheSdcbiAqIGltcG9ydCB7IHBpcGUgfSBmcm9tICdmcC10cy9mdW5jdGlvbidcbiAqXG4gKiBjb25zdCBpbnB1dDogUmVhZG9ubHlBcnJheTxudW1iZXI+ID0gWzEsIDIsIDNdXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKHBpcGUoaW5wdXQsIFJBLmRyb3BSaWdodCgyKSksIFsxXSlcbiAqIGFzc2VydC5zdHJpY3RFcXVhbChwaXBlKGlucHV0LCBSQS5kcm9wUmlnaHQoMCkpLCBpbnB1dClcbiAqIGFzc2VydC5zdHJpY3RFcXVhbChwaXBlKGlucHV0LCBSQS5kcm9wUmlnaHQoLTEpKSwgaW5wdXQpXG4gKlxuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgZHJvcFJpZ2h0ID0gZnVuY3Rpb24gKG4pIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIHJldHVybiBuIDw9IDAgfHwgaXNFbXB0eShhcykgPyBhcyA6IG4gPj0gYXMubGVuZ3RoID8gZW1wdHkgOiBhcy5zbGljZSgwLCBhcy5sZW5ndGggLSBuKTtcbiAgICB9O1xufTtcbmV4cG9ydCBmdW5jdGlvbiBkcm9wTGVmdFdoaWxlKHByZWRpY2F0ZSkge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgdmFyIGkgPSBzcGFuTGVmdEluZGV4KGFzLCBwcmVkaWNhdGUpO1xuICAgICAgICByZXR1cm4gaSA9PT0gMCA/IGFzIDogaSA9PT0gYXMubGVuZ3RoID8gZW1wdHkgOiBhcy5zbGljZShpKTtcbiAgICB9O1xufVxuLyoqXG4gKiBGaW5kIHRoZSBmaXJzdCBpbmRleCBmb3Igd2hpY2ggYSBwcmVkaWNhdGUgaG9sZHNcbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgZmluZEluZGV4IH0gZnJvbSAnZnAtdHMvUmVhZG9ubHlBcnJheSdcbiAqIGltcG9ydCB7IHNvbWUsIG5vbmUgfSBmcm9tICdmcC10cy9PcHRpb24nXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChmaW5kSW5kZXgoKG46IG51bWJlcikgPT4gbiA9PT0gMikoWzEsIDIsIDNdKSwgc29tZSgxKSlcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoZmluZEluZGV4KChuOiBudW1iZXIpID0+IG4gPT09IDIpKFtdKSwgbm9uZSlcbiAqXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBmaW5kSW5kZXggPSBmdW5jdGlvbiAocHJlZGljYXRlKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykge1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGFzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICBpZiAocHJlZGljYXRlKGFzW2ldKSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBfLnNvbWUoaSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIF8ubm9uZTtcbiAgICB9O1xufTtcbmV4cG9ydCBmdW5jdGlvbiBmaW5kRmlyc3QocHJlZGljYXRlKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykge1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGFzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICBpZiAocHJlZGljYXRlKGFzW2ldKSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBfLnNvbWUoYXNbaV0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBfLm5vbmU7XG4gICAgfTtcbn1cbi8qKlxuICogRmluZCB0aGUgZmlyc3QgZWxlbWVudCByZXR1cm5lZCBieSBhbiBvcHRpb24gYmFzZWQgc2VsZWN0b3IgZnVuY3Rpb25cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgZmluZEZpcnN0TWFwIH0gZnJvbSAnZnAtdHMvUmVhZG9ubHlBcnJheSdcbiAqIGltcG9ydCB7IHNvbWUsIG5vbmUgfSBmcm9tICdmcC10cy9PcHRpb24nXG4gKlxuICogaW50ZXJmYWNlIFBlcnNvbiB7XG4gKiAgIHJlYWRvbmx5IG5hbWU6IHN0cmluZ1xuICogICByZWFkb25seSBhZ2U/OiBudW1iZXJcbiAqIH1cbiAqXG4gKiBjb25zdCBwZXJzb25zOiBSZWFkb25seUFycmF5PFBlcnNvbj4gPSBbeyBuYW1lOiAnSm9obicgfSwgeyBuYW1lOiAnTWFyeScsIGFnZTogNDUgfSwgeyBuYW1lOiAnSm9leScsIGFnZTogMjggfV1cbiAqXG4gKiAvLyByZXR1cm5zIHRoZSBuYW1lIG9mIHRoZSBmaXJzdCBwZXJzb24gdGhhdCBoYXMgYW4gYWdlXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKGZpbmRGaXJzdE1hcCgocDogUGVyc29uKSA9PiAocC5hZ2UgPT09IHVuZGVmaW5lZCA/IG5vbmUgOiBzb21lKHAubmFtZSkpKShwZXJzb25zKSwgc29tZSgnTWFyeScpKVxuICpcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIGZpbmRGaXJzdE1hcCA9IGZ1bmN0aW9uIChmKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykge1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGFzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICB2YXIgb3V0ID0gZihhc1tpXSk7XG4gICAgICAgICAgICBpZiAoXy5pc1NvbWUob3V0KSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBvdXQ7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIF8ubm9uZTtcbiAgICB9O1xufTtcbmV4cG9ydCBmdW5jdGlvbiBmaW5kTGFzdChwcmVkaWNhdGUpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIGZvciAodmFyIGkgPSBhcy5sZW5ndGggLSAxOyBpID49IDA7IGktLSkge1xuICAgICAgICAgICAgaWYgKHByZWRpY2F0ZShhc1tpXSkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gXy5zb21lKGFzW2ldKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gXy5ub25lO1xuICAgIH07XG59XG4vKipcbiAqIEZpbmQgdGhlIGxhc3QgZWxlbWVudCByZXR1cm5lZCBieSBhbiBvcHRpb24gYmFzZWQgc2VsZWN0b3IgZnVuY3Rpb25cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgZmluZExhc3RNYXAgfSBmcm9tICdmcC10cy9SZWFkb25seUFycmF5J1xuICogaW1wb3J0IHsgc29tZSwgbm9uZSB9IGZyb20gJ2ZwLXRzL09wdGlvbidcbiAqXG4gKiBpbnRlcmZhY2UgUGVyc29uIHtcbiAqICAgcmVhZG9ubHkgbmFtZTogc3RyaW5nXG4gKiAgIHJlYWRvbmx5IGFnZT86IG51bWJlclxuICogfVxuICpcbiAqIGNvbnN0IHBlcnNvbnM6IFJlYWRvbmx5QXJyYXk8UGVyc29uPiA9IFt7IG5hbWU6ICdKb2huJyB9LCB7IG5hbWU6ICdNYXJ5JywgYWdlOiA0NSB9LCB7IG5hbWU6ICdKb2V5JywgYWdlOiAyOCB9XVxuICpcbiAqIC8vIHJldHVybnMgdGhlIG5hbWUgb2YgdGhlIGxhc3QgcGVyc29uIHRoYXQgaGFzIGFuIGFnZVxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChmaW5kTGFzdE1hcCgocDogUGVyc29uKSA9PiAocC5hZ2UgPT09IHVuZGVmaW5lZCA/IG5vbmUgOiBzb21lKHAubmFtZSkpKShwZXJzb25zKSwgc29tZSgnSm9leScpKVxuICpcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIGZpbmRMYXN0TWFwID0gZnVuY3Rpb24gKGYpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIGZvciAodmFyIGkgPSBhcy5sZW5ndGggLSAxOyBpID49IDA7IGktLSkge1xuICAgICAgICAgICAgdmFyIG91dCA9IGYoYXNbaV0pO1xuICAgICAgICAgICAgaWYgKF8uaXNTb21lKG91dCkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gb3V0O1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBfLm5vbmU7XG4gICAgfTtcbn07XG4vKipcbiAqIFJldHVybnMgdGhlIGluZGV4IG9mIHRoZSBsYXN0IGVsZW1lbnQgb2YgdGhlIGxpc3Qgd2hpY2ggbWF0Y2hlcyB0aGUgcHJlZGljYXRlXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IGZpbmRMYXN0SW5kZXggfSBmcm9tICdmcC10cy9SZWFkb25seUFycmF5J1xuICogaW1wb3J0IHsgc29tZSwgbm9uZSB9IGZyb20gJ2ZwLXRzL09wdGlvbidcbiAqXG4gKiBpbnRlcmZhY2UgWCB7XG4gKiAgIHJlYWRvbmx5IGE6IG51bWJlclxuICogICByZWFkb25seSBiOiBudW1iZXJcbiAqIH1cbiAqIGNvbnN0IHhzOiBSZWFkb25seUFycmF5PFg+ID0gW3sgYTogMSwgYjogMCB9LCB7IGE6IDEsIGI6IDEgfV1cbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoZmluZExhc3RJbmRleCgoeDogeyByZWFkb25seSBhOiBudW1iZXIgfSkgPT4geC5hID09PSAxKSh4cyksIHNvbWUoMSkpXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKGZpbmRMYXN0SW5kZXgoKHg6IHsgcmVhZG9ubHkgYTogbnVtYmVyIH0pID0+IHguYSA9PT0gNCkoeHMpLCBub25lKVxuICpcbiAqXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBmaW5kTGFzdEluZGV4ID0gZnVuY3Rpb24gKHByZWRpY2F0ZSkge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgZm9yICh2YXIgaSA9IGFzLmxlbmd0aCAtIDE7IGkgPj0gMDsgaS0tKSB7XG4gICAgICAgICAgICBpZiAocHJlZGljYXRlKGFzW2ldKSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBfLnNvbWUoaSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIF8ubm9uZTtcbiAgICB9O1xufTtcbi8qKlxuICogSW5zZXJ0IGFuIGVsZW1lbnQgYXQgdGhlIHNwZWNpZmllZCBpbmRleCwgY3JlYXRpbmcgYSBuZXcgYXJyYXksIG9yIHJldHVybmluZyBgTm9uZWAgaWYgdGhlIGluZGV4IGlzIG91dCBvZiBib3VuZHNcbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgaW5zZXJ0QXQgfSBmcm9tICdmcC10cy9SZWFkb25seUFycmF5J1xuICogaW1wb3J0IHsgc29tZSB9IGZyb20gJ2ZwLXRzL09wdGlvbidcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKGluc2VydEF0KDIsIDUpKFsxLCAyLCAzLCA0XSksIHNvbWUoWzEsIDIsIDUsIDMsIDRdKSlcbiAqXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBpbnNlcnRBdCA9IGZ1bmN0aW9uIChpLCBhKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykge1xuICAgICAgICByZXR1cm4gaSA8IDAgfHwgaSA+IGFzLmxlbmd0aCA/IF8ubm9uZSA6IF8uc29tZShSTkVBLnVuc2FmZUluc2VydEF0KGksIGEsIGFzKSk7XG4gICAgfTtcbn07XG4vKipcbiAqIENoYW5nZSB0aGUgZWxlbWVudCBhdCB0aGUgc3BlY2lmaWVkIGluZGV4LCBjcmVhdGluZyBhIG5ldyBhcnJheSwgb3IgcmV0dXJuaW5nIGBOb25lYCBpZiB0aGUgaW5kZXggaXMgb3V0IG9mIGJvdW5kc1xuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyB1cGRhdGVBdCB9IGZyb20gJ2ZwLXRzL1JlYWRvbmx5QXJyYXknXG4gKiBpbXBvcnQgeyBzb21lLCBub25lIH0gZnJvbSAnZnAtdHMvT3B0aW9uJ1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwodXBkYXRlQXQoMSwgMSkoWzEsIDIsIDNdKSwgc29tZShbMSwgMSwgM10pKVxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbCh1cGRhdGVBdCgxLCAxKShbXSksIG5vbmUpXG4gKlxuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgdXBkYXRlQXQgPSBmdW5jdGlvbiAoaSwgYSkge1xuICAgIHJldHVybiBtb2RpZnlBdChpLCBmdW5jdGlvbiAoKSB7IHJldHVybiBhOyB9KTtcbn07XG4vKipcbiAqIERlbGV0ZSB0aGUgZWxlbWVudCBhdCB0aGUgc3BlY2lmaWVkIGluZGV4LCBjcmVhdGluZyBhIG5ldyBhcnJheSwgb3IgcmV0dXJuaW5nIGBOb25lYCBpZiB0aGUgaW5kZXggaXMgb3V0IG9mIGJvdW5kc1xuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBkZWxldGVBdCB9IGZyb20gJ2ZwLXRzL1JlYWRvbmx5QXJyYXknXG4gKiBpbXBvcnQgeyBzb21lLCBub25lIH0gZnJvbSAnZnAtdHMvT3B0aW9uJ1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoZGVsZXRlQXQoMCkoWzEsIDIsIDNdKSwgc29tZShbMiwgM10pKVxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChkZWxldGVBdCgxKShbXSksIG5vbmUpXG4gKlxuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgZGVsZXRlQXQgPSBmdW5jdGlvbiAoaSkge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgcmV0dXJuIGlzT3V0T2ZCb3VuZChpLCBhcykgPyBfLm5vbmUgOiBfLnNvbWUodW5zYWZlRGVsZXRlQXQoaSwgYXMpKTtcbiAgICB9O1xufTtcbi8qKlxuICogQXBwbHkgYSBmdW5jdGlvbiB0byB0aGUgZWxlbWVudCBhdCB0aGUgc3BlY2lmaWVkIGluZGV4LCBjcmVhdGluZyBhIG5ldyBhcnJheSwgb3IgcmV0dXJuaW5nIGBOb25lYCBpZiB0aGUgaW5kZXggaXMgb3V0XG4gKiBvZiBib3VuZHNcbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgbW9kaWZ5QXQgfSBmcm9tICdmcC10cy9SZWFkb25seUFycmF5J1xuICogaW1wb3J0IHsgc29tZSwgbm9uZSB9IGZyb20gJ2ZwLXRzL09wdGlvbidcbiAqXG4gKiBjb25zdCBkb3VibGUgPSAoeDogbnVtYmVyKTogbnVtYmVyID0+IHggKiAyXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKG1vZGlmeUF0KDEsIGRvdWJsZSkoWzEsIDIsIDNdKSwgc29tZShbMSwgNCwgM10pKVxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChtb2RpZnlBdCgxLCBkb3VibGUpKFtdKSwgbm9uZSlcbiAqXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBtb2RpZnlBdCA9IGZ1bmN0aW9uIChpLCBmKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykge1xuICAgICAgICByZXR1cm4gaXNPdXRPZkJvdW5kKGksIGFzKSA/IF8ubm9uZSA6IF8uc29tZSh1bnNhZmVVcGRhdGVBdChpLCBmKGFzW2ldKSwgYXMpKTtcbiAgICB9O1xufTtcbi8qKlxuICogUmV2ZXJzZSBhbiBhcnJheSwgY3JlYXRpbmcgYSBuZXcgYXJyYXlcbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgcmV2ZXJzZSB9IGZyb20gJ2ZwLXRzL1JlYWRvbmx5QXJyYXknXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChyZXZlcnNlKFsxLCAyLCAzXSksIFszLCAyLCAxXSlcbiAqXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciByZXZlcnNlID0gZnVuY3Rpb24gKGFzKSB7IHJldHVybiAoYXMubGVuZ3RoIDw9IDEgPyBhcyA6IGFzLnNsaWNlKCkucmV2ZXJzZSgpKTsgfTtcbi8qKlxuICogRXh0cmFjdHMgZnJvbSBhbiBhcnJheSBvZiBgRWl0aGVyYCBhbGwgdGhlIGBSaWdodGAgZWxlbWVudHMuIEFsbCB0aGUgYFJpZ2h0YCBlbGVtZW50cyBhcmUgZXh0cmFjdGVkIGluIG9yZGVyXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IHJpZ2h0cyB9IGZyb20gJ2ZwLXRzL1JlYWRvbmx5QXJyYXknXG4gKiBpbXBvcnQgeyByaWdodCwgbGVmdCB9IGZyb20gJ2ZwLXRzL0VpdGhlcidcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKHJpZ2h0cyhbcmlnaHQoMSksIGxlZnQoJ2ZvbycpLCByaWdodCgyKV0pLCBbMSwgMl0pXG4gKlxuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgcmlnaHRzID0gZnVuY3Rpb24gKGFzKSB7XG4gICAgdmFyIHIgPSBbXTtcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IGFzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIHZhciBhID0gYXNbaV07XG4gICAgICAgIGlmIChhLl90YWcgPT09ICdSaWdodCcpIHtcbiAgICAgICAgICAgIHIucHVzaChhLnJpZ2h0KTtcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gcjtcbn07XG4vKipcbiAqIEV4dHJhY3RzIGZyb20gYW4gYXJyYXkgb2YgYEVpdGhlcmAgYWxsIHRoZSBgTGVmdGAgZWxlbWVudHMuIEFsbCB0aGUgYExlZnRgIGVsZW1lbnRzIGFyZSBleHRyYWN0ZWQgaW4gb3JkZXJcbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgbGVmdHMgfSBmcm9tICdmcC10cy9SZWFkb25seUFycmF5J1xuICogaW1wb3J0IHsgbGVmdCwgcmlnaHQgfSBmcm9tICdmcC10cy9FaXRoZXInXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChsZWZ0cyhbcmlnaHQoMSksIGxlZnQoJ2ZvbycpLCByaWdodCgyKV0pLCBbJ2ZvbyddKVxuICpcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIGxlZnRzID0gZnVuY3Rpb24gKGFzKSB7XG4gICAgdmFyIHIgPSBbXTtcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IGFzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIHZhciBhID0gYXNbaV07XG4gICAgICAgIGlmIChhLl90YWcgPT09ICdMZWZ0Jykge1xuICAgICAgICAgICAgci5wdXNoKGEubGVmdCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHI7XG59O1xuLyoqXG4gKiBTb3J0IHRoZSBlbGVtZW50cyBvZiBhbiBhcnJheSBpbiBpbmNyZWFzaW5nIG9yZGVyLCBjcmVhdGluZyBhIG5ldyBhcnJheVxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBzb3J0IH0gZnJvbSAnZnAtdHMvUmVhZG9ubHlBcnJheSdcbiAqIGltcG9ydCAqIGFzIE4gZnJvbSAnZnAtdHMvbnVtYmVyJ1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoc29ydChOLk9yZCkoWzMsIDIsIDFdKSwgWzEsIDIsIDNdKVxuICpcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIHNvcnQgPSBmdW5jdGlvbiAoTykge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgcmV0dXJuIGFzLmxlbmd0aCA8PSAxID8gYXMgOiBhcy5zbGljZSgpLnNvcnQoTy5jb21wYXJlKTtcbiAgICB9O1xufTtcbi8vIFRPRE86IGN1cnJ5IGFuZCBtYWtlIGRhdGEtbGFzdCBpbiB2M1xuLyoqXG4gKiBBcHBseSBhIGZ1bmN0aW9uIHRvIHBhaXJzIG9mIGVsZW1lbnRzIGF0IHRoZSBzYW1lIGluZGV4IGluIHR3byBhcnJheXMsIGNvbGxlY3RpbmcgdGhlIHJlc3VsdHMgaW4gYSBuZXcgYXJyYXkuIElmIG9uZVxuICogaW5wdXQgYXJyYXkgaXMgc2hvcnQsIGV4Y2VzcyBlbGVtZW50cyBvZiB0aGUgbG9uZ2VyIGFycmF5IGFyZSBkaXNjYXJkZWQuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IHppcFdpdGggfSBmcm9tICdmcC10cy9SZWFkb25seUFycmF5J1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoemlwV2l0aChbMSwgMiwgM10sIFsnYScsICdiJywgJ2MnLCAnZCddLCAobiwgcykgPT4gcyArIG4pLCBbJ2ExJywgJ2IyJywgJ2MzJ10pXG4gKlxuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgemlwV2l0aCA9IGZ1bmN0aW9uIChmYSwgZmIsIGYpIHtcbiAgICB2YXIgZmMgPSBbXTtcbiAgICB2YXIgbGVuID0gTWF0aC5taW4oZmEubGVuZ3RoLCBmYi5sZW5ndGgpO1xuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbGVuOyBpKyspIHtcbiAgICAgICAgZmNbaV0gPSBmKGZhW2ldLCBmYltpXSk7XG4gICAgfVxuICAgIHJldHVybiBmYztcbn07XG5leHBvcnQgZnVuY3Rpb24gemlwKGFzLCBicykge1xuICAgIGlmIChicyA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgIHJldHVybiBmdW5jdGlvbiAoYnMpIHsgcmV0dXJuIHppcChicywgYXMpOyB9O1xuICAgIH1cbiAgICByZXR1cm4gemlwV2l0aChhcywgYnMsIGZ1bmN0aW9uIChhLCBiKSB7IHJldHVybiBbYSwgYl07IH0pO1xufVxuLyoqXG4gKiBUaGUgZnVuY3Rpb24gaXMgcmV2ZXJzZSBvZiBgemlwYC4gVGFrZXMgYW4gYXJyYXkgb2YgcGFpcnMgYW5kIHJldHVybiB0d28gY29ycmVzcG9uZGluZyBhcnJheXNcbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgdW56aXAgfSBmcm9tICdmcC10cy9SZWFkb25seUFycmF5J1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwodW56aXAoW1sxLCAnYSddLCBbMiwgJ2InXSwgWzMsICdjJ11dKSwgW1sxLCAyLCAzXSwgWydhJywgJ2InLCAnYyddXSlcbiAqXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciB1bnppcCA9IGZ1bmN0aW9uIChhcykge1xuICAgIHZhciBmYSA9IFtdO1xuICAgIHZhciBmYiA9IFtdO1xuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgYXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgZmFbaV0gPSBhc1tpXVswXTtcbiAgICAgICAgZmJbaV0gPSBhc1tpXVsxXTtcbiAgICB9XG4gICAgcmV0dXJuIFtmYSwgZmJdO1xufTtcbi8qKlxuICogUHJlcGVuZCBhbiBlbGVtZW50IHRvIGV2ZXJ5IG1lbWJlciBvZiBhbiBhcnJheVxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBwcmVwZW5kQWxsIH0gZnJvbSAnZnAtdHMvUmVhZG9ubHlBcnJheSdcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKHByZXBlbmRBbGwoOSkoWzEsIDIsIDMsIDRdKSwgWzksIDEsIDksIDIsIDksIDMsIDksIDRdKVxuICpcbiAqIEBzaW5jZSAyLjEwLjBcbiAqL1xuZXhwb3J0IHZhciBwcmVwZW5kQWxsID0gZnVuY3Rpb24gKG1pZGRsZSkge1xuICAgIHZhciBmID0gUk5FQS5wcmVwZW5kQWxsKG1pZGRsZSk7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykgeyByZXR1cm4gKGlzTm9uRW1wdHkoYXMpID8gZihhcykgOiBhcyk7IH07XG59O1xuLyoqXG4gKiBQbGFjZXMgYW4gZWxlbWVudCBpbiBiZXR3ZWVuIG1lbWJlcnMgb2YgYW4gYXJyYXlcbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgaW50ZXJzcGVyc2UgfSBmcm9tICdmcC10cy9SZWFkb25seUFycmF5J1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoaW50ZXJzcGVyc2UoOSkoWzEsIDIsIDMsIDRdKSwgWzEsIDksIDIsIDksIDMsIDksIDRdKVxuICpcbiAqIEBzaW5jZSAyLjkuMFxuICovXG5leHBvcnQgdmFyIGludGVyc3BlcnNlID0gZnVuY3Rpb24gKG1pZGRsZSkge1xuICAgIHZhciBmID0gUk5FQS5pbnRlcnNwZXJzZShtaWRkbGUpO1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHsgcmV0dXJuIChpc05vbkVtcHR5KGFzKSA/IGYoYXMpIDogYXMpOyB9O1xufTtcbi8qKlxuICogUm90YXRlIGEgYFJlYWRvbmx5QXJyYXlgIGJ5IGBuYCBzdGVwcy5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgcm90YXRlIH0gZnJvbSAnZnAtdHMvUmVhZG9ubHlBcnJheSdcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKHJvdGF0ZSgyKShbMSwgMiwgMywgNCwgNV0pLCBbNCwgNSwgMSwgMiwgM10pXG4gKlxuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgcm90YXRlID0gZnVuY3Rpb24gKG4pIHtcbiAgICB2YXIgZiA9IFJORUEucm90YXRlKG4pO1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHsgcmV0dXJuIChpc05vbkVtcHR5KGFzKSA/IGYoYXMpIDogYXMpOyB9O1xufTtcbmV4cG9ydCBmdW5jdGlvbiBlbGVtKEUpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGEsIGFzKSB7XG4gICAgICAgIGlmIChhcyA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICB2YXIgZWxlbUVfMSA9IGVsZW0oRSk7XG4gICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7IHJldHVybiBlbGVtRV8xKGEsIGFzKTsgfTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgcHJlZGljYXRlID0gZnVuY3Rpb24gKGVsZW1lbnQpIHsgcmV0dXJuIEUuZXF1YWxzKGVsZW1lbnQsIGEpOyB9O1xuICAgICAgICB2YXIgaSA9IDA7XG4gICAgICAgIGZvciAoOyBpIDwgYXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIGlmIChwcmVkaWNhdGUoYXNbaV0pKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH07XG59XG4vKipcbiAqIFJlbW92ZSBkdXBsaWNhdGVzIGZyb20gYW4gYXJyYXksIGtlZXBpbmcgdGhlIGZpcnN0IG9jY3VycmVuY2Ugb2YgYW4gZWxlbWVudC5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgdW5pcSB9IGZyb20gJ2ZwLXRzL1JlYWRvbmx5QXJyYXknXG4gKiBpbXBvcnQgKiBhcyBOIGZyb20gJ2ZwLXRzL251bWJlcidcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKHVuaXEoTi5FcSkoWzEsIDIsIDFdKSwgWzEsIDJdKVxuICpcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIHVuaXEgPSBmdW5jdGlvbiAoRSkge1xuICAgIHZhciBmID0gUk5FQS51bmlxKEUpO1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHsgcmV0dXJuIChpc05vbkVtcHR5KGFzKSA/IGYoYXMpIDogYXMpOyB9O1xufTtcbi8qKlxuICogU29ydCB0aGUgZWxlbWVudHMgb2YgYW4gYXJyYXkgaW4gaW5jcmVhc2luZyBvcmRlciwgd2hlcmUgZWxlbWVudHMgYXJlIGNvbXBhcmVkIHVzaW5nIGZpcnN0IGBvcmRzWzBdYCwgdGhlbiBgb3Jkc1sxXWAsXG4gKiBldGMuLi5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgc29ydEJ5IH0gZnJvbSAnZnAtdHMvUmVhZG9ubHlBcnJheSdcbiAqIGltcG9ydCB7IGNvbnRyYW1hcCB9IGZyb20gJ2ZwLXRzL09yZCdcbiAqIGltcG9ydCAqIGFzIFMgZnJvbSAnZnAtdHMvc3RyaW5nJ1xuICogaW1wb3J0ICogYXMgTiBmcm9tICdmcC10cy9udW1iZXInXG4gKiBpbXBvcnQgeyBwaXBlIH0gZnJvbSAnZnAtdHMvZnVuY3Rpb24nXG4gKlxuICogaW50ZXJmYWNlIFBlcnNvbiB7XG4gKiAgIHJlYWRvbmx5IG5hbWU6IHN0cmluZ1xuICogICByZWFkb25seSBhZ2U6IG51bWJlclxuICogfVxuICogY29uc3QgYnlOYW1lID0gcGlwZShTLk9yZCwgY29udHJhbWFwKChwOiBQZXJzb24pID0+IHAubmFtZSkpXG4gKiBjb25zdCBieUFnZSA9IHBpcGUoTi5PcmQsIGNvbnRyYW1hcCgocDogUGVyc29uKSA9PiBwLmFnZSkpXG4gKlxuICogY29uc3Qgc29ydEJ5TmFtZUJ5QWdlID0gc29ydEJ5KFtieU5hbWUsIGJ5QWdlXSlcbiAqXG4gKiBjb25zdCBwZXJzb25zID0gW3sgbmFtZTogJ2EnLCBhZ2U6IDEgfSwgeyBuYW1lOiAnYicsIGFnZTogMyB9LCB7IG5hbWU6ICdjJywgYWdlOiAyIH0sIHsgbmFtZTogJ2InLCBhZ2U6IDIgfV1cbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoc29ydEJ5TmFtZUJ5QWdlKHBlcnNvbnMpLCBbXG4gKiAgIHsgbmFtZTogJ2EnLCBhZ2U6IDEgfSxcbiAqICAgeyBuYW1lOiAnYicsIGFnZTogMiB9LFxuICogICB7IG5hbWU6ICdiJywgYWdlOiAzIH0sXG4gKiAgIHsgbmFtZTogJ2MnLCBhZ2U6IDIgfVxuICogXSlcbiAqXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBzb3J0QnkgPSBmdW5jdGlvbiAob3Jkcykge1xuICAgIHZhciBmID0gUk5FQS5zb3J0Qnkob3Jkcyk7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykgeyByZXR1cm4gKGlzTm9uRW1wdHkoYXMpID8gZihhcykgOiBhcyk7IH07XG59O1xuLyoqXG4gKiBBIHVzZWZ1bCByZWN1cnNpb24gcGF0dGVybiBmb3IgcHJvY2Vzc2luZyBhIGBSZWFkb25seUFycmF5YCB0byBwcm9kdWNlIGEgbmV3IGBSZWFkb25seUFycmF5YCwgb2Z0ZW4gdXNlZCBmb3IgXCJjaG9wcGluZ1wiIHVwIHRoZSBpbnB1dFxuICogYFJlYWRvbmx5QXJyYXlgLiBUeXBpY2FsbHkgYGNob3BgIGlzIGNhbGxlZCB3aXRoIHNvbWUgZnVuY3Rpb24gdGhhdCB3aWxsIGNvbnN1bWUgYW4gaW5pdGlhbCBwcmVmaXggb2YgdGhlIGBSZWFkb25seUFycmF5YCBhbmQgcHJvZHVjZSBhXG4gKiB2YWx1ZSBhbmQgdGhlIHRhaWwgb2YgdGhlIGBSZWFkb25seUFycmF5YC5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgRXEgfSBmcm9tICdmcC10cy9FcSdcbiAqIGltcG9ydCAqIGFzIFJBIGZyb20gJ2ZwLXRzL1JlYWRvbmx5QXJyYXknXG4gKiBpbXBvcnQgKiBhcyBOIGZyb20gJ2ZwLXRzL251bWJlcidcbiAqIGltcG9ydCB7IHBpcGUgfSBmcm9tICdmcC10cy9mdW5jdGlvbidcbiAqXG4gKiBjb25zdCBncm91cCA9IDxBPihTOiBFcTxBPik6ICgoYXM6IFJlYWRvbmx5QXJyYXk8QT4pID0+IFJlYWRvbmx5QXJyYXk8UmVhZG9ubHlBcnJheTxBPj4pID0+IHtcbiAqICAgcmV0dXJuIFJBLmNob3AoYXMgPT4ge1xuICogICAgIGNvbnN0IHsgaW5pdCwgcmVzdCB9ID0gcGlwZShhcywgUkEuc3BhbkxlZnQoKGE6IEEpID0+IFMuZXF1YWxzKGEsIGFzWzBdKSkpXG4gKiAgICAgcmV0dXJuIFtpbml0LCByZXN0XVxuICogICB9KVxuICogfVxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChncm91cChOLkVxKShbMSwgMSwgMiwgMywgMywgNF0pLCBbWzEsIDFdLCBbMl0sIFszLCAzXSwgWzRdXSlcbiAqXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBjaG9wID0gZnVuY3Rpb24gKGYpIHtcbiAgICB2YXIgZyA9IFJORUEuY2hvcChmKTtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7IHJldHVybiAoaXNOb25FbXB0eShhcykgPyBnKGFzKSA6IGVtcHR5KTsgfTtcbn07XG4vKipcbiAqIFNwbGl0cyBhIGBSZWFkb25seUFycmF5YCBpbnRvIHR3byBwaWVjZXMsIHRoZSBmaXJzdCBwaWVjZSBoYXMgbWF4IGBuYCBlbGVtZW50cy5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgc3BsaXRBdCB9IGZyb20gJ2ZwLXRzL1JlYWRvbmx5QXJyYXknXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChzcGxpdEF0KDIpKFsxLCAyLCAzLCA0LCA1XSksIFtbMSwgMl0sIFszLCA0LCA1XV0pXG4gKlxuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgc3BsaXRBdCA9IGZ1bmN0aW9uIChuKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykge1xuICAgICAgICByZXR1cm4gbiA+PSAxICYmIGlzTm9uRW1wdHkoYXMpID8gUk5FQS5zcGxpdEF0KG4pKGFzKSA6IGlzRW1wdHkoYXMpID8gW2FzLCBlbXB0eV0gOiBbZW1wdHksIGFzXTtcbiAgICB9O1xufTtcbi8qKlxuICogU3BsaXRzIGEgYFJlYWRvbmx5QXJyYXlgIGludG8gbGVuZ3RoLWBuYCBwaWVjZXMuIFRoZSBsYXN0IHBpZWNlIHdpbGwgYmUgc2hvcnRlciBpZiBgbmAgZG9lcyBub3QgZXZlbmx5IGRpdmlkZSB0aGUgbGVuZ3RoIG9mXG4gKiB0aGUgYFJlYWRvbmx5QXJyYXlgLiBOb3RlIHRoYXQgYGNodW5rc09mKG4pKFtdKWAgaXMgYFtdYCwgbm90IGBbW11dYC4gVGhpcyBpcyBpbnRlbnRpb25hbCwgYW5kIGlzIGNvbnNpc3RlbnQgd2l0aCBhIHJlY3Vyc2l2ZVxuICogZGVmaW5pdGlvbiBvZiBgY2h1bmtzT2ZgOyBpdCBzYXRpc2ZpZXMgdGhlIHByb3BlcnR5IHRoYXQ6XG4gKlxuICogYGBgdHNcbiAqIGNodW5rc09mKG4pKHhzKS5jb25jYXQoY2h1bmtzT2YobikoeXMpKSA9PSBjaHVua3NPZihuKSh4cy5jb25jYXQoeXMpKSlcbiAqIGBgYFxuICpcbiAqIHdoZW5ldmVyIGBuYCBldmVubHkgZGl2aWRlcyB0aGUgbGVuZ3RoIG9mIGBhc2AuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IGNodW5rc09mIH0gZnJvbSAnZnAtdHMvUmVhZG9ubHlBcnJheSdcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKGNodW5rc09mKDIpKFsxLCAyLCAzLCA0LCA1XSksIFtbMSwgMl0sIFszLCA0XSwgWzVdXSlcbiAqXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBjaHVua3NPZiA9IGZ1bmN0aW9uIChuKSB7XG4gICAgdmFyIGYgPSBSTkVBLmNodW5rc09mKG4pO1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHsgcmV0dXJuIChpc05vbkVtcHR5KGFzKSA/IGYoYXMpIDogZW1wdHkpOyB9O1xufTtcbi8qKlxuICogQGNhdGVnb3J5IGxpZnRpbmdcbiAqIEBzaW5jZSAyLjExLjBcbiAqL1xuZXhwb3J0IHZhciBmcm9tT3B0aW9uSyA9IGZ1bmN0aW9uIChmKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIGEgPSBbXTtcbiAgICAgICAgZm9yICh2YXIgX2kgPSAwOyBfaSA8IGFyZ3VtZW50cy5sZW5ndGg7IF9pKyspIHtcbiAgICAgICAgICAgIGFbX2ldID0gYXJndW1lbnRzW19pXTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gZnJvbU9wdGlvbihmLmFwcGx5KHZvaWQgMCwgYSkpO1xuICAgIH07XG59O1xuZXhwb3J0IGZ1bmN0aW9uIGNvbXByZWhlbnNpb24oaW5wdXQsIGYsIGcpIHtcbiAgICBpZiAoZyA9PT0gdm9pZCAwKSB7IGcgPSBmdW5jdGlvbiAoKSB7IHJldHVybiB0cnVlOyB9OyB9XG4gICAgdmFyIGdvID0gZnVuY3Rpb24gKHNjb3BlLCBpbnB1dCkge1xuICAgICAgICByZXR1cm4gaXNOb25FbXB0eShpbnB1dClcbiAgICAgICAgICAgID8gZmxhdE1hcChSTkVBLmhlYWQoaW5wdXQpLCBmdW5jdGlvbiAoYSkgeyByZXR1cm4gZ28ocGlwZShzY29wZSwgYXBwZW5kKGEpKSwgUk5FQS50YWlsKGlucHV0KSk7IH0pXG4gICAgICAgICAgICA6IGcuYXBwbHkodm9pZCAwLCBzY29wZSkgPyBbZi5hcHBseSh2b2lkIDAsIHNjb3BlKV1cbiAgICAgICAgICAgICAgICA6IGVtcHR5O1xuICAgIH07XG4gICAgcmV0dXJuIGdvKGVtcHR5LCBpbnB1dCk7XG59XG4vKipcbiAqIEBzaW5jZSAyLjExLjBcbiAqL1xuZXhwb3J0IHZhciBjb25jYXRXID0gZnVuY3Rpb24gKHNlY29uZCkge1xuICAgIHJldHVybiBmdW5jdGlvbiAoZmlyc3QpIHtcbiAgICAgICAgcmV0dXJuIGlzRW1wdHkoZmlyc3QpID8gc2Vjb25kIDogaXNFbXB0eShzZWNvbmQpID8gZmlyc3QgOiBmaXJzdC5jb25jYXQoc2Vjb25kKTtcbiAgICB9O1xufTtcbi8qKlxuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIGNvbmNhdCA9IGNvbmNhdFc7XG5leHBvcnQgZnVuY3Rpb24gdW5pb24oRSkge1xuICAgIHZhciB1bmlvbkUgPSBSTkVBLnVuaW9uKEUpO1xuICAgIHJldHVybiBmdW5jdGlvbiAoZmlyc3QsIHNlY29uZCkge1xuICAgICAgICBpZiAoc2Vjb25kID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIHZhciB1bmlvbkVfMSA9IHVuaW9uKEUpO1xuICAgICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIChzZWNvbmQpIHsgcmV0dXJuIHVuaW9uRV8xKHNlY29uZCwgZmlyc3QpOyB9O1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBpc05vbkVtcHR5KGZpcnN0KSAmJiBpc05vbkVtcHR5KHNlY29uZCkgPyB1bmlvbkUoc2Vjb25kKShmaXJzdCkgOiBpc05vbkVtcHR5KGZpcnN0KSA/IGZpcnN0IDogc2Vjb25kO1xuICAgIH07XG59XG5leHBvcnQgZnVuY3Rpb24gaW50ZXJzZWN0aW9uKEUpIHtcbiAgICB2YXIgZWxlbUUgPSBlbGVtKEUpO1xuICAgIHJldHVybiBmdW5jdGlvbiAoeHMsIHlzKSB7XG4gICAgICAgIGlmICh5cyA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICB2YXIgaW50ZXJzZWN0aW9uRV8xID0gaW50ZXJzZWN0aW9uKEUpO1xuICAgICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uICh5cykgeyByZXR1cm4gaW50ZXJzZWN0aW9uRV8xKHlzLCB4cyk7IH07XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHhzLmZpbHRlcihmdW5jdGlvbiAoYSkgeyByZXR1cm4gZWxlbUUoYSwgeXMpOyB9KTtcbiAgICB9O1xufVxuZXhwb3J0IGZ1bmN0aW9uIGRpZmZlcmVuY2UoRSkge1xuICAgIHZhciBlbGVtRSA9IGVsZW0oRSk7XG4gICAgcmV0dXJuIGZ1bmN0aW9uICh4cywgeXMpIHtcbiAgICAgICAgaWYgKHlzID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIHZhciBkaWZmZXJlbmNlRV8xID0gZGlmZmVyZW5jZShFKTtcbiAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbiAoeXMpIHsgcmV0dXJuIGRpZmZlcmVuY2VFXzEoeXMsIHhzKTsgfTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4geHMuZmlsdGVyKGZ1bmN0aW9uIChhKSB7IHJldHVybiAhZWxlbUUoYSwgeXMpOyB9KTtcbiAgICB9O1xufVxudmFyIF9tYXAgPSBmdW5jdGlvbiAoZmEsIGYpIHsgcmV0dXJuIHBpcGUoZmEsIG1hcChmKSk7IH07XG52YXIgX21hcFdpdGhJbmRleCA9IGZ1bmN0aW9uIChmYSwgZikgeyByZXR1cm4gcGlwZShmYSwgbWFwV2l0aEluZGV4KGYpKTsgfTtcbnZhciBfYXAgPSBmdW5jdGlvbiAoZmFiLCBmYSkgeyByZXR1cm4gcGlwZShmYWIsIGFwKGZhKSk7IH07XG52YXIgX2ZpbHRlciA9IGZ1bmN0aW9uIChmYSwgcHJlZGljYXRlKSB7XG4gICAgcmV0dXJuIHBpcGUoZmEsIGZpbHRlcihwcmVkaWNhdGUpKTtcbn07XG52YXIgX2ZpbHRlck1hcCA9IGZ1bmN0aW9uIChmYSwgZikgeyByZXR1cm4gcGlwZShmYSwgZmlsdGVyTWFwKGYpKTsgfTtcbnZhciBfcGFydGl0aW9uID0gZnVuY3Rpb24gKGZhLCBwcmVkaWNhdGUpIHtcbiAgICByZXR1cm4gcGlwZShmYSwgcGFydGl0aW9uKHByZWRpY2F0ZSkpO1xufTtcbnZhciBfcGFydGl0aW9uTWFwID0gZnVuY3Rpb24gKGZhLCBmKSB7IHJldHVybiBwaXBlKGZhLCBwYXJ0aXRpb25NYXAoZikpOyB9O1xudmFyIF9wYXJ0aXRpb25XaXRoSW5kZXggPSBmdW5jdGlvbiAoZmEsIHByZWRpY2F0ZVdpdGhJbmRleCkgeyByZXR1cm4gcGlwZShmYSwgcGFydGl0aW9uV2l0aEluZGV4KHByZWRpY2F0ZVdpdGhJbmRleCkpOyB9O1xudmFyIF9wYXJ0aXRpb25NYXBXaXRoSW5kZXggPSBmdW5jdGlvbiAoZmEsIGYpIHsgcmV0dXJuIHBpcGUoZmEsIHBhcnRpdGlvbk1hcFdpdGhJbmRleChmKSk7IH07XG52YXIgX2FsdCA9IGZ1bmN0aW9uIChmYSwgdGhhdCkgeyByZXR1cm4gcGlwZShmYSwgYWx0KHRoYXQpKTsgfTtcbnZhciBfcmVkdWNlID0gZnVuY3Rpb24gKGZhLCBiLCBmKSB7IHJldHVybiBwaXBlKGZhLCByZWR1Y2UoYiwgZikpOyB9O1xudmFyIF9mb2xkTWFwID0gZnVuY3Rpb24gKE0pIHtcbiAgICB2YXIgZm9sZE1hcE0gPSBmb2xkTWFwKE0pO1xuICAgIHJldHVybiBmdW5jdGlvbiAoZmEsIGYpIHsgcmV0dXJuIHBpcGUoZmEsIGZvbGRNYXBNKGYpKTsgfTtcbn07XG52YXIgX3JlZHVjZVJpZ2h0ID0gZnVuY3Rpb24gKGZhLCBiLCBmKSB7IHJldHVybiBwaXBlKGZhLCByZWR1Y2VSaWdodChiLCBmKSk7IH07XG52YXIgX3JlZHVjZVdpdGhJbmRleCA9IGZ1bmN0aW9uIChmYSwgYiwgZikge1xuICAgIHJldHVybiBwaXBlKGZhLCByZWR1Y2VXaXRoSW5kZXgoYiwgZikpO1xufTtcbnZhciBfZm9sZE1hcFdpdGhJbmRleCA9IGZ1bmN0aW9uIChNKSB7XG4gICAgdmFyIGZvbGRNYXBXaXRoSW5kZXhNID0gZm9sZE1hcFdpdGhJbmRleChNKTtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGZhLCBmKSB7IHJldHVybiBwaXBlKGZhLCBmb2xkTWFwV2l0aEluZGV4TShmKSk7IH07XG59O1xudmFyIF9yZWR1Y2VSaWdodFdpdGhJbmRleCA9IGZ1bmN0aW9uIChmYSwgYiwgZikge1xuICAgIHJldHVybiBwaXBlKGZhLCByZWR1Y2VSaWdodFdpdGhJbmRleChiLCBmKSk7XG59O1xudmFyIF9maWx0ZXJNYXBXaXRoSW5kZXggPSBmdW5jdGlvbiAoZmEsIGYpIHsgcmV0dXJuIHBpcGUoZmEsIGZpbHRlck1hcFdpdGhJbmRleChmKSk7IH07XG52YXIgX2ZpbHRlcldpdGhJbmRleCA9IGZ1bmN0aW9uIChmYSwgcHJlZGljYXRlV2l0aEluZGV4KSB7IHJldHVybiBwaXBlKGZhLCBmaWx0ZXJXaXRoSW5kZXgocHJlZGljYXRlV2l0aEluZGV4KSk7IH07XG52YXIgX2V4dGVuZCA9IGZ1bmN0aW9uIChmYSwgZikgeyByZXR1cm4gcGlwZShmYSwgZXh0ZW5kKGYpKTsgfTtcbnZhciBfdHJhdmVyc2UgPSBmdW5jdGlvbiAoRikge1xuICAgIHZhciB0cmF2ZXJzZUYgPSB0cmF2ZXJzZShGKTtcbiAgICByZXR1cm4gZnVuY3Rpb24gKHRhLCBmKSB7IHJldHVybiBwaXBlKHRhLCB0cmF2ZXJzZUYoZikpOyB9O1xufTtcbi8qIGlzdGFuYnVsIGlnbm9yZSBuZXh0ICovXG52YXIgX3RyYXZlcnNlV2l0aEluZGV4ID0gZnVuY3Rpb24gKEYpIHtcbiAgICB2YXIgdHJhdmVyc2VXaXRoSW5kZXhGID0gdHJhdmVyc2VXaXRoSW5kZXgoRik7XG4gICAgcmV0dXJuIGZ1bmN0aW9uICh0YSwgZikgeyByZXR1cm4gcGlwZSh0YSwgdHJhdmVyc2VXaXRoSW5kZXhGKGYpKTsgfTtcbn07XG4vKiogQGludGVybmFsICovXG5leHBvcnQgdmFyIF9jaGFpblJlY0RlcHRoRmlyc3QgPSBmdW5jdGlvbiAoYSwgZikgeyByZXR1cm4gcGlwZShhLCBjaGFpblJlY0RlcHRoRmlyc3QoZikpOyB9O1xuLyoqIEBpbnRlcm5hbCAqL1xuZXhwb3J0IHZhciBfY2hhaW5SZWNCcmVhZHRoRmlyc3QgPSBmdW5jdGlvbiAoYSwgZikgeyByZXR1cm4gcGlwZShhLCBjaGFpblJlY0JyZWFkdGhGaXJzdChmKSk7IH07XG4vKipcbiAqIEBjYXRlZ29yeSBjb25zdHJ1Y3RvcnNcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIG9mID0gUk5FQS5vZjtcbi8qKlxuICogQHNpbmNlIDIuNy4wXG4gKi9cbmV4cG9ydCB2YXIgemVybyA9IGZ1bmN0aW9uICgpIHsgcmV0dXJuIGVtcHR5OyB9O1xuLyoqXG4gKiBMZXNzIHN0cmljdCB2ZXJzaW9uIG9mIFtgYWx0YF0oI2FsdCkuXG4gKlxuICogVGhlIGBXYCBzdWZmaXggKHNob3J0IGZvciAqKlcqKmlkZW5pbmcpIG1lYW5zIHRoYXQgdGhlIHJldHVybiB0eXBlcyB3aWxsIGJlIG1lcmdlZC5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0ICogYXMgUkEgZnJvbSAnZnAtdHMvUmVhZG9ubHlBcnJheSdcbiAqIGltcG9ydCB7IHBpcGUgfSBmcm9tICdmcC10cy9mdW5jdGlvbidcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKFxuICogICBwaXBlKFxuICogICAgIFsxLCAyLCAzXSxcbiAqICAgICBSQS5hbHRXKCgpID0+IFsnYScsICdiJ10pXG4gKiAgICksXG4gKiAgIFsxLCAyLCAzLCAnYScsICdiJ11cbiAqIClcbiAqXG4gKiBAY2F0ZWdvcnkgZXJyb3IgaGFuZGxpbmdcbiAqIEBzaW5jZSAyLjkuMFxuICovXG5leHBvcnQgdmFyIGFsdFcgPSBmdW5jdGlvbiAodGhhdCkge1xuICAgIHJldHVybiBmdW5jdGlvbiAoZmEpIHtcbiAgICAgICAgcmV0dXJuIGZhLmNvbmNhdCh0aGF0KCkpO1xuICAgIH07XG59O1xuLyoqXG4gKiBJZGVudGlmaWVzIGFuIGFzc29jaWF0aXZlIG9wZXJhdGlvbiBvbiBhIHR5cGUgY29uc3RydWN0b3IuIEl0IGlzIHNpbWlsYXIgdG8gYFNlbWlncm91cGAsIGV4Y2VwdCB0aGF0IGl0IGFwcGxpZXMgdG9cbiAqIHR5cGVzIG9mIGtpbmQgYCogLT4gKmAuXG4gKlxuICogSW4gY2FzZSBvZiBgUmVhZG9ubHlBcnJheWAgY29uY2F0ZW5hdGVzIHRoZSBpbnB1dHMgaW50byBhIHNpbmdsZSBhcnJheS5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0ICogYXMgUkEgZnJvbSAnZnAtdHMvUmVhZG9ubHlBcnJheSdcbiAqIGltcG9ydCB7IHBpcGUgfSBmcm9tICdmcC10cy9mdW5jdGlvbidcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKFxuICogICBwaXBlKFxuICogICAgIFsxLCAyLCAzXSxcbiAqICAgICBSQS5hbHQoKCkgPT4gWzQsIDVdKVxuICogICApLFxuICogICBbMSwgMiwgMywgNCwgNV1cbiAqIClcbiAqXG4gKiBAY2F0ZWdvcnkgZXJyb3IgaGFuZGxpbmdcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIGFsdCA9IGFsdFc7XG4vKipcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIGFwID0gZnVuY3Rpb24gKGZhKSB7XG4gICAgcmV0dXJuIGZsYXRNYXAoZnVuY3Rpb24gKGYpIHsgcmV0dXJuIHBpcGUoZmEsIG1hcChmKSk7IH0pO1xufTtcbi8qKlxuICogQ29tcG9zZXMgY29tcHV0YXRpb25zIGluIHNlcXVlbmNlLCB1c2luZyB0aGUgcmV0dXJuIHZhbHVlIG9mIG9uZSBjb21wdXRhdGlvbiB0byBkZXRlcm1pbmUgdGhlIG5leHQgY29tcHV0YXRpb24uXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCAqIGFzIFJBIGZyb20gJ2ZwLXRzL1JlYWRvbmx5QXJyYXknXG4gKiBpbXBvcnQgeyBwaXBlIH0gZnJvbSAnZnAtdHMvZnVuY3Rpb24nXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChcbiAqICAgcGlwZShcbiAqICAgICBbMSwgMiwgM10sXG4gKiAgICAgUkEuZmxhdE1hcCgobikgPT4gW2BhJHtufWAsIGBiJHtufWBdKVxuICogICApLFxuICogICBbJ2ExJywgJ2IxJywgJ2EyJywgJ2IyJywgJ2EzJywgJ2IzJ11cbiAqIClcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoXG4gKiAgIHBpcGUoXG4gKiAgICAgWzEsIDIsIDNdLFxuICogICAgIFJBLmZsYXRNYXAoKCkgPT4gW10pXG4gKiAgICksXG4gKiAgIFtdXG4gKiApXG4gKlxuICogQGNhdGVnb3J5IHNlcXVlbmNpbmdcbiAqIEBzaW5jZSAyLjE0LjBcbiAqL1xuZXhwb3J0IHZhciBmbGF0TWFwID0gLyojX19QVVJFX18qLyBkdWFsKDIsIGZ1bmN0aW9uIChtYSwgZikge1xuICAgIHJldHVybiBwaXBlKG1hLCBjaGFpbldpdGhJbmRleChmdW5jdGlvbiAoaSwgYSkgeyByZXR1cm4gZihhLCBpKTsgfSkpO1xufSk7XG4vKipcbiAqIEBjYXRlZ29yeSBzZXF1ZW5jaW5nXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBmbGF0dGVuID0gLyojX19QVVJFX18qLyBmbGF0TWFwKGlkZW50aXR5KTtcbi8qKlxuICogYG1hcGAgY2FuIGJlIHVzZWQgdG8gdHVybiBmdW5jdGlvbnMgYChhOiBBKSA9PiBCYCBpbnRvIGZ1bmN0aW9ucyBgKGZhOiBGPEE+KSA9PiBGPEI+YCB3aG9zZSBhcmd1bWVudCBhbmQgcmV0dXJuIHR5cGVzXG4gKiB1c2UgdGhlIHR5cGUgY29uc3RydWN0b3IgYEZgIHRvIHJlcHJlc2VudCBzb21lIGNvbXB1dGF0aW9uYWwgY29udGV4dC5cbiAqXG4gKiBAY2F0ZWdvcnkgbWFwcGluZ1xuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgbWFwID0gZnVuY3Rpb24gKGYpIHsgcmV0dXJuIGZ1bmN0aW9uIChmYSkge1xuICAgIHJldHVybiBmYS5tYXAoZnVuY3Rpb24gKGEpIHsgcmV0dXJuIGYoYSk7IH0pO1xufTsgfTtcbi8qKlxuICogQGNhdGVnb3J5IG1hcHBpbmdcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIG1hcFdpdGhJbmRleCA9IGZ1bmN0aW9uIChmKSB7IHJldHVybiBmdW5jdGlvbiAoZmEpIHtcbiAgICByZXR1cm4gZmEubWFwKGZ1bmN0aW9uIChhLCBpKSB7IHJldHVybiBmKGksIGEpOyB9KTtcbn07IH07XG4vKipcbiAqIEBjYXRlZ29yeSBmaWx0ZXJpbmdcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIHNlcGFyYXRlID0gZnVuY3Rpb24gKGZhKSB7XG4gICAgdmFyIGxlZnQgPSBbXTtcbiAgICB2YXIgcmlnaHQgPSBbXTtcbiAgICBmb3IgKHZhciBfaSA9IDAsIGZhXzEgPSBmYTsgX2kgPCBmYV8xLmxlbmd0aDsgX2krKykge1xuICAgICAgICB2YXIgZSA9IGZhXzFbX2ldO1xuICAgICAgICBpZiAoZS5fdGFnID09PSAnTGVmdCcpIHtcbiAgICAgICAgICAgIGxlZnQucHVzaChlLmxlZnQpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgcmlnaHQucHVzaChlLnJpZ2h0KTtcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gc2VwYXJhdGVkKGxlZnQsIHJpZ2h0KTtcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBmaWx0ZXJpbmdcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIGZpbHRlciA9IGZ1bmN0aW9uIChwcmVkaWNhdGUpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIHJldHVybiBhcy5maWx0ZXIocHJlZGljYXRlKTtcbiAgICB9O1xufTtcbi8qKlxuICogQGNhdGVnb3J5IGZpbHRlcmluZ1xuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgZmlsdGVyTWFwV2l0aEluZGV4ID0gZnVuY3Rpb24gKGYpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGZhKSB7XG4gICAgICAgIHZhciBvdXQgPSBbXTtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBmYS5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgdmFyIG9wdGlvbkIgPSBmKGksIGZhW2ldKTtcbiAgICAgICAgICAgIGlmIChfLmlzU29tZShvcHRpb25CKSkge1xuICAgICAgICAgICAgICAgIG91dC5wdXNoKG9wdGlvbkIudmFsdWUpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBvdXQ7XG4gICAgfTtcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBmaWx0ZXJpbmdcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIGZpbHRlck1hcCA9IGZ1bmN0aW9uIChmKSB7XG4gICAgcmV0dXJuIGZpbHRlck1hcFdpdGhJbmRleChmdW5jdGlvbiAoXywgYSkgeyByZXR1cm4gZihhKTsgfSk7XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgZmlsdGVyaW5nXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBjb21wYWN0ID0gLyojX19QVVJFX18qLyBmaWx0ZXJNYXAoaWRlbnRpdHkpO1xuLyoqXG4gKiBAY2F0ZWdvcnkgZmlsdGVyaW5nXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBwYXJ0aXRpb24gPSBmdW5jdGlvbiAocHJlZGljYXRlKSB7XG4gICAgcmV0dXJuIHBhcnRpdGlvbldpdGhJbmRleChmdW5jdGlvbiAoXywgYSkgeyByZXR1cm4gcHJlZGljYXRlKGEpOyB9KTtcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBmaWx0ZXJpbmdcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIHBhcnRpdGlvbldpdGhJbmRleCA9IGZ1bmN0aW9uIChwcmVkaWNhdGVXaXRoSW5kZXgpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIHZhciBsZWZ0ID0gW107XG4gICAgICAgIHZhciByaWdodCA9IFtdO1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGFzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICB2YXIgYSA9IGFzW2ldO1xuICAgICAgICAgICAgaWYgKHByZWRpY2F0ZVdpdGhJbmRleChpLCBhKSkge1xuICAgICAgICAgICAgICAgIHJpZ2h0LnB1c2goYSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBsZWZ0LnB1c2goYSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHNlcGFyYXRlZChsZWZ0LCByaWdodCk7XG4gICAgfTtcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBmaWx0ZXJpbmdcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIHBhcnRpdGlvbk1hcCA9IGZ1bmN0aW9uIChmKSB7XG4gICAgcmV0dXJuIHBhcnRpdGlvbk1hcFdpdGhJbmRleChmdW5jdGlvbiAoXywgYSkgeyByZXR1cm4gZihhKTsgfSk7XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgZmlsdGVyaW5nXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBwYXJ0aXRpb25NYXBXaXRoSW5kZXggPSBmdW5jdGlvbiAoZikge1xuICAgIHJldHVybiBmdW5jdGlvbiAoZmEpIHtcbiAgICAgICAgdmFyIGxlZnQgPSBbXTtcbiAgICAgICAgdmFyIHJpZ2h0ID0gW107XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgZmEubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIHZhciBlID0gZihpLCBmYVtpXSk7XG4gICAgICAgICAgICBpZiAoZS5fdGFnID09PSAnTGVmdCcpIHtcbiAgICAgICAgICAgICAgICBsZWZ0LnB1c2goZS5sZWZ0KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHJpZ2h0LnB1c2goZS5yaWdodCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHNlcGFyYXRlZChsZWZ0LCByaWdodCk7XG4gICAgfTtcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBmaWx0ZXJpbmdcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIGZpbHRlcldpdGhJbmRleCA9IGZ1bmN0aW9uIChwcmVkaWNhdGVXaXRoSW5kZXgpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIHJldHVybiBhcy5maWx0ZXIoZnVuY3Rpb24gKGEsIGkpIHsgcmV0dXJuIHByZWRpY2F0ZVdpdGhJbmRleChpLCBhKTsgfSk7XG4gICAgfTtcbn07XG4vKipcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIGV4dGVuZCA9IGZ1bmN0aW9uIChmKSB7IHJldHVybiBmdW5jdGlvbiAod2EpIHtcbiAgICByZXR1cm4gd2EubWFwKGZ1bmN0aW9uIChfLCBpKSB7IHJldHVybiBmKHdhLnNsaWNlKGkpKTsgfSk7XG59OyB9O1xuLyoqXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBkdXBsaWNhdGUgPSAvKiNfX1BVUkVfXyovIGV4dGVuZChpZGVudGl0eSk7XG4vKipcbiAqIEBjYXRlZ29yeSBmb2xkaW5nXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBmb2xkTWFwV2l0aEluZGV4ID0gZnVuY3Rpb24gKE0pIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGYpIHtcbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIChmYSkge1xuICAgICAgICAgICAgcmV0dXJuIGZhLnJlZHVjZShmdW5jdGlvbiAoYiwgYSwgaSkgeyByZXR1cm4gTS5jb25jYXQoYiwgZihpLCBhKSk7IH0sIE0uZW1wdHkpO1xuICAgICAgICB9O1xuICAgIH07XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgZm9sZGluZ1xuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgcmVkdWNlID0gZnVuY3Rpb24gKGIsIGYpIHtcbiAgICByZXR1cm4gcmVkdWNlV2l0aEluZGV4KGIsIGZ1bmN0aW9uIChfLCBiLCBhKSB7IHJldHVybiBmKGIsIGEpOyB9KTtcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBmb2xkaW5nXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBmb2xkTWFwID0gZnVuY3Rpb24gKE0pIHtcbiAgICB2YXIgZm9sZE1hcFdpdGhJbmRleE0gPSBmb2xkTWFwV2l0aEluZGV4KE0pO1xuICAgIHJldHVybiBmdW5jdGlvbiAoZikgeyByZXR1cm4gZm9sZE1hcFdpdGhJbmRleE0oZnVuY3Rpb24gKF8sIGEpIHsgcmV0dXJuIGYoYSk7IH0pOyB9O1xufTtcbi8qKlxuICogQGNhdGVnb3J5IGZvbGRpbmdcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIHJlZHVjZVdpdGhJbmRleCA9IGZ1bmN0aW9uIChiLCBmKSB7IHJldHVybiBmdW5jdGlvbiAoZmEpIHtcbiAgICB2YXIgbGVuID0gZmEubGVuZ3RoO1xuICAgIHZhciBvdXQgPSBiO1xuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbGVuOyBpKyspIHtcbiAgICAgICAgb3V0ID0gZihpLCBvdXQsIGZhW2ldKTtcbiAgICB9XG4gICAgcmV0dXJuIG91dDtcbn07IH07XG4vKipcbiAqIEBjYXRlZ29yeSBmb2xkaW5nXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciByZWR1Y2VSaWdodCA9IGZ1bmN0aW9uIChiLCBmKSB7XG4gICAgcmV0dXJuIHJlZHVjZVJpZ2h0V2l0aEluZGV4KGIsIGZ1bmN0aW9uIChfLCBhLCBiKSB7IHJldHVybiBmKGEsIGIpOyB9KTtcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBmb2xkaW5nXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciByZWR1Y2VSaWdodFdpdGhJbmRleCA9IGZ1bmN0aW9uIChiLCBmKSB7IHJldHVybiBmdW5jdGlvbiAoZmEpIHtcbiAgICByZXR1cm4gZmEucmVkdWNlUmlnaHQoZnVuY3Rpb24gKGIsIGEsIGkpIHsgcmV0dXJuIGYoaSwgYSwgYik7IH0sIGIpO1xufTsgfTtcbi8qKlxuICogQGNhdGVnb3J5IHRyYXZlcnNpbmdcbiAqIEBzaW5jZSAyLjYuM1xuICovXG5leHBvcnQgdmFyIHRyYXZlcnNlID0gZnVuY3Rpb24gKEYpIHtcbiAgICB2YXIgdHJhdmVyc2VXaXRoSW5kZXhGID0gdHJhdmVyc2VXaXRoSW5kZXgoRik7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChmKSB7IHJldHVybiB0cmF2ZXJzZVdpdGhJbmRleEYoZnVuY3Rpb24gKF8sIGEpIHsgcmV0dXJuIGYoYSk7IH0pOyB9O1xufTtcbi8qKlxuICogQGNhdGVnb3J5IHRyYXZlcnNpbmdcbiAqIEBzaW5jZSAyLjYuM1xuICovXG5leHBvcnQgdmFyIHNlcXVlbmNlID0gZnVuY3Rpb24gKEYpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKHRhKSB7XG4gICAgICAgIHJldHVybiBfcmVkdWNlKHRhLCBGLm9mKHplcm8oKSksIGZ1bmN0aW9uIChmYXMsIGZhKSB7XG4gICAgICAgICAgICByZXR1cm4gRi5hcChGLm1hcChmYXMsIGZ1bmN0aW9uIChhcykgeyByZXR1cm4gZnVuY3Rpb24gKGEpIHsgcmV0dXJuIHBpcGUoYXMsIGFwcGVuZChhKSk7IH07IH0pLCBmYSk7XG4gICAgICAgIH0pO1xuICAgIH07XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgc2VxdWVuY2luZ1xuICogQHNpbmNlIDIuNi4zXG4gKi9cbmV4cG9ydCB2YXIgdHJhdmVyc2VXaXRoSW5kZXggPSBmdW5jdGlvbiAoRikge1xuICAgIHJldHVybiBmdW5jdGlvbiAoZikge1xuICAgICAgICByZXR1cm4gcmVkdWNlV2l0aEluZGV4KEYub2YoemVybygpKSwgZnVuY3Rpb24gKGksIGZicywgYSkge1xuICAgICAgICAgICAgcmV0dXJuIEYuYXAoRi5tYXAoZmJzLCBmdW5jdGlvbiAoYnMpIHsgcmV0dXJuIGZ1bmN0aW9uIChiKSB7IHJldHVybiBwaXBlKGJzLCBhcHBlbmQoYikpOyB9OyB9KSwgZihpLCBhKSk7XG4gICAgICAgIH0pO1xuICAgIH07XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgZmlsdGVyaW5nXG4gKiBAc2luY2UgMi42LjVcbiAqL1xuZXhwb3J0IHZhciB3aXRoZXIgPSBmdW5jdGlvbiAoRikge1xuICAgIHZhciBfd2l0aGVyRiA9IF93aXRoZXIoRik7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChmKSB7IHJldHVybiBmdW5jdGlvbiAoZmEpIHsgcmV0dXJuIF93aXRoZXJGKGZhLCBmKTsgfTsgfTtcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBmaWx0ZXJpbmdcbiAqIEBzaW5jZSAyLjYuNVxuICovXG5leHBvcnQgdmFyIHdpbHQgPSBmdW5jdGlvbiAoRikge1xuICAgIHZhciBfd2lsdEYgPSBfd2lsdChGKTtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGYpIHsgcmV0dXJuIGZ1bmN0aW9uIChmYSkgeyByZXR1cm4gX3dpbHRGKGZhLCBmKTsgfTsgfTtcbn07XG4vKipcbiAqIEBzaW5jZSAyLjYuNlxuICovXG5leHBvcnQgdmFyIHVuZm9sZCA9IGZ1bmN0aW9uIChiLCBmKSB7XG4gICAgdmFyIG91dCA9IFtdO1xuICAgIHZhciBiYiA9IGI7XG4gICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG5vLWNvbnN0YW50LWNvbmRpdGlvblxuICAgIHdoaWxlICh0cnVlKSB7XG4gICAgICAgIHZhciBtdCA9IGYoYmIpO1xuICAgICAgICBpZiAoXy5pc1NvbWUobXQpKSB7XG4gICAgICAgICAgICB2YXIgX2EgPSBtdC52YWx1ZSwgYSA9IF9hWzBdLCBiXzEgPSBfYVsxXTtcbiAgICAgICAgICAgIG91dC5wdXNoKGEpO1xuICAgICAgICAgICAgYmIgPSBiXzE7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gb3V0O1xufTtcbi8qKlxuICogQGNhdGVnb3J5IHR5cGUgbGFtYmRhc1xuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgVVJJID0gJ1JlYWRvbmx5QXJyYXknO1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBnZXRTaG93ID0gZnVuY3Rpb24gKFMpIHsgcmV0dXJuICh7XG4gICAgc2hvdzogZnVuY3Rpb24gKGFzKSB7IHJldHVybiBcIltcIi5jb25jYXQoYXMubWFwKFMuc2hvdykuam9pbignLCAnKSwgXCJdXCIpOyB9XG59KTsgfTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgZ2V0U2VtaWdyb3VwID0gZnVuY3Rpb24gKCkgeyByZXR1cm4gKHtcbiAgICBjb25jYXQ6IGZ1bmN0aW9uIChmaXJzdCwgc2Vjb25kKSB7IHJldHVybiAoaXNFbXB0eShmaXJzdCkgPyBzZWNvbmQgOiBpc0VtcHR5KHNlY29uZCkgPyBmaXJzdCA6IGZpcnN0LmNvbmNhdChzZWNvbmQpKTsgfVxufSk7IH07XG4vKipcbiAqIFJldHVybnMgYSBgTW9ub2lkYCBmb3IgYFJlYWRvbmx5QXJyYXk8QT5gLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBnZXRNb25vaWQgfSBmcm9tICdmcC10cy9SZWFkb25seUFycmF5J1xuICpcbiAqIGNvbnN0IE0gPSBnZXRNb25vaWQ8bnVtYmVyPigpXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKE0uY29uY2F0KFsxLCAyXSwgWzMsIDRdKSwgWzEsIDIsIDMsIDRdKVxuICpcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIGdldE1vbm9pZCA9IGZ1bmN0aW9uICgpIHsgcmV0dXJuICh7XG4gICAgY29uY2F0OiBnZXRTZW1pZ3JvdXAoKS5jb25jYXQsXG4gICAgZW1wdHk6IGVtcHR5XG59KTsgfTtcbi8qKlxuICogRGVyaXZlcyBhbiBgRXFgIG92ZXIgdGhlIGBSZWFkb25seUFycmF5YCBvZiBhIGdpdmVuIGVsZW1lbnQgdHlwZSBmcm9tIHRoZSBgRXFgIG9mIHRoYXQgdHlwZS4gVGhlIGRlcml2ZWQgYEVxYCBkZWZpbmVzIHR3b1xuICogYXJyYXlzIGFzIGVxdWFsIGlmIGFsbCBlbGVtZW50cyBvZiBib3RoIGFycmF5cyBhcmUgY29tcGFyZWQgZXF1YWwgcGFpcndpc2Ugd2l0aCB0aGUgZ2l2ZW4gYEVgLiBJbiBjYXNlIG9mIGFycmF5cyBvZlxuICogZGlmZmVyZW50IGxlbmd0aHMsIHRoZSByZXN1bHQgaXMgbm9uIGVxdWFsaXR5LlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgKiBhcyBTIGZyb20gJ2ZwLXRzL3N0cmluZydcbiAqIGltcG9ydCB7IGdldEVxIH0gZnJvbSAnZnAtdHMvUmVhZG9ubHlBcnJheSdcbiAqXG4gKiBjb25zdCBFID0gZ2V0RXEoUy5FcSlcbiAqIGFzc2VydC5zdHJpY3RFcXVhbChFLmVxdWFscyhbJ2EnLCAnYiddLCBbJ2EnLCAnYiddKSwgdHJ1ZSlcbiAqIGFzc2VydC5zdHJpY3RFcXVhbChFLmVxdWFscyhbJ2EnXSwgW10pLCBmYWxzZSlcbiAqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBnZXRFcSA9IGZ1bmN0aW9uIChFKSB7XG4gICAgcmV0dXJuIGZyb21FcXVhbHMoZnVuY3Rpb24gKHhzLCB5cykgeyByZXR1cm4geHMubGVuZ3RoID09PSB5cy5sZW5ndGggJiYgeHMuZXZlcnkoZnVuY3Rpb24gKHgsIGkpIHsgcmV0dXJuIEUuZXF1YWxzKHgsIHlzW2ldKTsgfSk7IH0pO1xufTtcbi8qKlxuICogRGVyaXZlcyBhbiBgT3JkYCBvdmVyIHRoZSBgUmVhZG9ubHlBcnJheWAgb2YgYSBnaXZlbiBlbGVtZW50IHR5cGUgZnJvbSB0aGUgYE9yZGAgb2YgdGhhdCB0eXBlLiBUaGUgb3JkZXJpbmcgYmV0d2VlbiB0d28gc3VjaFxuICogYXJyYXlzIGlzIGVxdWFsIHRvOiB0aGUgZmlyc3Qgbm9uIGVxdWFsIGNvbXBhcmlzb24gb2YgZWFjaCBhcnJheXMgZWxlbWVudHMgdGFrZW4gcGFpcndpc2UgaW4gaW5jcmVhc2luZyBvcmRlciwgaW5cbiAqIGNhc2Ugb2YgZXF1YWxpdHkgb3ZlciBhbGwgdGhlIHBhaXJ3aXNlIGVsZW1lbnRzOyB0aGUgbG9uZ2VzdCBhcnJheSBpcyBjb25zaWRlcmVkIHRoZSBncmVhdGVzdCwgaWYgYm90aCBhcnJheXMgaGF2ZVxuICogdGhlIHNhbWUgbGVuZ3RoLCB0aGUgcmVzdWx0IGlzIGVxdWFsaXR5LlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBnZXRPcmQgfSBmcm9tICdmcC10cy9SZWFkb25seUFycmF5J1xuICogaW1wb3J0ICogYXMgUyBmcm9tICdmcC10cy9zdHJpbmcnXG4gKlxuICogY29uc3QgTyA9IGdldE9yZChTLk9yZClcbiAqIGFzc2VydC5zdHJpY3RFcXVhbChPLmNvbXBhcmUoWydiJ10sIFsnYSddKSwgMSlcbiAqIGFzc2VydC5zdHJpY3RFcXVhbChPLmNvbXBhcmUoWydhJ10sIFsnYSddKSwgMClcbiAqIGFzc2VydC5zdHJpY3RFcXVhbChPLmNvbXBhcmUoWydhJ10sIFsnYiddKSwgLTEpXG4gKlxuICpcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIGdldE9yZCA9IGZ1bmN0aW9uIChPKSB7XG4gICAgcmV0dXJuIGZyb21Db21wYXJlKGZ1bmN0aW9uIChhLCBiKSB7XG4gICAgICAgIHZhciBhTGVuID0gYS5sZW5ndGg7XG4gICAgICAgIHZhciBiTGVuID0gYi5sZW5ndGg7XG4gICAgICAgIHZhciBsZW4gPSBNYXRoLm1pbihhTGVuLCBiTGVuKTtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBsZW47IGkrKykge1xuICAgICAgICAgICAgdmFyIG9yZGVyaW5nID0gTy5jb21wYXJlKGFbaV0sIGJbaV0pO1xuICAgICAgICAgICAgaWYgKG9yZGVyaW5nICE9PSAwKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG9yZGVyaW5nO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBOLk9yZC5jb21wYXJlKGFMZW4sIGJMZW4pO1xuICAgIH0pO1xufTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIGdldFVuaW9uU2VtaWdyb3VwID0gZnVuY3Rpb24gKEUpIHtcbiAgICB2YXIgdW5pb25FID0gdW5pb24oRSk7XG4gICAgcmV0dXJuIHtcbiAgICAgICAgY29uY2F0OiBmdW5jdGlvbiAoZmlyc3QsIHNlY29uZCkgeyByZXR1cm4gdW5pb25FKHNlY29uZCkoZmlyc3QpOyB9XG4gICAgfTtcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjExLjBcbiAqL1xuZXhwb3J0IHZhciBnZXRVbmlvbk1vbm9pZCA9IGZ1bmN0aW9uIChFKSB7IHJldHVybiAoe1xuICAgIGNvbmNhdDogZ2V0VW5pb25TZW1pZ3JvdXAoRSkuY29uY2F0LFxuICAgIGVtcHR5OiBlbXB0eVxufSk7IH07XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjExLjBcbiAqL1xuZXhwb3J0IHZhciBnZXRJbnRlcnNlY3Rpb25TZW1pZ3JvdXAgPSBmdW5jdGlvbiAoRSkge1xuICAgIHZhciBpbnRlcnNlY3Rpb25FID0gaW50ZXJzZWN0aW9uKEUpO1xuICAgIHJldHVybiB7XG4gICAgICAgIGNvbmNhdDogZnVuY3Rpb24gKGZpcnN0LCBzZWNvbmQpIHsgcmV0dXJuIGludGVyc2VjdGlvbkUoc2Vjb25kKShmaXJzdCk7IH1cbiAgICB9O1xufTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIGdldERpZmZlcmVuY2VNYWdtYSA9IGZ1bmN0aW9uIChFKSB7XG4gICAgdmFyIGRpZmZlcmVuY2VFID0gZGlmZmVyZW5jZShFKTtcbiAgICByZXR1cm4ge1xuICAgICAgICBjb25jYXQ6IGZ1bmN0aW9uIChmaXJzdCwgc2Vjb25kKSB7IHJldHVybiBkaWZmZXJlbmNlRShzZWNvbmQpKGZpcnN0KTsgfVxuICAgIH07XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi43LjBcbiAqL1xuZXhwb3J0IHZhciBGdW5jdG9yID0ge1xuICAgIFVSSTogVVJJLFxuICAgIG1hcDogX21hcFxufTtcbi8qKlxuICogQGNhdGVnb3J5IG1hcHBpbmdcbiAqIEBzaW5jZSAyLjEwLjBcbiAqL1xuZXhwb3J0IHZhciBmbGFwID0gLyojX19QVVJFX18qLyBmbGFwXyhGdW5jdG9yKTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuMTAuMFxuICovXG5leHBvcnQgdmFyIFBvaW50ZWQgPSB7XG4gICAgVVJJOiBVUkksXG4gICAgb2Y6IG9mXG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi43LjBcbiAqL1xuZXhwb3J0IHZhciBGdW5jdG9yV2l0aEluZGV4ID0ge1xuICAgIFVSSTogVVJJLFxuICAgIG1hcDogX21hcCxcbiAgICBtYXBXaXRoSW5kZXg6IF9tYXBXaXRoSW5kZXhcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjEwLjBcbiAqL1xuZXhwb3J0IHZhciBBcHBseSA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICBtYXA6IF9tYXAsXG4gICAgYXA6IF9hcFxufTtcbi8qKlxuICogQ29tYmluZSB0d28gZWZmZWN0ZnVsIGFjdGlvbnMsIGtlZXBpbmcgb25seSB0aGUgcmVzdWx0IG9mIHRoZSBmaXJzdC5cbiAqXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBhcEZpcnN0ID0gLyojX19QVVJFX18qLyBhcEZpcnN0XyhBcHBseSk7XG4vKipcbiAqIENvbWJpbmUgdHdvIGVmZmVjdGZ1bCBhY3Rpb25zLCBrZWVwaW5nIG9ubHkgdGhlIHJlc3VsdCBvZiB0aGUgc2Vjb25kLlxuICpcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIGFwU2Vjb25kID0gLyojX19QVVJFX18qLyBhcFNlY29uZF8oQXBwbHkpO1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi43LjBcbiAqL1xuZXhwb3J0IHZhciBBcHBsaWNhdGl2ZSA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICBtYXA6IF9tYXAsXG4gICAgYXA6IF9hcCxcbiAgICBvZjogb2Zcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjEwLjBcbiAqL1xuZXhwb3J0IHZhciBDaGFpbiA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICBtYXA6IF9tYXAsXG4gICAgYXA6IF9hcCxcbiAgICBjaGFpbjogZmxhdE1hcFxufTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuNy4wXG4gKi9cbmV4cG9ydCB2YXIgTW9uYWQgPSB7XG4gICAgVVJJOiBVUkksXG4gICAgbWFwOiBfbWFwLFxuICAgIGFwOiBfYXAsXG4gICAgb2Y6IG9mLFxuICAgIGNoYWluOiBmbGF0TWFwXG59O1xuLyoqXG4gKiBDb21wb3NlcyBjb21wdXRhdGlvbnMgaW4gc2VxdWVuY2UsIHVzaW5nIHRoZSByZXR1cm4gdmFsdWUgb2Ygb25lIGNvbXB1dGF0aW9uIHRvIGRldGVybWluZSB0aGUgbmV4dCBjb21wdXRhdGlvbiBhbmRcbiAqIGtlZXBpbmcgb25seSB0aGUgcmVzdWx0IG9mIHRoZSBmaXJzdC5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0ICogYXMgUkEgZnJvbSAnZnAtdHMvUmVhZG9ubHlBcnJheSdcbiAqIGltcG9ydCB7IHBpcGUgfSBmcm9tICdmcC10cy9mdW5jdGlvbidcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKFxuICogICBwaXBlKFxuICogICAgIFsxLCAyLCAzXSxcbiAqICAgICBSQS5jaGFpbkZpcnN0KCgpID0+IFsnYScsICdiJ10pXG4gKiAgICksXG4gKiAgIFsxLCAxLCAyLCAyLCAzLCAzXVxuICogKVxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChcbiAqICAgcGlwZShcbiAqICAgICBbMSwgMiwgM10sXG4gKiAgICAgUkEuY2hhaW5GaXJzdCgoKSA9PiBbXSlcbiAqICAgKSxcbiAqICAgW11cbiAqIClcbiAqXG4gKiBAY2F0ZWdvcnkgc2VxdWVuY2luZ1xuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgY2hhaW5GaXJzdCA9IFxuLyojX19QVVJFX18qLyBjaGFpbkZpcnN0XyhDaGFpbik7XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjcuMFxuICovXG5leHBvcnQgdmFyIFVuZm9sZGFibGUgPSB7XG4gICAgVVJJOiBVUkksXG4gICAgdW5mb2xkOiB1bmZvbGRcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjcuMFxuICovXG5leHBvcnQgdmFyIEFsdCA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICBtYXA6IF9tYXAsXG4gICAgYWx0OiBfYWx0XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi4xMS4wXG4gKi9cbmV4cG9ydCB2YXIgWmVybyA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICB6ZXJvOiB6ZXJvXG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgZG8gbm90YXRpb25cbiAqIEBzaW5jZSAyLjExLjBcbiAqL1xuZXhwb3J0IHZhciBndWFyZCA9IC8qI19fUFVSRV9fKi8gZ3VhcmRfKFplcm8sIFBvaW50ZWQpO1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi43LjBcbiAqL1xuZXhwb3J0IHZhciBBbHRlcm5hdGl2ZSA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICBtYXA6IF9tYXAsXG4gICAgYXA6IF9hcCxcbiAgICBvZjogb2YsXG4gICAgYWx0OiBfYWx0LFxuICAgIHplcm86IHplcm9cbn07XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjcuMFxuICovXG5leHBvcnQgdmFyIEV4dGVuZCA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICBtYXA6IF9tYXAsXG4gICAgZXh0ZW5kOiBfZXh0ZW5kXG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi43LjBcbiAqL1xuZXhwb3J0IHZhciBDb21wYWN0YWJsZSA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICBjb21wYWN0OiBjb21wYWN0LFxuICAgIHNlcGFyYXRlOiBzZXBhcmF0ZVxufTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuNy4wXG4gKi9cbmV4cG9ydCB2YXIgRmlsdGVyYWJsZSA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICBtYXA6IF9tYXAsXG4gICAgY29tcGFjdDogY29tcGFjdCxcbiAgICBzZXBhcmF0ZTogc2VwYXJhdGUsXG4gICAgZmlsdGVyOiBfZmlsdGVyLFxuICAgIGZpbHRlck1hcDogX2ZpbHRlck1hcCxcbiAgICBwYXJ0aXRpb246IF9wYXJ0aXRpb24sXG4gICAgcGFydGl0aW9uTWFwOiBfcGFydGl0aW9uTWFwXG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi43LjBcbiAqL1xuZXhwb3J0IHZhciBGaWx0ZXJhYmxlV2l0aEluZGV4ID0ge1xuICAgIFVSSTogVVJJLFxuICAgIG1hcDogX21hcCxcbiAgICBtYXBXaXRoSW5kZXg6IF9tYXBXaXRoSW5kZXgsXG4gICAgY29tcGFjdDogY29tcGFjdCxcbiAgICBzZXBhcmF0ZTogc2VwYXJhdGUsXG4gICAgZmlsdGVyOiBfZmlsdGVyLFxuICAgIGZpbHRlck1hcDogX2ZpbHRlck1hcCxcbiAgICBwYXJ0aXRpb246IF9wYXJ0aXRpb24sXG4gICAgcGFydGl0aW9uTWFwOiBfcGFydGl0aW9uTWFwLFxuICAgIHBhcnRpdGlvbk1hcFdpdGhJbmRleDogX3BhcnRpdGlvbk1hcFdpdGhJbmRleCxcbiAgICBwYXJ0aXRpb25XaXRoSW5kZXg6IF9wYXJ0aXRpb25XaXRoSW5kZXgsXG4gICAgZmlsdGVyTWFwV2l0aEluZGV4OiBfZmlsdGVyTWFwV2l0aEluZGV4LFxuICAgIGZpbHRlcldpdGhJbmRleDogX2ZpbHRlcldpdGhJbmRleFxufTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuNy4wXG4gKi9cbmV4cG9ydCB2YXIgRm9sZGFibGUgPSB7XG4gICAgVVJJOiBVUkksXG4gICAgcmVkdWNlOiBfcmVkdWNlLFxuICAgIGZvbGRNYXA6IF9mb2xkTWFwLFxuICAgIHJlZHVjZVJpZ2h0OiBfcmVkdWNlUmlnaHRcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjcuMFxuICovXG5leHBvcnQgdmFyIEZvbGRhYmxlV2l0aEluZGV4ID0ge1xuICAgIFVSSTogVVJJLFxuICAgIHJlZHVjZTogX3JlZHVjZSxcbiAgICBmb2xkTWFwOiBfZm9sZE1hcCxcbiAgICByZWR1Y2VSaWdodDogX3JlZHVjZVJpZ2h0LFxuICAgIHJlZHVjZVdpdGhJbmRleDogX3JlZHVjZVdpdGhJbmRleCxcbiAgICBmb2xkTWFwV2l0aEluZGV4OiBfZm9sZE1hcFdpdGhJbmRleCxcbiAgICByZWR1Y2VSaWdodFdpdGhJbmRleDogX3JlZHVjZVJpZ2h0V2l0aEluZGV4XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi43LjBcbiAqL1xuZXhwb3J0IHZhciBUcmF2ZXJzYWJsZSA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICBtYXA6IF9tYXAsXG4gICAgcmVkdWNlOiBfcmVkdWNlLFxuICAgIGZvbGRNYXA6IF9mb2xkTWFwLFxuICAgIHJlZHVjZVJpZ2h0OiBfcmVkdWNlUmlnaHQsXG4gICAgdHJhdmVyc2U6IF90cmF2ZXJzZSxcbiAgICBzZXF1ZW5jZTogc2VxdWVuY2Vcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjcuMFxuICovXG5leHBvcnQgdmFyIFRyYXZlcnNhYmxlV2l0aEluZGV4ID0ge1xuICAgIFVSSTogVVJJLFxuICAgIG1hcDogX21hcCxcbiAgICBtYXBXaXRoSW5kZXg6IF9tYXBXaXRoSW5kZXgsXG4gICAgcmVkdWNlOiBfcmVkdWNlLFxuICAgIGZvbGRNYXA6IF9mb2xkTWFwLFxuICAgIHJlZHVjZVJpZ2h0OiBfcmVkdWNlUmlnaHQsXG4gICAgcmVkdWNlV2l0aEluZGV4OiBfcmVkdWNlV2l0aEluZGV4LFxuICAgIGZvbGRNYXBXaXRoSW5kZXg6IF9mb2xkTWFwV2l0aEluZGV4LFxuICAgIHJlZHVjZVJpZ2h0V2l0aEluZGV4OiBfcmVkdWNlUmlnaHRXaXRoSW5kZXgsXG4gICAgdHJhdmVyc2U6IF90cmF2ZXJzZSxcbiAgICBzZXF1ZW5jZTogc2VxdWVuY2UsXG4gICAgdHJhdmVyc2VXaXRoSW5kZXg6IF90cmF2ZXJzZVdpdGhJbmRleFxufTtcbi8qKlxuICogQGNhdGVnb3J5IHNlcXVlbmNpbmdcbiAqIEBzaW5jZSAyLjExLjBcbiAqL1xuZXhwb3J0IHZhciBjaGFpblJlY0RlcHRoRmlyc3QgPSBmdW5jdGlvbiAoZikge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYSkge1xuICAgICAgICB2YXIgdG9kbyA9IF9fc3ByZWFkQXJyYXkoW10sIGYoYSksIHRydWUpO1xuICAgICAgICB2YXIgb3V0ID0gW107XG4gICAgICAgIHdoaWxlICh0b2RvLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgIHZhciBlID0gdG9kby5zaGlmdCgpO1xuICAgICAgICAgICAgaWYgKF8uaXNMZWZ0KGUpKSB7XG4gICAgICAgICAgICAgICAgdG9kby51bnNoaWZ0LmFwcGx5KHRvZG8sIGYoZS5sZWZ0KSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBvdXQucHVzaChlLnJpZ2h0KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gb3V0O1xuICAgIH07XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi4xMS4wXG4gKi9cbmV4cG9ydCB2YXIgQ2hhaW5SZWNEZXB0aEZpcnN0ID0ge1xuICAgIFVSSTogVVJJLFxuICAgIG1hcDogX21hcCxcbiAgICBhcDogX2FwLFxuICAgIGNoYWluOiBmbGF0TWFwLFxuICAgIGNoYWluUmVjOiBfY2hhaW5SZWNEZXB0aEZpcnN0XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgc2VxdWVuY2luZ1xuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIGNoYWluUmVjQnJlYWR0aEZpcnN0ID0gZnVuY3Rpb24gKGYpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGEpIHtcbiAgICAgICAgdmFyIGluaXRpYWwgPSBmKGEpO1xuICAgICAgICB2YXIgdG9kbyA9IFtdO1xuICAgICAgICB2YXIgb3V0ID0gW107XG4gICAgICAgIGZ1bmN0aW9uIGdvKGUpIHtcbiAgICAgICAgICAgIGlmIChfLmlzTGVmdChlKSkge1xuICAgICAgICAgICAgICAgIGYoZS5sZWZ0KS5mb3JFYWNoKGZ1bmN0aW9uICh2KSB7IHJldHVybiB0b2RvLnB1c2godik7IH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgb3V0LnB1c2goZS5yaWdodCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZm9yICh2YXIgX2kgPSAwLCBpbml0aWFsXzEgPSBpbml0aWFsOyBfaSA8IGluaXRpYWxfMS5sZW5ndGg7IF9pKyspIHtcbiAgICAgICAgICAgIHZhciBlID0gaW5pdGlhbF8xW19pXTtcbiAgICAgICAgICAgIGdvKGUpO1xuICAgICAgICB9XG4gICAgICAgIHdoaWxlICh0b2RvLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgIGdvKHRvZG8uc2hpZnQoKSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG91dDtcbiAgICB9O1xufTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIENoYWluUmVjQnJlYWR0aEZpcnN0ID0ge1xuICAgIFVSSTogVVJJLFxuICAgIG1hcDogX21hcCxcbiAgICBhcDogX2FwLFxuICAgIGNoYWluOiBmbGF0TWFwLFxuICAgIGNoYWluUmVjOiBfY2hhaW5SZWNCcmVhZHRoRmlyc3Rcbn07XG52YXIgX3dpdGhlciA9IC8qI19fUFVSRV9fKi8gd2l0aGVyRGVmYXVsdChUcmF2ZXJzYWJsZSwgQ29tcGFjdGFibGUpO1xudmFyIF93aWx0ID0gLyojX19QVVJFX18qLyB3aWx0RGVmYXVsdChUcmF2ZXJzYWJsZSwgQ29tcGFjdGFibGUpO1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi43LjBcbiAqL1xuZXhwb3J0IHZhciBXaXRoZXJhYmxlID0ge1xuICAgIFVSSTogVVJJLFxuICAgIG1hcDogX21hcCxcbiAgICBjb21wYWN0OiBjb21wYWN0LFxuICAgIHNlcGFyYXRlOiBzZXBhcmF0ZSxcbiAgICBmaWx0ZXI6IF9maWx0ZXIsXG4gICAgZmlsdGVyTWFwOiBfZmlsdGVyTWFwLFxuICAgIHBhcnRpdGlvbjogX3BhcnRpdGlvbixcbiAgICBwYXJ0aXRpb25NYXA6IF9wYXJ0aXRpb25NYXAsXG4gICAgcmVkdWNlOiBfcmVkdWNlLFxuICAgIGZvbGRNYXA6IF9mb2xkTWFwLFxuICAgIHJlZHVjZVJpZ2h0OiBfcmVkdWNlUmlnaHQsXG4gICAgdHJhdmVyc2U6IF90cmF2ZXJzZSxcbiAgICBzZXF1ZW5jZTogc2VxdWVuY2UsXG4gICAgd2l0aGVyOiBfd2l0aGVyLFxuICAgIHdpbHQ6IF93aWx0XG59O1xuLyoqXG4gKiBGaWx0ZXIgdmFsdWVzIGluc2lkZSBhIGNvbnRleHQuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IHBpcGUgfSBmcm9tICdmcC10cy9mdW5jdGlvbidcbiAqIGltcG9ydCAqIGFzIFJBIGZyb20gJ2ZwLXRzL1JlYWRvbmx5QXJyYXknXG4gKiBpbXBvcnQgKiBhcyBUIGZyb20gJ2ZwLXRzL1Rhc2snXG4gKlxuICogY29uc3QgZmlsdGVyRSA9IFJBLmZpbHRlckUoVC5BcHBsaWNhdGl2ZVBhcilcbiAqIGFzeW5jIGZ1bmN0aW9uIHRlc3QoKSB7XG4gKiAgIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoXG4gKiAgICAgYXdhaXQgcGlwZShcbiAqICAgICAgIFstMSwgMiwgM10sXG4gKiAgICAgICBmaWx0ZXJFKChuKSA9PiBULm9mKG4gPiAwKSlcbiAqICAgICApKCksXG4gKiAgICAgWzIsIDNdXG4gKiAgIClcbiAqIH1cbiAqIHRlc3QoKVxuICpcbiAqIEBzaW5jZSAyLjExLjBcbiAqL1xuZXhwb3J0IHZhciBmaWx0ZXJFID0gLyojX19QVVJFX18qLyBmaWx0ZXJFXyhXaXRoZXJhYmxlKTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIEZyb21FaXRoZXIgPSB7XG4gICAgVVJJOiBVUkksXG4gICAgZnJvbUVpdGhlcjogZnJvbUVpdGhlclxufTtcbi8qKlxuICogQGNhdGVnb3J5IGxpZnRpbmdcbiAqIEBzaW5jZSAyLjExLjBcbiAqL1xuZXhwb3J0IHZhciBmcm9tRWl0aGVySyA9IC8qI19fUFVSRV9fKi8gZnJvbUVpdGhlcktfKEZyb21FaXRoZXIpO1xuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLy8gdW5zYWZlXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vKipcbiAqIEBjYXRlZ29yeSB1bnNhZmVcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIHVuc2FmZUluc2VydEF0ID0gUk5FQS51bnNhZmVJbnNlcnRBdDtcbi8qKlxuICogQGNhdGVnb3J5IHVuc2FmZVxuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgdW5zYWZlVXBkYXRlQXQgPSBmdW5jdGlvbiAoaSwgYSwgYXMpIHtcbiAgICByZXR1cm4gaXNOb25FbXB0eShhcykgPyBSTkVBLnVuc2FmZVVwZGF0ZUF0KGksIGEsIGFzKSA6IGFzO1xufTtcbi8qKlxuICogQGNhdGVnb3J5IHVuc2FmZVxuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgdW5zYWZlRGVsZXRlQXQgPSBmdW5jdGlvbiAoaSwgYXMpIHtcbiAgICB2YXIgeHMgPSBhcy5zbGljZSgpO1xuICAgIHhzLnNwbGljZShpLCAxKTtcbiAgICByZXR1cm4geHM7XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgY29udmVyc2lvbnNcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIHRvQXJyYXkgPSBmdW5jdGlvbiAoYXMpIHsgcmV0dXJuIGFzLnNsaWNlKCk7IH07XG4vKipcbiAqIEBjYXRlZ29yeSBjb252ZXJzaW9uc1xuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgZnJvbUFycmF5ID0gZnVuY3Rpb24gKGFzKSB7IHJldHVybiAoaXNFbXB0eShhcykgPyBlbXB0eSA6IGFzLnNsaWNlKCkpOyB9O1xuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLy8gdXRpbHNcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8qKlxuICogQW4gZW1wdHkgYXJyYXlcbiAqXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBlbXB0eSA9IFJORUEuZW1wdHk7XG5leHBvcnQgZnVuY3Rpb24gZXZlcnkocHJlZGljYXRlKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykgeyByZXR1cm4gYXMuZXZlcnkocHJlZGljYXRlKTsgfTtcbn1cbi8qKlxuICogQ2hlY2sgaWYgYSBwcmVkaWNhdGUgaG9sZHMgdHJ1ZSBmb3IgYW55IGFycmF5IG1lbWJlci5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgc29tZSB9IGZyb20gJ2ZwLXRzL1JlYWRvbmx5QXJyYXknXG4gKiBpbXBvcnQgeyBwaXBlIH0gZnJvbSAnZnAtdHMvZnVuY3Rpb24nXG4gKlxuICogY29uc3QgaXNQb3NpdGl2ZSA9IChuOiBudW1iZXIpOiBib29sZWFuID0+IG4gPiAwXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChwaXBlKFstMSwgLTIsIDNdLCBzb21lKGlzUG9zaXRpdmUpKSwgdHJ1ZSlcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwocGlwZShbLTEsIC0yLCAtM10sIHNvbWUoaXNQb3NpdGl2ZSkpLCBmYWxzZSlcbiAqXG4gKiBAc2luY2UgMi45LjBcbiAqL1xuZXhwb3J0IHZhciBzb21lID0gZnVuY3Rpb24gKHByZWRpY2F0ZSkge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgcmV0dXJuIGFzLnNvbWUocHJlZGljYXRlKTtcbiAgICB9O1xufTtcbi8qKlxuICogQWxpYXMgb2YgW2Bzb21lYF0oI3NvbWUpXG4gKlxuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIGV4aXN0cyA9IHNvbWU7XG4vKipcbiAqIFBsYWNlcyBhbiBlbGVtZW50IGluIGJldHdlZW4gbWVtYmVycyBvZiBhIGBSZWFkb25seUFycmF5YCwgdGhlbiBmb2xkcyB0aGUgcmVzdWx0cyB1c2luZyB0aGUgcHJvdmlkZWQgYE1vbm9pZGAuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCAqIGFzIFMgZnJvbSAnZnAtdHMvc3RyaW5nJ1xuICogaW1wb3J0IHsgaW50ZXJjYWxhdGUgfSBmcm9tICdmcC10cy9SZWFkb25seUFycmF5J1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoaW50ZXJjYWxhdGUoUy5Nb25vaWQpKCctJykoWydhJywgJ2InLCAnYyddKSwgJ2EtYi1jJylcbiAqXG4gKiBAc2luY2UgMi4xMi4wXG4gKi9cbmV4cG9ydCB2YXIgaW50ZXJjYWxhdGUgPSBmdW5jdGlvbiAoTSkge1xuICAgIHZhciBpbnRlcmNhbGF0ZU0gPSBSTkVBLmludGVyY2FsYXRlKE0pO1xuICAgIHJldHVybiBmdW5jdGlvbiAobWlkZGxlKSB7IHJldHVybiBtYXRjaChmdW5jdGlvbiAoKSB7IHJldHVybiBNLmVtcHR5OyB9LCBpbnRlcmNhbGF0ZU0obWlkZGxlKSk7IH07XG59O1xuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLy8gZG8gbm90YXRpb25cbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8qKlxuICogQGNhdGVnb3J5IGRvIG5vdGF0aW9uXG4gKiBAc2luY2UgMi45LjBcbiAqL1xuZXhwb3J0IHZhciBEbyA9IC8qI19fUFVSRV9fKi8gb2YoXy5lbXB0eVJlY29yZCk7XG4vKipcbiAqIEBjYXRlZ29yeSBkbyBub3RhdGlvblxuICogQHNpbmNlIDIuOC4wXG4gKi9cbmV4cG9ydCB2YXIgYmluZFRvID0gLyojX19QVVJFX18qLyBiaW5kVG9fKEZ1bmN0b3IpO1xudmFyIGxldF8gPSAvKiNfX1BVUkVfXyovIGxldF9fKEZ1bmN0b3IpO1xuZXhwb3J0IHsgXG4vKipcbiAqIEBjYXRlZ29yeSBkbyBub3RhdGlvblxuICogQHNpbmNlIDIuMTMuMFxuICovXG5sZXRfIGFzIGxldCB9O1xuLyoqXG4gKiBAY2F0ZWdvcnkgZG8gbm90YXRpb25cbiAqIEBzaW5jZSAyLjguMFxuICovXG5leHBvcnQgdmFyIGJpbmQgPSAvKiNfX1BVUkVfXyovIGJpbmRfKENoYWluKTtcbi8qKlxuICogQGNhdGVnb3J5IGRvIG5vdGF0aW9uXG4gKiBAc2luY2UgMi44LjBcbiAqL1xuZXhwb3J0IHZhciBhcFMgPSAvKiNfX1BVUkVfXyovIGFwU18oQXBwbHkpO1xuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLy8gbGVnYWN5XG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vKipcbiAqIEFsaWFzIG9mIGBmbGF0TWFwYC5cbiAqXG4gKiBAY2F0ZWdvcnkgbGVnYWN5XG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBjaGFpbiA9IGZsYXRNYXA7XG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vLyBkZXByZWNhdGVkXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vKipcbiAqIFVzZSBgUmVhZG9ubHlOb25FbXB0eUFycmF5YCBtb2R1bGUgaW5zdGVhZC5cbiAqXG4gKiBAY2F0ZWdvcnkgem9uZSBvZiBkZWF0aFxuICogQHNpbmNlIDIuNS4wXG4gKiBAZGVwcmVjYXRlZFxuICovXG5leHBvcnQgdmFyIHJhbmdlID0gUk5FQS5yYW5nZTtcbi8qKlxuICogVXNlIFtgcHJlcGVuZGBdKCNwcmVwZW5kKSBpbnN0ZWFkLlxuICpcbiAqIEBjYXRlZ29yeSB6b25lIG9mIGRlYXRoXG4gKiBAc2luY2UgMi41LjBcbiAqIEBkZXByZWNhdGVkXG4gKi9cbmV4cG9ydCB2YXIgY29ucyA9IFJORUEuY29ucztcbi8qKlxuICogVXNlIFtgYXBwZW5kYF0oI2FwcGVuZCkgaW5zdGVhZC5cbiAqXG4gKiBAY2F0ZWdvcnkgem9uZSBvZiBkZWF0aFxuICogQHNpbmNlIDIuNS4wXG4gKiBAZGVwcmVjYXRlZFxuICovXG5leHBvcnQgdmFyIHNub2MgPSBSTkVBLnNub2M7XG4vKipcbiAqIFVzZSBbYHByZXBlbmRBbGxgXSgjcHJlcGVuZGFsbCkgaW5zdGVhZC5cbiAqXG4gKiBAY2F0ZWdvcnkgem9uZSBvZiBkZWF0aFxuICogQHNpbmNlIDIuOS4wXG4gKiBAZGVwcmVjYXRlZFxuICovXG5leHBvcnQgdmFyIHByZXBlbmRUb0FsbCA9IHByZXBlbmRBbGw7XG4vKipcbiAqIFRoaXMgaW5zdGFuY2UgaXMgZGVwcmVjYXRlZCwgdXNlIHNtYWxsLCBzcGVjaWZpYyBpbnN0YW5jZXMgaW5zdGVhZC5cbiAqIEZvciBleGFtcGxlIGlmIGEgZnVuY3Rpb24gbmVlZHMgYSBgRnVuY3RvcmAgaW5zdGFuY2UsIHBhc3MgYFJBLkZ1bmN0b3JgIGluc3RlYWQgb2YgYFJBLnJlYWRvbmx5QXJyYXlgXG4gKiAod2hlcmUgYFJBYCBpcyBmcm9tIGBpbXBvcnQgUkEgZnJvbSAnZnAtdHMvUmVhZG9ubHlBcnJheSdgKVxuICpcbiAqIEBjYXRlZ29yeSB6b25lIG9mIGRlYXRoXG4gKiBAc2luY2UgMi41LjBcbiAqIEBkZXByZWNhdGVkXG4gKi9cbmV4cG9ydCB2YXIgcmVhZG9ubHlBcnJheSA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICBjb21wYWN0OiBjb21wYWN0LFxuICAgIHNlcGFyYXRlOiBzZXBhcmF0ZSxcbiAgICBtYXA6IF9tYXAsXG4gICAgYXA6IF9hcCxcbiAgICBvZjogb2YsXG4gICAgY2hhaW46IGZsYXRNYXAsXG4gICAgZmlsdGVyOiBfZmlsdGVyLFxuICAgIGZpbHRlck1hcDogX2ZpbHRlck1hcCxcbiAgICBwYXJ0aXRpb246IF9wYXJ0aXRpb24sXG4gICAgcGFydGl0aW9uTWFwOiBfcGFydGl0aW9uTWFwLFxuICAgIG1hcFdpdGhJbmRleDogX21hcFdpdGhJbmRleCxcbiAgICBwYXJ0aXRpb25NYXBXaXRoSW5kZXg6IF9wYXJ0aXRpb25NYXBXaXRoSW5kZXgsXG4gICAgcGFydGl0aW9uV2l0aEluZGV4OiBfcGFydGl0aW9uV2l0aEluZGV4LFxuICAgIGZpbHRlck1hcFdpdGhJbmRleDogX2ZpbHRlck1hcFdpdGhJbmRleCxcbiAgICBmaWx0ZXJXaXRoSW5kZXg6IF9maWx0ZXJXaXRoSW5kZXgsXG4gICAgYWx0OiBfYWx0LFxuICAgIHplcm86IHplcm8sXG4gICAgdW5mb2xkOiB1bmZvbGQsXG4gICAgcmVkdWNlOiBfcmVkdWNlLFxuICAgIGZvbGRNYXA6IF9mb2xkTWFwLFxuICAgIHJlZHVjZVJpZ2h0OiBfcmVkdWNlUmlnaHQsXG4gICAgdHJhdmVyc2U6IF90cmF2ZXJzZSxcbiAgICBzZXF1ZW5jZTogc2VxdWVuY2UsXG4gICAgcmVkdWNlV2l0aEluZGV4OiBfcmVkdWNlV2l0aEluZGV4LFxuICAgIGZvbGRNYXBXaXRoSW5kZXg6IF9mb2xkTWFwV2l0aEluZGV4LFxuICAgIHJlZHVjZVJpZ2h0V2l0aEluZGV4OiBfcmVkdWNlUmlnaHRXaXRoSW5kZXgsXG4gICAgdHJhdmVyc2VXaXRoSW5kZXg6IF90cmF2ZXJzZVdpdGhJbmRleCxcbiAgICBleHRlbmQ6IF9leHRlbmQsXG4gICAgd2l0aGVyOiBfd2l0aGVyLFxuICAgIHdpbHQ6IF93aWx0XG59O1xuIiwKICAiaW1wb3J0IHsgYXBGaXJzdCBhcyBhcEZpcnN0XywgYXBTIGFzIGFwU18sIGFwU2Vjb25kIGFzIGFwU2Vjb25kXyB9IGZyb20gJy4vQXBwbHknO1xuaW1wb3J0IHsgYmluZCBhcyBiaW5kXywgY2hhaW5GaXJzdCBhcyBjaGFpbkZpcnN0XyB9IGZyb20gJy4vQ2hhaW4nO1xuaW1wb3J0IHsgZnJvbUVpdGhlcksgYXMgZnJvbUVpdGhlcktfIH0gZnJvbSAnLi9Gcm9tRWl0aGVyJztcbmltcG9ydCB7IGR1YWwsIGlkZW50aXR5LCBwaXBlIH0gZnJvbSAnLi9mdW5jdGlvbic7XG5pbXBvcnQgeyBiaW5kVG8gYXMgYmluZFRvXywgZmxhcCBhcyBmbGFwXywgbGV0IGFzIGxldF9fIH0gZnJvbSAnLi9GdW5jdG9yJztcbmltcG9ydCAqIGFzIF8gZnJvbSAnLi9pbnRlcm5hbCc7XG5pbXBvcnQgKiBhcyBORUEgZnJvbSAnLi9Ob25FbXB0eUFycmF5JztcbmltcG9ydCAqIGFzIFJBIGZyb20gJy4vUmVhZG9ubHlBcnJheSc7XG5pbXBvcnQgeyBzZXBhcmF0ZWQgfSBmcm9tICcuL1NlcGFyYXRlZCc7XG5pbXBvcnQgeyBmaWx0ZXJFIGFzIGZpbHRlckVfLCB3aWx0RGVmYXVsdCwgd2l0aGVyRGVmYXVsdCB9IGZyb20gJy4vV2l0aGVyYWJsZSc7XG5pbXBvcnQgeyBndWFyZCBhcyBndWFyZF8gfSBmcm9tICcuL1plcm8nO1xuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLy8gcmVmaW5lbWVudHNcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8qKlxuICogVGVzdCB3aGV0aGVyIGFuIGFycmF5IGlzIGVtcHR5XG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IGlzRW1wdHkgfSBmcm9tICdmcC10cy9BcnJheSdcbiAqXG4gKiBhc3NlcnQuc3RyaWN0RXF1YWwoaXNFbXB0eShbXSksIHRydWUpXG4gKiBhc3NlcnQuc3RyaWN0RXF1YWwoaXNFbXB0eShbJ2EnXSksIGZhbHNlKVxuICpcbiAqIEBjYXRlZ29yeSByZWZpbmVtZW50c1xuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgaXNFbXB0eSA9IGZ1bmN0aW9uIChhcykgeyByZXR1cm4gYXMubGVuZ3RoID09PSAwOyB9O1xuLyoqXG4gKiBUZXN0IHdoZXRoZXIgYW4gYXJyYXkgaXMgbm9uIGVtcHR5IG5hcnJvd2luZyBkb3duIHRoZSB0eXBlIHRvIGBOb25FbXB0eUFycmF5PEE+YFxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBpc05vbkVtcHR5IH0gZnJvbSAnZnAtdHMvQXJyYXknXG4gKlxuICogYXNzZXJ0LnN0cmljdEVxdWFsKGlzTm9uRW1wdHkoW10pLCBmYWxzZSlcbiAqIGFzc2VydC5zdHJpY3RFcXVhbChpc05vbkVtcHR5KFsnYSddKSwgdHJ1ZSlcbiAqXG4gKiBAY2F0ZWdvcnkgcmVmaW5lbWVudHNcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIGlzTm9uRW1wdHkgPSBORUEuaXNOb25FbXB0eTtcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8vIGNvbnN0cnVjdG9yc1xuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLyoqXG4gKiBQcmVwZW5kIGFuIGVsZW1lbnQgdG8gdGhlIGZyb250IG9mIGEgYEFycmF5YCwgY3JlYXRpbmcgYSBuZXcgYE5vbkVtcHR5QXJyYXlgLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBwcmVwZW5kIH0gZnJvbSAnZnAtdHMvQXJyYXknXG4gKiBpbXBvcnQgeyBwaXBlIH0gZnJvbSAnZnAtdHMvZnVuY3Rpb24nXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChwaXBlKFsyLCAzLCA0XSwgcHJlcGVuZCgxKSksIFsxLCAyLCAzLCA0XSlcbiAqXG4gKiBAc2luY2UgMi4xMC4wXG4gKi9cbmV4cG9ydCB2YXIgcHJlcGVuZCA9IE5FQS5wcmVwZW5kO1xuLyoqXG4gKiBMZXNzIHN0cmljdCB2ZXJzaW9uIG9mIFtgcHJlcGVuZGBdKCNwcmVwZW5kKS5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgcHJlcGVuZFcgfSBmcm9tICdmcC10cy9BcnJheSdcbiAqIGltcG9ydCB7IHBpcGUgfSBmcm9tICdmcC10cy9mdW5jdGlvbidcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKHBpcGUoWzIsIDMsIDRdLCBwcmVwZW5kVyhcImFcIikpLCBbXCJhXCIsIDIsIDMsIDRdKTtcbiAqXG4gKiBAc2luY2UgMi4xMS4wXG4gKi9cbmV4cG9ydCB2YXIgcHJlcGVuZFcgPSBORUEucHJlcGVuZFc7XG4vKipcbiAqIEFwcGVuZCBhbiBlbGVtZW50IHRvIHRoZSBlbmQgb2YgYSBgQXJyYXlgLCBjcmVhdGluZyBhIG5ldyBgTm9uRW1wdHlBcnJheWAuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IGFwcGVuZCB9IGZyb20gJ2ZwLXRzL0FycmF5J1xuICogaW1wb3J0IHsgcGlwZSB9IGZyb20gJ2ZwLXRzL2Z1bmN0aW9uJ1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwocGlwZShbMSwgMiwgM10sIGFwcGVuZCg0KSksIFsxLCAyLCAzLCA0XSlcbiAqXG4gKiBAc2luY2UgMi4xMC4wXG4gKi9cbmV4cG9ydCB2YXIgYXBwZW5kID0gTkVBLmFwcGVuZDtcbi8qKlxuICogTGVzcyBzdHJpY3QgdmVyc2lvbiBvZiBbYGFwcGVuZGBdKCNhcHBlbmQpLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBhcHBlbmRXIH0gZnJvbSAnZnAtdHMvQXJyYXknXG4gKiBpbXBvcnQgeyBwaXBlIH0gZnJvbSAnZnAtdHMvZnVuY3Rpb24nXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChwaXBlKFsxLCAyLCAzXSwgYXBwZW5kVyhcImRcIikpLCBbMSwgMiwgMywgXCJkXCJdKTtcbiAqXG4gKiBAc2luY2UgMi4xMS4wXG4gKi9cbmV4cG9ydCB2YXIgYXBwZW5kVyA9IE5FQS5hcHBlbmRXO1xuLyoqXG4gKiBSZXR1cm4gYSBgQXJyYXlgIG9mIGxlbmd0aCBgbmAgd2l0aCBlbGVtZW50IGBpYCBpbml0aWFsaXplZCB3aXRoIGBmKGkpYC5cbiAqXG4gKiAqKk5vdGUqKi4gYG5gIGlzIG5vcm1hbGl6ZWQgdG8gYSBub24gbmVnYXRpdmUgaW50ZWdlci5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgbWFrZUJ5IH0gZnJvbSAnZnAtdHMvQXJyYXknXG4gKlxuICogY29uc3QgZG91YmxlID0gKGk6IG51bWJlcik6IG51bWJlciA9PiBpICogMlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChtYWtlQnkoNSwgZG91YmxlKSwgWzAsIDIsIDQsIDYsIDhdKVxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChtYWtlQnkoLTMsIGRvdWJsZSksIFtdKVxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChtYWtlQnkoNC4zMjE2NCwgZG91YmxlKSwgWzAsIDIsIDQsIDZdKVxuICpcbiAqIEBjYXRlZ29yeSBjb25zdHJ1Y3RvcnNcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIG1ha2VCeSA9IGZ1bmN0aW9uIChuLCBmKSB7IHJldHVybiAobiA8PSAwID8gW10gOiBORUEubWFrZUJ5KGYpKG4pKTsgfTtcbi8qKlxuICogQ3JlYXRlIGEgYEFycmF5YCBjb250YWluaW5nIGEgdmFsdWUgcmVwZWF0ZWQgdGhlIHNwZWNpZmllZCBudW1iZXIgb2YgdGltZXMuXG4gKlxuICogKipOb3RlKiouIGBuYCBpcyBub3JtYWxpemVkIHRvIGEgbm9uIG5lZ2F0aXZlIGludGVnZXIuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IHJlcGxpY2F0ZSB9IGZyb20gJ2ZwLXRzL0FycmF5J1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwocmVwbGljYXRlKDMsICdhJyksIFsnYScsICdhJywgJ2EnXSlcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwocmVwbGljYXRlKC0zLCAnYScpLCBbXSlcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwocmVwbGljYXRlKDIuOTg1NjQ3LCAnYScpLCBbJ2EnLCAnYSddKVxuICpcbiAqIEBjYXRlZ29yeSBjb25zdHJ1Y3RvcnNcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIHJlcGxpY2F0ZSA9IGZ1bmN0aW9uIChuLCBhKSB7IHJldHVybiBtYWtlQnkobiwgZnVuY3Rpb24gKCkgeyByZXR1cm4gYTsgfSk7IH07XG5leHBvcnQgZnVuY3Rpb24gZnJvbVByZWRpY2F0ZShwcmVkaWNhdGUpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGEpIHsgcmV0dXJuIChwcmVkaWNhdGUoYSkgPyBbYV0gOiBbXSk7IH07XG59XG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vLyBjb252ZXJzaW9uc1xuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLyoqXG4gKiBDcmVhdGUgYW4gYXJyYXkgZnJvbSBhbiBgT3B0aW9uYC4gVGhlIHJlc3VsdGluZyBhcnJheSB3aWxsIGNvbnRhaW4gdGhlIGNvbnRlbnQgb2YgdGhlXG4gKiBgT3B0aW9uYCBpZiBpdCBpcyBgU29tZWAgYW5kIGl0IHdpbGwgYmUgZW1wdHkgaWYgdGhlIGBPcHRpb25gIGlzIGBOb25lYC5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgZnJvbU9wdGlvbiB9IGZyb20gJ2ZwLXRzL0FycmF5J1xuICogaW1wb3J0IHsgb3B0aW9uIH0gZnJvbSBcImZwLXRzXCI7XG4gKiBpbXBvcnQgeyBwaXBlIH0gZnJvbSAnZnAtdHMvZnVuY3Rpb24nXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChwaXBlKG9wdGlvbi5zb21lKFwiYVwiKSwgZnJvbU9wdGlvbiksW1wiYVwiXSlcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwocGlwZShvcHRpb24ubm9uZSwgZnJvbU9wdGlvbiksW10pXG4gKlxuICogQGNhdGVnb3J5IGNvbnZlcnNpb25zXG4gKiBAc2luY2UgMi4xMS4wXG4gKi9cbmV4cG9ydCB2YXIgZnJvbU9wdGlvbiA9IGZ1bmN0aW9uIChtYSkgeyByZXR1cm4gKF8uaXNOb25lKG1hKSA/IFtdIDogW21hLnZhbHVlXSk7IH07XG4vKipcbiAqIENyZWF0ZSBhbiBhcnJheSBmcm9tIGFuIGBFaXRoZXJgLiBUaGUgcmVzdWx0aW5nIGFycmF5IHdpbGwgY29udGFpbiB0aGUgY29udGVudCBvZiB0aGVcbiAqIGBFaXRoZXJgIGlmIGl0IGlzIGBSaWdodGAgYW5kIGl0IHdpbGwgYmUgZW1wdHkgaWYgdGhlIGBFaXRoZXJgIGlzIGBMZWZ0YC5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgZnJvbUVpdGhlciB9IGZyb20gJ2ZwLXRzL0FycmF5J1xuICogaW1wb3J0IHsgZWl0aGVyIH0gZnJvbSBcImZwLXRzXCI7XG4gKiBpbXBvcnQgeyBwaXBlIH0gZnJvbSAnZnAtdHMvZnVuY3Rpb24nXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChwaXBlKGVpdGhlci5yaWdodChcInJcIiksIGZyb21FaXRoZXIpLCBbXCJyXCJdKTtcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwocGlwZShlaXRoZXIubGVmdChcImxcIiksIGZyb21FaXRoZXIpLCBbXSk7XG4gKlxuICogQGNhdGVnb3J5IGNvbnZlcnNpb25zXG4gKiBAc2luY2UgMi4xMS4wXG4gKi9cbmV4cG9ydCB2YXIgZnJvbUVpdGhlciA9IGZ1bmN0aW9uIChlKSB7IHJldHVybiAoXy5pc0xlZnQoZSkgPyBbXSA6IFtlLnJpZ2h0XSk7IH07XG4vKipcbiAqIExlc3Mgc3RyaWN0IHZlcnNpb24gb2YgW2BtYXRjaGBdKCNtYXRjaCkuXG4gKlxuICogVGhlIGBXYCBzdWZmaXggKHNob3J0IGZvciAqKlcqKmlkZW5pbmcpIG1lYW5zIHRoYXQgdGhlIGhhbmRsZXIgcmV0dXJuIHR5cGVzIHdpbGwgYmUgbWVyZ2VkLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBtYXRjaFcgfSBmcm9tICdmcC10cy9BcnJheSdcbiAqIGltcG9ydCB7IHBpcGUgfSBmcm9tICdmcC10cy9mdW5jdGlvbidcbiAqXG4gKiBjb25zdCBtYXRjaGVyVyA9IG1hdGNoVyhcbiAqICAgKCkgPT4gXCJObyBlbGVtZW50c1wiLFxuICogICAoYXMpID0+IGFzLmxlbmd0aFxuICogKTtcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwocGlwZShbMSwgMiwgMywgNF0sIG1hdGNoZXJXKSwgNCk7XG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKHBpcGUoW10sIG1hdGNoZXJXKSwgXCJObyBlbGVtZW50c1wiKTtcbiAqXG4gKiBAY2F0ZWdvcnkgcGF0dGVybiBtYXRjaGluZ1xuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIG1hdGNoVyA9IGZ1bmN0aW9uIChvbkVtcHR5LCBvbk5vbkVtcHR5KSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykge1xuICAgICAgICByZXR1cm4gaXNOb25FbXB0eShhcykgPyBvbk5vbkVtcHR5KGFzKSA6IG9uRW1wdHkoKTtcbiAgICB9O1xufTtcbi8qKlxuICogVGFrZXMgYW4gYXJyYXksIGlmIHRoZSBhcnJheSBpcyBlbXB0eSBpdCByZXR1cm5zIHRoZSByZXN1bHQgb2YgYG9uRW1wdHlgLCBvdGhlcndpc2VcbiAqIGl0IHBhc3NlcyB0aGUgYXJyYXkgdG8gYG9uTm9uRW1wdHlgIGFuZCByZXR1cm5zIHRoZSByZXN1bHQuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IG1hdGNoIH0gZnJvbSAnZnAtdHMvQXJyYXknXG4gKiBpbXBvcnQgeyBwaXBlIH0gZnJvbSAnZnAtdHMvZnVuY3Rpb24nXG4gKlxuICogY29uc3QgbWF0Y2hlciA9IG1hdGNoKFxuICogICAoKSA9PiBcIk5vIGVsZW1lbnRzXCIsXG4gKiAgIChhcykgPT4gYEZvdW5kICR7YXMubGVuZ3RofSBlbGVtZW50KHMpYFxuICogKTtcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwocGlwZShbMSwgMiwgMywgNF0sIG1hdGNoZXIpLCBcIkZvdW5kIDQgZWxlbWVudChzKVwiKTtcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwocGlwZShbXSwgbWF0Y2hlciksIFwiTm8gZWxlbWVudHNcIik7XG4gKlxuICogQGNhdGVnb3J5IHBhdHRlcm4gbWF0Y2hpbmdcbiAqIEBzaW5jZSAyLjExLjBcbiAqL1xuZXhwb3J0IHZhciBtYXRjaCA9IG1hdGNoVztcbi8qKlxuICogTGVzcyBzdHJpY3QgdmVyc2lvbiBvZiBbYG1hdGNoTGVmdGBdKCNtYXRjaGxlZnQpLiBJdCB3aWxsIHdvcmsgd2hlbiBgb25FbXB0eWAgYW5kXG4gKiBgb25Ob25FbXB0eWAgaGF2ZSBkaWZmZXJlbnQgcmV0dXJuIHR5cGVzLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBtYXRjaExlZnRXIH0gZnJvbSAnZnAtdHMvQXJyYXknXG4gKlxuICogY29uc3QgZiA9IG1hdGNoTGVmdFcoXG4gKiAgICgpID0+IDAsXG4gKiAgIChoZWFkOiBzdHJpbmcsIHRhaWw6IHN0cmluZ1tdKSA9PiBgRm91bmQgXCIke2hlYWR9XCIgZm9sbG93ZWQgYnkgJHt0YWlsLmxlbmd0aH0gZWxlbWVudHNgXG4gKiApO1xuICogYXNzZXJ0LnN0cmljdEVxdWFsKGYoW1wiYVwiLCBcImJcIiwgXCJjXCJdKSwgJ0ZvdW5kIFwiYVwiIGZvbGxvd2VkIGJ5IDIgZWxlbWVudHMnKTtcbiAqIGFzc2VydC5zdHJpY3RFcXVhbChmKFtdKSwgMCk7XG4gKlxuICogQGNhdGVnb3J5IHBhdHRlcm4gbWF0Y2hpbmdcbiAqIEBzaW5jZSAyLjExLjBcbiAqL1xuZXhwb3J0IHZhciBtYXRjaExlZnRXID0gZnVuY3Rpb24gKG9uRW1wdHksIG9uTm9uRW1wdHkpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIHJldHVybiBpc05vbkVtcHR5KGFzKSA/IG9uTm9uRW1wdHkoTkVBLmhlYWQoYXMpLCBORUEudGFpbChhcykpIDogb25FbXB0eSgpO1xuICAgIH07XG59O1xuLyoqXG4gKiBUYWtlcyBhbiBhcnJheSwgaWYgdGhlIGFycmF5IGlzIGVtcHR5IGl0IHJldHVybnMgdGhlIHJlc3VsdCBvZiBgb25FbXB0eWAsIG90aGVyd2lzZVxuICogaXQgcGFzc2VzIHRoZSBhcnJheSB0byBgb25Ob25FbXB0eWAgYnJva2VuIGludG8gaXRzIGZpcnN0IGVsZW1lbnQgYW5kIHJlbWFpbmluZyBlbGVtZW50cy5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgbWF0Y2hMZWZ0IH0gZnJvbSAnZnAtdHMvQXJyYXknXG4gKlxuICogY29uc3QgbGVuOiA8QT4oYXM6IEFycmF5PEE+KSA9PiBudW1iZXIgPSBtYXRjaExlZnQoKCkgPT4gMCwgKF8sIHRhaWwpID0+IDEgKyBsZW4odGFpbCkpXG4gKiBhc3NlcnQuc3RyaWN0RXF1YWwobGVuKFsxLCAyLCAzXSksIDMpXG4gKlxuICogQGNhdGVnb3J5IHBhdHRlcm4gbWF0Y2hpbmdcbiAqIEBzaW5jZSAyLjEwLjBcbiAqL1xuZXhwb3J0IHZhciBtYXRjaExlZnQgPSBtYXRjaExlZnRXO1xuLyoqXG4gKiBBbGlhcyBvZiBbYG1hdGNoTGVmdGBdKCNtYXRjaGxlZnQpLlxuICpcbiAqIEBjYXRlZ29yeSBwYXR0ZXJuIG1hdGNoaW5nXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciBmb2xkTGVmdCA9IG1hdGNoTGVmdDtcbi8qKlxuICogTGVzcyBzdHJpY3QgdmVyc2lvbiBvZiBbYG1hdGNoUmlnaHRgXSgjbWF0Y2hyaWdodCkuIEl0IHdpbGwgd29yayB3aGVuIGBvbkVtcHR5YCBhbmRcbiAqIGBvbk5vbkVtcHR5YCBoYXZlIGRpZmZlcmVudCByZXR1cm4gdHlwZXMuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IG1hdGNoUmlnaHRXIH0gZnJvbSAnZnAtdHMvQXJyYXknXG4gKlxuICogY29uc3QgZiA9IG1hdGNoUmlnaHRXKFxuICogICAoKSA9PiAwLFxuICogICAoaGVhZDogc3RyaW5nW10sIHRhaWw6IHN0cmluZykgPT4gYEZvdW5kICR7aGVhZC5sZW5ndGh9IGVsZW1lbnRzIGZvbGxsb3dlZCBieSBcIiR7dGFpbH1cImBcbiAqICk7XG4gKiBhc3NlcnQuc3RyaWN0RXF1YWwoZihbXCJhXCIsIFwiYlwiLCBcImNcIl0pLCAnRm91bmQgMiBlbGVtZW50cyBmb2xsbG93ZWQgYnkgXCJjXCInKTtcbiAqIGFzc2VydC5zdHJpY3RFcXVhbChmKFtdKSwgMCk7XG4gKlxuICogQGNhdGVnb3J5IHBhdHRlcm4gbWF0Y2hpbmdcbiAqIEBzaW5jZSAyLjExLjBcbiAqL1xuZXhwb3J0IHZhciBtYXRjaFJpZ2h0VyA9IGZ1bmN0aW9uIChvbkVtcHR5LCBvbk5vbkVtcHR5KSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykge1xuICAgICAgICByZXR1cm4gaXNOb25FbXB0eShhcykgPyBvbk5vbkVtcHR5KE5FQS5pbml0KGFzKSwgTkVBLmxhc3QoYXMpKSA6IG9uRW1wdHkoKTtcbiAgICB9O1xufTtcbi8qKlxuICogVGFrZXMgYW4gYXJyYXksIGlmIHRoZSBhcnJheSBpcyBlbXB0eSBpdCByZXR1cm5zIHRoZSByZXN1bHQgb2YgYG9uRW1wdHlgLCBvdGhlcndpc2VcbiAqIGl0IHBhc3NlcyB0aGUgYXJyYXkgdG8gYG9uTm9uRW1wdHlgIGJyb2tlbiAgaW50byBpdHMgaW5pdGlhbCBlbGVtZW50cyBhbmQgdGhlIGxhc3QgZWxlbWVudC5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgbWF0Y2hSaWdodCB9IGZyb20gJ2ZwLXRzL0FycmF5J1xuICpcbiAqIGNvbnN0IGxlbjogPEE+KGFzOiBBcnJheTxBPikgPT4gbnVtYmVyID0gbWF0Y2hSaWdodChcbiAqICAgKCkgPT4gMCxcbiAqICAgKGhlYWQsIF8pID0+IDEgKyBsZW4oaGVhZClcbiAqICk7XG4gKiBhc3NlcnQuc3RyaWN0RXF1YWwobGVuKFsxLCAyLCAzXSksIDMpO1xuICpcbiAqIEBjYXRlZ29yeSBwYXR0ZXJuIG1hdGNoaW5nXG4gKiBAc2luY2UgMi4xMC4wXG4gKi9cbmV4cG9ydCB2YXIgbWF0Y2hSaWdodCA9IG1hdGNoUmlnaHRXO1xuLyoqXG4gKiBBbGlhcyBvZiBbYG1hdGNoUmlnaHRgXSgjbWF0Y2hyaWdodCkuXG4gKlxuICogQGNhdGVnb3J5IHBhdHRlcm4gbWF0Y2hpbmdcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIGZvbGRSaWdodCA9IG1hdGNoUmlnaHQ7XG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vLyBjb21iaW5hdG9yc1xuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLyoqXG4gKiBTYW1lIGFzIFtgY2hhaW5gXSgjY2hhaW4pLCBidXQgcGFzc2luZyBhbHNvIHRoZSBpbmRleCB0byB0aGUgaXRlcmF0aW5nIGZ1bmN0aW9uLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBjaGFpbldpdGhJbmRleCwgcmVwbGljYXRlIH0gZnJvbSAnZnAtdHMvQXJyYXknXG4gKiBpbXBvcnQgeyBwaXBlIH0gZnJvbSAnZnAtdHMvZnVuY3Rpb24nXG4gKlxuICogY29uc3QgZiA9IChpbmRleDogbnVtYmVyLCB4OiBzdHJpbmcpID0+IHJlcGxpY2F0ZSgyLCBgJHt4fSR7aW5kZXh9YCk7XG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKHBpcGUoW1wiYVwiLCBcImJcIiwgXCJjXCJdLCBjaGFpbldpdGhJbmRleChmKSksIFtcImEwXCIsIFwiYTBcIiwgXCJiMVwiLCBcImIxXCIsIFwiYzJcIiwgXCJjMlwiXSk7XG4gKlxuICogQGNhdGVnb3J5IHNlcXVlbmNpbmdcbiAqIEBzaW5jZSAyLjcuMFxuICovXG5leHBvcnQgdmFyIGNoYWluV2l0aEluZGV4ID0gZnVuY3Rpb24gKGYpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIHZhciBvdXQgPSBbXTtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBhcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgb3V0LnB1c2guYXBwbHkob3V0LCBmKGksIGFzW2ldKSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG91dDtcbiAgICB9O1xufTtcbi8qKlxuICogU2FtZSBhcyBgcmVkdWNlYCBidXQgaXQgY2FycmllcyBvdmVyIHRoZSBpbnRlcm1lZGlhdGUgc3RlcHNcbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgc2NhbkxlZnQgfSBmcm9tICdmcC10cy9BcnJheSdcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKHNjYW5MZWZ0KDEwLCAoYiwgYTogbnVtYmVyKSA9PiBiIC0gYSkoWzEsIDIsIDNdKSwgWzEwLCA5LCA3LCA0XSlcbiAqXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciBzY2FuTGVmdCA9IGZ1bmN0aW9uIChiLCBmKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykge1xuICAgICAgICB2YXIgbGVuID0gYXMubGVuZ3RoO1xuICAgICAgICB2YXIgb3V0ID0gbmV3IEFycmF5KGxlbiArIDEpO1xuICAgICAgICBvdXRbMF0gPSBiO1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGxlbjsgaSsrKSB7XG4gICAgICAgICAgICBvdXRbaSArIDFdID0gZihvdXRbaV0sIGFzW2ldKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gb3V0O1xuICAgIH07XG59O1xuLyoqXG4gKiBGb2xkIGFuIGFycmF5IGZyb20gdGhlIHJpZ2h0LCBrZWVwaW5nIGFsbCBpbnRlcm1lZGlhdGUgcmVzdWx0cyBpbnN0ZWFkIG9mIG9ubHkgdGhlIGZpbmFsIHJlc3VsdFxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBzY2FuUmlnaHQgfSBmcm9tICdmcC10cy9BcnJheSdcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKHNjYW5SaWdodCgxMCwgKGE6IG51bWJlciwgYikgPT4gYiAtIGEpKFsxLCAyLCAzXSksIFs0LCA1LCA3LCAxMF0pXG4gKlxuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgc2NhblJpZ2h0ID0gZnVuY3Rpb24gKGIsIGYpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIHZhciBsZW4gPSBhcy5sZW5ndGg7XG4gICAgICAgIHZhciBvdXQgPSBuZXcgQXJyYXkobGVuICsgMSk7XG4gICAgICAgIG91dFtsZW5dID0gYjtcbiAgICAgICAgZm9yICh2YXIgaSA9IGxlbiAtIDE7IGkgPj0gMDsgaS0tKSB7XG4gICAgICAgICAgICBvdXRbaV0gPSBmKGFzW2ldLCBvdXRbaSArIDFdKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gb3V0O1xuICAgIH07XG59O1xuLyoqXG4gKiBDYWxjdWxhdGUgdGhlIG51bWJlciBvZiBlbGVtZW50cyBpbiBhIGBBcnJheWAuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IHNpemUgfSBmcm9tICdmcC10cy9BcnJheSdcbiAqXG4gKiBhc3NlcnQuc3RyaWN0RXF1YWwoc2l6ZShbXCJhXCIsXCJiXCIsXCJjXCJdKSwzKVxuICpcbiAqIEBzaW5jZSAyLjEwLjBcbiAqL1xuZXhwb3J0IHZhciBzaXplID0gZnVuY3Rpb24gKGFzKSB7IHJldHVybiBhcy5sZW5ndGg7IH07XG4vKipcbiAqIFRlc3Qgd2hldGhlciBhbiBhcnJheSBjb250YWlucyBhIHBhcnRpY3VsYXIgaW5kZXhcbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgaXNPdXRPZkJvdW5kIH0gZnJvbSAnZnAtdHMvQXJyYXknXG4gKlxuICogYXNzZXJ0LnN0cmljdEVxdWFsKGlzT3V0T2ZCb3VuZCgxLFtcImFcIixcImJcIixcImNcIl0pLGZhbHNlKVxuICogYXNzZXJ0LnN0cmljdEVxdWFsKGlzT3V0T2ZCb3VuZCgtMSxbXCJhXCIsXCJiXCIsXCJjXCJdKSx0cnVlKVxuICogYXNzZXJ0LnN0cmljdEVxdWFsKGlzT3V0T2ZCb3VuZCgzLFtcImFcIixcImJcIixcImNcIl0pLHRydWUpXG4gKlxuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgaXNPdXRPZkJvdW5kID0gTkVBLmlzT3V0T2ZCb3VuZDtcbi8vIFRPRE86IHJlbW92ZSBub24tY3VycmllZCBvdmVybG9hZGluZyBpbiB2M1xuLyoqXG4gKiBUaGlzIGZ1bmN0aW9uIHByb3ZpZGVzIGEgc2FmZSB3YXkgdG8gcmVhZCBhIHZhbHVlIGF0IGEgcGFydGljdWxhciBpbmRleCBmcm9tIGFuIGFycmF5LlxuICogSXQgcmV0dXJucyBhIGBub25lYCBpZiB0aGUgaW5kZXggaXMgb3V0IG9mIGJvdW5kcywgYW5kIGEgYHNvbWVgIG9mIHRoZSBlbGVtZW50IGlmIHRoZVxuICogaW5kZXggaXMgdmFsaWQuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IGxvb2t1cCB9IGZyb20gJ2ZwLXRzL0FycmF5J1xuICogaW1wb3J0IHsgc29tZSwgbm9uZSB9IGZyb20gJ2ZwLXRzL09wdGlvbidcbiAqIGltcG9ydCB7IHBpcGUgfSBmcm9tICdmcC10cy9mdW5jdGlvbidcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKHBpcGUoWzEsIDIsIDNdLCBsb29rdXAoMSkpLCBzb21lKDIpKVxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChwaXBlKFsxLCAyLCAzXSwgbG9va3VwKDMpKSwgbm9uZSlcbiAqXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciBsb29rdXAgPSBSQS5sb29rdXA7XG4vKipcbiAqIEdldCB0aGUgZmlyc3QgZWxlbWVudCBpbiBhbiBhcnJheSwgb3IgYE5vbmVgIGlmIHRoZSBhcnJheSBpcyBlbXB0eVxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBoZWFkIH0gZnJvbSAnZnAtdHMvQXJyYXknXG4gKiBpbXBvcnQgeyBzb21lLCBub25lIH0gZnJvbSAnZnAtdHMvT3B0aW9uJ1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoaGVhZChbMSwgMiwgM10pLCBzb21lKDEpKVxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChoZWFkKFtdKSwgbm9uZSlcbiAqXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciBoZWFkID0gUkEuaGVhZDtcbi8qKlxuICogR2V0IHRoZSBsYXN0IGVsZW1lbnQgaW4gYW4gYXJyYXksIG9yIGBOb25lYCBpZiB0aGUgYXJyYXkgaXMgZW1wdHlcbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgbGFzdCB9IGZyb20gJ2ZwLXRzL0FycmF5J1xuICogaW1wb3J0IHsgc29tZSwgbm9uZSB9IGZyb20gJ2ZwLXRzL09wdGlvbidcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKGxhc3QoWzEsIDIsIDNdKSwgc29tZSgzKSlcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwobGFzdChbXSksIG5vbmUpXG4gKlxuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgbGFzdCA9IFJBLmxhc3Q7XG4vKipcbiAqIEdldCBhbGwgYnV0IHRoZSBmaXJzdCBlbGVtZW50IG9mIGFuIGFycmF5LCBjcmVhdGluZyBhIG5ldyBhcnJheSwgb3IgYE5vbmVgIGlmIHRoZSBhcnJheSBpcyBlbXB0eVxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyB0YWlsIH0gZnJvbSAnZnAtdHMvQXJyYXknXG4gKiBpbXBvcnQgeyBzb21lLCBub25lIH0gZnJvbSAnZnAtdHMvT3B0aW9uJ1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwodGFpbChbMSwgMiwgM10pLCBzb21lKFsyLCAzXSkpXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKHRhaWwoW10pLCBub25lKVxuICpcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIHRhaWwgPSBmdW5jdGlvbiAoYXMpIHsgcmV0dXJuIChpc05vbkVtcHR5KGFzKSA/IF8uc29tZShORUEudGFpbChhcykpIDogXy5ub25lKTsgfTtcbi8qKlxuICogR2V0IGFsbCBidXQgdGhlIGxhc3QgZWxlbWVudCBvZiBhbiBhcnJheSwgY3JlYXRpbmcgYSBuZXcgYXJyYXksIG9yIGBOb25lYCBpZiB0aGUgYXJyYXkgaXMgZW1wdHlcbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgaW5pdCB9IGZyb20gJ2ZwLXRzL0FycmF5J1xuICogaW1wb3J0IHsgc29tZSwgbm9uZSB9IGZyb20gJ2ZwLXRzL09wdGlvbidcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKGluaXQoWzEsIDIsIDNdKSwgc29tZShbMSwgMl0pKVxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChpbml0KFtdKSwgbm9uZSlcbiAqXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciBpbml0ID0gZnVuY3Rpb24gKGFzKSB7IHJldHVybiAoaXNOb25FbXB0eShhcykgPyBfLnNvbWUoTkVBLmluaXQoYXMpKSA6IF8ubm9uZSk7IH07XG4vKipcbiAqIEtlZXAgb25seSBhIG1heCBudW1iZXIgb2YgZWxlbWVudHMgZnJvbSB0aGUgc3RhcnQgb2YgYW4gYEFycmF5YCwgY3JlYXRpbmcgYSBuZXcgYEFycmF5YC5cbiAqXG4gKiAqKk5vdGUqKi4gYG5gIGlzIG5vcm1hbGl6ZWQgdG8gYSBub24gbmVnYXRpdmUgaW50ZWdlci5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgdGFrZUxlZnQgfSBmcm9tICdmcC10cy9BcnJheSdcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKHRha2VMZWZ0KDIpKFsxLCAyLCAzLCA0LCA1XSksIFsxLCAyXSk7XG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKHRha2VMZWZ0KDcpKFsxLCAyLCAzLCA0LCA1XSksIFsxLCAyLCAzLCA0LCA1XSk7XG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKHRha2VMZWZ0KDApKFsxLCAyLCAzLCA0LCA1XSksIFtdKTtcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwodGFrZUxlZnQoLTEpKFsxLCAyLCAzLCA0LCA1XSksIFsxLCAyLCAzLCA0LCA1XSk7XG4gKlxuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgdGFrZUxlZnQgPSBmdW5jdGlvbiAobikge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgcmV0dXJuIGlzT3V0T2ZCb3VuZChuLCBhcykgPyBjb3B5KGFzKSA6IGFzLnNsaWNlKDAsIG4pO1xuICAgIH07XG59O1xuLyoqXG4gKiBLZWVwIG9ubHkgYSBtYXggbnVtYmVyIG9mIGVsZW1lbnRzIGZyb20gdGhlIGVuZCBvZiBhbiBgQXJyYXlgLCBjcmVhdGluZyBhIG5ldyBgQXJyYXlgLlxuICpcbiAqICoqTm90ZSoqLiBgbmAgaXMgbm9ybWFsaXplZCB0byBhIG5vbiBuZWdhdGl2ZSBpbnRlZ2VyLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyB0YWtlUmlnaHQgfSBmcm9tICdmcC10cy9BcnJheSdcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKHRha2VSaWdodCgyKShbMSwgMiwgMywgNCwgNV0pLCBbNCwgNV0pO1xuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbCh0YWtlUmlnaHQoNykoWzEsIDIsIDMsIDQsIDVdKSwgWzEsIDIsIDMsIDQsIDVdKTtcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwodGFrZVJpZ2h0KDApKFsxLCAyLCAzLCA0LCA1XSksIFtdKTtcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwodGFrZVJpZ2h0KC0xKShbMSwgMiwgMywgNCwgNV0pLCBbMSwgMiwgMywgNCwgNV0pO1xuICpcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIHRha2VSaWdodCA9IGZ1bmN0aW9uIChuKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykge1xuICAgICAgICByZXR1cm4gaXNPdXRPZkJvdW5kKG4sIGFzKSA/IGNvcHkoYXMpIDogbiA9PT0gMCA/IFtdIDogYXMuc2xpY2UoLW4pO1xuICAgIH07XG59O1xuZXhwb3J0IGZ1bmN0aW9uIHRha2VMZWZ0V2hpbGUocHJlZGljYXRlKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykge1xuICAgICAgICB2YXIgb3V0ID0gW107XG4gICAgICAgIGZvciAodmFyIF9pID0gMCwgYXNfMSA9IGFzOyBfaSA8IGFzXzEubGVuZ3RoOyBfaSsrKSB7XG4gICAgICAgICAgICB2YXIgYSA9IGFzXzFbX2ldO1xuICAgICAgICAgICAgaWYgKCFwcmVkaWNhdGUoYSkpIHtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIG91dC5wdXNoKGEpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBvdXQ7XG4gICAgfTtcbn1cbnZhciBzcGFuTGVmdEluZGV4ID0gZnVuY3Rpb24gKGFzLCBwcmVkaWNhdGUpIHtcbiAgICB2YXIgbCA9IGFzLmxlbmd0aDtcbiAgICB2YXIgaSA9IDA7XG4gICAgZm9yICg7IGkgPCBsOyBpKyspIHtcbiAgICAgICAgaWYgKCFwcmVkaWNhdGUoYXNbaV0pKSB7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gaTtcbn07XG5leHBvcnQgZnVuY3Rpb24gc3BhbkxlZnQocHJlZGljYXRlKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykge1xuICAgICAgICB2YXIgX2EgPSBzcGxpdEF0KHNwYW5MZWZ0SW5kZXgoYXMsIHByZWRpY2F0ZSkpKGFzKSwgaW5pdCA9IF9hWzBdLCByZXN0ID0gX2FbMV07XG4gICAgICAgIHJldHVybiB7IGluaXQ6IGluaXQsIHJlc3Q6IHJlc3QgfTtcbiAgICB9O1xufVxuLyoqXG4gKiBDcmVhdGVzIGEgbmV3IGBBcnJheWAgd2hpY2ggaXMgYSBjb3B5IG9mIHRoZSBpbnB1dCBkcm9wcGluZyBhIG1heCBudW1iZXIgb2YgZWxlbWVudHMgZnJvbSB0aGUgc3RhcnQuXG4gKlxuICogKipOb3RlKiouIGBuYCBpcyBub3JtYWxpemVkIHRvIGEgbm9uIG5lZ2F0aXZlIGludGVnZXIuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IGRyb3BMZWZ0IH0gZnJvbSAnZnAtdHMvQXJyYXknXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChkcm9wTGVmdCgyKShbMSwgMiwgM10pLCBbM10pO1xuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChkcm9wTGVmdCg1KShbMSwgMiwgM10pLCBbXSk7XG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKGRyb3BMZWZ0KDApKFsxLCAyLCAzXSksIFsxLCAyLCAzXSk7XG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKGRyb3BMZWZ0KC0yKShbMSwgMiwgM10pLCBbMSwgMiwgM10pO1xuICpcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIGRyb3BMZWZ0ID0gZnVuY3Rpb24gKG4pIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIHJldHVybiBuIDw9IDAgfHwgaXNFbXB0eShhcykgPyBjb3B5KGFzKSA6IG4gPj0gYXMubGVuZ3RoID8gW10gOiBhcy5zbGljZShuLCBhcy5sZW5ndGgpO1xuICAgIH07XG59O1xuLyoqXG4gKiBDcmVhdGVzIGEgbmV3IGBBcnJheWAgd2hpY2ggaXMgYSBjb3B5IG9mIHRoZSBpbnB1dCBkcm9wcGluZyBhIG1heCBudW1iZXIgb2YgZWxlbWVudHMgZnJvbSB0aGUgZW5kLlxuICpcbiAqICoqTm90ZSoqLiBgbmAgaXMgbm9ybWFsaXplZCB0byBhIG5vbiBuZWdhdGl2ZSBpbnRlZ2VyLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBkcm9wUmlnaHQgfSBmcm9tICdmcC10cy9BcnJheSdcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKGRyb3BSaWdodCgyKShbMSwgMiwgM10pLCBbMV0pO1xuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChkcm9wUmlnaHQoNSkoWzEsIDIsIDNdKSwgW10pO1xuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChkcm9wUmlnaHQoMCkoWzEsIDIsIDNdKSwgWzEsIDIsIDNdKTtcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoZHJvcFJpZ2h0KC0yKShbMSwgMiwgM10pLCBbMSwgMiwgM10pO1xuICpcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIGRyb3BSaWdodCA9IGZ1bmN0aW9uIChuKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykge1xuICAgICAgICByZXR1cm4gbiA8PSAwIHx8IGlzRW1wdHkoYXMpID8gY29weShhcykgOiBuID49IGFzLmxlbmd0aCA/IFtdIDogYXMuc2xpY2UoMCwgYXMubGVuZ3RoIC0gbik7XG4gICAgfTtcbn07XG5leHBvcnQgZnVuY3Rpb24gZHJvcExlZnRXaGlsZShwcmVkaWNhdGUpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7IHJldHVybiBhcy5zbGljZShzcGFuTGVmdEluZGV4KGFzLCBwcmVkaWNhdGUpKTsgfTtcbn1cbi8qKlxuICogYGZpbmRJbmRleGAgcmV0dXJucyBhbiBgT3B0aW9uYCBjb250YWluaW5nIHRoZSBmaXJzdCBpbmRleCBmb3Igd2hpY2ggYSBwcmVkaWNhdGUgaG9sZHMuXG4gKiBJdCByZXR1cm5zIGBOb25lYCBpZiBubyBlbGVtZW50IHNhdGlzZmllcyB0aGUgcHJlZGljYXRlLlxuICogU2ltaWxhciB0byBbYGZpbmRGaXJzdGBdKCNmaW5kRmlyc3QpIGJ1dCByZXR1cm5pbmcgdGhlIGluZGV4IGluc3RlYWQgb2YgdGhlIGVsZW1lbnQuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IGZpbmRJbmRleCB9IGZyb20gJ2ZwLXRzL0FycmF5J1xuICogaW1wb3J0IHsgc29tZSwgbm9uZSB9IGZyb20gJ2ZwLXRzL09wdGlvbidcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKGZpbmRJbmRleCgobjogbnVtYmVyKSA9PiBuID09PSAyKShbMSwgMiwgM10pLCBzb21lKDEpKVxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChmaW5kSW5kZXgoKG46IG51bWJlcikgPT4gbiA9PT0gMikoW10pLCBub25lKVxuICpcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIGZpbmRJbmRleCA9IFJBLmZpbmRJbmRleDtcbmV4cG9ydCBmdW5jdGlvbiBmaW5kRmlyc3QocHJlZGljYXRlKSB7XG4gICAgcmV0dXJuIFJBLmZpbmRGaXJzdChwcmVkaWNhdGUpO1xufVxuLyoqXG4gKiBHaXZlbiBhIHNlbGVjdG9yIGZ1bmN0aW9uIHdoaWNoIHRha2VzIGFuIGVsZW1lbnQgYW5kIHJldHVybnMgYW4gb3B0aW9uLFxuICogdGhpcyBmdW5jdGlvbiBhcHBsaWVzIHRoZSBzZWxlY3RvciB0byBlYWNoIGVsZW1lbnQgb2YgdGhlIGFycmF5IGFuZFxuICogcmV0dXJucyB0aGUgZmlyc3QgYFNvbWVgIHJlc3VsdC4gT3RoZXJ3aXNlIGl0IHJldHVybnMgYE5vbmVgLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBmaW5kRmlyc3RNYXAgfSBmcm9tICdmcC10cy9BcnJheSdcbiAqIGltcG9ydCB7IHNvbWUsIG5vbmUgfSBmcm9tICdmcC10cy9PcHRpb24nXG4gKlxuICogaW50ZXJmYWNlIFBlcnNvbiB7XG4gKiAgIHJlYWRvbmx5IG5hbWU6IHN0cmluZztcbiAqICAgcmVhZG9ubHkgYWdlOiBudW1iZXI7XG4gKiB9XG4gKlxuICogY29uc3QgcGVyc29uczogQXJyYXk8UGVyc29uPiA9IFtcbiAqICAgeyBuYW1lOiBcIkpvaG5cIiwgYWdlOiAxNiB9LFxuICogICB7IG5hbWU6IFwiTWFyeVwiLCBhZ2U6IDQ1IH0sXG4gKiAgIHsgbmFtZTogXCJKb2V5XCIsIGFnZTogMjggfSxcbiAqIF07XG4gKlxuICogY29uc3QgbmFtZU9mUGVyc29uQWJvdmUxOCA9IChwOiBQZXJzb24pID0+IChwLmFnZSA8PSAxOCA/IG5vbmUgOiBzb21lKHAubmFtZSkpO1xuICogY29uc3QgbmFtZU9mUGVyc29uQWJvdmU3MCA9IChwOiBQZXJzb24pID0+IChwLmFnZSA8PSA3MCA/IG5vbmUgOiBzb21lKHAubmFtZSkpO1xuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChmaW5kRmlyc3RNYXAobmFtZU9mUGVyc29uQWJvdmUxOCkocGVyc29ucyksIHNvbWUoXCJNYXJ5XCIpKTtcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoZmluZEZpcnN0TWFwKG5hbWVPZlBlcnNvbkFib3ZlNzApKHBlcnNvbnMpLCBub25lKTtcbiAqXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciBmaW5kRmlyc3RNYXAgPSBSQS5maW5kRmlyc3RNYXA7XG5leHBvcnQgZnVuY3Rpb24gZmluZExhc3QocHJlZGljYXRlKSB7XG4gICAgcmV0dXJuIFJBLmZpbmRMYXN0KHByZWRpY2F0ZSk7XG59XG4vKipcbiAqIEdpdmVuIGEgc2VsZWN0b3IgZnVuY3Rpb24gd2hpY2ggdGFrZXMgYW4gZWxlbWVudCBhbmQgcmV0dXJucyBhbiBvcHRpb24sXG4gKiB0aGlzIGZ1bmN0aW9uIGFwcGxpZXMgdGhlIHNlbGVjdG9yIHRvIGVhY2ggZWxlbWVudCBvZiB0aGUgYXJyYXkgc3RhcnRpbmcgZnJvbSB0aGVcbiAqIGVuZCBhbmQgcmV0dXJucyB0aGUgbGFzdCBgU29tZWAgcmVzdWx0LiBPdGhlcndpc2UgaXQgcmV0dXJucyBgTm9uZWAuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IGZpbmRMYXN0TWFwIH0gZnJvbSAnZnAtdHMvQXJyYXknXG4gKiBpbXBvcnQgeyBzb21lLCBub25lIH0gZnJvbSAnZnAtdHMvT3B0aW9uJ1xuICpcbiAqIGludGVyZmFjZSBQZXJzb24ge1xuICogICByZWFkb25seSBuYW1lOiBzdHJpbmc7XG4gKiAgIHJlYWRvbmx5IGFnZTogbnVtYmVyO1xuICogfVxuICpcbiAqIGNvbnN0IHBlcnNvbnM6IEFycmF5PFBlcnNvbj4gPSBbXG4gKiAgIHsgbmFtZTogXCJKb2huXCIsIGFnZTogMTYgfSxcbiAqICAgeyBuYW1lOiBcIk1hcnlcIiwgYWdlOiA0NSB9LFxuICogICB7IG5hbWU6IFwiSm9leVwiLCBhZ2U6IDI4IH0sXG4gKiBdO1xuICpcbiAqIGNvbnN0IG5hbWVPZlBlcnNvbkFib3ZlMTggPSAocDogUGVyc29uKSA9PiAocC5hZ2UgPD0gMTggPyBub25lIDogc29tZShwLm5hbWUpKTtcbiAqIGNvbnN0IG5hbWVPZlBlcnNvbkFib3ZlNzAgPSAocDogUGVyc29uKSA9PiAocC5hZ2UgPD0gNzAgPyBub25lIDogc29tZShwLm5hbWUpKTtcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoZmluZExhc3RNYXAobmFtZU9mUGVyc29uQWJvdmUxOCkocGVyc29ucyksIHNvbWUoXCJKb2V5XCIpKTtcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoZmluZExhc3RNYXAobmFtZU9mUGVyc29uQWJvdmU3MCkocGVyc29ucyksIG5vbmUpO1xuICpcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIGZpbmRMYXN0TWFwID0gUkEuZmluZExhc3RNYXA7XG4vKipcbiAqIFJldHVybnMgdGhlIGluZGV4IG9mIHRoZSBsYXN0IGVsZW1lbnQgb2YgdGhlIGxpc3Qgd2hpY2ggbWF0Y2hlcyB0aGUgcHJlZGljYXRlLlxuICogSXQgcmV0dXJucyBhbiBgT3B0aW9uYCBjb250YWluaW5nIHRoZSBpbmRleCBvciBgTm9uZWAgaWYgbm90IGZvdW5kLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBmaW5kTGFzdEluZGV4IH0gZnJvbSAnZnAtdHMvQXJyYXknXG4gKiBpbXBvcnQgeyBzb21lLCBub25lIH0gZnJvbSAnZnAtdHMvT3B0aW9uJ1xuICpcbiAqIGludGVyZmFjZSBYIHtcbiAqICAgcmVhZG9ubHkgYTogbnVtYmVyXG4gKiAgIHJlYWRvbmx5IGI6IG51bWJlclxuICogfVxuICogY29uc3QgeHM6IEFycmF5PFg+ID0gW3sgYTogMSwgYjogMCB9LCB7IGE6IDEsIGI6IDEgfV1cbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoZmluZExhc3RJbmRleCgoeDogeyByZWFkb25seSBhOiBudW1iZXIgfSkgPT4geC5hID09PSAxKSh4cyksIHNvbWUoMSkpXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKGZpbmRMYXN0SW5kZXgoKHg6IHsgcmVhZG9ubHkgYTogbnVtYmVyIH0pID0+IHguYSA9PT0gNCkoeHMpLCBub25lKVxuICpcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIGZpbmRMYXN0SW5kZXggPSBSQS5maW5kTGFzdEluZGV4O1xuLyoqXG4gKiBUaGlzIGZ1bmN0aW9uIHRha2VzIGFuIGFycmF5IGFuZCBtYWtlcyBhIG5ldyBhcnJheSBjb250YWluaW5nIHRoZSBzYW1lIGVsZW1lbnRzLlxuICpcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIGNvcHkgPSBmdW5jdGlvbiAoYXMpIHsgcmV0dXJuIGFzLnNsaWNlKCk7IH07XG4vKipcbiAqIEluc2VydCBhbiBlbGVtZW50IGF0IHRoZSBzcGVjaWZpZWQgaW5kZXgsIGNyZWF0aW5nIGEgbmV3IGFycmF5LFxuICogb3IgcmV0dXJuaW5nIGBOb25lYCBpZiB0aGUgaW5kZXggaXMgb3V0IG9mIGJvdW5kcy5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgaW5zZXJ0QXQgfSBmcm9tICdmcC10cy9BcnJheSdcbiAqIGltcG9ydCB7IHNvbWUgfSBmcm9tICdmcC10cy9PcHRpb24nXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChpbnNlcnRBdCgyLCA1KShbMSwgMiwgMywgNF0pLCBzb21lKFsxLCAyLCA1LCAzLCA0XSkpXG4gKlxuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgaW5zZXJ0QXQgPSBmdW5jdGlvbiAoaSwgYSkge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgcmV0dXJuIGkgPCAwIHx8IGkgPiBhcy5sZW5ndGggPyBfLm5vbmUgOiBfLnNvbWUodW5zYWZlSW5zZXJ0QXQoaSwgYSwgYXMpKTtcbiAgICB9O1xufTtcbi8qKlxuICogQ2hhbmdlIHRoZSBlbGVtZW50IGF0IHRoZSBzcGVjaWZpZWQgaW5kZXgsIGNyZWF0aW5nIGEgbmV3IGFycmF5LFxuICogb3IgcmV0dXJuaW5nIGBOb25lYCBpZiB0aGUgaW5kZXggaXMgb3V0IG9mIGJvdW5kcy5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgdXBkYXRlQXQgfSBmcm9tICdmcC10cy9BcnJheSdcbiAqIGltcG9ydCB7IHNvbWUsIG5vbmUgfSBmcm9tICdmcC10cy9PcHRpb24nXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbCh1cGRhdGVBdCgxLCAxKShbMSwgMiwgM10pLCBzb21lKFsxLCAxLCAzXSkpXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKHVwZGF0ZUF0KDEsIDEpKFtdKSwgbm9uZSlcbiAqXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciB1cGRhdGVBdCA9IGZ1bmN0aW9uIChpLCBhKSB7IHJldHVybiBtb2RpZnlBdChpLCBmdW5jdGlvbiAoKSB7IHJldHVybiBhOyB9KTsgfTtcbi8qKlxuICogRGVsZXRlIHRoZSBlbGVtZW50IGF0IHRoZSBzcGVjaWZpZWQgaW5kZXgsIGNyZWF0aW5nIGEgbmV3IGFycmF5LCBvciByZXR1cm5pbmcgYE5vbmVgIGlmIHRoZSBpbmRleCBpcyBvdXQgb2YgYm91bmRzLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBkZWxldGVBdCB9IGZyb20gJ2ZwLXRzL0FycmF5J1xuICogaW1wb3J0IHsgc29tZSwgbm9uZSB9IGZyb20gJ2ZwLXRzL09wdGlvbidcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKGRlbGV0ZUF0KDApKFsxLCAyLCAzXSksIHNvbWUoWzIsIDNdKSlcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoZGVsZXRlQXQoMSkoW10pLCBub25lKVxuICpcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIGRlbGV0ZUF0ID0gZnVuY3Rpb24gKGkpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIHJldHVybiBpc091dE9mQm91bmQoaSwgYXMpID8gXy5ub25lIDogXy5zb21lKHVuc2FmZURlbGV0ZUF0KGksIGFzKSk7XG4gICAgfTtcbn07XG4vKipcbiAqIEFwcGx5IGEgZnVuY3Rpb24gdG8gdGhlIGVsZW1lbnQgYXQgdGhlIHNwZWNpZmllZCBpbmRleCwgY3JlYXRpbmcgYSBuZXcgYXJyYXksIG9yIHJldHVybmluZyBgTm9uZWAgaWYgdGhlIGluZGV4IGlzIG91dFxuICogb2YgYm91bmRzLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBtb2RpZnlBdCB9IGZyb20gJ2ZwLXRzL0FycmF5J1xuICogaW1wb3J0IHsgc29tZSwgbm9uZSB9IGZyb20gJ2ZwLXRzL09wdGlvbidcbiAqXG4gKiBjb25zdCBkb3VibGUgPSAoeDogbnVtYmVyKTogbnVtYmVyID0+IHggKiAyXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKG1vZGlmeUF0KDEsIGRvdWJsZSkoWzEsIDIsIDNdKSwgc29tZShbMSwgNCwgM10pKVxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChtb2RpZnlBdCgxLCBkb3VibGUpKFtdKSwgbm9uZSlcbiAqXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciBtb2RpZnlBdCA9IGZ1bmN0aW9uIChpLCBmKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykge1xuICAgICAgICByZXR1cm4gaXNPdXRPZkJvdW5kKGksIGFzKSA/IF8ubm9uZSA6IF8uc29tZSh1bnNhZmVVcGRhdGVBdChpLCBmKGFzW2ldKSwgYXMpKTtcbiAgICB9O1xufTtcbi8qKlxuICogUmV2ZXJzZSBhbiBhcnJheSwgY3JlYXRpbmcgYSBuZXcgYXJyYXlcbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgcmV2ZXJzZSB9IGZyb20gJ2ZwLXRzL0FycmF5J1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwocmV2ZXJzZShbMSwgMiwgM10pLCBbMywgMiwgMV0pXG4gKlxuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgcmV2ZXJzZSA9IGZ1bmN0aW9uIChhcykgeyByZXR1cm4gKGlzRW1wdHkoYXMpID8gW10gOiBhcy5zbGljZSgpLnJldmVyc2UoKSk7IH07XG4vKipcbiAqIFRha2VzIGFuIGBBcnJheWAgb2YgYEVpdGhlcmAgYW5kIHByb2R1Y2VzIGEgbmV3IGBBcnJheWAgY29udGFpbmluZ1xuICogdGhlIHZhbHVlcyBvZiBhbGwgdGhlIGBSaWdodGAgZWxlbWVudHMgaW4gdGhlIHNhbWUgb3JkZXIuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IHJpZ2h0cyB9IGZyb20gJ2ZwLXRzL0FycmF5J1xuICogaW1wb3J0IHsgcmlnaHQsIGxlZnQgfSBmcm9tICdmcC10cy9FaXRoZXInXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChyaWdodHMoW3JpZ2h0KDEpLCBsZWZ0KCdmb28nKSwgcmlnaHQoMildKSwgWzEsIDJdKVxuICpcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIHJpZ2h0cyA9IGZ1bmN0aW9uIChhcykge1xuICAgIHZhciByID0gW107XG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBhcy5sZW5ndGg7IGkrKykge1xuICAgICAgICB2YXIgYSA9IGFzW2ldO1xuICAgICAgICBpZiAoYS5fdGFnID09PSAnUmlnaHQnKSB7XG4gICAgICAgICAgICByLnB1c2goYS5yaWdodCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHI7XG59O1xuLyoqXG4gKiBUYWtlcyBhbiBgQXJyYXlgIG9mIGBFaXRoZXJgIGFuZCBwcm9kdWNlcyBhIG5ldyBgQXJyYXlgIGNvbnRhaW5pbmdcbiAqIHRoZSB2YWx1ZXMgb2YgYWxsIHRoZSBgTGVmdGAgZWxlbWVudHMgaW4gdGhlIHNhbWUgb3JkZXIuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IGxlZnRzIH0gZnJvbSAnZnAtdHMvQXJyYXknXG4gKiBpbXBvcnQgeyBsZWZ0LCByaWdodCB9IGZyb20gJ2ZwLXRzL0VpdGhlcidcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKGxlZnRzKFtyaWdodCgxKSwgbGVmdCgnZm9vJyksIHJpZ2h0KDIpXSksIFsnZm9vJ10pXG4gKlxuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgbGVmdHMgPSBmdW5jdGlvbiAoYXMpIHtcbiAgICB2YXIgciA9IFtdO1xuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgYXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgdmFyIGEgPSBhc1tpXTtcbiAgICAgICAgaWYgKGEuX3RhZyA9PT0gJ0xlZnQnKSB7XG4gICAgICAgICAgICByLnB1c2goYS5sZWZ0KTtcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gcjtcbn07XG4vKipcbiAqIFNvcnQgdGhlIGVsZW1lbnRzIG9mIGFuIGFycmF5IGluIGluY3JlYXNpbmcgb3JkZXIsIGNyZWF0aW5nIGEgbmV3IGFycmF5XG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IHNvcnQgfSBmcm9tICdmcC10cy9BcnJheSdcbiAqIGltcG9ydCAqIGFzIE4gZnJvbSAnZnAtdHMvbnVtYmVyJ1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoc29ydChOLk9yZCkoWzMsIDIsIDFdKSwgWzEsIDIsIDNdKVxuICpcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIHNvcnQgPSBmdW5jdGlvbiAoTykge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgcmV0dXJuIGFzLmxlbmd0aCA8PSAxID8gY29weShhcykgOiBhcy5zbGljZSgpLnNvcnQoTy5jb21wYXJlKTtcbiAgICB9O1xufTtcbi8qKlxuICogQXBwbHkgYSBmdW5jdGlvbiB0byBwYWlycyBvZiBlbGVtZW50cyBhdCB0aGUgc2FtZSBpbmRleCBpbiB0d28gYXJyYXlzLCBjb2xsZWN0aW5nIHRoZSByZXN1bHRzIGluIGEgbmV3IGFycmF5LiBJZiBvbmVcbiAqIGlucHV0IGFycmF5IGlzIHNob3J0LCBleGNlc3MgZWxlbWVudHMgb2YgdGhlIGxvbmdlciBhcnJheSBhcmUgZGlzY2FyZGVkLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyB6aXBXaXRoIH0gZnJvbSAnZnAtdHMvQXJyYXknXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbCh6aXBXaXRoKFsxLCAyLCAzXSwgWydhJywgJ2InLCAnYycsICdkJ10sIChuLCBzKSA9PiBzICsgbiksIFsnYTEnLCAnYjInLCAnYzMnXSlcbiAqXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciB6aXBXaXRoID0gZnVuY3Rpb24gKGZhLCBmYiwgZikge1xuICAgIHZhciBmYyA9IFtdO1xuICAgIHZhciBsZW4gPSBNYXRoLm1pbihmYS5sZW5ndGgsIGZiLmxlbmd0aCk7XG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBsZW47IGkrKykge1xuICAgICAgICBmY1tpXSA9IGYoZmFbaV0sIGZiW2ldKTtcbiAgICB9XG4gICAgcmV0dXJuIGZjO1xufTtcbmV4cG9ydCBmdW5jdGlvbiB6aXAoYXMsIGJzKSB7XG4gICAgaWYgKGJzID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIChicykgeyByZXR1cm4gemlwKGJzLCBhcyk7IH07XG4gICAgfVxuICAgIHJldHVybiB6aXBXaXRoKGFzLCBicywgZnVuY3Rpb24gKGEsIGIpIHsgcmV0dXJuIFthLCBiXTsgfSk7XG59XG4vKipcbiAqIFRoZSBmdW5jdGlvbiBpcyByZXZlcnNlIG9mIGB6aXBgLiBUYWtlcyBhbiBhcnJheSBvZiBwYWlycyBhbmQgcmV0dXJuIHR3byBjb3JyZXNwb25kaW5nIGFycmF5c1xuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyB1bnppcCB9IGZyb20gJ2ZwLXRzL0FycmF5J1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwodW56aXAoW1sxLCAnYSddLCBbMiwgJ2InXSwgWzMsICdjJ11dKSwgW1sxLCAyLCAzXSwgWydhJywgJ2InLCAnYyddXSlcbiAqXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciB1bnppcCA9IGZ1bmN0aW9uIChhcykge1xuICAgIHZhciBmYSA9IFtdO1xuICAgIHZhciBmYiA9IFtdO1xuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgYXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgZmFbaV0gPSBhc1tpXVswXTtcbiAgICAgICAgZmJbaV0gPSBhc1tpXVsxXTtcbiAgICB9XG4gICAgcmV0dXJuIFtmYSwgZmJdO1xufTtcbi8qKlxuICogQ3JlYXRlcyBhIG5ldyBgQXJyYXlgLCBwcmVwZW5kaW5nIGFuIGVsZW1lbnQgdG8gZXZlcnkgbWVtYmVyIG9mIHRoZSBpbnB1dCBgQXJyYXlgLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBwcmVwZW5kQWxsIH0gZnJvbSAnZnAtdHMvQXJyYXknXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChwcmVwZW5kQWxsKDkpKFsxLCAyLCAzLCA0XSksIFs5LCAxLCA5LCAyLCA5LCAzLCA5LCA0XSlcbiAqXG4gKiBAc2luY2UgMi4xMC4wXG4gKi9cbmV4cG9ydCB2YXIgcHJlcGVuZEFsbCA9IGZ1bmN0aW9uIChtaWRkbGUpIHtcbiAgICB2YXIgZiA9IE5FQS5wcmVwZW5kQWxsKG1pZGRsZSk7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykgeyByZXR1cm4gKGlzTm9uRW1wdHkoYXMpID8gZihhcykgOiBbXSk7IH07XG59O1xuLyoqXG4gKiBDcmVhdGVzIGEgbmV3IGBBcnJheWAgcGxhY2luZyBhbiBlbGVtZW50IGluIGJldHdlZW4gbWVtYmVycyBvZiB0aGUgaW5wdXQgYEFycmF5YC5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgaW50ZXJzcGVyc2UgfSBmcm9tICdmcC10cy9BcnJheSdcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKGludGVyc3BlcnNlKDkpKFsxLCAyLCAzLCA0XSksIFsxLCA5LCAyLCA5LCAzLCA5LCA0XSlcbiAqXG4gKiBAc2luY2UgMi45LjBcbiAqL1xuZXhwb3J0IHZhciBpbnRlcnNwZXJzZSA9IGZ1bmN0aW9uIChtaWRkbGUpIHtcbiAgICB2YXIgZiA9IE5FQS5pbnRlcnNwZXJzZShtaWRkbGUpO1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHsgcmV0dXJuIChpc05vbkVtcHR5KGFzKSA/IGYoYXMpIDogY29weShhcykpOyB9O1xufTtcbi8qKlxuICogQ3JlYXRlcyBhIG5ldyBgQXJyYXlgIHJvdGF0aW5nIHRoZSBpbnB1dCBgQXJyYXlgIGJ5IGBuYCBzdGVwcy5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgcm90YXRlIH0gZnJvbSAnZnAtdHMvQXJyYXknXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChyb3RhdGUoMikoWzEsIDIsIDMsIDQsIDVdKSwgWzQsIDUsIDEsIDIsIDNdKVxuICpcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIHJvdGF0ZSA9IGZ1bmN0aW9uIChuKSB7XG4gICAgdmFyIGYgPSBORUEucm90YXRlKG4pO1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHsgcmV0dXJuIChpc05vbkVtcHR5KGFzKSA/IGYoYXMpIDogY29weShhcykpOyB9O1xufTtcbi8vIFRPRE86IHJlbW92ZSBub24tY3VycmllZCBvdmVybG9hZGluZyBpbiB2M1xuLyoqXG4gKiBUZXN0IGlmIGEgdmFsdWUgaXMgYSBtZW1iZXIgb2YgYW4gYEFycmF5YC4gVGFrZXMgYSBgRXE8QT5gIGFzIGEgc2luZ2xlXG4gKiBhcmd1bWVudCB3aGljaCByZXR1cm5zIHRoZSBmdW5jdGlvbiB0byB1c2UgdG8gc2VhcmNoIGZvciBhIHZhbHVlIG9mIHR5cGUgYEFgIGluXG4gKiBhbiBgQXJyYXk8QT5gLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBlbGVtIH0gZnJvbSAnZnAtdHMvQXJyYXknXG4gKiBpbXBvcnQgKiBhcyBOIGZyb20gJ2ZwLXRzL251bWJlcidcbiAqIGltcG9ydCB7IHBpcGUgfSBmcm9tICdmcC10cy9mdW5jdGlvbidcbiAqXG4gKiBhc3NlcnQuc3RyaWN0RXF1YWwocGlwZShbMSwgMiwgM10sIGVsZW0oTi5FcSkoMikpLCB0cnVlKVxuICogYXNzZXJ0LnN0cmljdEVxdWFsKHBpcGUoWzEsIDIsIDNdLCBlbGVtKE4uRXEpKDApKSwgZmFsc2UpXG4gKlxuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgZWxlbSA9IFJBLmVsZW07XG4vKipcbiAqIENyZWF0ZXMgYSBuZXcgYEFycmF5YCByZW1vdmluZyBkdXBsaWNhdGUgZWxlbWVudHMsIGtlZXBpbmcgdGhlIGZpcnN0IG9jY3VycmVuY2Ugb2YgYW4gZWxlbWVudCxcbiAqIGJhc2VkIG9uIGEgYEVxPEE+YC5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgdW5pcSB9IGZyb20gJ2ZwLXRzL0FycmF5J1xuICogaW1wb3J0ICogYXMgTiBmcm9tICdmcC10cy9udW1iZXInXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbCh1bmlxKE4uRXEpKFsxLCAyLCAxXSksIFsxLCAyXSlcbiAqXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciB1bmlxID0gZnVuY3Rpb24gKEUpIHtcbiAgICB2YXIgZiA9IE5FQS51bmlxKEUpO1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHsgcmV0dXJuIChpc05vbkVtcHR5KGFzKSA/IGYoYXMpIDogY29weShhcykpOyB9O1xufTtcbi8qKlxuICogU29ydCB0aGUgZWxlbWVudHMgb2YgYW4gYXJyYXkgaW4gaW5jcmVhc2luZyBvcmRlciwgd2hlcmUgZWxlbWVudHMgYXJlIGNvbXBhcmVkIHVzaW5nIGZpcnN0IGBvcmRzWzBdYCwgdGhlbiBgb3Jkc1sxXWAsXG4gKiBldGMuLi5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgc29ydEJ5IH0gZnJvbSAnZnAtdHMvQXJyYXknXG4gKiBpbXBvcnQgeyBjb250cmFtYXAgfSBmcm9tICdmcC10cy9PcmQnXG4gKiBpbXBvcnQgKiBhcyBTIGZyb20gJ2ZwLXRzL3N0cmluZydcbiAqIGltcG9ydCAqIGFzIE4gZnJvbSAnZnAtdHMvbnVtYmVyJ1xuICogaW1wb3J0IHsgcGlwZSB9IGZyb20gJ2ZwLXRzL2Z1bmN0aW9uJ1xuICpcbiAqIGludGVyZmFjZSBQZXJzb24ge1xuICogICByZWFkb25seSBuYW1lOiBzdHJpbmdcbiAqICAgcmVhZG9ubHkgYWdlOiBudW1iZXJcbiAqIH1cbiAqIGNvbnN0IGJ5TmFtZSA9IHBpcGUoUy5PcmQsIGNvbnRyYW1hcCgocDogUGVyc29uKSA9PiBwLm5hbWUpKVxuICogY29uc3QgYnlBZ2UgPSBwaXBlKE4uT3JkLCBjb250cmFtYXAoKHA6IFBlcnNvbikgPT4gcC5hZ2UpKVxuICpcbiAqIGNvbnN0IHNvcnRCeU5hbWVCeUFnZSA9IHNvcnRCeShbYnlOYW1lLCBieUFnZV0pXG4gKlxuICogY29uc3QgcGVyc29ucyA9IFt7IG5hbWU6ICdhJywgYWdlOiAxIH0sIHsgbmFtZTogJ2InLCBhZ2U6IDMgfSwgeyBuYW1lOiAnYycsIGFnZTogMiB9LCB7IG5hbWU6ICdiJywgYWdlOiAyIH1dXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKHNvcnRCeU5hbWVCeUFnZShwZXJzb25zKSwgW1xuICogICB7IG5hbWU6ICdhJywgYWdlOiAxIH0sXG4gKiAgIHsgbmFtZTogJ2InLCBhZ2U6IDIgfSxcbiAqICAgeyBuYW1lOiAnYicsIGFnZTogMyB9LFxuICogICB7IG5hbWU6ICdjJywgYWdlOiAyIH1cbiAqIF0pXG4gKlxuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgc29ydEJ5ID0gZnVuY3Rpb24gKG9yZHMpIHtcbiAgICB2YXIgZiA9IE5FQS5zb3J0Qnkob3Jkcyk7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykgeyByZXR1cm4gKGlzTm9uRW1wdHkoYXMpID8gZihhcykgOiBjb3B5KGFzKSk7IH07XG59O1xuLyoqXG4gKiBBIHVzZWZ1bCByZWN1cnNpb24gcGF0dGVybiBmb3IgcHJvY2Vzc2luZyBhbiBhcnJheSB0byBwcm9kdWNlIGEgbmV3IGFycmF5LCBvZnRlbiB1c2VkIGZvciBcImNob3BwaW5nXCIgdXAgdGhlIGlucHV0XG4gKiBhcnJheS4gVHlwaWNhbGx5IGNob3AgaXMgY2FsbGVkIHdpdGggc29tZSBmdW5jdGlvbiB0aGF0IHdpbGwgY29uc3VtZSBhbiBpbml0aWFsIHByZWZpeCBvZiB0aGUgYXJyYXkgYW5kIHByb2R1Y2UgYVxuICogdmFsdWUgYW5kIHRoZSByZXN0IG9mIHRoZSBhcnJheS5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgRXEgfSBmcm9tICdmcC10cy9FcSdcbiAqIGltcG9ydCAqIGFzIEEgZnJvbSAnZnAtdHMvQXJyYXknXG4gKiBpbXBvcnQgKiBhcyBOIGZyb20gJ2ZwLXRzL251bWJlcidcbiAqIGltcG9ydCB7IHBpcGUgfSBmcm9tICdmcC10cy9mdW5jdGlvbidcbiAqXG4gKiBjb25zdCBncm91cCA9IDxBPihTOiBFcTxBPik6ICgoYXM6IEFycmF5PEE+KSA9PiBBcnJheTxBcnJheTxBPj4pID0+IHtcbiAqICAgcmV0dXJuIEEuY2hvcChhcyA9PiB7XG4gKiAgICAgY29uc3QgeyBpbml0LCByZXN0IH0gPSBwaXBlKGFzLCBBLnNwYW5MZWZ0KChhOiBBKSA9PiBTLmVxdWFscyhhLCBhc1swXSkpKVxuICogICAgIHJldHVybiBbaW5pdCwgcmVzdF1cbiAqICAgfSlcbiAqIH1cbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoZ3JvdXAoTi5FcSkoWzEsIDEsIDIsIDMsIDMsIDRdKSwgW1sxLCAxXSwgWzJdLCBbMywgM10sIFs0XV0pXG4gKlxuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgY2hvcCA9IGZ1bmN0aW9uIChmKSB7XG4gICAgdmFyIGcgPSBORUEuY2hvcChmKTtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7IHJldHVybiAoaXNOb25FbXB0eShhcykgPyBnKGFzKSA6IFtdKTsgfTtcbn07XG4vKipcbiAqIFNwbGl0cyBhbiBgQXJyYXlgIGludG8gdHdvIHBpZWNlcywgdGhlIGZpcnN0IHBpZWNlIGhhcyBtYXggYG5gIGVsZW1lbnRzLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBzcGxpdEF0IH0gZnJvbSAnZnAtdHMvQXJyYXknXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChzcGxpdEF0KDIpKFsxLCAyLCAzLCA0LCA1XSksIFtbMSwgMl0sIFszLCA0LCA1XV0pXG4gKlxuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgc3BsaXRBdCA9IGZ1bmN0aW9uIChuKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykge1xuICAgICAgICByZXR1cm4gbiA+PSAxICYmIGlzTm9uRW1wdHkoYXMpID8gTkVBLnNwbGl0QXQobikoYXMpIDogaXNFbXB0eShhcykgPyBbY29weShhcyksIFtdXSA6IFtbXSwgY29weShhcyldO1xuICAgIH07XG59O1xuLyoqXG4gKiBTcGxpdHMgYW4gYXJyYXkgaW50byBsZW5ndGgtYG5gIHBpZWNlcy4gVGhlIGxhc3QgcGllY2Ugd2lsbCBiZSBzaG9ydGVyIGlmIGBuYCBkb2VzIG5vdCBldmVubHkgZGl2aWRlIHRoZSBsZW5ndGggb2ZcbiAqIHRoZSBhcnJheS4gTm90ZSB0aGF0IGBjaHVua3NPZihuKShbXSlgIGlzIGBbXWAsIG5vdCBgW1tdXWAuIFRoaXMgaXMgaW50ZW50aW9uYWwsIGFuZCBpcyBjb25zaXN0ZW50IHdpdGggYSByZWN1cnNpdmVcbiAqIGRlZmluaXRpb24gb2YgYGNodW5rc09mYDsgaXQgc2F0aXNmaWVzIHRoZSBwcm9wZXJ0eSB0aGF0XG4gKlxuICogYGBgdHNcbiAqIGNodW5rc09mKG4pKHhzKS5jb25jYXQoY2h1bmtzT2YobikoeXMpKSA9PSBjaHVua3NPZihuKSh4cy5jb25jYXQoeXMpKSlcbiAqIGBgYFxuICpcbiAqIHdoZW5ldmVyIGBuYCBldmVubHkgZGl2aWRlcyB0aGUgbGVuZ3RoIG9mIGB4c2AuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IGNodW5rc09mIH0gZnJvbSAnZnAtdHMvQXJyYXknXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChjaHVua3NPZigyKShbMSwgMiwgMywgNCwgNV0pLCBbWzEsIDJdLCBbMywgNF0sIFs1XV0pXG4gKlxuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgY2h1bmtzT2YgPSBmdW5jdGlvbiAobikge1xuICAgIHZhciBmID0gTkVBLmNodW5rc09mKG4pO1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHsgcmV0dXJuIChpc05vbkVtcHR5KGFzKSA/IGYoYXMpIDogW10pOyB9O1xufTtcbi8qKlxuICogQGNhdGVnb3J5IGxpZnRpbmdcbiAqIEBzaW5jZSAyLjExLjBcbiAqL1xuZXhwb3J0IHZhciBmcm9tT3B0aW9uSyA9IGZ1bmN0aW9uIChmKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIGEgPSBbXTtcbiAgICAgICAgZm9yICh2YXIgX2kgPSAwOyBfaSA8IGFyZ3VtZW50cy5sZW5ndGg7IF9pKyspIHtcbiAgICAgICAgICAgIGFbX2ldID0gYXJndW1lbnRzW19pXTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gZnJvbU9wdGlvbihmLmFwcGx5KHZvaWQgMCwgYSkpO1xuICAgIH07XG59O1xuZXhwb3J0IGZ1bmN0aW9uIGNvbXByZWhlbnNpb24oaW5wdXQsIGYsIGcpIHtcbiAgICBpZiAoZyA9PT0gdm9pZCAwKSB7IGcgPSBmdW5jdGlvbiAoKSB7IHJldHVybiB0cnVlOyB9OyB9XG4gICAgdmFyIGdvID0gZnVuY3Rpb24gKHNjb3BlLCBpbnB1dCkge1xuICAgICAgICByZXR1cm4gaXNOb25FbXB0eShpbnB1dClcbiAgICAgICAgICAgID8gZmxhdE1hcChORUEuaGVhZChpbnB1dCksIGZ1bmN0aW9uIChhKSB7IHJldHVybiBnbyhwaXBlKHNjb3BlLCBhcHBlbmQoYSkpLCBORUEudGFpbChpbnB1dCkpOyB9KVxuICAgICAgICAgICAgOiBnLmFwcGx5KHZvaWQgMCwgc2NvcGUpID8gW2YuYXBwbHkodm9pZCAwLCBzY29wZSldXG4gICAgICAgICAgICAgICAgOiBbXTtcbiAgICB9O1xuICAgIHJldHVybiBnbyhbXSwgaW5wdXQpO1xufVxuLyoqXG4gKiBAc2luY2UgMi4xMS4wXG4gKi9cbmV4cG9ydCB2YXIgY29uY2F0VyA9IGZ1bmN0aW9uIChzZWNvbmQpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGZpcnN0KSB7XG4gICAgICAgIHJldHVybiBpc0VtcHR5KGZpcnN0KSA/IGNvcHkoc2Vjb25kKSA6IGlzRW1wdHkoc2Vjb25kKSA/IGNvcHkoZmlyc3QpIDogZmlyc3QuY29uY2F0KHNlY29uZCk7XG4gICAgfTtcbn07XG4vKipcbiAqIEBzaW5jZSAyLjExLjBcbiAqL1xuZXhwb3J0IHZhciBjb25jYXQgPSBjb25jYXRXO1xuZXhwb3J0IGZ1bmN0aW9uIHVuaW9uKEUpIHtcbiAgICB2YXIgdW5pb25FID0gTkVBLnVuaW9uKEUpO1xuICAgIHJldHVybiBmdW5jdGlvbiAoZmlyc3QsIHNlY29uZCkge1xuICAgICAgICBpZiAoc2Vjb25kID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIHZhciB1bmlvbkVfMSA9IHVuaW9uKEUpO1xuICAgICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIChzZWNvbmQpIHsgcmV0dXJuIHVuaW9uRV8xKHNlY29uZCwgZmlyc3QpOyB9O1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBpc05vbkVtcHR5KGZpcnN0KSAmJiBpc05vbkVtcHR5KHNlY29uZClcbiAgICAgICAgICAgID8gdW5pb25FKHNlY29uZCkoZmlyc3QpXG4gICAgICAgICAgICA6IGlzTm9uRW1wdHkoZmlyc3QpXG4gICAgICAgICAgICAgICAgPyBjb3B5KGZpcnN0KVxuICAgICAgICAgICAgICAgIDogY29weShzZWNvbmQpO1xuICAgIH07XG59XG5leHBvcnQgZnVuY3Rpb24gaW50ZXJzZWN0aW9uKEUpIHtcbiAgICB2YXIgZWxlbUUgPSBlbGVtKEUpO1xuICAgIHJldHVybiBmdW5jdGlvbiAoeHMsIHlzKSB7XG4gICAgICAgIGlmICh5cyA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICB2YXIgaW50ZXJzZWN0aW9uRV8xID0gaW50ZXJzZWN0aW9uKEUpO1xuICAgICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uICh5cykgeyByZXR1cm4gaW50ZXJzZWN0aW9uRV8xKHlzLCB4cyk7IH07XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHhzLmZpbHRlcihmdW5jdGlvbiAoYSkgeyByZXR1cm4gZWxlbUUoYSwgeXMpOyB9KTtcbiAgICB9O1xufVxuZXhwb3J0IGZ1bmN0aW9uIGRpZmZlcmVuY2UoRSkge1xuICAgIHZhciBlbGVtRSA9IGVsZW0oRSk7XG4gICAgcmV0dXJuIGZ1bmN0aW9uICh4cywgeXMpIHtcbiAgICAgICAgaWYgKHlzID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIHZhciBkaWZmZXJlbmNlRV8xID0gZGlmZmVyZW5jZShFKTtcbiAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbiAoeXMpIHsgcmV0dXJuIGRpZmZlcmVuY2VFXzEoeXMsIHhzKTsgfTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4geHMuZmlsdGVyKGZ1bmN0aW9uIChhKSB7IHJldHVybiAhZWxlbUUoYSwgeXMpOyB9KTtcbiAgICB9O1xufVxudmFyIF9tYXAgPSBmdW5jdGlvbiAoZmEsIGYpIHsgcmV0dXJuIHBpcGUoZmEsIG1hcChmKSk7IH07XG4vKiBpc3RhbmJ1bCBpZ25vcmUgbmV4dCAqL1xudmFyIF9tYXBXaXRoSW5kZXggPSBmdW5jdGlvbiAoZmEsIGYpIHsgcmV0dXJuIHBpcGUoZmEsIG1hcFdpdGhJbmRleChmKSk7IH07XG52YXIgX2FwID0gZnVuY3Rpb24gKGZhYiwgZmEpIHsgcmV0dXJuIHBpcGUoZmFiLCBhcChmYSkpOyB9O1xuLyogaXN0YW5idWwgaWdub3JlIG5leHQgKi9cbnZhciBfZmlsdGVyID0gZnVuY3Rpb24gKGZhLCBwcmVkaWNhdGUpIHsgcmV0dXJuIHBpcGUoZmEsIGZpbHRlcihwcmVkaWNhdGUpKTsgfTtcbi8qIGlzdGFuYnVsIGlnbm9yZSBuZXh0ICovXG52YXIgX2ZpbHRlck1hcCA9IGZ1bmN0aW9uIChmYSwgZikgeyByZXR1cm4gcGlwZShmYSwgZmlsdGVyTWFwKGYpKTsgfTtcbi8qIGlzdGFuYnVsIGlnbm9yZSBuZXh0ICovXG52YXIgX3BhcnRpdGlvbiA9IGZ1bmN0aW9uIChmYSwgcHJlZGljYXRlKSB7XG4gICAgcmV0dXJuIHBpcGUoZmEsIHBhcnRpdGlvbihwcmVkaWNhdGUpKTtcbn07XG4vKiBpc3RhbmJ1bCBpZ25vcmUgbmV4dCAqL1xudmFyIF9wYXJ0aXRpb25NYXAgPSBmdW5jdGlvbiAoZmEsIGYpIHsgcmV0dXJuIHBpcGUoZmEsIHBhcnRpdGlvbk1hcChmKSk7IH07XG4vKiBpc3RhbmJ1bCBpZ25vcmUgbmV4dCAqL1xudmFyIF9wYXJ0aXRpb25XaXRoSW5kZXggPSBmdW5jdGlvbiAoZmEsIHByZWRpY2F0ZVdpdGhJbmRleCkgeyByZXR1cm4gcGlwZShmYSwgcGFydGl0aW9uV2l0aEluZGV4KHByZWRpY2F0ZVdpdGhJbmRleCkpOyB9O1xuLyogaXN0YW5idWwgaWdub3JlIG5leHQgKi9cbnZhciBfcGFydGl0aW9uTWFwV2l0aEluZGV4ID0gZnVuY3Rpb24gKGZhLCBmKSB7IHJldHVybiBwaXBlKGZhLCBwYXJ0aXRpb25NYXBXaXRoSW5kZXgoZikpOyB9O1xuLyogaXN0YW5idWwgaWdub3JlIG5leHQgKi9cbnZhciBfYWx0ID0gZnVuY3Rpb24gKGZhLCB0aGF0KSB7IHJldHVybiBwaXBlKGZhLCBhbHQodGhhdCkpOyB9O1xudmFyIF9yZWR1Y2UgPSBmdW5jdGlvbiAoZmEsIGIsIGYpIHsgcmV0dXJuIHBpcGUoZmEsIHJlZHVjZShiLCBmKSk7IH07XG4vKiBpc3RhbmJ1bCBpZ25vcmUgbmV4dCAqL1xudmFyIF9mb2xkTWFwID0gZnVuY3Rpb24gKE0pIHtcbiAgICB2YXIgZm9sZE1hcE0gPSBmb2xkTWFwKE0pO1xuICAgIHJldHVybiBmdW5jdGlvbiAoZmEsIGYpIHsgcmV0dXJuIHBpcGUoZmEsIGZvbGRNYXBNKGYpKTsgfTtcbn07XG4vKiBpc3RhbmJ1bCBpZ25vcmUgbmV4dCAqL1xudmFyIF9yZWR1Y2VSaWdodCA9IGZ1bmN0aW9uIChmYSwgYiwgZikgeyByZXR1cm4gcGlwZShmYSwgcmVkdWNlUmlnaHQoYiwgZikpOyB9O1xuLyogaXN0YW5idWwgaWdub3JlIG5leHQgKi9cbnZhciBfcmVkdWNlV2l0aEluZGV4ID0gZnVuY3Rpb24gKGZhLCBiLCBmKSB7XG4gICAgcmV0dXJuIHBpcGUoZmEsIHJlZHVjZVdpdGhJbmRleChiLCBmKSk7XG59O1xuLyogaXN0YW5idWwgaWdub3JlIG5leHQgKi9cbnZhciBfZm9sZE1hcFdpdGhJbmRleCA9IGZ1bmN0aW9uIChNKSB7XG4gICAgdmFyIGZvbGRNYXBXaXRoSW5kZXhNID0gZm9sZE1hcFdpdGhJbmRleChNKTtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGZhLCBmKSB7IHJldHVybiBwaXBlKGZhLCBmb2xkTWFwV2l0aEluZGV4TShmKSk7IH07XG59O1xuLyogaXN0YW5idWwgaWdub3JlIG5leHQgKi9cbnZhciBfcmVkdWNlUmlnaHRXaXRoSW5kZXggPSBmdW5jdGlvbiAoZmEsIGIsIGYpIHtcbiAgICByZXR1cm4gcGlwZShmYSwgcmVkdWNlUmlnaHRXaXRoSW5kZXgoYiwgZikpO1xufTtcbi8qIGlzdGFuYnVsIGlnbm9yZSBuZXh0ICovXG52YXIgX2ZpbHRlck1hcFdpdGhJbmRleCA9IGZ1bmN0aW9uIChmYSwgZikgeyByZXR1cm4gcGlwZShmYSwgZmlsdGVyTWFwV2l0aEluZGV4KGYpKTsgfTtcbi8qIGlzdGFuYnVsIGlnbm9yZSBuZXh0ICovXG52YXIgX2ZpbHRlcldpdGhJbmRleCA9IGZ1bmN0aW9uIChmYSwgcHJlZGljYXRlV2l0aEluZGV4KSB7IHJldHVybiBwaXBlKGZhLCBmaWx0ZXJXaXRoSW5kZXgocHJlZGljYXRlV2l0aEluZGV4KSk7IH07XG4vKiBpc3RhbmJ1bCBpZ25vcmUgbmV4dCAqL1xudmFyIF9leHRlbmQgPSBmdW5jdGlvbiAoZmEsIGYpIHsgcmV0dXJuIHBpcGUoZmEsIGV4dGVuZChmKSk7IH07XG4vKiBpc3RhbmJ1bCBpZ25vcmUgbmV4dCAqL1xudmFyIF90cmF2ZXJzZSA9IGZ1bmN0aW9uIChGKSB7XG4gICAgdmFyIHRyYXZlcnNlRiA9IHRyYXZlcnNlKEYpO1xuICAgIHJldHVybiBmdW5jdGlvbiAodGEsIGYpIHsgcmV0dXJuIHBpcGUodGEsIHRyYXZlcnNlRihmKSk7IH07XG59O1xuLyogaXN0YW5idWwgaWdub3JlIG5leHQgKi9cbnZhciBfdHJhdmVyc2VXaXRoSW5kZXggPSBmdW5jdGlvbiAoRikge1xuICAgIHZhciB0cmF2ZXJzZVdpdGhJbmRleEYgPSB0cmF2ZXJzZVdpdGhJbmRleChGKTtcbiAgICByZXR1cm4gZnVuY3Rpb24gKHRhLCBmKSB7IHJldHVybiBwaXBlKHRhLCB0cmF2ZXJzZVdpdGhJbmRleEYoZikpOyB9O1xufTtcbnZhciBfY2hhaW5SZWNEZXB0aEZpcnN0ID0gUkEuX2NoYWluUmVjRGVwdGhGaXJzdDtcbnZhciBfY2hhaW5SZWNCcmVhZHRoRmlyc3QgPSBSQS5fY2hhaW5SZWNCcmVhZHRoRmlyc3Q7XG4vKipcbiAqIEdpdmVuIGFuIGVsZW1lbnQgb2YgdGhlIGJhc2UgdHlwZSwgYG9mYCBidWlsZHMgYW4gYEFycmF5YCBjb250YWluaW5nIGp1c3QgdGhhdFxuICogZWxlbWVudCBvZiB0aGUgYmFzZSB0eXBlICh0aGlzIGlzIHVzZWZ1bCBmb3IgYnVpbGRpbmcgYSBgTW9uYWRgKS5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgb2YgfSBmcm9tICdmcC10cy9BcnJheSdcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKG9mKFwiYVwiKSwgW1wiYVwiXSk7XG4gKlxuICogQGNhdGVnb3J5IGNvbnN0cnVjdG9yc1xuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgb2YgPSBORUEub2Y7XG4vKipcbiAqIE1ha2VzIGFuIGVtcHR5IGBBcnJheWAsIHVzZWZ1bCBmb3IgYnVpbGRpbmcgYSBbYE1vbm9pZGBdKCNNb25vaWQpXG4gKlxuICogQHNpbmNlIDIuNy4wXG4gKi9cbmV4cG9ydCB2YXIgemVybyA9IGZ1bmN0aW9uICgpIHsgcmV0dXJuIFtdOyB9O1xuLyoqXG4gKiBgbWFwYCBjYW4gYmUgdXNlZCB0byB0dXJuIGZ1bmN0aW9ucyBgKGE6IEEpID0+IEJgIGludG8gZnVuY3Rpb25zIGAoZmE6IEFycmF5PEE+KSA9PiBBcnJheTxCPmAuXG4gKiBJbiBwcmFjdGljZSBpdCBhcHBsaWVzIHRoZSBiYXNlIGZ1bmN0aW9uIHRvIGVhY2ggZWxlbWVudCBvZiB0aGUgYXJyYXkgYW5kIGNvbGxlY3RzIHRoZVxuICogcmVzdWx0cyBpbiBhIG5ldyBhcnJheS5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgbWFwIH0gZnJvbSAnZnAtdHMvQXJyYXknXG4gKiBpbXBvcnQgeyBwaXBlIH0gZnJvbSAnZnAtdHMvZnVuY3Rpb24nXG4gKlxuICogY29uc3QgZiA9IChuOiBudW1iZXIpID0+IG4gKiAyO1xuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChwaXBlKFsxLCAyLCAzXSwgbWFwKGYpKSwgWzIsIDQsIDZdKTtcbiAqXG4gKiBAY2F0ZWdvcnkgbWFwcGluZ1xuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgbWFwID0gZnVuY3Rpb24gKGYpIHsgcmV0dXJuIGZ1bmN0aW9uIChmYSkgeyByZXR1cm4gZmEubWFwKGZ1bmN0aW9uIChhKSB7IHJldHVybiBmKGEpOyB9KTsgfTsgfTtcbi8qKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IGFwLCBtYXAsIG9mIH0gZnJvbSAnZnAtdHMvQXJyYXknXG4gKiBpbXBvcnQgeyBwaXBlIH0gZnJvbSAnZnAtdHMvZnVuY3Rpb24nXG4gKlxuICogLy8gYSBjdXJyaWVkIGZ1bmN0aW9uIHdpdGggMyBpbnB1dCBwYXJhbWV0ZXJlc1xuICogY29uc3QgZiA9IChzMTogc3RyaW5nKSA9PiAobjogbnVtYmVyKSA9PiAoczI6IHN0cmluZykgPT4gczEgKyBuICsgczI7XG4gKlxuICogLy8gbGV0J3MgdXNlIGBhcGAgdG8gaXRlcmF0ZSBgZmAgb3ZlciBhbiBhcnJheSBmb3IgZWFjaCBpbnB1dCBwYXJhbWV0ZXJcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwocGlwZShbXCJhXCIsIFwiYlwiXSwgbWFwKGYpLCBhcChbMSwgMl0pLCBhcChbXCLwn5iAXCIsIFwi8J+Yq1wiLCBcIvCfmI5cIl0pKSwgW1xuICogICBcImEx8J+YgFwiLCBcImEx8J+Yq1wiLCBcImEx8J+YjlwiLFxuICogICBcImEy8J+YgFwiLCBcImEy8J+Yq1wiLCBcImEy8J+YjlwiLFxuICogICBcImIx8J+YgFwiLCBcImIx8J+Yq1wiLCBcImIx8J+YjlwiLFxuICogICBcImIy8J+YgFwiLCBcImIy8J+Yq1wiLCBcImIy8J+YjlwiLFxuICogXSk7XG4gKlxuICogLy8gZ2l2ZW4gQXJyYXkgaW1wbGVtZW50cyB0aGUgQXBwbGljYXRpdmUgaW50ZXJmYWNlIHdpdGggdGhlIGBvZmAgbWV0aG9kLFxuICogLy8gd2UgY2FuIHdyaXRlIGV4YWN0bHkgdGhlIHNhbWUgdGhpbmcgaW4gYSBtb3JlIHN5bW1ldHJpYyB3YXlcbiAqIC8vIHVzaW5nIGBvZmAgb24gYGZgIGFuZCBgYXBgIG9uIGVhY2ggYXJyYXkgaW4gaW5wdXRcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoXG4gKiAgIHBpcGUob2YoZiksIGFwKFtcImFcIiwgXCJiXCJdKSwgYXAoWzEsIDJdKSwgYXAoW1wi8J+YgFwiLCBcIvCfmKtcIiwgXCLwn5iOXCJdKSksXG4gKiAgIHBpcGUoW1wiYVwiLCBcImJcIl0sIG1hcChmKSwgYXAoWzEsIDJdKSwgYXAoW1wi8J+YgFwiLCBcIvCfmKtcIiwgXCLwn5iOXCJdKSlcbiAqICk7XG4gKlxuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgYXAgPSBmdW5jdGlvbiAoZmEpIHtcbiAgICByZXR1cm4gZmxhdE1hcChmdW5jdGlvbiAoZikgeyByZXR1cm4gcGlwZShmYSwgbWFwKGYpKTsgfSk7XG59O1xuLyoqXG4gKiBDb21wb3NlcyBjb21wdXRhdGlvbnMgaW4gc2VxdWVuY2UsIHVzaW5nIHRoZSByZXR1cm4gdmFsdWUgb2Ygb25lIGNvbXB1dGF0aW9uIHRvXG4gKiBkZXRlcm1pbmUgdGhlIG5leHQgY29tcHV0YXRpb24uXG4gKlxuICogSW4gb3RoZXIgd29yZHMgaXQgdGFrZXMgYSBmdW5jdGlvbiBgZmAgdGhhdCBwcm9kdWNlcyBhbiBhcnJheSBmcm9tIGEgc2luZ2xlIGVsZW1lbnQgb2ZcbiAqIHRoZSBiYXNlIHR5cGUgYEFgIGFuZCByZXR1cm5zIGEgbmV3IGZ1bmN0aW9uIHdoaWNoIGFwcGxpZXMgYGZgIHRvIGVhY2ggZWxlbWVudCBvZiB0aGVcbiAqIGlucHV0IGFycmF5IChsaWtlIFtgbWFwYF0oI21hcCkpIGFuZCwgaW5zdGVhZCBvZiByZXR1cm5pbmcgYW4gYXJyYXkgb2YgYXJyYXlzLCBjb25jYXRlbmF0ZXMgdGhlXG4gKiByZXN1bHRzIGludG8gYSBzaW5nbGUgYXJyYXkgKGxpa2UgW2BmbGF0dGVuYF0oI2ZsYXR0ZW4pKS5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgZmxhdE1hcCwgbWFwLCByZXBsaWNhdGUgfSBmcm9tICdmcC10cy9BcnJheSdcbiAqIGltcG9ydCB7IHBpcGUgfSBmcm9tICdmcC10cy9mdW5jdGlvbidcbiAqXG4gKiBjb25zdCBmID0gKG46IG51bWJlcikgPT4gcmVwbGljYXRlKG4sIGAke259YCk7XG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKHBpcGUoWzEsIDIsIDNdLCBtYXAoZikpLCBbW1wiMVwiXSwgW1wiMlwiLCBcIjJcIl0sIFtcIjNcIiwgXCIzXCIsIFwiM1wiXV0pO1xuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChwaXBlKFsxLCAyLCAzXSwgZmxhdE1hcChmKSksIFtcIjFcIiwgXCIyXCIsIFwiMlwiLCBcIjNcIiwgXCIzXCIsIFwiM1wiXSk7XG4gKlxuICogQGNhdGVnb3J5IHNlcXVlbmNpbmdcbiAqIEBzaW5jZSAyLjE0LjBcbiAqL1xuZXhwb3J0IHZhciBmbGF0TWFwID0gLyojX19QVVJFX18qLyBkdWFsKDIsIGZ1bmN0aW9uIChtYSwgZikge1xuICAgIHJldHVybiBwaXBlKG1hLCBjaGFpbldpdGhJbmRleChmdW5jdGlvbiAoaSwgYSkgeyByZXR1cm4gZihhLCBpKTsgfSkpO1xufSk7XG4vKipcbiAqIFRha2VzIGFuIGFycmF5IG9mIGFycmF5cyBvZiBgQWAgYW5kIGZsYXR0ZW5zIHRoZW0gaW50byBhbiBhcnJheSBvZiBgQWBcbiAqIGJ5IGNvbmNhdGVuYXRpbmcgdGhlIGVsZW1lbnRzIG9mIGVhY2ggYXJyYXkgaW4gb3JkZXIuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IGZsYXR0ZW4gfSBmcm9tICdmcC10cy9BcnJheSdcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKGZsYXR0ZW4oW1tcImFcIl0sIFtcImJcIiwgXCJjXCJdLCBbXCJkXCIsIFwiZVwiLCBcImZcIl1dKSwgW1wiYVwiLCBcImJcIiwgXCJjXCIsIFwiZFwiLCBcImVcIiwgXCJmXCJdKTtcbiAqXG4gKiBAY2F0ZWdvcnkgc2VxdWVuY2luZ1xuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgZmxhdHRlbiA9IC8qI19fUFVSRV9fKi8gZmxhdE1hcChpZGVudGl0eSk7XG4vKipcbiAqIFNhbWUgYXMgW2BtYXBgXSgjbWFwKSwgYnV0IHRoZSBpdGVyYXRpbmcgZnVuY3Rpb24gdGFrZXMgYm90aCB0aGUgaW5kZXggYW5kIHRoZSB2YWx1ZVxuICogb2YgdGhlIGVsZW1lbnQuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IG1hcFdpdGhJbmRleCB9IGZyb20gJ2ZwLXRzL0FycmF5J1xuICogaW1wb3J0IHsgcGlwZSB9IGZyb20gJ2ZwLXRzL2Z1bmN0aW9uJ1xuICpcbiAqIGNvbnN0IGYgPSAoaTogbnVtYmVyLCBzOiBzdHJpbmcpID0+IGAke3N9IC0gJHtpfWA7XG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKHBpcGUoW1wiYVwiLCBcImJcIiwgXCJjXCJdLCBtYXBXaXRoSW5kZXgoZikpLCBbXCJhIC0gMFwiLCBcImIgLSAxXCIsIFwiYyAtIDJcIl0pO1xuICpcbiAqIEBjYXRlZ29yeSBtYXBwaW5nXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciBtYXBXaXRoSW5kZXggPSBmdW5jdGlvbiAoZikgeyByZXR1cm4gZnVuY3Rpb24gKGZhKSB7XG4gICAgcmV0dXJuIGZhLm1hcChmdW5jdGlvbiAoYSwgaSkgeyByZXR1cm4gZihpLCBhKTsgfSk7XG59OyB9O1xuLyoqXG4gKiBNYXBzIGFuIGFycmF5IHdpdGggYW4gaXRlcmF0aW5nIGZ1bmN0aW9uIHRoYXQgdGFrZXMgdGhlIGluZGV4IGFuZCB0aGUgdmFsdWUgb2ZcbiAqIGVhY2ggZWxlbWVudCBhbmQgcmV0dXJucyBhbiBgT3B0aW9uYC4gSXQga2VlcHMgb25seSB0aGUgYFNvbWVgIHZhbHVlcyBkaXNjYXJkaW5nXG4gKiB0aGUgYE5vbmVgcy5cbiAqXG4gKiBTYW1lIGFzIFtgZmlsdGVyTWFwYF0oI2ZpbHRlck1hcCksIGJ1dCB3aXRoIGFuIGl0ZXJhdGluZyBmdW5jdGlvbiB3aGljaCB0YWtlcyBhbHNvXG4gKiB0aGUgaW5kZXggYXMgaW5wdXQuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IGZpbHRlck1hcFdpdGhJbmRleCB9IGZyb20gJ2ZwLXRzL0FycmF5J1xuICogaW1wb3J0IHsgcGlwZSB9IGZyb20gJ2ZwLXRzL2Z1bmN0aW9uJ1xuICogaW1wb3J0IHsgb3B0aW9uIH0gZnJvbSBcImZwLXRzXCI7XG4gKlxuICogY29uc3QgZiA9IChpOiBudW1iZXIsIHM6IHN0cmluZykgPT4gKGkgJSAyID09PSAxID8gb3B0aW9uLnNvbWUocy50b1VwcGVyQ2FzZSgpKSA6IG9wdGlvbi5ub25lKTtcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwocGlwZShbXCJhXCIsIFwibm9cIiwgXCJuZWl0aGVyXCIsIFwiYlwiXSwgZmlsdGVyTWFwV2l0aEluZGV4KGYpKSwgW1wiTk9cIiwgXCJCXCJdKTtcbiAqXG4gKiBAY2F0ZWdvcnkgZmlsdGVyaW5nXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciBmaWx0ZXJNYXBXaXRoSW5kZXggPSBmdW5jdGlvbiAoZikge1xuICAgIHJldHVybiBmdW5jdGlvbiAoZmEpIHtcbiAgICAgICAgdmFyIG91dCA9IFtdO1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGZhLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICB2YXIgb3B0aW9uQiA9IGYoaSwgZmFbaV0pO1xuICAgICAgICAgICAgaWYgKF8uaXNTb21lKG9wdGlvbkIpKSB7XG4gICAgICAgICAgICAgICAgb3V0LnB1c2gob3B0aW9uQi52YWx1ZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG91dDtcbiAgICB9O1xufTtcbi8qKlxuICogTWFwcyBhbiBhcnJheSB3aXRoIGFuIGl0ZXJhdGluZyBmdW5jdGlvbiB0aGF0IHJldHVybnMgYW4gYE9wdGlvbmBcbiAqIGFuZCBpdCBrZWVwcyBvbmx5IHRoZSBgU29tZWAgdmFsdWVzIGRpc2NhcmRpbmcgdGhlIGBOb25lYHMuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IGZpbHRlck1hcCB9IGZyb20gJ2ZwLXRzL0FycmF5J1xuICogaW1wb3J0IHsgcGlwZSB9IGZyb20gJ2ZwLXRzL2Z1bmN0aW9uJ1xuICogaW1wb3J0IHsgb3B0aW9uIH0gZnJvbSBcImZwLXRzXCI7XG4gKlxuICogY29uc3QgZiA9IChzOiBzdHJpbmcpID0+IHMubGVuZ3RoID09PSAxID8gb3B0aW9uLnNvbWUocy50b1VwcGVyQ2FzZSgpKSA6IG9wdGlvbi5ub25lO1xuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChwaXBlKFtcImFcIiwgXCJub1wiLCBcIm5laXRoZXJcIiwgXCJiXCJdLCBmaWx0ZXJNYXAoZikpLCBbXCJBXCIsIFwiQlwiXSk7XG4gKlxuICogQGNhdGVnb3J5IGZpbHRlcmluZ1xuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgZmlsdGVyTWFwID0gZnVuY3Rpb24gKGYpIHtcbiAgICByZXR1cm4gZmlsdGVyTWFwV2l0aEluZGV4KGZ1bmN0aW9uIChfLCBhKSB7IHJldHVybiBmKGEpOyB9KTtcbn07XG4vKipcbiAqIENvbXBhY3QgYW4gYXJyYXkgb2YgYE9wdGlvbmBzIGRpc2NhcmRpbmcgdGhlIGBOb25lYCB2YWx1ZXMgYW5kXG4gKiBrZWVwaW5nIHRoZSBgU29tZWAgdmFsdWVzLiBJdCByZXR1cm5zIGEgbmV3IGFycmF5IGNvbnRhaW5pbmcgdGhlIHZhbHVlcyBvZlxuICogdGhlIGBTb21lYCBvcHRpb25zLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBjb21wYWN0IH0gZnJvbSAnZnAtdHMvQXJyYXknXG4gKiBpbXBvcnQgeyBvcHRpb24gfSBmcm9tIFwiZnAtdHNcIjtcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKGNvbXBhY3QoW29wdGlvbi5zb21lKFwiYVwiKSwgb3B0aW9uLm5vbmUsIG9wdGlvbi5zb21lKFwiYlwiKV0pLCBbXCJhXCIsIFwiYlwiXSk7XG4gKlxuICogQGNhdGVnb3J5IGZpbHRlcmluZ1xuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgY29tcGFjdCA9IC8qI19fUFVSRV9fKi8gZmlsdGVyTWFwKGlkZW50aXR5KTtcbi8qKlxuICogU2VwYXJhdGUgYW4gYXJyYXkgb2YgYEVpdGhlcmBzIGludG8gYExlZnRgcyBhbmQgYFJpZ2h0YHMsIGNyZWF0aW5nIHR3byBuZXcgYXJyYXlzOlxuICogb25lIGNvbnRhaW5pbmcgYWxsIHRoZSBsZWZ0IHZhbHVlcyBhbmQgb25lIGNvbnRhaW5pbmcgYWxsIHRoZSByaWdodCB2YWx1ZXMuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IHNlcGFyYXRlIH0gZnJvbSAnZnAtdHMvQXJyYXknXG4gKiBpbXBvcnQgeyBlaXRoZXIgfSBmcm9tIFwiZnAtdHNcIjtcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKHNlcGFyYXRlKFtlaXRoZXIucmlnaHQoXCJyMVwiKSwgZWl0aGVyLmxlZnQoXCJsMVwiKSwgZWl0aGVyLnJpZ2h0KFwicjJcIildKSwge1xuICogICBsZWZ0OiBbXCJsMVwiXSxcbiAqICAgcmlnaHQ6IFtcInIxXCIsIFwicjJcIl0sXG4gKiB9KTtcbiAqXG4gKiBAY2F0ZWdvcnkgZmlsdGVyaW5nXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciBzZXBhcmF0ZSA9IGZ1bmN0aW9uIChmYSkge1xuICAgIHZhciBsZWZ0ID0gW107XG4gICAgdmFyIHJpZ2h0ID0gW107XG4gICAgZm9yICh2YXIgX2kgPSAwLCBmYV8xID0gZmE7IF9pIDwgZmFfMS5sZW5ndGg7IF9pKyspIHtcbiAgICAgICAgdmFyIGUgPSBmYV8xW19pXTtcbiAgICAgICAgaWYgKGUuX3RhZyA9PT0gJ0xlZnQnKSB7XG4gICAgICAgICAgICBsZWZ0LnB1c2goZS5sZWZ0KTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHJpZ2h0LnB1c2goZS5yaWdodCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHNlcGFyYXRlZChsZWZ0LCByaWdodCk7XG59O1xuLyoqXG4gKiBHaXZlbiBhbiBpdGVyYXRpbmcgZnVuY3Rpb24gdGhhdCBpcyBhIGBQcmVkaWNhdGVgIG9yIGEgYFJlZmluZW1lbnRgLFxuICogYGZpbHRlcmAgY3JlYXRlcyBhIG5ldyBgQXJyYXlgIGNvbnRhaW5pbmcgdGhlIGVsZW1lbnRzIG9mIHRoZSBvcmlnaW5hbFxuICogYEFycmF5YCBmb3Igd2hpY2ggdGhlIGl0ZXJhdGluZyBmdW5jdGlvbiBpcyBgdHJ1ZWAuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IGZpbHRlciB9IGZyb20gJ2ZwLXRzL0FycmF5J1xuICogaW1wb3J0IHsgaXNTdHJpbmcgfSBmcm9tIFwiZnAtdHMvbGliL3N0cmluZ1wiO1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoZmlsdGVyKGlzU3RyaW5nKShbXCJhXCIsIDEsIHt9LCBcImJcIiwgNV0pLCBbXCJhXCIsIFwiYlwiXSk7XG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKGZpbHRlcigoeDpudW1iZXIpID0+IHggPiAwKShbLTMsIDEsIC0yLCA1XSksIFsxLCA1XSk7XG4gKlxuICogQGNhdGVnb3J5IGZpbHRlcmluZ1xuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgZmlsdGVyID0gZnVuY3Rpb24gKHByZWRpY2F0ZSkge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgcmV0dXJuIGFzLmZpbHRlcihwcmVkaWNhdGUpO1xuICAgIH07XG59O1xuLyoqXG4gKiBHaXZlbiBhbiBpdGVyYXRpbmcgZnVuY3Rpb24gdGhhdCBpcyBhIGBQcmVkaWNhdGVgIG9yIGEgYFJlZmluZW1lbnRgLFxuICogYHBhcnRpdGlvbmAgY3JlYXRlcyB0d28gbmV3IGBBcnJheWBzOiBgcmlnaHRgIGNvbnRhaW5pbmcgdGhlIGVsZW1lbnRzIG9mIHRoZSBvcmlnaW5hbFxuICogYEFycmF5YCBmb3Igd2hpY2ggdGhlIGl0ZXJhdGluZyBmdW5jdGlvbiBpcyBgdHJ1ZWAsIGBsZWZ0YCBjb250YWluaW5nIHRoZSBlbGVtZW50c1xuICogZm9yIHdoaWNoIGl0IGlzIGZhbHNlLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBwYXJ0aXRpb24gfSBmcm9tICdmcC10cy9BcnJheSdcbiAqIGltcG9ydCB7IGlzU3RyaW5nIH0gZnJvbSBcImZwLXRzL2xpYi9zdHJpbmdcIjtcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKHBhcnRpdGlvbihpc1N0cmluZykoW1wiYVwiLCAxLCB7fSwgXCJiXCIsIDVdKSwgeyBsZWZ0OiBbMSwge30sIDVdLCByaWdodDogW1wiYVwiLCBcImJcIl0gfSk7XG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKHBhcnRpdGlvbigoeDogbnVtYmVyKSA9PiB4ID4gMCkoWy0zLCAxLCAtMiwgNV0pLCB7IGxlZnQ6IFstMywgLTJdLCByaWdodDogWzEsIDVdIH0pO1xuICpcbiAqIEBjYXRlZ29yeSBmaWx0ZXJpbmdcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIHBhcnRpdGlvbiA9IGZ1bmN0aW9uIChwcmVkaWNhdGUpIHtcbiAgICByZXR1cm4gcGFydGl0aW9uV2l0aEluZGV4KGZ1bmN0aW9uIChfLCBhKSB7IHJldHVybiBwcmVkaWNhdGUoYSk7IH0pO1xufTtcbi8qKlxuICogU2FtZSBhcyBbYHBhcnRpdGlvbmBdKCNwYXJ0aXRpb24pLCBidXQgcGFzc2luZyBhbHNvIHRoZSBpbmRleCB0byB0aGUgaXRlcmF0aW5nIGZ1bmN0aW9uLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBwYXJ0aXRpb25XaXRoSW5kZXggfSBmcm9tICdmcC10cy9BcnJheSdcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKHBhcnRpdGlvbldpdGhJbmRleCgoaW5kZXgsIHg6IG51bWJlcikgPT4gaW5kZXggPCAzICYmIHggPiAwKShbLTIsIDUsIDYsIDddKSwge1xuICogICBsZWZ0OiBbLTIsIDddLFxuICogICByaWdodDogWzUsIDZdLFxuICogfSk7XG4gKlxuICogQGNhdGVnb3J5IGZpbHRlcmluZ1xuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgcGFydGl0aW9uV2l0aEluZGV4ID0gZnVuY3Rpb24gKHByZWRpY2F0ZVdpdGhJbmRleCkge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgdmFyIGxlZnQgPSBbXTtcbiAgICAgICAgdmFyIHJpZ2h0ID0gW107XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgYXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIHZhciBiID0gYXNbaV07XG4gICAgICAgICAgICBpZiAocHJlZGljYXRlV2l0aEluZGV4KGksIGIpKSB7XG4gICAgICAgICAgICAgICAgcmlnaHQucHVzaChiKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIGxlZnQucHVzaChiKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gc2VwYXJhdGVkKGxlZnQsIHJpZ2h0KTtcbiAgICB9O1xufTtcbi8qKlxuICogR2l2ZW4gYW4gaXRlcmF0aW5nIGZ1bmN0aW9uIHRoYXQgcmV0dXJucyBhbiBgRWl0aGVyYCxcbiAqIGBwYXJ0aXRpb25NYXBgIGFwcGxpZXMgdGhlIGl0ZXJhdGluZyBmdW5jdGlvbiB0byBlYWNoIGVsZW1lbnQgYW5kIGl0IGNyZWF0ZXMgdHdvIGBBcnJheWBzOlxuICogYHJpZ2h0YCBjb250YWluaW5nIHRoZSB2YWx1ZXMgb2YgYFJpZ2h0YCByZXN1bHRzLCBgbGVmdGAgY29udGFpbmluZyB0aGUgdmFsdWVzIG9mIGBMZWZ0YCByZXN1bHRzLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBwYXJ0aXRpb25NYXAgfSBmcm9tICdmcC10cy9BcnJheSdcbiAqIGltcG9ydCB7IEVpdGhlciwgbGVmdCwgcmlnaHQgfSBmcm9tIFwiZnAtdHMvbGliL0VpdGhlclwiO1xuICpcbiAqIGNvbnN0IHVwcGVySWZTdHJpbmcgPSA8Qj4oeDogQik6IEVpdGhlcjxCLCBzdHJpbmc+ID0+XG4gKiAgIHR5cGVvZiB4ID09PSBcInN0cmluZ1wiID8gcmlnaHQoeC50b1VwcGVyQ2FzZSgpKSA6IGxlZnQoeCk7XG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKHBhcnRpdGlvbk1hcCh1cHBlcklmU3RyaW5nKShbLTIsIFwiaGVsbG9cIiwgNiwgNywgXCJ3b3JsZFwiXSksIHtcbiAqICAgbGVmdDogWy0yLCA2LCA3XSxcbiAqICAgcmlnaHQ6IFsgJ0hFTExPJywgJ1dPUkxEJyBdLFxuICogfSk7XG4gKlxuICogQGNhdGVnb3J5IGZpbHRlcmluZ1xuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgcGFydGl0aW9uTWFwID0gZnVuY3Rpb24gKGYpIHsgcmV0dXJuIHBhcnRpdGlvbk1hcFdpdGhJbmRleChmdW5jdGlvbiAoXywgYSkgeyByZXR1cm4gZihhKTsgfSk7IH07XG4vKipcbiAqIFNhbWUgYXMgW2BwYXJ0aXRpb25NYXBgXSgjcGFydGl0aW9uTWFwKSwgYnV0IHBhc3NpbmcgYWxzbyB0aGUgaW5kZXggdG8gdGhlIGl0ZXJhdGluZyBmdW5jdGlvbi5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgcGFydGl0aW9uTWFwV2l0aEluZGV4IH0gZnJvbSAnZnAtdHMvQXJyYXknXG4gKiBpbXBvcnQgeyBFaXRoZXIsIGxlZnQsIHJpZ2h0IH0gZnJvbSBcImZwLXRzL2xpYi9FaXRoZXJcIjtcbiAqXG4gKiBjb25zdCB1cHBlcklmU3RyaW5nQmVmb3JlMyA9IDxCPihpbmRleDogbnVtYmVyLCB4OiBCKTogRWl0aGVyPEIsIHN0cmluZz4gPT5cbiAqICAgaW5kZXggPCAzICYmIHR5cGVvZiB4ID09PSBcInN0cmluZ1wiID8gcmlnaHQoeC50b1VwcGVyQ2FzZSgpKSA6IGxlZnQoeCk7XG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKHBhcnRpdGlvbk1hcFdpdGhJbmRleCh1cHBlcklmU3RyaW5nQmVmb3JlMykoWy0yLCBcImhlbGxvXCIsIDYsIDcsIFwid29ybGRcIl0pLCB7XG4gKiAgIGxlZnQ6IFstMiwgNiwgNywgXCJ3b3JsZFwiXSxcbiAqICAgcmlnaHQ6IFtcIkhFTExPXCJdLFxuICogfSk7XG4gKlxuICogQGNhdGVnb3J5IGZpbHRlcmluZ1xuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgcGFydGl0aW9uTWFwV2l0aEluZGV4ID0gZnVuY3Rpb24gKGYpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGZhKSB7XG4gICAgICAgIHZhciBsZWZ0ID0gW107XG4gICAgICAgIHZhciByaWdodCA9IFtdO1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGZhLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICB2YXIgZSA9IGYoaSwgZmFbaV0pO1xuICAgICAgICAgICAgaWYgKGUuX3RhZyA9PT0gJ0xlZnQnKSB7XG4gICAgICAgICAgICAgICAgbGVmdC5wdXNoKGUubGVmdCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICByaWdodC5wdXNoKGUucmlnaHQpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBzZXBhcmF0ZWQobGVmdCwgcmlnaHQpO1xuICAgIH07XG59O1xuLyoqXG4gKiBMZXNzIHN0cmljdCB2ZXJzaW9uIG9mIFtgYWx0YF0oI2FsdCkuXG4gKlxuICogVGhlIGBXYCBzdWZmaXggKHNob3J0IGZvciAqKlcqKmlkZW5pbmcpIG1lYW5zIHRoYXQgdGhlIHJldHVybiB0eXBlcyB3aWxsIGJlIG1lcmdlZC5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0ICogYXMgQSBmcm9tICdmcC10cy9BcnJheSdcbiAqIGltcG9ydCB7IHBpcGUgfSBmcm9tICdmcC10cy9mdW5jdGlvbidcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKFxuICogICBwaXBlKFxuICogICAgIFsxLCAyLCAzXSxcbiAqICAgICBBLmFsdFcoKCkgPT4gWydhJywgJ2InXSlcbiAqICAgKSxcbiAqICAgWzEsIDIsIDMsICdhJywgJ2InXVxuICogKVxuICpcbiAqIEBjYXRlZ29yeSBlcnJvciBoYW5kbGluZ1xuICogQHNpbmNlIDIuOS4wXG4gKi9cbmV4cG9ydCB2YXIgYWx0VyA9IGZ1bmN0aW9uICh0aGF0KSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChmYSkge1xuICAgICAgICByZXR1cm4gZmEuY29uY2F0KHRoYXQoKSk7XG4gICAgfTtcbn07XG4vKipcbiAqIElkZW50aWZpZXMgYW4gYXNzb2NpYXRpdmUgb3BlcmF0aW9uIG9uIGEgdHlwZSBjb25zdHJ1Y3Rvci4gSXQgaXMgc2ltaWxhciB0byBgU2VtaWdyb3VwYCwgZXhjZXB0IHRoYXQgaXQgYXBwbGllcyB0b1xuICogdHlwZXMgb2Yga2luZCBgKiAtPiAqYC5cbiAqXG4gKiBJbiBjYXNlIG9mIGBBcnJheWAgY29uY2F0ZW5hdGVzIHRoZSBpbnB1dHMgaW50byBhIHNpbmdsZSBhcnJheS5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0ICogYXMgQSBmcm9tICdmcC10cy9BcnJheSdcbiAqIGltcG9ydCB7IHBpcGUgfSBmcm9tICdmcC10cy9mdW5jdGlvbidcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKFxuICogICBwaXBlKFxuICogICAgIFsxLCAyLCAzXSxcbiAqICAgICBBLmFsdCgoKSA9PiBbNCwgNV0pXG4gKiAgICksXG4gKiAgIFsxLCAyLCAzLCA0LCA1XVxuICogKVxuICpcbiAqIEBjYXRlZ29yeSBlcnJvciBoYW5kbGluZ1xuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgYWx0ID0gYWx0Vztcbi8qKlxuICogU2FtZSBhcyBbYGZpbHRlcmBdKCNmaWx0ZXIpLCBidXQgcGFzc2luZyBhbHNvIHRoZSBpbmRleCB0byB0aGUgaXRlcmF0aW5nIGZ1bmN0aW9uLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBmaWx0ZXJXaXRoSW5kZXggfSBmcm9tICdmcC10cy9BcnJheSc7XG4gKlxuICogY29uc3QgZiA9IChpbmRleDogbnVtYmVyLCB4OiBudW1iZXIpID0+IHggPiAwICYmIGluZGV4IDw9IDI7XG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKGZpbHRlcldpdGhJbmRleChmKShbLTMsIDEsIC0yLCA1XSksIFsxXSk7XG4gKlxuICogQGNhdGVnb3J5IGZpbHRlcmluZ1xuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgZmlsdGVyV2l0aEluZGV4ID0gZnVuY3Rpb24gKHByZWRpY2F0ZVdpdGhJbmRleCkge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgcmV0dXJuIGFzLmZpbHRlcihmdW5jdGlvbiAoYiwgaSkgeyByZXR1cm4gcHJlZGljYXRlV2l0aEluZGV4KGksIGIpOyB9KTtcbiAgICB9O1xufTtcbi8qKlxuICogR2l2ZW4gYW4gaXRlcmF0aW5nIGZ1bmN0aW9uIHRoYXQgdGFrZXMgYEFycmF5PEE+YCBhcyBpbnB1dCwgYGV4dGVuZGAgcmV0dXJuc1xuICogYW4gYXJyYXkgY29udGFpbmluZyB0aGUgcmVzdWx0cyBvZiB0aGUgaXRlcmF0aW5nIGZ1bmN0aW9uIGFwcGxpZWQgdG8gdGhlIHdob2xlIGlucHV0XG4gKiBgQXJyYXlgLCB0aGVuIHRvIHRoZSBpbnB1dCBgQXJyYXlgIHdpdGhvdXQgdGhlIGZpcnN0IGVsZW1lbnQsIHRoZW4gdG8gdGhlIGlucHV0XG4gKiBgQXJyYXlgIHdpdGhvdXQgdGhlIGZpcnN0IHR3byBlbGVtZW50cywgZXRjLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBleHRlbmQgfSBmcm9tICdmcC10cy9BcnJheSdcbiAqXG4gKiBjb25zdCBmID0gKGE6IHN0cmluZ1tdKSA9PiBhLmpvaW4oXCIsXCIpO1xuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChleHRlbmQoZikoW1wiYVwiLCBcImJcIiwgXCJjXCJdKSwgW1wiYSxiLGNcIiwgXCJiLGNcIiwgXCJjXCJdKTtcbiAqXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciBleHRlbmQgPSBmdW5jdGlvbiAoZikgeyByZXR1cm4gZnVuY3Rpb24gKHdhKSB7XG4gICAgcmV0dXJuIHdhLm1hcChmdW5jdGlvbiAoXywgaSkgeyByZXR1cm4gZih3YS5zbGljZShpKSk7IH0pO1xufTsgfTtcbi8qKlxuICogYGR1cGxpY2F0ZWAgcmV0dXJucyBhbiBhcnJheSBjb250YWluaW5nIHRoZSB3aG9sZSBpbnB1dCBgQXJyYXlgLFxuICogdGhlbiB0byB0aGUgaW5wdXQgYEFycmF5YCBkcm9wcGluZyB0aGUgZmlyc3QgZWxlbWVudCwgdGhlbiB0byB0aGUgaW5wdXRcbiAqIGBBcnJheWAgZHJvcHBpbmcgdGhlIGZpcnN0IHR3byBlbGVtZW50cywgZXRjLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBkdXBsaWNhdGUgfSBmcm9tICdmcC10cy9BcnJheSdcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKGR1cGxpY2F0ZShbXCJhXCIsIFwiYlwiLCBcImNcIl0pLCBbW1wiYVwiLCBcImJcIiwgXCJjXCJdLCBbXCJiXCIsIFwiY1wiXSwgW1wiY1wiXV0pO1xuICpcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIGR1cGxpY2F0ZSA9IC8qI19fUFVSRV9fKi8gZXh0ZW5kKGlkZW50aXR5KTtcbi8qKlxuICogTWFwIGFuZCBmb2xkIGFuIGBBcnJheWAuXG4gKiBNYXAgdGhlIGBBcnJheWAgcGFzc2luZyBlYWNoIHZhbHVlIHRvIHRoZSBpdGVyYXRpbmcgZnVuY3Rpb24uXG4gKiBUaGVuIGZvbGQgdGhlIHJlc3VsdHMgdXNpbmcgdGhlIHByb3ZpZGVkIGBNb25vaWRgLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBmb2xkTWFwIH0gZnJvbSAnZnAtdHMvQXJyYXknXG4gKlxuICogY29uc3QgbW9ub2lkID0geyBjb25jYXQ6IChhOiBzdHJpbmcsIGI6IHN0cmluZykgPT4gYSArIGIsIGVtcHR5OiBcIlwiIH07XG4gKiBjb25zdCBmID0gKHM6IHN0cmluZykgPT4gcy50b1VwcGVyQ2FzZSgpXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKGZvbGRNYXAobW9ub2lkKShmKShbXCJhXCIsIFwiYlwiLCBcImNcIl0pLCBcIkFCQ1wiKTtcbiAqXG4gKiBAY2F0ZWdvcnkgZm9sZGluZ1xuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgZm9sZE1hcCA9IFJBLmZvbGRNYXA7XG4vKipcbiAqIFNhbWUgYXMgW2Bmb2xkTWFwYF0oI2ZvbGRNYXApIGJ1dCBwYXNzaW5nIGFsc28gdGhlIGluZGV4IHRvIHRoZSBpdGVyYXRpbmcgZnVuY3Rpb24uXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IGZvbGRNYXBXaXRoSW5kZXggfSBmcm9tICdmcC10cy9BcnJheSdcbiAqXG4gKiBjb25zdCBtb25vaWQgPSB7IGNvbmNhdDogKGE6IHN0cmluZywgYjogc3RyaW5nKSA9PiBhICsgYiwgZW1wdHk6IFwiXCIgfTtcbiAqIGNvbnN0IGYgPSAoaW5kZXg6bnVtYmVyLCBzOiBzdHJpbmcpID0+IGAke3MudG9VcHBlckNhc2UoKX0oJHtpbmRleH0pYFxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChmb2xkTWFwV2l0aEluZGV4KG1vbm9pZCkoZikoW1wiYVwiLCBcImJcIiwgXCJjXCJdKSwgXCJBKDApQigxKUMoMilcIik7XG4gKlxuICogQGNhdGVnb3J5IGZvbGRpbmdcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIGZvbGRNYXBXaXRoSW5kZXggPSBSQS5mb2xkTWFwV2l0aEluZGV4O1xuLyoqXG4gKiBSZWR1Y2VzIGFuIGBBcnJheWAuXG4gKlxuICogYHJlZHVjZWAgZXhlY3V0ZXMgdGhlIHN1cHBsaWVkIGl0ZXJhdGluZyBmdW5jdGlvbiBvbiBlYWNoIGVsZW1lbnQgb2YgdGhlIGFycmF5LFxuICogaW4gb3JkZXIsIHBhc3NpbmcgaW4gdGhlIGVsZW1lbnQgYW5kIHRoZSByZXR1cm4gdmFsdWUgZnJvbSB0aGUgY2FsY3VsYXRpb24gb24gdGhlIHByZWNlZGluZyBlbGVtZW50LlxuICpcbiAqIFRoZSBmaXJzdCB0aW1lIHRoYXQgdGhlIGl0ZXJhdGluZyBmdW5jdGlvbiBpcyBjYWxsZWQgdGhlcmUgaXMgbm8gXCJyZXR1cm4gdmFsdWUgb2YgdGhlXG4gKiBwcmV2aW91cyBjYWxjdWxhdGlvblwiLCB0aGUgaW5pdGlhbCB2YWx1ZSBpcyB1c2VkIGluIGl0cyBwbGFjZS5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgcmVkdWNlIH0gZnJvbSAnZnAtdHMvQXJyYXknXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChyZWR1Y2UoNSwgKGFjYzogbnVtYmVyLCBjdXI6IG51bWJlcikgPT4gYWNjICogY3VyKShbMiwgM10pLCA1ICogMiAqIDMpO1xuICpcbiAqIEBjYXRlZ29yeSBmb2xkaW5nXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciByZWR1Y2UgPSBSQS5yZWR1Y2U7XG4vKipcbiAqIFNhbWUgYXMgW2ByZWR1Y2VgXSgjcmVkdWNlKSBidXQgcGFzc2luZyBhbHNvIHRoZSBpbmRleCB0byB0aGUgaXRlcmF0aW5nIGZ1bmN0aW9uLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyByZWR1Y2VXaXRoSW5kZXggfSBmcm9tICdmcC10cy9BcnJheSdcbiAqXG4gKiBjb25zdCBmID0gKGluZGV4OiBudW1iZXIsIGFjYzogc3RyaW5nLCBjdXI6IHVua25vd24pID0+XG4gKiAgIGFjYyArICh0eXBlb2YgY3VyID09PSBcInN0cmluZ1wiID8gY3VyLnRvVXBwZXJDYXNlKCkgKyBpbmRleCA6IFwiXCIpO1xuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChyZWR1Y2VXaXRoSW5kZXgoXCJcIiwgZikoWzIsIFwiYVwiLCBcImJcIiwgbnVsbF0pLCBcIkExQjJcIik7XG4gKlxuICogQGNhdGVnb3J5IGZvbGRpbmdcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIHJlZHVjZVdpdGhJbmRleCA9IFJBLnJlZHVjZVdpdGhJbmRleDtcbi8qKlxuICogU2FtZSBhcyBbYHJlZHVjZWBdKCNyZWR1Y2UpIGJ1dCBhcHBsaWVkIGZyb20gdGhlIGVuZCB0byB0aGUgc3RhcnQuXG4gKlxuICogKk5vdGUqOiB0aGUgaXRlcmF0aW5nIGZ1bmN0aW9uIGluIHRoaXMgY2FzZSB0YWtlcyB0aGUgYWNjdW11bGF0b3IgYXMgdGhlIGxhc3QgYXJndW1lbnQuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IHJlZHVjZVJpZ2h0IH0gZnJvbSAnZnAtdHMvQXJyYXknXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChyZWR1Y2VSaWdodChcIlwiLCAoY3VyOiBzdHJpbmcsIGFjYzogc3RyaW5nKSA9PiBhY2MgKyBjdXIpKFtcImFcIiwgXCJiXCIsIFwiY1wiXSksIFwiY2JhXCIpO1xuICpcbiAqIEBjYXRlZ29yeSBmb2xkaW5nXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciByZWR1Y2VSaWdodCA9IFJBLnJlZHVjZVJpZ2h0O1xuLyoqXG4gKiBTYW1lIGFzIFtgcmVkdWNlUmlnaHRgXSgjcmVkdWNlUmlnaHQpIGJ1dCBwYXNzaW5nIGFsc28gdGhlIGluZGV4IHRvIHRoZSBpdGVyYXRpbmcgZnVuY3Rpb24uXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IHJlZHVjZVJpZ2h0V2l0aEluZGV4IH0gZnJvbSAnZnAtdHMvQXJyYXknXG4gKlxuICogY29uc3QgZiA9IChpbmRleDogbnVtYmVyLCBjdXI6IHVua25vd24sIGFjYzogc3RyaW5nKSA9PlxuICogICBhY2MgKyAodHlwZW9mIGN1ciA9PT0gXCJzdHJpbmdcIiA/IGN1ci50b1VwcGVyQ2FzZSgpICsgaW5kZXggOiBcIlwiKTtcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwocmVkdWNlUmlnaHRXaXRoSW5kZXgoXCJcIiwgZikoWzIsIFwiYVwiLCBcImJcIiwgbnVsbF0pLCBcIkIyQTFcIik7XG4gKlxuICogQGNhdGVnb3J5IGZvbGRpbmdcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIHJlZHVjZVJpZ2h0V2l0aEluZGV4ID0gUkEucmVkdWNlUmlnaHRXaXRoSW5kZXg7XG4vKipcbiAqIEdpdmVuIGFuIGl0ZXJhdGluZyBmdW5jdGlvbiB0aGF0IHJldHVybnMgYSBgSEtUYCAoaGlnaGVyIGtpbmRlZCB0eXBlKSwgYHRyYXZlcnNlYFxuICogYXBwbGllcyB0aGUgaXRlcmF0aW5nIGZ1bmN0aW9uIHRvIGVhY2ggZWxlbWVudCBvZiB0aGUgYEFycmF5YCBhbmQgdGhlbiBbYHNlcXVlbmNlYF0oI3NlcXVlbmNlKS1zXG4gKiB0aGUgcmVzdWx0cyB1c2luZyB0aGUgcHJvdmlkZWQgYEFwcGxpY2F0aXZlYC5cbiAqXG4gKiBFLmcuIHN1cHBvc2UgeW91IGhhdmUgYW4gYEFycmF5YCBhbmQgeW91IHdhbnQgdG8gZm9ybWF0IGVhY2ggZWxlbWVudCB3aXRoIGEgZnVuY3Rpb25cbiAqIHRoYXQgcmV0dXJucyBhIHJlc3VsdCBvciBhbiBlcnJvciBhcyBgZiA9IChhOiBBKSA9PiBFaXRoZXI8RXJyb3IsIEI+YCwgdXNpbmcgYHRyYXZlcnNlYFxuICogeW91IGNhbiBhcHBseSBgZmAgdG8gYWxsIGVsZW1lbnRzIGFuZCBkaXJlY3RseSBvYnRhaW4gYXMgYSByZXN1bHQgYW4gYEVpdGhlcjxFcnJvcixBcnJheTxCPj5gXG4gKiBpLmUuIGFuIGBBcnJheTxCPmAgaWYgYWxsIHRoZSByZXN1bHRzIGFyZSBgQmAsIG9yIGFuIGBFcnJvcmAgaWYgc29tZSBvZiB0aGUgcmVzdWx0c1xuICogYXJlIGBFcnJvcmBzLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyB0cmF2ZXJzZSB9IGZyb20gJ2ZwLXRzL0FycmF5J1xuICogaW1wb3J0IHsgQXBwbGljYXRpdmUsIGxlZnQsIHJpZ2h0IH0gZnJvbSBcImZwLXRzL2xpYi9FaXRoZXJcIjtcbiAqXG4gKiBjb25zdCBmID0gKHg6IHVua25vd24pID0+XG4gKiAgIHR5cGVvZiB4ID09PSBcInN0cmluZ1wiID8gcmlnaHQoeC50b1VwcGVyQ2FzZSgpKSA6IGxlZnQobmV3IEVycm9yKFwibm90IGEgc3RyaW5nXCIpKTtcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwodHJhdmVyc2UoQXBwbGljYXRpdmUpKGYpKFtcImFcIiwgXCJiXCJdKSwgcmlnaHQoW1wiQVwiLCBcIkJcIl0pKTtcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwodHJhdmVyc2UoQXBwbGljYXRpdmUpKGYpKFtcImFcIiwgNV0pLCBsZWZ0KG5ldyBFcnJvcihcIm5vdCBhIHN0cmluZ1wiKSkpO1xuICpcbiAqIEBjYXRlZ29yeSB0cmF2ZXJzaW5nXG4gKiBAc2luY2UgMi42LjNcbiAqL1xuZXhwb3J0IHZhciB0cmF2ZXJzZSA9IGZ1bmN0aW9uIChGKSB7XG4gICAgdmFyIHRyYXZlcnNlV2l0aEluZGV4RiA9IHRyYXZlcnNlV2l0aEluZGV4KEYpO1xuICAgIHJldHVybiBmdW5jdGlvbiAoZikgeyByZXR1cm4gdHJhdmVyc2VXaXRoSW5kZXhGKGZ1bmN0aW9uIChfLCBhKSB7IHJldHVybiBmKGEpOyB9KTsgfTtcbn07XG4vKipcbiAqIGBzZXF1ZW5jZWAgdGFrZXMgYW4gYEFycmF5YCB3aGVyZSBlbGVtZW50cyBhcmUgYEhLVDxBPmAgKGhpZ2hlciBraW5kZWQgdHlwZSkgYW5kLFxuICogdXNpbmcgYW4gYXBwbGljYXRpdmUgb2YgdGhhdCBgSEtUYCwgcmV0dXJucyBhbiBgSEtUYCBvZiBgQXJyYXk8QT5gLlxuICogRS5nLiBpdCBjYW4gdHVybiBhbiBgQXJyYXk8RWl0aGVyPEVycm9yLCBzdHJpbmc+PmAgaW50byBhbiBgRWl0aGVyPEVycm9yLCBBcnJheTxzdHJpbmc+PmAuXG4gKlxuICogYHNlcXVlbmNlYCByZXF1aXJlcyBhbiBgQXBwbGljYXRpdmVgIG9mIHRoZSBgSEtUYCB5b3UgYXJlIHRhcmdldGluZywgZS5nLiB0byB0dXJuIGFuXG4gKiBgQXJyYXk8RWl0aGVyPEUsIEE+PmAgaW50byBhbiBgRWl0aGVyPEUsIEFycmF5PEE+PmAsIGl0IG5lZWRzIGFuXG4gKiBgQXBwbGljYXRpdmVgIGZvciBgRWl0aGVyYCwgdG8gdG8gdHVybiBhbiBgQXJyYXk8T3B0aW9uPEE+PmAgaW50byBhbiBgT3B0aW9uPEFycmF5PEE+PmAsXG4gKiBpdCBuZWVkcyBhbiBgQXBwbGljYXRpdmVgIGZvciBgT3B0aW9uYC5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgc2VxdWVuY2UgfSBmcm9tICdmcC10cy9BcnJheSdcbiAqIGltcG9ydCB7IEFwcGxpY2F0aXZlLCBsZWZ0LCByaWdodCB9IGZyb20gXCJmcC10cy9saWIvRWl0aGVyXCI7XG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChzZXF1ZW5jZShBcHBsaWNhdGl2ZSkoW3JpZ2h0KFwiYVwiKSwgcmlnaHQoXCJiXCIpXSksIHJpZ2h0KFtcImFcIiwgXCJiXCJdKSk7XG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKFxuICogICBzZXF1ZW5jZShBcHBsaWNhdGl2ZSkoW3JpZ2h0KFwiYVwiKSwgbGVmdChuZXcgRXJyb3IoXCJub3QgYSBzdHJpbmdcIikpXSksXG4gKiAgIGxlZnQobmV3IEVycm9yKFwibm90IGEgc3RyaW5nXCIpKVxuICogKTtcbiAqXG4gKiBAY2F0ZWdvcnkgdHJhdmVyc2luZ1xuICogQHNpbmNlIDIuNi4zXG4gKi9cbmV4cG9ydCB2YXIgc2VxdWVuY2UgPSBmdW5jdGlvbiAoRikge1xuICAgIHJldHVybiBmdW5jdGlvbiAodGEpIHtcbiAgICAgICAgcmV0dXJuIF9yZWR1Y2UodGEsIEYub2YoemVybygpKSwgZnVuY3Rpb24gKGZhcywgZmEpIHtcbiAgICAgICAgICAgIHJldHVybiBGLmFwKEYubWFwKGZhcywgZnVuY3Rpb24gKGFzKSB7IHJldHVybiBmdW5jdGlvbiAoYSkgeyByZXR1cm4gcGlwZShhcywgYXBwZW5kKGEpKTsgfTsgfSksIGZhKTtcbiAgICAgICAgfSk7XG4gICAgfTtcbn07XG4vKipcbiAqIFNhbWUgYXMgW2B0cmF2ZXJzZWBdKCN0cmF2ZXJzZSkgYnV0IHBhc3NpbmcgYWxzbyB0aGUgaW5kZXggdG8gdGhlIGl0ZXJhdGluZyBmdW5jdGlvbi5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgdHJhdmVyc2VXaXRoSW5kZXggfSBmcm9tICdmcC10cy9BcnJheSdcbiAqIGltcG9ydCB7IEFwcGxpY2F0aXZlLCBsZWZ0LCByaWdodCB9IGZyb20gXCJmcC10cy9saWIvRWl0aGVyXCI7XG4gKlxuICogY29uc3QgZiA9IChpbmRleDpudW1iZXIsIHg6dW5rbm93bikgPT5cbiAqICAgdHlwZW9mIHggPT09IFwic3RyaW5nXCIgPyByaWdodCh4LnRvVXBwZXJDYXNlKCkgKyBpbmRleCkgOiBsZWZ0KG5ldyBFcnJvcihcIm5vdCBhIHN0cmluZ1wiKSk7XG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKHRyYXZlcnNlV2l0aEluZGV4KEFwcGxpY2F0aXZlKShmKShbXCJhXCIsIFwiYlwiXSksIHJpZ2h0KFtcIkEwXCIsIFwiQjFcIl0pKTtcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwodHJhdmVyc2VXaXRoSW5kZXgoQXBwbGljYXRpdmUpKGYpKFtcImFcIiwgNV0pLCBsZWZ0KG5ldyBFcnJvcihcIm5vdCBhIHN0cmluZ1wiKSkpO1xuICpcbiAqIEBjYXRlZ29yeSBzZXF1ZW5jaW5nXG4gKiBAc2luY2UgMi42LjNcbiAqL1xuZXhwb3J0IHZhciB0cmF2ZXJzZVdpdGhJbmRleCA9IGZ1bmN0aW9uIChGKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChmKSB7XG4gICAgICAgIHJldHVybiByZWR1Y2VXaXRoSW5kZXgoRi5vZih6ZXJvKCkpLCBmdW5jdGlvbiAoaSwgZmJzLCBhKSB7XG4gICAgICAgICAgICByZXR1cm4gRi5hcChGLm1hcChmYnMsIGZ1bmN0aW9uIChicykgeyByZXR1cm4gZnVuY3Rpb24gKGIpIHsgcmV0dXJuIHBpcGUoYnMsIGFwcGVuZChiKSk7IH07IH0pLCBmKGksIGEpKTtcbiAgICAgICAgfSk7XG4gICAgfTtcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBmaWx0ZXJpbmdcbiAqIEBzaW5jZSAyLjYuNVxuICovXG5leHBvcnQgdmFyIHdpdGhlciA9IGZ1bmN0aW9uIChGKSB7XG4gICAgdmFyIF93aXRoZXJGID0gX3dpdGhlcihGKTtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGYpIHsgcmV0dXJuIGZ1bmN0aW9uIChmYSkgeyByZXR1cm4gX3dpdGhlckYoZmEsIGYpOyB9OyB9O1xufTtcbi8qKlxuICogQGNhdGVnb3J5IGZpbHRlcmluZ1xuICogQHNpbmNlIDIuNi41XG4gKi9cbmV4cG9ydCB2YXIgd2lsdCA9IGZ1bmN0aW9uIChGKSB7XG4gICAgdmFyIF93aWx0RiA9IF93aWx0KEYpO1xuICAgIHJldHVybiBmdW5jdGlvbiAoZikgeyByZXR1cm4gZnVuY3Rpb24gKGZhKSB7IHJldHVybiBfd2lsdEYoZmEsIGYpOyB9OyB9O1xufTtcbi8qKlxuICogYHVuZm9sZGAgdGFrZXMgYSBmdW5jdGlvbiBgZmAgd2hpY2ggcmV0dXJucyBhbiBgT3B0aW9uYCBvZiBhIHR1cGxlIGNvbnRhaW5pbmcgYW4gb3V0Y29tZVxuICogdmFsdWUgYW5kIGFuIGlucHV0IGZvciB0aGUgZm9sbG93aW5nIGl0ZXJhdGlvbi5cbiAqIGB1bmZvbGRgIGFwcGxpZXMgYGZgIHRvIHRoZSBpbml0aWFsIHZhbHVlIGBiYCBhbmQgdGhlbiByZWN1cnNpdmVseSB0byB0aGUgc2Vjb25kXG4gKiBlbGVtZW50IG9mIHRoZSB0dXBsZSBjb250YWluZWQgaW4gdGhlIHJldHVybmVkIGBvcHRpb25gIG9mIHRoZSBwcmV2aW91c1xuICogY2FsY3VsYXRpb24gdW50aWwgYGZgIHJldHVybnMgYE9wdGlvbi5ub25lYC5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgdW5mb2xkIH0gZnJvbSAnZnAtdHMvQXJyYXknXG4gKiBpbXBvcnQgeyBvcHRpb24gfSBmcm9tICdmcC10cydcbiAqXG4gKiBjb25zdCBmID0gKG46IG51bWJlcikgPT4ge1xuICogICBpZiAobiA8PSAwKSByZXR1cm4gb3B0aW9uLm5vbmU7XG4gKiAgIGNvbnN0IHJldHVyblZhbHVlID0gbiAqIDI7XG4gKiAgIGNvbnN0IGlucHV0Rm9yTmV4dFJvdW5kID0gbiAtIDE7XG4gKiAgIHJldHVybiBvcHRpb24uc29tZShbcmV0dXJuVmFsdWUsIGlucHV0Rm9yTmV4dFJvdW5kXSBhcyBjb25zdCk7XG4gKiB9O1xuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbCh1bmZvbGQoNSwgZiksIFsxMCwgOCwgNiwgNCwgMl0pO1xuICpcbiAqIEBzaW5jZSAyLjYuNlxuICovXG5leHBvcnQgdmFyIHVuZm9sZCA9IGZ1bmN0aW9uIChiLCBmKSB7XG4gICAgdmFyIG91dCA9IFtdO1xuICAgIHZhciBiYiA9IGI7XG4gICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG5vLWNvbnN0YW50LWNvbmRpdGlvblxuICAgIHdoaWxlICh0cnVlKSB7XG4gICAgICAgIHZhciBtdCA9IGYoYmIpO1xuICAgICAgICBpZiAoXy5pc1NvbWUobXQpKSB7XG4gICAgICAgICAgICB2YXIgX2EgPSBtdC52YWx1ZSwgYSA9IF9hWzBdLCBiXzEgPSBfYVsxXTtcbiAgICAgICAgICAgIG91dC5wdXNoKGEpO1xuICAgICAgICAgICAgYmIgPSBiXzE7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gb3V0O1xufTtcbi8qKlxuICogQGNhdGVnb3J5IHR5cGUgbGFtYmRhc1xuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgVVJJID0gJ0FycmF5Jztcbi8qKlxuICogYGdldFNob3dgIG1ha2VzIGEgYFNob3dgIGZvciBhbiBgQXJyYXk8QT5gIGZyb20gYSBgU2hvd2AgZm9yXG4gKiBhbiBgQWAuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IGdldFNob3cgfSBmcm9tICdmcC10cy9BcnJheSdcbiAqXG4gKiBjb25zdCBudW1TaG93ID0geyBzaG93OiAobjogbnVtYmVyKSA9PiAobiA+PSAwID8gYCR7bn1gIDogYCgkey1ufSlgKSB9O1xuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChnZXRTaG93KG51bVNob3cpLnNob3coWy0yLCAtMSwgMCwgMV0pLCBcIlsoMiksICgxKSwgMCwgMV1cIik7XG4gKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgZ2V0U2hvdyA9IFJBLmdldFNob3c7XG4vKipcbiAqIEdldCBhIGBTZW1pZ3JvdXBgIGJhc2VkIG9uIHRoZSBjb25jYXRlbmF0aW9uIG9mIGBBcnJheWBzLlxuICogU2VlIGFsc28gW2BnZXRNb25vaWRgXSgjZ2V0TW9ub2lkKS5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgZ2V0U2VtaWdyb3VwIH0gZnJvbSAnZnAtdHMvQXJyYXknXG4gKlxuICogY29uc3QgUyA9IGdldFNlbWlncm91cDxudW1iZXI+KCk7XG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKFMuY29uY2F0KFsxLCAyXSwgWzIsIDNdKSwgWzEsIDIsIDIsIDNdKTtcbiAqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi4xMC4wXG4gKi9cbmV4cG9ydCB2YXIgZ2V0U2VtaWdyb3VwID0gZnVuY3Rpb24gKCkgeyByZXR1cm4gKHtcbiAgICBjb25jYXQ6IGZ1bmN0aW9uIChmaXJzdCwgc2Vjb25kKSB7IHJldHVybiBmaXJzdC5jb25jYXQoc2Vjb25kKTsgfVxufSk7IH07XG4vKipcbiAqIFJldHVybnMgYSBgTW9ub2lkYCBmb3IgYEFycmF5PEE+YCBiYXNlZCBvbiB0aGUgY29uY2F0ZW5hdGlvbiBvZiBgQXJyYXlgcy5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgZ2V0TW9ub2lkIH0gZnJvbSAnZnAtdHMvQXJyYXknXG4gKlxuICogY29uc3QgTSA9IGdldE1vbm9pZDxudW1iZXI+KClcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoTS5jb25jYXQoWzEsIDJdLCBbMywgNF0pLCBbMSwgMiwgMywgNF0pXG4gKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgZ2V0TW9ub2lkID0gZnVuY3Rpb24gKCkgeyByZXR1cm4gKHtcbiAgICBjb25jYXQ6IGdldFNlbWlncm91cCgpLmNvbmNhdCxcbiAgICBlbXB0eTogW11cbn0pOyB9O1xuLyoqXG4gKiBEZXJpdmVzIGFuIGBFcWAgb3ZlciB0aGUgYEFycmF5YCBvZiBhIGdpdmVuIGVsZW1lbnQgdHlwZSBmcm9tIHRoZSBgRXFgIG9mIHRoYXQgdHlwZS4gVGhlIGRlcml2ZWQgYEVxYCBkZWZpbmVzIHR3b1xuICogYXJyYXlzIGFzIGVxdWFsIGlmIGFsbCBlbGVtZW50cyBvZiBib3RoIGFycmF5cyBhcmUgY29tcGFyZWQgZXF1YWwgcGFpcndpc2Ugd2l0aCB0aGUgZ2l2ZW4gYEVgLiBJbiBjYXNlIG9mIGFycmF5cyBvZlxuICogZGlmZmVyZW50IGxlbmd0aHMsIHRoZSByZXN1bHQgaXMgbm9uIGVxdWFsaXR5LlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgKiBhcyBTIGZyb20gJ2ZwLXRzL3N0cmluZydcbiAqIGltcG9ydCB7IGdldEVxIH0gZnJvbSAnZnAtdHMvQXJyYXknXG4gKlxuICogY29uc3QgRSA9IGdldEVxKFMuRXEpXG4gKiBhc3NlcnQuc3RyaWN0RXF1YWwoRS5lcXVhbHMoWydhJywgJ2InXSwgWydhJywgJ2InXSksIHRydWUpXG4gKiBhc3NlcnQuc3RyaWN0RXF1YWwoRS5lcXVhbHMoWydhJ10sIFtdKSwgZmFsc2UpXG4gKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgZ2V0RXEgPSBSQS5nZXRFcTtcbi8qKlxuICogRGVyaXZlcyBhbiBgT3JkYCBvdmVyIHRoZSBgQXJyYXlgIG9mIGEgZ2l2ZW4gZWxlbWVudCB0eXBlIGZyb20gdGhlIGBPcmRgIG9mIHRoYXQgdHlwZS4gVGhlIG9yZGVyaW5nIGJldHdlZW4gdHdvIHN1Y2hcbiAqIGFycmF5cyBpcyBlcXVhbCB0bzogdGhlIGZpcnN0IG5vbiBlcXVhbCBjb21wYXJpc29uIG9mIGVhY2ggYXJyYXlzIGVsZW1lbnRzIHRha2VuIHBhaXJ3aXNlIGluIGluY3JlYXNpbmcgb3JkZXIsIGluXG4gKiBjYXNlIG9mIGVxdWFsaXR5IG92ZXIgYWxsIHRoZSBwYWlyd2lzZSBlbGVtZW50czsgdGhlIGxvbmdlc3QgYXJyYXkgaXMgY29uc2lkZXJlZCB0aGUgZ3JlYXRlc3QsIGlmIGJvdGggYXJyYXlzIGhhdmVcbiAqIHRoZSBzYW1lIGxlbmd0aCwgdGhlIHJlc3VsdCBpcyBlcXVhbGl0eS5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgZ2V0T3JkIH0gZnJvbSAnZnAtdHMvQXJyYXknXG4gKiBpbXBvcnQgKiBhcyBTIGZyb20gJ2ZwLXRzL3N0cmluZydcbiAqXG4gKiBjb25zdCBPID0gZ2V0T3JkKFMuT3JkKVxuICogYXNzZXJ0LnN0cmljdEVxdWFsKE8uY29tcGFyZShbJ2InXSwgWydhJ10pLCAxKVxuICogYXNzZXJ0LnN0cmljdEVxdWFsKE8uY29tcGFyZShbJ2EnXSwgWydhJ10pLCAwKVxuICogYXNzZXJ0LnN0cmljdEVxdWFsKE8uY29tcGFyZShbJ2EnXSwgWydiJ10pLCAtMSlcbiAqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciBnZXRPcmQgPSBSQS5nZXRPcmQ7XG4vKipcbiAqIEdldCBhIGBTZW1pZ3JvdXBgIGJhc2VkIG9uIHRoZSB1bmlvbiBvZiB0aGUgZWxlbWVudHMgb2YgYEFycmF5YHMuXG4gKiBFbGVtZW50cyB3aGljaCBlcXVhbCBhY2NvcmRpbmcgdG8gdGhlIHByb3ZpZGVkIGBFcWAgYXJlIGluY2x1ZGVkXG4gKiBvbmx5IG9uY2UgaW4gdGhlIHJlc3VsdC5cbiAqIFNlZSBhbHNvIFtgZ2V0VW5pb25Nb25vaWRgXSgjZ2V0VW5pb25Nb25vaWQpLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBnZXRVbmlvblNlbWlncm91cCB9IGZyb20gJ2ZwLXRzL0FycmF5JztcbiAqIGltcG9ydCB7IEVxIH0gZnJvbSAnZnAtdHMvbnVtYmVyJztcbiAqXG4gKiBjb25zdCBTID0gZ2V0VW5pb25TZW1pZ3JvdXA8bnVtYmVyPihFcSk7XG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKFMuY29uY2F0KFsxLCAyXSwgWzIsIDNdKSwgWzEsIDIsIDNdKTtcbiAqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi4xMS4wXG4gKi9cbmV4cG9ydCB2YXIgZ2V0VW5pb25TZW1pZ3JvdXAgPSBmdW5jdGlvbiAoRSkge1xuICAgIHZhciB1bmlvbkUgPSB1bmlvbihFKTtcbiAgICByZXR1cm4ge1xuICAgICAgICBjb25jYXQ6IGZ1bmN0aW9uIChmaXJzdCwgc2Vjb25kKSB7IHJldHVybiB1bmlvbkUoc2Vjb25kKShmaXJzdCk7IH1cbiAgICB9O1xufTtcbi8qKlxuICogR2V0IGEgYE1vbm9pZGAgYmFzZWQgb24gdGhlIHVuaW9uIG9mIHRoZSBlbGVtZW50cyBvZiBgQXJyYXlgcy5cbiAqIEVsZW1lbnRzIHdoaWNoIGVxdWFsIGFjY29yZGluZyB0byB0aGUgcHJvdmlkZWQgYEVxYCBhcmUgaW5jbHVkZWRcbiAqIG9ubHkgb25jZSBpbiB0aGUgcmVzdWx0LlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBnZXRVbmlvbk1vbm9pZCB9IGZyb20gJ2ZwLXRzL0FycmF5J1xuICogaW1wb3J0IHsgRXEgfSBmcm9tICdmcC10cy9udW1iZXInO1xuICpcbiAqIGNvbnN0IE0gPSBnZXRVbmlvbk1vbm9pZDxudW1iZXI+KEVxKTtcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoTS5jb25jYXQoWzEsIDJdLCBbMiwgM10pLCBbMSwgMiwgM10pO1xuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChNLmVtcHR5LFtdKTtcbiAqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi4xMS4wXG4gKi9cbmV4cG9ydCB2YXIgZ2V0VW5pb25Nb25vaWQgPSBmdW5jdGlvbiAoRSkgeyByZXR1cm4gKHtcbiAgICBjb25jYXQ6IGdldFVuaW9uU2VtaWdyb3VwKEUpLmNvbmNhdCxcbiAgICBlbXB0eTogW11cbn0pOyB9O1xuLyoqXG4gKiBHZXQgYSBgU2VtaWdyb3VwYCBiYXNlZCBvbiB0aGUgaW50ZXJzZWN0aW9uIG9mIHRoZSBlbGVtZW50cyBvZiBgQXJyYXlgcy5cbiAqIE9ubHkgZWxlbWVudHMgcHJlc2VudCBpbiB0aGUgdHdvIGFycmF5cyB3aGljaCBhcmUgZXF1YWwgYWNjb3JkaW5nIHRvIHRoZVxuICogcHJvdmlkZWQgYEVxYCBhcmUgaW5jbHVkZWQgaW4gdGhlIHJlc3VsdC5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgZ2V0SW50ZXJzZWN0aW9uU2VtaWdyb3VwIH0gZnJvbSAnZnAtdHMvQXJyYXknXG4gKiBpbXBvcnQgeyBFcSB9IGZyb20gJ2ZwLXRzL251bWJlcic7XG4gKlxuICogY29uc3QgUyA9IGdldEludGVyc2VjdGlvblNlbWlncm91cDxudW1iZXI+KEVxKTtcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoUy5jb25jYXQoWzEsIDJdLCBbMiwgM10pLCBbMl0pO1xuICpcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjExLjBcbiAqL1xuZXhwb3J0IHZhciBnZXRJbnRlcnNlY3Rpb25TZW1pZ3JvdXAgPSBmdW5jdGlvbiAoRSkge1xuICAgIHZhciBpbnRlcnNlY3Rpb25FID0gaW50ZXJzZWN0aW9uKEUpO1xuICAgIHJldHVybiB7XG4gICAgICAgIGNvbmNhdDogZnVuY3Rpb24gKGZpcnN0LCBzZWNvbmQpIHsgcmV0dXJuIGludGVyc2VjdGlvbkUoc2Vjb25kKShmaXJzdCk7IH1cbiAgICB9O1xufTtcbi8qKlxuICogR2V0IGEgYE1hZ21hYCBmb3IgYEFycmF5YCB3aGVyZSB0aGUgYGNvbmNhdGAgZnVuY3Rpb24gaXMgdGhlIGRpZmZlcm5jZSBiZXR3ZWVuXG4gKiB0aGUgZmlyc3QgYW5kIHRoZSBzZWNvbmQgYXJyYXksIGkuZS4gdGhlIHJlc3VsdCBjb250YWlucyBhbGwgdGhlIGVsZW1lbnRzIG9mIHRoZVxuICogZmlyc3QgYXJyYXkgZm9yIHdoaWNoIHRoZWlyIGlzIG5vIGVxdWFsIGVsZW1lbnQgaW4gdGhlIHNlY29uZCBhcnJheSBhY2NvcmRpbmdcbiAqIHRvIHRoZSBgRXFgIHByb3ZpZGVkLlxuICpcbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgZ2V0RGlmZmVyZW5jZU1hZ21hIH0gZnJvbSAnZnAtdHMvQXJyYXknXG4gKiBpbXBvcnQgeyBFcSB9IGZyb20gJ2ZwLXRzL251bWJlcic7XG4gKlxuICogY29uc3QgUyA9IGdldERpZmZlcmVuY2VNYWdtYTxudW1iZXI+KEVxKTtcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoUy5jb25jYXQoWzEsIDJdLCBbMiwgM10pLCBbMV0pO1xuICpcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjExLjBcbiAqL1xuZXhwb3J0IHZhciBnZXREaWZmZXJlbmNlTWFnbWEgPSBmdW5jdGlvbiAoRSkge1xuICAgIHZhciBkaWZmZXJlbmNlRSA9IGRpZmZlcmVuY2UoRSk7XG4gICAgcmV0dXJuIHtcbiAgICAgICAgY29uY2F0OiBmdW5jdGlvbiAoZmlyc3QsIHNlY29uZCkgeyByZXR1cm4gZGlmZmVyZW5jZUUoc2Vjb25kKShmaXJzdCk7IH1cbiAgICB9O1xufTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuNy4wXG4gKi9cbmV4cG9ydCB2YXIgRnVuY3RvciA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICBtYXA6IF9tYXBcbn07XG4vKipcbiAqIEdpdmVuIGFuIGlucHV0IGFuIGBBcnJheWAgb2YgZnVuY3Rpb25zLCBgZmxhcGAgcmV0dXJucyBhbiBgQXJyYXlgIGNvbnRhaW5pbmdcbiAqIHRoZSByZXN1bHRzIG9mIGFwcGx5aW5nIGVhY2ggZnVuY3Rpb24gdG8gdGhlIGdpdmVuIGlucHV0LlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBmbGFwIH0gZnJvbSAnZnAtdHMvQXJyYXknXG4gKlxuICogY29uc3QgZnVucyA9IFtcbiAqICAgKG46IG51bWJlcikgPT4gYERvdWJsZTogJHtuICogMn1gLFxuICogICAobjogbnVtYmVyKSA9PiBgVHJpcGxlOiAke24gKiAzfWAsXG4gKiAgIChuOiBudW1iZXIpID0+IGBTcXVhcmU6ICR7biAqIG59YCxcbiAqIF07XG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKGZsYXAoNCkoZnVucyksIFsnRG91YmxlOiA4JywgJ1RyaXBsZTogMTInLCAnU3F1YXJlOiAxNiddKTtcbiAqXG4gKiBAY2F0ZWdvcnkgbWFwcGluZ1xuICogQHNpbmNlIDIuMTAuMFxuICovXG5leHBvcnQgdmFyIGZsYXAgPSAvKiNfX1BVUkVfXyovIGZsYXBfKEZ1bmN0b3IpO1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi4xMC4wXG4gKi9cbmV4cG9ydCB2YXIgUG9pbnRlZCA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICBvZjogb2Zcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjcuMFxuICovXG5leHBvcnQgdmFyIEZ1bmN0b3JXaXRoSW5kZXggPSB7XG4gICAgVVJJOiBVUkksXG4gICAgbWFwOiBfbWFwLFxuICAgIG1hcFdpdGhJbmRleDogX21hcFdpdGhJbmRleFxufTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuMTAuMFxuICovXG5leHBvcnQgdmFyIEFwcGx5ID0ge1xuICAgIFVSSTogVVJJLFxuICAgIG1hcDogX21hcCxcbiAgICBhcDogX2FwXG59O1xuLyoqXG4gKiBDb21iaW5lIHR3byBlZmZlY3RmdWwgYWN0aW9ucywga2VlcGluZyBvbmx5IHRoZSByZXN1bHQgb2YgdGhlIGZpcnN0LlxuICpcbiAqIEBzaW5jZSAyLjUuMFxuICovXG5leHBvcnQgdmFyIGFwRmlyc3QgPSAvKiNfX1BVUkVfXyovIGFwRmlyc3RfKEFwcGx5KTtcbi8qKlxuICogQ29tYmluZSB0d28gZWZmZWN0ZnVsIGFjdGlvbnMsIGtlZXBpbmcgb25seSB0aGUgcmVzdWx0IG9mIHRoZSBzZWNvbmQuXG4gKlxuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgYXBTZWNvbmQgPSAvKiNfX1BVUkVfXyovIGFwU2Vjb25kXyhBcHBseSk7XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjcuMFxuICovXG5leHBvcnQgdmFyIEFwcGxpY2F0aXZlID0ge1xuICAgIFVSSTogVVJJLFxuICAgIG1hcDogX21hcCxcbiAgICBhcDogX2FwLFxuICAgIG9mOiBvZlxufTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuMTAuMFxuICovXG5leHBvcnQgdmFyIENoYWluID0ge1xuICAgIFVSSTogVVJJLFxuICAgIG1hcDogX21hcCxcbiAgICBhcDogX2FwLFxuICAgIGNoYWluOiBmbGF0TWFwXG59O1xuLyoqXG4gKiBDb21wb3NlcyBjb21wdXRhdGlvbnMgaW4gc2VxdWVuY2UsIHVzaW5nIHRoZSByZXR1cm4gdmFsdWUgb2Ygb25lIGNvbXB1dGF0aW9uIHRvIGRldGVybWluZSB0aGUgbmV4dCBjb21wdXRhdGlvbiBhbmRcbiAqIGtlZXBpbmcgb25seSB0aGUgcmVzdWx0IG9mIHRoZSBmaXJzdC5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0ICogYXMgQSBmcm9tICdmcC10cy9BcnJheSdcbiAqIGltcG9ydCB7IHBpcGUgfSBmcm9tICdmcC10cy9mdW5jdGlvbidcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKFxuICogICBwaXBlKFxuICogICAgIFsxLCAyLCAzXSxcbiAqICAgICBBLmNoYWluRmlyc3QoKCkgPT4gWydhJywgJ2InXSlcbiAqICAgKSxcbiAqICAgWzEsIDEsIDIsIDIsIDMsIDNdXG4gKiApXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKFxuICogICBwaXBlKFxuICogICAgIFsxLCAyLCAzXSxcbiAqICAgICBBLmNoYWluRmlyc3QoKCkgPT4gW10pXG4gKiAgICksXG4gKiAgIFtdXG4gKiApXG4gKlxuICogQGNhdGVnb3J5IHNlcXVlbmNpbmdcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIGNoYWluRmlyc3QgPSBcbi8qI19fUFVSRV9fKi8gY2hhaW5GaXJzdF8oQ2hhaW4pO1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi43LjBcbiAqL1xuZXhwb3J0IHZhciBNb25hZCA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICBtYXA6IF9tYXAsXG4gICAgYXA6IF9hcCxcbiAgICBvZjogb2YsXG4gICAgY2hhaW46IGZsYXRNYXBcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjcuMFxuICovXG5leHBvcnQgdmFyIFVuZm9sZGFibGUgPSB7XG4gICAgVVJJOiBVUkksXG4gICAgdW5mb2xkOiB1bmZvbGRcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjcuMFxuICovXG5leHBvcnQgdmFyIEFsdCA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICBtYXA6IF9tYXAsXG4gICAgYWx0OiBfYWx0XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi4xMS4wXG4gKi9cbmV4cG9ydCB2YXIgWmVybyA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICB6ZXJvOiB6ZXJvXG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgZG8gbm90YXRpb25cbiAqIEBzaW5jZSAyLjExLjBcbiAqL1xuZXhwb3J0IHZhciBndWFyZCA9IC8qI19fUFVSRV9fKi8gZ3VhcmRfKFplcm8sIFBvaW50ZWQpO1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi43LjBcbiAqL1xuZXhwb3J0IHZhciBBbHRlcm5hdGl2ZSA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICBtYXA6IF9tYXAsXG4gICAgYXA6IF9hcCxcbiAgICBvZjogb2YsXG4gICAgYWx0OiBfYWx0LFxuICAgIHplcm86IHplcm9cbn07XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjcuMFxuICovXG5leHBvcnQgdmFyIEV4dGVuZCA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICBtYXA6IF9tYXAsXG4gICAgZXh0ZW5kOiBfZXh0ZW5kXG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi43LjBcbiAqL1xuZXhwb3J0IHZhciBDb21wYWN0YWJsZSA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICBjb21wYWN0OiBjb21wYWN0LFxuICAgIHNlcGFyYXRlOiBzZXBhcmF0ZVxufTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuNy4wXG4gKi9cbmV4cG9ydCB2YXIgRmlsdGVyYWJsZSA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICBtYXA6IF9tYXAsXG4gICAgY29tcGFjdDogY29tcGFjdCxcbiAgICBzZXBhcmF0ZTogc2VwYXJhdGUsXG4gICAgZmlsdGVyOiBfZmlsdGVyLFxuICAgIGZpbHRlck1hcDogX2ZpbHRlck1hcCxcbiAgICBwYXJ0aXRpb246IF9wYXJ0aXRpb24sXG4gICAgcGFydGl0aW9uTWFwOiBfcGFydGl0aW9uTWFwXG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi43LjBcbiAqL1xuZXhwb3J0IHZhciBGaWx0ZXJhYmxlV2l0aEluZGV4ID0ge1xuICAgIFVSSTogVVJJLFxuICAgIG1hcDogX21hcCxcbiAgICBtYXBXaXRoSW5kZXg6IF9tYXBXaXRoSW5kZXgsXG4gICAgY29tcGFjdDogY29tcGFjdCxcbiAgICBzZXBhcmF0ZTogc2VwYXJhdGUsXG4gICAgZmlsdGVyOiBfZmlsdGVyLFxuICAgIGZpbHRlck1hcDogX2ZpbHRlck1hcCxcbiAgICBwYXJ0aXRpb246IF9wYXJ0aXRpb24sXG4gICAgcGFydGl0aW9uTWFwOiBfcGFydGl0aW9uTWFwLFxuICAgIHBhcnRpdGlvbk1hcFdpdGhJbmRleDogX3BhcnRpdGlvbk1hcFdpdGhJbmRleCxcbiAgICBwYXJ0aXRpb25XaXRoSW5kZXg6IF9wYXJ0aXRpb25XaXRoSW5kZXgsXG4gICAgZmlsdGVyTWFwV2l0aEluZGV4OiBfZmlsdGVyTWFwV2l0aEluZGV4LFxuICAgIGZpbHRlcldpdGhJbmRleDogX2ZpbHRlcldpdGhJbmRleFxufTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuNy4wXG4gKi9cbmV4cG9ydCB2YXIgRm9sZGFibGUgPSB7XG4gICAgVVJJOiBVUkksXG4gICAgcmVkdWNlOiBfcmVkdWNlLFxuICAgIGZvbGRNYXA6IF9mb2xkTWFwLFxuICAgIHJlZHVjZVJpZ2h0OiBfcmVkdWNlUmlnaHRcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjcuMFxuICovXG5leHBvcnQgdmFyIEZvbGRhYmxlV2l0aEluZGV4ID0ge1xuICAgIFVSSTogVVJJLFxuICAgIHJlZHVjZTogX3JlZHVjZSxcbiAgICBmb2xkTWFwOiBfZm9sZE1hcCxcbiAgICByZWR1Y2VSaWdodDogX3JlZHVjZVJpZ2h0LFxuICAgIHJlZHVjZVdpdGhJbmRleDogX3JlZHVjZVdpdGhJbmRleCxcbiAgICBmb2xkTWFwV2l0aEluZGV4OiBfZm9sZE1hcFdpdGhJbmRleCxcbiAgICByZWR1Y2VSaWdodFdpdGhJbmRleDogX3JlZHVjZVJpZ2h0V2l0aEluZGV4XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi43LjBcbiAqL1xuZXhwb3J0IHZhciBUcmF2ZXJzYWJsZSA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICBtYXA6IF9tYXAsXG4gICAgcmVkdWNlOiBfcmVkdWNlLFxuICAgIGZvbGRNYXA6IF9mb2xkTWFwLFxuICAgIHJlZHVjZVJpZ2h0OiBfcmVkdWNlUmlnaHQsXG4gICAgdHJhdmVyc2U6IF90cmF2ZXJzZSxcbiAgICBzZXF1ZW5jZTogc2VxdWVuY2Vcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjcuMFxuICovXG5leHBvcnQgdmFyIFRyYXZlcnNhYmxlV2l0aEluZGV4ID0ge1xuICAgIFVSSTogVVJJLFxuICAgIG1hcDogX21hcCxcbiAgICBtYXBXaXRoSW5kZXg6IF9tYXBXaXRoSW5kZXgsXG4gICAgcmVkdWNlOiBfcmVkdWNlLFxuICAgIGZvbGRNYXA6IF9mb2xkTWFwLFxuICAgIHJlZHVjZVJpZ2h0OiBfcmVkdWNlUmlnaHQsXG4gICAgcmVkdWNlV2l0aEluZGV4OiBfcmVkdWNlV2l0aEluZGV4LFxuICAgIGZvbGRNYXBXaXRoSW5kZXg6IF9mb2xkTWFwV2l0aEluZGV4LFxuICAgIHJlZHVjZVJpZ2h0V2l0aEluZGV4OiBfcmVkdWNlUmlnaHRXaXRoSW5kZXgsXG4gICAgdHJhdmVyc2U6IF90cmF2ZXJzZSxcbiAgICBzZXF1ZW5jZTogc2VxdWVuY2UsXG4gICAgdHJhdmVyc2VXaXRoSW5kZXg6IF90cmF2ZXJzZVdpdGhJbmRleFxufTtcbnZhciBfd2l0aGVyID0gLyojX19QVVJFX18qLyB3aXRoZXJEZWZhdWx0KFRyYXZlcnNhYmxlLCBDb21wYWN0YWJsZSk7XG52YXIgX3dpbHQgPSAvKiNfX1BVUkVfXyovIHdpbHREZWZhdWx0KFRyYXZlcnNhYmxlLCBDb21wYWN0YWJsZSk7XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjcuMFxuICovXG5leHBvcnQgdmFyIFdpdGhlcmFibGUgPSB7XG4gICAgVVJJOiBVUkksXG4gICAgbWFwOiBfbWFwLFxuICAgIGNvbXBhY3Q6IGNvbXBhY3QsXG4gICAgc2VwYXJhdGU6IHNlcGFyYXRlLFxuICAgIGZpbHRlcjogX2ZpbHRlcixcbiAgICBmaWx0ZXJNYXA6IF9maWx0ZXJNYXAsXG4gICAgcGFydGl0aW9uOiBfcGFydGl0aW9uLFxuICAgIHBhcnRpdGlvbk1hcDogX3BhcnRpdGlvbk1hcCxcbiAgICByZWR1Y2U6IF9yZWR1Y2UsXG4gICAgZm9sZE1hcDogX2ZvbGRNYXAsXG4gICAgcmVkdWNlUmlnaHQ6IF9yZWR1Y2VSaWdodCxcbiAgICB0cmF2ZXJzZTogX3RyYXZlcnNlLFxuICAgIHNlcXVlbmNlOiBzZXF1ZW5jZSxcbiAgICB3aXRoZXI6IF93aXRoZXIsXG4gICAgd2lsdDogX3dpbHRcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBzZXF1ZW5jaW5nXG4gKiBAc2luY2UgMi4xMS4wXG4gKi9cbmV4cG9ydCB2YXIgY2hhaW5SZWNEZXB0aEZpcnN0ID0gUkEuY2hhaW5SZWNEZXB0aEZpcnN0O1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi4xMS4wXG4gKi9cbmV4cG9ydCB2YXIgQ2hhaW5SZWNEZXB0aEZpcnN0ID0ge1xuICAgIFVSSTogVVJJLFxuICAgIG1hcDogX21hcCxcbiAgICBhcDogX2FwLFxuICAgIGNoYWluOiBmbGF0TWFwLFxuICAgIGNoYWluUmVjOiBfY2hhaW5SZWNEZXB0aEZpcnN0XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgc2VxdWVuY2luZ1xuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIGNoYWluUmVjQnJlYWR0aEZpcnN0ID0gUkEuY2hhaW5SZWNCcmVhZHRoRmlyc3Q7XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjExLjBcbiAqL1xuZXhwb3J0IHZhciBDaGFpblJlY0JyZWFkdGhGaXJzdCA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICBtYXA6IF9tYXAsXG4gICAgYXA6IF9hcCxcbiAgICBjaGFpbjogZmxhdE1hcCxcbiAgICBjaGFpblJlYzogX2NoYWluUmVjQnJlYWR0aEZpcnN0XG59O1xuLyoqXG4gKiBGaWx0ZXIgdmFsdWVzIGluc2lkZSBhIGNvbnRleHQuXG4gKlxuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIGZpbHRlckUgPSAvKiNfX1BVUkVfXyovIGZpbHRlckVfKFdpdGhlcmFibGUpO1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi4xMS4wXG4gKi9cbmV4cG9ydCB2YXIgRnJvbUVpdGhlciA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICBmcm9tRWl0aGVyOiBmcm9tRWl0aGVyXG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgbGlmdGluZ1xuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIGZyb21FaXRoZXJLID0gLyojX19QVVJFX18qLyBmcm9tRWl0aGVyS18oRnJvbUVpdGhlcik7XG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vLyB1bnNhZmVcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8qKlxuICogQGNhdGVnb3J5IHVuc2FmZVxuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgdW5zYWZlSW5zZXJ0QXQgPSBORUEudW5zYWZlSW5zZXJ0QXQ7XG4vKipcbiAqIEBjYXRlZ29yeSB1bnNhZmVcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIHVuc2FmZVVwZGF0ZUF0ID0gZnVuY3Rpb24gKGksIGEsIGFzKSB7XG4gICAgcmV0dXJuIGlzTm9uRW1wdHkoYXMpID8gTkVBLnVuc2FmZVVwZGF0ZUF0KGksIGEsIGFzKSA6IFtdO1xufTtcbi8qKlxuICogQGNhdGVnb3J5IHVuc2FmZVxuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgdW5zYWZlRGVsZXRlQXQgPSBmdW5jdGlvbiAoaSwgYXMpIHtcbiAgICB2YXIgeHMgPSBhcy5zbGljZSgpO1xuICAgIHhzLnNwbGljZShpLCAxKTtcbiAgICByZXR1cm4geHM7XG59O1xuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLy8gdXRpbHNcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8qKlxuICogYGV2ZXJ5YCB0ZWxscyBpZiB0aGUgcHJvdmlkZWQgcHJlZGljYXRlIGhvbGRzIHRydWUgZm9yIGV2ZXJ5IGVsZW1lbnQgaW4gdGhlIGBBcnJheWAuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IGV2ZXJ5IH0gZnJvbSAnZnAtdHMvQXJyYXknXG4gKlxuICogYXNzZXJ0LmVxdWFsKGV2ZXJ5KCh4OiBudW1iZXIpID0+IHggPj0gMCkoWzEsIDIsIDNdKSwgdHJ1ZSk7XG4gKiBhc3NlcnQuZXF1YWwoZXZlcnkoKHg6IG51bWJlcikgPT4geCA+PSAwKShbLTEsIDIsIDNdKSwgZmFsc2UpO1xuICpcbiAqIEBzaW5jZSAyLjkuMFxuICovXG5leHBvcnQgdmFyIGV2ZXJ5ID0gUkEuZXZlcnk7XG4vKipcbiAqIGBzb21lYCB0ZWxscyBpZiB0aGUgcHJvdmlkZWQgcHJlZGljYXRlIGhvbGRzIHRydWUgYXQgbGVhc3QgZm9yIG9uZSBlbGVtZW50IGluIHRoZSBgQXJyYXlgLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBzb21lIH0gZnJvbSAnZnAtdHMvQXJyYXknXG4gKlxuICogYXNzZXJ0LmVxdWFsKHNvbWUoKHg6IG51bWJlcikgPT4geCA+PSAwKShbMSwgMiwgM10pLCB0cnVlKTtcbiAqIGFzc2VydC5lcXVhbChzb21lKCh4OiBudW1iZXIpID0+IHggPj0gMTApKFsxLCAyLCAzXSksIGZhbHNlKTtcbiAqXG4gKiBAc2luY2UgMi45LjBcbiAqL1xuZXhwb3J0IHZhciBzb21lID0gZnVuY3Rpb24gKHByZWRpY2F0ZSkge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgcmV0dXJuIGFzLnNvbWUocHJlZGljYXRlKTtcbiAgICB9O1xufTtcbi8qKlxuICogQWxpYXMgb2YgW2Bzb21lYF0oI3NvbWUpXG4gKlxuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIGV4aXN0cyA9IHNvbWU7XG4vKipcbiAqIFBsYWNlcyBhbiBlbGVtZW50IGluIGJldHdlZW4gbWVtYmVycyBvZiBhbiBgQXJyYXlgLCB0aGVuIGZvbGRzIHRoZSByZXN1bHRzIHVzaW5nIHRoZSBwcm92aWRlZCBgTW9ub2lkYC5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0ICogYXMgUyBmcm9tICdmcC10cy9zdHJpbmcnXG4gKiBpbXBvcnQgeyBpbnRlcmNhbGF0ZSB9IGZyb20gJ2ZwLXRzL0FycmF5J1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoaW50ZXJjYWxhdGUoUy5Nb25vaWQpKCctJykoWydhJywgJ2InLCAnYyddKSwgJ2EtYi1jJylcbiAqXG4gKiBAc2luY2UgMi4xMi4wXG4gKi9cbmV4cG9ydCB2YXIgaW50ZXJjYWxhdGUgPSBSQS5pbnRlcmNhbGF0ZTtcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8vIGRvIG5vdGF0aW9uXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vKipcbiAqIEBjYXRlZ29yeSBkbyBub3RhdGlvblxuICogQHNpbmNlIDIuOS4wXG4gKi9cbmV4cG9ydCB2YXIgRG8gPSAvKiNfX1BVUkVfXyovIG9mKF8uZW1wdHlSZWNvcmQpO1xuLyoqXG4gKiBAY2F0ZWdvcnkgZG8gbm90YXRpb25cbiAqIEBzaW5jZSAyLjguMFxuICovXG5leHBvcnQgdmFyIGJpbmRUbyA9IC8qI19fUFVSRV9fKi8gYmluZFRvXyhGdW5jdG9yKTtcbnZhciBsZXRfID0gLyojX19QVVJFX18qLyBsZXRfXyhGdW5jdG9yKTtcbmV4cG9ydCB7IFxuLyoqXG4gKiBAY2F0ZWdvcnkgZG8gbm90YXRpb25cbiAqIEBzaW5jZSAyLjEzLjBcbiAqL1xubGV0XyBhcyBsZXQgfTtcbi8qKlxuICogQGNhdGVnb3J5IGRvIG5vdGF0aW9uXG4gKiBAc2luY2UgMi44LjBcbiAqL1xuZXhwb3J0IHZhciBiaW5kID0gLyojX19QVVJFX18qLyBiaW5kXyhDaGFpbik7XG4vKipcbiAqIEBjYXRlZ29yeSBkbyBub3RhdGlvblxuICogQHNpbmNlIDIuOC4wXG4gKi9cbmV4cG9ydCB2YXIgYXBTID0gLyojX19QVVJFX18qLyBhcFNfKEFwcGx5KTtcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8vIGxlZ2FjeVxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLyoqXG4gKiBBbGlhcyBvZiBgZmxhdE1hcGAuXG4gKlxuICogQGNhdGVnb3J5IGxlZ2FjeVxuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgY2hhaW4gPSBmbGF0TWFwO1xuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLy8gZGVwcmVjYXRlZFxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLyoqXG4gKiBVc2UgYE5vbkVtcHR5QXJyYXlgIG1vZHVsZSBpbnN0ZWFkLlxuICpcbiAqIEBjYXRlZ29yeSB6b25lIG9mIGRlYXRoXG4gKiBAc2luY2UgMi4wLjBcbiAqIEBkZXByZWNhdGVkXG4gKi9cbmV4cG9ydCB2YXIgcmFuZ2UgPSBORUEucmFuZ2U7XG4vKipcbiAqIFVzZSBhIG5ldyBgW11gIGluc3RlYWQuXG4gKlxuICogQGNhdGVnb3J5IHpvbmUgb2YgZGVhdGhcbiAqIEBzaW5jZSAyLjAuMFxuICogQGRlcHJlY2F0ZWRcbiAqL1xuZXhwb3J0IHZhciBlbXB0eSA9IFtdO1xuLyoqXG4gKiBVc2UgYHByZXBlbmRgIGluc3RlYWQuXG4gKlxuICogQGNhdGVnb3J5IHpvbmUgb2YgZGVhdGhcbiAqIEBzaW5jZSAyLjAuMFxuICogQGRlcHJlY2F0ZWRcbiAqL1xuZXhwb3J0IHZhciBjb25zID0gTkVBLmNvbnM7XG4vKipcbiAqIFVzZSBgYXBwZW5kYCBpbnN0ZWFkLlxuICpcbiAqIEBjYXRlZ29yeSB6b25lIG9mIGRlYXRoXG4gKiBAc2luY2UgMi4wLjBcbiAqIEBkZXByZWNhdGVkXG4gKi9cbmV4cG9ydCB2YXIgc25vYyA9IE5FQS5zbm9jO1xuLyoqXG4gKiBVc2UgYHByZXBlbmRBbGxgIGluc3RlYWRcbiAqXG4gKiBAY2F0ZWdvcnkgem9uZSBvZiBkZWF0aFxuICogQHNpbmNlIDIuOS4wXG4gKiBAZGVwcmVjYXRlZFxuICovXG5leHBvcnQgdmFyIHByZXBlbmRUb0FsbCA9IHByZXBlbmRBbGw7XG4vKipcbiAqIFRoaXMgaW5zdGFuY2UgaXMgZGVwcmVjYXRlZCwgdXNlIHNtYWxsLCBzcGVjaWZpYyBpbnN0YW5jZXMgaW5zdGVhZC5cbiAqIEZvciBleGFtcGxlIGlmIGEgZnVuY3Rpb24gbmVlZHMgYSBgRnVuY3RvcmAgaW5zdGFuY2UsIHBhc3MgYEEuRnVuY3RvcmAgaW5zdGVhZCBvZiBgQS5hcnJheWBcbiAqICh3aGVyZSBgQWAgaXMgZnJvbSBgaW1wb3J0IEEgZnJvbSAnZnAtdHMvQXJyYXknYClcbiAqXG4gKiBAY2F0ZWdvcnkgem9uZSBvZiBkZWF0aFxuICogQHNpbmNlIDIuMC4wXG4gKiBAZGVwcmVjYXRlZFxuICovXG5leHBvcnQgdmFyIGFycmF5ID0ge1xuICAgIFVSSTogVVJJLFxuICAgIGNvbXBhY3Q6IGNvbXBhY3QsXG4gICAgc2VwYXJhdGU6IHNlcGFyYXRlLFxuICAgIG1hcDogX21hcCxcbiAgICBhcDogX2FwLFxuICAgIG9mOiBvZixcbiAgICBjaGFpbjogZmxhdE1hcCxcbiAgICBmaWx0ZXI6IF9maWx0ZXIsXG4gICAgZmlsdGVyTWFwOiBfZmlsdGVyTWFwLFxuICAgIHBhcnRpdGlvbjogX3BhcnRpdGlvbixcbiAgICBwYXJ0aXRpb25NYXA6IF9wYXJ0aXRpb25NYXAsXG4gICAgbWFwV2l0aEluZGV4OiBfbWFwV2l0aEluZGV4LFxuICAgIHBhcnRpdGlvbk1hcFdpdGhJbmRleDogX3BhcnRpdGlvbk1hcFdpdGhJbmRleCxcbiAgICBwYXJ0aXRpb25XaXRoSW5kZXg6IF9wYXJ0aXRpb25XaXRoSW5kZXgsXG4gICAgZmlsdGVyTWFwV2l0aEluZGV4OiBfZmlsdGVyTWFwV2l0aEluZGV4LFxuICAgIGZpbHRlcldpdGhJbmRleDogX2ZpbHRlcldpdGhJbmRleCxcbiAgICBhbHQ6IF9hbHQsXG4gICAgemVybzogemVybyxcbiAgICB1bmZvbGQ6IHVuZm9sZCxcbiAgICByZWR1Y2U6IF9yZWR1Y2UsXG4gICAgZm9sZE1hcDogX2ZvbGRNYXAsXG4gICAgcmVkdWNlUmlnaHQ6IF9yZWR1Y2VSaWdodCxcbiAgICB0cmF2ZXJzZTogX3RyYXZlcnNlLFxuICAgIHNlcXVlbmNlOiBzZXF1ZW5jZSxcbiAgICByZWR1Y2VXaXRoSW5kZXg6IF9yZWR1Y2VXaXRoSW5kZXgsXG4gICAgZm9sZE1hcFdpdGhJbmRleDogX2ZvbGRNYXBXaXRoSW5kZXgsXG4gICAgcmVkdWNlUmlnaHRXaXRoSW5kZXg6IF9yZWR1Y2VSaWdodFdpdGhJbmRleCxcbiAgICB0cmF2ZXJzZVdpdGhJbmRleDogX3RyYXZlcnNlV2l0aEluZGV4LFxuICAgIGV4dGVuZDogX2V4dGVuZCxcbiAgICB3aXRoZXI6IF93aXRoZXIsXG4gICAgd2lsdDogX3dpbHRcbn07XG4iLAogICJpbXBvcnQgeyBhcEZpcnN0IGFzIGFwRmlyc3RfLCBhcFMgYXMgYXBTXywgYXBTZWNvbmQgYXMgYXBTZWNvbmRfIH0gZnJvbSAnLi9BcHBseSc7XG5pbXBvcnQgeyBiaW5kIGFzIGJpbmRfLCBjaGFpbkZpcnN0IGFzIGNoYWluRmlyc3RfIH0gZnJvbSAnLi9DaGFpbic7XG5pbXBvcnQgeyBmcm9tRWl0aGVySyBhcyBmcm9tRWl0aGVyS18gfSBmcm9tICcuL0Zyb21FaXRoZXInO1xuaW1wb3J0IHsgZHVhbCwgaWRlbnRpdHksIHBpcGUgfSBmcm9tICcuL2Z1bmN0aW9uJztcbmltcG9ydCB7IGJpbmRUbyBhcyBiaW5kVG9fLCBmbGFwIGFzIGZsYXBfLCBsZXQgYXMgbGV0X18gfSBmcm9tICcuL0Z1bmN0b3InO1xuaW1wb3J0ICogYXMgXyBmcm9tICcuL2ludGVybmFsJztcbmltcG9ydCAqIGFzIE5FQSBmcm9tICcuL05vbkVtcHR5QXJyYXknO1xuaW1wb3J0ICogYXMgUkEgZnJvbSAnLi9SZWFkb25seUFycmF5JztcbmltcG9ydCB7IHNlcGFyYXRlZCB9IGZyb20gJy4vU2VwYXJhdGVkJztcbmltcG9ydCB7IGZpbHRlckUgYXMgZmlsdGVyRV8sIHdpbHREZWZhdWx0LCB3aXRoZXJEZWZhdWx0IH0gZnJvbSAnLi9XaXRoZXJhYmxlJztcbmltcG9ydCB7IGd1YXJkIGFzIGd1YXJkXyB9IGZyb20gJy4vWmVybyc7XG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vLyByZWZpbmVtZW50c1xuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLyoqXG4gKiBUZXN0IHdoZXRoZXIgYW4gYXJyYXkgaXMgZW1wdHlcbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgaXNFbXB0eSB9IGZyb20gJ2ZwLXRzL0FycmF5J1xuICpcbiAqIGFzc2VydC5zdHJpY3RFcXVhbChpc0VtcHR5KFtdKSwgdHJ1ZSlcbiAqIGFzc2VydC5zdHJpY3RFcXVhbChpc0VtcHR5KFsnYSddKSwgZmFsc2UpXG4gKlxuICogQGNhdGVnb3J5IHJlZmluZW1lbnRzXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciBpc0VtcHR5ID0gZnVuY3Rpb24gKGFzKSB7IHJldHVybiBhcy5sZW5ndGggPT09IDA7IH07XG4vKipcbiAqIFRlc3Qgd2hldGhlciBhbiBhcnJheSBpcyBub24gZW1wdHkgbmFycm93aW5nIGRvd24gdGhlIHR5cGUgdG8gYE5vbkVtcHR5QXJyYXk8QT5gXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IGlzTm9uRW1wdHkgfSBmcm9tICdmcC10cy9BcnJheSdcbiAqXG4gKiBhc3NlcnQuc3RyaWN0RXF1YWwoaXNOb25FbXB0eShbXSksIGZhbHNlKVxuICogYXNzZXJ0LnN0cmljdEVxdWFsKGlzTm9uRW1wdHkoWydhJ10pLCB0cnVlKVxuICpcbiAqIEBjYXRlZ29yeSByZWZpbmVtZW50c1xuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgaXNOb25FbXB0eSA9IE5FQS5pc05vbkVtcHR5O1xuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLy8gY29uc3RydWN0b3JzXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vKipcbiAqIFByZXBlbmQgYW4gZWxlbWVudCB0byB0aGUgZnJvbnQgb2YgYSBgQXJyYXlgLCBjcmVhdGluZyBhIG5ldyBgTm9uRW1wdHlBcnJheWAuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IHByZXBlbmQgfSBmcm9tICdmcC10cy9BcnJheSdcbiAqIGltcG9ydCB7IHBpcGUgfSBmcm9tICdmcC10cy9mdW5jdGlvbidcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKHBpcGUoWzIsIDMsIDRdLCBwcmVwZW5kKDEpKSwgWzEsIDIsIDMsIDRdKVxuICpcbiAqIEBzaW5jZSAyLjEwLjBcbiAqL1xuZXhwb3J0IHZhciBwcmVwZW5kID0gTkVBLnByZXBlbmQ7XG4vKipcbiAqIExlc3Mgc3RyaWN0IHZlcnNpb24gb2YgW2BwcmVwZW5kYF0oI3ByZXBlbmQpLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBwcmVwZW5kVyB9IGZyb20gJ2ZwLXRzL0FycmF5J1xuICogaW1wb3J0IHsgcGlwZSB9IGZyb20gJ2ZwLXRzL2Z1bmN0aW9uJ1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwocGlwZShbMiwgMywgNF0sIHByZXBlbmRXKFwiYVwiKSksIFtcImFcIiwgMiwgMywgNF0pO1xuICpcbiAqIEBzaW5jZSAyLjExLjBcbiAqL1xuZXhwb3J0IHZhciBwcmVwZW5kVyA9IE5FQS5wcmVwZW5kVztcbi8qKlxuICogQXBwZW5kIGFuIGVsZW1lbnQgdG8gdGhlIGVuZCBvZiBhIGBBcnJheWAsIGNyZWF0aW5nIGEgbmV3IGBOb25FbXB0eUFycmF5YC5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgYXBwZW5kIH0gZnJvbSAnZnAtdHMvQXJyYXknXG4gKiBpbXBvcnQgeyBwaXBlIH0gZnJvbSAnZnAtdHMvZnVuY3Rpb24nXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChwaXBlKFsxLCAyLCAzXSwgYXBwZW5kKDQpKSwgWzEsIDIsIDMsIDRdKVxuICpcbiAqIEBzaW5jZSAyLjEwLjBcbiAqL1xuZXhwb3J0IHZhciBhcHBlbmQgPSBORUEuYXBwZW5kO1xuLyoqXG4gKiBMZXNzIHN0cmljdCB2ZXJzaW9uIG9mIFtgYXBwZW5kYF0oI2FwcGVuZCkuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IGFwcGVuZFcgfSBmcm9tICdmcC10cy9BcnJheSdcbiAqIGltcG9ydCB7IHBpcGUgfSBmcm9tICdmcC10cy9mdW5jdGlvbidcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKHBpcGUoWzEsIDIsIDNdLCBhcHBlbmRXKFwiZFwiKSksIFsxLCAyLCAzLCBcImRcIl0pO1xuICpcbiAqIEBzaW5jZSAyLjExLjBcbiAqL1xuZXhwb3J0IHZhciBhcHBlbmRXID0gTkVBLmFwcGVuZFc7XG4vKipcbiAqIFJldHVybiBhIGBBcnJheWAgb2YgbGVuZ3RoIGBuYCB3aXRoIGVsZW1lbnQgYGlgIGluaXRpYWxpemVkIHdpdGggYGYoaSlgLlxuICpcbiAqICoqTm90ZSoqLiBgbmAgaXMgbm9ybWFsaXplZCB0byBhIG5vbiBuZWdhdGl2ZSBpbnRlZ2VyLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBtYWtlQnkgfSBmcm9tICdmcC10cy9BcnJheSdcbiAqXG4gKiBjb25zdCBkb3VibGUgPSAoaTogbnVtYmVyKTogbnVtYmVyID0+IGkgKiAyXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKG1ha2VCeSg1LCBkb3VibGUpLCBbMCwgMiwgNCwgNiwgOF0pXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKG1ha2VCeSgtMywgZG91YmxlKSwgW10pXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKG1ha2VCeSg0LjMyMTY0LCBkb3VibGUpLCBbMCwgMiwgNCwgNl0pXG4gKlxuICogQGNhdGVnb3J5IGNvbnN0cnVjdG9yc1xuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgbWFrZUJ5ID0gZnVuY3Rpb24gKG4sIGYpIHsgcmV0dXJuIChuIDw9IDAgPyBbXSA6IE5FQS5tYWtlQnkoZikobikpOyB9O1xuLyoqXG4gKiBDcmVhdGUgYSBgQXJyYXlgIGNvbnRhaW5pbmcgYSB2YWx1ZSByZXBlYXRlZCB0aGUgc3BlY2lmaWVkIG51bWJlciBvZiB0aW1lcy5cbiAqXG4gKiAqKk5vdGUqKi4gYG5gIGlzIG5vcm1hbGl6ZWQgdG8gYSBub24gbmVnYXRpdmUgaW50ZWdlci5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgcmVwbGljYXRlIH0gZnJvbSAnZnAtdHMvQXJyYXknXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChyZXBsaWNhdGUoMywgJ2EnKSwgWydhJywgJ2EnLCAnYSddKVxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChyZXBsaWNhdGUoLTMsICdhJyksIFtdKVxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChyZXBsaWNhdGUoMi45ODU2NDcsICdhJyksIFsnYScsICdhJ10pXG4gKlxuICogQGNhdGVnb3J5IGNvbnN0cnVjdG9yc1xuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgcmVwbGljYXRlID0gZnVuY3Rpb24gKG4sIGEpIHsgcmV0dXJuIG1ha2VCeShuLCBmdW5jdGlvbiAoKSB7IHJldHVybiBhOyB9KTsgfTtcbmV4cG9ydCBmdW5jdGlvbiBmcm9tUHJlZGljYXRlKHByZWRpY2F0ZSkge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYSkgeyByZXR1cm4gKHByZWRpY2F0ZShhKSA/IFthXSA6IFtdKTsgfTtcbn1cbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8vIGNvbnZlcnNpb25zXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vKipcbiAqIENyZWF0ZSBhbiBhcnJheSBmcm9tIGFuIGBPcHRpb25gLiBUaGUgcmVzdWx0aW5nIGFycmF5IHdpbGwgY29udGFpbiB0aGUgY29udGVudCBvZiB0aGVcbiAqIGBPcHRpb25gIGlmIGl0IGlzIGBTb21lYCBhbmQgaXQgd2lsbCBiZSBlbXB0eSBpZiB0aGUgYE9wdGlvbmAgaXMgYE5vbmVgLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBmcm9tT3B0aW9uIH0gZnJvbSAnZnAtdHMvQXJyYXknXG4gKiBpbXBvcnQgeyBvcHRpb24gfSBmcm9tIFwiZnAtdHNcIjtcbiAqIGltcG9ydCB7IHBpcGUgfSBmcm9tICdmcC10cy9mdW5jdGlvbidcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKHBpcGUob3B0aW9uLnNvbWUoXCJhXCIpLCBmcm9tT3B0aW9uKSxbXCJhXCJdKVxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChwaXBlKG9wdGlvbi5ub25lLCBmcm9tT3B0aW9uKSxbXSlcbiAqXG4gKiBAY2F0ZWdvcnkgY29udmVyc2lvbnNcbiAqIEBzaW5jZSAyLjExLjBcbiAqL1xuZXhwb3J0IHZhciBmcm9tT3B0aW9uID0gZnVuY3Rpb24gKG1hKSB7IHJldHVybiAoXy5pc05vbmUobWEpID8gW10gOiBbbWEudmFsdWVdKTsgfTtcbi8qKlxuICogQ3JlYXRlIGFuIGFycmF5IGZyb20gYW4gYEVpdGhlcmAuIFRoZSByZXN1bHRpbmcgYXJyYXkgd2lsbCBjb250YWluIHRoZSBjb250ZW50IG9mIHRoZVxuICogYEVpdGhlcmAgaWYgaXQgaXMgYFJpZ2h0YCBhbmQgaXQgd2lsbCBiZSBlbXB0eSBpZiB0aGUgYEVpdGhlcmAgaXMgYExlZnRgLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBmcm9tRWl0aGVyIH0gZnJvbSAnZnAtdHMvQXJyYXknXG4gKiBpbXBvcnQgeyBlaXRoZXIgfSBmcm9tIFwiZnAtdHNcIjtcbiAqIGltcG9ydCB7IHBpcGUgfSBmcm9tICdmcC10cy9mdW5jdGlvbidcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKHBpcGUoZWl0aGVyLnJpZ2h0KFwiclwiKSwgZnJvbUVpdGhlciksIFtcInJcIl0pO1xuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChwaXBlKGVpdGhlci5sZWZ0KFwibFwiKSwgZnJvbUVpdGhlciksIFtdKTtcbiAqXG4gKiBAY2F0ZWdvcnkgY29udmVyc2lvbnNcbiAqIEBzaW5jZSAyLjExLjBcbiAqL1xuZXhwb3J0IHZhciBmcm9tRWl0aGVyID0gZnVuY3Rpb24gKGUpIHsgcmV0dXJuIChfLmlzTGVmdChlKSA/IFtdIDogW2UucmlnaHRdKTsgfTtcbi8qKlxuICogTGVzcyBzdHJpY3QgdmVyc2lvbiBvZiBbYG1hdGNoYF0oI21hdGNoKS5cbiAqXG4gKiBUaGUgYFdgIHN1ZmZpeCAoc2hvcnQgZm9yICoqVyoqaWRlbmluZykgbWVhbnMgdGhhdCB0aGUgaGFuZGxlciByZXR1cm4gdHlwZXMgd2lsbCBiZSBtZXJnZWQuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IG1hdGNoVyB9IGZyb20gJ2ZwLXRzL0FycmF5J1xuICogaW1wb3J0IHsgcGlwZSB9IGZyb20gJ2ZwLXRzL2Z1bmN0aW9uJ1xuICpcbiAqIGNvbnN0IG1hdGNoZXJXID0gbWF0Y2hXKFxuICogICAoKSA9PiBcIk5vIGVsZW1lbnRzXCIsXG4gKiAgIChhcykgPT4gYXMubGVuZ3RoXG4gKiApO1xuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChwaXBlKFsxLCAyLCAzLCA0XSwgbWF0Y2hlclcpLCA0KTtcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwocGlwZShbXSwgbWF0Y2hlclcpLCBcIk5vIGVsZW1lbnRzXCIpO1xuICpcbiAqIEBjYXRlZ29yeSBwYXR0ZXJuIG1hdGNoaW5nXG4gKiBAc2luY2UgMi4xMS4wXG4gKi9cbmV4cG9ydCB2YXIgbWF0Y2hXID0gZnVuY3Rpb24gKG9uRW1wdHksIG9uTm9uRW1wdHkpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIHJldHVybiBpc05vbkVtcHR5KGFzKSA/IG9uTm9uRW1wdHkoYXMpIDogb25FbXB0eSgpO1xuICAgIH07XG59O1xuLyoqXG4gKiBUYWtlcyBhbiBhcnJheSwgaWYgdGhlIGFycmF5IGlzIGVtcHR5IGl0IHJldHVybnMgdGhlIHJlc3VsdCBvZiBgb25FbXB0eWAsIG90aGVyd2lzZVxuICogaXQgcGFzc2VzIHRoZSBhcnJheSB0byBgb25Ob25FbXB0eWAgYW5kIHJldHVybnMgdGhlIHJlc3VsdC5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgbWF0Y2ggfSBmcm9tICdmcC10cy9BcnJheSdcbiAqIGltcG9ydCB7IHBpcGUgfSBmcm9tICdmcC10cy9mdW5jdGlvbidcbiAqXG4gKiBjb25zdCBtYXRjaGVyID0gbWF0Y2goXG4gKiAgICgpID0+IFwiTm8gZWxlbWVudHNcIixcbiAqICAgKGFzKSA9PiBgRm91bmQgJHthcy5sZW5ndGh9IGVsZW1lbnQocylgXG4gKiApO1xuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChwaXBlKFsxLCAyLCAzLCA0XSwgbWF0Y2hlciksIFwiRm91bmQgNCBlbGVtZW50KHMpXCIpO1xuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChwaXBlKFtdLCBtYXRjaGVyKSwgXCJObyBlbGVtZW50c1wiKTtcbiAqXG4gKiBAY2F0ZWdvcnkgcGF0dGVybiBtYXRjaGluZ1xuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIG1hdGNoID0gbWF0Y2hXO1xuLyoqXG4gKiBMZXNzIHN0cmljdCB2ZXJzaW9uIG9mIFtgbWF0Y2hMZWZ0YF0oI21hdGNobGVmdCkuIEl0IHdpbGwgd29yayB3aGVuIGBvbkVtcHR5YCBhbmRcbiAqIGBvbk5vbkVtcHR5YCBoYXZlIGRpZmZlcmVudCByZXR1cm4gdHlwZXMuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IG1hdGNoTGVmdFcgfSBmcm9tICdmcC10cy9BcnJheSdcbiAqXG4gKiBjb25zdCBmID0gbWF0Y2hMZWZ0VyhcbiAqICAgKCkgPT4gMCxcbiAqICAgKGhlYWQ6IHN0cmluZywgdGFpbDogc3RyaW5nW10pID0+IGBGb3VuZCBcIiR7aGVhZH1cIiBmb2xsb3dlZCBieSAke3RhaWwubGVuZ3RofSBlbGVtZW50c2BcbiAqICk7XG4gKiBhc3NlcnQuc3RyaWN0RXF1YWwoZihbXCJhXCIsIFwiYlwiLCBcImNcIl0pLCAnRm91bmQgXCJhXCIgZm9sbG93ZWQgYnkgMiBlbGVtZW50cycpO1xuICogYXNzZXJ0LnN0cmljdEVxdWFsKGYoW10pLCAwKTtcbiAqXG4gKiBAY2F0ZWdvcnkgcGF0dGVybiBtYXRjaGluZ1xuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIG1hdGNoTGVmdFcgPSBmdW5jdGlvbiAob25FbXB0eSwgb25Ob25FbXB0eSkge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgcmV0dXJuIGlzTm9uRW1wdHkoYXMpID8gb25Ob25FbXB0eShORUEuaGVhZChhcyksIE5FQS50YWlsKGFzKSkgOiBvbkVtcHR5KCk7XG4gICAgfTtcbn07XG4vKipcbiAqIFRha2VzIGFuIGFycmF5LCBpZiB0aGUgYXJyYXkgaXMgZW1wdHkgaXQgcmV0dXJucyB0aGUgcmVzdWx0IG9mIGBvbkVtcHR5YCwgb3RoZXJ3aXNlXG4gKiBpdCBwYXNzZXMgdGhlIGFycmF5IHRvIGBvbk5vbkVtcHR5YCBicm9rZW4gaW50byBpdHMgZmlyc3QgZWxlbWVudCBhbmQgcmVtYWluaW5nIGVsZW1lbnRzLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBtYXRjaExlZnQgfSBmcm9tICdmcC10cy9BcnJheSdcbiAqXG4gKiBjb25zdCBsZW46IDxBPihhczogQXJyYXk8QT4pID0+IG51bWJlciA9IG1hdGNoTGVmdCgoKSA9PiAwLCAoXywgdGFpbCkgPT4gMSArIGxlbih0YWlsKSlcbiAqIGFzc2VydC5zdHJpY3RFcXVhbChsZW4oWzEsIDIsIDNdKSwgMylcbiAqXG4gKiBAY2F0ZWdvcnkgcGF0dGVybiBtYXRjaGluZ1xuICogQHNpbmNlIDIuMTAuMFxuICovXG5leHBvcnQgdmFyIG1hdGNoTGVmdCA9IG1hdGNoTGVmdFc7XG4vKipcbiAqIEFsaWFzIG9mIFtgbWF0Y2hMZWZ0YF0oI21hdGNobGVmdCkuXG4gKlxuICogQGNhdGVnb3J5IHBhdHRlcm4gbWF0Y2hpbmdcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIGZvbGRMZWZ0ID0gbWF0Y2hMZWZ0O1xuLyoqXG4gKiBMZXNzIHN0cmljdCB2ZXJzaW9uIG9mIFtgbWF0Y2hSaWdodGBdKCNtYXRjaHJpZ2h0KS4gSXQgd2lsbCB3b3JrIHdoZW4gYG9uRW1wdHlgIGFuZFxuICogYG9uTm9uRW1wdHlgIGhhdmUgZGlmZmVyZW50IHJldHVybiB0eXBlcy5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgbWF0Y2hSaWdodFcgfSBmcm9tICdmcC10cy9BcnJheSdcbiAqXG4gKiBjb25zdCBmID0gbWF0Y2hSaWdodFcoXG4gKiAgICgpID0+IDAsXG4gKiAgIChoZWFkOiBzdHJpbmdbXSwgdGFpbDogc3RyaW5nKSA9PiBgRm91bmQgJHtoZWFkLmxlbmd0aH0gZWxlbWVudHMgZm9sbGxvd2VkIGJ5IFwiJHt0YWlsfVwiYFxuICogKTtcbiAqIGFzc2VydC5zdHJpY3RFcXVhbChmKFtcImFcIiwgXCJiXCIsIFwiY1wiXSksICdGb3VuZCAyIGVsZW1lbnRzIGZvbGxsb3dlZCBieSBcImNcIicpO1xuICogYXNzZXJ0LnN0cmljdEVxdWFsKGYoW10pLCAwKTtcbiAqXG4gKiBAY2F0ZWdvcnkgcGF0dGVybiBtYXRjaGluZ1xuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIG1hdGNoUmlnaHRXID0gZnVuY3Rpb24gKG9uRW1wdHksIG9uTm9uRW1wdHkpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIHJldHVybiBpc05vbkVtcHR5KGFzKSA/IG9uTm9uRW1wdHkoTkVBLmluaXQoYXMpLCBORUEubGFzdChhcykpIDogb25FbXB0eSgpO1xuICAgIH07XG59O1xuLyoqXG4gKiBUYWtlcyBhbiBhcnJheSwgaWYgdGhlIGFycmF5IGlzIGVtcHR5IGl0IHJldHVybnMgdGhlIHJlc3VsdCBvZiBgb25FbXB0eWAsIG90aGVyd2lzZVxuICogaXQgcGFzc2VzIHRoZSBhcnJheSB0byBgb25Ob25FbXB0eWAgYnJva2VuICBpbnRvIGl0cyBpbml0aWFsIGVsZW1lbnRzIGFuZCB0aGUgbGFzdCBlbGVtZW50LlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBtYXRjaFJpZ2h0IH0gZnJvbSAnZnAtdHMvQXJyYXknXG4gKlxuICogY29uc3QgbGVuOiA8QT4oYXM6IEFycmF5PEE+KSA9PiBudW1iZXIgPSBtYXRjaFJpZ2h0KFxuICogICAoKSA9PiAwLFxuICogICAoaGVhZCwgXykgPT4gMSArIGxlbihoZWFkKVxuICogKTtcbiAqIGFzc2VydC5zdHJpY3RFcXVhbChsZW4oWzEsIDIsIDNdKSwgMyk7XG4gKlxuICogQGNhdGVnb3J5IHBhdHRlcm4gbWF0Y2hpbmdcbiAqIEBzaW5jZSAyLjEwLjBcbiAqL1xuZXhwb3J0IHZhciBtYXRjaFJpZ2h0ID0gbWF0Y2hSaWdodFc7XG4vKipcbiAqIEFsaWFzIG9mIFtgbWF0Y2hSaWdodGBdKCNtYXRjaHJpZ2h0KS5cbiAqXG4gKiBAY2F0ZWdvcnkgcGF0dGVybiBtYXRjaGluZ1xuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgZm9sZFJpZ2h0ID0gbWF0Y2hSaWdodDtcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8vIGNvbWJpbmF0b3JzXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vKipcbiAqIFNhbWUgYXMgW2BjaGFpbmBdKCNjaGFpbiksIGJ1dCBwYXNzaW5nIGFsc28gdGhlIGluZGV4IHRvIHRoZSBpdGVyYXRpbmcgZnVuY3Rpb24uXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IGNoYWluV2l0aEluZGV4LCByZXBsaWNhdGUgfSBmcm9tICdmcC10cy9BcnJheSdcbiAqIGltcG9ydCB7IHBpcGUgfSBmcm9tICdmcC10cy9mdW5jdGlvbidcbiAqXG4gKiBjb25zdCBmID0gKGluZGV4OiBudW1iZXIsIHg6IHN0cmluZykgPT4gcmVwbGljYXRlKDIsIGAke3h9JHtpbmRleH1gKTtcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwocGlwZShbXCJhXCIsIFwiYlwiLCBcImNcIl0sIGNoYWluV2l0aEluZGV4KGYpKSwgW1wiYTBcIiwgXCJhMFwiLCBcImIxXCIsIFwiYjFcIiwgXCJjMlwiLCBcImMyXCJdKTtcbiAqXG4gKiBAY2F0ZWdvcnkgc2VxdWVuY2luZ1xuICogQHNpbmNlIDIuNy4wXG4gKi9cbmV4cG9ydCB2YXIgY2hhaW5XaXRoSW5kZXggPSBmdW5jdGlvbiAoZikge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgdmFyIG91dCA9IFtdO1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGFzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICBvdXQucHVzaC5hcHBseShvdXQsIGYoaSwgYXNbaV0pKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gb3V0O1xuICAgIH07XG59O1xuLyoqXG4gKiBTYW1lIGFzIGByZWR1Y2VgIGJ1dCBpdCBjYXJyaWVzIG92ZXIgdGhlIGludGVybWVkaWF0ZSBzdGVwc1xuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBzY2FuTGVmdCB9IGZyb20gJ2ZwLXRzL0FycmF5J1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoc2NhbkxlZnQoMTAsIChiLCBhOiBudW1iZXIpID0+IGIgLSBhKShbMSwgMiwgM10pLCBbMTAsIDksIDcsIDRdKVxuICpcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIHNjYW5MZWZ0ID0gZnVuY3Rpb24gKGIsIGYpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIHZhciBsZW4gPSBhcy5sZW5ndGg7XG4gICAgICAgIHZhciBvdXQgPSBuZXcgQXJyYXkobGVuICsgMSk7XG4gICAgICAgIG91dFswXSA9IGI7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbGVuOyBpKyspIHtcbiAgICAgICAgICAgIG91dFtpICsgMV0gPSBmKG91dFtpXSwgYXNbaV0pO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBvdXQ7XG4gICAgfTtcbn07XG4vKipcbiAqIEZvbGQgYW4gYXJyYXkgZnJvbSB0aGUgcmlnaHQsIGtlZXBpbmcgYWxsIGludGVybWVkaWF0ZSByZXN1bHRzIGluc3RlYWQgb2Ygb25seSB0aGUgZmluYWwgcmVzdWx0XG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IHNjYW5SaWdodCB9IGZyb20gJ2ZwLXRzL0FycmF5J1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoc2NhblJpZ2h0KDEwLCAoYTogbnVtYmVyLCBiKSA9PiBiIC0gYSkoWzEsIDIsIDNdKSwgWzQsIDUsIDcsIDEwXSlcbiAqXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciBzY2FuUmlnaHQgPSBmdW5jdGlvbiAoYiwgZikge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgdmFyIGxlbiA9IGFzLmxlbmd0aDtcbiAgICAgICAgdmFyIG91dCA9IG5ldyBBcnJheShsZW4gKyAxKTtcbiAgICAgICAgb3V0W2xlbl0gPSBiO1xuICAgICAgICBmb3IgKHZhciBpID0gbGVuIC0gMTsgaSA+PSAwOyBpLS0pIHtcbiAgICAgICAgICAgIG91dFtpXSA9IGYoYXNbaV0sIG91dFtpICsgMV0pO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBvdXQ7XG4gICAgfTtcbn07XG4vKipcbiAqIENhbGN1bGF0ZSB0aGUgbnVtYmVyIG9mIGVsZW1lbnRzIGluIGEgYEFycmF5YC5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgc2l6ZSB9IGZyb20gJ2ZwLXRzL0FycmF5J1xuICpcbiAqIGFzc2VydC5zdHJpY3RFcXVhbChzaXplKFtcImFcIixcImJcIixcImNcIl0pLDMpXG4gKlxuICogQHNpbmNlIDIuMTAuMFxuICovXG5leHBvcnQgdmFyIHNpemUgPSBmdW5jdGlvbiAoYXMpIHsgcmV0dXJuIGFzLmxlbmd0aDsgfTtcbi8qKlxuICogVGVzdCB3aGV0aGVyIGFuIGFycmF5IGNvbnRhaW5zIGEgcGFydGljdWxhciBpbmRleFxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBpc091dE9mQm91bmQgfSBmcm9tICdmcC10cy9BcnJheSdcbiAqXG4gKiBhc3NlcnQuc3RyaWN0RXF1YWwoaXNPdXRPZkJvdW5kKDEsW1wiYVwiLFwiYlwiLFwiY1wiXSksZmFsc2UpXG4gKiBhc3NlcnQuc3RyaWN0RXF1YWwoaXNPdXRPZkJvdW5kKC0xLFtcImFcIixcImJcIixcImNcIl0pLHRydWUpXG4gKiBhc3NlcnQuc3RyaWN0RXF1YWwoaXNPdXRPZkJvdW5kKDMsW1wiYVwiLFwiYlwiLFwiY1wiXSksdHJ1ZSlcbiAqXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciBpc091dE9mQm91bmQgPSBORUEuaXNPdXRPZkJvdW5kO1xuLy8gVE9ETzogcmVtb3ZlIG5vbi1jdXJyaWVkIG92ZXJsb2FkaW5nIGluIHYzXG4vKipcbiAqIFRoaXMgZnVuY3Rpb24gcHJvdmlkZXMgYSBzYWZlIHdheSB0byByZWFkIGEgdmFsdWUgYXQgYSBwYXJ0aWN1bGFyIGluZGV4IGZyb20gYW4gYXJyYXkuXG4gKiBJdCByZXR1cm5zIGEgYG5vbmVgIGlmIHRoZSBpbmRleCBpcyBvdXQgb2YgYm91bmRzLCBhbmQgYSBgc29tZWAgb2YgdGhlIGVsZW1lbnQgaWYgdGhlXG4gKiBpbmRleCBpcyB2YWxpZC5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgbG9va3VwIH0gZnJvbSAnZnAtdHMvQXJyYXknXG4gKiBpbXBvcnQgeyBzb21lLCBub25lIH0gZnJvbSAnZnAtdHMvT3B0aW9uJ1xuICogaW1wb3J0IHsgcGlwZSB9IGZyb20gJ2ZwLXRzL2Z1bmN0aW9uJ1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwocGlwZShbMSwgMiwgM10sIGxvb2t1cCgxKSksIHNvbWUoMikpXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKHBpcGUoWzEsIDIsIDNdLCBsb29rdXAoMykpLCBub25lKVxuICpcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIGxvb2t1cCA9IFJBLmxvb2t1cDtcbi8qKlxuICogR2V0IHRoZSBmaXJzdCBlbGVtZW50IGluIGFuIGFycmF5LCBvciBgTm9uZWAgaWYgdGhlIGFycmF5IGlzIGVtcHR5XG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IGhlYWQgfSBmcm9tICdmcC10cy9BcnJheSdcbiAqIGltcG9ydCB7IHNvbWUsIG5vbmUgfSBmcm9tICdmcC10cy9PcHRpb24nXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChoZWFkKFsxLCAyLCAzXSksIHNvbWUoMSkpXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKGhlYWQoW10pLCBub25lKVxuICpcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIGhlYWQgPSBSQS5oZWFkO1xuLyoqXG4gKiBHZXQgdGhlIGxhc3QgZWxlbWVudCBpbiBhbiBhcnJheSwgb3IgYE5vbmVgIGlmIHRoZSBhcnJheSBpcyBlbXB0eVxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBsYXN0IH0gZnJvbSAnZnAtdHMvQXJyYXknXG4gKiBpbXBvcnQgeyBzb21lLCBub25lIH0gZnJvbSAnZnAtdHMvT3B0aW9uJ1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwobGFzdChbMSwgMiwgM10pLCBzb21lKDMpKVxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChsYXN0KFtdKSwgbm9uZSlcbiAqXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciBsYXN0ID0gUkEubGFzdDtcbi8qKlxuICogR2V0IGFsbCBidXQgdGhlIGZpcnN0IGVsZW1lbnQgb2YgYW4gYXJyYXksIGNyZWF0aW5nIGEgbmV3IGFycmF5LCBvciBgTm9uZWAgaWYgdGhlIGFycmF5IGlzIGVtcHR5XG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IHRhaWwgfSBmcm9tICdmcC10cy9BcnJheSdcbiAqIGltcG9ydCB7IHNvbWUsIG5vbmUgfSBmcm9tICdmcC10cy9PcHRpb24nXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbCh0YWlsKFsxLCAyLCAzXSksIHNvbWUoWzIsIDNdKSlcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwodGFpbChbXSksIG5vbmUpXG4gKlxuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgdGFpbCA9IGZ1bmN0aW9uIChhcykgeyByZXR1cm4gKGlzTm9uRW1wdHkoYXMpID8gXy5zb21lKE5FQS50YWlsKGFzKSkgOiBfLm5vbmUpOyB9O1xuLyoqXG4gKiBHZXQgYWxsIGJ1dCB0aGUgbGFzdCBlbGVtZW50IG9mIGFuIGFycmF5LCBjcmVhdGluZyBhIG5ldyBhcnJheSwgb3IgYE5vbmVgIGlmIHRoZSBhcnJheSBpcyBlbXB0eVxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBpbml0IH0gZnJvbSAnZnAtdHMvQXJyYXknXG4gKiBpbXBvcnQgeyBzb21lLCBub25lIH0gZnJvbSAnZnAtdHMvT3B0aW9uJ1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoaW5pdChbMSwgMiwgM10pLCBzb21lKFsxLCAyXSkpXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKGluaXQoW10pLCBub25lKVxuICpcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIGluaXQgPSBmdW5jdGlvbiAoYXMpIHsgcmV0dXJuIChpc05vbkVtcHR5KGFzKSA/IF8uc29tZShORUEuaW5pdChhcykpIDogXy5ub25lKTsgfTtcbi8qKlxuICogS2VlcCBvbmx5IGEgbWF4IG51bWJlciBvZiBlbGVtZW50cyBmcm9tIHRoZSBzdGFydCBvZiBhbiBgQXJyYXlgLCBjcmVhdGluZyBhIG5ldyBgQXJyYXlgLlxuICpcbiAqICoqTm90ZSoqLiBgbmAgaXMgbm9ybWFsaXplZCB0byBhIG5vbiBuZWdhdGl2ZSBpbnRlZ2VyLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyB0YWtlTGVmdCB9IGZyb20gJ2ZwLXRzL0FycmF5J1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwodGFrZUxlZnQoMikoWzEsIDIsIDMsIDQsIDVdKSwgWzEsIDJdKTtcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwodGFrZUxlZnQoNykoWzEsIDIsIDMsIDQsIDVdKSwgWzEsIDIsIDMsIDQsIDVdKTtcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwodGFrZUxlZnQoMCkoWzEsIDIsIDMsIDQsIDVdKSwgW10pO1xuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbCh0YWtlTGVmdCgtMSkoWzEsIDIsIDMsIDQsIDVdKSwgWzEsIDIsIDMsIDQsIDVdKTtcbiAqXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciB0YWtlTGVmdCA9IGZ1bmN0aW9uIChuKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykge1xuICAgICAgICByZXR1cm4gaXNPdXRPZkJvdW5kKG4sIGFzKSA/IGNvcHkoYXMpIDogYXMuc2xpY2UoMCwgbik7XG4gICAgfTtcbn07XG4vKipcbiAqIEtlZXAgb25seSBhIG1heCBudW1iZXIgb2YgZWxlbWVudHMgZnJvbSB0aGUgZW5kIG9mIGFuIGBBcnJheWAsIGNyZWF0aW5nIGEgbmV3IGBBcnJheWAuXG4gKlxuICogKipOb3RlKiouIGBuYCBpcyBub3JtYWxpemVkIHRvIGEgbm9uIG5lZ2F0aXZlIGludGVnZXIuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IHRha2VSaWdodCB9IGZyb20gJ2ZwLXRzL0FycmF5J1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwodGFrZVJpZ2h0KDIpKFsxLCAyLCAzLCA0LCA1XSksIFs0LCA1XSk7XG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKHRha2VSaWdodCg3KShbMSwgMiwgMywgNCwgNV0pLCBbMSwgMiwgMywgNCwgNV0pO1xuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbCh0YWtlUmlnaHQoMCkoWzEsIDIsIDMsIDQsIDVdKSwgW10pO1xuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbCh0YWtlUmlnaHQoLTEpKFsxLCAyLCAzLCA0LCA1XSksIFsxLCAyLCAzLCA0LCA1XSk7XG4gKlxuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgdGFrZVJpZ2h0ID0gZnVuY3Rpb24gKG4pIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIHJldHVybiBpc091dE9mQm91bmQobiwgYXMpID8gY29weShhcykgOiBuID09PSAwID8gW10gOiBhcy5zbGljZSgtbik7XG4gICAgfTtcbn07XG5leHBvcnQgZnVuY3Rpb24gdGFrZUxlZnRXaGlsZShwcmVkaWNhdGUpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIHZhciBvdXQgPSBbXTtcbiAgICAgICAgZm9yICh2YXIgX2kgPSAwLCBhc18xID0gYXM7IF9pIDwgYXNfMS5sZW5ndGg7IF9pKyspIHtcbiAgICAgICAgICAgIHZhciBhID0gYXNfMVtfaV07XG4gICAgICAgICAgICBpZiAoIXByZWRpY2F0ZShhKSkge1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgb3V0LnB1c2goYSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG91dDtcbiAgICB9O1xufVxudmFyIHNwYW5MZWZ0SW5kZXggPSBmdW5jdGlvbiAoYXMsIHByZWRpY2F0ZSkge1xuICAgIHZhciBsID0gYXMubGVuZ3RoO1xuICAgIHZhciBpID0gMDtcbiAgICBmb3IgKDsgaSA8IGw7IGkrKykge1xuICAgICAgICBpZiAoIXByZWRpY2F0ZShhc1tpXSkpIHtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiBpO1xufTtcbmV4cG9ydCBmdW5jdGlvbiBzcGFuTGVmdChwcmVkaWNhdGUpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIHZhciBfYSA9IHNwbGl0QXQoc3BhbkxlZnRJbmRleChhcywgcHJlZGljYXRlKSkoYXMpLCBpbml0ID0gX2FbMF0sIHJlc3QgPSBfYVsxXTtcbiAgICAgICAgcmV0dXJuIHsgaW5pdDogaW5pdCwgcmVzdDogcmVzdCB9O1xuICAgIH07XG59XG4vKipcbiAqIENyZWF0ZXMgYSBuZXcgYEFycmF5YCB3aGljaCBpcyBhIGNvcHkgb2YgdGhlIGlucHV0IGRyb3BwaW5nIGEgbWF4IG51bWJlciBvZiBlbGVtZW50cyBmcm9tIHRoZSBzdGFydC5cbiAqXG4gKiAqKk5vdGUqKi4gYG5gIGlzIG5vcm1hbGl6ZWQgdG8gYSBub24gbmVnYXRpdmUgaW50ZWdlci5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgZHJvcExlZnQgfSBmcm9tICdmcC10cy9BcnJheSdcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKGRyb3BMZWZ0KDIpKFsxLCAyLCAzXSksIFszXSk7XG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKGRyb3BMZWZ0KDUpKFsxLCAyLCAzXSksIFtdKTtcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoZHJvcExlZnQoMCkoWzEsIDIsIDNdKSwgWzEsIDIsIDNdKTtcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoZHJvcExlZnQoLTIpKFsxLCAyLCAzXSksIFsxLCAyLCAzXSk7XG4gKlxuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgZHJvcExlZnQgPSBmdW5jdGlvbiAobikge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgcmV0dXJuIG4gPD0gMCB8fCBpc0VtcHR5KGFzKSA/IGNvcHkoYXMpIDogbiA+PSBhcy5sZW5ndGggPyBbXSA6IGFzLnNsaWNlKG4sIGFzLmxlbmd0aCk7XG4gICAgfTtcbn07XG4vKipcbiAqIENyZWF0ZXMgYSBuZXcgYEFycmF5YCB3aGljaCBpcyBhIGNvcHkgb2YgdGhlIGlucHV0IGRyb3BwaW5nIGEgbWF4IG51bWJlciBvZiBlbGVtZW50cyBmcm9tIHRoZSBlbmQuXG4gKlxuICogKipOb3RlKiouIGBuYCBpcyBub3JtYWxpemVkIHRvIGEgbm9uIG5lZ2F0aXZlIGludGVnZXIuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IGRyb3BSaWdodCB9IGZyb20gJ2ZwLXRzL0FycmF5J1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoZHJvcFJpZ2h0KDIpKFsxLCAyLCAzXSksIFsxXSk7XG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKGRyb3BSaWdodCg1KShbMSwgMiwgM10pLCBbXSk7XG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKGRyb3BSaWdodCgwKShbMSwgMiwgM10pLCBbMSwgMiwgM10pO1xuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChkcm9wUmlnaHQoLTIpKFsxLCAyLCAzXSksIFsxLCAyLCAzXSk7XG4gKlxuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgZHJvcFJpZ2h0ID0gZnVuY3Rpb24gKG4pIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIHJldHVybiBuIDw9IDAgfHwgaXNFbXB0eShhcykgPyBjb3B5KGFzKSA6IG4gPj0gYXMubGVuZ3RoID8gW10gOiBhcy5zbGljZSgwLCBhcy5sZW5ndGggLSBuKTtcbiAgICB9O1xufTtcbmV4cG9ydCBmdW5jdGlvbiBkcm9wTGVmdFdoaWxlKHByZWRpY2F0ZSkge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHsgcmV0dXJuIGFzLnNsaWNlKHNwYW5MZWZ0SW5kZXgoYXMsIHByZWRpY2F0ZSkpOyB9O1xufVxuLyoqXG4gKiBgZmluZEluZGV4YCByZXR1cm5zIGFuIGBPcHRpb25gIGNvbnRhaW5pbmcgdGhlIGZpcnN0IGluZGV4IGZvciB3aGljaCBhIHByZWRpY2F0ZSBob2xkcy5cbiAqIEl0IHJldHVybnMgYE5vbmVgIGlmIG5vIGVsZW1lbnQgc2F0aXNmaWVzIHRoZSBwcmVkaWNhdGUuXG4gKiBTaW1pbGFyIHRvIFtgZmluZEZpcnN0YF0oI2ZpbmRGaXJzdCkgYnV0IHJldHVybmluZyB0aGUgaW5kZXggaW5zdGVhZCBvZiB0aGUgZWxlbWVudC5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgZmluZEluZGV4IH0gZnJvbSAnZnAtdHMvQXJyYXknXG4gKiBpbXBvcnQgeyBzb21lLCBub25lIH0gZnJvbSAnZnAtdHMvT3B0aW9uJ1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoZmluZEluZGV4KChuOiBudW1iZXIpID0+IG4gPT09IDIpKFsxLCAyLCAzXSksIHNvbWUoMSkpXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKGZpbmRJbmRleCgobjogbnVtYmVyKSA9PiBuID09PSAyKShbXSksIG5vbmUpXG4gKlxuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgZmluZEluZGV4ID0gUkEuZmluZEluZGV4O1xuZXhwb3J0IGZ1bmN0aW9uIGZpbmRGaXJzdChwcmVkaWNhdGUpIHtcbiAgICByZXR1cm4gUkEuZmluZEZpcnN0KHByZWRpY2F0ZSk7XG59XG4vKipcbiAqIEdpdmVuIGEgc2VsZWN0b3IgZnVuY3Rpb24gd2hpY2ggdGFrZXMgYW4gZWxlbWVudCBhbmQgcmV0dXJucyBhbiBvcHRpb24sXG4gKiB0aGlzIGZ1bmN0aW9uIGFwcGxpZXMgdGhlIHNlbGVjdG9yIHRvIGVhY2ggZWxlbWVudCBvZiB0aGUgYXJyYXkgYW5kXG4gKiByZXR1cm5zIHRoZSBmaXJzdCBgU29tZWAgcmVzdWx0LiBPdGhlcndpc2UgaXQgcmV0dXJucyBgTm9uZWAuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IGZpbmRGaXJzdE1hcCB9IGZyb20gJ2ZwLXRzL0FycmF5J1xuICogaW1wb3J0IHsgc29tZSwgbm9uZSB9IGZyb20gJ2ZwLXRzL09wdGlvbidcbiAqXG4gKiBpbnRlcmZhY2UgUGVyc29uIHtcbiAqICAgcmVhZG9ubHkgbmFtZTogc3RyaW5nO1xuICogICByZWFkb25seSBhZ2U6IG51bWJlcjtcbiAqIH1cbiAqXG4gKiBjb25zdCBwZXJzb25zOiBBcnJheTxQZXJzb24+ID0gW1xuICogICB7IG5hbWU6IFwiSm9oblwiLCBhZ2U6IDE2IH0sXG4gKiAgIHsgbmFtZTogXCJNYXJ5XCIsIGFnZTogNDUgfSxcbiAqICAgeyBuYW1lOiBcIkpvZXlcIiwgYWdlOiAyOCB9LFxuICogXTtcbiAqXG4gKiBjb25zdCBuYW1lT2ZQZXJzb25BYm92ZTE4ID0gKHA6IFBlcnNvbikgPT4gKHAuYWdlIDw9IDE4ID8gbm9uZSA6IHNvbWUocC5uYW1lKSk7XG4gKiBjb25zdCBuYW1lT2ZQZXJzb25BYm92ZTcwID0gKHA6IFBlcnNvbikgPT4gKHAuYWdlIDw9IDcwID8gbm9uZSA6IHNvbWUocC5uYW1lKSk7XG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKGZpbmRGaXJzdE1hcChuYW1lT2ZQZXJzb25BYm92ZTE4KShwZXJzb25zKSwgc29tZShcIk1hcnlcIikpO1xuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChmaW5kRmlyc3RNYXAobmFtZU9mUGVyc29uQWJvdmU3MCkocGVyc29ucyksIG5vbmUpO1xuICpcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIGZpbmRGaXJzdE1hcCA9IFJBLmZpbmRGaXJzdE1hcDtcbmV4cG9ydCBmdW5jdGlvbiBmaW5kTGFzdChwcmVkaWNhdGUpIHtcbiAgICByZXR1cm4gUkEuZmluZExhc3QocHJlZGljYXRlKTtcbn1cbi8qKlxuICogR2l2ZW4gYSBzZWxlY3RvciBmdW5jdGlvbiB3aGljaCB0YWtlcyBhbiBlbGVtZW50IGFuZCByZXR1cm5zIGFuIG9wdGlvbixcbiAqIHRoaXMgZnVuY3Rpb24gYXBwbGllcyB0aGUgc2VsZWN0b3IgdG8gZWFjaCBlbGVtZW50IG9mIHRoZSBhcnJheSBzdGFydGluZyBmcm9tIHRoZVxuICogZW5kIGFuZCByZXR1cm5zIHRoZSBsYXN0IGBTb21lYCByZXN1bHQuIE90aGVyd2lzZSBpdCByZXR1cm5zIGBOb25lYC5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgZmluZExhc3RNYXAgfSBmcm9tICdmcC10cy9BcnJheSdcbiAqIGltcG9ydCB7IHNvbWUsIG5vbmUgfSBmcm9tICdmcC10cy9PcHRpb24nXG4gKlxuICogaW50ZXJmYWNlIFBlcnNvbiB7XG4gKiAgIHJlYWRvbmx5IG5hbWU6IHN0cmluZztcbiAqICAgcmVhZG9ubHkgYWdlOiBudW1iZXI7XG4gKiB9XG4gKlxuICogY29uc3QgcGVyc29uczogQXJyYXk8UGVyc29uPiA9IFtcbiAqICAgeyBuYW1lOiBcIkpvaG5cIiwgYWdlOiAxNiB9LFxuICogICB7IG5hbWU6IFwiTWFyeVwiLCBhZ2U6IDQ1IH0sXG4gKiAgIHsgbmFtZTogXCJKb2V5XCIsIGFnZTogMjggfSxcbiAqIF07XG4gKlxuICogY29uc3QgbmFtZU9mUGVyc29uQWJvdmUxOCA9IChwOiBQZXJzb24pID0+IChwLmFnZSA8PSAxOCA/IG5vbmUgOiBzb21lKHAubmFtZSkpO1xuICogY29uc3QgbmFtZU9mUGVyc29uQWJvdmU3MCA9IChwOiBQZXJzb24pID0+IChwLmFnZSA8PSA3MCA/IG5vbmUgOiBzb21lKHAubmFtZSkpO1xuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChmaW5kTGFzdE1hcChuYW1lT2ZQZXJzb25BYm92ZTE4KShwZXJzb25zKSwgc29tZShcIkpvZXlcIikpO1xuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChmaW5kTGFzdE1hcChuYW1lT2ZQZXJzb25BYm92ZTcwKShwZXJzb25zKSwgbm9uZSk7XG4gKlxuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgZmluZExhc3RNYXAgPSBSQS5maW5kTGFzdE1hcDtcbi8qKlxuICogUmV0dXJucyB0aGUgaW5kZXggb2YgdGhlIGxhc3QgZWxlbWVudCBvZiB0aGUgbGlzdCB3aGljaCBtYXRjaGVzIHRoZSBwcmVkaWNhdGUuXG4gKiBJdCByZXR1cm5zIGFuIGBPcHRpb25gIGNvbnRhaW5pbmcgdGhlIGluZGV4IG9yIGBOb25lYCBpZiBub3QgZm91bmQuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IGZpbmRMYXN0SW5kZXggfSBmcm9tICdmcC10cy9BcnJheSdcbiAqIGltcG9ydCB7IHNvbWUsIG5vbmUgfSBmcm9tICdmcC10cy9PcHRpb24nXG4gKlxuICogaW50ZXJmYWNlIFgge1xuICogICByZWFkb25seSBhOiBudW1iZXJcbiAqICAgcmVhZG9ubHkgYjogbnVtYmVyXG4gKiB9XG4gKiBjb25zdCB4czogQXJyYXk8WD4gPSBbeyBhOiAxLCBiOiAwIH0sIHsgYTogMSwgYjogMSB9XVxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChmaW5kTGFzdEluZGV4KCh4OiB7IHJlYWRvbmx5IGE6IG51bWJlciB9KSA9PiB4LmEgPT09IDEpKHhzKSwgc29tZSgxKSlcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoZmluZExhc3RJbmRleCgoeDogeyByZWFkb25seSBhOiBudW1iZXIgfSkgPT4geC5hID09PSA0KSh4cyksIG5vbmUpXG4gKlxuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgZmluZExhc3RJbmRleCA9IFJBLmZpbmRMYXN0SW5kZXg7XG4vKipcbiAqIFRoaXMgZnVuY3Rpb24gdGFrZXMgYW4gYXJyYXkgYW5kIG1ha2VzIGEgbmV3IGFycmF5IGNvbnRhaW5pbmcgdGhlIHNhbWUgZWxlbWVudHMuXG4gKlxuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgY29weSA9IGZ1bmN0aW9uIChhcykgeyByZXR1cm4gYXMuc2xpY2UoKTsgfTtcbi8qKlxuICogSW5zZXJ0IGFuIGVsZW1lbnQgYXQgdGhlIHNwZWNpZmllZCBpbmRleCwgY3JlYXRpbmcgYSBuZXcgYXJyYXksXG4gKiBvciByZXR1cm5pbmcgYE5vbmVgIGlmIHRoZSBpbmRleCBpcyBvdXQgb2YgYm91bmRzLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBpbnNlcnRBdCB9IGZyb20gJ2ZwLXRzL0FycmF5J1xuICogaW1wb3J0IHsgc29tZSB9IGZyb20gJ2ZwLXRzL09wdGlvbidcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKGluc2VydEF0KDIsIDUpKFsxLCAyLCAzLCA0XSksIHNvbWUoWzEsIDIsIDUsIDMsIDRdKSlcbiAqXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciBpbnNlcnRBdCA9IGZ1bmN0aW9uIChpLCBhKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykge1xuICAgICAgICByZXR1cm4gaSA8IDAgfHwgaSA+IGFzLmxlbmd0aCA/IF8ubm9uZSA6IF8uc29tZSh1bnNhZmVJbnNlcnRBdChpLCBhLCBhcykpO1xuICAgIH07XG59O1xuLyoqXG4gKiBDaGFuZ2UgdGhlIGVsZW1lbnQgYXQgdGhlIHNwZWNpZmllZCBpbmRleCwgY3JlYXRpbmcgYSBuZXcgYXJyYXksXG4gKiBvciByZXR1cm5pbmcgYE5vbmVgIGlmIHRoZSBpbmRleCBpcyBvdXQgb2YgYm91bmRzLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyB1cGRhdGVBdCB9IGZyb20gJ2ZwLXRzL0FycmF5J1xuICogaW1wb3J0IHsgc29tZSwgbm9uZSB9IGZyb20gJ2ZwLXRzL09wdGlvbidcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKHVwZGF0ZUF0KDEsIDEpKFsxLCAyLCAzXSksIHNvbWUoWzEsIDEsIDNdKSlcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwodXBkYXRlQXQoMSwgMSkoW10pLCBub25lKVxuICpcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIHVwZGF0ZUF0ID0gZnVuY3Rpb24gKGksIGEpIHsgcmV0dXJuIG1vZGlmeUF0KGksIGZ1bmN0aW9uICgpIHsgcmV0dXJuIGE7IH0pOyB9O1xuLyoqXG4gKiBEZWxldGUgdGhlIGVsZW1lbnQgYXQgdGhlIHNwZWNpZmllZCBpbmRleCwgY3JlYXRpbmcgYSBuZXcgYXJyYXksIG9yIHJldHVybmluZyBgTm9uZWAgaWYgdGhlIGluZGV4IGlzIG91dCBvZiBib3VuZHMuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IGRlbGV0ZUF0IH0gZnJvbSAnZnAtdHMvQXJyYXknXG4gKiBpbXBvcnQgeyBzb21lLCBub25lIH0gZnJvbSAnZnAtdHMvT3B0aW9uJ1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoZGVsZXRlQXQoMCkoWzEsIDIsIDNdKSwgc29tZShbMiwgM10pKVxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChkZWxldGVBdCgxKShbXSksIG5vbmUpXG4gKlxuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgZGVsZXRlQXQgPSBmdW5jdGlvbiAoaSkge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgcmV0dXJuIGlzT3V0T2ZCb3VuZChpLCBhcykgPyBfLm5vbmUgOiBfLnNvbWUodW5zYWZlRGVsZXRlQXQoaSwgYXMpKTtcbiAgICB9O1xufTtcbi8qKlxuICogQXBwbHkgYSBmdW5jdGlvbiB0byB0aGUgZWxlbWVudCBhdCB0aGUgc3BlY2lmaWVkIGluZGV4LCBjcmVhdGluZyBhIG5ldyBhcnJheSwgb3IgcmV0dXJuaW5nIGBOb25lYCBpZiB0aGUgaW5kZXggaXMgb3V0XG4gKiBvZiBib3VuZHMuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IG1vZGlmeUF0IH0gZnJvbSAnZnAtdHMvQXJyYXknXG4gKiBpbXBvcnQgeyBzb21lLCBub25lIH0gZnJvbSAnZnAtdHMvT3B0aW9uJ1xuICpcbiAqIGNvbnN0IGRvdWJsZSA9ICh4OiBudW1iZXIpOiBudW1iZXIgPT4geCAqIDJcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwobW9kaWZ5QXQoMSwgZG91YmxlKShbMSwgMiwgM10pLCBzb21lKFsxLCA0LCAzXSkpXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKG1vZGlmeUF0KDEsIGRvdWJsZSkoW10pLCBub25lKVxuICpcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIG1vZGlmeUF0ID0gZnVuY3Rpb24gKGksIGYpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIHJldHVybiBpc091dE9mQm91bmQoaSwgYXMpID8gXy5ub25lIDogXy5zb21lKHVuc2FmZVVwZGF0ZUF0KGksIGYoYXNbaV0pLCBhcykpO1xuICAgIH07XG59O1xuLyoqXG4gKiBSZXZlcnNlIGFuIGFycmF5LCBjcmVhdGluZyBhIG5ldyBhcnJheVxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyByZXZlcnNlIH0gZnJvbSAnZnAtdHMvQXJyYXknXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChyZXZlcnNlKFsxLCAyLCAzXSksIFszLCAyLCAxXSlcbiAqXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciByZXZlcnNlID0gZnVuY3Rpb24gKGFzKSB7IHJldHVybiAoaXNFbXB0eShhcykgPyBbXSA6IGFzLnNsaWNlKCkucmV2ZXJzZSgpKTsgfTtcbi8qKlxuICogVGFrZXMgYW4gYEFycmF5YCBvZiBgRWl0aGVyYCBhbmQgcHJvZHVjZXMgYSBuZXcgYEFycmF5YCBjb250YWluaW5nXG4gKiB0aGUgdmFsdWVzIG9mIGFsbCB0aGUgYFJpZ2h0YCBlbGVtZW50cyBpbiB0aGUgc2FtZSBvcmRlci5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgcmlnaHRzIH0gZnJvbSAnZnAtdHMvQXJyYXknXG4gKiBpbXBvcnQgeyByaWdodCwgbGVmdCB9IGZyb20gJ2ZwLXRzL0VpdGhlcidcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKHJpZ2h0cyhbcmlnaHQoMSksIGxlZnQoJ2ZvbycpLCByaWdodCgyKV0pLCBbMSwgMl0pXG4gKlxuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgcmlnaHRzID0gZnVuY3Rpb24gKGFzKSB7XG4gICAgdmFyIHIgPSBbXTtcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IGFzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIHZhciBhID0gYXNbaV07XG4gICAgICAgIGlmIChhLl90YWcgPT09ICdSaWdodCcpIHtcbiAgICAgICAgICAgIHIucHVzaChhLnJpZ2h0KTtcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gcjtcbn07XG4vKipcbiAqIFRha2VzIGFuIGBBcnJheWAgb2YgYEVpdGhlcmAgYW5kIHByb2R1Y2VzIGEgbmV3IGBBcnJheWAgY29udGFpbmluZ1xuICogdGhlIHZhbHVlcyBvZiBhbGwgdGhlIGBMZWZ0YCBlbGVtZW50cyBpbiB0aGUgc2FtZSBvcmRlci5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgbGVmdHMgfSBmcm9tICdmcC10cy9BcnJheSdcbiAqIGltcG9ydCB7IGxlZnQsIHJpZ2h0IH0gZnJvbSAnZnAtdHMvRWl0aGVyJ1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwobGVmdHMoW3JpZ2h0KDEpLCBsZWZ0KCdmb28nKSwgcmlnaHQoMildKSwgWydmb28nXSlcbiAqXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciBsZWZ0cyA9IGZ1bmN0aW9uIChhcykge1xuICAgIHZhciByID0gW107XG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBhcy5sZW5ndGg7IGkrKykge1xuICAgICAgICB2YXIgYSA9IGFzW2ldO1xuICAgICAgICBpZiAoYS5fdGFnID09PSAnTGVmdCcpIHtcbiAgICAgICAgICAgIHIucHVzaChhLmxlZnQpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiByO1xufTtcbi8qKlxuICogU29ydCB0aGUgZWxlbWVudHMgb2YgYW4gYXJyYXkgaW4gaW5jcmVhc2luZyBvcmRlciwgY3JlYXRpbmcgYSBuZXcgYXJyYXlcbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgc29ydCB9IGZyb20gJ2ZwLXRzL0FycmF5J1xuICogaW1wb3J0ICogYXMgTiBmcm9tICdmcC10cy9udW1iZXInXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChzb3J0KE4uT3JkKShbMywgMiwgMV0pLCBbMSwgMiwgM10pXG4gKlxuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgc29ydCA9IGZ1bmN0aW9uIChPKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykge1xuICAgICAgICByZXR1cm4gYXMubGVuZ3RoIDw9IDEgPyBjb3B5KGFzKSA6IGFzLnNsaWNlKCkuc29ydChPLmNvbXBhcmUpO1xuICAgIH07XG59O1xuLyoqXG4gKiBBcHBseSBhIGZ1bmN0aW9uIHRvIHBhaXJzIG9mIGVsZW1lbnRzIGF0IHRoZSBzYW1lIGluZGV4IGluIHR3byBhcnJheXMsIGNvbGxlY3RpbmcgdGhlIHJlc3VsdHMgaW4gYSBuZXcgYXJyYXkuIElmIG9uZVxuICogaW5wdXQgYXJyYXkgaXMgc2hvcnQsIGV4Y2VzcyBlbGVtZW50cyBvZiB0aGUgbG9uZ2VyIGFycmF5IGFyZSBkaXNjYXJkZWQuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IHppcFdpdGggfSBmcm9tICdmcC10cy9BcnJheSdcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKHppcFdpdGgoWzEsIDIsIDNdLCBbJ2EnLCAnYicsICdjJywgJ2QnXSwgKG4sIHMpID0+IHMgKyBuKSwgWydhMScsICdiMicsICdjMyddKVxuICpcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIHppcFdpdGggPSBmdW5jdGlvbiAoZmEsIGZiLCBmKSB7XG4gICAgdmFyIGZjID0gW107XG4gICAgdmFyIGxlbiA9IE1hdGgubWluKGZhLmxlbmd0aCwgZmIubGVuZ3RoKTtcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IGxlbjsgaSsrKSB7XG4gICAgICAgIGZjW2ldID0gZihmYVtpXSwgZmJbaV0pO1xuICAgIH1cbiAgICByZXR1cm4gZmM7XG59O1xuZXhwb3J0IGZ1bmN0aW9uIHppcChhcywgYnMpIHtcbiAgICBpZiAoYnMgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICByZXR1cm4gZnVuY3Rpb24gKGJzKSB7IHJldHVybiB6aXAoYnMsIGFzKTsgfTtcbiAgICB9XG4gICAgcmV0dXJuIHppcFdpdGgoYXMsIGJzLCBmdW5jdGlvbiAoYSwgYikgeyByZXR1cm4gW2EsIGJdOyB9KTtcbn1cbi8qKlxuICogVGhlIGZ1bmN0aW9uIGlzIHJldmVyc2Ugb2YgYHppcGAuIFRha2VzIGFuIGFycmF5IG9mIHBhaXJzIGFuZCByZXR1cm4gdHdvIGNvcnJlc3BvbmRpbmcgYXJyYXlzXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IHVuemlwIH0gZnJvbSAnZnAtdHMvQXJyYXknXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbCh1bnppcChbWzEsICdhJ10sIFsyLCAnYiddLCBbMywgJ2MnXV0pLCBbWzEsIDIsIDNdLCBbJ2EnLCAnYicsICdjJ11dKVxuICpcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIHVuemlwID0gZnVuY3Rpb24gKGFzKSB7XG4gICAgdmFyIGZhID0gW107XG4gICAgdmFyIGZiID0gW107XG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBhcy5sZW5ndGg7IGkrKykge1xuICAgICAgICBmYVtpXSA9IGFzW2ldWzBdO1xuICAgICAgICBmYltpXSA9IGFzW2ldWzFdO1xuICAgIH1cbiAgICByZXR1cm4gW2ZhLCBmYl07XG59O1xuLyoqXG4gKiBDcmVhdGVzIGEgbmV3IGBBcnJheWAsIHByZXBlbmRpbmcgYW4gZWxlbWVudCB0byBldmVyeSBtZW1iZXIgb2YgdGhlIGlucHV0IGBBcnJheWAuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IHByZXBlbmRBbGwgfSBmcm9tICdmcC10cy9BcnJheSdcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKHByZXBlbmRBbGwoOSkoWzEsIDIsIDMsIDRdKSwgWzksIDEsIDksIDIsIDksIDMsIDksIDRdKVxuICpcbiAqIEBzaW5jZSAyLjEwLjBcbiAqL1xuZXhwb3J0IHZhciBwcmVwZW5kQWxsID0gZnVuY3Rpb24gKG1pZGRsZSkge1xuICAgIHZhciBmID0gTkVBLnByZXBlbmRBbGwobWlkZGxlKTtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7IHJldHVybiAoaXNOb25FbXB0eShhcykgPyBmKGFzKSA6IFtdKTsgfTtcbn07XG4vKipcbiAqIENyZWF0ZXMgYSBuZXcgYEFycmF5YCBwbGFjaW5nIGFuIGVsZW1lbnQgaW4gYmV0d2VlbiBtZW1iZXJzIG9mIHRoZSBpbnB1dCBgQXJyYXlgLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBpbnRlcnNwZXJzZSB9IGZyb20gJ2ZwLXRzL0FycmF5J1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoaW50ZXJzcGVyc2UoOSkoWzEsIDIsIDMsIDRdKSwgWzEsIDksIDIsIDksIDMsIDksIDRdKVxuICpcbiAqIEBzaW5jZSAyLjkuMFxuICovXG5leHBvcnQgdmFyIGludGVyc3BlcnNlID0gZnVuY3Rpb24gKG1pZGRsZSkge1xuICAgIHZhciBmID0gTkVBLmludGVyc3BlcnNlKG1pZGRsZSk7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykgeyByZXR1cm4gKGlzTm9uRW1wdHkoYXMpID8gZihhcykgOiBjb3B5KGFzKSk7IH07XG59O1xuLyoqXG4gKiBDcmVhdGVzIGEgbmV3IGBBcnJheWAgcm90YXRpbmcgdGhlIGlucHV0IGBBcnJheWAgYnkgYG5gIHN0ZXBzLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyByb3RhdGUgfSBmcm9tICdmcC10cy9BcnJheSdcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKHJvdGF0ZSgyKShbMSwgMiwgMywgNCwgNV0pLCBbNCwgNSwgMSwgMiwgM10pXG4gKlxuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgcm90YXRlID0gZnVuY3Rpb24gKG4pIHtcbiAgICB2YXIgZiA9IE5FQS5yb3RhdGUobik7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykgeyByZXR1cm4gKGlzTm9uRW1wdHkoYXMpID8gZihhcykgOiBjb3B5KGFzKSk7IH07XG59O1xuLy8gVE9ETzogcmVtb3ZlIG5vbi1jdXJyaWVkIG92ZXJsb2FkaW5nIGluIHYzXG4vKipcbiAqIFRlc3QgaWYgYSB2YWx1ZSBpcyBhIG1lbWJlciBvZiBhbiBgQXJyYXlgLiBUYWtlcyBhIGBFcTxBPmAgYXMgYSBzaW5nbGVcbiAqIGFyZ3VtZW50IHdoaWNoIHJldHVybnMgdGhlIGZ1bmN0aW9uIHRvIHVzZSB0byBzZWFyY2ggZm9yIGEgdmFsdWUgb2YgdHlwZSBgQWAgaW5cbiAqIGFuIGBBcnJheTxBPmAuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IGVsZW0gfSBmcm9tICdmcC10cy9BcnJheSdcbiAqIGltcG9ydCAqIGFzIE4gZnJvbSAnZnAtdHMvbnVtYmVyJ1xuICogaW1wb3J0IHsgcGlwZSB9IGZyb20gJ2ZwLXRzL2Z1bmN0aW9uJ1xuICpcbiAqIGFzc2VydC5zdHJpY3RFcXVhbChwaXBlKFsxLCAyLCAzXSwgZWxlbShOLkVxKSgyKSksIHRydWUpXG4gKiBhc3NlcnQuc3RyaWN0RXF1YWwocGlwZShbMSwgMiwgM10sIGVsZW0oTi5FcSkoMCkpLCBmYWxzZSlcbiAqXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciBlbGVtID0gUkEuZWxlbTtcbi8qKlxuICogQ3JlYXRlcyBhIG5ldyBgQXJyYXlgIHJlbW92aW5nIGR1cGxpY2F0ZSBlbGVtZW50cywga2VlcGluZyB0aGUgZmlyc3Qgb2NjdXJyZW5jZSBvZiBhbiBlbGVtZW50LFxuICogYmFzZWQgb24gYSBgRXE8QT5gLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyB1bmlxIH0gZnJvbSAnZnAtdHMvQXJyYXknXG4gKiBpbXBvcnQgKiBhcyBOIGZyb20gJ2ZwLXRzL251bWJlcidcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKHVuaXEoTi5FcSkoWzEsIDIsIDFdKSwgWzEsIDJdKVxuICpcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIHVuaXEgPSBmdW5jdGlvbiAoRSkge1xuICAgIHZhciBmID0gTkVBLnVuaXEoRSk7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykgeyByZXR1cm4gKGlzTm9uRW1wdHkoYXMpID8gZihhcykgOiBjb3B5KGFzKSk7IH07XG59O1xuLyoqXG4gKiBTb3J0IHRoZSBlbGVtZW50cyBvZiBhbiBhcnJheSBpbiBpbmNyZWFzaW5nIG9yZGVyLCB3aGVyZSBlbGVtZW50cyBhcmUgY29tcGFyZWQgdXNpbmcgZmlyc3QgYG9yZHNbMF1gLCB0aGVuIGBvcmRzWzFdYCxcbiAqIGV0Yy4uLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBzb3J0QnkgfSBmcm9tICdmcC10cy9BcnJheSdcbiAqIGltcG9ydCB7IGNvbnRyYW1hcCB9IGZyb20gJ2ZwLXRzL09yZCdcbiAqIGltcG9ydCAqIGFzIFMgZnJvbSAnZnAtdHMvc3RyaW5nJ1xuICogaW1wb3J0ICogYXMgTiBmcm9tICdmcC10cy9udW1iZXInXG4gKiBpbXBvcnQgeyBwaXBlIH0gZnJvbSAnZnAtdHMvZnVuY3Rpb24nXG4gKlxuICogaW50ZXJmYWNlIFBlcnNvbiB7XG4gKiAgIHJlYWRvbmx5IG5hbWU6IHN0cmluZ1xuICogICByZWFkb25seSBhZ2U6IG51bWJlclxuICogfVxuICogY29uc3QgYnlOYW1lID0gcGlwZShTLk9yZCwgY29udHJhbWFwKChwOiBQZXJzb24pID0+IHAubmFtZSkpXG4gKiBjb25zdCBieUFnZSA9IHBpcGUoTi5PcmQsIGNvbnRyYW1hcCgocDogUGVyc29uKSA9PiBwLmFnZSkpXG4gKlxuICogY29uc3Qgc29ydEJ5TmFtZUJ5QWdlID0gc29ydEJ5KFtieU5hbWUsIGJ5QWdlXSlcbiAqXG4gKiBjb25zdCBwZXJzb25zID0gW3sgbmFtZTogJ2EnLCBhZ2U6IDEgfSwgeyBuYW1lOiAnYicsIGFnZTogMyB9LCB7IG5hbWU6ICdjJywgYWdlOiAyIH0sIHsgbmFtZTogJ2InLCBhZ2U6IDIgfV1cbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoc29ydEJ5TmFtZUJ5QWdlKHBlcnNvbnMpLCBbXG4gKiAgIHsgbmFtZTogJ2EnLCBhZ2U6IDEgfSxcbiAqICAgeyBuYW1lOiAnYicsIGFnZTogMiB9LFxuICogICB7IG5hbWU6ICdiJywgYWdlOiAzIH0sXG4gKiAgIHsgbmFtZTogJ2MnLCBhZ2U6IDIgfVxuICogXSlcbiAqXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciBzb3J0QnkgPSBmdW5jdGlvbiAob3Jkcykge1xuICAgIHZhciBmID0gTkVBLnNvcnRCeShvcmRzKTtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7IHJldHVybiAoaXNOb25FbXB0eShhcykgPyBmKGFzKSA6IGNvcHkoYXMpKTsgfTtcbn07XG4vKipcbiAqIEEgdXNlZnVsIHJlY3Vyc2lvbiBwYXR0ZXJuIGZvciBwcm9jZXNzaW5nIGFuIGFycmF5IHRvIHByb2R1Y2UgYSBuZXcgYXJyYXksIG9mdGVuIHVzZWQgZm9yIFwiY2hvcHBpbmdcIiB1cCB0aGUgaW5wdXRcbiAqIGFycmF5LiBUeXBpY2FsbHkgY2hvcCBpcyBjYWxsZWQgd2l0aCBzb21lIGZ1bmN0aW9uIHRoYXQgd2lsbCBjb25zdW1lIGFuIGluaXRpYWwgcHJlZml4IG9mIHRoZSBhcnJheSBhbmQgcHJvZHVjZSBhXG4gKiB2YWx1ZSBhbmQgdGhlIHJlc3Qgb2YgdGhlIGFycmF5LlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBFcSB9IGZyb20gJ2ZwLXRzL0VxJ1xuICogaW1wb3J0ICogYXMgQSBmcm9tICdmcC10cy9BcnJheSdcbiAqIGltcG9ydCAqIGFzIE4gZnJvbSAnZnAtdHMvbnVtYmVyJ1xuICogaW1wb3J0IHsgcGlwZSB9IGZyb20gJ2ZwLXRzL2Z1bmN0aW9uJ1xuICpcbiAqIGNvbnN0IGdyb3VwID0gPEE+KFM6IEVxPEE+KTogKChhczogQXJyYXk8QT4pID0+IEFycmF5PEFycmF5PEE+PikgPT4ge1xuICogICByZXR1cm4gQS5jaG9wKGFzID0+IHtcbiAqICAgICBjb25zdCB7IGluaXQsIHJlc3QgfSA9IHBpcGUoYXMsIEEuc3BhbkxlZnQoKGE6IEEpID0+IFMuZXF1YWxzKGEsIGFzWzBdKSkpXG4gKiAgICAgcmV0dXJuIFtpbml0LCByZXN0XVxuICogICB9KVxuICogfVxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChncm91cChOLkVxKShbMSwgMSwgMiwgMywgMywgNF0pLCBbWzEsIDFdLCBbMl0sIFszLCAzXSwgWzRdXSlcbiAqXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciBjaG9wID0gZnVuY3Rpb24gKGYpIHtcbiAgICB2YXIgZyA9IE5FQS5jaG9wKGYpO1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHsgcmV0dXJuIChpc05vbkVtcHR5KGFzKSA/IGcoYXMpIDogW10pOyB9O1xufTtcbi8qKlxuICogU3BsaXRzIGFuIGBBcnJheWAgaW50byB0d28gcGllY2VzLCB0aGUgZmlyc3QgcGllY2UgaGFzIG1heCBgbmAgZWxlbWVudHMuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IHNwbGl0QXQgfSBmcm9tICdmcC10cy9BcnJheSdcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKHNwbGl0QXQoMikoWzEsIDIsIDMsIDQsIDVdKSwgW1sxLCAyXSwgWzMsIDQsIDVdXSlcbiAqXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciBzcGxpdEF0ID0gZnVuY3Rpb24gKG4pIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIHJldHVybiBuID49IDEgJiYgaXNOb25FbXB0eShhcykgPyBORUEuc3BsaXRBdChuKShhcykgOiBpc0VtcHR5KGFzKSA/IFtjb3B5KGFzKSwgW11dIDogW1tdLCBjb3B5KGFzKV07XG4gICAgfTtcbn07XG4vKipcbiAqIFNwbGl0cyBhbiBhcnJheSBpbnRvIGxlbmd0aC1gbmAgcGllY2VzLiBUaGUgbGFzdCBwaWVjZSB3aWxsIGJlIHNob3J0ZXIgaWYgYG5gIGRvZXMgbm90IGV2ZW5seSBkaXZpZGUgdGhlIGxlbmd0aCBvZlxuICogdGhlIGFycmF5LiBOb3RlIHRoYXQgYGNodW5rc09mKG4pKFtdKWAgaXMgYFtdYCwgbm90IGBbW11dYC4gVGhpcyBpcyBpbnRlbnRpb25hbCwgYW5kIGlzIGNvbnNpc3RlbnQgd2l0aCBhIHJlY3Vyc2l2ZVxuICogZGVmaW5pdGlvbiBvZiBgY2h1bmtzT2ZgOyBpdCBzYXRpc2ZpZXMgdGhlIHByb3BlcnR5IHRoYXRcbiAqXG4gKiBgYGB0c1xuICogY2h1bmtzT2YobikoeHMpLmNvbmNhdChjaHVua3NPZihuKSh5cykpID09IGNodW5rc09mKG4pKHhzLmNvbmNhdCh5cykpKVxuICogYGBgXG4gKlxuICogd2hlbmV2ZXIgYG5gIGV2ZW5seSBkaXZpZGVzIHRoZSBsZW5ndGggb2YgYHhzYC5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgY2h1bmtzT2YgfSBmcm9tICdmcC10cy9BcnJheSdcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKGNodW5rc09mKDIpKFsxLCAyLCAzLCA0LCA1XSksIFtbMSwgMl0sIFszLCA0XSwgWzVdXSlcbiAqXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciBjaHVua3NPZiA9IGZ1bmN0aW9uIChuKSB7XG4gICAgdmFyIGYgPSBORUEuY2h1bmtzT2Yobik7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykgeyByZXR1cm4gKGlzTm9uRW1wdHkoYXMpID8gZihhcykgOiBbXSk7IH07XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgbGlmdGluZ1xuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIGZyb21PcHRpb25LID0gZnVuY3Rpb24gKGYpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgYSA9IFtdO1xuICAgICAgICBmb3IgKHZhciBfaSA9IDA7IF9pIDwgYXJndW1lbnRzLmxlbmd0aDsgX2krKykge1xuICAgICAgICAgICAgYVtfaV0gPSBhcmd1bWVudHNbX2ldO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBmcm9tT3B0aW9uKGYuYXBwbHkodm9pZCAwLCBhKSk7XG4gICAgfTtcbn07XG5leHBvcnQgZnVuY3Rpb24gY29tcHJlaGVuc2lvbihpbnB1dCwgZiwgZykge1xuICAgIGlmIChnID09PSB2b2lkIDApIHsgZyA9IGZ1bmN0aW9uICgpIHsgcmV0dXJuIHRydWU7IH07IH1cbiAgICB2YXIgZ28gPSBmdW5jdGlvbiAoc2NvcGUsIGlucHV0KSB7XG4gICAgICAgIHJldHVybiBpc05vbkVtcHR5KGlucHV0KVxuICAgICAgICAgICAgPyBmbGF0TWFwKE5FQS5oZWFkKGlucHV0KSwgZnVuY3Rpb24gKGEpIHsgcmV0dXJuIGdvKHBpcGUoc2NvcGUsIGFwcGVuZChhKSksIE5FQS50YWlsKGlucHV0KSk7IH0pXG4gICAgICAgICAgICA6IGcuYXBwbHkodm9pZCAwLCBzY29wZSkgPyBbZi5hcHBseSh2b2lkIDAsIHNjb3BlKV1cbiAgICAgICAgICAgICAgICA6IFtdO1xuICAgIH07XG4gICAgcmV0dXJuIGdvKFtdLCBpbnB1dCk7XG59XG4vKipcbiAqIEBzaW5jZSAyLjExLjBcbiAqL1xuZXhwb3J0IHZhciBjb25jYXRXID0gZnVuY3Rpb24gKHNlY29uZCkge1xuICAgIHJldHVybiBmdW5jdGlvbiAoZmlyc3QpIHtcbiAgICAgICAgcmV0dXJuIGlzRW1wdHkoZmlyc3QpID8gY29weShzZWNvbmQpIDogaXNFbXB0eShzZWNvbmQpID8gY29weShmaXJzdCkgOiBmaXJzdC5jb25jYXQoc2Vjb25kKTtcbiAgICB9O1xufTtcbi8qKlxuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIGNvbmNhdCA9IGNvbmNhdFc7XG5leHBvcnQgZnVuY3Rpb24gdW5pb24oRSkge1xuICAgIHZhciB1bmlvbkUgPSBORUEudW5pb24oRSk7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChmaXJzdCwgc2Vjb25kKSB7XG4gICAgICAgIGlmIChzZWNvbmQgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgdmFyIHVuaW9uRV8xID0gdW5pb24oRSk7XG4gICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24gKHNlY29uZCkgeyByZXR1cm4gdW5pb25FXzEoc2Vjb25kLCBmaXJzdCk7IH07XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGlzTm9uRW1wdHkoZmlyc3QpICYmIGlzTm9uRW1wdHkoc2Vjb25kKVxuICAgICAgICAgICAgPyB1bmlvbkUoc2Vjb25kKShmaXJzdClcbiAgICAgICAgICAgIDogaXNOb25FbXB0eShmaXJzdClcbiAgICAgICAgICAgICAgICA/IGNvcHkoZmlyc3QpXG4gICAgICAgICAgICAgICAgOiBjb3B5KHNlY29uZCk7XG4gICAgfTtcbn1cbmV4cG9ydCBmdW5jdGlvbiBpbnRlcnNlY3Rpb24oRSkge1xuICAgIHZhciBlbGVtRSA9IGVsZW0oRSk7XG4gICAgcmV0dXJuIGZ1bmN0aW9uICh4cywgeXMpIHtcbiAgICAgICAgaWYgKHlzID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIHZhciBpbnRlcnNlY3Rpb25FXzEgPSBpbnRlcnNlY3Rpb24oRSk7XG4gICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24gKHlzKSB7IHJldHVybiBpbnRlcnNlY3Rpb25FXzEoeXMsIHhzKTsgfTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4geHMuZmlsdGVyKGZ1bmN0aW9uIChhKSB7IHJldHVybiBlbGVtRShhLCB5cyk7IH0pO1xuICAgIH07XG59XG5leHBvcnQgZnVuY3Rpb24gZGlmZmVyZW5jZShFKSB7XG4gICAgdmFyIGVsZW1FID0gZWxlbShFKTtcbiAgICByZXR1cm4gZnVuY3Rpb24gKHhzLCB5cykge1xuICAgICAgICBpZiAoeXMgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgdmFyIGRpZmZlcmVuY2VFXzEgPSBkaWZmZXJlbmNlKEUpO1xuICAgICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uICh5cykgeyByZXR1cm4gZGlmZmVyZW5jZUVfMSh5cywgeHMpOyB9O1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB4cy5maWx0ZXIoZnVuY3Rpb24gKGEpIHsgcmV0dXJuICFlbGVtRShhLCB5cyk7IH0pO1xuICAgIH07XG59XG52YXIgX21hcCA9IGZ1bmN0aW9uIChmYSwgZikgeyByZXR1cm4gcGlwZShmYSwgbWFwKGYpKTsgfTtcbi8qIGlzdGFuYnVsIGlnbm9yZSBuZXh0ICovXG52YXIgX21hcFdpdGhJbmRleCA9IGZ1bmN0aW9uIChmYSwgZikgeyByZXR1cm4gcGlwZShmYSwgbWFwV2l0aEluZGV4KGYpKTsgfTtcbnZhciBfYXAgPSBmdW5jdGlvbiAoZmFiLCBmYSkgeyByZXR1cm4gcGlwZShmYWIsIGFwKGZhKSk7IH07XG4vKiBpc3RhbmJ1bCBpZ25vcmUgbmV4dCAqL1xudmFyIF9maWx0ZXIgPSBmdW5jdGlvbiAoZmEsIHByZWRpY2F0ZSkgeyByZXR1cm4gcGlwZShmYSwgZmlsdGVyKHByZWRpY2F0ZSkpOyB9O1xuLyogaXN0YW5idWwgaWdub3JlIG5leHQgKi9cbnZhciBfZmlsdGVyTWFwID0gZnVuY3Rpb24gKGZhLCBmKSB7IHJldHVybiBwaXBlKGZhLCBmaWx0ZXJNYXAoZikpOyB9O1xuLyogaXN0YW5idWwgaWdub3JlIG5leHQgKi9cbnZhciBfcGFydGl0aW9uID0gZnVuY3Rpb24gKGZhLCBwcmVkaWNhdGUpIHtcbiAgICByZXR1cm4gcGlwZShmYSwgcGFydGl0aW9uKHByZWRpY2F0ZSkpO1xufTtcbi8qIGlzdGFuYnVsIGlnbm9yZSBuZXh0ICovXG52YXIgX3BhcnRpdGlvbk1hcCA9IGZ1bmN0aW9uIChmYSwgZikgeyByZXR1cm4gcGlwZShmYSwgcGFydGl0aW9uTWFwKGYpKTsgfTtcbi8qIGlzdGFuYnVsIGlnbm9yZSBuZXh0ICovXG52YXIgX3BhcnRpdGlvbldpdGhJbmRleCA9IGZ1bmN0aW9uIChmYSwgcHJlZGljYXRlV2l0aEluZGV4KSB7IHJldHVybiBwaXBlKGZhLCBwYXJ0aXRpb25XaXRoSW5kZXgocHJlZGljYXRlV2l0aEluZGV4KSk7IH07XG4vKiBpc3RhbmJ1bCBpZ25vcmUgbmV4dCAqL1xudmFyIF9wYXJ0aXRpb25NYXBXaXRoSW5kZXggPSBmdW5jdGlvbiAoZmEsIGYpIHsgcmV0dXJuIHBpcGUoZmEsIHBhcnRpdGlvbk1hcFdpdGhJbmRleChmKSk7IH07XG4vKiBpc3RhbmJ1bCBpZ25vcmUgbmV4dCAqL1xudmFyIF9hbHQgPSBmdW5jdGlvbiAoZmEsIHRoYXQpIHsgcmV0dXJuIHBpcGUoZmEsIGFsdCh0aGF0KSk7IH07XG52YXIgX3JlZHVjZSA9IGZ1bmN0aW9uIChmYSwgYiwgZikgeyByZXR1cm4gcGlwZShmYSwgcmVkdWNlKGIsIGYpKTsgfTtcbi8qIGlzdGFuYnVsIGlnbm9yZSBuZXh0ICovXG52YXIgX2ZvbGRNYXAgPSBmdW5jdGlvbiAoTSkge1xuICAgIHZhciBmb2xkTWFwTSA9IGZvbGRNYXAoTSk7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChmYSwgZikgeyByZXR1cm4gcGlwZShmYSwgZm9sZE1hcE0oZikpOyB9O1xufTtcbi8qIGlzdGFuYnVsIGlnbm9yZSBuZXh0ICovXG52YXIgX3JlZHVjZVJpZ2h0ID0gZnVuY3Rpb24gKGZhLCBiLCBmKSB7IHJldHVybiBwaXBlKGZhLCByZWR1Y2VSaWdodChiLCBmKSk7IH07XG4vKiBpc3RhbmJ1bCBpZ25vcmUgbmV4dCAqL1xudmFyIF9yZWR1Y2VXaXRoSW5kZXggPSBmdW5jdGlvbiAoZmEsIGIsIGYpIHtcbiAgICByZXR1cm4gcGlwZShmYSwgcmVkdWNlV2l0aEluZGV4KGIsIGYpKTtcbn07XG4vKiBpc3RhbmJ1bCBpZ25vcmUgbmV4dCAqL1xudmFyIF9mb2xkTWFwV2l0aEluZGV4ID0gZnVuY3Rpb24gKE0pIHtcbiAgICB2YXIgZm9sZE1hcFdpdGhJbmRleE0gPSBmb2xkTWFwV2l0aEluZGV4KE0pO1xuICAgIHJldHVybiBmdW5jdGlvbiAoZmEsIGYpIHsgcmV0dXJuIHBpcGUoZmEsIGZvbGRNYXBXaXRoSW5kZXhNKGYpKTsgfTtcbn07XG4vKiBpc3RhbmJ1bCBpZ25vcmUgbmV4dCAqL1xudmFyIF9yZWR1Y2VSaWdodFdpdGhJbmRleCA9IGZ1bmN0aW9uIChmYSwgYiwgZikge1xuICAgIHJldHVybiBwaXBlKGZhLCByZWR1Y2VSaWdodFdpdGhJbmRleChiLCBmKSk7XG59O1xuLyogaXN0YW5idWwgaWdub3JlIG5leHQgKi9cbnZhciBfZmlsdGVyTWFwV2l0aEluZGV4ID0gZnVuY3Rpb24gKGZhLCBmKSB7IHJldHVybiBwaXBlKGZhLCBmaWx0ZXJNYXBXaXRoSW5kZXgoZikpOyB9O1xuLyogaXN0YW5idWwgaWdub3JlIG5leHQgKi9cbnZhciBfZmlsdGVyV2l0aEluZGV4ID0gZnVuY3Rpb24gKGZhLCBwcmVkaWNhdGVXaXRoSW5kZXgpIHsgcmV0dXJuIHBpcGUoZmEsIGZpbHRlcldpdGhJbmRleChwcmVkaWNhdGVXaXRoSW5kZXgpKTsgfTtcbi8qIGlzdGFuYnVsIGlnbm9yZSBuZXh0ICovXG52YXIgX2V4dGVuZCA9IGZ1bmN0aW9uIChmYSwgZikgeyByZXR1cm4gcGlwZShmYSwgZXh0ZW5kKGYpKTsgfTtcbi8qIGlzdGFuYnVsIGlnbm9yZSBuZXh0ICovXG52YXIgX3RyYXZlcnNlID0gZnVuY3Rpb24gKEYpIHtcbiAgICB2YXIgdHJhdmVyc2VGID0gdHJhdmVyc2UoRik7XG4gICAgcmV0dXJuIGZ1bmN0aW9uICh0YSwgZikgeyByZXR1cm4gcGlwZSh0YSwgdHJhdmVyc2VGKGYpKTsgfTtcbn07XG4vKiBpc3RhbmJ1bCBpZ25vcmUgbmV4dCAqL1xudmFyIF90cmF2ZXJzZVdpdGhJbmRleCA9IGZ1bmN0aW9uIChGKSB7XG4gICAgdmFyIHRyYXZlcnNlV2l0aEluZGV4RiA9IHRyYXZlcnNlV2l0aEluZGV4KEYpO1xuICAgIHJldHVybiBmdW5jdGlvbiAodGEsIGYpIHsgcmV0dXJuIHBpcGUodGEsIHRyYXZlcnNlV2l0aEluZGV4RihmKSk7IH07XG59O1xudmFyIF9jaGFpblJlY0RlcHRoRmlyc3QgPSBSQS5fY2hhaW5SZWNEZXB0aEZpcnN0O1xudmFyIF9jaGFpblJlY0JyZWFkdGhGaXJzdCA9IFJBLl9jaGFpblJlY0JyZWFkdGhGaXJzdDtcbi8qKlxuICogR2l2ZW4gYW4gZWxlbWVudCBvZiB0aGUgYmFzZSB0eXBlLCBgb2ZgIGJ1aWxkcyBhbiBgQXJyYXlgIGNvbnRhaW5pbmcganVzdCB0aGF0XG4gKiBlbGVtZW50IG9mIHRoZSBiYXNlIHR5cGUgKHRoaXMgaXMgdXNlZnVsIGZvciBidWlsZGluZyBhIGBNb25hZGApLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBvZiB9IGZyb20gJ2ZwLXRzL0FycmF5J1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwob2YoXCJhXCIpLCBbXCJhXCJdKTtcbiAqXG4gKiBAY2F0ZWdvcnkgY29uc3RydWN0b3JzXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciBvZiA9IE5FQS5vZjtcbi8qKlxuICogTWFrZXMgYW4gZW1wdHkgYEFycmF5YCwgdXNlZnVsIGZvciBidWlsZGluZyBhIFtgTW9ub2lkYF0oI01vbm9pZClcbiAqXG4gKiBAc2luY2UgMi43LjBcbiAqL1xuZXhwb3J0IHZhciB6ZXJvID0gZnVuY3Rpb24gKCkgeyByZXR1cm4gW107IH07XG4vKipcbiAqIGBtYXBgIGNhbiBiZSB1c2VkIHRvIHR1cm4gZnVuY3Rpb25zIGAoYTogQSkgPT4gQmAgaW50byBmdW5jdGlvbnMgYChmYTogQXJyYXk8QT4pID0+IEFycmF5PEI+YC5cbiAqIEluIHByYWN0aWNlIGl0IGFwcGxpZXMgdGhlIGJhc2UgZnVuY3Rpb24gdG8gZWFjaCBlbGVtZW50IG9mIHRoZSBhcnJheSBhbmQgY29sbGVjdHMgdGhlXG4gKiByZXN1bHRzIGluIGEgbmV3IGFycmF5LlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBtYXAgfSBmcm9tICdmcC10cy9BcnJheSdcbiAqIGltcG9ydCB7IHBpcGUgfSBmcm9tICdmcC10cy9mdW5jdGlvbidcbiAqXG4gKiBjb25zdCBmID0gKG46IG51bWJlcikgPT4gbiAqIDI7XG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKHBpcGUoWzEsIDIsIDNdLCBtYXAoZikpLCBbMiwgNCwgNl0pO1xuICpcbiAqIEBjYXRlZ29yeSBtYXBwaW5nXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciBtYXAgPSBmdW5jdGlvbiAoZikgeyByZXR1cm4gZnVuY3Rpb24gKGZhKSB7IHJldHVybiBmYS5tYXAoZnVuY3Rpb24gKGEpIHsgcmV0dXJuIGYoYSk7IH0pOyB9OyB9O1xuLyoqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgYXAsIG1hcCwgb2YgfSBmcm9tICdmcC10cy9BcnJheSdcbiAqIGltcG9ydCB7IHBpcGUgfSBmcm9tICdmcC10cy9mdW5jdGlvbidcbiAqXG4gKiAvLyBhIGN1cnJpZWQgZnVuY3Rpb24gd2l0aCAzIGlucHV0IHBhcmFtZXRlcmVzXG4gKiBjb25zdCBmID0gKHMxOiBzdHJpbmcpID0+IChuOiBudW1iZXIpID0+IChzMjogc3RyaW5nKSA9PiBzMSArIG4gKyBzMjtcbiAqXG4gKiAvLyBsZXQncyB1c2UgYGFwYCB0byBpdGVyYXRlIGBmYCBvdmVyIGFuIGFycmF5IGZvciBlYWNoIGlucHV0IHBhcmFtZXRlclxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChwaXBlKFtcImFcIiwgXCJiXCJdLCBtYXAoZiksIGFwKFsxLCAyXSksIGFwKFtcIvCfmIBcIiwgXCLwn5irXCIsIFwi8J+YjlwiXSkpLCBbXG4gKiAgIFwiYTHwn5iAXCIsIFwiYTHwn5irXCIsIFwiYTHwn5iOXCIsXG4gKiAgIFwiYTLwn5iAXCIsIFwiYTLwn5irXCIsIFwiYTLwn5iOXCIsXG4gKiAgIFwiYjHwn5iAXCIsIFwiYjHwn5irXCIsIFwiYjHwn5iOXCIsXG4gKiAgIFwiYjLwn5iAXCIsIFwiYjLwn5irXCIsIFwiYjLwn5iOXCIsXG4gKiBdKTtcbiAqXG4gKiAvLyBnaXZlbiBBcnJheSBpbXBsZW1lbnRzIHRoZSBBcHBsaWNhdGl2ZSBpbnRlcmZhY2Ugd2l0aCB0aGUgYG9mYCBtZXRob2QsXG4gKiAvLyB3ZSBjYW4gd3JpdGUgZXhhY3RseSB0aGUgc2FtZSB0aGluZyBpbiBhIG1vcmUgc3ltbWV0cmljIHdheVxuICogLy8gdXNpbmcgYG9mYCBvbiBgZmAgYW5kIGBhcGAgb24gZWFjaCBhcnJheSBpbiBpbnB1dFxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChcbiAqICAgcGlwZShvZihmKSwgYXAoW1wiYVwiLCBcImJcIl0pLCBhcChbMSwgMl0pLCBhcChbXCLwn5iAXCIsIFwi8J+Yq1wiLCBcIvCfmI5cIl0pKSxcbiAqICAgcGlwZShbXCJhXCIsIFwiYlwiXSwgbWFwKGYpLCBhcChbMSwgMl0pLCBhcChbXCLwn5iAXCIsIFwi8J+Yq1wiLCBcIvCfmI5cIl0pKVxuICogKTtcbiAqXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciBhcCA9IGZ1bmN0aW9uIChmYSkge1xuICAgIHJldHVybiBmbGF0TWFwKGZ1bmN0aW9uIChmKSB7IHJldHVybiBwaXBlKGZhLCBtYXAoZikpOyB9KTtcbn07XG4vKipcbiAqIENvbXBvc2VzIGNvbXB1dGF0aW9ucyBpbiBzZXF1ZW5jZSwgdXNpbmcgdGhlIHJldHVybiB2YWx1ZSBvZiBvbmUgY29tcHV0YXRpb24gdG9cbiAqIGRldGVybWluZSB0aGUgbmV4dCBjb21wdXRhdGlvbi5cbiAqXG4gKiBJbiBvdGhlciB3b3JkcyBpdCB0YWtlcyBhIGZ1bmN0aW9uIGBmYCB0aGF0IHByb2R1Y2VzIGFuIGFycmF5IGZyb20gYSBzaW5nbGUgZWxlbWVudCBvZlxuICogdGhlIGJhc2UgdHlwZSBgQWAgYW5kIHJldHVybnMgYSBuZXcgZnVuY3Rpb24gd2hpY2ggYXBwbGllcyBgZmAgdG8gZWFjaCBlbGVtZW50IG9mIHRoZVxuICogaW5wdXQgYXJyYXkgKGxpa2UgW2BtYXBgXSgjbWFwKSkgYW5kLCBpbnN0ZWFkIG9mIHJldHVybmluZyBhbiBhcnJheSBvZiBhcnJheXMsIGNvbmNhdGVuYXRlcyB0aGVcbiAqIHJlc3VsdHMgaW50byBhIHNpbmdsZSBhcnJheSAobGlrZSBbYGZsYXR0ZW5gXSgjZmxhdHRlbikpLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBmbGF0TWFwLCBtYXAsIHJlcGxpY2F0ZSB9IGZyb20gJ2ZwLXRzL0FycmF5J1xuICogaW1wb3J0IHsgcGlwZSB9IGZyb20gJ2ZwLXRzL2Z1bmN0aW9uJ1xuICpcbiAqIGNvbnN0IGYgPSAobjogbnVtYmVyKSA9PiByZXBsaWNhdGUobiwgYCR7bn1gKTtcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwocGlwZShbMSwgMiwgM10sIG1hcChmKSksIFtbXCIxXCJdLCBbXCIyXCIsIFwiMlwiXSwgW1wiM1wiLCBcIjNcIiwgXCIzXCJdXSk7XG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKHBpcGUoWzEsIDIsIDNdLCBmbGF0TWFwKGYpKSwgW1wiMVwiLCBcIjJcIiwgXCIyXCIsIFwiM1wiLCBcIjNcIiwgXCIzXCJdKTtcbiAqXG4gKiBAY2F0ZWdvcnkgc2VxdWVuY2luZ1xuICogQHNpbmNlIDIuMTQuMFxuICovXG5leHBvcnQgdmFyIGZsYXRNYXAgPSAvKiNfX1BVUkVfXyovIGR1YWwoMiwgZnVuY3Rpb24gKG1hLCBmKSB7XG4gICAgcmV0dXJuIHBpcGUobWEsIGNoYWluV2l0aEluZGV4KGZ1bmN0aW9uIChpLCBhKSB7IHJldHVybiBmKGEsIGkpOyB9KSk7XG59KTtcbi8qKlxuICogVGFrZXMgYW4gYXJyYXkgb2YgYXJyYXlzIG9mIGBBYCBhbmQgZmxhdHRlbnMgdGhlbSBpbnRvIGFuIGFycmF5IG9mIGBBYFxuICogYnkgY29uY2F0ZW5hdGluZyB0aGUgZWxlbWVudHMgb2YgZWFjaCBhcnJheSBpbiBvcmRlci5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgZmxhdHRlbiB9IGZyb20gJ2ZwLXRzL0FycmF5J1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoZmxhdHRlbihbW1wiYVwiXSwgW1wiYlwiLCBcImNcIl0sIFtcImRcIiwgXCJlXCIsIFwiZlwiXV0pLCBbXCJhXCIsIFwiYlwiLCBcImNcIiwgXCJkXCIsIFwiZVwiLCBcImZcIl0pO1xuICpcbiAqIEBjYXRlZ29yeSBzZXF1ZW5jaW5nXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBmbGF0dGVuID0gLyojX19QVVJFX18qLyBmbGF0TWFwKGlkZW50aXR5KTtcbi8qKlxuICogU2FtZSBhcyBbYG1hcGBdKCNtYXApLCBidXQgdGhlIGl0ZXJhdGluZyBmdW5jdGlvbiB0YWtlcyBib3RoIHRoZSBpbmRleCBhbmQgdGhlIHZhbHVlXG4gKiBvZiB0aGUgZWxlbWVudC5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgbWFwV2l0aEluZGV4IH0gZnJvbSAnZnAtdHMvQXJyYXknXG4gKiBpbXBvcnQgeyBwaXBlIH0gZnJvbSAnZnAtdHMvZnVuY3Rpb24nXG4gKlxuICogY29uc3QgZiA9IChpOiBudW1iZXIsIHM6IHN0cmluZykgPT4gYCR7c30gLSAke2l9YDtcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwocGlwZShbXCJhXCIsIFwiYlwiLCBcImNcIl0sIG1hcFdpdGhJbmRleChmKSksIFtcImEgLSAwXCIsIFwiYiAtIDFcIiwgXCJjIC0gMlwiXSk7XG4gKlxuICogQGNhdGVnb3J5IG1hcHBpbmdcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIG1hcFdpdGhJbmRleCA9IGZ1bmN0aW9uIChmKSB7IHJldHVybiBmdW5jdGlvbiAoZmEpIHtcbiAgICByZXR1cm4gZmEubWFwKGZ1bmN0aW9uIChhLCBpKSB7IHJldHVybiBmKGksIGEpOyB9KTtcbn07IH07XG4vKipcbiAqIE1hcHMgYW4gYXJyYXkgd2l0aCBhbiBpdGVyYXRpbmcgZnVuY3Rpb24gdGhhdCB0YWtlcyB0aGUgaW5kZXggYW5kIHRoZSB2YWx1ZSBvZlxuICogZWFjaCBlbGVtZW50IGFuZCByZXR1cm5zIGFuIGBPcHRpb25gLiBJdCBrZWVwcyBvbmx5IHRoZSBgU29tZWAgdmFsdWVzIGRpc2NhcmRpbmdcbiAqIHRoZSBgTm9uZWBzLlxuICpcbiAqIFNhbWUgYXMgW2BmaWx0ZXJNYXBgXSgjZmlsdGVyTWFwKSwgYnV0IHdpdGggYW4gaXRlcmF0aW5nIGZ1bmN0aW9uIHdoaWNoIHRha2VzIGFsc29cbiAqIHRoZSBpbmRleCBhcyBpbnB1dC5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgZmlsdGVyTWFwV2l0aEluZGV4IH0gZnJvbSAnZnAtdHMvQXJyYXknXG4gKiBpbXBvcnQgeyBwaXBlIH0gZnJvbSAnZnAtdHMvZnVuY3Rpb24nXG4gKiBpbXBvcnQgeyBvcHRpb24gfSBmcm9tIFwiZnAtdHNcIjtcbiAqXG4gKiBjb25zdCBmID0gKGk6IG51bWJlciwgczogc3RyaW5nKSA9PiAoaSAlIDIgPT09IDEgPyBvcHRpb24uc29tZShzLnRvVXBwZXJDYXNlKCkpIDogb3B0aW9uLm5vbmUpO1xuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChwaXBlKFtcImFcIiwgXCJub1wiLCBcIm5laXRoZXJcIiwgXCJiXCJdLCBmaWx0ZXJNYXBXaXRoSW5kZXgoZikpLCBbXCJOT1wiLCBcIkJcIl0pO1xuICpcbiAqIEBjYXRlZ29yeSBmaWx0ZXJpbmdcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIGZpbHRlck1hcFdpdGhJbmRleCA9IGZ1bmN0aW9uIChmKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChmYSkge1xuICAgICAgICB2YXIgb3V0ID0gW107XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgZmEubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIHZhciBvcHRpb25CID0gZihpLCBmYVtpXSk7XG4gICAgICAgICAgICBpZiAoXy5pc1NvbWUob3B0aW9uQikpIHtcbiAgICAgICAgICAgICAgICBvdXQucHVzaChvcHRpb25CLnZhbHVlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gb3V0O1xuICAgIH07XG59O1xuLyoqXG4gKiBNYXBzIGFuIGFycmF5IHdpdGggYW4gaXRlcmF0aW5nIGZ1bmN0aW9uIHRoYXQgcmV0dXJucyBhbiBgT3B0aW9uYFxuICogYW5kIGl0IGtlZXBzIG9ubHkgdGhlIGBTb21lYCB2YWx1ZXMgZGlzY2FyZGluZyB0aGUgYE5vbmVgcy5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgZmlsdGVyTWFwIH0gZnJvbSAnZnAtdHMvQXJyYXknXG4gKiBpbXBvcnQgeyBwaXBlIH0gZnJvbSAnZnAtdHMvZnVuY3Rpb24nXG4gKiBpbXBvcnQgeyBvcHRpb24gfSBmcm9tIFwiZnAtdHNcIjtcbiAqXG4gKiBjb25zdCBmID0gKHM6IHN0cmluZykgPT4gcy5sZW5ndGggPT09IDEgPyBvcHRpb24uc29tZShzLnRvVXBwZXJDYXNlKCkpIDogb3B0aW9uLm5vbmU7XG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKHBpcGUoW1wiYVwiLCBcIm5vXCIsIFwibmVpdGhlclwiLCBcImJcIl0sIGZpbHRlck1hcChmKSksIFtcIkFcIiwgXCJCXCJdKTtcbiAqXG4gKiBAY2F0ZWdvcnkgZmlsdGVyaW5nXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciBmaWx0ZXJNYXAgPSBmdW5jdGlvbiAoZikge1xuICAgIHJldHVybiBmaWx0ZXJNYXBXaXRoSW5kZXgoZnVuY3Rpb24gKF8sIGEpIHsgcmV0dXJuIGYoYSk7IH0pO1xufTtcbi8qKlxuICogQ29tcGFjdCBhbiBhcnJheSBvZiBgT3B0aW9uYHMgZGlzY2FyZGluZyB0aGUgYE5vbmVgIHZhbHVlcyBhbmRcbiAqIGtlZXBpbmcgdGhlIGBTb21lYCB2YWx1ZXMuIEl0IHJldHVybnMgYSBuZXcgYXJyYXkgY29udGFpbmluZyB0aGUgdmFsdWVzIG9mXG4gKiB0aGUgYFNvbWVgIG9wdGlvbnMuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IGNvbXBhY3QgfSBmcm9tICdmcC10cy9BcnJheSdcbiAqIGltcG9ydCB7IG9wdGlvbiB9IGZyb20gXCJmcC10c1wiO1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoY29tcGFjdChbb3B0aW9uLnNvbWUoXCJhXCIpLCBvcHRpb24ubm9uZSwgb3B0aW9uLnNvbWUoXCJiXCIpXSksIFtcImFcIiwgXCJiXCJdKTtcbiAqXG4gKiBAY2F0ZWdvcnkgZmlsdGVyaW5nXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciBjb21wYWN0ID0gLyojX19QVVJFX18qLyBmaWx0ZXJNYXAoaWRlbnRpdHkpO1xuLyoqXG4gKiBTZXBhcmF0ZSBhbiBhcnJheSBvZiBgRWl0aGVyYHMgaW50byBgTGVmdGBzIGFuZCBgUmlnaHRgcywgY3JlYXRpbmcgdHdvIG5ldyBhcnJheXM6XG4gKiBvbmUgY29udGFpbmluZyBhbGwgdGhlIGxlZnQgdmFsdWVzIGFuZCBvbmUgY29udGFpbmluZyBhbGwgdGhlIHJpZ2h0IHZhbHVlcy5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgc2VwYXJhdGUgfSBmcm9tICdmcC10cy9BcnJheSdcbiAqIGltcG9ydCB7IGVpdGhlciB9IGZyb20gXCJmcC10c1wiO1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoc2VwYXJhdGUoW2VpdGhlci5yaWdodChcInIxXCIpLCBlaXRoZXIubGVmdChcImwxXCIpLCBlaXRoZXIucmlnaHQoXCJyMlwiKV0pLCB7XG4gKiAgIGxlZnQ6IFtcImwxXCJdLFxuICogICByaWdodDogW1wicjFcIiwgXCJyMlwiXSxcbiAqIH0pO1xuICpcbiAqIEBjYXRlZ29yeSBmaWx0ZXJpbmdcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIHNlcGFyYXRlID0gZnVuY3Rpb24gKGZhKSB7XG4gICAgdmFyIGxlZnQgPSBbXTtcbiAgICB2YXIgcmlnaHQgPSBbXTtcbiAgICBmb3IgKHZhciBfaSA9IDAsIGZhXzEgPSBmYTsgX2kgPCBmYV8xLmxlbmd0aDsgX2krKykge1xuICAgICAgICB2YXIgZSA9IGZhXzFbX2ldO1xuICAgICAgICBpZiAoZS5fdGFnID09PSAnTGVmdCcpIHtcbiAgICAgICAgICAgIGxlZnQucHVzaChlLmxlZnQpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgcmlnaHQucHVzaChlLnJpZ2h0KTtcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gc2VwYXJhdGVkKGxlZnQsIHJpZ2h0KTtcbn07XG4vKipcbiAqIEdpdmVuIGFuIGl0ZXJhdGluZyBmdW5jdGlvbiB0aGF0IGlzIGEgYFByZWRpY2F0ZWAgb3IgYSBgUmVmaW5lbWVudGAsXG4gKiBgZmlsdGVyYCBjcmVhdGVzIGEgbmV3IGBBcnJheWAgY29udGFpbmluZyB0aGUgZWxlbWVudHMgb2YgdGhlIG9yaWdpbmFsXG4gKiBgQXJyYXlgIGZvciB3aGljaCB0aGUgaXRlcmF0aW5nIGZ1bmN0aW9uIGlzIGB0cnVlYC5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgZmlsdGVyIH0gZnJvbSAnZnAtdHMvQXJyYXknXG4gKiBpbXBvcnQgeyBpc1N0cmluZyB9IGZyb20gXCJmcC10cy9saWIvc3RyaW5nXCI7XG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChmaWx0ZXIoaXNTdHJpbmcpKFtcImFcIiwgMSwge30sIFwiYlwiLCA1XSksIFtcImFcIiwgXCJiXCJdKTtcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoZmlsdGVyKCh4Om51bWJlcikgPT4geCA+IDApKFstMywgMSwgLTIsIDVdKSwgWzEsIDVdKTtcbiAqXG4gKiBAY2F0ZWdvcnkgZmlsdGVyaW5nXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciBmaWx0ZXIgPSBmdW5jdGlvbiAocHJlZGljYXRlKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykge1xuICAgICAgICByZXR1cm4gYXMuZmlsdGVyKHByZWRpY2F0ZSk7XG4gICAgfTtcbn07XG4vKipcbiAqIEdpdmVuIGFuIGl0ZXJhdGluZyBmdW5jdGlvbiB0aGF0IGlzIGEgYFByZWRpY2F0ZWAgb3IgYSBgUmVmaW5lbWVudGAsXG4gKiBgcGFydGl0aW9uYCBjcmVhdGVzIHR3byBuZXcgYEFycmF5YHM6IGByaWdodGAgY29udGFpbmluZyB0aGUgZWxlbWVudHMgb2YgdGhlIG9yaWdpbmFsXG4gKiBgQXJyYXlgIGZvciB3aGljaCB0aGUgaXRlcmF0aW5nIGZ1bmN0aW9uIGlzIGB0cnVlYCwgYGxlZnRgIGNvbnRhaW5pbmcgdGhlIGVsZW1lbnRzXG4gKiBmb3Igd2hpY2ggaXQgaXMgZmFsc2UuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IHBhcnRpdGlvbiB9IGZyb20gJ2ZwLXRzL0FycmF5J1xuICogaW1wb3J0IHsgaXNTdHJpbmcgfSBmcm9tIFwiZnAtdHMvbGliL3N0cmluZ1wiO1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwocGFydGl0aW9uKGlzU3RyaW5nKShbXCJhXCIsIDEsIHt9LCBcImJcIiwgNV0pLCB7IGxlZnQ6IFsxLCB7fSwgNV0sIHJpZ2h0OiBbXCJhXCIsIFwiYlwiXSB9KTtcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwocGFydGl0aW9uKCh4OiBudW1iZXIpID0+IHggPiAwKShbLTMsIDEsIC0yLCA1XSksIHsgbGVmdDogWy0zLCAtMl0sIHJpZ2h0OiBbMSwgNV0gfSk7XG4gKlxuICogQGNhdGVnb3J5IGZpbHRlcmluZ1xuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgcGFydGl0aW9uID0gZnVuY3Rpb24gKHByZWRpY2F0ZSkge1xuICAgIHJldHVybiBwYXJ0aXRpb25XaXRoSW5kZXgoZnVuY3Rpb24gKF8sIGEpIHsgcmV0dXJuIHByZWRpY2F0ZShhKTsgfSk7XG59O1xuLyoqXG4gKiBTYW1lIGFzIFtgcGFydGl0aW9uYF0oI3BhcnRpdGlvbiksIGJ1dCBwYXNzaW5nIGFsc28gdGhlIGluZGV4IHRvIHRoZSBpdGVyYXRpbmcgZnVuY3Rpb24uXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IHBhcnRpdGlvbldpdGhJbmRleCB9IGZyb20gJ2ZwLXRzL0FycmF5J1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwocGFydGl0aW9uV2l0aEluZGV4KChpbmRleCwgeDogbnVtYmVyKSA9PiBpbmRleCA8IDMgJiYgeCA+IDApKFstMiwgNSwgNiwgN10pLCB7XG4gKiAgIGxlZnQ6IFstMiwgN10sXG4gKiAgIHJpZ2h0OiBbNSwgNl0sXG4gKiB9KTtcbiAqXG4gKiBAY2F0ZWdvcnkgZmlsdGVyaW5nXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciBwYXJ0aXRpb25XaXRoSW5kZXggPSBmdW5jdGlvbiAocHJlZGljYXRlV2l0aEluZGV4KSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykge1xuICAgICAgICB2YXIgbGVmdCA9IFtdO1xuICAgICAgICB2YXIgcmlnaHQgPSBbXTtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBhcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgdmFyIGIgPSBhc1tpXTtcbiAgICAgICAgICAgIGlmIChwcmVkaWNhdGVXaXRoSW5kZXgoaSwgYikpIHtcbiAgICAgICAgICAgICAgICByaWdodC5wdXNoKGIpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgbGVmdC5wdXNoKGIpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBzZXBhcmF0ZWQobGVmdCwgcmlnaHQpO1xuICAgIH07XG59O1xuLyoqXG4gKiBHaXZlbiBhbiBpdGVyYXRpbmcgZnVuY3Rpb24gdGhhdCByZXR1cm5zIGFuIGBFaXRoZXJgLFxuICogYHBhcnRpdGlvbk1hcGAgYXBwbGllcyB0aGUgaXRlcmF0aW5nIGZ1bmN0aW9uIHRvIGVhY2ggZWxlbWVudCBhbmQgaXQgY3JlYXRlcyB0d28gYEFycmF5YHM6XG4gKiBgcmlnaHRgIGNvbnRhaW5pbmcgdGhlIHZhbHVlcyBvZiBgUmlnaHRgIHJlc3VsdHMsIGBsZWZ0YCBjb250YWluaW5nIHRoZSB2YWx1ZXMgb2YgYExlZnRgIHJlc3VsdHMuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IHBhcnRpdGlvbk1hcCB9IGZyb20gJ2ZwLXRzL0FycmF5J1xuICogaW1wb3J0IHsgRWl0aGVyLCBsZWZ0LCByaWdodCB9IGZyb20gXCJmcC10cy9saWIvRWl0aGVyXCI7XG4gKlxuICogY29uc3QgdXBwZXJJZlN0cmluZyA9IDxCPih4OiBCKTogRWl0aGVyPEIsIHN0cmluZz4gPT5cbiAqICAgdHlwZW9mIHggPT09IFwic3RyaW5nXCIgPyByaWdodCh4LnRvVXBwZXJDYXNlKCkpIDogbGVmdCh4KTtcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwocGFydGl0aW9uTWFwKHVwcGVySWZTdHJpbmcpKFstMiwgXCJoZWxsb1wiLCA2LCA3LCBcIndvcmxkXCJdKSwge1xuICogICBsZWZ0OiBbLTIsIDYsIDddLFxuICogICByaWdodDogWyAnSEVMTE8nLCAnV09STEQnIF0sXG4gKiB9KTtcbiAqXG4gKiBAY2F0ZWdvcnkgZmlsdGVyaW5nXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciBwYXJ0aXRpb25NYXAgPSBmdW5jdGlvbiAoZikgeyByZXR1cm4gcGFydGl0aW9uTWFwV2l0aEluZGV4KGZ1bmN0aW9uIChfLCBhKSB7IHJldHVybiBmKGEpOyB9KTsgfTtcbi8qKlxuICogU2FtZSBhcyBbYHBhcnRpdGlvbk1hcGBdKCNwYXJ0aXRpb25NYXApLCBidXQgcGFzc2luZyBhbHNvIHRoZSBpbmRleCB0byB0aGUgaXRlcmF0aW5nIGZ1bmN0aW9uLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBwYXJ0aXRpb25NYXBXaXRoSW5kZXggfSBmcm9tICdmcC10cy9BcnJheSdcbiAqIGltcG9ydCB7IEVpdGhlciwgbGVmdCwgcmlnaHQgfSBmcm9tIFwiZnAtdHMvbGliL0VpdGhlclwiO1xuICpcbiAqIGNvbnN0IHVwcGVySWZTdHJpbmdCZWZvcmUzID0gPEI+KGluZGV4OiBudW1iZXIsIHg6IEIpOiBFaXRoZXI8Qiwgc3RyaW5nPiA9PlxuICogICBpbmRleCA8IDMgJiYgdHlwZW9mIHggPT09IFwic3RyaW5nXCIgPyByaWdodCh4LnRvVXBwZXJDYXNlKCkpIDogbGVmdCh4KTtcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwocGFydGl0aW9uTWFwV2l0aEluZGV4KHVwcGVySWZTdHJpbmdCZWZvcmUzKShbLTIsIFwiaGVsbG9cIiwgNiwgNywgXCJ3b3JsZFwiXSksIHtcbiAqICAgbGVmdDogWy0yLCA2LCA3LCBcIndvcmxkXCJdLFxuICogICByaWdodDogW1wiSEVMTE9cIl0sXG4gKiB9KTtcbiAqXG4gKiBAY2F0ZWdvcnkgZmlsdGVyaW5nXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciBwYXJ0aXRpb25NYXBXaXRoSW5kZXggPSBmdW5jdGlvbiAoZikge1xuICAgIHJldHVybiBmdW5jdGlvbiAoZmEpIHtcbiAgICAgICAgdmFyIGxlZnQgPSBbXTtcbiAgICAgICAgdmFyIHJpZ2h0ID0gW107XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgZmEubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIHZhciBlID0gZihpLCBmYVtpXSk7XG4gICAgICAgICAgICBpZiAoZS5fdGFnID09PSAnTGVmdCcpIHtcbiAgICAgICAgICAgICAgICBsZWZ0LnB1c2goZS5sZWZ0KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHJpZ2h0LnB1c2goZS5yaWdodCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHNlcGFyYXRlZChsZWZ0LCByaWdodCk7XG4gICAgfTtcbn07XG4vKipcbiAqIExlc3Mgc3RyaWN0IHZlcnNpb24gb2YgW2BhbHRgXSgjYWx0KS5cbiAqXG4gKiBUaGUgYFdgIHN1ZmZpeCAoc2hvcnQgZm9yICoqVyoqaWRlbmluZykgbWVhbnMgdGhhdCB0aGUgcmV0dXJuIHR5cGVzIHdpbGwgYmUgbWVyZ2VkLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgKiBhcyBBIGZyb20gJ2ZwLXRzL0FycmF5J1xuICogaW1wb3J0IHsgcGlwZSB9IGZyb20gJ2ZwLXRzL2Z1bmN0aW9uJ1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoXG4gKiAgIHBpcGUoXG4gKiAgICAgWzEsIDIsIDNdLFxuICogICAgIEEuYWx0VygoKSA9PiBbJ2EnLCAnYiddKVxuICogICApLFxuICogICBbMSwgMiwgMywgJ2EnLCAnYiddXG4gKiApXG4gKlxuICogQGNhdGVnb3J5IGVycm9yIGhhbmRsaW5nXG4gKiBAc2luY2UgMi45LjBcbiAqL1xuZXhwb3J0IHZhciBhbHRXID0gZnVuY3Rpb24gKHRoYXQpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGZhKSB7XG4gICAgICAgIHJldHVybiBmYS5jb25jYXQodGhhdCgpKTtcbiAgICB9O1xufTtcbi8qKlxuICogSWRlbnRpZmllcyBhbiBhc3NvY2lhdGl2ZSBvcGVyYXRpb24gb24gYSB0eXBlIGNvbnN0cnVjdG9yLiBJdCBpcyBzaW1pbGFyIHRvIGBTZW1pZ3JvdXBgLCBleGNlcHQgdGhhdCBpdCBhcHBsaWVzIHRvXG4gKiB0eXBlcyBvZiBraW5kIGAqIC0+ICpgLlxuICpcbiAqIEluIGNhc2Ugb2YgYEFycmF5YCBjb25jYXRlbmF0ZXMgdGhlIGlucHV0cyBpbnRvIGEgc2luZ2xlIGFycmF5LlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgKiBhcyBBIGZyb20gJ2ZwLXRzL0FycmF5J1xuICogaW1wb3J0IHsgcGlwZSB9IGZyb20gJ2ZwLXRzL2Z1bmN0aW9uJ1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoXG4gKiAgIHBpcGUoXG4gKiAgICAgWzEsIDIsIDNdLFxuICogICAgIEEuYWx0KCgpID0+IFs0LCA1XSlcbiAqICAgKSxcbiAqICAgWzEsIDIsIDMsIDQsIDVdXG4gKiApXG4gKlxuICogQGNhdGVnb3J5IGVycm9yIGhhbmRsaW5nXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciBhbHQgPSBhbHRXO1xuLyoqXG4gKiBTYW1lIGFzIFtgZmlsdGVyYF0oI2ZpbHRlciksIGJ1dCBwYXNzaW5nIGFsc28gdGhlIGluZGV4IHRvIHRoZSBpdGVyYXRpbmcgZnVuY3Rpb24uXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IGZpbHRlcldpdGhJbmRleCB9IGZyb20gJ2ZwLXRzL0FycmF5JztcbiAqXG4gKiBjb25zdCBmID0gKGluZGV4OiBudW1iZXIsIHg6IG51bWJlcikgPT4geCA+IDAgJiYgaW5kZXggPD0gMjtcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoZmlsdGVyV2l0aEluZGV4KGYpKFstMywgMSwgLTIsIDVdKSwgWzFdKTtcbiAqXG4gKiBAY2F0ZWdvcnkgZmlsdGVyaW5nXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciBmaWx0ZXJXaXRoSW5kZXggPSBmdW5jdGlvbiAocHJlZGljYXRlV2l0aEluZGV4KSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykge1xuICAgICAgICByZXR1cm4gYXMuZmlsdGVyKGZ1bmN0aW9uIChiLCBpKSB7IHJldHVybiBwcmVkaWNhdGVXaXRoSW5kZXgoaSwgYik7IH0pO1xuICAgIH07XG59O1xuLyoqXG4gKiBHaXZlbiBhbiBpdGVyYXRpbmcgZnVuY3Rpb24gdGhhdCB0YWtlcyBgQXJyYXk8QT5gIGFzIGlucHV0LCBgZXh0ZW5kYCByZXR1cm5zXG4gKiBhbiBhcnJheSBjb250YWluaW5nIHRoZSByZXN1bHRzIG9mIHRoZSBpdGVyYXRpbmcgZnVuY3Rpb24gYXBwbGllZCB0byB0aGUgd2hvbGUgaW5wdXRcbiAqIGBBcnJheWAsIHRoZW4gdG8gdGhlIGlucHV0IGBBcnJheWAgd2l0aG91dCB0aGUgZmlyc3QgZWxlbWVudCwgdGhlbiB0byB0aGUgaW5wdXRcbiAqIGBBcnJheWAgd2l0aG91dCB0aGUgZmlyc3QgdHdvIGVsZW1lbnRzLCBldGMuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IGV4dGVuZCB9IGZyb20gJ2ZwLXRzL0FycmF5J1xuICpcbiAqIGNvbnN0IGYgPSAoYTogc3RyaW5nW10pID0+IGEuam9pbihcIixcIik7XG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKGV4dGVuZChmKShbXCJhXCIsIFwiYlwiLCBcImNcIl0pLCBbXCJhLGIsY1wiLCBcImIsY1wiLCBcImNcIl0pO1xuICpcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIGV4dGVuZCA9IGZ1bmN0aW9uIChmKSB7IHJldHVybiBmdW5jdGlvbiAod2EpIHtcbiAgICByZXR1cm4gd2EubWFwKGZ1bmN0aW9uIChfLCBpKSB7IHJldHVybiBmKHdhLnNsaWNlKGkpKTsgfSk7XG59OyB9O1xuLyoqXG4gKiBgZHVwbGljYXRlYCByZXR1cm5zIGFuIGFycmF5IGNvbnRhaW5pbmcgdGhlIHdob2xlIGlucHV0IGBBcnJheWAsXG4gKiB0aGVuIHRvIHRoZSBpbnB1dCBgQXJyYXlgIGRyb3BwaW5nIHRoZSBmaXJzdCBlbGVtZW50LCB0aGVuIHRvIHRoZSBpbnB1dFxuICogYEFycmF5YCBkcm9wcGluZyB0aGUgZmlyc3QgdHdvIGVsZW1lbnRzLCBldGMuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IGR1cGxpY2F0ZSB9IGZyb20gJ2ZwLXRzL0FycmF5J1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoZHVwbGljYXRlKFtcImFcIiwgXCJiXCIsIFwiY1wiXSksIFtbXCJhXCIsIFwiYlwiLCBcImNcIl0sIFtcImJcIiwgXCJjXCJdLCBbXCJjXCJdXSk7XG4gKlxuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgZHVwbGljYXRlID0gLyojX19QVVJFX18qLyBleHRlbmQoaWRlbnRpdHkpO1xuLyoqXG4gKiBNYXAgYW5kIGZvbGQgYW4gYEFycmF5YC5cbiAqIE1hcCB0aGUgYEFycmF5YCBwYXNzaW5nIGVhY2ggdmFsdWUgdG8gdGhlIGl0ZXJhdGluZyBmdW5jdGlvbi5cbiAqIFRoZW4gZm9sZCB0aGUgcmVzdWx0cyB1c2luZyB0aGUgcHJvdmlkZWQgYE1vbm9pZGAuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IGZvbGRNYXAgfSBmcm9tICdmcC10cy9BcnJheSdcbiAqXG4gKiBjb25zdCBtb25vaWQgPSB7IGNvbmNhdDogKGE6IHN0cmluZywgYjogc3RyaW5nKSA9PiBhICsgYiwgZW1wdHk6IFwiXCIgfTtcbiAqIGNvbnN0IGYgPSAoczogc3RyaW5nKSA9PiBzLnRvVXBwZXJDYXNlKClcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoZm9sZE1hcChtb25vaWQpKGYpKFtcImFcIiwgXCJiXCIsIFwiY1wiXSksIFwiQUJDXCIpO1xuICpcbiAqIEBjYXRlZ29yeSBmb2xkaW5nXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciBmb2xkTWFwID0gUkEuZm9sZE1hcDtcbi8qKlxuICogU2FtZSBhcyBbYGZvbGRNYXBgXSgjZm9sZE1hcCkgYnV0IHBhc3NpbmcgYWxzbyB0aGUgaW5kZXggdG8gdGhlIGl0ZXJhdGluZyBmdW5jdGlvbi5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgZm9sZE1hcFdpdGhJbmRleCB9IGZyb20gJ2ZwLXRzL0FycmF5J1xuICpcbiAqIGNvbnN0IG1vbm9pZCA9IHsgY29uY2F0OiAoYTogc3RyaW5nLCBiOiBzdHJpbmcpID0+IGEgKyBiLCBlbXB0eTogXCJcIiB9O1xuICogY29uc3QgZiA9IChpbmRleDpudW1iZXIsIHM6IHN0cmluZykgPT4gYCR7cy50b1VwcGVyQ2FzZSgpfSgke2luZGV4fSlgXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKGZvbGRNYXBXaXRoSW5kZXgobW9ub2lkKShmKShbXCJhXCIsIFwiYlwiLCBcImNcIl0pLCBcIkEoMClCKDEpQygyKVwiKTtcbiAqXG4gKiBAY2F0ZWdvcnkgZm9sZGluZ1xuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgZm9sZE1hcFdpdGhJbmRleCA9IFJBLmZvbGRNYXBXaXRoSW5kZXg7XG4vKipcbiAqIFJlZHVjZXMgYW4gYEFycmF5YC5cbiAqXG4gKiBgcmVkdWNlYCBleGVjdXRlcyB0aGUgc3VwcGxpZWQgaXRlcmF0aW5nIGZ1bmN0aW9uIG9uIGVhY2ggZWxlbWVudCBvZiB0aGUgYXJyYXksXG4gKiBpbiBvcmRlciwgcGFzc2luZyBpbiB0aGUgZWxlbWVudCBhbmQgdGhlIHJldHVybiB2YWx1ZSBmcm9tIHRoZSBjYWxjdWxhdGlvbiBvbiB0aGUgcHJlY2VkaW5nIGVsZW1lbnQuXG4gKlxuICogVGhlIGZpcnN0IHRpbWUgdGhhdCB0aGUgaXRlcmF0aW5nIGZ1bmN0aW9uIGlzIGNhbGxlZCB0aGVyZSBpcyBubyBcInJldHVybiB2YWx1ZSBvZiB0aGVcbiAqIHByZXZpb3VzIGNhbGN1bGF0aW9uXCIsIHRoZSBpbml0aWFsIHZhbHVlIGlzIHVzZWQgaW4gaXRzIHBsYWNlLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyByZWR1Y2UgfSBmcm9tICdmcC10cy9BcnJheSdcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKHJlZHVjZSg1LCAoYWNjOiBudW1iZXIsIGN1cjogbnVtYmVyKSA9PiBhY2MgKiBjdXIpKFsyLCAzXSksIDUgKiAyICogMyk7XG4gKlxuICogQGNhdGVnb3J5IGZvbGRpbmdcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIHJlZHVjZSA9IFJBLnJlZHVjZTtcbi8qKlxuICogU2FtZSBhcyBbYHJlZHVjZWBdKCNyZWR1Y2UpIGJ1dCBwYXNzaW5nIGFsc28gdGhlIGluZGV4IHRvIHRoZSBpdGVyYXRpbmcgZnVuY3Rpb24uXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IHJlZHVjZVdpdGhJbmRleCB9IGZyb20gJ2ZwLXRzL0FycmF5J1xuICpcbiAqIGNvbnN0IGYgPSAoaW5kZXg6IG51bWJlciwgYWNjOiBzdHJpbmcsIGN1cjogdW5rbm93bikgPT5cbiAqICAgYWNjICsgKHR5cGVvZiBjdXIgPT09IFwic3RyaW5nXCIgPyBjdXIudG9VcHBlckNhc2UoKSArIGluZGV4IDogXCJcIik7XG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKHJlZHVjZVdpdGhJbmRleChcIlwiLCBmKShbMiwgXCJhXCIsIFwiYlwiLCBudWxsXSksIFwiQTFCMlwiKTtcbiAqXG4gKiBAY2F0ZWdvcnkgZm9sZGluZ1xuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgcmVkdWNlV2l0aEluZGV4ID0gUkEucmVkdWNlV2l0aEluZGV4O1xuLyoqXG4gKiBTYW1lIGFzIFtgcmVkdWNlYF0oI3JlZHVjZSkgYnV0IGFwcGxpZWQgZnJvbSB0aGUgZW5kIHRvIHRoZSBzdGFydC5cbiAqXG4gKiAqTm90ZSo6IHRoZSBpdGVyYXRpbmcgZnVuY3Rpb24gaW4gdGhpcyBjYXNlIHRha2VzIHRoZSBhY2N1bXVsYXRvciBhcyB0aGUgbGFzdCBhcmd1bWVudC5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgcmVkdWNlUmlnaHQgfSBmcm9tICdmcC10cy9BcnJheSdcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKHJlZHVjZVJpZ2h0KFwiXCIsIChjdXI6IHN0cmluZywgYWNjOiBzdHJpbmcpID0+IGFjYyArIGN1cikoW1wiYVwiLCBcImJcIiwgXCJjXCJdKSwgXCJjYmFcIik7XG4gKlxuICogQGNhdGVnb3J5IGZvbGRpbmdcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIHJlZHVjZVJpZ2h0ID0gUkEucmVkdWNlUmlnaHQ7XG4vKipcbiAqIFNhbWUgYXMgW2ByZWR1Y2VSaWdodGBdKCNyZWR1Y2VSaWdodCkgYnV0IHBhc3NpbmcgYWxzbyB0aGUgaW5kZXggdG8gdGhlIGl0ZXJhdGluZyBmdW5jdGlvbi5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgcmVkdWNlUmlnaHRXaXRoSW5kZXggfSBmcm9tICdmcC10cy9BcnJheSdcbiAqXG4gKiBjb25zdCBmID0gKGluZGV4OiBudW1iZXIsIGN1cjogdW5rbm93biwgYWNjOiBzdHJpbmcpID0+XG4gKiAgIGFjYyArICh0eXBlb2YgY3VyID09PSBcInN0cmluZ1wiID8gY3VyLnRvVXBwZXJDYXNlKCkgKyBpbmRleCA6IFwiXCIpO1xuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChyZWR1Y2VSaWdodFdpdGhJbmRleChcIlwiLCBmKShbMiwgXCJhXCIsIFwiYlwiLCBudWxsXSksIFwiQjJBMVwiKTtcbiAqXG4gKiBAY2F0ZWdvcnkgZm9sZGluZ1xuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgcmVkdWNlUmlnaHRXaXRoSW5kZXggPSBSQS5yZWR1Y2VSaWdodFdpdGhJbmRleDtcbi8qKlxuICogR2l2ZW4gYW4gaXRlcmF0aW5nIGZ1bmN0aW9uIHRoYXQgcmV0dXJucyBhIGBIS1RgIChoaWdoZXIga2luZGVkIHR5cGUpLCBgdHJhdmVyc2VgXG4gKiBhcHBsaWVzIHRoZSBpdGVyYXRpbmcgZnVuY3Rpb24gdG8gZWFjaCBlbGVtZW50IG9mIHRoZSBgQXJyYXlgIGFuZCB0aGVuIFtgc2VxdWVuY2VgXSgjc2VxdWVuY2UpLXNcbiAqIHRoZSByZXN1bHRzIHVzaW5nIHRoZSBwcm92aWRlZCBgQXBwbGljYXRpdmVgLlxuICpcbiAqIEUuZy4gc3VwcG9zZSB5b3UgaGF2ZSBhbiBgQXJyYXlgIGFuZCB5b3Ugd2FudCB0byBmb3JtYXQgZWFjaCBlbGVtZW50IHdpdGggYSBmdW5jdGlvblxuICogdGhhdCByZXR1cm5zIGEgcmVzdWx0IG9yIGFuIGVycm9yIGFzIGBmID0gKGE6IEEpID0+IEVpdGhlcjxFcnJvciwgQj5gLCB1c2luZyBgdHJhdmVyc2VgXG4gKiB5b3UgY2FuIGFwcGx5IGBmYCB0byBhbGwgZWxlbWVudHMgYW5kIGRpcmVjdGx5IG9idGFpbiBhcyBhIHJlc3VsdCBhbiBgRWl0aGVyPEVycm9yLEFycmF5PEI+PmBcbiAqIGkuZS4gYW4gYEFycmF5PEI+YCBpZiBhbGwgdGhlIHJlc3VsdHMgYXJlIGBCYCwgb3IgYW4gYEVycm9yYCBpZiBzb21lIG9mIHRoZSByZXN1bHRzXG4gKiBhcmUgYEVycm9yYHMuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IHRyYXZlcnNlIH0gZnJvbSAnZnAtdHMvQXJyYXknXG4gKiBpbXBvcnQgeyBBcHBsaWNhdGl2ZSwgbGVmdCwgcmlnaHQgfSBmcm9tIFwiZnAtdHMvbGliL0VpdGhlclwiO1xuICpcbiAqIGNvbnN0IGYgPSAoeDogdW5rbm93bikgPT5cbiAqICAgdHlwZW9mIHggPT09IFwic3RyaW5nXCIgPyByaWdodCh4LnRvVXBwZXJDYXNlKCkpIDogbGVmdChuZXcgRXJyb3IoXCJub3QgYSBzdHJpbmdcIikpO1xuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbCh0cmF2ZXJzZShBcHBsaWNhdGl2ZSkoZikoW1wiYVwiLCBcImJcIl0pLCByaWdodChbXCJBXCIsIFwiQlwiXSkpO1xuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbCh0cmF2ZXJzZShBcHBsaWNhdGl2ZSkoZikoW1wiYVwiLCA1XSksIGxlZnQobmV3IEVycm9yKFwibm90IGEgc3RyaW5nXCIpKSk7XG4gKlxuICogQGNhdGVnb3J5IHRyYXZlcnNpbmdcbiAqIEBzaW5jZSAyLjYuM1xuICovXG5leHBvcnQgdmFyIHRyYXZlcnNlID0gZnVuY3Rpb24gKEYpIHtcbiAgICB2YXIgdHJhdmVyc2VXaXRoSW5kZXhGID0gdHJhdmVyc2VXaXRoSW5kZXgoRik7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChmKSB7IHJldHVybiB0cmF2ZXJzZVdpdGhJbmRleEYoZnVuY3Rpb24gKF8sIGEpIHsgcmV0dXJuIGYoYSk7IH0pOyB9O1xufTtcbi8qKlxuICogYHNlcXVlbmNlYCB0YWtlcyBhbiBgQXJyYXlgIHdoZXJlIGVsZW1lbnRzIGFyZSBgSEtUPEE+YCAoaGlnaGVyIGtpbmRlZCB0eXBlKSBhbmQsXG4gKiB1c2luZyBhbiBhcHBsaWNhdGl2ZSBvZiB0aGF0IGBIS1RgLCByZXR1cm5zIGFuIGBIS1RgIG9mIGBBcnJheTxBPmAuXG4gKiBFLmcuIGl0IGNhbiB0dXJuIGFuIGBBcnJheTxFaXRoZXI8RXJyb3IsIHN0cmluZz4+YCBpbnRvIGFuIGBFaXRoZXI8RXJyb3IsIEFycmF5PHN0cmluZz4+YC5cbiAqXG4gKiBgc2VxdWVuY2VgIHJlcXVpcmVzIGFuIGBBcHBsaWNhdGl2ZWAgb2YgdGhlIGBIS1RgIHlvdSBhcmUgdGFyZ2V0aW5nLCBlLmcuIHRvIHR1cm4gYW5cbiAqIGBBcnJheTxFaXRoZXI8RSwgQT4+YCBpbnRvIGFuIGBFaXRoZXI8RSwgQXJyYXk8QT4+YCwgaXQgbmVlZHMgYW5cbiAqIGBBcHBsaWNhdGl2ZWAgZm9yIGBFaXRoZXJgLCB0byB0byB0dXJuIGFuIGBBcnJheTxPcHRpb248QT4+YCBpbnRvIGFuIGBPcHRpb248QXJyYXk8QT4+YCxcbiAqIGl0IG5lZWRzIGFuIGBBcHBsaWNhdGl2ZWAgZm9yIGBPcHRpb25gLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBzZXF1ZW5jZSB9IGZyb20gJ2ZwLXRzL0FycmF5J1xuICogaW1wb3J0IHsgQXBwbGljYXRpdmUsIGxlZnQsIHJpZ2h0IH0gZnJvbSBcImZwLXRzL2xpYi9FaXRoZXJcIjtcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKHNlcXVlbmNlKEFwcGxpY2F0aXZlKShbcmlnaHQoXCJhXCIpLCByaWdodChcImJcIildKSwgcmlnaHQoW1wiYVwiLCBcImJcIl0pKTtcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoXG4gKiAgIHNlcXVlbmNlKEFwcGxpY2F0aXZlKShbcmlnaHQoXCJhXCIpLCBsZWZ0KG5ldyBFcnJvcihcIm5vdCBhIHN0cmluZ1wiKSldKSxcbiAqICAgbGVmdChuZXcgRXJyb3IoXCJub3QgYSBzdHJpbmdcIikpXG4gKiApO1xuICpcbiAqIEBjYXRlZ29yeSB0cmF2ZXJzaW5nXG4gKiBAc2luY2UgMi42LjNcbiAqL1xuZXhwb3J0IHZhciBzZXF1ZW5jZSA9IGZ1bmN0aW9uIChGKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uICh0YSkge1xuICAgICAgICByZXR1cm4gX3JlZHVjZSh0YSwgRi5vZih6ZXJvKCkpLCBmdW5jdGlvbiAoZmFzLCBmYSkge1xuICAgICAgICAgICAgcmV0dXJuIEYuYXAoRi5tYXAoZmFzLCBmdW5jdGlvbiAoYXMpIHsgcmV0dXJuIGZ1bmN0aW9uIChhKSB7IHJldHVybiBwaXBlKGFzLCBhcHBlbmQoYSkpOyB9OyB9KSwgZmEpO1xuICAgICAgICB9KTtcbiAgICB9O1xufTtcbi8qKlxuICogU2FtZSBhcyBbYHRyYXZlcnNlYF0oI3RyYXZlcnNlKSBidXQgcGFzc2luZyBhbHNvIHRoZSBpbmRleCB0byB0aGUgaXRlcmF0aW5nIGZ1bmN0aW9uLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyB0cmF2ZXJzZVdpdGhJbmRleCB9IGZyb20gJ2ZwLXRzL0FycmF5J1xuICogaW1wb3J0IHsgQXBwbGljYXRpdmUsIGxlZnQsIHJpZ2h0IH0gZnJvbSBcImZwLXRzL2xpYi9FaXRoZXJcIjtcbiAqXG4gKiBjb25zdCBmID0gKGluZGV4Om51bWJlciwgeDp1bmtub3duKSA9PlxuICogICB0eXBlb2YgeCA9PT0gXCJzdHJpbmdcIiA/IHJpZ2h0KHgudG9VcHBlckNhc2UoKSArIGluZGV4KSA6IGxlZnQobmV3IEVycm9yKFwibm90IGEgc3RyaW5nXCIpKTtcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwodHJhdmVyc2VXaXRoSW5kZXgoQXBwbGljYXRpdmUpKGYpKFtcImFcIiwgXCJiXCJdKSwgcmlnaHQoW1wiQTBcIiwgXCJCMVwiXSkpO1xuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbCh0cmF2ZXJzZVdpdGhJbmRleChBcHBsaWNhdGl2ZSkoZikoW1wiYVwiLCA1XSksIGxlZnQobmV3IEVycm9yKFwibm90IGEgc3RyaW5nXCIpKSk7XG4gKlxuICogQGNhdGVnb3J5IHNlcXVlbmNpbmdcbiAqIEBzaW5jZSAyLjYuM1xuICovXG5leHBvcnQgdmFyIHRyYXZlcnNlV2l0aEluZGV4ID0gZnVuY3Rpb24gKEYpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGYpIHtcbiAgICAgICAgcmV0dXJuIHJlZHVjZVdpdGhJbmRleChGLm9mKHplcm8oKSksIGZ1bmN0aW9uIChpLCBmYnMsIGEpIHtcbiAgICAgICAgICAgIHJldHVybiBGLmFwKEYubWFwKGZicywgZnVuY3Rpb24gKGJzKSB7IHJldHVybiBmdW5jdGlvbiAoYikgeyByZXR1cm4gcGlwZShicywgYXBwZW5kKGIpKTsgfTsgfSksIGYoaSwgYSkpO1xuICAgICAgICB9KTtcbiAgICB9O1xufTtcbi8qKlxuICogQGNhdGVnb3J5IGZpbHRlcmluZ1xuICogQHNpbmNlIDIuNi41XG4gKi9cbmV4cG9ydCB2YXIgd2l0aGVyID0gZnVuY3Rpb24gKEYpIHtcbiAgICB2YXIgX3dpdGhlckYgPSBfd2l0aGVyKEYpO1xuICAgIHJldHVybiBmdW5jdGlvbiAoZikgeyByZXR1cm4gZnVuY3Rpb24gKGZhKSB7IHJldHVybiBfd2l0aGVyRihmYSwgZik7IH07IH07XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgZmlsdGVyaW5nXG4gKiBAc2luY2UgMi42LjVcbiAqL1xuZXhwb3J0IHZhciB3aWx0ID0gZnVuY3Rpb24gKEYpIHtcbiAgICB2YXIgX3dpbHRGID0gX3dpbHQoRik7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChmKSB7IHJldHVybiBmdW5jdGlvbiAoZmEpIHsgcmV0dXJuIF93aWx0RihmYSwgZik7IH07IH07XG59O1xuLyoqXG4gKiBgdW5mb2xkYCB0YWtlcyBhIGZ1bmN0aW9uIGBmYCB3aGljaCByZXR1cm5zIGFuIGBPcHRpb25gIG9mIGEgdHVwbGUgY29udGFpbmluZyBhbiBvdXRjb21lXG4gKiB2YWx1ZSBhbmQgYW4gaW5wdXQgZm9yIHRoZSBmb2xsb3dpbmcgaXRlcmF0aW9uLlxuICogYHVuZm9sZGAgYXBwbGllcyBgZmAgdG8gdGhlIGluaXRpYWwgdmFsdWUgYGJgIGFuZCB0aGVuIHJlY3Vyc2l2ZWx5IHRvIHRoZSBzZWNvbmRcbiAqIGVsZW1lbnQgb2YgdGhlIHR1cGxlIGNvbnRhaW5lZCBpbiB0aGUgcmV0dXJuZWQgYG9wdGlvbmAgb2YgdGhlIHByZXZpb3VzXG4gKiBjYWxjdWxhdGlvbiB1bnRpbCBgZmAgcmV0dXJucyBgT3B0aW9uLm5vbmVgLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyB1bmZvbGQgfSBmcm9tICdmcC10cy9BcnJheSdcbiAqIGltcG9ydCB7IG9wdGlvbiB9IGZyb20gJ2ZwLXRzJ1xuICpcbiAqIGNvbnN0IGYgPSAobjogbnVtYmVyKSA9PiB7XG4gKiAgIGlmIChuIDw9IDApIHJldHVybiBvcHRpb24ubm9uZTtcbiAqICAgY29uc3QgcmV0dXJuVmFsdWUgPSBuICogMjtcbiAqICAgY29uc3QgaW5wdXRGb3JOZXh0Um91bmQgPSBuIC0gMTtcbiAqICAgcmV0dXJuIG9wdGlvbi5zb21lKFtyZXR1cm5WYWx1ZSwgaW5wdXRGb3JOZXh0Um91bmRdIGFzIGNvbnN0KTtcbiAqIH07XG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKHVuZm9sZCg1LCBmKSwgWzEwLCA4LCA2LCA0LCAyXSk7XG4gKlxuICogQHNpbmNlIDIuNi42XG4gKi9cbmV4cG9ydCB2YXIgdW5mb2xkID0gZnVuY3Rpb24gKGIsIGYpIHtcbiAgICB2YXIgb3V0ID0gW107XG4gICAgdmFyIGJiID0gYjtcbiAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tY29uc3RhbnQtY29uZGl0aW9uXG4gICAgd2hpbGUgKHRydWUpIHtcbiAgICAgICAgdmFyIG10ID0gZihiYik7XG4gICAgICAgIGlmIChfLmlzU29tZShtdCkpIHtcbiAgICAgICAgICAgIHZhciBfYSA9IG10LnZhbHVlLCBhID0gX2FbMF0sIGJfMSA9IF9hWzFdO1xuICAgICAgICAgICAgb3V0LnB1c2goYSk7XG4gICAgICAgICAgICBiYiA9IGJfMTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiBvdXQ7XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgdHlwZSBsYW1iZGFzXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciBVUkkgPSAnQXJyYXknO1xuLyoqXG4gKiBgZ2V0U2hvd2AgbWFrZXMgYSBgU2hvd2AgZm9yIGFuIGBBcnJheTxBPmAgZnJvbSBhIGBTaG93YCBmb3JcbiAqIGFuIGBBYC5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgZ2V0U2hvdyB9IGZyb20gJ2ZwLXRzL0FycmF5J1xuICpcbiAqIGNvbnN0IG51bVNob3cgPSB7IHNob3c6IChuOiBudW1iZXIpID0+IChuID49IDAgPyBgJHtufWAgOiBgKCR7LW59KWApIH07XG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKGdldFNob3cobnVtU2hvdykuc2hvdyhbLTIsIC0xLCAwLCAxXSksIFwiWygyKSwgKDEpLCAwLCAxXVwiKTtcbiAqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciBnZXRTaG93ID0gUkEuZ2V0U2hvdztcbi8qKlxuICogR2V0IGEgYFNlbWlncm91cGAgYmFzZWQgb24gdGhlIGNvbmNhdGVuYXRpb24gb2YgYEFycmF5YHMuXG4gKiBTZWUgYWxzbyBbYGdldE1vbm9pZGBdKCNnZXRNb25vaWQpLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBnZXRTZW1pZ3JvdXAgfSBmcm9tICdmcC10cy9BcnJheSdcbiAqXG4gKiBjb25zdCBTID0gZ2V0U2VtaWdyb3VwPG51bWJlcj4oKTtcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoUy5jb25jYXQoWzEsIDJdLCBbMiwgM10pLCBbMSwgMiwgMiwgM10pO1xuICpcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjEwLjBcbiAqL1xuZXhwb3J0IHZhciBnZXRTZW1pZ3JvdXAgPSBmdW5jdGlvbiAoKSB7IHJldHVybiAoe1xuICAgIGNvbmNhdDogZnVuY3Rpb24gKGZpcnN0LCBzZWNvbmQpIHsgcmV0dXJuIGZpcnN0LmNvbmNhdChzZWNvbmQpOyB9XG59KTsgfTtcbi8qKlxuICogUmV0dXJucyBhIGBNb25vaWRgIGZvciBgQXJyYXk8QT5gIGJhc2VkIG9uIHRoZSBjb25jYXRlbmF0aW9uIG9mIGBBcnJheWBzLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBnZXRNb25vaWQgfSBmcm9tICdmcC10cy9BcnJheSdcbiAqXG4gKiBjb25zdCBNID0gZ2V0TW9ub2lkPG51bWJlcj4oKVxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChNLmNvbmNhdChbMSwgMl0sIFszLCA0XSksIFsxLCAyLCAzLCA0XSlcbiAqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciBnZXRNb25vaWQgPSBmdW5jdGlvbiAoKSB7IHJldHVybiAoe1xuICAgIGNvbmNhdDogZ2V0U2VtaWdyb3VwKCkuY29uY2F0LFxuICAgIGVtcHR5OiBbXVxufSk7IH07XG4vKipcbiAqIERlcml2ZXMgYW4gYEVxYCBvdmVyIHRoZSBgQXJyYXlgIG9mIGEgZ2l2ZW4gZWxlbWVudCB0eXBlIGZyb20gdGhlIGBFcWAgb2YgdGhhdCB0eXBlLiBUaGUgZGVyaXZlZCBgRXFgIGRlZmluZXMgdHdvXG4gKiBhcnJheXMgYXMgZXF1YWwgaWYgYWxsIGVsZW1lbnRzIG9mIGJvdGggYXJyYXlzIGFyZSBjb21wYXJlZCBlcXVhbCBwYWlyd2lzZSB3aXRoIHRoZSBnaXZlbiBgRWAuIEluIGNhc2Ugb2YgYXJyYXlzIG9mXG4gKiBkaWZmZXJlbnQgbGVuZ3RocywgdGhlIHJlc3VsdCBpcyBub24gZXF1YWxpdHkuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCAqIGFzIFMgZnJvbSAnZnAtdHMvc3RyaW5nJ1xuICogaW1wb3J0IHsgZ2V0RXEgfSBmcm9tICdmcC10cy9BcnJheSdcbiAqXG4gKiBjb25zdCBFID0gZ2V0RXEoUy5FcSlcbiAqIGFzc2VydC5zdHJpY3RFcXVhbChFLmVxdWFscyhbJ2EnLCAnYiddLCBbJ2EnLCAnYiddKSwgdHJ1ZSlcbiAqIGFzc2VydC5zdHJpY3RFcXVhbChFLmVxdWFscyhbJ2EnXSwgW10pLCBmYWxzZSlcbiAqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciBnZXRFcSA9IFJBLmdldEVxO1xuLyoqXG4gKiBEZXJpdmVzIGFuIGBPcmRgIG92ZXIgdGhlIGBBcnJheWAgb2YgYSBnaXZlbiBlbGVtZW50IHR5cGUgZnJvbSB0aGUgYE9yZGAgb2YgdGhhdCB0eXBlLiBUaGUgb3JkZXJpbmcgYmV0d2VlbiB0d28gc3VjaFxuICogYXJyYXlzIGlzIGVxdWFsIHRvOiB0aGUgZmlyc3Qgbm9uIGVxdWFsIGNvbXBhcmlzb24gb2YgZWFjaCBhcnJheXMgZWxlbWVudHMgdGFrZW4gcGFpcndpc2UgaW4gaW5jcmVhc2luZyBvcmRlciwgaW5cbiAqIGNhc2Ugb2YgZXF1YWxpdHkgb3ZlciBhbGwgdGhlIHBhaXJ3aXNlIGVsZW1lbnRzOyB0aGUgbG9uZ2VzdCBhcnJheSBpcyBjb25zaWRlcmVkIHRoZSBncmVhdGVzdCwgaWYgYm90aCBhcnJheXMgaGF2ZVxuICogdGhlIHNhbWUgbGVuZ3RoLCB0aGUgcmVzdWx0IGlzIGVxdWFsaXR5LlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBnZXRPcmQgfSBmcm9tICdmcC10cy9BcnJheSdcbiAqIGltcG9ydCAqIGFzIFMgZnJvbSAnZnAtdHMvc3RyaW5nJ1xuICpcbiAqIGNvbnN0IE8gPSBnZXRPcmQoUy5PcmQpXG4gKiBhc3NlcnQuc3RyaWN0RXF1YWwoTy5jb21wYXJlKFsnYiddLCBbJ2EnXSksIDEpXG4gKiBhc3NlcnQuc3RyaWN0RXF1YWwoTy5jb21wYXJlKFsnYSddLCBbJ2EnXSksIDApXG4gKiBhc3NlcnQuc3RyaWN0RXF1YWwoTy5jb21wYXJlKFsnYSddLCBbJ2InXSksIC0xKVxuICpcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIGdldE9yZCA9IFJBLmdldE9yZDtcbi8qKlxuICogR2V0IGEgYFNlbWlncm91cGAgYmFzZWQgb24gdGhlIHVuaW9uIG9mIHRoZSBlbGVtZW50cyBvZiBgQXJyYXlgcy5cbiAqIEVsZW1lbnRzIHdoaWNoIGVxdWFsIGFjY29yZGluZyB0byB0aGUgcHJvdmlkZWQgYEVxYCBhcmUgaW5jbHVkZWRcbiAqIG9ubHkgb25jZSBpbiB0aGUgcmVzdWx0LlxuICogU2VlIGFsc28gW2BnZXRVbmlvbk1vbm9pZGBdKCNnZXRVbmlvbk1vbm9pZCkuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IGdldFVuaW9uU2VtaWdyb3VwIH0gZnJvbSAnZnAtdHMvQXJyYXknO1xuICogaW1wb3J0IHsgRXEgfSBmcm9tICdmcC10cy9udW1iZXInO1xuICpcbiAqIGNvbnN0IFMgPSBnZXRVbmlvblNlbWlncm91cDxudW1iZXI+KEVxKTtcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoUy5jb25jYXQoWzEsIDJdLCBbMiwgM10pLCBbMSwgMiwgM10pO1xuICpcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjExLjBcbiAqL1xuZXhwb3J0IHZhciBnZXRVbmlvblNlbWlncm91cCA9IGZ1bmN0aW9uIChFKSB7XG4gICAgdmFyIHVuaW9uRSA9IHVuaW9uKEUpO1xuICAgIHJldHVybiB7XG4gICAgICAgIGNvbmNhdDogZnVuY3Rpb24gKGZpcnN0LCBzZWNvbmQpIHsgcmV0dXJuIHVuaW9uRShzZWNvbmQpKGZpcnN0KTsgfVxuICAgIH07XG59O1xuLyoqXG4gKiBHZXQgYSBgTW9ub2lkYCBiYXNlZCBvbiB0aGUgdW5pb24gb2YgdGhlIGVsZW1lbnRzIG9mIGBBcnJheWBzLlxuICogRWxlbWVudHMgd2hpY2ggZXF1YWwgYWNjb3JkaW5nIHRvIHRoZSBwcm92aWRlZCBgRXFgIGFyZSBpbmNsdWRlZFxuICogb25seSBvbmNlIGluIHRoZSByZXN1bHQuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IGdldFVuaW9uTW9ub2lkIH0gZnJvbSAnZnAtdHMvQXJyYXknXG4gKiBpbXBvcnQgeyBFcSB9IGZyb20gJ2ZwLXRzL251bWJlcic7XG4gKlxuICogY29uc3QgTSA9IGdldFVuaW9uTW9ub2lkPG51bWJlcj4oRXEpO1xuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChNLmNvbmNhdChbMSwgMl0sIFsyLCAzXSksIFsxLCAyLCAzXSk7XG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKE0uZW1wdHksW10pO1xuICpcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjExLjBcbiAqL1xuZXhwb3J0IHZhciBnZXRVbmlvbk1vbm9pZCA9IGZ1bmN0aW9uIChFKSB7IHJldHVybiAoe1xuICAgIGNvbmNhdDogZ2V0VW5pb25TZW1pZ3JvdXAoRSkuY29uY2F0LFxuICAgIGVtcHR5OiBbXVxufSk7IH07XG4vKipcbiAqIEdldCBhIGBTZW1pZ3JvdXBgIGJhc2VkIG9uIHRoZSBpbnRlcnNlY3Rpb24gb2YgdGhlIGVsZW1lbnRzIG9mIGBBcnJheWBzLlxuICogT25seSBlbGVtZW50cyBwcmVzZW50IGluIHRoZSB0d28gYXJyYXlzIHdoaWNoIGFyZSBlcXVhbCBhY2NvcmRpbmcgdG8gdGhlXG4gKiBwcm92aWRlZCBgRXFgIGFyZSBpbmNsdWRlZCBpbiB0aGUgcmVzdWx0LlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBnZXRJbnRlcnNlY3Rpb25TZW1pZ3JvdXAgfSBmcm9tICdmcC10cy9BcnJheSdcbiAqIGltcG9ydCB7IEVxIH0gZnJvbSAnZnAtdHMvbnVtYmVyJztcbiAqXG4gKiBjb25zdCBTID0gZ2V0SW50ZXJzZWN0aW9uU2VtaWdyb3VwPG51bWJlcj4oRXEpO1xuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChTLmNvbmNhdChbMSwgMl0sIFsyLCAzXSksIFsyXSk7XG4gKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIGdldEludGVyc2VjdGlvblNlbWlncm91cCA9IGZ1bmN0aW9uIChFKSB7XG4gICAgdmFyIGludGVyc2VjdGlvbkUgPSBpbnRlcnNlY3Rpb24oRSk7XG4gICAgcmV0dXJuIHtcbiAgICAgICAgY29uY2F0OiBmdW5jdGlvbiAoZmlyc3QsIHNlY29uZCkgeyByZXR1cm4gaW50ZXJzZWN0aW9uRShzZWNvbmQpKGZpcnN0KTsgfVxuICAgIH07XG59O1xuLyoqXG4gKiBHZXQgYSBgTWFnbWFgIGZvciBgQXJyYXlgIHdoZXJlIHRoZSBgY29uY2F0YCBmdW5jdGlvbiBpcyB0aGUgZGlmZmVybmNlIGJldHdlZW5cbiAqIHRoZSBmaXJzdCBhbmQgdGhlIHNlY29uZCBhcnJheSwgaS5lLiB0aGUgcmVzdWx0IGNvbnRhaW5zIGFsbCB0aGUgZWxlbWVudHMgb2YgdGhlXG4gKiBmaXJzdCBhcnJheSBmb3Igd2hpY2ggdGhlaXIgaXMgbm8gZXF1YWwgZWxlbWVudCBpbiB0aGUgc2Vjb25kIGFycmF5IGFjY29yZGluZ1xuICogdG8gdGhlIGBFcWAgcHJvdmlkZWQuXG4gKlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBnZXREaWZmZXJlbmNlTWFnbWEgfSBmcm9tICdmcC10cy9BcnJheSdcbiAqIGltcG9ydCB7IEVxIH0gZnJvbSAnZnAtdHMvbnVtYmVyJztcbiAqXG4gKiBjb25zdCBTID0gZ2V0RGlmZmVyZW5jZU1hZ21hPG51bWJlcj4oRXEpO1xuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChTLmNvbmNhdChbMSwgMl0sIFsyLCAzXSksIFsxXSk7XG4gKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIGdldERpZmZlcmVuY2VNYWdtYSA9IGZ1bmN0aW9uIChFKSB7XG4gICAgdmFyIGRpZmZlcmVuY2VFID0gZGlmZmVyZW5jZShFKTtcbiAgICByZXR1cm4ge1xuICAgICAgICBjb25jYXQ6IGZ1bmN0aW9uIChmaXJzdCwgc2Vjb25kKSB7IHJldHVybiBkaWZmZXJlbmNlRShzZWNvbmQpKGZpcnN0KTsgfVxuICAgIH07XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi43LjBcbiAqL1xuZXhwb3J0IHZhciBGdW5jdG9yID0ge1xuICAgIFVSSTogVVJJLFxuICAgIG1hcDogX21hcFxufTtcbi8qKlxuICogR2l2ZW4gYW4gaW5wdXQgYW4gYEFycmF5YCBvZiBmdW5jdGlvbnMsIGBmbGFwYCByZXR1cm5zIGFuIGBBcnJheWAgY29udGFpbmluZ1xuICogdGhlIHJlc3VsdHMgb2YgYXBwbHlpbmcgZWFjaCBmdW5jdGlvbiB0byB0aGUgZ2l2ZW4gaW5wdXQuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IGZsYXAgfSBmcm9tICdmcC10cy9BcnJheSdcbiAqXG4gKiBjb25zdCBmdW5zID0gW1xuICogICAobjogbnVtYmVyKSA9PiBgRG91YmxlOiAke24gKiAyfWAsXG4gKiAgIChuOiBudW1iZXIpID0+IGBUcmlwbGU6ICR7biAqIDN9YCxcbiAqICAgKG46IG51bWJlcikgPT4gYFNxdWFyZTogJHtuICogbn1gLFxuICogXTtcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoZmxhcCg0KShmdW5zKSwgWydEb3VibGU6IDgnLCAnVHJpcGxlOiAxMicsICdTcXVhcmU6IDE2J10pO1xuICpcbiAqIEBjYXRlZ29yeSBtYXBwaW5nXG4gKiBAc2luY2UgMi4xMC4wXG4gKi9cbmV4cG9ydCB2YXIgZmxhcCA9IC8qI19fUFVSRV9fKi8gZmxhcF8oRnVuY3Rvcik7XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjEwLjBcbiAqL1xuZXhwb3J0IHZhciBQb2ludGVkID0ge1xuICAgIFVSSTogVVJJLFxuICAgIG9mOiBvZlxufTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuNy4wXG4gKi9cbmV4cG9ydCB2YXIgRnVuY3RvcldpdGhJbmRleCA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICBtYXA6IF9tYXAsXG4gICAgbWFwV2l0aEluZGV4OiBfbWFwV2l0aEluZGV4XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi4xMC4wXG4gKi9cbmV4cG9ydCB2YXIgQXBwbHkgPSB7XG4gICAgVVJJOiBVUkksXG4gICAgbWFwOiBfbWFwLFxuICAgIGFwOiBfYXBcbn07XG4vKipcbiAqIENvbWJpbmUgdHdvIGVmZmVjdGZ1bCBhY3Rpb25zLCBrZWVwaW5nIG9ubHkgdGhlIHJlc3VsdCBvZiB0aGUgZmlyc3QuXG4gKlxuICogQHNpbmNlIDIuNS4wXG4gKi9cbmV4cG9ydCB2YXIgYXBGaXJzdCA9IC8qI19fUFVSRV9fKi8gYXBGaXJzdF8oQXBwbHkpO1xuLyoqXG4gKiBDb21iaW5lIHR3byBlZmZlY3RmdWwgYWN0aW9ucywga2VlcGluZyBvbmx5IHRoZSByZXN1bHQgb2YgdGhlIHNlY29uZC5cbiAqXG4gKiBAc2luY2UgMi41LjBcbiAqL1xuZXhwb3J0IHZhciBhcFNlY29uZCA9IC8qI19fUFVSRV9fKi8gYXBTZWNvbmRfKEFwcGx5KTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuNy4wXG4gKi9cbmV4cG9ydCB2YXIgQXBwbGljYXRpdmUgPSB7XG4gICAgVVJJOiBVUkksXG4gICAgbWFwOiBfbWFwLFxuICAgIGFwOiBfYXAsXG4gICAgb2Y6IG9mXG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi4xMC4wXG4gKi9cbmV4cG9ydCB2YXIgQ2hhaW4gPSB7XG4gICAgVVJJOiBVUkksXG4gICAgbWFwOiBfbWFwLFxuICAgIGFwOiBfYXAsXG4gICAgY2hhaW46IGZsYXRNYXBcbn07XG4vKipcbiAqIENvbXBvc2VzIGNvbXB1dGF0aW9ucyBpbiBzZXF1ZW5jZSwgdXNpbmcgdGhlIHJldHVybiB2YWx1ZSBvZiBvbmUgY29tcHV0YXRpb24gdG8gZGV0ZXJtaW5lIHRoZSBuZXh0IGNvbXB1dGF0aW9uIGFuZFxuICoga2VlcGluZyBvbmx5IHRoZSByZXN1bHQgb2YgdGhlIGZpcnN0LlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgKiBhcyBBIGZyb20gJ2ZwLXRzL0FycmF5J1xuICogaW1wb3J0IHsgcGlwZSB9IGZyb20gJ2ZwLXRzL2Z1bmN0aW9uJ1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoXG4gKiAgIHBpcGUoXG4gKiAgICAgWzEsIDIsIDNdLFxuICogICAgIEEuY2hhaW5GaXJzdCgoKSA9PiBbJ2EnLCAnYiddKVxuICogICApLFxuICogICBbMSwgMSwgMiwgMiwgMywgM11cbiAqIClcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoXG4gKiAgIHBpcGUoXG4gKiAgICAgWzEsIDIsIDNdLFxuICogICAgIEEuY2hhaW5GaXJzdCgoKSA9PiBbXSlcbiAqICAgKSxcbiAqICAgW11cbiAqIClcbiAqXG4gKiBAY2F0ZWdvcnkgc2VxdWVuY2luZ1xuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgY2hhaW5GaXJzdCA9IFxuLyojX19QVVJFX18qLyBjaGFpbkZpcnN0XyhDaGFpbik7XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjcuMFxuICovXG5leHBvcnQgdmFyIE1vbmFkID0ge1xuICAgIFVSSTogVVJJLFxuICAgIG1hcDogX21hcCxcbiAgICBhcDogX2FwLFxuICAgIG9mOiBvZixcbiAgICBjaGFpbjogZmxhdE1hcFxufTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuNy4wXG4gKi9cbmV4cG9ydCB2YXIgVW5mb2xkYWJsZSA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICB1bmZvbGQ6IHVuZm9sZFxufTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuNy4wXG4gKi9cbmV4cG9ydCB2YXIgQWx0ID0ge1xuICAgIFVSSTogVVJJLFxuICAgIG1hcDogX21hcCxcbiAgICBhbHQ6IF9hbHRcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjExLjBcbiAqL1xuZXhwb3J0IHZhciBaZXJvID0ge1xuICAgIFVSSTogVVJJLFxuICAgIHplcm86IHplcm9cbn07XG4vKipcbiAqIEBjYXRlZ29yeSBkbyBub3RhdGlvblxuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIGd1YXJkID0gLyojX19QVVJFX18qLyBndWFyZF8oWmVybywgUG9pbnRlZCk7XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjcuMFxuICovXG5leHBvcnQgdmFyIEFsdGVybmF0aXZlID0ge1xuICAgIFVSSTogVVJJLFxuICAgIG1hcDogX21hcCxcbiAgICBhcDogX2FwLFxuICAgIG9mOiBvZixcbiAgICBhbHQ6IF9hbHQsXG4gICAgemVybzogemVyb1xufTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuNy4wXG4gKi9cbmV4cG9ydCB2YXIgRXh0ZW5kID0ge1xuICAgIFVSSTogVVJJLFxuICAgIG1hcDogX21hcCxcbiAgICBleHRlbmQ6IF9leHRlbmRcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjcuMFxuICovXG5leHBvcnQgdmFyIENvbXBhY3RhYmxlID0ge1xuICAgIFVSSTogVVJJLFxuICAgIGNvbXBhY3Q6IGNvbXBhY3QsXG4gICAgc2VwYXJhdGU6IHNlcGFyYXRlXG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi43LjBcbiAqL1xuZXhwb3J0IHZhciBGaWx0ZXJhYmxlID0ge1xuICAgIFVSSTogVVJJLFxuICAgIG1hcDogX21hcCxcbiAgICBjb21wYWN0OiBjb21wYWN0LFxuICAgIHNlcGFyYXRlOiBzZXBhcmF0ZSxcbiAgICBmaWx0ZXI6IF9maWx0ZXIsXG4gICAgZmlsdGVyTWFwOiBfZmlsdGVyTWFwLFxuICAgIHBhcnRpdGlvbjogX3BhcnRpdGlvbixcbiAgICBwYXJ0aXRpb25NYXA6IF9wYXJ0aXRpb25NYXBcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjcuMFxuICovXG5leHBvcnQgdmFyIEZpbHRlcmFibGVXaXRoSW5kZXggPSB7XG4gICAgVVJJOiBVUkksXG4gICAgbWFwOiBfbWFwLFxuICAgIG1hcFdpdGhJbmRleDogX21hcFdpdGhJbmRleCxcbiAgICBjb21wYWN0OiBjb21wYWN0LFxuICAgIHNlcGFyYXRlOiBzZXBhcmF0ZSxcbiAgICBmaWx0ZXI6IF9maWx0ZXIsXG4gICAgZmlsdGVyTWFwOiBfZmlsdGVyTWFwLFxuICAgIHBhcnRpdGlvbjogX3BhcnRpdGlvbixcbiAgICBwYXJ0aXRpb25NYXA6IF9wYXJ0aXRpb25NYXAsXG4gICAgcGFydGl0aW9uTWFwV2l0aEluZGV4OiBfcGFydGl0aW9uTWFwV2l0aEluZGV4LFxuICAgIHBhcnRpdGlvbldpdGhJbmRleDogX3BhcnRpdGlvbldpdGhJbmRleCxcbiAgICBmaWx0ZXJNYXBXaXRoSW5kZXg6IF9maWx0ZXJNYXBXaXRoSW5kZXgsXG4gICAgZmlsdGVyV2l0aEluZGV4OiBfZmlsdGVyV2l0aEluZGV4XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi43LjBcbiAqL1xuZXhwb3J0IHZhciBGb2xkYWJsZSA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICByZWR1Y2U6IF9yZWR1Y2UsXG4gICAgZm9sZE1hcDogX2ZvbGRNYXAsXG4gICAgcmVkdWNlUmlnaHQ6IF9yZWR1Y2VSaWdodFxufTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuNy4wXG4gKi9cbmV4cG9ydCB2YXIgRm9sZGFibGVXaXRoSW5kZXggPSB7XG4gICAgVVJJOiBVUkksXG4gICAgcmVkdWNlOiBfcmVkdWNlLFxuICAgIGZvbGRNYXA6IF9mb2xkTWFwLFxuICAgIHJlZHVjZVJpZ2h0OiBfcmVkdWNlUmlnaHQsXG4gICAgcmVkdWNlV2l0aEluZGV4OiBfcmVkdWNlV2l0aEluZGV4LFxuICAgIGZvbGRNYXBXaXRoSW5kZXg6IF9mb2xkTWFwV2l0aEluZGV4LFxuICAgIHJlZHVjZVJpZ2h0V2l0aEluZGV4OiBfcmVkdWNlUmlnaHRXaXRoSW5kZXhcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjcuMFxuICovXG5leHBvcnQgdmFyIFRyYXZlcnNhYmxlID0ge1xuICAgIFVSSTogVVJJLFxuICAgIG1hcDogX21hcCxcbiAgICByZWR1Y2U6IF9yZWR1Y2UsXG4gICAgZm9sZE1hcDogX2ZvbGRNYXAsXG4gICAgcmVkdWNlUmlnaHQ6IF9yZWR1Y2VSaWdodCxcbiAgICB0cmF2ZXJzZTogX3RyYXZlcnNlLFxuICAgIHNlcXVlbmNlOiBzZXF1ZW5jZVxufTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuNy4wXG4gKi9cbmV4cG9ydCB2YXIgVHJhdmVyc2FibGVXaXRoSW5kZXggPSB7XG4gICAgVVJJOiBVUkksXG4gICAgbWFwOiBfbWFwLFxuICAgIG1hcFdpdGhJbmRleDogX21hcFdpdGhJbmRleCxcbiAgICByZWR1Y2U6IF9yZWR1Y2UsXG4gICAgZm9sZE1hcDogX2ZvbGRNYXAsXG4gICAgcmVkdWNlUmlnaHQ6IF9yZWR1Y2VSaWdodCxcbiAgICByZWR1Y2VXaXRoSW5kZXg6IF9yZWR1Y2VXaXRoSW5kZXgsXG4gICAgZm9sZE1hcFdpdGhJbmRleDogX2ZvbGRNYXBXaXRoSW5kZXgsXG4gICAgcmVkdWNlUmlnaHRXaXRoSW5kZXg6IF9yZWR1Y2VSaWdodFdpdGhJbmRleCxcbiAgICB0cmF2ZXJzZTogX3RyYXZlcnNlLFxuICAgIHNlcXVlbmNlOiBzZXF1ZW5jZSxcbiAgICB0cmF2ZXJzZVdpdGhJbmRleDogX3RyYXZlcnNlV2l0aEluZGV4XG59O1xudmFyIF93aXRoZXIgPSAvKiNfX1BVUkVfXyovIHdpdGhlckRlZmF1bHQoVHJhdmVyc2FibGUsIENvbXBhY3RhYmxlKTtcbnZhciBfd2lsdCA9IC8qI19fUFVSRV9fKi8gd2lsdERlZmF1bHQoVHJhdmVyc2FibGUsIENvbXBhY3RhYmxlKTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuNy4wXG4gKi9cbmV4cG9ydCB2YXIgV2l0aGVyYWJsZSA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICBtYXA6IF9tYXAsXG4gICAgY29tcGFjdDogY29tcGFjdCxcbiAgICBzZXBhcmF0ZTogc2VwYXJhdGUsXG4gICAgZmlsdGVyOiBfZmlsdGVyLFxuICAgIGZpbHRlck1hcDogX2ZpbHRlck1hcCxcbiAgICBwYXJ0aXRpb246IF9wYXJ0aXRpb24sXG4gICAgcGFydGl0aW9uTWFwOiBfcGFydGl0aW9uTWFwLFxuICAgIHJlZHVjZTogX3JlZHVjZSxcbiAgICBmb2xkTWFwOiBfZm9sZE1hcCxcbiAgICByZWR1Y2VSaWdodDogX3JlZHVjZVJpZ2h0LFxuICAgIHRyYXZlcnNlOiBfdHJhdmVyc2UsXG4gICAgc2VxdWVuY2U6IHNlcXVlbmNlLFxuICAgIHdpdGhlcjogX3dpdGhlcixcbiAgICB3aWx0OiBfd2lsdFxufTtcbi8qKlxuICogQGNhdGVnb3J5IHNlcXVlbmNpbmdcbiAqIEBzaW5jZSAyLjExLjBcbiAqL1xuZXhwb3J0IHZhciBjaGFpblJlY0RlcHRoRmlyc3QgPSBSQS5jaGFpblJlY0RlcHRoRmlyc3Q7XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjExLjBcbiAqL1xuZXhwb3J0IHZhciBDaGFpblJlY0RlcHRoRmlyc3QgPSB7XG4gICAgVVJJOiBVUkksXG4gICAgbWFwOiBfbWFwLFxuICAgIGFwOiBfYXAsXG4gICAgY2hhaW46IGZsYXRNYXAsXG4gICAgY2hhaW5SZWM6IF9jaGFpblJlY0RlcHRoRmlyc3Rcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBzZXF1ZW5jaW5nXG4gKiBAc2luY2UgMi4xMS4wXG4gKi9cbmV4cG9ydCB2YXIgY2hhaW5SZWNCcmVhZHRoRmlyc3QgPSBSQS5jaGFpblJlY0JyZWFkdGhGaXJzdDtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIENoYWluUmVjQnJlYWR0aEZpcnN0ID0ge1xuICAgIFVSSTogVVJJLFxuICAgIG1hcDogX21hcCxcbiAgICBhcDogX2FwLFxuICAgIGNoYWluOiBmbGF0TWFwLFxuICAgIGNoYWluUmVjOiBfY2hhaW5SZWNCcmVhZHRoRmlyc3Rcbn07XG4vKipcbiAqIEZpbHRlciB2YWx1ZXMgaW5zaWRlIGEgY29udGV4dC5cbiAqXG4gKiBAc2luY2UgMi4xMS4wXG4gKi9cbmV4cG9ydCB2YXIgZmlsdGVyRSA9IC8qI19fUFVSRV9fKi8gZmlsdGVyRV8oV2l0aGVyYWJsZSk7XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjExLjBcbiAqL1xuZXhwb3J0IHZhciBGcm9tRWl0aGVyID0ge1xuICAgIFVSSTogVVJJLFxuICAgIGZyb21FaXRoZXI6IGZyb21FaXRoZXJcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBsaWZ0aW5nXG4gKiBAc2luY2UgMi4xMS4wXG4gKi9cbmV4cG9ydCB2YXIgZnJvbUVpdGhlcksgPSAvKiNfX1BVUkVfXyovIGZyb21FaXRoZXJLXyhGcm9tRWl0aGVyKTtcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8vIHVuc2FmZVxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLyoqXG4gKiBAY2F0ZWdvcnkgdW5zYWZlXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciB1bnNhZmVJbnNlcnRBdCA9IE5FQS51bnNhZmVJbnNlcnRBdDtcbi8qKlxuICogQGNhdGVnb3J5IHVuc2FmZVxuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgdW5zYWZlVXBkYXRlQXQgPSBmdW5jdGlvbiAoaSwgYSwgYXMpIHtcbiAgICByZXR1cm4gaXNOb25FbXB0eShhcykgPyBORUEudW5zYWZlVXBkYXRlQXQoaSwgYSwgYXMpIDogW107XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgdW5zYWZlXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciB1bnNhZmVEZWxldGVBdCA9IGZ1bmN0aW9uIChpLCBhcykge1xuICAgIHZhciB4cyA9IGFzLnNsaWNlKCk7XG4gICAgeHMuc3BsaWNlKGksIDEpO1xuICAgIHJldHVybiB4cztcbn07XG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vLyB1dGlsc1xuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLyoqXG4gKiBgZXZlcnlgIHRlbGxzIGlmIHRoZSBwcm92aWRlZCBwcmVkaWNhdGUgaG9sZHMgdHJ1ZSBmb3IgZXZlcnkgZWxlbWVudCBpbiB0aGUgYEFycmF5YC5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgZXZlcnkgfSBmcm9tICdmcC10cy9BcnJheSdcbiAqXG4gKiBhc3NlcnQuZXF1YWwoZXZlcnkoKHg6IG51bWJlcikgPT4geCA+PSAwKShbMSwgMiwgM10pLCB0cnVlKTtcbiAqIGFzc2VydC5lcXVhbChldmVyeSgoeDogbnVtYmVyKSA9PiB4ID49IDApKFstMSwgMiwgM10pLCBmYWxzZSk7XG4gKlxuICogQHNpbmNlIDIuOS4wXG4gKi9cbmV4cG9ydCB2YXIgZXZlcnkgPSBSQS5ldmVyeTtcbi8qKlxuICogYHNvbWVgIHRlbGxzIGlmIHRoZSBwcm92aWRlZCBwcmVkaWNhdGUgaG9sZHMgdHJ1ZSBhdCBsZWFzdCBmb3Igb25lIGVsZW1lbnQgaW4gdGhlIGBBcnJheWAuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IHNvbWUgfSBmcm9tICdmcC10cy9BcnJheSdcbiAqXG4gKiBhc3NlcnQuZXF1YWwoc29tZSgoeDogbnVtYmVyKSA9PiB4ID49IDApKFsxLCAyLCAzXSksIHRydWUpO1xuICogYXNzZXJ0LmVxdWFsKHNvbWUoKHg6IG51bWJlcikgPT4geCA+PSAxMCkoWzEsIDIsIDNdKSwgZmFsc2UpO1xuICpcbiAqIEBzaW5jZSAyLjkuMFxuICovXG5leHBvcnQgdmFyIHNvbWUgPSBmdW5jdGlvbiAocHJlZGljYXRlKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykge1xuICAgICAgICByZXR1cm4gYXMuc29tZShwcmVkaWNhdGUpO1xuICAgIH07XG59O1xuLyoqXG4gKiBBbGlhcyBvZiBbYHNvbWVgXSgjc29tZSlcbiAqXG4gKiBAc2luY2UgMi4xMS4wXG4gKi9cbmV4cG9ydCB2YXIgZXhpc3RzID0gc29tZTtcbi8qKlxuICogUGxhY2VzIGFuIGVsZW1lbnQgaW4gYmV0d2VlbiBtZW1iZXJzIG9mIGFuIGBBcnJheWAsIHRoZW4gZm9sZHMgdGhlIHJlc3VsdHMgdXNpbmcgdGhlIHByb3ZpZGVkIGBNb25vaWRgLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgKiBhcyBTIGZyb20gJ2ZwLXRzL3N0cmluZydcbiAqIGltcG9ydCB7IGludGVyY2FsYXRlIH0gZnJvbSAnZnAtdHMvQXJyYXknXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChpbnRlcmNhbGF0ZShTLk1vbm9pZCkoJy0nKShbJ2EnLCAnYicsICdjJ10pLCAnYS1iLWMnKVxuICpcbiAqIEBzaW5jZSAyLjEyLjBcbiAqL1xuZXhwb3J0IHZhciBpbnRlcmNhbGF0ZSA9IFJBLmludGVyY2FsYXRlO1xuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLy8gZG8gbm90YXRpb25cbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8qKlxuICogQGNhdGVnb3J5IGRvIG5vdGF0aW9uXG4gKiBAc2luY2UgMi45LjBcbiAqL1xuZXhwb3J0IHZhciBEbyA9IC8qI19fUFVSRV9fKi8gb2YoXy5lbXB0eVJlY29yZCk7XG4vKipcbiAqIEBjYXRlZ29yeSBkbyBub3RhdGlvblxuICogQHNpbmNlIDIuOC4wXG4gKi9cbmV4cG9ydCB2YXIgYmluZFRvID0gLyojX19QVVJFX18qLyBiaW5kVG9fKEZ1bmN0b3IpO1xudmFyIGxldF8gPSAvKiNfX1BVUkVfXyovIGxldF9fKEZ1bmN0b3IpO1xuZXhwb3J0IHsgXG4vKipcbiAqIEBjYXRlZ29yeSBkbyBub3RhdGlvblxuICogQHNpbmNlIDIuMTMuMFxuICovXG5sZXRfIGFzIGxldCB9O1xuLyoqXG4gKiBAY2F0ZWdvcnkgZG8gbm90YXRpb25cbiAqIEBzaW5jZSAyLjguMFxuICovXG5leHBvcnQgdmFyIGJpbmQgPSAvKiNfX1BVUkVfXyovIGJpbmRfKENoYWluKTtcbi8qKlxuICogQGNhdGVnb3J5IGRvIG5vdGF0aW9uXG4gKiBAc2luY2UgMi44LjBcbiAqL1xuZXhwb3J0IHZhciBhcFMgPSAvKiNfX1BVUkVfXyovIGFwU18oQXBwbHkpO1xuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLy8gbGVnYWN5XG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vKipcbiAqIEFsaWFzIG9mIGBmbGF0TWFwYC5cbiAqXG4gKiBAY2F0ZWdvcnkgbGVnYWN5XG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciBjaGFpbiA9IGZsYXRNYXA7XG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vLyBkZXByZWNhdGVkXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vKipcbiAqIFVzZSBgTm9uRW1wdHlBcnJheWAgbW9kdWxlIGluc3RlYWQuXG4gKlxuICogQGNhdGVnb3J5IHpvbmUgb2YgZGVhdGhcbiAqIEBzaW5jZSAyLjAuMFxuICogQGRlcHJlY2F0ZWRcbiAqL1xuZXhwb3J0IHZhciByYW5nZSA9IE5FQS5yYW5nZTtcbi8qKlxuICogVXNlIGEgbmV3IGBbXWAgaW5zdGVhZC5cbiAqXG4gKiBAY2F0ZWdvcnkgem9uZSBvZiBkZWF0aFxuICogQHNpbmNlIDIuMC4wXG4gKiBAZGVwcmVjYXRlZFxuICovXG5leHBvcnQgdmFyIGVtcHR5ID0gW107XG4vKipcbiAqIFVzZSBgcHJlcGVuZGAgaW5zdGVhZC5cbiAqXG4gKiBAY2F0ZWdvcnkgem9uZSBvZiBkZWF0aFxuICogQHNpbmNlIDIuMC4wXG4gKiBAZGVwcmVjYXRlZFxuICovXG5leHBvcnQgdmFyIGNvbnMgPSBORUEuY29ucztcbi8qKlxuICogVXNlIGBhcHBlbmRgIGluc3RlYWQuXG4gKlxuICogQGNhdGVnb3J5IHpvbmUgb2YgZGVhdGhcbiAqIEBzaW5jZSAyLjAuMFxuICogQGRlcHJlY2F0ZWRcbiAqL1xuZXhwb3J0IHZhciBzbm9jID0gTkVBLnNub2M7XG4vKipcbiAqIFVzZSBgcHJlcGVuZEFsbGAgaW5zdGVhZFxuICpcbiAqIEBjYXRlZ29yeSB6b25lIG9mIGRlYXRoXG4gKiBAc2luY2UgMi45LjBcbiAqIEBkZXByZWNhdGVkXG4gKi9cbmV4cG9ydCB2YXIgcHJlcGVuZFRvQWxsID0gcHJlcGVuZEFsbDtcbi8qKlxuICogVGhpcyBpbnN0YW5jZSBpcyBkZXByZWNhdGVkLCB1c2Ugc21hbGwsIHNwZWNpZmljIGluc3RhbmNlcyBpbnN0ZWFkLlxuICogRm9yIGV4YW1wbGUgaWYgYSBmdW5jdGlvbiBuZWVkcyBhIGBGdW5jdG9yYCBpbnN0YW5jZSwgcGFzcyBgQS5GdW5jdG9yYCBpbnN0ZWFkIG9mIGBBLmFycmF5YFxuICogKHdoZXJlIGBBYCBpcyBmcm9tIGBpbXBvcnQgQSBmcm9tICdmcC10cy9BcnJheSdgKVxuICpcbiAqIEBjYXRlZ29yeSB6b25lIG9mIGRlYXRoXG4gKiBAc2luY2UgMi4wLjBcbiAqIEBkZXByZWNhdGVkXG4gKi9cbmV4cG9ydCB2YXIgYXJyYXkgPSB7XG4gICAgVVJJOiBVUkksXG4gICAgY29tcGFjdDogY29tcGFjdCxcbiAgICBzZXBhcmF0ZTogc2VwYXJhdGUsXG4gICAgbWFwOiBfbWFwLFxuICAgIGFwOiBfYXAsXG4gICAgb2Y6IG9mLFxuICAgIGNoYWluOiBmbGF0TWFwLFxuICAgIGZpbHRlcjogX2ZpbHRlcixcbiAgICBmaWx0ZXJNYXA6IF9maWx0ZXJNYXAsXG4gICAgcGFydGl0aW9uOiBfcGFydGl0aW9uLFxuICAgIHBhcnRpdGlvbk1hcDogX3BhcnRpdGlvbk1hcCxcbiAgICBtYXBXaXRoSW5kZXg6IF9tYXBXaXRoSW5kZXgsXG4gICAgcGFydGl0aW9uTWFwV2l0aEluZGV4OiBfcGFydGl0aW9uTWFwV2l0aEluZGV4LFxuICAgIHBhcnRpdGlvbldpdGhJbmRleDogX3BhcnRpdGlvbldpdGhJbmRleCxcbiAgICBmaWx0ZXJNYXBXaXRoSW5kZXg6IF9maWx0ZXJNYXBXaXRoSW5kZXgsXG4gICAgZmlsdGVyV2l0aEluZGV4OiBfZmlsdGVyV2l0aEluZGV4LFxuICAgIGFsdDogX2FsdCxcbiAgICB6ZXJvOiB6ZXJvLFxuICAgIHVuZm9sZDogdW5mb2xkLFxuICAgIHJlZHVjZTogX3JlZHVjZSxcbiAgICBmb2xkTWFwOiBfZm9sZE1hcCxcbiAgICByZWR1Y2VSaWdodDogX3JlZHVjZVJpZ2h0LFxuICAgIHRyYXZlcnNlOiBfdHJhdmVyc2UsXG4gICAgc2VxdWVuY2U6IHNlcXVlbmNlLFxuICAgIHJlZHVjZVdpdGhJbmRleDogX3JlZHVjZVdpdGhJbmRleCxcbiAgICBmb2xkTWFwV2l0aEluZGV4OiBfZm9sZE1hcFdpdGhJbmRleCxcbiAgICByZWR1Y2VSaWdodFdpdGhJbmRleDogX3JlZHVjZVJpZ2h0V2l0aEluZGV4LFxuICAgIHRyYXZlcnNlV2l0aEluZGV4OiBfdHJhdmVyc2VXaXRoSW5kZXgsXG4gICAgZXh0ZW5kOiBfZXh0ZW5kLFxuICAgIHdpdGhlcjogX3dpdGhlcixcbiAgICB3aWx0OiBfd2lsdFxufTtcbiIsCiAgImltcG9ydCB7IGNvbnN0RmFsc2UsIGNvbnN0VHJ1ZSwgZmxvdywgcGlwZSB9IGZyb20gJy4vZnVuY3Rpb24nO1xudmFyIGNvbnRyYW1hcF8gPSBmdW5jdGlvbiAocHJlZGljYXRlLCBmKSB7IHJldHVybiBwaXBlKHByZWRpY2F0ZSwgY29udHJhbWFwKGYpKTsgfTtcbi8qKlxuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIGNvbnRyYW1hcCA9IGZ1bmN0aW9uIChmKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChwcmVkaWNhdGUpIHtcbiAgICAgICAgcmV0dXJuIGZsb3coZiwgcHJlZGljYXRlKTtcbiAgICB9O1xufTtcbi8qKlxuICogQGNhdGVnb3J5IHR5cGUgbGFtYmRhc1xuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIFVSSSA9ICdQcmVkaWNhdGUnO1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi4xMS4wXG4gKi9cbmV4cG9ydCB2YXIgZ2V0U2VtaWdyb3VwQW55ID0gZnVuY3Rpb24gKCkgeyByZXR1cm4gKHtcbiAgICBjb25jYXQ6IGZ1bmN0aW9uIChmaXJzdCwgc2Vjb25kKSB7IHJldHVybiBwaXBlKGZpcnN0LCBvcihzZWNvbmQpKTsgfVxufSk7IH07XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjExLjBcbiAqL1xuZXhwb3J0IHZhciBnZXRNb25vaWRBbnkgPSBmdW5jdGlvbiAoKSB7IHJldHVybiAoe1xuICAgIGNvbmNhdDogZ2V0U2VtaWdyb3VwQW55KCkuY29uY2F0LFxuICAgIGVtcHR5OiBjb25zdEZhbHNlXG59KTsgfTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIGdldFNlbWlncm91cEFsbCA9IGZ1bmN0aW9uICgpIHsgcmV0dXJuICh7XG4gICAgY29uY2F0OiBmdW5jdGlvbiAoZmlyc3QsIHNlY29uZCkgeyByZXR1cm4gcGlwZShmaXJzdCwgYW5kKHNlY29uZCkpOyB9XG59KTsgfTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIGdldE1vbm9pZEFsbCA9IGZ1bmN0aW9uICgpIHsgcmV0dXJuICh7XG4gICAgY29uY2F0OiBnZXRTZW1pZ3JvdXBBbGwoKS5jb25jYXQsXG4gICAgZW1wdHk6IGNvbnN0VHJ1ZVxufSk7IH07XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjExLjBcbiAqL1xuZXhwb3J0IHZhciBDb250cmF2YXJpYW50ID0ge1xuICAgIFVSSTogVVJJLFxuICAgIGNvbnRyYW1hcDogY29udHJhbWFwX1xufTtcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8vIHV0aWxzXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vKipcbiAqIEBzaW5jZSAyLjExLjBcbiAqL1xuZXhwb3J0IHZhciBub3QgPSBmdW5jdGlvbiAocHJlZGljYXRlKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhKSB7XG4gICAgICAgIHJldHVybiAhcHJlZGljYXRlKGEpO1xuICAgIH07XG59O1xuLyoqXG4gKiBAc2luY2UgMi4xMS4wXG4gKi9cbmV4cG9ydCB2YXIgb3IgPSBmdW5jdGlvbiAoc2Vjb25kKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChmaXJzdCkge1xuICAgICAgICByZXR1cm4gZnVuY3Rpb24gKGEpIHtcbiAgICAgICAgICAgIHJldHVybiBmaXJzdChhKSB8fCBzZWNvbmQoYSk7XG4gICAgICAgIH07XG4gICAgfTtcbn07XG4vKipcbiAqIEBzaW5jZSAyLjExLjBcbiAqL1xuZXhwb3J0IHZhciBhbmQgPSBmdW5jdGlvbiAoc2Vjb25kKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChmaXJzdCkge1xuICAgICAgICByZXR1cm4gZnVuY3Rpb24gKGEpIHtcbiAgICAgICAgICAgIHJldHVybiBmaXJzdChhKSAmJiBzZWNvbmQoYSk7XG4gICAgICAgIH07XG4gICAgfTtcbn07XG4iLAogICJpbXBvcnQgeyBjb25zdEZhbHNlLCBjb25zdFRydWUsIGZsb3csIHBpcGUgfSBmcm9tICcuL2Z1bmN0aW9uJztcbnZhciBjb250cmFtYXBfID0gZnVuY3Rpb24gKHByZWRpY2F0ZSwgZikgeyByZXR1cm4gcGlwZShwcmVkaWNhdGUsIGNvbnRyYW1hcChmKSk7IH07XG4vKipcbiAqIEBzaW5jZSAyLjExLjBcbiAqL1xuZXhwb3J0IHZhciBjb250cmFtYXAgPSBmdW5jdGlvbiAoZikge1xuICAgIHJldHVybiBmdW5jdGlvbiAocHJlZGljYXRlKSB7XG4gICAgICAgIHJldHVybiBmbG93KGYsIHByZWRpY2F0ZSk7XG4gICAgfTtcbn07XG4vKipcbiAqIEBjYXRlZ29yeSB0eXBlIGxhbWJkYXNcbiAqIEBzaW5jZSAyLjExLjBcbiAqL1xuZXhwb3J0IHZhciBVUkkgPSAnUHJlZGljYXRlJztcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIGdldFNlbWlncm91cEFueSA9IGZ1bmN0aW9uICgpIHsgcmV0dXJuICh7XG4gICAgY29uY2F0OiBmdW5jdGlvbiAoZmlyc3QsIHNlY29uZCkgeyByZXR1cm4gcGlwZShmaXJzdCwgb3Ioc2Vjb25kKSk7IH1cbn0pOyB9O1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi4xMS4wXG4gKi9cbmV4cG9ydCB2YXIgZ2V0TW9ub2lkQW55ID0gZnVuY3Rpb24gKCkgeyByZXR1cm4gKHtcbiAgICBjb25jYXQ6IGdldFNlbWlncm91cEFueSgpLmNvbmNhdCxcbiAgICBlbXB0eTogY29uc3RGYWxzZVxufSk7IH07XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjExLjBcbiAqL1xuZXhwb3J0IHZhciBnZXRTZW1pZ3JvdXBBbGwgPSBmdW5jdGlvbiAoKSB7IHJldHVybiAoe1xuICAgIGNvbmNhdDogZnVuY3Rpb24gKGZpcnN0LCBzZWNvbmQpIHsgcmV0dXJuIHBpcGUoZmlyc3QsIGFuZChzZWNvbmQpKTsgfVxufSk7IH07XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjExLjBcbiAqL1xuZXhwb3J0IHZhciBnZXRNb25vaWRBbGwgPSBmdW5jdGlvbiAoKSB7IHJldHVybiAoe1xuICAgIGNvbmNhdDogZ2V0U2VtaWdyb3VwQWxsKCkuY29uY2F0LFxuICAgIGVtcHR5OiBjb25zdFRydWVcbn0pOyB9O1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi4xMS4wXG4gKi9cbmV4cG9ydCB2YXIgQ29udHJhdmFyaWFudCA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICBjb250cmFtYXA6IGNvbnRyYW1hcF9cbn07XG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vLyB1dGlsc1xuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLyoqXG4gKiBAc2luY2UgMi4xMS4wXG4gKi9cbmV4cG9ydCB2YXIgbm90ID0gZnVuY3Rpb24gKHByZWRpY2F0ZSkge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYSkge1xuICAgICAgICByZXR1cm4gIXByZWRpY2F0ZShhKTtcbiAgICB9O1xufTtcbi8qKlxuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIG9yID0gZnVuY3Rpb24gKHNlY29uZCkge1xuICAgIHJldHVybiBmdW5jdGlvbiAoZmlyc3QpIHtcbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIChhKSB7XG4gICAgICAgICAgICByZXR1cm4gZmlyc3QoYSkgfHwgc2Vjb25kKGEpO1xuICAgICAgICB9O1xuICAgIH07XG59O1xuLyoqXG4gKiBAc2luY2UgMi4xMS4wXG4gKi9cbmV4cG9ydCB2YXIgYW5kID0gZnVuY3Rpb24gKHNlY29uZCkge1xuICAgIHJldHVybiBmdW5jdGlvbiAoZmlyc3QpIHtcbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIChhKSB7XG4gICAgICAgICAgICByZXR1cm4gZmlyc3QoYSkgJiYgc2Vjb25kKGEpO1xuICAgICAgICB9O1xuICAgIH07XG59O1xuIiwKICAiaW1wb3J0IHsgZ2V0QXBwbGljYXRpdmVNb25vaWQgfSBmcm9tICcuL0FwcGxpY2F0aXZlJztcbmltcG9ydCB7IGFwRmlyc3QgYXMgYXBGaXJzdF8sIGFwUyBhcyBhcFNfLCBhcFNlY29uZCBhcyBhcFNlY29uZF8sIGdldEFwcGx5U2VtaWdyb3VwIGFzIGdldEFwcGx5U2VtaWdyb3VwXyB9IGZyb20gJy4vQXBwbHknO1xuaW1wb3J0ICogYXMgY2hhaW5hYmxlIGZyb20gJy4vQ2hhaW4nO1xuaW1wb3J0IHsgY2hhaW5FaXRoZXJLIGFzIGNoYWluRWl0aGVyS18sIGZyb21FaXRoZXJLIGFzIGZyb21FaXRoZXJLXywgdGFwRWl0aGVyIGFzIHRhcEVpdGhlcl8gfSBmcm9tICcuL0Zyb21FaXRoZXInO1xuaW1wb3J0IHsgY29uc3ROdWxsLCBjb25zdFVuZGVmaW5lZCwgZHVhbCwgZmxvdywgaWRlbnRpdHksIHBpcGUgfSBmcm9tICcuL2Z1bmN0aW9uJztcbmltcG9ydCB7IGFzIGFzIGFzXywgYXNVbml0IGFzIGFzVW5pdF8sIGJpbmRUbyBhcyBiaW5kVG9fLCBmbGFwIGFzIGZsYXBfLCBsZXQgYXMgbGV0X18gfSBmcm9tICcuL0Z1bmN0b3InO1xuaW1wb3J0ICogYXMgXyBmcm9tICcuL2ludGVybmFsJztcbmltcG9ydCB7IG5vdCB9IGZyb20gJy4vUHJlZGljYXRlJztcbmltcG9ydCB7IGZpcnN0LCBsYXN0IH0gZnJvbSAnLi9TZW1pZ3JvdXAnO1xuaW1wb3J0IHsgc2VwYXJhdGVkIH0gZnJvbSAnLi9TZXBhcmF0ZWQnO1xuaW1wb3J0IHsgd2lsdERlZmF1bHQsIHdpdGhlckRlZmF1bHQgfSBmcm9tICcuL1dpdGhlcmFibGUnO1xuaW1wb3J0IHsgZ3VhcmQgYXMgZ3VhcmRfIH0gZnJvbSAnLi9aZXJvJztcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8vIGNvbnN0cnVjdG9yc1xuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLyoqXG4gKiBgTm9uZWAgZG9lc24ndCBoYXZlIGEgY29uc3RydWN0b3IsIGluc3RlYWQgeW91IGNhbiB1c2UgaXQgZGlyZWN0bHkgYXMgYSB2YWx1ZS4gUmVwcmVzZW50cyBhIG1pc3NpbmcgdmFsdWUuXG4gKlxuICogQGNhdGVnb3J5IGNvbnN0cnVjdG9yc1xuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgbm9uZSA9IF8ubm9uZTtcbi8qKlxuICogQ29uc3RydWN0cyBhIGBTb21lYC4gUmVwcmVzZW50cyBhbiBvcHRpb25hbCB2YWx1ZSB0aGF0IGV4aXN0cy5cbiAqXG4gKiBAY2F0ZWdvcnkgY29uc3RydWN0b3JzXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciBzb21lID0gXy5zb21lO1xuZXhwb3J0IGZ1bmN0aW9uIGZyb21QcmVkaWNhdGUocHJlZGljYXRlKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhKSB7IHJldHVybiAocHJlZGljYXRlKGEpID8gc29tZShhKSA6IG5vbmUpOyB9O1xufVxuLyoqXG4gKiBSZXR1cm5zIHRoZSBgTGVmdGAgdmFsdWUgb2YgYW4gYEVpdGhlcmAgaWYgcG9zc2libGUuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IGdldExlZnQsIG5vbmUsIHNvbWUgfSBmcm9tICdmcC10cy9PcHRpb24nXG4gKiBpbXBvcnQgeyByaWdodCwgbGVmdCB9IGZyb20gJ2ZwLXRzL0VpdGhlcidcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKGdldExlZnQocmlnaHQoMSkpLCBub25lKVxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChnZXRMZWZ0KGxlZnQoJ2EnKSksIHNvbWUoJ2EnKSlcbiAqXG4gKiBAY2F0ZWdvcnkgY29uc3RydWN0b3JzXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciBnZXRMZWZ0ID0gZnVuY3Rpb24gKG1hKSB7IHJldHVybiAobWEuX3RhZyA9PT0gJ1JpZ2h0JyA/IG5vbmUgOiBzb21lKG1hLmxlZnQpKTsgfTtcbi8qKlxuICogUmV0dXJucyB0aGUgYFJpZ2h0YCB2YWx1ZSBvZiBhbiBgRWl0aGVyYCBpZiBwb3NzaWJsZS5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgZ2V0UmlnaHQsIG5vbmUsIHNvbWUgfSBmcm9tICdmcC10cy9PcHRpb24nXG4gKiBpbXBvcnQgeyByaWdodCwgbGVmdCB9IGZyb20gJ2ZwLXRzL0VpdGhlcidcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKGdldFJpZ2h0KHJpZ2h0KDEpKSwgc29tZSgxKSlcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoZ2V0UmlnaHQobGVmdCgnYScpKSwgbm9uZSlcbiAqXG4gKiBAY2F0ZWdvcnkgY29uc3RydWN0b3JzXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciBnZXRSaWdodCA9IGZ1bmN0aW9uIChtYSkgeyByZXR1cm4gKG1hLl90YWcgPT09ICdMZWZ0JyA/IG5vbmUgOiBzb21lKG1hLnJpZ2h0KSk7IH07XG52YXIgX21hcCA9IGZ1bmN0aW9uIChmYSwgZikgeyByZXR1cm4gcGlwZShmYSwgbWFwKGYpKTsgfTtcbnZhciBfYXAgPSBmdW5jdGlvbiAoZmFiLCBmYSkgeyByZXR1cm4gcGlwZShmYWIsIGFwKGZhKSk7IH07XG52YXIgX3JlZHVjZSA9IGZ1bmN0aW9uIChmYSwgYiwgZikgeyByZXR1cm4gcGlwZShmYSwgcmVkdWNlKGIsIGYpKTsgfTtcbnZhciBfZm9sZE1hcCA9IGZ1bmN0aW9uIChNKSB7XG4gICAgdmFyIGZvbGRNYXBNID0gZm9sZE1hcChNKTtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGZhLCBmKSB7IHJldHVybiBwaXBlKGZhLCBmb2xkTWFwTShmKSk7IH07XG59O1xudmFyIF9yZWR1Y2VSaWdodCA9IGZ1bmN0aW9uIChmYSwgYiwgZikgeyByZXR1cm4gcGlwZShmYSwgcmVkdWNlUmlnaHQoYiwgZikpOyB9O1xudmFyIF90cmF2ZXJzZSA9IGZ1bmN0aW9uIChGKSB7XG4gICAgdmFyIHRyYXZlcnNlRiA9IHRyYXZlcnNlKEYpO1xuICAgIHJldHVybiBmdW5jdGlvbiAodGEsIGYpIHsgcmV0dXJuIHBpcGUodGEsIHRyYXZlcnNlRihmKSk7IH07XG59O1xuLyogaXN0YW5idWwgaWdub3JlIG5leHQgKi9cbnZhciBfYWx0ID0gZnVuY3Rpb24gKGZhLCB0aGF0KSB7IHJldHVybiBwaXBlKGZhLCBhbHQodGhhdCkpOyB9O1xudmFyIF9maWx0ZXIgPSBmdW5jdGlvbiAoZmEsIHByZWRpY2F0ZSkgeyByZXR1cm4gcGlwZShmYSwgZmlsdGVyKHByZWRpY2F0ZSkpOyB9O1xuLyogaXN0YW5idWwgaWdub3JlIG5leHQgKi9cbnZhciBfZmlsdGVyTWFwID0gZnVuY3Rpb24gKGZhLCBmKSB7IHJldHVybiBwaXBlKGZhLCBmaWx0ZXJNYXAoZikpOyB9O1xuLyogaXN0YW5idWwgaWdub3JlIG5leHQgKi9cbnZhciBfZXh0ZW5kID0gZnVuY3Rpb24gKHdhLCBmKSB7IHJldHVybiBwaXBlKHdhLCBleHRlbmQoZikpOyB9O1xuLyogaXN0YW5idWwgaWdub3JlIG5leHQgKi9cbnZhciBfcGFydGl0aW9uID0gZnVuY3Rpb24gKGZhLCBwcmVkaWNhdGUpIHtcbiAgICByZXR1cm4gcGlwZShmYSwgcGFydGl0aW9uKHByZWRpY2F0ZSkpO1xufTtcbi8qIGlzdGFuYnVsIGlnbm9yZSBuZXh0ICovXG52YXIgX3BhcnRpdGlvbk1hcCA9IGZ1bmN0aW9uIChmYSwgZikgeyByZXR1cm4gcGlwZShmYSwgcGFydGl0aW9uTWFwKGYpKTsgfTtcbi8qKlxuICogQGNhdGVnb3J5IHR5cGUgbGFtYmRhc1xuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgVVJJID0gJ09wdGlvbic7XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIGdldFNob3cgPSBmdW5jdGlvbiAoUykgeyByZXR1cm4gKHtcbiAgICBzaG93OiBmdW5jdGlvbiAobWEpIHsgcmV0dXJuIChpc05vbmUobWEpID8gJ25vbmUnIDogXCJzb21lKFwiLmNvbmNhdChTLnNob3cobWEudmFsdWUpLCBcIilcIikpOyB9XG59KTsgfTtcbi8qKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IG5vbmUsIHNvbWUsIGdldEVxIH0gZnJvbSAnZnAtdHMvT3B0aW9uJ1xuICogaW1wb3J0ICogYXMgTiBmcm9tICdmcC10cy9udW1iZXInXG4gKlxuICogY29uc3QgRSA9IGdldEVxKE4uRXEpXG4gKiBhc3NlcnQuc3RyaWN0RXF1YWwoRS5lcXVhbHMobm9uZSwgbm9uZSksIHRydWUpXG4gKiBhc3NlcnQuc3RyaWN0RXF1YWwoRS5lcXVhbHMobm9uZSwgc29tZSgxKSksIGZhbHNlKVxuICogYXNzZXJ0LnN0cmljdEVxdWFsKEUuZXF1YWxzKHNvbWUoMSksIG5vbmUpLCBmYWxzZSlcbiAqIGFzc2VydC5zdHJpY3RFcXVhbChFLmVxdWFscyhzb21lKDEpLCBzb21lKDIpKSwgZmFsc2UpXG4gKiBhc3NlcnQuc3RyaWN0RXF1YWwoRS5lcXVhbHMoc29tZSgxKSwgc29tZSgxKSksIHRydWUpXG4gKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgZ2V0RXEgPSBmdW5jdGlvbiAoRSkgeyByZXR1cm4gKHtcbiAgICBlcXVhbHM6IGZ1bmN0aW9uICh4LCB5KSB7IHJldHVybiB4ID09PSB5IHx8IChpc05vbmUoeCkgPyBpc05vbmUoeSkgOiBpc05vbmUoeSkgPyBmYWxzZSA6IEUuZXF1YWxzKHgudmFsdWUsIHkudmFsdWUpKTsgfVxufSk7IH07XG4vKipcbiAqIFRoZSBgT3JkYCBpbnN0YW5jZSBhbGxvd3MgYE9wdGlvbmAgdmFsdWVzIHRvIGJlIGNvbXBhcmVkIHdpdGhcbiAqIGBjb21wYXJlYCwgd2hlbmV2ZXIgdGhlcmUgaXMgYW4gYE9yZGAgaW5zdGFuY2UgZm9yXG4gKiB0aGUgdHlwZSB0aGUgYE9wdGlvbmAgY29udGFpbnMuXG4gKlxuICogYE5vbmVgIGlzIGNvbnNpZGVyZWQgdG8gYmUgbGVzcyB0aGFuIGFueSBgU29tZWAgdmFsdWUuXG4gKlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBub25lLCBzb21lLCBnZXRPcmQgfSBmcm9tICdmcC10cy9PcHRpb24nXG4gKiBpbXBvcnQgKiBhcyBOIGZyb20gJ2ZwLXRzL251bWJlcidcbiAqXG4gKiBjb25zdCBPID0gZ2V0T3JkKE4uT3JkKVxuICogYXNzZXJ0LnN0cmljdEVxdWFsKE8uY29tcGFyZShub25lLCBub25lKSwgMClcbiAqIGFzc2VydC5zdHJpY3RFcXVhbChPLmNvbXBhcmUobm9uZSwgc29tZSgxKSksIC0xKVxuICogYXNzZXJ0LnN0cmljdEVxdWFsKE8uY29tcGFyZShzb21lKDEpLCBub25lKSwgMSlcbiAqIGFzc2VydC5zdHJpY3RFcXVhbChPLmNvbXBhcmUoc29tZSgxKSwgc29tZSgyKSksIC0xKVxuICogYXNzZXJ0LnN0cmljdEVxdWFsKE8uY29tcGFyZShzb21lKDEpLCBzb21lKDEpKSwgMClcbiAqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciBnZXRPcmQgPSBmdW5jdGlvbiAoTykgeyByZXR1cm4gKHtcbiAgICBlcXVhbHM6IGdldEVxKE8pLmVxdWFscyxcbiAgICBjb21wYXJlOiBmdW5jdGlvbiAoeCwgeSkgeyByZXR1cm4gKHggPT09IHkgPyAwIDogaXNTb21lKHgpID8gKGlzU29tZSh5KSA/IE8uY29tcGFyZSh4LnZhbHVlLCB5LnZhbHVlKSA6IDEpIDogLTEpOyB9XG59KTsgfTtcbi8qKlxuICogTW9ub2lkIHJldHVybmluZyB0aGUgbGVmdC1tb3N0IG5vbi1gTm9uZWAgdmFsdWUuIElmIGJvdGggb3BlcmFuZHMgYXJlIGBTb21lYHMgdGhlbiB0aGUgaW5uZXIgdmFsdWVzIGFyZVxuICogY29uY2F0ZW5hdGVkIHVzaW5nIHRoZSBwcm92aWRlZCBgU2VtaWdyb3VwYFxuICpcbiAqIHwgeCAgICAgICB8IHkgICAgICAgfCBjb25jYXQoeCwgeSkgICAgICAgfFxuICogfCAtLS0tLS0tIHwgLS0tLS0tLSB8IC0tLS0tLS0tLS0tLS0tLS0tLSB8XG4gKiB8IG5vbmUgICAgfCBub25lICAgIHwgbm9uZSAgICAgICAgICAgICAgIHxcbiAqIHwgc29tZShhKSB8IG5vbmUgICAgfCBzb21lKGEpICAgICAgICAgICAgfFxuICogfCBub25lICAgIHwgc29tZShiKSB8IHNvbWUoYikgICAgICAgICAgICB8XG4gKiB8IHNvbWUoYSkgfCBzb21lKGIpIHwgc29tZShjb25jYXQoYSwgYikpIHxcbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgZ2V0TW9ub2lkLCBzb21lLCBub25lIH0gZnJvbSAnZnAtdHMvT3B0aW9uJ1xuICogaW1wb3J0IHsgU2VtaWdyb3VwU3VtIH0gZnJvbSAnZnAtdHMvbnVtYmVyJ1xuICpcbiAqIGNvbnN0IE0gPSBnZXRNb25vaWQoU2VtaWdyb3VwU3VtKVxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChNLmNvbmNhdChub25lLCBub25lKSwgbm9uZSlcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoTS5jb25jYXQoc29tZSgxKSwgbm9uZSksIHNvbWUoMSkpXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKE0uY29uY2F0KG5vbmUsIHNvbWUoMSkpLCBzb21lKDEpKVxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChNLmNvbmNhdChzb21lKDEpLCBzb21lKDIpKSwgc29tZSgzKSlcbiAqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciBnZXRNb25vaWQgPSBmdW5jdGlvbiAoUykgeyByZXR1cm4gKHtcbiAgICBjb25jYXQ6IGZ1bmN0aW9uICh4LCB5KSB7IHJldHVybiAoaXNOb25lKHgpID8geSA6IGlzTm9uZSh5KSA/IHggOiBzb21lKFMuY29uY2F0KHgudmFsdWUsIHkudmFsdWUpKSk7IH0sXG4gICAgZW1wdHk6IG5vbmVcbn0pOyB9O1xuLyoqXG4gKiBAY2F0ZWdvcnkgbWFwcGluZ1xuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgbWFwID0gZnVuY3Rpb24gKGYpIHsgcmV0dXJuIGZ1bmN0aW9uIChmYSkge1xuICAgIHJldHVybiBpc05vbmUoZmEpID8gbm9uZSA6IHNvbWUoZihmYS52YWx1ZSkpO1xufTsgfTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuNy4wXG4gKi9cbmV4cG9ydCB2YXIgRnVuY3RvciA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICBtYXA6IF9tYXBcbn07XG4vKipcbiAqIE1hcHMgdGhlIGBTb21lYCB2YWx1ZSBvZiB0aGlzIGBPcHRpb25gIHRvIHRoZSBzcGVjaWZpZWQgY29uc3RhbnQgdmFsdWUuXG4gKlxuICogQGNhdGVnb3J5IG1hcHBpbmdcbiAqIEBzaW5jZSAyLjE2LjBcbiAqL1xuZXhwb3J0IHZhciBhcyA9IGR1YWwoMiwgYXNfKEZ1bmN0b3IpKTtcbi8qKlxuICogTWFwcyB0aGUgYFNvbWVgIHZhbHVlIG9mIHRoaXMgYE9wdGlvbmAgdG8gdGhlIHZvaWQgY29uc3RhbnQgdmFsdWUuXG4gKlxuICogQGNhdGVnb3J5IG1hcHBpbmdcbiAqIEBzaW5jZSAyLjE2LjBcbiAqL1xuZXhwb3J0IHZhciBhc1VuaXQgPSBhc1VuaXRfKEZ1bmN0b3IpO1xuLyoqXG4gKiBAY2F0ZWdvcnkgY29uc3RydWN0b3JzXG4gKiBAc2luY2UgMi43LjBcbiAqL1xuZXhwb3J0IHZhciBvZiA9IHNvbWU7XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjEwLjBcbiAqL1xuZXhwb3J0IHZhciBQb2ludGVkID0ge1xuICAgIFVSSTogVVJJLFxuICAgIG9mOiBvZlxufTtcbi8qKlxuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgYXAgPSBmdW5jdGlvbiAoZmEpIHsgcmV0dXJuIGZ1bmN0aW9uIChmYWIpIHtcbiAgICByZXR1cm4gaXNOb25lKGZhYikgPyBub25lIDogaXNOb25lKGZhKSA/IG5vbmUgOiBzb21lKGZhYi52YWx1ZShmYS52YWx1ZSkpO1xufTsgfTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuMTAuMFxuICovXG5leHBvcnQgdmFyIEFwcGx5ID0ge1xuICAgIFVSSTogVVJJLFxuICAgIG1hcDogX21hcCxcbiAgICBhcDogX2FwXG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi43LjBcbiAqL1xuZXhwb3J0IHZhciBBcHBsaWNhdGl2ZSA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICBtYXA6IF9tYXAsXG4gICAgYXA6IF9hcCxcbiAgICBvZjogb2Zcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBzZXF1ZW5jaW5nXG4gKiBAc2luY2UgMi4xNC4wXG4gKi9cbmV4cG9ydCB2YXIgZmxhdE1hcCA9IC8qI19fUFVSRV9fKi8gZHVhbCgyLCBmdW5jdGlvbiAobWEsIGYpIHsgcmV0dXJuIChpc05vbmUobWEpID8gbm9uZSA6IGYobWEudmFsdWUpKTsgfSk7XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjEwLjBcbiAqL1xuZXhwb3J0IHZhciBDaGFpbiA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICBtYXA6IF9tYXAsXG4gICAgYXA6IF9hcCxcbiAgICBjaGFpbjogZmxhdE1hcFxufTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuNy4wXG4gKi9cbmV4cG9ydCB2YXIgTW9uYWQgPSB7XG4gICAgVVJJOiBVUkksXG4gICAgbWFwOiBfbWFwLFxuICAgIGFwOiBfYXAsXG4gICAgb2Y6IG9mLFxuICAgIGNoYWluOiBmbGF0TWFwXG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgZm9sZGluZ1xuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgcmVkdWNlID0gZnVuY3Rpb24gKGIsIGYpIHsgcmV0dXJuIGZ1bmN0aW9uIChmYSkge1xuICAgIHJldHVybiBpc05vbmUoZmEpID8gYiA6IGYoYiwgZmEudmFsdWUpO1xufTsgfTtcbi8qKlxuICogQGNhdGVnb3J5IGZvbGRpbmdcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIGZvbGRNYXAgPSBmdW5jdGlvbiAoTSkgeyByZXR1cm4gZnVuY3Rpb24gKGYpIHsgcmV0dXJuIGZ1bmN0aW9uIChmYSkge1xuICAgIHJldHVybiBpc05vbmUoZmEpID8gTS5lbXB0eSA6IGYoZmEudmFsdWUpO1xufTsgfTsgfTtcbi8qKlxuICogQGNhdGVnb3J5IGZvbGRpbmdcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIHJlZHVjZVJpZ2h0ID0gZnVuY3Rpb24gKGIsIGYpIHsgcmV0dXJuIGZ1bmN0aW9uIChmYSkge1xuICAgIHJldHVybiBpc05vbmUoZmEpID8gYiA6IGYoZmEudmFsdWUsIGIpO1xufTsgfTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuNy4wXG4gKi9cbmV4cG9ydCB2YXIgRm9sZGFibGUgPSB7XG4gICAgVVJJOiBVUkksXG4gICAgcmVkdWNlOiBfcmVkdWNlLFxuICAgIGZvbGRNYXA6IF9mb2xkTWFwLFxuICAgIHJlZHVjZVJpZ2h0OiBfcmVkdWNlUmlnaHRcbn07XG4vKipcbiAqIFJldHVybnMgdGhlIHByb3ZpZGVkIGBPcHRpb25gIGB0aGF0YCBpZiBgc2VsZmAgaXMgYE5vbmVgLCBvdGhlcndpc2UgcmV0dXJucyBgc2VsZmAuXG4gKlxuICogQHBhcmFtIHNlbGYgLSBUaGUgZmlyc3QgYE9wdGlvbmAgdG8gYmUgY2hlY2tlZC5cbiAqIEBwYXJhbSB0aGF0IC0gVGhlIGBPcHRpb25gIHRvIHJldHVybiBpZiBgc2VsZmAgaXMgYE5vbmVgLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgKiBhcyBPIGZyb20gXCJmcC10cy9PcHRpb25cIlxuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoTy5vckVsc2UoTy5ub25lLCAoKSA9PiBPLm5vbmUpLCBPLm5vbmUpXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKE8ub3JFbHNlKE8uc29tZSgxKSwgKCkgPT4gTy5ub25lKSwgTy5zb21lKDEpKVxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChPLm9yRWxzZShPLm5vbmUsICgpID0+IE8uc29tZSgnYicpKSwgTy5zb21lKCdiJykpXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKE8ub3JFbHNlKE8uc29tZSgxKSwgKCkgPT4gTy5zb21lKCdiJykpLCBPLnNvbWUoMSkpXG4gKlxuICogQGNhdGVnb3J5IGVycm9yIGhhbmRsaW5nXG4gKiBAc2luY2UgMi4xNi4wXG4gKi9cbmV4cG9ydCB2YXIgb3JFbHNlID0gZHVhbCgyLCBmdW5jdGlvbiAoc2VsZiwgdGhhdCkgeyByZXR1cm4gKGlzTm9uZShzZWxmKSA/IHRoYXQoKSA6IHNlbGYpOyB9KTtcbi8qKlxuICogQWxpYXMgb2YgYG9yRWxzZWAuXG4gKlxuICogTGVzcyBzdHJpY3QgdmVyc2lvbiBvZiBbYGFsdGBdKCNhbHQpLlxuICpcbiAqIFRoZSBgV2Agc3VmZml4IChzaG9ydCBmb3IgKipXKippZGVuaW5nKSBtZWFucyB0aGF0IHRoZSByZXR1cm4gdHlwZXMgd2lsbCBiZSBtZXJnZWQuXG4gKlxuICogQGNhdGVnb3J5IGxlZ2FjeVxuICogQHNpbmNlIDIuOS4wXG4gKi9cbmV4cG9ydCB2YXIgYWx0VyA9IG9yRWxzZTtcbi8qKlxuICogQWxpYXMgb2YgYG9yRWxzZWAuXG4gKlxuICogQGNhdGVnb3J5IGxlZ2FjeVxuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgYWx0ID0gb3JFbHNlO1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi43LjBcbiAqL1xuZXhwb3J0IHZhciBBbHQgPSB7XG4gICAgVVJJOiBVUkksXG4gICAgbWFwOiBfbWFwLFxuICAgIGFsdDogX2FsdFxufTtcbi8qKlxuICogQHNpbmNlIDIuNy4wXG4gKi9cbmV4cG9ydCB2YXIgemVybyA9IGZ1bmN0aW9uICgpIHsgcmV0dXJuIG5vbmU7IH07XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjExLjBcbiAqL1xuZXhwb3J0IHZhciBaZXJvID0ge1xuICAgIFVSSTogVVJJLFxuICAgIHplcm86IHplcm9cbn07XG4vKipcbiAqIEBjYXRlZ29yeSBkbyBub3RhdGlvblxuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIGd1YXJkID0gLyojX19QVVJFX18qLyBndWFyZF8oWmVybywgUG9pbnRlZCk7XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjcuMFxuICovXG5leHBvcnQgdmFyIEFsdGVybmF0aXZlID0ge1xuICAgIFVSSTogVVJJLFxuICAgIG1hcDogX21hcCxcbiAgICBhcDogX2FwLFxuICAgIG9mOiBvZixcbiAgICBhbHQ6IF9hbHQsXG4gICAgemVybzogemVyb1xufTtcbi8qKlxuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgZXh0ZW5kID0gZnVuY3Rpb24gKGYpIHsgcmV0dXJuIGZ1bmN0aW9uICh3YSkge1xuICAgIHJldHVybiBpc05vbmUod2EpID8gbm9uZSA6IHNvbWUoZih3YSkpO1xufTsgfTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuNy4wXG4gKi9cbmV4cG9ydCB2YXIgRXh0ZW5kID0ge1xuICAgIFVSSTogVVJJLFxuICAgIG1hcDogX21hcCxcbiAgICBleHRlbmQ6IF9leHRlbmRcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBmaWx0ZXJpbmdcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIGNvbXBhY3QgPSAvKiNfX1BVUkVfXyovIGZsYXRNYXAoaWRlbnRpdHkpO1xudmFyIGRlZmF1bHRTZXBhcmF0ZWQgPSAvKiNfX1BVUkVfXyovIHNlcGFyYXRlZChub25lLCBub25lKTtcbi8qKlxuICogQGNhdGVnb3J5IGZpbHRlcmluZ1xuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgc2VwYXJhdGUgPSBmdW5jdGlvbiAobWEpIHtcbiAgICByZXR1cm4gaXNOb25lKG1hKSA/IGRlZmF1bHRTZXBhcmF0ZWQgOiBzZXBhcmF0ZWQoZ2V0TGVmdChtYS52YWx1ZSksIGdldFJpZ2h0KG1hLnZhbHVlKSk7XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi43LjBcbiAqL1xuZXhwb3J0IHZhciBDb21wYWN0YWJsZSA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICBjb21wYWN0OiBjb21wYWN0LFxuICAgIHNlcGFyYXRlOiBzZXBhcmF0ZVxufTtcbi8qKlxuICogQGNhdGVnb3J5IGZpbHRlcmluZ1xuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgZmlsdGVyID0gZnVuY3Rpb24gKHByZWRpY2F0ZSkge1xuICAgIHJldHVybiBmdW5jdGlvbiAoZmEpIHtcbiAgICAgICAgcmV0dXJuIGlzTm9uZShmYSkgPyBub25lIDogcHJlZGljYXRlKGZhLnZhbHVlKSA/IGZhIDogbm9uZTtcbiAgICB9O1xufTtcbi8qKlxuICogQGNhdGVnb3J5IGZpbHRlcmluZ1xuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgZmlsdGVyTWFwID0gZnVuY3Rpb24gKGYpIHsgcmV0dXJuIGZ1bmN0aW9uIChmYSkge1xuICAgIHJldHVybiBpc05vbmUoZmEpID8gbm9uZSA6IGYoZmEudmFsdWUpO1xufTsgfTtcbi8qKlxuICogQGNhdGVnb3J5IGZpbHRlcmluZ1xuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgcGFydGl0aW9uID0gZnVuY3Rpb24gKHByZWRpY2F0ZSkge1xuICAgIHJldHVybiBmdW5jdGlvbiAoZmEpIHtcbiAgICAgICAgcmV0dXJuIHNlcGFyYXRlZChfZmlsdGVyKGZhLCBub3QocHJlZGljYXRlKSksIF9maWx0ZXIoZmEsIHByZWRpY2F0ZSkpO1xuICAgIH07XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgZmlsdGVyaW5nXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciBwYXJ0aXRpb25NYXAgPSBmdW5jdGlvbiAoZikgeyByZXR1cm4gZmxvdyhtYXAoZiksIHNlcGFyYXRlKTsgfTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuNy4wXG4gKi9cbmV4cG9ydCB2YXIgRmlsdGVyYWJsZSA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICBtYXA6IF9tYXAsXG4gICAgY29tcGFjdDogY29tcGFjdCxcbiAgICBzZXBhcmF0ZTogc2VwYXJhdGUsXG4gICAgZmlsdGVyOiBfZmlsdGVyLFxuICAgIGZpbHRlck1hcDogX2ZpbHRlck1hcCxcbiAgICBwYXJ0aXRpb246IF9wYXJ0aXRpb24sXG4gICAgcGFydGl0aW9uTWFwOiBfcGFydGl0aW9uTWFwXG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgdHJhdmVyc2luZ1xuICogQHNpbmNlIDIuNi4zXG4gKi9cbmV4cG9ydCB2YXIgdHJhdmVyc2UgPSBmdW5jdGlvbiAoRikge1xuICAgIHJldHVybiBmdW5jdGlvbiAoZikge1xuICAgICAgICByZXR1cm4gZnVuY3Rpb24gKHRhKSB7XG4gICAgICAgICAgICByZXR1cm4gaXNOb25lKHRhKSA/IEYub2Yobm9uZSkgOiBGLm1hcChmKHRhLnZhbHVlKSwgc29tZSk7XG4gICAgICAgIH07XG4gICAgfTtcbn07XG4vKipcbiAqIEBjYXRlZ29yeSB0cmF2ZXJzaW5nXG4gKiBAc2luY2UgMi42LjNcbiAqL1xuZXhwb3J0IHZhciBzZXF1ZW5jZSA9IGZ1bmN0aW9uIChGKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uICh0YSkge1xuICAgICAgICByZXR1cm4gaXNOb25lKHRhKSA/IEYub2Yobm9uZSkgOiBGLm1hcCh0YS52YWx1ZSwgc29tZSk7XG4gICAgfTtcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjcuMFxuICovXG5leHBvcnQgdmFyIFRyYXZlcnNhYmxlID0ge1xuICAgIFVSSTogVVJJLFxuICAgIG1hcDogX21hcCxcbiAgICByZWR1Y2U6IF9yZWR1Y2UsXG4gICAgZm9sZE1hcDogX2ZvbGRNYXAsXG4gICAgcmVkdWNlUmlnaHQ6IF9yZWR1Y2VSaWdodCxcbiAgICB0cmF2ZXJzZTogX3RyYXZlcnNlLFxuICAgIHNlcXVlbmNlOiBzZXF1ZW5jZVxufTtcbnZhciBfd2l0aGVyID0gLyojX19QVVJFX18qLyB3aXRoZXJEZWZhdWx0KFRyYXZlcnNhYmxlLCBDb21wYWN0YWJsZSk7XG52YXIgX3dpbHQgPSAvKiNfX1BVUkVfXyovIHdpbHREZWZhdWx0KFRyYXZlcnNhYmxlLCBDb21wYWN0YWJsZSk7XG4vKipcbiAqIEBjYXRlZ29yeSBmaWx0ZXJpbmdcbiAqIEBzaW5jZSAyLjYuNVxuICovXG5leHBvcnQgdmFyIHdpdGhlciA9IGZ1bmN0aW9uIChGKSB7XG4gICAgdmFyIF93aXRoZXJGID0gX3dpdGhlcihGKTtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGYpIHsgcmV0dXJuIGZ1bmN0aW9uIChmYSkgeyByZXR1cm4gX3dpdGhlckYoZmEsIGYpOyB9OyB9O1xufTtcbi8qKlxuICogQGNhdGVnb3J5IGZpbHRlcmluZ1xuICogQHNpbmNlIDIuNi41XG4gKi9cbmV4cG9ydCB2YXIgd2lsdCA9IGZ1bmN0aW9uIChGKSB7XG4gICAgdmFyIF93aWx0RiA9IF93aWx0KEYpO1xuICAgIHJldHVybiBmdW5jdGlvbiAoZikgeyByZXR1cm4gZnVuY3Rpb24gKGZhKSB7IHJldHVybiBfd2lsdEYoZmEsIGYpOyB9OyB9O1xufTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuNy4wXG4gKi9cbmV4cG9ydCB2YXIgV2l0aGVyYWJsZSA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICBtYXA6IF9tYXAsXG4gICAgcmVkdWNlOiBfcmVkdWNlLFxuICAgIGZvbGRNYXA6IF9mb2xkTWFwLFxuICAgIHJlZHVjZVJpZ2h0OiBfcmVkdWNlUmlnaHQsXG4gICAgdHJhdmVyc2U6IF90cmF2ZXJzZSxcbiAgICBzZXF1ZW5jZTogc2VxdWVuY2UsXG4gICAgY29tcGFjdDogY29tcGFjdCxcbiAgICBzZXBhcmF0ZTogc2VwYXJhdGUsXG4gICAgZmlsdGVyOiBfZmlsdGVyLFxuICAgIGZpbHRlck1hcDogX2ZpbHRlck1hcCxcbiAgICBwYXJ0aXRpb246IF9wYXJ0aXRpb24sXG4gICAgcGFydGl0aW9uTWFwOiBfcGFydGl0aW9uTWFwLFxuICAgIHdpdGhlcjogX3dpdGhlcixcbiAgICB3aWx0OiBfd2lsdFxufTtcbi8qKlxuICogQHNpbmNlIDIuNy4wXG4gKi9cbmV4cG9ydCB2YXIgdGhyb3dFcnJvciA9IGZ1bmN0aW9uICgpIHsgcmV0dXJuIG5vbmU7IH07XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjcuMFxuICovXG5leHBvcnQgdmFyIE1vbmFkVGhyb3cgPSB7XG4gICAgVVJJOiBVUkksXG4gICAgbWFwOiBfbWFwLFxuICAgIGFwOiBfYXAsXG4gICAgb2Y6IG9mLFxuICAgIGNoYWluOiBmbGF0TWFwLFxuICAgIHRocm93RXJyb3I6IHRocm93RXJyb3Jcbn07XG4vKipcbiAqIFRyYW5zZm9ybXMgYW4gYEVpdGhlcmAgdG8gYW4gYE9wdGlvbmAgZGlzY2FyZGluZyB0aGUgZXJyb3IuXG4gKlxuICogQWxpYXMgb2YgW2dldFJpZ2h0XSgjZ2V0cmlnaHQpXG4gKlxuICogQGNhdGVnb3J5IGNvbnZlcnNpb25zXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciBmcm9tRWl0aGVyID0gZ2V0UmlnaHQ7XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjExLjBcbiAqL1xuZXhwb3J0IHZhciBGcm9tRWl0aGVyID0ge1xuICAgIFVSSTogVVJJLFxuICAgIGZyb21FaXRoZXI6IGZyb21FaXRoZXJcbn07XG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vLyByZWZpbmVtZW50c1xuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLyoqXG4gKiBSZXR1cm5zIGB0cnVlYCBpZiB0aGUgb3B0aW9uIGlzIGFuIGluc3RhbmNlIG9mIGBTb21lYCwgYGZhbHNlYCBvdGhlcndpc2UuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IHNvbWUsIG5vbmUsIGlzU29tZSB9IGZyb20gJ2ZwLXRzL09wdGlvbidcbiAqXG4gKiBhc3NlcnQuc3RyaWN0RXF1YWwoaXNTb21lKHNvbWUoMSkpLCB0cnVlKVxuICogYXNzZXJ0LnN0cmljdEVxdWFsKGlzU29tZShub25lKSwgZmFsc2UpXG4gKlxuICogQGNhdGVnb3J5IHJlZmluZW1lbnRzXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciBpc1NvbWUgPSBfLmlzU29tZTtcbi8qKlxuICogUmV0dXJucyBgdHJ1ZWAgaWYgdGhlIG9wdGlvbiBpcyBgTm9uZWAsIGBmYWxzZWAgb3RoZXJ3aXNlLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBzb21lLCBub25lLCBpc05vbmUgfSBmcm9tICdmcC10cy9PcHRpb24nXG4gKlxuICogYXNzZXJ0LnN0cmljdEVxdWFsKGlzTm9uZShzb21lKDEpKSwgZmFsc2UpXG4gKiBhc3NlcnQuc3RyaWN0RXF1YWwoaXNOb25lKG5vbmUpLCB0cnVlKVxuICpcbiAqIEBjYXRlZ29yeSByZWZpbmVtZW50c1xuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgaXNOb25lID0gZnVuY3Rpb24gKGZhKSB7IHJldHVybiBmYS5fdGFnID09PSAnTm9uZSc7IH07XG4vKipcbiAqIExlc3Mgc3RyaWN0IHZlcnNpb24gb2YgW2BtYXRjaGBdKCNtYXRjaCkuXG4gKlxuICogVGhlIGBXYCBzdWZmaXggKHNob3J0IGZvciAqKlcqKmlkZW5pbmcpIG1lYW5zIHRoYXQgdGhlIGhhbmRsZXIgcmV0dXJuIHR5cGVzIHdpbGwgYmUgbWVyZ2VkLlxuICpcbiAqIEBjYXRlZ29yeSBwYXR0ZXJuIG1hdGNoaW5nXG4gKiBAc2luY2UgMi4xMC4wXG4gKi9cbmV4cG9ydCB2YXIgbWF0Y2hXID0gZnVuY3Rpb24gKG9uTm9uZSwgb25Tb21lKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChtYSkge1xuICAgICAgICByZXR1cm4gaXNOb25lKG1hKSA/IG9uTm9uZSgpIDogb25Tb21lKG1hLnZhbHVlKTtcbiAgICB9O1xufTtcbi8qKlxuICogQWxpYXMgb2YgW2BtYXRjaFdgXSgjbWF0Y2h3KS5cbiAqXG4gKiBAY2F0ZWdvcnkgcGF0dGVybiBtYXRjaGluZ1xuICogQHNpbmNlIDIuMTAuMFxuICovXG5leHBvcnQgdmFyIGZvbGRXID0gbWF0Y2hXO1xuLyoqXG4gKiBUYWtlcyBhIChsYXp5KSBkZWZhdWx0IHZhbHVlLCBhIGZ1bmN0aW9uLCBhbmQgYW4gYE9wdGlvbmAgdmFsdWUsIGlmIHRoZSBgT3B0aW9uYCB2YWx1ZSBpcyBgTm9uZWAgdGhlIGRlZmF1bHQgdmFsdWUgaXNcbiAqIHJldHVybmVkLCBvdGhlcndpc2UgdGhlIGZ1bmN0aW9uIGlzIGFwcGxpZWQgdG8gdGhlIHZhbHVlIGluc2lkZSB0aGUgYFNvbWVgIGFuZCB0aGUgcmVzdWx0IGlzIHJldHVybmVkLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBzb21lLCBub25lLCBtYXRjaCB9IGZyb20gJ2ZwLXRzL09wdGlvbidcbiAqIGltcG9ydCB7IHBpcGUgfSBmcm9tICdmcC10cy9mdW5jdGlvbidcbiAqXG4gKiBhc3NlcnQuc3RyaWN0RXF1YWwoXG4gKiAgIHBpcGUoXG4gKiAgICAgc29tZSgxKSxcbiAqICAgICBtYXRjaCgoKSA9PiAnYSBub25lJywgYSA9PiBgYSBzb21lIGNvbnRhaW5pbmcgJHthfWApXG4gKiAgICksXG4gKiAgICdhIHNvbWUgY29udGFpbmluZyAxJ1xuICogKVxuICpcbiAqIGFzc2VydC5zdHJpY3RFcXVhbChcbiAqICAgcGlwZShcbiAqICAgICBub25lLFxuICogICAgIG1hdGNoKCgpID0+ICdhIG5vbmUnLCBhID0+IGBhIHNvbWUgY29udGFpbmluZyAke2F9YClcbiAqICAgKSxcbiAqICAgJ2Egbm9uZSdcbiAqIClcbiAqXG4gKiBAY2F0ZWdvcnkgcGF0dGVybiBtYXRjaGluZ1xuICogQHNpbmNlIDIuMTAuMFxuICovXG5leHBvcnQgdmFyIG1hdGNoID0gbWF0Y2hXO1xuLyoqXG4gKiBBbGlhcyBvZiBbYG1hdGNoYF0oI21hdGNoKS5cbiAqXG4gKiBAY2F0ZWdvcnkgcGF0dGVybiBtYXRjaGluZ1xuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgZm9sZCA9IG1hdGNoO1xuLyoqXG4gKiBMZXNzIHN0cmljdCB2ZXJzaW9uIG9mIFtgZ2V0T3JFbHNlYF0oI2dldG9yZWxzZSkuXG4gKlxuICogVGhlIGBXYCBzdWZmaXggKHNob3J0IGZvciAqKlcqKmlkZW5pbmcpIG1lYW5zIHRoYXQgdGhlIGhhbmRsZXIgcmV0dXJuIHR5cGUgd2lsbCBiZSBtZXJnZWQuXG4gKlxuICogQGNhdGVnb3J5IGVycm9yIGhhbmRsaW5nXG4gKiBAc2luY2UgMi42LjBcbiAqL1xuZXhwb3J0IHZhciBnZXRPckVsc2VXID0gZnVuY3Rpb24gKG9uTm9uZSkge1xuICAgIHJldHVybiBmdW5jdGlvbiAobWEpIHtcbiAgICAgICAgcmV0dXJuIGlzTm9uZShtYSkgPyBvbk5vbmUoKSA6IG1hLnZhbHVlO1xuICAgIH07XG59O1xuLyoqXG4gKiBFeHRyYWN0cyB0aGUgdmFsdWUgb3V0IG9mIHRoZSBzdHJ1Y3R1cmUsIGlmIGl0IGV4aXN0cy4gT3RoZXJ3aXNlIHJldHVybnMgdGhlIGdpdmVuIGRlZmF1bHQgdmFsdWVcbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgc29tZSwgbm9uZSwgZ2V0T3JFbHNlIH0gZnJvbSAnZnAtdHMvT3B0aW9uJ1xuICogaW1wb3J0IHsgcGlwZSB9IGZyb20gJ2ZwLXRzL2Z1bmN0aW9uJ1xuICpcbiAqIGFzc2VydC5zdHJpY3RFcXVhbChcbiAqICAgcGlwZShcbiAqICAgICBzb21lKDEpLFxuICogICAgIGdldE9yRWxzZSgoKSA9PiAwKVxuICogICApLFxuICogICAxXG4gKiApXG4gKiBhc3NlcnQuc3RyaWN0RXF1YWwoXG4gKiAgIHBpcGUoXG4gKiAgICAgbm9uZSxcbiAqICAgICBnZXRPckVsc2UoKCkgPT4gMClcbiAqICAgKSxcbiAqICAgMFxuICogKVxuICpcbiAqIEBjYXRlZ29yeSBlcnJvciBoYW5kbGluZ1xuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgZ2V0T3JFbHNlID0gZ2V0T3JFbHNlVztcbi8qKlxuICogQGNhdGVnb3J5IG1hcHBpbmdcbiAqIEBzaW5jZSAyLjEwLjBcbiAqL1xuZXhwb3J0IHZhciBmbGFwID0gLyojX19QVVJFX18qLyBmbGFwXyhGdW5jdG9yKTtcbi8qKlxuICogQ29tYmluZSB0d28gZWZmZWN0ZnVsIGFjdGlvbnMsIGtlZXBpbmcgb25seSB0aGUgcmVzdWx0IG9mIHRoZSBmaXJzdC5cbiAqXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciBhcEZpcnN0ID0gLyojX19QVVJFX18qLyBhcEZpcnN0XyhBcHBseSk7XG4vKipcbiAqIENvbWJpbmUgdHdvIGVmZmVjdGZ1bCBhY3Rpb25zLCBrZWVwaW5nIG9ubHkgdGhlIHJlc3VsdCBvZiB0aGUgc2Vjb25kLlxuICpcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIGFwU2Vjb25kID0gLyojX19QVVJFX18qLyBhcFNlY29uZF8oQXBwbHkpO1xuLyoqXG4gKiBAY2F0ZWdvcnkgc2VxdWVuY2luZ1xuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgZmxhdHRlbiA9IGNvbXBhY3Q7XG4vKipcbiAqIENvbXBvc2VzIGNvbXB1dGF0aW9ucyBpbiBzZXF1ZW5jZSwgdXNpbmcgdGhlIHJldHVybiB2YWx1ZSBvZiBvbmUgY29tcHV0YXRpb24gdG8gZGV0ZXJtaW5lIHRoZSBuZXh0IGNvbXB1dGF0aW9uIGFuZFxuICoga2VlcGluZyBvbmx5IHRoZSByZXN1bHQgb2YgdGhlIGZpcnN0LlxuICpcbiAqIEBjYXRlZ29yeSBjb21iaW5hdG9yc1xuICogQHNpbmNlIDIuMTUuMFxuICovXG5leHBvcnQgdmFyIHRhcCA9IC8qI19fUFVSRV9fKi8gZHVhbCgyLCBjaGFpbmFibGUudGFwKENoYWluKSk7XG4vKipcbiAqIENvbXBvc2VzIGNvbXB1dGF0aW9ucyBpbiBzZXF1ZW5jZSwgdXNpbmcgdGhlIHJldHVybiB2YWx1ZSBvZiBvbmUgY29tcHV0YXRpb24gdG8gZGV0ZXJtaW5lIHRoZSBuZXh0IGNvbXB1dGF0aW9uIGFuZFxuICoga2VlcGluZyBvbmx5IHRoZSByZXN1bHQgb2YgdGhlIGZpcnN0LlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBwaXBlIH0gZnJvbSAnZnAtdHMvZnVuY3Rpb24nXG4gKiBpbXBvcnQgKiBhcyBPIGZyb20gJ2ZwLXRzL09wdGlvbidcbiAqIGltcG9ydCAqIGFzIEUgZnJvbSAnZnAtdHMvRWl0aGVyJ1xuICpcbiAqIGNvbnN0IGNvbXB1dGUgPSAodmFsdWU6IG51bWJlcikgPT4gcGlwZShcbiAqICAgTy5vZih2YWx1ZSksXG4gKiAgIE8udGFwRWl0aGVyKCh2YWx1ZSkgPT4gdmFsdWUgPiAwID8gRS5yaWdodCgnb2snKSA6IEUubGVmdCgnZXJyb3InKSksXG4gKiApXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChjb21wdXRlKDEpLCBPLm9mKDEpKVxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChjb21wdXRlKC00MiksIE8ubm9uZSlcbiAqXG4gKiBAY2F0ZWdvcnkgY29tYmluYXRvcnNcbiAqIEBzaW5jZSAyLjE2LjBcbiAqL1xuZXhwb3J0IHZhciB0YXBFaXRoZXIgPSAvKiNfX1BVUkVfXyovIGR1YWwoMiwgdGFwRWl0aGVyXyhGcm9tRWl0aGVyLCBDaGFpbikpO1xuLyoqXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciBkdXBsaWNhdGUgPSAvKiNfX1BVUkVfXyovIGV4dGVuZChpZGVudGl0eSk7XG4vKipcbiAqIEBjYXRlZ29yeSBsaWZ0aW5nXG4gKiBAc2luY2UgMi4xMS4wXG4gKi9cbmV4cG9ydCB2YXIgZnJvbUVpdGhlcksgPSAvKiNfX1BVUkVfXyovIGZyb21FaXRoZXJLXyhGcm9tRWl0aGVyKTtcbi8qKlxuICogQGNhdGVnb3J5IHNlcXVlbmNpbmdcbiAqIEBzaW5jZSAyLjExLjBcbiAqL1xuZXhwb3J0IHZhciBjaGFpbkVpdGhlcksgPSBcbi8qI19fUFVSRV9fKi8gY2hhaW5FaXRoZXJLXyhGcm9tRWl0aGVyLCBDaGFpbik7XG4vKipcbiAqIEFsaWFzIG9mIGB0YXBFaXRoZXJgLlxuICpcbiAqIEBjYXRlZ29yeSBsZWdhY3lcbiAqIEBzaW5jZSAyLjEyLjBcbiAqL1xuZXhwb3J0IHZhciBjaGFpbkZpcnN0RWl0aGVySyA9IHRhcEVpdGhlcjtcbi8qKlxuICogQ29uc3RydWN0cyBhIG5ldyBgT3B0aW9uYCBmcm9tIGEgbnVsbGFibGUgdHlwZS4gSWYgdGhlIHZhbHVlIGlzIGBudWxsYCBvciBgdW5kZWZpbmVkYCwgcmV0dXJucyBgTm9uZWAsIG90aGVyd2lzZVxuICogcmV0dXJucyB0aGUgdmFsdWUgd3JhcHBlZCBpbiBhIGBTb21lYC5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgbm9uZSwgc29tZSwgZnJvbU51bGxhYmxlIH0gZnJvbSAnZnAtdHMvT3B0aW9uJ1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoZnJvbU51bGxhYmxlKHVuZGVmaW5lZCksIG5vbmUpXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKGZyb21OdWxsYWJsZShudWxsKSwgbm9uZSlcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoZnJvbU51bGxhYmxlKDEpLCBzb21lKDEpKVxuICpcbiAqIEBjYXRlZ29yeSBjb252ZXJzaW9uc1xuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgZnJvbU51bGxhYmxlID0gZnVuY3Rpb24gKGEpIHsgcmV0dXJuIChhID09IG51bGwgPyBub25lIDogc29tZShhKSk7IH07XG4vKipcbiAqIFRyYW5zZm9ybXMgYW4gZXhjZXB0aW9uIGludG8gYW4gYE9wdGlvbmAuIElmIGBmYCB0aHJvd3MsIHJldHVybnMgYE5vbmVgLCBvdGhlcndpc2UgcmV0dXJucyB0aGUgb3V0cHV0IHdyYXBwZWQgaW4gYVxuICogYFNvbWVgLlxuICpcbiAqIFNlZSBhbHNvIFtgdHJ5Q2F0Y2hLYF0oI3RyeWNhdGNoaykuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IG5vbmUsIHNvbWUsIHRyeUNhdGNoIH0gZnJvbSAnZnAtdHMvT3B0aW9uJ1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoXG4gKiAgIHRyeUNhdGNoKCgpID0+IHtcbiAqICAgICB0aHJvdyBuZXcgRXJyb3IoKVxuICogICB9KSxcbiAqICAgbm9uZVxuICogKVxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbCh0cnlDYXRjaCgoKSA9PiAxKSwgc29tZSgxKSlcbiAqXG4gKiBAY2F0ZWdvcnkgaW50ZXJvcFxuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgdHJ5Q2F0Y2ggPSBmdW5jdGlvbiAoZikge1xuICAgIHRyeSB7XG4gICAgICAgIHJldHVybiBzb21lKGYoKSk7XG4gICAgfVxuICAgIGNhdGNoIChlKSB7XG4gICAgICAgIHJldHVybiBub25lO1xuICAgIH1cbn07XG4vKipcbiAqIENvbnZlcnRzIGEgZnVuY3Rpb24gdGhhdCBtYXkgdGhyb3cgdG8gb25lIHJldHVybmluZyBhIGBPcHRpb25gLlxuICpcbiAqIEBjYXRlZ29yeSBpbnRlcm9wXG4gKiBAc2luY2UgMi4xMC4wXG4gKi9cbmV4cG9ydCB2YXIgdHJ5Q2F0Y2hLID0gZnVuY3Rpb24gKGYpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgYSA9IFtdO1xuICAgICAgICBmb3IgKHZhciBfaSA9IDA7IF9pIDwgYXJndW1lbnRzLmxlbmd0aDsgX2krKykge1xuICAgICAgICAgICAgYVtfaV0gPSBhcmd1bWVudHNbX2ldO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0cnlDYXRjaChmdW5jdGlvbiAoKSB7IHJldHVybiBmLmFwcGx5KHZvaWQgMCwgYSk7IH0pO1xuICAgIH07XG59O1xuLyoqXG4gKiBSZXR1cm5zIGEgKnNtYXJ0IGNvbnN0cnVjdG9yKiBmcm9tIGEgZnVuY3Rpb24gdGhhdCByZXR1cm5zIGEgbnVsbGFibGUgdmFsdWUuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IGZyb21OdWxsYWJsZUssIG5vbmUsIHNvbWUgfSBmcm9tICdmcC10cy9PcHRpb24nXG4gKlxuICogY29uc3QgZiA9IChzOiBzdHJpbmcpOiBudW1iZXIgfCB1bmRlZmluZWQgPT4ge1xuICogICBjb25zdCBuID0gcGFyc2VGbG9hdChzKVxuICogICByZXR1cm4gaXNOYU4obikgPyB1bmRlZmluZWQgOiBuXG4gKiB9XG4gKlxuICogY29uc3QgZyA9IGZyb21OdWxsYWJsZUsoZilcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKGcoJzEnKSwgc29tZSgxKSlcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoZygnYScpLCBub25lKVxuICpcbiAqIEBjYXRlZ29yeSBsaWZ0aW5nXG4gKiBAc2luY2UgMi45LjBcbiAqL1xuZXhwb3J0IHZhciBmcm9tTnVsbGFibGVLID0gZnVuY3Rpb24gKGYpIHsgcmV0dXJuIGZsb3coZiwgZnJvbU51bGxhYmxlKTsgfTtcbi8qKlxuICogVGhpcyBpcyBgY2hhaW5gICsgYGZyb21OdWxsYWJsZWAsIHVzZWZ1bCB3aGVuIHdvcmtpbmcgd2l0aCBvcHRpb25hbCB2YWx1ZXMuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IHNvbWUsIG5vbmUsIGZyb21OdWxsYWJsZSwgY2hhaW5OdWxsYWJsZUsgfSBmcm9tICdmcC10cy9PcHRpb24nXG4gKiBpbXBvcnQgeyBwaXBlIH0gZnJvbSAnZnAtdHMvZnVuY3Rpb24nXG4gKlxuICogaW50ZXJmYWNlIEVtcGxveWVlIHtcbiAqICAgcmVhZG9ubHkgY29tcGFueT86IHtcbiAqICAgICByZWFkb25seSBhZGRyZXNzPzoge1xuICogICAgICAgcmVhZG9ubHkgc3RyZWV0Pzoge1xuICogICAgICAgICByZWFkb25seSBuYW1lPzogc3RyaW5nXG4gKiAgICAgICB9XG4gKiAgICAgfVxuICogICB9XG4gKiB9XG4gKlxuICogY29uc3QgZW1wbG95ZWUxOiBFbXBsb3llZSA9IHsgY29tcGFueTogeyBhZGRyZXNzOiB7IHN0cmVldDogeyBuYW1lOiAnaGlnaCBzdHJlZXQnIH0gfSB9IH1cbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKFxuICogICBwaXBlKFxuICogICAgIGZyb21OdWxsYWJsZShlbXBsb3llZTEuY29tcGFueSksXG4gKiAgICAgY2hhaW5OdWxsYWJsZUsoY29tcGFueSA9PiBjb21wYW55LmFkZHJlc3MpLFxuICogICAgIGNoYWluTnVsbGFibGVLKGFkZHJlc3MgPT4gYWRkcmVzcy5zdHJlZXQpLFxuICogICAgIGNoYWluTnVsbGFibGVLKHN0cmVldCA9PiBzdHJlZXQubmFtZSlcbiAqICAgKSxcbiAqICAgc29tZSgnaGlnaCBzdHJlZXQnKVxuICogKVxuICpcbiAqIGNvbnN0IGVtcGxveWVlMjogRW1wbG95ZWUgPSB7IGNvbXBhbnk6IHsgYWRkcmVzczogeyBzdHJlZXQ6IHt9IH0gfSB9XG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChcbiAqICAgcGlwZShcbiAqICAgICBmcm9tTnVsbGFibGUoZW1wbG95ZWUyLmNvbXBhbnkpLFxuICogICAgIGNoYWluTnVsbGFibGVLKGNvbXBhbnkgPT4gY29tcGFueS5hZGRyZXNzKSxcbiAqICAgICBjaGFpbk51bGxhYmxlSyhhZGRyZXNzID0+IGFkZHJlc3Muc3RyZWV0KSxcbiAqICAgICBjaGFpbk51bGxhYmxlSyhzdHJlZXQgPT4gc3RyZWV0Lm5hbWUpXG4gKiAgICksXG4gKiAgIG5vbmVcbiAqIClcbiAqXG4gKiBAY2F0ZWdvcnkgc2VxdWVuY2luZ1xuICogQHNpbmNlIDIuOS4wXG4gKi9cbmV4cG9ydCB2YXIgY2hhaW5OdWxsYWJsZUsgPSBmdW5jdGlvbiAoZikge1xuICAgIHJldHVybiBmdW5jdGlvbiAobWEpIHtcbiAgICAgICAgcmV0dXJuIGlzTm9uZShtYSkgPyBub25lIDogZnJvbU51bGxhYmxlKGYobWEudmFsdWUpKTtcbiAgICB9O1xufTtcbi8qKlxuICogRXh0cmFjdHMgdGhlIHZhbHVlIG91dCBvZiB0aGUgc3RydWN0dXJlLCBpZiBpdCBleGlzdHMuIE90aGVyd2lzZSByZXR1cm5zIGBudWxsYC5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgc29tZSwgbm9uZSwgdG9OdWxsYWJsZSB9IGZyb20gJ2ZwLXRzL09wdGlvbidcbiAqIGltcG9ydCB7IHBpcGUgfSBmcm9tICdmcC10cy9mdW5jdGlvbidcbiAqXG4gKiBhc3NlcnQuc3RyaWN0RXF1YWwoXG4gKiAgIHBpcGUoXG4gKiAgICAgc29tZSgxKSxcbiAqICAgICB0b051bGxhYmxlXG4gKiAgICksXG4gKiAgIDFcbiAqIClcbiAqIGFzc2VydC5zdHJpY3RFcXVhbChcbiAqICAgcGlwZShcbiAqICAgICBub25lLFxuICogICAgIHRvTnVsbGFibGVcbiAqICAgKSxcbiAqICAgbnVsbFxuICogKVxuICpcbiAqIEBjYXRlZ29yeSBjb252ZXJzaW9uc1xuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgdG9OdWxsYWJsZSA9IC8qI19fUFVSRV9fKi8gbWF0Y2goY29uc3ROdWxsLCBpZGVudGl0eSk7XG4vKipcbiAqIEV4dHJhY3RzIHRoZSB2YWx1ZSBvdXQgb2YgdGhlIHN0cnVjdHVyZSwgaWYgaXQgZXhpc3RzLiBPdGhlcndpc2UgcmV0dXJucyBgdW5kZWZpbmVkYC5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgc29tZSwgbm9uZSwgdG9VbmRlZmluZWQgfSBmcm9tICdmcC10cy9PcHRpb24nXG4gKiBpbXBvcnQgeyBwaXBlIH0gZnJvbSAnZnAtdHMvZnVuY3Rpb24nXG4gKlxuICogYXNzZXJ0LnN0cmljdEVxdWFsKFxuICogICBwaXBlKFxuICogICAgIHNvbWUoMSksXG4gKiAgICAgdG9VbmRlZmluZWRcbiAqICAgKSxcbiAqICAgMVxuICogKVxuICogYXNzZXJ0LnN0cmljdEVxdWFsKFxuICogICBwaXBlKFxuICogICAgIG5vbmUsXG4gKiAgICAgdG9VbmRlZmluZWRcbiAqICAgKSxcbiAqICAgdW5kZWZpbmVkXG4gKiApXG4gKlxuICogQGNhdGVnb3J5IGNvbnZlcnNpb25zXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciB0b1VuZGVmaW5lZCA9IC8qI19fUFVSRV9fKi8gbWF0Y2goY29uc3RVbmRlZmluZWQsIGlkZW50aXR5KTtcbmV4cG9ydCBmdW5jdGlvbiBlbGVtKEUpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGEsIG1hKSB7XG4gICAgICAgIGlmIChtYSA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICB2YXIgZWxlbUVfMSA9IGVsZW0oRSk7XG4gICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24gKG1hKSB7IHJldHVybiBlbGVtRV8xKGEsIG1hKTsgfTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gaXNOb25lKG1hKSA/IGZhbHNlIDogRS5lcXVhbHMoYSwgbWEudmFsdWUpO1xuICAgIH07XG59XG4vKipcbiAqIFJldHVybnMgYHRydWVgIGlmIHRoZSBwcmVkaWNhdGUgaXMgc2F0aXNmaWVkIGJ5IHRoZSB3cmFwcGVkIHZhbHVlXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IHNvbWUsIG5vbmUsIGV4aXN0cyB9IGZyb20gJ2ZwLXRzL09wdGlvbidcbiAqIGltcG9ydCB7IHBpcGUgfSBmcm9tICdmcC10cy9mdW5jdGlvbidcbiAqXG4gKiBhc3NlcnQuc3RyaWN0RXF1YWwoXG4gKiAgIHBpcGUoXG4gKiAgICAgc29tZSgxKSxcbiAqICAgICBleGlzdHMobiA9PiBuID4gMClcbiAqICAgKSxcbiAqICAgdHJ1ZVxuICogKVxuICogYXNzZXJ0LnN0cmljdEVxdWFsKFxuICogICBwaXBlKFxuICogICAgIHNvbWUoMSksXG4gKiAgICAgZXhpc3RzKG4gPT4gbiA+IDEpXG4gKiAgICksXG4gKiAgIGZhbHNlXG4gKiApXG4gKiBhc3NlcnQuc3RyaWN0RXF1YWwoXG4gKiAgIHBpcGUoXG4gKiAgICAgbm9uZSxcbiAqICAgICBleGlzdHMobiA9PiBuID4gMClcbiAqICAgKSxcbiAqICAgZmFsc2VcbiAqIClcbiAqXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciBleGlzdHMgPSBmdW5jdGlvbiAocHJlZGljYXRlKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChtYSkge1xuICAgICAgICByZXR1cm4gaXNOb25lKG1hKSA/IGZhbHNlIDogcHJlZGljYXRlKG1hLnZhbHVlKTtcbiAgICB9O1xufTtcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8vIGRvIG5vdGF0aW9uXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vKipcbiAqIEBjYXRlZ29yeSBkbyBub3RhdGlvblxuICogQHNpbmNlIDIuOS4wXG4gKi9cbmV4cG9ydCB2YXIgRG8gPSAvKiNfX1BVUkVfXyovIG9mKF8uZW1wdHlSZWNvcmQpO1xuLyoqXG4gKiBAY2F0ZWdvcnkgZG8gbm90YXRpb25cbiAqIEBzaW5jZSAyLjguMFxuICovXG5leHBvcnQgdmFyIGJpbmRUbyA9IC8qI19fUFVSRV9fKi8gYmluZFRvXyhGdW5jdG9yKTtcbnZhciBsZXRfID0gLyojX19QVVJFX18qLyBsZXRfXyhGdW5jdG9yKTtcbmV4cG9ydCB7IFxuLyoqXG4gKiBAY2F0ZWdvcnkgZG8gbm90YXRpb25cbiAqIEBzaW5jZSAyLjEzLjBcbiAqL1xubGV0XyBhcyBsZXQgfTtcbi8qKlxuICogQGNhdGVnb3J5IGRvIG5vdGF0aW9uXG4gKiBAc2luY2UgMi44LjBcbiAqL1xuZXhwb3J0IHZhciBiaW5kID0gLyojX19QVVJFX18qLyBjaGFpbmFibGUuYmluZChDaGFpbik7XG4vKipcbiAqIEBjYXRlZ29yeSBkbyBub3RhdGlvblxuICogQHNpbmNlIDIuOC4wXG4gKi9cbmV4cG9ydCB2YXIgYXBTID0gLyojX19QVVJFX18qLyBhcFNfKEFwcGx5KTtcbi8qKlxuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIEFwVCA9IC8qI19fUFVSRV9fKi8gb2YoXy5lbXB0eVJlYWRvbmx5QXJyYXkpO1xuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLy8gYXJyYXkgdXRpbHNcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8qKlxuICogRXF1aXZhbGVudCB0byBgUmVhZG9ubHlOb25FbXB0eUFycmF5I3RyYXZlcnNlV2l0aEluZGV4KEFwcGxpY2F0aXZlKWAuXG4gKlxuICogQGNhdGVnb3J5IHRyYXZlcnNpbmdcbiAqIEBzaW5jZSAyLjExLjBcbiAqL1xuZXhwb3J0IHZhciB0cmF2ZXJzZVJlYWRvbmx5Tm9uRW1wdHlBcnJheVdpdGhJbmRleCA9IGZ1bmN0aW9uIChmKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykge1xuICAgICAgICB2YXIgbyA9IGYoMCwgXy5oZWFkKGFzKSk7XG4gICAgICAgIGlmIChpc05vbmUobykpIHtcbiAgICAgICAgICAgIHJldHVybiBub25lO1xuICAgICAgICB9XG4gICAgICAgIHZhciBvdXQgPSBbby52YWx1ZV07XG4gICAgICAgIGZvciAodmFyIGkgPSAxOyBpIDwgYXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIHZhciBvXzEgPSBmKGksIGFzW2ldKTtcbiAgICAgICAgICAgIGlmIChpc05vbmUob18xKSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBub25lO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgb3V0LnB1c2gob18xLnZhbHVlKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gc29tZShvdXQpO1xuICAgIH07XG59O1xuLyoqXG4gKiBFcXVpdmFsZW50IHRvIGBSZWFkb25seUFycmF5I3RyYXZlcnNlV2l0aEluZGV4KEFwcGxpY2F0aXZlKWAuXG4gKlxuICogQGNhdGVnb3J5IHRyYXZlcnNpbmdcbiAqIEBzaW5jZSAyLjExLjBcbiAqL1xuZXhwb3J0IHZhciB0cmF2ZXJzZVJlYWRvbmx5QXJyYXlXaXRoSW5kZXggPSBmdW5jdGlvbiAoZikge1xuICAgIHZhciBnID0gdHJhdmVyc2VSZWFkb25seU5vbkVtcHR5QXJyYXlXaXRoSW5kZXgoZik7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykgeyByZXR1cm4gKF8uaXNOb25FbXB0eShhcykgPyBnKGFzKSA6IEFwVCk7IH07XG59O1xuLyoqXG4gKiBFcXVpdmFsZW50IHRvIGBSZWFkb25seUFycmF5I3RyYXZlcnNlV2l0aEluZGV4KEFwcGxpY2F0aXZlKWAuXG4gKlxuICogQGNhdGVnb3J5IHRyYXZlcnNpbmdcbiAqIEBzaW5jZSAyLjkuMFxuICovXG5leHBvcnQgdmFyIHRyYXZlcnNlQXJyYXlXaXRoSW5kZXggPSB0cmF2ZXJzZVJlYWRvbmx5QXJyYXlXaXRoSW5kZXg7XG4vKipcbiAqIEVxdWl2YWxlbnQgdG8gYFJlYWRvbmx5QXJyYXkjdHJhdmVyc2UoQXBwbGljYXRpdmUpYC5cbiAqXG4gKiBAY2F0ZWdvcnkgdHJhdmVyc2luZ1xuICogQHNpbmNlIDIuOS4wXG4gKi9cbmV4cG9ydCB2YXIgdHJhdmVyc2VBcnJheSA9IGZ1bmN0aW9uIChmKSB7XG4gICAgcmV0dXJuIHRyYXZlcnNlUmVhZG9ubHlBcnJheVdpdGhJbmRleChmdW5jdGlvbiAoXywgYSkgeyByZXR1cm4gZihhKTsgfSk7XG59O1xuLyoqXG4gKiBFcXVpdmFsZW50IHRvIGBSZWFkb25seUFycmF5I3NlcXVlbmNlKEFwcGxpY2F0aXZlKWAuXG4gKlxuICogQGNhdGVnb3J5IHRyYXZlcnNpbmdcbiAqIEBzaW5jZSAyLjkuMFxuICovXG5leHBvcnQgdmFyIHNlcXVlbmNlQXJyYXkgPSBcbi8qI19fUFVSRV9fKi8gdHJhdmVyc2VBcnJheShpZGVudGl0eSk7XG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vLyBsZWdhY3lcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8qKlxuICogQWxpYXMgb2YgYGZsYXRNYXBgLlxuICpcbiAqIEBjYXRlZ29yeSBsZWdhY3lcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIGNoYWluID0gZmxhdE1hcDtcbi8qKlxuICogQWxpYXMgb2YgYHRhcGAuXG4gKlxuICogQGNhdGVnb3J5IGxlZ2FjeVxuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgY2hhaW5GaXJzdCA9IHRhcDtcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8vIGRlcHJlY2F0ZWRcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8qKlxuICogVXNlIGBSZWZpbmVtZW50YCBtb2R1bGUgaW5zdGVhZC5cbiAqXG4gKiBAY2F0ZWdvcnkgem9uZSBvZiBkZWF0aFxuICogQHNpbmNlIDIuMC4wXG4gKiBAZGVwcmVjYXRlZFxuICovXG5leHBvcnQgZnVuY3Rpb24gZ2V0UmVmaW5lbWVudChnZXRPcHRpb24pIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGEpIHsgcmV0dXJuIGlzU29tZShnZXRPcHRpb24oYSkpOyB9O1xufVxuLyoqXG4gKiBVc2UgW2BjaGFpbk51bGxhYmxlS2BdKCNjaGFpbm51bGxhYmxlaykgaW5zdGVhZC5cbiAqXG4gKiBAY2F0ZWdvcnkgem9uZSBvZiBkZWF0aFxuICogQHNpbmNlIDIuMC4wXG4gKiBAZGVwcmVjYXRlZFxuICovXG5leHBvcnQgdmFyIG1hcE51bGxhYmxlID0gY2hhaW5OdWxsYWJsZUs7XG4vKipcbiAqIFRoaXMgaW5zdGFuY2UgaXMgZGVwcmVjYXRlZCwgdXNlIHNtYWxsLCBzcGVjaWZpYyBpbnN0YW5jZXMgaW5zdGVhZC5cbiAqIEZvciBleGFtcGxlIGlmIGEgZnVuY3Rpb24gbmVlZHMgYSBgRnVuY3RvcmAgaW5zdGFuY2UsIHBhc3MgYE8uRnVuY3RvcmAgaW5zdGVhZCBvZiBgTy5vcHRpb25gXG4gKiAod2hlcmUgYE9gIGlzIGZyb20gYGltcG9ydCBPIGZyb20gJ2ZwLXRzL09wdGlvbidgKVxuICpcbiAqIEBjYXRlZ29yeSB6b25lIG9mIGRlYXRoXG4gKiBAc2luY2UgMi4wLjBcbiAqIEBkZXByZWNhdGVkXG4gKi9cbmV4cG9ydCB2YXIgb3B0aW9uID0ge1xuICAgIFVSSTogVVJJLFxuICAgIG1hcDogX21hcCxcbiAgICBvZjogb2YsXG4gICAgYXA6IF9hcCxcbiAgICBjaGFpbjogZmxhdE1hcCxcbiAgICByZWR1Y2U6IF9yZWR1Y2UsXG4gICAgZm9sZE1hcDogX2ZvbGRNYXAsXG4gICAgcmVkdWNlUmlnaHQ6IF9yZWR1Y2VSaWdodCxcbiAgICB0cmF2ZXJzZTogX3RyYXZlcnNlLFxuICAgIHNlcXVlbmNlOiBzZXF1ZW5jZSxcbiAgICB6ZXJvOiB6ZXJvLFxuICAgIGFsdDogX2FsdCxcbiAgICBleHRlbmQ6IF9leHRlbmQsXG4gICAgY29tcGFjdDogY29tcGFjdCxcbiAgICBzZXBhcmF0ZTogc2VwYXJhdGUsXG4gICAgZmlsdGVyOiBfZmlsdGVyLFxuICAgIGZpbHRlck1hcDogX2ZpbHRlck1hcCxcbiAgICBwYXJ0aXRpb246IF9wYXJ0aXRpb24sXG4gICAgcGFydGl0aW9uTWFwOiBfcGFydGl0aW9uTWFwLFxuICAgIHdpdGhlcjogX3dpdGhlcixcbiAgICB3aWx0OiBfd2lsdCxcbiAgICB0aHJvd0Vycm9yOiB0aHJvd0Vycm9yXG59O1xuLyoqXG4gKiBVc2UgW2BnZXRBcHBseVNlbWlncm91cGBdKC4vQXBwbHkudHMuaHRtbCNnZXRhcHBseXNlbWlncm91cCkgaW5zdGVhZC5cbiAqXG4gKiBAY2F0ZWdvcnkgem9uZSBvZiBkZWF0aFxuICogQHNpbmNlIDIuMC4wXG4gKiBAZGVwcmVjYXRlZFxuICovXG5leHBvcnQgdmFyIGdldEFwcGx5U2VtaWdyb3VwID0gLyojX19QVVJFX18qLyBnZXRBcHBseVNlbWlncm91cF8oQXBwbHkpO1xuLyoqXG4gKiBVc2UgW2BnZXRBcHBsaWNhdGl2ZU1vbm9pZGBdKC4vQXBwbGljYXRpdmUudHMuaHRtbCNnZXRhcHBsaWNhdGl2ZW1vbm9pZCkgaW5zdGVhZC5cbiAqXG4gKiBAY2F0ZWdvcnkgem9uZSBvZiBkZWF0aFxuICogQHNpbmNlIDIuMC4wXG4gKiBAZGVwcmVjYXRlZFxuICovXG5leHBvcnQgdmFyIGdldEFwcGx5TW9ub2lkID0gLyojX19QVVJFX18qLyBnZXRBcHBsaWNhdGl2ZU1vbm9pZChBcHBsaWNhdGl2ZSk7XG4vKipcbiAqIFVzZVxuICpcbiAqIGBgYHRzXG4gKiBpbXBvcnQgeyBmaXJzdCB9IGZyb20gJ2ZwLXRzL1NlbWlncm91cCdcbiAqIGltcG9ydCB7IGdldE1vbm9pZCB9IGZyb20gJ2ZwLXRzL09wdGlvbidcbiAqXG4gKiBnZXRNb25vaWQoZmlyc3QoKSlcbiAqIGBgYFxuICpcbiAqIGluc3RlYWQuXG4gKlxuICogTW9ub2lkIHJldHVybmluZyB0aGUgbGVmdC1tb3N0IG5vbi1gTm9uZWAgdmFsdWVcbiAqXG4gKiB8IHggICAgICAgfCB5ICAgICAgIHwgY29uY2F0KHgsIHkpIHxcbiAqIHwgLS0tLS0tLSB8IC0tLS0tLS0gfCAtLS0tLS0tLS0tLS0gfFxuICogfCBub25lICAgIHwgbm9uZSAgICB8IG5vbmUgICAgICAgICB8XG4gKiB8IHNvbWUoYSkgfCBub25lICAgIHwgc29tZShhKSAgICAgIHxcbiAqIHwgbm9uZSAgICB8IHNvbWUoYikgfCBzb21lKGIpICAgICAgfFxuICogfCBzb21lKGEpIHwgc29tZShiKSB8IHNvbWUoYSkgICAgICB8XG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IGdldEZpcnN0TW9ub2lkLCBzb21lLCBub25lIH0gZnJvbSAnZnAtdHMvT3B0aW9uJ1xuICpcbiAqIGNvbnN0IE0gPSBnZXRGaXJzdE1vbm9pZDxudW1iZXI+KClcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoTS5jb25jYXQobm9uZSwgbm9uZSksIG5vbmUpXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKE0uY29uY2F0KHNvbWUoMSksIG5vbmUpLCBzb21lKDEpKVxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChNLmNvbmNhdChub25lLCBzb21lKDIpKSwgc29tZSgyKSlcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoTS5jb25jYXQoc29tZSgxKSwgc29tZSgyKSksIHNvbWUoMSkpXG4gKlxuICogQGNhdGVnb3J5IHpvbmUgb2YgZGVhdGhcbiAqIEBzaW5jZSAyLjAuMFxuICogQGRlcHJlY2F0ZWRcbiAqL1xuZXhwb3J0IHZhciBnZXRGaXJzdE1vbm9pZCA9IGZ1bmN0aW9uICgpIHsgcmV0dXJuIGdldE1vbm9pZChmaXJzdCgpKTsgfTtcbi8qKlxuICogVXNlXG4gKlxuICogYGBgdHNcbiAqIGltcG9ydCB7IGxhc3QgfSBmcm9tICdmcC10cy9TZW1pZ3JvdXAnXG4gKiBpbXBvcnQgeyBnZXRNb25vaWQgfSBmcm9tICdmcC10cy9PcHRpb24nXG4gKlxuICogZ2V0TW9ub2lkKGxhc3QoKSlcbiAqIGBgYFxuICpcbiAqIGluc3RlYWQuXG4gKlxuICogTW9ub2lkIHJldHVybmluZyB0aGUgcmlnaHQtbW9zdCBub24tYE5vbmVgIHZhbHVlXG4gKlxuICogfCB4ICAgICAgIHwgeSAgICAgICB8IGNvbmNhdCh4LCB5KSB8XG4gKiB8IC0tLS0tLS0gfCAtLS0tLS0tIHwgLS0tLS0tLS0tLS0tIHxcbiAqIHwgbm9uZSAgICB8IG5vbmUgICAgfCBub25lICAgICAgICAgfFxuICogfCBzb21lKGEpIHwgbm9uZSAgICB8IHNvbWUoYSkgICAgICB8XG4gKiB8IG5vbmUgICAgfCBzb21lKGIpIHwgc29tZShiKSAgICAgIHxcbiAqIHwgc29tZShhKSB8IHNvbWUoYikgfCBzb21lKGIpICAgICAgfFxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBnZXRMYXN0TW9ub2lkLCBzb21lLCBub25lIH0gZnJvbSAnZnAtdHMvT3B0aW9uJ1xuICpcbiAqIGNvbnN0IE0gPSBnZXRMYXN0TW9ub2lkPG51bWJlcj4oKVxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChNLmNvbmNhdChub25lLCBub25lKSwgbm9uZSlcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoTS5jb25jYXQoc29tZSgxKSwgbm9uZSksIHNvbWUoMSkpXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKE0uY29uY2F0KG5vbmUsIHNvbWUoMikpLCBzb21lKDIpKVxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChNLmNvbmNhdChzb21lKDEpLCBzb21lKDIpKSwgc29tZSgyKSlcbiAqXG4gKiBAY2F0ZWdvcnkgem9uZSBvZiBkZWF0aFxuICogQHNpbmNlIDIuMC4wXG4gKiBAZGVwcmVjYXRlZFxuICovXG5leHBvcnQgdmFyIGdldExhc3RNb25vaWQgPSBmdW5jdGlvbiAoKSB7IHJldHVybiBnZXRNb25vaWQobGFzdCgpKTsgfTtcbiIsCiAgImltcG9ydCB7IGdldEFwcGxpY2F0aXZlTW9ub2lkIH0gZnJvbSAnLi9BcHBsaWNhdGl2ZSc7XG5pbXBvcnQgeyBhcEZpcnN0IGFzIGFwRmlyc3RfLCBhcFMgYXMgYXBTXywgYXBTZWNvbmQgYXMgYXBTZWNvbmRfLCBnZXRBcHBseVNlbWlncm91cCBhcyBnZXRBcHBseVNlbWlncm91cF8gfSBmcm9tICcuL0FwcGx5JztcbmltcG9ydCAqIGFzIGNoYWluYWJsZSBmcm9tICcuL0NoYWluJztcbmltcG9ydCB7IGNoYWluRWl0aGVySyBhcyBjaGFpbkVpdGhlcktfLCBmcm9tRWl0aGVySyBhcyBmcm9tRWl0aGVyS18sIHRhcEVpdGhlciBhcyB0YXBFaXRoZXJfIH0gZnJvbSAnLi9Gcm9tRWl0aGVyJztcbmltcG9ydCB7IGNvbnN0TnVsbCwgY29uc3RVbmRlZmluZWQsIGR1YWwsIGZsb3csIGlkZW50aXR5LCBwaXBlIH0gZnJvbSAnLi9mdW5jdGlvbic7XG5pbXBvcnQgeyBhcyBhcyBhc18sIGFzVW5pdCBhcyBhc1VuaXRfLCBiaW5kVG8gYXMgYmluZFRvXywgZmxhcCBhcyBmbGFwXywgbGV0IGFzIGxldF9fIH0gZnJvbSAnLi9GdW5jdG9yJztcbmltcG9ydCAqIGFzIF8gZnJvbSAnLi9pbnRlcm5hbCc7XG5pbXBvcnQgeyBub3QgfSBmcm9tICcuL1ByZWRpY2F0ZSc7XG5pbXBvcnQgeyBmaXJzdCwgbGFzdCB9IGZyb20gJy4vU2VtaWdyb3VwJztcbmltcG9ydCB7IHNlcGFyYXRlZCB9IGZyb20gJy4vU2VwYXJhdGVkJztcbmltcG9ydCB7IHdpbHREZWZhdWx0LCB3aXRoZXJEZWZhdWx0IH0gZnJvbSAnLi9XaXRoZXJhYmxlJztcbmltcG9ydCB7IGd1YXJkIGFzIGd1YXJkXyB9IGZyb20gJy4vWmVybyc7XG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vLyBjb25zdHJ1Y3RvcnNcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8qKlxuICogYE5vbmVgIGRvZXNuJ3QgaGF2ZSBhIGNvbnN0cnVjdG9yLCBpbnN0ZWFkIHlvdSBjYW4gdXNlIGl0IGRpcmVjdGx5IGFzIGEgdmFsdWUuIFJlcHJlc2VudHMgYSBtaXNzaW5nIHZhbHVlLlxuICpcbiAqIEBjYXRlZ29yeSBjb25zdHJ1Y3RvcnNcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIG5vbmUgPSBfLm5vbmU7XG4vKipcbiAqIENvbnN0cnVjdHMgYSBgU29tZWAuIFJlcHJlc2VudHMgYW4gb3B0aW9uYWwgdmFsdWUgdGhhdCBleGlzdHMuXG4gKlxuICogQGNhdGVnb3J5IGNvbnN0cnVjdG9yc1xuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgc29tZSA9IF8uc29tZTtcbmV4cG9ydCBmdW5jdGlvbiBmcm9tUHJlZGljYXRlKHByZWRpY2F0ZSkge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYSkgeyByZXR1cm4gKHByZWRpY2F0ZShhKSA/IHNvbWUoYSkgOiBub25lKTsgfTtcbn1cbi8qKlxuICogUmV0dXJucyB0aGUgYExlZnRgIHZhbHVlIG9mIGFuIGBFaXRoZXJgIGlmIHBvc3NpYmxlLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBnZXRMZWZ0LCBub25lLCBzb21lIH0gZnJvbSAnZnAtdHMvT3B0aW9uJ1xuICogaW1wb3J0IHsgcmlnaHQsIGxlZnQgfSBmcm9tICdmcC10cy9FaXRoZXInXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChnZXRMZWZ0KHJpZ2h0KDEpKSwgbm9uZSlcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoZ2V0TGVmdChsZWZ0KCdhJykpLCBzb21lKCdhJykpXG4gKlxuICogQGNhdGVnb3J5IGNvbnN0cnVjdG9yc1xuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgZ2V0TGVmdCA9IGZ1bmN0aW9uIChtYSkgeyByZXR1cm4gKG1hLl90YWcgPT09ICdSaWdodCcgPyBub25lIDogc29tZShtYS5sZWZ0KSk7IH07XG4vKipcbiAqIFJldHVybnMgdGhlIGBSaWdodGAgdmFsdWUgb2YgYW4gYEVpdGhlcmAgaWYgcG9zc2libGUuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IGdldFJpZ2h0LCBub25lLCBzb21lIH0gZnJvbSAnZnAtdHMvT3B0aW9uJ1xuICogaW1wb3J0IHsgcmlnaHQsIGxlZnQgfSBmcm9tICdmcC10cy9FaXRoZXInXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChnZXRSaWdodChyaWdodCgxKSksIHNvbWUoMSkpXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKGdldFJpZ2h0KGxlZnQoJ2EnKSksIG5vbmUpXG4gKlxuICogQGNhdGVnb3J5IGNvbnN0cnVjdG9yc1xuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgZ2V0UmlnaHQgPSBmdW5jdGlvbiAobWEpIHsgcmV0dXJuIChtYS5fdGFnID09PSAnTGVmdCcgPyBub25lIDogc29tZShtYS5yaWdodCkpOyB9O1xudmFyIF9tYXAgPSBmdW5jdGlvbiAoZmEsIGYpIHsgcmV0dXJuIHBpcGUoZmEsIG1hcChmKSk7IH07XG52YXIgX2FwID0gZnVuY3Rpb24gKGZhYiwgZmEpIHsgcmV0dXJuIHBpcGUoZmFiLCBhcChmYSkpOyB9O1xudmFyIF9yZWR1Y2UgPSBmdW5jdGlvbiAoZmEsIGIsIGYpIHsgcmV0dXJuIHBpcGUoZmEsIHJlZHVjZShiLCBmKSk7IH07XG52YXIgX2ZvbGRNYXAgPSBmdW5jdGlvbiAoTSkge1xuICAgIHZhciBmb2xkTWFwTSA9IGZvbGRNYXAoTSk7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChmYSwgZikgeyByZXR1cm4gcGlwZShmYSwgZm9sZE1hcE0oZikpOyB9O1xufTtcbnZhciBfcmVkdWNlUmlnaHQgPSBmdW5jdGlvbiAoZmEsIGIsIGYpIHsgcmV0dXJuIHBpcGUoZmEsIHJlZHVjZVJpZ2h0KGIsIGYpKTsgfTtcbnZhciBfdHJhdmVyc2UgPSBmdW5jdGlvbiAoRikge1xuICAgIHZhciB0cmF2ZXJzZUYgPSB0cmF2ZXJzZShGKTtcbiAgICByZXR1cm4gZnVuY3Rpb24gKHRhLCBmKSB7IHJldHVybiBwaXBlKHRhLCB0cmF2ZXJzZUYoZikpOyB9O1xufTtcbi8qIGlzdGFuYnVsIGlnbm9yZSBuZXh0ICovXG52YXIgX2FsdCA9IGZ1bmN0aW9uIChmYSwgdGhhdCkgeyByZXR1cm4gcGlwZShmYSwgYWx0KHRoYXQpKTsgfTtcbnZhciBfZmlsdGVyID0gZnVuY3Rpb24gKGZhLCBwcmVkaWNhdGUpIHsgcmV0dXJuIHBpcGUoZmEsIGZpbHRlcihwcmVkaWNhdGUpKTsgfTtcbi8qIGlzdGFuYnVsIGlnbm9yZSBuZXh0ICovXG52YXIgX2ZpbHRlck1hcCA9IGZ1bmN0aW9uIChmYSwgZikgeyByZXR1cm4gcGlwZShmYSwgZmlsdGVyTWFwKGYpKTsgfTtcbi8qIGlzdGFuYnVsIGlnbm9yZSBuZXh0ICovXG52YXIgX2V4dGVuZCA9IGZ1bmN0aW9uICh3YSwgZikgeyByZXR1cm4gcGlwZSh3YSwgZXh0ZW5kKGYpKTsgfTtcbi8qIGlzdGFuYnVsIGlnbm9yZSBuZXh0ICovXG52YXIgX3BhcnRpdGlvbiA9IGZ1bmN0aW9uIChmYSwgcHJlZGljYXRlKSB7XG4gICAgcmV0dXJuIHBpcGUoZmEsIHBhcnRpdGlvbihwcmVkaWNhdGUpKTtcbn07XG4vKiBpc3RhbmJ1bCBpZ25vcmUgbmV4dCAqL1xudmFyIF9wYXJ0aXRpb25NYXAgPSBmdW5jdGlvbiAoZmEsIGYpIHsgcmV0dXJuIHBpcGUoZmEsIHBhcnRpdGlvbk1hcChmKSk7IH07XG4vKipcbiAqIEBjYXRlZ29yeSB0eXBlIGxhbWJkYXNcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIFVSSSA9ICdPcHRpb24nO1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciBnZXRTaG93ID0gZnVuY3Rpb24gKFMpIHsgcmV0dXJuICh7XG4gICAgc2hvdzogZnVuY3Rpb24gKG1hKSB7IHJldHVybiAoaXNOb25lKG1hKSA/ICdub25lJyA6IFwic29tZShcIi5jb25jYXQoUy5zaG93KG1hLnZhbHVlKSwgXCIpXCIpKTsgfVxufSk7IH07XG4vKipcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBub25lLCBzb21lLCBnZXRFcSB9IGZyb20gJ2ZwLXRzL09wdGlvbidcbiAqIGltcG9ydCAqIGFzIE4gZnJvbSAnZnAtdHMvbnVtYmVyJ1xuICpcbiAqIGNvbnN0IEUgPSBnZXRFcShOLkVxKVxuICogYXNzZXJ0LnN0cmljdEVxdWFsKEUuZXF1YWxzKG5vbmUsIG5vbmUpLCB0cnVlKVxuICogYXNzZXJ0LnN0cmljdEVxdWFsKEUuZXF1YWxzKG5vbmUsIHNvbWUoMSkpLCBmYWxzZSlcbiAqIGFzc2VydC5zdHJpY3RFcXVhbChFLmVxdWFscyhzb21lKDEpLCBub25lKSwgZmFsc2UpXG4gKiBhc3NlcnQuc3RyaWN0RXF1YWwoRS5lcXVhbHMoc29tZSgxKSwgc29tZSgyKSksIGZhbHNlKVxuICogYXNzZXJ0LnN0cmljdEVxdWFsKEUuZXF1YWxzKHNvbWUoMSksIHNvbWUoMSkpLCB0cnVlKVxuICpcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIGdldEVxID0gZnVuY3Rpb24gKEUpIHsgcmV0dXJuICh7XG4gICAgZXF1YWxzOiBmdW5jdGlvbiAoeCwgeSkgeyByZXR1cm4geCA9PT0geSB8fCAoaXNOb25lKHgpID8gaXNOb25lKHkpIDogaXNOb25lKHkpID8gZmFsc2UgOiBFLmVxdWFscyh4LnZhbHVlLCB5LnZhbHVlKSk7IH1cbn0pOyB9O1xuLyoqXG4gKiBUaGUgYE9yZGAgaW5zdGFuY2UgYWxsb3dzIGBPcHRpb25gIHZhbHVlcyB0byBiZSBjb21wYXJlZCB3aXRoXG4gKiBgY29tcGFyZWAsIHdoZW5ldmVyIHRoZXJlIGlzIGFuIGBPcmRgIGluc3RhbmNlIGZvclxuICogdGhlIHR5cGUgdGhlIGBPcHRpb25gIGNvbnRhaW5zLlxuICpcbiAqIGBOb25lYCBpcyBjb25zaWRlcmVkIHRvIGJlIGxlc3MgdGhhbiBhbnkgYFNvbWVgIHZhbHVlLlxuICpcbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgbm9uZSwgc29tZSwgZ2V0T3JkIH0gZnJvbSAnZnAtdHMvT3B0aW9uJ1xuICogaW1wb3J0ICogYXMgTiBmcm9tICdmcC10cy9udW1iZXInXG4gKlxuICogY29uc3QgTyA9IGdldE9yZChOLk9yZClcbiAqIGFzc2VydC5zdHJpY3RFcXVhbChPLmNvbXBhcmUobm9uZSwgbm9uZSksIDApXG4gKiBhc3NlcnQuc3RyaWN0RXF1YWwoTy5jb21wYXJlKG5vbmUsIHNvbWUoMSkpLCAtMSlcbiAqIGFzc2VydC5zdHJpY3RFcXVhbChPLmNvbXBhcmUoc29tZSgxKSwgbm9uZSksIDEpXG4gKiBhc3NlcnQuc3RyaWN0RXF1YWwoTy5jb21wYXJlKHNvbWUoMSksIHNvbWUoMikpLCAtMSlcbiAqIGFzc2VydC5zdHJpY3RFcXVhbChPLmNvbXBhcmUoc29tZSgxKSwgc29tZSgxKSksIDApXG4gKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgZ2V0T3JkID0gZnVuY3Rpb24gKE8pIHsgcmV0dXJuICh7XG4gICAgZXF1YWxzOiBnZXRFcShPKS5lcXVhbHMsXG4gICAgY29tcGFyZTogZnVuY3Rpb24gKHgsIHkpIHsgcmV0dXJuICh4ID09PSB5ID8gMCA6IGlzU29tZSh4KSA/IChpc1NvbWUoeSkgPyBPLmNvbXBhcmUoeC52YWx1ZSwgeS52YWx1ZSkgOiAxKSA6IC0xKTsgfVxufSk7IH07XG4vKipcbiAqIE1vbm9pZCByZXR1cm5pbmcgdGhlIGxlZnQtbW9zdCBub24tYE5vbmVgIHZhbHVlLiBJZiBib3RoIG9wZXJhbmRzIGFyZSBgU29tZWBzIHRoZW4gdGhlIGlubmVyIHZhbHVlcyBhcmVcbiAqIGNvbmNhdGVuYXRlZCB1c2luZyB0aGUgcHJvdmlkZWQgYFNlbWlncm91cGBcbiAqXG4gKiB8IHggICAgICAgfCB5ICAgICAgIHwgY29uY2F0KHgsIHkpICAgICAgIHxcbiAqIHwgLS0tLS0tLSB8IC0tLS0tLS0gfCAtLS0tLS0tLS0tLS0tLS0tLS0gfFxuICogfCBub25lICAgIHwgbm9uZSAgICB8IG5vbmUgICAgICAgICAgICAgICB8XG4gKiB8IHNvbWUoYSkgfCBub25lICAgIHwgc29tZShhKSAgICAgICAgICAgIHxcbiAqIHwgbm9uZSAgICB8IHNvbWUoYikgfCBzb21lKGIpICAgICAgICAgICAgfFxuICogfCBzb21lKGEpIHwgc29tZShiKSB8IHNvbWUoY29uY2F0KGEsIGIpKSB8XG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IGdldE1vbm9pZCwgc29tZSwgbm9uZSB9IGZyb20gJ2ZwLXRzL09wdGlvbidcbiAqIGltcG9ydCB7IFNlbWlncm91cFN1bSB9IGZyb20gJ2ZwLXRzL251bWJlcidcbiAqXG4gKiBjb25zdCBNID0gZ2V0TW9ub2lkKFNlbWlncm91cFN1bSlcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoTS5jb25jYXQobm9uZSwgbm9uZSksIG5vbmUpXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKE0uY29uY2F0KHNvbWUoMSksIG5vbmUpLCBzb21lKDEpKVxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChNLmNvbmNhdChub25lLCBzb21lKDEpKSwgc29tZSgxKSlcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoTS5jb25jYXQoc29tZSgxKSwgc29tZSgyKSksIHNvbWUoMykpXG4gKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgZ2V0TW9ub2lkID0gZnVuY3Rpb24gKFMpIHsgcmV0dXJuICh7XG4gICAgY29uY2F0OiBmdW5jdGlvbiAoeCwgeSkgeyByZXR1cm4gKGlzTm9uZSh4KSA/IHkgOiBpc05vbmUoeSkgPyB4IDogc29tZShTLmNvbmNhdCh4LnZhbHVlLCB5LnZhbHVlKSkpOyB9LFxuICAgIGVtcHR5OiBub25lXG59KTsgfTtcbi8qKlxuICogQGNhdGVnb3J5IG1hcHBpbmdcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIG1hcCA9IGZ1bmN0aW9uIChmKSB7IHJldHVybiBmdW5jdGlvbiAoZmEpIHtcbiAgICByZXR1cm4gaXNOb25lKGZhKSA/IG5vbmUgOiBzb21lKGYoZmEudmFsdWUpKTtcbn07IH07XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjcuMFxuICovXG5leHBvcnQgdmFyIEZ1bmN0b3IgPSB7XG4gICAgVVJJOiBVUkksXG4gICAgbWFwOiBfbWFwXG59O1xuLyoqXG4gKiBNYXBzIHRoZSBgU29tZWAgdmFsdWUgb2YgdGhpcyBgT3B0aW9uYCB0byB0aGUgc3BlY2lmaWVkIGNvbnN0YW50IHZhbHVlLlxuICpcbiAqIEBjYXRlZ29yeSBtYXBwaW5nXG4gKiBAc2luY2UgMi4xNi4wXG4gKi9cbmV4cG9ydCB2YXIgYXMgPSBkdWFsKDIsIGFzXyhGdW5jdG9yKSk7XG4vKipcbiAqIE1hcHMgdGhlIGBTb21lYCB2YWx1ZSBvZiB0aGlzIGBPcHRpb25gIHRvIHRoZSB2b2lkIGNvbnN0YW50IHZhbHVlLlxuICpcbiAqIEBjYXRlZ29yeSBtYXBwaW5nXG4gKiBAc2luY2UgMi4xNi4wXG4gKi9cbmV4cG9ydCB2YXIgYXNVbml0ID0gYXNVbml0XyhGdW5jdG9yKTtcbi8qKlxuICogQGNhdGVnb3J5IGNvbnN0cnVjdG9yc1xuICogQHNpbmNlIDIuNy4wXG4gKi9cbmV4cG9ydCB2YXIgb2YgPSBzb21lO1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi4xMC4wXG4gKi9cbmV4cG9ydCB2YXIgUG9pbnRlZCA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICBvZjogb2Zcbn07XG4vKipcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIGFwID0gZnVuY3Rpb24gKGZhKSB7IHJldHVybiBmdW5jdGlvbiAoZmFiKSB7XG4gICAgcmV0dXJuIGlzTm9uZShmYWIpID8gbm9uZSA6IGlzTm9uZShmYSkgPyBub25lIDogc29tZShmYWIudmFsdWUoZmEudmFsdWUpKTtcbn07IH07XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjEwLjBcbiAqL1xuZXhwb3J0IHZhciBBcHBseSA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICBtYXA6IF9tYXAsXG4gICAgYXA6IF9hcFxufTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuNy4wXG4gKi9cbmV4cG9ydCB2YXIgQXBwbGljYXRpdmUgPSB7XG4gICAgVVJJOiBVUkksXG4gICAgbWFwOiBfbWFwLFxuICAgIGFwOiBfYXAsXG4gICAgb2Y6IG9mXG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgc2VxdWVuY2luZ1xuICogQHNpbmNlIDIuMTQuMFxuICovXG5leHBvcnQgdmFyIGZsYXRNYXAgPSAvKiNfX1BVUkVfXyovIGR1YWwoMiwgZnVuY3Rpb24gKG1hLCBmKSB7IHJldHVybiAoaXNOb25lKG1hKSA/IG5vbmUgOiBmKG1hLnZhbHVlKSk7IH0pO1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi4xMC4wXG4gKi9cbmV4cG9ydCB2YXIgQ2hhaW4gPSB7XG4gICAgVVJJOiBVUkksXG4gICAgbWFwOiBfbWFwLFxuICAgIGFwOiBfYXAsXG4gICAgY2hhaW46IGZsYXRNYXBcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjcuMFxuICovXG5leHBvcnQgdmFyIE1vbmFkID0ge1xuICAgIFVSSTogVVJJLFxuICAgIG1hcDogX21hcCxcbiAgICBhcDogX2FwLFxuICAgIG9mOiBvZixcbiAgICBjaGFpbjogZmxhdE1hcFxufTtcbi8qKlxuICogQGNhdGVnb3J5IGZvbGRpbmdcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIHJlZHVjZSA9IGZ1bmN0aW9uIChiLCBmKSB7IHJldHVybiBmdW5jdGlvbiAoZmEpIHtcbiAgICByZXR1cm4gaXNOb25lKGZhKSA/IGIgOiBmKGIsIGZhLnZhbHVlKTtcbn07IH07XG4vKipcbiAqIEBjYXRlZ29yeSBmb2xkaW5nXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciBmb2xkTWFwID0gZnVuY3Rpb24gKE0pIHsgcmV0dXJuIGZ1bmN0aW9uIChmKSB7IHJldHVybiBmdW5jdGlvbiAoZmEpIHtcbiAgICByZXR1cm4gaXNOb25lKGZhKSA/IE0uZW1wdHkgOiBmKGZhLnZhbHVlKTtcbn07IH07IH07XG4vKipcbiAqIEBjYXRlZ29yeSBmb2xkaW5nXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciByZWR1Y2VSaWdodCA9IGZ1bmN0aW9uIChiLCBmKSB7IHJldHVybiBmdW5jdGlvbiAoZmEpIHtcbiAgICByZXR1cm4gaXNOb25lKGZhKSA/IGIgOiBmKGZhLnZhbHVlLCBiKTtcbn07IH07XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjcuMFxuICovXG5leHBvcnQgdmFyIEZvbGRhYmxlID0ge1xuICAgIFVSSTogVVJJLFxuICAgIHJlZHVjZTogX3JlZHVjZSxcbiAgICBmb2xkTWFwOiBfZm9sZE1hcCxcbiAgICByZWR1Y2VSaWdodDogX3JlZHVjZVJpZ2h0XG59O1xuLyoqXG4gKiBSZXR1cm5zIHRoZSBwcm92aWRlZCBgT3B0aW9uYCBgdGhhdGAgaWYgYHNlbGZgIGlzIGBOb25lYCwgb3RoZXJ3aXNlIHJldHVybnMgYHNlbGZgLlxuICpcbiAqIEBwYXJhbSBzZWxmIC0gVGhlIGZpcnN0IGBPcHRpb25gIHRvIGJlIGNoZWNrZWQuXG4gKiBAcGFyYW0gdGhhdCAtIFRoZSBgT3B0aW9uYCB0byByZXR1cm4gaWYgYHNlbGZgIGlzIGBOb25lYC5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0ICogYXMgTyBmcm9tIFwiZnAtdHMvT3B0aW9uXCJcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKE8ub3JFbHNlKE8ubm9uZSwgKCkgPT4gTy5ub25lKSwgTy5ub25lKVxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChPLm9yRWxzZShPLnNvbWUoMSksICgpID0+IE8ubm9uZSksIE8uc29tZSgxKSlcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoTy5vckVsc2UoTy5ub25lLCAoKSA9PiBPLnNvbWUoJ2InKSksIE8uc29tZSgnYicpKVxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChPLm9yRWxzZShPLnNvbWUoMSksICgpID0+IE8uc29tZSgnYicpKSwgTy5zb21lKDEpKVxuICpcbiAqIEBjYXRlZ29yeSBlcnJvciBoYW5kbGluZ1xuICogQHNpbmNlIDIuMTYuMFxuICovXG5leHBvcnQgdmFyIG9yRWxzZSA9IGR1YWwoMiwgZnVuY3Rpb24gKHNlbGYsIHRoYXQpIHsgcmV0dXJuIChpc05vbmUoc2VsZikgPyB0aGF0KCkgOiBzZWxmKTsgfSk7XG4vKipcbiAqIEFsaWFzIG9mIGBvckVsc2VgLlxuICpcbiAqIExlc3Mgc3RyaWN0IHZlcnNpb24gb2YgW2BhbHRgXSgjYWx0KS5cbiAqXG4gKiBUaGUgYFdgIHN1ZmZpeCAoc2hvcnQgZm9yICoqVyoqaWRlbmluZykgbWVhbnMgdGhhdCB0aGUgcmV0dXJuIHR5cGVzIHdpbGwgYmUgbWVyZ2VkLlxuICpcbiAqIEBjYXRlZ29yeSBsZWdhY3lcbiAqIEBzaW5jZSAyLjkuMFxuICovXG5leHBvcnQgdmFyIGFsdFcgPSBvckVsc2U7XG4vKipcbiAqIEFsaWFzIG9mIGBvckVsc2VgLlxuICpcbiAqIEBjYXRlZ29yeSBsZWdhY3lcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIGFsdCA9IG9yRWxzZTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuNy4wXG4gKi9cbmV4cG9ydCB2YXIgQWx0ID0ge1xuICAgIFVSSTogVVJJLFxuICAgIG1hcDogX21hcCxcbiAgICBhbHQ6IF9hbHRcbn07XG4vKipcbiAqIEBzaW5jZSAyLjcuMFxuICovXG5leHBvcnQgdmFyIHplcm8gPSBmdW5jdGlvbiAoKSB7IHJldHVybiBub25lOyB9O1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi4xMS4wXG4gKi9cbmV4cG9ydCB2YXIgWmVybyA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICB6ZXJvOiB6ZXJvXG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgZG8gbm90YXRpb25cbiAqIEBzaW5jZSAyLjExLjBcbiAqL1xuZXhwb3J0IHZhciBndWFyZCA9IC8qI19fUFVSRV9fKi8gZ3VhcmRfKFplcm8sIFBvaW50ZWQpO1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi43LjBcbiAqL1xuZXhwb3J0IHZhciBBbHRlcm5hdGl2ZSA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICBtYXA6IF9tYXAsXG4gICAgYXA6IF9hcCxcbiAgICBvZjogb2YsXG4gICAgYWx0OiBfYWx0LFxuICAgIHplcm86IHplcm9cbn07XG4vKipcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIGV4dGVuZCA9IGZ1bmN0aW9uIChmKSB7IHJldHVybiBmdW5jdGlvbiAod2EpIHtcbiAgICByZXR1cm4gaXNOb25lKHdhKSA/IG5vbmUgOiBzb21lKGYod2EpKTtcbn07IH07XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjcuMFxuICovXG5leHBvcnQgdmFyIEV4dGVuZCA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICBtYXA6IF9tYXAsXG4gICAgZXh0ZW5kOiBfZXh0ZW5kXG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgZmlsdGVyaW5nXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciBjb21wYWN0ID0gLyojX19QVVJFX18qLyBmbGF0TWFwKGlkZW50aXR5KTtcbnZhciBkZWZhdWx0U2VwYXJhdGVkID0gLyojX19QVVJFX18qLyBzZXBhcmF0ZWQobm9uZSwgbm9uZSk7XG4vKipcbiAqIEBjYXRlZ29yeSBmaWx0ZXJpbmdcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIHNlcGFyYXRlID0gZnVuY3Rpb24gKG1hKSB7XG4gICAgcmV0dXJuIGlzTm9uZShtYSkgPyBkZWZhdWx0U2VwYXJhdGVkIDogc2VwYXJhdGVkKGdldExlZnQobWEudmFsdWUpLCBnZXRSaWdodChtYS52YWx1ZSkpO1xufTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuNy4wXG4gKi9cbmV4cG9ydCB2YXIgQ29tcGFjdGFibGUgPSB7XG4gICAgVVJJOiBVUkksXG4gICAgY29tcGFjdDogY29tcGFjdCxcbiAgICBzZXBhcmF0ZTogc2VwYXJhdGVcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBmaWx0ZXJpbmdcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIGZpbHRlciA9IGZ1bmN0aW9uIChwcmVkaWNhdGUpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGZhKSB7XG4gICAgICAgIHJldHVybiBpc05vbmUoZmEpID8gbm9uZSA6IHByZWRpY2F0ZShmYS52YWx1ZSkgPyBmYSA6IG5vbmU7XG4gICAgfTtcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBmaWx0ZXJpbmdcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIGZpbHRlck1hcCA9IGZ1bmN0aW9uIChmKSB7IHJldHVybiBmdW5jdGlvbiAoZmEpIHtcbiAgICByZXR1cm4gaXNOb25lKGZhKSA/IG5vbmUgOiBmKGZhLnZhbHVlKTtcbn07IH07XG4vKipcbiAqIEBjYXRlZ29yeSBmaWx0ZXJpbmdcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIHBhcnRpdGlvbiA9IGZ1bmN0aW9uIChwcmVkaWNhdGUpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGZhKSB7XG4gICAgICAgIHJldHVybiBzZXBhcmF0ZWQoX2ZpbHRlcihmYSwgbm90KHByZWRpY2F0ZSkpLCBfZmlsdGVyKGZhLCBwcmVkaWNhdGUpKTtcbiAgICB9O1xufTtcbi8qKlxuICogQGNhdGVnb3J5IGZpbHRlcmluZ1xuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgcGFydGl0aW9uTWFwID0gZnVuY3Rpb24gKGYpIHsgcmV0dXJuIGZsb3cobWFwKGYpLCBzZXBhcmF0ZSk7IH07XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjcuMFxuICovXG5leHBvcnQgdmFyIEZpbHRlcmFibGUgPSB7XG4gICAgVVJJOiBVUkksXG4gICAgbWFwOiBfbWFwLFxuICAgIGNvbXBhY3Q6IGNvbXBhY3QsXG4gICAgc2VwYXJhdGU6IHNlcGFyYXRlLFxuICAgIGZpbHRlcjogX2ZpbHRlcixcbiAgICBmaWx0ZXJNYXA6IF9maWx0ZXJNYXAsXG4gICAgcGFydGl0aW9uOiBfcGFydGl0aW9uLFxuICAgIHBhcnRpdGlvbk1hcDogX3BhcnRpdGlvbk1hcFxufTtcbi8qKlxuICogQGNhdGVnb3J5IHRyYXZlcnNpbmdcbiAqIEBzaW5jZSAyLjYuM1xuICovXG5leHBvcnQgdmFyIHRyYXZlcnNlID0gZnVuY3Rpb24gKEYpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGYpIHtcbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uICh0YSkge1xuICAgICAgICAgICAgcmV0dXJuIGlzTm9uZSh0YSkgPyBGLm9mKG5vbmUpIDogRi5tYXAoZih0YS52YWx1ZSksIHNvbWUpO1xuICAgICAgICB9O1xuICAgIH07XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgdHJhdmVyc2luZ1xuICogQHNpbmNlIDIuNi4zXG4gKi9cbmV4cG9ydCB2YXIgc2VxdWVuY2UgPSBmdW5jdGlvbiAoRikge1xuICAgIHJldHVybiBmdW5jdGlvbiAodGEpIHtcbiAgICAgICAgcmV0dXJuIGlzTm9uZSh0YSkgPyBGLm9mKG5vbmUpIDogRi5tYXAodGEudmFsdWUsIHNvbWUpO1xuICAgIH07XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi43LjBcbiAqL1xuZXhwb3J0IHZhciBUcmF2ZXJzYWJsZSA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICBtYXA6IF9tYXAsXG4gICAgcmVkdWNlOiBfcmVkdWNlLFxuICAgIGZvbGRNYXA6IF9mb2xkTWFwLFxuICAgIHJlZHVjZVJpZ2h0OiBfcmVkdWNlUmlnaHQsXG4gICAgdHJhdmVyc2U6IF90cmF2ZXJzZSxcbiAgICBzZXF1ZW5jZTogc2VxdWVuY2Vcbn07XG52YXIgX3dpdGhlciA9IC8qI19fUFVSRV9fKi8gd2l0aGVyRGVmYXVsdChUcmF2ZXJzYWJsZSwgQ29tcGFjdGFibGUpO1xudmFyIF93aWx0ID0gLyojX19QVVJFX18qLyB3aWx0RGVmYXVsdChUcmF2ZXJzYWJsZSwgQ29tcGFjdGFibGUpO1xuLyoqXG4gKiBAY2F0ZWdvcnkgZmlsdGVyaW5nXG4gKiBAc2luY2UgMi42LjVcbiAqL1xuZXhwb3J0IHZhciB3aXRoZXIgPSBmdW5jdGlvbiAoRikge1xuICAgIHZhciBfd2l0aGVyRiA9IF93aXRoZXIoRik7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChmKSB7IHJldHVybiBmdW5jdGlvbiAoZmEpIHsgcmV0dXJuIF93aXRoZXJGKGZhLCBmKTsgfTsgfTtcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBmaWx0ZXJpbmdcbiAqIEBzaW5jZSAyLjYuNVxuICovXG5leHBvcnQgdmFyIHdpbHQgPSBmdW5jdGlvbiAoRikge1xuICAgIHZhciBfd2lsdEYgPSBfd2lsdChGKTtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGYpIHsgcmV0dXJuIGZ1bmN0aW9uIChmYSkgeyByZXR1cm4gX3dpbHRGKGZhLCBmKTsgfTsgfTtcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjcuMFxuICovXG5leHBvcnQgdmFyIFdpdGhlcmFibGUgPSB7XG4gICAgVVJJOiBVUkksXG4gICAgbWFwOiBfbWFwLFxuICAgIHJlZHVjZTogX3JlZHVjZSxcbiAgICBmb2xkTWFwOiBfZm9sZE1hcCxcbiAgICByZWR1Y2VSaWdodDogX3JlZHVjZVJpZ2h0LFxuICAgIHRyYXZlcnNlOiBfdHJhdmVyc2UsXG4gICAgc2VxdWVuY2U6IHNlcXVlbmNlLFxuICAgIGNvbXBhY3Q6IGNvbXBhY3QsXG4gICAgc2VwYXJhdGU6IHNlcGFyYXRlLFxuICAgIGZpbHRlcjogX2ZpbHRlcixcbiAgICBmaWx0ZXJNYXA6IF9maWx0ZXJNYXAsXG4gICAgcGFydGl0aW9uOiBfcGFydGl0aW9uLFxuICAgIHBhcnRpdGlvbk1hcDogX3BhcnRpdGlvbk1hcCxcbiAgICB3aXRoZXI6IF93aXRoZXIsXG4gICAgd2lsdDogX3dpbHRcbn07XG4vKipcbiAqIEBzaW5jZSAyLjcuMFxuICovXG5leHBvcnQgdmFyIHRocm93RXJyb3IgPSBmdW5jdGlvbiAoKSB7IHJldHVybiBub25lOyB9O1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi43LjBcbiAqL1xuZXhwb3J0IHZhciBNb25hZFRocm93ID0ge1xuICAgIFVSSTogVVJJLFxuICAgIG1hcDogX21hcCxcbiAgICBhcDogX2FwLFxuICAgIG9mOiBvZixcbiAgICBjaGFpbjogZmxhdE1hcCxcbiAgICB0aHJvd0Vycm9yOiB0aHJvd0Vycm9yXG59O1xuLyoqXG4gKiBUcmFuc2Zvcm1zIGFuIGBFaXRoZXJgIHRvIGFuIGBPcHRpb25gIGRpc2NhcmRpbmcgdGhlIGVycm9yLlxuICpcbiAqIEFsaWFzIG9mIFtnZXRSaWdodF0oI2dldHJpZ2h0KVxuICpcbiAqIEBjYXRlZ29yeSBjb252ZXJzaW9uc1xuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgZnJvbUVpdGhlciA9IGdldFJpZ2h0O1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi4xMS4wXG4gKi9cbmV4cG9ydCB2YXIgRnJvbUVpdGhlciA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICBmcm9tRWl0aGVyOiBmcm9tRWl0aGVyXG59O1xuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLy8gcmVmaW5lbWVudHNcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8qKlxuICogUmV0dXJucyBgdHJ1ZWAgaWYgdGhlIG9wdGlvbiBpcyBhbiBpbnN0YW5jZSBvZiBgU29tZWAsIGBmYWxzZWAgb3RoZXJ3aXNlLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBzb21lLCBub25lLCBpc1NvbWUgfSBmcm9tICdmcC10cy9PcHRpb24nXG4gKlxuICogYXNzZXJ0LnN0cmljdEVxdWFsKGlzU29tZShzb21lKDEpKSwgdHJ1ZSlcbiAqIGFzc2VydC5zdHJpY3RFcXVhbChpc1NvbWUobm9uZSksIGZhbHNlKVxuICpcbiAqIEBjYXRlZ29yeSByZWZpbmVtZW50c1xuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgaXNTb21lID0gXy5pc1NvbWU7XG4vKipcbiAqIFJldHVybnMgYHRydWVgIGlmIHRoZSBvcHRpb24gaXMgYE5vbmVgLCBgZmFsc2VgIG90aGVyd2lzZS5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgc29tZSwgbm9uZSwgaXNOb25lIH0gZnJvbSAnZnAtdHMvT3B0aW9uJ1xuICpcbiAqIGFzc2VydC5zdHJpY3RFcXVhbChpc05vbmUoc29tZSgxKSksIGZhbHNlKVxuICogYXNzZXJ0LnN0cmljdEVxdWFsKGlzTm9uZShub25lKSwgdHJ1ZSlcbiAqXG4gKiBAY2F0ZWdvcnkgcmVmaW5lbWVudHNcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIGlzTm9uZSA9IGZ1bmN0aW9uIChmYSkgeyByZXR1cm4gZmEuX3RhZyA9PT0gJ05vbmUnOyB9O1xuLyoqXG4gKiBMZXNzIHN0cmljdCB2ZXJzaW9uIG9mIFtgbWF0Y2hgXSgjbWF0Y2gpLlxuICpcbiAqIFRoZSBgV2Agc3VmZml4IChzaG9ydCBmb3IgKipXKippZGVuaW5nKSBtZWFucyB0aGF0IHRoZSBoYW5kbGVyIHJldHVybiB0eXBlcyB3aWxsIGJlIG1lcmdlZC5cbiAqXG4gKiBAY2F0ZWdvcnkgcGF0dGVybiBtYXRjaGluZ1xuICogQHNpbmNlIDIuMTAuMFxuICovXG5leHBvcnQgdmFyIG1hdGNoVyA9IGZ1bmN0aW9uIChvbk5vbmUsIG9uU29tZSkge1xuICAgIHJldHVybiBmdW5jdGlvbiAobWEpIHtcbiAgICAgICAgcmV0dXJuIGlzTm9uZShtYSkgPyBvbk5vbmUoKSA6IG9uU29tZShtYS52YWx1ZSk7XG4gICAgfTtcbn07XG4vKipcbiAqIEFsaWFzIG9mIFtgbWF0Y2hXYF0oI21hdGNodykuXG4gKlxuICogQGNhdGVnb3J5IHBhdHRlcm4gbWF0Y2hpbmdcbiAqIEBzaW5jZSAyLjEwLjBcbiAqL1xuZXhwb3J0IHZhciBmb2xkVyA9IG1hdGNoVztcbi8qKlxuICogVGFrZXMgYSAobGF6eSkgZGVmYXVsdCB2YWx1ZSwgYSBmdW5jdGlvbiwgYW5kIGFuIGBPcHRpb25gIHZhbHVlLCBpZiB0aGUgYE9wdGlvbmAgdmFsdWUgaXMgYE5vbmVgIHRoZSBkZWZhdWx0IHZhbHVlIGlzXG4gKiByZXR1cm5lZCwgb3RoZXJ3aXNlIHRoZSBmdW5jdGlvbiBpcyBhcHBsaWVkIHRvIHRoZSB2YWx1ZSBpbnNpZGUgdGhlIGBTb21lYCBhbmQgdGhlIHJlc3VsdCBpcyByZXR1cm5lZC5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgc29tZSwgbm9uZSwgbWF0Y2ggfSBmcm9tICdmcC10cy9PcHRpb24nXG4gKiBpbXBvcnQgeyBwaXBlIH0gZnJvbSAnZnAtdHMvZnVuY3Rpb24nXG4gKlxuICogYXNzZXJ0LnN0cmljdEVxdWFsKFxuICogICBwaXBlKFxuICogICAgIHNvbWUoMSksXG4gKiAgICAgbWF0Y2goKCkgPT4gJ2Egbm9uZScsIGEgPT4gYGEgc29tZSBjb250YWluaW5nICR7YX1gKVxuICogICApLFxuICogICAnYSBzb21lIGNvbnRhaW5pbmcgMSdcbiAqIClcbiAqXG4gKiBhc3NlcnQuc3RyaWN0RXF1YWwoXG4gKiAgIHBpcGUoXG4gKiAgICAgbm9uZSxcbiAqICAgICBtYXRjaCgoKSA9PiAnYSBub25lJywgYSA9PiBgYSBzb21lIGNvbnRhaW5pbmcgJHthfWApXG4gKiAgICksXG4gKiAgICdhIG5vbmUnXG4gKiApXG4gKlxuICogQGNhdGVnb3J5IHBhdHRlcm4gbWF0Y2hpbmdcbiAqIEBzaW5jZSAyLjEwLjBcbiAqL1xuZXhwb3J0IHZhciBtYXRjaCA9IG1hdGNoVztcbi8qKlxuICogQWxpYXMgb2YgW2BtYXRjaGBdKCNtYXRjaCkuXG4gKlxuICogQGNhdGVnb3J5IHBhdHRlcm4gbWF0Y2hpbmdcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIGZvbGQgPSBtYXRjaDtcbi8qKlxuICogTGVzcyBzdHJpY3QgdmVyc2lvbiBvZiBbYGdldE9yRWxzZWBdKCNnZXRvcmVsc2UpLlxuICpcbiAqIFRoZSBgV2Agc3VmZml4IChzaG9ydCBmb3IgKipXKippZGVuaW5nKSBtZWFucyB0aGF0IHRoZSBoYW5kbGVyIHJldHVybiB0eXBlIHdpbGwgYmUgbWVyZ2VkLlxuICpcbiAqIEBjYXRlZ29yeSBlcnJvciBoYW5kbGluZ1xuICogQHNpbmNlIDIuNi4wXG4gKi9cbmV4cG9ydCB2YXIgZ2V0T3JFbHNlVyA9IGZ1bmN0aW9uIChvbk5vbmUpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKG1hKSB7XG4gICAgICAgIHJldHVybiBpc05vbmUobWEpID8gb25Ob25lKCkgOiBtYS52YWx1ZTtcbiAgICB9O1xufTtcbi8qKlxuICogRXh0cmFjdHMgdGhlIHZhbHVlIG91dCBvZiB0aGUgc3RydWN0dXJlLCBpZiBpdCBleGlzdHMuIE90aGVyd2lzZSByZXR1cm5zIHRoZSBnaXZlbiBkZWZhdWx0IHZhbHVlXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IHNvbWUsIG5vbmUsIGdldE9yRWxzZSB9IGZyb20gJ2ZwLXRzL09wdGlvbidcbiAqIGltcG9ydCB7IHBpcGUgfSBmcm9tICdmcC10cy9mdW5jdGlvbidcbiAqXG4gKiBhc3NlcnQuc3RyaWN0RXF1YWwoXG4gKiAgIHBpcGUoXG4gKiAgICAgc29tZSgxKSxcbiAqICAgICBnZXRPckVsc2UoKCkgPT4gMClcbiAqICAgKSxcbiAqICAgMVxuICogKVxuICogYXNzZXJ0LnN0cmljdEVxdWFsKFxuICogICBwaXBlKFxuICogICAgIG5vbmUsXG4gKiAgICAgZ2V0T3JFbHNlKCgpID0+IDApXG4gKiAgICksXG4gKiAgIDBcbiAqIClcbiAqXG4gKiBAY2F0ZWdvcnkgZXJyb3IgaGFuZGxpbmdcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIGdldE9yRWxzZSA9IGdldE9yRWxzZVc7XG4vKipcbiAqIEBjYXRlZ29yeSBtYXBwaW5nXG4gKiBAc2luY2UgMi4xMC4wXG4gKi9cbmV4cG9ydCB2YXIgZmxhcCA9IC8qI19fUFVSRV9fKi8gZmxhcF8oRnVuY3Rvcik7XG4vKipcbiAqIENvbWJpbmUgdHdvIGVmZmVjdGZ1bCBhY3Rpb25zLCBrZWVwaW5nIG9ubHkgdGhlIHJlc3VsdCBvZiB0aGUgZmlyc3QuXG4gKlxuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgYXBGaXJzdCA9IC8qI19fUFVSRV9fKi8gYXBGaXJzdF8oQXBwbHkpO1xuLyoqXG4gKiBDb21iaW5lIHR3byBlZmZlY3RmdWwgYWN0aW9ucywga2VlcGluZyBvbmx5IHRoZSByZXN1bHQgb2YgdGhlIHNlY29uZC5cbiAqXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciBhcFNlY29uZCA9IC8qI19fUFVSRV9fKi8gYXBTZWNvbmRfKEFwcGx5KTtcbi8qKlxuICogQGNhdGVnb3J5IHNlcXVlbmNpbmdcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIGZsYXR0ZW4gPSBjb21wYWN0O1xuLyoqXG4gKiBDb21wb3NlcyBjb21wdXRhdGlvbnMgaW4gc2VxdWVuY2UsIHVzaW5nIHRoZSByZXR1cm4gdmFsdWUgb2Ygb25lIGNvbXB1dGF0aW9uIHRvIGRldGVybWluZSB0aGUgbmV4dCBjb21wdXRhdGlvbiBhbmRcbiAqIGtlZXBpbmcgb25seSB0aGUgcmVzdWx0IG9mIHRoZSBmaXJzdC5cbiAqXG4gKiBAY2F0ZWdvcnkgY29tYmluYXRvcnNcbiAqIEBzaW5jZSAyLjE1LjBcbiAqL1xuZXhwb3J0IHZhciB0YXAgPSAvKiNfX1BVUkVfXyovIGR1YWwoMiwgY2hhaW5hYmxlLnRhcChDaGFpbikpO1xuLyoqXG4gKiBDb21wb3NlcyBjb21wdXRhdGlvbnMgaW4gc2VxdWVuY2UsIHVzaW5nIHRoZSByZXR1cm4gdmFsdWUgb2Ygb25lIGNvbXB1dGF0aW9uIHRvIGRldGVybWluZSB0aGUgbmV4dCBjb21wdXRhdGlvbiBhbmRcbiAqIGtlZXBpbmcgb25seSB0aGUgcmVzdWx0IG9mIHRoZSBmaXJzdC5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgcGlwZSB9IGZyb20gJ2ZwLXRzL2Z1bmN0aW9uJ1xuICogaW1wb3J0ICogYXMgTyBmcm9tICdmcC10cy9PcHRpb24nXG4gKiBpbXBvcnQgKiBhcyBFIGZyb20gJ2ZwLXRzL0VpdGhlcidcbiAqXG4gKiBjb25zdCBjb21wdXRlID0gKHZhbHVlOiBudW1iZXIpID0+IHBpcGUoXG4gKiAgIE8ub2YodmFsdWUpLFxuICogICBPLnRhcEVpdGhlcigodmFsdWUpID0+IHZhbHVlID4gMCA/IEUucmlnaHQoJ29rJykgOiBFLmxlZnQoJ2Vycm9yJykpLFxuICogKVxuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoY29tcHV0ZSgxKSwgTy5vZigxKSlcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoY29tcHV0ZSgtNDIpLCBPLm5vbmUpXG4gKlxuICogQGNhdGVnb3J5IGNvbWJpbmF0b3JzXG4gKiBAc2luY2UgMi4xNi4wXG4gKi9cbmV4cG9ydCB2YXIgdGFwRWl0aGVyID0gLyojX19QVVJFX18qLyBkdWFsKDIsIHRhcEVpdGhlcl8oRnJvbUVpdGhlciwgQ2hhaW4pKTtcbi8qKlxuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgZHVwbGljYXRlID0gLyojX19QVVJFX18qLyBleHRlbmQoaWRlbnRpdHkpO1xuLyoqXG4gKiBAY2F0ZWdvcnkgbGlmdGluZ1xuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIGZyb21FaXRoZXJLID0gLyojX19QVVJFX18qLyBmcm9tRWl0aGVyS18oRnJvbUVpdGhlcik7XG4vKipcbiAqIEBjYXRlZ29yeSBzZXF1ZW5jaW5nXG4gKiBAc2luY2UgMi4xMS4wXG4gKi9cbmV4cG9ydCB2YXIgY2hhaW5FaXRoZXJLID0gXG4vKiNfX1BVUkVfXyovIGNoYWluRWl0aGVyS18oRnJvbUVpdGhlciwgQ2hhaW4pO1xuLyoqXG4gKiBBbGlhcyBvZiBgdGFwRWl0aGVyYC5cbiAqXG4gKiBAY2F0ZWdvcnkgbGVnYWN5XG4gKiBAc2luY2UgMi4xMi4wXG4gKi9cbmV4cG9ydCB2YXIgY2hhaW5GaXJzdEVpdGhlcksgPSB0YXBFaXRoZXI7XG4vKipcbiAqIENvbnN0cnVjdHMgYSBuZXcgYE9wdGlvbmAgZnJvbSBhIG51bGxhYmxlIHR5cGUuIElmIHRoZSB2YWx1ZSBpcyBgbnVsbGAgb3IgYHVuZGVmaW5lZGAsIHJldHVybnMgYE5vbmVgLCBvdGhlcndpc2VcbiAqIHJldHVybnMgdGhlIHZhbHVlIHdyYXBwZWQgaW4gYSBgU29tZWAuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IG5vbmUsIHNvbWUsIGZyb21OdWxsYWJsZSB9IGZyb20gJ2ZwLXRzL09wdGlvbidcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKGZyb21OdWxsYWJsZSh1bmRlZmluZWQpLCBub25lKVxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChmcm9tTnVsbGFibGUobnVsbCksIG5vbmUpXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKGZyb21OdWxsYWJsZSgxKSwgc29tZSgxKSlcbiAqXG4gKiBAY2F0ZWdvcnkgY29udmVyc2lvbnNcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIGZyb21OdWxsYWJsZSA9IGZ1bmN0aW9uIChhKSB7IHJldHVybiAoYSA9PSBudWxsID8gbm9uZSA6IHNvbWUoYSkpOyB9O1xuLyoqXG4gKiBUcmFuc2Zvcm1zIGFuIGV4Y2VwdGlvbiBpbnRvIGFuIGBPcHRpb25gLiBJZiBgZmAgdGhyb3dzLCByZXR1cm5zIGBOb25lYCwgb3RoZXJ3aXNlIHJldHVybnMgdGhlIG91dHB1dCB3cmFwcGVkIGluIGFcbiAqIGBTb21lYC5cbiAqXG4gKiBTZWUgYWxzbyBbYHRyeUNhdGNoS2BdKCN0cnljYXRjaGspLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBub25lLCBzb21lLCB0cnlDYXRjaCB9IGZyb20gJ2ZwLXRzL09wdGlvbidcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKFxuICogICB0cnlDYXRjaCgoKSA9PiB7XG4gKiAgICAgdGhyb3cgbmV3IEVycm9yKClcbiAqICAgfSksXG4gKiAgIG5vbmVcbiAqIClcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwodHJ5Q2F0Y2goKCkgPT4gMSksIHNvbWUoMSkpXG4gKlxuICogQGNhdGVnb3J5IGludGVyb3BcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIHRyeUNhdGNoID0gZnVuY3Rpb24gKGYpIHtcbiAgICB0cnkge1xuICAgICAgICByZXR1cm4gc29tZShmKCkpO1xuICAgIH1cbiAgICBjYXRjaCAoZSkge1xuICAgICAgICByZXR1cm4gbm9uZTtcbiAgICB9XG59O1xuLyoqXG4gKiBDb252ZXJ0cyBhIGZ1bmN0aW9uIHRoYXQgbWF5IHRocm93IHRvIG9uZSByZXR1cm5pbmcgYSBgT3B0aW9uYC5cbiAqXG4gKiBAY2F0ZWdvcnkgaW50ZXJvcFxuICogQHNpbmNlIDIuMTAuMFxuICovXG5leHBvcnQgdmFyIHRyeUNhdGNoSyA9IGZ1bmN0aW9uIChmKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIGEgPSBbXTtcbiAgICAgICAgZm9yICh2YXIgX2kgPSAwOyBfaSA8IGFyZ3VtZW50cy5sZW5ndGg7IF9pKyspIHtcbiAgICAgICAgICAgIGFbX2ldID0gYXJndW1lbnRzW19pXTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdHJ5Q2F0Y2goZnVuY3Rpb24gKCkgeyByZXR1cm4gZi5hcHBseSh2b2lkIDAsIGEpOyB9KTtcbiAgICB9O1xufTtcbi8qKlxuICogUmV0dXJucyBhICpzbWFydCBjb25zdHJ1Y3RvciogZnJvbSBhIGZ1bmN0aW9uIHRoYXQgcmV0dXJucyBhIG51bGxhYmxlIHZhbHVlLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBmcm9tTnVsbGFibGVLLCBub25lLCBzb21lIH0gZnJvbSAnZnAtdHMvT3B0aW9uJ1xuICpcbiAqIGNvbnN0IGYgPSAoczogc3RyaW5nKTogbnVtYmVyIHwgdW5kZWZpbmVkID0+IHtcbiAqICAgY29uc3QgbiA9IHBhcnNlRmxvYXQocylcbiAqICAgcmV0dXJuIGlzTmFOKG4pID8gdW5kZWZpbmVkIDogblxuICogfVxuICpcbiAqIGNvbnN0IGcgPSBmcm9tTnVsbGFibGVLKGYpXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChnKCcxJyksIHNvbWUoMSkpXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKGcoJ2EnKSwgbm9uZSlcbiAqXG4gKiBAY2F0ZWdvcnkgbGlmdGluZ1xuICogQHNpbmNlIDIuOS4wXG4gKi9cbmV4cG9ydCB2YXIgZnJvbU51bGxhYmxlSyA9IGZ1bmN0aW9uIChmKSB7IHJldHVybiBmbG93KGYsIGZyb21OdWxsYWJsZSk7IH07XG4vKipcbiAqIFRoaXMgaXMgYGNoYWluYCArIGBmcm9tTnVsbGFibGVgLCB1c2VmdWwgd2hlbiB3b3JraW5nIHdpdGggb3B0aW9uYWwgdmFsdWVzLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBzb21lLCBub25lLCBmcm9tTnVsbGFibGUsIGNoYWluTnVsbGFibGVLIH0gZnJvbSAnZnAtdHMvT3B0aW9uJ1xuICogaW1wb3J0IHsgcGlwZSB9IGZyb20gJ2ZwLXRzL2Z1bmN0aW9uJ1xuICpcbiAqIGludGVyZmFjZSBFbXBsb3llZSB7XG4gKiAgIHJlYWRvbmx5IGNvbXBhbnk/OiB7XG4gKiAgICAgcmVhZG9ubHkgYWRkcmVzcz86IHtcbiAqICAgICAgIHJlYWRvbmx5IHN0cmVldD86IHtcbiAqICAgICAgICAgcmVhZG9ubHkgbmFtZT86IHN0cmluZ1xuICogICAgICAgfVxuICogICAgIH1cbiAqICAgfVxuICogfVxuICpcbiAqIGNvbnN0IGVtcGxveWVlMTogRW1wbG95ZWUgPSB7IGNvbXBhbnk6IHsgYWRkcmVzczogeyBzdHJlZXQ6IHsgbmFtZTogJ2hpZ2ggc3RyZWV0JyB9IH0gfSB9XG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChcbiAqICAgcGlwZShcbiAqICAgICBmcm9tTnVsbGFibGUoZW1wbG95ZWUxLmNvbXBhbnkpLFxuICogICAgIGNoYWluTnVsbGFibGVLKGNvbXBhbnkgPT4gY29tcGFueS5hZGRyZXNzKSxcbiAqICAgICBjaGFpbk51bGxhYmxlSyhhZGRyZXNzID0+IGFkZHJlc3Muc3RyZWV0KSxcbiAqICAgICBjaGFpbk51bGxhYmxlSyhzdHJlZXQgPT4gc3RyZWV0Lm5hbWUpXG4gKiAgICksXG4gKiAgIHNvbWUoJ2hpZ2ggc3RyZWV0JylcbiAqIClcbiAqXG4gKiBjb25zdCBlbXBsb3llZTI6IEVtcGxveWVlID0geyBjb21wYW55OiB7IGFkZHJlc3M6IHsgc3RyZWV0OiB7fSB9IH0gfVxuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoXG4gKiAgIHBpcGUoXG4gKiAgICAgZnJvbU51bGxhYmxlKGVtcGxveWVlMi5jb21wYW55KSxcbiAqICAgICBjaGFpbk51bGxhYmxlSyhjb21wYW55ID0+IGNvbXBhbnkuYWRkcmVzcyksXG4gKiAgICAgY2hhaW5OdWxsYWJsZUsoYWRkcmVzcyA9PiBhZGRyZXNzLnN0cmVldCksXG4gKiAgICAgY2hhaW5OdWxsYWJsZUsoc3RyZWV0ID0+IHN0cmVldC5uYW1lKVxuICogICApLFxuICogICBub25lXG4gKiApXG4gKlxuICogQGNhdGVnb3J5IHNlcXVlbmNpbmdcbiAqIEBzaW5jZSAyLjkuMFxuICovXG5leHBvcnQgdmFyIGNoYWluTnVsbGFibGVLID0gZnVuY3Rpb24gKGYpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKG1hKSB7XG4gICAgICAgIHJldHVybiBpc05vbmUobWEpID8gbm9uZSA6IGZyb21OdWxsYWJsZShmKG1hLnZhbHVlKSk7XG4gICAgfTtcbn07XG4vKipcbiAqIEV4dHJhY3RzIHRoZSB2YWx1ZSBvdXQgb2YgdGhlIHN0cnVjdHVyZSwgaWYgaXQgZXhpc3RzLiBPdGhlcndpc2UgcmV0dXJucyBgbnVsbGAuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IHNvbWUsIG5vbmUsIHRvTnVsbGFibGUgfSBmcm9tICdmcC10cy9PcHRpb24nXG4gKiBpbXBvcnQgeyBwaXBlIH0gZnJvbSAnZnAtdHMvZnVuY3Rpb24nXG4gKlxuICogYXNzZXJ0LnN0cmljdEVxdWFsKFxuICogICBwaXBlKFxuICogICAgIHNvbWUoMSksXG4gKiAgICAgdG9OdWxsYWJsZVxuICogICApLFxuICogICAxXG4gKiApXG4gKiBhc3NlcnQuc3RyaWN0RXF1YWwoXG4gKiAgIHBpcGUoXG4gKiAgICAgbm9uZSxcbiAqICAgICB0b051bGxhYmxlXG4gKiAgICksXG4gKiAgIG51bGxcbiAqIClcbiAqXG4gKiBAY2F0ZWdvcnkgY29udmVyc2lvbnNcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIHRvTnVsbGFibGUgPSAvKiNfX1BVUkVfXyovIG1hdGNoKGNvbnN0TnVsbCwgaWRlbnRpdHkpO1xuLyoqXG4gKiBFeHRyYWN0cyB0aGUgdmFsdWUgb3V0IG9mIHRoZSBzdHJ1Y3R1cmUsIGlmIGl0IGV4aXN0cy4gT3RoZXJ3aXNlIHJldHVybnMgYHVuZGVmaW5lZGAuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IHNvbWUsIG5vbmUsIHRvVW5kZWZpbmVkIH0gZnJvbSAnZnAtdHMvT3B0aW9uJ1xuICogaW1wb3J0IHsgcGlwZSB9IGZyb20gJ2ZwLXRzL2Z1bmN0aW9uJ1xuICpcbiAqIGFzc2VydC5zdHJpY3RFcXVhbChcbiAqICAgcGlwZShcbiAqICAgICBzb21lKDEpLFxuICogICAgIHRvVW5kZWZpbmVkXG4gKiAgICksXG4gKiAgIDFcbiAqIClcbiAqIGFzc2VydC5zdHJpY3RFcXVhbChcbiAqICAgcGlwZShcbiAqICAgICBub25lLFxuICogICAgIHRvVW5kZWZpbmVkXG4gKiAgICksXG4gKiAgIHVuZGVmaW5lZFxuICogKVxuICpcbiAqIEBjYXRlZ29yeSBjb252ZXJzaW9uc1xuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgdG9VbmRlZmluZWQgPSAvKiNfX1BVUkVfXyovIG1hdGNoKGNvbnN0VW5kZWZpbmVkLCBpZGVudGl0eSk7XG5leHBvcnQgZnVuY3Rpb24gZWxlbShFKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhLCBtYSkge1xuICAgICAgICBpZiAobWEgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgdmFyIGVsZW1FXzEgPSBlbGVtKEUpO1xuICAgICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIChtYSkgeyByZXR1cm4gZWxlbUVfMShhLCBtYSk7IH07XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGlzTm9uZShtYSkgPyBmYWxzZSA6IEUuZXF1YWxzKGEsIG1hLnZhbHVlKTtcbiAgICB9O1xufVxuLyoqXG4gKiBSZXR1cm5zIGB0cnVlYCBpZiB0aGUgcHJlZGljYXRlIGlzIHNhdGlzZmllZCBieSB0aGUgd3JhcHBlZCB2YWx1ZVxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBzb21lLCBub25lLCBleGlzdHMgfSBmcm9tICdmcC10cy9PcHRpb24nXG4gKiBpbXBvcnQgeyBwaXBlIH0gZnJvbSAnZnAtdHMvZnVuY3Rpb24nXG4gKlxuICogYXNzZXJ0LnN0cmljdEVxdWFsKFxuICogICBwaXBlKFxuICogICAgIHNvbWUoMSksXG4gKiAgICAgZXhpc3RzKG4gPT4gbiA+IDApXG4gKiAgICksXG4gKiAgIHRydWVcbiAqIClcbiAqIGFzc2VydC5zdHJpY3RFcXVhbChcbiAqICAgcGlwZShcbiAqICAgICBzb21lKDEpLFxuICogICAgIGV4aXN0cyhuID0+IG4gPiAxKVxuICogICApLFxuICogICBmYWxzZVxuICogKVxuICogYXNzZXJ0LnN0cmljdEVxdWFsKFxuICogICBwaXBlKFxuICogICAgIG5vbmUsXG4gKiAgICAgZXhpc3RzKG4gPT4gbiA+IDApXG4gKiAgICksXG4gKiAgIGZhbHNlXG4gKiApXG4gKlxuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgZXhpc3RzID0gZnVuY3Rpb24gKHByZWRpY2F0ZSkge1xuICAgIHJldHVybiBmdW5jdGlvbiAobWEpIHtcbiAgICAgICAgcmV0dXJuIGlzTm9uZShtYSkgPyBmYWxzZSA6IHByZWRpY2F0ZShtYS52YWx1ZSk7XG4gICAgfTtcbn07XG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vLyBkbyBub3RhdGlvblxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLyoqXG4gKiBAY2F0ZWdvcnkgZG8gbm90YXRpb25cbiAqIEBzaW5jZSAyLjkuMFxuICovXG5leHBvcnQgdmFyIERvID0gLyojX19QVVJFX18qLyBvZihfLmVtcHR5UmVjb3JkKTtcbi8qKlxuICogQGNhdGVnb3J5IGRvIG5vdGF0aW9uXG4gKiBAc2luY2UgMi44LjBcbiAqL1xuZXhwb3J0IHZhciBiaW5kVG8gPSAvKiNfX1BVUkVfXyovIGJpbmRUb18oRnVuY3Rvcik7XG52YXIgbGV0XyA9IC8qI19fUFVSRV9fKi8gbGV0X18oRnVuY3Rvcik7XG5leHBvcnQgeyBcbi8qKlxuICogQGNhdGVnb3J5IGRvIG5vdGF0aW9uXG4gKiBAc2luY2UgMi4xMy4wXG4gKi9cbmxldF8gYXMgbGV0IH07XG4vKipcbiAqIEBjYXRlZ29yeSBkbyBub3RhdGlvblxuICogQHNpbmNlIDIuOC4wXG4gKi9cbmV4cG9ydCB2YXIgYmluZCA9IC8qI19fUFVSRV9fKi8gY2hhaW5hYmxlLmJpbmQoQ2hhaW4pO1xuLyoqXG4gKiBAY2F0ZWdvcnkgZG8gbm90YXRpb25cbiAqIEBzaW5jZSAyLjguMFxuICovXG5leHBvcnQgdmFyIGFwUyA9IC8qI19fUFVSRV9fKi8gYXBTXyhBcHBseSk7XG4vKipcbiAqIEBzaW5jZSAyLjExLjBcbiAqL1xuZXhwb3J0IHZhciBBcFQgPSAvKiNfX1BVUkVfXyovIG9mKF8uZW1wdHlSZWFkb25seUFycmF5KTtcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8vIGFycmF5IHV0aWxzXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vKipcbiAqIEVxdWl2YWxlbnQgdG8gYFJlYWRvbmx5Tm9uRW1wdHlBcnJheSN0cmF2ZXJzZVdpdGhJbmRleChBcHBsaWNhdGl2ZSlgLlxuICpcbiAqIEBjYXRlZ29yeSB0cmF2ZXJzaW5nXG4gKiBAc2luY2UgMi4xMS4wXG4gKi9cbmV4cG9ydCB2YXIgdHJhdmVyc2VSZWFkb25seU5vbkVtcHR5QXJyYXlXaXRoSW5kZXggPSBmdW5jdGlvbiAoZikge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgdmFyIG8gPSBmKDAsIF8uaGVhZChhcykpO1xuICAgICAgICBpZiAoaXNOb25lKG8pKSB7XG4gICAgICAgICAgICByZXR1cm4gbm9uZTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgb3V0ID0gW28udmFsdWVdO1xuICAgICAgICBmb3IgKHZhciBpID0gMTsgaSA8IGFzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICB2YXIgb18xID0gZihpLCBhc1tpXSk7XG4gICAgICAgICAgICBpZiAoaXNOb25lKG9fMSkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gbm9uZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIG91dC5wdXNoKG9fMS52YWx1ZSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHNvbWUob3V0KTtcbiAgICB9O1xufTtcbi8qKlxuICogRXF1aXZhbGVudCB0byBgUmVhZG9ubHlBcnJheSN0cmF2ZXJzZVdpdGhJbmRleChBcHBsaWNhdGl2ZSlgLlxuICpcbiAqIEBjYXRlZ29yeSB0cmF2ZXJzaW5nXG4gKiBAc2luY2UgMi4xMS4wXG4gKi9cbmV4cG9ydCB2YXIgdHJhdmVyc2VSZWFkb25seUFycmF5V2l0aEluZGV4ID0gZnVuY3Rpb24gKGYpIHtcbiAgICB2YXIgZyA9IHRyYXZlcnNlUmVhZG9ubHlOb25FbXB0eUFycmF5V2l0aEluZGV4KGYpO1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHsgcmV0dXJuIChfLmlzTm9uRW1wdHkoYXMpID8gZyhhcykgOiBBcFQpOyB9O1xufTtcbi8qKlxuICogRXF1aXZhbGVudCB0byBgUmVhZG9ubHlBcnJheSN0cmF2ZXJzZVdpdGhJbmRleChBcHBsaWNhdGl2ZSlgLlxuICpcbiAqIEBjYXRlZ29yeSB0cmF2ZXJzaW5nXG4gKiBAc2luY2UgMi45LjBcbiAqL1xuZXhwb3J0IHZhciB0cmF2ZXJzZUFycmF5V2l0aEluZGV4ID0gdHJhdmVyc2VSZWFkb25seUFycmF5V2l0aEluZGV4O1xuLyoqXG4gKiBFcXVpdmFsZW50IHRvIGBSZWFkb25seUFycmF5I3RyYXZlcnNlKEFwcGxpY2F0aXZlKWAuXG4gKlxuICogQGNhdGVnb3J5IHRyYXZlcnNpbmdcbiAqIEBzaW5jZSAyLjkuMFxuICovXG5leHBvcnQgdmFyIHRyYXZlcnNlQXJyYXkgPSBmdW5jdGlvbiAoZikge1xuICAgIHJldHVybiB0cmF2ZXJzZVJlYWRvbmx5QXJyYXlXaXRoSW5kZXgoZnVuY3Rpb24gKF8sIGEpIHsgcmV0dXJuIGYoYSk7IH0pO1xufTtcbi8qKlxuICogRXF1aXZhbGVudCB0byBgUmVhZG9ubHlBcnJheSNzZXF1ZW5jZShBcHBsaWNhdGl2ZSlgLlxuICpcbiAqIEBjYXRlZ29yeSB0cmF2ZXJzaW5nXG4gKiBAc2luY2UgMi45LjBcbiAqL1xuZXhwb3J0IHZhciBzZXF1ZW5jZUFycmF5ID0gXG4vKiNfX1BVUkVfXyovIHRyYXZlcnNlQXJyYXkoaWRlbnRpdHkpO1xuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLy8gbGVnYWN5XG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vKipcbiAqIEFsaWFzIG9mIGBmbGF0TWFwYC5cbiAqXG4gKiBAY2F0ZWdvcnkgbGVnYWN5XG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciBjaGFpbiA9IGZsYXRNYXA7XG4vKipcbiAqIEFsaWFzIG9mIGB0YXBgLlxuICpcbiAqIEBjYXRlZ29yeSBsZWdhY3lcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIGNoYWluRmlyc3QgPSB0YXA7XG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vLyBkZXByZWNhdGVkXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vKipcbiAqIFVzZSBgUmVmaW5lbWVudGAgbW9kdWxlIGluc3RlYWQuXG4gKlxuICogQGNhdGVnb3J5IHpvbmUgb2YgZGVhdGhcbiAqIEBzaW5jZSAyLjAuMFxuICogQGRlcHJlY2F0ZWRcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGdldFJlZmluZW1lbnQoZ2V0T3B0aW9uKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhKSB7IHJldHVybiBpc1NvbWUoZ2V0T3B0aW9uKGEpKTsgfTtcbn1cbi8qKlxuICogVXNlIFtgY2hhaW5OdWxsYWJsZUtgXSgjY2hhaW5udWxsYWJsZWspIGluc3RlYWQuXG4gKlxuICogQGNhdGVnb3J5IHpvbmUgb2YgZGVhdGhcbiAqIEBzaW5jZSAyLjAuMFxuICogQGRlcHJlY2F0ZWRcbiAqL1xuZXhwb3J0IHZhciBtYXBOdWxsYWJsZSA9IGNoYWluTnVsbGFibGVLO1xuLyoqXG4gKiBUaGlzIGluc3RhbmNlIGlzIGRlcHJlY2F0ZWQsIHVzZSBzbWFsbCwgc3BlY2lmaWMgaW5zdGFuY2VzIGluc3RlYWQuXG4gKiBGb3IgZXhhbXBsZSBpZiBhIGZ1bmN0aW9uIG5lZWRzIGEgYEZ1bmN0b3JgIGluc3RhbmNlLCBwYXNzIGBPLkZ1bmN0b3JgIGluc3RlYWQgb2YgYE8ub3B0aW9uYFxuICogKHdoZXJlIGBPYCBpcyBmcm9tIGBpbXBvcnQgTyBmcm9tICdmcC10cy9PcHRpb24nYClcbiAqXG4gKiBAY2F0ZWdvcnkgem9uZSBvZiBkZWF0aFxuICogQHNpbmNlIDIuMC4wXG4gKiBAZGVwcmVjYXRlZFxuICovXG5leHBvcnQgdmFyIG9wdGlvbiA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICBtYXA6IF9tYXAsXG4gICAgb2Y6IG9mLFxuICAgIGFwOiBfYXAsXG4gICAgY2hhaW46IGZsYXRNYXAsXG4gICAgcmVkdWNlOiBfcmVkdWNlLFxuICAgIGZvbGRNYXA6IF9mb2xkTWFwLFxuICAgIHJlZHVjZVJpZ2h0OiBfcmVkdWNlUmlnaHQsXG4gICAgdHJhdmVyc2U6IF90cmF2ZXJzZSxcbiAgICBzZXF1ZW5jZTogc2VxdWVuY2UsXG4gICAgemVybzogemVybyxcbiAgICBhbHQ6IF9hbHQsXG4gICAgZXh0ZW5kOiBfZXh0ZW5kLFxuICAgIGNvbXBhY3Q6IGNvbXBhY3QsXG4gICAgc2VwYXJhdGU6IHNlcGFyYXRlLFxuICAgIGZpbHRlcjogX2ZpbHRlcixcbiAgICBmaWx0ZXJNYXA6IF9maWx0ZXJNYXAsXG4gICAgcGFydGl0aW9uOiBfcGFydGl0aW9uLFxuICAgIHBhcnRpdGlvbk1hcDogX3BhcnRpdGlvbk1hcCxcbiAgICB3aXRoZXI6IF93aXRoZXIsXG4gICAgd2lsdDogX3dpbHQsXG4gICAgdGhyb3dFcnJvcjogdGhyb3dFcnJvclxufTtcbi8qKlxuICogVXNlIFtgZ2V0QXBwbHlTZW1pZ3JvdXBgXSguL0FwcGx5LnRzLmh0bWwjZ2V0YXBwbHlzZW1pZ3JvdXApIGluc3RlYWQuXG4gKlxuICogQGNhdGVnb3J5IHpvbmUgb2YgZGVhdGhcbiAqIEBzaW5jZSAyLjAuMFxuICogQGRlcHJlY2F0ZWRcbiAqL1xuZXhwb3J0IHZhciBnZXRBcHBseVNlbWlncm91cCA9IC8qI19fUFVSRV9fKi8gZ2V0QXBwbHlTZW1pZ3JvdXBfKEFwcGx5KTtcbi8qKlxuICogVXNlIFtgZ2V0QXBwbGljYXRpdmVNb25vaWRgXSguL0FwcGxpY2F0aXZlLnRzLmh0bWwjZ2V0YXBwbGljYXRpdmVtb25vaWQpIGluc3RlYWQuXG4gKlxuICogQGNhdGVnb3J5IHpvbmUgb2YgZGVhdGhcbiAqIEBzaW5jZSAyLjAuMFxuICogQGRlcHJlY2F0ZWRcbiAqL1xuZXhwb3J0IHZhciBnZXRBcHBseU1vbm9pZCA9IC8qI19fUFVSRV9fKi8gZ2V0QXBwbGljYXRpdmVNb25vaWQoQXBwbGljYXRpdmUpO1xuLyoqXG4gKiBVc2VcbiAqXG4gKiBgYGB0c1xuICogaW1wb3J0IHsgZmlyc3QgfSBmcm9tICdmcC10cy9TZW1pZ3JvdXAnXG4gKiBpbXBvcnQgeyBnZXRNb25vaWQgfSBmcm9tICdmcC10cy9PcHRpb24nXG4gKlxuICogZ2V0TW9ub2lkKGZpcnN0KCkpXG4gKiBgYGBcbiAqXG4gKiBpbnN0ZWFkLlxuICpcbiAqIE1vbm9pZCByZXR1cm5pbmcgdGhlIGxlZnQtbW9zdCBub24tYE5vbmVgIHZhbHVlXG4gKlxuICogfCB4ICAgICAgIHwgeSAgICAgICB8IGNvbmNhdCh4LCB5KSB8XG4gKiB8IC0tLS0tLS0gfCAtLS0tLS0tIHwgLS0tLS0tLS0tLS0tIHxcbiAqIHwgbm9uZSAgICB8IG5vbmUgICAgfCBub25lICAgICAgICAgfFxuICogfCBzb21lKGEpIHwgbm9uZSAgICB8IHNvbWUoYSkgICAgICB8XG4gKiB8IG5vbmUgICAgfCBzb21lKGIpIHwgc29tZShiKSAgICAgIHxcbiAqIHwgc29tZShhKSB8IHNvbWUoYikgfCBzb21lKGEpICAgICAgfFxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBnZXRGaXJzdE1vbm9pZCwgc29tZSwgbm9uZSB9IGZyb20gJ2ZwLXRzL09wdGlvbidcbiAqXG4gKiBjb25zdCBNID0gZ2V0Rmlyc3RNb25vaWQ8bnVtYmVyPigpXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKE0uY29uY2F0KG5vbmUsIG5vbmUpLCBub25lKVxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChNLmNvbmNhdChzb21lKDEpLCBub25lKSwgc29tZSgxKSlcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoTS5jb25jYXQobm9uZSwgc29tZSgyKSksIHNvbWUoMikpXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKE0uY29uY2F0KHNvbWUoMSksIHNvbWUoMikpLCBzb21lKDEpKVxuICpcbiAqIEBjYXRlZ29yeSB6b25lIG9mIGRlYXRoXG4gKiBAc2luY2UgMi4wLjBcbiAqIEBkZXByZWNhdGVkXG4gKi9cbmV4cG9ydCB2YXIgZ2V0Rmlyc3RNb25vaWQgPSBmdW5jdGlvbiAoKSB7IHJldHVybiBnZXRNb25vaWQoZmlyc3QoKSk7IH07XG4vKipcbiAqIFVzZVxuICpcbiAqIGBgYHRzXG4gKiBpbXBvcnQgeyBsYXN0IH0gZnJvbSAnZnAtdHMvU2VtaWdyb3VwJ1xuICogaW1wb3J0IHsgZ2V0TW9ub2lkIH0gZnJvbSAnZnAtdHMvT3B0aW9uJ1xuICpcbiAqIGdldE1vbm9pZChsYXN0KCkpXG4gKiBgYGBcbiAqXG4gKiBpbnN0ZWFkLlxuICpcbiAqIE1vbm9pZCByZXR1cm5pbmcgdGhlIHJpZ2h0LW1vc3Qgbm9uLWBOb25lYCB2YWx1ZVxuICpcbiAqIHwgeCAgICAgICB8IHkgICAgICAgfCBjb25jYXQoeCwgeSkgfFxuICogfCAtLS0tLS0tIHwgLS0tLS0tLSB8IC0tLS0tLS0tLS0tLSB8XG4gKiB8IG5vbmUgICAgfCBub25lICAgIHwgbm9uZSAgICAgICAgIHxcbiAqIHwgc29tZShhKSB8IG5vbmUgICAgfCBzb21lKGEpICAgICAgfFxuICogfCBub25lICAgIHwgc29tZShiKSB8IHNvbWUoYikgICAgICB8XG4gKiB8IHNvbWUoYSkgfCBzb21lKGIpIHwgc29tZShiKSAgICAgIHxcbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgZ2V0TGFzdE1vbm9pZCwgc29tZSwgbm9uZSB9IGZyb20gJ2ZwLXRzL09wdGlvbidcbiAqXG4gKiBjb25zdCBNID0gZ2V0TGFzdE1vbm9pZDxudW1iZXI+KClcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoTS5jb25jYXQobm9uZSwgbm9uZSksIG5vbmUpXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKE0uY29uY2F0KHNvbWUoMSksIG5vbmUpLCBzb21lKDEpKVxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChNLmNvbmNhdChub25lLCBzb21lKDIpKSwgc29tZSgyKSlcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoTS5jb25jYXQoc29tZSgxKSwgc29tZSgyKSksIHNvbWUoMikpXG4gKlxuICogQGNhdGVnb3J5IHpvbmUgb2YgZGVhdGhcbiAqIEBzaW5jZSAyLjAuMFxuICogQGRlcHJlY2F0ZWRcbiAqL1xuZXhwb3J0IHZhciBnZXRMYXN0TW9ub2lkID0gZnVuY3Rpb24gKCkgeyByZXR1cm4gZ2V0TW9ub2lkKGxhc3QoKSk7IH07XG4iLAogICJpbXBvcnQgeyBnZXRBcHBsaWNhdGl2ZU1vbm9pZCB9IGZyb20gJy4vQXBwbGljYXRpdmUnO1xuaW1wb3J0IHsgYXBGaXJzdCBhcyBhcEZpcnN0XywgYXBTIGFzIGFwU18sIGFwU2Vjb25kIGFzIGFwU2Vjb25kXywgZ2V0QXBwbHlTZW1pZ3JvdXAgYXMgZ2V0QXBwbHlTZW1pZ3JvdXBfIH0gZnJvbSAnLi9BcHBseSc7XG5pbXBvcnQgKiBhcyBjaGFpbmFibGUgZnJvbSAnLi9DaGFpbic7XG5pbXBvcnQgeyBjaGFpbkVpdGhlcksgYXMgY2hhaW5FaXRoZXJLXywgZnJvbUVpdGhlcksgYXMgZnJvbUVpdGhlcktfLCB0YXBFaXRoZXIgYXMgdGFwRWl0aGVyXyB9IGZyb20gJy4vRnJvbUVpdGhlcic7XG5pbXBvcnQgeyBjb25zdE51bGwsIGNvbnN0VW5kZWZpbmVkLCBkdWFsLCBmbG93LCBpZGVudGl0eSwgcGlwZSB9IGZyb20gJy4vZnVuY3Rpb24nO1xuaW1wb3J0IHsgYXMgYXMgYXNfLCBhc1VuaXQgYXMgYXNVbml0XywgYmluZFRvIGFzIGJpbmRUb18sIGZsYXAgYXMgZmxhcF8sIGxldCBhcyBsZXRfXyB9IGZyb20gJy4vRnVuY3Rvcic7XG5pbXBvcnQgKiBhcyBfIGZyb20gJy4vaW50ZXJuYWwnO1xuaW1wb3J0IHsgbm90IH0gZnJvbSAnLi9QcmVkaWNhdGUnO1xuaW1wb3J0IHsgZmlyc3QsIGxhc3QgfSBmcm9tICcuL1NlbWlncm91cCc7XG5pbXBvcnQgeyBzZXBhcmF0ZWQgfSBmcm9tICcuL1NlcGFyYXRlZCc7XG5pbXBvcnQgeyB3aWx0RGVmYXVsdCwgd2l0aGVyRGVmYXVsdCB9IGZyb20gJy4vV2l0aGVyYWJsZSc7XG5pbXBvcnQgeyBndWFyZCBhcyBndWFyZF8gfSBmcm9tICcuL1plcm8nO1xuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLy8gY29uc3RydWN0b3JzXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vKipcbiAqIGBOb25lYCBkb2Vzbid0IGhhdmUgYSBjb25zdHJ1Y3RvciwgaW5zdGVhZCB5b3UgY2FuIHVzZSBpdCBkaXJlY3RseSBhcyBhIHZhbHVlLiBSZXByZXNlbnRzIGEgbWlzc2luZyB2YWx1ZS5cbiAqXG4gKiBAY2F0ZWdvcnkgY29uc3RydWN0b3JzXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciBub25lID0gXy5ub25lO1xuLyoqXG4gKiBDb25zdHJ1Y3RzIGEgYFNvbWVgLiBSZXByZXNlbnRzIGFuIG9wdGlvbmFsIHZhbHVlIHRoYXQgZXhpc3RzLlxuICpcbiAqIEBjYXRlZ29yeSBjb25zdHJ1Y3RvcnNcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIHNvbWUgPSBfLnNvbWU7XG5leHBvcnQgZnVuY3Rpb24gZnJvbVByZWRpY2F0ZShwcmVkaWNhdGUpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGEpIHsgcmV0dXJuIChwcmVkaWNhdGUoYSkgPyBzb21lKGEpIDogbm9uZSk7IH07XG59XG4vKipcbiAqIFJldHVybnMgdGhlIGBMZWZ0YCB2YWx1ZSBvZiBhbiBgRWl0aGVyYCBpZiBwb3NzaWJsZS5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgZ2V0TGVmdCwgbm9uZSwgc29tZSB9IGZyb20gJ2ZwLXRzL09wdGlvbidcbiAqIGltcG9ydCB7IHJpZ2h0LCBsZWZ0IH0gZnJvbSAnZnAtdHMvRWl0aGVyJ1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoZ2V0TGVmdChyaWdodCgxKSksIG5vbmUpXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKGdldExlZnQobGVmdCgnYScpKSwgc29tZSgnYScpKVxuICpcbiAqIEBjYXRlZ29yeSBjb25zdHJ1Y3RvcnNcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIGdldExlZnQgPSBmdW5jdGlvbiAobWEpIHsgcmV0dXJuIChtYS5fdGFnID09PSAnUmlnaHQnID8gbm9uZSA6IHNvbWUobWEubGVmdCkpOyB9O1xuLyoqXG4gKiBSZXR1cm5zIHRoZSBgUmlnaHRgIHZhbHVlIG9mIGFuIGBFaXRoZXJgIGlmIHBvc3NpYmxlLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBnZXRSaWdodCwgbm9uZSwgc29tZSB9IGZyb20gJ2ZwLXRzL09wdGlvbidcbiAqIGltcG9ydCB7IHJpZ2h0LCBsZWZ0IH0gZnJvbSAnZnAtdHMvRWl0aGVyJ1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoZ2V0UmlnaHQocmlnaHQoMSkpLCBzb21lKDEpKVxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChnZXRSaWdodChsZWZ0KCdhJykpLCBub25lKVxuICpcbiAqIEBjYXRlZ29yeSBjb25zdHJ1Y3RvcnNcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIGdldFJpZ2h0ID0gZnVuY3Rpb24gKG1hKSB7IHJldHVybiAobWEuX3RhZyA9PT0gJ0xlZnQnID8gbm9uZSA6IHNvbWUobWEucmlnaHQpKTsgfTtcbnZhciBfbWFwID0gZnVuY3Rpb24gKGZhLCBmKSB7IHJldHVybiBwaXBlKGZhLCBtYXAoZikpOyB9O1xudmFyIF9hcCA9IGZ1bmN0aW9uIChmYWIsIGZhKSB7IHJldHVybiBwaXBlKGZhYiwgYXAoZmEpKTsgfTtcbnZhciBfcmVkdWNlID0gZnVuY3Rpb24gKGZhLCBiLCBmKSB7IHJldHVybiBwaXBlKGZhLCByZWR1Y2UoYiwgZikpOyB9O1xudmFyIF9mb2xkTWFwID0gZnVuY3Rpb24gKE0pIHtcbiAgICB2YXIgZm9sZE1hcE0gPSBmb2xkTWFwKE0pO1xuICAgIHJldHVybiBmdW5jdGlvbiAoZmEsIGYpIHsgcmV0dXJuIHBpcGUoZmEsIGZvbGRNYXBNKGYpKTsgfTtcbn07XG52YXIgX3JlZHVjZVJpZ2h0ID0gZnVuY3Rpb24gKGZhLCBiLCBmKSB7IHJldHVybiBwaXBlKGZhLCByZWR1Y2VSaWdodChiLCBmKSk7IH07XG52YXIgX3RyYXZlcnNlID0gZnVuY3Rpb24gKEYpIHtcbiAgICB2YXIgdHJhdmVyc2VGID0gdHJhdmVyc2UoRik7XG4gICAgcmV0dXJuIGZ1bmN0aW9uICh0YSwgZikgeyByZXR1cm4gcGlwZSh0YSwgdHJhdmVyc2VGKGYpKTsgfTtcbn07XG4vKiBpc3RhbmJ1bCBpZ25vcmUgbmV4dCAqL1xudmFyIF9hbHQgPSBmdW5jdGlvbiAoZmEsIHRoYXQpIHsgcmV0dXJuIHBpcGUoZmEsIGFsdCh0aGF0KSk7IH07XG52YXIgX2ZpbHRlciA9IGZ1bmN0aW9uIChmYSwgcHJlZGljYXRlKSB7IHJldHVybiBwaXBlKGZhLCBmaWx0ZXIocHJlZGljYXRlKSk7IH07XG4vKiBpc3RhbmJ1bCBpZ25vcmUgbmV4dCAqL1xudmFyIF9maWx0ZXJNYXAgPSBmdW5jdGlvbiAoZmEsIGYpIHsgcmV0dXJuIHBpcGUoZmEsIGZpbHRlck1hcChmKSk7IH07XG4vKiBpc3RhbmJ1bCBpZ25vcmUgbmV4dCAqL1xudmFyIF9leHRlbmQgPSBmdW5jdGlvbiAod2EsIGYpIHsgcmV0dXJuIHBpcGUod2EsIGV4dGVuZChmKSk7IH07XG4vKiBpc3RhbmJ1bCBpZ25vcmUgbmV4dCAqL1xudmFyIF9wYXJ0aXRpb24gPSBmdW5jdGlvbiAoZmEsIHByZWRpY2F0ZSkge1xuICAgIHJldHVybiBwaXBlKGZhLCBwYXJ0aXRpb24ocHJlZGljYXRlKSk7XG59O1xuLyogaXN0YW5idWwgaWdub3JlIG5leHQgKi9cbnZhciBfcGFydGl0aW9uTWFwID0gZnVuY3Rpb24gKGZhLCBmKSB7IHJldHVybiBwaXBlKGZhLCBwYXJ0aXRpb25NYXAoZikpOyB9O1xuLyoqXG4gKiBAY2F0ZWdvcnkgdHlwZSBsYW1iZGFzXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciBVUkkgPSAnT3B0aW9uJztcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgZ2V0U2hvdyA9IGZ1bmN0aW9uIChTKSB7IHJldHVybiAoe1xuICAgIHNob3c6IGZ1bmN0aW9uIChtYSkgeyByZXR1cm4gKGlzTm9uZShtYSkgPyAnbm9uZScgOiBcInNvbWUoXCIuY29uY2F0KFMuc2hvdyhtYS52YWx1ZSksIFwiKVwiKSk7IH1cbn0pOyB9O1xuLyoqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgbm9uZSwgc29tZSwgZ2V0RXEgfSBmcm9tICdmcC10cy9PcHRpb24nXG4gKiBpbXBvcnQgKiBhcyBOIGZyb20gJ2ZwLXRzL251bWJlcidcbiAqXG4gKiBjb25zdCBFID0gZ2V0RXEoTi5FcSlcbiAqIGFzc2VydC5zdHJpY3RFcXVhbChFLmVxdWFscyhub25lLCBub25lKSwgdHJ1ZSlcbiAqIGFzc2VydC5zdHJpY3RFcXVhbChFLmVxdWFscyhub25lLCBzb21lKDEpKSwgZmFsc2UpXG4gKiBhc3NlcnQuc3RyaWN0RXF1YWwoRS5lcXVhbHMoc29tZSgxKSwgbm9uZSksIGZhbHNlKVxuICogYXNzZXJ0LnN0cmljdEVxdWFsKEUuZXF1YWxzKHNvbWUoMSksIHNvbWUoMikpLCBmYWxzZSlcbiAqIGFzc2VydC5zdHJpY3RFcXVhbChFLmVxdWFscyhzb21lKDEpLCBzb21lKDEpKSwgdHJ1ZSlcbiAqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciBnZXRFcSA9IGZ1bmN0aW9uIChFKSB7IHJldHVybiAoe1xuICAgIGVxdWFsczogZnVuY3Rpb24gKHgsIHkpIHsgcmV0dXJuIHggPT09IHkgfHwgKGlzTm9uZSh4KSA/IGlzTm9uZSh5KSA6IGlzTm9uZSh5KSA/IGZhbHNlIDogRS5lcXVhbHMoeC52YWx1ZSwgeS52YWx1ZSkpOyB9XG59KTsgfTtcbi8qKlxuICogVGhlIGBPcmRgIGluc3RhbmNlIGFsbG93cyBgT3B0aW9uYCB2YWx1ZXMgdG8gYmUgY29tcGFyZWQgd2l0aFxuICogYGNvbXBhcmVgLCB3aGVuZXZlciB0aGVyZSBpcyBhbiBgT3JkYCBpbnN0YW5jZSBmb3JcbiAqIHRoZSB0eXBlIHRoZSBgT3B0aW9uYCBjb250YWlucy5cbiAqXG4gKiBgTm9uZWAgaXMgY29uc2lkZXJlZCB0byBiZSBsZXNzIHRoYW4gYW55IGBTb21lYCB2YWx1ZS5cbiAqXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IG5vbmUsIHNvbWUsIGdldE9yZCB9IGZyb20gJ2ZwLXRzL09wdGlvbidcbiAqIGltcG9ydCAqIGFzIE4gZnJvbSAnZnAtdHMvbnVtYmVyJ1xuICpcbiAqIGNvbnN0IE8gPSBnZXRPcmQoTi5PcmQpXG4gKiBhc3NlcnQuc3RyaWN0RXF1YWwoTy5jb21wYXJlKG5vbmUsIG5vbmUpLCAwKVxuICogYXNzZXJ0LnN0cmljdEVxdWFsKE8uY29tcGFyZShub25lLCBzb21lKDEpKSwgLTEpXG4gKiBhc3NlcnQuc3RyaWN0RXF1YWwoTy5jb21wYXJlKHNvbWUoMSksIG5vbmUpLCAxKVxuICogYXNzZXJ0LnN0cmljdEVxdWFsKE8uY29tcGFyZShzb21lKDEpLCBzb21lKDIpKSwgLTEpXG4gKiBhc3NlcnQuc3RyaWN0RXF1YWwoTy5jb21wYXJlKHNvbWUoMSksIHNvbWUoMSkpLCAwKVxuICpcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIGdldE9yZCA9IGZ1bmN0aW9uIChPKSB7IHJldHVybiAoe1xuICAgIGVxdWFsczogZ2V0RXEoTykuZXF1YWxzLFxuICAgIGNvbXBhcmU6IGZ1bmN0aW9uICh4LCB5KSB7IHJldHVybiAoeCA9PT0geSA/IDAgOiBpc1NvbWUoeCkgPyAoaXNTb21lKHkpID8gTy5jb21wYXJlKHgudmFsdWUsIHkudmFsdWUpIDogMSkgOiAtMSk7IH1cbn0pOyB9O1xuLyoqXG4gKiBNb25vaWQgcmV0dXJuaW5nIHRoZSBsZWZ0LW1vc3Qgbm9uLWBOb25lYCB2YWx1ZS4gSWYgYm90aCBvcGVyYW5kcyBhcmUgYFNvbWVgcyB0aGVuIHRoZSBpbm5lciB2YWx1ZXMgYXJlXG4gKiBjb25jYXRlbmF0ZWQgdXNpbmcgdGhlIHByb3ZpZGVkIGBTZW1pZ3JvdXBgXG4gKlxuICogfCB4ICAgICAgIHwgeSAgICAgICB8IGNvbmNhdCh4LCB5KSAgICAgICB8XG4gKiB8IC0tLS0tLS0gfCAtLS0tLS0tIHwgLS0tLS0tLS0tLS0tLS0tLS0tIHxcbiAqIHwgbm9uZSAgICB8IG5vbmUgICAgfCBub25lICAgICAgICAgICAgICAgfFxuICogfCBzb21lKGEpIHwgbm9uZSAgICB8IHNvbWUoYSkgICAgICAgICAgICB8XG4gKiB8IG5vbmUgICAgfCBzb21lKGIpIHwgc29tZShiKSAgICAgICAgICAgIHxcbiAqIHwgc29tZShhKSB8IHNvbWUoYikgfCBzb21lKGNvbmNhdChhLCBiKSkgfFxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBnZXRNb25vaWQsIHNvbWUsIG5vbmUgfSBmcm9tICdmcC10cy9PcHRpb24nXG4gKiBpbXBvcnQgeyBTZW1pZ3JvdXBTdW0gfSBmcm9tICdmcC10cy9udW1iZXInXG4gKlxuICogY29uc3QgTSA9IGdldE1vbm9pZChTZW1pZ3JvdXBTdW0pXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKE0uY29uY2F0KG5vbmUsIG5vbmUpLCBub25lKVxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChNLmNvbmNhdChzb21lKDEpLCBub25lKSwgc29tZSgxKSlcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoTS5jb25jYXQobm9uZSwgc29tZSgxKSksIHNvbWUoMSkpXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKE0uY29uY2F0KHNvbWUoMSksIHNvbWUoMikpLCBzb21lKDMpKVxuICpcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIGdldE1vbm9pZCA9IGZ1bmN0aW9uIChTKSB7IHJldHVybiAoe1xuICAgIGNvbmNhdDogZnVuY3Rpb24gKHgsIHkpIHsgcmV0dXJuIChpc05vbmUoeCkgPyB5IDogaXNOb25lKHkpID8geCA6IHNvbWUoUy5jb25jYXQoeC52YWx1ZSwgeS52YWx1ZSkpKTsgfSxcbiAgICBlbXB0eTogbm9uZVxufSk7IH07XG4vKipcbiAqIEBjYXRlZ29yeSBtYXBwaW5nXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciBtYXAgPSBmdW5jdGlvbiAoZikgeyByZXR1cm4gZnVuY3Rpb24gKGZhKSB7XG4gICAgcmV0dXJuIGlzTm9uZShmYSkgPyBub25lIDogc29tZShmKGZhLnZhbHVlKSk7XG59OyB9O1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi43LjBcbiAqL1xuZXhwb3J0IHZhciBGdW5jdG9yID0ge1xuICAgIFVSSTogVVJJLFxuICAgIG1hcDogX21hcFxufTtcbi8qKlxuICogTWFwcyB0aGUgYFNvbWVgIHZhbHVlIG9mIHRoaXMgYE9wdGlvbmAgdG8gdGhlIHNwZWNpZmllZCBjb25zdGFudCB2YWx1ZS5cbiAqXG4gKiBAY2F0ZWdvcnkgbWFwcGluZ1xuICogQHNpbmNlIDIuMTYuMFxuICovXG5leHBvcnQgdmFyIGFzID0gZHVhbCgyLCBhc18oRnVuY3RvcikpO1xuLyoqXG4gKiBNYXBzIHRoZSBgU29tZWAgdmFsdWUgb2YgdGhpcyBgT3B0aW9uYCB0byB0aGUgdm9pZCBjb25zdGFudCB2YWx1ZS5cbiAqXG4gKiBAY2F0ZWdvcnkgbWFwcGluZ1xuICogQHNpbmNlIDIuMTYuMFxuICovXG5leHBvcnQgdmFyIGFzVW5pdCA9IGFzVW5pdF8oRnVuY3Rvcik7XG4vKipcbiAqIEBjYXRlZ29yeSBjb25zdHJ1Y3RvcnNcbiAqIEBzaW5jZSAyLjcuMFxuICovXG5leHBvcnQgdmFyIG9mID0gc29tZTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuMTAuMFxuICovXG5leHBvcnQgdmFyIFBvaW50ZWQgPSB7XG4gICAgVVJJOiBVUkksXG4gICAgb2Y6IG9mXG59O1xuLyoqXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciBhcCA9IGZ1bmN0aW9uIChmYSkgeyByZXR1cm4gZnVuY3Rpb24gKGZhYikge1xuICAgIHJldHVybiBpc05vbmUoZmFiKSA/IG5vbmUgOiBpc05vbmUoZmEpID8gbm9uZSA6IHNvbWUoZmFiLnZhbHVlKGZhLnZhbHVlKSk7XG59OyB9O1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi4xMC4wXG4gKi9cbmV4cG9ydCB2YXIgQXBwbHkgPSB7XG4gICAgVVJJOiBVUkksXG4gICAgbWFwOiBfbWFwLFxuICAgIGFwOiBfYXBcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjcuMFxuICovXG5leHBvcnQgdmFyIEFwcGxpY2F0aXZlID0ge1xuICAgIFVSSTogVVJJLFxuICAgIG1hcDogX21hcCxcbiAgICBhcDogX2FwLFxuICAgIG9mOiBvZlxufTtcbi8qKlxuICogQGNhdGVnb3J5IHNlcXVlbmNpbmdcbiAqIEBzaW5jZSAyLjE0LjBcbiAqL1xuZXhwb3J0IHZhciBmbGF0TWFwID0gLyojX19QVVJFX18qLyBkdWFsKDIsIGZ1bmN0aW9uIChtYSwgZikgeyByZXR1cm4gKGlzTm9uZShtYSkgPyBub25lIDogZihtYS52YWx1ZSkpOyB9KTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuMTAuMFxuICovXG5leHBvcnQgdmFyIENoYWluID0ge1xuICAgIFVSSTogVVJJLFxuICAgIG1hcDogX21hcCxcbiAgICBhcDogX2FwLFxuICAgIGNoYWluOiBmbGF0TWFwXG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi43LjBcbiAqL1xuZXhwb3J0IHZhciBNb25hZCA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICBtYXA6IF9tYXAsXG4gICAgYXA6IF9hcCxcbiAgICBvZjogb2YsXG4gICAgY2hhaW46IGZsYXRNYXBcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBmb2xkaW5nXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciByZWR1Y2UgPSBmdW5jdGlvbiAoYiwgZikgeyByZXR1cm4gZnVuY3Rpb24gKGZhKSB7XG4gICAgcmV0dXJuIGlzTm9uZShmYSkgPyBiIDogZihiLCBmYS52YWx1ZSk7XG59OyB9O1xuLyoqXG4gKiBAY2F0ZWdvcnkgZm9sZGluZ1xuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgZm9sZE1hcCA9IGZ1bmN0aW9uIChNKSB7IHJldHVybiBmdW5jdGlvbiAoZikgeyByZXR1cm4gZnVuY3Rpb24gKGZhKSB7XG4gICAgcmV0dXJuIGlzTm9uZShmYSkgPyBNLmVtcHR5IDogZihmYS52YWx1ZSk7XG59OyB9OyB9O1xuLyoqXG4gKiBAY2F0ZWdvcnkgZm9sZGluZ1xuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgcmVkdWNlUmlnaHQgPSBmdW5jdGlvbiAoYiwgZikgeyByZXR1cm4gZnVuY3Rpb24gKGZhKSB7XG4gICAgcmV0dXJuIGlzTm9uZShmYSkgPyBiIDogZihmYS52YWx1ZSwgYik7XG59OyB9O1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi43LjBcbiAqL1xuZXhwb3J0IHZhciBGb2xkYWJsZSA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICByZWR1Y2U6IF9yZWR1Y2UsXG4gICAgZm9sZE1hcDogX2ZvbGRNYXAsXG4gICAgcmVkdWNlUmlnaHQ6IF9yZWR1Y2VSaWdodFxufTtcbi8qKlxuICogUmV0dXJucyB0aGUgcHJvdmlkZWQgYE9wdGlvbmAgYHRoYXRgIGlmIGBzZWxmYCBpcyBgTm9uZWAsIG90aGVyd2lzZSByZXR1cm5zIGBzZWxmYC5cbiAqXG4gKiBAcGFyYW0gc2VsZiAtIFRoZSBmaXJzdCBgT3B0aW9uYCB0byBiZSBjaGVja2VkLlxuICogQHBhcmFtIHRoYXQgLSBUaGUgYE9wdGlvbmAgdG8gcmV0dXJuIGlmIGBzZWxmYCBpcyBgTm9uZWAuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCAqIGFzIE8gZnJvbSBcImZwLXRzL09wdGlvblwiXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChPLm9yRWxzZShPLm5vbmUsICgpID0+IE8ubm9uZSksIE8ubm9uZSlcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoTy5vckVsc2UoTy5zb21lKDEpLCAoKSA9PiBPLm5vbmUpLCBPLnNvbWUoMSkpXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKE8ub3JFbHNlKE8ubm9uZSwgKCkgPT4gTy5zb21lKCdiJykpLCBPLnNvbWUoJ2InKSlcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoTy5vckVsc2UoTy5zb21lKDEpLCAoKSA9PiBPLnNvbWUoJ2InKSksIE8uc29tZSgxKSlcbiAqXG4gKiBAY2F0ZWdvcnkgZXJyb3IgaGFuZGxpbmdcbiAqIEBzaW5jZSAyLjE2LjBcbiAqL1xuZXhwb3J0IHZhciBvckVsc2UgPSBkdWFsKDIsIGZ1bmN0aW9uIChzZWxmLCB0aGF0KSB7IHJldHVybiAoaXNOb25lKHNlbGYpID8gdGhhdCgpIDogc2VsZik7IH0pO1xuLyoqXG4gKiBBbGlhcyBvZiBgb3JFbHNlYC5cbiAqXG4gKiBMZXNzIHN0cmljdCB2ZXJzaW9uIG9mIFtgYWx0YF0oI2FsdCkuXG4gKlxuICogVGhlIGBXYCBzdWZmaXggKHNob3J0IGZvciAqKlcqKmlkZW5pbmcpIG1lYW5zIHRoYXQgdGhlIHJldHVybiB0eXBlcyB3aWxsIGJlIG1lcmdlZC5cbiAqXG4gKiBAY2F0ZWdvcnkgbGVnYWN5XG4gKiBAc2luY2UgMi45LjBcbiAqL1xuZXhwb3J0IHZhciBhbHRXID0gb3JFbHNlO1xuLyoqXG4gKiBBbGlhcyBvZiBgb3JFbHNlYC5cbiAqXG4gKiBAY2F0ZWdvcnkgbGVnYWN5XG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciBhbHQgPSBvckVsc2U7XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjcuMFxuICovXG5leHBvcnQgdmFyIEFsdCA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICBtYXA6IF9tYXAsXG4gICAgYWx0OiBfYWx0XG59O1xuLyoqXG4gKiBAc2luY2UgMi43LjBcbiAqL1xuZXhwb3J0IHZhciB6ZXJvID0gZnVuY3Rpb24gKCkgeyByZXR1cm4gbm9uZTsgfTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIFplcm8gPSB7XG4gICAgVVJJOiBVUkksXG4gICAgemVybzogemVyb1xufTtcbi8qKlxuICogQGNhdGVnb3J5IGRvIG5vdGF0aW9uXG4gKiBAc2luY2UgMi4xMS4wXG4gKi9cbmV4cG9ydCB2YXIgZ3VhcmQgPSAvKiNfX1BVUkVfXyovIGd1YXJkXyhaZXJvLCBQb2ludGVkKTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuNy4wXG4gKi9cbmV4cG9ydCB2YXIgQWx0ZXJuYXRpdmUgPSB7XG4gICAgVVJJOiBVUkksXG4gICAgbWFwOiBfbWFwLFxuICAgIGFwOiBfYXAsXG4gICAgb2Y6IG9mLFxuICAgIGFsdDogX2FsdCxcbiAgICB6ZXJvOiB6ZXJvXG59O1xuLyoqXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciBleHRlbmQgPSBmdW5jdGlvbiAoZikgeyByZXR1cm4gZnVuY3Rpb24gKHdhKSB7XG4gICAgcmV0dXJuIGlzTm9uZSh3YSkgPyBub25lIDogc29tZShmKHdhKSk7XG59OyB9O1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi43LjBcbiAqL1xuZXhwb3J0IHZhciBFeHRlbmQgPSB7XG4gICAgVVJJOiBVUkksXG4gICAgbWFwOiBfbWFwLFxuICAgIGV4dGVuZDogX2V4dGVuZFxufTtcbi8qKlxuICogQGNhdGVnb3J5IGZpbHRlcmluZ1xuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgY29tcGFjdCA9IC8qI19fUFVSRV9fKi8gZmxhdE1hcChpZGVudGl0eSk7XG52YXIgZGVmYXVsdFNlcGFyYXRlZCA9IC8qI19fUFVSRV9fKi8gc2VwYXJhdGVkKG5vbmUsIG5vbmUpO1xuLyoqXG4gKiBAY2F0ZWdvcnkgZmlsdGVyaW5nXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciBzZXBhcmF0ZSA9IGZ1bmN0aW9uIChtYSkge1xuICAgIHJldHVybiBpc05vbmUobWEpID8gZGVmYXVsdFNlcGFyYXRlZCA6IHNlcGFyYXRlZChnZXRMZWZ0KG1hLnZhbHVlKSwgZ2V0UmlnaHQobWEudmFsdWUpKTtcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjcuMFxuICovXG5leHBvcnQgdmFyIENvbXBhY3RhYmxlID0ge1xuICAgIFVSSTogVVJJLFxuICAgIGNvbXBhY3Q6IGNvbXBhY3QsXG4gICAgc2VwYXJhdGU6IHNlcGFyYXRlXG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgZmlsdGVyaW5nXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciBmaWx0ZXIgPSBmdW5jdGlvbiAocHJlZGljYXRlKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChmYSkge1xuICAgICAgICByZXR1cm4gaXNOb25lKGZhKSA/IG5vbmUgOiBwcmVkaWNhdGUoZmEudmFsdWUpID8gZmEgOiBub25lO1xuICAgIH07XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgZmlsdGVyaW5nXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciBmaWx0ZXJNYXAgPSBmdW5jdGlvbiAoZikgeyByZXR1cm4gZnVuY3Rpb24gKGZhKSB7XG4gICAgcmV0dXJuIGlzTm9uZShmYSkgPyBub25lIDogZihmYS52YWx1ZSk7XG59OyB9O1xuLyoqXG4gKiBAY2F0ZWdvcnkgZmlsdGVyaW5nXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciBwYXJ0aXRpb24gPSBmdW5jdGlvbiAocHJlZGljYXRlKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChmYSkge1xuICAgICAgICByZXR1cm4gc2VwYXJhdGVkKF9maWx0ZXIoZmEsIG5vdChwcmVkaWNhdGUpKSwgX2ZpbHRlcihmYSwgcHJlZGljYXRlKSk7XG4gICAgfTtcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBmaWx0ZXJpbmdcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIHBhcnRpdGlvbk1hcCA9IGZ1bmN0aW9uIChmKSB7IHJldHVybiBmbG93KG1hcChmKSwgc2VwYXJhdGUpOyB9O1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi43LjBcbiAqL1xuZXhwb3J0IHZhciBGaWx0ZXJhYmxlID0ge1xuICAgIFVSSTogVVJJLFxuICAgIG1hcDogX21hcCxcbiAgICBjb21wYWN0OiBjb21wYWN0LFxuICAgIHNlcGFyYXRlOiBzZXBhcmF0ZSxcbiAgICBmaWx0ZXI6IF9maWx0ZXIsXG4gICAgZmlsdGVyTWFwOiBfZmlsdGVyTWFwLFxuICAgIHBhcnRpdGlvbjogX3BhcnRpdGlvbixcbiAgICBwYXJ0aXRpb25NYXA6IF9wYXJ0aXRpb25NYXBcbn07XG4vKipcbiAqIEBjYXRlZ29yeSB0cmF2ZXJzaW5nXG4gKiBAc2luY2UgMi42LjNcbiAqL1xuZXhwb3J0IHZhciB0cmF2ZXJzZSA9IGZ1bmN0aW9uIChGKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChmKSB7XG4gICAgICAgIHJldHVybiBmdW5jdGlvbiAodGEpIHtcbiAgICAgICAgICAgIHJldHVybiBpc05vbmUodGEpID8gRi5vZihub25lKSA6IEYubWFwKGYodGEudmFsdWUpLCBzb21lKTtcbiAgICAgICAgfTtcbiAgICB9O1xufTtcbi8qKlxuICogQGNhdGVnb3J5IHRyYXZlcnNpbmdcbiAqIEBzaW5jZSAyLjYuM1xuICovXG5leHBvcnQgdmFyIHNlcXVlbmNlID0gZnVuY3Rpb24gKEYpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKHRhKSB7XG4gICAgICAgIHJldHVybiBpc05vbmUodGEpID8gRi5vZihub25lKSA6IEYubWFwKHRhLnZhbHVlLCBzb21lKTtcbiAgICB9O1xufTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuNy4wXG4gKi9cbmV4cG9ydCB2YXIgVHJhdmVyc2FibGUgPSB7XG4gICAgVVJJOiBVUkksXG4gICAgbWFwOiBfbWFwLFxuICAgIHJlZHVjZTogX3JlZHVjZSxcbiAgICBmb2xkTWFwOiBfZm9sZE1hcCxcbiAgICByZWR1Y2VSaWdodDogX3JlZHVjZVJpZ2h0LFxuICAgIHRyYXZlcnNlOiBfdHJhdmVyc2UsXG4gICAgc2VxdWVuY2U6IHNlcXVlbmNlXG59O1xudmFyIF93aXRoZXIgPSAvKiNfX1BVUkVfXyovIHdpdGhlckRlZmF1bHQoVHJhdmVyc2FibGUsIENvbXBhY3RhYmxlKTtcbnZhciBfd2lsdCA9IC8qI19fUFVSRV9fKi8gd2lsdERlZmF1bHQoVHJhdmVyc2FibGUsIENvbXBhY3RhYmxlKTtcbi8qKlxuICogQGNhdGVnb3J5IGZpbHRlcmluZ1xuICogQHNpbmNlIDIuNi41XG4gKi9cbmV4cG9ydCB2YXIgd2l0aGVyID0gZnVuY3Rpb24gKEYpIHtcbiAgICB2YXIgX3dpdGhlckYgPSBfd2l0aGVyKEYpO1xuICAgIHJldHVybiBmdW5jdGlvbiAoZikgeyByZXR1cm4gZnVuY3Rpb24gKGZhKSB7IHJldHVybiBfd2l0aGVyRihmYSwgZik7IH07IH07XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgZmlsdGVyaW5nXG4gKiBAc2luY2UgMi42LjVcbiAqL1xuZXhwb3J0IHZhciB3aWx0ID0gZnVuY3Rpb24gKEYpIHtcbiAgICB2YXIgX3dpbHRGID0gX3dpbHQoRik7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChmKSB7IHJldHVybiBmdW5jdGlvbiAoZmEpIHsgcmV0dXJuIF93aWx0RihmYSwgZik7IH07IH07XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi43LjBcbiAqL1xuZXhwb3J0IHZhciBXaXRoZXJhYmxlID0ge1xuICAgIFVSSTogVVJJLFxuICAgIG1hcDogX21hcCxcbiAgICByZWR1Y2U6IF9yZWR1Y2UsXG4gICAgZm9sZE1hcDogX2ZvbGRNYXAsXG4gICAgcmVkdWNlUmlnaHQ6IF9yZWR1Y2VSaWdodCxcbiAgICB0cmF2ZXJzZTogX3RyYXZlcnNlLFxuICAgIHNlcXVlbmNlOiBzZXF1ZW5jZSxcbiAgICBjb21wYWN0OiBjb21wYWN0LFxuICAgIHNlcGFyYXRlOiBzZXBhcmF0ZSxcbiAgICBmaWx0ZXI6IF9maWx0ZXIsXG4gICAgZmlsdGVyTWFwOiBfZmlsdGVyTWFwLFxuICAgIHBhcnRpdGlvbjogX3BhcnRpdGlvbixcbiAgICBwYXJ0aXRpb25NYXA6IF9wYXJ0aXRpb25NYXAsXG4gICAgd2l0aGVyOiBfd2l0aGVyLFxuICAgIHdpbHQ6IF93aWx0XG59O1xuLyoqXG4gKiBAc2luY2UgMi43LjBcbiAqL1xuZXhwb3J0IHZhciB0aHJvd0Vycm9yID0gZnVuY3Rpb24gKCkgeyByZXR1cm4gbm9uZTsgfTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuNy4wXG4gKi9cbmV4cG9ydCB2YXIgTW9uYWRUaHJvdyA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICBtYXA6IF9tYXAsXG4gICAgYXA6IF9hcCxcbiAgICBvZjogb2YsXG4gICAgY2hhaW46IGZsYXRNYXAsXG4gICAgdGhyb3dFcnJvcjogdGhyb3dFcnJvclxufTtcbi8qKlxuICogVHJhbnNmb3JtcyBhbiBgRWl0aGVyYCB0byBhbiBgT3B0aW9uYCBkaXNjYXJkaW5nIHRoZSBlcnJvci5cbiAqXG4gKiBBbGlhcyBvZiBbZ2V0UmlnaHRdKCNnZXRyaWdodClcbiAqXG4gKiBAY2F0ZWdvcnkgY29udmVyc2lvbnNcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIGZyb21FaXRoZXIgPSBnZXRSaWdodDtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIEZyb21FaXRoZXIgPSB7XG4gICAgVVJJOiBVUkksXG4gICAgZnJvbUVpdGhlcjogZnJvbUVpdGhlclxufTtcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8vIHJlZmluZW1lbnRzXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vKipcbiAqIFJldHVybnMgYHRydWVgIGlmIHRoZSBvcHRpb24gaXMgYW4gaW5zdGFuY2Ugb2YgYFNvbWVgLCBgZmFsc2VgIG90aGVyd2lzZS5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgc29tZSwgbm9uZSwgaXNTb21lIH0gZnJvbSAnZnAtdHMvT3B0aW9uJ1xuICpcbiAqIGFzc2VydC5zdHJpY3RFcXVhbChpc1NvbWUoc29tZSgxKSksIHRydWUpXG4gKiBhc3NlcnQuc3RyaWN0RXF1YWwoaXNTb21lKG5vbmUpLCBmYWxzZSlcbiAqXG4gKiBAY2F0ZWdvcnkgcmVmaW5lbWVudHNcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIGlzU29tZSA9IF8uaXNTb21lO1xuLyoqXG4gKiBSZXR1cm5zIGB0cnVlYCBpZiB0aGUgb3B0aW9uIGlzIGBOb25lYCwgYGZhbHNlYCBvdGhlcndpc2UuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IHNvbWUsIG5vbmUsIGlzTm9uZSB9IGZyb20gJ2ZwLXRzL09wdGlvbidcbiAqXG4gKiBhc3NlcnQuc3RyaWN0RXF1YWwoaXNOb25lKHNvbWUoMSkpLCBmYWxzZSlcbiAqIGFzc2VydC5zdHJpY3RFcXVhbChpc05vbmUobm9uZSksIHRydWUpXG4gKlxuICogQGNhdGVnb3J5IHJlZmluZW1lbnRzXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciBpc05vbmUgPSBmdW5jdGlvbiAoZmEpIHsgcmV0dXJuIGZhLl90YWcgPT09ICdOb25lJzsgfTtcbi8qKlxuICogTGVzcyBzdHJpY3QgdmVyc2lvbiBvZiBbYG1hdGNoYF0oI21hdGNoKS5cbiAqXG4gKiBUaGUgYFdgIHN1ZmZpeCAoc2hvcnQgZm9yICoqVyoqaWRlbmluZykgbWVhbnMgdGhhdCB0aGUgaGFuZGxlciByZXR1cm4gdHlwZXMgd2lsbCBiZSBtZXJnZWQuXG4gKlxuICogQGNhdGVnb3J5IHBhdHRlcm4gbWF0Y2hpbmdcbiAqIEBzaW5jZSAyLjEwLjBcbiAqL1xuZXhwb3J0IHZhciBtYXRjaFcgPSBmdW5jdGlvbiAob25Ob25lLCBvblNvbWUpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKG1hKSB7XG4gICAgICAgIHJldHVybiBpc05vbmUobWEpID8gb25Ob25lKCkgOiBvblNvbWUobWEudmFsdWUpO1xuICAgIH07XG59O1xuLyoqXG4gKiBBbGlhcyBvZiBbYG1hdGNoV2BdKCNtYXRjaHcpLlxuICpcbiAqIEBjYXRlZ29yeSBwYXR0ZXJuIG1hdGNoaW5nXG4gKiBAc2luY2UgMi4xMC4wXG4gKi9cbmV4cG9ydCB2YXIgZm9sZFcgPSBtYXRjaFc7XG4vKipcbiAqIFRha2VzIGEgKGxhenkpIGRlZmF1bHQgdmFsdWUsIGEgZnVuY3Rpb24sIGFuZCBhbiBgT3B0aW9uYCB2YWx1ZSwgaWYgdGhlIGBPcHRpb25gIHZhbHVlIGlzIGBOb25lYCB0aGUgZGVmYXVsdCB2YWx1ZSBpc1xuICogcmV0dXJuZWQsIG90aGVyd2lzZSB0aGUgZnVuY3Rpb24gaXMgYXBwbGllZCB0byB0aGUgdmFsdWUgaW5zaWRlIHRoZSBgU29tZWAgYW5kIHRoZSByZXN1bHQgaXMgcmV0dXJuZWQuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IHNvbWUsIG5vbmUsIG1hdGNoIH0gZnJvbSAnZnAtdHMvT3B0aW9uJ1xuICogaW1wb3J0IHsgcGlwZSB9IGZyb20gJ2ZwLXRzL2Z1bmN0aW9uJ1xuICpcbiAqIGFzc2VydC5zdHJpY3RFcXVhbChcbiAqICAgcGlwZShcbiAqICAgICBzb21lKDEpLFxuICogICAgIG1hdGNoKCgpID0+ICdhIG5vbmUnLCBhID0+IGBhIHNvbWUgY29udGFpbmluZyAke2F9YClcbiAqICAgKSxcbiAqICAgJ2Egc29tZSBjb250YWluaW5nIDEnXG4gKiApXG4gKlxuICogYXNzZXJ0LnN0cmljdEVxdWFsKFxuICogICBwaXBlKFxuICogICAgIG5vbmUsXG4gKiAgICAgbWF0Y2goKCkgPT4gJ2Egbm9uZScsIGEgPT4gYGEgc29tZSBjb250YWluaW5nICR7YX1gKVxuICogICApLFxuICogICAnYSBub25lJ1xuICogKVxuICpcbiAqIEBjYXRlZ29yeSBwYXR0ZXJuIG1hdGNoaW5nXG4gKiBAc2luY2UgMi4xMC4wXG4gKi9cbmV4cG9ydCB2YXIgbWF0Y2ggPSBtYXRjaFc7XG4vKipcbiAqIEFsaWFzIG9mIFtgbWF0Y2hgXSgjbWF0Y2gpLlxuICpcbiAqIEBjYXRlZ29yeSBwYXR0ZXJuIG1hdGNoaW5nXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciBmb2xkID0gbWF0Y2g7XG4vKipcbiAqIExlc3Mgc3RyaWN0IHZlcnNpb24gb2YgW2BnZXRPckVsc2VgXSgjZ2V0b3JlbHNlKS5cbiAqXG4gKiBUaGUgYFdgIHN1ZmZpeCAoc2hvcnQgZm9yICoqVyoqaWRlbmluZykgbWVhbnMgdGhhdCB0aGUgaGFuZGxlciByZXR1cm4gdHlwZSB3aWxsIGJlIG1lcmdlZC5cbiAqXG4gKiBAY2F0ZWdvcnkgZXJyb3IgaGFuZGxpbmdcbiAqIEBzaW5jZSAyLjYuMFxuICovXG5leHBvcnQgdmFyIGdldE9yRWxzZVcgPSBmdW5jdGlvbiAob25Ob25lKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChtYSkge1xuICAgICAgICByZXR1cm4gaXNOb25lKG1hKSA/IG9uTm9uZSgpIDogbWEudmFsdWU7XG4gICAgfTtcbn07XG4vKipcbiAqIEV4dHJhY3RzIHRoZSB2YWx1ZSBvdXQgb2YgdGhlIHN0cnVjdHVyZSwgaWYgaXQgZXhpc3RzLiBPdGhlcndpc2UgcmV0dXJucyB0aGUgZ2l2ZW4gZGVmYXVsdCB2YWx1ZVxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBzb21lLCBub25lLCBnZXRPckVsc2UgfSBmcm9tICdmcC10cy9PcHRpb24nXG4gKiBpbXBvcnQgeyBwaXBlIH0gZnJvbSAnZnAtdHMvZnVuY3Rpb24nXG4gKlxuICogYXNzZXJ0LnN0cmljdEVxdWFsKFxuICogICBwaXBlKFxuICogICAgIHNvbWUoMSksXG4gKiAgICAgZ2V0T3JFbHNlKCgpID0+IDApXG4gKiAgICksXG4gKiAgIDFcbiAqIClcbiAqIGFzc2VydC5zdHJpY3RFcXVhbChcbiAqICAgcGlwZShcbiAqICAgICBub25lLFxuICogICAgIGdldE9yRWxzZSgoKSA9PiAwKVxuICogICApLFxuICogICAwXG4gKiApXG4gKlxuICogQGNhdGVnb3J5IGVycm9yIGhhbmRsaW5nXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciBnZXRPckVsc2UgPSBnZXRPckVsc2VXO1xuLyoqXG4gKiBAY2F0ZWdvcnkgbWFwcGluZ1xuICogQHNpbmNlIDIuMTAuMFxuICovXG5leHBvcnQgdmFyIGZsYXAgPSAvKiNfX1BVUkVfXyovIGZsYXBfKEZ1bmN0b3IpO1xuLyoqXG4gKiBDb21iaW5lIHR3byBlZmZlY3RmdWwgYWN0aW9ucywga2VlcGluZyBvbmx5IHRoZSByZXN1bHQgb2YgdGhlIGZpcnN0LlxuICpcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIGFwRmlyc3QgPSAvKiNfX1BVUkVfXyovIGFwRmlyc3RfKEFwcGx5KTtcbi8qKlxuICogQ29tYmluZSB0d28gZWZmZWN0ZnVsIGFjdGlvbnMsIGtlZXBpbmcgb25seSB0aGUgcmVzdWx0IG9mIHRoZSBzZWNvbmQuXG4gKlxuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgYXBTZWNvbmQgPSAvKiNfX1BVUkVfXyovIGFwU2Vjb25kXyhBcHBseSk7XG4vKipcbiAqIEBjYXRlZ29yeSBzZXF1ZW5jaW5nXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciBmbGF0dGVuID0gY29tcGFjdDtcbi8qKlxuICogQ29tcG9zZXMgY29tcHV0YXRpb25zIGluIHNlcXVlbmNlLCB1c2luZyB0aGUgcmV0dXJuIHZhbHVlIG9mIG9uZSBjb21wdXRhdGlvbiB0byBkZXRlcm1pbmUgdGhlIG5leHQgY29tcHV0YXRpb24gYW5kXG4gKiBrZWVwaW5nIG9ubHkgdGhlIHJlc3VsdCBvZiB0aGUgZmlyc3QuXG4gKlxuICogQGNhdGVnb3J5IGNvbWJpbmF0b3JzXG4gKiBAc2luY2UgMi4xNS4wXG4gKi9cbmV4cG9ydCB2YXIgdGFwID0gLyojX19QVVJFX18qLyBkdWFsKDIsIGNoYWluYWJsZS50YXAoQ2hhaW4pKTtcbi8qKlxuICogQ29tcG9zZXMgY29tcHV0YXRpb25zIGluIHNlcXVlbmNlLCB1c2luZyB0aGUgcmV0dXJuIHZhbHVlIG9mIG9uZSBjb21wdXRhdGlvbiB0byBkZXRlcm1pbmUgdGhlIG5leHQgY29tcHV0YXRpb24gYW5kXG4gKiBrZWVwaW5nIG9ubHkgdGhlIHJlc3VsdCBvZiB0aGUgZmlyc3QuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IHBpcGUgfSBmcm9tICdmcC10cy9mdW5jdGlvbidcbiAqIGltcG9ydCAqIGFzIE8gZnJvbSAnZnAtdHMvT3B0aW9uJ1xuICogaW1wb3J0ICogYXMgRSBmcm9tICdmcC10cy9FaXRoZXInXG4gKlxuICogY29uc3QgY29tcHV0ZSA9ICh2YWx1ZTogbnVtYmVyKSA9PiBwaXBlKFxuICogICBPLm9mKHZhbHVlKSxcbiAqICAgTy50YXBFaXRoZXIoKHZhbHVlKSA9PiB2YWx1ZSA+IDAgPyBFLnJpZ2h0KCdvaycpIDogRS5sZWZ0KCdlcnJvcicpKSxcbiAqIClcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKGNvbXB1dGUoMSksIE8ub2YoMSkpXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKGNvbXB1dGUoLTQyKSwgTy5ub25lKVxuICpcbiAqIEBjYXRlZ29yeSBjb21iaW5hdG9yc1xuICogQHNpbmNlIDIuMTYuMFxuICovXG5leHBvcnQgdmFyIHRhcEVpdGhlciA9IC8qI19fUFVSRV9fKi8gZHVhbCgyLCB0YXBFaXRoZXJfKEZyb21FaXRoZXIsIENoYWluKSk7XG4vKipcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIGR1cGxpY2F0ZSA9IC8qI19fUFVSRV9fKi8gZXh0ZW5kKGlkZW50aXR5KTtcbi8qKlxuICogQGNhdGVnb3J5IGxpZnRpbmdcbiAqIEBzaW5jZSAyLjExLjBcbiAqL1xuZXhwb3J0IHZhciBmcm9tRWl0aGVySyA9IC8qI19fUFVSRV9fKi8gZnJvbUVpdGhlcktfKEZyb21FaXRoZXIpO1xuLyoqXG4gKiBAY2F0ZWdvcnkgc2VxdWVuY2luZ1xuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIGNoYWluRWl0aGVySyA9IFxuLyojX19QVVJFX18qLyBjaGFpbkVpdGhlcktfKEZyb21FaXRoZXIsIENoYWluKTtcbi8qKlxuICogQWxpYXMgb2YgYHRhcEVpdGhlcmAuXG4gKlxuICogQGNhdGVnb3J5IGxlZ2FjeVxuICogQHNpbmNlIDIuMTIuMFxuICovXG5leHBvcnQgdmFyIGNoYWluRmlyc3RFaXRoZXJLID0gdGFwRWl0aGVyO1xuLyoqXG4gKiBDb25zdHJ1Y3RzIGEgbmV3IGBPcHRpb25gIGZyb20gYSBudWxsYWJsZSB0eXBlLiBJZiB0aGUgdmFsdWUgaXMgYG51bGxgIG9yIGB1bmRlZmluZWRgLCByZXR1cm5zIGBOb25lYCwgb3RoZXJ3aXNlXG4gKiByZXR1cm5zIHRoZSB2YWx1ZSB3cmFwcGVkIGluIGEgYFNvbWVgLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBub25lLCBzb21lLCBmcm9tTnVsbGFibGUgfSBmcm9tICdmcC10cy9PcHRpb24nXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChmcm9tTnVsbGFibGUodW5kZWZpbmVkKSwgbm9uZSlcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoZnJvbU51bGxhYmxlKG51bGwpLCBub25lKVxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChmcm9tTnVsbGFibGUoMSksIHNvbWUoMSkpXG4gKlxuICogQGNhdGVnb3J5IGNvbnZlcnNpb25zXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciBmcm9tTnVsbGFibGUgPSBmdW5jdGlvbiAoYSkgeyByZXR1cm4gKGEgPT0gbnVsbCA/IG5vbmUgOiBzb21lKGEpKTsgfTtcbi8qKlxuICogVHJhbnNmb3JtcyBhbiBleGNlcHRpb24gaW50byBhbiBgT3B0aW9uYC4gSWYgYGZgIHRocm93cywgcmV0dXJucyBgTm9uZWAsIG90aGVyd2lzZSByZXR1cm5zIHRoZSBvdXRwdXQgd3JhcHBlZCBpbiBhXG4gKiBgU29tZWAuXG4gKlxuICogU2VlIGFsc28gW2B0cnlDYXRjaEtgXSgjdHJ5Y2F0Y2hrKS5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgbm9uZSwgc29tZSwgdHJ5Q2F0Y2ggfSBmcm9tICdmcC10cy9PcHRpb24nXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChcbiAqICAgdHJ5Q2F0Y2goKCkgPT4ge1xuICogICAgIHRocm93IG5ldyBFcnJvcigpXG4gKiAgIH0pLFxuICogICBub25lXG4gKiApXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKHRyeUNhdGNoKCgpID0+IDEpLCBzb21lKDEpKVxuICpcbiAqIEBjYXRlZ29yeSBpbnRlcm9wXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciB0cnlDYXRjaCA9IGZ1bmN0aW9uIChmKSB7XG4gICAgdHJ5IHtcbiAgICAgICAgcmV0dXJuIHNvbWUoZigpKTtcbiAgICB9XG4gICAgY2F0Y2ggKGUpIHtcbiAgICAgICAgcmV0dXJuIG5vbmU7XG4gICAgfVxufTtcbi8qKlxuICogQ29udmVydHMgYSBmdW5jdGlvbiB0aGF0IG1heSB0aHJvdyB0byBvbmUgcmV0dXJuaW5nIGEgYE9wdGlvbmAuXG4gKlxuICogQGNhdGVnb3J5IGludGVyb3BcbiAqIEBzaW5jZSAyLjEwLjBcbiAqL1xuZXhwb3J0IHZhciB0cnlDYXRjaEsgPSBmdW5jdGlvbiAoZikge1xuICAgIHJldHVybiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBhID0gW107XG4gICAgICAgIGZvciAodmFyIF9pID0gMDsgX2kgPCBhcmd1bWVudHMubGVuZ3RoOyBfaSsrKSB7XG4gICAgICAgICAgICBhW19pXSA9IGFyZ3VtZW50c1tfaV07XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRyeUNhdGNoKGZ1bmN0aW9uICgpIHsgcmV0dXJuIGYuYXBwbHkodm9pZCAwLCBhKTsgfSk7XG4gICAgfTtcbn07XG4vKipcbiAqIFJldHVybnMgYSAqc21hcnQgY29uc3RydWN0b3IqIGZyb20gYSBmdW5jdGlvbiB0aGF0IHJldHVybnMgYSBudWxsYWJsZSB2YWx1ZS5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgZnJvbU51bGxhYmxlSywgbm9uZSwgc29tZSB9IGZyb20gJ2ZwLXRzL09wdGlvbidcbiAqXG4gKiBjb25zdCBmID0gKHM6IHN0cmluZyk6IG51bWJlciB8IHVuZGVmaW5lZCA9PiB7XG4gKiAgIGNvbnN0IG4gPSBwYXJzZUZsb2F0KHMpXG4gKiAgIHJldHVybiBpc05hTihuKSA/IHVuZGVmaW5lZCA6IG5cbiAqIH1cbiAqXG4gKiBjb25zdCBnID0gZnJvbU51bGxhYmxlSyhmKVxuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoZygnMScpLCBzb21lKDEpKVxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChnKCdhJyksIG5vbmUpXG4gKlxuICogQGNhdGVnb3J5IGxpZnRpbmdcbiAqIEBzaW5jZSAyLjkuMFxuICovXG5leHBvcnQgdmFyIGZyb21OdWxsYWJsZUsgPSBmdW5jdGlvbiAoZikgeyByZXR1cm4gZmxvdyhmLCBmcm9tTnVsbGFibGUpOyB9O1xuLyoqXG4gKiBUaGlzIGlzIGBjaGFpbmAgKyBgZnJvbU51bGxhYmxlYCwgdXNlZnVsIHdoZW4gd29ya2luZyB3aXRoIG9wdGlvbmFsIHZhbHVlcy5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgc29tZSwgbm9uZSwgZnJvbU51bGxhYmxlLCBjaGFpbk51bGxhYmxlSyB9IGZyb20gJ2ZwLXRzL09wdGlvbidcbiAqIGltcG9ydCB7IHBpcGUgfSBmcm9tICdmcC10cy9mdW5jdGlvbidcbiAqXG4gKiBpbnRlcmZhY2UgRW1wbG95ZWUge1xuICogICByZWFkb25seSBjb21wYW55Pzoge1xuICogICAgIHJlYWRvbmx5IGFkZHJlc3M/OiB7XG4gKiAgICAgICByZWFkb25seSBzdHJlZXQ/OiB7XG4gKiAgICAgICAgIHJlYWRvbmx5IG5hbWU/OiBzdHJpbmdcbiAqICAgICAgIH1cbiAqICAgICB9XG4gKiAgIH1cbiAqIH1cbiAqXG4gKiBjb25zdCBlbXBsb3llZTE6IEVtcGxveWVlID0geyBjb21wYW55OiB7IGFkZHJlc3M6IHsgc3RyZWV0OiB7IG5hbWU6ICdoaWdoIHN0cmVldCcgfSB9IH0gfVxuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoXG4gKiAgIHBpcGUoXG4gKiAgICAgZnJvbU51bGxhYmxlKGVtcGxveWVlMS5jb21wYW55KSxcbiAqICAgICBjaGFpbk51bGxhYmxlSyhjb21wYW55ID0+IGNvbXBhbnkuYWRkcmVzcyksXG4gKiAgICAgY2hhaW5OdWxsYWJsZUsoYWRkcmVzcyA9PiBhZGRyZXNzLnN0cmVldCksXG4gKiAgICAgY2hhaW5OdWxsYWJsZUsoc3RyZWV0ID0+IHN0cmVldC5uYW1lKVxuICogICApLFxuICogICBzb21lKCdoaWdoIHN0cmVldCcpXG4gKiApXG4gKlxuICogY29uc3QgZW1wbG95ZWUyOiBFbXBsb3llZSA9IHsgY29tcGFueTogeyBhZGRyZXNzOiB7IHN0cmVldDoge30gfSB9IH1cbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKFxuICogICBwaXBlKFxuICogICAgIGZyb21OdWxsYWJsZShlbXBsb3llZTIuY29tcGFueSksXG4gKiAgICAgY2hhaW5OdWxsYWJsZUsoY29tcGFueSA9PiBjb21wYW55LmFkZHJlc3MpLFxuICogICAgIGNoYWluTnVsbGFibGVLKGFkZHJlc3MgPT4gYWRkcmVzcy5zdHJlZXQpLFxuICogICAgIGNoYWluTnVsbGFibGVLKHN0cmVldCA9PiBzdHJlZXQubmFtZSlcbiAqICAgKSxcbiAqICAgbm9uZVxuICogKVxuICpcbiAqIEBjYXRlZ29yeSBzZXF1ZW5jaW5nXG4gKiBAc2luY2UgMi45LjBcbiAqL1xuZXhwb3J0IHZhciBjaGFpbk51bGxhYmxlSyA9IGZ1bmN0aW9uIChmKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChtYSkge1xuICAgICAgICByZXR1cm4gaXNOb25lKG1hKSA/IG5vbmUgOiBmcm9tTnVsbGFibGUoZihtYS52YWx1ZSkpO1xuICAgIH07XG59O1xuLyoqXG4gKiBFeHRyYWN0cyB0aGUgdmFsdWUgb3V0IG9mIHRoZSBzdHJ1Y3R1cmUsIGlmIGl0IGV4aXN0cy4gT3RoZXJ3aXNlIHJldHVybnMgYG51bGxgLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBzb21lLCBub25lLCB0b051bGxhYmxlIH0gZnJvbSAnZnAtdHMvT3B0aW9uJ1xuICogaW1wb3J0IHsgcGlwZSB9IGZyb20gJ2ZwLXRzL2Z1bmN0aW9uJ1xuICpcbiAqIGFzc2VydC5zdHJpY3RFcXVhbChcbiAqICAgcGlwZShcbiAqICAgICBzb21lKDEpLFxuICogICAgIHRvTnVsbGFibGVcbiAqICAgKSxcbiAqICAgMVxuICogKVxuICogYXNzZXJ0LnN0cmljdEVxdWFsKFxuICogICBwaXBlKFxuICogICAgIG5vbmUsXG4gKiAgICAgdG9OdWxsYWJsZVxuICogICApLFxuICogICBudWxsXG4gKiApXG4gKlxuICogQGNhdGVnb3J5IGNvbnZlcnNpb25zXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciB0b051bGxhYmxlID0gLyojX19QVVJFX18qLyBtYXRjaChjb25zdE51bGwsIGlkZW50aXR5KTtcbi8qKlxuICogRXh0cmFjdHMgdGhlIHZhbHVlIG91dCBvZiB0aGUgc3RydWN0dXJlLCBpZiBpdCBleGlzdHMuIE90aGVyd2lzZSByZXR1cm5zIGB1bmRlZmluZWRgLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBzb21lLCBub25lLCB0b1VuZGVmaW5lZCB9IGZyb20gJ2ZwLXRzL09wdGlvbidcbiAqIGltcG9ydCB7IHBpcGUgfSBmcm9tICdmcC10cy9mdW5jdGlvbidcbiAqXG4gKiBhc3NlcnQuc3RyaWN0RXF1YWwoXG4gKiAgIHBpcGUoXG4gKiAgICAgc29tZSgxKSxcbiAqICAgICB0b1VuZGVmaW5lZFxuICogICApLFxuICogICAxXG4gKiApXG4gKiBhc3NlcnQuc3RyaWN0RXF1YWwoXG4gKiAgIHBpcGUoXG4gKiAgICAgbm9uZSxcbiAqICAgICB0b1VuZGVmaW5lZFxuICogICApLFxuICogICB1bmRlZmluZWRcbiAqIClcbiAqXG4gKiBAY2F0ZWdvcnkgY29udmVyc2lvbnNcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIHRvVW5kZWZpbmVkID0gLyojX19QVVJFX18qLyBtYXRjaChjb25zdFVuZGVmaW5lZCwgaWRlbnRpdHkpO1xuZXhwb3J0IGZ1bmN0aW9uIGVsZW0oRSkge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYSwgbWEpIHtcbiAgICAgICAgaWYgKG1hID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIHZhciBlbGVtRV8xID0gZWxlbShFKTtcbiAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbiAobWEpIHsgcmV0dXJuIGVsZW1FXzEoYSwgbWEpOyB9O1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBpc05vbmUobWEpID8gZmFsc2UgOiBFLmVxdWFscyhhLCBtYS52YWx1ZSk7XG4gICAgfTtcbn1cbi8qKlxuICogUmV0dXJucyBgdHJ1ZWAgaWYgdGhlIHByZWRpY2F0ZSBpcyBzYXRpc2ZpZWQgYnkgdGhlIHdyYXBwZWQgdmFsdWVcbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgc29tZSwgbm9uZSwgZXhpc3RzIH0gZnJvbSAnZnAtdHMvT3B0aW9uJ1xuICogaW1wb3J0IHsgcGlwZSB9IGZyb20gJ2ZwLXRzL2Z1bmN0aW9uJ1xuICpcbiAqIGFzc2VydC5zdHJpY3RFcXVhbChcbiAqICAgcGlwZShcbiAqICAgICBzb21lKDEpLFxuICogICAgIGV4aXN0cyhuID0+IG4gPiAwKVxuICogICApLFxuICogICB0cnVlXG4gKiApXG4gKiBhc3NlcnQuc3RyaWN0RXF1YWwoXG4gKiAgIHBpcGUoXG4gKiAgICAgc29tZSgxKSxcbiAqICAgICBleGlzdHMobiA9PiBuID4gMSlcbiAqICAgKSxcbiAqICAgZmFsc2VcbiAqIClcbiAqIGFzc2VydC5zdHJpY3RFcXVhbChcbiAqICAgcGlwZShcbiAqICAgICBub25lLFxuICogICAgIGV4aXN0cyhuID0+IG4gPiAwKVxuICogICApLFxuICogICBmYWxzZVxuICogKVxuICpcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIGV4aXN0cyA9IGZ1bmN0aW9uIChwcmVkaWNhdGUpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKG1hKSB7XG4gICAgICAgIHJldHVybiBpc05vbmUobWEpID8gZmFsc2UgOiBwcmVkaWNhdGUobWEudmFsdWUpO1xuICAgIH07XG59O1xuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLy8gZG8gbm90YXRpb25cbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8qKlxuICogQGNhdGVnb3J5IGRvIG5vdGF0aW9uXG4gKiBAc2luY2UgMi45LjBcbiAqL1xuZXhwb3J0IHZhciBEbyA9IC8qI19fUFVSRV9fKi8gb2YoXy5lbXB0eVJlY29yZCk7XG4vKipcbiAqIEBjYXRlZ29yeSBkbyBub3RhdGlvblxuICogQHNpbmNlIDIuOC4wXG4gKi9cbmV4cG9ydCB2YXIgYmluZFRvID0gLyojX19QVVJFX18qLyBiaW5kVG9fKEZ1bmN0b3IpO1xudmFyIGxldF8gPSAvKiNfX1BVUkVfXyovIGxldF9fKEZ1bmN0b3IpO1xuZXhwb3J0IHsgXG4vKipcbiAqIEBjYXRlZ29yeSBkbyBub3RhdGlvblxuICogQHNpbmNlIDIuMTMuMFxuICovXG5sZXRfIGFzIGxldCB9O1xuLyoqXG4gKiBAY2F0ZWdvcnkgZG8gbm90YXRpb25cbiAqIEBzaW5jZSAyLjguMFxuICovXG5leHBvcnQgdmFyIGJpbmQgPSAvKiNfX1BVUkVfXyovIGNoYWluYWJsZS5iaW5kKENoYWluKTtcbi8qKlxuICogQGNhdGVnb3J5IGRvIG5vdGF0aW9uXG4gKiBAc2luY2UgMi44LjBcbiAqL1xuZXhwb3J0IHZhciBhcFMgPSAvKiNfX1BVUkVfXyovIGFwU18oQXBwbHkpO1xuLyoqXG4gKiBAc2luY2UgMi4xMS4wXG4gKi9cbmV4cG9ydCB2YXIgQXBUID0gLyojX19QVVJFX18qLyBvZihfLmVtcHR5UmVhZG9ubHlBcnJheSk7XG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vLyBhcnJheSB1dGlsc1xuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLyoqXG4gKiBFcXVpdmFsZW50IHRvIGBSZWFkb25seU5vbkVtcHR5QXJyYXkjdHJhdmVyc2VXaXRoSW5kZXgoQXBwbGljYXRpdmUpYC5cbiAqXG4gKiBAY2F0ZWdvcnkgdHJhdmVyc2luZ1xuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIHRyYXZlcnNlUmVhZG9ubHlOb25FbXB0eUFycmF5V2l0aEluZGV4ID0gZnVuY3Rpb24gKGYpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIHZhciBvID0gZigwLCBfLmhlYWQoYXMpKTtcbiAgICAgICAgaWYgKGlzTm9uZShvKSkge1xuICAgICAgICAgICAgcmV0dXJuIG5vbmU7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIG91dCA9IFtvLnZhbHVlXTtcbiAgICAgICAgZm9yICh2YXIgaSA9IDE7IGkgPCBhcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgdmFyIG9fMSA9IGYoaSwgYXNbaV0pO1xuICAgICAgICAgICAgaWYgKGlzTm9uZShvXzEpKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG5vbmU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBvdXQucHVzaChvXzEudmFsdWUpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBzb21lKG91dCk7XG4gICAgfTtcbn07XG4vKipcbiAqIEVxdWl2YWxlbnQgdG8gYFJlYWRvbmx5QXJyYXkjdHJhdmVyc2VXaXRoSW5kZXgoQXBwbGljYXRpdmUpYC5cbiAqXG4gKiBAY2F0ZWdvcnkgdHJhdmVyc2luZ1xuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIHRyYXZlcnNlUmVhZG9ubHlBcnJheVdpdGhJbmRleCA9IGZ1bmN0aW9uIChmKSB7XG4gICAgdmFyIGcgPSB0cmF2ZXJzZVJlYWRvbmx5Tm9uRW1wdHlBcnJheVdpdGhJbmRleChmKTtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7IHJldHVybiAoXy5pc05vbkVtcHR5KGFzKSA/IGcoYXMpIDogQXBUKTsgfTtcbn07XG4vKipcbiAqIEVxdWl2YWxlbnQgdG8gYFJlYWRvbmx5QXJyYXkjdHJhdmVyc2VXaXRoSW5kZXgoQXBwbGljYXRpdmUpYC5cbiAqXG4gKiBAY2F0ZWdvcnkgdHJhdmVyc2luZ1xuICogQHNpbmNlIDIuOS4wXG4gKi9cbmV4cG9ydCB2YXIgdHJhdmVyc2VBcnJheVdpdGhJbmRleCA9IHRyYXZlcnNlUmVhZG9ubHlBcnJheVdpdGhJbmRleDtcbi8qKlxuICogRXF1aXZhbGVudCB0byBgUmVhZG9ubHlBcnJheSN0cmF2ZXJzZShBcHBsaWNhdGl2ZSlgLlxuICpcbiAqIEBjYXRlZ29yeSB0cmF2ZXJzaW5nXG4gKiBAc2luY2UgMi45LjBcbiAqL1xuZXhwb3J0IHZhciB0cmF2ZXJzZUFycmF5ID0gZnVuY3Rpb24gKGYpIHtcbiAgICByZXR1cm4gdHJhdmVyc2VSZWFkb25seUFycmF5V2l0aEluZGV4KGZ1bmN0aW9uIChfLCBhKSB7IHJldHVybiBmKGEpOyB9KTtcbn07XG4vKipcbiAqIEVxdWl2YWxlbnQgdG8gYFJlYWRvbmx5QXJyYXkjc2VxdWVuY2UoQXBwbGljYXRpdmUpYC5cbiAqXG4gKiBAY2F0ZWdvcnkgdHJhdmVyc2luZ1xuICogQHNpbmNlIDIuOS4wXG4gKi9cbmV4cG9ydCB2YXIgc2VxdWVuY2VBcnJheSA9IFxuLyojX19QVVJFX18qLyB0cmF2ZXJzZUFycmF5KGlkZW50aXR5KTtcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8vIGxlZ2FjeVxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLyoqXG4gKiBBbGlhcyBvZiBgZmxhdE1hcGAuXG4gKlxuICogQGNhdGVnb3J5IGxlZ2FjeVxuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgY2hhaW4gPSBmbGF0TWFwO1xuLyoqXG4gKiBBbGlhcyBvZiBgdGFwYC5cbiAqXG4gKiBAY2F0ZWdvcnkgbGVnYWN5XG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciBjaGFpbkZpcnN0ID0gdGFwO1xuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLy8gZGVwcmVjYXRlZFxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLyoqXG4gKiBVc2UgYFJlZmluZW1lbnRgIG1vZHVsZSBpbnN0ZWFkLlxuICpcbiAqIEBjYXRlZ29yeSB6b25lIG9mIGRlYXRoXG4gKiBAc2luY2UgMi4wLjBcbiAqIEBkZXByZWNhdGVkXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBnZXRSZWZpbmVtZW50KGdldE9wdGlvbikge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYSkgeyByZXR1cm4gaXNTb21lKGdldE9wdGlvbihhKSk7IH07XG59XG4vKipcbiAqIFVzZSBbYGNoYWluTnVsbGFibGVLYF0oI2NoYWlubnVsbGFibGVrKSBpbnN0ZWFkLlxuICpcbiAqIEBjYXRlZ29yeSB6b25lIG9mIGRlYXRoXG4gKiBAc2luY2UgMi4wLjBcbiAqIEBkZXByZWNhdGVkXG4gKi9cbmV4cG9ydCB2YXIgbWFwTnVsbGFibGUgPSBjaGFpbk51bGxhYmxlSztcbi8qKlxuICogVGhpcyBpbnN0YW5jZSBpcyBkZXByZWNhdGVkLCB1c2Ugc21hbGwsIHNwZWNpZmljIGluc3RhbmNlcyBpbnN0ZWFkLlxuICogRm9yIGV4YW1wbGUgaWYgYSBmdW5jdGlvbiBuZWVkcyBhIGBGdW5jdG9yYCBpbnN0YW5jZSwgcGFzcyBgTy5GdW5jdG9yYCBpbnN0ZWFkIG9mIGBPLm9wdGlvbmBcbiAqICh3aGVyZSBgT2AgaXMgZnJvbSBgaW1wb3J0IE8gZnJvbSAnZnAtdHMvT3B0aW9uJ2ApXG4gKlxuICogQGNhdGVnb3J5IHpvbmUgb2YgZGVhdGhcbiAqIEBzaW5jZSAyLjAuMFxuICogQGRlcHJlY2F0ZWRcbiAqL1xuZXhwb3J0IHZhciBvcHRpb24gPSB7XG4gICAgVVJJOiBVUkksXG4gICAgbWFwOiBfbWFwLFxuICAgIG9mOiBvZixcbiAgICBhcDogX2FwLFxuICAgIGNoYWluOiBmbGF0TWFwLFxuICAgIHJlZHVjZTogX3JlZHVjZSxcbiAgICBmb2xkTWFwOiBfZm9sZE1hcCxcbiAgICByZWR1Y2VSaWdodDogX3JlZHVjZVJpZ2h0LFxuICAgIHRyYXZlcnNlOiBfdHJhdmVyc2UsXG4gICAgc2VxdWVuY2U6IHNlcXVlbmNlLFxuICAgIHplcm86IHplcm8sXG4gICAgYWx0OiBfYWx0LFxuICAgIGV4dGVuZDogX2V4dGVuZCxcbiAgICBjb21wYWN0OiBjb21wYWN0LFxuICAgIHNlcGFyYXRlOiBzZXBhcmF0ZSxcbiAgICBmaWx0ZXI6IF9maWx0ZXIsXG4gICAgZmlsdGVyTWFwOiBfZmlsdGVyTWFwLFxuICAgIHBhcnRpdGlvbjogX3BhcnRpdGlvbixcbiAgICBwYXJ0aXRpb25NYXA6IF9wYXJ0aXRpb25NYXAsXG4gICAgd2l0aGVyOiBfd2l0aGVyLFxuICAgIHdpbHQ6IF93aWx0LFxuICAgIHRocm93RXJyb3I6IHRocm93RXJyb3Jcbn07XG4vKipcbiAqIFVzZSBbYGdldEFwcGx5U2VtaWdyb3VwYF0oLi9BcHBseS50cy5odG1sI2dldGFwcGx5c2VtaWdyb3VwKSBpbnN0ZWFkLlxuICpcbiAqIEBjYXRlZ29yeSB6b25lIG9mIGRlYXRoXG4gKiBAc2luY2UgMi4wLjBcbiAqIEBkZXByZWNhdGVkXG4gKi9cbmV4cG9ydCB2YXIgZ2V0QXBwbHlTZW1pZ3JvdXAgPSAvKiNfX1BVUkVfXyovIGdldEFwcGx5U2VtaWdyb3VwXyhBcHBseSk7XG4vKipcbiAqIFVzZSBbYGdldEFwcGxpY2F0aXZlTW9ub2lkYF0oLi9BcHBsaWNhdGl2ZS50cy5odG1sI2dldGFwcGxpY2F0aXZlbW9ub2lkKSBpbnN0ZWFkLlxuICpcbiAqIEBjYXRlZ29yeSB6b25lIG9mIGRlYXRoXG4gKiBAc2luY2UgMi4wLjBcbiAqIEBkZXByZWNhdGVkXG4gKi9cbmV4cG9ydCB2YXIgZ2V0QXBwbHlNb25vaWQgPSAvKiNfX1BVUkVfXyovIGdldEFwcGxpY2F0aXZlTW9ub2lkKEFwcGxpY2F0aXZlKTtcbi8qKlxuICogVXNlXG4gKlxuICogYGBgdHNcbiAqIGltcG9ydCB7IGZpcnN0IH0gZnJvbSAnZnAtdHMvU2VtaWdyb3VwJ1xuICogaW1wb3J0IHsgZ2V0TW9ub2lkIH0gZnJvbSAnZnAtdHMvT3B0aW9uJ1xuICpcbiAqIGdldE1vbm9pZChmaXJzdCgpKVxuICogYGBgXG4gKlxuICogaW5zdGVhZC5cbiAqXG4gKiBNb25vaWQgcmV0dXJuaW5nIHRoZSBsZWZ0LW1vc3Qgbm9uLWBOb25lYCB2YWx1ZVxuICpcbiAqIHwgeCAgICAgICB8IHkgICAgICAgfCBjb25jYXQoeCwgeSkgfFxuICogfCAtLS0tLS0tIHwgLS0tLS0tLSB8IC0tLS0tLS0tLS0tLSB8XG4gKiB8IG5vbmUgICAgfCBub25lICAgIHwgbm9uZSAgICAgICAgIHxcbiAqIHwgc29tZShhKSB8IG5vbmUgICAgfCBzb21lKGEpICAgICAgfFxuICogfCBub25lICAgIHwgc29tZShiKSB8IHNvbWUoYikgICAgICB8XG4gKiB8IHNvbWUoYSkgfCBzb21lKGIpIHwgc29tZShhKSAgICAgIHxcbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgZ2V0Rmlyc3RNb25vaWQsIHNvbWUsIG5vbmUgfSBmcm9tICdmcC10cy9PcHRpb24nXG4gKlxuICogY29uc3QgTSA9IGdldEZpcnN0TW9ub2lkPG51bWJlcj4oKVxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChNLmNvbmNhdChub25lLCBub25lKSwgbm9uZSlcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoTS5jb25jYXQoc29tZSgxKSwgbm9uZSksIHNvbWUoMSkpXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKE0uY29uY2F0KG5vbmUsIHNvbWUoMikpLCBzb21lKDIpKVxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChNLmNvbmNhdChzb21lKDEpLCBzb21lKDIpKSwgc29tZSgxKSlcbiAqXG4gKiBAY2F0ZWdvcnkgem9uZSBvZiBkZWF0aFxuICogQHNpbmNlIDIuMC4wXG4gKiBAZGVwcmVjYXRlZFxuICovXG5leHBvcnQgdmFyIGdldEZpcnN0TW9ub2lkID0gZnVuY3Rpb24gKCkgeyByZXR1cm4gZ2V0TW9ub2lkKGZpcnN0KCkpOyB9O1xuLyoqXG4gKiBVc2VcbiAqXG4gKiBgYGB0c1xuICogaW1wb3J0IHsgbGFzdCB9IGZyb20gJ2ZwLXRzL1NlbWlncm91cCdcbiAqIGltcG9ydCB7IGdldE1vbm9pZCB9IGZyb20gJ2ZwLXRzL09wdGlvbidcbiAqXG4gKiBnZXRNb25vaWQobGFzdCgpKVxuICogYGBgXG4gKlxuICogaW5zdGVhZC5cbiAqXG4gKiBNb25vaWQgcmV0dXJuaW5nIHRoZSByaWdodC1tb3N0IG5vbi1gTm9uZWAgdmFsdWVcbiAqXG4gKiB8IHggICAgICAgfCB5ICAgICAgIHwgY29uY2F0KHgsIHkpIHxcbiAqIHwgLS0tLS0tLSB8IC0tLS0tLS0gfCAtLS0tLS0tLS0tLS0gfFxuICogfCBub25lICAgIHwgbm9uZSAgICB8IG5vbmUgICAgICAgICB8XG4gKiB8IHNvbWUoYSkgfCBub25lICAgIHwgc29tZShhKSAgICAgIHxcbiAqIHwgbm9uZSAgICB8IHNvbWUoYikgfCBzb21lKGIpICAgICAgfFxuICogfCBzb21lKGEpIHwgc29tZShiKSB8IHNvbWUoYikgICAgICB8XG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IGdldExhc3RNb25vaWQsIHNvbWUsIG5vbmUgfSBmcm9tICdmcC10cy9PcHRpb24nXG4gKlxuICogY29uc3QgTSA9IGdldExhc3RNb25vaWQ8bnVtYmVyPigpXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKE0uY29uY2F0KG5vbmUsIG5vbmUpLCBub25lKVxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChNLmNvbmNhdChzb21lKDEpLCBub25lKSwgc29tZSgxKSlcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoTS5jb25jYXQobm9uZSwgc29tZSgyKSksIHNvbWUoMikpXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKE0uY29uY2F0KHNvbWUoMSksIHNvbWUoMikpLCBzb21lKDIpKVxuICpcbiAqIEBjYXRlZ29yeSB6b25lIG9mIGRlYXRoXG4gKiBAc2luY2UgMi4wLjBcbiAqIEBkZXByZWNhdGVkXG4gKi9cbmV4cG9ydCB2YXIgZ2V0TGFzdE1vbm9pZCA9IGZ1bmN0aW9uICgpIHsgcmV0dXJuIGdldE1vbm9pZChsYXN0KCkpOyB9O1xuIiwKICAiaW1wb3J0IHsgZ2V0QXBwbGljYXRpdmVNb25vaWQgfSBmcm9tICcuL0FwcGxpY2F0aXZlJztcbmltcG9ydCB7IGFwRmlyc3QgYXMgYXBGaXJzdF8sIGFwUyBhcyBhcFNfLCBhcFNlY29uZCBhcyBhcFNlY29uZF8sIGdldEFwcGx5U2VtaWdyb3VwIGFzIGdldEFwcGx5U2VtaWdyb3VwXyB9IGZyb20gJy4vQXBwbHknO1xuaW1wb3J0ICogYXMgY2hhaW5hYmxlIGZyb20gJy4vQ2hhaW4nO1xuaW1wb3J0IHsgY2hhaW5FaXRoZXJLIGFzIGNoYWluRWl0aGVyS18sIGZyb21FaXRoZXJLIGFzIGZyb21FaXRoZXJLXywgdGFwRWl0aGVyIGFzIHRhcEVpdGhlcl8gfSBmcm9tICcuL0Zyb21FaXRoZXInO1xuaW1wb3J0IHsgY29uc3ROdWxsLCBjb25zdFVuZGVmaW5lZCwgZHVhbCwgZmxvdywgaWRlbnRpdHksIHBpcGUgfSBmcm9tICcuL2Z1bmN0aW9uJztcbmltcG9ydCB7IGFzIGFzIGFzXywgYXNVbml0IGFzIGFzVW5pdF8sIGJpbmRUbyBhcyBiaW5kVG9fLCBmbGFwIGFzIGZsYXBfLCBsZXQgYXMgbGV0X18gfSBmcm9tICcuL0Z1bmN0b3InO1xuaW1wb3J0ICogYXMgXyBmcm9tICcuL2ludGVybmFsJztcbmltcG9ydCB7IG5vdCB9IGZyb20gJy4vUHJlZGljYXRlJztcbmltcG9ydCB7IGZpcnN0LCBsYXN0IH0gZnJvbSAnLi9TZW1pZ3JvdXAnO1xuaW1wb3J0IHsgc2VwYXJhdGVkIH0gZnJvbSAnLi9TZXBhcmF0ZWQnO1xuaW1wb3J0IHsgd2lsdERlZmF1bHQsIHdpdGhlckRlZmF1bHQgfSBmcm9tICcuL1dpdGhlcmFibGUnO1xuaW1wb3J0IHsgZ3VhcmQgYXMgZ3VhcmRfIH0gZnJvbSAnLi9aZXJvJztcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8vIGNvbnN0cnVjdG9yc1xuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLyoqXG4gKiBgTm9uZWAgZG9lc24ndCBoYXZlIGEgY29uc3RydWN0b3IsIGluc3RlYWQgeW91IGNhbiB1c2UgaXQgZGlyZWN0bHkgYXMgYSB2YWx1ZS4gUmVwcmVzZW50cyBhIG1pc3NpbmcgdmFsdWUuXG4gKlxuICogQGNhdGVnb3J5IGNvbnN0cnVjdG9yc1xuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgbm9uZSA9IF8ubm9uZTtcbi8qKlxuICogQ29uc3RydWN0cyBhIGBTb21lYC4gUmVwcmVzZW50cyBhbiBvcHRpb25hbCB2YWx1ZSB0aGF0IGV4aXN0cy5cbiAqXG4gKiBAY2F0ZWdvcnkgY29uc3RydWN0b3JzXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciBzb21lID0gXy5zb21lO1xuZXhwb3J0IGZ1bmN0aW9uIGZyb21QcmVkaWNhdGUocHJlZGljYXRlKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhKSB7IHJldHVybiAocHJlZGljYXRlKGEpID8gc29tZShhKSA6IG5vbmUpOyB9O1xufVxuLyoqXG4gKiBSZXR1cm5zIHRoZSBgTGVmdGAgdmFsdWUgb2YgYW4gYEVpdGhlcmAgaWYgcG9zc2libGUuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IGdldExlZnQsIG5vbmUsIHNvbWUgfSBmcm9tICdmcC10cy9PcHRpb24nXG4gKiBpbXBvcnQgeyByaWdodCwgbGVmdCB9IGZyb20gJ2ZwLXRzL0VpdGhlcidcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKGdldExlZnQocmlnaHQoMSkpLCBub25lKVxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChnZXRMZWZ0KGxlZnQoJ2EnKSksIHNvbWUoJ2EnKSlcbiAqXG4gKiBAY2F0ZWdvcnkgY29uc3RydWN0b3JzXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciBnZXRMZWZ0ID0gZnVuY3Rpb24gKG1hKSB7IHJldHVybiAobWEuX3RhZyA9PT0gJ1JpZ2h0JyA/IG5vbmUgOiBzb21lKG1hLmxlZnQpKTsgfTtcbi8qKlxuICogUmV0dXJucyB0aGUgYFJpZ2h0YCB2YWx1ZSBvZiBhbiBgRWl0aGVyYCBpZiBwb3NzaWJsZS5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgZ2V0UmlnaHQsIG5vbmUsIHNvbWUgfSBmcm9tICdmcC10cy9PcHRpb24nXG4gKiBpbXBvcnQgeyByaWdodCwgbGVmdCB9IGZyb20gJ2ZwLXRzL0VpdGhlcidcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKGdldFJpZ2h0KHJpZ2h0KDEpKSwgc29tZSgxKSlcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoZ2V0UmlnaHQobGVmdCgnYScpKSwgbm9uZSlcbiAqXG4gKiBAY2F0ZWdvcnkgY29uc3RydWN0b3JzXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciBnZXRSaWdodCA9IGZ1bmN0aW9uIChtYSkgeyByZXR1cm4gKG1hLl90YWcgPT09ICdMZWZ0JyA/IG5vbmUgOiBzb21lKG1hLnJpZ2h0KSk7IH07XG52YXIgX21hcCA9IGZ1bmN0aW9uIChmYSwgZikgeyByZXR1cm4gcGlwZShmYSwgbWFwKGYpKTsgfTtcbnZhciBfYXAgPSBmdW5jdGlvbiAoZmFiLCBmYSkgeyByZXR1cm4gcGlwZShmYWIsIGFwKGZhKSk7IH07XG52YXIgX3JlZHVjZSA9IGZ1bmN0aW9uIChmYSwgYiwgZikgeyByZXR1cm4gcGlwZShmYSwgcmVkdWNlKGIsIGYpKTsgfTtcbnZhciBfZm9sZE1hcCA9IGZ1bmN0aW9uIChNKSB7XG4gICAgdmFyIGZvbGRNYXBNID0gZm9sZE1hcChNKTtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGZhLCBmKSB7IHJldHVybiBwaXBlKGZhLCBmb2xkTWFwTShmKSk7IH07XG59O1xudmFyIF9yZWR1Y2VSaWdodCA9IGZ1bmN0aW9uIChmYSwgYiwgZikgeyByZXR1cm4gcGlwZShmYSwgcmVkdWNlUmlnaHQoYiwgZikpOyB9O1xudmFyIF90cmF2ZXJzZSA9IGZ1bmN0aW9uIChGKSB7XG4gICAgdmFyIHRyYXZlcnNlRiA9IHRyYXZlcnNlKEYpO1xuICAgIHJldHVybiBmdW5jdGlvbiAodGEsIGYpIHsgcmV0dXJuIHBpcGUodGEsIHRyYXZlcnNlRihmKSk7IH07XG59O1xuLyogaXN0YW5idWwgaWdub3JlIG5leHQgKi9cbnZhciBfYWx0ID0gZnVuY3Rpb24gKGZhLCB0aGF0KSB7IHJldHVybiBwaXBlKGZhLCBhbHQodGhhdCkpOyB9O1xudmFyIF9maWx0ZXIgPSBmdW5jdGlvbiAoZmEsIHByZWRpY2F0ZSkgeyByZXR1cm4gcGlwZShmYSwgZmlsdGVyKHByZWRpY2F0ZSkpOyB9O1xuLyogaXN0YW5idWwgaWdub3JlIG5leHQgKi9cbnZhciBfZmlsdGVyTWFwID0gZnVuY3Rpb24gKGZhLCBmKSB7IHJldHVybiBwaXBlKGZhLCBmaWx0ZXJNYXAoZikpOyB9O1xuLyogaXN0YW5idWwgaWdub3JlIG5leHQgKi9cbnZhciBfZXh0ZW5kID0gZnVuY3Rpb24gKHdhLCBmKSB7IHJldHVybiBwaXBlKHdhLCBleHRlbmQoZikpOyB9O1xuLyogaXN0YW5idWwgaWdub3JlIG5leHQgKi9cbnZhciBfcGFydGl0aW9uID0gZnVuY3Rpb24gKGZhLCBwcmVkaWNhdGUpIHtcbiAgICByZXR1cm4gcGlwZShmYSwgcGFydGl0aW9uKHByZWRpY2F0ZSkpO1xufTtcbi8qIGlzdGFuYnVsIGlnbm9yZSBuZXh0ICovXG52YXIgX3BhcnRpdGlvbk1hcCA9IGZ1bmN0aW9uIChmYSwgZikgeyByZXR1cm4gcGlwZShmYSwgcGFydGl0aW9uTWFwKGYpKTsgfTtcbi8qKlxuICogQGNhdGVnb3J5IHR5cGUgbGFtYmRhc1xuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgVVJJID0gJ09wdGlvbic7XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIGdldFNob3cgPSBmdW5jdGlvbiAoUykgeyByZXR1cm4gKHtcbiAgICBzaG93OiBmdW5jdGlvbiAobWEpIHsgcmV0dXJuIChpc05vbmUobWEpID8gJ25vbmUnIDogXCJzb21lKFwiLmNvbmNhdChTLnNob3cobWEudmFsdWUpLCBcIilcIikpOyB9XG59KTsgfTtcbi8qKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IG5vbmUsIHNvbWUsIGdldEVxIH0gZnJvbSAnZnAtdHMvT3B0aW9uJ1xuICogaW1wb3J0ICogYXMgTiBmcm9tICdmcC10cy9udW1iZXInXG4gKlxuICogY29uc3QgRSA9IGdldEVxKE4uRXEpXG4gKiBhc3NlcnQuc3RyaWN0RXF1YWwoRS5lcXVhbHMobm9uZSwgbm9uZSksIHRydWUpXG4gKiBhc3NlcnQuc3RyaWN0RXF1YWwoRS5lcXVhbHMobm9uZSwgc29tZSgxKSksIGZhbHNlKVxuICogYXNzZXJ0LnN0cmljdEVxdWFsKEUuZXF1YWxzKHNvbWUoMSksIG5vbmUpLCBmYWxzZSlcbiAqIGFzc2VydC5zdHJpY3RFcXVhbChFLmVxdWFscyhzb21lKDEpLCBzb21lKDIpKSwgZmFsc2UpXG4gKiBhc3NlcnQuc3RyaWN0RXF1YWwoRS5lcXVhbHMoc29tZSgxKSwgc29tZSgxKSksIHRydWUpXG4gKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgZ2V0RXEgPSBmdW5jdGlvbiAoRSkgeyByZXR1cm4gKHtcbiAgICBlcXVhbHM6IGZ1bmN0aW9uICh4LCB5KSB7IHJldHVybiB4ID09PSB5IHx8IChpc05vbmUoeCkgPyBpc05vbmUoeSkgOiBpc05vbmUoeSkgPyBmYWxzZSA6IEUuZXF1YWxzKHgudmFsdWUsIHkudmFsdWUpKTsgfVxufSk7IH07XG4vKipcbiAqIFRoZSBgT3JkYCBpbnN0YW5jZSBhbGxvd3MgYE9wdGlvbmAgdmFsdWVzIHRvIGJlIGNvbXBhcmVkIHdpdGhcbiAqIGBjb21wYXJlYCwgd2hlbmV2ZXIgdGhlcmUgaXMgYW4gYE9yZGAgaW5zdGFuY2UgZm9yXG4gKiB0aGUgdHlwZSB0aGUgYE9wdGlvbmAgY29udGFpbnMuXG4gKlxuICogYE5vbmVgIGlzIGNvbnNpZGVyZWQgdG8gYmUgbGVzcyB0aGFuIGFueSBgU29tZWAgdmFsdWUuXG4gKlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBub25lLCBzb21lLCBnZXRPcmQgfSBmcm9tICdmcC10cy9PcHRpb24nXG4gKiBpbXBvcnQgKiBhcyBOIGZyb20gJ2ZwLXRzL251bWJlcidcbiAqXG4gKiBjb25zdCBPID0gZ2V0T3JkKE4uT3JkKVxuICogYXNzZXJ0LnN0cmljdEVxdWFsKE8uY29tcGFyZShub25lLCBub25lKSwgMClcbiAqIGFzc2VydC5zdHJpY3RFcXVhbChPLmNvbXBhcmUobm9uZSwgc29tZSgxKSksIC0xKVxuICogYXNzZXJ0LnN0cmljdEVxdWFsKE8uY29tcGFyZShzb21lKDEpLCBub25lKSwgMSlcbiAqIGFzc2VydC5zdHJpY3RFcXVhbChPLmNvbXBhcmUoc29tZSgxKSwgc29tZSgyKSksIC0xKVxuICogYXNzZXJ0LnN0cmljdEVxdWFsKE8uY29tcGFyZShzb21lKDEpLCBzb21lKDEpKSwgMClcbiAqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciBnZXRPcmQgPSBmdW5jdGlvbiAoTykgeyByZXR1cm4gKHtcbiAgICBlcXVhbHM6IGdldEVxKE8pLmVxdWFscyxcbiAgICBjb21wYXJlOiBmdW5jdGlvbiAoeCwgeSkgeyByZXR1cm4gKHggPT09IHkgPyAwIDogaXNTb21lKHgpID8gKGlzU29tZSh5KSA/IE8uY29tcGFyZSh4LnZhbHVlLCB5LnZhbHVlKSA6IDEpIDogLTEpOyB9XG59KTsgfTtcbi8qKlxuICogTW9ub2lkIHJldHVybmluZyB0aGUgbGVmdC1tb3N0IG5vbi1gTm9uZWAgdmFsdWUuIElmIGJvdGggb3BlcmFuZHMgYXJlIGBTb21lYHMgdGhlbiB0aGUgaW5uZXIgdmFsdWVzIGFyZVxuICogY29uY2F0ZW5hdGVkIHVzaW5nIHRoZSBwcm92aWRlZCBgU2VtaWdyb3VwYFxuICpcbiAqIHwgeCAgICAgICB8IHkgICAgICAgfCBjb25jYXQoeCwgeSkgICAgICAgfFxuICogfCAtLS0tLS0tIHwgLS0tLS0tLSB8IC0tLS0tLS0tLS0tLS0tLS0tLSB8XG4gKiB8IG5vbmUgICAgfCBub25lICAgIHwgbm9uZSAgICAgICAgICAgICAgIHxcbiAqIHwgc29tZShhKSB8IG5vbmUgICAgfCBzb21lKGEpICAgICAgICAgICAgfFxuICogfCBub25lICAgIHwgc29tZShiKSB8IHNvbWUoYikgICAgICAgICAgICB8XG4gKiB8IHNvbWUoYSkgfCBzb21lKGIpIHwgc29tZShjb25jYXQoYSwgYikpIHxcbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgZ2V0TW9ub2lkLCBzb21lLCBub25lIH0gZnJvbSAnZnAtdHMvT3B0aW9uJ1xuICogaW1wb3J0IHsgU2VtaWdyb3VwU3VtIH0gZnJvbSAnZnAtdHMvbnVtYmVyJ1xuICpcbiAqIGNvbnN0IE0gPSBnZXRNb25vaWQoU2VtaWdyb3VwU3VtKVxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChNLmNvbmNhdChub25lLCBub25lKSwgbm9uZSlcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoTS5jb25jYXQoc29tZSgxKSwgbm9uZSksIHNvbWUoMSkpXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKE0uY29uY2F0KG5vbmUsIHNvbWUoMSkpLCBzb21lKDEpKVxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChNLmNvbmNhdChzb21lKDEpLCBzb21lKDIpKSwgc29tZSgzKSlcbiAqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciBnZXRNb25vaWQgPSBmdW5jdGlvbiAoUykgeyByZXR1cm4gKHtcbiAgICBjb25jYXQ6IGZ1bmN0aW9uICh4LCB5KSB7IHJldHVybiAoaXNOb25lKHgpID8geSA6IGlzTm9uZSh5KSA/IHggOiBzb21lKFMuY29uY2F0KHgudmFsdWUsIHkudmFsdWUpKSk7IH0sXG4gICAgZW1wdHk6IG5vbmVcbn0pOyB9O1xuLyoqXG4gKiBAY2F0ZWdvcnkgbWFwcGluZ1xuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgbWFwID0gZnVuY3Rpb24gKGYpIHsgcmV0dXJuIGZ1bmN0aW9uIChmYSkge1xuICAgIHJldHVybiBpc05vbmUoZmEpID8gbm9uZSA6IHNvbWUoZihmYS52YWx1ZSkpO1xufTsgfTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuNy4wXG4gKi9cbmV4cG9ydCB2YXIgRnVuY3RvciA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICBtYXA6IF9tYXBcbn07XG4vKipcbiAqIE1hcHMgdGhlIGBTb21lYCB2YWx1ZSBvZiB0aGlzIGBPcHRpb25gIHRvIHRoZSBzcGVjaWZpZWQgY29uc3RhbnQgdmFsdWUuXG4gKlxuICogQGNhdGVnb3J5IG1hcHBpbmdcbiAqIEBzaW5jZSAyLjE2LjBcbiAqL1xuZXhwb3J0IHZhciBhcyA9IGR1YWwoMiwgYXNfKEZ1bmN0b3IpKTtcbi8qKlxuICogTWFwcyB0aGUgYFNvbWVgIHZhbHVlIG9mIHRoaXMgYE9wdGlvbmAgdG8gdGhlIHZvaWQgY29uc3RhbnQgdmFsdWUuXG4gKlxuICogQGNhdGVnb3J5IG1hcHBpbmdcbiAqIEBzaW5jZSAyLjE2LjBcbiAqL1xuZXhwb3J0IHZhciBhc1VuaXQgPSBhc1VuaXRfKEZ1bmN0b3IpO1xuLyoqXG4gKiBAY2F0ZWdvcnkgY29uc3RydWN0b3JzXG4gKiBAc2luY2UgMi43LjBcbiAqL1xuZXhwb3J0IHZhciBvZiA9IHNvbWU7XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjEwLjBcbiAqL1xuZXhwb3J0IHZhciBQb2ludGVkID0ge1xuICAgIFVSSTogVVJJLFxuICAgIG9mOiBvZlxufTtcbi8qKlxuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgYXAgPSBmdW5jdGlvbiAoZmEpIHsgcmV0dXJuIGZ1bmN0aW9uIChmYWIpIHtcbiAgICByZXR1cm4gaXNOb25lKGZhYikgPyBub25lIDogaXNOb25lKGZhKSA/IG5vbmUgOiBzb21lKGZhYi52YWx1ZShmYS52YWx1ZSkpO1xufTsgfTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuMTAuMFxuICovXG5leHBvcnQgdmFyIEFwcGx5ID0ge1xuICAgIFVSSTogVVJJLFxuICAgIG1hcDogX21hcCxcbiAgICBhcDogX2FwXG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi43LjBcbiAqL1xuZXhwb3J0IHZhciBBcHBsaWNhdGl2ZSA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICBtYXA6IF9tYXAsXG4gICAgYXA6IF9hcCxcbiAgICBvZjogb2Zcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBzZXF1ZW5jaW5nXG4gKiBAc2luY2UgMi4xNC4wXG4gKi9cbmV4cG9ydCB2YXIgZmxhdE1hcCA9IC8qI19fUFVSRV9fKi8gZHVhbCgyLCBmdW5jdGlvbiAobWEsIGYpIHsgcmV0dXJuIChpc05vbmUobWEpID8gbm9uZSA6IGYobWEudmFsdWUpKTsgfSk7XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjEwLjBcbiAqL1xuZXhwb3J0IHZhciBDaGFpbiA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICBtYXA6IF9tYXAsXG4gICAgYXA6IF9hcCxcbiAgICBjaGFpbjogZmxhdE1hcFxufTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuNy4wXG4gKi9cbmV4cG9ydCB2YXIgTW9uYWQgPSB7XG4gICAgVVJJOiBVUkksXG4gICAgbWFwOiBfbWFwLFxuICAgIGFwOiBfYXAsXG4gICAgb2Y6IG9mLFxuICAgIGNoYWluOiBmbGF0TWFwXG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgZm9sZGluZ1xuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgcmVkdWNlID0gZnVuY3Rpb24gKGIsIGYpIHsgcmV0dXJuIGZ1bmN0aW9uIChmYSkge1xuICAgIHJldHVybiBpc05vbmUoZmEpID8gYiA6IGYoYiwgZmEudmFsdWUpO1xufTsgfTtcbi8qKlxuICogQGNhdGVnb3J5IGZvbGRpbmdcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIGZvbGRNYXAgPSBmdW5jdGlvbiAoTSkgeyByZXR1cm4gZnVuY3Rpb24gKGYpIHsgcmV0dXJuIGZ1bmN0aW9uIChmYSkge1xuICAgIHJldHVybiBpc05vbmUoZmEpID8gTS5lbXB0eSA6IGYoZmEudmFsdWUpO1xufTsgfTsgfTtcbi8qKlxuICogQGNhdGVnb3J5IGZvbGRpbmdcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIHJlZHVjZVJpZ2h0ID0gZnVuY3Rpb24gKGIsIGYpIHsgcmV0dXJuIGZ1bmN0aW9uIChmYSkge1xuICAgIHJldHVybiBpc05vbmUoZmEpID8gYiA6IGYoZmEudmFsdWUsIGIpO1xufTsgfTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuNy4wXG4gKi9cbmV4cG9ydCB2YXIgRm9sZGFibGUgPSB7XG4gICAgVVJJOiBVUkksXG4gICAgcmVkdWNlOiBfcmVkdWNlLFxuICAgIGZvbGRNYXA6IF9mb2xkTWFwLFxuICAgIHJlZHVjZVJpZ2h0OiBfcmVkdWNlUmlnaHRcbn07XG4vKipcbiAqIFJldHVybnMgdGhlIHByb3ZpZGVkIGBPcHRpb25gIGB0aGF0YCBpZiBgc2VsZmAgaXMgYE5vbmVgLCBvdGhlcndpc2UgcmV0dXJucyBgc2VsZmAuXG4gKlxuICogQHBhcmFtIHNlbGYgLSBUaGUgZmlyc3QgYE9wdGlvbmAgdG8gYmUgY2hlY2tlZC5cbiAqIEBwYXJhbSB0aGF0IC0gVGhlIGBPcHRpb25gIHRvIHJldHVybiBpZiBgc2VsZmAgaXMgYE5vbmVgLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgKiBhcyBPIGZyb20gXCJmcC10cy9PcHRpb25cIlxuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoTy5vckVsc2UoTy5ub25lLCAoKSA9PiBPLm5vbmUpLCBPLm5vbmUpXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKE8ub3JFbHNlKE8uc29tZSgxKSwgKCkgPT4gTy5ub25lKSwgTy5zb21lKDEpKVxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChPLm9yRWxzZShPLm5vbmUsICgpID0+IE8uc29tZSgnYicpKSwgTy5zb21lKCdiJykpXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKE8ub3JFbHNlKE8uc29tZSgxKSwgKCkgPT4gTy5zb21lKCdiJykpLCBPLnNvbWUoMSkpXG4gKlxuICogQGNhdGVnb3J5IGVycm9yIGhhbmRsaW5nXG4gKiBAc2luY2UgMi4xNi4wXG4gKi9cbmV4cG9ydCB2YXIgb3JFbHNlID0gZHVhbCgyLCBmdW5jdGlvbiAoc2VsZiwgdGhhdCkgeyByZXR1cm4gKGlzTm9uZShzZWxmKSA/IHRoYXQoKSA6IHNlbGYpOyB9KTtcbi8qKlxuICogQWxpYXMgb2YgYG9yRWxzZWAuXG4gKlxuICogTGVzcyBzdHJpY3QgdmVyc2lvbiBvZiBbYGFsdGBdKCNhbHQpLlxuICpcbiAqIFRoZSBgV2Agc3VmZml4IChzaG9ydCBmb3IgKipXKippZGVuaW5nKSBtZWFucyB0aGF0IHRoZSByZXR1cm4gdHlwZXMgd2lsbCBiZSBtZXJnZWQuXG4gKlxuICogQGNhdGVnb3J5IGxlZ2FjeVxuICogQHNpbmNlIDIuOS4wXG4gKi9cbmV4cG9ydCB2YXIgYWx0VyA9IG9yRWxzZTtcbi8qKlxuICogQWxpYXMgb2YgYG9yRWxzZWAuXG4gKlxuICogQGNhdGVnb3J5IGxlZ2FjeVxuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgYWx0ID0gb3JFbHNlO1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi43LjBcbiAqL1xuZXhwb3J0IHZhciBBbHQgPSB7XG4gICAgVVJJOiBVUkksXG4gICAgbWFwOiBfbWFwLFxuICAgIGFsdDogX2FsdFxufTtcbi8qKlxuICogQHNpbmNlIDIuNy4wXG4gKi9cbmV4cG9ydCB2YXIgemVybyA9IGZ1bmN0aW9uICgpIHsgcmV0dXJuIG5vbmU7IH07XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjExLjBcbiAqL1xuZXhwb3J0IHZhciBaZXJvID0ge1xuICAgIFVSSTogVVJJLFxuICAgIHplcm86IHplcm9cbn07XG4vKipcbiAqIEBjYXRlZ29yeSBkbyBub3RhdGlvblxuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIGd1YXJkID0gLyojX19QVVJFX18qLyBndWFyZF8oWmVybywgUG9pbnRlZCk7XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjcuMFxuICovXG5leHBvcnQgdmFyIEFsdGVybmF0aXZlID0ge1xuICAgIFVSSTogVVJJLFxuICAgIG1hcDogX21hcCxcbiAgICBhcDogX2FwLFxuICAgIG9mOiBvZixcbiAgICBhbHQ6IF9hbHQsXG4gICAgemVybzogemVyb1xufTtcbi8qKlxuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgZXh0ZW5kID0gZnVuY3Rpb24gKGYpIHsgcmV0dXJuIGZ1bmN0aW9uICh3YSkge1xuICAgIHJldHVybiBpc05vbmUod2EpID8gbm9uZSA6IHNvbWUoZih3YSkpO1xufTsgfTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuNy4wXG4gKi9cbmV4cG9ydCB2YXIgRXh0ZW5kID0ge1xuICAgIFVSSTogVVJJLFxuICAgIG1hcDogX21hcCxcbiAgICBleHRlbmQ6IF9leHRlbmRcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBmaWx0ZXJpbmdcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIGNvbXBhY3QgPSAvKiNfX1BVUkVfXyovIGZsYXRNYXAoaWRlbnRpdHkpO1xudmFyIGRlZmF1bHRTZXBhcmF0ZWQgPSAvKiNfX1BVUkVfXyovIHNlcGFyYXRlZChub25lLCBub25lKTtcbi8qKlxuICogQGNhdGVnb3J5IGZpbHRlcmluZ1xuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgc2VwYXJhdGUgPSBmdW5jdGlvbiAobWEpIHtcbiAgICByZXR1cm4gaXNOb25lKG1hKSA/IGRlZmF1bHRTZXBhcmF0ZWQgOiBzZXBhcmF0ZWQoZ2V0TGVmdChtYS52YWx1ZSksIGdldFJpZ2h0KG1hLnZhbHVlKSk7XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi43LjBcbiAqL1xuZXhwb3J0IHZhciBDb21wYWN0YWJsZSA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICBjb21wYWN0OiBjb21wYWN0LFxuICAgIHNlcGFyYXRlOiBzZXBhcmF0ZVxufTtcbi8qKlxuICogQGNhdGVnb3J5IGZpbHRlcmluZ1xuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgZmlsdGVyID0gZnVuY3Rpb24gKHByZWRpY2F0ZSkge1xuICAgIHJldHVybiBmdW5jdGlvbiAoZmEpIHtcbiAgICAgICAgcmV0dXJuIGlzTm9uZShmYSkgPyBub25lIDogcHJlZGljYXRlKGZhLnZhbHVlKSA/IGZhIDogbm9uZTtcbiAgICB9O1xufTtcbi8qKlxuICogQGNhdGVnb3J5IGZpbHRlcmluZ1xuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgZmlsdGVyTWFwID0gZnVuY3Rpb24gKGYpIHsgcmV0dXJuIGZ1bmN0aW9uIChmYSkge1xuICAgIHJldHVybiBpc05vbmUoZmEpID8gbm9uZSA6IGYoZmEudmFsdWUpO1xufTsgfTtcbi8qKlxuICogQGNhdGVnb3J5IGZpbHRlcmluZ1xuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgcGFydGl0aW9uID0gZnVuY3Rpb24gKHByZWRpY2F0ZSkge1xuICAgIHJldHVybiBmdW5jdGlvbiAoZmEpIHtcbiAgICAgICAgcmV0dXJuIHNlcGFyYXRlZChfZmlsdGVyKGZhLCBub3QocHJlZGljYXRlKSksIF9maWx0ZXIoZmEsIHByZWRpY2F0ZSkpO1xuICAgIH07XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgZmlsdGVyaW5nXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciBwYXJ0aXRpb25NYXAgPSBmdW5jdGlvbiAoZikgeyByZXR1cm4gZmxvdyhtYXAoZiksIHNlcGFyYXRlKTsgfTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuNy4wXG4gKi9cbmV4cG9ydCB2YXIgRmlsdGVyYWJsZSA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICBtYXA6IF9tYXAsXG4gICAgY29tcGFjdDogY29tcGFjdCxcbiAgICBzZXBhcmF0ZTogc2VwYXJhdGUsXG4gICAgZmlsdGVyOiBfZmlsdGVyLFxuICAgIGZpbHRlck1hcDogX2ZpbHRlck1hcCxcbiAgICBwYXJ0aXRpb246IF9wYXJ0aXRpb24sXG4gICAgcGFydGl0aW9uTWFwOiBfcGFydGl0aW9uTWFwXG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgdHJhdmVyc2luZ1xuICogQHNpbmNlIDIuNi4zXG4gKi9cbmV4cG9ydCB2YXIgdHJhdmVyc2UgPSBmdW5jdGlvbiAoRikge1xuICAgIHJldHVybiBmdW5jdGlvbiAoZikge1xuICAgICAgICByZXR1cm4gZnVuY3Rpb24gKHRhKSB7XG4gICAgICAgICAgICByZXR1cm4gaXNOb25lKHRhKSA/IEYub2Yobm9uZSkgOiBGLm1hcChmKHRhLnZhbHVlKSwgc29tZSk7XG4gICAgICAgIH07XG4gICAgfTtcbn07XG4vKipcbiAqIEBjYXRlZ29yeSB0cmF2ZXJzaW5nXG4gKiBAc2luY2UgMi42LjNcbiAqL1xuZXhwb3J0IHZhciBzZXF1ZW5jZSA9IGZ1bmN0aW9uIChGKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uICh0YSkge1xuICAgICAgICByZXR1cm4gaXNOb25lKHRhKSA/IEYub2Yobm9uZSkgOiBGLm1hcCh0YS52YWx1ZSwgc29tZSk7XG4gICAgfTtcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjcuMFxuICovXG5leHBvcnQgdmFyIFRyYXZlcnNhYmxlID0ge1xuICAgIFVSSTogVVJJLFxuICAgIG1hcDogX21hcCxcbiAgICByZWR1Y2U6IF9yZWR1Y2UsXG4gICAgZm9sZE1hcDogX2ZvbGRNYXAsXG4gICAgcmVkdWNlUmlnaHQ6IF9yZWR1Y2VSaWdodCxcbiAgICB0cmF2ZXJzZTogX3RyYXZlcnNlLFxuICAgIHNlcXVlbmNlOiBzZXF1ZW5jZVxufTtcbnZhciBfd2l0aGVyID0gLyojX19QVVJFX18qLyB3aXRoZXJEZWZhdWx0KFRyYXZlcnNhYmxlLCBDb21wYWN0YWJsZSk7XG52YXIgX3dpbHQgPSAvKiNfX1BVUkVfXyovIHdpbHREZWZhdWx0KFRyYXZlcnNhYmxlLCBDb21wYWN0YWJsZSk7XG4vKipcbiAqIEBjYXRlZ29yeSBmaWx0ZXJpbmdcbiAqIEBzaW5jZSAyLjYuNVxuICovXG5leHBvcnQgdmFyIHdpdGhlciA9IGZ1bmN0aW9uIChGKSB7XG4gICAgdmFyIF93aXRoZXJGID0gX3dpdGhlcihGKTtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGYpIHsgcmV0dXJuIGZ1bmN0aW9uIChmYSkgeyByZXR1cm4gX3dpdGhlckYoZmEsIGYpOyB9OyB9O1xufTtcbi8qKlxuICogQGNhdGVnb3J5IGZpbHRlcmluZ1xuICogQHNpbmNlIDIuNi41XG4gKi9cbmV4cG9ydCB2YXIgd2lsdCA9IGZ1bmN0aW9uIChGKSB7XG4gICAgdmFyIF93aWx0RiA9IF93aWx0KEYpO1xuICAgIHJldHVybiBmdW5jdGlvbiAoZikgeyByZXR1cm4gZnVuY3Rpb24gKGZhKSB7IHJldHVybiBfd2lsdEYoZmEsIGYpOyB9OyB9O1xufTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuNy4wXG4gKi9cbmV4cG9ydCB2YXIgV2l0aGVyYWJsZSA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICBtYXA6IF9tYXAsXG4gICAgcmVkdWNlOiBfcmVkdWNlLFxuICAgIGZvbGRNYXA6IF9mb2xkTWFwLFxuICAgIHJlZHVjZVJpZ2h0OiBfcmVkdWNlUmlnaHQsXG4gICAgdHJhdmVyc2U6IF90cmF2ZXJzZSxcbiAgICBzZXF1ZW5jZTogc2VxdWVuY2UsXG4gICAgY29tcGFjdDogY29tcGFjdCxcbiAgICBzZXBhcmF0ZTogc2VwYXJhdGUsXG4gICAgZmlsdGVyOiBfZmlsdGVyLFxuICAgIGZpbHRlck1hcDogX2ZpbHRlck1hcCxcbiAgICBwYXJ0aXRpb246IF9wYXJ0aXRpb24sXG4gICAgcGFydGl0aW9uTWFwOiBfcGFydGl0aW9uTWFwLFxuICAgIHdpdGhlcjogX3dpdGhlcixcbiAgICB3aWx0OiBfd2lsdFxufTtcbi8qKlxuICogQHNpbmNlIDIuNy4wXG4gKi9cbmV4cG9ydCB2YXIgdGhyb3dFcnJvciA9IGZ1bmN0aW9uICgpIHsgcmV0dXJuIG5vbmU7IH07XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjcuMFxuICovXG5leHBvcnQgdmFyIE1vbmFkVGhyb3cgPSB7XG4gICAgVVJJOiBVUkksXG4gICAgbWFwOiBfbWFwLFxuICAgIGFwOiBfYXAsXG4gICAgb2Y6IG9mLFxuICAgIGNoYWluOiBmbGF0TWFwLFxuICAgIHRocm93RXJyb3I6IHRocm93RXJyb3Jcbn07XG4vKipcbiAqIFRyYW5zZm9ybXMgYW4gYEVpdGhlcmAgdG8gYW4gYE9wdGlvbmAgZGlzY2FyZGluZyB0aGUgZXJyb3IuXG4gKlxuICogQWxpYXMgb2YgW2dldFJpZ2h0XSgjZ2V0cmlnaHQpXG4gKlxuICogQGNhdGVnb3J5IGNvbnZlcnNpb25zXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciBmcm9tRWl0aGVyID0gZ2V0UmlnaHQ7XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjExLjBcbiAqL1xuZXhwb3J0IHZhciBGcm9tRWl0aGVyID0ge1xuICAgIFVSSTogVVJJLFxuICAgIGZyb21FaXRoZXI6IGZyb21FaXRoZXJcbn07XG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vLyByZWZpbmVtZW50c1xuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLyoqXG4gKiBSZXR1cm5zIGB0cnVlYCBpZiB0aGUgb3B0aW9uIGlzIGFuIGluc3RhbmNlIG9mIGBTb21lYCwgYGZhbHNlYCBvdGhlcndpc2UuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IHNvbWUsIG5vbmUsIGlzU29tZSB9IGZyb20gJ2ZwLXRzL09wdGlvbidcbiAqXG4gKiBhc3NlcnQuc3RyaWN0RXF1YWwoaXNTb21lKHNvbWUoMSkpLCB0cnVlKVxuICogYXNzZXJ0LnN0cmljdEVxdWFsKGlzU29tZShub25lKSwgZmFsc2UpXG4gKlxuICogQGNhdGVnb3J5IHJlZmluZW1lbnRzXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciBpc1NvbWUgPSBfLmlzU29tZTtcbi8qKlxuICogUmV0dXJucyBgdHJ1ZWAgaWYgdGhlIG9wdGlvbiBpcyBgTm9uZWAsIGBmYWxzZWAgb3RoZXJ3aXNlLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBzb21lLCBub25lLCBpc05vbmUgfSBmcm9tICdmcC10cy9PcHRpb24nXG4gKlxuICogYXNzZXJ0LnN0cmljdEVxdWFsKGlzTm9uZShzb21lKDEpKSwgZmFsc2UpXG4gKiBhc3NlcnQuc3RyaWN0RXF1YWwoaXNOb25lKG5vbmUpLCB0cnVlKVxuICpcbiAqIEBjYXRlZ29yeSByZWZpbmVtZW50c1xuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgaXNOb25lID0gZnVuY3Rpb24gKGZhKSB7IHJldHVybiBmYS5fdGFnID09PSAnTm9uZSc7IH07XG4vKipcbiAqIExlc3Mgc3RyaWN0IHZlcnNpb24gb2YgW2BtYXRjaGBdKCNtYXRjaCkuXG4gKlxuICogVGhlIGBXYCBzdWZmaXggKHNob3J0IGZvciAqKlcqKmlkZW5pbmcpIG1lYW5zIHRoYXQgdGhlIGhhbmRsZXIgcmV0dXJuIHR5cGVzIHdpbGwgYmUgbWVyZ2VkLlxuICpcbiAqIEBjYXRlZ29yeSBwYXR0ZXJuIG1hdGNoaW5nXG4gKiBAc2luY2UgMi4xMC4wXG4gKi9cbmV4cG9ydCB2YXIgbWF0Y2hXID0gZnVuY3Rpb24gKG9uTm9uZSwgb25Tb21lKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChtYSkge1xuICAgICAgICByZXR1cm4gaXNOb25lKG1hKSA/IG9uTm9uZSgpIDogb25Tb21lKG1hLnZhbHVlKTtcbiAgICB9O1xufTtcbi8qKlxuICogQWxpYXMgb2YgW2BtYXRjaFdgXSgjbWF0Y2h3KS5cbiAqXG4gKiBAY2F0ZWdvcnkgcGF0dGVybiBtYXRjaGluZ1xuICogQHNpbmNlIDIuMTAuMFxuICovXG5leHBvcnQgdmFyIGZvbGRXID0gbWF0Y2hXO1xuLyoqXG4gKiBUYWtlcyBhIChsYXp5KSBkZWZhdWx0IHZhbHVlLCBhIGZ1bmN0aW9uLCBhbmQgYW4gYE9wdGlvbmAgdmFsdWUsIGlmIHRoZSBgT3B0aW9uYCB2YWx1ZSBpcyBgTm9uZWAgdGhlIGRlZmF1bHQgdmFsdWUgaXNcbiAqIHJldHVybmVkLCBvdGhlcndpc2UgdGhlIGZ1bmN0aW9uIGlzIGFwcGxpZWQgdG8gdGhlIHZhbHVlIGluc2lkZSB0aGUgYFNvbWVgIGFuZCB0aGUgcmVzdWx0IGlzIHJldHVybmVkLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBzb21lLCBub25lLCBtYXRjaCB9IGZyb20gJ2ZwLXRzL09wdGlvbidcbiAqIGltcG9ydCB7IHBpcGUgfSBmcm9tICdmcC10cy9mdW5jdGlvbidcbiAqXG4gKiBhc3NlcnQuc3RyaWN0RXF1YWwoXG4gKiAgIHBpcGUoXG4gKiAgICAgc29tZSgxKSxcbiAqICAgICBtYXRjaCgoKSA9PiAnYSBub25lJywgYSA9PiBgYSBzb21lIGNvbnRhaW5pbmcgJHthfWApXG4gKiAgICksXG4gKiAgICdhIHNvbWUgY29udGFpbmluZyAxJ1xuICogKVxuICpcbiAqIGFzc2VydC5zdHJpY3RFcXVhbChcbiAqICAgcGlwZShcbiAqICAgICBub25lLFxuICogICAgIG1hdGNoKCgpID0+ICdhIG5vbmUnLCBhID0+IGBhIHNvbWUgY29udGFpbmluZyAke2F9YClcbiAqICAgKSxcbiAqICAgJ2Egbm9uZSdcbiAqIClcbiAqXG4gKiBAY2F0ZWdvcnkgcGF0dGVybiBtYXRjaGluZ1xuICogQHNpbmNlIDIuMTAuMFxuICovXG5leHBvcnQgdmFyIG1hdGNoID0gbWF0Y2hXO1xuLyoqXG4gKiBBbGlhcyBvZiBbYG1hdGNoYF0oI21hdGNoKS5cbiAqXG4gKiBAY2F0ZWdvcnkgcGF0dGVybiBtYXRjaGluZ1xuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgZm9sZCA9IG1hdGNoO1xuLyoqXG4gKiBMZXNzIHN0cmljdCB2ZXJzaW9uIG9mIFtgZ2V0T3JFbHNlYF0oI2dldG9yZWxzZSkuXG4gKlxuICogVGhlIGBXYCBzdWZmaXggKHNob3J0IGZvciAqKlcqKmlkZW5pbmcpIG1lYW5zIHRoYXQgdGhlIGhhbmRsZXIgcmV0dXJuIHR5cGUgd2lsbCBiZSBtZXJnZWQuXG4gKlxuICogQGNhdGVnb3J5IGVycm9yIGhhbmRsaW5nXG4gKiBAc2luY2UgMi42LjBcbiAqL1xuZXhwb3J0IHZhciBnZXRPckVsc2VXID0gZnVuY3Rpb24gKG9uTm9uZSkge1xuICAgIHJldHVybiBmdW5jdGlvbiAobWEpIHtcbiAgICAgICAgcmV0dXJuIGlzTm9uZShtYSkgPyBvbk5vbmUoKSA6IG1hLnZhbHVlO1xuICAgIH07XG59O1xuLyoqXG4gKiBFeHRyYWN0cyB0aGUgdmFsdWUgb3V0IG9mIHRoZSBzdHJ1Y3R1cmUsIGlmIGl0IGV4aXN0cy4gT3RoZXJ3aXNlIHJldHVybnMgdGhlIGdpdmVuIGRlZmF1bHQgdmFsdWVcbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgc29tZSwgbm9uZSwgZ2V0T3JFbHNlIH0gZnJvbSAnZnAtdHMvT3B0aW9uJ1xuICogaW1wb3J0IHsgcGlwZSB9IGZyb20gJ2ZwLXRzL2Z1bmN0aW9uJ1xuICpcbiAqIGFzc2VydC5zdHJpY3RFcXVhbChcbiAqICAgcGlwZShcbiAqICAgICBzb21lKDEpLFxuICogICAgIGdldE9yRWxzZSgoKSA9PiAwKVxuICogICApLFxuICogICAxXG4gKiApXG4gKiBhc3NlcnQuc3RyaWN0RXF1YWwoXG4gKiAgIHBpcGUoXG4gKiAgICAgbm9uZSxcbiAqICAgICBnZXRPckVsc2UoKCkgPT4gMClcbiAqICAgKSxcbiAqICAgMFxuICogKVxuICpcbiAqIEBjYXRlZ29yeSBlcnJvciBoYW5kbGluZ1xuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgZ2V0T3JFbHNlID0gZ2V0T3JFbHNlVztcbi8qKlxuICogQGNhdGVnb3J5IG1hcHBpbmdcbiAqIEBzaW5jZSAyLjEwLjBcbiAqL1xuZXhwb3J0IHZhciBmbGFwID0gLyojX19QVVJFX18qLyBmbGFwXyhGdW5jdG9yKTtcbi8qKlxuICogQ29tYmluZSB0d28gZWZmZWN0ZnVsIGFjdGlvbnMsIGtlZXBpbmcgb25seSB0aGUgcmVzdWx0IG9mIHRoZSBmaXJzdC5cbiAqXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciBhcEZpcnN0ID0gLyojX19QVVJFX18qLyBhcEZpcnN0XyhBcHBseSk7XG4vKipcbiAqIENvbWJpbmUgdHdvIGVmZmVjdGZ1bCBhY3Rpb25zLCBrZWVwaW5nIG9ubHkgdGhlIHJlc3VsdCBvZiB0aGUgc2Vjb25kLlxuICpcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIGFwU2Vjb25kID0gLyojX19QVVJFX18qLyBhcFNlY29uZF8oQXBwbHkpO1xuLyoqXG4gKiBAY2F0ZWdvcnkgc2VxdWVuY2luZ1xuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgZmxhdHRlbiA9IGNvbXBhY3Q7XG4vKipcbiAqIENvbXBvc2VzIGNvbXB1dGF0aW9ucyBpbiBzZXF1ZW5jZSwgdXNpbmcgdGhlIHJldHVybiB2YWx1ZSBvZiBvbmUgY29tcHV0YXRpb24gdG8gZGV0ZXJtaW5lIHRoZSBuZXh0IGNvbXB1dGF0aW9uIGFuZFxuICoga2VlcGluZyBvbmx5IHRoZSByZXN1bHQgb2YgdGhlIGZpcnN0LlxuICpcbiAqIEBjYXRlZ29yeSBjb21iaW5hdG9yc1xuICogQHNpbmNlIDIuMTUuMFxuICovXG5leHBvcnQgdmFyIHRhcCA9IC8qI19fUFVSRV9fKi8gZHVhbCgyLCBjaGFpbmFibGUudGFwKENoYWluKSk7XG4vKipcbiAqIENvbXBvc2VzIGNvbXB1dGF0aW9ucyBpbiBzZXF1ZW5jZSwgdXNpbmcgdGhlIHJldHVybiB2YWx1ZSBvZiBvbmUgY29tcHV0YXRpb24gdG8gZGV0ZXJtaW5lIHRoZSBuZXh0IGNvbXB1dGF0aW9uIGFuZFxuICoga2VlcGluZyBvbmx5IHRoZSByZXN1bHQgb2YgdGhlIGZpcnN0LlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBwaXBlIH0gZnJvbSAnZnAtdHMvZnVuY3Rpb24nXG4gKiBpbXBvcnQgKiBhcyBPIGZyb20gJ2ZwLXRzL09wdGlvbidcbiAqIGltcG9ydCAqIGFzIEUgZnJvbSAnZnAtdHMvRWl0aGVyJ1xuICpcbiAqIGNvbnN0IGNvbXB1dGUgPSAodmFsdWU6IG51bWJlcikgPT4gcGlwZShcbiAqICAgTy5vZih2YWx1ZSksXG4gKiAgIE8udGFwRWl0aGVyKCh2YWx1ZSkgPT4gdmFsdWUgPiAwID8gRS5yaWdodCgnb2snKSA6IEUubGVmdCgnZXJyb3InKSksXG4gKiApXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChjb21wdXRlKDEpLCBPLm9mKDEpKVxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChjb21wdXRlKC00MiksIE8ubm9uZSlcbiAqXG4gKiBAY2F0ZWdvcnkgY29tYmluYXRvcnNcbiAqIEBzaW5jZSAyLjE2LjBcbiAqL1xuZXhwb3J0IHZhciB0YXBFaXRoZXIgPSAvKiNfX1BVUkVfXyovIGR1YWwoMiwgdGFwRWl0aGVyXyhGcm9tRWl0aGVyLCBDaGFpbikpO1xuLyoqXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciBkdXBsaWNhdGUgPSAvKiNfX1BVUkVfXyovIGV4dGVuZChpZGVudGl0eSk7XG4vKipcbiAqIEBjYXRlZ29yeSBsaWZ0aW5nXG4gKiBAc2luY2UgMi4xMS4wXG4gKi9cbmV4cG9ydCB2YXIgZnJvbUVpdGhlcksgPSAvKiNfX1BVUkVfXyovIGZyb21FaXRoZXJLXyhGcm9tRWl0aGVyKTtcbi8qKlxuICogQGNhdGVnb3J5IHNlcXVlbmNpbmdcbiAqIEBzaW5jZSAyLjExLjBcbiAqL1xuZXhwb3J0IHZhciBjaGFpbkVpdGhlcksgPSBcbi8qI19fUFVSRV9fKi8gY2hhaW5FaXRoZXJLXyhGcm9tRWl0aGVyLCBDaGFpbik7XG4vKipcbiAqIEFsaWFzIG9mIGB0YXBFaXRoZXJgLlxuICpcbiAqIEBjYXRlZ29yeSBsZWdhY3lcbiAqIEBzaW5jZSAyLjEyLjBcbiAqL1xuZXhwb3J0IHZhciBjaGFpbkZpcnN0RWl0aGVySyA9IHRhcEVpdGhlcjtcbi8qKlxuICogQ29uc3RydWN0cyBhIG5ldyBgT3B0aW9uYCBmcm9tIGEgbnVsbGFibGUgdHlwZS4gSWYgdGhlIHZhbHVlIGlzIGBudWxsYCBvciBgdW5kZWZpbmVkYCwgcmV0dXJucyBgTm9uZWAsIG90aGVyd2lzZVxuICogcmV0dXJucyB0aGUgdmFsdWUgd3JhcHBlZCBpbiBhIGBTb21lYC5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgbm9uZSwgc29tZSwgZnJvbU51bGxhYmxlIH0gZnJvbSAnZnAtdHMvT3B0aW9uJ1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoZnJvbU51bGxhYmxlKHVuZGVmaW5lZCksIG5vbmUpXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKGZyb21OdWxsYWJsZShudWxsKSwgbm9uZSlcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoZnJvbU51bGxhYmxlKDEpLCBzb21lKDEpKVxuICpcbiAqIEBjYXRlZ29yeSBjb252ZXJzaW9uc1xuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgZnJvbU51bGxhYmxlID0gZnVuY3Rpb24gKGEpIHsgcmV0dXJuIChhID09IG51bGwgPyBub25lIDogc29tZShhKSk7IH07XG4vKipcbiAqIFRyYW5zZm9ybXMgYW4gZXhjZXB0aW9uIGludG8gYW4gYE9wdGlvbmAuIElmIGBmYCB0aHJvd3MsIHJldHVybnMgYE5vbmVgLCBvdGhlcndpc2UgcmV0dXJucyB0aGUgb3V0cHV0IHdyYXBwZWQgaW4gYVxuICogYFNvbWVgLlxuICpcbiAqIFNlZSBhbHNvIFtgdHJ5Q2F0Y2hLYF0oI3RyeWNhdGNoaykuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IG5vbmUsIHNvbWUsIHRyeUNhdGNoIH0gZnJvbSAnZnAtdHMvT3B0aW9uJ1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoXG4gKiAgIHRyeUNhdGNoKCgpID0+IHtcbiAqICAgICB0aHJvdyBuZXcgRXJyb3IoKVxuICogICB9KSxcbiAqICAgbm9uZVxuICogKVxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbCh0cnlDYXRjaCgoKSA9PiAxKSwgc29tZSgxKSlcbiAqXG4gKiBAY2F0ZWdvcnkgaW50ZXJvcFxuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgdHJ5Q2F0Y2ggPSBmdW5jdGlvbiAoZikge1xuICAgIHRyeSB7XG4gICAgICAgIHJldHVybiBzb21lKGYoKSk7XG4gICAgfVxuICAgIGNhdGNoIChlKSB7XG4gICAgICAgIHJldHVybiBub25lO1xuICAgIH1cbn07XG4vKipcbiAqIENvbnZlcnRzIGEgZnVuY3Rpb24gdGhhdCBtYXkgdGhyb3cgdG8gb25lIHJldHVybmluZyBhIGBPcHRpb25gLlxuICpcbiAqIEBjYXRlZ29yeSBpbnRlcm9wXG4gKiBAc2luY2UgMi4xMC4wXG4gKi9cbmV4cG9ydCB2YXIgdHJ5Q2F0Y2hLID0gZnVuY3Rpb24gKGYpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgYSA9IFtdO1xuICAgICAgICBmb3IgKHZhciBfaSA9IDA7IF9pIDwgYXJndW1lbnRzLmxlbmd0aDsgX2krKykge1xuICAgICAgICAgICAgYVtfaV0gPSBhcmd1bWVudHNbX2ldO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0cnlDYXRjaChmdW5jdGlvbiAoKSB7IHJldHVybiBmLmFwcGx5KHZvaWQgMCwgYSk7IH0pO1xuICAgIH07XG59O1xuLyoqXG4gKiBSZXR1cm5zIGEgKnNtYXJ0IGNvbnN0cnVjdG9yKiBmcm9tIGEgZnVuY3Rpb24gdGhhdCByZXR1cm5zIGEgbnVsbGFibGUgdmFsdWUuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IGZyb21OdWxsYWJsZUssIG5vbmUsIHNvbWUgfSBmcm9tICdmcC10cy9PcHRpb24nXG4gKlxuICogY29uc3QgZiA9IChzOiBzdHJpbmcpOiBudW1iZXIgfCB1bmRlZmluZWQgPT4ge1xuICogICBjb25zdCBuID0gcGFyc2VGbG9hdChzKVxuICogICByZXR1cm4gaXNOYU4obikgPyB1bmRlZmluZWQgOiBuXG4gKiB9XG4gKlxuICogY29uc3QgZyA9IGZyb21OdWxsYWJsZUsoZilcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKGcoJzEnKSwgc29tZSgxKSlcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoZygnYScpLCBub25lKVxuICpcbiAqIEBjYXRlZ29yeSBsaWZ0aW5nXG4gKiBAc2luY2UgMi45LjBcbiAqL1xuZXhwb3J0IHZhciBmcm9tTnVsbGFibGVLID0gZnVuY3Rpb24gKGYpIHsgcmV0dXJuIGZsb3coZiwgZnJvbU51bGxhYmxlKTsgfTtcbi8qKlxuICogVGhpcyBpcyBgY2hhaW5gICsgYGZyb21OdWxsYWJsZWAsIHVzZWZ1bCB3aGVuIHdvcmtpbmcgd2l0aCBvcHRpb25hbCB2YWx1ZXMuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IHNvbWUsIG5vbmUsIGZyb21OdWxsYWJsZSwgY2hhaW5OdWxsYWJsZUsgfSBmcm9tICdmcC10cy9PcHRpb24nXG4gKiBpbXBvcnQgeyBwaXBlIH0gZnJvbSAnZnAtdHMvZnVuY3Rpb24nXG4gKlxuICogaW50ZXJmYWNlIEVtcGxveWVlIHtcbiAqICAgcmVhZG9ubHkgY29tcGFueT86IHtcbiAqICAgICByZWFkb25seSBhZGRyZXNzPzoge1xuICogICAgICAgcmVhZG9ubHkgc3RyZWV0Pzoge1xuICogICAgICAgICByZWFkb25seSBuYW1lPzogc3RyaW5nXG4gKiAgICAgICB9XG4gKiAgICAgfVxuICogICB9XG4gKiB9XG4gKlxuICogY29uc3QgZW1wbG95ZWUxOiBFbXBsb3llZSA9IHsgY29tcGFueTogeyBhZGRyZXNzOiB7IHN0cmVldDogeyBuYW1lOiAnaGlnaCBzdHJlZXQnIH0gfSB9IH1cbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKFxuICogICBwaXBlKFxuICogICAgIGZyb21OdWxsYWJsZShlbXBsb3llZTEuY29tcGFueSksXG4gKiAgICAgY2hhaW5OdWxsYWJsZUsoY29tcGFueSA9PiBjb21wYW55LmFkZHJlc3MpLFxuICogICAgIGNoYWluTnVsbGFibGVLKGFkZHJlc3MgPT4gYWRkcmVzcy5zdHJlZXQpLFxuICogICAgIGNoYWluTnVsbGFibGVLKHN0cmVldCA9PiBzdHJlZXQubmFtZSlcbiAqICAgKSxcbiAqICAgc29tZSgnaGlnaCBzdHJlZXQnKVxuICogKVxuICpcbiAqIGNvbnN0IGVtcGxveWVlMjogRW1wbG95ZWUgPSB7IGNvbXBhbnk6IHsgYWRkcmVzczogeyBzdHJlZXQ6IHt9IH0gfSB9XG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChcbiAqICAgcGlwZShcbiAqICAgICBmcm9tTnVsbGFibGUoZW1wbG95ZWUyLmNvbXBhbnkpLFxuICogICAgIGNoYWluTnVsbGFibGVLKGNvbXBhbnkgPT4gY29tcGFueS5hZGRyZXNzKSxcbiAqICAgICBjaGFpbk51bGxhYmxlSyhhZGRyZXNzID0+IGFkZHJlc3Muc3RyZWV0KSxcbiAqICAgICBjaGFpbk51bGxhYmxlSyhzdHJlZXQgPT4gc3RyZWV0Lm5hbWUpXG4gKiAgICksXG4gKiAgIG5vbmVcbiAqIClcbiAqXG4gKiBAY2F0ZWdvcnkgc2VxdWVuY2luZ1xuICogQHNpbmNlIDIuOS4wXG4gKi9cbmV4cG9ydCB2YXIgY2hhaW5OdWxsYWJsZUsgPSBmdW5jdGlvbiAoZikge1xuICAgIHJldHVybiBmdW5jdGlvbiAobWEpIHtcbiAgICAgICAgcmV0dXJuIGlzTm9uZShtYSkgPyBub25lIDogZnJvbU51bGxhYmxlKGYobWEudmFsdWUpKTtcbiAgICB9O1xufTtcbi8qKlxuICogRXh0cmFjdHMgdGhlIHZhbHVlIG91dCBvZiB0aGUgc3RydWN0dXJlLCBpZiBpdCBleGlzdHMuIE90aGVyd2lzZSByZXR1cm5zIGBudWxsYC5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgc29tZSwgbm9uZSwgdG9OdWxsYWJsZSB9IGZyb20gJ2ZwLXRzL09wdGlvbidcbiAqIGltcG9ydCB7IHBpcGUgfSBmcm9tICdmcC10cy9mdW5jdGlvbidcbiAqXG4gKiBhc3NlcnQuc3RyaWN0RXF1YWwoXG4gKiAgIHBpcGUoXG4gKiAgICAgc29tZSgxKSxcbiAqICAgICB0b051bGxhYmxlXG4gKiAgICksXG4gKiAgIDFcbiAqIClcbiAqIGFzc2VydC5zdHJpY3RFcXVhbChcbiAqICAgcGlwZShcbiAqICAgICBub25lLFxuICogICAgIHRvTnVsbGFibGVcbiAqICAgKSxcbiAqICAgbnVsbFxuICogKVxuICpcbiAqIEBjYXRlZ29yeSBjb252ZXJzaW9uc1xuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgdG9OdWxsYWJsZSA9IC8qI19fUFVSRV9fKi8gbWF0Y2goY29uc3ROdWxsLCBpZGVudGl0eSk7XG4vKipcbiAqIEV4dHJhY3RzIHRoZSB2YWx1ZSBvdXQgb2YgdGhlIHN0cnVjdHVyZSwgaWYgaXQgZXhpc3RzLiBPdGhlcndpc2UgcmV0dXJucyBgdW5kZWZpbmVkYC5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgc29tZSwgbm9uZSwgdG9VbmRlZmluZWQgfSBmcm9tICdmcC10cy9PcHRpb24nXG4gKiBpbXBvcnQgeyBwaXBlIH0gZnJvbSAnZnAtdHMvZnVuY3Rpb24nXG4gKlxuICogYXNzZXJ0LnN0cmljdEVxdWFsKFxuICogICBwaXBlKFxuICogICAgIHNvbWUoMSksXG4gKiAgICAgdG9VbmRlZmluZWRcbiAqICAgKSxcbiAqICAgMVxuICogKVxuICogYXNzZXJ0LnN0cmljdEVxdWFsKFxuICogICBwaXBlKFxuICogICAgIG5vbmUsXG4gKiAgICAgdG9VbmRlZmluZWRcbiAqICAgKSxcbiAqICAgdW5kZWZpbmVkXG4gKiApXG4gKlxuICogQGNhdGVnb3J5IGNvbnZlcnNpb25zXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciB0b1VuZGVmaW5lZCA9IC8qI19fUFVSRV9fKi8gbWF0Y2goY29uc3RVbmRlZmluZWQsIGlkZW50aXR5KTtcbmV4cG9ydCBmdW5jdGlvbiBlbGVtKEUpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGEsIG1hKSB7XG4gICAgICAgIGlmIChtYSA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICB2YXIgZWxlbUVfMSA9IGVsZW0oRSk7XG4gICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24gKG1hKSB7IHJldHVybiBlbGVtRV8xKGEsIG1hKTsgfTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gaXNOb25lKG1hKSA/IGZhbHNlIDogRS5lcXVhbHMoYSwgbWEudmFsdWUpO1xuICAgIH07XG59XG4vKipcbiAqIFJldHVybnMgYHRydWVgIGlmIHRoZSBwcmVkaWNhdGUgaXMgc2F0aXNmaWVkIGJ5IHRoZSB3cmFwcGVkIHZhbHVlXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IHNvbWUsIG5vbmUsIGV4aXN0cyB9IGZyb20gJ2ZwLXRzL09wdGlvbidcbiAqIGltcG9ydCB7IHBpcGUgfSBmcm9tICdmcC10cy9mdW5jdGlvbidcbiAqXG4gKiBhc3NlcnQuc3RyaWN0RXF1YWwoXG4gKiAgIHBpcGUoXG4gKiAgICAgc29tZSgxKSxcbiAqICAgICBleGlzdHMobiA9PiBuID4gMClcbiAqICAgKSxcbiAqICAgdHJ1ZVxuICogKVxuICogYXNzZXJ0LnN0cmljdEVxdWFsKFxuICogICBwaXBlKFxuICogICAgIHNvbWUoMSksXG4gKiAgICAgZXhpc3RzKG4gPT4gbiA+IDEpXG4gKiAgICksXG4gKiAgIGZhbHNlXG4gKiApXG4gKiBhc3NlcnQuc3RyaWN0RXF1YWwoXG4gKiAgIHBpcGUoXG4gKiAgICAgbm9uZSxcbiAqICAgICBleGlzdHMobiA9PiBuID4gMClcbiAqICAgKSxcbiAqICAgZmFsc2VcbiAqIClcbiAqXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciBleGlzdHMgPSBmdW5jdGlvbiAocHJlZGljYXRlKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChtYSkge1xuICAgICAgICByZXR1cm4gaXNOb25lKG1hKSA/IGZhbHNlIDogcHJlZGljYXRlKG1hLnZhbHVlKTtcbiAgICB9O1xufTtcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8vIGRvIG5vdGF0aW9uXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vKipcbiAqIEBjYXRlZ29yeSBkbyBub3RhdGlvblxuICogQHNpbmNlIDIuOS4wXG4gKi9cbmV4cG9ydCB2YXIgRG8gPSAvKiNfX1BVUkVfXyovIG9mKF8uZW1wdHlSZWNvcmQpO1xuLyoqXG4gKiBAY2F0ZWdvcnkgZG8gbm90YXRpb25cbiAqIEBzaW5jZSAyLjguMFxuICovXG5leHBvcnQgdmFyIGJpbmRUbyA9IC8qI19fUFVSRV9fKi8gYmluZFRvXyhGdW5jdG9yKTtcbnZhciBsZXRfID0gLyojX19QVVJFX18qLyBsZXRfXyhGdW5jdG9yKTtcbmV4cG9ydCB7IFxuLyoqXG4gKiBAY2F0ZWdvcnkgZG8gbm90YXRpb25cbiAqIEBzaW5jZSAyLjEzLjBcbiAqL1xubGV0XyBhcyBsZXQgfTtcbi8qKlxuICogQGNhdGVnb3J5IGRvIG5vdGF0aW9uXG4gKiBAc2luY2UgMi44LjBcbiAqL1xuZXhwb3J0IHZhciBiaW5kID0gLyojX19QVVJFX18qLyBjaGFpbmFibGUuYmluZChDaGFpbik7XG4vKipcbiAqIEBjYXRlZ29yeSBkbyBub3RhdGlvblxuICogQHNpbmNlIDIuOC4wXG4gKi9cbmV4cG9ydCB2YXIgYXBTID0gLyojX19QVVJFX18qLyBhcFNfKEFwcGx5KTtcbi8qKlxuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIEFwVCA9IC8qI19fUFVSRV9fKi8gb2YoXy5lbXB0eVJlYWRvbmx5QXJyYXkpO1xuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLy8gYXJyYXkgdXRpbHNcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8qKlxuICogRXF1aXZhbGVudCB0byBgUmVhZG9ubHlOb25FbXB0eUFycmF5I3RyYXZlcnNlV2l0aEluZGV4KEFwcGxpY2F0aXZlKWAuXG4gKlxuICogQGNhdGVnb3J5IHRyYXZlcnNpbmdcbiAqIEBzaW5jZSAyLjExLjBcbiAqL1xuZXhwb3J0IHZhciB0cmF2ZXJzZVJlYWRvbmx5Tm9uRW1wdHlBcnJheVdpdGhJbmRleCA9IGZ1bmN0aW9uIChmKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykge1xuICAgICAgICB2YXIgbyA9IGYoMCwgXy5oZWFkKGFzKSk7XG4gICAgICAgIGlmIChpc05vbmUobykpIHtcbiAgICAgICAgICAgIHJldHVybiBub25lO1xuICAgICAgICB9XG4gICAgICAgIHZhciBvdXQgPSBbby52YWx1ZV07XG4gICAgICAgIGZvciAodmFyIGkgPSAxOyBpIDwgYXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIHZhciBvXzEgPSBmKGksIGFzW2ldKTtcbiAgICAgICAgICAgIGlmIChpc05vbmUob18xKSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBub25lO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgb3V0LnB1c2gob18xLnZhbHVlKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gc29tZShvdXQpO1xuICAgIH07XG59O1xuLyoqXG4gKiBFcXVpdmFsZW50IHRvIGBSZWFkb25seUFycmF5I3RyYXZlcnNlV2l0aEluZGV4KEFwcGxpY2F0aXZlKWAuXG4gKlxuICogQGNhdGVnb3J5IHRyYXZlcnNpbmdcbiAqIEBzaW5jZSAyLjExLjBcbiAqL1xuZXhwb3J0IHZhciB0cmF2ZXJzZVJlYWRvbmx5QXJyYXlXaXRoSW5kZXggPSBmdW5jdGlvbiAoZikge1xuICAgIHZhciBnID0gdHJhdmVyc2VSZWFkb25seU5vbkVtcHR5QXJyYXlXaXRoSW5kZXgoZik7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykgeyByZXR1cm4gKF8uaXNOb25FbXB0eShhcykgPyBnKGFzKSA6IEFwVCk7IH07XG59O1xuLyoqXG4gKiBFcXVpdmFsZW50IHRvIGBSZWFkb25seUFycmF5I3RyYXZlcnNlV2l0aEluZGV4KEFwcGxpY2F0aXZlKWAuXG4gKlxuICogQGNhdGVnb3J5IHRyYXZlcnNpbmdcbiAqIEBzaW5jZSAyLjkuMFxuICovXG5leHBvcnQgdmFyIHRyYXZlcnNlQXJyYXlXaXRoSW5kZXggPSB0cmF2ZXJzZVJlYWRvbmx5QXJyYXlXaXRoSW5kZXg7XG4vKipcbiAqIEVxdWl2YWxlbnQgdG8gYFJlYWRvbmx5QXJyYXkjdHJhdmVyc2UoQXBwbGljYXRpdmUpYC5cbiAqXG4gKiBAY2F0ZWdvcnkgdHJhdmVyc2luZ1xuICogQHNpbmNlIDIuOS4wXG4gKi9cbmV4cG9ydCB2YXIgdHJhdmVyc2VBcnJheSA9IGZ1bmN0aW9uIChmKSB7XG4gICAgcmV0dXJuIHRyYXZlcnNlUmVhZG9ubHlBcnJheVdpdGhJbmRleChmdW5jdGlvbiAoXywgYSkgeyByZXR1cm4gZihhKTsgfSk7XG59O1xuLyoqXG4gKiBFcXVpdmFsZW50IHRvIGBSZWFkb25seUFycmF5I3NlcXVlbmNlKEFwcGxpY2F0aXZlKWAuXG4gKlxuICogQGNhdGVnb3J5IHRyYXZlcnNpbmdcbiAqIEBzaW5jZSAyLjkuMFxuICovXG5leHBvcnQgdmFyIHNlcXVlbmNlQXJyYXkgPSBcbi8qI19fUFVSRV9fKi8gdHJhdmVyc2VBcnJheShpZGVudGl0eSk7XG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vLyBsZWdhY3lcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8qKlxuICogQWxpYXMgb2YgYGZsYXRNYXBgLlxuICpcbiAqIEBjYXRlZ29yeSBsZWdhY3lcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIGNoYWluID0gZmxhdE1hcDtcbi8qKlxuICogQWxpYXMgb2YgYHRhcGAuXG4gKlxuICogQGNhdGVnb3J5IGxlZ2FjeVxuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgY2hhaW5GaXJzdCA9IHRhcDtcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8vIGRlcHJlY2F0ZWRcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8qKlxuICogVXNlIGBSZWZpbmVtZW50YCBtb2R1bGUgaW5zdGVhZC5cbiAqXG4gKiBAY2F0ZWdvcnkgem9uZSBvZiBkZWF0aFxuICogQHNpbmNlIDIuMC4wXG4gKiBAZGVwcmVjYXRlZFxuICovXG5leHBvcnQgZnVuY3Rpb24gZ2V0UmVmaW5lbWVudChnZXRPcHRpb24pIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGEpIHsgcmV0dXJuIGlzU29tZShnZXRPcHRpb24oYSkpOyB9O1xufVxuLyoqXG4gKiBVc2UgW2BjaGFpbk51bGxhYmxlS2BdKCNjaGFpbm51bGxhYmxlaykgaW5zdGVhZC5cbiAqXG4gKiBAY2F0ZWdvcnkgem9uZSBvZiBkZWF0aFxuICogQHNpbmNlIDIuMC4wXG4gKiBAZGVwcmVjYXRlZFxuICovXG5leHBvcnQgdmFyIG1hcE51bGxhYmxlID0gY2hhaW5OdWxsYWJsZUs7XG4vKipcbiAqIFRoaXMgaW5zdGFuY2UgaXMgZGVwcmVjYXRlZCwgdXNlIHNtYWxsLCBzcGVjaWZpYyBpbnN0YW5jZXMgaW5zdGVhZC5cbiAqIEZvciBleGFtcGxlIGlmIGEgZnVuY3Rpb24gbmVlZHMgYSBgRnVuY3RvcmAgaW5zdGFuY2UsIHBhc3MgYE8uRnVuY3RvcmAgaW5zdGVhZCBvZiBgTy5vcHRpb25gXG4gKiAod2hlcmUgYE9gIGlzIGZyb20gYGltcG9ydCBPIGZyb20gJ2ZwLXRzL09wdGlvbidgKVxuICpcbiAqIEBjYXRlZ29yeSB6b25lIG9mIGRlYXRoXG4gKiBAc2luY2UgMi4wLjBcbiAqIEBkZXByZWNhdGVkXG4gKi9cbmV4cG9ydCB2YXIgb3B0aW9uID0ge1xuICAgIFVSSTogVVJJLFxuICAgIG1hcDogX21hcCxcbiAgICBvZjogb2YsXG4gICAgYXA6IF9hcCxcbiAgICBjaGFpbjogZmxhdE1hcCxcbiAgICByZWR1Y2U6IF9yZWR1Y2UsXG4gICAgZm9sZE1hcDogX2ZvbGRNYXAsXG4gICAgcmVkdWNlUmlnaHQ6IF9yZWR1Y2VSaWdodCxcbiAgICB0cmF2ZXJzZTogX3RyYXZlcnNlLFxuICAgIHNlcXVlbmNlOiBzZXF1ZW5jZSxcbiAgICB6ZXJvOiB6ZXJvLFxuICAgIGFsdDogX2FsdCxcbiAgICBleHRlbmQ6IF9leHRlbmQsXG4gICAgY29tcGFjdDogY29tcGFjdCxcbiAgICBzZXBhcmF0ZTogc2VwYXJhdGUsXG4gICAgZmlsdGVyOiBfZmlsdGVyLFxuICAgIGZpbHRlck1hcDogX2ZpbHRlck1hcCxcbiAgICBwYXJ0aXRpb246IF9wYXJ0aXRpb24sXG4gICAgcGFydGl0aW9uTWFwOiBfcGFydGl0aW9uTWFwLFxuICAgIHdpdGhlcjogX3dpdGhlcixcbiAgICB3aWx0OiBfd2lsdCxcbiAgICB0aHJvd0Vycm9yOiB0aHJvd0Vycm9yXG59O1xuLyoqXG4gKiBVc2UgW2BnZXRBcHBseVNlbWlncm91cGBdKC4vQXBwbHkudHMuaHRtbCNnZXRhcHBseXNlbWlncm91cCkgaW5zdGVhZC5cbiAqXG4gKiBAY2F0ZWdvcnkgem9uZSBvZiBkZWF0aFxuICogQHNpbmNlIDIuMC4wXG4gKiBAZGVwcmVjYXRlZFxuICovXG5leHBvcnQgdmFyIGdldEFwcGx5U2VtaWdyb3VwID0gLyojX19QVVJFX18qLyBnZXRBcHBseVNlbWlncm91cF8oQXBwbHkpO1xuLyoqXG4gKiBVc2UgW2BnZXRBcHBsaWNhdGl2ZU1vbm9pZGBdKC4vQXBwbGljYXRpdmUudHMuaHRtbCNnZXRhcHBsaWNhdGl2ZW1vbm9pZCkgaW5zdGVhZC5cbiAqXG4gKiBAY2F0ZWdvcnkgem9uZSBvZiBkZWF0aFxuICogQHNpbmNlIDIuMC4wXG4gKiBAZGVwcmVjYXRlZFxuICovXG5leHBvcnQgdmFyIGdldEFwcGx5TW9ub2lkID0gLyojX19QVVJFX18qLyBnZXRBcHBsaWNhdGl2ZU1vbm9pZChBcHBsaWNhdGl2ZSk7XG4vKipcbiAqIFVzZVxuICpcbiAqIGBgYHRzXG4gKiBpbXBvcnQgeyBmaXJzdCB9IGZyb20gJ2ZwLXRzL1NlbWlncm91cCdcbiAqIGltcG9ydCB7IGdldE1vbm9pZCB9IGZyb20gJ2ZwLXRzL09wdGlvbidcbiAqXG4gKiBnZXRNb25vaWQoZmlyc3QoKSlcbiAqIGBgYFxuICpcbiAqIGluc3RlYWQuXG4gKlxuICogTW9ub2lkIHJldHVybmluZyB0aGUgbGVmdC1tb3N0IG5vbi1gTm9uZWAgdmFsdWVcbiAqXG4gKiB8IHggICAgICAgfCB5ICAgICAgIHwgY29uY2F0KHgsIHkpIHxcbiAqIHwgLS0tLS0tLSB8IC0tLS0tLS0gfCAtLS0tLS0tLS0tLS0gfFxuICogfCBub25lICAgIHwgbm9uZSAgICB8IG5vbmUgICAgICAgICB8XG4gKiB8IHNvbWUoYSkgfCBub25lICAgIHwgc29tZShhKSAgICAgIHxcbiAqIHwgbm9uZSAgICB8IHNvbWUoYikgfCBzb21lKGIpICAgICAgfFxuICogfCBzb21lKGEpIHwgc29tZShiKSB8IHNvbWUoYSkgICAgICB8XG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IGdldEZpcnN0TW9ub2lkLCBzb21lLCBub25lIH0gZnJvbSAnZnAtdHMvT3B0aW9uJ1xuICpcbiAqIGNvbnN0IE0gPSBnZXRGaXJzdE1vbm9pZDxudW1iZXI+KClcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoTS5jb25jYXQobm9uZSwgbm9uZSksIG5vbmUpXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKE0uY29uY2F0KHNvbWUoMSksIG5vbmUpLCBzb21lKDEpKVxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChNLmNvbmNhdChub25lLCBzb21lKDIpKSwgc29tZSgyKSlcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoTS5jb25jYXQoc29tZSgxKSwgc29tZSgyKSksIHNvbWUoMSkpXG4gKlxuICogQGNhdGVnb3J5IHpvbmUgb2YgZGVhdGhcbiAqIEBzaW5jZSAyLjAuMFxuICogQGRlcHJlY2F0ZWRcbiAqL1xuZXhwb3J0IHZhciBnZXRGaXJzdE1vbm9pZCA9IGZ1bmN0aW9uICgpIHsgcmV0dXJuIGdldE1vbm9pZChmaXJzdCgpKTsgfTtcbi8qKlxuICogVXNlXG4gKlxuICogYGBgdHNcbiAqIGltcG9ydCB7IGxhc3QgfSBmcm9tICdmcC10cy9TZW1pZ3JvdXAnXG4gKiBpbXBvcnQgeyBnZXRNb25vaWQgfSBmcm9tICdmcC10cy9PcHRpb24nXG4gKlxuICogZ2V0TW9ub2lkKGxhc3QoKSlcbiAqIGBgYFxuICpcbiAqIGluc3RlYWQuXG4gKlxuICogTW9ub2lkIHJldHVybmluZyB0aGUgcmlnaHQtbW9zdCBub24tYE5vbmVgIHZhbHVlXG4gKlxuICogfCB4ICAgICAgIHwgeSAgICAgICB8IGNvbmNhdCh4LCB5KSB8XG4gKiB8IC0tLS0tLS0gfCAtLS0tLS0tIHwgLS0tLS0tLS0tLS0tIHxcbiAqIHwgbm9uZSAgICB8IG5vbmUgICAgfCBub25lICAgICAgICAgfFxuICogfCBzb21lKGEpIHwgbm9uZSAgICB8IHNvbWUoYSkgICAgICB8XG4gKiB8IG5vbmUgICAgfCBzb21lKGIpIHwgc29tZShiKSAgICAgIHxcbiAqIHwgc29tZShhKSB8IHNvbWUoYikgfCBzb21lKGIpICAgICAgfFxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBnZXRMYXN0TW9ub2lkLCBzb21lLCBub25lIH0gZnJvbSAnZnAtdHMvT3B0aW9uJ1xuICpcbiAqIGNvbnN0IE0gPSBnZXRMYXN0TW9ub2lkPG51bWJlcj4oKVxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChNLmNvbmNhdChub25lLCBub25lKSwgbm9uZSlcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoTS5jb25jYXQoc29tZSgxKSwgbm9uZSksIHNvbWUoMSkpXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKE0uY29uY2F0KG5vbmUsIHNvbWUoMikpLCBzb21lKDIpKVxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChNLmNvbmNhdChzb21lKDEpLCBzb21lKDIpKSwgc29tZSgyKSlcbiAqXG4gKiBAY2F0ZWdvcnkgem9uZSBvZiBkZWF0aFxuICogQHNpbmNlIDIuMC4wXG4gKiBAZGVwcmVjYXRlZFxuICovXG5leHBvcnQgdmFyIGdldExhc3RNb25vaWQgPSBmdW5jdGlvbiAoKSB7IHJldHVybiBnZXRNb25vaWQobGFzdCgpKTsgfTtcbiIsCiAgImltcG9ydCB7IGdldEFwcGxpY2F0aXZlTW9ub2lkIH0gZnJvbSAnLi9BcHBsaWNhdGl2ZSc7XG5pbXBvcnQgeyBhcEZpcnN0IGFzIGFwRmlyc3RfLCBhcFMgYXMgYXBTXywgYXBTZWNvbmQgYXMgYXBTZWNvbmRfLCBnZXRBcHBseVNlbWlncm91cCBhcyBnZXRBcHBseVNlbWlncm91cF8gfSBmcm9tICcuL0FwcGx5JztcbmltcG9ydCAqIGFzIGNoYWluYWJsZSBmcm9tICcuL0NoYWluJztcbmltcG9ydCB7IGNoYWluRWl0aGVySyBhcyBjaGFpbkVpdGhlcktfLCBmcm9tRWl0aGVySyBhcyBmcm9tRWl0aGVyS18sIHRhcEVpdGhlciBhcyB0YXBFaXRoZXJfIH0gZnJvbSAnLi9Gcm9tRWl0aGVyJztcbmltcG9ydCB7IGNvbnN0TnVsbCwgY29uc3RVbmRlZmluZWQsIGR1YWwsIGZsb3csIGlkZW50aXR5LCBwaXBlIH0gZnJvbSAnLi9mdW5jdGlvbic7XG5pbXBvcnQgeyBhcyBhcyBhc18sIGFzVW5pdCBhcyBhc1VuaXRfLCBiaW5kVG8gYXMgYmluZFRvXywgZmxhcCBhcyBmbGFwXywgbGV0IGFzIGxldF9fIH0gZnJvbSAnLi9GdW5jdG9yJztcbmltcG9ydCAqIGFzIF8gZnJvbSAnLi9pbnRlcm5hbCc7XG5pbXBvcnQgeyBub3QgfSBmcm9tICcuL1ByZWRpY2F0ZSc7XG5pbXBvcnQgeyBmaXJzdCwgbGFzdCB9IGZyb20gJy4vU2VtaWdyb3VwJztcbmltcG9ydCB7IHNlcGFyYXRlZCB9IGZyb20gJy4vU2VwYXJhdGVkJztcbmltcG9ydCB7IHdpbHREZWZhdWx0LCB3aXRoZXJEZWZhdWx0IH0gZnJvbSAnLi9XaXRoZXJhYmxlJztcbmltcG9ydCB7IGd1YXJkIGFzIGd1YXJkXyB9IGZyb20gJy4vWmVybyc7XG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vLyBjb25zdHJ1Y3RvcnNcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8qKlxuICogYE5vbmVgIGRvZXNuJ3QgaGF2ZSBhIGNvbnN0cnVjdG9yLCBpbnN0ZWFkIHlvdSBjYW4gdXNlIGl0IGRpcmVjdGx5IGFzIGEgdmFsdWUuIFJlcHJlc2VudHMgYSBtaXNzaW5nIHZhbHVlLlxuICpcbiAqIEBjYXRlZ29yeSBjb25zdHJ1Y3RvcnNcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIG5vbmUgPSBfLm5vbmU7XG4vKipcbiAqIENvbnN0cnVjdHMgYSBgU29tZWAuIFJlcHJlc2VudHMgYW4gb3B0aW9uYWwgdmFsdWUgdGhhdCBleGlzdHMuXG4gKlxuICogQGNhdGVnb3J5IGNvbnN0cnVjdG9yc1xuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgc29tZSA9IF8uc29tZTtcbmV4cG9ydCBmdW5jdGlvbiBmcm9tUHJlZGljYXRlKHByZWRpY2F0ZSkge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYSkgeyByZXR1cm4gKHByZWRpY2F0ZShhKSA/IHNvbWUoYSkgOiBub25lKTsgfTtcbn1cbi8qKlxuICogUmV0dXJucyB0aGUgYExlZnRgIHZhbHVlIG9mIGFuIGBFaXRoZXJgIGlmIHBvc3NpYmxlLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBnZXRMZWZ0LCBub25lLCBzb21lIH0gZnJvbSAnZnAtdHMvT3B0aW9uJ1xuICogaW1wb3J0IHsgcmlnaHQsIGxlZnQgfSBmcm9tICdmcC10cy9FaXRoZXInXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChnZXRMZWZ0KHJpZ2h0KDEpKSwgbm9uZSlcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoZ2V0TGVmdChsZWZ0KCdhJykpLCBzb21lKCdhJykpXG4gKlxuICogQGNhdGVnb3J5IGNvbnN0cnVjdG9yc1xuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgZ2V0TGVmdCA9IGZ1bmN0aW9uIChtYSkgeyByZXR1cm4gKG1hLl90YWcgPT09ICdSaWdodCcgPyBub25lIDogc29tZShtYS5sZWZ0KSk7IH07XG4vKipcbiAqIFJldHVybnMgdGhlIGBSaWdodGAgdmFsdWUgb2YgYW4gYEVpdGhlcmAgaWYgcG9zc2libGUuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IGdldFJpZ2h0LCBub25lLCBzb21lIH0gZnJvbSAnZnAtdHMvT3B0aW9uJ1xuICogaW1wb3J0IHsgcmlnaHQsIGxlZnQgfSBmcm9tICdmcC10cy9FaXRoZXInXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChnZXRSaWdodChyaWdodCgxKSksIHNvbWUoMSkpXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKGdldFJpZ2h0KGxlZnQoJ2EnKSksIG5vbmUpXG4gKlxuICogQGNhdGVnb3J5IGNvbnN0cnVjdG9yc1xuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgZ2V0UmlnaHQgPSBmdW5jdGlvbiAobWEpIHsgcmV0dXJuIChtYS5fdGFnID09PSAnTGVmdCcgPyBub25lIDogc29tZShtYS5yaWdodCkpOyB9O1xudmFyIF9tYXAgPSBmdW5jdGlvbiAoZmEsIGYpIHsgcmV0dXJuIHBpcGUoZmEsIG1hcChmKSk7IH07XG52YXIgX2FwID0gZnVuY3Rpb24gKGZhYiwgZmEpIHsgcmV0dXJuIHBpcGUoZmFiLCBhcChmYSkpOyB9O1xudmFyIF9yZWR1Y2UgPSBmdW5jdGlvbiAoZmEsIGIsIGYpIHsgcmV0dXJuIHBpcGUoZmEsIHJlZHVjZShiLCBmKSk7IH07XG52YXIgX2ZvbGRNYXAgPSBmdW5jdGlvbiAoTSkge1xuICAgIHZhciBmb2xkTWFwTSA9IGZvbGRNYXAoTSk7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChmYSwgZikgeyByZXR1cm4gcGlwZShmYSwgZm9sZE1hcE0oZikpOyB9O1xufTtcbnZhciBfcmVkdWNlUmlnaHQgPSBmdW5jdGlvbiAoZmEsIGIsIGYpIHsgcmV0dXJuIHBpcGUoZmEsIHJlZHVjZVJpZ2h0KGIsIGYpKTsgfTtcbnZhciBfdHJhdmVyc2UgPSBmdW5jdGlvbiAoRikge1xuICAgIHZhciB0cmF2ZXJzZUYgPSB0cmF2ZXJzZShGKTtcbiAgICByZXR1cm4gZnVuY3Rpb24gKHRhLCBmKSB7IHJldHVybiBwaXBlKHRhLCB0cmF2ZXJzZUYoZikpOyB9O1xufTtcbi8qIGlzdGFuYnVsIGlnbm9yZSBuZXh0ICovXG52YXIgX2FsdCA9IGZ1bmN0aW9uIChmYSwgdGhhdCkgeyByZXR1cm4gcGlwZShmYSwgYWx0KHRoYXQpKTsgfTtcbnZhciBfZmlsdGVyID0gZnVuY3Rpb24gKGZhLCBwcmVkaWNhdGUpIHsgcmV0dXJuIHBpcGUoZmEsIGZpbHRlcihwcmVkaWNhdGUpKTsgfTtcbi8qIGlzdGFuYnVsIGlnbm9yZSBuZXh0ICovXG52YXIgX2ZpbHRlck1hcCA9IGZ1bmN0aW9uIChmYSwgZikgeyByZXR1cm4gcGlwZShmYSwgZmlsdGVyTWFwKGYpKTsgfTtcbi8qIGlzdGFuYnVsIGlnbm9yZSBuZXh0ICovXG52YXIgX2V4dGVuZCA9IGZ1bmN0aW9uICh3YSwgZikgeyByZXR1cm4gcGlwZSh3YSwgZXh0ZW5kKGYpKTsgfTtcbi8qIGlzdGFuYnVsIGlnbm9yZSBuZXh0ICovXG52YXIgX3BhcnRpdGlvbiA9IGZ1bmN0aW9uIChmYSwgcHJlZGljYXRlKSB7XG4gICAgcmV0dXJuIHBpcGUoZmEsIHBhcnRpdGlvbihwcmVkaWNhdGUpKTtcbn07XG4vKiBpc3RhbmJ1bCBpZ25vcmUgbmV4dCAqL1xudmFyIF9wYXJ0aXRpb25NYXAgPSBmdW5jdGlvbiAoZmEsIGYpIHsgcmV0dXJuIHBpcGUoZmEsIHBhcnRpdGlvbk1hcChmKSk7IH07XG4vKipcbiAqIEBjYXRlZ29yeSB0eXBlIGxhbWJkYXNcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIFVSSSA9ICdPcHRpb24nO1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciBnZXRTaG93ID0gZnVuY3Rpb24gKFMpIHsgcmV0dXJuICh7XG4gICAgc2hvdzogZnVuY3Rpb24gKG1hKSB7IHJldHVybiAoaXNOb25lKG1hKSA/ICdub25lJyA6IFwic29tZShcIi5jb25jYXQoUy5zaG93KG1hLnZhbHVlKSwgXCIpXCIpKTsgfVxufSk7IH07XG4vKipcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBub25lLCBzb21lLCBnZXRFcSB9IGZyb20gJ2ZwLXRzL09wdGlvbidcbiAqIGltcG9ydCAqIGFzIE4gZnJvbSAnZnAtdHMvbnVtYmVyJ1xuICpcbiAqIGNvbnN0IEUgPSBnZXRFcShOLkVxKVxuICogYXNzZXJ0LnN0cmljdEVxdWFsKEUuZXF1YWxzKG5vbmUsIG5vbmUpLCB0cnVlKVxuICogYXNzZXJ0LnN0cmljdEVxdWFsKEUuZXF1YWxzKG5vbmUsIHNvbWUoMSkpLCBmYWxzZSlcbiAqIGFzc2VydC5zdHJpY3RFcXVhbChFLmVxdWFscyhzb21lKDEpLCBub25lKSwgZmFsc2UpXG4gKiBhc3NlcnQuc3RyaWN0RXF1YWwoRS5lcXVhbHMoc29tZSgxKSwgc29tZSgyKSksIGZhbHNlKVxuICogYXNzZXJ0LnN0cmljdEVxdWFsKEUuZXF1YWxzKHNvbWUoMSksIHNvbWUoMSkpLCB0cnVlKVxuICpcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIGdldEVxID0gZnVuY3Rpb24gKEUpIHsgcmV0dXJuICh7XG4gICAgZXF1YWxzOiBmdW5jdGlvbiAoeCwgeSkgeyByZXR1cm4geCA9PT0geSB8fCAoaXNOb25lKHgpID8gaXNOb25lKHkpIDogaXNOb25lKHkpID8gZmFsc2UgOiBFLmVxdWFscyh4LnZhbHVlLCB5LnZhbHVlKSk7IH1cbn0pOyB9O1xuLyoqXG4gKiBUaGUgYE9yZGAgaW5zdGFuY2UgYWxsb3dzIGBPcHRpb25gIHZhbHVlcyB0byBiZSBjb21wYXJlZCB3aXRoXG4gKiBgY29tcGFyZWAsIHdoZW5ldmVyIHRoZXJlIGlzIGFuIGBPcmRgIGluc3RhbmNlIGZvclxuICogdGhlIHR5cGUgdGhlIGBPcHRpb25gIGNvbnRhaW5zLlxuICpcbiAqIGBOb25lYCBpcyBjb25zaWRlcmVkIHRvIGJlIGxlc3MgdGhhbiBhbnkgYFNvbWVgIHZhbHVlLlxuICpcbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgbm9uZSwgc29tZSwgZ2V0T3JkIH0gZnJvbSAnZnAtdHMvT3B0aW9uJ1xuICogaW1wb3J0ICogYXMgTiBmcm9tICdmcC10cy9udW1iZXInXG4gKlxuICogY29uc3QgTyA9IGdldE9yZChOLk9yZClcbiAqIGFzc2VydC5zdHJpY3RFcXVhbChPLmNvbXBhcmUobm9uZSwgbm9uZSksIDApXG4gKiBhc3NlcnQuc3RyaWN0RXF1YWwoTy5jb21wYXJlKG5vbmUsIHNvbWUoMSkpLCAtMSlcbiAqIGFzc2VydC5zdHJpY3RFcXVhbChPLmNvbXBhcmUoc29tZSgxKSwgbm9uZSksIDEpXG4gKiBhc3NlcnQuc3RyaWN0RXF1YWwoTy5jb21wYXJlKHNvbWUoMSksIHNvbWUoMikpLCAtMSlcbiAqIGFzc2VydC5zdHJpY3RFcXVhbChPLmNvbXBhcmUoc29tZSgxKSwgc29tZSgxKSksIDApXG4gKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgZ2V0T3JkID0gZnVuY3Rpb24gKE8pIHsgcmV0dXJuICh7XG4gICAgZXF1YWxzOiBnZXRFcShPKS5lcXVhbHMsXG4gICAgY29tcGFyZTogZnVuY3Rpb24gKHgsIHkpIHsgcmV0dXJuICh4ID09PSB5ID8gMCA6IGlzU29tZSh4KSA/IChpc1NvbWUoeSkgPyBPLmNvbXBhcmUoeC52YWx1ZSwgeS52YWx1ZSkgOiAxKSA6IC0xKTsgfVxufSk7IH07XG4vKipcbiAqIE1vbm9pZCByZXR1cm5pbmcgdGhlIGxlZnQtbW9zdCBub24tYE5vbmVgIHZhbHVlLiBJZiBib3RoIG9wZXJhbmRzIGFyZSBgU29tZWBzIHRoZW4gdGhlIGlubmVyIHZhbHVlcyBhcmVcbiAqIGNvbmNhdGVuYXRlZCB1c2luZyB0aGUgcHJvdmlkZWQgYFNlbWlncm91cGBcbiAqXG4gKiB8IHggICAgICAgfCB5ICAgICAgIHwgY29uY2F0KHgsIHkpICAgICAgIHxcbiAqIHwgLS0tLS0tLSB8IC0tLS0tLS0gfCAtLS0tLS0tLS0tLS0tLS0tLS0gfFxuICogfCBub25lICAgIHwgbm9uZSAgICB8IG5vbmUgICAgICAgICAgICAgICB8XG4gKiB8IHNvbWUoYSkgfCBub25lICAgIHwgc29tZShhKSAgICAgICAgICAgIHxcbiAqIHwgbm9uZSAgICB8IHNvbWUoYikgfCBzb21lKGIpICAgICAgICAgICAgfFxuICogfCBzb21lKGEpIHwgc29tZShiKSB8IHNvbWUoY29uY2F0KGEsIGIpKSB8XG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IGdldE1vbm9pZCwgc29tZSwgbm9uZSB9IGZyb20gJ2ZwLXRzL09wdGlvbidcbiAqIGltcG9ydCB7IFNlbWlncm91cFN1bSB9IGZyb20gJ2ZwLXRzL251bWJlcidcbiAqXG4gKiBjb25zdCBNID0gZ2V0TW9ub2lkKFNlbWlncm91cFN1bSlcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoTS5jb25jYXQobm9uZSwgbm9uZSksIG5vbmUpXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKE0uY29uY2F0KHNvbWUoMSksIG5vbmUpLCBzb21lKDEpKVxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChNLmNvbmNhdChub25lLCBzb21lKDEpKSwgc29tZSgxKSlcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoTS5jb25jYXQoc29tZSgxKSwgc29tZSgyKSksIHNvbWUoMykpXG4gKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgZ2V0TW9ub2lkID0gZnVuY3Rpb24gKFMpIHsgcmV0dXJuICh7XG4gICAgY29uY2F0OiBmdW5jdGlvbiAoeCwgeSkgeyByZXR1cm4gKGlzTm9uZSh4KSA/IHkgOiBpc05vbmUoeSkgPyB4IDogc29tZShTLmNvbmNhdCh4LnZhbHVlLCB5LnZhbHVlKSkpOyB9LFxuICAgIGVtcHR5OiBub25lXG59KTsgfTtcbi8qKlxuICogQGNhdGVnb3J5IG1hcHBpbmdcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIG1hcCA9IGZ1bmN0aW9uIChmKSB7IHJldHVybiBmdW5jdGlvbiAoZmEpIHtcbiAgICByZXR1cm4gaXNOb25lKGZhKSA/IG5vbmUgOiBzb21lKGYoZmEudmFsdWUpKTtcbn07IH07XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjcuMFxuICovXG5leHBvcnQgdmFyIEZ1bmN0b3IgPSB7XG4gICAgVVJJOiBVUkksXG4gICAgbWFwOiBfbWFwXG59O1xuLyoqXG4gKiBNYXBzIHRoZSBgU29tZWAgdmFsdWUgb2YgdGhpcyBgT3B0aW9uYCB0byB0aGUgc3BlY2lmaWVkIGNvbnN0YW50IHZhbHVlLlxuICpcbiAqIEBjYXRlZ29yeSBtYXBwaW5nXG4gKiBAc2luY2UgMi4xNi4wXG4gKi9cbmV4cG9ydCB2YXIgYXMgPSBkdWFsKDIsIGFzXyhGdW5jdG9yKSk7XG4vKipcbiAqIE1hcHMgdGhlIGBTb21lYCB2YWx1ZSBvZiB0aGlzIGBPcHRpb25gIHRvIHRoZSB2b2lkIGNvbnN0YW50IHZhbHVlLlxuICpcbiAqIEBjYXRlZ29yeSBtYXBwaW5nXG4gKiBAc2luY2UgMi4xNi4wXG4gKi9cbmV4cG9ydCB2YXIgYXNVbml0ID0gYXNVbml0XyhGdW5jdG9yKTtcbi8qKlxuICogQGNhdGVnb3J5IGNvbnN0cnVjdG9yc1xuICogQHNpbmNlIDIuNy4wXG4gKi9cbmV4cG9ydCB2YXIgb2YgPSBzb21lO1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi4xMC4wXG4gKi9cbmV4cG9ydCB2YXIgUG9pbnRlZCA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICBvZjogb2Zcbn07XG4vKipcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIGFwID0gZnVuY3Rpb24gKGZhKSB7IHJldHVybiBmdW5jdGlvbiAoZmFiKSB7XG4gICAgcmV0dXJuIGlzTm9uZShmYWIpID8gbm9uZSA6IGlzTm9uZShmYSkgPyBub25lIDogc29tZShmYWIudmFsdWUoZmEudmFsdWUpKTtcbn07IH07XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjEwLjBcbiAqL1xuZXhwb3J0IHZhciBBcHBseSA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICBtYXA6IF9tYXAsXG4gICAgYXA6IF9hcFxufTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuNy4wXG4gKi9cbmV4cG9ydCB2YXIgQXBwbGljYXRpdmUgPSB7XG4gICAgVVJJOiBVUkksXG4gICAgbWFwOiBfbWFwLFxuICAgIGFwOiBfYXAsXG4gICAgb2Y6IG9mXG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgc2VxdWVuY2luZ1xuICogQHNpbmNlIDIuMTQuMFxuICovXG5leHBvcnQgdmFyIGZsYXRNYXAgPSAvKiNfX1BVUkVfXyovIGR1YWwoMiwgZnVuY3Rpb24gKG1hLCBmKSB7IHJldHVybiAoaXNOb25lKG1hKSA/IG5vbmUgOiBmKG1hLnZhbHVlKSk7IH0pO1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi4xMC4wXG4gKi9cbmV4cG9ydCB2YXIgQ2hhaW4gPSB7XG4gICAgVVJJOiBVUkksXG4gICAgbWFwOiBfbWFwLFxuICAgIGFwOiBfYXAsXG4gICAgY2hhaW46IGZsYXRNYXBcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjcuMFxuICovXG5leHBvcnQgdmFyIE1vbmFkID0ge1xuICAgIFVSSTogVVJJLFxuICAgIG1hcDogX21hcCxcbiAgICBhcDogX2FwLFxuICAgIG9mOiBvZixcbiAgICBjaGFpbjogZmxhdE1hcFxufTtcbi8qKlxuICogQGNhdGVnb3J5IGZvbGRpbmdcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIHJlZHVjZSA9IGZ1bmN0aW9uIChiLCBmKSB7IHJldHVybiBmdW5jdGlvbiAoZmEpIHtcbiAgICByZXR1cm4gaXNOb25lKGZhKSA/IGIgOiBmKGIsIGZhLnZhbHVlKTtcbn07IH07XG4vKipcbiAqIEBjYXRlZ29yeSBmb2xkaW5nXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciBmb2xkTWFwID0gZnVuY3Rpb24gKE0pIHsgcmV0dXJuIGZ1bmN0aW9uIChmKSB7IHJldHVybiBmdW5jdGlvbiAoZmEpIHtcbiAgICByZXR1cm4gaXNOb25lKGZhKSA/IE0uZW1wdHkgOiBmKGZhLnZhbHVlKTtcbn07IH07IH07XG4vKipcbiAqIEBjYXRlZ29yeSBmb2xkaW5nXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciByZWR1Y2VSaWdodCA9IGZ1bmN0aW9uIChiLCBmKSB7IHJldHVybiBmdW5jdGlvbiAoZmEpIHtcbiAgICByZXR1cm4gaXNOb25lKGZhKSA/IGIgOiBmKGZhLnZhbHVlLCBiKTtcbn07IH07XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjcuMFxuICovXG5leHBvcnQgdmFyIEZvbGRhYmxlID0ge1xuICAgIFVSSTogVVJJLFxuICAgIHJlZHVjZTogX3JlZHVjZSxcbiAgICBmb2xkTWFwOiBfZm9sZE1hcCxcbiAgICByZWR1Y2VSaWdodDogX3JlZHVjZVJpZ2h0XG59O1xuLyoqXG4gKiBSZXR1cm5zIHRoZSBwcm92aWRlZCBgT3B0aW9uYCBgdGhhdGAgaWYgYHNlbGZgIGlzIGBOb25lYCwgb3RoZXJ3aXNlIHJldHVybnMgYHNlbGZgLlxuICpcbiAqIEBwYXJhbSBzZWxmIC0gVGhlIGZpcnN0IGBPcHRpb25gIHRvIGJlIGNoZWNrZWQuXG4gKiBAcGFyYW0gdGhhdCAtIFRoZSBgT3B0aW9uYCB0byByZXR1cm4gaWYgYHNlbGZgIGlzIGBOb25lYC5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0ICogYXMgTyBmcm9tIFwiZnAtdHMvT3B0aW9uXCJcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKE8ub3JFbHNlKE8ubm9uZSwgKCkgPT4gTy5ub25lKSwgTy5ub25lKVxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChPLm9yRWxzZShPLnNvbWUoMSksICgpID0+IE8ubm9uZSksIE8uc29tZSgxKSlcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoTy5vckVsc2UoTy5ub25lLCAoKSA9PiBPLnNvbWUoJ2InKSksIE8uc29tZSgnYicpKVxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChPLm9yRWxzZShPLnNvbWUoMSksICgpID0+IE8uc29tZSgnYicpKSwgTy5zb21lKDEpKVxuICpcbiAqIEBjYXRlZ29yeSBlcnJvciBoYW5kbGluZ1xuICogQHNpbmNlIDIuMTYuMFxuICovXG5leHBvcnQgdmFyIG9yRWxzZSA9IGR1YWwoMiwgZnVuY3Rpb24gKHNlbGYsIHRoYXQpIHsgcmV0dXJuIChpc05vbmUoc2VsZikgPyB0aGF0KCkgOiBzZWxmKTsgfSk7XG4vKipcbiAqIEFsaWFzIG9mIGBvckVsc2VgLlxuICpcbiAqIExlc3Mgc3RyaWN0IHZlcnNpb24gb2YgW2BhbHRgXSgjYWx0KS5cbiAqXG4gKiBUaGUgYFdgIHN1ZmZpeCAoc2hvcnQgZm9yICoqVyoqaWRlbmluZykgbWVhbnMgdGhhdCB0aGUgcmV0dXJuIHR5cGVzIHdpbGwgYmUgbWVyZ2VkLlxuICpcbiAqIEBjYXRlZ29yeSBsZWdhY3lcbiAqIEBzaW5jZSAyLjkuMFxuICovXG5leHBvcnQgdmFyIGFsdFcgPSBvckVsc2U7XG4vKipcbiAqIEFsaWFzIG9mIGBvckVsc2VgLlxuICpcbiAqIEBjYXRlZ29yeSBsZWdhY3lcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIGFsdCA9IG9yRWxzZTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuNy4wXG4gKi9cbmV4cG9ydCB2YXIgQWx0ID0ge1xuICAgIFVSSTogVVJJLFxuICAgIG1hcDogX21hcCxcbiAgICBhbHQ6IF9hbHRcbn07XG4vKipcbiAqIEBzaW5jZSAyLjcuMFxuICovXG5leHBvcnQgdmFyIHplcm8gPSBmdW5jdGlvbiAoKSB7IHJldHVybiBub25lOyB9O1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi4xMS4wXG4gKi9cbmV4cG9ydCB2YXIgWmVybyA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICB6ZXJvOiB6ZXJvXG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgZG8gbm90YXRpb25cbiAqIEBzaW5jZSAyLjExLjBcbiAqL1xuZXhwb3J0IHZhciBndWFyZCA9IC8qI19fUFVSRV9fKi8gZ3VhcmRfKFplcm8sIFBvaW50ZWQpO1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi43LjBcbiAqL1xuZXhwb3J0IHZhciBBbHRlcm5hdGl2ZSA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICBtYXA6IF9tYXAsXG4gICAgYXA6IF9hcCxcbiAgICBvZjogb2YsXG4gICAgYWx0OiBfYWx0LFxuICAgIHplcm86IHplcm9cbn07XG4vKipcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIGV4dGVuZCA9IGZ1bmN0aW9uIChmKSB7IHJldHVybiBmdW5jdGlvbiAod2EpIHtcbiAgICByZXR1cm4gaXNOb25lKHdhKSA/IG5vbmUgOiBzb21lKGYod2EpKTtcbn07IH07XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjcuMFxuICovXG5leHBvcnQgdmFyIEV4dGVuZCA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICBtYXA6IF9tYXAsXG4gICAgZXh0ZW5kOiBfZXh0ZW5kXG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgZmlsdGVyaW5nXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciBjb21wYWN0ID0gLyojX19QVVJFX18qLyBmbGF0TWFwKGlkZW50aXR5KTtcbnZhciBkZWZhdWx0U2VwYXJhdGVkID0gLyojX19QVVJFX18qLyBzZXBhcmF0ZWQobm9uZSwgbm9uZSk7XG4vKipcbiAqIEBjYXRlZ29yeSBmaWx0ZXJpbmdcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIHNlcGFyYXRlID0gZnVuY3Rpb24gKG1hKSB7XG4gICAgcmV0dXJuIGlzTm9uZShtYSkgPyBkZWZhdWx0U2VwYXJhdGVkIDogc2VwYXJhdGVkKGdldExlZnQobWEudmFsdWUpLCBnZXRSaWdodChtYS52YWx1ZSkpO1xufTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuNy4wXG4gKi9cbmV4cG9ydCB2YXIgQ29tcGFjdGFibGUgPSB7XG4gICAgVVJJOiBVUkksXG4gICAgY29tcGFjdDogY29tcGFjdCxcbiAgICBzZXBhcmF0ZTogc2VwYXJhdGVcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBmaWx0ZXJpbmdcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIGZpbHRlciA9IGZ1bmN0aW9uIChwcmVkaWNhdGUpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGZhKSB7XG4gICAgICAgIHJldHVybiBpc05vbmUoZmEpID8gbm9uZSA6IHByZWRpY2F0ZShmYS52YWx1ZSkgPyBmYSA6IG5vbmU7XG4gICAgfTtcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBmaWx0ZXJpbmdcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIGZpbHRlck1hcCA9IGZ1bmN0aW9uIChmKSB7IHJldHVybiBmdW5jdGlvbiAoZmEpIHtcbiAgICByZXR1cm4gaXNOb25lKGZhKSA/IG5vbmUgOiBmKGZhLnZhbHVlKTtcbn07IH07XG4vKipcbiAqIEBjYXRlZ29yeSBmaWx0ZXJpbmdcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIHBhcnRpdGlvbiA9IGZ1bmN0aW9uIChwcmVkaWNhdGUpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGZhKSB7XG4gICAgICAgIHJldHVybiBzZXBhcmF0ZWQoX2ZpbHRlcihmYSwgbm90KHByZWRpY2F0ZSkpLCBfZmlsdGVyKGZhLCBwcmVkaWNhdGUpKTtcbiAgICB9O1xufTtcbi8qKlxuICogQGNhdGVnb3J5IGZpbHRlcmluZ1xuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgcGFydGl0aW9uTWFwID0gZnVuY3Rpb24gKGYpIHsgcmV0dXJuIGZsb3cobWFwKGYpLCBzZXBhcmF0ZSk7IH07XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjcuMFxuICovXG5leHBvcnQgdmFyIEZpbHRlcmFibGUgPSB7XG4gICAgVVJJOiBVUkksXG4gICAgbWFwOiBfbWFwLFxuICAgIGNvbXBhY3Q6IGNvbXBhY3QsXG4gICAgc2VwYXJhdGU6IHNlcGFyYXRlLFxuICAgIGZpbHRlcjogX2ZpbHRlcixcbiAgICBmaWx0ZXJNYXA6IF9maWx0ZXJNYXAsXG4gICAgcGFydGl0aW9uOiBfcGFydGl0aW9uLFxuICAgIHBhcnRpdGlvbk1hcDogX3BhcnRpdGlvbk1hcFxufTtcbi8qKlxuICogQGNhdGVnb3J5IHRyYXZlcnNpbmdcbiAqIEBzaW5jZSAyLjYuM1xuICovXG5leHBvcnQgdmFyIHRyYXZlcnNlID0gZnVuY3Rpb24gKEYpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGYpIHtcbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uICh0YSkge1xuICAgICAgICAgICAgcmV0dXJuIGlzTm9uZSh0YSkgPyBGLm9mKG5vbmUpIDogRi5tYXAoZih0YS52YWx1ZSksIHNvbWUpO1xuICAgICAgICB9O1xuICAgIH07XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgdHJhdmVyc2luZ1xuICogQHNpbmNlIDIuNi4zXG4gKi9cbmV4cG9ydCB2YXIgc2VxdWVuY2UgPSBmdW5jdGlvbiAoRikge1xuICAgIHJldHVybiBmdW5jdGlvbiAodGEpIHtcbiAgICAgICAgcmV0dXJuIGlzTm9uZSh0YSkgPyBGLm9mKG5vbmUpIDogRi5tYXAodGEudmFsdWUsIHNvbWUpO1xuICAgIH07XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi43LjBcbiAqL1xuZXhwb3J0IHZhciBUcmF2ZXJzYWJsZSA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICBtYXA6IF9tYXAsXG4gICAgcmVkdWNlOiBfcmVkdWNlLFxuICAgIGZvbGRNYXA6IF9mb2xkTWFwLFxuICAgIHJlZHVjZVJpZ2h0OiBfcmVkdWNlUmlnaHQsXG4gICAgdHJhdmVyc2U6IF90cmF2ZXJzZSxcbiAgICBzZXF1ZW5jZTogc2VxdWVuY2Vcbn07XG52YXIgX3dpdGhlciA9IC8qI19fUFVSRV9fKi8gd2l0aGVyRGVmYXVsdChUcmF2ZXJzYWJsZSwgQ29tcGFjdGFibGUpO1xudmFyIF93aWx0ID0gLyojX19QVVJFX18qLyB3aWx0RGVmYXVsdChUcmF2ZXJzYWJsZSwgQ29tcGFjdGFibGUpO1xuLyoqXG4gKiBAY2F0ZWdvcnkgZmlsdGVyaW5nXG4gKiBAc2luY2UgMi42LjVcbiAqL1xuZXhwb3J0IHZhciB3aXRoZXIgPSBmdW5jdGlvbiAoRikge1xuICAgIHZhciBfd2l0aGVyRiA9IF93aXRoZXIoRik7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChmKSB7IHJldHVybiBmdW5jdGlvbiAoZmEpIHsgcmV0dXJuIF93aXRoZXJGKGZhLCBmKTsgfTsgfTtcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBmaWx0ZXJpbmdcbiAqIEBzaW5jZSAyLjYuNVxuICovXG5leHBvcnQgdmFyIHdpbHQgPSBmdW5jdGlvbiAoRikge1xuICAgIHZhciBfd2lsdEYgPSBfd2lsdChGKTtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGYpIHsgcmV0dXJuIGZ1bmN0aW9uIChmYSkgeyByZXR1cm4gX3dpbHRGKGZhLCBmKTsgfTsgfTtcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjcuMFxuICovXG5leHBvcnQgdmFyIFdpdGhlcmFibGUgPSB7XG4gICAgVVJJOiBVUkksXG4gICAgbWFwOiBfbWFwLFxuICAgIHJlZHVjZTogX3JlZHVjZSxcbiAgICBmb2xkTWFwOiBfZm9sZE1hcCxcbiAgICByZWR1Y2VSaWdodDogX3JlZHVjZVJpZ2h0LFxuICAgIHRyYXZlcnNlOiBfdHJhdmVyc2UsXG4gICAgc2VxdWVuY2U6IHNlcXVlbmNlLFxuICAgIGNvbXBhY3Q6IGNvbXBhY3QsXG4gICAgc2VwYXJhdGU6IHNlcGFyYXRlLFxuICAgIGZpbHRlcjogX2ZpbHRlcixcbiAgICBmaWx0ZXJNYXA6IF9maWx0ZXJNYXAsXG4gICAgcGFydGl0aW9uOiBfcGFydGl0aW9uLFxuICAgIHBhcnRpdGlvbk1hcDogX3BhcnRpdGlvbk1hcCxcbiAgICB3aXRoZXI6IF93aXRoZXIsXG4gICAgd2lsdDogX3dpbHRcbn07XG4vKipcbiAqIEBzaW5jZSAyLjcuMFxuICovXG5leHBvcnQgdmFyIHRocm93RXJyb3IgPSBmdW5jdGlvbiAoKSB7IHJldHVybiBub25lOyB9O1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi43LjBcbiAqL1xuZXhwb3J0IHZhciBNb25hZFRocm93ID0ge1xuICAgIFVSSTogVVJJLFxuICAgIG1hcDogX21hcCxcbiAgICBhcDogX2FwLFxuICAgIG9mOiBvZixcbiAgICBjaGFpbjogZmxhdE1hcCxcbiAgICB0aHJvd0Vycm9yOiB0aHJvd0Vycm9yXG59O1xuLyoqXG4gKiBUcmFuc2Zvcm1zIGFuIGBFaXRoZXJgIHRvIGFuIGBPcHRpb25gIGRpc2NhcmRpbmcgdGhlIGVycm9yLlxuICpcbiAqIEFsaWFzIG9mIFtnZXRSaWdodF0oI2dldHJpZ2h0KVxuICpcbiAqIEBjYXRlZ29yeSBjb252ZXJzaW9uc1xuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgZnJvbUVpdGhlciA9IGdldFJpZ2h0O1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi4xMS4wXG4gKi9cbmV4cG9ydCB2YXIgRnJvbUVpdGhlciA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICBmcm9tRWl0aGVyOiBmcm9tRWl0aGVyXG59O1xuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLy8gcmVmaW5lbWVudHNcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8qKlxuICogUmV0dXJucyBgdHJ1ZWAgaWYgdGhlIG9wdGlvbiBpcyBhbiBpbnN0YW5jZSBvZiBgU29tZWAsIGBmYWxzZWAgb3RoZXJ3aXNlLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBzb21lLCBub25lLCBpc1NvbWUgfSBmcm9tICdmcC10cy9PcHRpb24nXG4gKlxuICogYXNzZXJ0LnN0cmljdEVxdWFsKGlzU29tZShzb21lKDEpKSwgdHJ1ZSlcbiAqIGFzc2VydC5zdHJpY3RFcXVhbChpc1NvbWUobm9uZSksIGZhbHNlKVxuICpcbiAqIEBjYXRlZ29yeSByZWZpbmVtZW50c1xuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgaXNTb21lID0gXy5pc1NvbWU7XG4vKipcbiAqIFJldHVybnMgYHRydWVgIGlmIHRoZSBvcHRpb24gaXMgYE5vbmVgLCBgZmFsc2VgIG90aGVyd2lzZS5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgc29tZSwgbm9uZSwgaXNOb25lIH0gZnJvbSAnZnAtdHMvT3B0aW9uJ1xuICpcbiAqIGFzc2VydC5zdHJpY3RFcXVhbChpc05vbmUoc29tZSgxKSksIGZhbHNlKVxuICogYXNzZXJ0LnN0cmljdEVxdWFsKGlzTm9uZShub25lKSwgdHJ1ZSlcbiAqXG4gKiBAY2F0ZWdvcnkgcmVmaW5lbWVudHNcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIGlzTm9uZSA9IGZ1bmN0aW9uIChmYSkgeyByZXR1cm4gZmEuX3RhZyA9PT0gJ05vbmUnOyB9O1xuLyoqXG4gKiBMZXNzIHN0cmljdCB2ZXJzaW9uIG9mIFtgbWF0Y2hgXSgjbWF0Y2gpLlxuICpcbiAqIFRoZSBgV2Agc3VmZml4IChzaG9ydCBmb3IgKipXKippZGVuaW5nKSBtZWFucyB0aGF0IHRoZSBoYW5kbGVyIHJldHVybiB0eXBlcyB3aWxsIGJlIG1lcmdlZC5cbiAqXG4gKiBAY2F0ZWdvcnkgcGF0dGVybiBtYXRjaGluZ1xuICogQHNpbmNlIDIuMTAuMFxuICovXG5leHBvcnQgdmFyIG1hdGNoVyA9IGZ1bmN0aW9uIChvbk5vbmUsIG9uU29tZSkge1xuICAgIHJldHVybiBmdW5jdGlvbiAobWEpIHtcbiAgICAgICAgcmV0dXJuIGlzTm9uZShtYSkgPyBvbk5vbmUoKSA6IG9uU29tZShtYS52YWx1ZSk7XG4gICAgfTtcbn07XG4vKipcbiAqIEFsaWFzIG9mIFtgbWF0Y2hXYF0oI21hdGNodykuXG4gKlxuICogQGNhdGVnb3J5IHBhdHRlcm4gbWF0Y2hpbmdcbiAqIEBzaW5jZSAyLjEwLjBcbiAqL1xuZXhwb3J0IHZhciBmb2xkVyA9IG1hdGNoVztcbi8qKlxuICogVGFrZXMgYSAobGF6eSkgZGVmYXVsdCB2YWx1ZSwgYSBmdW5jdGlvbiwgYW5kIGFuIGBPcHRpb25gIHZhbHVlLCBpZiB0aGUgYE9wdGlvbmAgdmFsdWUgaXMgYE5vbmVgIHRoZSBkZWZhdWx0IHZhbHVlIGlzXG4gKiByZXR1cm5lZCwgb3RoZXJ3aXNlIHRoZSBmdW5jdGlvbiBpcyBhcHBsaWVkIHRvIHRoZSB2YWx1ZSBpbnNpZGUgdGhlIGBTb21lYCBhbmQgdGhlIHJlc3VsdCBpcyByZXR1cm5lZC5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgc29tZSwgbm9uZSwgbWF0Y2ggfSBmcm9tICdmcC10cy9PcHRpb24nXG4gKiBpbXBvcnQgeyBwaXBlIH0gZnJvbSAnZnAtdHMvZnVuY3Rpb24nXG4gKlxuICogYXNzZXJ0LnN0cmljdEVxdWFsKFxuICogICBwaXBlKFxuICogICAgIHNvbWUoMSksXG4gKiAgICAgbWF0Y2goKCkgPT4gJ2Egbm9uZScsIGEgPT4gYGEgc29tZSBjb250YWluaW5nICR7YX1gKVxuICogICApLFxuICogICAnYSBzb21lIGNvbnRhaW5pbmcgMSdcbiAqIClcbiAqXG4gKiBhc3NlcnQuc3RyaWN0RXF1YWwoXG4gKiAgIHBpcGUoXG4gKiAgICAgbm9uZSxcbiAqICAgICBtYXRjaCgoKSA9PiAnYSBub25lJywgYSA9PiBgYSBzb21lIGNvbnRhaW5pbmcgJHthfWApXG4gKiAgICksXG4gKiAgICdhIG5vbmUnXG4gKiApXG4gKlxuICogQGNhdGVnb3J5IHBhdHRlcm4gbWF0Y2hpbmdcbiAqIEBzaW5jZSAyLjEwLjBcbiAqL1xuZXhwb3J0IHZhciBtYXRjaCA9IG1hdGNoVztcbi8qKlxuICogQWxpYXMgb2YgW2BtYXRjaGBdKCNtYXRjaCkuXG4gKlxuICogQGNhdGVnb3J5IHBhdHRlcm4gbWF0Y2hpbmdcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIGZvbGQgPSBtYXRjaDtcbi8qKlxuICogTGVzcyBzdHJpY3QgdmVyc2lvbiBvZiBbYGdldE9yRWxzZWBdKCNnZXRvcmVsc2UpLlxuICpcbiAqIFRoZSBgV2Agc3VmZml4IChzaG9ydCBmb3IgKipXKippZGVuaW5nKSBtZWFucyB0aGF0IHRoZSBoYW5kbGVyIHJldHVybiB0eXBlIHdpbGwgYmUgbWVyZ2VkLlxuICpcbiAqIEBjYXRlZ29yeSBlcnJvciBoYW5kbGluZ1xuICogQHNpbmNlIDIuNi4wXG4gKi9cbmV4cG9ydCB2YXIgZ2V0T3JFbHNlVyA9IGZ1bmN0aW9uIChvbk5vbmUpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKG1hKSB7XG4gICAgICAgIHJldHVybiBpc05vbmUobWEpID8gb25Ob25lKCkgOiBtYS52YWx1ZTtcbiAgICB9O1xufTtcbi8qKlxuICogRXh0cmFjdHMgdGhlIHZhbHVlIG91dCBvZiB0aGUgc3RydWN0dXJlLCBpZiBpdCBleGlzdHMuIE90aGVyd2lzZSByZXR1cm5zIHRoZSBnaXZlbiBkZWZhdWx0IHZhbHVlXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IHNvbWUsIG5vbmUsIGdldE9yRWxzZSB9IGZyb20gJ2ZwLXRzL09wdGlvbidcbiAqIGltcG9ydCB7IHBpcGUgfSBmcm9tICdmcC10cy9mdW5jdGlvbidcbiAqXG4gKiBhc3NlcnQuc3RyaWN0RXF1YWwoXG4gKiAgIHBpcGUoXG4gKiAgICAgc29tZSgxKSxcbiAqICAgICBnZXRPckVsc2UoKCkgPT4gMClcbiAqICAgKSxcbiAqICAgMVxuICogKVxuICogYXNzZXJ0LnN0cmljdEVxdWFsKFxuICogICBwaXBlKFxuICogICAgIG5vbmUsXG4gKiAgICAgZ2V0T3JFbHNlKCgpID0+IDApXG4gKiAgICksXG4gKiAgIDBcbiAqIClcbiAqXG4gKiBAY2F0ZWdvcnkgZXJyb3IgaGFuZGxpbmdcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIGdldE9yRWxzZSA9IGdldE9yRWxzZVc7XG4vKipcbiAqIEBjYXRlZ29yeSBtYXBwaW5nXG4gKiBAc2luY2UgMi4xMC4wXG4gKi9cbmV4cG9ydCB2YXIgZmxhcCA9IC8qI19fUFVSRV9fKi8gZmxhcF8oRnVuY3Rvcik7XG4vKipcbiAqIENvbWJpbmUgdHdvIGVmZmVjdGZ1bCBhY3Rpb25zLCBrZWVwaW5nIG9ubHkgdGhlIHJlc3VsdCBvZiB0aGUgZmlyc3QuXG4gKlxuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgYXBGaXJzdCA9IC8qI19fUFVSRV9fKi8gYXBGaXJzdF8oQXBwbHkpO1xuLyoqXG4gKiBDb21iaW5lIHR3byBlZmZlY3RmdWwgYWN0aW9ucywga2VlcGluZyBvbmx5IHRoZSByZXN1bHQgb2YgdGhlIHNlY29uZC5cbiAqXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciBhcFNlY29uZCA9IC8qI19fUFVSRV9fKi8gYXBTZWNvbmRfKEFwcGx5KTtcbi8qKlxuICogQGNhdGVnb3J5IHNlcXVlbmNpbmdcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIGZsYXR0ZW4gPSBjb21wYWN0O1xuLyoqXG4gKiBDb21wb3NlcyBjb21wdXRhdGlvbnMgaW4gc2VxdWVuY2UsIHVzaW5nIHRoZSByZXR1cm4gdmFsdWUgb2Ygb25lIGNvbXB1dGF0aW9uIHRvIGRldGVybWluZSB0aGUgbmV4dCBjb21wdXRhdGlvbiBhbmRcbiAqIGtlZXBpbmcgb25seSB0aGUgcmVzdWx0IG9mIHRoZSBmaXJzdC5cbiAqXG4gKiBAY2F0ZWdvcnkgY29tYmluYXRvcnNcbiAqIEBzaW5jZSAyLjE1LjBcbiAqL1xuZXhwb3J0IHZhciB0YXAgPSAvKiNfX1BVUkVfXyovIGR1YWwoMiwgY2hhaW5hYmxlLnRhcChDaGFpbikpO1xuLyoqXG4gKiBDb21wb3NlcyBjb21wdXRhdGlvbnMgaW4gc2VxdWVuY2UsIHVzaW5nIHRoZSByZXR1cm4gdmFsdWUgb2Ygb25lIGNvbXB1dGF0aW9uIHRvIGRldGVybWluZSB0aGUgbmV4dCBjb21wdXRhdGlvbiBhbmRcbiAqIGtlZXBpbmcgb25seSB0aGUgcmVzdWx0IG9mIHRoZSBmaXJzdC5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgcGlwZSB9IGZyb20gJ2ZwLXRzL2Z1bmN0aW9uJ1xuICogaW1wb3J0ICogYXMgTyBmcm9tICdmcC10cy9PcHRpb24nXG4gKiBpbXBvcnQgKiBhcyBFIGZyb20gJ2ZwLXRzL0VpdGhlcidcbiAqXG4gKiBjb25zdCBjb21wdXRlID0gKHZhbHVlOiBudW1iZXIpID0+IHBpcGUoXG4gKiAgIE8ub2YodmFsdWUpLFxuICogICBPLnRhcEVpdGhlcigodmFsdWUpID0+IHZhbHVlID4gMCA/IEUucmlnaHQoJ29rJykgOiBFLmxlZnQoJ2Vycm9yJykpLFxuICogKVxuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoY29tcHV0ZSgxKSwgTy5vZigxKSlcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoY29tcHV0ZSgtNDIpLCBPLm5vbmUpXG4gKlxuICogQGNhdGVnb3J5IGNvbWJpbmF0b3JzXG4gKiBAc2luY2UgMi4xNi4wXG4gKi9cbmV4cG9ydCB2YXIgdGFwRWl0aGVyID0gLyojX19QVVJFX18qLyBkdWFsKDIsIHRhcEVpdGhlcl8oRnJvbUVpdGhlciwgQ2hhaW4pKTtcbi8qKlxuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgZHVwbGljYXRlID0gLyojX19QVVJFX18qLyBleHRlbmQoaWRlbnRpdHkpO1xuLyoqXG4gKiBAY2F0ZWdvcnkgbGlmdGluZ1xuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIGZyb21FaXRoZXJLID0gLyojX19QVVJFX18qLyBmcm9tRWl0aGVyS18oRnJvbUVpdGhlcik7XG4vKipcbiAqIEBjYXRlZ29yeSBzZXF1ZW5jaW5nXG4gKiBAc2luY2UgMi4xMS4wXG4gKi9cbmV4cG9ydCB2YXIgY2hhaW5FaXRoZXJLID0gXG4vKiNfX1BVUkVfXyovIGNoYWluRWl0aGVyS18oRnJvbUVpdGhlciwgQ2hhaW4pO1xuLyoqXG4gKiBBbGlhcyBvZiBgdGFwRWl0aGVyYC5cbiAqXG4gKiBAY2F0ZWdvcnkgbGVnYWN5XG4gKiBAc2luY2UgMi4xMi4wXG4gKi9cbmV4cG9ydCB2YXIgY2hhaW5GaXJzdEVpdGhlcksgPSB0YXBFaXRoZXI7XG4vKipcbiAqIENvbnN0cnVjdHMgYSBuZXcgYE9wdGlvbmAgZnJvbSBhIG51bGxhYmxlIHR5cGUuIElmIHRoZSB2YWx1ZSBpcyBgbnVsbGAgb3IgYHVuZGVmaW5lZGAsIHJldHVybnMgYE5vbmVgLCBvdGhlcndpc2VcbiAqIHJldHVybnMgdGhlIHZhbHVlIHdyYXBwZWQgaW4gYSBgU29tZWAuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IG5vbmUsIHNvbWUsIGZyb21OdWxsYWJsZSB9IGZyb20gJ2ZwLXRzL09wdGlvbidcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKGZyb21OdWxsYWJsZSh1bmRlZmluZWQpLCBub25lKVxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChmcm9tTnVsbGFibGUobnVsbCksIG5vbmUpXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKGZyb21OdWxsYWJsZSgxKSwgc29tZSgxKSlcbiAqXG4gKiBAY2F0ZWdvcnkgY29udmVyc2lvbnNcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIGZyb21OdWxsYWJsZSA9IGZ1bmN0aW9uIChhKSB7IHJldHVybiAoYSA9PSBudWxsID8gbm9uZSA6IHNvbWUoYSkpOyB9O1xuLyoqXG4gKiBUcmFuc2Zvcm1zIGFuIGV4Y2VwdGlvbiBpbnRvIGFuIGBPcHRpb25gLiBJZiBgZmAgdGhyb3dzLCByZXR1cm5zIGBOb25lYCwgb3RoZXJ3aXNlIHJldHVybnMgdGhlIG91dHB1dCB3cmFwcGVkIGluIGFcbiAqIGBTb21lYC5cbiAqXG4gKiBTZWUgYWxzbyBbYHRyeUNhdGNoS2BdKCN0cnljYXRjaGspLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBub25lLCBzb21lLCB0cnlDYXRjaCB9IGZyb20gJ2ZwLXRzL09wdGlvbidcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKFxuICogICB0cnlDYXRjaCgoKSA9PiB7XG4gKiAgICAgdGhyb3cgbmV3IEVycm9yKClcbiAqICAgfSksXG4gKiAgIG5vbmVcbiAqIClcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwodHJ5Q2F0Y2goKCkgPT4gMSksIHNvbWUoMSkpXG4gKlxuICogQGNhdGVnb3J5IGludGVyb3BcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIHRyeUNhdGNoID0gZnVuY3Rpb24gKGYpIHtcbiAgICB0cnkge1xuICAgICAgICByZXR1cm4gc29tZShmKCkpO1xuICAgIH1cbiAgICBjYXRjaCAoZSkge1xuICAgICAgICByZXR1cm4gbm9uZTtcbiAgICB9XG59O1xuLyoqXG4gKiBDb252ZXJ0cyBhIGZ1bmN0aW9uIHRoYXQgbWF5IHRocm93IHRvIG9uZSByZXR1cm5pbmcgYSBgT3B0aW9uYC5cbiAqXG4gKiBAY2F0ZWdvcnkgaW50ZXJvcFxuICogQHNpbmNlIDIuMTAuMFxuICovXG5leHBvcnQgdmFyIHRyeUNhdGNoSyA9IGZ1bmN0aW9uIChmKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIGEgPSBbXTtcbiAgICAgICAgZm9yICh2YXIgX2kgPSAwOyBfaSA8IGFyZ3VtZW50cy5sZW5ndGg7IF9pKyspIHtcbiAgICAgICAgICAgIGFbX2ldID0gYXJndW1lbnRzW19pXTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdHJ5Q2F0Y2goZnVuY3Rpb24gKCkgeyByZXR1cm4gZi5hcHBseSh2b2lkIDAsIGEpOyB9KTtcbiAgICB9O1xufTtcbi8qKlxuICogUmV0dXJucyBhICpzbWFydCBjb25zdHJ1Y3RvciogZnJvbSBhIGZ1bmN0aW9uIHRoYXQgcmV0dXJucyBhIG51bGxhYmxlIHZhbHVlLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBmcm9tTnVsbGFibGVLLCBub25lLCBzb21lIH0gZnJvbSAnZnAtdHMvT3B0aW9uJ1xuICpcbiAqIGNvbnN0IGYgPSAoczogc3RyaW5nKTogbnVtYmVyIHwgdW5kZWZpbmVkID0+IHtcbiAqICAgY29uc3QgbiA9IHBhcnNlRmxvYXQocylcbiAqICAgcmV0dXJuIGlzTmFOKG4pID8gdW5kZWZpbmVkIDogblxuICogfVxuICpcbiAqIGNvbnN0IGcgPSBmcm9tTnVsbGFibGVLKGYpXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChnKCcxJyksIHNvbWUoMSkpXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKGcoJ2EnKSwgbm9uZSlcbiAqXG4gKiBAY2F0ZWdvcnkgbGlmdGluZ1xuICogQHNpbmNlIDIuOS4wXG4gKi9cbmV4cG9ydCB2YXIgZnJvbU51bGxhYmxlSyA9IGZ1bmN0aW9uIChmKSB7IHJldHVybiBmbG93KGYsIGZyb21OdWxsYWJsZSk7IH07XG4vKipcbiAqIFRoaXMgaXMgYGNoYWluYCArIGBmcm9tTnVsbGFibGVgLCB1c2VmdWwgd2hlbiB3b3JraW5nIHdpdGggb3B0aW9uYWwgdmFsdWVzLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBzb21lLCBub25lLCBmcm9tTnVsbGFibGUsIGNoYWluTnVsbGFibGVLIH0gZnJvbSAnZnAtdHMvT3B0aW9uJ1xuICogaW1wb3J0IHsgcGlwZSB9IGZyb20gJ2ZwLXRzL2Z1bmN0aW9uJ1xuICpcbiAqIGludGVyZmFjZSBFbXBsb3llZSB7XG4gKiAgIHJlYWRvbmx5IGNvbXBhbnk/OiB7XG4gKiAgICAgcmVhZG9ubHkgYWRkcmVzcz86IHtcbiAqICAgICAgIHJlYWRvbmx5IHN0cmVldD86IHtcbiAqICAgICAgICAgcmVhZG9ubHkgbmFtZT86IHN0cmluZ1xuICogICAgICAgfVxuICogICAgIH1cbiAqICAgfVxuICogfVxuICpcbiAqIGNvbnN0IGVtcGxveWVlMTogRW1wbG95ZWUgPSB7IGNvbXBhbnk6IHsgYWRkcmVzczogeyBzdHJlZXQ6IHsgbmFtZTogJ2hpZ2ggc3RyZWV0JyB9IH0gfSB9XG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChcbiAqICAgcGlwZShcbiAqICAgICBmcm9tTnVsbGFibGUoZW1wbG95ZWUxLmNvbXBhbnkpLFxuICogICAgIGNoYWluTnVsbGFibGVLKGNvbXBhbnkgPT4gY29tcGFueS5hZGRyZXNzKSxcbiAqICAgICBjaGFpbk51bGxhYmxlSyhhZGRyZXNzID0+IGFkZHJlc3Muc3RyZWV0KSxcbiAqICAgICBjaGFpbk51bGxhYmxlSyhzdHJlZXQgPT4gc3RyZWV0Lm5hbWUpXG4gKiAgICksXG4gKiAgIHNvbWUoJ2hpZ2ggc3RyZWV0JylcbiAqIClcbiAqXG4gKiBjb25zdCBlbXBsb3llZTI6IEVtcGxveWVlID0geyBjb21wYW55OiB7IGFkZHJlc3M6IHsgc3RyZWV0OiB7fSB9IH0gfVxuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoXG4gKiAgIHBpcGUoXG4gKiAgICAgZnJvbU51bGxhYmxlKGVtcGxveWVlMi5jb21wYW55KSxcbiAqICAgICBjaGFpbk51bGxhYmxlSyhjb21wYW55ID0+IGNvbXBhbnkuYWRkcmVzcyksXG4gKiAgICAgY2hhaW5OdWxsYWJsZUsoYWRkcmVzcyA9PiBhZGRyZXNzLnN0cmVldCksXG4gKiAgICAgY2hhaW5OdWxsYWJsZUsoc3RyZWV0ID0+IHN0cmVldC5uYW1lKVxuICogICApLFxuICogICBub25lXG4gKiApXG4gKlxuICogQGNhdGVnb3J5IHNlcXVlbmNpbmdcbiAqIEBzaW5jZSAyLjkuMFxuICovXG5leHBvcnQgdmFyIGNoYWluTnVsbGFibGVLID0gZnVuY3Rpb24gKGYpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKG1hKSB7XG4gICAgICAgIHJldHVybiBpc05vbmUobWEpID8gbm9uZSA6IGZyb21OdWxsYWJsZShmKG1hLnZhbHVlKSk7XG4gICAgfTtcbn07XG4vKipcbiAqIEV4dHJhY3RzIHRoZSB2YWx1ZSBvdXQgb2YgdGhlIHN0cnVjdHVyZSwgaWYgaXQgZXhpc3RzLiBPdGhlcndpc2UgcmV0dXJucyBgbnVsbGAuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IHNvbWUsIG5vbmUsIHRvTnVsbGFibGUgfSBmcm9tICdmcC10cy9PcHRpb24nXG4gKiBpbXBvcnQgeyBwaXBlIH0gZnJvbSAnZnAtdHMvZnVuY3Rpb24nXG4gKlxuICogYXNzZXJ0LnN0cmljdEVxdWFsKFxuICogICBwaXBlKFxuICogICAgIHNvbWUoMSksXG4gKiAgICAgdG9OdWxsYWJsZVxuICogICApLFxuICogICAxXG4gKiApXG4gKiBhc3NlcnQuc3RyaWN0RXF1YWwoXG4gKiAgIHBpcGUoXG4gKiAgICAgbm9uZSxcbiAqICAgICB0b051bGxhYmxlXG4gKiAgICksXG4gKiAgIG51bGxcbiAqIClcbiAqXG4gKiBAY2F0ZWdvcnkgY29udmVyc2lvbnNcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIHRvTnVsbGFibGUgPSAvKiNfX1BVUkVfXyovIG1hdGNoKGNvbnN0TnVsbCwgaWRlbnRpdHkpO1xuLyoqXG4gKiBFeHRyYWN0cyB0aGUgdmFsdWUgb3V0IG9mIHRoZSBzdHJ1Y3R1cmUsIGlmIGl0IGV4aXN0cy4gT3RoZXJ3aXNlIHJldHVybnMgYHVuZGVmaW5lZGAuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IHNvbWUsIG5vbmUsIHRvVW5kZWZpbmVkIH0gZnJvbSAnZnAtdHMvT3B0aW9uJ1xuICogaW1wb3J0IHsgcGlwZSB9IGZyb20gJ2ZwLXRzL2Z1bmN0aW9uJ1xuICpcbiAqIGFzc2VydC5zdHJpY3RFcXVhbChcbiAqICAgcGlwZShcbiAqICAgICBzb21lKDEpLFxuICogICAgIHRvVW5kZWZpbmVkXG4gKiAgICksXG4gKiAgIDFcbiAqIClcbiAqIGFzc2VydC5zdHJpY3RFcXVhbChcbiAqICAgcGlwZShcbiAqICAgICBub25lLFxuICogICAgIHRvVW5kZWZpbmVkXG4gKiAgICksXG4gKiAgIHVuZGVmaW5lZFxuICogKVxuICpcbiAqIEBjYXRlZ29yeSBjb252ZXJzaW9uc1xuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgdG9VbmRlZmluZWQgPSAvKiNfX1BVUkVfXyovIG1hdGNoKGNvbnN0VW5kZWZpbmVkLCBpZGVudGl0eSk7XG5leHBvcnQgZnVuY3Rpb24gZWxlbShFKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhLCBtYSkge1xuICAgICAgICBpZiAobWEgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgdmFyIGVsZW1FXzEgPSBlbGVtKEUpO1xuICAgICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIChtYSkgeyByZXR1cm4gZWxlbUVfMShhLCBtYSk7IH07XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGlzTm9uZShtYSkgPyBmYWxzZSA6IEUuZXF1YWxzKGEsIG1hLnZhbHVlKTtcbiAgICB9O1xufVxuLyoqXG4gKiBSZXR1cm5zIGB0cnVlYCBpZiB0aGUgcHJlZGljYXRlIGlzIHNhdGlzZmllZCBieSB0aGUgd3JhcHBlZCB2YWx1ZVxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBzb21lLCBub25lLCBleGlzdHMgfSBmcm9tICdmcC10cy9PcHRpb24nXG4gKiBpbXBvcnQgeyBwaXBlIH0gZnJvbSAnZnAtdHMvZnVuY3Rpb24nXG4gKlxuICogYXNzZXJ0LnN0cmljdEVxdWFsKFxuICogICBwaXBlKFxuICogICAgIHNvbWUoMSksXG4gKiAgICAgZXhpc3RzKG4gPT4gbiA+IDApXG4gKiAgICksXG4gKiAgIHRydWVcbiAqIClcbiAqIGFzc2VydC5zdHJpY3RFcXVhbChcbiAqICAgcGlwZShcbiAqICAgICBzb21lKDEpLFxuICogICAgIGV4aXN0cyhuID0+IG4gPiAxKVxuICogICApLFxuICogICBmYWxzZVxuICogKVxuICogYXNzZXJ0LnN0cmljdEVxdWFsKFxuICogICBwaXBlKFxuICogICAgIG5vbmUsXG4gKiAgICAgZXhpc3RzKG4gPT4gbiA+IDApXG4gKiAgICksXG4gKiAgIGZhbHNlXG4gKiApXG4gKlxuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgZXhpc3RzID0gZnVuY3Rpb24gKHByZWRpY2F0ZSkge1xuICAgIHJldHVybiBmdW5jdGlvbiAobWEpIHtcbiAgICAgICAgcmV0dXJuIGlzTm9uZShtYSkgPyBmYWxzZSA6IHByZWRpY2F0ZShtYS52YWx1ZSk7XG4gICAgfTtcbn07XG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vLyBkbyBub3RhdGlvblxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLyoqXG4gKiBAY2F0ZWdvcnkgZG8gbm90YXRpb25cbiAqIEBzaW5jZSAyLjkuMFxuICovXG5leHBvcnQgdmFyIERvID0gLyojX19QVVJFX18qLyBvZihfLmVtcHR5UmVjb3JkKTtcbi8qKlxuICogQGNhdGVnb3J5IGRvIG5vdGF0aW9uXG4gKiBAc2luY2UgMi44LjBcbiAqL1xuZXhwb3J0IHZhciBiaW5kVG8gPSAvKiNfX1BVUkVfXyovIGJpbmRUb18oRnVuY3Rvcik7XG52YXIgbGV0XyA9IC8qI19fUFVSRV9fKi8gbGV0X18oRnVuY3Rvcik7XG5leHBvcnQgeyBcbi8qKlxuICogQGNhdGVnb3J5IGRvIG5vdGF0aW9uXG4gKiBAc2luY2UgMi4xMy4wXG4gKi9cbmxldF8gYXMgbGV0IH07XG4vKipcbiAqIEBjYXRlZ29yeSBkbyBub3RhdGlvblxuICogQHNpbmNlIDIuOC4wXG4gKi9cbmV4cG9ydCB2YXIgYmluZCA9IC8qI19fUFVSRV9fKi8gY2hhaW5hYmxlLmJpbmQoQ2hhaW4pO1xuLyoqXG4gKiBAY2F0ZWdvcnkgZG8gbm90YXRpb25cbiAqIEBzaW5jZSAyLjguMFxuICovXG5leHBvcnQgdmFyIGFwUyA9IC8qI19fUFVSRV9fKi8gYXBTXyhBcHBseSk7XG4vKipcbiAqIEBzaW5jZSAyLjExLjBcbiAqL1xuZXhwb3J0IHZhciBBcFQgPSAvKiNfX1BVUkVfXyovIG9mKF8uZW1wdHlSZWFkb25seUFycmF5KTtcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8vIGFycmF5IHV0aWxzXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vKipcbiAqIEVxdWl2YWxlbnQgdG8gYFJlYWRvbmx5Tm9uRW1wdHlBcnJheSN0cmF2ZXJzZVdpdGhJbmRleChBcHBsaWNhdGl2ZSlgLlxuICpcbiAqIEBjYXRlZ29yeSB0cmF2ZXJzaW5nXG4gKiBAc2luY2UgMi4xMS4wXG4gKi9cbmV4cG9ydCB2YXIgdHJhdmVyc2VSZWFkb25seU5vbkVtcHR5QXJyYXlXaXRoSW5kZXggPSBmdW5jdGlvbiAoZikge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgdmFyIG8gPSBmKDAsIF8uaGVhZChhcykpO1xuICAgICAgICBpZiAoaXNOb25lKG8pKSB7XG4gICAgICAgICAgICByZXR1cm4gbm9uZTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgb3V0ID0gW28udmFsdWVdO1xuICAgICAgICBmb3IgKHZhciBpID0gMTsgaSA8IGFzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICB2YXIgb18xID0gZihpLCBhc1tpXSk7XG4gICAgICAgICAgICBpZiAoaXNOb25lKG9fMSkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gbm9uZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIG91dC5wdXNoKG9fMS52YWx1ZSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHNvbWUob3V0KTtcbiAgICB9O1xufTtcbi8qKlxuICogRXF1aXZhbGVudCB0byBgUmVhZG9ubHlBcnJheSN0cmF2ZXJzZVdpdGhJbmRleChBcHBsaWNhdGl2ZSlgLlxuICpcbiAqIEBjYXRlZ29yeSB0cmF2ZXJzaW5nXG4gKiBAc2luY2UgMi4xMS4wXG4gKi9cbmV4cG9ydCB2YXIgdHJhdmVyc2VSZWFkb25seUFycmF5V2l0aEluZGV4ID0gZnVuY3Rpb24gKGYpIHtcbiAgICB2YXIgZyA9IHRyYXZlcnNlUmVhZG9ubHlOb25FbXB0eUFycmF5V2l0aEluZGV4KGYpO1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHsgcmV0dXJuIChfLmlzTm9uRW1wdHkoYXMpID8gZyhhcykgOiBBcFQpOyB9O1xufTtcbi8qKlxuICogRXF1aXZhbGVudCB0byBgUmVhZG9ubHlBcnJheSN0cmF2ZXJzZVdpdGhJbmRleChBcHBsaWNhdGl2ZSlgLlxuICpcbiAqIEBjYXRlZ29yeSB0cmF2ZXJzaW5nXG4gKiBAc2luY2UgMi45LjBcbiAqL1xuZXhwb3J0IHZhciB0cmF2ZXJzZUFycmF5V2l0aEluZGV4ID0gdHJhdmVyc2VSZWFkb25seUFycmF5V2l0aEluZGV4O1xuLyoqXG4gKiBFcXVpdmFsZW50IHRvIGBSZWFkb25seUFycmF5I3RyYXZlcnNlKEFwcGxpY2F0aXZlKWAuXG4gKlxuICogQGNhdGVnb3J5IHRyYXZlcnNpbmdcbiAqIEBzaW5jZSAyLjkuMFxuICovXG5leHBvcnQgdmFyIHRyYXZlcnNlQXJyYXkgPSBmdW5jdGlvbiAoZikge1xuICAgIHJldHVybiB0cmF2ZXJzZVJlYWRvbmx5QXJyYXlXaXRoSW5kZXgoZnVuY3Rpb24gKF8sIGEpIHsgcmV0dXJuIGYoYSk7IH0pO1xufTtcbi8qKlxuICogRXF1aXZhbGVudCB0byBgUmVhZG9ubHlBcnJheSNzZXF1ZW5jZShBcHBsaWNhdGl2ZSlgLlxuICpcbiAqIEBjYXRlZ29yeSB0cmF2ZXJzaW5nXG4gKiBAc2luY2UgMi45LjBcbiAqL1xuZXhwb3J0IHZhciBzZXF1ZW5jZUFycmF5ID0gXG4vKiNfX1BVUkVfXyovIHRyYXZlcnNlQXJyYXkoaWRlbnRpdHkpO1xuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLy8gbGVnYWN5XG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vKipcbiAqIEFsaWFzIG9mIGBmbGF0TWFwYC5cbiAqXG4gKiBAY2F0ZWdvcnkgbGVnYWN5XG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciBjaGFpbiA9IGZsYXRNYXA7XG4vKipcbiAqIEFsaWFzIG9mIGB0YXBgLlxuICpcbiAqIEBjYXRlZ29yeSBsZWdhY3lcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIGNoYWluRmlyc3QgPSB0YXA7XG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vLyBkZXByZWNhdGVkXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vKipcbiAqIFVzZSBgUmVmaW5lbWVudGAgbW9kdWxlIGluc3RlYWQuXG4gKlxuICogQGNhdGVnb3J5IHpvbmUgb2YgZGVhdGhcbiAqIEBzaW5jZSAyLjAuMFxuICogQGRlcHJlY2F0ZWRcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGdldFJlZmluZW1lbnQoZ2V0T3B0aW9uKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhKSB7IHJldHVybiBpc1NvbWUoZ2V0T3B0aW9uKGEpKTsgfTtcbn1cbi8qKlxuICogVXNlIFtgY2hhaW5OdWxsYWJsZUtgXSgjY2hhaW5udWxsYWJsZWspIGluc3RlYWQuXG4gKlxuICogQGNhdGVnb3J5IHpvbmUgb2YgZGVhdGhcbiAqIEBzaW5jZSAyLjAuMFxuICogQGRlcHJlY2F0ZWRcbiAqL1xuZXhwb3J0IHZhciBtYXBOdWxsYWJsZSA9IGNoYWluTnVsbGFibGVLO1xuLyoqXG4gKiBUaGlzIGluc3RhbmNlIGlzIGRlcHJlY2F0ZWQsIHVzZSBzbWFsbCwgc3BlY2lmaWMgaW5zdGFuY2VzIGluc3RlYWQuXG4gKiBGb3IgZXhhbXBsZSBpZiBhIGZ1bmN0aW9uIG5lZWRzIGEgYEZ1bmN0b3JgIGluc3RhbmNlLCBwYXNzIGBPLkZ1bmN0b3JgIGluc3RlYWQgb2YgYE8ub3B0aW9uYFxuICogKHdoZXJlIGBPYCBpcyBmcm9tIGBpbXBvcnQgTyBmcm9tICdmcC10cy9PcHRpb24nYClcbiAqXG4gKiBAY2F0ZWdvcnkgem9uZSBvZiBkZWF0aFxuICogQHNpbmNlIDIuMC4wXG4gKiBAZGVwcmVjYXRlZFxuICovXG5leHBvcnQgdmFyIG9wdGlvbiA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICBtYXA6IF9tYXAsXG4gICAgb2Y6IG9mLFxuICAgIGFwOiBfYXAsXG4gICAgY2hhaW46IGZsYXRNYXAsXG4gICAgcmVkdWNlOiBfcmVkdWNlLFxuICAgIGZvbGRNYXA6IF9mb2xkTWFwLFxuICAgIHJlZHVjZVJpZ2h0OiBfcmVkdWNlUmlnaHQsXG4gICAgdHJhdmVyc2U6IF90cmF2ZXJzZSxcbiAgICBzZXF1ZW5jZTogc2VxdWVuY2UsXG4gICAgemVybzogemVybyxcbiAgICBhbHQ6IF9hbHQsXG4gICAgZXh0ZW5kOiBfZXh0ZW5kLFxuICAgIGNvbXBhY3Q6IGNvbXBhY3QsXG4gICAgc2VwYXJhdGU6IHNlcGFyYXRlLFxuICAgIGZpbHRlcjogX2ZpbHRlcixcbiAgICBmaWx0ZXJNYXA6IF9maWx0ZXJNYXAsXG4gICAgcGFydGl0aW9uOiBfcGFydGl0aW9uLFxuICAgIHBhcnRpdGlvbk1hcDogX3BhcnRpdGlvbk1hcCxcbiAgICB3aXRoZXI6IF93aXRoZXIsXG4gICAgd2lsdDogX3dpbHQsXG4gICAgdGhyb3dFcnJvcjogdGhyb3dFcnJvclxufTtcbi8qKlxuICogVXNlIFtgZ2V0QXBwbHlTZW1pZ3JvdXBgXSguL0FwcGx5LnRzLmh0bWwjZ2V0YXBwbHlzZW1pZ3JvdXApIGluc3RlYWQuXG4gKlxuICogQGNhdGVnb3J5IHpvbmUgb2YgZGVhdGhcbiAqIEBzaW5jZSAyLjAuMFxuICogQGRlcHJlY2F0ZWRcbiAqL1xuZXhwb3J0IHZhciBnZXRBcHBseVNlbWlncm91cCA9IC8qI19fUFVSRV9fKi8gZ2V0QXBwbHlTZW1pZ3JvdXBfKEFwcGx5KTtcbi8qKlxuICogVXNlIFtgZ2V0QXBwbGljYXRpdmVNb25vaWRgXSguL0FwcGxpY2F0aXZlLnRzLmh0bWwjZ2V0YXBwbGljYXRpdmVtb25vaWQpIGluc3RlYWQuXG4gKlxuICogQGNhdGVnb3J5IHpvbmUgb2YgZGVhdGhcbiAqIEBzaW5jZSAyLjAuMFxuICogQGRlcHJlY2F0ZWRcbiAqL1xuZXhwb3J0IHZhciBnZXRBcHBseU1vbm9pZCA9IC8qI19fUFVSRV9fKi8gZ2V0QXBwbGljYXRpdmVNb25vaWQoQXBwbGljYXRpdmUpO1xuLyoqXG4gKiBVc2VcbiAqXG4gKiBgYGB0c1xuICogaW1wb3J0IHsgZmlyc3QgfSBmcm9tICdmcC10cy9TZW1pZ3JvdXAnXG4gKiBpbXBvcnQgeyBnZXRNb25vaWQgfSBmcm9tICdmcC10cy9PcHRpb24nXG4gKlxuICogZ2V0TW9ub2lkKGZpcnN0KCkpXG4gKiBgYGBcbiAqXG4gKiBpbnN0ZWFkLlxuICpcbiAqIE1vbm9pZCByZXR1cm5pbmcgdGhlIGxlZnQtbW9zdCBub24tYE5vbmVgIHZhbHVlXG4gKlxuICogfCB4ICAgICAgIHwgeSAgICAgICB8IGNvbmNhdCh4LCB5KSB8XG4gKiB8IC0tLS0tLS0gfCAtLS0tLS0tIHwgLS0tLS0tLS0tLS0tIHxcbiAqIHwgbm9uZSAgICB8IG5vbmUgICAgfCBub25lICAgICAgICAgfFxuICogfCBzb21lKGEpIHwgbm9uZSAgICB8IHNvbWUoYSkgICAgICB8XG4gKiB8IG5vbmUgICAgfCBzb21lKGIpIHwgc29tZShiKSAgICAgIHxcbiAqIHwgc29tZShhKSB8IHNvbWUoYikgfCBzb21lKGEpICAgICAgfFxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBnZXRGaXJzdE1vbm9pZCwgc29tZSwgbm9uZSB9IGZyb20gJ2ZwLXRzL09wdGlvbidcbiAqXG4gKiBjb25zdCBNID0gZ2V0Rmlyc3RNb25vaWQ8bnVtYmVyPigpXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKE0uY29uY2F0KG5vbmUsIG5vbmUpLCBub25lKVxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChNLmNvbmNhdChzb21lKDEpLCBub25lKSwgc29tZSgxKSlcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoTS5jb25jYXQobm9uZSwgc29tZSgyKSksIHNvbWUoMikpXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKE0uY29uY2F0KHNvbWUoMSksIHNvbWUoMikpLCBzb21lKDEpKVxuICpcbiAqIEBjYXRlZ29yeSB6b25lIG9mIGRlYXRoXG4gKiBAc2luY2UgMi4wLjBcbiAqIEBkZXByZWNhdGVkXG4gKi9cbmV4cG9ydCB2YXIgZ2V0Rmlyc3RNb25vaWQgPSBmdW5jdGlvbiAoKSB7IHJldHVybiBnZXRNb25vaWQoZmlyc3QoKSk7IH07XG4vKipcbiAqIFVzZVxuICpcbiAqIGBgYHRzXG4gKiBpbXBvcnQgeyBsYXN0IH0gZnJvbSAnZnAtdHMvU2VtaWdyb3VwJ1xuICogaW1wb3J0IHsgZ2V0TW9ub2lkIH0gZnJvbSAnZnAtdHMvT3B0aW9uJ1xuICpcbiAqIGdldE1vbm9pZChsYXN0KCkpXG4gKiBgYGBcbiAqXG4gKiBpbnN0ZWFkLlxuICpcbiAqIE1vbm9pZCByZXR1cm5pbmcgdGhlIHJpZ2h0LW1vc3Qgbm9uLWBOb25lYCB2YWx1ZVxuICpcbiAqIHwgeCAgICAgICB8IHkgICAgICAgfCBjb25jYXQoeCwgeSkgfFxuICogfCAtLS0tLS0tIHwgLS0tLS0tLSB8IC0tLS0tLS0tLS0tLSB8XG4gKiB8IG5vbmUgICAgfCBub25lICAgIHwgbm9uZSAgICAgICAgIHxcbiAqIHwgc29tZShhKSB8IG5vbmUgICAgfCBzb21lKGEpICAgICAgfFxuICogfCBub25lICAgIHwgc29tZShiKSB8IHNvbWUoYikgICAgICB8XG4gKiB8IHNvbWUoYSkgfCBzb21lKGIpIHwgc29tZShiKSAgICAgIHxcbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgZ2V0TGFzdE1vbm9pZCwgc29tZSwgbm9uZSB9IGZyb20gJ2ZwLXRzL09wdGlvbidcbiAqXG4gKiBjb25zdCBNID0gZ2V0TGFzdE1vbm9pZDxudW1iZXI+KClcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoTS5jb25jYXQobm9uZSwgbm9uZSksIG5vbmUpXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKE0uY29uY2F0KHNvbWUoMSksIG5vbmUpLCBzb21lKDEpKVxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChNLmNvbmNhdChub25lLCBzb21lKDIpKSwgc29tZSgyKSlcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoTS5jb25jYXQoc29tZSgxKSwgc29tZSgyKSksIHNvbWUoMikpXG4gKlxuICogQGNhdGVnb3J5IHpvbmUgb2YgZGVhdGhcbiAqIEBzaW5jZSAyLjAuMFxuICogQGRlcHJlY2F0ZWRcbiAqL1xuZXhwb3J0IHZhciBnZXRMYXN0TW9ub2lkID0gZnVuY3Rpb24gKCkgeyByZXR1cm4gZ2V0TW9ub2lkKGxhc3QoKSk7IH07XG4iLAogICJpbXBvcnQgeyBnZXRBcHBsaWNhdGl2ZU1vbm9pZCB9IGZyb20gJy4vQXBwbGljYXRpdmUnO1xuaW1wb3J0IHsgYXBGaXJzdCBhcyBhcEZpcnN0XywgYXBTIGFzIGFwU18sIGFwU2Vjb25kIGFzIGFwU2Vjb25kXywgZ2V0QXBwbHlTZW1pZ3JvdXAgYXMgZ2V0QXBwbHlTZW1pZ3JvdXBfIH0gZnJvbSAnLi9BcHBseSc7XG5pbXBvcnQgKiBhcyBjaGFpbmFibGUgZnJvbSAnLi9DaGFpbic7XG5pbXBvcnQgeyBjaGFpbkVpdGhlcksgYXMgY2hhaW5FaXRoZXJLXywgZnJvbUVpdGhlcksgYXMgZnJvbUVpdGhlcktfLCB0YXBFaXRoZXIgYXMgdGFwRWl0aGVyXyB9IGZyb20gJy4vRnJvbUVpdGhlcic7XG5pbXBvcnQgeyBjb25zdE51bGwsIGNvbnN0VW5kZWZpbmVkLCBkdWFsLCBmbG93LCBpZGVudGl0eSwgcGlwZSB9IGZyb20gJy4vZnVuY3Rpb24nO1xuaW1wb3J0IHsgYXMgYXMgYXNfLCBhc1VuaXQgYXMgYXNVbml0XywgYmluZFRvIGFzIGJpbmRUb18sIGZsYXAgYXMgZmxhcF8sIGxldCBhcyBsZXRfXyB9IGZyb20gJy4vRnVuY3Rvcic7XG5pbXBvcnQgKiBhcyBfIGZyb20gJy4vaW50ZXJuYWwnO1xuaW1wb3J0IHsgbm90IH0gZnJvbSAnLi9QcmVkaWNhdGUnO1xuaW1wb3J0IHsgZmlyc3QsIGxhc3QgfSBmcm9tICcuL1NlbWlncm91cCc7XG5pbXBvcnQgeyBzZXBhcmF0ZWQgfSBmcm9tICcuL1NlcGFyYXRlZCc7XG5pbXBvcnQgeyB3aWx0RGVmYXVsdCwgd2l0aGVyRGVmYXVsdCB9IGZyb20gJy4vV2l0aGVyYWJsZSc7XG5pbXBvcnQgeyBndWFyZCBhcyBndWFyZF8gfSBmcm9tICcuL1plcm8nO1xuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLy8gY29uc3RydWN0b3JzXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vKipcbiAqIGBOb25lYCBkb2Vzbid0IGhhdmUgYSBjb25zdHJ1Y3RvciwgaW5zdGVhZCB5b3UgY2FuIHVzZSBpdCBkaXJlY3RseSBhcyBhIHZhbHVlLiBSZXByZXNlbnRzIGEgbWlzc2luZyB2YWx1ZS5cbiAqXG4gKiBAY2F0ZWdvcnkgY29uc3RydWN0b3JzXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciBub25lID0gXy5ub25lO1xuLyoqXG4gKiBDb25zdHJ1Y3RzIGEgYFNvbWVgLiBSZXByZXNlbnRzIGFuIG9wdGlvbmFsIHZhbHVlIHRoYXQgZXhpc3RzLlxuICpcbiAqIEBjYXRlZ29yeSBjb25zdHJ1Y3RvcnNcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIHNvbWUgPSBfLnNvbWU7XG5leHBvcnQgZnVuY3Rpb24gZnJvbVByZWRpY2F0ZShwcmVkaWNhdGUpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGEpIHsgcmV0dXJuIChwcmVkaWNhdGUoYSkgPyBzb21lKGEpIDogbm9uZSk7IH07XG59XG4vKipcbiAqIFJldHVybnMgdGhlIGBMZWZ0YCB2YWx1ZSBvZiBhbiBgRWl0aGVyYCBpZiBwb3NzaWJsZS5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgZ2V0TGVmdCwgbm9uZSwgc29tZSB9IGZyb20gJ2ZwLXRzL09wdGlvbidcbiAqIGltcG9ydCB7IHJpZ2h0LCBsZWZ0IH0gZnJvbSAnZnAtdHMvRWl0aGVyJ1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoZ2V0TGVmdChyaWdodCgxKSksIG5vbmUpXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKGdldExlZnQobGVmdCgnYScpKSwgc29tZSgnYScpKVxuICpcbiAqIEBjYXRlZ29yeSBjb25zdHJ1Y3RvcnNcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIGdldExlZnQgPSBmdW5jdGlvbiAobWEpIHsgcmV0dXJuIChtYS5fdGFnID09PSAnUmlnaHQnID8gbm9uZSA6IHNvbWUobWEubGVmdCkpOyB9O1xuLyoqXG4gKiBSZXR1cm5zIHRoZSBgUmlnaHRgIHZhbHVlIG9mIGFuIGBFaXRoZXJgIGlmIHBvc3NpYmxlLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBnZXRSaWdodCwgbm9uZSwgc29tZSB9IGZyb20gJ2ZwLXRzL09wdGlvbidcbiAqIGltcG9ydCB7IHJpZ2h0LCBsZWZ0IH0gZnJvbSAnZnAtdHMvRWl0aGVyJ1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoZ2V0UmlnaHQocmlnaHQoMSkpLCBzb21lKDEpKVxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChnZXRSaWdodChsZWZ0KCdhJykpLCBub25lKVxuICpcbiAqIEBjYXRlZ29yeSBjb25zdHJ1Y3RvcnNcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIGdldFJpZ2h0ID0gZnVuY3Rpb24gKG1hKSB7IHJldHVybiAobWEuX3RhZyA9PT0gJ0xlZnQnID8gbm9uZSA6IHNvbWUobWEucmlnaHQpKTsgfTtcbnZhciBfbWFwID0gZnVuY3Rpb24gKGZhLCBmKSB7IHJldHVybiBwaXBlKGZhLCBtYXAoZikpOyB9O1xudmFyIF9hcCA9IGZ1bmN0aW9uIChmYWIsIGZhKSB7IHJldHVybiBwaXBlKGZhYiwgYXAoZmEpKTsgfTtcbnZhciBfcmVkdWNlID0gZnVuY3Rpb24gKGZhLCBiLCBmKSB7IHJldHVybiBwaXBlKGZhLCByZWR1Y2UoYiwgZikpOyB9O1xudmFyIF9mb2xkTWFwID0gZnVuY3Rpb24gKE0pIHtcbiAgICB2YXIgZm9sZE1hcE0gPSBmb2xkTWFwKE0pO1xuICAgIHJldHVybiBmdW5jdGlvbiAoZmEsIGYpIHsgcmV0dXJuIHBpcGUoZmEsIGZvbGRNYXBNKGYpKTsgfTtcbn07XG52YXIgX3JlZHVjZVJpZ2h0ID0gZnVuY3Rpb24gKGZhLCBiLCBmKSB7IHJldHVybiBwaXBlKGZhLCByZWR1Y2VSaWdodChiLCBmKSk7IH07XG52YXIgX3RyYXZlcnNlID0gZnVuY3Rpb24gKEYpIHtcbiAgICB2YXIgdHJhdmVyc2VGID0gdHJhdmVyc2UoRik7XG4gICAgcmV0dXJuIGZ1bmN0aW9uICh0YSwgZikgeyByZXR1cm4gcGlwZSh0YSwgdHJhdmVyc2VGKGYpKTsgfTtcbn07XG4vKiBpc3RhbmJ1bCBpZ25vcmUgbmV4dCAqL1xudmFyIF9hbHQgPSBmdW5jdGlvbiAoZmEsIHRoYXQpIHsgcmV0dXJuIHBpcGUoZmEsIGFsdCh0aGF0KSk7IH07XG52YXIgX2ZpbHRlciA9IGZ1bmN0aW9uIChmYSwgcHJlZGljYXRlKSB7IHJldHVybiBwaXBlKGZhLCBmaWx0ZXIocHJlZGljYXRlKSk7IH07XG4vKiBpc3RhbmJ1bCBpZ25vcmUgbmV4dCAqL1xudmFyIF9maWx0ZXJNYXAgPSBmdW5jdGlvbiAoZmEsIGYpIHsgcmV0dXJuIHBpcGUoZmEsIGZpbHRlck1hcChmKSk7IH07XG4vKiBpc3RhbmJ1bCBpZ25vcmUgbmV4dCAqL1xudmFyIF9leHRlbmQgPSBmdW5jdGlvbiAod2EsIGYpIHsgcmV0dXJuIHBpcGUod2EsIGV4dGVuZChmKSk7IH07XG4vKiBpc3RhbmJ1bCBpZ25vcmUgbmV4dCAqL1xudmFyIF9wYXJ0aXRpb24gPSBmdW5jdGlvbiAoZmEsIHByZWRpY2F0ZSkge1xuICAgIHJldHVybiBwaXBlKGZhLCBwYXJ0aXRpb24ocHJlZGljYXRlKSk7XG59O1xuLyogaXN0YW5idWwgaWdub3JlIG5leHQgKi9cbnZhciBfcGFydGl0aW9uTWFwID0gZnVuY3Rpb24gKGZhLCBmKSB7IHJldHVybiBwaXBlKGZhLCBwYXJ0aXRpb25NYXAoZikpOyB9O1xuLyoqXG4gKiBAY2F0ZWdvcnkgdHlwZSBsYW1iZGFzXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciBVUkkgPSAnT3B0aW9uJztcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgZ2V0U2hvdyA9IGZ1bmN0aW9uIChTKSB7IHJldHVybiAoe1xuICAgIHNob3c6IGZ1bmN0aW9uIChtYSkgeyByZXR1cm4gKGlzTm9uZShtYSkgPyAnbm9uZScgOiBcInNvbWUoXCIuY29uY2F0KFMuc2hvdyhtYS52YWx1ZSksIFwiKVwiKSk7IH1cbn0pOyB9O1xuLyoqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgbm9uZSwgc29tZSwgZ2V0RXEgfSBmcm9tICdmcC10cy9PcHRpb24nXG4gKiBpbXBvcnQgKiBhcyBOIGZyb20gJ2ZwLXRzL251bWJlcidcbiAqXG4gKiBjb25zdCBFID0gZ2V0RXEoTi5FcSlcbiAqIGFzc2VydC5zdHJpY3RFcXVhbChFLmVxdWFscyhub25lLCBub25lKSwgdHJ1ZSlcbiAqIGFzc2VydC5zdHJpY3RFcXVhbChFLmVxdWFscyhub25lLCBzb21lKDEpKSwgZmFsc2UpXG4gKiBhc3NlcnQuc3RyaWN0RXF1YWwoRS5lcXVhbHMoc29tZSgxKSwgbm9uZSksIGZhbHNlKVxuICogYXNzZXJ0LnN0cmljdEVxdWFsKEUuZXF1YWxzKHNvbWUoMSksIHNvbWUoMikpLCBmYWxzZSlcbiAqIGFzc2VydC5zdHJpY3RFcXVhbChFLmVxdWFscyhzb21lKDEpLCBzb21lKDEpKSwgdHJ1ZSlcbiAqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciBnZXRFcSA9IGZ1bmN0aW9uIChFKSB7IHJldHVybiAoe1xuICAgIGVxdWFsczogZnVuY3Rpb24gKHgsIHkpIHsgcmV0dXJuIHggPT09IHkgfHwgKGlzTm9uZSh4KSA/IGlzTm9uZSh5KSA6IGlzTm9uZSh5KSA/IGZhbHNlIDogRS5lcXVhbHMoeC52YWx1ZSwgeS52YWx1ZSkpOyB9XG59KTsgfTtcbi8qKlxuICogVGhlIGBPcmRgIGluc3RhbmNlIGFsbG93cyBgT3B0aW9uYCB2YWx1ZXMgdG8gYmUgY29tcGFyZWQgd2l0aFxuICogYGNvbXBhcmVgLCB3aGVuZXZlciB0aGVyZSBpcyBhbiBgT3JkYCBpbnN0YW5jZSBmb3JcbiAqIHRoZSB0eXBlIHRoZSBgT3B0aW9uYCBjb250YWlucy5cbiAqXG4gKiBgTm9uZWAgaXMgY29uc2lkZXJlZCB0byBiZSBsZXNzIHRoYW4gYW55IGBTb21lYCB2YWx1ZS5cbiAqXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IG5vbmUsIHNvbWUsIGdldE9yZCB9IGZyb20gJ2ZwLXRzL09wdGlvbidcbiAqIGltcG9ydCAqIGFzIE4gZnJvbSAnZnAtdHMvbnVtYmVyJ1xuICpcbiAqIGNvbnN0IE8gPSBnZXRPcmQoTi5PcmQpXG4gKiBhc3NlcnQuc3RyaWN0RXF1YWwoTy5jb21wYXJlKG5vbmUsIG5vbmUpLCAwKVxuICogYXNzZXJ0LnN0cmljdEVxdWFsKE8uY29tcGFyZShub25lLCBzb21lKDEpKSwgLTEpXG4gKiBhc3NlcnQuc3RyaWN0RXF1YWwoTy5jb21wYXJlKHNvbWUoMSksIG5vbmUpLCAxKVxuICogYXNzZXJ0LnN0cmljdEVxdWFsKE8uY29tcGFyZShzb21lKDEpLCBzb21lKDIpKSwgLTEpXG4gKiBhc3NlcnQuc3RyaWN0RXF1YWwoTy5jb21wYXJlKHNvbWUoMSksIHNvbWUoMSkpLCAwKVxuICpcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIGdldE9yZCA9IGZ1bmN0aW9uIChPKSB7IHJldHVybiAoe1xuICAgIGVxdWFsczogZ2V0RXEoTykuZXF1YWxzLFxuICAgIGNvbXBhcmU6IGZ1bmN0aW9uICh4LCB5KSB7IHJldHVybiAoeCA9PT0geSA/IDAgOiBpc1NvbWUoeCkgPyAoaXNTb21lKHkpID8gTy5jb21wYXJlKHgudmFsdWUsIHkudmFsdWUpIDogMSkgOiAtMSk7IH1cbn0pOyB9O1xuLyoqXG4gKiBNb25vaWQgcmV0dXJuaW5nIHRoZSBsZWZ0LW1vc3Qgbm9uLWBOb25lYCB2YWx1ZS4gSWYgYm90aCBvcGVyYW5kcyBhcmUgYFNvbWVgcyB0aGVuIHRoZSBpbm5lciB2YWx1ZXMgYXJlXG4gKiBjb25jYXRlbmF0ZWQgdXNpbmcgdGhlIHByb3ZpZGVkIGBTZW1pZ3JvdXBgXG4gKlxuICogfCB4ICAgICAgIHwgeSAgICAgICB8IGNvbmNhdCh4LCB5KSAgICAgICB8XG4gKiB8IC0tLS0tLS0gfCAtLS0tLS0tIHwgLS0tLS0tLS0tLS0tLS0tLS0tIHxcbiAqIHwgbm9uZSAgICB8IG5vbmUgICAgfCBub25lICAgICAgICAgICAgICAgfFxuICogfCBzb21lKGEpIHwgbm9uZSAgICB8IHNvbWUoYSkgICAgICAgICAgICB8XG4gKiB8IG5vbmUgICAgfCBzb21lKGIpIHwgc29tZShiKSAgICAgICAgICAgIHxcbiAqIHwgc29tZShhKSB8IHNvbWUoYikgfCBzb21lKGNvbmNhdChhLCBiKSkgfFxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBnZXRNb25vaWQsIHNvbWUsIG5vbmUgfSBmcm9tICdmcC10cy9PcHRpb24nXG4gKiBpbXBvcnQgeyBTZW1pZ3JvdXBTdW0gfSBmcm9tICdmcC10cy9udW1iZXInXG4gKlxuICogY29uc3QgTSA9IGdldE1vbm9pZChTZW1pZ3JvdXBTdW0pXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKE0uY29uY2F0KG5vbmUsIG5vbmUpLCBub25lKVxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChNLmNvbmNhdChzb21lKDEpLCBub25lKSwgc29tZSgxKSlcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoTS5jb25jYXQobm9uZSwgc29tZSgxKSksIHNvbWUoMSkpXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKE0uY29uY2F0KHNvbWUoMSksIHNvbWUoMikpLCBzb21lKDMpKVxuICpcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIGdldE1vbm9pZCA9IGZ1bmN0aW9uIChTKSB7IHJldHVybiAoe1xuICAgIGNvbmNhdDogZnVuY3Rpb24gKHgsIHkpIHsgcmV0dXJuIChpc05vbmUoeCkgPyB5IDogaXNOb25lKHkpID8geCA6IHNvbWUoUy5jb25jYXQoeC52YWx1ZSwgeS52YWx1ZSkpKTsgfSxcbiAgICBlbXB0eTogbm9uZVxufSk7IH07XG4vKipcbiAqIEBjYXRlZ29yeSBtYXBwaW5nXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciBtYXAgPSBmdW5jdGlvbiAoZikgeyByZXR1cm4gZnVuY3Rpb24gKGZhKSB7XG4gICAgcmV0dXJuIGlzTm9uZShmYSkgPyBub25lIDogc29tZShmKGZhLnZhbHVlKSk7XG59OyB9O1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi43LjBcbiAqL1xuZXhwb3J0IHZhciBGdW5jdG9yID0ge1xuICAgIFVSSTogVVJJLFxuICAgIG1hcDogX21hcFxufTtcbi8qKlxuICogTWFwcyB0aGUgYFNvbWVgIHZhbHVlIG9mIHRoaXMgYE9wdGlvbmAgdG8gdGhlIHNwZWNpZmllZCBjb25zdGFudCB2YWx1ZS5cbiAqXG4gKiBAY2F0ZWdvcnkgbWFwcGluZ1xuICogQHNpbmNlIDIuMTYuMFxuICovXG5leHBvcnQgdmFyIGFzID0gZHVhbCgyLCBhc18oRnVuY3RvcikpO1xuLyoqXG4gKiBNYXBzIHRoZSBgU29tZWAgdmFsdWUgb2YgdGhpcyBgT3B0aW9uYCB0byB0aGUgdm9pZCBjb25zdGFudCB2YWx1ZS5cbiAqXG4gKiBAY2F0ZWdvcnkgbWFwcGluZ1xuICogQHNpbmNlIDIuMTYuMFxuICovXG5leHBvcnQgdmFyIGFzVW5pdCA9IGFzVW5pdF8oRnVuY3Rvcik7XG4vKipcbiAqIEBjYXRlZ29yeSBjb25zdHJ1Y3RvcnNcbiAqIEBzaW5jZSAyLjcuMFxuICovXG5leHBvcnQgdmFyIG9mID0gc29tZTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuMTAuMFxuICovXG5leHBvcnQgdmFyIFBvaW50ZWQgPSB7XG4gICAgVVJJOiBVUkksXG4gICAgb2Y6IG9mXG59O1xuLyoqXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciBhcCA9IGZ1bmN0aW9uIChmYSkgeyByZXR1cm4gZnVuY3Rpb24gKGZhYikge1xuICAgIHJldHVybiBpc05vbmUoZmFiKSA/IG5vbmUgOiBpc05vbmUoZmEpID8gbm9uZSA6IHNvbWUoZmFiLnZhbHVlKGZhLnZhbHVlKSk7XG59OyB9O1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi4xMC4wXG4gKi9cbmV4cG9ydCB2YXIgQXBwbHkgPSB7XG4gICAgVVJJOiBVUkksXG4gICAgbWFwOiBfbWFwLFxuICAgIGFwOiBfYXBcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjcuMFxuICovXG5leHBvcnQgdmFyIEFwcGxpY2F0aXZlID0ge1xuICAgIFVSSTogVVJJLFxuICAgIG1hcDogX21hcCxcbiAgICBhcDogX2FwLFxuICAgIG9mOiBvZlxufTtcbi8qKlxuICogQGNhdGVnb3J5IHNlcXVlbmNpbmdcbiAqIEBzaW5jZSAyLjE0LjBcbiAqL1xuZXhwb3J0IHZhciBmbGF0TWFwID0gLyojX19QVVJFX18qLyBkdWFsKDIsIGZ1bmN0aW9uIChtYSwgZikgeyByZXR1cm4gKGlzTm9uZShtYSkgPyBub25lIDogZihtYS52YWx1ZSkpOyB9KTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuMTAuMFxuICovXG5leHBvcnQgdmFyIENoYWluID0ge1xuICAgIFVSSTogVVJJLFxuICAgIG1hcDogX21hcCxcbiAgICBhcDogX2FwLFxuICAgIGNoYWluOiBmbGF0TWFwXG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi43LjBcbiAqL1xuZXhwb3J0IHZhciBNb25hZCA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICBtYXA6IF9tYXAsXG4gICAgYXA6IF9hcCxcbiAgICBvZjogb2YsXG4gICAgY2hhaW46IGZsYXRNYXBcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBmb2xkaW5nXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciByZWR1Y2UgPSBmdW5jdGlvbiAoYiwgZikgeyByZXR1cm4gZnVuY3Rpb24gKGZhKSB7XG4gICAgcmV0dXJuIGlzTm9uZShmYSkgPyBiIDogZihiLCBmYS52YWx1ZSk7XG59OyB9O1xuLyoqXG4gKiBAY2F0ZWdvcnkgZm9sZGluZ1xuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgZm9sZE1hcCA9IGZ1bmN0aW9uIChNKSB7IHJldHVybiBmdW5jdGlvbiAoZikgeyByZXR1cm4gZnVuY3Rpb24gKGZhKSB7XG4gICAgcmV0dXJuIGlzTm9uZShmYSkgPyBNLmVtcHR5IDogZihmYS52YWx1ZSk7XG59OyB9OyB9O1xuLyoqXG4gKiBAY2F0ZWdvcnkgZm9sZGluZ1xuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgcmVkdWNlUmlnaHQgPSBmdW5jdGlvbiAoYiwgZikgeyByZXR1cm4gZnVuY3Rpb24gKGZhKSB7XG4gICAgcmV0dXJuIGlzTm9uZShmYSkgPyBiIDogZihmYS52YWx1ZSwgYik7XG59OyB9O1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi43LjBcbiAqL1xuZXhwb3J0IHZhciBGb2xkYWJsZSA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICByZWR1Y2U6IF9yZWR1Y2UsXG4gICAgZm9sZE1hcDogX2ZvbGRNYXAsXG4gICAgcmVkdWNlUmlnaHQ6IF9yZWR1Y2VSaWdodFxufTtcbi8qKlxuICogUmV0dXJucyB0aGUgcHJvdmlkZWQgYE9wdGlvbmAgYHRoYXRgIGlmIGBzZWxmYCBpcyBgTm9uZWAsIG90aGVyd2lzZSByZXR1cm5zIGBzZWxmYC5cbiAqXG4gKiBAcGFyYW0gc2VsZiAtIFRoZSBmaXJzdCBgT3B0aW9uYCB0byBiZSBjaGVja2VkLlxuICogQHBhcmFtIHRoYXQgLSBUaGUgYE9wdGlvbmAgdG8gcmV0dXJuIGlmIGBzZWxmYCBpcyBgTm9uZWAuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCAqIGFzIE8gZnJvbSBcImZwLXRzL09wdGlvblwiXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChPLm9yRWxzZShPLm5vbmUsICgpID0+IE8ubm9uZSksIE8ubm9uZSlcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoTy5vckVsc2UoTy5zb21lKDEpLCAoKSA9PiBPLm5vbmUpLCBPLnNvbWUoMSkpXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKE8ub3JFbHNlKE8ubm9uZSwgKCkgPT4gTy5zb21lKCdiJykpLCBPLnNvbWUoJ2InKSlcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoTy5vckVsc2UoTy5zb21lKDEpLCAoKSA9PiBPLnNvbWUoJ2InKSksIE8uc29tZSgxKSlcbiAqXG4gKiBAY2F0ZWdvcnkgZXJyb3IgaGFuZGxpbmdcbiAqIEBzaW5jZSAyLjE2LjBcbiAqL1xuZXhwb3J0IHZhciBvckVsc2UgPSBkdWFsKDIsIGZ1bmN0aW9uIChzZWxmLCB0aGF0KSB7IHJldHVybiAoaXNOb25lKHNlbGYpID8gdGhhdCgpIDogc2VsZik7IH0pO1xuLyoqXG4gKiBBbGlhcyBvZiBgb3JFbHNlYC5cbiAqXG4gKiBMZXNzIHN0cmljdCB2ZXJzaW9uIG9mIFtgYWx0YF0oI2FsdCkuXG4gKlxuICogVGhlIGBXYCBzdWZmaXggKHNob3J0IGZvciAqKlcqKmlkZW5pbmcpIG1lYW5zIHRoYXQgdGhlIHJldHVybiB0eXBlcyB3aWxsIGJlIG1lcmdlZC5cbiAqXG4gKiBAY2F0ZWdvcnkgbGVnYWN5XG4gKiBAc2luY2UgMi45LjBcbiAqL1xuZXhwb3J0IHZhciBhbHRXID0gb3JFbHNlO1xuLyoqXG4gKiBBbGlhcyBvZiBgb3JFbHNlYC5cbiAqXG4gKiBAY2F0ZWdvcnkgbGVnYWN5XG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciBhbHQgPSBvckVsc2U7XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjcuMFxuICovXG5leHBvcnQgdmFyIEFsdCA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICBtYXA6IF9tYXAsXG4gICAgYWx0OiBfYWx0XG59O1xuLyoqXG4gKiBAc2luY2UgMi43LjBcbiAqL1xuZXhwb3J0IHZhciB6ZXJvID0gZnVuY3Rpb24gKCkgeyByZXR1cm4gbm9uZTsgfTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIFplcm8gPSB7XG4gICAgVVJJOiBVUkksXG4gICAgemVybzogemVyb1xufTtcbi8qKlxuICogQGNhdGVnb3J5IGRvIG5vdGF0aW9uXG4gKiBAc2luY2UgMi4xMS4wXG4gKi9cbmV4cG9ydCB2YXIgZ3VhcmQgPSAvKiNfX1BVUkVfXyovIGd1YXJkXyhaZXJvLCBQb2ludGVkKTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuNy4wXG4gKi9cbmV4cG9ydCB2YXIgQWx0ZXJuYXRpdmUgPSB7XG4gICAgVVJJOiBVUkksXG4gICAgbWFwOiBfbWFwLFxuICAgIGFwOiBfYXAsXG4gICAgb2Y6IG9mLFxuICAgIGFsdDogX2FsdCxcbiAgICB6ZXJvOiB6ZXJvXG59O1xuLyoqXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciBleHRlbmQgPSBmdW5jdGlvbiAoZikgeyByZXR1cm4gZnVuY3Rpb24gKHdhKSB7XG4gICAgcmV0dXJuIGlzTm9uZSh3YSkgPyBub25lIDogc29tZShmKHdhKSk7XG59OyB9O1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi43LjBcbiAqL1xuZXhwb3J0IHZhciBFeHRlbmQgPSB7XG4gICAgVVJJOiBVUkksXG4gICAgbWFwOiBfbWFwLFxuICAgIGV4dGVuZDogX2V4dGVuZFxufTtcbi8qKlxuICogQGNhdGVnb3J5IGZpbHRlcmluZ1xuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgY29tcGFjdCA9IC8qI19fUFVSRV9fKi8gZmxhdE1hcChpZGVudGl0eSk7XG52YXIgZGVmYXVsdFNlcGFyYXRlZCA9IC8qI19fUFVSRV9fKi8gc2VwYXJhdGVkKG5vbmUsIG5vbmUpO1xuLyoqXG4gKiBAY2F0ZWdvcnkgZmlsdGVyaW5nXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciBzZXBhcmF0ZSA9IGZ1bmN0aW9uIChtYSkge1xuICAgIHJldHVybiBpc05vbmUobWEpID8gZGVmYXVsdFNlcGFyYXRlZCA6IHNlcGFyYXRlZChnZXRMZWZ0KG1hLnZhbHVlKSwgZ2V0UmlnaHQobWEudmFsdWUpKTtcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjcuMFxuICovXG5leHBvcnQgdmFyIENvbXBhY3RhYmxlID0ge1xuICAgIFVSSTogVVJJLFxuICAgIGNvbXBhY3Q6IGNvbXBhY3QsXG4gICAgc2VwYXJhdGU6IHNlcGFyYXRlXG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgZmlsdGVyaW5nXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciBmaWx0ZXIgPSBmdW5jdGlvbiAocHJlZGljYXRlKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChmYSkge1xuICAgICAgICByZXR1cm4gaXNOb25lKGZhKSA/IG5vbmUgOiBwcmVkaWNhdGUoZmEudmFsdWUpID8gZmEgOiBub25lO1xuICAgIH07XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgZmlsdGVyaW5nXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciBmaWx0ZXJNYXAgPSBmdW5jdGlvbiAoZikgeyByZXR1cm4gZnVuY3Rpb24gKGZhKSB7XG4gICAgcmV0dXJuIGlzTm9uZShmYSkgPyBub25lIDogZihmYS52YWx1ZSk7XG59OyB9O1xuLyoqXG4gKiBAY2F0ZWdvcnkgZmlsdGVyaW5nXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciBwYXJ0aXRpb24gPSBmdW5jdGlvbiAocHJlZGljYXRlKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChmYSkge1xuICAgICAgICByZXR1cm4gc2VwYXJhdGVkKF9maWx0ZXIoZmEsIG5vdChwcmVkaWNhdGUpKSwgX2ZpbHRlcihmYSwgcHJlZGljYXRlKSk7XG4gICAgfTtcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBmaWx0ZXJpbmdcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIHBhcnRpdGlvbk1hcCA9IGZ1bmN0aW9uIChmKSB7IHJldHVybiBmbG93KG1hcChmKSwgc2VwYXJhdGUpOyB9O1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi43LjBcbiAqL1xuZXhwb3J0IHZhciBGaWx0ZXJhYmxlID0ge1xuICAgIFVSSTogVVJJLFxuICAgIG1hcDogX21hcCxcbiAgICBjb21wYWN0OiBjb21wYWN0LFxuICAgIHNlcGFyYXRlOiBzZXBhcmF0ZSxcbiAgICBmaWx0ZXI6IF9maWx0ZXIsXG4gICAgZmlsdGVyTWFwOiBfZmlsdGVyTWFwLFxuICAgIHBhcnRpdGlvbjogX3BhcnRpdGlvbixcbiAgICBwYXJ0aXRpb25NYXA6IF9wYXJ0aXRpb25NYXBcbn07XG4vKipcbiAqIEBjYXRlZ29yeSB0cmF2ZXJzaW5nXG4gKiBAc2luY2UgMi42LjNcbiAqL1xuZXhwb3J0IHZhciB0cmF2ZXJzZSA9IGZ1bmN0aW9uIChGKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChmKSB7XG4gICAgICAgIHJldHVybiBmdW5jdGlvbiAodGEpIHtcbiAgICAgICAgICAgIHJldHVybiBpc05vbmUodGEpID8gRi5vZihub25lKSA6IEYubWFwKGYodGEudmFsdWUpLCBzb21lKTtcbiAgICAgICAgfTtcbiAgICB9O1xufTtcbi8qKlxuICogQGNhdGVnb3J5IHRyYXZlcnNpbmdcbiAqIEBzaW5jZSAyLjYuM1xuICovXG5leHBvcnQgdmFyIHNlcXVlbmNlID0gZnVuY3Rpb24gKEYpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKHRhKSB7XG4gICAgICAgIHJldHVybiBpc05vbmUodGEpID8gRi5vZihub25lKSA6IEYubWFwKHRhLnZhbHVlLCBzb21lKTtcbiAgICB9O1xufTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuNy4wXG4gKi9cbmV4cG9ydCB2YXIgVHJhdmVyc2FibGUgPSB7XG4gICAgVVJJOiBVUkksXG4gICAgbWFwOiBfbWFwLFxuICAgIHJlZHVjZTogX3JlZHVjZSxcbiAgICBmb2xkTWFwOiBfZm9sZE1hcCxcbiAgICByZWR1Y2VSaWdodDogX3JlZHVjZVJpZ2h0LFxuICAgIHRyYXZlcnNlOiBfdHJhdmVyc2UsXG4gICAgc2VxdWVuY2U6IHNlcXVlbmNlXG59O1xudmFyIF93aXRoZXIgPSAvKiNfX1BVUkVfXyovIHdpdGhlckRlZmF1bHQoVHJhdmVyc2FibGUsIENvbXBhY3RhYmxlKTtcbnZhciBfd2lsdCA9IC8qI19fUFVSRV9fKi8gd2lsdERlZmF1bHQoVHJhdmVyc2FibGUsIENvbXBhY3RhYmxlKTtcbi8qKlxuICogQGNhdGVnb3J5IGZpbHRlcmluZ1xuICogQHNpbmNlIDIuNi41XG4gKi9cbmV4cG9ydCB2YXIgd2l0aGVyID0gZnVuY3Rpb24gKEYpIHtcbiAgICB2YXIgX3dpdGhlckYgPSBfd2l0aGVyKEYpO1xuICAgIHJldHVybiBmdW5jdGlvbiAoZikgeyByZXR1cm4gZnVuY3Rpb24gKGZhKSB7IHJldHVybiBfd2l0aGVyRihmYSwgZik7IH07IH07XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgZmlsdGVyaW5nXG4gKiBAc2luY2UgMi42LjVcbiAqL1xuZXhwb3J0IHZhciB3aWx0ID0gZnVuY3Rpb24gKEYpIHtcbiAgICB2YXIgX3dpbHRGID0gX3dpbHQoRik7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChmKSB7IHJldHVybiBmdW5jdGlvbiAoZmEpIHsgcmV0dXJuIF93aWx0RihmYSwgZik7IH07IH07XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi43LjBcbiAqL1xuZXhwb3J0IHZhciBXaXRoZXJhYmxlID0ge1xuICAgIFVSSTogVVJJLFxuICAgIG1hcDogX21hcCxcbiAgICByZWR1Y2U6IF9yZWR1Y2UsXG4gICAgZm9sZE1hcDogX2ZvbGRNYXAsXG4gICAgcmVkdWNlUmlnaHQ6IF9yZWR1Y2VSaWdodCxcbiAgICB0cmF2ZXJzZTogX3RyYXZlcnNlLFxuICAgIHNlcXVlbmNlOiBzZXF1ZW5jZSxcbiAgICBjb21wYWN0OiBjb21wYWN0LFxuICAgIHNlcGFyYXRlOiBzZXBhcmF0ZSxcbiAgICBmaWx0ZXI6IF9maWx0ZXIsXG4gICAgZmlsdGVyTWFwOiBfZmlsdGVyTWFwLFxuICAgIHBhcnRpdGlvbjogX3BhcnRpdGlvbixcbiAgICBwYXJ0aXRpb25NYXA6IF9wYXJ0aXRpb25NYXAsXG4gICAgd2l0aGVyOiBfd2l0aGVyLFxuICAgIHdpbHQ6IF93aWx0XG59O1xuLyoqXG4gKiBAc2luY2UgMi43LjBcbiAqL1xuZXhwb3J0IHZhciB0aHJvd0Vycm9yID0gZnVuY3Rpb24gKCkgeyByZXR1cm4gbm9uZTsgfTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuNy4wXG4gKi9cbmV4cG9ydCB2YXIgTW9uYWRUaHJvdyA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICBtYXA6IF9tYXAsXG4gICAgYXA6IF9hcCxcbiAgICBvZjogb2YsXG4gICAgY2hhaW46IGZsYXRNYXAsXG4gICAgdGhyb3dFcnJvcjogdGhyb3dFcnJvclxufTtcbi8qKlxuICogVHJhbnNmb3JtcyBhbiBgRWl0aGVyYCB0byBhbiBgT3B0aW9uYCBkaXNjYXJkaW5nIHRoZSBlcnJvci5cbiAqXG4gKiBBbGlhcyBvZiBbZ2V0UmlnaHRdKCNnZXRyaWdodClcbiAqXG4gKiBAY2F0ZWdvcnkgY29udmVyc2lvbnNcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIGZyb21FaXRoZXIgPSBnZXRSaWdodDtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIEZyb21FaXRoZXIgPSB7XG4gICAgVVJJOiBVUkksXG4gICAgZnJvbUVpdGhlcjogZnJvbUVpdGhlclxufTtcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8vIHJlZmluZW1lbnRzXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vKipcbiAqIFJldHVybnMgYHRydWVgIGlmIHRoZSBvcHRpb24gaXMgYW4gaW5zdGFuY2Ugb2YgYFNvbWVgLCBgZmFsc2VgIG90aGVyd2lzZS5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgc29tZSwgbm9uZSwgaXNTb21lIH0gZnJvbSAnZnAtdHMvT3B0aW9uJ1xuICpcbiAqIGFzc2VydC5zdHJpY3RFcXVhbChpc1NvbWUoc29tZSgxKSksIHRydWUpXG4gKiBhc3NlcnQuc3RyaWN0RXF1YWwoaXNTb21lKG5vbmUpLCBmYWxzZSlcbiAqXG4gKiBAY2F0ZWdvcnkgcmVmaW5lbWVudHNcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIGlzU29tZSA9IF8uaXNTb21lO1xuLyoqXG4gKiBSZXR1cm5zIGB0cnVlYCBpZiB0aGUgb3B0aW9uIGlzIGBOb25lYCwgYGZhbHNlYCBvdGhlcndpc2UuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IHNvbWUsIG5vbmUsIGlzTm9uZSB9IGZyb20gJ2ZwLXRzL09wdGlvbidcbiAqXG4gKiBhc3NlcnQuc3RyaWN0RXF1YWwoaXNOb25lKHNvbWUoMSkpLCBmYWxzZSlcbiAqIGFzc2VydC5zdHJpY3RFcXVhbChpc05vbmUobm9uZSksIHRydWUpXG4gKlxuICogQGNhdGVnb3J5IHJlZmluZW1lbnRzXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciBpc05vbmUgPSBmdW5jdGlvbiAoZmEpIHsgcmV0dXJuIGZhLl90YWcgPT09ICdOb25lJzsgfTtcbi8qKlxuICogTGVzcyBzdHJpY3QgdmVyc2lvbiBvZiBbYG1hdGNoYF0oI21hdGNoKS5cbiAqXG4gKiBUaGUgYFdgIHN1ZmZpeCAoc2hvcnQgZm9yICoqVyoqaWRlbmluZykgbWVhbnMgdGhhdCB0aGUgaGFuZGxlciByZXR1cm4gdHlwZXMgd2lsbCBiZSBtZXJnZWQuXG4gKlxuICogQGNhdGVnb3J5IHBhdHRlcm4gbWF0Y2hpbmdcbiAqIEBzaW5jZSAyLjEwLjBcbiAqL1xuZXhwb3J0IHZhciBtYXRjaFcgPSBmdW5jdGlvbiAob25Ob25lLCBvblNvbWUpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKG1hKSB7XG4gICAgICAgIHJldHVybiBpc05vbmUobWEpID8gb25Ob25lKCkgOiBvblNvbWUobWEudmFsdWUpO1xuICAgIH07XG59O1xuLyoqXG4gKiBBbGlhcyBvZiBbYG1hdGNoV2BdKCNtYXRjaHcpLlxuICpcbiAqIEBjYXRlZ29yeSBwYXR0ZXJuIG1hdGNoaW5nXG4gKiBAc2luY2UgMi4xMC4wXG4gKi9cbmV4cG9ydCB2YXIgZm9sZFcgPSBtYXRjaFc7XG4vKipcbiAqIFRha2VzIGEgKGxhenkpIGRlZmF1bHQgdmFsdWUsIGEgZnVuY3Rpb24sIGFuZCBhbiBgT3B0aW9uYCB2YWx1ZSwgaWYgdGhlIGBPcHRpb25gIHZhbHVlIGlzIGBOb25lYCB0aGUgZGVmYXVsdCB2YWx1ZSBpc1xuICogcmV0dXJuZWQsIG90aGVyd2lzZSB0aGUgZnVuY3Rpb24gaXMgYXBwbGllZCB0byB0aGUgdmFsdWUgaW5zaWRlIHRoZSBgU29tZWAgYW5kIHRoZSByZXN1bHQgaXMgcmV0dXJuZWQuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IHNvbWUsIG5vbmUsIG1hdGNoIH0gZnJvbSAnZnAtdHMvT3B0aW9uJ1xuICogaW1wb3J0IHsgcGlwZSB9IGZyb20gJ2ZwLXRzL2Z1bmN0aW9uJ1xuICpcbiAqIGFzc2VydC5zdHJpY3RFcXVhbChcbiAqICAgcGlwZShcbiAqICAgICBzb21lKDEpLFxuICogICAgIG1hdGNoKCgpID0+ICdhIG5vbmUnLCBhID0+IGBhIHNvbWUgY29udGFpbmluZyAke2F9YClcbiAqICAgKSxcbiAqICAgJ2Egc29tZSBjb250YWluaW5nIDEnXG4gKiApXG4gKlxuICogYXNzZXJ0LnN0cmljdEVxdWFsKFxuICogICBwaXBlKFxuICogICAgIG5vbmUsXG4gKiAgICAgbWF0Y2goKCkgPT4gJ2Egbm9uZScsIGEgPT4gYGEgc29tZSBjb250YWluaW5nICR7YX1gKVxuICogICApLFxuICogICAnYSBub25lJ1xuICogKVxuICpcbiAqIEBjYXRlZ29yeSBwYXR0ZXJuIG1hdGNoaW5nXG4gKiBAc2luY2UgMi4xMC4wXG4gKi9cbmV4cG9ydCB2YXIgbWF0Y2ggPSBtYXRjaFc7XG4vKipcbiAqIEFsaWFzIG9mIFtgbWF0Y2hgXSgjbWF0Y2gpLlxuICpcbiAqIEBjYXRlZ29yeSBwYXR0ZXJuIG1hdGNoaW5nXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciBmb2xkID0gbWF0Y2g7XG4vKipcbiAqIExlc3Mgc3RyaWN0IHZlcnNpb24gb2YgW2BnZXRPckVsc2VgXSgjZ2V0b3JlbHNlKS5cbiAqXG4gKiBUaGUgYFdgIHN1ZmZpeCAoc2hvcnQgZm9yICoqVyoqaWRlbmluZykgbWVhbnMgdGhhdCB0aGUgaGFuZGxlciByZXR1cm4gdHlwZSB3aWxsIGJlIG1lcmdlZC5cbiAqXG4gKiBAY2F0ZWdvcnkgZXJyb3IgaGFuZGxpbmdcbiAqIEBzaW5jZSAyLjYuMFxuICovXG5leHBvcnQgdmFyIGdldE9yRWxzZVcgPSBmdW5jdGlvbiAob25Ob25lKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChtYSkge1xuICAgICAgICByZXR1cm4gaXNOb25lKG1hKSA/IG9uTm9uZSgpIDogbWEudmFsdWU7XG4gICAgfTtcbn07XG4vKipcbiAqIEV4dHJhY3RzIHRoZSB2YWx1ZSBvdXQgb2YgdGhlIHN0cnVjdHVyZSwgaWYgaXQgZXhpc3RzLiBPdGhlcndpc2UgcmV0dXJucyB0aGUgZ2l2ZW4gZGVmYXVsdCB2YWx1ZVxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBzb21lLCBub25lLCBnZXRPckVsc2UgfSBmcm9tICdmcC10cy9PcHRpb24nXG4gKiBpbXBvcnQgeyBwaXBlIH0gZnJvbSAnZnAtdHMvZnVuY3Rpb24nXG4gKlxuICogYXNzZXJ0LnN0cmljdEVxdWFsKFxuICogICBwaXBlKFxuICogICAgIHNvbWUoMSksXG4gKiAgICAgZ2V0T3JFbHNlKCgpID0+IDApXG4gKiAgICksXG4gKiAgIDFcbiAqIClcbiAqIGFzc2VydC5zdHJpY3RFcXVhbChcbiAqICAgcGlwZShcbiAqICAgICBub25lLFxuICogICAgIGdldE9yRWxzZSgoKSA9PiAwKVxuICogICApLFxuICogICAwXG4gKiApXG4gKlxuICogQGNhdGVnb3J5IGVycm9yIGhhbmRsaW5nXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciBnZXRPckVsc2UgPSBnZXRPckVsc2VXO1xuLyoqXG4gKiBAY2F0ZWdvcnkgbWFwcGluZ1xuICogQHNpbmNlIDIuMTAuMFxuICovXG5leHBvcnQgdmFyIGZsYXAgPSAvKiNfX1BVUkVfXyovIGZsYXBfKEZ1bmN0b3IpO1xuLyoqXG4gKiBDb21iaW5lIHR3byBlZmZlY3RmdWwgYWN0aW9ucywga2VlcGluZyBvbmx5IHRoZSByZXN1bHQgb2YgdGhlIGZpcnN0LlxuICpcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIGFwRmlyc3QgPSAvKiNfX1BVUkVfXyovIGFwRmlyc3RfKEFwcGx5KTtcbi8qKlxuICogQ29tYmluZSB0d28gZWZmZWN0ZnVsIGFjdGlvbnMsIGtlZXBpbmcgb25seSB0aGUgcmVzdWx0IG9mIHRoZSBzZWNvbmQuXG4gKlxuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgYXBTZWNvbmQgPSAvKiNfX1BVUkVfXyovIGFwU2Vjb25kXyhBcHBseSk7XG4vKipcbiAqIEBjYXRlZ29yeSBzZXF1ZW5jaW5nXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciBmbGF0dGVuID0gY29tcGFjdDtcbi8qKlxuICogQ29tcG9zZXMgY29tcHV0YXRpb25zIGluIHNlcXVlbmNlLCB1c2luZyB0aGUgcmV0dXJuIHZhbHVlIG9mIG9uZSBjb21wdXRhdGlvbiB0byBkZXRlcm1pbmUgdGhlIG5leHQgY29tcHV0YXRpb24gYW5kXG4gKiBrZWVwaW5nIG9ubHkgdGhlIHJlc3VsdCBvZiB0aGUgZmlyc3QuXG4gKlxuICogQGNhdGVnb3J5IGNvbWJpbmF0b3JzXG4gKiBAc2luY2UgMi4xNS4wXG4gKi9cbmV4cG9ydCB2YXIgdGFwID0gLyojX19QVVJFX18qLyBkdWFsKDIsIGNoYWluYWJsZS50YXAoQ2hhaW4pKTtcbi8qKlxuICogQ29tcG9zZXMgY29tcHV0YXRpb25zIGluIHNlcXVlbmNlLCB1c2luZyB0aGUgcmV0dXJuIHZhbHVlIG9mIG9uZSBjb21wdXRhdGlvbiB0byBkZXRlcm1pbmUgdGhlIG5leHQgY29tcHV0YXRpb24gYW5kXG4gKiBrZWVwaW5nIG9ubHkgdGhlIHJlc3VsdCBvZiB0aGUgZmlyc3QuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IHBpcGUgfSBmcm9tICdmcC10cy9mdW5jdGlvbidcbiAqIGltcG9ydCAqIGFzIE8gZnJvbSAnZnAtdHMvT3B0aW9uJ1xuICogaW1wb3J0ICogYXMgRSBmcm9tICdmcC10cy9FaXRoZXInXG4gKlxuICogY29uc3QgY29tcHV0ZSA9ICh2YWx1ZTogbnVtYmVyKSA9PiBwaXBlKFxuICogICBPLm9mKHZhbHVlKSxcbiAqICAgTy50YXBFaXRoZXIoKHZhbHVlKSA9PiB2YWx1ZSA+IDAgPyBFLnJpZ2h0KCdvaycpIDogRS5sZWZ0KCdlcnJvcicpKSxcbiAqIClcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKGNvbXB1dGUoMSksIE8ub2YoMSkpXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKGNvbXB1dGUoLTQyKSwgTy5ub25lKVxuICpcbiAqIEBjYXRlZ29yeSBjb21iaW5hdG9yc1xuICogQHNpbmNlIDIuMTYuMFxuICovXG5leHBvcnQgdmFyIHRhcEVpdGhlciA9IC8qI19fUFVSRV9fKi8gZHVhbCgyLCB0YXBFaXRoZXJfKEZyb21FaXRoZXIsIENoYWluKSk7XG4vKipcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIGR1cGxpY2F0ZSA9IC8qI19fUFVSRV9fKi8gZXh0ZW5kKGlkZW50aXR5KTtcbi8qKlxuICogQGNhdGVnb3J5IGxpZnRpbmdcbiAqIEBzaW5jZSAyLjExLjBcbiAqL1xuZXhwb3J0IHZhciBmcm9tRWl0aGVySyA9IC8qI19fUFVSRV9fKi8gZnJvbUVpdGhlcktfKEZyb21FaXRoZXIpO1xuLyoqXG4gKiBAY2F0ZWdvcnkgc2VxdWVuY2luZ1xuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIGNoYWluRWl0aGVySyA9IFxuLyojX19QVVJFX18qLyBjaGFpbkVpdGhlcktfKEZyb21FaXRoZXIsIENoYWluKTtcbi8qKlxuICogQWxpYXMgb2YgYHRhcEVpdGhlcmAuXG4gKlxuICogQGNhdGVnb3J5IGxlZ2FjeVxuICogQHNpbmNlIDIuMTIuMFxuICovXG5leHBvcnQgdmFyIGNoYWluRmlyc3RFaXRoZXJLID0gdGFwRWl0aGVyO1xuLyoqXG4gKiBDb25zdHJ1Y3RzIGEgbmV3IGBPcHRpb25gIGZyb20gYSBudWxsYWJsZSB0eXBlLiBJZiB0aGUgdmFsdWUgaXMgYG51bGxgIG9yIGB1bmRlZmluZWRgLCByZXR1cm5zIGBOb25lYCwgb3RoZXJ3aXNlXG4gKiByZXR1cm5zIHRoZSB2YWx1ZSB3cmFwcGVkIGluIGEgYFNvbWVgLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBub25lLCBzb21lLCBmcm9tTnVsbGFibGUgfSBmcm9tICdmcC10cy9PcHRpb24nXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChmcm9tTnVsbGFibGUodW5kZWZpbmVkKSwgbm9uZSlcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoZnJvbU51bGxhYmxlKG51bGwpLCBub25lKVxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChmcm9tTnVsbGFibGUoMSksIHNvbWUoMSkpXG4gKlxuICogQGNhdGVnb3J5IGNvbnZlcnNpb25zXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciBmcm9tTnVsbGFibGUgPSBmdW5jdGlvbiAoYSkgeyByZXR1cm4gKGEgPT0gbnVsbCA/IG5vbmUgOiBzb21lKGEpKTsgfTtcbi8qKlxuICogVHJhbnNmb3JtcyBhbiBleGNlcHRpb24gaW50byBhbiBgT3B0aW9uYC4gSWYgYGZgIHRocm93cywgcmV0dXJucyBgTm9uZWAsIG90aGVyd2lzZSByZXR1cm5zIHRoZSBvdXRwdXQgd3JhcHBlZCBpbiBhXG4gKiBgU29tZWAuXG4gKlxuICogU2VlIGFsc28gW2B0cnlDYXRjaEtgXSgjdHJ5Y2F0Y2hrKS5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgbm9uZSwgc29tZSwgdHJ5Q2F0Y2ggfSBmcm9tICdmcC10cy9PcHRpb24nXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChcbiAqICAgdHJ5Q2F0Y2goKCkgPT4ge1xuICogICAgIHRocm93IG5ldyBFcnJvcigpXG4gKiAgIH0pLFxuICogICBub25lXG4gKiApXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKHRyeUNhdGNoKCgpID0+IDEpLCBzb21lKDEpKVxuICpcbiAqIEBjYXRlZ29yeSBpbnRlcm9wXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciB0cnlDYXRjaCA9IGZ1bmN0aW9uIChmKSB7XG4gICAgdHJ5IHtcbiAgICAgICAgcmV0dXJuIHNvbWUoZigpKTtcbiAgICB9XG4gICAgY2F0Y2ggKGUpIHtcbiAgICAgICAgcmV0dXJuIG5vbmU7XG4gICAgfVxufTtcbi8qKlxuICogQ29udmVydHMgYSBmdW5jdGlvbiB0aGF0IG1heSB0aHJvdyB0byBvbmUgcmV0dXJuaW5nIGEgYE9wdGlvbmAuXG4gKlxuICogQGNhdGVnb3J5IGludGVyb3BcbiAqIEBzaW5jZSAyLjEwLjBcbiAqL1xuZXhwb3J0IHZhciB0cnlDYXRjaEsgPSBmdW5jdGlvbiAoZikge1xuICAgIHJldHVybiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBhID0gW107XG4gICAgICAgIGZvciAodmFyIF9pID0gMDsgX2kgPCBhcmd1bWVudHMubGVuZ3RoOyBfaSsrKSB7XG4gICAgICAgICAgICBhW19pXSA9IGFyZ3VtZW50c1tfaV07XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRyeUNhdGNoKGZ1bmN0aW9uICgpIHsgcmV0dXJuIGYuYXBwbHkodm9pZCAwLCBhKTsgfSk7XG4gICAgfTtcbn07XG4vKipcbiAqIFJldHVybnMgYSAqc21hcnQgY29uc3RydWN0b3IqIGZyb20gYSBmdW5jdGlvbiB0aGF0IHJldHVybnMgYSBudWxsYWJsZSB2YWx1ZS5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgZnJvbU51bGxhYmxlSywgbm9uZSwgc29tZSB9IGZyb20gJ2ZwLXRzL09wdGlvbidcbiAqXG4gKiBjb25zdCBmID0gKHM6IHN0cmluZyk6IG51bWJlciB8IHVuZGVmaW5lZCA9PiB7XG4gKiAgIGNvbnN0IG4gPSBwYXJzZUZsb2F0KHMpXG4gKiAgIHJldHVybiBpc05hTihuKSA/IHVuZGVmaW5lZCA6IG5cbiAqIH1cbiAqXG4gKiBjb25zdCBnID0gZnJvbU51bGxhYmxlSyhmKVxuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoZygnMScpLCBzb21lKDEpKVxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChnKCdhJyksIG5vbmUpXG4gKlxuICogQGNhdGVnb3J5IGxpZnRpbmdcbiAqIEBzaW5jZSAyLjkuMFxuICovXG5leHBvcnQgdmFyIGZyb21OdWxsYWJsZUsgPSBmdW5jdGlvbiAoZikgeyByZXR1cm4gZmxvdyhmLCBmcm9tTnVsbGFibGUpOyB9O1xuLyoqXG4gKiBUaGlzIGlzIGBjaGFpbmAgKyBgZnJvbU51bGxhYmxlYCwgdXNlZnVsIHdoZW4gd29ya2luZyB3aXRoIG9wdGlvbmFsIHZhbHVlcy5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgc29tZSwgbm9uZSwgZnJvbU51bGxhYmxlLCBjaGFpbk51bGxhYmxlSyB9IGZyb20gJ2ZwLXRzL09wdGlvbidcbiAqIGltcG9ydCB7IHBpcGUgfSBmcm9tICdmcC10cy9mdW5jdGlvbidcbiAqXG4gKiBpbnRlcmZhY2UgRW1wbG95ZWUge1xuICogICByZWFkb25seSBjb21wYW55Pzoge1xuICogICAgIHJlYWRvbmx5IGFkZHJlc3M/OiB7XG4gKiAgICAgICByZWFkb25seSBzdHJlZXQ/OiB7XG4gKiAgICAgICAgIHJlYWRvbmx5IG5hbWU/OiBzdHJpbmdcbiAqICAgICAgIH1cbiAqICAgICB9XG4gKiAgIH1cbiAqIH1cbiAqXG4gKiBjb25zdCBlbXBsb3llZTE6IEVtcGxveWVlID0geyBjb21wYW55OiB7IGFkZHJlc3M6IHsgc3RyZWV0OiB7IG5hbWU6ICdoaWdoIHN0cmVldCcgfSB9IH0gfVxuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoXG4gKiAgIHBpcGUoXG4gKiAgICAgZnJvbU51bGxhYmxlKGVtcGxveWVlMS5jb21wYW55KSxcbiAqICAgICBjaGFpbk51bGxhYmxlSyhjb21wYW55ID0+IGNvbXBhbnkuYWRkcmVzcyksXG4gKiAgICAgY2hhaW5OdWxsYWJsZUsoYWRkcmVzcyA9PiBhZGRyZXNzLnN0cmVldCksXG4gKiAgICAgY2hhaW5OdWxsYWJsZUsoc3RyZWV0ID0+IHN0cmVldC5uYW1lKVxuICogICApLFxuICogICBzb21lKCdoaWdoIHN0cmVldCcpXG4gKiApXG4gKlxuICogY29uc3QgZW1wbG95ZWUyOiBFbXBsb3llZSA9IHsgY29tcGFueTogeyBhZGRyZXNzOiB7IHN0cmVldDoge30gfSB9IH1cbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKFxuICogICBwaXBlKFxuICogICAgIGZyb21OdWxsYWJsZShlbXBsb3llZTIuY29tcGFueSksXG4gKiAgICAgY2hhaW5OdWxsYWJsZUsoY29tcGFueSA9PiBjb21wYW55LmFkZHJlc3MpLFxuICogICAgIGNoYWluTnVsbGFibGVLKGFkZHJlc3MgPT4gYWRkcmVzcy5zdHJlZXQpLFxuICogICAgIGNoYWluTnVsbGFibGVLKHN0cmVldCA9PiBzdHJlZXQubmFtZSlcbiAqICAgKSxcbiAqICAgbm9uZVxuICogKVxuICpcbiAqIEBjYXRlZ29yeSBzZXF1ZW5jaW5nXG4gKiBAc2luY2UgMi45LjBcbiAqL1xuZXhwb3J0IHZhciBjaGFpbk51bGxhYmxlSyA9IGZ1bmN0aW9uIChmKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChtYSkge1xuICAgICAgICByZXR1cm4gaXNOb25lKG1hKSA/IG5vbmUgOiBmcm9tTnVsbGFibGUoZihtYS52YWx1ZSkpO1xuICAgIH07XG59O1xuLyoqXG4gKiBFeHRyYWN0cyB0aGUgdmFsdWUgb3V0IG9mIHRoZSBzdHJ1Y3R1cmUsIGlmIGl0IGV4aXN0cy4gT3RoZXJ3aXNlIHJldHVybnMgYG51bGxgLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBzb21lLCBub25lLCB0b051bGxhYmxlIH0gZnJvbSAnZnAtdHMvT3B0aW9uJ1xuICogaW1wb3J0IHsgcGlwZSB9IGZyb20gJ2ZwLXRzL2Z1bmN0aW9uJ1xuICpcbiAqIGFzc2VydC5zdHJpY3RFcXVhbChcbiAqICAgcGlwZShcbiAqICAgICBzb21lKDEpLFxuICogICAgIHRvTnVsbGFibGVcbiAqICAgKSxcbiAqICAgMVxuICogKVxuICogYXNzZXJ0LnN0cmljdEVxdWFsKFxuICogICBwaXBlKFxuICogICAgIG5vbmUsXG4gKiAgICAgdG9OdWxsYWJsZVxuICogICApLFxuICogICBudWxsXG4gKiApXG4gKlxuICogQGNhdGVnb3J5IGNvbnZlcnNpb25zXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciB0b051bGxhYmxlID0gLyojX19QVVJFX18qLyBtYXRjaChjb25zdE51bGwsIGlkZW50aXR5KTtcbi8qKlxuICogRXh0cmFjdHMgdGhlIHZhbHVlIG91dCBvZiB0aGUgc3RydWN0dXJlLCBpZiBpdCBleGlzdHMuIE90aGVyd2lzZSByZXR1cm5zIGB1bmRlZmluZWRgLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBzb21lLCBub25lLCB0b1VuZGVmaW5lZCB9IGZyb20gJ2ZwLXRzL09wdGlvbidcbiAqIGltcG9ydCB7IHBpcGUgfSBmcm9tICdmcC10cy9mdW5jdGlvbidcbiAqXG4gKiBhc3NlcnQuc3RyaWN0RXF1YWwoXG4gKiAgIHBpcGUoXG4gKiAgICAgc29tZSgxKSxcbiAqICAgICB0b1VuZGVmaW5lZFxuICogICApLFxuICogICAxXG4gKiApXG4gKiBhc3NlcnQuc3RyaWN0RXF1YWwoXG4gKiAgIHBpcGUoXG4gKiAgICAgbm9uZSxcbiAqICAgICB0b1VuZGVmaW5lZFxuICogICApLFxuICogICB1bmRlZmluZWRcbiAqIClcbiAqXG4gKiBAY2F0ZWdvcnkgY29udmVyc2lvbnNcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIHRvVW5kZWZpbmVkID0gLyojX19QVVJFX18qLyBtYXRjaChjb25zdFVuZGVmaW5lZCwgaWRlbnRpdHkpO1xuZXhwb3J0IGZ1bmN0aW9uIGVsZW0oRSkge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYSwgbWEpIHtcbiAgICAgICAgaWYgKG1hID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIHZhciBlbGVtRV8xID0gZWxlbShFKTtcbiAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbiAobWEpIHsgcmV0dXJuIGVsZW1FXzEoYSwgbWEpOyB9O1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBpc05vbmUobWEpID8gZmFsc2UgOiBFLmVxdWFscyhhLCBtYS52YWx1ZSk7XG4gICAgfTtcbn1cbi8qKlxuICogUmV0dXJucyBgdHJ1ZWAgaWYgdGhlIHByZWRpY2F0ZSBpcyBzYXRpc2ZpZWQgYnkgdGhlIHdyYXBwZWQgdmFsdWVcbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgc29tZSwgbm9uZSwgZXhpc3RzIH0gZnJvbSAnZnAtdHMvT3B0aW9uJ1xuICogaW1wb3J0IHsgcGlwZSB9IGZyb20gJ2ZwLXRzL2Z1bmN0aW9uJ1xuICpcbiAqIGFzc2VydC5zdHJpY3RFcXVhbChcbiAqICAgcGlwZShcbiAqICAgICBzb21lKDEpLFxuICogICAgIGV4aXN0cyhuID0+IG4gPiAwKVxuICogICApLFxuICogICB0cnVlXG4gKiApXG4gKiBhc3NlcnQuc3RyaWN0RXF1YWwoXG4gKiAgIHBpcGUoXG4gKiAgICAgc29tZSgxKSxcbiAqICAgICBleGlzdHMobiA9PiBuID4gMSlcbiAqICAgKSxcbiAqICAgZmFsc2VcbiAqIClcbiAqIGFzc2VydC5zdHJpY3RFcXVhbChcbiAqICAgcGlwZShcbiAqICAgICBub25lLFxuICogICAgIGV4aXN0cyhuID0+IG4gPiAwKVxuICogICApLFxuICogICBmYWxzZVxuICogKVxuICpcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIGV4aXN0cyA9IGZ1bmN0aW9uIChwcmVkaWNhdGUpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKG1hKSB7XG4gICAgICAgIHJldHVybiBpc05vbmUobWEpID8gZmFsc2UgOiBwcmVkaWNhdGUobWEudmFsdWUpO1xuICAgIH07XG59O1xuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLy8gZG8gbm90YXRpb25cbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8qKlxuICogQGNhdGVnb3J5IGRvIG5vdGF0aW9uXG4gKiBAc2luY2UgMi45LjBcbiAqL1xuZXhwb3J0IHZhciBEbyA9IC8qI19fUFVSRV9fKi8gb2YoXy5lbXB0eVJlY29yZCk7XG4vKipcbiAqIEBjYXRlZ29yeSBkbyBub3RhdGlvblxuICogQHNpbmNlIDIuOC4wXG4gKi9cbmV4cG9ydCB2YXIgYmluZFRvID0gLyojX19QVVJFX18qLyBiaW5kVG9fKEZ1bmN0b3IpO1xudmFyIGxldF8gPSAvKiNfX1BVUkVfXyovIGxldF9fKEZ1bmN0b3IpO1xuZXhwb3J0IHsgXG4vKipcbiAqIEBjYXRlZ29yeSBkbyBub3RhdGlvblxuICogQHNpbmNlIDIuMTMuMFxuICovXG5sZXRfIGFzIGxldCB9O1xuLyoqXG4gKiBAY2F0ZWdvcnkgZG8gbm90YXRpb25cbiAqIEBzaW5jZSAyLjguMFxuICovXG5leHBvcnQgdmFyIGJpbmQgPSAvKiNfX1BVUkVfXyovIGNoYWluYWJsZS5iaW5kKENoYWluKTtcbi8qKlxuICogQGNhdGVnb3J5IGRvIG5vdGF0aW9uXG4gKiBAc2luY2UgMi44LjBcbiAqL1xuZXhwb3J0IHZhciBhcFMgPSAvKiNfX1BVUkVfXyovIGFwU18oQXBwbHkpO1xuLyoqXG4gKiBAc2luY2UgMi4xMS4wXG4gKi9cbmV4cG9ydCB2YXIgQXBUID0gLyojX19QVVJFX18qLyBvZihfLmVtcHR5UmVhZG9ubHlBcnJheSk7XG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vLyBhcnJheSB1dGlsc1xuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLyoqXG4gKiBFcXVpdmFsZW50IHRvIGBSZWFkb25seU5vbkVtcHR5QXJyYXkjdHJhdmVyc2VXaXRoSW5kZXgoQXBwbGljYXRpdmUpYC5cbiAqXG4gKiBAY2F0ZWdvcnkgdHJhdmVyc2luZ1xuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIHRyYXZlcnNlUmVhZG9ubHlOb25FbXB0eUFycmF5V2l0aEluZGV4ID0gZnVuY3Rpb24gKGYpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIHZhciBvID0gZigwLCBfLmhlYWQoYXMpKTtcbiAgICAgICAgaWYgKGlzTm9uZShvKSkge1xuICAgICAgICAgICAgcmV0dXJuIG5vbmU7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIG91dCA9IFtvLnZhbHVlXTtcbiAgICAgICAgZm9yICh2YXIgaSA9IDE7IGkgPCBhcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgdmFyIG9fMSA9IGYoaSwgYXNbaV0pO1xuICAgICAgICAgICAgaWYgKGlzTm9uZShvXzEpKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG5vbmU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBvdXQucHVzaChvXzEudmFsdWUpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBzb21lKG91dCk7XG4gICAgfTtcbn07XG4vKipcbiAqIEVxdWl2YWxlbnQgdG8gYFJlYWRvbmx5QXJyYXkjdHJhdmVyc2VXaXRoSW5kZXgoQXBwbGljYXRpdmUpYC5cbiAqXG4gKiBAY2F0ZWdvcnkgdHJhdmVyc2luZ1xuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIHRyYXZlcnNlUmVhZG9ubHlBcnJheVdpdGhJbmRleCA9IGZ1bmN0aW9uIChmKSB7XG4gICAgdmFyIGcgPSB0cmF2ZXJzZVJlYWRvbmx5Tm9uRW1wdHlBcnJheVdpdGhJbmRleChmKTtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7IHJldHVybiAoXy5pc05vbkVtcHR5KGFzKSA/IGcoYXMpIDogQXBUKTsgfTtcbn07XG4vKipcbiAqIEVxdWl2YWxlbnQgdG8gYFJlYWRvbmx5QXJyYXkjdHJhdmVyc2VXaXRoSW5kZXgoQXBwbGljYXRpdmUpYC5cbiAqXG4gKiBAY2F0ZWdvcnkgdHJhdmVyc2luZ1xuICogQHNpbmNlIDIuOS4wXG4gKi9cbmV4cG9ydCB2YXIgdHJhdmVyc2VBcnJheVdpdGhJbmRleCA9IHRyYXZlcnNlUmVhZG9ubHlBcnJheVdpdGhJbmRleDtcbi8qKlxuICogRXF1aXZhbGVudCB0byBgUmVhZG9ubHlBcnJheSN0cmF2ZXJzZShBcHBsaWNhdGl2ZSlgLlxuICpcbiAqIEBjYXRlZ29yeSB0cmF2ZXJzaW5nXG4gKiBAc2luY2UgMi45LjBcbiAqL1xuZXhwb3J0IHZhciB0cmF2ZXJzZUFycmF5ID0gZnVuY3Rpb24gKGYpIHtcbiAgICByZXR1cm4gdHJhdmVyc2VSZWFkb25seUFycmF5V2l0aEluZGV4KGZ1bmN0aW9uIChfLCBhKSB7IHJldHVybiBmKGEpOyB9KTtcbn07XG4vKipcbiAqIEVxdWl2YWxlbnQgdG8gYFJlYWRvbmx5QXJyYXkjc2VxdWVuY2UoQXBwbGljYXRpdmUpYC5cbiAqXG4gKiBAY2F0ZWdvcnkgdHJhdmVyc2luZ1xuICogQHNpbmNlIDIuOS4wXG4gKi9cbmV4cG9ydCB2YXIgc2VxdWVuY2VBcnJheSA9IFxuLyojX19QVVJFX18qLyB0cmF2ZXJzZUFycmF5KGlkZW50aXR5KTtcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8vIGxlZ2FjeVxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLyoqXG4gKiBBbGlhcyBvZiBgZmxhdE1hcGAuXG4gKlxuICogQGNhdGVnb3J5IGxlZ2FjeVxuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgY2hhaW4gPSBmbGF0TWFwO1xuLyoqXG4gKiBBbGlhcyBvZiBgdGFwYC5cbiAqXG4gKiBAY2F0ZWdvcnkgbGVnYWN5XG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciBjaGFpbkZpcnN0ID0gdGFwO1xuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLy8gZGVwcmVjYXRlZFxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLyoqXG4gKiBVc2UgYFJlZmluZW1lbnRgIG1vZHVsZSBpbnN0ZWFkLlxuICpcbiAqIEBjYXRlZ29yeSB6b25lIG9mIGRlYXRoXG4gKiBAc2luY2UgMi4wLjBcbiAqIEBkZXByZWNhdGVkXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBnZXRSZWZpbmVtZW50KGdldE9wdGlvbikge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYSkgeyByZXR1cm4gaXNTb21lKGdldE9wdGlvbihhKSk7IH07XG59XG4vKipcbiAqIFVzZSBbYGNoYWluTnVsbGFibGVLYF0oI2NoYWlubnVsbGFibGVrKSBpbnN0ZWFkLlxuICpcbiAqIEBjYXRlZ29yeSB6b25lIG9mIGRlYXRoXG4gKiBAc2luY2UgMi4wLjBcbiAqIEBkZXByZWNhdGVkXG4gKi9cbmV4cG9ydCB2YXIgbWFwTnVsbGFibGUgPSBjaGFpbk51bGxhYmxlSztcbi8qKlxuICogVGhpcyBpbnN0YW5jZSBpcyBkZXByZWNhdGVkLCB1c2Ugc21hbGwsIHNwZWNpZmljIGluc3RhbmNlcyBpbnN0ZWFkLlxuICogRm9yIGV4YW1wbGUgaWYgYSBmdW5jdGlvbiBuZWVkcyBhIGBGdW5jdG9yYCBpbnN0YW5jZSwgcGFzcyBgTy5GdW5jdG9yYCBpbnN0ZWFkIG9mIGBPLm9wdGlvbmBcbiAqICh3aGVyZSBgT2AgaXMgZnJvbSBgaW1wb3J0IE8gZnJvbSAnZnAtdHMvT3B0aW9uJ2ApXG4gKlxuICogQGNhdGVnb3J5IHpvbmUgb2YgZGVhdGhcbiAqIEBzaW5jZSAyLjAuMFxuICogQGRlcHJlY2F0ZWRcbiAqL1xuZXhwb3J0IHZhciBvcHRpb24gPSB7XG4gICAgVVJJOiBVUkksXG4gICAgbWFwOiBfbWFwLFxuICAgIG9mOiBvZixcbiAgICBhcDogX2FwLFxuICAgIGNoYWluOiBmbGF0TWFwLFxuICAgIHJlZHVjZTogX3JlZHVjZSxcbiAgICBmb2xkTWFwOiBfZm9sZE1hcCxcbiAgICByZWR1Y2VSaWdodDogX3JlZHVjZVJpZ2h0LFxuICAgIHRyYXZlcnNlOiBfdHJhdmVyc2UsXG4gICAgc2VxdWVuY2U6IHNlcXVlbmNlLFxuICAgIHplcm86IHplcm8sXG4gICAgYWx0OiBfYWx0LFxuICAgIGV4dGVuZDogX2V4dGVuZCxcbiAgICBjb21wYWN0OiBjb21wYWN0LFxuICAgIHNlcGFyYXRlOiBzZXBhcmF0ZSxcbiAgICBmaWx0ZXI6IF9maWx0ZXIsXG4gICAgZmlsdGVyTWFwOiBfZmlsdGVyTWFwLFxuICAgIHBhcnRpdGlvbjogX3BhcnRpdGlvbixcbiAgICBwYXJ0aXRpb25NYXA6IF9wYXJ0aXRpb25NYXAsXG4gICAgd2l0aGVyOiBfd2l0aGVyLFxuICAgIHdpbHQ6IF93aWx0LFxuICAgIHRocm93RXJyb3I6IHRocm93RXJyb3Jcbn07XG4vKipcbiAqIFVzZSBbYGdldEFwcGx5U2VtaWdyb3VwYF0oLi9BcHBseS50cy5odG1sI2dldGFwcGx5c2VtaWdyb3VwKSBpbnN0ZWFkLlxuICpcbiAqIEBjYXRlZ29yeSB6b25lIG9mIGRlYXRoXG4gKiBAc2luY2UgMi4wLjBcbiAqIEBkZXByZWNhdGVkXG4gKi9cbmV4cG9ydCB2YXIgZ2V0QXBwbHlTZW1pZ3JvdXAgPSAvKiNfX1BVUkVfXyovIGdldEFwcGx5U2VtaWdyb3VwXyhBcHBseSk7XG4vKipcbiAqIFVzZSBbYGdldEFwcGxpY2F0aXZlTW9ub2lkYF0oLi9BcHBsaWNhdGl2ZS50cy5odG1sI2dldGFwcGxpY2F0aXZlbW9ub2lkKSBpbnN0ZWFkLlxuICpcbiAqIEBjYXRlZ29yeSB6b25lIG9mIGRlYXRoXG4gKiBAc2luY2UgMi4wLjBcbiAqIEBkZXByZWNhdGVkXG4gKi9cbmV4cG9ydCB2YXIgZ2V0QXBwbHlNb25vaWQgPSAvKiNfX1BVUkVfXyovIGdldEFwcGxpY2F0aXZlTW9ub2lkKEFwcGxpY2F0aXZlKTtcbi8qKlxuICogVXNlXG4gKlxuICogYGBgdHNcbiAqIGltcG9ydCB7IGZpcnN0IH0gZnJvbSAnZnAtdHMvU2VtaWdyb3VwJ1xuICogaW1wb3J0IHsgZ2V0TW9ub2lkIH0gZnJvbSAnZnAtdHMvT3B0aW9uJ1xuICpcbiAqIGdldE1vbm9pZChmaXJzdCgpKVxuICogYGBgXG4gKlxuICogaW5zdGVhZC5cbiAqXG4gKiBNb25vaWQgcmV0dXJuaW5nIHRoZSBsZWZ0LW1vc3Qgbm9uLWBOb25lYCB2YWx1ZVxuICpcbiAqIHwgeCAgICAgICB8IHkgICAgICAgfCBjb25jYXQoeCwgeSkgfFxuICogfCAtLS0tLS0tIHwgLS0tLS0tLSB8IC0tLS0tLS0tLS0tLSB8XG4gKiB8IG5vbmUgICAgfCBub25lICAgIHwgbm9uZSAgICAgICAgIHxcbiAqIHwgc29tZShhKSB8IG5vbmUgICAgfCBzb21lKGEpICAgICAgfFxuICogfCBub25lICAgIHwgc29tZShiKSB8IHNvbWUoYikgICAgICB8XG4gKiB8IHNvbWUoYSkgfCBzb21lKGIpIHwgc29tZShhKSAgICAgIHxcbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgZ2V0Rmlyc3RNb25vaWQsIHNvbWUsIG5vbmUgfSBmcm9tICdmcC10cy9PcHRpb24nXG4gKlxuICogY29uc3QgTSA9IGdldEZpcnN0TW9ub2lkPG51bWJlcj4oKVxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChNLmNvbmNhdChub25lLCBub25lKSwgbm9uZSlcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoTS5jb25jYXQoc29tZSgxKSwgbm9uZSksIHNvbWUoMSkpXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKE0uY29uY2F0KG5vbmUsIHNvbWUoMikpLCBzb21lKDIpKVxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChNLmNvbmNhdChzb21lKDEpLCBzb21lKDIpKSwgc29tZSgxKSlcbiAqXG4gKiBAY2F0ZWdvcnkgem9uZSBvZiBkZWF0aFxuICogQHNpbmNlIDIuMC4wXG4gKiBAZGVwcmVjYXRlZFxuICovXG5leHBvcnQgdmFyIGdldEZpcnN0TW9ub2lkID0gZnVuY3Rpb24gKCkgeyByZXR1cm4gZ2V0TW9ub2lkKGZpcnN0KCkpOyB9O1xuLyoqXG4gKiBVc2VcbiAqXG4gKiBgYGB0c1xuICogaW1wb3J0IHsgbGFzdCB9IGZyb20gJ2ZwLXRzL1NlbWlncm91cCdcbiAqIGltcG9ydCB7IGdldE1vbm9pZCB9IGZyb20gJ2ZwLXRzL09wdGlvbidcbiAqXG4gKiBnZXRNb25vaWQobGFzdCgpKVxuICogYGBgXG4gKlxuICogaW5zdGVhZC5cbiAqXG4gKiBNb25vaWQgcmV0dXJuaW5nIHRoZSByaWdodC1tb3N0IG5vbi1gTm9uZWAgdmFsdWVcbiAqXG4gKiB8IHggICAgICAgfCB5ICAgICAgIHwgY29uY2F0KHgsIHkpIHxcbiAqIHwgLS0tLS0tLSB8IC0tLS0tLS0gfCAtLS0tLS0tLS0tLS0gfFxuICogfCBub25lICAgIHwgbm9uZSAgICB8IG5vbmUgICAgICAgICB8XG4gKiB8IHNvbWUoYSkgfCBub25lICAgIHwgc29tZShhKSAgICAgIHxcbiAqIHwgbm9uZSAgICB8IHNvbWUoYikgfCBzb21lKGIpICAgICAgfFxuICogfCBzb21lKGEpIHwgc29tZShiKSB8IHNvbWUoYikgICAgICB8XG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IGdldExhc3RNb25vaWQsIHNvbWUsIG5vbmUgfSBmcm9tICdmcC10cy9PcHRpb24nXG4gKlxuICogY29uc3QgTSA9IGdldExhc3RNb25vaWQ8bnVtYmVyPigpXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKE0uY29uY2F0KG5vbmUsIG5vbmUpLCBub25lKVxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChNLmNvbmNhdChzb21lKDEpLCBub25lKSwgc29tZSgxKSlcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoTS5jb25jYXQobm9uZSwgc29tZSgyKSksIHNvbWUoMikpXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKE0uY29uY2F0KHNvbWUoMSksIHNvbWUoMikpLCBzb21lKDIpKVxuICpcbiAqIEBjYXRlZ29yeSB6b25lIG9mIGRlYXRoXG4gKiBAc2luY2UgMi4wLjBcbiAqIEBkZXByZWNhdGVkXG4gKi9cbmV4cG9ydCB2YXIgZ2V0TGFzdE1vbm9pZCA9IGZ1bmN0aW9uICgpIHsgcmV0dXJuIGdldE1vbm9pZChsYXN0KCkpOyB9O1xuIiwKICAiaW1wb3J0IHsgZ2V0QXBwbGljYXRpdmVNb25vaWQgfSBmcm9tICcuL0FwcGxpY2F0aXZlJztcbmltcG9ydCB7IGFwRmlyc3QgYXMgYXBGaXJzdF8sIGFwUyBhcyBhcFNfLCBhcFNlY29uZCBhcyBhcFNlY29uZF8sIGdldEFwcGx5U2VtaWdyb3VwIGFzIGdldEFwcGx5U2VtaWdyb3VwXyB9IGZyb20gJy4vQXBwbHknO1xuaW1wb3J0ICogYXMgY2hhaW5hYmxlIGZyb20gJy4vQ2hhaW4nO1xuaW1wb3J0IHsgY2hhaW5FaXRoZXJLIGFzIGNoYWluRWl0aGVyS18sIGZyb21FaXRoZXJLIGFzIGZyb21FaXRoZXJLXywgdGFwRWl0aGVyIGFzIHRhcEVpdGhlcl8gfSBmcm9tICcuL0Zyb21FaXRoZXInO1xuaW1wb3J0IHsgY29uc3ROdWxsLCBjb25zdFVuZGVmaW5lZCwgZHVhbCwgZmxvdywgaWRlbnRpdHksIHBpcGUgfSBmcm9tICcuL2Z1bmN0aW9uJztcbmltcG9ydCB7IGFzIGFzIGFzXywgYXNVbml0IGFzIGFzVW5pdF8sIGJpbmRUbyBhcyBiaW5kVG9fLCBmbGFwIGFzIGZsYXBfLCBsZXQgYXMgbGV0X18gfSBmcm9tICcuL0Z1bmN0b3InO1xuaW1wb3J0ICogYXMgXyBmcm9tICcuL2ludGVybmFsJztcbmltcG9ydCB7IG5vdCB9IGZyb20gJy4vUHJlZGljYXRlJztcbmltcG9ydCB7IGZpcnN0LCBsYXN0IH0gZnJvbSAnLi9TZW1pZ3JvdXAnO1xuaW1wb3J0IHsgc2VwYXJhdGVkIH0gZnJvbSAnLi9TZXBhcmF0ZWQnO1xuaW1wb3J0IHsgd2lsdERlZmF1bHQsIHdpdGhlckRlZmF1bHQgfSBmcm9tICcuL1dpdGhlcmFibGUnO1xuaW1wb3J0IHsgZ3VhcmQgYXMgZ3VhcmRfIH0gZnJvbSAnLi9aZXJvJztcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8vIGNvbnN0cnVjdG9yc1xuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLyoqXG4gKiBgTm9uZWAgZG9lc24ndCBoYXZlIGEgY29uc3RydWN0b3IsIGluc3RlYWQgeW91IGNhbiB1c2UgaXQgZGlyZWN0bHkgYXMgYSB2YWx1ZS4gUmVwcmVzZW50cyBhIG1pc3NpbmcgdmFsdWUuXG4gKlxuICogQGNhdGVnb3J5IGNvbnN0cnVjdG9yc1xuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgbm9uZSA9IF8ubm9uZTtcbi8qKlxuICogQ29uc3RydWN0cyBhIGBTb21lYC4gUmVwcmVzZW50cyBhbiBvcHRpb25hbCB2YWx1ZSB0aGF0IGV4aXN0cy5cbiAqXG4gKiBAY2F0ZWdvcnkgY29uc3RydWN0b3JzXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciBzb21lID0gXy5zb21lO1xuZXhwb3J0IGZ1bmN0aW9uIGZyb21QcmVkaWNhdGUocHJlZGljYXRlKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhKSB7IHJldHVybiAocHJlZGljYXRlKGEpID8gc29tZShhKSA6IG5vbmUpOyB9O1xufVxuLyoqXG4gKiBSZXR1cm5zIHRoZSBgTGVmdGAgdmFsdWUgb2YgYW4gYEVpdGhlcmAgaWYgcG9zc2libGUuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IGdldExlZnQsIG5vbmUsIHNvbWUgfSBmcm9tICdmcC10cy9PcHRpb24nXG4gKiBpbXBvcnQgeyByaWdodCwgbGVmdCB9IGZyb20gJ2ZwLXRzL0VpdGhlcidcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKGdldExlZnQocmlnaHQoMSkpLCBub25lKVxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChnZXRMZWZ0KGxlZnQoJ2EnKSksIHNvbWUoJ2EnKSlcbiAqXG4gKiBAY2F0ZWdvcnkgY29uc3RydWN0b3JzXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciBnZXRMZWZ0ID0gZnVuY3Rpb24gKG1hKSB7IHJldHVybiAobWEuX3RhZyA9PT0gJ1JpZ2h0JyA/IG5vbmUgOiBzb21lKG1hLmxlZnQpKTsgfTtcbi8qKlxuICogUmV0dXJucyB0aGUgYFJpZ2h0YCB2YWx1ZSBvZiBhbiBgRWl0aGVyYCBpZiBwb3NzaWJsZS5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgZ2V0UmlnaHQsIG5vbmUsIHNvbWUgfSBmcm9tICdmcC10cy9PcHRpb24nXG4gKiBpbXBvcnQgeyByaWdodCwgbGVmdCB9IGZyb20gJ2ZwLXRzL0VpdGhlcidcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKGdldFJpZ2h0KHJpZ2h0KDEpKSwgc29tZSgxKSlcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoZ2V0UmlnaHQobGVmdCgnYScpKSwgbm9uZSlcbiAqXG4gKiBAY2F0ZWdvcnkgY29uc3RydWN0b3JzXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciBnZXRSaWdodCA9IGZ1bmN0aW9uIChtYSkgeyByZXR1cm4gKG1hLl90YWcgPT09ICdMZWZ0JyA/IG5vbmUgOiBzb21lKG1hLnJpZ2h0KSk7IH07XG52YXIgX21hcCA9IGZ1bmN0aW9uIChmYSwgZikgeyByZXR1cm4gcGlwZShmYSwgbWFwKGYpKTsgfTtcbnZhciBfYXAgPSBmdW5jdGlvbiAoZmFiLCBmYSkgeyByZXR1cm4gcGlwZShmYWIsIGFwKGZhKSk7IH07XG52YXIgX3JlZHVjZSA9IGZ1bmN0aW9uIChmYSwgYiwgZikgeyByZXR1cm4gcGlwZShmYSwgcmVkdWNlKGIsIGYpKTsgfTtcbnZhciBfZm9sZE1hcCA9IGZ1bmN0aW9uIChNKSB7XG4gICAgdmFyIGZvbGRNYXBNID0gZm9sZE1hcChNKTtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGZhLCBmKSB7IHJldHVybiBwaXBlKGZhLCBmb2xkTWFwTShmKSk7IH07XG59O1xudmFyIF9yZWR1Y2VSaWdodCA9IGZ1bmN0aW9uIChmYSwgYiwgZikgeyByZXR1cm4gcGlwZShmYSwgcmVkdWNlUmlnaHQoYiwgZikpOyB9O1xudmFyIF90cmF2ZXJzZSA9IGZ1bmN0aW9uIChGKSB7XG4gICAgdmFyIHRyYXZlcnNlRiA9IHRyYXZlcnNlKEYpO1xuICAgIHJldHVybiBmdW5jdGlvbiAodGEsIGYpIHsgcmV0dXJuIHBpcGUodGEsIHRyYXZlcnNlRihmKSk7IH07XG59O1xuLyogaXN0YW5idWwgaWdub3JlIG5leHQgKi9cbnZhciBfYWx0ID0gZnVuY3Rpb24gKGZhLCB0aGF0KSB7IHJldHVybiBwaXBlKGZhLCBhbHQodGhhdCkpOyB9O1xudmFyIF9maWx0ZXIgPSBmdW5jdGlvbiAoZmEsIHByZWRpY2F0ZSkgeyByZXR1cm4gcGlwZShmYSwgZmlsdGVyKHByZWRpY2F0ZSkpOyB9O1xuLyogaXN0YW5idWwgaWdub3JlIG5leHQgKi9cbnZhciBfZmlsdGVyTWFwID0gZnVuY3Rpb24gKGZhLCBmKSB7IHJldHVybiBwaXBlKGZhLCBmaWx0ZXJNYXAoZikpOyB9O1xuLyogaXN0YW5idWwgaWdub3JlIG5leHQgKi9cbnZhciBfZXh0ZW5kID0gZnVuY3Rpb24gKHdhLCBmKSB7IHJldHVybiBwaXBlKHdhLCBleHRlbmQoZikpOyB9O1xuLyogaXN0YW5idWwgaWdub3JlIG5leHQgKi9cbnZhciBfcGFydGl0aW9uID0gZnVuY3Rpb24gKGZhLCBwcmVkaWNhdGUpIHtcbiAgICByZXR1cm4gcGlwZShmYSwgcGFydGl0aW9uKHByZWRpY2F0ZSkpO1xufTtcbi8qIGlzdGFuYnVsIGlnbm9yZSBuZXh0ICovXG52YXIgX3BhcnRpdGlvbk1hcCA9IGZ1bmN0aW9uIChmYSwgZikgeyByZXR1cm4gcGlwZShmYSwgcGFydGl0aW9uTWFwKGYpKTsgfTtcbi8qKlxuICogQGNhdGVnb3J5IHR5cGUgbGFtYmRhc1xuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgVVJJID0gJ09wdGlvbic7XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIGdldFNob3cgPSBmdW5jdGlvbiAoUykgeyByZXR1cm4gKHtcbiAgICBzaG93OiBmdW5jdGlvbiAobWEpIHsgcmV0dXJuIChpc05vbmUobWEpID8gJ25vbmUnIDogXCJzb21lKFwiLmNvbmNhdChTLnNob3cobWEudmFsdWUpLCBcIilcIikpOyB9XG59KTsgfTtcbi8qKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IG5vbmUsIHNvbWUsIGdldEVxIH0gZnJvbSAnZnAtdHMvT3B0aW9uJ1xuICogaW1wb3J0ICogYXMgTiBmcm9tICdmcC10cy9udW1iZXInXG4gKlxuICogY29uc3QgRSA9IGdldEVxKE4uRXEpXG4gKiBhc3NlcnQuc3RyaWN0RXF1YWwoRS5lcXVhbHMobm9uZSwgbm9uZSksIHRydWUpXG4gKiBhc3NlcnQuc3RyaWN0RXF1YWwoRS5lcXVhbHMobm9uZSwgc29tZSgxKSksIGZhbHNlKVxuICogYXNzZXJ0LnN0cmljdEVxdWFsKEUuZXF1YWxzKHNvbWUoMSksIG5vbmUpLCBmYWxzZSlcbiAqIGFzc2VydC5zdHJpY3RFcXVhbChFLmVxdWFscyhzb21lKDEpLCBzb21lKDIpKSwgZmFsc2UpXG4gKiBhc3NlcnQuc3RyaWN0RXF1YWwoRS5lcXVhbHMoc29tZSgxKSwgc29tZSgxKSksIHRydWUpXG4gKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgZ2V0RXEgPSBmdW5jdGlvbiAoRSkgeyByZXR1cm4gKHtcbiAgICBlcXVhbHM6IGZ1bmN0aW9uICh4LCB5KSB7IHJldHVybiB4ID09PSB5IHx8IChpc05vbmUoeCkgPyBpc05vbmUoeSkgOiBpc05vbmUoeSkgPyBmYWxzZSA6IEUuZXF1YWxzKHgudmFsdWUsIHkudmFsdWUpKTsgfVxufSk7IH07XG4vKipcbiAqIFRoZSBgT3JkYCBpbnN0YW5jZSBhbGxvd3MgYE9wdGlvbmAgdmFsdWVzIHRvIGJlIGNvbXBhcmVkIHdpdGhcbiAqIGBjb21wYXJlYCwgd2hlbmV2ZXIgdGhlcmUgaXMgYW4gYE9yZGAgaW5zdGFuY2UgZm9yXG4gKiB0aGUgdHlwZSB0aGUgYE9wdGlvbmAgY29udGFpbnMuXG4gKlxuICogYE5vbmVgIGlzIGNvbnNpZGVyZWQgdG8gYmUgbGVzcyB0aGFuIGFueSBgU29tZWAgdmFsdWUuXG4gKlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBub25lLCBzb21lLCBnZXRPcmQgfSBmcm9tICdmcC10cy9PcHRpb24nXG4gKiBpbXBvcnQgKiBhcyBOIGZyb20gJ2ZwLXRzL251bWJlcidcbiAqXG4gKiBjb25zdCBPID0gZ2V0T3JkKE4uT3JkKVxuICogYXNzZXJ0LnN0cmljdEVxdWFsKE8uY29tcGFyZShub25lLCBub25lKSwgMClcbiAqIGFzc2VydC5zdHJpY3RFcXVhbChPLmNvbXBhcmUobm9uZSwgc29tZSgxKSksIC0xKVxuICogYXNzZXJ0LnN0cmljdEVxdWFsKE8uY29tcGFyZShzb21lKDEpLCBub25lKSwgMSlcbiAqIGFzc2VydC5zdHJpY3RFcXVhbChPLmNvbXBhcmUoc29tZSgxKSwgc29tZSgyKSksIC0xKVxuICogYXNzZXJ0LnN0cmljdEVxdWFsKE8uY29tcGFyZShzb21lKDEpLCBzb21lKDEpKSwgMClcbiAqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciBnZXRPcmQgPSBmdW5jdGlvbiAoTykgeyByZXR1cm4gKHtcbiAgICBlcXVhbHM6IGdldEVxKE8pLmVxdWFscyxcbiAgICBjb21wYXJlOiBmdW5jdGlvbiAoeCwgeSkgeyByZXR1cm4gKHggPT09IHkgPyAwIDogaXNTb21lKHgpID8gKGlzU29tZSh5KSA/IE8uY29tcGFyZSh4LnZhbHVlLCB5LnZhbHVlKSA6IDEpIDogLTEpOyB9XG59KTsgfTtcbi8qKlxuICogTW9ub2lkIHJldHVybmluZyB0aGUgbGVmdC1tb3N0IG5vbi1gTm9uZWAgdmFsdWUuIElmIGJvdGggb3BlcmFuZHMgYXJlIGBTb21lYHMgdGhlbiB0aGUgaW5uZXIgdmFsdWVzIGFyZVxuICogY29uY2F0ZW5hdGVkIHVzaW5nIHRoZSBwcm92aWRlZCBgU2VtaWdyb3VwYFxuICpcbiAqIHwgeCAgICAgICB8IHkgICAgICAgfCBjb25jYXQoeCwgeSkgICAgICAgfFxuICogfCAtLS0tLS0tIHwgLS0tLS0tLSB8IC0tLS0tLS0tLS0tLS0tLS0tLSB8XG4gKiB8IG5vbmUgICAgfCBub25lICAgIHwgbm9uZSAgICAgICAgICAgICAgIHxcbiAqIHwgc29tZShhKSB8IG5vbmUgICAgfCBzb21lKGEpICAgICAgICAgICAgfFxuICogfCBub25lICAgIHwgc29tZShiKSB8IHNvbWUoYikgICAgICAgICAgICB8XG4gKiB8IHNvbWUoYSkgfCBzb21lKGIpIHwgc29tZShjb25jYXQoYSwgYikpIHxcbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgZ2V0TW9ub2lkLCBzb21lLCBub25lIH0gZnJvbSAnZnAtdHMvT3B0aW9uJ1xuICogaW1wb3J0IHsgU2VtaWdyb3VwU3VtIH0gZnJvbSAnZnAtdHMvbnVtYmVyJ1xuICpcbiAqIGNvbnN0IE0gPSBnZXRNb25vaWQoU2VtaWdyb3VwU3VtKVxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChNLmNvbmNhdChub25lLCBub25lKSwgbm9uZSlcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoTS5jb25jYXQoc29tZSgxKSwgbm9uZSksIHNvbWUoMSkpXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKE0uY29uY2F0KG5vbmUsIHNvbWUoMSkpLCBzb21lKDEpKVxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChNLmNvbmNhdChzb21lKDEpLCBzb21lKDIpKSwgc29tZSgzKSlcbiAqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciBnZXRNb25vaWQgPSBmdW5jdGlvbiAoUykgeyByZXR1cm4gKHtcbiAgICBjb25jYXQ6IGZ1bmN0aW9uICh4LCB5KSB7IHJldHVybiAoaXNOb25lKHgpID8geSA6IGlzTm9uZSh5KSA/IHggOiBzb21lKFMuY29uY2F0KHgudmFsdWUsIHkudmFsdWUpKSk7IH0sXG4gICAgZW1wdHk6IG5vbmVcbn0pOyB9O1xuLyoqXG4gKiBAY2F0ZWdvcnkgbWFwcGluZ1xuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgbWFwID0gZnVuY3Rpb24gKGYpIHsgcmV0dXJuIGZ1bmN0aW9uIChmYSkge1xuICAgIHJldHVybiBpc05vbmUoZmEpID8gbm9uZSA6IHNvbWUoZihmYS52YWx1ZSkpO1xufTsgfTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuNy4wXG4gKi9cbmV4cG9ydCB2YXIgRnVuY3RvciA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICBtYXA6IF9tYXBcbn07XG4vKipcbiAqIE1hcHMgdGhlIGBTb21lYCB2YWx1ZSBvZiB0aGlzIGBPcHRpb25gIHRvIHRoZSBzcGVjaWZpZWQgY29uc3RhbnQgdmFsdWUuXG4gKlxuICogQGNhdGVnb3J5IG1hcHBpbmdcbiAqIEBzaW5jZSAyLjE2LjBcbiAqL1xuZXhwb3J0IHZhciBhcyA9IGR1YWwoMiwgYXNfKEZ1bmN0b3IpKTtcbi8qKlxuICogTWFwcyB0aGUgYFNvbWVgIHZhbHVlIG9mIHRoaXMgYE9wdGlvbmAgdG8gdGhlIHZvaWQgY29uc3RhbnQgdmFsdWUuXG4gKlxuICogQGNhdGVnb3J5IG1hcHBpbmdcbiAqIEBzaW5jZSAyLjE2LjBcbiAqL1xuZXhwb3J0IHZhciBhc1VuaXQgPSBhc1VuaXRfKEZ1bmN0b3IpO1xuLyoqXG4gKiBAY2F0ZWdvcnkgY29uc3RydWN0b3JzXG4gKiBAc2luY2UgMi43LjBcbiAqL1xuZXhwb3J0IHZhciBvZiA9IHNvbWU7XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjEwLjBcbiAqL1xuZXhwb3J0IHZhciBQb2ludGVkID0ge1xuICAgIFVSSTogVVJJLFxuICAgIG9mOiBvZlxufTtcbi8qKlxuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgYXAgPSBmdW5jdGlvbiAoZmEpIHsgcmV0dXJuIGZ1bmN0aW9uIChmYWIpIHtcbiAgICByZXR1cm4gaXNOb25lKGZhYikgPyBub25lIDogaXNOb25lKGZhKSA/IG5vbmUgOiBzb21lKGZhYi52YWx1ZShmYS52YWx1ZSkpO1xufTsgfTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuMTAuMFxuICovXG5leHBvcnQgdmFyIEFwcGx5ID0ge1xuICAgIFVSSTogVVJJLFxuICAgIG1hcDogX21hcCxcbiAgICBhcDogX2FwXG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi43LjBcbiAqL1xuZXhwb3J0IHZhciBBcHBsaWNhdGl2ZSA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICBtYXA6IF9tYXAsXG4gICAgYXA6IF9hcCxcbiAgICBvZjogb2Zcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBzZXF1ZW5jaW5nXG4gKiBAc2luY2UgMi4xNC4wXG4gKi9cbmV4cG9ydCB2YXIgZmxhdE1hcCA9IC8qI19fUFVSRV9fKi8gZHVhbCgyLCBmdW5jdGlvbiAobWEsIGYpIHsgcmV0dXJuIChpc05vbmUobWEpID8gbm9uZSA6IGYobWEudmFsdWUpKTsgfSk7XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjEwLjBcbiAqL1xuZXhwb3J0IHZhciBDaGFpbiA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICBtYXA6IF9tYXAsXG4gICAgYXA6IF9hcCxcbiAgICBjaGFpbjogZmxhdE1hcFxufTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuNy4wXG4gKi9cbmV4cG9ydCB2YXIgTW9uYWQgPSB7XG4gICAgVVJJOiBVUkksXG4gICAgbWFwOiBfbWFwLFxuICAgIGFwOiBfYXAsXG4gICAgb2Y6IG9mLFxuICAgIGNoYWluOiBmbGF0TWFwXG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgZm9sZGluZ1xuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgcmVkdWNlID0gZnVuY3Rpb24gKGIsIGYpIHsgcmV0dXJuIGZ1bmN0aW9uIChmYSkge1xuICAgIHJldHVybiBpc05vbmUoZmEpID8gYiA6IGYoYiwgZmEudmFsdWUpO1xufTsgfTtcbi8qKlxuICogQGNhdGVnb3J5IGZvbGRpbmdcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIGZvbGRNYXAgPSBmdW5jdGlvbiAoTSkgeyByZXR1cm4gZnVuY3Rpb24gKGYpIHsgcmV0dXJuIGZ1bmN0aW9uIChmYSkge1xuICAgIHJldHVybiBpc05vbmUoZmEpID8gTS5lbXB0eSA6IGYoZmEudmFsdWUpO1xufTsgfTsgfTtcbi8qKlxuICogQGNhdGVnb3J5IGZvbGRpbmdcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIHJlZHVjZVJpZ2h0ID0gZnVuY3Rpb24gKGIsIGYpIHsgcmV0dXJuIGZ1bmN0aW9uIChmYSkge1xuICAgIHJldHVybiBpc05vbmUoZmEpID8gYiA6IGYoZmEudmFsdWUsIGIpO1xufTsgfTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuNy4wXG4gKi9cbmV4cG9ydCB2YXIgRm9sZGFibGUgPSB7XG4gICAgVVJJOiBVUkksXG4gICAgcmVkdWNlOiBfcmVkdWNlLFxuICAgIGZvbGRNYXA6IF9mb2xkTWFwLFxuICAgIHJlZHVjZVJpZ2h0OiBfcmVkdWNlUmlnaHRcbn07XG4vKipcbiAqIFJldHVybnMgdGhlIHByb3ZpZGVkIGBPcHRpb25gIGB0aGF0YCBpZiBgc2VsZmAgaXMgYE5vbmVgLCBvdGhlcndpc2UgcmV0dXJucyBgc2VsZmAuXG4gKlxuICogQHBhcmFtIHNlbGYgLSBUaGUgZmlyc3QgYE9wdGlvbmAgdG8gYmUgY2hlY2tlZC5cbiAqIEBwYXJhbSB0aGF0IC0gVGhlIGBPcHRpb25gIHRvIHJldHVybiBpZiBgc2VsZmAgaXMgYE5vbmVgLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgKiBhcyBPIGZyb20gXCJmcC10cy9PcHRpb25cIlxuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoTy5vckVsc2UoTy5ub25lLCAoKSA9PiBPLm5vbmUpLCBPLm5vbmUpXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKE8ub3JFbHNlKE8uc29tZSgxKSwgKCkgPT4gTy5ub25lKSwgTy5zb21lKDEpKVxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChPLm9yRWxzZShPLm5vbmUsICgpID0+IE8uc29tZSgnYicpKSwgTy5zb21lKCdiJykpXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKE8ub3JFbHNlKE8uc29tZSgxKSwgKCkgPT4gTy5zb21lKCdiJykpLCBPLnNvbWUoMSkpXG4gKlxuICogQGNhdGVnb3J5IGVycm9yIGhhbmRsaW5nXG4gKiBAc2luY2UgMi4xNi4wXG4gKi9cbmV4cG9ydCB2YXIgb3JFbHNlID0gZHVhbCgyLCBmdW5jdGlvbiAoc2VsZiwgdGhhdCkgeyByZXR1cm4gKGlzTm9uZShzZWxmKSA/IHRoYXQoKSA6IHNlbGYpOyB9KTtcbi8qKlxuICogQWxpYXMgb2YgYG9yRWxzZWAuXG4gKlxuICogTGVzcyBzdHJpY3QgdmVyc2lvbiBvZiBbYGFsdGBdKCNhbHQpLlxuICpcbiAqIFRoZSBgV2Agc3VmZml4IChzaG9ydCBmb3IgKipXKippZGVuaW5nKSBtZWFucyB0aGF0IHRoZSByZXR1cm4gdHlwZXMgd2lsbCBiZSBtZXJnZWQuXG4gKlxuICogQGNhdGVnb3J5IGxlZ2FjeVxuICogQHNpbmNlIDIuOS4wXG4gKi9cbmV4cG9ydCB2YXIgYWx0VyA9IG9yRWxzZTtcbi8qKlxuICogQWxpYXMgb2YgYG9yRWxzZWAuXG4gKlxuICogQGNhdGVnb3J5IGxlZ2FjeVxuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgYWx0ID0gb3JFbHNlO1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi43LjBcbiAqL1xuZXhwb3J0IHZhciBBbHQgPSB7XG4gICAgVVJJOiBVUkksXG4gICAgbWFwOiBfbWFwLFxuICAgIGFsdDogX2FsdFxufTtcbi8qKlxuICogQHNpbmNlIDIuNy4wXG4gKi9cbmV4cG9ydCB2YXIgemVybyA9IGZ1bmN0aW9uICgpIHsgcmV0dXJuIG5vbmU7IH07XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjExLjBcbiAqL1xuZXhwb3J0IHZhciBaZXJvID0ge1xuICAgIFVSSTogVVJJLFxuICAgIHplcm86IHplcm9cbn07XG4vKipcbiAqIEBjYXRlZ29yeSBkbyBub3RhdGlvblxuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIGd1YXJkID0gLyojX19QVVJFX18qLyBndWFyZF8oWmVybywgUG9pbnRlZCk7XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjcuMFxuICovXG5leHBvcnQgdmFyIEFsdGVybmF0aXZlID0ge1xuICAgIFVSSTogVVJJLFxuICAgIG1hcDogX21hcCxcbiAgICBhcDogX2FwLFxuICAgIG9mOiBvZixcbiAgICBhbHQ6IF9hbHQsXG4gICAgemVybzogemVyb1xufTtcbi8qKlxuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgZXh0ZW5kID0gZnVuY3Rpb24gKGYpIHsgcmV0dXJuIGZ1bmN0aW9uICh3YSkge1xuICAgIHJldHVybiBpc05vbmUod2EpID8gbm9uZSA6IHNvbWUoZih3YSkpO1xufTsgfTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuNy4wXG4gKi9cbmV4cG9ydCB2YXIgRXh0ZW5kID0ge1xuICAgIFVSSTogVVJJLFxuICAgIG1hcDogX21hcCxcbiAgICBleHRlbmQ6IF9leHRlbmRcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBmaWx0ZXJpbmdcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIGNvbXBhY3QgPSAvKiNfX1BVUkVfXyovIGZsYXRNYXAoaWRlbnRpdHkpO1xudmFyIGRlZmF1bHRTZXBhcmF0ZWQgPSAvKiNfX1BVUkVfXyovIHNlcGFyYXRlZChub25lLCBub25lKTtcbi8qKlxuICogQGNhdGVnb3J5IGZpbHRlcmluZ1xuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgc2VwYXJhdGUgPSBmdW5jdGlvbiAobWEpIHtcbiAgICByZXR1cm4gaXNOb25lKG1hKSA/IGRlZmF1bHRTZXBhcmF0ZWQgOiBzZXBhcmF0ZWQoZ2V0TGVmdChtYS52YWx1ZSksIGdldFJpZ2h0KG1hLnZhbHVlKSk7XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi43LjBcbiAqL1xuZXhwb3J0IHZhciBDb21wYWN0YWJsZSA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICBjb21wYWN0OiBjb21wYWN0LFxuICAgIHNlcGFyYXRlOiBzZXBhcmF0ZVxufTtcbi8qKlxuICogQGNhdGVnb3J5IGZpbHRlcmluZ1xuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgZmlsdGVyID0gZnVuY3Rpb24gKHByZWRpY2F0ZSkge1xuICAgIHJldHVybiBmdW5jdGlvbiAoZmEpIHtcbiAgICAgICAgcmV0dXJuIGlzTm9uZShmYSkgPyBub25lIDogcHJlZGljYXRlKGZhLnZhbHVlKSA/IGZhIDogbm9uZTtcbiAgICB9O1xufTtcbi8qKlxuICogQGNhdGVnb3J5IGZpbHRlcmluZ1xuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgZmlsdGVyTWFwID0gZnVuY3Rpb24gKGYpIHsgcmV0dXJuIGZ1bmN0aW9uIChmYSkge1xuICAgIHJldHVybiBpc05vbmUoZmEpID8gbm9uZSA6IGYoZmEudmFsdWUpO1xufTsgfTtcbi8qKlxuICogQGNhdGVnb3J5IGZpbHRlcmluZ1xuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgcGFydGl0aW9uID0gZnVuY3Rpb24gKHByZWRpY2F0ZSkge1xuICAgIHJldHVybiBmdW5jdGlvbiAoZmEpIHtcbiAgICAgICAgcmV0dXJuIHNlcGFyYXRlZChfZmlsdGVyKGZhLCBub3QocHJlZGljYXRlKSksIF9maWx0ZXIoZmEsIHByZWRpY2F0ZSkpO1xuICAgIH07XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgZmlsdGVyaW5nXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciBwYXJ0aXRpb25NYXAgPSBmdW5jdGlvbiAoZikgeyByZXR1cm4gZmxvdyhtYXAoZiksIHNlcGFyYXRlKTsgfTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuNy4wXG4gKi9cbmV4cG9ydCB2YXIgRmlsdGVyYWJsZSA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICBtYXA6IF9tYXAsXG4gICAgY29tcGFjdDogY29tcGFjdCxcbiAgICBzZXBhcmF0ZTogc2VwYXJhdGUsXG4gICAgZmlsdGVyOiBfZmlsdGVyLFxuICAgIGZpbHRlck1hcDogX2ZpbHRlck1hcCxcbiAgICBwYXJ0aXRpb246IF9wYXJ0aXRpb24sXG4gICAgcGFydGl0aW9uTWFwOiBfcGFydGl0aW9uTWFwXG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgdHJhdmVyc2luZ1xuICogQHNpbmNlIDIuNi4zXG4gKi9cbmV4cG9ydCB2YXIgdHJhdmVyc2UgPSBmdW5jdGlvbiAoRikge1xuICAgIHJldHVybiBmdW5jdGlvbiAoZikge1xuICAgICAgICByZXR1cm4gZnVuY3Rpb24gKHRhKSB7XG4gICAgICAgICAgICByZXR1cm4gaXNOb25lKHRhKSA/IEYub2Yobm9uZSkgOiBGLm1hcChmKHRhLnZhbHVlKSwgc29tZSk7XG4gICAgICAgIH07XG4gICAgfTtcbn07XG4vKipcbiAqIEBjYXRlZ29yeSB0cmF2ZXJzaW5nXG4gKiBAc2luY2UgMi42LjNcbiAqL1xuZXhwb3J0IHZhciBzZXF1ZW5jZSA9IGZ1bmN0aW9uIChGKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uICh0YSkge1xuICAgICAgICByZXR1cm4gaXNOb25lKHRhKSA/IEYub2Yobm9uZSkgOiBGLm1hcCh0YS52YWx1ZSwgc29tZSk7XG4gICAgfTtcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjcuMFxuICovXG5leHBvcnQgdmFyIFRyYXZlcnNhYmxlID0ge1xuICAgIFVSSTogVVJJLFxuICAgIG1hcDogX21hcCxcbiAgICByZWR1Y2U6IF9yZWR1Y2UsXG4gICAgZm9sZE1hcDogX2ZvbGRNYXAsXG4gICAgcmVkdWNlUmlnaHQ6IF9yZWR1Y2VSaWdodCxcbiAgICB0cmF2ZXJzZTogX3RyYXZlcnNlLFxuICAgIHNlcXVlbmNlOiBzZXF1ZW5jZVxufTtcbnZhciBfd2l0aGVyID0gLyojX19QVVJFX18qLyB3aXRoZXJEZWZhdWx0KFRyYXZlcnNhYmxlLCBDb21wYWN0YWJsZSk7XG52YXIgX3dpbHQgPSAvKiNfX1BVUkVfXyovIHdpbHREZWZhdWx0KFRyYXZlcnNhYmxlLCBDb21wYWN0YWJsZSk7XG4vKipcbiAqIEBjYXRlZ29yeSBmaWx0ZXJpbmdcbiAqIEBzaW5jZSAyLjYuNVxuICovXG5leHBvcnQgdmFyIHdpdGhlciA9IGZ1bmN0aW9uIChGKSB7XG4gICAgdmFyIF93aXRoZXJGID0gX3dpdGhlcihGKTtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGYpIHsgcmV0dXJuIGZ1bmN0aW9uIChmYSkgeyByZXR1cm4gX3dpdGhlckYoZmEsIGYpOyB9OyB9O1xufTtcbi8qKlxuICogQGNhdGVnb3J5IGZpbHRlcmluZ1xuICogQHNpbmNlIDIuNi41XG4gKi9cbmV4cG9ydCB2YXIgd2lsdCA9IGZ1bmN0aW9uIChGKSB7XG4gICAgdmFyIF93aWx0RiA9IF93aWx0KEYpO1xuICAgIHJldHVybiBmdW5jdGlvbiAoZikgeyByZXR1cm4gZnVuY3Rpb24gKGZhKSB7IHJldHVybiBfd2lsdEYoZmEsIGYpOyB9OyB9O1xufTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuNy4wXG4gKi9cbmV4cG9ydCB2YXIgV2l0aGVyYWJsZSA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICBtYXA6IF9tYXAsXG4gICAgcmVkdWNlOiBfcmVkdWNlLFxuICAgIGZvbGRNYXA6IF9mb2xkTWFwLFxuICAgIHJlZHVjZVJpZ2h0OiBfcmVkdWNlUmlnaHQsXG4gICAgdHJhdmVyc2U6IF90cmF2ZXJzZSxcbiAgICBzZXF1ZW5jZTogc2VxdWVuY2UsXG4gICAgY29tcGFjdDogY29tcGFjdCxcbiAgICBzZXBhcmF0ZTogc2VwYXJhdGUsXG4gICAgZmlsdGVyOiBfZmlsdGVyLFxuICAgIGZpbHRlck1hcDogX2ZpbHRlck1hcCxcbiAgICBwYXJ0aXRpb246IF9wYXJ0aXRpb24sXG4gICAgcGFydGl0aW9uTWFwOiBfcGFydGl0aW9uTWFwLFxuICAgIHdpdGhlcjogX3dpdGhlcixcbiAgICB3aWx0OiBfd2lsdFxufTtcbi8qKlxuICogQHNpbmNlIDIuNy4wXG4gKi9cbmV4cG9ydCB2YXIgdGhyb3dFcnJvciA9IGZ1bmN0aW9uICgpIHsgcmV0dXJuIG5vbmU7IH07XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjcuMFxuICovXG5leHBvcnQgdmFyIE1vbmFkVGhyb3cgPSB7XG4gICAgVVJJOiBVUkksXG4gICAgbWFwOiBfbWFwLFxuICAgIGFwOiBfYXAsXG4gICAgb2Y6IG9mLFxuICAgIGNoYWluOiBmbGF0TWFwLFxuICAgIHRocm93RXJyb3I6IHRocm93RXJyb3Jcbn07XG4vKipcbiAqIFRyYW5zZm9ybXMgYW4gYEVpdGhlcmAgdG8gYW4gYE9wdGlvbmAgZGlzY2FyZGluZyB0aGUgZXJyb3IuXG4gKlxuICogQWxpYXMgb2YgW2dldFJpZ2h0XSgjZ2V0cmlnaHQpXG4gKlxuICogQGNhdGVnb3J5IGNvbnZlcnNpb25zXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciBmcm9tRWl0aGVyID0gZ2V0UmlnaHQ7XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjExLjBcbiAqL1xuZXhwb3J0IHZhciBGcm9tRWl0aGVyID0ge1xuICAgIFVSSTogVVJJLFxuICAgIGZyb21FaXRoZXI6IGZyb21FaXRoZXJcbn07XG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vLyByZWZpbmVtZW50c1xuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLyoqXG4gKiBSZXR1cm5zIGB0cnVlYCBpZiB0aGUgb3B0aW9uIGlzIGFuIGluc3RhbmNlIG9mIGBTb21lYCwgYGZhbHNlYCBvdGhlcndpc2UuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IHNvbWUsIG5vbmUsIGlzU29tZSB9IGZyb20gJ2ZwLXRzL09wdGlvbidcbiAqXG4gKiBhc3NlcnQuc3RyaWN0RXF1YWwoaXNTb21lKHNvbWUoMSkpLCB0cnVlKVxuICogYXNzZXJ0LnN0cmljdEVxdWFsKGlzU29tZShub25lKSwgZmFsc2UpXG4gKlxuICogQGNhdGVnb3J5IHJlZmluZW1lbnRzXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciBpc1NvbWUgPSBfLmlzU29tZTtcbi8qKlxuICogUmV0dXJucyBgdHJ1ZWAgaWYgdGhlIG9wdGlvbiBpcyBgTm9uZWAsIGBmYWxzZWAgb3RoZXJ3aXNlLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBzb21lLCBub25lLCBpc05vbmUgfSBmcm9tICdmcC10cy9PcHRpb24nXG4gKlxuICogYXNzZXJ0LnN0cmljdEVxdWFsKGlzTm9uZShzb21lKDEpKSwgZmFsc2UpXG4gKiBhc3NlcnQuc3RyaWN0RXF1YWwoaXNOb25lKG5vbmUpLCB0cnVlKVxuICpcbiAqIEBjYXRlZ29yeSByZWZpbmVtZW50c1xuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgaXNOb25lID0gZnVuY3Rpb24gKGZhKSB7IHJldHVybiBmYS5fdGFnID09PSAnTm9uZSc7IH07XG4vKipcbiAqIExlc3Mgc3RyaWN0IHZlcnNpb24gb2YgW2BtYXRjaGBdKCNtYXRjaCkuXG4gKlxuICogVGhlIGBXYCBzdWZmaXggKHNob3J0IGZvciAqKlcqKmlkZW5pbmcpIG1lYW5zIHRoYXQgdGhlIGhhbmRsZXIgcmV0dXJuIHR5cGVzIHdpbGwgYmUgbWVyZ2VkLlxuICpcbiAqIEBjYXRlZ29yeSBwYXR0ZXJuIG1hdGNoaW5nXG4gKiBAc2luY2UgMi4xMC4wXG4gKi9cbmV4cG9ydCB2YXIgbWF0Y2hXID0gZnVuY3Rpb24gKG9uTm9uZSwgb25Tb21lKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChtYSkge1xuICAgICAgICByZXR1cm4gaXNOb25lKG1hKSA/IG9uTm9uZSgpIDogb25Tb21lKG1hLnZhbHVlKTtcbiAgICB9O1xufTtcbi8qKlxuICogQWxpYXMgb2YgW2BtYXRjaFdgXSgjbWF0Y2h3KS5cbiAqXG4gKiBAY2F0ZWdvcnkgcGF0dGVybiBtYXRjaGluZ1xuICogQHNpbmNlIDIuMTAuMFxuICovXG5leHBvcnQgdmFyIGZvbGRXID0gbWF0Y2hXO1xuLyoqXG4gKiBUYWtlcyBhIChsYXp5KSBkZWZhdWx0IHZhbHVlLCBhIGZ1bmN0aW9uLCBhbmQgYW4gYE9wdGlvbmAgdmFsdWUsIGlmIHRoZSBgT3B0aW9uYCB2YWx1ZSBpcyBgTm9uZWAgdGhlIGRlZmF1bHQgdmFsdWUgaXNcbiAqIHJldHVybmVkLCBvdGhlcndpc2UgdGhlIGZ1bmN0aW9uIGlzIGFwcGxpZWQgdG8gdGhlIHZhbHVlIGluc2lkZSB0aGUgYFNvbWVgIGFuZCB0aGUgcmVzdWx0IGlzIHJldHVybmVkLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBzb21lLCBub25lLCBtYXRjaCB9IGZyb20gJ2ZwLXRzL09wdGlvbidcbiAqIGltcG9ydCB7IHBpcGUgfSBmcm9tICdmcC10cy9mdW5jdGlvbidcbiAqXG4gKiBhc3NlcnQuc3RyaWN0RXF1YWwoXG4gKiAgIHBpcGUoXG4gKiAgICAgc29tZSgxKSxcbiAqICAgICBtYXRjaCgoKSA9PiAnYSBub25lJywgYSA9PiBgYSBzb21lIGNvbnRhaW5pbmcgJHthfWApXG4gKiAgICksXG4gKiAgICdhIHNvbWUgY29udGFpbmluZyAxJ1xuICogKVxuICpcbiAqIGFzc2VydC5zdHJpY3RFcXVhbChcbiAqICAgcGlwZShcbiAqICAgICBub25lLFxuICogICAgIG1hdGNoKCgpID0+ICdhIG5vbmUnLCBhID0+IGBhIHNvbWUgY29udGFpbmluZyAke2F9YClcbiAqICAgKSxcbiAqICAgJ2Egbm9uZSdcbiAqIClcbiAqXG4gKiBAY2F0ZWdvcnkgcGF0dGVybiBtYXRjaGluZ1xuICogQHNpbmNlIDIuMTAuMFxuICovXG5leHBvcnQgdmFyIG1hdGNoID0gbWF0Y2hXO1xuLyoqXG4gKiBBbGlhcyBvZiBbYG1hdGNoYF0oI21hdGNoKS5cbiAqXG4gKiBAY2F0ZWdvcnkgcGF0dGVybiBtYXRjaGluZ1xuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgZm9sZCA9IG1hdGNoO1xuLyoqXG4gKiBMZXNzIHN0cmljdCB2ZXJzaW9uIG9mIFtgZ2V0T3JFbHNlYF0oI2dldG9yZWxzZSkuXG4gKlxuICogVGhlIGBXYCBzdWZmaXggKHNob3J0IGZvciAqKlcqKmlkZW5pbmcpIG1lYW5zIHRoYXQgdGhlIGhhbmRsZXIgcmV0dXJuIHR5cGUgd2lsbCBiZSBtZXJnZWQuXG4gKlxuICogQGNhdGVnb3J5IGVycm9yIGhhbmRsaW5nXG4gKiBAc2luY2UgMi42LjBcbiAqL1xuZXhwb3J0IHZhciBnZXRPckVsc2VXID0gZnVuY3Rpb24gKG9uTm9uZSkge1xuICAgIHJldHVybiBmdW5jdGlvbiAobWEpIHtcbiAgICAgICAgcmV0dXJuIGlzTm9uZShtYSkgPyBvbk5vbmUoKSA6IG1hLnZhbHVlO1xuICAgIH07XG59O1xuLyoqXG4gKiBFeHRyYWN0cyB0aGUgdmFsdWUgb3V0IG9mIHRoZSBzdHJ1Y3R1cmUsIGlmIGl0IGV4aXN0cy4gT3RoZXJ3aXNlIHJldHVybnMgdGhlIGdpdmVuIGRlZmF1bHQgdmFsdWVcbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgc29tZSwgbm9uZSwgZ2V0T3JFbHNlIH0gZnJvbSAnZnAtdHMvT3B0aW9uJ1xuICogaW1wb3J0IHsgcGlwZSB9IGZyb20gJ2ZwLXRzL2Z1bmN0aW9uJ1xuICpcbiAqIGFzc2VydC5zdHJpY3RFcXVhbChcbiAqICAgcGlwZShcbiAqICAgICBzb21lKDEpLFxuICogICAgIGdldE9yRWxzZSgoKSA9PiAwKVxuICogICApLFxuICogICAxXG4gKiApXG4gKiBhc3NlcnQuc3RyaWN0RXF1YWwoXG4gKiAgIHBpcGUoXG4gKiAgICAgbm9uZSxcbiAqICAgICBnZXRPckVsc2UoKCkgPT4gMClcbiAqICAgKSxcbiAqICAgMFxuICogKVxuICpcbiAqIEBjYXRlZ29yeSBlcnJvciBoYW5kbGluZ1xuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgZ2V0T3JFbHNlID0gZ2V0T3JFbHNlVztcbi8qKlxuICogQGNhdGVnb3J5IG1hcHBpbmdcbiAqIEBzaW5jZSAyLjEwLjBcbiAqL1xuZXhwb3J0IHZhciBmbGFwID0gLyojX19QVVJFX18qLyBmbGFwXyhGdW5jdG9yKTtcbi8qKlxuICogQ29tYmluZSB0d28gZWZmZWN0ZnVsIGFjdGlvbnMsIGtlZXBpbmcgb25seSB0aGUgcmVzdWx0IG9mIHRoZSBmaXJzdC5cbiAqXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciBhcEZpcnN0ID0gLyojX19QVVJFX18qLyBhcEZpcnN0XyhBcHBseSk7XG4vKipcbiAqIENvbWJpbmUgdHdvIGVmZmVjdGZ1bCBhY3Rpb25zLCBrZWVwaW5nIG9ubHkgdGhlIHJlc3VsdCBvZiB0aGUgc2Vjb25kLlxuICpcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIGFwU2Vjb25kID0gLyojX19QVVJFX18qLyBhcFNlY29uZF8oQXBwbHkpO1xuLyoqXG4gKiBAY2F0ZWdvcnkgc2VxdWVuY2luZ1xuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgZmxhdHRlbiA9IGNvbXBhY3Q7XG4vKipcbiAqIENvbXBvc2VzIGNvbXB1dGF0aW9ucyBpbiBzZXF1ZW5jZSwgdXNpbmcgdGhlIHJldHVybiB2YWx1ZSBvZiBvbmUgY29tcHV0YXRpb24gdG8gZGV0ZXJtaW5lIHRoZSBuZXh0IGNvbXB1dGF0aW9uIGFuZFxuICoga2VlcGluZyBvbmx5IHRoZSByZXN1bHQgb2YgdGhlIGZpcnN0LlxuICpcbiAqIEBjYXRlZ29yeSBjb21iaW5hdG9yc1xuICogQHNpbmNlIDIuMTUuMFxuICovXG5leHBvcnQgdmFyIHRhcCA9IC8qI19fUFVSRV9fKi8gZHVhbCgyLCBjaGFpbmFibGUudGFwKENoYWluKSk7XG4vKipcbiAqIENvbXBvc2VzIGNvbXB1dGF0aW9ucyBpbiBzZXF1ZW5jZSwgdXNpbmcgdGhlIHJldHVybiB2YWx1ZSBvZiBvbmUgY29tcHV0YXRpb24gdG8gZGV0ZXJtaW5lIHRoZSBuZXh0IGNvbXB1dGF0aW9uIGFuZFxuICoga2VlcGluZyBvbmx5IHRoZSByZXN1bHQgb2YgdGhlIGZpcnN0LlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBwaXBlIH0gZnJvbSAnZnAtdHMvZnVuY3Rpb24nXG4gKiBpbXBvcnQgKiBhcyBPIGZyb20gJ2ZwLXRzL09wdGlvbidcbiAqIGltcG9ydCAqIGFzIEUgZnJvbSAnZnAtdHMvRWl0aGVyJ1xuICpcbiAqIGNvbnN0IGNvbXB1dGUgPSAodmFsdWU6IG51bWJlcikgPT4gcGlwZShcbiAqICAgTy5vZih2YWx1ZSksXG4gKiAgIE8udGFwRWl0aGVyKCh2YWx1ZSkgPT4gdmFsdWUgPiAwID8gRS5yaWdodCgnb2snKSA6IEUubGVmdCgnZXJyb3InKSksXG4gKiApXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChjb21wdXRlKDEpLCBPLm9mKDEpKVxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChjb21wdXRlKC00MiksIE8ubm9uZSlcbiAqXG4gKiBAY2F0ZWdvcnkgY29tYmluYXRvcnNcbiAqIEBzaW5jZSAyLjE2LjBcbiAqL1xuZXhwb3J0IHZhciB0YXBFaXRoZXIgPSAvKiNfX1BVUkVfXyovIGR1YWwoMiwgdGFwRWl0aGVyXyhGcm9tRWl0aGVyLCBDaGFpbikpO1xuLyoqXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciBkdXBsaWNhdGUgPSAvKiNfX1BVUkVfXyovIGV4dGVuZChpZGVudGl0eSk7XG4vKipcbiAqIEBjYXRlZ29yeSBsaWZ0aW5nXG4gKiBAc2luY2UgMi4xMS4wXG4gKi9cbmV4cG9ydCB2YXIgZnJvbUVpdGhlcksgPSAvKiNfX1BVUkVfXyovIGZyb21FaXRoZXJLXyhGcm9tRWl0aGVyKTtcbi8qKlxuICogQGNhdGVnb3J5IHNlcXVlbmNpbmdcbiAqIEBzaW5jZSAyLjExLjBcbiAqL1xuZXhwb3J0IHZhciBjaGFpbkVpdGhlcksgPSBcbi8qI19fUFVSRV9fKi8gY2hhaW5FaXRoZXJLXyhGcm9tRWl0aGVyLCBDaGFpbik7XG4vKipcbiAqIEFsaWFzIG9mIGB0YXBFaXRoZXJgLlxuICpcbiAqIEBjYXRlZ29yeSBsZWdhY3lcbiAqIEBzaW5jZSAyLjEyLjBcbiAqL1xuZXhwb3J0IHZhciBjaGFpbkZpcnN0RWl0aGVySyA9IHRhcEVpdGhlcjtcbi8qKlxuICogQ29uc3RydWN0cyBhIG5ldyBgT3B0aW9uYCBmcm9tIGEgbnVsbGFibGUgdHlwZS4gSWYgdGhlIHZhbHVlIGlzIGBudWxsYCBvciBgdW5kZWZpbmVkYCwgcmV0dXJucyBgTm9uZWAsIG90aGVyd2lzZVxuICogcmV0dXJucyB0aGUgdmFsdWUgd3JhcHBlZCBpbiBhIGBTb21lYC5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgbm9uZSwgc29tZSwgZnJvbU51bGxhYmxlIH0gZnJvbSAnZnAtdHMvT3B0aW9uJ1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoZnJvbU51bGxhYmxlKHVuZGVmaW5lZCksIG5vbmUpXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKGZyb21OdWxsYWJsZShudWxsKSwgbm9uZSlcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoZnJvbU51bGxhYmxlKDEpLCBzb21lKDEpKVxuICpcbiAqIEBjYXRlZ29yeSBjb252ZXJzaW9uc1xuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgZnJvbU51bGxhYmxlID0gZnVuY3Rpb24gKGEpIHsgcmV0dXJuIChhID09IG51bGwgPyBub25lIDogc29tZShhKSk7IH07XG4vKipcbiAqIFRyYW5zZm9ybXMgYW4gZXhjZXB0aW9uIGludG8gYW4gYE9wdGlvbmAuIElmIGBmYCB0aHJvd3MsIHJldHVybnMgYE5vbmVgLCBvdGhlcndpc2UgcmV0dXJucyB0aGUgb3V0cHV0IHdyYXBwZWQgaW4gYVxuICogYFNvbWVgLlxuICpcbiAqIFNlZSBhbHNvIFtgdHJ5Q2F0Y2hLYF0oI3RyeWNhdGNoaykuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IG5vbmUsIHNvbWUsIHRyeUNhdGNoIH0gZnJvbSAnZnAtdHMvT3B0aW9uJ1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoXG4gKiAgIHRyeUNhdGNoKCgpID0+IHtcbiAqICAgICB0aHJvdyBuZXcgRXJyb3IoKVxuICogICB9KSxcbiAqICAgbm9uZVxuICogKVxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbCh0cnlDYXRjaCgoKSA9PiAxKSwgc29tZSgxKSlcbiAqXG4gKiBAY2F0ZWdvcnkgaW50ZXJvcFxuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgdHJ5Q2F0Y2ggPSBmdW5jdGlvbiAoZikge1xuICAgIHRyeSB7XG4gICAgICAgIHJldHVybiBzb21lKGYoKSk7XG4gICAgfVxuICAgIGNhdGNoIChlKSB7XG4gICAgICAgIHJldHVybiBub25lO1xuICAgIH1cbn07XG4vKipcbiAqIENvbnZlcnRzIGEgZnVuY3Rpb24gdGhhdCBtYXkgdGhyb3cgdG8gb25lIHJldHVybmluZyBhIGBPcHRpb25gLlxuICpcbiAqIEBjYXRlZ29yeSBpbnRlcm9wXG4gKiBAc2luY2UgMi4xMC4wXG4gKi9cbmV4cG9ydCB2YXIgdHJ5Q2F0Y2hLID0gZnVuY3Rpb24gKGYpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgYSA9IFtdO1xuICAgICAgICBmb3IgKHZhciBfaSA9IDA7IF9pIDwgYXJndW1lbnRzLmxlbmd0aDsgX2krKykge1xuICAgICAgICAgICAgYVtfaV0gPSBhcmd1bWVudHNbX2ldO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0cnlDYXRjaChmdW5jdGlvbiAoKSB7IHJldHVybiBmLmFwcGx5KHZvaWQgMCwgYSk7IH0pO1xuICAgIH07XG59O1xuLyoqXG4gKiBSZXR1cm5zIGEgKnNtYXJ0IGNvbnN0cnVjdG9yKiBmcm9tIGEgZnVuY3Rpb24gdGhhdCByZXR1cm5zIGEgbnVsbGFibGUgdmFsdWUuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IGZyb21OdWxsYWJsZUssIG5vbmUsIHNvbWUgfSBmcm9tICdmcC10cy9PcHRpb24nXG4gKlxuICogY29uc3QgZiA9IChzOiBzdHJpbmcpOiBudW1iZXIgfCB1bmRlZmluZWQgPT4ge1xuICogICBjb25zdCBuID0gcGFyc2VGbG9hdChzKVxuICogICByZXR1cm4gaXNOYU4obikgPyB1bmRlZmluZWQgOiBuXG4gKiB9XG4gKlxuICogY29uc3QgZyA9IGZyb21OdWxsYWJsZUsoZilcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKGcoJzEnKSwgc29tZSgxKSlcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoZygnYScpLCBub25lKVxuICpcbiAqIEBjYXRlZ29yeSBsaWZ0aW5nXG4gKiBAc2luY2UgMi45LjBcbiAqL1xuZXhwb3J0IHZhciBmcm9tTnVsbGFibGVLID0gZnVuY3Rpb24gKGYpIHsgcmV0dXJuIGZsb3coZiwgZnJvbU51bGxhYmxlKTsgfTtcbi8qKlxuICogVGhpcyBpcyBgY2hhaW5gICsgYGZyb21OdWxsYWJsZWAsIHVzZWZ1bCB3aGVuIHdvcmtpbmcgd2l0aCBvcHRpb25hbCB2YWx1ZXMuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IHNvbWUsIG5vbmUsIGZyb21OdWxsYWJsZSwgY2hhaW5OdWxsYWJsZUsgfSBmcm9tICdmcC10cy9PcHRpb24nXG4gKiBpbXBvcnQgeyBwaXBlIH0gZnJvbSAnZnAtdHMvZnVuY3Rpb24nXG4gKlxuICogaW50ZXJmYWNlIEVtcGxveWVlIHtcbiAqICAgcmVhZG9ubHkgY29tcGFueT86IHtcbiAqICAgICByZWFkb25seSBhZGRyZXNzPzoge1xuICogICAgICAgcmVhZG9ubHkgc3RyZWV0Pzoge1xuICogICAgICAgICByZWFkb25seSBuYW1lPzogc3RyaW5nXG4gKiAgICAgICB9XG4gKiAgICAgfVxuICogICB9XG4gKiB9XG4gKlxuICogY29uc3QgZW1wbG95ZWUxOiBFbXBsb3llZSA9IHsgY29tcGFueTogeyBhZGRyZXNzOiB7IHN0cmVldDogeyBuYW1lOiAnaGlnaCBzdHJlZXQnIH0gfSB9IH1cbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKFxuICogICBwaXBlKFxuICogICAgIGZyb21OdWxsYWJsZShlbXBsb3llZTEuY29tcGFueSksXG4gKiAgICAgY2hhaW5OdWxsYWJsZUsoY29tcGFueSA9PiBjb21wYW55LmFkZHJlc3MpLFxuICogICAgIGNoYWluTnVsbGFibGVLKGFkZHJlc3MgPT4gYWRkcmVzcy5zdHJlZXQpLFxuICogICAgIGNoYWluTnVsbGFibGVLKHN0cmVldCA9PiBzdHJlZXQubmFtZSlcbiAqICAgKSxcbiAqICAgc29tZSgnaGlnaCBzdHJlZXQnKVxuICogKVxuICpcbiAqIGNvbnN0IGVtcGxveWVlMjogRW1wbG95ZWUgPSB7IGNvbXBhbnk6IHsgYWRkcmVzczogeyBzdHJlZXQ6IHt9IH0gfSB9XG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChcbiAqICAgcGlwZShcbiAqICAgICBmcm9tTnVsbGFibGUoZW1wbG95ZWUyLmNvbXBhbnkpLFxuICogICAgIGNoYWluTnVsbGFibGVLKGNvbXBhbnkgPT4gY29tcGFueS5hZGRyZXNzKSxcbiAqICAgICBjaGFpbk51bGxhYmxlSyhhZGRyZXNzID0+IGFkZHJlc3Muc3RyZWV0KSxcbiAqICAgICBjaGFpbk51bGxhYmxlSyhzdHJlZXQgPT4gc3RyZWV0Lm5hbWUpXG4gKiAgICksXG4gKiAgIG5vbmVcbiAqIClcbiAqXG4gKiBAY2F0ZWdvcnkgc2VxdWVuY2luZ1xuICogQHNpbmNlIDIuOS4wXG4gKi9cbmV4cG9ydCB2YXIgY2hhaW5OdWxsYWJsZUsgPSBmdW5jdGlvbiAoZikge1xuICAgIHJldHVybiBmdW5jdGlvbiAobWEpIHtcbiAgICAgICAgcmV0dXJuIGlzTm9uZShtYSkgPyBub25lIDogZnJvbU51bGxhYmxlKGYobWEudmFsdWUpKTtcbiAgICB9O1xufTtcbi8qKlxuICogRXh0cmFjdHMgdGhlIHZhbHVlIG91dCBvZiB0aGUgc3RydWN0dXJlLCBpZiBpdCBleGlzdHMuIE90aGVyd2lzZSByZXR1cm5zIGBudWxsYC5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgc29tZSwgbm9uZSwgdG9OdWxsYWJsZSB9IGZyb20gJ2ZwLXRzL09wdGlvbidcbiAqIGltcG9ydCB7IHBpcGUgfSBmcm9tICdmcC10cy9mdW5jdGlvbidcbiAqXG4gKiBhc3NlcnQuc3RyaWN0RXF1YWwoXG4gKiAgIHBpcGUoXG4gKiAgICAgc29tZSgxKSxcbiAqICAgICB0b051bGxhYmxlXG4gKiAgICksXG4gKiAgIDFcbiAqIClcbiAqIGFzc2VydC5zdHJpY3RFcXVhbChcbiAqICAgcGlwZShcbiAqICAgICBub25lLFxuICogICAgIHRvTnVsbGFibGVcbiAqICAgKSxcbiAqICAgbnVsbFxuICogKVxuICpcbiAqIEBjYXRlZ29yeSBjb252ZXJzaW9uc1xuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgdG9OdWxsYWJsZSA9IC8qI19fUFVSRV9fKi8gbWF0Y2goY29uc3ROdWxsLCBpZGVudGl0eSk7XG4vKipcbiAqIEV4dHJhY3RzIHRoZSB2YWx1ZSBvdXQgb2YgdGhlIHN0cnVjdHVyZSwgaWYgaXQgZXhpc3RzLiBPdGhlcndpc2UgcmV0dXJucyBgdW5kZWZpbmVkYC5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgc29tZSwgbm9uZSwgdG9VbmRlZmluZWQgfSBmcm9tICdmcC10cy9PcHRpb24nXG4gKiBpbXBvcnQgeyBwaXBlIH0gZnJvbSAnZnAtdHMvZnVuY3Rpb24nXG4gKlxuICogYXNzZXJ0LnN0cmljdEVxdWFsKFxuICogICBwaXBlKFxuICogICAgIHNvbWUoMSksXG4gKiAgICAgdG9VbmRlZmluZWRcbiAqICAgKSxcbiAqICAgMVxuICogKVxuICogYXNzZXJ0LnN0cmljdEVxdWFsKFxuICogICBwaXBlKFxuICogICAgIG5vbmUsXG4gKiAgICAgdG9VbmRlZmluZWRcbiAqICAgKSxcbiAqICAgdW5kZWZpbmVkXG4gKiApXG4gKlxuICogQGNhdGVnb3J5IGNvbnZlcnNpb25zXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciB0b1VuZGVmaW5lZCA9IC8qI19fUFVSRV9fKi8gbWF0Y2goY29uc3RVbmRlZmluZWQsIGlkZW50aXR5KTtcbmV4cG9ydCBmdW5jdGlvbiBlbGVtKEUpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGEsIG1hKSB7XG4gICAgICAgIGlmIChtYSA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICB2YXIgZWxlbUVfMSA9IGVsZW0oRSk7XG4gICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24gKG1hKSB7IHJldHVybiBlbGVtRV8xKGEsIG1hKTsgfTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gaXNOb25lKG1hKSA/IGZhbHNlIDogRS5lcXVhbHMoYSwgbWEudmFsdWUpO1xuICAgIH07XG59XG4vKipcbiAqIFJldHVybnMgYHRydWVgIGlmIHRoZSBwcmVkaWNhdGUgaXMgc2F0aXNmaWVkIGJ5IHRoZSB3cmFwcGVkIHZhbHVlXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IHNvbWUsIG5vbmUsIGV4aXN0cyB9IGZyb20gJ2ZwLXRzL09wdGlvbidcbiAqIGltcG9ydCB7IHBpcGUgfSBmcm9tICdmcC10cy9mdW5jdGlvbidcbiAqXG4gKiBhc3NlcnQuc3RyaWN0RXF1YWwoXG4gKiAgIHBpcGUoXG4gKiAgICAgc29tZSgxKSxcbiAqICAgICBleGlzdHMobiA9PiBuID4gMClcbiAqICAgKSxcbiAqICAgdHJ1ZVxuICogKVxuICogYXNzZXJ0LnN0cmljdEVxdWFsKFxuICogICBwaXBlKFxuICogICAgIHNvbWUoMSksXG4gKiAgICAgZXhpc3RzKG4gPT4gbiA+IDEpXG4gKiAgICksXG4gKiAgIGZhbHNlXG4gKiApXG4gKiBhc3NlcnQuc3RyaWN0RXF1YWwoXG4gKiAgIHBpcGUoXG4gKiAgICAgbm9uZSxcbiAqICAgICBleGlzdHMobiA9PiBuID4gMClcbiAqICAgKSxcbiAqICAgZmFsc2VcbiAqIClcbiAqXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciBleGlzdHMgPSBmdW5jdGlvbiAocHJlZGljYXRlKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChtYSkge1xuICAgICAgICByZXR1cm4gaXNOb25lKG1hKSA/IGZhbHNlIDogcHJlZGljYXRlKG1hLnZhbHVlKTtcbiAgICB9O1xufTtcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8vIGRvIG5vdGF0aW9uXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vKipcbiAqIEBjYXRlZ29yeSBkbyBub3RhdGlvblxuICogQHNpbmNlIDIuOS4wXG4gKi9cbmV4cG9ydCB2YXIgRG8gPSAvKiNfX1BVUkVfXyovIG9mKF8uZW1wdHlSZWNvcmQpO1xuLyoqXG4gKiBAY2F0ZWdvcnkgZG8gbm90YXRpb25cbiAqIEBzaW5jZSAyLjguMFxuICovXG5leHBvcnQgdmFyIGJpbmRUbyA9IC8qI19fUFVSRV9fKi8gYmluZFRvXyhGdW5jdG9yKTtcbnZhciBsZXRfID0gLyojX19QVVJFX18qLyBsZXRfXyhGdW5jdG9yKTtcbmV4cG9ydCB7IFxuLyoqXG4gKiBAY2F0ZWdvcnkgZG8gbm90YXRpb25cbiAqIEBzaW5jZSAyLjEzLjBcbiAqL1xubGV0XyBhcyBsZXQgfTtcbi8qKlxuICogQGNhdGVnb3J5IGRvIG5vdGF0aW9uXG4gKiBAc2luY2UgMi44LjBcbiAqL1xuZXhwb3J0IHZhciBiaW5kID0gLyojX19QVVJFX18qLyBjaGFpbmFibGUuYmluZChDaGFpbik7XG4vKipcbiAqIEBjYXRlZ29yeSBkbyBub3RhdGlvblxuICogQHNpbmNlIDIuOC4wXG4gKi9cbmV4cG9ydCB2YXIgYXBTID0gLyojX19QVVJFX18qLyBhcFNfKEFwcGx5KTtcbi8qKlxuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIEFwVCA9IC8qI19fUFVSRV9fKi8gb2YoXy5lbXB0eVJlYWRvbmx5QXJyYXkpO1xuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLy8gYXJyYXkgdXRpbHNcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8qKlxuICogRXF1aXZhbGVudCB0byBgUmVhZG9ubHlOb25FbXB0eUFycmF5I3RyYXZlcnNlV2l0aEluZGV4KEFwcGxpY2F0aXZlKWAuXG4gKlxuICogQGNhdGVnb3J5IHRyYXZlcnNpbmdcbiAqIEBzaW5jZSAyLjExLjBcbiAqL1xuZXhwb3J0IHZhciB0cmF2ZXJzZVJlYWRvbmx5Tm9uRW1wdHlBcnJheVdpdGhJbmRleCA9IGZ1bmN0aW9uIChmKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykge1xuICAgICAgICB2YXIgbyA9IGYoMCwgXy5oZWFkKGFzKSk7XG4gICAgICAgIGlmIChpc05vbmUobykpIHtcbiAgICAgICAgICAgIHJldHVybiBub25lO1xuICAgICAgICB9XG4gICAgICAgIHZhciBvdXQgPSBbby52YWx1ZV07XG4gICAgICAgIGZvciAodmFyIGkgPSAxOyBpIDwgYXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIHZhciBvXzEgPSBmKGksIGFzW2ldKTtcbiAgICAgICAgICAgIGlmIChpc05vbmUob18xKSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBub25lO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgb3V0LnB1c2gob18xLnZhbHVlKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gc29tZShvdXQpO1xuICAgIH07XG59O1xuLyoqXG4gKiBFcXVpdmFsZW50IHRvIGBSZWFkb25seUFycmF5I3RyYXZlcnNlV2l0aEluZGV4KEFwcGxpY2F0aXZlKWAuXG4gKlxuICogQGNhdGVnb3J5IHRyYXZlcnNpbmdcbiAqIEBzaW5jZSAyLjExLjBcbiAqL1xuZXhwb3J0IHZhciB0cmF2ZXJzZVJlYWRvbmx5QXJyYXlXaXRoSW5kZXggPSBmdW5jdGlvbiAoZikge1xuICAgIHZhciBnID0gdHJhdmVyc2VSZWFkb25seU5vbkVtcHR5QXJyYXlXaXRoSW5kZXgoZik7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykgeyByZXR1cm4gKF8uaXNOb25FbXB0eShhcykgPyBnKGFzKSA6IEFwVCk7IH07XG59O1xuLyoqXG4gKiBFcXVpdmFsZW50IHRvIGBSZWFkb25seUFycmF5I3RyYXZlcnNlV2l0aEluZGV4KEFwcGxpY2F0aXZlKWAuXG4gKlxuICogQGNhdGVnb3J5IHRyYXZlcnNpbmdcbiAqIEBzaW5jZSAyLjkuMFxuICovXG5leHBvcnQgdmFyIHRyYXZlcnNlQXJyYXlXaXRoSW5kZXggPSB0cmF2ZXJzZVJlYWRvbmx5QXJyYXlXaXRoSW5kZXg7XG4vKipcbiAqIEVxdWl2YWxlbnQgdG8gYFJlYWRvbmx5QXJyYXkjdHJhdmVyc2UoQXBwbGljYXRpdmUpYC5cbiAqXG4gKiBAY2F0ZWdvcnkgdHJhdmVyc2luZ1xuICogQHNpbmNlIDIuOS4wXG4gKi9cbmV4cG9ydCB2YXIgdHJhdmVyc2VBcnJheSA9IGZ1bmN0aW9uIChmKSB7XG4gICAgcmV0dXJuIHRyYXZlcnNlUmVhZG9ubHlBcnJheVdpdGhJbmRleChmdW5jdGlvbiAoXywgYSkgeyByZXR1cm4gZihhKTsgfSk7XG59O1xuLyoqXG4gKiBFcXVpdmFsZW50IHRvIGBSZWFkb25seUFycmF5I3NlcXVlbmNlKEFwcGxpY2F0aXZlKWAuXG4gKlxuICogQGNhdGVnb3J5IHRyYXZlcnNpbmdcbiAqIEBzaW5jZSAyLjkuMFxuICovXG5leHBvcnQgdmFyIHNlcXVlbmNlQXJyYXkgPSBcbi8qI19fUFVSRV9fKi8gdHJhdmVyc2VBcnJheShpZGVudGl0eSk7XG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vLyBsZWdhY3lcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8qKlxuICogQWxpYXMgb2YgYGZsYXRNYXBgLlxuICpcbiAqIEBjYXRlZ29yeSBsZWdhY3lcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIGNoYWluID0gZmxhdE1hcDtcbi8qKlxuICogQWxpYXMgb2YgYHRhcGAuXG4gKlxuICogQGNhdGVnb3J5IGxlZ2FjeVxuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgY2hhaW5GaXJzdCA9IHRhcDtcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8vIGRlcHJlY2F0ZWRcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8qKlxuICogVXNlIGBSZWZpbmVtZW50YCBtb2R1bGUgaW5zdGVhZC5cbiAqXG4gKiBAY2F0ZWdvcnkgem9uZSBvZiBkZWF0aFxuICogQHNpbmNlIDIuMC4wXG4gKiBAZGVwcmVjYXRlZFxuICovXG5leHBvcnQgZnVuY3Rpb24gZ2V0UmVmaW5lbWVudChnZXRPcHRpb24pIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGEpIHsgcmV0dXJuIGlzU29tZShnZXRPcHRpb24oYSkpOyB9O1xufVxuLyoqXG4gKiBVc2UgW2BjaGFpbk51bGxhYmxlS2BdKCNjaGFpbm51bGxhYmxlaykgaW5zdGVhZC5cbiAqXG4gKiBAY2F0ZWdvcnkgem9uZSBvZiBkZWF0aFxuICogQHNpbmNlIDIuMC4wXG4gKiBAZGVwcmVjYXRlZFxuICovXG5leHBvcnQgdmFyIG1hcE51bGxhYmxlID0gY2hhaW5OdWxsYWJsZUs7XG4vKipcbiAqIFRoaXMgaW5zdGFuY2UgaXMgZGVwcmVjYXRlZCwgdXNlIHNtYWxsLCBzcGVjaWZpYyBpbnN0YW5jZXMgaW5zdGVhZC5cbiAqIEZvciBleGFtcGxlIGlmIGEgZnVuY3Rpb24gbmVlZHMgYSBgRnVuY3RvcmAgaW5zdGFuY2UsIHBhc3MgYE8uRnVuY3RvcmAgaW5zdGVhZCBvZiBgTy5vcHRpb25gXG4gKiAod2hlcmUgYE9gIGlzIGZyb20gYGltcG9ydCBPIGZyb20gJ2ZwLXRzL09wdGlvbidgKVxuICpcbiAqIEBjYXRlZ29yeSB6b25lIG9mIGRlYXRoXG4gKiBAc2luY2UgMi4wLjBcbiAqIEBkZXByZWNhdGVkXG4gKi9cbmV4cG9ydCB2YXIgb3B0aW9uID0ge1xuICAgIFVSSTogVVJJLFxuICAgIG1hcDogX21hcCxcbiAgICBvZjogb2YsXG4gICAgYXA6IF9hcCxcbiAgICBjaGFpbjogZmxhdE1hcCxcbiAgICByZWR1Y2U6IF9yZWR1Y2UsXG4gICAgZm9sZE1hcDogX2ZvbGRNYXAsXG4gICAgcmVkdWNlUmlnaHQ6IF9yZWR1Y2VSaWdodCxcbiAgICB0cmF2ZXJzZTogX3RyYXZlcnNlLFxuICAgIHNlcXVlbmNlOiBzZXF1ZW5jZSxcbiAgICB6ZXJvOiB6ZXJvLFxuICAgIGFsdDogX2FsdCxcbiAgICBleHRlbmQ6IF9leHRlbmQsXG4gICAgY29tcGFjdDogY29tcGFjdCxcbiAgICBzZXBhcmF0ZTogc2VwYXJhdGUsXG4gICAgZmlsdGVyOiBfZmlsdGVyLFxuICAgIGZpbHRlck1hcDogX2ZpbHRlck1hcCxcbiAgICBwYXJ0aXRpb246IF9wYXJ0aXRpb24sXG4gICAgcGFydGl0aW9uTWFwOiBfcGFydGl0aW9uTWFwLFxuICAgIHdpdGhlcjogX3dpdGhlcixcbiAgICB3aWx0OiBfd2lsdCxcbiAgICB0aHJvd0Vycm9yOiB0aHJvd0Vycm9yXG59O1xuLyoqXG4gKiBVc2UgW2BnZXRBcHBseVNlbWlncm91cGBdKC4vQXBwbHkudHMuaHRtbCNnZXRhcHBseXNlbWlncm91cCkgaW5zdGVhZC5cbiAqXG4gKiBAY2F0ZWdvcnkgem9uZSBvZiBkZWF0aFxuICogQHNpbmNlIDIuMC4wXG4gKiBAZGVwcmVjYXRlZFxuICovXG5leHBvcnQgdmFyIGdldEFwcGx5U2VtaWdyb3VwID0gLyojX19QVVJFX18qLyBnZXRBcHBseVNlbWlncm91cF8oQXBwbHkpO1xuLyoqXG4gKiBVc2UgW2BnZXRBcHBsaWNhdGl2ZU1vbm9pZGBdKC4vQXBwbGljYXRpdmUudHMuaHRtbCNnZXRhcHBsaWNhdGl2ZW1vbm9pZCkgaW5zdGVhZC5cbiAqXG4gKiBAY2F0ZWdvcnkgem9uZSBvZiBkZWF0aFxuICogQHNpbmNlIDIuMC4wXG4gKiBAZGVwcmVjYXRlZFxuICovXG5leHBvcnQgdmFyIGdldEFwcGx5TW9ub2lkID0gLyojX19QVVJFX18qLyBnZXRBcHBsaWNhdGl2ZU1vbm9pZChBcHBsaWNhdGl2ZSk7XG4vKipcbiAqIFVzZVxuICpcbiAqIGBgYHRzXG4gKiBpbXBvcnQgeyBmaXJzdCB9IGZyb20gJ2ZwLXRzL1NlbWlncm91cCdcbiAqIGltcG9ydCB7IGdldE1vbm9pZCB9IGZyb20gJ2ZwLXRzL09wdGlvbidcbiAqXG4gKiBnZXRNb25vaWQoZmlyc3QoKSlcbiAqIGBgYFxuICpcbiAqIGluc3RlYWQuXG4gKlxuICogTW9ub2lkIHJldHVybmluZyB0aGUgbGVmdC1tb3N0IG5vbi1gTm9uZWAgdmFsdWVcbiAqXG4gKiB8IHggICAgICAgfCB5ICAgICAgIHwgY29uY2F0KHgsIHkpIHxcbiAqIHwgLS0tLS0tLSB8IC0tLS0tLS0gfCAtLS0tLS0tLS0tLS0gfFxuICogfCBub25lICAgIHwgbm9uZSAgICB8IG5vbmUgICAgICAgICB8XG4gKiB8IHNvbWUoYSkgfCBub25lICAgIHwgc29tZShhKSAgICAgIHxcbiAqIHwgbm9uZSAgICB8IHNvbWUoYikgfCBzb21lKGIpICAgICAgfFxuICogfCBzb21lKGEpIHwgc29tZShiKSB8IHNvbWUoYSkgICAgICB8XG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IGdldEZpcnN0TW9ub2lkLCBzb21lLCBub25lIH0gZnJvbSAnZnAtdHMvT3B0aW9uJ1xuICpcbiAqIGNvbnN0IE0gPSBnZXRGaXJzdE1vbm9pZDxudW1iZXI+KClcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoTS5jb25jYXQobm9uZSwgbm9uZSksIG5vbmUpXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKE0uY29uY2F0KHNvbWUoMSksIG5vbmUpLCBzb21lKDEpKVxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChNLmNvbmNhdChub25lLCBzb21lKDIpKSwgc29tZSgyKSlcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoTS5jb25jYXQoc29tZSgxKSwgc29tZSgyKSksIHNvbWUoMSkpXG4gKlxuICogQGNhdGVnb3J5IHpvbmUgb2YgZGVhdGhcbiAqIEBzaW5jZSAyLjAuMFxuICogQGRlcHJlY2F0ZWRcbiAqL1xuZXhwb3J0IHZhciBnZXRGaXJzdE1vbm9pZCA9IGZ1bmN0aW9uICgpIHsgcmV0dXJuIGdldE1vbm9pZChmaXJzdCgpKTsgfTtcbi8qKlxuICogVXNlXG4gKlxuICogYGBgdHNcbiAqIGltcG9ydCB7IGxhc3QgfSBmcm9tICdmcC10cy9TZW1pZ3JvdXAnXG4gKiBpbXBvcnQgeyBnZXRNb25vaWQgfSBmcm9tICdmcC10cy9PcHRpb24nXG4gKlxuICogZ2V0TW9ub2lkKGxhc3QoKSlcbiAqIGBgYFxuICpcbiAqIGluc3RlYWQuXG4gKlxuICogTW9ub2lkIHJldHVybmluZyB0aGUgcmlnaHQtbW9zdCBub24tYE5vbmVgIHZhbHVlXG4gKlxuICogfCB4ICAgICAgIHwgeSAgICAgICB8IGNvbmNhdCh4LCB5KSB8XG4gKiB8IC0tLS0tLS0gfCAtLS0tLS0tIHwgLS0tLS0tLS0tLS0tIHxcbiAqIHwgbm9uZSAgICB8IG5vbmUgICAgfCBub25lICAgICAgICAgfFxuICogfCBzb21lKGEpIHwgbm9uZSAgICB8IHNvbWUoYSkgICAgICB8XG4gKiB8IG5vbmUgICAgfCBzb21lKGIpIHwgc29tZShiKSAgICAgIHxcbiAqIHwgc29tZShhKSB8IHNvbWUoYikgfCBzb21lKGIpICAgICAgfFxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBnZXRMYXN0TW9ub2lkLCBzb21lLCBub25lIH0gZnJvbSAnZnAtdHMvT3B0aW9uJ1xuICpcbiAqIGNvbnN0IE0gPSBnZXRMYXN0TW9ub2lkPG51bWJlcj4oKVxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChNLmNvbmNhdChub25lLCBub25lKSwgbm9uZSlcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoTS5jb25jYXQoc29tZSgxKSwgbm9uZSksIHNvbWUoMSkpXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKE0uY29uY2F0KG5vbmUsIHNvbWUoMikpLCBzb21lKDIpKVxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChNLmNvbmNhdChzb21lKDEpLCBzb21lKDIpKSwgc29tZSgyKSlcbiAqXG4gKiBAY2F0ZWdvcnkgem9uZSBvZiBkZWF0aFxuICogQHNpbmNlIDIuMC4wXG4gKiBAZGVwcmVjYXRlZFxuICovXG5leHBvcnQgdmFyIGdldExhc3RNb25vaWQgPSBmdW5jdGlvbiAoKSB7IHJldHVybiBnZXRNb25vaWQobGFzdCgpKTsgfTtcbiIsCiAgImltcG9ydCB7IGdldEFwcGxpY2F0aXZlTW9ub2lkIH0gZnJvbSAnLi9BcHBsaWNhdGl2ZSc7XG5pbXBvcnQgeyBhcEZpcnN0IGFzIGFwRmlyc3RfLCBhcFMgYXMgYXBTXywgYXBTZWNvbmQgYXMgYXBTZWNvbmRfLCBnZXRBcHBseVNlbWlncm91cCBhcyBnZXRBcHBseVNlbWlncm91cF8gfSBmcm9tICcuL0FwcGx5JztcbmltcG9ydCAqIGFzIGNoYWluYWJsZSBmcm9tICcuL0NoYWluJztcbmltcG9ydCB7IGNoYWluRWl0aGVySyBhcyBjaGFpbkVpdGhlcktfLCBmcm9tRWl0aGVySyBhcyBmcm9tRWl0aGVyS18sIHRhcEVpdGhlciBhcyB0YXBFaXRoZXJfIH0gZnJvbSAnLi9Gcm9tRWl0aGVyJztcbmltcG9ydCB7IGNvbnN0TnVsbCwgY29uc3RVbmRlZmluZWQsIGR1YWwsIGZsb3csIGlkZW50aXR5LCBwaXBlIH0gZnJvbSAnLi9mdW5jdGlvbic7XG5pbXBvcnQgeyBhcyBhcyBhc18sIGFzVW5pdCBhcyBhc1VuaXRfLCBiaW5kVG8gYXMgYmluZFRvXywgZmxhcCBhcyBmbGFwXywgbGV0IGFzIGxldF9fIH0gZnJvbSAnLi9GdW5jdG9yJztcbmltcG9ydCAqIGFzIF8gZnJvbSAnLi9pbnRlcm5hbCc7XG5pbXBvcnQgeyBub3QgfSBmcm9tICcuL1ByZWRpY2F0ZSc7XG5pbXBvcnQgeyBmaXJzdCwgbGFzdCB9IGZyb20gJy4vU2VtaWdyb3VwJztcbmltcG9ydCB7IHNlcGFyYXRlZCB9IGZyb20gJy4vU2VwYXJhdGVkJztcbmltcG9ydCB7IHdpbHREZWZhdWx0LCB3aXRoZXJEZWZhdWx0IH0gZnJvbSAnLi9XaXRoZXJhYmxlJztcbmltcG9ydCB7IGd1YXJkIGFzIGd1YXJkXyB9IGZyb20gJy4vWmVybyc7XG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vLyBjb25zdHJ1Y3RvcnNcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8qKlxuICogYE5vbmVgIGRvZXNuJ3QgaGF2ZSBhIGNvbnN0cnVjdG9yLCBpbnN0ZWFkIHlvdSBjYW4gdXNlIGl0IGRpcmVjdGx5IGFzIGEgdmFsdWUuIFJlcHJlc2VudHMgYSBtaXNzaW5nIHZhbHVlLlxuICpcbiAqIEBjYXRlZ29yeSBjb25zdHJ1Y3RvcnNcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIG5vbmUgPSBfLm5vbmU7XG4vKipcbiAqIENvbnN0cnVjdHMgYSBgU29tZWAuIFJlcHJlc2VudHMgYW4gb3B0aW9uYWwgdmFsdWUgdGhhdCBleGlzdHMuXG4gKlxuICogQGNhdGVnb3J5IGNvbnN0cnVjdG9yc1xuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgc29tZSA9IF8uc29tZTtcbmV4cG9ydCBmdW5jdGlvbiBmcm9tUHJlZGljYXRlKHByZWRpY2F0ZSkge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYSkgeyByZXR1cm4gKHByZWRpY2F0ZShhKSA/IHNvbWUoYSkgOiBub25lKTsgfTtcbn1cbi8qKlxuICogUmV0dXJucyB0aGUgYExlZnRgIHZhbHVlIG9mIGFuIGBFaXRoZXJgIGlmIHBvc3NpYmxlLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBnZXRMZWZ0LCBub25lLCBzb21lIH0gZnJvbSAnZnAtdHMvT3B0aW9uJ1xuICogaW1wb3J0IHsgcmlnaHQsIGxlZnQgfSBmcm9tICdmcC10cy9FaXRoZXInXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChnZXRMZWZ0KHJpZ2h0KDEpKSwgbm9uZSlcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoZ2V0TGVmdChsZWZ0KCdhJykpLCBzb21lKCdhJykpXG4gKlxuICogQGNhdGVnb3J5IGNvbnN0cnVjdG9yc1xuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgZ2V0TGVmdCA9IGZ1bmN0aW9uIChtYSkgeyByZXR1cm4gKG1hLl90YWcgPT09ICdSaWdodCcgPyBub25lIDogc29tZShtYS5sZWZ0KSk7IH07XG4vKipcbiAqIFJldHVybnMgdGhlIGBSaWdodGAgdmFsdWUgb2YgYW4gYEVpdGhlcmAgaWYgcG9zc2libGUuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IGdldFJpZ2h0LCBub25lLCBzb21lIH0gZnJvbSAnZnAtdHMvT3B0aW9uJ1xuICogaW1wb3J0IHsgcmlnaHQsIGxlZnQgfSBmcm9tICdmcC10cy9FaXRoZXInXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChnZXRSaWdodChyaWdodCgxKSksIHNvbWUoMSkpXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKGdldFJpZ2h0KGxlZnQoJ2EnKSksIG5vbmUpXG4gKlxuICogQGNhdGVnb3J5IGNvbnN0cnVjdG9yc1xuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgZ2V0UmlnaHQgPSBmdW5jdGlvbiAobWEpIHsgcmV0dXJuIChtYS5fdGFnID09PSAnTGVmdCcgPyBub25lIDogc29tZShtYS5yaWdodCkpOyB9O1xudmFyIF9tYXAgPSBmdW5jdGlvbiAoZmEsIGYpIHsgcmV0dXJuIHBpcGUoZmEsIG1hcChmKSk7IH07XG52YXIgX2FwID0gZnVuY3Rpb24gKGZhYiwgZmEpIHsgcmV0dXJuIHBpcGUoZmFiLCBhcChmYSkpOyB9O1xudmFyIF9yZWR1Y2UgPSBmdW5jdGlvbiAoZmEsIGIsIGYpIHsgcmV0dXJuIHBpcGUoZmEsIHJlZHVjZShiLCBmKSk7IH07XG52YXIgX2ZvbGRNYXAgPSBmdW5jdGlvbiAoTSkge1xuICAgIHZhciBmb2xkTWFwTSA9IGZvbGRNYXAoTSk7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChmYSwgZikgeyByZXR1cm4gcGlwZShmYSwgZm9sZE1hcE0oZikpOyB9O1xufTtcbnZhciBfcmVkdWNlUmlnaHQgPSBmdW5jdGlvbiAoZmEsIGIsIGYpIHsgcmV0dXJuIHBpcGUoZmEsIHJlZHVjZVJpZ2h0KGIsIGYpKTsgfTtcbnZhciBfdHJhdmVyc2UgPSBmdW5jdGlvbiAoRikge1xuICAgIHZhciB0cmF2ZXJzZUYgPSB0cmF2ZXJzZShGKTtcbiAgICByZXR1cm4gZnVuY3Rpb24gKHRhLCBmKSB7IHJldHVybiBwaXBlKHRhLCB0cmF2ZXJzZUYoZikpOyB9O1xufTtcbi8qIGlzdGFuYnVsIGlnbm9yZSBuZXh0ICovXG52YXIgX2FsdCA9IGZ1bmN0aW9uIChmYSwgdGhhdCkgeyByZXR1cm4gcGlwZShmYSwgYWx0KHRoYXQpKTsgfTtcbnZhciBfZmlsdGVyID0gZnVuY3Rpb24gKGZhLCBwcmVkaWNhdGUpIHsgcmV0dXJuIHBpcGUoZmEsIGZpbHRlcihwcmVkaWNhdGUpKTsgfTtcbi8qIGlzdGFuYnVsIGlnbm9yZSBuZXh0ICovXG52YXIgX2ZpbHRlck1hcCA9IGZ1bmN0aW9uIChmYSwgZikgeyByZXR1cm4gcGlwZShmYSwgZmlsdGVyTWFwKGYpKTsgfTtcbi8qIGlzdGFuYnVsIGlnbm9yZSBuZXh0ICovXG52YXIgX2V4dGVuZCA9IGZ1bmN0aW9uICh3YSwgZikgeyByZXR1cm4gcGlwZSh3YSwgZXh0ZW5kKGYpKTsgfTtcbi8qIGlzdGFuYnVsIGlnbm9yZSBuZXh0ICovXG52YXIgX3BhcnRpdGlvbiA9IGZ1bmN0aW9uIChmYSwgcHJlZGljYXRlKSB7XG4gICAgcmV0dXJuIHBpcGUoZmEsIHBhcnRpdGlvbihwcmVkaWNhdGUpKTtcbn07XG4vKiBpc3RhbmJ1bCBpZ25vcmUgbmV4dCAqL1xudmFyIF9wYXJ0aXRpb25NYXAgPSBmdW5jdGlvbiAoZmEsIGYpIHsgcmV0dXJuIHBpcGUoZmEsIHBhcnRpdGlvbk1hcChmKSk7IH07XG4vKipcbiAqIEBjYXRlZ29yeSB0eXBlIGxhbWJkYXNcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIFVSSSA9ICdPcHRpb24nO1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciBnZXRTaG93ID0gZnVuY3Rpb24gKFMpIHsgcmV0dXJuICh7XG4gICAgc2hvdzogZnVuY3Rpb24gKG1hKSB7IHJldHVybiAoaXNOb25lKG1hKSA/ICdub25lJyA6IFwic29tZShcIi5jb25jYXQoUy5zaG93KG1hLnZhbHVlKSwgXCIpXCIpKTsgfVxufSk7IH07XG4vKipcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBub25lLCBzb21lLCBnZXRFcSB9IGZyb20gJ2ZwLXRzL09wdGlvbidcbiAqIGltcG9ydCAqIGFzIE4gZnJvbSAnZnAtdHMvbnVtYmVyJ1xuICpcbiAqIGNvbnN0IEUgPSBnZXRFcShOLkVxKVxuICogYXNzZXJ0LnN0cmljdEVxdWFsKEUuZXF1YWxzKG5vbmUsIG5vbmUpLCB0cnVlKVxuICogYXNzZXJ0LnN0cmljdEVxdWFsKEUuZXF1YWxzKG5vbmUsIHNvbWUoMSkpLCBmYWxzZSlcbiAqIGFzc2VydC5zdHJpY3RFcXVhbChFLmVxdWFscyhzb21lKDEpLCBub25lKSwgZmFsc2UpXG4gKiBhc3NlcnQuc3RyaWN0RXF1YWwoRS5lcXVhbHMoc29tZSgxKSwgc29tZSgyKSksIGZhbHNlKVxuICogYXNzZXJ0LnN0cmljdEVxdWFsKEUuZXF1YWxzKHNvbWUoMSksIHNvbWUoMSkpLCB0cnVlKVxuICpcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIGdldEVxID0gZnVuY3Rpb24gKEUpIHsgcmV0dXJuICh7XG4gICAgZXF1YWxzOiBmdW5jdGlvbiAoeCwgeSkgeyByZXR1cm4geCA9PT0geSB8fCAoaXNOb25lKHgpID8gaXNOb25lKHkpIDogaXNOb25lKHkpID8gZmFsc2UgOiBFLmVxdWFscyh4LnZhbHVlLCB5LnZhbHVlKSk7IH1cbn0pOyB9O1xuLyoqXG4gKiBUaGUgYE9yZGAgaW5zdGFuY2UgYWxsb3dzIGBPcHRpb25gIHZhbHVlcyB0byBiZSBjb21wYXJlZCB3aXRoXG4gKiBgY29tcGFyZWAsIHdoZW5ldmVyIHRoZXJlIGlzIGFuIGBPcmRgIGluc3RhbmNlIGZvclxuICogdGhlIHR5cGUgdGhlIGBPcHRpb25gIGNvbnRhaW5zLlxuICpcbiAqIGBOb25lYCBpcyBjb25zaWRlcmVkIHRvIGJlIGxlc3MgdGhhbiBhbnkgYFNvbWVgIHZhbHVlLlxuICpcbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgbm9uZSwgc29tZSwgZ2V0T3JkIH0gZnJvbSAnZnAtdHMvT3B0aW9uJ1xuICogaW1wb3J0ICogYXMgTiBmcm9tICdmcC10cy9udW1iZXInXG4gKlxuICogY29uc3QgTyA9IGdldE9yZChOLk9yZClcbiAqIGFzc2VydC5zdHJpY3RFcXVhbChPLmNvbXBhcmUobm9uZSwgbm9uZSksIDApXG4gKiBhc3NlcnQuc3RyaWN0RXF1YWwoTy5jb21wYXJlKG5vbmUsIHNvbWUoMSkpLCAtMSlcbiAqIGFzc2VydC5zdHJpY3RFcXVhbChPLmNvbXBhcmUoc29tZSgxKSwgbm9uZSksIDEpXG4gKiBhc3NlcnQuc3RyaWN0RXF1YWwoTy5jb21wYXJlKHNvbWUoMSksIHNvbWUoMikpLCAtMSlcbiAqIGFzc2VydC5zdHJpY3RFcXVhbChPLmNvbXBhcmUoc29tZSgxKSwgc29tZSgxKSksIDApXG4gKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgZ2V0T3JkID0gZnVuY3Rpb24gKE8pIHsgcmV0dXJuICh7XG4gICAgZXF1YWxzOiBnZXRFcShPKS5lcXVhbHMsXG4gICAgY29tcGFyZTogZnVuY3Rpb24gKHgsIHkpIHsgcmV0dXJuICh4ID09PSB5ID8gMCA6IGlzU29tZSh4KSA/IChpc1NvbWUoeSkgPyBPLmNvbXBhcmUoeC52YWx1ZSwgeS52YWx1ZSkgOiAxKSA6IC0xKTsgfVxufSk7IH07XG4vKipcbiAqIE1vbm9pZCByZXR1cm5pbmcgdGhlIGxlZnQtbW9zdCBub24tYE5vbmVgIHZhbHVlLiBJZiBib3RoIG9wZXJhbmRzIGFyZSBgU29tZWBzIHRoZW4gdGhlIGlubmVyIHZhbHVlcyBhcmVcbiAqIGNvbmNhdGVuYXRlZCB1c2luZyB0aGUgcHJvdmlkZWQgYFNlbWlncm91cGBcbiAqXG4gKiB8IHggICAgICAgfCB5ICAgICAgIHwgY29uY2F0KHgsIHkpICAgICAgIHxcbiAqIHwgLS0tLS0tLSB8IC0tLS0tLS0gfCAtLS0tLS0tLS0tLS0tLS0tLS0gfFxuICogfCBub25lICAgIHwgbm9uZSAgICB8IG5vbmUgICAgICAgICAgICAgICB8XG4gKiB8IHNvbWUoYSkgfCBub25lICAgIHwgc29tZShhKSAgICAgICAgICAgIHxcbiAqIHwgbm9uZSAgICB8IHNvbWUoYikgfCBzb21lKGIpICAgICAgICAgICAgfFxuICogfCBzb21lKGEpIHwgc29tZShiKSB8IHNvbWUoY29uY2F0KGEsIGIpKSB8XG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IGdldE1vbm9pZCwgc29tZSwgbm9uZSB9IGZyb20gJ2ZwLXRzL09wdGlvbidcbiAqIGltcG9ydCB7IFNlbWlncm91cFN1bSB9IGZyb20gJ2ZwLXRzL251bWJlcidcbiAqXG4gKiBjb25zdCBNID0gZ2V0TW9ub2lkKFNlbWlncm91cFN1bSlcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoTS5jb25jYXQobm9uZSwgbm9uZSksIG5vbmUpXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKE0uY29uY2F0KHNvbWUoMSksIG5vbmUpLCBzb21lKDEpKVxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChNLmNvbmNhdChub25lLCBzb21lKDEpKSwgc29tZSgxKSlcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoTS5jb25jYXQoc29tZSgxKSwgc29tZSgyKSksIHNvbWUoMykpXG4gKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgZ2V0TW9ub2lkID0gZnVuY3Rpb24gKFMpIHsgcmV0dXJuICh7XG4gICAgY29uY2F0OiBmdW5jdGlvbiAoeCwgeSkgeyByZXR1cm4gKGlzTm9uZSh4KSA/IHkgOiBpc05vbmUoeSkgPyB4IDogc29tZShTLmNvbmNhdCh4LnZhbHVlLCB5LnZhbHVlKSkpOyB9LFxuICAgIGVtcHR5OiBub25lXG59KTsgfTtcbi8qKlxuICogQGNhdGVnb3J5IG1hcHBpbmdcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIG1hcCA9IGZ1bmN0aW9uIChmKSB7IHJldHVybiBmdW5jdGlvbiAoZmEpIHtcbiAgICByZXR1cm4gaXNOb25lKGZhKSA/IG5vbmUgOiBzb21lKGYoZmEudmFsdWUpKTtcbn07IH07XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjcuMFxuICovXG5leHBvcnQgdmFyIEZ1bmN0b3IgPSB7XG4gICAgVVJJOiBVUkksXG4gICAgbWFwOiBfbWFwXG59O1xuLyoqXG4gKiBNYXBzIHRoZSBgU29tZWAgdmFsdWUgb2YgdGhpcyBgT3B0aW9uYCB0byB0aGUgc3BlY2lmaWVkIGNvbnN0YW50IHZhbHVlLlxuICpcbiAqIEBjYXRlZ29yeSBtYXBwaW5nXG4gKiBAc2luY2UgMi4xNi4wXG4gKi9cbmV4cG9ydCB2YXIgYXMgPSBkdWFsKDIsIGFzXyhGdW5jdG9yKSk7XG4vKipcbiAqIE1hcHMgdGhlIGBTb21lYCB2YWx1ZSBvZiB0aGlzIGBPcHRpb25gIHRvIHRoZSB2b2lkIGNvbnN0YW50IHZhbHVlLlxuICpcbiAqIEBjYXRlZ29yeSBtYXBwaW5nXG4gKiBAc2luY2UgMi4xNi4wXG4gKi9cbmV4cG9ydCB2YXIgYXNVbml0ID0gYXNVbml0XyhGdW5jdG9yKTtcbi8qKlxuICogQGNhdGVnb3J5IGNvbnN0cnVjdG9yc1xuICogQHNpbmNlIDIuNy4wXG4gKi9cbmV4cG9ydCB2YXIgb2YgPSBzb21lO1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi4xMC4wXG4gKi9cbmV4cG9ydCB2YXIgUG9pbnRlZCA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICBvZjogb2Zcbn07XG4vKipcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIGFwID0gZnVuY3Rpb24gKGZhKSB7IHJldHVybiBmdW5jdGlvbiAoZmFiKSB7XG4gICAgcmV0dXJuIGlzTm9uZShmYWIpID8gbm9uZSA6IGlzTm9uZShmYSkgPyBub25lIDogc29tZShmYWIudmFsdWUoZmEudmFsdWUpKTtcbn07IH07XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjEwLjBcbiAqL1xuZXhwb3J0IHZhciBBcHBseSA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICBtYXA6IF9tYXAsXG4gICAgYXA6IF9hcFxufTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuNy4wXG4gKi9cbmV4cG9ydCB2YXIgQXBwbGljYXRpdmUgPSB7XG4gICAgVVJJOiBVUkksXG4gICAgbWFwOiBfbWFwLFxuICAgIGFwOiBfYXAsXG4gICAgb2Y6IG9mXG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgc2VxdWVuY2luZ1xuICogQHNpbmNlIDIuMTQuMFxuICovXG5leHBvcnQgdmFyIGZsYXRNYXAgPSAvKiNfX1BVUkVfXyovIGR1YWwoMiwgZnVuY3Rpb24gKG1hLCBmKSB7IHJldHVybiAoaXNOb25lKG1hKSA/IG5vbmUgOiBmKG1hLnZhbHVlKSk7IH0pO1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi4xMC4wXG4gKi9cbmV4cG9ydCB2YXIgQ2hhaW4gPSB7XG4gICAgVVJJOiBVUkksXG4gICAgbWFwOiBfbWFwLFxuICAgIGFwOiBfYXAsXG4gICAgY2hhaW46IGZsYXRNYXBcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjcuMFxuICovXG5leHBvcnQgdmFyIE1vbmFkID0ge1xuICAgIFVSSTogVVJJLFxuICAgIG1hcDogX21hcCxcbiAgICBhcDogX2FwLFxuICAgIG9mOiBvZixcbiAgICBjaGFpbjogZmxhdE1hcFxufTtcbi8qKlxuICogQGNhdGVnb3J5IGZvbGRpbmdcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIHJlZHVjZSA9IGZ1bmN0aW9uIChiLCBmKSB7IHJldHVybiBmdW5jdGlvbiAoZmEpIHtcbiAgICByZXR1cm4gaXNOb25lKGZhKSA/IGIgOiBmKGIsIGZhLnZhbHVlKTtcbn07IH07XG4vKipcbiAqIEBjYXRlZ29yeSBmb2xkaW5nXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciBmb2xkTWFwID0gZnVuY3Rpb24gKE0pIHsgcmV0dXJuIGZ1bmN0aW9uIChmKSB7IHJldHVybiBmdW5jdGlvbiAoZmEpIHtcbiAgICByZXR1cm4gaXNOb25lKGZhKSA/IE0uZW1wdHkgOiBmKGZhLnZhbHVlKTtcbn07IH07IH07XG4vKipcbiAqIEBjYXRlZ29yeSBmb2xkaW5nXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciByZWR1Y2VSaWdodCA9IGZ1bmN0aW9uIChiLCBmKSB7IHJldHVybiBmdW5jdGlvbiAoZmEpIHtcbiAgICByZXR1cm4gaXNOb25lKGZhKSA/IGIgOiBmKGZhLnZhbHVlLCBiKTtcbn07IH07XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjcuMFxuICovXG5leHBvcnQgdmFyIEZvbGRhYmxlID0ge1xuICAgIFVSSTogVVJJLFxuICAgIHJlZHVjZTogX3JlZHVjZSxcbiAgICBmb2xkTWFwOiBfZm9sZE1hcCxcbiAgICByZWR1Y2VSaWdodDogX3JlZHVjZVJpZ2h0XG59O1xuLyoqXG4gKiBSZXR1cm5zIHRoZSBwcm92aWRlZCBgT3B0aW9uYCBgdGhhdGAgaWYgYHNlbGZgIGlzIGBOb25lYCwgb3RoZXJ3aXNlIHJldHVybnMgYHNlbGZgLlxuICpcbiAqIEBwYXJhbSBzZWxmIC0gVGhlIGZpcnN0IGBPcHRpb25gIHRvIGJlIGNoZWNrZWQuXG4gKiBAcGFyYW0gdGhhdCAtIFRoZSBgT3B0aW9uYCB0byByZXR1cm4gaWYgYHNlbGZgIGlzIGBOb25lYC5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0ICogYXMgTyBmcm9tIFwiZnAtdHMvT3B0aW9uXCJcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKE8ub3JFbHNlKE8ubm9uZSwgKCkgPT4gTy5ub25lKSwgTy5ub25lKVxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChPLm9yRWxzZShPLnNvbWUoMSksICgpID0+IE8ubm9uZSksIE8uc29tZSgxKSlcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoTy5vckVsc2UoTy5ub25lLCAoKSA9PiBPLnNvbWUoJ2InKSksIE8uc29tZSgnYicpKVxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChPLm9yRWxzZShPLnNvbWUoMSksICgpID0+IE8uc29tZSgnYicpKSwgTy5zb21lKDEpKVxuICpcbiAqIEBjYXRlZ29yeSBlcnJvciBoYW5kbGluZ1xuICogQHNpbmNlIDIuMTYuMFxuICovXG5leHBvcnQgdmFyIG9yRWxzZSA9IGR1YWwoMiwgZnVuY3Rpb24gKHNlbGYsIHRoYXQpIHsgcmV0dXJuIChpc05vbmUoc2VsZikgPyB0aGF0KCkgOiBzZWxmKTsgfSk7XG4vKipcbiAqIEFsaWFzIG9mIGBvckVsc2VgLlxuICpcbiAqIExlc3Mgc3RyaWN0IHZlcnNpb24gb2YgW2BhbHRgXSgjYWx0KS5cbiAqXG4gKiBUaGUgYFdgIHN1ZmZpeCAoc2hvcnQgZm9yICoqVyoqaWRlbmluZykgbWVhbnMgdGhhdCB0aGUgcmV0dXJuIHR5cGVzIHdpbGwgYmUgbWVyZ2VkLlxuICpcbiAqIEBjYXRlZ29yeSBsZWdhY3lcbiAqIEBzaW5jZSAyLjkuMFxuICovXG5leHBvcnQgdmFyIGFsdFcgPSBvckVsc2U7XG4vKipcbiAqIEFsaWFzIG9mIGBvckVsc2VgLlxuICpcbiAqIEBjYXRlZ29yeSBsZWdhY3lcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIGFsdCA9IG9yRWxzZTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuNy4wXG4gKi9cbmV4cG9ydCB2YXIgQWx0ID0ge1xuICAgIFVSSTogVVJJLFxuICAgIG1hcDogX21hcCxcbiAgICBhbHQ6IF9hbHRcbn07XG4vKipcbiAqIEBzaW5jZSAyLjcuMFxuICovXG5leHBvcnQgdmFyIHplcm8gPSBmdW5jdGlvbiAoKSB7IHJldHVybiBub25lOyB9O1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi4xMS4wXG4gKi9cbmV4cG9ydCB2YXIgWmVybyA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICB6ZXJvOiB6ZXJvXG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgZG8gbm90YXRpb25cbiAqIEBzaW5jZSAyLjExLjBcbiAqL1xuZXhwb3J0IHZhciBndWFyZCA9IC8qI19fUFVSRV9fKi8gZ3VhcmRfKFplcm8sIFBvaW50ZWQpO1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi43LjBcbiAqL1xuZXhwb3J0IHZhciBBbHRlcm5hdGl2ZSA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICBtYXA6IF9tYXAsXG4gICAgYXA6IF9hcCxcbiAgICBvZjogb2YsXG4gICAgYWx0OiBfYWx0LFxuICAgIHplcm86IHplcm9cbn07XG4vKipcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIGV4dGVuZCA9IGZ1bmN0aW9uIChmKSB7IHJldHVybiBmdW5jdGlvbiAod2EpIHtcbiAgICByZXR1cm4gaXNOb25lKHdhKSA/IG5vbmUgOiBzb21lKGYod2EpKTtcbn07IH07XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjcuMFxuICovXG5leHBvcnQgdmFyIEV4dGVuZCA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICBtYXA6IF9tYXAsXG4gICAgZXh0ZW5kOiBfZXh0ZW5kXG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgZmlsdGVyaW5nXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciBjb21wYWN0ID0gLyojX19QVVJFX18qLyBmbGF0TWFwKGlkZW50aXR5KTtcbnZhciBkZWZhdWx0U2VwYXJhdGVkID0gLyojX19QVVJFX18qLyBzZXBhcmF0ZWQobm9uZSwgbm9uZSk7XG4vKipcbiAqIEBjYXRlZ29yeSBmaWx0ZXJpbmdcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIHNlcGFyYXRlID0gZnVuY3Rpb24gKG1hKSB7XG4gICAgcmV0dXJuIGlzTm9uZShtYSkgPyBkZWZhdWx0U2VwYXJhdGVkIDogc2VwYXJhdGVkKGdldExlZnQobWEudmFsdWUpLCBnZXRSaWdodChtYS52YWx1ZSkpO1xufTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuNy4wXG4gKi9cbmV4cG9ydCB2YXIgQ29tcGFjdGFibGUgPSB7XG4gICAgVVJJOiBVUkksXG4gICAgY29tcGFjdDogY29tcGFjdCxcbiAgICBzZXBhcmF0ZTogc2VwYXJhdGVcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBmaWx0ZXJpbmdcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIGZpbHRlciA9IGZ1bmN0aW9uIChwcmVkaWNhdGUpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGZhKSB7XG4gICAgICAgIHJldHVybiBpc05vbmUoZmEpID8gbm9uZSA6IHByZWRpY2F0ZShmYS52YWx1ZSkgPyBmYSA6IG5vbmU7XG4gICAgfTtcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBmaWx0ZXJpbmdcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIGZpbHRlck1hcCA9IGZ1bmN0aW9uIChmKSB7IHJldHVybiBmdW5jdGlvbiAoZmEpIHtcbiAgICByZXR1cm4gaXNOb25lKGZhKSA/IG5vbmUgOiBmKGZhLnZhbHVlKTtcbn07IH07XG4vKipcbiAqIEBjYXRlZ29yeSBmaWx0ZXJpbmdcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIHBhcnRpdGlvbiA9IGZ1bmN0aW9uIChwcmVkaWNhdGUpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGZhKSB7XG4gICAgICAgIHJldHVybiBzZXBhcmF0ZWQoX2ZpbHRlcihmYSwgbm90KHByZWRpY2F0ZSkpLCBfZmlsdGVyKGZhLCBwcmVkaWNhdGUpKTtcbiAgICB9O1xufTtcbi8qKlxuICogQGNhdGVnb3J5IGZpbHRlcmluZ1xuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgcGFydGl0aW9uTWFwID0gZnVuY3Rpb24gKGYpIHsgcmV0dXJuIGZsb3cobWFwKGYpLCBzZXBhcmF0ZSk7IH07XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjcuMFxuICovXG5leHBvcnQgdmFyIEZpbHRlcmFibGUgPSB7XG4gICAgVVJJOiBVUkksXG4gICAgbWFwOiBfbWFwLFxuICAgIGNvbXBhY3Q6IGNvbXBhY3QsXG4gICAgc2VwYXJhdGU6IHNlcGFyYXRlLFxuICAgIGZpbHRlcjogX2ZpbHRlcixcbiAgICBmaWx0ZXJNYXA6IF9maWx0ZXJNYXAsXG4gICAgcGFydGl0aW9uOiBfcGFydGl0aW9uLFxuICAgIHBhcnRpdGlvbk1hcDogX3BhcnRpdGlvbk1hcFxufTtcbi8qKlxuICogQGNhdGVnb3J5IHRyYXZlcnNpbmdcbiAqIEBzaW5jZSAyLjYuM1xuICovXG5leHBvcnQgdmFyIHRyYXZlcnNlID0gZnVuY3Rpb24gKEYpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGYpIHtcbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uICh0YSkge1xuICAgICAgICAgICAgcmV0dXJuIGlzTm9uZSh0YSkgPyBGLm9mKG5vbmUpIDogRi5tYXAoZih0YS52YWx1ZSksIHNvbWUpO1xuICAgICAgICB9O1xuICAgIH07XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgdHJhdmVyc2luZ1xuICogQHNpbmNlIDIuNi4zXG4gKi9cbmV4cG9ydCB2YXIgc2VxdWVuY2UgPSBmdW5jdGlvbiAoRikge1xuICAgIHJldHVybiBmdW5jdGlvbiAodGEpIHtcbiAgICAgICAgcmV0dXJuIGlzTm9uZSh0YSkgPyBGLm9mKG5vbmUpIDogRi5tYXAodGEudmFsdWUsIHNvbWUpO1xuICAgIH07XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi43LjBcbiAqL1xuZXhwb3J0IHZhciBUcmF2ZXJzYWJsZSA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICBtYXA6IF9tYXAsXG4gICAgcmVkdWNlOiBfcmVkdWNlLFxuICAgIGZvbGRNYXA6IF9mb2xkTWFwLFxuICAgIHJlZHVjZVJpZ2h0OiBfcmVkdWNlUmlnaHQsXG4gICAgdHJhdmVyc2U6IF90cmF2ZXJzZSxcbiAgICBzZXF1ZW5jZTogc2VxdWVuY2Vcbn07XG52YXIgX3dpdGhlciA9IC8qI19fUFVSRV9fKi8gd2l0aGVyRGVmYXVsdChUcmF2ZXJzYWJsZSwgQ29tcGFjdGFibGUpO1xudmFyIF93aWx0ID0gLyojX19QVVJFX18qLyB3aWx0RGVmYXVsdChUcmF2ZXJzYWJsZSwgQ29tcGFjdGFibGUpO1xuLyoqXG4gKiBAY2F0ZWdvcnkgZmlsdGVyaW5nXG4gKiBAc2luY2UgMi42LjVcbiAqL1xuZXhwb3J0IHZhciB3aXRoZXIgPSBmdW5jdGlvbiAoRikge1xuICAgIHZhciBfd2l0aGVyRiA9IF93aXRoZXIoRik7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChmKSB7IHJldHVybiBmdW5jdGlvbiAoZmEpIHsgcmV0dXJuIF93aXRoZXJGKGZhLCBmKTsgfTsgfTtcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBmaWx0ZXJpbmdcbiAqIEBzaW5jZSAyLjYuNVxuICovXG5leHBvcnQgdmFyIHdpbHQgPSBmdW5jdGlvbiAoRikge1xuICAgIHZhciBfd2lsdEYgPSBfd2lsdChGKTtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGYpIHsgcmV0dXJuIGZ1bmN0aW9uIChmYSkgeyByZXR1cm4gX3dpbHRGKGZhLCBmKTsgfTsgfTtcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjcuMFxuICovXG5leHBvcnQgdmFyIFdpdGhlcmFibGUgPSB7XG4gICAgVVJJOiBVUkksXG4gICAgbWFwOiBfbWFwLFxuICAgIHJlZHVjZTogX3JlZHVjZSxcbiAgICBmb2xkTWFwOiBfZm9sZE1hcCxcbiAgICByZWR1Y2VSaWdodDogX3JlZHVjZVJpZ2h0LFxuICAgIHRyYXZlcnNlOiBfdHJhdmVyc2UsXG4gICAgc2VxdWVuY2U6IHNlcXVlbmNlLFxuICAgIGNvbXBhY3Q6IGNvbXBhY3QsXG4gICAgc2VwYXJhdGU6IHNlcGFyYXRlLFxuICAgIGZpbHRlcjogX2ZpbHRlcixcbiAgICBmaWx0ZXJNYXA6IF9maWx0ZXJNYXAsXG4gICAgcGFydGl0aW9uOiBfcGFydGl0aW9uLFxuICAgIHBhcnRpdGlvbk1hcDogX3BhcnRpdGlvbk1hcCxcbiAgICB3aXRoZXI6IF93aXRoZXIsXG4gICAgd2lsdDogX3dpbHRcbn07XG4vKipcbiAqIEBzaW5jZSAyLjcuMFxuICovXG5leHBvcnQgdmFyIHRocm93RXJyb3IgPSBmdW5jdGlvbiAoKSB7IHJldHVybiBub25lOyB9O1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi43LjBcbiAqL1xuZXhwb3J0IHZhciBNb25hZFRocm93ID0ge1xuICAgIFVSSTogVVJJLFxuICAgIG1hcDogX21hcCxcbiAgICBhcDogX2FwLFxuICAgIG9mOiBvZixcbiAgICBjaGFpbjogZmxhdE1hcCxcbiAgICB0aHJvd0Vycm9yOiB0aHJvd0Vycm9yXG59O1xuLyoqXG4gKiBUcmFuc2Zvcm1zIGFuIGBFaXRoZXJgIHRvIGFuIGBPcHRpb25gIGRpc2NhcmRpbmcgdGhlIGVycm9yLlxuICpcbiAqIEFsaWFzIG9mIFtnZXRSaWdodF0oI2dldHJpZ2h0KVxuICpcbiAqIEBjYXRlZ29yeSBjb252ZXJzaW9uc1xuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgZnJvbUVpdGhlciA9IGdldFJpZ2h0O1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi4xMS4wXG4gKi9cbmV4cG9ydCB2YXIgRnJvbUVpdGhlciA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICBmcm9tRWl0aGVyOiBmcm9tRWl0aGVyXG59O1xuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLy8gcmVmaW5lbWVudHNcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8qKlxuICogUmV0dXJucyBgdHJ1ZWAgaWYgdGhlIG9wdGlvbiBpcyBhbiBpbnN0YW5jZSBvZiBgU29tZWAsIGBmYWxzZWAgb3RoZXJ3aXNlLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBzb21lLCBub25lLCBpc1NvbWUgfSBmcm9tICdmcC10cy9PcHRpb24nXG4gKlxuICogYXNzZXJ0LnN0cmljdEVxdWFsKGlzU29tZShzb21lKDEpKSwgdHJ1ZSlcbiAqIGFzc2VydC5zdHJpY3RFcXVhbChpc1NvbWUobm9uZSksIGZhbHNlKVxuICpcbiAqIEBjYXRlZ29yeSByZWZpbmVtZW50c1xuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgaXNTb21lID0gXy5pc1NvbWU7XG4vKipcbiAqIFJldHVybnMgYHRydWVgIGlmIHRoZSBvcHRpb24gaXMgYE5vbmVgLCBgZmFsc2VgIG90aGVyd2lzZS5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgc29tZSwgbm9uZSwgaXNOb25lIH0gZnJvbSAnZnAtdHMvT3B0aW9uJ1xuICpcbiAqIGFzc2VydC5zdHJpY3RFcXVhbChpc05vbmUoc29tZSgxKSksIGZhbHNlKVxuICogYXNzZXJ0LnN0cmljdEVxdWFsKGlzTm9uZShub25lKSwgdHJ1ZSlcbiAqXG4gKiBAY2F0ZWdvcnkgcmVmaW5lbWVudHNcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIGlzTm9uZSA9IGZ1bmN0aW9uIChmYSkgeyByZXR1cm4gZmEuX3RhZyA9PT0gJ05vbmUnOyB9O1xuLyoqXG4gKiBMZXNzIHN0cmljdCB2ZXJzaW9uIG9mIFtgbWF0Y2hgXSgjbWF0Y2gpLlxuICpcbiAqIFRoZSBgV2Agc3VmZml4IChzaG9ydCBmb3IgKipXKippZGVuaW5nKSBtZWFucyB0aGF0IHRoZSBoYW5kbGVyIHJldHVybiB0eXBlcyB3aWxsIGJlIG1lcmdlZC5cbiAqXG4gKiBAY2F0ZWdvcnkgcGF0dGVybiBtYXRjaGluZ1xuICogQHNpbmNlIDIuMTAuMFxuICovXG5leHBvcnQgdmFyIG1hdGNoVyA9IGZ1bmN0aW9uIChvbk5vbmUsIG9uU29tZSkge1xuICAgIHJldHVybiBmdW5jdGlvbiAobWEpIHtcbiAgICAgICAgcmV0dXJuIGlzTm9uZShtYSkgPyBvbk5vbmUoKSA6IG9uU29tZShtYS52YWx1ZSk7XG4gICAgfTtcbn07XG4vKipcbiAqIEFsaWFzIG9mIFtgbWF0Y2hXYF0oI21hdGNodykuXG4gKlxuICogQGNhdGVnb3J5IHBhdHRlcm4gbWF0Y2hpbmdcbiAqIEBzaW5jZSAyLjEwLjBcbiAqL1xuZXhwb3J0IHZhciBmb2xkVyA9IG1hdGNoVztcbi8qKlxuICogVGFrZXMgYSAobGF6eSkgZGVmYXVsdCB2YWx1ZSwgYSBmdW5jdGlvbiwgYW5kIGFuIGBPcHRpb25gIHZhbHVlLCBpZiB0aGUgYE9wdGlvbmAgdmFsdWUgaXMgYE5vbmVgIHRoZSBkZWZhdWx0IHZhbHVlIGlzXG4gKiByZXR1cm5lZCwgb3RoZXJ3aXNlIHRoZSBmdW5jdGlvbiBpcyBhcHBsaWVkIHRvIHRoZSB2YWx1ZSBpbnNpZGUgdGhlIGBTb21lYCBhbmQgdGhlIHJlc3VsdCBpcyByZXR1cm5lZC5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgc29tZSwgbm9uZSwgbWF0Y2ggfSBmcm9tICdmcC10cy9PcHRpb24nXG4gKiBpbXBvcnQgeyBwaXBlIH0gZnJvbSAnZnAtdHMvZnVuY3Rpb24nXG4gKlxuICogYXNzZXJ0LnN0cmljdEVxdWFsKFxuICogICBwaXBlKFxuICogICAgIHNvbWUoMSksXG4gKiAgICAgbWF0Y2goKCkgPT4gJ2Egbm9uZScsIGEgPT4gYGEgc29tZSBjb250YWluaW5nICR7YX1gKVxuICogICApLFxuICogICAnYSBzb21lIGNvbnRhaW5pbmcgMSdcbiAqIClcbiAqXG4gKiBhc3NlcnQuc3RyaWN0RXF1YWwoXG4gKiAgIHBpcGUoXG4gKiAgICAgbm9uZSxcbiAqICAgICBtYXRjaCgoKSA9PiAnYSBub25lJywgYSA9PiBgYSBzb21lIGNvbnRhaW5pbmcgJHthfWApXG4gKiAgICksXG4gKiAgICdhIG5vbmUnXG4gKiApXG4gKlxuICogQGNhdGVnb3J5IHBhdHRlcm4gbWF0Y2hpbmdcbiAqIEBzaW5jZSAyLjEwLjBcbiAqL1xuZXhwb3J0IHZhciBtYXRjaCA9IG1hdGNoVztcbi8qKlxuICogQWxpYXMgb2YgW2BtYXRjaGBdKCNtYXRjaCkuXG4gKlxuICogQGNhdGVnb3J5IHBhdHRlcm4gbWF0Y2hpbmdcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIGZvbGQgPSBtYXRjaDtcbi8qKlxuICogTGVzcyBzdHJpY3QgdmVyc2lvbiBvZiBbYGdldE9yRWxzZWBdKCNnZXRvcmVsc2UpLlxuICpcbiAqIFRoZSBgV2Agc3VmZml4IChzaG9ydCBmb3IgKipXKippZGVuaW5nKSBtZWFucyB0aGF0IHRoZSBoYW5kbGVyIHJldHVybiB0eXBlIHdpbGwgYmUgbWVyZ2VkLlxuICpcbiAqIEBjYXRlZ29yeSBlcnJvciBoYW5kbGluZ1xuICogQHNpbmNlIDIuNi4wXG4gKi9cbmV4cG9ydCB2YXIgZ2V0T3JFbHNlVyA9IGZ1bmN0aW9uIChvbk5vbmUpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKG1hKSB7XG4gICAgICAgIHJldHVybiBpc05vbmUobWEpID8gb25Ob25lKCkgOiBtYS52YWx1ZTtcbiAgICB9O1xufTtcbi8qKlxuICogRXh0cmFjdHMgdGhlIHZhbHVlIG91dCBvZiB0aGUgc3RydWN0dXJlLCBpZiBpdCBleGlzdHMuIE90aGVyd2lzZSByZXR1cm5zIHRoZSBnaXZlbiBkZWZhdWx0IHZhbHVlXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IHNvbWUsIG5vbmUsIGdldE9yRWxzZSB9IGZyb20gJ2ZwLXRzL09wdGlvbidcbiAqIGltcG9ydCB7IHBpcGUgfSBmcm9tICdmcC10cy9mdW5jdGlvbidcbiAqXG4gKiBhc3NlcnQuc3RyaWN0RXF1YWwoXG4gKiAgIHBpcGUoXG4gKiAgICAgc29tZSgxKSxcbiAqICAgICBnZXRPckVsc2UoKCkgPT4gMClcbiAqICAgKSxcbiAqICAgMVxuICogKVxuICogYXNzZXJ0LnN0cmljdEVxdWFsKFxuICogICBwaXBlKFxuICogICAgIG5vbmUsXG4gKiAgICAgZ2V0T3JFbHNlKCgpID0+IDApXG4gKiAgICksXG4gKiAgIDBcbiAqIClcbiAqXG4gKiBAY2F0ZWdvcnkgZXJyb3IgaGFuZGxpbmdcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIGdldE9yRWxzZSA9IGdldE9yRWxzZVc7XG4vKipcbiAqIEBjYXRlZ29yeSBtYXBwaW5nXG4gKiBAc2luY2UgMi4xMC4wXG4gKi9cbmV4cG9ydCB2YXIgZmxhcCA9IC8qI19fUFVSRV9fKi8gZmxhcF8oRnVuY3Rvcik7XG4vKipcbiAqIENvbWJpbmUgdHdvIGVmZmVjdGZ1bCBhY3Rpb25zLCBrZWVwaW5nIG9ubHkgdGhlIHJlc3VsdCBvZiB0aGUgZmlyc3QuXG4gKlxuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgYXBGaXJzdCA9IC8qI19fUFVSRV9fKi8gYXBGaXJzdF8oQXBwbHkpO1xuLyoqXG4gKiBDb21iaW5lIHR3byBlZmZlY3RmdWwgYWN0aW9ucywga2VlcGluZyBvbmx5IHRoZSByZXN1bHQgb2YgdGhlIHNlY29uZC5cbiAqXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciBhcFNlY29uZCA9IC8qI19fUFVSRV9fKi8gYXBTZWNvbmRfKEFwcGx5KTtcbi8qKlxuICogQGNhdGVnb3J5IHNlcXVlbmNpbmdcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIGZsYXR0ZW4gPSBjb21wYWN0O1xuLyoqXG4gKiBDb21wb3NlcyBjb21wdXRhdGlvbnMgaW4gc2VxdWVuY2UsIHVzaW5nIHRoZSByZXR1cm4gdmFsdWUgb2Ygb25lIGNvbXB1dGF0aW9uIHRvIGRldGVybWluZSB0aGUgbmV4dCBjb21wdXRhdGlvbiBhbmRcbiAqIGtlZXBpbmcgb25seSB0aGUgcmVzdWx0IG9mIHRoZSBmaXJzdC5cbiAqXG4gKiBAY2F0ZWdvcnkgY29tYmluYXRvcnNcbiAqIEBzaW5jZSAyLjE1LjBcbiAqL1xuZXhwb3J0IHZhciB0YXAgPSAvKiNfX1BVUkVfXyovIGR1YWwoMiwgY2hhaW5hYmxlLnRhcChDaGFpbikpO1xuLyoqXG4gKiBDb21wb3NlcyBjb21wdXRhdGlvbnMgaW4gc2VxdWVuY2UsIHVzaW5nIHRoZSByZXR1cm4gdmFsdWUgb2Ygb25lIGNvbXB1dGF0aW9uIHRvIGRldGVybWluZSB0aGUgbmV4dCBjb21wdXRhdGlvbiBhbmRcbiAqIGtlZXBpbmcgb25seSB0aGUgcmVzdWx0IG9mIHRoZSBmaXJzdC5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgcGlwZSB9IGZyb20gJ2ZwLXRzL2Z1bmN0aW9uJ1xuICogaW1wb3J0ICogYXMgTyBmcm9tICdmcC10cy9PcHRpb24nXG4gKiBpbXBvcnQgKiBhcyBFIGZyb20gJ2ZwLXRzL0VpdGhlcidcbiAqXG4gKiBjb25zdCBjb21wdXRlID0gKHZhbHVlOiBudW1iZXIpID0+IHBpcGUoXG4gKiAgIE8ub2YodmFsdWUpLFxuICogICBPLnRhcEVpdGhlcigodmFsdWUpID0+IHZhbHVlID4gMCA/IEUucmlnaHQoJ29rJykgOiBFLmxlZnQoJ2Vycm9yJykpLFxuICogKVxuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoY29tcHV0ZSgxKSwgTy5vZigxKSlcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoY29tcHV0ZSgtNDIpLCBPLm5vbmUpXG4gKlxuICogQGNhdGVnb3J5IGNvbWJpbmF0b3JzXG4gKiBAc2luY2UgMi4xNi4wXG4gKi9cbmV4cG9ydCB2YXIgdGFwRWl0aGVyID0gLyojX19QVVJFX18qLyBkdWFsKDIsIHRhcEVpdGhlcl8oRnJvbUVpdGhlciwgQ2hhaW4pKTtcbi8qKlxuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgZHVwbGljYXRlID0gLyojX19QVVJFX18qLyBleHRlbmQoaWRlbnRpdHkpO1xuLyoqXG4gKiBAY2F0ZWdvcnkgbGlmdGluZ1xuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIGZyb21FaXRoZXJLID0gLyojX19QVVJFX18qLyBmcm9tRWl0aGVyS18oRnJvbUVpdGhlcik7XG4vKipcbiAqIEBjYXRlZ29yeSBzZXF1ZW5jaW5nXG4gKiBAc2luY2UgMi4xMS4wXG4gKi9cbmV4cG9ydCB2YXIgY2hhaW5FaXRoZXJLID0gXG4vKiNfX1BVUkVfXyovIGNoYWluRWl0aGVyS18oRnJvbUVpdGhlciwgQ2hhaW4pO1xuLyoqXG4gKiBBbGlhcyBvZiBgdGFwRWl0aGVyYC5cbiAqXG4gKiBAY2F0ZWdvcnkgbGVnYWN5XG4gKiBAc2luY2UgMi4xMi4wXG4gKi9cbmV4cG9ydCB2YXIgY2hhaW5GaXJzdEVpdGhlcksgPSB0YXBFaXRoZXI7XG4vKipcbiAqIENvbnN0cnVjdHMgYSBuZXcgYE9wdGlvbmAgZnJvbSBhIG51bGxhYmxlIHR5cGUuIElmIHRoZSB2YWx1ZSBpcyBgbnVsbGAgb3IgYHVuZGVmaW5lZGAsIHJldHVybnMgYE5vbmVgLCBvdGhlcndpc2VcbiAqIHJldHVybnMgdGhlIHZhbHVlIHdyYXBwZWQgaW4gYSBgU29tZWAuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IG5vbmUsIHNvbWUsIGZyb21OdWxsYWJsZSB9IGZyb20gJ2ZwLXRzL09wdGlvbidcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKGZyb21OdWxsYWJsZSh1bmRlZmluZWQpLCBub25lKVxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChmcm9tTnVsbGFibGUobnVsbCksIG5vbmUpXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKGZyb21OdWxsYWJsZSgxKSwgc29tZSgxKSlcbiAqXG4gKiBAY2F0ZWdvcnkgY29udmVyc2lvbnNcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIGZyb21OdWxsYWJsZSA9IGZ1bmN0aW9uIChhKSB7IHJldHVybiAoYSA9PSBudWxsID8gbm9uZSA6IHNvbWUoYSkpOyB9O1xuLyoqXG4gKiBUcmFuc2Zvcm1zIGFuIGV4Y2VwdGlvbiBpbnRvIGFuIGBPcHRpb25gLiBJZiBgZmAgdGhyb3dzLCByZXR1cm5zIGBOb25lYCwgb3RoZXJ3aXNlIHJldHVybnMgdGhlIG91dHB1dCB3cmFwcGVkIGluIGFcbiAqIGBTb21lYC5cbiAqXG4gKiBTZWUgYWxzbyBbYHRyeUNhdGNoS2BdKCN0cnljYXRjaGspLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBub25lLCBzb21lLCB0cnlDYXRjaCB9IGZyb20gJ2ZwLXRzL09wdGlvbidcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKFxuICogICB0cnlDYXRjaCgoKSA9PiB7XG4gKiAgICAgdGhyb3cgbmV3IEVycm9yKClcbiAqICAgfSksXG4gKiAgIG5vbmVcbiAqIClcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwodHJ5Q2F0Y2goKCkgPT4gMSksIHNvbWUoMSkpXG4gKlxuICogQGNhdGVnb3J5IGludGVyb3BcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIHRyeUNhdGNoID0gZnVuY3Rpb24gKGYpIHtcbiAgICB0cnkge1xuICAgICAgICByZXR1cm4gc29tZShmKCkpO1xuICAgIH1cbiAgICBjYXRjaCAoZSkge1xuICAgICAgICByZXR1cm4gbm9uZTtcbiAgICB9XG59O1xuLyoqXG4gKiBDb252ZXJ0cyBhIGZ1bmN0aW9uIHRoYXQgbWF5IHRocm93IHRvIG9uZSByZXR1cm5pbmcgYSBgT3B0aW9uYC5cbiAqXG4gKiBAY2F0ZWdvcnkgaW50ZXJvcFxuICogQHNpbmNlIDIuMTAuMFxuICovXG5leHBvcnQgdmFyIHRyeUNhdGNoSyA9IGZ1bmN0aW9uIChmKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIGEgPSBbXTtcbiAgICAgICAgZm9yICh2YXIgX2kgPSAwOyBfaSA8IGFyZ3VtZW50cy5sZW5ndGg7IF9pKyspIHtcbiAgICAgICAgICAgIGFbX2ldID0gYXJndW1lbnRzW19pXTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdHJ5Q2F0Y2goZnVuY3Rpb24gKCkgeyByZXR1cm4gZi5hcHBseSh2b2lkIDAsIGEpOyB9KTtcbiAgICB9O1xufTtcbi8qKlxuICogUmV0dXJucyBhICpzbWFydCBjb25zdHJ1Y3RvciogZnJvbSBhIGZ1bmN0aW9uIHRoYXQgcmV0dXJucyBhIG51bGxhYmxlIHZhbHVlLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBmcm9tTnVsbGFibGVLLCBub25lLCBzb21lIH0gZnJvbSAnZnAtdHMvT3B0aW9uJ1xuICpcbiAqIGNvbnN0IGYgPSAoczogc3RyaW5nKTogbnVtYmVyIHwgdW5kZWZpbmVkID0+IHtcbiAqICAgY29uc3QgbiA9IHBhcnNlRmxvYXQocylcbiAqICAgcmV0dXJuIGlzTmFOKG4pID8gdW5kZWZpbmVkIDogblxuICogfVxuICpcbiAqIGNvbnN0IGcgPSBmcm9tTnVsbGFibGVLKGYpXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChnKCcxJyksIHNvbWUoMSkpXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKGcoJ2EnKSwgbm9uZSlcbiAqXG4gKiBAY2F0ZWdvcnkgbGlmdGluZ1xuICogQHNpbmNlIDIuOS4wXG4gKi9cbmV4cG9ydCB2YXIgZnJvbU51bGxhYmxlSyA9IGZ1bmN0aW9uIChmKSB7IHJldHVybiBmbG93KGYsIGZyb21OdWxsYWJsZSk7IH07XG4vKipcbiAqIFRoaXMgaXMgYGNoYWluYCArIGBmcm9tTnVsbGFibGVgLCB1c2VmdWwgd2hlbiB3b3JraW5nIHdpdGggb3B0aW9uYWwgdmFsdWVzLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBzb21lLCBub25lLCBmcm9tTnVsbGFibGUsIGNoYWluTnVsbGFibGVLIH0gZnJvbSAnZnAtdHMvT3B0aW9uJ1xuICogaW1wb3J0IHsgcGlwZSB9IGZyb20gJ2ZwLXRzL2Z1bmN0aW9uJ1xuICpcbiAqIGludGVyZmFjZSBFbXBsb3llZSB7XG4gKiAgIHJlYWRvbmx5IGNvbXBhbnk/OiB7XG4gKiAgICAgcmVhZG9ubHkgYWRkcmVzcz86IHtcbiAqICAgICAgIHJlYWRvbmx5IHN0cmVldD86IHtcbiAqICAgICAgICAgcmVhZG9ubHkgbmFtZT86IHN0cmluZ1xuICogICAgICAgfVxuICogICAgIH1cbiAqICAgfVxuICogfVxuICpcbiAqIGNvbnN0IGVtcGxveWVlMTogRW1wbG95ZWUgPSB7IGNvbXBhbnk6IHsgYWRkcmVzczogeyBzdHJlZXQ6IHsgbmFtZTogJ2hpZ2ggc3RyZWV0JyB9IH0gfSB9XG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChcbiAqICAgcGlwZShcbiAqICAgICBmcm9tTnVsbGFibGUoZW1wbG95ZWUxLmNvbXBhbnkpLFxuICogICAgIGNoYWluTnVsbGFibGVLKGNvbXBhbnkgPT4gY29tcGFueS5hZGRyZXNzKSxcbiAqICAgICBjaGFpbk51bGxhYmxlSyhhZGRyZXNzID0+IGFkZHJlc3Muc3RyZWV0KSxcbiAqICAgICBjaGFpbk51bGxhYmxlSyhzdHJlZXQgPT4gc3RyZWV0Lm5hbWUpXG4gKiAgICksXG4gKiAgIHNvbWUoJ2hpZ2ggc3RyZWV0JylcbiAqIClcbiAqXG4gKiBjb25zdCBlbXBsb3llZTI6IEVtcGxveWVlID0geyBjb21wYW55OiB7IGFkZHJlc3M6IHsgc3RyZWV0OiB7fSB9IH0gfVxuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoXG4gKiAgIHBpcGUoXG4gKiAgICAgZnJvbU51bGxhYmxlKGVtcGxveWVlMi5jb21wYW55KSxcbiAqICAgICBjaGFpbk51bGxhYmxlSyhjb21wYW55ID0+IGNvbXBhbnkuYWRkcmVzcyksXG4gKiAgICAgY2hhaW5OdWxsYWJsZUsoYWRkcmVzcyA9PiBhZGRyZXNzLnN0cmVldCksXG4gKiAgICAgY2hhaW5OdWxsYWJsZUsoc3RyZWV0ID0+IHN0cmVldC5uYW1lKVxuICogICApLFxuICogICBub25lXG4gKiApXG4gKlxuICogQGNhdGVnb3J5IHNlcXVlbmNpbmdcbiAqIEBzaW5jZSAyLjkuMFxuICovXG5leHBvcnQgdmFyIGNoYWluTnVsbGFibGVLID0gZnVuY3Rpb24gKGYpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKG1hKSB7XG4gICAgICAgIHJldHVybiBpc05vbmUobWEpID8gbm9uZSA6IGZyb21OdWxsYWJsZShmKG1hLnZhbHVlKSk7XG4gICAgfTtcbn07XG4vKipcbiAqIEV4dHJhY3RzIHRoZSB2YWx1ZSBvdXQgb2YgdGhlIHN0cnVjdHVyZSwgaWYgaXQgZXhpc3RzLiBPdGhlcndpc2UgcmV0dXJucyBgbnVsbGAuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IHNvbWUsIG5vbmUsIHRvTnVsbGFibGUgfSBmcm9tICdmcC10cy9PcHRpb24nXG4gKiBpbXBvcnQgeyBwaXBlIH0gZnJvbSAnZnAtdHMvZnVuY3Rpb24nXG4gKlxuICogYXNzZXJ0LnN0cmljdEVxdWFsKFxuICogICBwaXBlKFxuICogICAgIHNvbWUoMSksXG4gKiAgICAgdG9OdWxsYWJsZVxuICogICApLFxuICogICAxXG4gKiApXG4gKiBhc3NlcnQuc3RyaWN0RXF1YWwoXG4gKiAgIHBpcGUoXG4gKiAgICAgbm9uZSxcbiAqICAgICB0b051bGxhYmxlXG4gKiAgICksXG4gKiAgIG51bGxcbiAqIClcbiAqXG4gKiBAY2F0ZWdvcnkgY29udmVyc2lvbnNcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIHRvTnVsbGFibGUgPSAvKiNfX1BVUkVfXyovIG1hdGNoKGNvbnN0TnVsbCwgaWRlbnRpdHkpO1xuLyoqXG4gKiBFeHRyYWN0cyB0aGUgdmFsdWUgb3V0IG9mIHRoZSBzdHJ1Y3R1cmUsIGlmIGl0IGV4aXN0cy4gT3RoZXJ3aXNlIHJldHVybnMgYHVuZGVmaW5lZGAuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IHNvbWUsIG5vbmUsIHRvVW5kZWZpbmVkIH0gZnJvbSAnZnAtdHMvT3B0aW9uJ1xuICogaW1wb3J0IHsgcGlwZSB9IGZyb20gJ2ZwLXRzL2Z1bmN0aW9uJ1xuICpcbiAqIGFzc2VydC5zdHJpY3RFcXVhbChcbiAqICAgcGlwZShcbiAqICAgICBzb21lKDEpLFxuICogICAgIHRvVW5kZWZpbmVkXG4gKiAgICksXG4gKiAgIDFcbiAqIClcbiAqIGFzc2VydC5zdHJpY3RFcXVhbChcbiAqICAgcGlwZShcbiAqICAgICBub25lLFxuICogICAgIHRvVW5kZWZpbmVkXG4gKiAgICksXG4gKiAgIHVuZGVmaW5lZFxuICogKVxuICpcbiAqIEBjYXRlZ29yeSBjb252ZXJzaW9uc1xuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgdG9VbmRlZmluZWQgPSAvKiNfX1BVUkVfXyovIG1hdGNoKGNvbnN0VW5kZWZpbmVkLCBpZGVudGl0eSk7XG5leHBvcnQgZnVuY3Rpb24gZWxlbShFKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhLCBtYSkge1xuICAgICAgICBpZiAobWEgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgdmFyIGVsZW1FXzEgPSBlbGVtKEUpO1xuICAgICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIChtYSkgeyByZXR1cm4gZWxlbUVfMShhLCBtYSk7IH07XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGlzTm9uZShtYSkgPyBmYWxzZSA6IEUuZXF1YWxzKGEsIG1hLnZhbHVlKTtcbiAgICB9O1xufVxuLyoqXG4gKiBSZXR1cm5zIGB0cnVlYCBpZiB0aGUgcHJlZGljYXRlIGlzIHNhdGlzZmllZCBieSB0aGUgd3JhcHBlZCB2YWx1ZVxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBzb21lLCBub25lLCBleGlzdHMgfSBmcm9tICdmcC10cy9PcHRpb24nXG4gKiBpbXBvcnQgeyBwaXBlIH0gZnJvbSAnZnAtdHMvZnVuY3Rpb24nXG4gKlxuICogYXNzZXJ0LnN0cmljdEVxdWFsKFxuICogICBwaXBlKFxuICogICAgIHNvbWUoMSksXG4gKiAgICAgZXhpc3RzKG4gPT4gbiA+IDApXG4gKiAgICksXG4gKiAgIHRydWVcbiAqIClcbiAqIGFzc2VydC5zdHJpY3RFcXVhbChcbiAqICAgcGlwZShcbiAqICAgICBzb21lKDEpLFxuICogICAgIGV4aXN0cyhuID0+IG4gPiAxKVxuICogICApLFxuICogICBmYWxzZVxuICogKVxuICogYXNzZXJ0LnN0cmljdEVxdWFsKFxuICogICBwaXBlKFxuICogICAgIG5vbmUsXG4gKiAgICAgZXhpc3RzKG4gPT4gbiA+IDApXG4gKiAgICksXG4gKiAgIGZhbHNlXG4gKiApXG4gKlxuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgZXhpc3RzID0gZnVuY3Rpb24gKHByZWRpY2F0ZSkge1xuICAgIHJldHVybiBmdW5jdGlvbiAobWEpIHtcbiAgICAgICAgcmV0dXJuIGlzTm9uZShtYSkgPyBmYWxzZSA6IHByZWRpY2F0ZShtYS52YWx1ZSk7XG4gICAgfTtcbn07XG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vLyBkbyBub3RhdGlvblxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLyoqXG4gKiBAY2F0ZWdvcnkgZG8gbm90YXRpb25cbiAqIEBzaW5jZSAyLjkuMFxuICovXG5leHBvcnQgdmFyIERvID0gLyojX19QVVJFX18qLyBvZihfLmVtcHR5UmVjb3JkKTtcbi8qKlxuICogQGNhdGVnb3J5IGRvIG5vdGF0aW9uXG4gKiBAc2luY2UgMi44LjBcbiAqL1xuZXhwb3J0IHZhciBiaW5kVG8gPSAvKiNfX1BVUkVfXyovIGJpbmRUb18oRnVuY3Rvcik7XG52YXIgbGV0XyA9IC8qI19fUFVSRV9fKi8gbGV0X18oRnVuY3Rvcik7XG5leHBvcnQgeyBcbi8qKlxuICogQGNhdGVnb3J5IGRvIG5vdGF0aW9uXG4gKiBAc2luY2UgMi4xMy4wXG4gKi9cbmxldF8gYXMgbGV0IH07XG4vKipcbiAqIEBjYXRlZ29yeSBkbyBub3RhdGlvblxuICogQHNpbmNlIDIuOC4wXG4gKi9cbmV4cG9ydCB2YXIgYmluZCA9IC8qI19fUFVSRV9fKi8gY2hhaW5hYmxlLmJpbmQoQ2hhaW4pO1xuLyoqXG4gKiBAY2F0ZWdvcnkgZG8gbm90YXRpb25cbiAqIEBzaW5jZSAyLjguMFxuICovXG5leHBvcnQgdmFyIGFwUyA9IC8qI19fUFVSRV9fKi8gYXBTXyhBcHBseSk7XG4vKipcbiAqIEBzaW5jZSAyLjExLjBcbiAqL1xuZXhwb3J0IHZhciBBcFQgPSAvKiNfX1BVUkVfXyovIG9mKF8uZW1wdHlSZWFkb25seUFycmF5KTtcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8vIGFycmF5IHV0aWxzXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vKipcbiAqIEVxdWl2YWxlbnQgdG8gYFJlYWRvbmx5Tm9uRW1wdHlBcnJheSN0cmF2ZXJzZVdpdGhJbmRleChBcHBsaWNhdGl2ZSlgLlxuICpcbiAqIEBjYXRlZ29yeSB0cmF2ZXJzaW5nXG4gKiBAc2luY2UgMi4xMS4wXG4gKi9cbmV4cG9ydCB2YXIgdHJhdmVyc2VSZWFkb25seU5vbkVtcHR5QXJyYXlXaXRoSW5kZXggPSBmdW5jdGlvbiAoZikge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgdmFyIG8gPSBmKDAsIF8uaGVhZChhcykpO1xuICAgICAgICBpZiAoaXNOb25lKG8pKSB7XG4gICAgICAgICAgICByZXR1cm4gbm9uZTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgb3V0ID0gW28udmFsdWVdO1xuICAgICAgICBmb3IgKHZhciBpID0gMTsgaSA8IGFzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICB2YXIgb18xID0gZihpLCBhc1tpXSk7XG4gICAgICAgICAgICBpZiAoaXNOb25lKG9fMSkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gbm9uZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIG91dC5wdXNoKG9fMS52YWx1ZSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHNvbWUob3V0KTtcbiAgICB9O1xufTtcbi8qKlxuICogRXF1aXZhbGVudCB0byBgUmVhZG9ubHlBcnJheSN0cmF2ZXJzZVdpdGhJbmRleChBcHBsaWNhdGl2ZSlgLlxuICpcbiAqIEBjYXRlZ29yeSB0cmF2ZXJzaW5nXG4gKiBAc2luY2UgMi4xMS4wXG4gKi9cbmV4cG9ydCB2YXIgdHJhdmVyc2VSZWFkb25seUFycmF5V2l0aEluZGV4ID0gZnVuY3Rpb24gKGYpIHtcbiAgICB2YXIgZyA9IHRyYXZlcnNlUmVhZG9ubHlOb25FbXB0eUFycmF5V2l0aEluZGV4KGYpO1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHsgcmV0dXJuIChfLmlzTm9uRW1wdHkoYXMpID8gZyhhcykgOiBBcFQpOyB9O1xufTtcbi8qKlxuICogRXF1aXZhbGVudCB0byBgUmVhZG9ubHlBcnJheSN0cmF2ZXJzZVdpdGhJbmRleChBcHBsaWNhdGl2ZSlgLlxuICpcbiAqIEBjYXRlZ29yeSB0cmF2ZXJzaW5nXG4gKiBAc2luY2UgMi45LjBcbiAqL1xuZXhwb3J0IHZhciB0cmF2ZXJzZUFycmF5V2l0aEluZGV4ID0gdHJhdmVyc2VSZWFkb25seUFycmF5V2l0aEluZGV4O1xuLyoqXG4gKiBFcXVpdmFsZW50IHRvIGBSZWFkb25seUFycmF5I3RyYXZlcnNlKEFwcGxpY2F0aXZlKWAuXG4gKlxuICogQGNhdGVnb3J5IHRyYXZlcnNpbmdcbiAqIEBzaW5jZSAyLjkuMFxuICovXG5leHBvcnQgdmFyIHRyYXZlcnNlQXJyYXkgPSBmdW5jdGlvbiAoZikge1xuICAgIHJldHVybiB0cmF2ZXJzZVJlYWRvbmx5QXJyYXlXaXRoSW5kZXgoZnVuY3Rpb24gKF8sIGEpIHsgcmV0dXJuIGYoYSk7IH0pO1xufTtcbi8qKlxuICogRXF1aXZhbGVudCB0byBgUmVhZG9ubHlBcnJheSNzZXF1ZW5jZShBcHBsaWNhdGl2ZSlgLlxuICpcbiAqIEBjYXRlZ29yeSB0cmF2ZXJzaW5nXG4gKiBAc2luY2UgMi45LjBcbiAqL1xuZXhwb3J0IHZhciBzZXF1ZW5jZUFycmF5ID0gXG4vKiNfX1BVUkVfXyovIHRyYXZlcnNlQXJyYXkoaWRlbnRpdHkpO1xuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLy8gbGVnYWN5XG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vKipcbiAqIEFsaWFzIG9mIGBmbGF0TWFwYC5cbiAqXG4gKiBAY2F0ZWdvcnkgbGVnYWN5XG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciBjaGFpbiA9IGZsYXRNYXA7XG4vKipcbiAqIEFsaWFzIG9mIGB0YXBgLlxuICpcbiAqIEBjYXRlZ29yeSBsZWdhY3lcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIGNoYWluRmlyc3QgPSB0YXA7XG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vLyBkZXByZWNhdGVkXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vKipcbiAqIFVzZSBgUmVmaW5lbWVudGAgbW9kdWxlIGluc3RlYWQuXG4gKlxuICogQGNhdGVnb3J5IHpvbmUgb2YgZGVhdGhcbiAqIEBzaW5jZSAyLjAuMFxuICogQGRlcHJlY2F0ZWRcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGdldFJlZmluZW1lbnQoZ2V0T3B0aW9uKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhKSB7IHJldHVybiBpc1NvbWUoZ2V0T3B0aW9uKGEpKTsgfTtcbn1cbi8qKlxuICogVXNlIFtgY2hhaW5OdWxsYWJsZUtgXSgjY2hhaW5udWxsYWJsZWspIGluc3RlYWQuXG4gKlxuICogQGNhdGVnb3J5IHpvbmUgb2YgZGVhdGhcbiAqIEBzaW5jZSAyLjAuMFxuICogQGRlcHJlY2F0ZWRcbiAqL1xuZXhwb3J0IHZhciBtYXBOdWxsYWJsZSA9IGNoYWluTnVsbGFibGVLO1xuLyoqXG4gKiBUaGlzIGluc3RhbmNlIGlzIGRlcHJlY2F0ZWQsIHVzZSBzbWFsbCwgc3BlY2lmaWMgaW5zdGFuY2VzIGluc3RlYWQuXG4gKiBGb3IgZXhhbXBsZSBpZiBhIGZ1bmN0aW9uIG5lZWRzIGEgYEZ1bmN0b3JgIGluc3RhbmNlLCBwYXNzIGBPLkZ1bmN0b3JgIGluc3RlYWQgb2YgYE8ub3B0aW9uYFxuICogKHdoZXJlIGBPYCBpcyBmcm9tIGBpbXBvcnQgTyBmcm9tICdmcC10cy9PcHRpb24nYClcbiAqXG4gKiBAY2F0ZWdvcnkgem9uZSBvZiBkZWF0aFxuICogQHNpbmNlIDIuMC4wXG4gKiBAZGVwcmVjYXRlZFxuICovXG5leHBvcnQgdmFyIG9wdGlvbiA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICBtYXA6IF9tYXAsXG4gICAgb2Y6IG9mLFxuICAgIGFwOiBfYXAsXG4gICAgY2hhaW46IGZsYXRNYXAsXG4gICAgcmVkdWNlOiBfcmVkdWNlLFxuICAgIGZvbGRNYXA6IF9mb2xkTWFwLFxuICAgIHJlZHVjZVJpZ2h0OiBfcmVkdWNlUmlnaHQsXG4gICAgdHJhdmVyc2U6IF90cmF2ZXJzZSxcbiAgICBzZXF1ZW5jZTogc2VxdWVuY2UsXG4gICAgemVybzogemVybyxcbiAgICBhbHQ6IF9hbHQsXG4gICAgZXh0ZW5kOiBfZXh0ZW5kLFxuICAgIGNvbXBhY3Q6IGNvbXBhY3QsXG4gICAgc2VwYXJhdGU6IHNlcGFyYXRlLFxuICAgIGZpbHRlcjogX2ZpbHRlcixcbiAgICBmaWx0ZXJNYXA6IF9maWx0ZXJNYXAsXG4gICAgcGFydGl0aW9uOiBfcGFydGl0aW9uLFxuICAgIHBhcnRpdGlvbk1hcDogX3BhcnRpdGlvbk1hcCxcbiAgICB3aXRoZXI6IF93aXRoZXIsXG4gICAgd2lsdDogX3dpbHQsXG4gICAgdGhyb3dFcnJvcjogdGhyb3dFcnJvclxufTtcbi8qKlxuICogVXNlIFtgZ2V0QXBwbHlTZW1pZ3JvdXBgXSguL0FwcGx5LnRzLmh0bWwjZ2V0YXBwbHlzZW1pZ3JvdXApIGluc3RlYWQuXG4gKlxuICogQGNhdGVnb3J5IHpvbmUgb2YgZGVhdGhcbiAqIEBzaW5jZSAyLjAuMFxuICogQGRlcHJlY2F0ZWRcbiAqL1xuZXhwb3J0IHZhciBnZXRBcHBseVNlbWlncm91cCA9IC8qI19fUFVSRV9fKi8gZ2V0QXBwbHlTZW1pZ3JvdXBfKEFwcGx5KTtcbi8qKlxuICogVXNlIFtgZ2V0QXBwbGljYXRpdmVNb25vaWRgXSguL0FwcGxpY2F0aXZlLnRzLmh0bWwjZ2V0YXBwbGljYXRpdmVtb25vaWQpIGluc3RlYWQuXG4gKlxuICogQGNhdGVnb3J5IHpvbmUgb2YgZGVhdGhcbiAqIEBzaW5jZSAyLjAuMFxuICogQGRlcHJlY2F0ZWRcbiAqL1xuZXhwb3J0IHZhciBnZXRBcHBseU1vbm9pZCA9IC8qI19fUFVSRV9fKi8gZ2V0QXBwbGljYXRpdmVNb25vaWQoQXBwbGljYXRpdmUpO1xuLyoqXG4gKiBVc2VcbiAqXG4gKiBgYGB0c1xuICogaW1wb3J0IHsgZmlyc3QgfSBmcm9tICdmcC10cy9TZW1pZ3JvdXAnXG4gKiBpbXBvcnQgeyBnZXRNb25vaWQgfSBmcm9tICdmcC10cy9PcHRpb24nXG4gKlxuICogZ2V0TW9ub2lkKGZpcnN0KCkpXG4gKiBgYGBcbiAqXG4gKiBpbnN0ZWFkLlxuICpcbiAqIE1vbm9pZCByZXR1cm5pbmcgdGhlIGxlZnQtbW9zdCBub24tYE5vbmVgIHZhbHVlXG4gKlxuICogfCB4ICAgICAgIHwgeSAgICAgICB8IGNvbmNhdCh4LCB5KSB8XG4gKiB8IC0tLS0tLS0gfCAtLS0tLS0tIHwgLS0tLS0tLS0tLS0tIHxcbiAqIHwgbm9uZSAgICB8IG5vbmUgICAgfCBub25lICAgICAgICAgfFxuICogfCBzb21lKGEpIHwgbm9uZSAgICB8IHNvbWUoYSkgICAgICB8XG4gKiB8IG5vbmUgICAgfCBzb21lKGIpIHwgc29tZShiKSAgICAgIHxcbiAqIHwgc29tZShhKSB8IHNvbWUoYikgfCBzb21lKGEpICAgICAgfFxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBnZXRGaXJzdE1vbm9pZCwgc29tZSwgbm9uZSB9IGZyb20gJ2ZwLXRzL09wdGlvbidcbiAqXG4gKiBjb25zdCBNID0gZ2V0Rmlyc3RNb25vaWQ8bnVtYmVyPigpXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKE0uY29uY2F0KG5vbmUsIG5vbmUpLCBub25lKVxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChNLmNvbmNhdChzb21lKDEpLCBub25lKSwgc29tZSgxKSlcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoTS5jb25jYXQobm9uZSwgc29tZSgyKSksIHNvbWUoMikpXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKE0uY29uY2F0KHNvbWUoMSksIHNvbWUoMikpLCBzb21lKDEpKVxuICpcbiAqIEBjYXRlZ29yeSB6b25lIG9mIGRlYXRoXG4gKiBAc2luY2UgMi4wLjBcbiAqIEBkZXByZWNhdGVkXG4gKi9cbmV4cG9ydCB2YXIgZ2V0Rmlyc3RNb25vaWQgPSBmdW5jdGlvbiAoKSB7IHJldHVybiBnZXRNb25vaWQoZmlyc3QoKSk7IH07XG4vKipcbiAqIFVzZVxuICpcbiAqIGBgYHRzXG4gKiBpbXBvcnQgeyBsYXN0IH0gZnJvbSAnZnAtdHMvU2VtaWdyb3VwJ1xuICogaW1wb3J0IHsgZ2V0TW9ub2lkIH0gZnJvbSAnZnAtdHMvT3B0aW9uJ1xuICpcbiAqIGdldE1vbm9pZChsYXN0KCkpXG4gKiBgYGBcbiAqXG4gKiBpbnN0ZWFkLlxuICpcbiAqIE1vbm9pZCByZXR1cm5pbmcgdGhlIHJpZ2h0LW1vc3Qgbm9uLWBOb25lYCB2YWx1ZVxuICpcbiAqIHwgeCAgICAgICB8IHkgICAgICAgfCBjb25jYXQoeCwgeSkgfFxuICogfCAtLS0tLS0tIHwgLS0tLS0tLSB8IC0tLS0tLS0tLS0tLSB8XG4gKiB8IG5vbmUgICAgfCBub25lICAgIHwgbm9uZSAgICAgICAgIHxcbiAqIHwgc29tZShhKSB8IG5vbmUgICAgfCBzb21lKGEpICAgICAgfFxuICogfCBub25lICAgIHwgc29tZShiKSB8IHNvbWUoYikgICAgICB8XG4gKiB8IHNvbWUoYSkgfCBzb21lKGIpIHwgc29tZShiKSAgICAgIHxcbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgZ2V0TGFzdE1vbm9pZCwgc29tZSwgbm9uZSB9IGZyb20gJ2ZwLXRzL09wdGlvbidcbiAqXG4gKiBjb25zdCBNID0gZ2V0TGFzdE1vbm9pZDxudW1iZXI+KClcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoTS5jb25jYXQobm9uZSwgbm9uZSksIG5vbmUpXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKE0uY29uY2F0KHNvbWUoMSksIG5vbmUpLCBzb21lKDEpKVxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChNLmNvbmNhdChub25lLCBzb21lKDIpKSwgc29tZSgyKSlcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoTS5jb25jYXQoc29tZSgxKSwgc29tZSgyKSksIHNvbWUoMikpXG4gKlxuICogQGNhdGVnb3J5IHpvbmUgb2YgZGVhdGhcbiAqIEBzaW5jZSAyLjAuMFxuICogQGRlcHJlY2F0ZWRcbiAqL1xuZXhwb3J0IHZhciBnZXRMYXN0TW9ub2lkID0gZnVuY3Rpb24gKCkgeyByZXR1cm4gZ2V0TW9ub2lkKGxhc3QoKSk7IH07XG4iLAogICJpbXBvcnQgeyBnZXRBcHBsaWNhdGl2ZU1vbm9pZCB9IGZyb20gJy4vQXBwbGljYXRpdmUnO1xuaW1wb3J0IHsgYXBGaXJzdCBhcyBhcEZpcnN0XywgYXBTIGFzIGFwU18sIGFwU2Vjb25kIGFzIGFwU2Vjb25kXywgZ2V0QXBwbHlTZW1pZ3JvdXAgYXMgZ2V0QXBwbHlTZW1pZ3JvdXBfIH0gZnJvbSAnLi9BcHBseSc7XG5pbXBvcnQgKiBhcyBjaGFpbmFibGUgZnJvbSAnLi9DaGFpbic7XG5pbXBvcnQgeyBjaGFpbkVpdGhlcksgYXMgY2hhaW5FaXRoZXJLXywgZnJvbUVpdGhlcksgYXMgZnJvbUVpdGhlcktfLCB0YXBFaXRoZXIgYXMgdGFwRWl0aGVyXyB9IGZyb20gJy4vRnJvbUVpdGhlcic7XG5pbXBvcnQgeyBjb25zdE51bGwsIGNvbnN0VW5kZWZpbmVkLCBkdWFsLCBmbG93LCBpZGVudGl0eSwgcGlwZSB9IGZyb20gJy4vZnVuY3Rpb24nO1xuaW1wb3J0IHsgYXMgYXMgYXNfLCBhc1VuaXQgYXMgYXNVbml0XywgYmluZFRvIGFzIGJpbmRUb18sIGZsYXAgYXMgZmxhcF8sIGxldCBhcyBsZXRfXyB9IGZyb20gJy4vRnVuY3Rvcic7XG5pbXBvcnQgKiBhcyBfIGZyb20gJy4vaW50ZXJuYWwnO1xuaW1wb3J0IHsgbm90IH0gZnJvbSAnLi9QcmVkaWNhdGUnO1xuaW1wb3J0IHsgZmlyc3QsIGxhc3QgfSBmcm9tICcuL1NlbWlncm91cCc7XG5pbXBvcnQgeyBzZXBhcmF0ZWQgfSBmcm9tICcuL1NlcGFyYXRlZCc7XG5pbXBvcnQgeyB3aWx0RGVmYXVsdCwgd2l0aGVyRGVmYXVsdCB9IGZyb20gJy4vV2l0aGVyYWJsZSc7XG5pbXBvcnQgeyBndWFyZCBhcyBndWFyZF8gfSBmcm9tICcuL1plcm8nO1xuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLy8gY29uc3RydWN0b3JzXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vKipcbiAqIGBOb25lYCBkb2Vzbid0IGhhdmUgYSBjb25zdHJ1Y3RvciwgaW5zdGVhZCB5b3UgY2FuIHVzZSBpdCBkaXJlY3RseSBhcyBhIHZhbHVlLiBSZXByZXNlbnRzIGEgbWlzc2luZyB2YWx1ZS5cbiAqXG4gKiBAY2F0ZWdvcnkgY29uc3RydWN0b3JzXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciBub25lID0gXy5ub25lO1xuLyoqXG4gKiBDb25zdHJ1Y3RzIGEgYFNvbWVgLiBSZXByZXNlbnRzIGFuIG9wdGlvbmFsIHZhbHVlIHRoYXQgZXhpc3RzLlxuICpcbiAqIEBjYXRlZ29yeSBjb25zdHJ1Y3RvcnNcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIHNvbWUgPSBfLnNvbWU7XG5leHBvcnQgZnVuY3Rpb24gZnJvbVByZWRpY2F0ZShwcmVkaWNhdGUpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGEpIHsgcmV0dXJuIChwcmVkaWNhdGUoYSkgPyBzb21lKGEpIDogbm9uZSk7IH07XG59XG4vKipcbiAqIFJldHVybnMgdGhlIGBMZWZ0YCB2YWx1ZSBvZiBhbiBgRWl0aGVyYCBpZiBwb3NzaWJsZS5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgZ2V0TGVmdCwgbm9uZSwgc29tZSB9IGZyb20gJ2ZwLXRzL09wdGlvbidcbiAqIGltcG9ydCB7IHJpZ2h0LCBsZWZ0IH0gZnJvbSAnZnAtdHMvRWl0aGVyJ1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoZ2V0TGVmdChyaWdodCgxKSksIG5vbmUpXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKGdldExlZnQobGVmdCgnYScpKSwgc29tZSgnYScpKVxuICpcbiAqIEBjYXRlZ29yeSBjb25zdHJ1Y3RvcnNcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIGdldExlZnQgPSBmdW5jdGlvbiAobWEpIHsgcmV0dXJuIChtYS5fdGFnID09PSAnUmlnaHQnID8gbm9uZSA6IHNvbWUobWEubGVmdCkpOyB9O1xuLyoqXG4gKiBSZXR1cm5zIHRoZSBgUmlnaHRgIHZhbHVlIG9mIGFuIGBFaXRoZXJgIGlmIHBvc3NpYmxlLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBnZXRSaWdodCwgbm9uZSwgc29tZSB9IGZyb20gJ2ZwLXRzL09wdGlvbidcbiAqIGltcG9ydCB7IHJpZ2h0LCBsZWZ0IH0gZnJvbSAnZnAtdHMvRWl0aGVyJ1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoZ2V0UmlnaHQocmlnaHQoMSkpLCBzb21lKDEpKVxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChnZXRSaWdodChsZWZ0KCdhJykpLCBub25lKVxuICpcbiAqIEBjYXRlZ29yeSBjb25zdHJ1Y3RvcnNcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIGdldFJpZ2h0ID0gZnVuY3Rpb24gKG1hKSB7IHJldHVybiAobWEuX3RhZyA9PT0gJ0xlZnQnID8gbm9uZSA6IHNvbWUobWEucmlnaHQpKTsgfTtcbnZhciBfbWFwID0gZnVuY3Rpb24gKGZhLCBmKSB7IHJldHVybiBwaXBlKGZhLCBtYXAoZikpOyB9O1xudmFyIF9hcCA9IGZ1bmN0aW9uIChmYWIsIGZhKSB7IHJldHVybiBwaXBlKGZhYiwgYXAoZmEpKTsgfTtcbnZhciBfcmVkdWNlID0gZnVuY3Rpb24gKGZhLCBiLCBmKSB7IHJldHVybiBwaXBlKGZhLCByZWR1Y2UoYiwgZikpOyB9O1xudmFyIF9mb2xkTWFwID0gZnVuY3Rpb24gKE0pIHtcbiAgICB2YXIgZm9sZE1hcE0gPSBmb2xkTWFwKE0pO1xuICAgIHJldHVybiBmdW5jdGlvbiAoZmEsIGYpIHsgcmV0dXJuIHBpcGUoZmEsIGZvbGRNYXBNKGYpKTsgfTtcbn07XG52YXIgX3JlZHVjZVJpZ2h0ID0gZnVuY3Rpb24gKGZhLCBiLCBmKSB7IHJldHVybiBwaXBlKGZhLCByZWR1Y2VSaWdodChiLCBmKSk7IH07XG52YXIgX3RyYXZlcnNlID0gZnVuY3Rpb24gKEYpIHtcbiAgICB2YXIgdHJhdmVyc2VGID0gdHJhdmVyc2UoRik7XG4gICAgcmV0dXJuIGZ1bmN0aW9uICh0YSwgZikgeyByZXR1cm4gcGlwZSh0YSwgdHJhdmVyc2VGKGYpKTsgfTtcbn07XG4vKiBpc3RhbmJ1bCBpZ25vcmUgbmV4dCAqL1xudmFyIF9hbHQgPSBmdW5jdGlvbiAoZmEsIHRoYXQpIHsgcmV0dXJuIHBpcGUoZmEsIGFsdCh0aGF0KSk7IH07XG52YXIgX2ZpbHRlciA9IGZ1bmN0aW9uIChmYSwgcHJlZGljYXRlKSB7IHJldHVybiBwaXBlKGZhLCBmaWx0ZXIocHJlZGljYXRlKSk7IH07XG4vKiBpc3RhbmJ1bCBpZ25vcmUgbmV4dCAqL1xudmFyIF9maWx0ZXJNYXAgPSBmdW5jdGlvbiAoZmEsIGYpIHsgcmV0dXJuIHBpcGUoZmEsIGZpbHRlck1hcChmKSk7IH07XG4vKiBpc3RhbmJ1bCBpZ25vcmUgbmV4dCAqL1xudmFyIF9leHRlbmQgPSBmdW5jdGlvbiAod2EsIGYpIHsgcmV0dXJuIHBpcGUod2EsIGV4dGVuZChmKSk7IH07XG4vKiBpc3RhbmJ1bCBpZ25vcmUgbmV4dCAqL1xudmFyIF9wYXJ0aXRpb24gPSBmdW5jdGlvbiAoZmEsIHByZWRpY2F0ZSkge1xuICAgIHJldHVybiBwaXBlKGZhLCBwYXJ0aXRpb24ocHJlZGljYXRlKSk7XG59O1xuLyogaXN0YW5idWwgaWdub3JlIG5leHQgKi9cbnZhciBfcGFydGl0aW9uTWFwID0gZnVuY3Rpb24gKGZhLCBmKSB7IHJldHVybiBwaXBlKGZhLCBwYXJ0aXRpb25NYXAoZikpOyB9O1xuLyoqXG4gKiBAY2F0ZWdvcnkgdHlwZSBsYW1iZGFzXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciBVUkkgPSAnT3B0aW9uJztcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgZ2V0U2hvdyA9IGZ1bmN0aW9uIChTKSB7IHJldHVybiAoe1xuICAgIHNob3c6IGZ1bmN0aW9uIChtYSkgeyByZXR1cm4gKGlzTm9uZShtYSkgPyAnbm9uZScgOiBcInNvbWUoXCIuY29uY2F0KFMuc2hvdyhtYS52YWx1ZSksIFwiKVwiKSk7IH1cbn0pOyB9O1xuLyoqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgbm9uZSwgc29tZSwgZ2V0RXEgfSBmcm9tICdmcC10cy9PcHRpb24nXG4gKiBpbXBvcnQgKiBhcyBOIGZyb20gJ2ZwLXRzL251bWJlcidcbiAqXG4gKiBjb25zdCBFID0gZ2V0RXEoTi5FcSlcbiAqIGFzc2VydC5zdHJpY3RFcXVhbChFLmVxdWFscyhub25lLCBub25lKSwgdHJ1ZSlcbiAqIGFzc2VydC5zdHJpY3RFcXVhbChFLmVxdWFscyhub25lLCBzb21lKDEpKSwgZmFsc2UpXG4gKiBhc3NlcnQuc3RyaWN0RXF1YWwoRS5lcXVhbHMoc29tZSgxKSwgbm9uZSksIGZhbHNlKVxuICogYXNzZXJ0LnN0cmljdEVxdWFsKEUuZXF1YWxzKHNvbWUoMSksIHNvbWUoMikpLCBmYWxzZSlcbiAqIGFzc2VydC5zdHJpY3RFcXVhbChFLmVxdWFscyhzb21lKDEpLCBzb21lKDEpKSwgdHJ1ZSlcbiAqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciBnZXRFcSA9IGZ1bmN0aW9uIChFKSB7IHJldHVybiAoe1xuICAgIGVxdWFsczogZnVuY3Rpb24gKHgsIHkpIHsgcmV0dXJuIHggPT09IHkgfHwgKGlzTm9uZSh4KSA/IGlzTm9uZSh5KSA6IGlzTm9uZSh5KSA/IGZhbHNlIDogRS5lcXVhbHMoeC52YWx1ZSwgeS52YWx1ZSkpOyB9XG59KTsgfTtcbi8qKlxuICogVGhlIGBPcmRgIGluc3RhbmNlIGFsbG93cyBgT3B0aW9uYCB2YWx1ZXMgdG8gYmUgY29tcGFyZWQgd2l0aFxuICogYGNvbXBhcmVgLCB3aGVuZXZlciB0aGVyZSBpcyBhbiBgT3JkYCBpbnN0YW5jZSBmb3JcbiAqIHRoZSB0eXBlIHRoZSBgT3B0aW9uYCBjb250YWlucy5cbiAqXG4gKiBgTm9uZWAgaXMgY29uc2lkZXJlZCB0byBiZSBsZXNzIHRoYW4gYW55IGBTb21lYCB2YWx1ZS5cbiAqXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IG5vbmUsIHNvbWUsIGdldE9yZCB9IGZyb20gJ2ZwLXRzL09wdGlvbidcbiAqIGltcG9ydCAqIGFzIE4gZnJvbSAnZnAtdHMvbnVtYmVyJ1xuICpcbiAqIGNvbnN0IE8gPSBnZXRPcmQoTi5PcmQpXG4gKiBhc3NlcnQuc3RyaWN0RXF1YWwoTy5jb21wYXJlKG5vbmUsIG5vbmUpLCAwKVxuICogYXNzZXJ0LnN0cmljdEVxdWFsKE8uY29tcGFyZShub25lLCBzb21lKDEpKSwgLTEpXG4gKiBhc3NlcnQuc3RyaWN0RXF1YWwoTy5jb21wYXJlKHNvbWUoMSksIG5vbmUpLCAxKVxuICogYXNzZXJ0LnN0cmljdEVxdWFsKE8uY29tcGFyZShzb21lKDEpLCBzb21lKDIpKSwgLTEpXG4gKiBhc3NlcnQuc3RyaWN0RXF1YWwoTy5jb21wYXJlKHNvbWUoMSksIHNvbWUoMSkpLCAwKVxuICpcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIGdldE9yZCA9IGZ1bmN0aW9uIChPKSB7IHJldHVybiAoe1xuICAgIGVxdWFsczogZ2V0RXEoTykuZXF1YWxzLFxuICAgIGNvbXBhcmU6IGZ1bmN0aW9uICh4LCB5KSB7IHJldHVybiAoeCA9PT0geSA/IDAgOiBpc1NvbWUoeCkgPyAoaXNTb21lKHkpID8gTy5jb21wYXJlKHgudmFsdWUsIHkudmFsdWUpIDogMSkgOiAtMSk7IH1cbn0pOyB9O1xuLyoqXG4gKiBNb25vaWQgcmV0dXJuaW5nIHRoZSBsZWZ0LW1vc3Qgbm9uLWBOb25lYCB2YWx1ZS4gSWYgYm90aCBvcGVyYW5kcyBhcmUgYFNvbWVgcyB0aGVuIHRoZSBpbm5lciB2YWx1ZXMgYXJlXG4gKiBjb25jYXRlbmF0ZWQgdXNpbmcgdGhlIHByb3ZpZGVkIGBTZW1pZ3JvdXBgXG4gKlxuICogfCB4ICAgICAgIHwgeSAgICAgICB8IGNvbmNhdCh4LCB5KSAgICAgICB8XG4gKiB8IC0tLS0tLS0gfCAtLS0tLS0tIHwgLS0tLS0tLS0tLS0tLS0tLS0tIHxcbiAqIHwgbm9uZSAgICB8IG5vbmUgICAgfCBub25lICAgICAgICAgICAgICAgfFxuICogfCBzb21lKGEpIHwgbm9uZSAgICB8IHNvbWUoYSkgICAgICAgICAgICB8XG4gKiB8IG5vbmUgICAgfCBzb21lKGIpIHwgc29tZShiKSAgICAgICAgICAgIHxcbiAqIHwgc29tZShhKSB8IHNvbWUoYikgfCBzb21lKGNvbmNhdChhLCBiKSkgfFxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBnZXRNb25vaWQsIHNvbWUsIG5vbmUgfSBmcm9tICdmcC10cy9PcHRpb24nXG4gKiBpbXBvcnQgeyBTZW1pZ3JvdXBTdW0gfSBmcm9tICdmcC10cy9udW1iZXInXG4gKlxuICogY29uc3QgTSA9IGdldE1vbm9pZChTZW1pZ3JvdXBTdW0pXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKE0uY29uY2F0KG5vbmUsIG5vbmUpLCBub25lKVxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChNLmNvbmNhdChzb21lKDEpLCBub25lKSwgc29tZSgxKSlcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoTS5jb25jYXQobm9uZSwgc29tZSgxKSksIHNvbWUoMSkpXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKE0uY29uY2F0KHNvbWUoMSksIHNvbWUoMikpLCBzb21lKDMpKVxuICpcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIGdldE1vbm9pZCA9IGZ1bmN0aW9uIChTKSB7IHJldHVybiAoe1xuICAgIGNvbmNhdDogZnVuY3Rpb24gKHgsIHkpIHsgcmV0dXJuIChpc05vbmUoeCkgPyB5IDogaXNOb25lKHkpID8geCA6IHNvbWUoUy5jb25jYXQoeC52YWx1ZSwgeS52YWx1ZSkpKTsgfSxcbiAgICBlbXB0eTogbm9uZVxufSk7IH07XG4vKipcbiAqIEBjYXRlZ29yeSBtYXBwaW5nXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciBtYXAgPSBmdW5jdGlvbiAoZikgeyByZXR1cm4gZnVuY3Rpb24gKGZhKSB7XG4gICAgcmV0dXJuIGlzTm9uZShmYSkgPyBub25lIDogc29tZShmKGZhLnZhbHVlKSk7XG59OyB9O1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi43LjBcbiAqL1xuZXhwb3J0IHZhciBGdW5jdG9yID0ge1xuICAgIFVSSTogVVJJLFxuICAgIG1hcDogX21hcFxufTtcbi8qKlxuICogTWFwcyB0aGUgYFNvbWVgIHZhbHVlIG9mIHRoaXMgYE9wdGlvbmAgdG8gdGhlIHNwZWNpZmllZCBjb25zdGFudCB2YWx1ZS5cbiAqXG4gKiBAY2F0ZWdvcnkgbWFwcGluZ1xuICogQHNpbmNlIDIuMTYuMFxuICovXG5leHBvcnQgdmFyIGFzID0gZHVhbCgyLCBhc18oRnVuY3RvcikpO1xuLyoqXG4gKiBNYXBzIHRoZSBgU29tZWAgdmFsdWUgb2YgdGhpcyBgT3B0aW9uYCB0byB0aGUgdm9pZCBjb25zdGFudCB2YWx1ZS5cbiAqXG4gKiBAY2F0ZWdvcnkgbWFwcGluZ1xuICogQHNpbmNlIDIuMTYuMFxuICovXG5leHBvcnQgdmFyIGFzVW5pdCA9IGFzVW5pdF8oRnVuY3Rvcik7XG4vKipcbiAqIEBjYXRlZ29yeSBjb25zdHJ1Y3RvcnNcbiAqIEBzaW5jZSAyLjcuMFxuICovXG5leHBvcnQgdmFyIG9mID0gc29tZTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuMTAuMFxuICovXG5leHBvcnQgdmFyIFBvaW50ZWQgPSB7XG4gICAgVVJJOiBVUkksXG4gICAgb2Y6IG9mXG59O1xuLyoqXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciBhcCA9IGZ1bmN0aW9uIChmYSkgeyByZXR1cm4gZnVuY3Rpb24gKGZhYikge1xuICAgIHJldHVybiBpc05vbmUoZmFiKSA/IG5vbmUgOiBpc05vbmUoZmEpID8gbm9uZSA6IHNvbWUoZmFiLnZhbHVlKGZhLnZhbHVlKSk7XG59OyB9O1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi4xMC4wXG4gKi9cbmV4cG9ydCB2YXIgQXBwbHkgPSB7XG4gICAgVVJJOiBVUkksXG4gICAgbWFwOiBfbWFwLFxuICAgIGFwOiBfYXBcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjcuMFxuICovXG5leHBvcnQgdmFyIEFwcGxpY2F0aXZlID0ge1xuICAgIFVSSTogVVJJLFxuICAgIG1hcDogX21hcCxcbiAgICBhcDogX2FwLFxuICAgIG9mOiBvZlxufTtcbi8qKlxuICogQGNhdGVnb3J5IHNlcXVlbmNpbmdcbiAqIEBzaW5jZSAyLjE0LjBcbiAqL1xuZXhwb3J0IHZhciBmbGF0TWFwID0gLyojX19QVVJFX18qLyBkdWFsKDIsIGZ1bmN0aW9uIChtYSwgZikgeyByZXR1cm4gKGlzTm9uZShtYSkgPyBub25lIDogZihtYS52YWx1ZSkpOyB9KTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuMTAuMFxuICovXG5leHBvcnQgdmFyIENoYWluID0ge1xuICAgIFVSSTogVVJJLFxuICAgIG1hcDogX21hcCxcbiAgICBhcDogX2FwLFxuICAgIGNoYWluOiBmbGF0TWFwXG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi43LjBcbiAqL1xuZXhwb3J0IHZhciBNb25hZCA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICBtYXA6IF9tYXAsXG4gICAgYXA6IF9hcCxcbiAgICBvZjogb2YsXG4gICAgY2hhaW46IGZsYXRNYXBcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBmb2xkaW5nXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciByZWR1Y2UgPSBmdW5jdGlvbiAoYiwgZikgeyByZXR1cm4gZnVuY3Rpb24gKGZhKSB7XG4gICAgcmV0dXJuIGlzTm9uZShmYSkgPyBiIDogZihiLCBmYS52YWx1ZSk7XG59OyB9O1xuLyoqXG4gKiBAY2F0ZWdvcnkgZm9sZGluZ1xuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgZm9sZE1hcCA9IGZ1bmN0aW9uIChNKSB7IHJldHVybiBmdW5jdGlvbiAoZikgeyByZXR1cm4gZnVuY3Rpb24gKGZhKSB7XG4gICAgcmV0dXJuIGlzTm9uZShmYSkgPyBNLmVtcHR5IDogZihmYS52YWx1ZSk7XG59OyB9OyB9O1xuLyoqXG4gKiBAY2F0ZWdvcnkgZm9sZGluZ1xuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgcmVkdWNlUmlnaHQgPSBmdW5jdGlvbiAoYiwgZikgeyByZXR1cm4gZnVuY3Rpb24gKGZhKSB7XG4gICAgcmV0dXJuIGlzTm9uZShmYSkgPyBiIDogZihmYS52YWx1ZSwgYik7XG59OyB9O1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi43LjBcbiAqL1xuZXhwb3J0IHZhciBGb2xkYWJsZSA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICByZWR1Y2U6IF9yZWR1Y2UsXG4gICAgZm9sZE1hcDogX2ZvbGRNYXAsXG4gICAgcmVkdWNlUmlnaHQ6IF9yZWR1Y2VSaWdodFxufTtcbi8qKlxuICogUmV0dXJucyB0aGUgcHJvdmlkZWQgYE9wdGlvbmAgYHRoYXRgIGlmIGBzZWxmYCBpcyBgTm9uZWAsIG90aGVyd2lzZSByZXR1cm5zIGBzZWxmYC5cbiAqXG4gKiBAcGFyYW0gc2VsZiAtIFRoZSBmaXJzdCBgT3B0aW9uYCB0byBiZSBjaGVja2VkLlxuICogQHBhcmFtIHRoYXQgLSBUaGUgYE9wdGlvbmAgdG8gcmV0dXJuIGlmIGBzZWxmYCBpcyBgTm9uZWAuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCAqIGFzIE8gZnJvbSBcImZwLXRzL09wdGlvblwiXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChPLm9yRWxzZShPLm5vbmUsICgpID0+IE8ubm9uZSksIE8ubm9uZSlcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoTy5vckVsc2UoTy5zb21lKDEpLCAoKSA9PiBPLm5vbmUpLCBPLnNvbWUoMSkpXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKE8ub3JFbHNlKE8ubm9uZSwgKCkgPT4gTy5zb21lKCdiJykpLCBPLnNvbWUoJ2InKSlcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoTy5vckVsc2UoTy5zb21lKDEpLCAoKSA9PiBPLnNvbWUoJ2InKSksIE8uc29tZSgxKSlcbiAqXG4gKiBAY2F0ZWdvcnkgZXJyb3IgaGFuZGxpbmdcbiAqIEBzaW5jZSAyLjE2LjBcbiAqL1xuZXhwb3J0IHZhciBvckVsc2UgPSBkdWFsKDIsIGZ1bmN0aW9uIChzZWxmLCB0aGF0KSB7IHJldHVybiAoaXNOb25lKHNlbGYpID8gdGhhdCgpIDogc2VsZik7IH0pO1xuLyoqXG4gKiBBbGlhcyBvZiBgb3JFbHNlYC5cbiAqXG4gKiBMZXNzIHN0cmljdCB2ZXJzaW9uIG9mIFtgYWx0YF0oI2FsdCkuXG4gKlxuICogVGhlIGBXYCBzdWZmaXggKHNob3J0IGZvciAqKlcqKmlkZW5pbmcpIG1lYW5zIHRoYXQgdGhlIHJldHVybiB0eXBlcyB3aWxsIGJlIG1lcmdlZC5cbiAqXG4gKiBAY2F0ZWdvcnkgbGVnYWN5XG4gKiBAc2luY2UgMi45LjBcbiAqL1xuZXhwb3J0IHZhciBhbHRXID0gb3JFbHNlO1xuLyoqXG4gKiBBbGlhcyBvZiBgb3JFbHNlYC5cbiAqXG4gKiBAY2F0ZWdvcnkgbGVnYWN5XG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciBhbHQgPSBvckVsc2U7XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjcuMFxuICovXG5leHBvcnQgdmFyIEFsdCA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICBtYXA6IF9tYXAsXG4gICAgYWx0OiBfYWx0XG59O1xuLyoqXG4gKiBAc2luY2UgMi43LjBcbiAqL1xuZXhwb3J0IHZhciB6ZXJvID0gZnVuY3Rpb24gKCkgeyByZXR1cm4gbm9uZTsgfTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIFplcm8gPSB7XG4gICAgVVJJOiBVUkksXG4gICAgemVybzogemVyb1xufTtcbi8qKlxuICogQGNhdGVnb3J5IGRvIG5vdGF0aW9uXG4gKiBAc2luY2UgMi4xMS4wXG4gKi9cbmV4cG9ydCB2YXIgZ3VhcmQgPSAvKiNfX1BVUkVfXyovIGd1YXJkXyhaZXJvLCBQb2ludGVkKTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuNy4wXG4gKi9cbmV4cG9ydCB2YXIgQWx0ZXJuYXRpdmUgPSB7XG4gICAgVVJJOiBVUkksXG4gICAgbWFwOiBfbWFwLFxuICAgIGFwOiBfYXAsXG4gICAgb2Y6IG9mLFxuICAgIGFsdDogX2FsdCxcbiAgICB6ZXJvOiB6ZXJvXG59O1xuLyoqXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciBleHRlbmQgPSBmdW5jdGlvbiAoZikgeyByZXR1cm4gZnVuY3Rpb24gKHdhKSB7XG4gICAgcmV0dXJuIGlzTm9uZSh3YSkgPyBub25lIDogc29tZShmKHdhKSk7XG59OyB9O1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi43LjBcbiAqL1xuZXhwb3J0IHZhciBFeHRlbmQgPSB7XG4gICAgVVJJOiBVUkksXG4gICAgbWFwOiBfbWFwLFxuICAgIGV4dGVuZDogX2V4dGVuZFxufTtcbi8qKlxuICogQGNhdGVnb3J5IGZpbHRlcmluZ1xuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgY29tcGFjdCA9IC8qI19fUFVSRV9fKi8gZmxhdE1hcChpZGVudGl0eSk7XG52YXIgZGVmYXVsdFNlcGFyYXRlZCA9IC8qI19fUFVSRV9fKi8gc2VwYXJhdGVkKG5vbmUsIG5vbmUpO1xuLyoqXG4gKiBAY2F0ZWdvcnkgZmlsdGVyaW5nXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciBzZXBhcmF0ZSA9IGZ1bmN0aW9uIChtYSkge1xuICAgIHJldHVybiBpc05vbmUobWEpID8gZGVmYXVsdFNlcGFyYXRlZCA6IHNlcGFyYXRlZChnZXRMZWZ0KG1hLnZhbHVlKSwgZ2V0UmlnaHQobWEudmFsdWUpKTtcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjcuMFxuICovXG5leHBvcnQgdmFyIENvbXBhY3RhYmxlID0ge1xuICAgIFVSSTogVVJJLFxuICAgIGNvbXBhY3Q6IGNvbXBhY3QsXG4gICAgc2VwYXJhdGU6IHNlcGFyYXRlXG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgZmlsdGVyaW5nXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciBmaWx0ZXIgPSBmdW5jdGlvbiAocHJlZGljYXRlKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChmYSkge1xuICAgICAgICByZXR1cm4gaXNOb25lKGZhKSA/IG5vbmUgOiBwcmVkaWNhdGUoZmEudmFsdWUpID8gZmEgOiBub25lO1xuICAgIH07XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgZmlsdGVyaW5nXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciBmaWx0ZXJNYXAgPSBmdW5jdGlvbiAoZikgeyByZXR1cm4gZnVuY3Rpb24gKGZhKSB7XG4gICAgcmV0dXJuIGlzTm9uZShmYSkgPyBub25lIDogZihmYS52YWx1ZSk7XG59OyB9O1xuLyoqXG4gKiBAY2F0ZWdvcnkgZmlsdGVyaW5nXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciBwYXJ0aXRpb24gPSBmdW5jdGlvbiAocHJlZGljYXRlKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChmYSkge1xuICAgICAgICByZXR1cm4gc2VwYXJhdGVkKF9maWx0ZXIoZmEsIG5vdChwcmVkaWNhdGUpKSwgX2ZpbHRlcihmYSwgcHJlZGljYXRlKSk7XG4gICAgfTtcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBmaWx0ZXJpbmdcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIHBhcnRpdGlvbk1hcCA9IGZ1bmN0aW9uIChmKSB7IHJldHVybiBmbG93KG1hcChmKSwgc2VwYXJhdGUpOyB9O1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi43LjBcbiAqL1xuZXhwb3J0IHZhciBGaWx0ZXJhYmxlID0ge1xuICAgIFVSSTogVVJJLFxuICAgIG1hcDogX21hcCxcbiAgICBjb21wYWN0OiBjb21wYWN0LFxuICAgIHNlcGFyYXRlOiBzZXBhcmF0ZSxcbiAgICBmaWx0ZXI6IF9maWx0ZXIsXG4gICAgZmlsdGVyTWFwOiBfZmlsdGVyTWFwLFxuICAgIHBhcnRpdGlvbjogX3BhcnRpdGlvbixcbiAgICBwYXJ0aXRpb25NYXA6IF9wYXJ0aXRpb25NYXBcbn07XG4vKipcbiAqIEBjYXRlZ29yeSB0cmF2ZXJzaW5nXG4gKiBAc2luY2UgMi42LjNcbiAqL1xuZXhwb3J0IHZhciB0cmF2ZXJzZSA9IGZ1bmN0aW9uIChGKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChmKSB7XG4gICAgICAgIHJldHVybiBmdW5jdGlvbiAodGEpIHtcbiAgICAgICAgICAgIHJldHVybiBpc05vbmUodGEpID8gRi5vZihub25lKSA6IEYubWFwKGYodGEudmFsdWUpLCBzb21lKTtcbiAgICAgICAgfTtcbiAgICB9O1xufTtcbi8qKlxuICogQGNhdGVnb3J5IHRyYXZlcnNpbmdcbiAqIEBzaW5jZSAyLjYuM1xuICovXG5leHBvcnQgdmFyIHNlcXVlbmNlID0gZnVuY3Rpb24gKEYpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKHRhKSB7XG4gICAgICAgIHJldHVybiBpc05vbmUodGEpID8gRi5vZihub25lKSA6IEYubWFwKHRhLnZhbHVlLCBzb21lKTtcbiAgICB9O1xufTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuNy4wXG4gKi9cbmV4cG9ydCB2YXIgVHJhdmVyc2FibGUgPSB7XG4gICAgVVJJOiBVUkksXG4gICAgbWFwOiBfbWFwLFxuICAgIHJlZHVjZTogX3JlZHVjZSxcbiAgICBmb2xkTWFwOiBfZm9sZE1hcCxcbiAgICByZWR1Y2VSaWdodDogX3JlZHVjZVJpZ2h0LFxuICAgIHRyYXZlcnNlOiBfdHJhdmVyc2UsXG4gICAgc2VxdWVuY2U6IHNlcXVlbmNlXG59O1xudmFyIF93aXRoZXIgPSAvKiNfX1BVUkVfXyovIHdpdGhlckRlZmF1bHQoVHJhdmVyc2FibGUsIENvbXBhY3RhYmxlKTtcbnZhciBfd2lsdCA9IC8qI19fUFVSRV9fKi8gd2lsdERlZmF1bHQoVHJhdmVyc2FibGUsIENvbXBhY3RhYmxlKTtcbi8qKlxuICogQGNhdGVnb3J5IGZpbHRlcmluZ1xuICogQHNpbmNlIDIuNi41XG4gKi9cbmV4cG9ydCB2YXIgd2l0aGVyID0gZnVuY3Rpb24gKEYpIHtcbiAgICB2YXIgX3dpdGhlckYgPSBfd2l0aGVyKEYpO1xuICAgIHJldHVybiBmdW5jdGlvbiAoZikgeyByZXR1cm4gZnVuY3Rpb24gKGZhKSB7IHJldHVybiBfd2l0aGVyRihmYSwgZik7IH07IH07XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgZmlsdGVyaW5nXG4gKiBAc2luY2UgMi42LjVcbiAqL1xuZXhwb3J0IHZhciB3aWx0ID0gZnVuY3Rpb24gKEYpIHtcbiAgICB2YXIgX3dpbHRGID0gX3dpbHQoRik7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChmKSB7IHJldHVybiBmdW5jdGlvbiAoZmEpIHsgcmV0dXJuIF93aWx0RihmYSwgZik7IH07IH07XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi43LjBcbiAqL1xuZXhwb3J0IHZhciBXaXRoZXJhYmxlID0ge1xuICAgIFVSSTogVVJJLFxuICAgIG1hcDogX21hcCxcbiAgICByZWR1Y2U6IF9yZWR1Y2UsXG4gICAgZm9sZE1hcDogX2ZvbGRNYXAsXG4gICAgcmVkdWNlUmlnaHQ6IF9yZWR1Y2VSaWdodCxcbiAgICB0cmF2ZXJzZTogX3RyYXZlcnNlLFxuICAgIHNlcXVlbmNlOiBzZXF1ZW5jZSxcbiAgICBjb21wYWN0OiBjb21wYWN0LFxuICAgIHNlcGFyYXRlOiBzZXBhcmF0ZSxcbiAgICBmaWx0ZXI6IF9maWx0ZXIsXG4gICAgZmlsdGVyTWFwOiBfZmlsdGVyTWFwLFxuICAgIHBhcnRpdGlvbjogX3BhcnRpdGlvbixcbiAgICBwYXJ0aXRpb25NYXA6IF9wYXJ0aXRpb25NYXAsXG4gICAgd2l0aGVyOiBfd2l0aGVyLFxuICAgIHdpbHQ6IF93aWx0XG59O1xuLyoqXG4gKiBAc2luY2UgMi43LjBcbiAqL1xuZXhwb3J0IHZhciB0aHJvd0Vycm9yID0gZnVuY3Rpb24gKCkgeyByZXR1cm4gbm9uZTsgfTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuNy4wXG4gKi9cbmV4cG9ydCB2YXIgTW9uYWRUaHJvdyA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICBtYXA6IF9tYXAsXG4gICAgYXA6IF9hcCxcbiAgICBvZjogb2YsXG4gICAgY2hhaW46IGZsYXRNYXAsXG4gICAgdGhyb3dFcnJvcjogdGhyb3dFcnJvclxufTtcbi8qKlxuICogVHJhbnNmb3JtcyBhbiBgRWl0aGVyYCB0byBhbiBgT3B0aW9uYCBkaXNjYXJkaW5nIHRoZSBlcnJvci5cbiAqXG4gKiBBbGlhcyBvZiBbZ2V0UmlnaHRdKCNnZXRyaWdodClcbiAqXG4gKiBAY2F0ZWdvcnkgY29udmVyc2lvbnNcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIGZyb21FaXRoZXIgPSBnZXRSaWdodDtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIEZyb21FaXRoZXIgPSB7XG4gICAgVVJJOiBVUkksXG4gICAgZnJvbUVpdGhlcjogZnJvbUVpdGhlclxufTtcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8vIHJlZmluZW1lbnRzXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vKipcbiAqIFJldHVybnMgYHRydWVgIGlmIHRoZSBvcHRpb24gaXMgYW4gaW5zdGFuY2Ugb2YgYFNvbWVgLCBgZmFsc2VgIG90aGVyd2lzZS5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgc29tZSwgbm9uZSwgaXNTb21lIH0gZnJvbSAnZnAtdHMvT3B0aW9uJ1xuICpcbiAqIGFzc2VydC5zdHJpY3RFcXVhbChpc1NvbWUoc29tZSgxKSksIHRydWUpXG4gKiBhc3NlcnQuc3RyaWN0RXF1YWwoaXNTb21lKG5vbmUpLCBmYWxzZSlcbiAqXG4gKiBAY2F0ZWdvcnkgcmVmaW5lbWVudHNcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIGlzU29tZSA9IF8uaXNTb21lO1xuLyoqXG4gKiBSZXR1cm5zIGB0cnVlYCBpZiB0aGUgb3B0aW9uIGlzIGBOb25lYCwgYGZhbHNlYCBvdGhlcndpc2UuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IHNvbWUsIG5vbmUsIGlzTm9uZSB9IGZyb20gJ2ZwLXRzL09wdGlvbidcbiAqXG4gKiBhc3NlcnQuc3RyaWN0RXF1YWwoaXNOb25lKHNvbWUoMSkpLCBmYWxzZSlcbiAqIGFzc2VydC5zdHJpY3RFcXVhbChpc05vbmUobm9uZSksIHRydWUpXG4gKlxuICogQGNhdGVnb3J5IHJlZmluZW1lbnRzXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciBpc05vbmUgPSBmdW5jdGlvbiAoZmEpIHsgcmV0dXJuIGZhLl90YWcgPT09ICdOb25lJzsgfTtcbi8qKlxuICogTGVzcyBzdHJpY3QgdmVyc2lvbiBvZiBbYG1hdGNoYF0oI21hdGNoKS5cbiAqXG4gKiBUaGUgYFdgIHN1ZmZpeCAoc2hvcnQgZm9yICoqVyoqaWRlbmluZykgbWVhbnMgdGhhdCB0aGUgaGFuZGxlciByZXR1cm4gdHlwZXMgd2lsbCBiZSBtZXJnZWQuXG4gKlxuICogQGNhdGVnb3J5IHBhdHRlcm4gbWF0Y2hpbmdcbiAqIEBzaW5jZSAyLjEwLjBcbiAqL1xuZXhwb3J0IHZhciBtYXRjaFcgPSBmdW5jdGlvbiAob25Ob25lLCBvblNvbWUpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKG1hKSB7XG4gICAgICAgIHJldHVybiBpc05vbmUobWEpID8gb25Ob25lKCkgOiBvblNvbWUobWEudmFsdWUpO1xuICAgIH07XG59O1xuLyoqXG4gKiBBbGlhcyBvZiBbYG1hdGNoV2BdKCNtYXRjaHcpLlxuICpcbiAqIEBjYXRlZ29yeSBwYXR0ZXJuIG1hdGNoaW5nXG4gKiBAc2luY2UgMi4xMC4wXG4gKi9cbmV4cG9ydCB2YXIgZm9sZFcgPSBtYXRjaFc7XG4vKipcbiAqIFRha2VzIGEgKGxhenkpIGRlZmF1bHQgdmFsdWUsIGEgZnVuY3Rpb24sIGFuZCBhbiBgT3B0aW9uYCB2YWx1ZSwgaWYgdGhlIGBPcHRpb25gIHZhbHVlIGlzIGBOb25lYCB0aGUgZGVmYXVsdCB2YWx1ZSBpc1xuICogcmV0dXJuZWQsIG90aGVyd2lzZSB0aGUgZnVuY3Rpb24gaXMgYXBwbGllZCB0byB0aGUgdmFsdWUgaW5zaWRlIHRoZSBgU29tZWAgYW5kIHRoZSByZXN1bHQgaXMgcmV0dXJuZWQuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IHNvbWUsIG5vbmUsIG1hdGNoIH0gZnJvbSAnZnAtdHMvT3B0aW9uJ1xuICogaW1wb3J0IHsgcGlwZSB9IGZyb20gJ2ZwLXRzL2Z1bmN0aW9uJ1xuICpcbiAqIGFzc2VydC5zdHJpY3RFcXVhbChcbiAqICAgcGlwZShcbiAqICAgICBzb21lKDEpLFxuICogICAgIG1hdGNoKCgpID0+ICdhIG5vbmUnLCBhID0+IGBhIHNvbWUgY29udGFpbmluZyAke2F9YClcbiAqICAgKSxcbiAqICAgJ2Egc29tZSBjb250YWluaW5nIDEnXG4gKiApXG4gKlxuICogYXNzZXJ0LnN0cmljdEVxdWFsKFxuICogICBwaXBlKFxuICogICAgIG5vbmUsXG4gKiAgICAgbWF0Y2goKCkgPT4gJ2Egbm9uZScsIGEgPT4gYGEgc29tZSBjb250YWluaW5nICR7YX1gKVxuICogICApLFxuICogICAnYSBub25lJ1xuICogKVxuICpcbiAqIEBjYXRlZ29yeSBwYXR0ZXJuIG1hdGNoaW5nXG4gKiBAc2luY2UgMi4xMC4wXG4gKi9cbmV4cG9ydCB2YXIgbWF0Y2ggPSBtYXRjaFc7XG4vKipcbiAqIEFsaWFzIG9mIFtgbWF0Y2hgXSgjbWF0Y2gpLlxuICpcbiAqIEBjYXRlZ29yeSBwYXR0ZXJuIG1hdGNoaW5nXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciBmb2xkID0gbWF0Y2g7XG4vKipcbiAqIExlc3Mgc3RyaWN0IHZlcnNpb24gb2YgW2BnZXRPckVsc2VgXSgjZ2V0b3JlbHNlKS5cbiAqXG4gKiBUaGUgYFdgIHN1ZmZpeCAoc2hvcnQgZm9yICoqVyoqaWRlbmluZykgbWVhbnMgdGhhdCB0aGUgaGFuZGxlciByZXR1cm4gdHlwZSB3aWxsIGJlIG1lcmdlZC5cbiAqXG4gKiBAY2F0ZWdvcnkgZXJyb3IgaGFuZGxpbmdcbiAqIEBzaW5jZSAyLjYuMFxuICovXG5leHBvcnQgdmFyIGdldE9yRWxzZVcgPSBmdW5jdGlvbiAob25Ob25lKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChtYSkge1xuICAgICAgICByZXR1cm4gaXNOb25lKG1hKSA/IG9uTm9uZSgpIDogbWEudmFsdWU7XG4gICAgfTtcbn07XG4vKipcbiAqIEV4dHJhY3RzIHRoZSB2YWx1ZSBvdXQgb2YgdGhlIHN0cnVjdHVyZSwgaWYgaXQgZXhpc3RzLiBPdGhlcndpc2UgcmV0dXJucyB0aGUgZ2l2ZW4gZGVmYXVsdCB2YWx1ZVxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBzb21lLCBub25lLCBnZXRPckVsc2UgfSBmcm9tICdmcC10cy9PcHRpb24nXG4gKiBpbXBvcnQgeyBwaXBlIH0gZnJvbSAnZnAtdHMvZnVuY3Rpb24nXG4gKlxuICogYXNzZXJ0LnN0cmljdEVxdWFsKFxuICogICBwaXBlKFxuICogICAgIHNvbWUoMSksXG4gKiAgICAgZ2V0T3JFbHNlKCgpID0+IDApXG4gKiAgICksXG4gKiAgIDFcbiAqIClcbiAqIGFzc2VydC5zdHJpY3RFcXVhbChcbiAqICAgcGlwZShcbiAqICAgICBub25lLFxuICogICAgIGdldE9yRWxzZSgoKSA9PiAwKVxuICogICApLFxuICogICAwXG4gKiApXG4gKlxuICogQGNhdGVnb3J5IGVycm9yIGhhbmRsaW5nXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciBnZXRPckVsc2UgPSBnZXRPckVsc2VXO1xuLyoqXG4gKiBAY2F0ZWdvcnkgbWFwcGluZ1xuICogQHNpbmNlIDIuMTAuMFxuICovXG5leHBvcnQgdmFyIGZsYXAgPSAvKiNfX1BVUkVfXyovIGZsYXBfKEZ1bmN0b3IpO1xuLyoqXG4gKiBDb21iaW5lIHR3byBlZmZlY3RmdWwgYWN0aW9ucywga2VlcGluZyBvbmx5IHRoZSByZXN1bHQgb2YgdGhlIGZpcnN0LlxuICpcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIGFwRmlyc3QgPSAvKiNfX1BVUkVfXyovIGFwRmlyc3RfKEFwcGx5KTtcbi8qKlxuICogQ29tYmluZSB0d28gZWZmZWN0ZnVsIGFjdGlvbnMsIGtlZXBpbmcgb25seSB0aGUgcmVzdWx0IG9mIHRoZSBzZWNvbmQuXG4gKlxuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgYXBTZWNvbmQgPSAvKiNfX1BVUkVfXyovIGFwU2Vjb25kXyhBcHBseSk7XG4vKipcbiAqIEBjYXRlZ29yeSBzZXF1ZW5jaW5nXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciBmbGF0dGVuID0gY29tcGFjdDtcbi8qKlxuICogQ29tcG9zZXMgY29tcHV0YXRpb25zIGluIHNlcXVlbmNlLCB1c2luZyB0aGUgcmV0dXJuIHZhbHVlIG9mIG9uZSBjb21wdXRhdGlvbiB0byBkZXRlcm1pbmUgdGhlIG5leHQgY29tcHV0YXRpb24gYW5kXG4gKiBrZWVwaW5nIG9ubHkgdGhlIHJlc3VsdCBvZiB0aGUgZmlyc3QuXG4gKlxuICogQGNhdGVnb3J5IGNvbWJpbmF0b3JzXG4gKiBAc2luY2UgMi4xNS4wXG4gKi9cbmV4cG9ydCB2YXIgdGFwID0gLyojX19QVVJFX18qLyBkdWFsKDIsIGNoYWluYWJsZS50YXAoQ2hhaW4pKTtcbi8qKlxuICogQ29tcG9zZXMgY29tcHV0YXRpb25zIGluIHNlcXVlbmNlLCB1c2luZyB0aGUgcmV0dXJuIHZhbHVlIG9mIG9uZSBjb21wdXRhdGlvbiB0byBkZXRlcm1pbmUgdGhlIG5leHQgY29tcHV0YXRpb24gYW5kXG4gKiBrZWVwaW5nIG9ubHkgdGhlIHJlc3VsdCBvZiB0aGUgZmlyc3QuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IHBpcGUgfSBmcm9tICdmcC10cy9mdW5jdGlvbidcbiAqIGltcG9ydCAqIGFzIE8gZnJvbSAnZnAtdHMvT3B0aW9uJ1xuICogaW1wb3J0ICogYXMgRSBmcm9tICdmcC10cy9FaXRoZXInXG4gKlxuICogY29uc3QgY29tcHV0ZSA9ICh2YWx1ZTogbnVtYmVyKSA9PiBwaXBlKFxuICogICBPLm9mKHZhbHVlKSxcbiAqICAgTy50YXBFaXRoZXIoKHZhbHVlKSA9PiB2YWx1ZSA+IDAgPyBFLnJpZ2h0KCdvaycpIDogRS5sZWZ0KCdlcnJvcicpKSxcbiAqIClcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKGNvbXB1dGUoMSksIE8ub2YoMSkpXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKGNvbXB1dGUoLTQyKSwgTy5ub25lKVxuICpcbiAqIEBjYXRlZ29yeSBjb21iaW5hdG9yc1xuICogQHNpbmNlIDIuMTYuMFxuICovXG5leHBvcnQgdmFyIHRhcEVpdGhlciA9IC8qI19fUFVSRV9fKi8gZHVhbCgyLCB0YXBFaXRoZXJfKEZyb21FaXRoZXIsIENoYWluKSk7XG4vKipcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIGR1cGxpY2F0ZSA9IC8qI19fUFVSRV9fKi8gZXh0ZW5kKGlkZW50aXR5KTtcbi8qKlxuICogQGNhdGVnb3J5IGxpZnRpbmdcbiAqIEBzaW5jZSAyLjExLjBcbiAqL1xuZXhwb3J0IHZhciBmcm9tRWl0aGVySyA9IC8qI19fUFVSRV9fKi8gZnJvbUVpdGhlcktfKEZyb21FaXRoZXIpO1xuLyoqXG4gKiBAY2F0ZWdvcnkgc2VxdWVuY2luZ1xuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIGNoYWluRWl0aGVySyA9IFxuLyojX19QVVJFX18qLyBjaGFpbkVpdGhlcktfKEZyb21FaXRoZXIsIENoYWluKTtcbi8qKlxuICogQWxpYXMgb2YgYHRhcEVpdGhlcmAuXG4gKlxuICogQGNhdGVnb3J5IGxlZ2FjeVxuICogQHNpbmNlIDIuMTIuMFxuICovXG5leHBvcnQgdmFyIGNoYWluRmlyc3RFaXRoZXJLID0gdGFwRWl0aGVyO1xuLyoqXG4gKiBDb25zdHJ1Y3RzIGEgbmV3IGBPcHRpb25gIGZyb20gYSBudWxsYWJsZSB0eXBlLiBJZiB0aGUgdmFsdWUgaXMgYG51bGxgIG9yIGB1bmRlZmluZWRgLCByZXR1cm5zIGBOb25lYCwgb3RoZXJ3aXNlXG4gKiByZXR1cm5zIHRoZSB2YWx1ZSB3cmFwcGVkIGluIGEgYFNvbWVgLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBub25lLCBzb21lLCBmcm9tTnVsbGFibGUgfSBmcm9tICdmcC10cy9PcHRpb24nXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChmcm9tTnVsbGFibGUodW5kZWZpbmVkKSwgbm9uZSlcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoZnJvbU51bGxhYmxlKG51bGwpLCBub25lKVxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChmcm9tTnVsbGFibGUoMSksIHNvbWUoMSkpXG4gKlxuICogQGNhdGVnb3J5IGNvbnZlcnNpb25zXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciBmcm9tTnVsbGFibGUgPSBmdW5jdGlvbiAoYSkgeyByZXR1cm4gKGEgPT0gbnVsbCA/IG5vbmUgOiBzb21lKGEpKTsgfTtcbi8qKlxuICogVHJhbnNmb3JtcyBhbiBleGNlcHRpb24gaW50byBhbiBgT3B0aW9uYC4gSWYgYGZgIHRocm93cywgcmV0dXJucyBgTm9uZWAsIG90aGVyd2lzZSByZXR1cm5zIHRoZSBvdXRwdXQgd3JhcHBlZCBpbiBhXG4gKiBgU29tZWAuXG4gKlxuICogU2VlIGFsc28gW2B0cnlDYXRjaEtgXSgjdHJ5Y2F0Y2hrKS5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgbm9uZSwgc29tZSwgdHJ5Q2F0Y2ggfSBmcm9tICdmcC10cy9PcHRpb24nXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChcbiAqICAgdHJ5Q2F0Y2goKCkgPT4ge1xuICogICAgIHRocm93IG5ldyBFcnJvcigpXG4gKiAgIH0pLFxuICogICBub25lXG4gKiApXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKHRyeUNhdGNoKCgpID0+IDEpLCBzb21lKDEpKVxuICpcbiAqIEBjYXRlZ29yeSBpbnRlcm9wXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciB0cnlDYXRjaCA9IGZ1bmN0aW9uIChmKSB7XG4gICAgdHJ5IHtcbiAgICAgICAgcmV0dXJuIHNvbWUoZigpKTtcbiAgICB9XG4gICAgY2F0Y2ggKGUpIHtcbiAgICAgICAgcmV0dXJuIG5vbmU7XG4gICAgfVxufTtcbi8qKlxuICogQ29udmVydHMgYSBmdW5jdGlvbiB0aGF0IG1heSB0aHJvdyB0byBvbmUgcmV0dXJuaW5nIGEgYE9wdGlvbmAuXG4gKlxuICogQGNhdGVnb3J5IGludGVyb3BcbiAqIEBzaW5jZSAyLjEwLjBcbiAqL1xuZXhwb3J0IHZhciB0cnlDYXRjaEsgPSBmdW5jdGlvbiAoZikge1xuICAgIHJldHVybiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBhID0gW107XG4gICAgICAgIGZvciAodmFyIF9pID0gMDsgX2kgPCBhcmd1bWVudHMubGVuZ3RoOyBfaSsrKSB7XG4gICAgICAgICAgICBhW19pXSA9IGFyZ3VtZW50c1tfaV07XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRyeUNhdGNoKGZ1bmN0aW9uICgpIHsgcmV0dXJuIGYuYXBwbHkodm9pZCAwLCBhKTsgfSk7XG4gICAgfTtcbn07XG4vKipcbiAqIFJldHVybnMgYSAqc21hcnQgY29uc3RydWN0b3IqIGZyb20gYSBmdW5jdGlvbiB0aGF0IHJldHVybnMgYSBudWxsYWJsZSB2YWx1ZS5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgZnJvbU51bGxhYmxlSywgbm9uZSwgc29tZSB9IGZyb20gJ2ZwLXRzL09wdGlvbidcbiAqXG4gKiBjb25zdCBmID0gKHM6IHN0cmluZyk6IG51bWJlciB8IHVuZGVmaW5lZCA9PiB7XG4gKiAgIGNvbnN0IG4gPSBwYXJzZUZsb2F0KHMpXG4gKiAgIHJldHVybiBpc05hTihuKSA/IHVuZGVmaW5lZCA6IG5cbiAqIH1cbiAqXG4gKiBjb25zdCBnID0gZnJvbU51bGxhYmxlSyhmKVxuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoZygnMScpLCBzb21lKDEpKVxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChnKCdhJyksIG5vbmUpXG4gKlxuICogQGNhdGVnb3J5IGxpZnRpbmdcbiAqIEBzaW5jZSAyLjkuMFxuICovXG5leHBvcnQgdmFyIGZyb21OdWxsYWJsZUsgPSBmdW5jdGlvbiAoZikgeyByZXR1cm4gZmxvdyhmLCBmcm9tTnVsbGFibGUpOyB9O1xuLyoqXG4gKiBUaGlzIGlzIGBjaGFpbmAgKyBgZnJvbU51bGxhYmxlYCwgdXNlZnVsIHdoZW4gd29ya2luZyB3aXRoIG9wdGlvbmFsIHZhbHVlcy5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgc29tZSwgbm9uZSwgZnJvbU51bGxhYmxlLCBjaGFpbk51bGxhYmxlSyB9IGZyb20gJ2ZwLXRzL09wdGlvbidcbiAqIGltcG9ydCB7IHBpcGUgfSBmcm9tICdmcC10cy9mdW5jdGlvbidcbiAqXG4gKiBpbnRlcmZhY2UgRW1wbG95ZWUge1xuICogICByZWFkb25seSBjb21wYW55Pzoge1xuICogICAgIHJlYWRvbmx5IGFkZHJlc3M/OiB7XG4gKiAgICAgICByZWFkb25seSBzdHJlZXQ/OiB7XG4gKiAgICAgICAgIHJlYWRvbmx5IG5hbWU/OiBzdHJpbmdcbiAqICAgICAgIH1cbiAqICAgICB9XG4gKiAgIH1cbiAqIH1cbiAqXG4gKiBjb25zdCBlbXBsb3llZTE6IEVtcGxveWVlID0geyBjb21wYW55OiB7IGFkZHJlc3M6IHsgc3RyZWV0OiB7IG5hbWU6ICdoaWdoIHN0cmVldCcgfSB9IH0gfVxuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoXG4gKiAgIHBpcGUoXG4gKiAgICAgZnJvbU51bGxhYmxlKGVtcGxveWVlMS5jb21wYW55KSxcbiAqICAgICBjaGFpbk51bGxhYmxlSyhjb21wYW55ID0+IGNvbXBhbnkuYWRkcmVzcyksXG4gKiAgICAgY2hhaW5OdWxsYWJsZUsoYWRkcmVzcyA9PiBhZGRyZXNzLnN0cmVldCksXG4gKiAgICAgY2hhaW5OdWxsYWJsZUsoc3RyZWV0ID0+IHN0cmVldC5uYW1lKVxuICogICApLFxuICogICBzb21lKCdoaWdoIHN0cmVldCcpXG4gKiApXG4gKlxuICogY29uc3QgZW1wbG95ZWUyOiBFbXBsb3llZSA9IHsgY29tcGFueTogeyBhZGRyZXNzOiB7IHN0cmVldDoge30gfSB9IH1cbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKFxuICogICBwaXBlKFxuICogICAgIGZyb21OdWxsYWJsZShlbXBsb3llZTIuY29tcGFueSksXG4gKiAgICAgY2hhaW5OdWxsYWJsZUsoY29tcGFueSA9PiBjb21wYW55LmFkZHJlc3MpLFxuICogICAgIGNoYWluTnVsbGFibGVLKGFkZHJlc3MgPT4gYWRkcmVzcy5zdHJlZXQpLFxuICogICAgIGNoYWluTnVsbGFibGVLKHN0cmVldCA9PiBzdHJlZXQubmFtZSlcbiAqICAgKSxcbiAqICAgbm9uZVxuICogKVxuICpcbiAqIEBjYXRlZ29yeSBzZXF1ZW5jaW5nXG4gKiBAc2luY2UgMi45LjBcbiAqL1xuZXhwb3J0IHZhciBjaGFpbk51bGxhYmxlSyA9IGZ1bmN0aW9uIChmKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChtYSkge1xuICAgICAgICByZXR1cm4gaXNOb25lKG1hKSA/IG5vbmUgOiBmcm9tTnVsbGFibGUoZihtYS52YWx1ZSkpO1xuICAgIH07XG59O1xuLyoqXG4gKiBFeHRyYWN0cyB0aGUgdmFsdWUgb3V0IG9mIHRoZSBzdHJ1Y3R1cmUsIGlmIGl0IGV4aXN0cy4gT3RoZXJ3aXNlIHJldHVybnMgYG51bGxgLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBzb21lLCBub25lLCB0b051bGxhYmxlIH0gZnJvbSAnZnAtdHMvT3B0aW9uJ1xuICogaW1wb3J0IHsgcGlwZSB9IGZyb20gJ2ZwLXRzL2Z1bmN0aW9uJ1xuICpcbiAqIGFzc2VydC5zdHJpY3RFcXVhbChcbiAqICAgcGlwZShcbiAqICAgICBzb21lKDEpLFxuICogICAgIHRvTnVsbGFibGVcbiAqICAgKSxcbiAqICAgMVxuICogKVxuICogYXNzZXJ0LnN0cmljdEVxdWFsKFxuICogICBwaXBlKFxuICogICAgIG5vbmUsXG4gKiAgICAgdG9OdWxsYWJsZVxuICogICApLFxuICogICBudWxsXG4gKiApXG4gKlxuICogQGNhdGVnb3J5IGNvbnZlcnNpb25zXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciB0b051bGxhYmxlID0gLyojX19QVVJFX18qLyBtYXRjaChjb25zdE51bGwsIGlkZW50aXR5KTtcbi8qKlxuICogRXh0cmFjdHMgdGhlIHZhbHVlIG91dCBvZiB0aGUgc3RydWN0dXJlLCBpZiBpdCBleGlzdHMuIE90aGVyd2lzZSByZXR1cm5zIGB1bmRlZmluZWRgLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBzb21lLCBub25lLCB0b1VuZGVmaW5lZCB9IGZyb20gJ2ZwLXRzL09wdGlvbidcbiAqIGltcG9ydCB7IHBpcGUgfSBmcm9tICdmcC10cy9mdW5jdGlvbidcbiAqXG4gKiBhc3NlcnQuc3RyaWN0RXF1YWwoXG4gKiAgIHBpcGUoXG4gKiAgICAgc29tZSgxKSxcbiAqICAgICB0b1VuZGVmaW5lZFxuICogICApLFxuICogICAxXG4gKiApXG4gKiBhc3NlcnQuc3RyaWN0RXF1YWwoXG4gKiAgIHBpcGUoXG4gKiAgICAgbm9uZSxcbiAqICAgICB0b1VuZGVmaW5lZFxuICogICApLFxuICogICB1bmRlZmluZWRcbiAqIClcbiAqXG4gKiBAY2F0ZWdvcnkgY29udmVyc2lvbnNcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIHRvVW5kZWZpbmVkID0gLyojX19QVVJFX18qLyBtYXRjaChjb25zdFVuZGVmaW5lZCwgaWRlbnRpdHkpO1xuZXhwb3J0IGZ1bmN0aW9uIGVsZW0oRSkge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYSwgbWEpIHtcbiAgICAgICAgaWYgKG1hID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIHZhciBlbGVtRV8xID0gZWxlbShFKTtcbiAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbiAobWEpIHsgcmV0dXJuIGVsZW1FXzEoYSwgbWEpOyB9O1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBpc05vbmUobWEpID8gZmFsc2UgOiBFLmVxdWFscyhhLCBtYS52YWx1ZSk7XG4gICAgfTtcbn1cbi8qKlxuICogUmV0dXJucyBgdHJ1ZWAgaWYgdGhlIHByZWRpY2F0ZSBpcyBzYXRpc2ZpZWQgYnkgdGhlIHdyYXBwZWQgdmFsdWVcbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgc29tZSwgbm9uZSwgZXhpc3RzIH0gZnJvbSAnZnAtdHMvT3B0aW9uJ1xuICogaW1wb3J0IHsgcGlwZSB9IGZyb20gJ2ZwLXRzL2Z1bmN0aW9uJ1xuICpcbiAqIGFzc2VydC5zdHJpY3RFcXVhbChcbiAqICAgcGlwZShcbiAqICAgICBzb21lKDEpLFxuICogICAgIGV4aXN0cyhuID0+IG4gPiAwKVxuICogICApLFxuICogICB0cnVlXG4gKiApXG4gKiBhc3NlcnQuc3RyaWN0RXF1YWwoXG4gKiAgIHBpcGUoXG4gKiAgICAgc29tZSgxKSxcbiAqICAgICBleGlzdHMobiA9PiBuID4gMSlcbiAqICAgKSxcbiAqICAgZmFsc2VcbiAqIClcbiAqIGFzc2VydC5zdHJpY3RFcXVhbChcbiAqICAgcGlwZShcbiAqICAgICBub25lLFxuICogICAgIGV4aXN0cyhuID0+IG4gPiAwKVxuICogICApLFxuICogICBmYWxzZVxuICogKVxuICpcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIGV4aXN0cyA9IGZ1bmN0aW9uIChwcmVkaWNhdGUpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKG1hKSB7XG4gICAgICAgIHJldHVybiBpc05vbmUobWEpID8gZmFsc2UgOiBwcmVkaWNhdGUobWEudmFsdWUpO1xuICAgIH07XG59O1xuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLy8gZG8gbm90YXRpb25cbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8qKlxuICogQGNhdGVnb3J5IGRvIG5vdGF0aW9uXG4gKiBAc2luY2UgMi45LjBcbiAqL1xuZXhwb3J0IHZhciBEbyA9IC8qI19fUFVSRV9fKi8gb2YoXy5lbXB0eVJlY29yZCk7XG4vKipcbiAqIEBjYXRlZ29yeSBkbyBub3RhdGlvblxuICogQHNpbmNlIDIuOC4wXG4gKi9cbmV4cG9ydCB2YXIgYmluZFRvID0gLyojX19QVVJFX18qLyBiaW5kVG9fKEZ1bmN0b3IpO1xudmFyIGxldF8gPSAvKiNfX1BVUkVfXyovIGxldF9fKEZ1bmN0b3IpO1xuZXhwb3J0IHsgXG4vKipcbiAqIEBjYXRlZ29yeSBkbyBub3RhdGlvblxuICogQHNpbmNlIDIuMTMuMFxuICovXG5sZXRfIGFzIGxldCB9O1xuLyoqXG4gKiBAY2F0ZWdvcnkgZG8gbm90YXRpb25cbiAqIEBzaW5jZSAyLjguMFxuICovXG5leHBvcnQgdmFyIGJpbmQgPSAvKiNfX1BVUkVfXyovIGNoYWluYWJsZS5iaW5kKENoYWluKTtcbi8qKlxuICogQGNhdGVnb3J5IGRvIG5vdGF0aW9uXG4gKiBAc2luY2UgMi44LjBcbiAqL1xuZXhwb3J0IHZhciBhcFMgPSAvKiNfX1BVUkVfXyovIGFwU18oQXBwbHkpO1xuLyoqXG4gKiBAc2luY2UgMi4xMS4wXG4gKi9cbmV4cG9ydCB2YXIgQXBUID0gLyojX19QVVJFX18qLyBvZihfLmVtcHR5UmVhZG9ubHlBcnJheSk7XG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vLyBhcnJheSB1dGlsc1xuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLyoqXG4gKiBFcXVpdmFsZW50IHRvIGBSZWFkb25seU5vbkVtcHR5QXJyYXkjdHJhdmVyc2VXaXRoSW5kZXgoQXBwbGljYXRpdmUpYC5cbiAqXG4gKiBAY2F0ZWdvcnkgdHJhdmVyc2luZ1xuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIHRyYXZlcnNlUmVhZG9ubHlOb25FbXB0eUFycmF5V2l0aEluZGV4ID0gZnVuY3Rpb24gKGYpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIHZhciBvID0gZigwLCBfLmhlYWQoYXMpKTtcbiAgICAgICAgaWYgKGlzTm9uZShvKSkge1xuICAgICAgICAgICAgcmV0dXJuIG5vbmU7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIG91dCA9IFtvLnZhbHVlXTtcbiAgICAgICAgZm9yICh2YXIgaSA9IDE7IGkgPCBhcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgdmFyIG9fMSA9IGYoaSwgYXNbaV0pO1xuICAgICAgICAgICAgaWYgKGlzTm9uZShvXzEpKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG5vbmU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBvdXQucHVzaChvXzEudmFsdWUpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBzb21lKG91dCk7XG4gICAgfTtcbn07XG4vKipcbiAqIEVxdWl2YWxlbnQgdG8gYFJlYWRvbmx5QXJyYXkjdHJhdmVyc2VXaXRoSW5kZXgoQXBwbGljYXRpdmUpYC5cbiAqXG4gKiBAY2F0ZWdvcnkgdHJhdmVyc2luZ1xuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIHRyYXZlcnNlUmVhZG9ubHlBcnJheVdpdGhJbmRleCA9IGZ1bmN0aW9uIChmKSB7XG4gICAgdmFyIGcgPSB0cmF2ZXJzZVJlYWRvbmx5Tm9uRW1wdHlBcnJheVdpdGhJbmRleChmKTtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7IHJldHVybiAoXy5pc05vbkVtcHR5KGFzKSA/IGcoYXMpIDogQXBUKTsgfTtcbn07XG4vKipcbiAqIEVxdWl2YWxlbnQgdG8gYFJlYWRvbmx5QXJyYXkjdHJhdmVyc2VXaXRoSW5kZXgoQXBwbGljYXRpdmUpYC5cbiAqXG4gKiBAY2F0ZWdvcnkgdHJhdmVyc2luZ1xuICogQHNpbmNlIDIuOS4wXG4gKi9cbmV4cG9ydCB2YXIgdHJhdmVyc2VBcnJheVdpdGhJbmRleCA9IHRyYXZlcnNlUmVhZG9ubHlBcnJheVdpdGhJbmRleDtcbi8qKlxuICogRXF1aXZhbGVudCB0byBgUmVhZG9ubHlBcnJheSN0cmF2ZXJzZShBcHBsaWNhdGl2ZSlgLlxuICpcbiAqIEBjYXRlZ29yeSB0cmF2ZXJzaW5nXG4gKiBAc2luY2UgMi45LjBcbiAqL1xuZXhwb3J0IHZhciB0cmF2ZXJzZUFycmF5ID0gZnVuY3Rpb24gKGYpIHtcbiAgICByZXR1cm4gdHJhdmVyc2VSZWFkb25seUFycmF5V2l0aEluZGV4KGZ1bmN0aW9uIChfLCBhKSB7IHJldHVybiBmKGEpOyB9KTtcbn07XG4vKipcbiAqIEVxdWl2YWxlbnQgdG8gYFJlYWRvbmx5QXJyYXkjc2VxdWVuY2UoQXBwbGljYXRpdmUpYC5cbiAqXG4gKiBAY2F0ZWdvcnkgdHJhdmVyc2luZ1xuICogQHNpbmNlIDIuOS4wXG4gKi9cbmV4cG9ydCB2YXIgc2VxdWVuY2VBcnJheSA9IFxuLyojX19QVVJFX18qLyB0cmF2ZXJzZUFycmF5KGlkZW50aXR5KTtcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8vIGxlZ2FjeVxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLyoqXG4gKiBBbGlhcyBvZiBgZmxhdE1hcGAuXG4gKlxuICogQGNhdGVnb3J5IGxlZ2FjeVxuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgY2hhaW4gPSBmbGF0TWFwO1xuLyoqXG4gKiBBbGlhcyBvZiBgdGFwYC5cbiAqXG4gKiBAY2F0ZWdvcnkgbGVnYWN5XG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciBjaGFpbkZpcnN0ID0gdGFwO1xuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLy8gZGVwcmVjYXRlZFxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLyoqXG4gKiBVc2UgYFJlZmluZW1lbnRgIG1vZHVsZSBpbnN0ZWFkLlxuICpcbiAqIEBjYXRlZ29yeSB6b25lIG9mIGRlYXRoXG4gKiBAc2luY2UgMi4wLjBcbiAqIEBkZXByZWNhdGVkXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBnZXRSZWZpbmVtZW50KGdldE9wdGlvbikge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYSkgeyByZXR1cm4gaXNTb21lKGdldE9wdGlvbihhKSk7IH07XG59XG4vKipcbiAqIFVzZSBbYGNoYWluTnVsbGFibGVLYF0oI2NoYWlubnVsbGFibGVrKSBpbnN0ZWFkLlxuICpcbiAqIEBjYXRlZ29yeSB6b25lIG9mIGRlYXRoXG4gKiBAc2luY2UgMi4wLjBcbiAqIEBkZXByZWNhdGVkXG4gKi9cbmV4cG9ydCB2YXIgbWFwTnVsbGFibGUgPSBjaGFpbk51bGxhYmxlSztcbi8qKlxuICogVGhpcyBpbnN0YW5jZSBpcyBkZXByZWNhdGVkLCB1c2Ugc21hbGwsIHNwZWNpZmljIGluc3RhbmNlcyBpbnN0ZWFkLlxuICogRm9yIGV4YW1wbGUgaWYgYSBmdW5jdGlvbiBuZWVkcyBhIGBGdW5jdG9yYCBpbnN0YW5jZSwgcGFzcyBgTy5GdW5jdG9yYCBpbnN0ZWFkIG9mIGBPLm9wdGlvbmBcbiAqICh3aGVyZSBgT2AgaXMgZnJvbSBgaW1wb3J0IE8gZnJvbSAnZnAtdHMvT3B0aW9uJ2ApXG4gKlxuICogQGNhdGVnb3J5IHpvbmUgb2YgZGVhdGhcbiAqIEBzaW5jZSAyLjAuMFxuICogQGRlcHJlY2F0ZWRcbiAqL1xuZXhwb3J0IHZhciBvcHRpb24gPSB7XG4gICAgVVJJOiBVUkksXG4gICAgbWFwOiBfbWFwLFxuICAgIG9mOiBvZixcbiAgICBhcDogX2FwLFxuICAgIGNoYWluOiBmbGF0TWFwLFxuICAgIHJlZHVjZTogX3JlZHVjZSxcbiAgICBmb2xkTWFwOiBfZm9sZE1hcCxcbiAgICByZWR1Y2VSaWdodDogX3JlZHVjZVJpZ2h0LFxuICAgIHRyYXZlcnNlOiBfdHJhdmVyc2UsXG4gICAgc2VxdWVuY2U6IHNlcXVlbmNlLFxuICAgIHplcm86IHplcm8sXG4gICAgYWx0OiBfYWx0LFxuICAgIGV4dGVuZDogX2V4dGVuZCxcbiAgICBjb21wYWN0OiBjb21wYWN0LFxuICAgIHNlcGFyYXRlOiBzZXBhcmF0ZSxcbiAgICBmaWx0ZXI6IF9maWx0ZXIsXG4gICAgZmlsdGVyTWFwOiBfZmlsdGVyTWFwLFxuICAgIHBhcnRpdGlvbjogX3BhcnRpdGlvbixcbiAgICBwYXJ0aXRpb25NYXA6IF9wYXJ0aXRpb25NYXAsXG4gICAgd2l0aGVyOiBfd2l0aGVyLFxuICAgIHdpbHQ6IF93aWx0LFxuICAgIHRocm93RXJyb3I6IHRocm93RXJyb3Jcbn07XG4vKipcbiAqIFVzZSBbYGdldEFwcGx5U2VtaWdyb3VwYF0oLi9BcHBseS50cy5odG1sI2dldGFwcGx5c2VtaWdyb3VwKSBpbnN0ZWFkLlxuICpcbiAqIEBjYXRlZ29yeSB6b25lIG9mIGRlYXRoXG4gKiBAc2luY2UgMi4wLjBcbiAqIEBkZXByZWNhdGVkXG4gKi9cbmV4cG9ydCB2YXIgZ2V0QXBwbHlTZW1pZ3JvdXAgPSAvKiNfX1BVUkVfXyovIGdldEFwcGx5U2VtaWdyb3VwXyhBcHBseSk7XG4vKipcbiAqIFVzZSBbYGdldEFwcGxpY2F0aXZlTW9ub2lkYF0oLi9BcHBsaWNhdGl2ZS50cy5odG1sI2dldGFwcGxpY2F0aXZlbW9ub2lkKSBpbnN0ZWFkLlxuICpcbiAqIEBjYXRlZ29yeSB6b25lIG9mIGRlYXRoXG4gKiBAc2luY2UgMi4wLjBcbiAqIEBkZXByZWNhdGVkXG4gKi9cbmV4cG9ydCB2YXIgZ2V0QXBwbHlNb25vaWQgPSAvKiNfX1BVUkVfXyovIGdldEFwcGxpY2F0aXZlTW9ub2lkKEFwcGxpY2F0aXZlKTtcbi8qKlxuICogVXNlXG4gKlxuICogYGBgdHNcbiAqIGltcG9ydCB7IGZpcnN0IH0gZnJvbSAnZnAtdHMvU2VtaWdyb3VwJ1xuICogaW1wb3J0IHsgZ2V0TW9ub2lkIH0gZnJvbSAnZnAtdHMvT3B0aW9uJ1xuICpcbiAqIGdldE1vbm9pZChmaXJzdCgpKVxuICogYGBgXG4gKlxuICogaW5zdGVhZC5cbiAqXG4gKiBNb25vaWQgcmV0dXJuaW5nIHRoZSBsZWZ0LW1vc3Qgbm9uLWBOb25lYCB2YWx1ZVxuICpcbiAqIHwgeCAgICAgICB8IHkgICAgICAgfCBjb25jYXQoeCwgeSkgfFxuICogfCAtLS0tLS0tIHwgLS0tLS0tLSB8IC0tLS0tLS0tLS0tLSB8XG4gKiB8IG5vbmUgICAgfCBub25lICAgIHwgbm9uZSAgICAgICAgIHxcbiAqIHwgc29tZShhKSB8IG5vbmUgICAgfCBzb21lKGEpICAgICAgfFxuICogfCBub25lICAgIHwgc29tZShiKSB8IHNvbWUoYikgICAgICB8XG4gKiB8IHNvbWUoYSkgfCBzb21lKGIpIHwgc29tZShhKSAgICAgIHxcbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgZ2V0Rmlyc3RNb25vaWQsIHNvbWUsIG5vbmUgfSBmcm9tICdmcC10cy9PcHRpb24nXG4gKlxuICogY29uc3QgTSA9IGdldEZpcnN0TW9ub2lkPG51bWJlcj4oKVxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChNLmNvbmNhdChub25lLCBub25lKSwgbm9uZSlcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoTS5jb25jYXQoc29tZSgxKSwgbm9uZSksIHNvbWUoMSkpXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKE0uY29uY2F0KG5vbmUsIHNvbWUoMikpLCBzb21lKDIpKVxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChNLmNvbmNhdChzb21lKDEpLCBzb21lKDIpKSwgc29tZSgxKSlcbiAqXG4gKiBAY2F0ZWdvcnkgem9uZSBvZiBkZWF0aFxuICogQHNpbmNlIDIuMC4wXG4gKiBAZGVwcmVjYXRlZFxuICovXG5leHBvcnQgdmFyIGdldEZpcnN0TW9ub2lkID0gZnVuY3Rpb24gKCkgeyByZXR1cm4gZ2V0TW9ub2lkKGZpcnN0KCkpOyB9O1xuLyoqXG4gKiBVc2VcbiAqXG4gKiBgYGB0c1xuICogaW1wb3J0IHsgbGFzdCB9IGZyb20gJ2ZwLXRzL1NlbWlncm91cCdcbiAqIGltcG9ydCB7IGdldE1vbm9pZCB9IGZyb20gJ2ZwLXRzL09wdGlvbidcbiAqXG4gKiBnZXRNb25vaWQobGFzdCgpKVxuICogYGBgXG4gKlxuICogaW5zdGVhZC5cbiAqXG4gKiBNb25vaWQgcmV0dXJuaW5nIHRoZSByaWdodC1tb3N0IG5vbi1gTm9uZWAgdmFsdWVcbiAqXG4gKiB8IHggICAgICAgfCB5ICAgICAgIHwgY29uY2F0KHgsIHkpIHxcbiAqIHwgLS0tLS0tLSB8IC0tLS0tLS0gfCAtLS0tLS0tLS0tLS0gfFxuICogfCBub25lICAgIHwgbm9uZSAgICB8IG5vbmUgICAgICAgICB8XG4gKiB8IHNvbWUoYSkgfCBub25lICAgIHwgc29tZShhKSAgICAgIHxcbiAqIHwgbm9uZSAgICB8IHNvbWUoYikgfCBzb21lKGIpICAgICAgfFxuICogfCBzb21lKGEpIHwgc29tZShiKSB8IHNvbWUoYikgICAgICB8XG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IGdldExhc3RNb25vaWQsIHNvbWUsIG5vbmUgfSBmcm9tICdmcC10cy9PcHRpb24nXG4gKlxuICogY29uc3QgTSA9IGdldExhc3RNb25vaWQ8bnVtYmVyPigpXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKE0uY29uY2F0KG5vbmUsIG5vbmUpLCBub25lKVxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChNLmNvbmNhdChzb21lKDEpLCBub25lKSwgc29tZSgxKSlcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoTS5jb25jYXQobm9uZSwgc29tZSgyKSksIHNvbWUoMikpXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKE0uY29uY2F0KHNvbWUoMSksIHNvbWUoMikpLCBzb21lKDIpKVxuICpcbiAqIEBjYXRlZ29yeSB6b25lIG9mIGRlYXRoXG4gKiBAc2luY2UgMi4wLjBcbiAqIEBkZXByZWNhdGVkXG4gKi9cbmV4cG9ydCB2YXIgZ2V0TGFzdE1vbm9pZCA9IGZ1bmN0aW9uICgpIHsgcmV0dXJuIGdldE1vbm9pZChsYXN0KCkpOyB9O1xuIiwKICAiaW1wb3J0IHsgZ2V0QXBwbGljYXRpdmVNb25vaWQgfSBmcm9tICcuL0FwcGxpY2F0aXZlJztcbmltcG9ydCB7IGFwRmlyc3QgYXMgYXBGaXJzdF8sIGFwUyBhcyBhcFNfLCBhcFNlY29uZCBhcyBhcFNlY29uZF8sIGdldEFwcGx5U2VtaWdyb3VwIGFzIGdldEFwcGx5U2VtaWdyb3VwXyB9IGZyb20gJy4vQXBwbHknO1xuaW1wb3J0ICogYXMgY2hhaW5hYmxlIGZyb20gJy4vQ2hhaW4nO1xuaW1wb3J0IHsgY2hhaW5FaXRoZXJLIGFzIGNoYWluRWl0aGVyS18sIGZyb21FaXRoZXJLIGFzIGZyb21FaXRoZXJLXywgdGFwRWl0aGVyIGFzIHRhcEVpdGhlcl8gfSBmcm9tICcuL0Zyb21FaXRoZXInO1xuaW1wb3J0IHsgY29uc3ROdWxsLCBjb25zdFVuZGVmaW5lZCwgZHVhbCwgZmxvdywgaWRlbnRpdHksIHBpcGUgfSBmcm9tICcuL2Z1bmN0aW9uJztcbmltcG9ydCB7IGFzIGFzIGFzXywgYXNVbml0IGFzIGFzVW5pdF8sIGJpbmRUbyBhcyBiaW5kVG9fLCBmbGFwIGFzIGZsYXBfLCBsZXQgYXMgbGV0X18gfSBmcm9tICcuL0Z1bmN0b3InO1xuaW1wb3J0ICogYXMgXyBmcm9tICcuL2ludGVybmFsJztcbmltcG9ydCB7IG5vdCB9IGZyb20gJy4vUHJlZGljYXRlJztcbmltcG9ydCB7IGZpcnN0LCBsYXN0IH0gZnJvbSAnLi9TZW1pZ3JvdXAnO1xuaW1wb3J0IHsgc2VwYXJhdGVkIH0gZnJvbSAnLi9TZXBhcmF0ZWQnO1xuaW1wb3J0IHsgd2lsdERlZmF1bHQsIHdpdGhlckRlZmF1bHQgfSBmcm9tICcuL1dpdGhlcmFibGUnO1xuaW1wb3J0IHsgZ3VhcmQgYXMgZ3VhcmRfIH0gZnJvbSAnLi9aZXJvJztcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8vIGNvbnN0cnVjdG9yc1xuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLyoqXG4gKiBgTm9uZWAgZG9lc24ndCBoYXZlIGEgY29uc3RydWN0b3IsIGluc3RlYWQgeW91IGNhbiB1c2UgaXQgZGlyZWN0bHkgYXMgYSB2YWx1ZS4gUmVwcmVzZW50cyBhIG1pc3NpbmcgdmFsdWUuXG4gKlxuICogQGNhdGVnb3J5IGNvbnN0cnVjdG9yc1xuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgbm9uZSA9IF8ubm9uZTtcbi8qKlxuICogQ29uc3RydWN0cyBhIGBTb21lYC4gUmVwcmVzZW50cyBhbiBvcHRpb25hbCB2YWx1ZSB0aGF0IGV4aXN0cy5cbiAqXG4gKiBAY2F0ZWdvcnkgY29uc3RydWN0b3JzXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciBzb21lID0gXy5zb21lO1xuZXhwb3J0IGZ1bmN0aW9uIGZyb21QcmVkaWNhdGUocHJlZGljYXRlKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhKSB7IHJldHVybiAocHJlZGljYXRlKGEpID8gc29tZShhKSA6IG5vbmUpOyB9O1xufVxuLyoqXG4gKiBSZXR1cm5zIHRoZSBgTGVmdGAgdmFsdWUgb2YgYW4gYEVpdGhlcmAgaWYgcG9zc2libGUuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IGdldExlZnQsIG5vbmUsIHNvbWUgfSBmcm9tICdmcC10cy9PcHRpb24nXG4gKiBpbXBvcnQgeyByaWdodCwgbGVmdCB9IGZyb20gJ2ZwLXRzL0VpdGhlcidcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKGdldExlZnQocmlnaHQoMSkpLCBub25lKVxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChnZXRMZWZ0KGxlZnQoJ2EnKSksIHNvbWUoJ2EnKSlcbiAqXG4gKiBAY2F0ZWdvcnkgY29uc3RydWN0b3JzXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciBnZXRMZWZ0ID0gZnVuY3Rpb24gKG1hKSB7IHJldHVybiAobWEuX3RhZyA9PT0gJ1JpZ2h0JyA/IG5vbmUgOiBzb21lKG1hLmxlZnQpKTsgfTtcbi8qKlxuICogUmV0dXJucyB0aGUgYFJpZ2h0YCB2YWx1ZSBvZiBhbiBgRWl0aGVyYCBpZiBwb3NzaWJsZS5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgZ2V0UmlnaHQsIG5vbmUsIHNvbWUgfSBmcm9tICdmcC10cy9PcHRpb24nXG4gKiBpbXBvcnQgeyByaWdodCwgbGVmdCB9IGZyb20gJ2ZwLXRzL0VpdGhlcidcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKGdldFJpZ2h0KHJpZ2h0KDEpKSwgc29tZSgxKSlcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoZ2V0UmlnaHQobGVmdCgnYScpKSwgbm9uZSlcbiAqXG4gKiBAY2F0ZWdvcnkgY29uc3RydWN0b3JzXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciBnZXRSaWdodCA9IGZ1bmN0aW9uIChtYSkgeyByZXR1cm4gKG1hLl90YWcgPT09ICdMZWZ0JyA/IG5vbmUgOiBzb21lKG1hLnJpZ2h0KSk7IH07XG52YXIgX21hcCA9IGZ1bmN0aW9uIChmYSwgZikgeyByZXR1cm4gcGlwZShmYSwgbWFwKGYpKTsgfTtcbnZhciBfYXAgPSBmdW5jdGlvbiAoZmFiLCBmYSkgeyByZXR1cm4gcGlwZShmYWIsIGFwKGZhKSk7IH07XG52YXIgX3JlZHVjZSA9IGZ1bmN0aW9uIChmYSwgYiwgZikgeyByZXR1cm4gcGlwZShmYSwgcmVkdWNlKGIsIGYpKTsgfTtcbnZhciBfZm9sZE1hcCA9IGZ1bmN0aW9uIChNKSB7XG4gICAgdmFyIGZvbGRNYXBNID0gZm9sZE1hcChNKTtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGZhLCBmKSB7IHJldHVybiBwaXBlKGZhLCBmb2xkTWFwTShmKSk7IH07XG59O1xudmFyIF9yZWR1Y2VSaWdodCA9IGZ1bmN0aW9uIChmYSwgYiwgZikgeyByZXR1cm4gcGlwZShmYSwgcmVkdWNlUmlnaHQoYiwgZikpOyB9O1xudmFyIF90cmF2ZXJzZSA9IGZ1bmN0aW9uIChGKSB7XG4gICAgdmFyIHRyYXZlcnNlRiA9IHRyYXZlcnNlKEYpO1xuICAgIHJldHVybiBmdW5jdGlvbiAodGEsIGYpIHsgcmV0dXJuIHBpcGUodGEsIHRyYXZlcnNlRihmKSk7IH07XG59O1xuLyogaXN0YW5idWwgaWdub3JlIG5leHQgKi9cbnZhciBfYWx0ID0gZnVuY3Rpb24gKGZhLCB0aGF0KSB7IHJldHVybiBwaXBlKGZhLCBhbHQodGhhdCkpOyB9O1xudmFyIF9maWx0ZXIgPSBmdW5jdGlvbiAoZmEsIHByZWRpY2F0ZSkgeyByZXR1cm4gcGlwZShmYSwgZmlsdGVyKHByZWRpY2F0ZSkpOyB9O1xuLyogaXN0YW5idWwgaWdub3JlIG5leHQgKi9cbnZhciBfZmlsdGVyTWFwID0gZnVuY3Rpb24gKGZhLCBmKSB7IHJldHVybiBwaXBlKGZhLCBmaWx0ZXJNYXAoZikpOyB9O1xuLyogaXN0YW5idWwgaWdub3JlIG5leHQgKi9cbnZhciBfZXh0ZW5kID0gZnVuY3Rpb24gKHdhLCBmKSB7IHJldHVybiBwaXBlKHdhLCBleHRlbmQoZikpOyB9O1xuLyogaXN0YW5idWwgaWdub3JlIG5leHQgKi9cbnZhciBfcGFydGl0aW9uID0gZnVuY3Rpb24gKGZhLCBwcmVkaWNhdGUpIHtcbiAgICByZXR1cm4gcGlwZShmYSwgcGFydGl0aW9uKHByZWRpY2F0ZSkpO1xufTtcbi8qIGlzdGFuYnVsIGlnbm9yZSBuZXh0ICovXG52YXIgX3BhcnRpdGlvbk1hcCA9IGZ1bmN0aW9uIChmYSwgZikgeyByZXR1cm4gcGlwZShmYSwgcGFydGl0aW9uTWFwKGYpKTsgfTtcbi8qKlxuICogQGNhdGVnb3J5IHR5cGUgbGFtYmRhc1xuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgVVJJID0gJ09wdGlvbic7XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIGdldFNob3cgPSBmdW5jdGlvbiAoUykgeyByZXR1cm4gKHtcbiAgICBzaG93OiBmdW5jdGlvbiAobWEpIHsgcmV0dXJuIChpc05vbmUobWEpID8gJ25vbmUnIDogXCJzb21lKFwiLmNvbmNhdChTLnNob3cobWEudmFsdWUpLCBcIilcIikpOyB9XG59KTsgfTtcbi8qKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IG5vbmUsIHNvbWUsIGdldEVxIH0gZnJvbSAnZnAtdHMvT3B0aW9uJ1xuICogaW1wb3J0ICogYXMgTiBmcm9tICdmcC10cy9udW1iZXInXG4gKlxuICogY29uc3QgRSA9IGdldEVxKE4uRXEpXG4gKiBhc3NlcnQuc3RyaWN0RXF1YWwoRS5lcXVhbHMobm9uZSwgbm9uZSksIHRydWUpXG4gKiBhc3NlcnQuc3RyaWN0RXF1YWwoRS5lcXVhbHMobm9uZSwgc29tZSgxKSksIGZhbHNlKVxuICogYXNzZXJ0LnN0cmljdEVxdWFsKEUuZXF1YWxzKHNvbWUoMSksIG5vbmUpLCBmYWxzZSlcbiAqIGFzc2VydC5zdHJpY3RFcXVhbChFLmVxdWFscyhzb21lKDEpLCBzb21lKDIpKSwgZmFsc2UpXG4gKiBhc3NlcnQuc3RyaWN0RXF1YWwoRS5lcXVhbHMoc29tZSgxKSwgc29tZSgxKSksIHRydWUpXG4gKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgZ2V0RXEgPSBmdW5jdGlvbiAoRSkgeyByZXR1cm4gKHtcbiAgICBlcXVhbHM6IGZ1bmN0aW9uICh4LCB5KSB7IHJldHVybiB4ID09PSB5IHx8IChpc05vbmUoeCkgPyBpc05vbmUoeSkgOiBpc05vbmUoeSkgPyBmYWxzZSA6IEUuZXF1YWxzKHgudmFsdWUsIHkudmFsdWUpKTsgfVxufSk7IH07XG4vKipcbiAqIFRoZSBgT3JkYCBpbnN0YW5jZSBhbGxvd3MgYE9wdGlvbmAgdmFsdWVzIHRvIGJlIGNvbXBhcmVkIHdpdGhcbiAqIGBjb21wYXJlYCwgd2hlbmV2ZXIgdGhlcmUgaXMgYW4gYE9yZGAgaW5zdGFuY2UgZm9yXG4gKiB0aGUgdHlwZSB0aGUgYE9wdGlvbmAgY29udGFpbnMuXG4gKlxuICogYE5vbmVgIGlzIGNvbnNpZGVyZWQgdG8gYmUgbGVzcyB0aGFuIGFueSBgU29tZWAgdmFsdWUuXG4gKlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBub25lLCBzb21lLCBnZXRPcmQgfSBmcm9tICdmcC10cy9PcHRpb24nXG4gKiBpbXBvcnQgKiBhcyBOIGZyb20gJ2ZwLXRzL251bWJlcidcbiAqXG4gKiBjb25zdCBPID0gZ2V0T3JkKE4uT3JkKVxuICogYXNzZXJ0LnN0cmljdEVxdWFsKE8uY29tcGFyZShub25lLCBub25lKSwgMClcbiAqIGFzc2VydC5zdHJpY3RFcXVhbChPLmNvbXBhcmUobm9uZSwgc29tZSgxKSksIC0xKVxuICogYXNzZXJ0LnN0cmljdEVxdWFsKE8uY29tcGFyZShzb21lKDEpLCBub25lKSwgMSlcbiAqIGFzc2VydC5zdHJpY3RFcXVhbChPLmNvbXBhcmUoc29tZSgxKSwgc29tZSgyKSksIC0xKVxuICogYXNzZXJ0LnN0cmljdEVxdWFsKE8uY29tcGFyZShzb21lKDEpLCBzb21lKDEpKSwgMClcbiAqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciBnZXRPcmQgPSBmdW5jdGlvbiAoTykgeyByZXR1cm4gKHtcbiAgICBlcXVhbHM6IGdldEVxKE8pLmVxdWFscyxcbiAgICBjb21wYXJlOiBmdW5jdGlvbiAoeCwgeSkgeyByZXR1cm4gKHggPT09IHkgPyAwIDogaXNTb21lKHgpID8gKGlzU29tZSh5KSA/IE8uY29tcGFyZSh4LnZhbHVlLCB5LnZhbHVlKSA6IDEpIDogLTEpOyB9XG59KTsgfTtcbi8qKlxuICogTW9ub2lkIHJldHVybmluZyB0aGUgbGVmdC1tb3N0IG5vbi1gTm9uZWAgdmFsdWUuIElmIGJvdGggb3BlcmFuZHMgYXJlIGBTb21lYHMgdGhlbiB0aGUgaW5uZXIgdmFsdWVzIGFyZVxuICogY29uY2F0ZW5hdGVkIHVzaW5nIHRoZSBwcm92aWRlZCBgU2VtaWdyb3VwYFxuICpcbiAqIHwgeCAgICAgICB8IHkgICAgICAgfCBjb25jYXQoeCwgeSkgICAgICAgfFxuICogfCAtLS0tLS0tIHwgLS0tLS0tLSB8IC0tLS0tLS0tLS0tLS0tLS0tLSB8XG4gKiB8IG5vbmUgICAgfCBub25lICAgIHwgbm9uZSAgICAgICAgICAgICAgIHxcbiAqIHwgc29tZShhKSB8IG5vbmUgICAgfCBzb21lKGEpICAgICAgICAgICAgfFxuICogfCBub25lICAgIHwgc29tZShiKSB8IHNvbWUoYikgICAgICAgICAgICB8XG4gKiB8IHNvbWUoYSkgfCBzb21lKGIpIHwgc29tZShjb25jYXQoYSwgYikpIHxcbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgZ2V0TW9ub2lkLCBzb21lLCBub25lIH0gZnJvbSAnZnAtdHMvT3B0aW9uJ1xuICogaW1wb3J0IHsgU2VtaWdyb3VwU3VtIH0gZnJvbSAnZnAtdHMvbnVtYmVyJ1xuICpcbiAqIGNvbnN0IE0gPSBnZXRNb25vaWQoU2VtaWdyb3VwU3VtKVxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChNLmNvbmNhdChub25lLCBub25lKSwgbm9uZSlcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoTS5jb25jYXQoc29tZSgxKSwgbm9uZSksIHNvbWUoMSkpXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKE0uY29uY2F0KG5vbmUsIHNvbWUoMSkpLCBzb21lKDEpKVxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChNLmNvbmNhdChzb21lKDEpLCBzb21lKDIpKSwgc29tZSgzKSlcbiAqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciBnZXRNb25vaWQgPSBmdW5jdGlvbiAoUykgeyByZXR1cm4gKHtcbiAgICBjb25jYXQ6IGZ1bmN0aW9uICh4LCB5KSB7IHJldHVybiAoaXNOb25lKHgpID8geSA6IGlzTm9uZSh5KSA/IHggOiBzb21lKFMuY29uY2F0KHgudmFsdWUsIHkudmFsdWUpKSk7IH0sXG4gICAgZW1wdHk6IG5vbmVcbn0pOyB9O1xuLyoqXG4gKiBAY2F0ZWdvcnkgbWFwcGluZ1xuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgbWFwID0gZnVuY3Rpb24gKGYpIHsgcmV0dXJuIGZ1bmN0aW9uIChmYSkge1xuICAgIHJldHVybiBpc05vbmUoZmEpID8gbm9uZSA6IHNvbWUoZihmYS52YWx1ZSkpO1xufTsgfTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuNy4wXG4gKi9cbmV4cG9ydCB2YXIgRnVuY3RvciA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICBtYXA6IF9tYXBcbn07XG4vKipcbiAqIE1hcHMgdGhlIGBTb21lYCB2YWx1ZSBvZiB0aGlzIGBPcHRpb25gIHRvIHRoZSBzcGVjaWZpZWQgY29uc3RhbnQgdmFsdWUuXG4gKlxuICogQGNhdGVnb3J5IG1hcHBpbmdcbiAqIEBzaW5jZSAyLjE2LjBcbiAqL1xuZXhwb3J0IHZhciBhcyA9IGR1YWwoMiwgYXNfKEZ1bmN0b3IpKTtcbi8qKlxuICogTWFwcyB0aGUgYFNvbWVgIHZhbHVlIG9mIHRoaXMgYE9wdGlvbmAgdG8gdGhlIHZvaWQgY29uc3RhbnQgdmFsdWUuXG4gKlxuICogQGNhdGVnb3J5IG1hcHBpbmdcbiAqIEBzaW5jZSAyLjE2LjBcbiAqL1xuZXhwb3J0IHZhciBhc1VuaXQgPSBhc1VuaXRfKEZ1bmN0b3IpO1xuLyoqXG4gKiBAY2F0ZWdvcnkgY29uc3RydWN0b3JzXG4gKiBAc2luY2UgMi43LjBcbiAqL1xuZXhwb3J0IHZhciBvZiA9IHNvbWU7XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjEwLjBcbiAqL1xuZXhwb3J0IHZhciBQb2ludGVkID0ge1xuICAgIFVSSTogVVJJLFxuICAgIG9mOiBvZlxufTtcbi8qKlxuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgYXAgPSBmdW5jdGlvbiAoZmEpIHsgcmV0dXJuIGZ1bmN0aW9uIChmYWIpIHtcbiAgICByZXR1cm4gaXNOb25lKGZhYikgPyBub25lIDogaXNOb25lKGZhKSA/IG5vbmUgOiBzb21lKGZhYi52YWx1ZShmYS52YWx1ZSkpO1xufTsgfTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuMTAuMFxuICovXG5leHBvcnQgdmFyIEFwcGx5ID0ge1xuICAgIFVSSTogVVJJLFxuICAgIG1hcDogX21hcCxcbiAgICBhcDogX2FwXG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi43LjBcbiAqL1xuZXhwb3J0IHZhciBBcHBsaWNhdGl2ZSA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICBtYXA6IF9tYXAsXG4gICAgYXA6IF9hcCxcbiAgICBvZjogb2Zcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBzZXF1ZW5jaW5nXG4gKiBAc2luY2UgMi4xNC4wXG4gKi9cbmV4cG9ydCB2YXIgZmxhdE1hcCA9IC8qI19fUFVSRV9fKi8gZHVhbCgyLCBmdW5jdGlvbiAobWEsIGYpIHsgcmV0dXJuIChpc05vbmUobWEpID8gbm9uZSA6IGYobWEudmFsdWUpKTsgfSk7XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjEwLjBcbiAqL1xuZXhwb3J0IHZhciBDaGFpbiA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICBtYXA6IF9tYXAsXG4gICAgYXA6IF9hcCxcbiAgICBjaGFpbjogZmxhdE1hcFxufTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuNy4wXG4gKi9cbmV4cG9ydCB2YXIgTW9uYWQgPSB7XG4gICAgVVJJOiBVUkksXG4gICAgbWFwOiBfbWFwLFxuICAgIGFwOiBfYXAsXG4gICAgb2Y6IG9mLFxuICAgIGNoYWluOiBmbGF0TWFwXG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgZm9sZGluZ1xuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgcmVkdWNlID0gZnVuY3Rpb24gKGIsIGYpIHsgcmV0dXJuIGZ1bmN0aW9uIChmYSkge1xuICAgIHJldHVybiBpc05vbmUoZmEpID8gYiA6IGYoYiwgZmEudmFsdWUpO1xufTsgfTtcbi8qKlxuICogQGNhdGVnb3J5IGZvbGRpbmdcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIGZvbGRNYXAgPSBmdW5jdGlvbiAoTSkgeyByZXR1cm4gZnVuY3Rpb24gKGYpIHsgcmV0dXJuIGZ1bmN0aW9uIChmYSkge1xuICAgIHJldHVybiBpc05vbmUoZmEpID8gTS5lbXB0eSA6IGYoZmEudmFsdWUpO1xufTsgfTsgfTtcbi8qKlxuICogQGNhdGVnb3J5IGZvbGRpbmdcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIHJlZHVjZVJpZ2h0ID0gZnVuY3Rpb24gKGIsIGYpIHsgcmV0dXJuIGZ1bmN0aW9uIChmYSkge1xuICAgIHJldHVybiBpc05vbmUoZmEpID8gYiA6IGYoZmEudmFsdWUsIGIpO1xufTsgfTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuNy4wXG4gKi9cbmV4cG9ydCB2YXIgRm9sZGFibGUgPSB7XG4gICAgVVJJOiBVUkksXG4gICAgcmVkdWNlOiBfcmVkdWNlLFxuICAgIGZvbGRNYXA6IF9mb2xkTWFwLFxuICAgIHJlZHVjZVJpZ2h0OiBfcmVkdWNlUmlnaHRcbn07XG4vKipcbiAqIFJldHVybnMgdGhlIHByb3ZpZGVkIGBPcHRpb25gIGB0aGF0YCBpZiBgc2VsZmAgaXMgYE5vbmVgLCBvdGhlcndpc2UgcmV0dXJucyBgc2VsZmAuXG4gKlxuICogQHBhcmFtIHNlbGYgLSBUaGUgZmlyc3QgYE9wdGlvbmAgdG8gYmUgY2hlY2tlZC5cbiAqIEBwYXJhbSB0aGF0IC0gVGhlIGBPcHRpb25gIHRvIHJldHVybiBpZiBgc2VsZmAgaXMgYE5vbmVgLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgKiBhcyBPIGZyb20gXCJmcC10cy9PcHRpb25cIlxuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoTy5vckVsc2UoTy5ub25lLCAoKSA9PiBPLm5vbmUpLCBPLm5vbmUpXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKE8ub3JFbHNlKE8uc29tZSgxKSwgKCkgPT4gTy5ub25lKSwgTy5zb21lKDEpKVxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChPLm9yRWxzZShPLm5vbmUsICgpID0+IE8uc29tZSgnYicpKSwgTy5zb21lKCdiJykpXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKE8ub3JFbHNlKE8uc29tZSgxKSwgKCkgPT4gTy5zb21lKCdiJykpLCBPLnNvbWUoMSkpXG4gKlxuICogQGNhdGVnb3J5IGVycm9yIGhhbmRsaW5nXG4gKiBAc2luY2UgMi4xNi4wXG4gKi9cbmV4cG9ydCB2YXIgb3JFbHNlID0gZHVhbCgyLCBmdW5jdGlvbiAoc2VsZiwgdGhhdCkgeyByZXR1cm4gKGlzTm9uZShzZWxmKSA/IHRoYXQoKSA6IHNlbGYpOyB9KTtcbi8qKlxuICogQWxpYXMgb2YgYG9yRWxzZWAuXG4gKlxuICogTGVzcyBzdHJpY3QgdmVyc2lvbiBvZiBbYGFsdGBdKCNhbHQpLlxuICpcbiAqIFRoZSBgV2Agc3VmZml4IChzaG9ydCBmb3IgKipXKippZGVuaW5nKSBtZWFucyB0aGF0IHRoZSByZXR1cm4gdHlwZXMgd2lsbCBiZSBtZXJnZWQuXG4gKlxuICogQGNhdGVnb3J5IGxlZ2FjeVxuICogQHNpbmNlIDIuOS4wXG4gKi9cbmV4cG9ydCB2YXIgYWx0VyA9IG9yRWxzZTtcbi8qKlxuICogQWxpYXMgb2YgYG9yRWxzZWAuXG4gKlxuICogQGNhdGVnb3J5IGxlZ2FjeVxuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgYWx0ID0gb3JFbHNlO1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi43LjBcbiAqL1xuZXhwb3J0IHZhciBBbHQgPSB7XG4gICAgVVJJOiBVUkksXG4gICAgbWFwOiBfbWFwLFxuICAgIGFsdDogX2FsdFxufTtcbi8qKlxuICogQHNpbmNlIDIuNy4wXG4gKi9cbmV4cG9ydCB2YXIgemVybyA9IGZ1bmN0aW9uICgpIHsgcmV0dXJuIG5vbmU7IH07XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjExLjBcbiAqL1xuZXhwb3J0IHZhciBaZXJvID0ge1xuICAgIFVSSTogVVJJLFxuICAgIHplcm86IHplcm9cbn07XG4vKipcbiAqIEBjYXRlZ29yeSBkbyBub3RhdGlvblxuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIGd1YXJkID0gLyojX19QVVJFX18qLyBndWFyZF8oWmVybywgUG9pbnRlZCk7XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjcuMFxuICovXG5leHBvcnQgdmFyIEFsdGVybmF0aXZlID0ge1xuICAgIFVSSTogVVJJLFxuICAgIG1hcDogX21hcCxcbiAgICBhcDogX2FwLFxuICAgIG9mOiBvZixcbiAgICBhbHQ6IF9hbHQsXG4gICAgemVybzogemVyb1xufTtcbi8qKlxuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgZXh0ZW5kID0gZnVuY3Rpb24gKGYpIHsgcmV0dXJuIGZ1bmN0aW9uICh3YSkge1xuICAgIHJldHVybiBpc05vbmUod2EpID8gbm9uZSA6IHNvbWUoZih3YSkpO1xufTsgfTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuNy4wXG4gKi9cbmV4cG9ydCB2YXIgRXh0ZW5kID0ge1xuICAgIFVSSTogVVJJLFxuICAgIG1hcDogX21hcCxcbiAgICBleHRlbmQ6IF9leHRlbmRcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBmaWx0ZXJpbmdcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIGNvbXBhY3QgPSAvKiNfX1BVUkVfXyovIGZsYXRNYXAoaWRlbnRpdHkpO1xudmFyIGRlZmF1bHRTZXBhcmF0ZWQgPSAvKiNfX1BVUkVfXyovIHNlcGFyYXRlZChub25lLCBub25lKTtcbi8qKlxuICogQGNhdGVnb3J5IGZpbHRlcmluZ1xuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgc2VwYXJhdGUgPSBmdW5jdGlvbiAobWEpIHtcbiAgICByZXR1cm4gaXNOb25lKG1hKSA/IGRlZmF1bHRTZXBhcmF0ZWQgOiBzZXBhcmF0ZWQoZ2V0TGVmdChtYS52YWx1ZSksIGdldFJpZ2h0KG1hLnZhbHVlKSk7XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi43LjBcbiAqL1xuZXhwb3J0IHZhciBDb21wYWN0YWJsZSA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICBjb21wYWN0OiBjb21wYWN0LFxuICAgIHNlcGFyYXRlOiBzZXBhcmF0ZVxufTtcbi8qKlxuICogQGNhdGVnb3J5IGZpbHRlcmluZ1xuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgZmlsdGVyID0gZnVuY3Rpb24gKHByZWRpY2F0ZSkge1xuICAgIHJldHVybiBmdW5jdGlvbiAoZmEpIHtcbiAgICAgICAgcmV0dXJuIGlzTm9uZShmYSkgPyBub25lIDogcHJlZGljYXRlKGZhLnZhbHVlKSA/IGZhIDogbm9uZTtcbiAgICB9O1xufTtcbi8qKlxuICogQGNhdGVnb3J5IGZpbHRlcmluZ1xuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgZmlsdGVyTWFwID0gZnVuY3Rpb24gKGYpIHsgcmV0dXJuIGZ1bmN0aW9uIChmYSkge1xuICAgIHJldHVybiBpc05vbmUoZmEpID8gbm9uZSA6IGYoZmEudmFsdWUpO1xufTsgfTtcbi8qKlxuICogQGNhdGVnb3J5IGZpbHRlcmluZ1xuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgcGFydGl0aW9uID0gZnVuY3Rpb24gKHByZWRpY2F0ZSkge1xuICAgIHJldHVybiBmdW5jdGlvbiAoZmEpIHtcbiAgICAgICAgcmV0dXJuIHNlcGFyYXRlZChfZmlsdGVyKGZhLCBub3QocHJlZGljYXRlKSksIF9maWx0ZXIoZmEsIHByZWRpY2F0ZSkpO1xuICAgIH07XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgZmlsdGVyaW5nXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciBwYXJ0aXRpb25NYXAgPSBmdW5jdGlvbiAoZikgeyByZXR1cm4gZmxvdyhtYXAoZiksIHNlcGFyYXRlKTsgfTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuNy4wXG4gKi9cbmV4cG9ydCB2YXIgRmlsdGVyYWJsZSA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICBtYXA6IF9tYXAsXG4gICAgY29tcGFjdDogY29tcGFjdCxcbiAgICBzZXBhcmF0ZTogc2VwYXJhdGUsXG4gICAgZmlsdGVyOiBfZmlsdGVyLFxuICAgIGZpbHRlck1hcDogX2ZpbHRlck1hcCxcbiAgICBwYXJ0aXRpb246IF9wYXJ0aXRpb24sXG4gICAgcGFydGl0aW9uTWFwOiBfcGFydGl0aW9uTWFwXG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgdHJhdmVyc2luZ1xuICogQHNpbmNlIDIuNi4zXG4gKi9cbmV4cG9ydCB2YXIgdHJhdmVyc2UgPSBmdW5jdGlvbiAoRikge1xuICAgIHJldHVybiBmdW5jdGlvbiAoZikge1xuICAgICAgICByZXR1cm4gZnVuY3Rpb24gKHRhKSB7XG4gICAgICAgICAgICByZXR1cm4gaXNOb25lKHRhKSA/IEYub2Yobm9uZSkgOiBGLm1hcChmKHRhLnZhbHVlKSwgc29tZSk7XG4gICAgICAgIH07XG4gICAgfTtcbn07XG4vKipcbiAqIEBjYXRlZ29yeSB0cmF2ZXJzaW5nXG4gKiBAc2luY2UgMi42LjNcbiAqL1xuZXhwb3J0IHZhciBzZXF1ZW5jZSA9IGZ1bmN0aW9uIChGKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uICh0YSkge1xuICAgICAgICByZXR1cm4gaXNOb25lKHRhKSA/IEYub2Yobm9uZSkgOiBGLm1hcCh0YS52YWx1ZSwgc29tZSk7XG4gICAgfTtcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjcuMFxuICovXG5leHBvcnQgdmFyIFRyYXZlcnNhYmxlID0ge1xuICAgIFVSSTogVVJJLFxuICAgIG1hcDogX21hcCxcbiAgICByZWR1Y2U6IF9yZWR1Y2UsXG4gICAgZm9sZE1hcDogX2ZvbGRNYXAsXG4gICAgcmVkdWNlUmlnaHQ6IF9yZWR1Y2VSaWdodCxcbiAgICB0cmF2ZXJzZTogX3RyYXZlcnNlLFxuICAgIHNlcXVlbmNlOiBzZXF1ZW5jZVxufTtcbnZhciBfd2l0aGVyID0gLyojX19QVVJFX18qLyB3aXRoZXJEZWZhdWx0KFRyYXZlcnNhYmxlLCBDb21wYWN0YWJsZSk7XG52YXIgX3dpbHQgPSAvKiNfX1BVUkVfXyovIHdpbHREZWZhdWx0KFRyYXZlcnNhYmxlLCBDb21wYWN0YWJsZSk7XG4vKipcbiAqIEBjYXRlZ29yeSBmaWx0ZXJpbmdcbiAqIEBzaW5jZSAyLjYuNVxuICovXG5leHBvcnQgdmFyIHdpdGhlciA9IGZ1bmN0aW9uIChGKSB7XG4gICAgdmFyIF93aXRoZXJGID0gX3dpdGhlcihGKTtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGYpIHsgcmV0dXJuIGZ1bmN0aW9uIChmYSkgeyByZXR1cm4gX3dpdGhlckYoZmEsIGYpOyB9OyB9O1xufTtcbi8qKlxuICogQGNhdGVnb3J5IGZpbHRlcmluZ1xuICogQHNpbmNlIDIuNi41XG4gKi9cbmV4cG9ydCB2YXIgd2lsdCA9IGZ1bmN0aW9uIChGKSB7XG4gICAgdmFyIF93aWx0RiA9IF93aWx0KEYpO1xuICAgIHJldHVybiBmdW5jdGlvbiAoZikgeyByZXR1cm4gZnVuY3Rpb24gKGZhKSB7IHJldHVybiBfd2lsdEYoZmEsIGYpOyB9OyB9O1xufTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuNy4wXG4gKi9cbmV4cG9ydCB2YXIgV2l0aGVyYWJsZSA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICBtYXA6IF9tYXAsXG4gICAgcmVkdWNlOiBfcmVkdWNlLFxuICAgIGZvbGRNYXA6IF9mb2xkTWFwLFxuICAgIHJlZHVjZVJpZ2h0OiBfcmVkdWNlUmlnaHQsXG4gICAgdHJhdmVyc2U6IF90cmF2ZXJzZSxcbiAgICBzZXF1ZW5jZTogc2VxdWVuY2UsXG4gICAgY29tcGFjdDogY29tcGFjdCxcbiAgICBzZXBhcmF0ZTogc2VwYXJhdGUsXG4gICAgZmlsdGVyOiBfZmlsdGVyLFxuICAgIGZpbHRlck1hcDogX2ZpbHRlck1hcCxcbiAgICBwYXJ0aXRpb246IF9wYXJ0aXRpb24sXG4gICAgcGFydGl0aW9uTWFwOiBfcGFydGl0aW9uTWFwLFxuICAgIHdpdGhlcjogX3dpdGhlcixcbiAgICB3aWx0OiBfd2lsdFxufTtcbi8qKlxuICogQHNpbmNlIDIuNy4wXG4gKi9cbmV4cG9ydCB2YXIgdGhyb3dFcnJvciA9IGZ1bmN0aW9uICgpIHsgcmV0dXJuIG5vbmU7IH07XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjcuMFxuICovXG5leHBvcnQgdmFyIE1vbmFkVGhyb3cgPSB7XG4gICAgVVJJOiBVUkksXG4gICAgbWFwOiBfbWFwLFxuICAgIGFwOiBfYXAsXG4gICAgb2Y6IG9mLFxuICAgIGNoYWluOiBmbGF0TWFwLFxuICAgIHRocm93RXJyb3I6IHRocm93RXJyb3Jcbn07XG4vKipcbiAqIFRyYW5zZm9ybXMgYW4gYEVpdGhlcmAgdG8gYW4gYE9wdGlvbmAgZGlzY2FyZGluZyB0aGUgZXJyb3IuXG4gKlxuICogQWxpYXMgb2YgW2dldFJpZ2h0XSgjZ2V0cmlnaHQpXG4gKlxuICogQGNhdGVnb3J5IGNvbnZlcnNpb25zXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciBmcm9tRWl0aGVyID0gZ2V0UmlnaHQ7XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjExLjBcbiAqL1xuZXhwb3J0IHZhciBGcm9tRWl0aGVyID0ge1xuICAgIFVSSTogVVJJLFxuICAgIGZyb21FaXRoZXI6IGZyb21FaXRoZXJcbn07XG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vLyByZWZpbmVtZW50c1xuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLyoqXG4gKiBSZXR1cm5zIGB0cnVlYCBpZiB0aGUgb3B0aW9uIGlzIGFuIGluc3RhbmNlIG9mIGBTb21lYCwgYGZhbHNlYCBvdGhlcndpc2UuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IHNvbWUsIG5vbmUsIGlzU29tZSB9IGZyb20gJ2ZwLXRzL09wdGlvbidcbiAqXG4gKiBhc3NlcnQuc3RyaWN0RXF1YWwoaXNTb21lKHNvbWUoMSkpLCB0cnVlKVxuICogYXNzZXJ0LnN0cmljdEVxdWFsKGlzU29tZShub25lKSwgZmFsc2UpXG4gKlxuICogQGNhdGVnb3J5IHJlZmluZW1lbnRzXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciBpc1NvbWUgPSBfLmlzU29tZTtcbi8qKlxuICogUmV0dXJucyBgdHJ1ZWAgaWYgdGhlIG9wdGlvbiBpcyBgTm9uZWAsIGBmYWxzZWAgb3RoZXJ3aXNlLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBzb21lLCBub25lLCBpc05vbmUgfSBmcm9tICdmcC10cy9PcHRpb24nXG4gKlxuICogYXNzZXJ0LnN0cmljdEVxdWFsKGlzTm9uZShzb21lKDEpKSwgZmFsc2UpXG4gKiBhc3NlcnQuc3RyaWN0RXF1YWwoaXNOb25lKG5vbmUpLCB0cnVlKVxuICpcbiAqIEBjYXRlZ29yeSByZWZpbmVtZW50c1xuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgaXNOb25lID0gZnVuY3Rpb24gKGZhKSB7IHJldHVybiBmYS5fdGFnID09PSAnTm9uZSc7IH07XG4vKipcbiAqIExlc3Mgc3RyaWN0IHZlcnNpb24gb2YgW2BtYXRjaGBdKCNtYXRjaCkuXG4gKlxuICogVGhlIGBXYCBzdWZmaXggKHNob3J0IGZvciAqKlcqKmlkZW5pbmcpIG1lYW5zIHRoYXQgdGhlIGhhbmRsZXIgcmV0dXJuIHR5cGVzIHdpbGwgYmUgbWVyZ2VkLlxuICpcbiAqIEBjYXRlZ29yeSBwYXR0ZXJuIG1hdGNoaW5nXG4gKiBAc2luY2UgMi4xMC4wXG4gKi9cbmV4cG9ydCB2YXIgbWF0Y2hXID0gZnVuY3Rpb24gKG9uTm9uZSwgb25Tb21lKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChtYSkge1xuICAgICAgICByZXR1cm4gaXNOb25lKG1hKSA/IG9uTm9uZSgpIDogb25Tb21lKG1hLnZhbHVlKTtcbiAgICB9O1xufTtcbi8qKlxuICogQWxpYXMgb2YgW2BtYXRjaFdgXSgjbWF0Y2h3KS5cbiAqXG4gKiBAY2F0ZWdvcnkgcGF0dGVybiBtYXRjaGluZ1xuICogQHNpbmNlIDIuMTAuMFxuICovXG5leHBvcnQgdmFyIGZvbGRXID0gbWF0Y2hXO1xuLyoqXG4gKiBUYWtlcyBhIChsYXp5KSBkZWZhdWx0IHZhbHVlLCBhIGZ1bmN0aW9uLCBhbmQgYW4gYE9wdGlvbmAgdmFsdWUsIGlmIHRoZSBgT3B0aW9uYCB2YWx1ZSBpcyBgTm9uZWAgdGhlIGRlZmF1bHQgdmFsdWUgaXNcbiAqIHJldHVybmVkLCBvdGhlcndpc2UgdGhlIGZ1bmN0aW9uIGlzIGFwcGxpZWQgdG8gdGhlIHZhbHVlIGluc2lkZSB0aGUgYFNvbWVgIGFuZCB0aGUgcmVzdWx0IGlzIHJldHVybmVkLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBzb21lLCBub25lLCBtYXRjaCB9IGZyb20gJ2ZwLXRzL09wdGlvbidcbiAqIGltcG9ydCB7IHBpcGUgfSBmcm9tICdmcC10cy9mdW5jdGlvbidcbiAqXG4gKiBhc3NlcnQuc3RyaWN0RXF1YWwoXG4gKiAgIHBpcGUoXG4gKiAgICAgc29tZSgxKSxcbiAqICAgICBtYXRjaCgoKSA9PiAnYSBub25lJywgYSA9PiBgYSBzb21lIGNvbnRhaW5pbmcgJHthfWApXG4gKiAgICksXG4gKiAgICdhIHNvbWUgY29udGFpbmluZyAxJ1xuICogKVxuICpcbiAqIGFzc2VydC5zdHJpY3RFcXVhbChcbiAqICAgcGlwZShcbiAqICAgICBub25lLFxuICogICAgIG1hdGNoKCgpID0+ICdhIG5vbmUnLCBhID0+IGBhIHNvbWUgY29udGFpbmluZyAke2F9YClcbiAqICAgKSxcbiAqICAgJ2Egbm9uZSdcbiAqIClcbiAqXG4gKiBAY2F0ZWdvcnkgcGF0dGVybiBtYXRjaGluZ1xuICogQHNpbmNlIDIuMTAuMFxuICovXG5leHBvcnQgdmFyIG1hdGNoID0gbWF0Y2hXO1xuLyoqXG4gKiBBbGlhcyBvZiBbYG1hdGNoYF0oI21hdGNoKS5cbiAqXG4gKiBAY2F0ZWdvcnkgcGF0dGVybiBtYXRjaGluZ1xuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgZm9sZCA9IG1hdGNoO1xuLyoqXG4gKiBMZXNzIHN0cmljdCB2ZXJzaW9uIG9mIFtgZ2V0T3JFbHNlYF0oI2dldG9yZWxzZSkuXG4gKlxuICogVGhlIGBXYCBzdWZmaXggKHNob3J0IGZvciAqKlcqKmlkZW5pbmcpIG1lYW5zIHRoYXQgdGhlIGhhbmRsZXIgcmV0dXJuIHR5cGUgd2lsbCBiZSBtZXJnZWQuXG4gKlxuICogQGNhdGVnb3J5IGVycm9yIGhhbmRsaW5nXG4gKiBAc2luY2UgMi42LjBcbiAqL1xuZXhwb3J0IHZhciBnZXRPckVsc2VXID0gZnVuY3Rpb24gKG9uTm9uZSkge1xuICAgIHJldHVybiBmdW5jdGlvbiAobWEpIHtcbiAgICAgICAgcmV0dXJuIGlzTm9uZShtYSkgPyBvbk5vbmUoKSA6IG1hLnZhbHVlO1xuICAgIH07XG59O1xuLyoqXG4gKiBFeHRyYWN0cyB0aGUgdmFsdWUgb3V0IG9mIHRoZSBzdHJ1Y3R1cmUsIGlmIGl0IGV4aXN0cy4gT3RoZXJ3aXNlIHJldHVybnMgdGhlIGdpdmVuIGRlZmF1bHQgdmFsdWVcbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgc29tZSwgbm9uZSwgZ2V0T3JFbHNlIH0gZnJvbSAnZnAtdHMvT3B0aW9uJ1xuICogaW1wb3J0IHsgcGlwZSB9IGZyb20gJ2ZwLXRzL2Z1bmN0aW9uJ1xuICpcbiAqIGFzc2VydC5zdHJpY3RFcXVhbChcbiAqICAgcGlwZShcbiAqICAgICBzb21lKDEpLFxuICogICAgIGdldE9yRWxzZSgoKSA9PiAwKVxuICogICApLFxuICogICAxXG4gKiApXG4gKiBhc3NlcnQuc3RyaWN0RXF1YWwoXG4gKiAgIHBpcGUoXG4gKiAgICAgbm9uZSxcbiAqICAgICBnZXRPckVsc2UoKCkgPT4gMClcbiAqICAgKSxcbiAqICAgMFxuICogKVxuICpcbiAqIEBjYXRlZ29yeSBlcnJvciBoYW5kbGluZ1xuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgZ2V0T3JFbHNlID0gZ2V0T3JFbHNlVztcbi8qKlxuICogQGNhdGVnb3J5IG1hcHBpbmdcbiAqIEBzaW5jZSAyLjEwLjBcbiAqL1xuZXhwb3J0IHZhciBmbGFwID0gLyojX19QVVJFX18qLyBmbGFwXyhGdW5jdG9yKTtcbi8qKlxuICogQ29tYmluZSB0d28gZWZmZWN0ZnVsIGFjdGlvbnMsIGtlZXBpbmcgb25seSB0aGUgcmVzdWx0IG9mIHRoZSBmaXJzdC5cbiAqXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciBhcEZpcnN0ID0gLyojX19QVVJFX18qLyBhcEZpcnN0XyhBcHBseSk7XG4vKipcbiAqIENvbWJpbmUgdHdvIGVmZmVjdGZ1bCBhY3Rpb25zLCBrZWVwaW5nIG9ubHkgdGhlIHJlc3VsdCBvZiB0aGUgc2Vjb25kLlxuICpcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIGFwU2Vjb25kID0gLyojX19QVVJFX18qLyBhcFNlY29uZF8oQXBwbHkpO1xuLyoqXG4gKiBAY2F0ZWdvcnkgc2VxdWVuY2luZ1xuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgZmxhdHRlbiA9IGNvbXBhY3Q7XG4vKipcbiAqIENvbXBvc2VzIGNvbXB1dGF0aW9ucyBpbiBzZXF1ZW5jZSwgdXNpbmcgdGhlIHJldHVybiB2YWx1ZSBvZiBvbmUgY29tcHV0YXRpb24gdG8gZGV0ZXJtaW5lIHRoZSBuZXh0IGNvbXB1dGF0aW9uIGFuZFxuICoga2VlcGluZyBvbmx5IHRoZSByZXN1bHQgb2YgdGhlIGZpcnN0LlxuICpcbiAqIEBjYXRlZ29yeSBjb21iaW5hdG9yc1xuICogQHNpbmNlIDIuMTUuMFxuICovXG5leHBvcnQgdmFyIHRhcCA9IC8qI19fUFVSRV9fKi8gZHVhbCgyLCBjaGFpbmFibGUudGFwKENoYWluKSk7XG4vKipcbiAqIENvbXBvc2VzIGNvbXB1dGF0aW9ucyBpbiBzZXF1ZW5jZSwgdXNpbmcgdGhlIHJldHVybiB2YWx1ZSBvZiBvbmUgY29tcHV0YXRpb24gdG8gZGV0ZXJtaW5lIHRoZSBuZXh0IGNvbXB1dGF0aW9uIGFuZFxuICoga2VlcGluZyBvbmx5IHRoZSByZXN1bHQgb2YgdGhlIGZpcnN0LlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBwaXBlIH0gZnJvbSAnZnAtdHMvZnVuY3Rpb24nXG4gKiBpbXBvcnQgKiBhcyBPIGZyb20gJ2ZwLXRzL09wdGlvbidcbiAqIGltcG9ydCAqIGFzIEUgZnJvbSAnZnAtdHMvRWl0aGVyJ1xuICpcbiAqIGNvbnN0IGNvbXB1dGUgPSAodmFsdWU6IG51bWJlcikgPT4gcGlwZShcbiAqICAgTy5vZih2YWx1ZSksXG4gKiAgIE8udGFwRWl0aGVyKCh2YWx1ZSkgPT4gdmFsdWUgPiAwID8gRS5yaWdodCgnb2snKSA6IEUubGVmdCgnZXJyb3InKSksXG4gKiApXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChjb21wdXRlKDEpLCBPLm9mKDEpKVxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChjb21wdXRlKC00MiksIE8ubm9uZSlcbiAqXG4gKiBAY2F0ZWdvcnkgY29tYmluYXRvcnNcbiAqIEBzaW5jZSAyLjE2LjBcbiAqL1xuZXhwb3J0IHZhciB0YXBFaXRoZXIgPSAvKiNfX1BVUkVfXyovIGR1YWwoMiwgdGFwRWl0aGVyXyhGcm9tRWl0aGVyLCBDaGFpbikpO1xuLyoqXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciBkdXBsaWNhdGUgPSAvKiNfX1BVUkVfXyovIGV4dGVuZChpZGVudGl0eSk7XG4vKipcbiAqIEBjYXRlZ29yeSBsaWZ0aW5nXG4gKiBAc2luY2UgMi4xMS4wXG4gKi9cbmV4cG9ydCB2YXIgZnJvbUVpdGhlcksgPSAvKiNfX1BVUkVfXyovIGZyb21FaXRoZXJLXyhGcm9tRWl0aGVyKTtcbi8qKlxuICogQGNhdGVnb3J5IHNlcXVlbmNpbmdcbiAqIEBzaW5jZSAyLjExLjBcbiAqL1xuZXhwb3J0IHZhciBjaGFpbkVpdGhlcksgPSBcbi8qI19fUFVSRV9fKi8gY2hhaW5FaXRoZXJLXyhGcm9tRWl0aGVyLCBDaGFpbik7XG4vKipcbiAqIEFsaWFzIG9mIGB0YXBFaXRoZXJgLlxuICpcbiAqIEBjYXRlZ29yeSBsZWdhY3lcbiAqIEBzaW5jZSAyLjEyLjBcbiAqL1xuZXhwb3J0IHZhciBjaGFpbkZpcnN0RWl0aGVySyA9IHRhcEVpdGhlcjtcbi8qKlxuICogQ29uc3RydWN0cyBhIG5ldyBgT3B0aW9uYCBmcm9tIGEgbnVsbGFibGUgdHlwZS4gSWYgdGhlIHZhbHVlIGlzIGBudWxsYCBvciBgdW5kZWZpbmVkYCwgcmV0dXJucyBgTm9uZWAsIG90aGVyd2lzZVxuICogcmV0dXJucyB0aGUgdmFsdWUgd3JhcHBlZCBpbiBhIGBTb21lYC5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgbm9uZSwgc29tZSwgZnJvbU51bGxhYmxlIH0gZnJvbSAnZnAtdHMvT3B0aW9uJ1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoZnJvbU51bGxhYmxlKHVuZGVmaW5lZCksIG5vbmUpXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKGZyb21OdWxsYWJsZShudWxsKSwgbm9uZSlcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoZnJvbU51bGxhYmxlKDEpLCBzb21lKDEpKVxuICpcbiAqIEBjYXRlZ29yeSBjb252ZXJzaW9uc1xuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgZnJvbU51bGxhYmxlID0gZnVuY3Rpb24gKGEpIHsgcmV0dXJuIChhID09IG51bGwgPyBub25lIDogc29tZShhKSk7IH07XG4vKipcbiAqIFRyYW5zZm9ybXMgYW4gZXhjZXB0aW9uIGludG8gYW4gYE9wdGlvbmAuIElmIGBmYCB0aHJvd3MsIHJldHVybnMgYE5vbmVgLCBvdGhlcndpc2UgcmV0dXJucyB0aGUgb3V0cHV0IHdyYXBwZWQgaW4gYVxuICogYFNvbWVgLlxuICpcbiAqIFNlZSBhbHNvIFtgdHJ5Q2F0Y2hLYF0oI3RyeWNhdGNoaykuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IG5vbmUsIHNvbWUsIHRyeUNhdGNoIH0gZnJvbSAnZnAtdHMvT3B0aW9uJ1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoXG4gKiAgIHRyeUNhdGNoKCgpID0+IHtcbiAqICAgICB0aHJvdyBuZXcgRXJyb3IoKVxuICogICB9KSxcbiAqICAgbm9uZVxuICogKVxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbCh0cnlDYXRjaCgoKSA9PiAxKSwgc29tZSgxKSlcbiAqXG4gKiBAY2F0ZWdvcnkgaW50ZXJvcFxuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgdHJ5Q2F0Y2ggPSBmdW5jdGlvbiAoZikge1xuICAgIHRyeSB7XG4gICAgICAgIHJldHVybiBzb21lKGYoKSk7XG4gICAgfVxuICAgIGNhdGNoIChlKSB7XG4gICAgICAgIHJldHVybiBub25lO1xuICAgIH1cbn07XG4vKipcbiAqIENvbnZlcnRzIGEgZnVuY3Rpb24gdGhhdCBtYXkgdGhyb3cgdG8gb25lIHJldHVybmluZyBhIGBPcHRpb25gLlxuICpcbiAqIEBjYXRlZ29yeSBpbnRlcm9wXG4gKiBAc2luY2UgMi4xMC4wXG4gKi9cbmV4cG9ydCB2YXIgdHJ5Q2F0Y2hLID0gZnVuY3Rpb24gKGYpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgYSA9IFtdO1xuICAgICAgICBmb3IgKHZhciBfaSA9IDA7IF9pIDwgYXJndW1lbnRzLmxlbmd0aDsgX2krKykge1xuICAgICAgICAgICAgYVtfaV0gPSBhcmd1bWVudHNbX2ldO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0cnlDYXRjaChmdW5jdGlvbiAoKSB7IHJldHVybiBmLmFwcGx5KHZvaWQgMCwgYSk7IH0pO1xuICAgIH07XG59O1xuLyoqXG4gKiBSZXR1cm5zIGEgKnNtYXJ0IGNvbnN0cnVjdG9yKiBmcm9tIGEgZnVuY3Rpb24gdGhhdCByZXR1cm5zIGEgbnVsbGFibGUgdmFsdWUuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IGZyb21OdWxsYWJsZUssIG5vbmUsIHNvbWUgfSBmcm9tICdmcC10cy9PcHRpb24nXG4gKlxuICogY29uc3QgZiA9IChzOiBzdHJpbmcpOiBudW1iZXIgfCB1bmRlZmluZWQgPT4ge1xuICogICBjb25zdCBuID0gcGFyc2VGbG9hdChzKVxuICogICByZXR1cm4gaXNOYU4obikgPyB1bmRlZmluZWQgOiBuXG4gKiB9XG4gKlxuICogY29uc3QgZyA9IGZyb21OdWxsYWJsZUsoZilcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKGcoJzEnKSwgc29tZSgxKSlcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoZygnYScpLCBub25lKVxuICpcbiAqIEBjYXRlZ29yeSBsaWZ0aW5nXG4gKiBAc2luY2UgMi45LjBcbiAqL1xuZXhwb3J0IHZhciBmcm9tTnVsbGFibGVLID0gZnVuY3Rpb24gKGYpIHsgcmV0dXJuIGZsb3coZiwgZnJvbU51bGxhYmxlKTsgfTtcbi8qKlxuICogVGhpcyBpcyBgY2hhaW5gICsgYGZyb21OdWxsYWJsZWAsIHVzZWZ1bCB3aGVuIHdvcmtpbmcgd2l0aCBvcHRpb25hbCB2YWx1ZXMuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IHNvbWUsIG5vbmUsIGZyb21OdWxsYWJsZSwgY2hhaW5OdWxsYWJsZUsgfSBmcm9tICdmcC10cy9PcHRpb24nXG4gKiBpbXBvcnQgeyBwaXBlIH0gZnJvbSAnZnAtdHMvZnVuY3Rpb24nXG4gKlxuICogaW50ZXJmYWNlIEVtcGxveWVlIHtcbiAqICAgcmVhZG9ubHkgY29tcGFueT86IHtcbiAqICAgICByZWFkb25seSBhZGRyZXNzPzoge1xuICogICAgICAgcmVhZG9ubHkgc3RyZWV0Pzoge1xuICogICAgICAgICByZWFkb25seSBuYW1lPzogc3RyaW5nXG4gKiAgICAgICB9XG4gKiAgICAgfVxuICogICB9XG4gKiB9XG4gKlxuICogY29uc3QgZW1wbG95ZWUxOiBFbXBsb3llZSA9IHsgY29tcGFueTogeyBhZGRyZXNzOiB7IHN0cmVldDogeyBuYW1lOiAnaGlnaCBzdHJlZXQnIH0gfSB9IH1cbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKFxuICogICBwaXBlKFxuICogICAgIGZyb21OdWxsYWJsZShlbXBsb3llZTEuY29tcGFueSksXG4gKiAgICAgY2hhaW5OdWxsYWJsZUsoY29tcGFueSA9PiBjb21wYW55LmFkZHJlc3MpLFxuICogICAgIGNoYWluTnVsbGFibGVLKGFkZHJlc3MgPT4gYWRkcmVzcy5zdHJlZXQpLFxuICogICAgIGNoYWluTnVsbGFibGVLKHN0cmVldCA9PiBzdHJlZXQubmFtZSlcbiAqICAgKSxcbiAqICAgc29tZSgnaGlnaCBzdHJlZXQnKVxuICogKVxuICpcbiAqIGNvbnN0IGVtcGxveWVlMjogRW1wbG95ZWUgPSB7IGNvbXBhbnk6IHsgYWRkcmVzczogeyBzdHJlZXQ6IHt9IH0gfSB9XG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChcbiAqICAgcGlwZShcbiAqICAgICBmcm9tTnVsbGFibGUoZW1wbG95ZWUyLmNvbXBhbnkpLFxuICogICAgIGNoYWluTnVsbGFibGVLKGNvbXBhbnkgPT4gY29tcGFueS5hZGRyZXNzKSxcbiAqICAgICBjaGFpbk51bGxhYmxlSyhhZGRyZXNzID0+IGFkZHJlc3Muc3RyZWV0KSxcbiAqICAgICBjaGFpbk51bGxhYmxlSyhzdHJlZXQgPT4gc3RyZWV0Lm5hbWUpXG4gKiAgICksXG4gKiAgIG5vbmVcbiAqIClcbiAqXG4gKiBAY2F0ZWdvcnkgc2VxdWVuY2luZ1xuICogQHNpbmNlIDIuOS4wXG4gKi9cbmV4cG9ydCB2YXIgY2hhaW5OdWxsYWJsZUsgPSBmdW5jdGlvbiAoZikge1xuICAgIHJldHVybiBmdW5jdGlvbiAobWEpIHtcbiAgICAgICAgcmV0dXJuIGlzTm9uZShtYSkgPyBub25lIDogZnJvbU51bGxhYmxlKGYobWEudmFsdWUpKTtcbiAgICB9O1xufTtcbi8qKlxuICogRXh0cmFjdHMgdGhlIHZhbHVlIG91dCBvZiB0aGUgc3RydWN0dXJlLCBpZiBpdCBleGlzdHMuIE90aGVyd2lzZSByZXR1cm5zIGBudWxsYC5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgc29tZSwgbm9uZSwgdG9OdWxsYWJsZSB9IGZyb20gJ2ZwLXRzL09wdGlvbidcbiAqIGltcG9ydCB7IHBpcGUgfSBmcm9tICdmcC10cy9mdW5jdGlvbidcbiAqXG4gKiBhc3NlcnQuc3RyaWN0RXF1YWwoXG4gKiAgIHBpcGUoXG4gKiAgICAgc29tZSgxKSxcbiAqICAgICB0b051bGxhYmxlXG4gKiAgICksXG4gKiAgIDFcbiAqIClcbiAqIGFzc2VydC5zdHJpY3RFcXVhbChcbiAqICAgcGlwZShcbiAqICAgICBub25lLFxuICogICAgIHRvTnVsbGFibGVcbiAqICAgKSxcbiAqICAgbnVsbFxuICogKVxuICpcbiAqIEBjYXRlZ29yeSBjb252ZXJzaW9uc1xuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgdG9OdWxsYWJsZSA9IC8qI19fUFVSRV9fKi8gbWF0Y2goY29uc3ROdWxsLCBpZGVudGl0eSk7XG4vKipcbiAqIEV4dHJhY3RzIHRoZSB2YWx1ZSBvdXQgb2YgdGhlIHN0cnVjdHVyZSwgaWYgaXQgZXhpc3RzLiBPdGhlcndpc2UgcmV0dXJucyBgdW5kZWZpbmVkYC5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgc29tZSwgbm9uZSwgdG9VbmRlZmluZWQgfSBmcm9tICdmcC10cy9PcHRpb24nXG4gKiBpbXBvcnQgeyBwaXBlIH0gZnJvbSAnZnAtdHMvZnVuY3Rpb24nXG4gKlxuICogYXNzZXJ0LnN0cmljdEVxdWFsKFxuICogICBwaXBlKFxuICogICAgIHNvbWUoMSksXG4gKiAgICAgdG9VbmRlZmluZWRcbiAqICAgKSxcbiAqICAgMVxuICogKVxuICogYXNzZXJ0LnN0cmljdEVxdWFsKFxuICogICBwaXBlKFxuICogICAgIG5vbmUsXG4gKiAgICAgdG9VbmRlZmluZWRcbiAqICAgKSxcbiAqICAgdW5kZWZpbmVkXG4gKiApXG4gKlxuICogQGNhdGVnb3J5IGNvbnZlcnNpb25zXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciB0b1VuZGVmaW5lZCA9IC8qI19fUFVSRV9fKi8gbWF0Y2goY29uc3RVbmRlZmluZWQsIGlkZW50aXR5KTtcbmV4cG9ydCBmdW5jdGlvbiBlbGVtKEUpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGEsIG1hKSB7XG4gICAgICAgIGlmIChtYSA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICB2YXIgZWxlbUVfMSA9IGVsZW0oRSk7XG4gICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24gKG1hKSB7IHJldHVybiBlbGVtRV8xKGEsIG1hKTsgfTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gaXNOb25lKG1hKSA/IGZhbHNlIDogRS5lcXVhbHMoYSwgbWEudmFsdWUpO1xuICAgIH07XG59XG4vKipcbiAqIFJldHVybnMgYHRydWVgIGlmIHRoZSBwcmVkaWNhdGUgaXMgc2F0aXNmaWVkIGJ5IHRoZSB3cmFwcGVkIHZhbHVlXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IHNvbWUsIG5vbmUsIGV4aXN0cyB9IGZyb20gJ2ZwLXRzL09wdGlvbidcbiAqIGltcG9ydCB7IHBpcGUgfSBmcm9tICdmcC10cy9mdW5jdGlvbidcbiAqXG4gKiBhc3NlcnQuc3RyaWN0RXF1YWwoXG4gKiAgIHBpcGUoXG4gKiAgICAgc29tZSgxKSxcbiAqICAgICBleGlzdHMobiA9PiBuID4gMClcbiAqICAgKSxcbiAqICAgdHJ1ZVxuICogKVxuICogYXNzZXJ0LnN0cmljdEVxdWFsKFxuICogICBwaXBlKFxuICogICAgIHNvbWUoMSksXG4gKiAgICAgZXhpc3RzKG4gPT4gbiA+IDEpXG4gKiAgICksXG4gKiAgIGZhbHNlXG4gKiApXG4gKiBhc3NlcnQuc3RyaWN0RXF1YWwoXG4gKiAgIHBpcGUoXG4gKiAgICAgbm9uZSxcbiAqICAgICBleGlzdHMobiA9PiBuID4gMClcbiAqICAgKSxcbiAqICAgZmFsc2VcbiAqIClcbiAqXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciBleGlzdHMgPSBmdW5jdGlvbiAocHJlZGljYXRlKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChtYSkge1xuICAgICAgICByZXR1cm4gaXNOb25lKG1hKSA/IGZhbHNlIDogcHJlZGljYXRlKG1hLnZhbHVlKTtcbiAgICB9O1xufTtcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8vIGRvIG5vdGF0aW9uXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vKipcbiAqIEBjYXRlZ29yeSBkbyBub3RhdGlvblxuICogQHNpbmNlIDIuOS4wXG4gKi9cbmV4cG9ydCB2YXIgRG8gPSAvKiNfX1BVUkVfXyovIG9mKF8uZW1wdHlSZWNvcmQpO1xuLyoqXG4gKiBAY2F0ZWdvcnkgZG8gbm90YXRpb25cbiAqIEBzaW5jZSAyLjguMFxuICovXG5leHBvcnQgdmFyIGJpbmRUbyA9IC8qI19fUFVSRV9fKi8gYmluZFRvXyhGdW5jdG9yKTtcbnZhciBsZXRfID0gLyojX19QVVJFX18qLyBsZXRfXyhGdW5jdG9yKTtcbmV4cG9ydCB7IFxuLyoqXG4gKiBAY2F0ZWdvcnkgZG8gbm90YXRpb25cbiAqIEBzaW5jZSAyLjEzLjBcbiAqL1xubGV0XyBhcyBsZXQgfTtcbi8qKlxuICogQGNhdGVnb3J5IGRvIG5vdGF0aW9uXG4gKiBAc2luY2UgMi44LjBcbiAqL1xuZXhwb3J0IHZhciBiaW5kID0gLyojX19QVVJFX18qLyBjaGFpbmFibGUuYmluZChDaGFpbik7XG4vKipcbiAqIEBjYXRlZ29yeSBkbyBub3RhdGlvblxuICogQHNpbmNlIDIuOC4wXG4gKi9cbmV4cG9ydCB2YXIgYXBTID0gLyojX19QVVJFX18qLyBhcFNfKEFwcGx5KTtcbi8qKlxuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIEFwVCA9IC8qI19fUFVSRV9fKi8gb2YoXy5lbXB0eVJlYWRvbmx5QXJyYXkpO1xuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLy8gYXJyYXkgdXRpbHNcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8qKlxuICogRXF1aXZhbGVudCB0byBgUmVhZG9ubHlOb25FbXB0eUFycmF5I3RyYXZlcnNlV2l0aEluZGV4KEFwcGxpY2F0aXZlKWAuXG4gKlxuICogQGNhdGVnb3J5IHRyYXZlcnNpbmdcbiAqIEBzaW5jZSAyLjExLjBcbiAqL1xuZXhwb3J0IHZhciB0cmF2ZXJzZVJlYWRvbmx5Tm9uRW1wdHlBcnJheVdpdGhJbmRleCA9IGZ1bmN0aW9uIChmKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykge1xuICAgICAgICB2YXIgbyA9IGYoMCwgXy5oZWFkKGFzKSk7XG4gICAgICAgIGlmIChpc05vbmUobykpIHtcbiAgICAgICAgICAgIHJldHVybiBub25lO1xuICAgICAgICB9XG4gICAgICAgIHZhciBvdXQgPSBbby52YWx1ZV07XG4gICAgICAgIGZvciAodmFyIGkgPSAxOyBpIDwgYXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIHZhciBvXzEgPSBmKGksIGFzW2ldKTtcbiAgICAgICAgICAgIGlmIChpc05vbmUob18xKSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBub25lO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgb3V0LnB1c2gob18xLnZhbHVlKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gc29tZShvdXQpO1xuICAgIH07XG59O1xuLyoqXG4gKiBFcXVpdmFsZW50IHRvIGBSZWFkb25seUFycmF5I3RyYXZlcnNlV2l0aEluZGV4KEFwcGxpY2F0aXZlKWAuXG4gKlxuICogQGNhdGVnb3J5IHRyYXZlcnNpbmdcbiAqIEBzaW5jZSAyLjExLjBcbiAqL1xuZXhwb3J0IHZhciB0cmF2ZXJzZVJlYWRvbmx5QXJyYXlXaXRoSW5kZXggPSBmdW5jdGlvbiAoZikge1xuICAgIHZhciBnID0gdHJhdmVyc2VSZWFkb25seU5vbkVtcHR5QXJyYXlXaXRoSW5kZXgoZik7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhcykgeyByZXR1cm4gKF8uaXNOb25FbXB0eShhcykgPyBnKGFzKSA6IEFwVCk7IH07XG59O1xuLyoqXG4gKiBFcXVpdmFsZW50IHRvIGBSZWFkb25seUFycmF5I3RyYXZlcnNlV2l0aEluZGV4KEFwcGxpY2F0aXZlKWAuXG4gKlxuICogQGNhdGVnb3J5IHRyYXZlcnNpbmdcbiAqIEBzaW5jZSAyLjkuMFxuICovXG5leHBvcnQgdmFyIHRyYXZlcnNlQXJyYXlXaXRoSW5kZXggPSB0cmF2ZXJzZVJlYWRvbmx5QXJyYXlXaXRoSW5kZXg7XG4vKipcbiAqIEVxdWl2YWxlbnQgdG8gYFJlYWRvbmx5QXJyYXkjdHJhdmVyc2UoQXBwbGljYXRpdmUpYC5cbiAqXG4gKiBAY2F0ZWdvcnkgdHJhdmVyc2luZ1xuICogQHNpbmNlIDIuOS4wXG4gKi9cbmV4cG9ydCB2YXIgdHJhdmVyc2VBcnJheSA9IGZ1bmN0aW9uIChmKSB7XG4gICAgcmV0dXJuIHRyYXZlcnNlUmVhZG9ubHlBcnJheVdpdGhJbmRleChmdW5jdGlvbiAoXywgYSkgeyByZXR1cm4gZihhKTsgfSk7XG59O1xuLyoqXG4gKiBFcXVpdmFsZW50IHRvIGBSZWFkb25seUFycmF5I3NlcXVlbmNlKEFwcGxpY2F0aXZlKWAuXG4gKlxuICogQGNhdGVnb3J5IHRyYXZlcnNpbmdcbiAqIEBzaW5jZSAyLjkuMFxuICovXG5leHBvcnQgdmFyIHNlcXVlbmNlQXJyYXkgPSBcbi8qI19fUFVSRV9fKi8gdHJhdmVyc2VBcnJheShpZGVudGl0eSk7XG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vLyBsZWdhY3lcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8qKlxuICogQWxpYXMgb2YgYGZsYXRNYXBgLlxuICpcbiAqIEBjYXRlZ29yeSBsZWdhY3lcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIGNoYWluID0gZmxhdE1hcDtcbi8qKlxuICogQWxpYXMgb2YgYHRhcGAuXG4gKlxuICogQGNhdGVnb3J5IGxlZ2FjeVxuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgY2hhaW5GaXJzdCA9IHRhcDtcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8vIGRlcHJlY2F0ZWRcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8qKlxuICogVXNlIGBSZWZpbmVtZW50YCBtb2R1bGUgaW5zdGVhZC5cbiAqXG4gKiBAY2F0ZWdvcnkgem9uZSBvZiBkZWF0aFxuICogQHNpbmNlIDIuMC4wXG4gKiBAZGVwcmVjYXRlZFxuICovXG5leHBvcnQgZnVuY3Rpb24gZ2V0UmVmaW5lbWVudChnZXRPcHRpb24pIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGEpIHsgcmV0dXJuIGlzU29tZShnZXRPcHRpb24oYSkpOyB9O1xufVxuLyoqXG4gKiBVc2UgW2BjaGFpbk51bGxhYmxlS2BdKCNjaGFpbm51bGxhYmxlaykgaW5zdGVhZC5cbiAqXG4gKiBAY2F0ZWdvcnkgem9uZSBvZiBkZWF0aFxuICogQHNpbmNlIDIuMC4wXG4gKiBAZGVwcmVjYXRlZFxuICovXG5leHBvcnQgdmFyIG1hcE51bGxhYmxlID0gY2hhaW5OdWxsYWJsZUs7XG4vKipcbiAqIFRoaXMgaW5zdGFuY2UgaXMgZGVwcmVjYXRlZCwgdXNlIHNtYWxsLCBzcGVjaWZpYyBpbnN0YW5jZXMgaW5zdGVhZC5cbiAqIEZvciBleGFtcGxlIGlmIGEgZnVuY3Rpb24gbmVlZHMgYSBgRnVuY3RvcmAgaW5zdGFuY2UsIHBhc3MgYE8uRnVuY3RvcmAgaW5zdGVhZCBvZiBgTy5vcHRpb25gXG4gKiAod2hlcmUgYE9gIGlzIGZyb20gYGltcG9ydCBPIGZyb20gJ2ZwLXRzL09wdGlvbidgKVxuICpcbiAqIEBjYXRlZ29yeSB6b25lIG9mIGRlYXRoXG4gKiBAc2luY2UgMi4wLjBcbiAqIEBkZXByZWNhdGVkXG4gKi9cbmV4cG9ydCB2YXIgb3B0aW9uID0ge1xuICAgIFVSSTogVVJJLFxuICAgIG1hcDogX21hcCxcbiAgICBvZjogb2YsXG4gICAgYXA6IF9hcCxcbiAgICBjaGFpbjogZmxhdE1hcCxcbiAgICByZWR1Y2U6IF9yZWR1Y2UsXG4gICAgZm9sZE1hcDogX2ZvbGRNYXAsXG4gICAgcmVkdWNlUmlnaHQ6IF9yZWR1Y2VSaWdodCxcbiAgICB0cmF2ZXJzZTogX3RyYXZlcnNlLFxuICAgIHNlcXVlbmNlOiBzZXF1ZW5jZSxcbiAgICB6ZXJvOiB6ZXJvLFxuICAgIGFsdDogX2FsdCxcbiAgICBleHRlbmQ6IF9leHRlbmQsXG4gICAgY29tcGFjdDogY29tcGFjdCxcbiAgICBzZXBhcmF0ZTogc2VwYXJhdGUsXG4gICAgZmlsdGVyOiBfZmlsdGVyLFxuICAgIGZpbHRlck1hcDogX2ZpbHRlck1hcCxcbiAgICBwYXJ0aXRpb246IF9wYXJ0aXRpb24sXG4gICAgcGFydGl0aW9uTWFwOiBfcGFydGl0aW9uTWFwLFxuICAgIHdpdGhlcjogX3dpdGhlcixcbiAgICB3aWx0OiBfd2lsdCxcbiAgICB0aHJvd0Vycm9yOiB0aHJvd0Vycm9yXG59O1xuLyoqXG4gKiBVc2UgW2BnZXRBcHBseVNlbWlncm91cGBdKC4vQXBwbHkudHMuaHRtbCNnZXRhcHBseXNlbWlncm91cCkgaW5zdGVhZC5cbiAqXG4gKiBAY2F0ZWdvcnkgem9uZSBvZiBkZWF0aFxuICogQHNpbmNlIDIuMC4wXG4gKiBAZGVwcmVjYXRlZFxuICovXG5leHBvcnQgdmFyIGdldEFwcGx5U2VtaWdyb3VwID0gLyojX19QVVJFX18qLyBnZXRBcHBseVNlbWlncm91cF8oQXBwbHkpO1xuLyoqXG4gKiBVc2UgW2BnZXRBcHBsaWNhdGl2ZU1vbm9pZGBdKC4vQXBwbGljYXRpdmUudHMuaHRtbCNnZXRhcHBsaWNhdGl2ZW1vbm9pZCkgaW5zdGVhZC5cbiAqXG4gKiBAY2F0ZWdvcnkgem9uZSBvZiBkZWF0aFxuICogQHNpbmNlIDIuMC4wXG4gKiBAZGVwcmVjYXRlZFxuICovXG5leHBvcnQgdmFyIGdldEFwcGx5TW9ub2lkID0gLyojX19QVVJFX18qLyBnZXRBcHBsaWNhdGl2ZU1vbm9pZChBcHBsaWNhdGl2ZSk7XG4vKipcbiAqIFVzZVxuICpcbiAqIGBgYHRzXG4gKiBpbXBvcnQgeyBmaXJzdCB9IGZyb20gJ2ZwLXRzL1NlbWlncm91cCdcbiAqIGltcG9ydCB7IGdldE1vbm9pZCB9IGZyb20gJ2ZwLXRzL09wdGlvbidcbiAqXG4gKiBnZXRNb25vaWQoZmlyc3QoKSlcbiAqIGBgYFxuICpcbiAqIGluc3RlYWQuXG4gKlxuICogTW9ub2lkIHJldHVybmluZyB0aGUgbGVmdC1tb3N0IG5vbi1gTm9uZWAgdmFsdWVcbiAqXG4gKiB8IHggICAgICAgfCB5ICAgICAgIHwgY29uY2F0KHgsIHkpIHxcbiAqIHwgLS0tLS0tLSB8IC0tLS0tLS0gfCAtLS0tLS0tLS0tLS0gfFxuICogfCBub25lICAgIHwgbm9uZSAgICB8IG5vbmUgICAgICAgICB8XG4gKiB8IHNvbWUoYSkgfCBub25lICAgIHwgc29tZShhKSAgICAgIHxcbiAqIHwgbm9uZSAgICB8IHNvbWUoYikgfCBzb21lKGIpICAgICAgfFxuICogfCBzb21lKGEpIHwgc29tZShiKSB8IHNvbWUoYSkgICAgICB8XG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IGdldEZpcnN0TW9ub2lkLCBzb21lLCBub25lIH0gZnJvbSAnZnAtdHMvT3B0aW9uJ1xuICpcbiAqIGNvbnN0IE0gPSBnZXRGaXJzdE1vbm9pZDxudW1iZXI+KClcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoTS5jb25jYXQobm9uZSwgbm9uZSksIG5vbmUpXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKE0uY29uY2F0KHNvbWUoMSksIG5vbmUpLCBzb21lKDEpKVxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChNLmNvbmNhdChub25lLCBzb21lKDIpKSwgc29tZSgyKSlcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoTS5jb25jYXQoc29tZSgxKSwgc29tZSgyKSksIHNvbWUoMSkpXG4gKlxuICogQGNhdGVnb3J5IHpvbmUgb2YgZGVhdGhcbiAqIEBzaW5jZSAyLjAuMFxuICogQGRlcHJlY2F0ZWRcbiAqL1xuZXhwb3J0IHZhciBnZXRGaXJzdE1vbm9pZCA9IGZ1bmN0aW9uICgpIHsgcmV0dXJuIGdldE1vbm9pZChmaXJzdCgpKTsgfTtcbi8qKlxuICogVXNlXG4gKlxuICogYGBgdHNcbiAqIGltcG9ydCB7IGxhc3QgfSBmcm9tICdmcC10cy9TZW1pZ3JvdXAnXG4gKiBpbXBvcnQgeyBnZXRNb25vaWQgfSBmcm9tICdmcC10cy9PcHRpb24nXG4gKlxuICogZ2V0TW9ub2lkKGxhc3QoKSlcbiAqIGBgYFxuICpcbiAqIGluc3RlYWQuXG4gKlxuICogTW9ub2lkIHJldHVybmluZyB0aGUgcmlnaHQtbW9zdCBub24tYE5vbmVgIHZhbHVlXG4gKlxuICogfCB4ICAgICAgIHwgeSAgICAgICB8IGNvbmNhdCh4LCB5KSB8XG4gKiB8IC0tLS0tLS0gfCAtLS0tLS0tIHwgLS0tLS0tLS0tLS0tIHxcbiAqIHwgbm9uZSAgICB8IG5vbmUgICAgfCBub25lICAgICAgICAgfFxuICogfCBzb21lKGEpIHwgbm9uZSAgICB8IHNvbWUoYSkgICAgICB8XG4gKiB8IG5vbmUgICAgfCBzb21lKGIpIHwgc29tZShiKSAgICAgIHxcbiAqIHwgc29tZShhKSB8IHNvbWUoYikgfCBzb21lKGIpICAgICAgfFxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBnZXRMYXN0TW9ub2lkLCBzb21lLCBub25lIH0gZnJvbSAnZnAtdHMvT3B0aW9uJ1xuICpcbiAqIGNvbnN0IE0gPSBnZXRMYXN0TW9ub2lkPG51bWJlcj4oKVxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChNLmNvbmNhdChub25lLCBub25lKSwgbm9uZSlcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoTS5jb25jYXQoc29tZSgxKSwgbm9uZSksIHNvbWUoMSkpXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKE0uY29uY2F0KG5vbmUsIHNvbWUoMikpLCBzb21lKDIpKVxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChNLmNvbmNhdChzb21lKDEpLCBzb21lKDIpKSwgc29tZSgyKSlcbiAqXG4gKiBAY2F0ZWdvcnkgem9uZSBvZiBkZWF0aFxuICogQHNpbmNlIDIuMC4wXG4gKiBAZGVwcmVjYXRlZFxuICovXG5leHBvcnQgdmFyIGdldExhc3RNb25vaWQgPSBmdW5jdGlvbiAoKSB7IHJldHVybiBnZXRNb25vaWQobGFzdCgpKTsgfTtcbiIsCiAgImltcG9ydCB7IGdldEFwcGxpY2F0aXZlTW9ub2lkIH0gZnJvbSAnLi9BcHBsaWNhdGl2ZSc7XG5pbXBvcnQgeyBhcEZpcnN0IGFzIGFwRmlyc3RfLCBhcFMgYXMgYXBTXywgYXBTZWNvbmQgYXMgYXBTZWNvbmRfLCBnZXRBcHBseVNlbWlncm91cCBhcyBnZXRBcHBseVNlbWlncm91cF8gfSBmcm9tICcuL0FwcGx5JztcbmltcG9ydCAqIGFzIGNoYWluYWJsZSBmcm9tICcuL0NoYWluJztcbmltcG9ydCB7IGNoYWluRWl0aGVySyBhcyBjaGFpbkVpdGhlcktfLCBmcm9tRWl0aGVySyBhcyBmcm9tRWl0aGVyS18sIHRhcEVpdGhlciBhcyB0YXBFaXRoZXJfIH0gZnJvbSAnLi9Gcm9tRWl0aGVyJztcbmltcG9ydCB7IGNvbnN0TnVsbCwgY29uc3RVbmRlZmluZWQsIGR1YWwsIGZsb3csIGlkZW50aXR5LCBwaXBlIH0gZnJvbSAnLi9mdW5jdGlvbic7XG5pbXBvcnQgeyBhcyBhcyBhc18sIGFzVW5pdCBhcyBhc1VuaXRfLCBiaW5kVG8gYXMgYmluZFRvXywgZmxhcCBhcyBmbGFwXywgbGV0IGFzIGxldF9fIH0gZnJvbSAnLi9GdW5jdG9yJztcbmltcG9ydCAqIGFzIF8gZnJvbSAnLi9pbnRlcm5hbCc7XG5pbXBvcnQgeyBub3QgfSBmcm9tICcuL1ByZWRpY2F0ZSc7XG5pbXBvcnQgeyBmaXJzdCwgbGFzdCB9IGZyb20gJy4vU2VtaWdyb3VwJztcbmltcG9ydCB7IHNlcGFyYXRlZCB9IGZyb20gJy4vU2VwYXJhdGVkJztcbmltcG9ydCB7IHdpbHREZWZhdWx0LCB3aXRoZXJEZWZhdWx0IH0gZnJvbSAnLi9XaXRoZXJhYmxlJztcbmltcG9ydCB7IGd1YXJkIGFzIGd1YXJkXyB9IGZyb20gJy4vWmVybyc7XG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vLyBjb25zdHJ1Y3RvcnNcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8qKlxuICogYE5vbmVgIGRvZXNuJ3QgaGF2ZSBhIGNvbnN0cnVjdG9yLCBpbnN0ZWFkIHlvdSBjYW4gdXNlIGl0IGRpcmVjdGx5IGFzIGEgdmFsdWUuIFJlcHJlc2VudHMgYSBtaXNzaW5nIHZhbHVlLlxuICpcbiAqIEBjYXRlZ29yeSBjb25zdHJ1Y3RvcnNcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIG5vbmUgPSBfLm5vbmU7XG4vKipcbiAqIENvbnN0cnVjdHMgYSBgU29tZWAuIFJlcHJlc2VudHMgYW4gb3B0aW9uYWwgdmFsdWUgdGhhdCBleGlzdHMuXG4gKlxuICogQGNhdGVnb3J5IGNvbnN0cnVjdG9yc1xuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgc29tZSA9IF8uc29tZTtcbmV4cG9ydCBmdW5jdGlvbiBmcm9tUHJlZGljYXRlKHByZWRpY2F0ZSkge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYSkgeyByZXR1cm4gKHByZWRpY2F0ZShhKSA/IHNvbWUoYSkgOiBub25lKTsgfTtcbn1cbi8qKlxuICogUmV0dXJucyB0aGUgYExlZnRgIHZhbHVlIG9mIGFuIGBFaXRoZXJgIGlmIHBvc3NpYmxlLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBnZXRMZWZ0LCBub25lLCBzb21lIH0gZnJvbSAnZnAtdHMvT3B0aW9uJ1xuICogaW1wb3J0IHsgcmlnaHQsIGxlZnQgfSBmcm9tICdmcC10cy9FaXRoZXInXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChnZXRMZWZ0KHJpZ2h0KDEpKSwgbm9uZSlcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoZ2V0TGVmdChsZWZ0KCdhJykpLCBzb21lKCdhJykpXG4gKlxuICogQGNhdGVnb3J5IGNvbnN0cnVjdG9yc1xuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgZ2V0TGVmdCA9IGZ1bmN0aW9uIChtYSkgeyByZXR1cm4gKG1hLl90YWcgPT09ICdSaWdodCcgPyBub25lIDogc29tZShtYS5sZWZ0KSk7IH07XG4vKipcbiAqIFJldHVybnMgdGhlIGBSaWdodGAgdmFsdWUgb2YgYW4gYEVpdGhlcmAgaWYgcG9zc2libGUuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IGdldFJpZ2h0LCBub25lLCBzb21lIH0gZnJvbSAnZnAtdHMvT3B0aW9uJ1xuICogaW1wb3J0IHsgcmlnaHQsIGxlZnQgfSBmcm9tICdmcC10cy9FaXRoZXInXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChnZXRSaWdodChyaWdodCgxKSksIHNvbWUoMSkpXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKGdldFJpZ2h0KGxlZnQoJ2EnKSksIG5vbmUpXG4gKlxuICogQGNhdGVnb3J5IGNvbnN0cnVjdG9yc1xuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgZ2V0UmlnaHQgPSBmdW5jdGlvbiAobWEpIHsgcmV0dXJuIChtYS5fdGFnID09PSAnTGVmdCcgPyBub25lIDogc29tZShtYS5yaWdodCkpOyB9O1xudmFyIF9tYXAgPSBmdW5jdGlvbiAoZmEsIGYpIHsgcmV0dXJuIHBpcGUoZmEsIG1hcChmKSk7IH07XG52YXIgX2FwID0gZnVuY3Rpb24gKGZhYiwgZmEpIHsgcmV0dXJuIHBpcGUoZmFiLCBhcChmYSkpOyB9O1xudmFyIF9yZWR1Y2UgPSBmdW5jdGlvbiAoZmEsIGIsIGYpIHsgcmV0dXJuIHBpcGUoZmEsIHJlZHVjZShiLCBmKSk7IH07XG52YXIgX2ZvbGRNYXAgPSBmdW5jdGlvbiAoTSkge1xuICAgIHZhciBmb2xkTWFwTSA9IGZvbGRNYXAoTSk7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChmYSwgZikgeyByZXR1cm4gcGlwZShmYSwgZm9sZE1hcE0oZikpOyB9O1xufTtcbnZhciBfcmVkdWNlUmlnaHQgPSBmdW5jdGlvbiAoZmEsIGIsIGYpIHsgcmV0dXJuIHBpcGUoZmEsIHJlZHVjZVJpZ2h0KGIsIGYpKTsgfTtcbnZhciBfdHJhdmVyc2UgPSBmdW5jdGlvbiAoRikge1xuICAgIHZhciB0cmF2ZXJzZUYgPSB0cmF2ZXJzZShGKTtcbiAgICByZXR1cm4gZnVuY3Rpb24gKHRhLCBmKSB7IHJldHVybiBwaXBlKHRhLCB0cmF2ZXJzZUYoZikpOyB9O1xufTtcbi8qIGlzdGFuYnVsIGlnbm9yZSBuZXh0ICovXG52YXIgX2FsdCA9IGZ1bmN0aW9uIChmYSwgdGhhdCkgeyByZXR1cm4gcGlwZShmYSwgYWx0KHRoYXQpKTsgfTtcbnZhciBfZmlsdGVyID0gZnVuY3Rpb24gKGZhLCBwcmVkaWNhdGUpIHsgcmV0dXJuIHBpcGUoZmEsIGZpbHRlcihwcmVkaWNhdGUpKTsgfTtcbi8qIGlzdGFuYnVsIGlnbm9yZSBuZXh0ICovXG52YXIgX2ZpbHRlck1hcCA9IGZ1bmN0aW9uIChmYSwgZikgeyByZXR1cm4gcGlwZShmYSwgZmlsdGVyTWFwKGYpKTsgfTtcbi8qIGlzdGFuYnVsIGlnbm9yZSBuZXh0ICovXG52YXIgX2V4dGVuZCA9IGZ1bmN0aW9uICh3YSwgZikgeyByZXR1cm4gcGlwZSh3YSwgZXh0ZW5kKGYpKTsgfTtcbi8qIGlzdGFuYnVsIGlnbm9yZSBuZXh0ICovXG52YXIgX3BhcnRpdGlvbiA9IGZ1bmN0aW9uIChmYSwgcHJlZGljYXRlKSB7XG4gICAgcmV0dXJuIHBpcGUoZmEsIHBhcnRpdGlvbihwcmVkaWNhdGUpKTtcbn07XG4vKiBpc3RhbmJ1bCBpZ25vcmUgbmV4dCAqL1xudmFyIF9wYXJ0aXRpb25NYXAgPSBmdW5jdGlvbiAoZmEsIGYpIHsgcmV0dXJuIHBpcGUoZmEsIHBhcnRpdGlvbk1hcChmKSk7IH07XG4vKipcbiAqIEBjYXRlZ29yeSB0eXBlIGxhbWJkYXNcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIFVSSSA9ICdPcHRpb24nO1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciBnZXRTaG93ID0gZnVuY3Rpb24gKFMpIHsgcmV0dXJuICh7XG4gICAgc2hvdzogZnVuY3Rpb24gKG1hKSB7IHJldHVybiAoaXNOb25lKG1hKSA/ICdub25lJyA6IFwic29tZShcIi5jb25jYXQoUy5zaG93KG1hLnZhbHVlKSwgXCIpXCIpKTsgfVxufSk7IH07XG4vKipcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBub25lLCBzb21lLCBnZXRFcSB9IGZyb20gJ2ZwLXRzL09wdGlvbidcbiAqIGltcG9ydCAqIGFzIE4gZnJvbSAnZnAtdHMvbnVtYmVyJ1xuICpcbiAqIGNvbnN0IEUgPSBnZXRFcShOLkVxKVxuICogYXNzZXJ0LnN0cmljdEVxdWFsKEUuZXF1YWxzKG5vbmUsIG5vbmUpLCB0cnVlKVxuICogYXNzZXJ0LnN0cmljdEVxdWFsKEUuZXF1YWxzKG5vbmUsIHNvbWUoMSkpLCBmYWxzZSlcbiAqIGFzc2VydC5zdHJpY3RFcXVhbChFLmVxdWFscyhzb21lKDEpLCBub25lKSwgZmFsc2UpXG4gKiBhc3NlcnQuc3RyaWN0RXF1YWwoRS5lcXVhbHMoc29tZSgxKSwgc29tZSgyKSksIGZhbHNlKVxuICogYXNzZXJ0LnN0cmljdEVxdWFsKEUuZXF1YWxzKHNvbWUoMSksIHNvbWUoMSkpLCB0cnVlKVxuICpcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIGdldEVxID0gZnVuY3Rpb24gKEUpIHsgcmV0dXJuICh7XG4gICAgZXF1YWxzOiBmdW5jdGlvbiAoeCwgeSkgeyByZXR1cm4geCA9PT0geSB8fCAoaXNOb25lKHgpID8gaXNOb25lKHkpIDogaXNOb25lKHkpID8gZmFsc2UgOiBFLmVxdWFscyh4LnZhbHVlLCB5LnZhbHVlKSk7IH1cbn0pOyB9O1xuLyoqXG4gKiBUaGUgYE9yZGAgaW5zdGFuY2UgYWxsb3dzIGBPcHRpb25gIHZhbHVlcyB0byBiZSBjb21wYXJlZCB3aXRoXG4gKiBgY29tcGFyZWAsIHdoZW5ldmVyIHRoZXJlIGlzIGFuIGBPcmRgIGluc3RhbmNlIGZvclxuICogdGhlIHR5cGUgdGhlIGBPcHRpb25gIGNvbnRhaW5zLlxuICpcbiAqIGBOb25lYCBpcyBjb25zaWRlcmVkIHRvIGJlIGxlc3MgdGhhbiBhbnkgYFNvbWVgIHZhbHVlLlxuICpcbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgbm9uZSwgc29tZSwgZ2V0T3JkIH0gZnJvbSAnZnAtdHMvT3B0aW9uJ1xuICogaW1wb3J0ICogYXMgTiBmcm9tICdmcC10cy9udW1iZXInXG4gKlxuICogY29uc3QgTyA9IGdldE9yZChOLk9yZClcbiAqIGFzc2VydC5zdHJpY3RFcXVhbChPLmNvbXBhcmUobm9uZSwgbm9uZSksIDApXG4gKiBhc3NlcnQuc3RyaWN0RXF1YWwoTy5jb21wYXJlKG5vbmUsIHNvbWUoMSkpLCAtMSlcbiAqIGFzc2VydC5zdHJpY3RFcXVhbChPLmNvbXBhcmUoc29tZSgxKSwgbm9uZSksIDEpXG4gKiBhc3NlcnQuc3RyaWN0RXF1YWwoTy5jb21wYXJlKHNvbWUoMSksIHNvbWUoMikpLCAtMSlcbiAqIGFzc2VydC5zdHJpY3RFcXVhbChPLmNvbXBhcmUoc29tZSgxKSwgc29tZSgxKSksIDApXG4gKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgZ2V0T3JkID0gZnVuY3Rpb24gKE8pIHsgcmV0dXJuICh7XG4gICAgZXF1YWxzOiBnZXRFcShPKS5lcXVhbHMsXG4gICAgY29tcGFyZTogZnVuY3Rpb24gKHgsIHkpIHsgcmV0dXJuICh4ID09PSB5ID8gMCA6IGlzU29tZSh4KSA/IChpc1NvbWUoeSkgPyBPLmNvbXBhcmUoeC52YWx1ZSwgeS52YWx1ZSkgOiAxKSA6IC0xKTsgfVxufSk7IH07XG4vKipcbiAqIE1vbm9pZCByZXR1cm5pbmcgdGhlIGxlZnQtbW9zdCBub24tYE5vbmVgIHZhbHVlLiBJZiBib3RoIG9wZXJhbmRzIGFyZSBgU29tZWBzIHRoZW4gdGhlIGlubmVyIHZhbHVlcyBhcmVcbiAqIGNvbmNhdGVuYXRlZCB1c2luZyB0aGUgcHJvdmlkZWQgYFNlbWlncm91cGBcbiAqXG4gKiB8IHggICAgICAgfCB5ICAgICAgIHwgY29uY2F0KHgsIHkpICAgICAgIHxcbiAqIHwgLS0tLS0tLSB8IC0tLS0tLS0gfCAtLS0tLS0tLS0tLS0tLS0tLS0gfFxuICogfCBub25lICAgIHwgbm9uZSAgICB8IG5vbmUgICAgICAgICAgICAgICB8XG4gKiB8IHNvbWUoYSkgfCBub25lICAgIHwgc29tZShhKSAgICAgICAgICAgIHxcbiAqIHwgbm9uZSAgICB8IHNvbWUoYikgfCBzb21lKGIpICAgICAgICAgICAgfFxuICogfCBzb21lKGEpIHwgc29tZShiKSB8IHNvbWUoY29uY2F0KGEsIGIpKSB8XG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IGdldE1vbm9pZCwgc29tZSwgbm9uZSB9IGZyb20gJ2ZwLXRzL09wdGlvbidcbiAqIGltcG9ydCB7IFNlbWlncm91cFN1bSB9IGZyb20gJ2ZwLXRzL251bWJlcidcbiAqXG4gKiBjb25zdCBNID0gZ2V0TW9ub2lkKFNlbWlncm91cFN1bSlcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoTS5jb25jYXQobm9uZSwgbm9uZSksIG5vbmUpXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKE0uY29uY2F0KHNvbWUoMSksIG5vbmUpLCBzb21lKDEpKVxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChNLmNvbmNhdChub25lLCBzb21lKDEpKSwgc29tZSgxKSlcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoTS5jb25jYXQoc29tZSgxKSwgc29tZSgyKSksIHNvbWUoMykpXG4gKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgZ2V0TW9ub2lkID0gZnVuY3Rpb24gKFMpIHsgcmV0dXJuICh7XG4gICAgY29uY2F0OiBmdW5jdGlvbiAoeCwgeSkgeyByZXR1cm4gKGlzTm9uZSh4KSA/IHkgOiBpc05vbmUoeSkgPyB4IDogc29tZShTLmNvbmNhdCh4LnZhbHVlLCB5LnZhbHVlKSkpOyB9LFxuICAgIGVtcHR5OiBub25lXG59KTsgfTtcbi8qKlxuICogQGNhdGVnb3J5IG1hcHBpbmdcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIG1hcCA9IGZ1bmN0aW9uIChmKSB7IHJldHVybiBmdW5jdGlvbiAoZmEpIHtcbiAgICByZXR1cm4gaXNOb25lKGZhKSA/IG5vbmUgOiBzb21lKGYoZmEudmFsdWUpKTtcbn07IH07XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjcuMFxuICovXG5leHBvcnQgdmFyIEZ1bmN0b3IgPSB7XG4gICAgVVJJOiBVUkksXG4gICAgbWFwOiBfbWFwXG59O1xuLyoqXG4gKiBNYXBzIHRoZSBgU29tZWAgdmFsdWUgb2YgdGhpcyBgT3B0aW9uYCB0byB0aGUgc3BlY2lmaWVkIGNvbnN0YW50IHZhbHVlLlxuICpcbiAqIEBjYXRlZ29yeSBtYXBwaW5nXG4gKiBAc2luY2UgMi4xNi4wXG4gKi9cbmV4cG9ydCB2YXIgYXMgPSBkdWFsKDIsIGFzXyhGdW5jdG9yKSk7XG4vKipcbiAqIE1hcHMgdGhlIGBTb21lYCB2YWx1ZSBvZiB0aGlzIGBPcHRpb25gIHRvIHRoZSB2b2lkIGNvbnN0YW50IHZhbHVlLlxuICpcbiAqIEBjYXRlZ29yeSBtYXBwaW5nXG4gKiBAc2luY2UgMi4xNi4wXG4gKi9cbmV4cG9ydCB2YXIgYXNVbml0ID0gYXNVbml0XyhGdW5jdG9yKTtcbi8qKlxuICogQGNhdGVnb3J5IGNvbnN0cnVjdG9yc1xuICogQHNpbmNlIDIuNy4wXG4gKi9cbmV4cG9ydCB2YXIgb2YgPSBzb21lO1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi4xMC4wXG4gKi9cbmV4cG9ydCB2YXIgUG9pbnRlZCA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICBvZjogb2Zcbn07XG4vKipcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIGFwID0gZnVuY3Rpb24gKGZhKSB7IHJldHVybiBmdW5jdGlvbiAoZmFiKSB7XG4gICAgcmV0dXJuIGlzTm9uZShmYWIpID8gbm9uZSA6IGlzTm9uZShmYSkgPyBub25lIDogc29tZShmYWIudmFsdWUoZmEudmFsdWUpKTtcbn07IH07XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjEwLjBcbiAqL1xuZXhwb3J0IHZhciBBcHBseSA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICBtYXA6IF9tYXAsXG4gICAgYXA6IF9hcFxufTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuNy4wXG4gKi9cbmV4cG9ydCB2YXIgQXBwbGljYXRpdmUgPSB7XG4gICAgVVJJOiBVUkksXG4gICAgbWFwOiBfbWFwLFxuICAgIGFwOiBfYXAsXG4gICAgb2Y6IG9mXG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgc2VxdWVuY2luZ1xuICogQHNpbmNlIDIuMTQuMFxuICovXG5leHBvcnQgdmFyIGZsYXRNYXAgPSAvKiNfX1BVUkVfXyovIGR1YWwoMiwgZnVuY3Rpb24gKG1hLCBmKSB7IHJldHVybiAoaXNOb25lKG1hKSA/IG5vbmUgOiBmKG1hLnZhbHVlKSk7IH0pO1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi4xMC4wXG4gKi9cbmV4cG9ydCB2YXIgQ2hhaW4gPSB7XG4gICAgVVJJOiBVUkksXG4gICAgbWFwOiBfbWFwLFxuICAgIGFwOiBfYXAsXG4gICAgY2hhaW46IGZsYXRNYXBcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjcuMFxuICovXG5leHBvcnQgdmFyIE1vbmFkID0ge1xuICAgIFVSSTogVVJJLFxuICAgIG1hcDogX21hcCxcbiAgICBhcDogX2FwLFxuICAgIG9mOiBvZixcbiAgICBjaGFpbjogZmxhdE1hcFxufTtcbi8qKlxuICogQGNhdGVnb3J5IGZvbGRpbmdcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIHJlZHVjZSA9IGZ1bmN0aW9uIChiLCBmKSB7IHJldHVybiBmdW5jdGlvbiAoZmEpIHtcbiAgICByZXR1cm4gaXNOb25lKGZhKSA/IGIgOiBmKGIsIGZhLnZhbHVlKTtcbn07IH07XG4vKipcbiAqIEBjYXRlZ29yeSBmb2xkaW5nXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciBmb2xkTWFwID0gZnVuY3Rpb24gKE0pIHsgcmV0dXJuIGZ1bmN0aW9uIChmKSB7IHJldHVybiBmdW5jdGlvbiAoZmEpIHtcbiAgICByZXR1cm4gaXNOb25lKGZhKSA/IE0uZW1wdHkgOiBmKGZhLnZhbHVlKTtcbn07IH07IH07XG4vKipcbiAqIEBjYXRlZ29yeSBmb2xkaW5nXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciByZWR1Y2VSaWdodCA9IGZ1bmN0aW9uIChiLCBmKSB7IHJldHVybiBmdW5jdGlvbiAoZmEpIHtcbiAgICByZXR1cm4gaXNOb25lKGZhKSA/IGIgOiBmKGZhLnZhbHVlLCBiKTtcbn07IH07XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjcuMFxuICovXG5leHBvcnQgdmFyIEZvbGRhYmxlID0ge1xuICAgIFVSSTogVVJJLFxuICAgIHJlZHVjZTogX3JlZHVjZSxcbiAgICBmb2xkTWFwOiBfZm9sZE1hcCxcbiAgICByZWR1Y2VSaWdodDogX3JlZHVjZVJpZ2h0XG59O1xuLyoqXG4gKiBSZXR1cm5zIHRoZSBwcm92aWRlZCBgT3B0aW9uYCBgdGhhdGAgaWYgYHNlbGZgIGlzIGBOb25lYCwgb3RoZXJ3aXNlIHJldHVybnMgYHNlbGZgLlxuICpcbiAqIEBwYXJhbSBzZWxmIC0gVGhlIGZpcnN0IGBPcHRpb25gIHRvIGJlIGNoZWNrZWQuXG4gKiBAcGFyYW0gdGhhdCAtIFRoZSBgT3B0aW9uYCB0byByZXR1cm4gaWYgYHNlbGZgIGlzIGBOb25lYC5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0ICogYXMgTyBmcm9tIFwiZnAtdHMvT3B0aW9uXCJcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKE8ub3JFbHNlKE8ubm9uZSwgKCkgPT4gTy5ub25lKSwgTy5ub25lKVxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChPLm9yRWxzZShPLnNvbWUoMSksICgpID0+IE8ubm9uZSksIE8uc29tZSgxKSlcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoTy5vckVsc2UoTy5ub25lLCAoKSA9PiBPLnNvbWUoJ2InKSksIE8uc29tZSgnYicpKVxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChPLm9yRWxzZShPLnNvbWUoMSksICgpID0+IE8uc29tZSgnYicpKSwgTy5zb21lKDEpKVxuICpcbiAqIEBjYXRlZ29yeSBlcnJvciBoYW5kbGluZ1xuICogQHNpbmNlIDIuMTYuMFxuICovXG5leHBvcnQgdmFyIG9yRWxzZSA9IGR1YWwoMiwgZnVuY3Rpb24gKHNlbGYsIHRoYXQpIHsgcmV0dXJuIChpc05vbmUoc2VsZikgPyB0aGF0KCkgOiBzZWxmKTsgfSk7XG4vKipcbiAqIEFsaWFzIG9mIGBvckVsc2VgLlxuICpcbiAqIExlc3Mgc3RyaWN0IHZlcnNpb24gb2YgW2BhbHRgXSgjYWx0KS5cbiAqXG4gKiBUaGUgYFdgIHN1ZmZpeCAoc2hvcnQgZm9yICoqVyoqaWRlbmluZykgbWVhbnMgdGhhdCB0aGUgcmV0dXJuIHR5cGVzIHdpbGwgYmUgbWVyZ2VkLlxuICpcbiAqIEBjYXRlZ29yeSBsZWdhY3lcbiAqIEBzaW5jZSAyLjkuMFxuICovXG5leHBvcnQgdmFyIGFsdFcgPSBvckVsc2U7XG4vKipcbiAqIEFsaWFzIG9mIGBvckVsc2VgLlxuICpcbiAqIEBjYXRlZ29yeSBsZWdhY3lcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIGFsdCA9IG9yRWxzZTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuNy4wXG4gKi9cbmV4cG9ydCB2YXIgQWx0ID0ge1xuICAgIFVSSTogVVJJLFxuICAgIG1hcDogX21hcCxcbiAgICBhbHQ6IF9hbHRcbn07XG4vKipcbiAqIEBzaW5jZSAyLjcuMFxuICovXG5leHBvcnQgdmFyIHplcm8gPSBmdW5jdGlvbiAoKSB7IHJldHVybiBub25lOyB9O1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi4xMS4wXG4gKi9cbmV4cG9ydCB2YXIgWmVybyA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICB6ZXJvOiB6ZXJvXG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgZG8gbm90YXRpb25cbiAqIEBzaW5jZSAyLjExLjBcbiAqL1xuZXhwb3J0IHZhciBndWFyZCA9IC8qI19fUFVSRV9fKi8gZ3VhcmRfKFplcm8sIFBvaW50ZWQpO1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi43LjBcbiAqL1xuZXhwb3J0IHZhciBBbHRlcm5hdGl2ZSA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICBtYXA6IF9tYXAsXG4gICAgYXA6IF9hcCxcbiAgICBvZjogb2YsXG4gICAgYWx0OiBfYWx0LFxuICAgIHplcm86IHplcm9cbn07XG4vKipcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIGV4dGVuZCA9IGZ1bmN0aW9uIChmKSB7IHJldHVybiBmdW5jdGlvbiAod2EpIHtcbiAgICByZXR1cm4gaXNOb25lKHdhKSA/IG5vbmUgOiBzb21lKGYod2EpKTtcbn07IH07XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjcuMFxuICovXG5leHBvcnQgdmFyIEV4dGVuZCA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICBtYXA6IF9tYXAsXG4gICAgZXh0ZW5kOiBfZXh0ZW5kXG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgZmlsdGVyaW5nXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciBjb21wYWN0ID0gLyojX19QVVJFX18qLyBmbGF0TWFwKGlkZW50aXR5KTtcbnZhciBkZWZhdWx0U2VwYXJhdGVkID0gLyojX19QVVJFX18qLyBzZXBhcmF0ZWQobm9uZSwgbm9uZSk7XG4vKipcbiAqIEBjYXRlZ29yeSBmaWx0ZXJpbmdcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIHNlcGFyYXRlID0gZnVuY3Rpb24gKG1hKSB7XG4gICAgcmV0dXJuIGlzTm9uZShtYSkgPyBkZWZhdWx0U2VwYXJhdGVkIDogc2VwYXJhdGVkKGdldExlZnQobWEudmFsdWUpLCBnZXRSaWdodChtYS52YWx1ZSkpO1xufTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuNy4wXG4gKi9cbmV4cG9ydCB2YXIgQ29tcGFjdGFibGUgPSB7XG4gICAgVVJJOiBVUkksXG4gICAgY29tcGFjdDogY29tcGFjdCxcbiAgICBzZXBhcmF0ZTogc2VwYXJhdGVcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBmaWx0ZXJpbmdcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIGZpbHRlciA9IGZ1bmN0aW9uIChwcmVkaWNhdGUpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGZhKSB7XG4gICAgICAgIHJldHVybiBpc05vbmUoZmEpID8gbm9uZSA6IHByZWRpY2F0ZShmYS52YWx1ZSkgPyBmYSA6IG5vbmU7XG4gICAgfTtcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBmaWx0ZXJpbmdcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIGZpbHRlck1hcCA9IGZ1bmN0aW9uIChmKSB7IHJldHVybiBmdW5jdGlvbiAoZmEpIHtcbiAgICByZXR1cm4gaXNOb25lKGZhKSA/IG5vbmUgOiBmKGZhLnZhbHVlKTtcbn07IH07XG4vKipcbiAqIEBjYXRlZ29yeSBmaWx0ZXJpbmdcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIHBhcnRpdGlvbiA9IGZ1bmN0aW9uIChwcmVkaWNhdGUpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGZhKSB7XG4gICAgICAgIHJldHVybiBzZXBhcmF0ZWQoX2ZpbHRlcihmYSwgbm90KHByZWRpY2F0ZSkpLCBfZmlsdGVyKGZhLCBwcmVkaWNhdGUpKTtcbiAgICB9O1xufTtcbi8qKlxuICogQGNhdGVnb3J5IGZpbHRlcmluZ1xuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgcGFydGl0aW9uTWFwID0gZnVuY3Rpb24gKGYpIHsgcmV0dXJuIGZsb3cobWFwKGYpLCBzZXBhcmF0ZSk7IH07XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjcuMFxuICovXG5leHBvcnQgdmFyIEZpbHRlcmFibGUgPSB7XG4gICAgVVJJOiBVUkksXG4gICAgbWFwOiBfbWFwLFxuICAgIGNvbXBhY3Q6IGNvbXBhY3QsXG4gICAgc2VwYXJhdGU6IHNlcGFyYXRlLFxuICAgIGZpbHRlcjogX2ZpbHRlcixcbiAgICBmaWx0ZXJNYXA6IF9maWx0ZXJNYXAsXG4gICAgcGFydGl0aW9uOiBfcGFydGl0aW9uLFxuICAgIHBhcnRpdGlvbk1hcDogX3BhcnRpdGlvbk1hcFxufTtcbi8qKlxuICogQGNhdGVnb3J5IHRyYXZlcnNpbmdcbiAqIEBzaW5jZSAyLjYuM1xuICovXG5leHBvcnQgdmFyIHRyYXZlcnNlID0gZnVuY3Rpb24gKEYpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGYpIHtcbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uICh0YSkge1xuICAgICAgICAgICAgcmV0dXJuIGlzTm9uZSh0YSkgPyBGLm9mKG5vbmUpIDogRi5tYXAoZih0YS52YWx1ZSksIHNvbWUpO1xuICAgICAgICB9O1xuICAgIH07XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgdHJhdmVyc2luZ1xuICogQHNpbmNlIDIuNi4zXG4gKi9cbmV4cG9ydCB2YXIgc2VxdWVuY2UgPSBmdW5jdGlvbiAoRikge1xuICAgIHJldHVybiBmdW5jdGlvbiAodGEpIHtcbiAgICAgICAgcmV0dXJuIGlzTm9uZSh0YSkgPyBGLm9mKG5vbmUpIDogRi5tYXAodGEudmFsdWUsIHNvbWUpO1xuICAgIH07XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi43LjBcbiAqL1xuZXhwb3J0IHZhciBUcmF2ZXJzYWJsZSA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICBtYXA6IF9tYXAsXG4gICAgcmVkdWNlOiBfcmVkdWNlLFxuICAgIGZvbGRNYXA6IF9mb2xkTWFwLFxuICAgIHJlZHVjZVJpZ2h0OiBfcmVkdWNlUmlnaHQsXG4gICAgdHJhdmVyc2U6IF90cmF2ZXJzZSxcbiAgICBzZXF1ZW5jZTogc2VxdWVuY2Vcbn07XG52YXIgX3dpdGhlciA9IC8qI19fUFVSRV9fKi8gd2l0aGVyRGVmYXVsdChUcmF2ZXJzYWJsZSwgQ29tcGFjdGFibGUpO1xudmFyIF93aWx0ID0gLyojX19QVVJFX18qLyB3aWx0RGVmYXVsdChUcmF2ZXJzYWJsZSwgQ29tcGFjdGFibGUpO1xuLyoqXG4gKiBAY2F0ZWdvcnkgZmlsdGVyaW5nXG4gKiBAc2luY2UgMi42LjVcbiAqL1xuZXhwb3J0IHZhciB3aXRoZXIgPSBmdW5jdGlvbiAoRikge1xuICAgIHZhciBfd2l0aGVyRiA9IF93aXRoZXIoRik7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChmKSB7IHJldHVybiBmdW5jdGlvbiAoZmEpIHsgcmV0dXJuIF93aXRoZXJGKGZhLCBmKTsgfTsgfTtcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBmaWx0ZXJpbmdcbiAqIEBzaW5jZSAyLjYuNVxuICovXG5leHBvcnQgdmFyIHdpbHQgPSBmdW5jdGlvbiAoRikge1xuICAgIHZhciBfd2lsdEYgPSBfd2lsdChGKTtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGYpIHsgcmV0dXJuIGZ1bmN0aW9uIChmYSkgeyByZXR1cm4gX3dpbHRGKGZhLCBmKTsgfTsgfTtcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjcuMFxuICovXG5leHBvcnQgdmFyIFdpdGhlcmFibGUgPSB7XG4gICAgVVJJOiBVUkksXG4gICAgbWFwOiBfbWFwLFxuICAgIHJlZHVjZTogX3JlZHVjZSxcbiAgICBmb2xkTWFwOiBfZm9sZE1hcCxcbiAgICByZWR1Y2VSaWdodDogX3JlZHVjZVJpZ2h0LFxuICAgIHRyYXZlcnNlOiBfdHJhdmVyc2UsXG4gICAgc2VxdWVuY2U6IHNlcXVlbmNlLFxuICAgIGNvbXBhY3Q6IGNvbXBhY3QsXG4gICAgc2VwYXJhdGU6IHNlcGFyYXRlLFxuICAgIGZpbHRlcjogX2ZpbHRlcixcbiAgICBmaWx0ZXJNYXA6IF9maWx0ZXJNYXAsXG4gICAgcGFydGl0aW9uOiBfcGFydGl0aW9uLFxuICAgIHBhcnRpdGlvbk1hcDogX3BhcnRpdGlvbk1hcCxcbiAgICB3aXRoZXI6IF93aXRoZXIsXG4gICAgd2lsdDogX3dpbHRcbn07XG4vKipcbiAqIEBzaW5jZSAyLjcuMFxuICovXG5leHBvcnQgdmFyIHRocm93RXJyb3IgPSBmdW5jdGlvbiAoKSB7IHJldHVybiBub25lOyB9O1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi43LjBcbiAqL1xuZXhwb3J0IHZhciBNb25hZFRocm93ID0ge1xuICAgIFVSSTogVVJJLFxuICAgIG1hcDogX21hcCxcbiAgICBhcDogX2FwLFxuICAgIG9mOiBvZixcbiAgICBjaGFpbjogZmxhdE1hcCxcbiAgICB0aHJvd0Vycm9yOiB0aHJvd0Vycm9yXG59O1xuLyoqXG4gKiBUcmFuc2Zvcm1zIGFuIGBFaXRoZXJgIHRvIGFuIGBPcHRpb25gIGRpc2NhcmRpbmcgdGhlIGVycm9yLlxuICpcbiAqIEFsaWFzIG9mIFtnZXRSaWdodF0oI2dldHJpZ2h0KVxuICpcbiAqIEBjYXRlZ29yeSBjb252ZXJzaW9uc1xuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgZnJvbUVpdGhlciA9IGdldFJpZ2h0O1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi4xMS4wXG4gKi9cbmV4cG9ydCB2YXIgRnJvbUVpdGhlciA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICBmcm9tRWl0aGVyOiBmcm9tRWl0aGVyXG59O1xuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLy8gcmVmaW5lbWVudHNcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8qKlxuICogUmV0dXJucyBgdHJ1ZWAgaWYgdGhlIG9wdGlvbiBpcyBhbiBpbnN0YW5jZSBvZiBgU29tZWAsIGBmYWxzZWAgb3RoZXJ3aXNlLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBzb21lLCBub25lLCBpc1NvbWUgfSBmcm9tICdmcC10cy9PcHRpb24nXG4gKlxuICogYXNzZXJ0LnN0cmljdEVxdWFsKGlzU29tZShzb21lKDEpKSwgdHJ1ZSlcbiAqIGFzc2VydC5zdHJpY3RFcXVhbChpc1NvbWUobm9uZSksIGZhbHNlKVxuICpcbiAqIEBjYXRlZ29yeSByZWZpbmVtZW50c1xuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgaXNTb21lID0gXy5pc1NvbWU7XG4vKipcbiAqIFJldHVybnMgYHRydWVgIGlmIHRoZSBvcHRpb24gaXMgYE5vbmVgLCBgZmFsc2VgIG90aGVyd2lzZS5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgc29tZSwgbm9uZSwgaXNOb25lIH0gZnJvbSAnZnAtdHMvT3B0aW9uJ1xuICpcbiAqIGFzc2VydC5zdHJpY3RFcXVhbChpc05vbmUoc29tZSgxKSksIGZhbHNlKVxuICogYXNzZXJ0LnN0cmljdEVxdWFsKGlzTm9uZShub25lKSwgdHJ1ZSlcbiAqXG4gKiBAY2F0ZWdvcnkgcmVmaW5lbWVudHNcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIGlzTm9uZSA9IGZ1bmN0aW9uIChmYSkgeyByZXR1cm4gZmEuX3RhZyA9PT0gJ05vbmUnOyB9O1xuLyoqXG4gKiBMZXNzIHN0cmljdCB2ZXJzaW9uIG9mIFtgbWF0Y2hgXSgjbWF0Y2gpLlxuICpcbiAqIFRoZSBgV2Agc3VmZml4IChzaG9ydCBmb3IgKipXKippZGVuaW5nKSBtZWFucyB0aGF0IHRoZSBoYW5kbGVyIHJldHVybiB0eXBlcyB3aWxsIGJlIG1lcmdlZC5cbiAqXG4gKiBAY2F0ZWdvcnkgcGF0dGVybiBtYXRjaGluZ1xuICogQHNpbmNlIDIuMTAuMFxuICovXG5leHBvcnQgdmFyIG1hdGNoVyA9IGZ1bmN0aW9uIChvbk5vbmUsIG9uU29tZSkge1xuICAgIHJldHVybiBmdW5jdGlvbiAobWEpIHtcbiAgICAgICAgcmV0dXJuIGlzTm9uZShtYSkgPyBvbk5vbmUoKSA6IG9uU29tZShtYS52YWx1ZSk7XG4gICAgfTtcbn07XG4vKipcbiAqIEFsaWFzIG9mIFtgbWF0Y2hXYF0oI21hdGNodykuXG4gKlxuICogQGNhdGVnb3J5IHBhdHRlcm4gbWF0Y2hpbmdcbiAqIEBzaW5jZSAyLjEwLjBcbiAqL1xuZXhwb3J0IHZhciBmb2xkVyA9IG1hdGNoVztcbi8qKlxuICogVGFrZXMgYSAobGF6eSkgZGVmYXVsdCB2YWx1ZSwgYSBmdW5jdGlvbiwgYW5kIGFuIGBPcHRpb25gIHZhbHVlLCBpZiB0aGUgYE9wdGlvbmAgdmFsdWUgaXMgYE5vbmVgIHRoZSBkZWZhdWx0IHZhbHVlIGlzXG4gKiByZXR1cm5lZCwgb3RoZXJ3aXNlIHRoZSBmdW5jdGlvbiBpcyBhcHBsaWVkIHRvIHRoZSB2YWx1ZSBpbnNpZGUgdGhlIGBTb21lYCBhbmQgdGhlIHJlc3VsdCBpcyByZXR1cm5lZC5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgc29tZSwgbm9uZSwgbWF0Y2ggfSBmcm9tICdmcC10cy9PcHRpb24nXG4gKiBpbXBvcnQgeyBwaXBlIH0gZnJvbSAnZnAtdHMvZnVuY3Rpb24nXG4gKlxuICogYXNzZXJ0LnN0cmljdEVxdWFsKFxuICogICBwaXBlKFxuICogICAgIHNvbWUoMSksXG4gKiAgICAgbWF0Y2goKCkgPT4gJ2Egbm9uZScsIGEgPT4gYGEgc29tZSBjb250YWluaW5nICR7YX1gKVxuICogICApLFxuICogICAnYSBzb21lIGNvbnRhaW5pbmcgMSdcbiAqIClcbiAqXG4gKiBhc3NlcnQuc3RyaWN0RXF1YWwoXG4gKiAgIHBpcGUoXG4gKiAgICAgbm9uZSxcbiAqICAgICBtYXRjaCgoKSA9PiAnYSBub25lJywgYSA9PiBgYSBzb21lIGNvbnRhaW5pbmcgJHthfWApXG4gKiAgICksXG4gKiAgICdhIG5vbmUnXG4gKiApXG4gKlxuICogQGNhdGVnb3J5IHBhdHRlcm4gbWF0Y2hpbmdcbiAqIEBzaW5jZSAyLjEwLjBcbiAqL1xuZXhwb3J0IHZhciBtYXRjaCA9IG1hdGNoVztcbi8qKlxuICogQWxpYXMgb2YgW2BtYXRjaGBdKCNtYXRjaCkuXG4gKlxuICogQGNhdGVnb3J5IHBhdHRlcm4gbWF0Y2hpbmdcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIGZvbGQgPSBtYXRjaDtcbi8qKlxuICogTGVzcyBzdHJpY3QgdmVyc2lvbiBvZiBbYGdldE9yRWxzZWBdKCNnZXRvcmVsc2UpLlxuICpcbiAqIFRoZSBgV2Agc3VmZml4IChzaG9ydCBmb3IgKipXKippZGVuaW5nKSBtZWFucyB0aGF0IHRoZSBoYW5kbGVyIHJldHVybiB0eXBlIHdpbGwgYmUgbWVyZ2VkLlxuICpcbiAqIEBjYXRlZ29yeSBlcnJvciBoYW5kbGluZ1xuICogQHNpbmNlIDIuNi4wXG4gKi9cbmV4cG9ydCB2YXIgZ2V0T3JFbHNlVyA9IGZ1bmN0aW9uIChvbk5vbmUpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKG1hKSB7XG4gICAgICAgIHJldHVybiBpc05vbmUobWEpID8gb25Ob25lKCkgOiBtYS52YWx1ZTtcbiAgICB9O1xufTtcbi8qKlxuICogRXh0cmFjdHMgdGhlIHZhbHVlIG91dCBvZiB0aGUgc3RydWN0dXJlLCBpZiBpdCBleGlzdHMuIE90aGVyd2lzZSByZXR1cm5zIHRoZSBnaXZlbiBkZWZhdWx0IHZhbHVlXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IHNvbWUsIG5vbmUsIGdldE9yRWxzZSB9IGZyb20gJ2ZwLXRzL09wdGlvbidcbiAqIGltcG9ydCB7IHBpcGUgfSBmcm9tICdmcC10cy9mdW5jdGlvbidcbiAqXG4gKiBhc3NlcnQuc3RyaWN0RXF1YWwoXG4gKiAgIHBpcGUoXG4gKiAgICAgc29tZSgxKSxcbiAqICAgICBnZXRPckVsc2UoKCkgPT4gMClcbiAqICAgKSxcbiAqICAgMVxuICogKVxuICogYXNzZXJ0LnN0cmljdEVxdWFsKFxuICogICBwaXBlKFxuICogICAgIG5vbmUsXG4gKiAgICAgZ2V0T3JFbHNlKCgpID0+IDApXG4gKiAgICksXG4gKiAgIDBcbiAqIClcbiAqXG4gKiBAY2F0ZWdvcnkgZXJyb3IgaGFuZGxpbmdcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIGdldE9yRWxzZSA9IGdldE9yRWxzZVc7XG4vKipcbiAqIEBjYXRlZ29yeSBtYXBwaW5nXG4gKiBAc2luY2UgMi4xMC4wXG4gKi9cbmV4cG9ydCB2YXIgZmxhcCA9IC8qI19fUFVSRV9fKi8gZmxhcF8oRnVuY3Rvcik7XG4vKipcbiAqIENvbWJpbmUgdHdvIGVmZmVjdGZ1bCBhY3Rpb25zLCBrZWVwaW5nIG9ubHkgdGhlIHJlc3VsdCBvZiB0aGUgZmlyc3QuXG4gKlxuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgYXBGaXJzdCA9IC8qI19fUFVSRV9fKi8gYXBGaXJzdF8oQXBwbHkpO1xuLyoqXG4gKiBDb21iaW5lIHR3byBlZmZlY3RmdWwgYWN0aW9ucywga2VlcGluZyBvbmx5IHRoZSByZXN1bHQgb2YgdGhlIHNlY29uZC5cbiAqXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciBhcFNlY29uZCA9IC8qI19fUFVSRV9fKi8gYXBTZWNvbmRfKEFwcGx5KTtcbi8qKlxuICogQGNhdGVnb3J5IHNlcXVlbmNpbmdcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIGZsYXR0ZW4gPSBjb21wYWN0O1xuLyoqXG4gKiBDb21wb3NlcyBjb21wdXRhdGlvbnMgaW4gc2VxdWVuY2UsIHVzaW5nIHRoZSByZXR1cm4gdmFsdWUgb2Ygb25lIGNvbXB1dGF0aW9uIHRvIGRldGVybWluZSB0aGUgbmV4dCBjb21wdXRhdGlvbiBhbmRcbiAqIGtlZXBpbmcgb25seSB0aGUgcmVzdWx0IG9mIHRoZSBmaXJzdC5cbiAqXG4gKiBAY2F0ZWdvcnkgY29tYmluYXRvcnNcbiAqIEBzaW5jZSAyLjE1LjBcbiAqL1xuZXhwb3J0IHZhciB0YXAgPSAvKiNfX1BVUkVfXyovIGR1YWwoMiwgY2hhaW5hYmxlLnRhcChDaGFpbikpO1xuLyoqXG4gKiBDb21wb3NlcyBjb21wdXRhdGlvbnMgaW4gc2VxdWVuY2UsIHVzaW5nIHRoZSByZXR1cm4gdmFsdWUgb2Ygb25lIGNvbXB1dGF0aW9uIHRvIGRldGVybWluZSB0aGUgbmV4dCBjb21wdXRhdGlvbiBhbmRcbiAqIGtlZXBpbmcgb25seSB0aGUgcmVzdWx0IG9mIHRoZSBmaXJzdC5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgcGlwZSB9IGZyb20gJ2ZwLXRzL2Z1bmN0aW9uJ1xuICogaW1wb3J0ICogYXMgTyBmcm9tICdmcC10cy9PcHRpb24nXG4gKiBpbXBvcnQgKiBhcyBFIGZyb20gJ2ZwLXRzL0VpdGhlcidcbiAqXG4gKiBjb25zdCBjb21wdXRlID0gKHZhbHVlOiBudW1iZXIpID0+IHBpcGUoXG4gKiAgIE8ub2YodmFsdWUpLFxuICogICBPLnRhcEVpdGhlcigodmFsdWUpID0+IHZhbHVlID4gMCA/IEUucmlnaHQoJ29rJykgOiBFLmxlZnQoJ2Vycm9yJykpLFxuICogKVxuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoY29tcHV0ZSgxKSwgTy5vZigxKSlcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoY29tcHV0ZSgtNDIpLCBPLm5vbmUpXG4gKlxuICogQGNhdGVnb3J5IGNvbWJpbmF0b3JzXG4gKiBAc2luY2UgMi4xNi4wXG4gKi9cbmV4cG9ydCB2YXIgdGFwRWl0aGVyID0gLyojX19QVVJFX18qLyBkdWFsKDIsIHRhcEVpdGhlcl8oRnJvbUVpdGhlciwgQ2hhaW4pKTtcbi8qKlxuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgZHVwbGljYXRlID0gLyojX19QVVJFX18qLyBleHRlbmQoaWRlbnRpdHkpO1xuLyoqXG4gKiBAY2F0ZWdvcnkgbGlmdGluZ1xuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIGZyb21FaXRoZXJLID0gLyojX19QVVJFX18qLyBmcm9tRWl0aGVyS18oRnJvbUVpdGhlcik7XG4vKipcbiAqIEBjYXRlZ29yeSBzZXF1ZW5jaW5nXG4gKiBAc2luY2UgMi4xMS4wXG4gKi9cbmV4cG9ydCB2YXIgY2hhaW5FaXRoZXJLID0gXG4vKiNfX1BVUkVfXyovIGNoYWluRWl0aGVyS18oRnJvbUVpdGhlciwgQ2hhaW4pO1xuLyoqXG4gKiBBbGlhcyBvZiBgdGFwRWl0aGVyYC5cbiAqXG4gKiBAY2F0ZWdvcnkgbGVnYWN5XG4gKiBAc2luY2UgMi4xMi4wXG4gKi9cbmV4cG9ydCB2YXIgY2hhaW5GaXJzdEVpdGhlcksgPSB0YXBFaXRoZXI7XG4vKipcbiAqIENvbnN0cnVjdHMgYSBuZXcgYE9wdGlvbmAgZnJvbSBhIG51bGxhYmxlIHR5cGUuIElmIHRoZSB2YWx1ZSBpcyBgbnVsbGAgb3IgYHVuZGVmaW5lZGAsIHJldHVybnMgYE5vbmVgLCBvdGhlcndpc2VcbiAqIHJldHVybnMgdGhlIHZhbHVlIHdyYXBwZWQgaW4gYSBgU29tZWAuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IG5vbmUsIHNvbWUsIGZyb21OdWxsYWJsZSB9IGZyb20gJ2ZwLXRzL09wdGlvbidcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKGZyb21OdWxsYWJsZSh1bmRlZmluZWQpLCBub25lKVxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChmcm9tTnVsbGFibGUobnVsbCksIG5vbmUpXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKGZyb21OdWxsYWJsZSgxKSwgc29tZSgxKSlcbiAqXG4gKiBAY2F0ZWdvcnkgY29udmVyc2lvbnNcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIGZyb21OdWxsYWJsZSA9IGZ1bmN0aW9uIChhKSB7IHJldHVybiAoYSA9PSBudWxsID8gbm9uZSA6IHNvbWUoYSkpOyB9O1xuLyoqXG4gKiBUcmFuc2Zvcm1zIGFuIGV4Y2VwdGlvbiBpbnRvIGFuIGBPcHRpb25gLiBJZiBgZmAgdGhyb3dzLCByZXR1cm5zIGBOb25lYCwgb3RoZXJ3aXNlIHJldHVybnMgdGhlIG91dHB1dCB3cmFwcGVkIGluIGFcbiAqIGBTb21lYC5cbiAqXG4gKiBTZWUgYWxzbyBbYHRyeUNhdGNoS2BdKCN0cnljYXRjaGspLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBub25lLCBzb21lLCB0cnlDYXRjaCB9IGZyb20gJ2ZwLXRzL09wdGlvbidcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKFxuICogICB0cnlDYXRjaCgoKSA9PiB7XG4gKiAgICAgdGhyb3cgbmV3IEVycm9yKClcbiAqICAgfSksXG4gKiAgIG5vbmVcbiAqIClcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwodHJ5Q2F0Y2goKCkgPT4gMSksIHNvbWUoMSkpXG4gKlxuICogQGNhdGVnb3J5IGludGVyb3BcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIHRyeUNhdGNoID0gZnVuY3Rpb24gKGYpIHtcbiAgICB0cnkge1xuICAgICAgICByZXR1cm4gc29tZShmKCkpO1xuICAgIH1cbiAgICBjYXRjaCAoZSkge1xuICAgICAgICByZXR1cm4gbm9uZTtcbiAgICB9XG59O1xuLyoqXG4gKiBDb252ZXJ0cyBhIGZ1bmN0aW9uIHRoYXQgbWF5IHRocm93IHRvIG9uZSByZXR1cm5pbmcgYSBgT3B0aW9uYC5cbiAqXG4gKiBAY2F0ZWdvcnkgaW50ZXJvcFxuICogQHNpbmNlIDIuMTAuMFxuICovXG5leHBvcnQgdmFyIHRyeUNhdGNoSyA9IGZ1bmN0aW9uIChmKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIGEgPSBbXTtcbiAgICAgICAgZm9yICh2YXIgX2kgPSAwOyBfaSA8IGFyZ3VtZW50cy5sZW5ndGg7IF9pKyspIHtcbiAgICAgICAgICAgIGFbX2ldID0gYXJndW1lbnRzW19pXTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdHJ5Q2F0Y2goZnVuY3Rpb24gKCkgeyByZXR1cm4gZi5hcHBseSh2b2lkIDAsIGEpOyB9KTtcbiAgICB9O1xufTtcbi8qKlxuICogUmV0dXJucyBhICpzbWFydCBjb25zdHJ1Y3RvciogZnJvbSBhIGZ1bmN0aW9uIHRoYXQgcmV0dXJucyBhIG51bGxhYmxlIHZhbHVlLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBmcm9tTnVsbGFibGVLLCBub25lLCBzb21lIH0gZnJvbSAnZnAtdHMvT3B0aW9uJ1xuICpcbiAqIGNvbnN0IGYgPSAoczogc3RyaW5nKTogbnVtYmVyIHwgdW5kZWZpbmVkID0+IHtcbiAqICAgY29uc3QgbiA9IHBhcnNlRmxvYXQocylcbiAqICAgcmV0dXJuIGlzTmFOKG4pID8gdW5kZWZpbmVkIDogblxuICogfVxuICpcbiAqIGNvbnN0IGcgPSBmcm9tTnVsbGFibGVLKGYpXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChnKCcxJyksIHNvbWUoMSkpXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKGcoJ2EnKSwgbm9uZSlcbiAqXG4gKiBAY2F0ZWdvcnkgbGlmdGluZ1xuICogQHNpbmNlIDIuOS4wXG4gKi9cbmV4cG9ydCB2YXIgZnJvbU51bGxhYmxlSyA9IGZ1bmN0aW9uIChmKSB7IHJldHVybiBmbG93KGYsIGZyb21OdWxsYWJsZSk7IH07XG4vKipcbiAqIFRoaXMgaXMgYGNoYWluYCArIGBmcm9tTnVsbGFibGVgLCB1c2VmdWwgd2hlbiB3b3JraW5nIHdpdGggb3B0aW9uYWwgdmFsdWVzLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBzb21lLCBub25lLCBmcm9tTnVsbGFibGUsIGNoYWluTnVsbGFibGVLIH0gZnJvbSAnZnAtdHMvT3B0aW9uJ1xuICogaW1wb3J0IHsgcGlwZSB9IGZyb20gJ2ZwLXRzL2Z1bmN0aW9uJ1xuICpcbiAqIGludGVyZmFjZSBFbXBsb3llZSB7XG4gKiAgIHJlYWRvbmx5IGNvbXBhbnk/OiB7XG4gKiAgICAgcmVhZG9ubHkgYWRkcmVzcz86IHtcbiAqICAgICAgIHJlYWRvbmx5IHN0cmVldD86IHtcbiAqICAgICAgICAgcmVhZG9ubHkgbmFtZT86IHN0cmluZ1xuICogICAgICAgfVxuICogICAgIH1cbiAqICAgfVxuICogfVxuICpcbiAqIGNvbnN0IGVtcGxveWVlMTogRW1wbG95ZWUgPSB7IGNvbXBhbnk6IHsgYWRkcmVzczogeyBzdHJlZXQ6IHsgbmFtZTogJ2hpZ2ggc3RyZWV0JyB9IH0gfSB9XG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChcbiAqICAgcGlwZShcbiAqICAgICBmcm9tTnVsbGFibGUoZW1wbG95ZWUxLmNvbXBhbnkpLFxuICogICAgIGNoYWluTnVsbGFibGVLKGNvbXBhbnkgPT4gY29tcGFueS5hZGRyZXNzKSxcbiAqICAgICBjaGFpbk51bGxhYmxlSyhhZGRyZXNzID0+IGFkZHJlc3Muc3RyZWV0KSxcbiAqICAgICBjaGFpbk51bGxhYmxlSyhzdHJlZXQgPT4gc3RyZWV0Lm5hbWUpXG4gKiAgICksXG4gKiAgIHNvbWUoJ2hpZ2ggc3RyZWV0JylcbiAqIClcbiAqXG4gKiBjb25zdCBlbXBsb3llZTI6IEVtcGxveWVlID0geyBjb21wYW55OiB7IGFkZHJlc3M6IHsgc3RyZWV0OiB7fSB9IH0gfVxuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoXG4gKiAgIHBpcGUoXG4gKiAgICAgZnJvbU51bGxhYmxlKGVtcGxveWVlMi5jb21wYW55KSxcbiAqICAgICBjaGFpbk51bGxhYmxlSyhjb21wYW55ID0+IGNvbXBhbnkuYWRkcmVzcyksXG4gKiAgICAgY2hhaW5OdWxsYWJsZUsoYWRkcmVzcyA9PiBhZGRyZXNzLnN0cmVldCksXG4gKiAgICAgY2hhaW5OdWxsYWJsZUsoc3RyZWV0ID0+IHN0cmVldC5uYW1lKVxuICogICApLFxuICogICBub25lXG4gKiApXG4gKlxuICogQGNhdGVnb3J5IHNlcXVlbmNpbmdcbiAqIEBzaW5jZSAyLjkuMFxuICovXG5leHBvcnQgdmFyIGNoYWluTnVsbGFibGVLID0gZnVuY3Rpb24gKGYpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKG1hKSB7XG4gICAgICAgIHJldHVybiBpc05vbmUobWEpID8gbm9uZSA6IGZyb21OdWxsYWJsZShmKG1hLnZhbHVlKSk7XG4gICAgfTtcbn07XG4vKipcbiAqIEV4dHJhY3RzIHRoZSB2YWx1ZSBvdXQgb2YgdGhlIHN0cnVjdHVyZSwgaWYgaXQgZXhpc3RzLiBPdGhlcndpc2UgcmV0dXJucyBgbnVsbGAuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IHNvbWUsIG5vbmUsIHRvTnVsbGFibGUgfSBmcm9tICdmcC10cy9PcHRpb24nXG4gKiBpbXBvcnQgeyBwaXBlIH0gZnJvbSAnZnAtdHMvZnVuY3Rpb24nXG4gKlxuICogYXNzZXJ0LnN0cmljdEVxdWFsKFxuICogICBwaXBlKFxuICogICAgIHNvbWUoMSksXG4gKiAgICAgdG9OdWxsYWJsZVxuICogICApLFxuICogICAxXG4gKiApXG4gKiBhc3NlcnQuc3RyaWN0RXF1YWwoXG4gKiAgIHBpcGUoXG4gKiAgICAgbm9uZSxcbiAqICAgICB0b051bGxhYmxlXG4gKiAgICksXG4gKiAgIG51bGxcbiAqIClcbiAqXG4gKiBAY2F0ZWdvcnkgY29udmVyc2lvbnNcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIHRvTnVsbGFibGUgPSAvKiNfX1BVUkVfXyovIG1hdGNoKGNvbnN0TnVsbCwgaWRlbnRpdHkpO1xuLyoqXG4gKiBFeHRyYWN0cyB0aGUgdmFsdWUgb3V0IG9mIHRoZSBzdHJ1Y3R1cmUsIGlmIGl0IGV4aXN0cy4gT3RoZXJ3aXNlIHJldHVybnMgYHVuZGVmaW5lZGAuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IHNvbWUsIG5vbmUsIHRvVW5kZWZpbmVkIH0gZnJvbSAnZnAtdHMvT3B0aW9uJ1xuICogaW1wb3J0IHsgcGlwZSB9IGZyb20gJ2ZwLXRzL2Z1bmN0aW9uJ1xuICpcbiAqIGFzc2VydC5zdHJpY3RFcXVhbChcbiAqICAgcGlwZShcbiAqICAgICBzb21lKDEpLFxuICogICAgIHRvVW5kZWZpbmVkXG4gKiAgICksXG4gKiAgIDFcbiAqIClcbiAqIGFzc2VydC5zdHJpY3RFcXVhbChcbiAqICAgcGlwZShcbiAqICAgICBub25lLFxuICogICAgIHRvVW5kZWZpbmVkXG4gKiAgICksXG4gKiAgIHVuZGVmaW5lZFxuICogKVxuICpcbiAqIEBjYXRlZ29yeSBjb252ZXJzaW9uc1xuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgdG9VbmRlZmluZWQgPSAvKiNfX1BVUkVfXyovIG1hdGNoKGNvbnN0VW5kZWZpbmVkLCBpZGVudGl0eSk7XG5leHBvcnQgZnVuY3Rpb24gZWxlbShFKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhLCBtYSkge1xuICAgICAgICBpZiAobWEgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgdmFyIGVsZW1FXzEgPSBlbGVtKEUpO1xuICAgICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIChtYSkgeyByZXR1cm4gZWxlbUVfMShhLCBtYSk7IH07XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGlzTm9uZShtYSkgPyBmYWxzZSA6IEUuZXF1YWxzKGEsIG1hLnZhbHVlKTtcbiAgICB9O1xufVxuLyoqXG4gKiBSZXR1cm5zIGB0cnVlYCBpZiB0aGUgcHJlZGljYXRlIGlzIHNhdGlzZmllZCBieSB0aGUgd3JhcHBlZCB2YWx1ZVxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBzb21lLCBub25lLCBleGlzdHMgfSBmcm9tICdmcC10cy9PcHRpb24nXG4gKiBpbXBvcnQgeyBwaXBlIH0gZnJvbSAnZnAtdHMvZnVuY3Rpb24nXG4gKlxuICogYXNzZXJ0LnN0cmljdEVxdWFsKFxuICogICBwaXBlKFxuICogICAgIHNvbWUoMSksXG4gKiAgICAgZXhpc3RzKG4gPT4gbiA+IDApXG4gKiAgICksXG4gKiAgIHRydWVcbiAqIClcbiAqIGFzc2VydC5zdHJpY3RFcXVhbChcbiAqICAgcGlwZShcbiAqICAgICBzb21lKDEpLFxuICogICAgIGV4aXN0cyhuID0+IG4gPiAxKVxuICogICApLFxuICogICBmYWxzZVxuICogKVxuICogYXNzZXJ0LnN0cmljdEVxdWFsKFxuICogICBwaXBlKFxuICogICAgIG5vbmUsXG4gKiAgICAgZXhpc3RzKG4gPT4gbiA+IDApXG4gKiAgICksXG4gKiAgIGZhbHNlXG4gKiApXG4gKlxuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgZXhpc3RzID0gZnVuY3Rpb24gKHByZWRpY2F0ZSkge1xuICAgIHJldHVybiBmdW5jdGlvbiAobWEpIHtcbiAgICAgICAgcmV0dXJuIGlzTm9uZShtYSkgPyBmYWxzZSA6IHByZWRpY2F0ZShtYS52YWx1ZSk7XG4gICAgfTtcbn07XG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vLyBkbyBub3RhdGlvblxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLyoqXG4gKiBAY2F0ZWdvcnkgZG8gbm90YXRpb25cbiAqIEBzaW5jZSAyLjkuMFxuICovXG5leHBvcnQgdmFyIERvID0gLyojX19QVVJFX18qLyBvZihfLmVtcHR5UmVjb3JkKTtcbi8qKlxuICogQGNhdGVnb3J5IGRvIG5vdGF0aW9uXG4gKiBAc2luY2UgMi44LjBcbiAqL1xuZXhwb3J0IHZhciBiaW5kVG8gPSAvKiNfX1BVUkVfXyovIGJpbmRUb18oRnVuY3Rvcik7XG52YXIgbGV0XyA9IC8qI19fUFVSRV9fKi8gbGV0X18oRnVuY3Rvcik7XG5leHBvcnQgeyBcbi8qKlxuICogQGNhdGVnb3J5IGRvIG5vdGF0aW9uXG4gKiBAc2luY2UgMi4xMy4wXG4gKi9cbmxldF8gYXMgbGV0IH07XG4vKipcbiAqIEBjYXRlZ29yeSBkbyBub3RhdGlvblxuICogQHNpbmNlIDIuOC4wXG4gKi9cbmV4cG9ydCB2YXIgYmluZCA9IC8qI19fUFVSRV9fKi8gY2hhaW5hYmxlLmJpbmQoQ2hhaW4pO1xuLyoqXG4gKiBAY2F0ZWdvcnkgZG8gbm90YXRpb25cbiAqIEBzaW5jZSAyLjguMFxuICovXG5leHBvcnQgdmFyIGFwUyA9IC8qI19fUFVSRV9fKi8gYXBTXyhBcHBseSk7XG4vKipcbiAqIEBzaW5jZSAyLjExLjBcbiAqL1xuZXhwb3J0IHZhciBBcFQgPSAvKiNfX1BVUkVfXyovIG9mKF8uZW1wdHlSZWFkb25seUFycmF5KTtcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8vIGFycmF5IHV0aWxzXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vKipcbiAqIEVxdWl2YWxlbnQgdG8gYFJlYWRvbmx5Tm9uRW1wdHlBcnJheSN0cmF2ZXJzZVdpdGhJbmRleChBcHBsaWNhdGl2ZSlgLlxuICpcbiAqIEBjYXRlZ29yeSB0cmF2ZXJzaW5nXG4gKiBAc2luY2UgMi4xMS4wXG4gKi9cbmV4cG9ydCB2YXIgdHJhdmVyc2VSZWFkb25seU5vbkVtcHR5QXJyYXlXaXRoSW5kZXggPSBmdW5jdGlvbiAoZikge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHtcbiAgICAgICAgdmFyIG8gPSBmKDAsIF8uaGVhZChhcykpO1xuICAgICAgICBpZiAoaXNOb25lKG8pKSB7XG4gICAgICAgICAgICByZXR1cm4gbm9uZTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgb3V0ID0gW28udmFsdWVdO1xuICAgICAgICBmb3IgKHZhciBpID0gMTsgaSA8IGFzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICB2YXIgb18xID0gZihpLCBhc1tpXSk7XG4gICAgICAgICAgICBpZiAoaXNOb25lKG9fMSkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gbm9uZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIG91dC5wdXNoKG9fMS52YWx1ZSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHNvbWUob3V0KTtcbiAgICB9O1xufTtcbi8qKlxuICogRXF1aXZhbGVudCB0byBgUmVhZG9ubHlBcnJheSN0cmF2ZXJzZVdpdGhJbmRleChBcHBsaWNhdGl2ZSlgLlxuICpcbiAqIEBjYXRlZ29yeSB0cmF2ZXJzaW5nXG4gKiBAc2luY2UgMi4xMS4wXG4gKi9cbmV4cG9ydCB2YXIgdHJhdmVyc2VSZWFkb25seUFycmF5V2l0aEluZGV4ID0gZnVuY3Rpb24gKGYpIHtcbiAgICB2YXIgZyA9IHRyYXZlcnNlUmVhZG9ubHlOb25FbXB0eUFycmF5V2l0aEluZGV4KGYpO1xuICAgIHJldHVybiBmdW5jdGlvbiAoYXMpIHsgcmV0dXJuIChfLmlzTm9uRW1wdHkoYXMpID8gZyhhcykgOiBBcFQpOyB9O1xufTtcbi8qKlxuICogRXF1aXZhbGVudCB0byBgUmVhZG9ubHlBcnJheSN0cmF2ZXJzZVdpdGhJbmRleChBcHBsaWNhdGl2ZSlgLlxuICpcbiAqIEBjYXRlZ29yeSB0cmF2ZXJzaW5nXG4gKiBAc2luY2UgMi45LjBcbiAqL1xuZXhwb3J0IHZhciB0cmF2ZXJzZUFycmF5V2l0aEluZGV4ID0gdHJhdmVyc2VSZWFkb25seUFycmF5V2l0aEluZGV4O1xuLyoqXG4gKiBFcXVpdmFsZW50IHRvIGBSZWFkb25seUFycmF5I3RyYXZlcnNlKEFwcGxpY2F0aXZlKWAuXG4gKlxuICogQGNhdGVnb3J5IHRyYXZlcnNpbmdcbiAqIEBzaW5jZSAyLjkuMFxuICovXG5leHBvcnQgdmFyIHRyYXZlcnNlQXJyYXkgPSBmdW5jdGlvbiAoZikge1xuICAgIHJldHVybiB0cmF2ZXJzZVJlYWRvbmx5QXJyYXlXaXRoSW5kZXgoZnVuY3Rpb24gKF8sIGEpIHsgcmV0dXJuIGYoYSk7IH0pO1xufTtcbi8qKlxuICogRXF1aXZhbGVudCB0byBgUmVhZG9ubHlBcnJheSNzZXF1ZW5jZShBcHBsaWNhdGl2ZSlgLlxuICpcbiAqIEBjYXRlZ29yeSB0cmF2ZXJzaW5nXG4gKiBAc2luY2UgMi45LjBcbiAqL1xuZXhwb3J0IHZhciBzZXF1ZW5jZUFycmF5ID0gXG4vKiNfX1BVUkVfXyovIHRyYXZlcnNlQXJyYXkoaWRlbnRpdHkpO1xuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLy8gbGVnYWN5XG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vKipcbiAqIEFsaWFzIG9mIGBmbGF0TWFwYC5cbiAqXG4gKiBAY2F0ZWdvcnkgbGVnYWN5XG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciBjaGFpbiA9IGZsYXRNYXA7XG4vKipcbiAqIEFsaWFzIG9mIGB0YXBgLlxuICpcbiAqIEBjYXRlZ29yeSBsZWdhY3lcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIGNoYWluRmlyc3QgPSB0YXA7XG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vLyBkZXByZWNhdGVkXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vKipcbiAqIFVzZSBgUmVmaW5lbWVudGAgbW9kdWxlIGluc3RlYWQuXG4gKlxuICogQGNhdGVnb3J5IHpvbmUgb2YgZGVhdGhcbiAqIEBzaW5jZSAyLjAuMFxuICogQGRlcHJlY2F0ZWRcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGdldFJlZmluZW1lbnQoZ2V0T3B0aW9uKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhKSB7IHJldHVybiBpc1NvbWUoZ2V0T3B0aW9uKGEpKTsgfTtcbn1cbi8qKlxuICogVXNlIFtgY2hhaW5OdWxsYWJsZUtgXSgjY2hhaW5udWxsYWJsZWspIGluc3RlYWQuXG4gKlxuICogQGNhdGVnb3J5IHpvbmUgb2YgZGVhdGhcbiAqIEBzaW5jZSAyLjAuMFxuICogQGRlcHJlY2F0ZWRcbiAqL1xuZXhwb3J0IHZhciBtYXBOdWxsYWJsZSA9IGNoYWluTnVsbGFibGVLO1xuLyoqXG4gKiBUaGlzIGluc3RhbmNlIGlzIGRlcHJlY2F0ZWQsIHVzZSBzbWFsbCwgc3BlY2lmaWMgaW5zdGFuY2VzIGluc3RlYWQuXG4gKiBGb3IgZXhhbXBsZSBpZiBhIGZ1bmN0aW9uIG5lZWRzIGEgYEZ1bmN0b3JgIGluc3RhbmNlLCBwYXNzIGBPLkZ1bmN0b3JgIGluc3RlYWQgb2YgYE8ub3B0aW9uYFxuICogKHdoZXJlIGBPYCBpcyBmcm9tIGBpbXBvcnQgTyBmcm9tICdmcC10cy9PcHRpb24nYClcbiAqXG4gKiBAY2F0ZWdvcnkgem9uZSBvZiBkZWF0aFxuICogQHNpbmNlIDIuMC4wXG4gKiBAZGVwcmVjYXRlZFxuICovXG5leHBvcnQgdmFyIG9wdGlvbiA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICBtYXA6IF9tYXAsXG4gICAgb2Y6IG9mLFxuICAgIGFwOiBfYXAsXG4gICAgY2hhaW46IGZsYXRNYXAsXG4gICAgcmVkdWNlOiBfcmVkdWNlLFxuICAgIGZvbGRNYXA6IF9mb2xkTWFwLFxuICAgIHJlZHVjZVJpZ2h0OiBfcmVkdWNlUmlnaHQsXG4gICAgdHJhdmVyc2U6IF90cmF2ZXJzZSxcbiAgICBzZXF1ZW5jZTogc2VxdWVuY2UsXG4gICAgemVybzogemVybyxcbiAgICBhbHQ6IF9hbHQsXG4gICAgZXh0ZW5kOiBfZXh0ZW5kLFxuICAgIGNvbXBhY3Q6IGNvbXBhY3QsXG4gICAgc2VwYXJhdGU6IHNlcGFyYXRlLFxuICAgIGZpbHRlcjogX2ZpbHRlcixcbiAgICBmaWx0ZXJNYXA6IF9maWx0ZXJNYXAsXG4gICAgcGFydGl0aW9uOiBfcGFydGl0aW9uLFxuICAgIHBhcnRpdGlvbk1hcDogX3BhcnRpdGlvbk1hcCxcbiAgICB3aXRoZXI6IF93aXRoZXIsXG4gICAgd2lsdDogX3dpbHQsXG4gICAgdGhyb3dFcnJvcjogdGhyb3dFcnJvclxufTtcbi8qKlxuICogVXNlIFtgZ2V0QXBwbHlTZW1pZ3JvdXBgXSguL0FwcGx5LnRzLmh0bWwjZ2V0YXBwbHlzZW1pZ3JvdXApIGluc3RlYWQuXG4gKlxuICogQGNhdGVnb3J5IHpvbmUgb2YgZGVhdGhcbiAqIEBzaW5jZSAyLjAuMFxuICogQGRlcHJlY2F0ZWRcbiAqL1xuZXhwb3J0IHZhciBnZXRBcHBseVNlbWlncm91cCA9IC8qI19fUFVSRV9fKi8gZ2V0QXBwbHlTZW1pZ3JvdXBfKEFwcGx5KTtcbi8qKlxuICogVXNlIFtgZ2V0QXBwbGljYXRpdmVNb25vaWRgXSguL0FwcGxpY2F0aXZlLnRzLmh0bWwjZ2V0YXBwbGljYXRpdmVtb25vaWQpIGluc3RlYWQuXG4gKlxuICogQGNhdGVnb3J5IHpvbmUgb2YgZGVhdGhcbiAqIEBzaW5jZSAyLjAuMFxuICogQGRlcHJlY2F0ZWRcbiAqL1xuZXhwb3J0IHZhciBnZXRBcHBseU1vbm9pZCA9IC8qI19fUFVSRV9fKi8gZ2V0QXBwbGljYXRpdmVNb25vaWQoQXBwbGljYXRpdmUpO1xuLyoqXG4gKiBVc2VcbiAqXG4gKiBgYGB0c1xuICogaW1wb3J0IHsgZmlyc3QgfSBmcm9tICdmcC10cy9TZW1pZ3JvdXAnXG4gKiBpbXBvcnQgeyBnZXRNb25vaWQgfSBmcm9tICdmcC10cy9PcHRpb24nXG4gKlxuICogZ2V0TW9ub2lkKGZpcnN0KCkpXG4gKiBgYGBcbiAqXG4gKiBpbnN0ZWFkLlxuICpcbiAqIE1vbm9pZCByZXR1cm5pbmcgdGhlIGxlZnQtbW9zdCBub24tYE5vbmVgIHZhbHVlXG4gKlxuICogfCB4ICAgICAgIHwgeSAgICAgICB8IGNvbmNhdCh4LCB5KSB8XG4gKiB8IC0tLS0tLS0gfCAtLS0tLS0tIHwgLS0tLS0tLS0tLS0tIHxcbiAqIHwgbm9uZSAgICB8IG5vbmUgICAgfCBub25lICAgICAgICAgfFxuICogfCBzb21lKGEpIHwgbm9uZSAgICB8IHNvbWUoYSkgICAgICB8XG4gKiB8IG5vbmUgICAgfCBzb21lKGIpIHwgc29tZShiKSAgICAgIHxcbiAqIHwgc29tZShhKSB8IHNvbWUoYikgfCBzb21lKGEpICAgICAgfFxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBnZXRGaXJzdE1vbm9pZCwgc29tZSwgbm9uZSB9IGZyb20gJ2ZwLXRzL09wdGlvbidcbiAqXG4gKiBjb25zdCBNID0gZ2V0Rmlyc3RNb25vaWQ8bnVtYmVyPigpXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKE0uY29uY2F0KG5vbmUsIG5vbmUpLCBub25lKVxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChNLmNvbmNhdChzb21lKDEpLCBub25lKSwgc29tZSgxKSlcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoTS5jb25jYXQobm9uZSwgc29tZSgyKSksIHNvbWUoMikpXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKE0uY29uY2F0KHNvbWUoMSksIHNvbWUoMikpLCBzb21lKDEpKVxuICpcbiAqIEBjYXRlZ29yeSB6b25lIG9mIGRlYXRoXG4gKiBAc2luY2UgMi4wLjBcbiAqIEBkZXByZWNhdGVkXG4gKi9cbmV4cG9ydCB2YXIgZ2V0Rmlyc3RNb25vaWQgPSBmdW5jdGlvbiAoKSB7IHJldHVybiBnZXRNb25vaWQoZmlyc3QoKSk7IH07XG4vKipcbiAqIFVzZVxuICpcbiAqIGBgYHRzXG4gKiBpbXBvcnQgeyBsYXN0IH0gZnJvbSAnZnAtdHMvU2VtaWdyb3VwJ1xuICogaW1wb3J0IHsgZ2V0TW9ub2lkIH0gZnJvbSAnZnAtdHMvT3B0aW9uJ1xuICpcbiAqIGdldE1vbm9pZChsYXN0KCkpXG4gKiBgYGBcbiAqXG4gKiBpbnN0ZWFkLlxuICpcbiAqIE1vbm9pZCByZXR1cm5pbmcgdGhlIHJpZ2h0LW1vc3Qgbm9uLWBOb25lYCB2YWx1ZVxuICpcbiAqIHwgeCAgICAgICB8IHkgICAgICAgfCBjb25jYXQoeCwgeSkgfFxuICogfCAtLS0tLS0tIHwgLS0tLS0tLSB8IC0tLS0tLS0tLS0tLSB8XG4gKiB8IG5vbmUgICAgfCBub25lICAgIHwgbm9uZSAgICAgICAgIHxcbiAqIHwgc29tZShhKSB8IG5vbmUgICAgfCBzb21lKGEpICAgICAgfFxuICogfCBub25lICAgIHwgc29tZShiKSB8IHNvbWUoYikgICAgICB8XG4gKiB8IHNvbWUoYSkgfCBzb21lKGIpIHwgc29tZShiKSAgICAgIHxcbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgZ2V0TGFzdE1vbm9pZCwgc29tZSwgbm9uZSB9IGZyb20gJ2ZwLXRzL09wdGlvbidcbiAqXG4gKiBjb25zdCBNID0gZ2V0TGFzdE1vbm9pZDxudW1iZXI+KClcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoTS5jb25jYXQobm9uZSwgbm9uZSksIG5vbmUpXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKE0uY29uY2F0KHNvbWUoMSksIG5vbmUpLCBzb21lKDEpKVxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChNLmNvbmNhdChub25lLCBzb21lKDIpKSwgc29tZSgyKSlcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoTS5jb25jYXQoc29tZSgxKSwgc29tZSgyKSksIHNvbWUoMikpXG4gKlxuICogQGNhdGVnb3J5IHpvbmUgb2YgZGVhdGhcbiAqIEBzaW5jZSAyLjAuMFxuICogQGRlcHJlY2F0ZWRcbiAqL1xuZXhwb3J0IHZhciBnZXRMYXN0TW9ub2lkID0gZnVuY3Rpb24gKCkgeyByZXR1cm4gZ2V0TW9ub2lkKGxhc3QoKSk7IH07XG4iLAogICJpbXBvcnQgeyBnZXRBcHBsaWNhdGl2ZU1vbm9pZCB9IGZyb20gJy4vQXBwbGljYXRpdmUnO1xuaW1wb3J0IHsgYXBGaXJzdCBhcyBhcEZpcnN0XywgYXBTIGFzIGFwU18sIGFwU2Vjb25kIGFzIGFwU2Vjb25kXywgZ2V0QXBwbHlTZW1pZ3JvdXAgYXMgZ2V0QXBwbHlTZW1pZ3JvdXBfIH0gZnJvbSAnLi9BcHBseSc7XG5pbXBvcnQgKiBhcyBjaGFpbmFibGUgZnJvbSAnLi9DaGFpbic7XG5pbXBvcnQgeyBjaGFpbkVpdGhlcksgYXMgY2hhaW5FaXRoZXJLXywgZnJvbUVpdGhlcksgYXMgZnJvbUVpdGhlcktfLCB0YXBFaXRoZXIgYXMgdGFwRWl0aGVyXyB9IGZyb20gJy4vRnJvbUVpdGhlcic7XG5pbXBvcnQgeyBjb25zdE51bGwsIGNvbnN0VW5kZWZpbmVkLCBkdWFsLCBmbG93LCBpZGVudGl0eSwgcGlwZSB9IGZyb20gJy4vZnVuY3Rpb24nO1xuaW1wb3J0IHsgYXMgYXMgYXNfLCBhc1VuaXQgYXMgYXNVbml0XywgYmluZFRvIGFzIGJpbmRUb18sIGZsYXAgYXMgZmxhcF8sIGxldCBhcyBsZXRfXyB9IGZyb20gJy4vRnVuY3Rvcic7XG5pbXBvcnQgKiBhcyBfIGZyb20gJy4vaW50ZXJuYWwnO1xuaW1wb3J0IHsgbm90IH0gZnJvbSAnLi9QcmVkaWNhdGUnO1xuaW1wb3J0IHsgZmlyc3QsIGxhc3QgfSBmcm9tICcuL1NlbWlncm91cCc7XG5pbXBvcnQgeyBzZXBhcmF0ZWQgfSBmcm9tICcuL1NlcGFyYXRlZCc7XG5pbXBvcnQgeyB3aWx0RGVmYXVsdCwgd2l0aGVyRGVmYXVsdCB9IGZyb20gJy4vV2l0aGVyYWJsZSc7XG5pbXBvcnQgeyBndWFyZCBhcyBndWFyZF8gfSBmcm9tICcuL1plcm8nO1xuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLy8gY29uc3RydWN0b3JzXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vKipcbiAqIGBOb25lYCBkb2Vzbid0IGhhdmUgYSBjb25zdHJ1Y3RvciwgaW5zdGVhZCB5b3UgY2FuIHVzZSBpdCBkaXJlY3RseSBhcyBhIHZhbHVlLiBSZXByZXNlbnRzIGEgbWlzc2luZyB2YWx1ZS5cbiAqXG4gKiBAY2F0ZWdvcnkgY29uc3RydWN0b3JzXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciBub25lID0gXy5ub25lO1xuLyoqXG4gKiBDb25zdHJ1Y3RzIGEgYFNvbWVgLiBSZXByZXNlbnRzIGFuIG9wdGlvbmFsIHZhbHVlIHRoYXQgZXhpc3RzLlxuICpcbiAqIEBjYXRlZ29yeSBjb25zdHJ1Y3RvcnNcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIHNvbWUgPSBfLnNvbWU7XG5leHBvcnQgZnVuY3Rpb24gZnJvbVByZWRpY2F0ZShwcmVkaWNhdGUpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGEpIHsgcmV0dXJuIChwcmVkaWNhdGUoYSkgPyBzb21lKGEpIDogbm9uZSk7IH07XG59XG4vKipcbiAqIFJldHVybnMgdGhlIGBMZWZ0YCB2YWx1ZSBvZiBhbiBgRWl0aGVyYCBpZiBwb3NzaWJsZS5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgZ2V0TGVmdCwgbm9uZSwgc29tZSB9IGZyb20gJ2ZwLXRzL09wdGlvbidcbiAqIGltcG9ydCB7IHJpZ2h0LCBsZWZ0IH0gZnJvbSAnZnAtdHMvRWl0aGVyJ1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoZ2V0TGVmdChyaWdodCgxKSksIG5vbmUpXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKGdldExlZnQobGVmdCgnYScpKSwgc29tZSgnYScpKVxuICpcbiAqIEBjYXRlZ29yeSBjb25zdHJ1Y3RvcnNcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIGdldExlZnQgPSBmdW5jdGlvbiAobWEpIHsgcmV0dXJuIChtYS5fdGFnID09PSAnUmlnaHQnID8gbm9uZSA6IHNvbWUobWEubGVmdCkpOyB9O1xuLyoqXG4gKiBSZXR1cm5zIHRoZSBgUmlnaHRgIHZhbHVlIG9mIGFuIGBFaXRoZXJgIGlmIHBvc3NpYmxlLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBnZXRSaWdodCwgbm9uZSwgc29tZSB9IGZyb20gJ2ZwLXRzL09wdGlvbidcbiAqIGltcG9ydCB7IHJpZ2h0LCBsZWZ0IH0gZnJvbSAnZnAtdHMvRWl0aGVyJ1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoZ2V0UmlnaHQocmlnaHQoMSkpLCBzb21lKDEpKVxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChnZXRSaWdodChsZWZ0KCdhJykpLCBub25lKVxuICpcbiAqIEBjYXRlZ29yeSBjb25zdHJ1Y3RvcnNcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIGdldFJpZ2h0ID0gZnVuY3Rpb24gKG1hKSB7IHJldHVybiAobWEuX3RhZyA9PT0gJ0xlZnQnID8gbm9uZSA6IHNvbWUobWEucmlnaHQpKTsgfTtcbnZhciBfbWFwID0gZnVuY3Rpb24gKGZhLCBmKSB7IHJldHVybiBwaXBlKGZhLCBtYXAoZikpOyB9O1xudmFyIF9hcCA9IGZ1bmN0aW9uIChmYWIsIGZhKSB7IHJldHVybiBwaXBlKGZhYiwgYXAoZmEpKTsgfTtcbnZhciBfcmVkdWNlID0gZnVuY3Rpb24gKGZhLCBiLCBmKSB7IHJldHVybiBwaXBlKGZhLCByZWR1Y2UoYiwgZikpOyB9O1xudmFyIF9mb2xkTWFwID0gZnVuY3Rpb24gKE0pIHtcbiAgICB2YXIgZm9sZE1hcE0gPSBmb2xkTWFwKE0pO1xuICAgIHJldHVybiBmdW5jdGlvbiAoZmEsIGYpIHsgcmV0dXJuIHBpcGUoZmEsIGZvbGRNYXBNKGYpKTsgfTtcbn07XG52YXIgX3JlZHVjZVJpZ2h0ID0gZnVuY3Rpb24gKGZhLCBiLCBmKSB7IHJldHVybiBwaXBlKGZhLCByZWR1Y2VSaWdodChiLCBmKSk7IH07XG52YXIgX3RyYXZlcnNlID0gZnVuY3Rpb24gKEYpIHtcbiAgICB2YXIgdHJhdmVyc2VGID0gdHJhdmVyc2UoRik7XG4gICAgcmV0dXJuIGZ1bmN0aW9uICh0YSwgZikgeyByZXR1cm4gcGlwZSh0YSwgdHJhdmVyc2VGKGYpKTsgfTtcbn07XG4vKiBpc3RhbmJ1bCBpZ25vcmUgbmV4dCAqL1xudmFyIF9hbHQgPSBmdW5jdGlvbiAoZmEsIHRoYXQpIHsgcmV0dXJuIHBpcGUoZmEsIGFsdCh0aGF0KSk7IH07XG52YXIgX2ZpbHRlciA9IGZ1bmN0aW9uIChmYSwgcHJlZGljYXRlKSB7IHJldHVybiBwaXBlKGZhLCBmaWx0ZXIocHJlZGljYXRlKSk7IH07XG4vKiBpc3RhbmJ1bCBpZ25vcmUgbmV4dCAqL1xudmFyIF9maWx0ZXJNYXAgPSBmdW5jdGlvbiAoZmEsIGYpIHsgcmV0dXJuIHBpcGUoZmEsIGZpbHRlck1hcChmKSk7IH07XG4vKiBpc3RhbmJ1bCBpZ25vcmUgbmV4dCAqL1xudmFyIF9leHRlbmQgPSBmdW5jdGlvbiAod2EsIGYpIHsgcmV0dXJuIHBpcGUod2EsIGV4dGVuZChmKSk7IH07XG4vKiBpc3RhbmJ1bCBpZ25vcmUgbmV4dCAqL1xudmFyIF9wYXJ0aXRpb24gPSBmdW5jdGlvbiAoZmEsIHByZWRpY2F0ZSkge1xuICAgIHJldHVybiBwaXBlKGZhLCBwYXJ0aXRpb24ocHJlZGljYXRlKSk7XG59O1xuLyogaXN0YW5idWwgaWdub3JlIG5leHQgKi9cbnZhciBfcGFydGl0aW9uTWFwID0gZnVuY3Rpb24gKGZhLCBmKSB7IHJldHVybiBwaXBlKGZhLCBwYXJ0aXRpb25NYXAoZikpOyB9O1xuLyoqXG4gKiBAY2F0ZWdvcnkgdHlwZSBsYW1iZGFzXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciBVUkkgPSAnT3B0aW9uJztcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgZ2V0U2hvdyA9IGZ1bmN0aW9uIChTKSB7IHJldHVybiAoe1xuICAgIHNob3c6IGZ1bmN0aW9uIChtYSkgeyByZXR1cm4gKGlzTm9uZShtYSkgPyAnbm9uZScgOiBcInNvbWUoXCIuY29uY2F0KFMuc2hvdyhtYS52YWx1ZSksIFwiKVwiKSk7IH1cbn0pOyB9O1xuLyoqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgbm9uZSwgc29tZSwgZ2V0RXEgfSBmcm9tICdmcC10cy9PcHRpb24nXG4gKiBpbXBvcnQgKiBhcyBOIGZyb20gJ2ZwLXRzL251bWJlcidcbiAqXG4gKiBjb25zdCBFID0gZ2V0RXEoTi5FcSlcbiAqIGFzc2VydC5zdHJpY3RFcXVhbChFLmVxdWFscyhub25lLCBub25lKSwgdHJ1ZSlcbiAqIGFzc2VydC5zdHJpY3RFcXVhbChFLmVxdWFscyhub25lLCBzb21lKDEpKSwgZmFsc2UpXG4gKiBhc3NlcnQuc3RyaWN0RXF1YWwoRS5lcXVhbHMoc29tZSgxKSwgbm9uZSksIGZhbHNlKVxuICogYXNzZXJ0LnN0cmljdEVxdWFsKEUuZXF1YWxzKHNvbWUoMSksIHNvbWUoMikpLCBmYWxzZSlcbiAqIGFzc2VydC5zdHJpY3RFcXVhbChFLmVxdWFscyhzb21lKDEpLCBzb21lKDEpKSwgdHJ1ZSlcbiAqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciBnZXRFcSA9IGZ1bmN0aW9uIChFKSB7IHJldHVybiAoe1xuICAgIGVxdWFsczogZnVuY3Rpb24gKHgsIHkpIHsgcmV0dXJuIHggPT09IHkgfHwgKGlzTm9uZSh4KSA/IGlzTm9uZSh5KSA6IGlzTm9uZSh5KSA/IGZhbHNlIDogRS5lcXVhbHMoeC52YWx1ZSwgeS52YWx1ZSkpOyB9XG59KTsgfTtcbi8qKlxuICogVGhlIGBPcmRgIGluc3RhbmNlIGFsbG93cyBgT3B0aW9uYCB2YWx1ZXMgdG8gYmUgY29tcGFyZWQgd2l0aFxuICogYGNvbXBhcmVgLCB3aGVuZXZlciB0aGVyZSBpcyBhbiBgT3JkYCBpbnN0YW5jZSBmb3JcbiAqIHRoZSB0eXBlIHRoZSBgT3B0aW9uYCBjb250YWlucy5cbiAqXG4gKiBgTm9uZWAgaXMgY29uc2lkZXJlZCB0byBiZSBsZXNzIHRoYW4gYW55IGBTb21lYCB2YWx1ZS5cbiAqXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IG5vbmUsIHNvbWUsIGdldE9yZCB9IGZyb20gJ2ZwLXRzL09wdGlvbidcbiAqIGltcG9ydCAqIGFzIE4gZnJvbSAnZnAtdHMvbnVtYmVyJ1xuICpcbiAqIGNvbnN0IE8gPSBnZXRPcmQoTi5PcmQpXG4gKiBhc3NlcnQuc3RyaWN0RXF1YWwoTy5jb21wYXJlKG5vbmUsIG5vbmUpLCAwKVxuICogYXNzZXJ0LnN0cmljdEVxdWFsKE8uY29tcGFyZShub25lLCBzb21lKDEpKSwgLTEpXG4gKiBhc3NlcnQuc3RyaWN0RXF1YWwoTy5jb21wYXJlKHNvbWUoMSksIG5vbmUpLCAxKVxuICogYXNzZXJ0LnN0cmljdEVxdWFsKE8uY29tcGFyZShzb21lKDEpLCBzb21lKDIpKSwgLTEpXG4gKiBhc3NlcnQuc3RyaWN0RXF1YWwoTy5jb21wYXJlKHNvbWUoMSksIHNvbWUoMSkpLCAwKVxuICpcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIGdldE9yZCA9IGZ1bmN0aW9uIChPKSB7IHJldHVybiAoe1xuICAgIGVxdWFsczogZ2V0RXEoTykuZXF1YWxzLFxuICAgIGNvbXBhcmU6IGZ1bmN0aW9uICh4LCB5KSB7IHJldHVybiAoeCA9PT0geSA/IDAgOiBpc1NvbWUoeCkgPyAoaXNTb21lKHkpID8gTy5jb21wYXJlKHgudmFsdWUsIHkudmFsdWUpIDogMSkgOiAtMSk7IH1cbn0pOyB9O1xuLyoqXG4gKiBNb25vaWQgcmV0dXJuaW5nIHRoZSBsZWZ0LW1vc3Qgbm9uLWBOb25lYCB2YWx1ZS4gSWYgYm90aCBvcGVyYW5kcyBhcmUgYFNvbWVgcyB0aGVuIHRoZSBpbm5lciB2YWx1ZXMgYXJlXG4gKiBjb25jYXRlbmF0ZWQgdXNpbmcgdGhlIHByb3ZpZGVkIGBTZW1pZ3JvdXBgXG4gKlxuICogfCB4ICAgICAgIHwgeSAgICAgICB8IGNvbmNhdCh4LCB5KSAgICAgICB8XG4gKiB8IC0tLS0tLS0gfCAtLS0tLS0tIHwgLS0tLS0tLS0tLS0tLS0tLS0tIHxcbiAqIHwgbm9uZSAgICB8IG5vbmUgICAgfCBub25lICAgICAgICAgICAgICAgfFxuICogfCBzb21lKGEpIHwgbm9uZSAgICB8IHNvbWUoYSkgICAgICAgICAgICB8XG4gKiB8IG5vbmUgICAgfCBzb21lKGIpIHwgc29tZShiKSAgICAgICAgICAgIHxcbiAqIHwgc29tZShhKSB8IHNvbWUoYikgfCBzb21lKGNvbmNhdChhLCBiKSkgfFxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBnZXRNb25vaWQsIHNvbWUsIG5vbmUgfSBmcm9tICdmcC10cy9PcHRpb24nXG4gKiBpbXBvcnQgeyBTZW1pZ3JvdXBTdW0gfSBmcm9tICdmcC10cy9udW1iZXInXG4gKlxuICogY29uc3QgTSA9IGdldE1vbm9pZChTZW1pZ3JvdXBTdW0pXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKE0uY29uY2F0KG5vbmUsIG5vbmUpLCBub25lKVxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChNLmNvbmNhdChzb21lKDEpLCBub25lKSwgc29tZSgxKSlcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoTS5jb25jYXQobm9uZSwgc29tZSgxKSksIHNvbWUoMSkpXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKE0uY29uY2F0KHNvbWUoMSksIHNvbWUoMikpLCBzb21lKDMpKVxuICpcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIGdldE1vbm9pZCA9IGZ1bmN0aW9uIChTKSB7IHJldHVybiAoe1xuICAgIGNvbmNhdDogZnVuY3Rpb24gKHgsIHkpIHsgcmV0dXJuIChpc05vbmUoeCkgPyB5IDogaXNOb25lKHkpID8geCA6IHNvbWUoUy5jb25jYXQoeC52YWx1ZSwgeS52YWx1ZSkpKTsgfSxcbiAgICBlbXB0eTogbm9uZVxufSk7IH07XG4vKipcbiAqIEBjYXRlZ29yeSBtYXBwaW5nXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciBtYXAgPSBmdW5jdGlvbiAoZikgeyByZXR1cm4gZnVuY3Rpb24gKGZhKSB7XG4gICAgcmV0dXJuIGlzTm9uZShmYSkgPyBub25lIDogc29tZShmKGZhLnZhbHVlKSk7XG59OyB9O1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi43LjBcbiAqL1xuZXhwb3J0IHZhciBGdW5jdG9yID0ge1xuICAgIFVSSTogVVJJLFxuICAgIG1hcDogX21hcFxufTtcbi8qKlxuICogTWFwcyB0aGUgYFNvbWVgIHZhbHVlIG9mIHRoaXMgYE9wdGlvbmAgdG8gdGhlIHNwZWNpZmllZCBjb25zdGFudCB2YWx1ZS5cbiAqXG4gKiBAY2F0ZWdvcnkgbWFwcGluZ1xuICogQHNpbmNlIDIuMTYuMFxuICovXG5leHBvcnQgdmFyIGFzID0gZHVhbCgyLCBhc18oRnVuY3RvcikpO1xuLyoqXG4gKiBNYXBzIHRoZSBgU29tZWAgdmFsdWUgb2YgdGhpcyBgT3B0aW9uYCB0byB0aGUgdm9pZCBjb25zdGFudCB2YWx1ZS5cbiAqXG4gKiBAY2F0ZWdvcnkgbWFwcGluZ1xuICogQHNpbmNlIDIuMTYuMFxuICovXG5leHBvcnQgdmFyIGFzVW5pdCA9IGFzVW5pdF8oRnVuY3Rvcik7XG4vKipcbiAqIEBjYXRlZ29yeSBjb25zdHJ1Y3RvcnNcbiAqIEBzaW5jZSAyLjcuMFxuICovXG5leHBvcnQgdmFyIG9mID0gc29tZTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuMTAuMFxuICovXG5leHBvcnQgdmFyIFBvaW50ZWQgPSB7XG4gICAgVVJJOiBVUkksXG4gICAgb2Y6IG9mXG59O1xuLyoqXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciBhcCA9IGZ1bmN0aW9uIChmYSkgeyByZXR1cm4gZnVuY3Rpb24gKGZhYikge1xuICAgIHJldHVybiBpc05vbmUoZmFiKSA/IG5vbmUgOiBpc05vbmUoZmEpID8gbm9uZSA6IHNvbWUoZmFiLnZhbHVlKGZhLnZhbHVlKSk7XG59OyB9O1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi4xMC4wXG4gKi9cbmV4cG9ydCB2YXIgQXBwbHkgPSB7XG4gICAgVVJJOiBVUkksXG4gICAgbWFwOiBfbWFwLFxuICAgIGFwOiBfYXBcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjcuMFxuICovXG5leHBvcnQgdmFyIEFwcGxpY2F0aXZlID0ge1xuICAgIFVSSTogVVJJLFxuICAgIG1hcDogX21hcCxcbiAgICBhcDogX2FwLFxuICAgIG9mOiBvZlxufTtcbi8qKlxuICogQGNhdGVnb3J5IHNlcXVlbmNpbmdcbiAqIEBzaW5jZSAyLjE0LjBcbiAqL1xuZXhwb3J0IHZhciBmbGF0TWFwID0gLyojX19QVVJFX18qLyBkdWFsKDIsIGZ1bmN0aW9uIChtYSwgZikgeyByZXR1cm4gKGlzTm9uZShtYSkgPyBub25lIDogZihtYS52YWx1ZSkpOyB9KTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuMTAuMFxuICovXG5leHBvcnQgdmFyIENoYWluID0ge1xuICAgIFVSSTogVVJJLFxuICAgIG1hcDogX21hcCxcbiAgICBhcDogX2FwLFxuICAgIGNoYWluOiBmbGF0TWFwXG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi43LjBcbiAqL1xuZXhwb3J0IHZhciBNb25hZCA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICBtYXA6IF9tYXAsXG4gICAgYXA6IF9hcCxcbiAgICBvZjogb2YsXG4gICAgY2hhaW46IGZsYXRNYXBcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBmb2xkaW5nXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciByZWR1Y2UgPSBmdW5jdGlvbiAoYiwgZikgeyByZXR1cm4gZnVuY3Rpb24gKGZhKSB7XG4gICAgcmV0dXJuIGlzTm9uZShmYSkgPyBiIDogZihiLCBmYS52YWx1ZSk7XG59OyB9O1xuLyoqXG4gKiBAY2F0ZWdvcnkgZm9sZGluZ1xuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgZm9sZE1hcCA9IGZ1bmN0aW9uIChNKSB7IHJldHVybiBmdW5jdGlvbiAoZikgeyByZXR1cm4gZnVuY3Rpb24gKGZhKSB7XG4gICAgcmV0dXJuIGlzTm9uZShmYSkgPyBNLmVtcHR5IDogZihmYS52YWx1ZSk7XG59OyB9OyB9O1xuLyoqXG4gKiBAY2F0ZWdvcnkgZm9sZGluZ1xuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgcmVkdWNlUmlnaHQgPSBmdW5jdGlvbiAoYiwgZikgeyByZXR1cm4gZnVuY3Rpb24gKGZhKSB7XG4gICAgcmV0dXJuIGlzTm9uZShmYSkgPyBiIDogZihmYS52YWx1ZSwgYik7XG59OyB9O1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi43LjBcbiAqL1xuZXhwb3J0IHZhciBGb2xkYWJsZSA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICByZWR1Y2U6IF9yZWR1Y2UsXG4gICAgZm9sZE1hcDogX2ZvbGRNYXAsXG4gICAgcmVkdWNlUmlnaHQ6IF9yZWR1Y2VSaWdodFxufTtcbi8qKlxuICogUmV0dXJucyB0aGUgcHJvdmlkZWQgYE9wdGlvbmAgYHRoYXRgIGlmIGBzZWxmYCBpcyBgTm9uZWAsIG90aGVyd2lzZSByZXR1cm5zIGBzZWxmYC5cbiAqXG4gKiBAcGFyYW0gc2VsZiAtIFRoZSBmaXJzdCBgT3B0aW9uYCB0byBiZSBjaGVja2VkLlxuICogQHBhcmFtIHRoYXQgLSBUaGUgYE9wdGlvbmAgdG8gcmV0dXJuIGlmIGBzZWxmYCBpcyBgTm9uZWAuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCAqIGFzIE8gZnJvbSBcImZwLXRzL09wdGlvblwiXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChPLm9yRWxzZShPLm5vbmUsICgpID0+IE8ubm9uZSksIE8ubm9uZSlcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoTy5vckVsc2UoTy5zb21lKDEpLCAoKSA9PiBPLm5vbmUpLCBPLnNvbWUoMSkpXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKE8ub3JFbHNlKE8ubm9uZSwgKCkgPT4gTy5zb21lKCdiJykpLCBPLnNvbWUoJ2InKSlcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoTy5vckVsc2UoTy5zb21lKDEpLCAoKSA9PiBPLnNvbWUoJ2InKSksIE8uc29tZSgxKSlcbiAqXG4gKiBAY2F0ZWdvcnkgZXJyb3IgaGFuZGxpbmdcbiAqIEBzaW5jZSAyLjE2LjBcbiAqL1xuZXhwb3J0IHZhciBvckVsc2UgPSBkdWFsKDIsIGZ1bmN0aW9uIChzZWxmLCB0aGF0KSB7IHJldHVybiAoaXNOb25lKHNlbGYpID8gdGhhdCgpIDogc2VsZik7IH0pO1xuLyoqXG4gKiBBbGlhcyBvZiBgb3JFbHNlYC5cbiAqXG4gKiBMZXNzIHN0cmljdCB2ZXJzaW9uIG9mIFtgYWx0YF0oI2FsdCkuXG4gKlxuICogVGhlIGBXYCBzdWZmaXggKHNob3J0IGZvciAqKlcqKmlkZW5pbmcpIG1lYW5zIHRoYXQgdGhlIHJldHVybiB0eXBlcyB3aWxsIGJlIG1lcmdlZC5cbiAqXG4gKiBAY2F0ZWdvcnkgbGVnYWN5XG4gKiBAc2luY2UgMi45LjBcbiAqL1xuZXhwb3J0IHZhciBhbHRXID0gb3JFbHNlO1xuLyoqXG4gKiBBbGlhcyBvZiBgb3JFbHNlYC5cbiAqXG4gKiBAY2F0ZWdvcnkgbGVnYWN5XG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciBhbHQgPSBvckVsc2U7XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjcuMFxuICovXG5leHBvcnQgdmFyIEFsdCA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICBtYXA6IF9tYXAsXG4gICAgYWx0OiBfYWx0XG59O1xuLyoqXG4gKiBAc2luY2UgMi43LjBcbiAqL1xuZXhwb3J0IHZhciB6ZXJvID0gZnVuY3Rpb24gKCkgeyByZXR1cm4gbm9uZTsgfTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIFplcm8gPSB7XG4gICAgVVJJOiBVUkksXG4gICAgemVybzogemVyb1xufTtcbi8qKlxuICogQGNhdGVnb3J5IGRvIG5vdGF0aW9uXG4gKiBAc2luY2UgMi4xMS4wXG4gKi9cbmV4cG9ydCB2YXIgZ3VhcmQgPSAvKiNfX1BVUkVfXyovIGd1YXJkXyhaZXJvLCBQb2ludGVkKTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuNy4wXG4gKi9cbmV4cG9ydCB2YXIgQWx0ZXJuYXRpdmUgPSB7XG4gICAgVVJJOiBVUkksXG4gICAgbWFwOiBfbWFwLFxuICAgIGFwOiBfYXAsXG4gICAgb2Y6IG9mLFxuICAgIGFsdDogX2FsdCxcbiAgICB6ZXJvOiB6ZXJvXG59O1xuLyoqXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciBleHRlbmQgPSBmdW5jdGlvbiAoZikgeyByZXR1cm4gZnVuY3Rpb24gKHdhKSB7XG4gICAgcmV0dXJuIGlzTm9uZSh3YSkgPyBub25lIDogc29tZShmKHdhKSk7XG59OyB9O1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi43LjBcbiAqL1xuZXhwb3J0IHZhciBFeHRlbmQgPSB7XG4gICAgVVJJOiBVUkksXG4gICAgbWFwOiBfbWFwLFxuICAgIGV4dGVuZDogX2V4dGVuZFxufTtcbi8qKlxuICogQGNhdGVnb3J5IGZpbHRlcmluZ1xuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgY29tcGFjdCA9IC8qI19fUFVSRV9fKi8gZmxhdE1hcChpZGVudGl0eSk7XG52YXIgZGVmYXVsdFNlcGFyYXRlZCA9IC8qI19fUFVSRV9fKi8gc2VwYXJhdGVkKG5vbmUsIG5vbmUpO1xuLyoqXG4gKiBAY2F0ZWdvcnkgZmlsdGVyaW5nXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciBzZXBhcmF0ZSA9IGZ1bmN0aW9uIChtYSkge1xuICAgIHJldHVybiBpc05vbmUobWEpID8gZGVmYXVsdFNlcGFyYXRlZCA6IHNlcGFyYXRlZChnZXRMZWZ0KG1hLnZhbHVlKSwgZ2V0UmlnaHQobWEudmFsdWUpKTtcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBpbnN0YW5jZXNcbiAqIEBzaW5jZSAyLjcuMFxuICovXG5leHBvcnQgdmFyIENvbXBhY3RhYmxlID0ge1xuICAgIFVSSTogVVJJLFxuICAgIGNvbXBhY3Q6IGNvbXBhY3QsXG4gICAgc2VwYXJhdGU6IHNlcGFyYXRlXG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgZmlsdGVyaW5nXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciBmaWx0ZXIgPSBmdW5jdGlvbiAocHJlZGljYXRlKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChmYSkge1xuICAgICAgICByZXR1cm4gaXNOb25lKGZhKSA/IG5vbmUgOiBwcmVkaWNhdGUoZmEudmFsdWUpID8gZmEgOiBub25lO1xuICAgIH07XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgZmlsdGVyaW5nXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciBmaWx0ZXJNYXAgPSBmdW5jdGlvbiAoZikgeyByZXR1cm4gZnVuY3Rpb24gKGZhKSB7XG4gICAgcmV0dXJuIGlzTm9uZShmYSkgPyBub25lIDogZihmYS52YWx1ZSk7XG59OyB9O1xuLyoqXG4gKiBAY2F0ZWdvcnkgZmlsdGVyaW5nXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciBwYXJ0aXRpb24gPSBmdW5jdGlvbiAocHJlZGljYXRlKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChmYSkge1xuICAgICAgICByZXR1cm4gc2VwYXJhdGVkKF9maWx0ZXIoZmEsIG5vdChwcmVkaWNhdGUpKSwgX2ZpbHRlcihmYSwgcHJlZGljYXRlKSk7XG4gICAgfTtcbn07XG4vKipcbiAqIEBjYXRlZ29yeSBmaWx0ZXJpbmdcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIHBhcnRpdGlvbk1hcCA9IGZ1bmN0aW9uIChmKSB7IHJldHVybiBmbG93KG1hcChmKSwgc2VwYXJhdGUpOyB9O1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi43LjBcbiAqL1xuZXhwb3J0IHZhciBGaWx0ZXJhYmxlID0ge1xuICAgIFVSSTogVVJJLFxuICAgIG1hcDogX21hcCxcbiAgICBjb21wYWN0OiBjb21wYWN0LFxuICAgIHNlcGFyYXRlOiBzZXBhcmF0ZSxcbiAgICBmaWx0ZXI6IF9maWx0ZXIsXG4gICAgZmlsdGVyTWFwOiBfZmlsdGVyTWFwLFxuICAgIHBhcnRpdGlvbjogX3BhcnRpdGlvbixcbiAgICBwYXJ0aXRpb25NYXA6IF9wYXJ0aXRpb25NYXBcbn07XG4vKipcbiAqIEBjYXRlZ29yeSB0cmF2ZXJzaW5nXG4gKiBAc2luY2UgMi42LjNcbiAqL1xuZXhwb3J0IHZhciB0cmF2ZXJzZSA9IGZ1bmN0aW9uIChGKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChmKSB7XG4gICAgICAgIHJldHVybiBmdW5jdGlvbiAodGEpIHtcbiAgICAgICAgICAgIHJldHVybiBpc05vbmUodGEpID8gRi5vZihub25lKSA6IEYubWFwKGYodGEudmFsdWUpLCBzb21lKTtcbiAgICAgICAgfTtcbiAgICB9O1xufTtcbi8qKlxuICogQGNhdGVnb3J5IHRyYXZlcnNpbmdcbiAqIEBzaW5jZSAyLjYuM1xuICovXG5leHBvcnQgdmFyIHNlcXVlbmNlID0gZnVuY3Rpb24gKEYpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKHRhKSB7XG4gICAgICAgIHJldHVybiBpc05vbmUodGEpID8gRi5vZihub25lKSA6IEYubWFwKHRhLnZhbHVlLCBzb21lKTtcbiAgICB9O1xufTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuNy4wXG4gKi9cbmV4cG9ydCB2YXIgVHJhdmVyc2FibGUgPSB7XG4gICAgVVJJOiBVUkksXG4gICAgbWFwOiBfbWFwLFxuICAgIHJlZHVjZTogX3JlZHVjZSxcbiAgICBmb2xkTWFwOiBfZm9sZE1hcCxcbiAgICByZWR1Y2VSaWdodDogX3JlZHVjZVJpZ2h0LFxuICAgIHRyYXZlcnNlOiBfdHJhdmVyc2UsXG4gICAgc2VxdWVuY2U6IHNlcXVlbmNlXG59O1xudmFyIF93aXRoZXIgPSAvKiNfX1BVUkVfXyovIHdpdGhlckRlZmF1bHQoVHJhdmVyc2FibGUsIENvbXBhY3RhYmxlKTtcbnZhciBfd2lsdCA9IC8qI19fUFVSRV9fKi8gd2lsdERlZmF1bHQoVHJhdmVyc2FibGUsIENvbXBhY3RhYmxlKTtcbi8qKlxuICogQGNhdGVnb3J5IGZpbHRlcmluZ1xuICogQHNpbmNlIDIuNi41XG4gKi9cbmV4cG9ydCB2YXIgd2l0aGVyID0gZnVuY3Rpb24gKEYpIHtcbiAgICB2YXIgX3dpdGhlckYgPSBfd2l0aGVyKEYpO1xuICAgIHJldHVybiBmdW5jdGlvbiAoZikgeyByZXR1cm4gZnVuY3Rpb24gKGZhKSB7IHJldHVybiBfd2l0aGVyRihmYSwgZik7IH07IH07XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgZmlsdGVyaW5nXG4gKiBAc2luY2UgMi42LjVcbiAqL1xuZXhwb3J0IHZhciB3aWx0ID0gZnVuY3Rpb24gKEYpIHtcbiAgICB2YXIgX3dpbHRGID0gX3dpbHQoRik7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChmKSB7IHJldHVybiBmdW5jdGlvbiAoZmEpIHsgcmV0dXJuIF93aWx0RihmYSwgZik7IH07IH07XG59O1xuLyoqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi43LjBcbiAqL1xuZXhwb3J0IHZhciBXaXRoZXJhYmxlID0ge1xuICAgIFVSSTogVVJJLFxuICAgIG1hcDogX21hcCxcbiAgICByZWR1Y2U6IF9yZWR1Y2UsXG4gICAgZm9sZE1hcDogX2ZvbGRNYXAsXG4gICAgcmVkdWNlUmlnaHQ6IF9yZWR1Y2VSaWdodCxcbiAgICB0cmF2ZXJzZTogX3RyYXZlcnNlLFxuICAgIHNlcXVlbmNlOiBzZXF1ZW5jZSxcbiAgICBjb21wYWN0OiBjb21wYWN0LFxuICAgIHNlcGFyYXRlOiBzZXBhcmF0ZSxcbiAgICBmaWx0ZXI6IF9maWx0ZXIsXG4gICAgZmlsdGVyTWFwOiBfZmlsdGVyTWFwLFxuICAgIHBhcnRpdGlvbjogX3BhcnRpdGlvbixcbiAgICBwYXJ0aXRpb25NYXA6IF9wYXJ0aXRpb25NYXAsXG4gICAgd2l0aGVyOiBfd2l0aGVyLFxuICAgIHdpbHQ6IF93aWx0XG59O1xuLyoqXG4gKiBAc2luY2UgMi43LjBcbiAqL1xuZXhwb3J0IHZhciB0aHJvd0Vycm9yID0gZnVuY3Rpb24gKCkgeyByZXR1cm4gbm9uZTsgfTtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuNy4wXG4gKi9cbmV4cG9ydCB2YXIgTW9uYWRUaHJvdyA9IHtcbiAgICBVUkk6IFVSSSxcbiAgICBtYXA6IF9tYXAsXG4gICAgYXA6IF9hcCxcbiAgICBvZjogb2YsXG4gICAgY2hhaW46IGZsYXRNYXAsXG4gICAgdGhyb3dFcnJvcjogdGhyb3dFcnJvclxufTtcbi8qKlxuICogVHJhbnNmb3JtcyBhbiBgRWl0aGVyYCB0byBhbiBgT3B0aW9uYCBkaXNjYXJkaW5nIHRoZSBlcnJvci5cbiAqXG4gKiBBbGlhcyBvZiBbZ2V0UmlnaHRdKCNnZXRyaWdodClcbiAqXG4gKiBAY2F0ZWdvcnkgY29udmVyc2lvbnNcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIGZyb21FaXRoZXIgPSBnZXRSaWdodDtcbi8qKlxuICogQGNhdGVnb3J5IGluc3RhbmNlc1xuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIEZyb21FaXRoZXIgPSB7XG4gICAgVVJJOiBVUkksXG4gICAgZnJvbUVpdGhlcjogZnJvbUVpdGhlclxufTtcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8vIHJlZmluZW1lbnRzXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vKipcbiAqIFJldHVybnMgYHRydWVgIGlmIHRoZSBvcHRpb24gaXMgYW4gaW5zdGFuY2Ugb2YgYFNvbWVgLCBgZmFsc2VgIG90aGVyd2lzZS5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgc29tZSwgbm9uZSwgaXNTb21lIH0gZnJvbSAnZnAtdHMvT3B0aW9uJ1xuICpcbiAqIGFzc2VydC5zdHJpY3RFcXVhbChpc1NvbWUoc29tZSgxKSksIHRydWUpXG4gKiBhc3NlcnQuc3RyaWN0RXF1YWwoaXNTb21lKG5vbmUpLCBmYWxzZSlcbiAqXG4gKiBAY2F0ZWdvcnkgcmVmaW5lbWVudHNcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIGlzU29tZSA9IF8uaXNTb21lO1xuLyoqXG4gKiBSZXR1cm5zIGB0cnVlYCBpZiB0aGUgb3B0aW9uIGlzIGBOb25lYCwgYGZhbHNlYCBvdGhlcndpc2UuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IHNvbWUsIG5vbmUsIGlzTm9uZSB9IGZyb20gJ2ZwLXRzL09wdGlvbidcbiAqXG4gKiBhc3NlcnQuc3RyaWN0RXF1YWwoaXNOb25lKHNvbWUoMSkpLCBmYWxzZSlcbiAqIGFzc2VydC5zdHJpY3RFcXVhbChpc05vbmUobm9uZSksIHRydWUpXG4gKlxuICogQGNhdGVnb3J5IHJlZmluZW1lbnRzXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciBpc05vbmUgPSBmdW5jdGlvbiAoZmEpIHsgcmV0dXJuIGZhLl90YWcgPT09ICdOb25lJzsgfTtcbi8qKlxuICogTGVzcyBzdHJpY3QgdmVyc2lvbiBvZiBbYG1hdGNoYF0oI21hdGNoKS5cbiAqXG4gKiBUaGUgYFdgIHN1ZmZpeCAoc2hvcnQgZm9yICoqVyoqaWRlbmluZykgbWVhbnMgdGhhdCB0aGUgaGFuZGxlciByZXR1cm4gdHlwZXMgd2lsbCBiZSBtZXJnZWQuXG4gKlxuICogQGNhdGVnb3J5IHBhdHRlcm4gbWF0Y2hpbmdcbiAqIEBzaW5jZSAyLjEwLjBcbiAqL1xuZXhwb3J0IHZhciBtYXRjaFcgPSBmdW5jdGlvbiAob25Ob25lLCBvblNvbWUpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKG1hKSB7XG4gICAgICAgIHJldHVybiBpc05vbmUobWEpID8gb25Ob25lKCkgOiBvblNvbWUobWEudmFsdWUpO1xuICAgIH07XG59O1xuLyoqXG4gKiBBbGlhcyBvZiBbYG1hdGNoV2BdKCNtYXRjaHcpLlxuICpcbiAqIEBjYXRlZ29yeSBwYXR0ZXJuIG1hdGNoaW5nXG4gKiBAc2luY2UgMi4xMC4wXG4gKi9cbmV4cG9ydCB2YXIgZm9sZFcgPSBtYXRjaFc7XG4vKipcbiAqIFRha2VzIGEgKGxhenkpIGRlZmF1bHQgdmFsdWUsIGEgZnVuY3Rpb24sIGFuZCBhbiBgT3B0aW9uYCB2YWx1ZSwgaWYgdGhlIGBPcHRpb25gIHZhbHVlIGlzIGBOb25lYCB0aGUgZGVmYXVsdCB2YWx1ZSBpc1xuICogcmV0dXJuZWQsIG90aGVyd2lzZSB0aGUgZnVuY3Rpb24gaXMgYXBwbGllZCB0byB0aGUgdmFsdWUgaW5zaWRlIHRoZSBgU29tZWAgYW5kIHRoZSByZXN1bHQgaXMgcmV0dXJuZWQuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IHNvbWUsIG5vbmUsIG1hdGNoIH0gZnJvbSAnZnAtdHMvT3B0aW9uJ1xuICogaW1wb3J0IHsgcGlwZSB9IGZyb20gJ2ZwLXRzL2Z1bmN0aW9uJ1xuICpcbiAqIGFzc2VydC5zdHJpY3RFcXVhbChcbiAqICAgcGlwZShcbiAqICAgICBzb21lKDEpLFxuICogICAgIG1hdGNoKCgpID0+ICdhIG5vbmUnLCBhID0+IGBhIHNvbWUgY29udGFpbmluZyAke2F9YClcbiAqICAgKSxcbiAqICAgJ2Egc29tZSBjb250YWluaW5nIDEnXG4gKiApXG4gKlxuICogYXNzZXJ0LnN0cmljdEVxdWFsKFxuICogICBwaXBlKFxuICogICAgIG5vbmUsXG4gKiAgICAgbWF0Y2goKCkgPT4gJ2Egbm9uZScsIGEgPT4gYGEgc29tZSBjb250YWluaW5nICR7YX1gKVxuICogICApLFxuICogICAnYSBub25lJ1xuICogKVxuICpcbiAqIEBjYXRlZ29yeSBwYXR0ZXJuIG1hdGNoaW5nXG4gKiBAc2luY2UgMi4xMC4wXG4gKi9cbmV4cG9ydCB2YXIgbWF0Y2ggPSBtYXRjaFc7XG4vKipcbiAqIEFsaWFzIG9mIFtgbWF0Y2hgXSgjbWF0Y2gpLlxuICpcbiAqIEBjYXRlZ29yeSBwYXR0ZXJuIG1hdGNoaW5nXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciBmb2xkID0gbWF0Y2g7XG4vKipcbiAqIExlc3Mgc3RyaWN0IHZlcnNpb24gb2YgW2BnZXRPckVsc2VgXSgjZ2V0b3JlbHNlKS5cbiAqXG4gKiBUaGUgYFdgIHN1ZmZpeCAoc2hvcnQgZm9yICoqVyoqaWRlbmluZykgbWVhbnMgdGhhdCB0aGUgaGFuZGxlciByZXR1cm4gdHlwZSB3aWxsIGJlIG1lcmdlZC5cbiAqXG4gKiBAY2F0ZWdvcnkgZXJyb3IgaGFuZGxpbmdcbiAqIEBzaW5jZSAyLjYuMFxuICovXG5leHBvcnQgdmFyIGdldE9yRWxzZVcgPSBmdW5jdGlvbiAob25Ob25lKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChtYSkge1xuICAgICAgICByZXR1cm4gaXNOb25lKG1hKSA/IG9uTm9uZSgpIDogbWEudmFsdWU7XG4gICAgfTtcbn07XG4vKipcbiAqIEV4dHJhY3RzIHRoZSB2YWx1ZSBvdXQgb2YgdGhlIHN0cnVjdHVyZSwgaWYgaXQgZXhpc3RzLiBPdGhlcndpc2UgcmV0dXJucyB0aGUgZ2l2ZW4gZGVmYXVsdCB2YWx1ZVxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBzb21lLCBub25lLCBnZXRPckVsc2UgfSBmcm9tICdmcC10cy9PcHRpb24nXG4gKiBpbXBvcnQgeyBwaXBlIH0gZnJvbSAnZnAtdHMvZnVuY3Rpb24nXG4gKlxuICogYXNzZXJ0LnN0cmljdEVxdWFsKFxuICogICBwaXBlKFxuICogICAgIHNvbWUoMSksXG4gKiAgICAgZ2V0T3JFbHNlKCgpID0+IDApXG4gKiAgICksXG4gKiAgIDFcbiAqIClcbiAqIGFzc2VydC5zdHJpY3RFcXVhbChcbiAqICAgcGlwZShcbiAqICAgICBub25lLFxuICogICAgIGdldE9yRWxzZSgoKSA9PiAwKVxuICogICApLFxuICogICAwXG4gKiApXG4gKlxuICogQGNhdGVnb3J5IGVycm9yIGhhbmRsaW5nXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciBnZXRPckVsc2UgPSBnZXRPckVsc2VXO1xuLyoqXG4gKiBAY2F0ZWdvcnkgbWFwcGluZ1xuICogQHNpbmNlIDIuMTAuMFxuICovXG5leHBvcnQgdmFyIGZsYXAgPSAvKiNfX1BVUkVfXyovIGZsYXBfKEZ1bmN0b3IpO1xuLyoqXG4gKiBDb21iaW5lIHR3byBlZmZlY3RmdWwgYWN0aW9ucywga2VlcGluZyBvbmx5IHRoZSByZXN1bHQgb2YgdGhlIGZpcnN0LlxuICpcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIGFwRmlyc3QgPSAvKiNfX1BVUkVfXyovIGFwRmlyc3RfKEFwcGx5KTtcbi8qKlxuICogQ29tYmluZSB0d28gZWZmZWN0ZnVsIGFjdGlvbnMsIGtlZXBpbmcgb25seSB0aGUgcmVzdWx0IG9mIHRoZSBzZWNvbmQuXG4gKlxuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgYXBTZWNvbmQgPSAvKiNfX1BVUkVfXyovIGFwU2Vjb25kXyhBcHBseSk7XG4vKipcbiAqIEBjYXRlZ29yeSBzZXF1ZW5jaW5nXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciBmbGF0dGVuID0gY29tcGFjdDtcbi8qKlxuICogQ29tcG9zZXMgY29tcHV0YXRpb25zIGluIHNlcXVlbmNlLCB1c2luZyB0aGUgcmV0dXJuIHZhbHVlIG9mIG9uZSBjb21wdXRhdGlvbiB0byBkZXRlcm1pbmUgdGhlIG5leHQgY29tcHV0YXRpb24gYW5kXG4gKiBrZWVwaW5nIG9ubHkgdGhlIHJlc3VsdCBvZiB0aGUgZmlyc3QuXG4gKlxuICogQGNhdGVnb3J5IGNvbWJpbmF0b3JzXG4gKiBAc2luY2UgMi4xNS4wXG4gKi9cbmV4cG9ydCB2YXIgdGFwID0gLyojX19QVVJFX18qLyBkdWFsKDIsIGNoYWluYWJsZS50YXAoQ2hhaW4pKTtcbi8qKlxuICogQ29tcG9zZXMgY29tcHV0YXRpb25zIGluIHNlcXVlbmNlLCB1c2luZyB0aGUgcmV0dXJuIHZhbHVlIG9mIG9uZSBjb21wdXRhdGlvbiB0byBkZXRlcm1pbmUgdGhlIG5leHQgY29tcHV0YXRpb24gYW5kXG4gKiBrZWVwaW5nIG9ubHkgdGhlIHJlc3VsdCBvZiB0aGUgZmlyc3QuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IHBpcGUgfSBmcm9tICdmcC10cy9mdW5jdGlvbidcbiAqIGltcG9ydCAqIGFzIE8gZnJvbSAnZnAtdHMvT3B0aW9uJ1xuICogaW1wb3J0ICogYXMgRSBmcm9tICdmcC10cy9FaXRoZXInXG4gKlxuICogY29uc3QgY29tcHV0ZSA9ICh2YWx1ZTogbnVtYmVyKSA9PiBwaXBlKFxuICogICBPLm9mKHZhbHVlKSxcbiAqICAgTy50YXBFaXRoZXIoKHZhbHVlKSA9PiB2YWx1ZSA+IDAgPyBFLnJpZ2h0KCdvaycpIDogRS5sZWZ0KCdlcnJvcicpKSxcbiAqIClcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKGNvbXB1dGUoMSksIE8ub2YoMSkpXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKGNvbXB1dGUoLTQyKSwgTy5ub25lKVxuICpcbiAqIEBjYXRlZ29yeSBjb21iaW5hdG9yc1xuICogQHNpbmNlIDIuMTYuMFxuICovXG5leHBvcnQgdmFyIHRhcEVpdGhlciA9IC8qI19fUFVSRV9fKi8gZHVhbCgyLCB0YXBFaXRoZXJfKEZyb21FaXRoZXIsIENoYWluKSk7XG4vKipcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIGR1cGxpY2F0ZSA9IC8qI19fUFVSRV9fKi8gZXh0ZW5kKGlkZW50aXR5KTtcbi8qKlxuICogQGNhdGVnb3J5IGxpZnRpbmdcbiAqIEBzaW5jZSAyLjExLjBcbiAqL1xuZXhwb3J0IHZhciBmcm9tRWl0aGVySyA9IC8qI19fUFVSRV9fKi8gZnJvbUVpdGhlcktfKEZyb21FaXRoZXIpO1xuLyoqXG4gKiBAY2F0ZWdvcnkgc2VxdWVuY2luZ1xuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIGNoYWluRWl0aGVySyA9IFxuLyojX19QVVJFX18qLyBjaGFpbkVpdGhlcktfKEZyb21FaXRoZXIsIENoYWluKTtcbi8qKlxuICogQWxpYXMgb2YgYHRhcEVpdGhlcmAuXG4gKlxuICogQGNhdGVnb3J5IGxlZ2FjeVxuICogQHNpbmNlIDIuMTIuMFxuICovXG5leHBvcnQgdmFyIGNoYWluRmlyc3RFaXRoZXJLID0gdGFwRWl0aGVyO1xuLyoqXG4gKiBDb25zdHJ1Y3RzIGEgbmV3IGBPcHRpb25gIGZyb20gYSBudWxsYWJsZSB0eXBlLiBJZiB0aGUgdmFsdWUgaXMgYG51bGxgIG9yIGB1bmRlZmluZWRgLCByZXR1cm5zIGBOb25lYCwgb3RoZXJ3aXNlXG4gKiByZXR1cm5zIHRoZSB2YWx1ZSB3cmFwcGVkIGluIGEgYFNvbWVgLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBub25lLCBzb21lLCBmcm9tTnVsbGFibGUgfSBmcm9tICdmcC10cy9PcHRpb24nXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChmcm9tTnVsbGFibGUodW5kZWZpbmVkKSwgbm9uZSlcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoZnJvbU51bGxhYmxlKG51bGwpLCBub25lKVxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChmcm9tTnVsbGFibGUoMSksIHNvbWUoMSkpXG4gKlxuICogQGNhdGVnb3J5IGNvbnZlcnNpb25zXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciBmcm9tTnVsbGFibGUgPSBmdW5jdGlvbiAoYSkgeyByZXR1cm4gKGEgPT0gbnVsbCA/IG5vbmUgOiBzb21lKGEpKTsgfTtcbi8qKlxuICogVHJhbnNmb3JtcyBhbiBleGNlcHRpb24gaW50byBhbiBgT3B0aW9uYC4gSWYgYGZgIHRocm93cywgcmV0dXJucyBgTm9uZWAsIG90aGVyd2lzZSByZXR1cm5zIHRoZSBvdXRwdXQgd3JhcHBlZCBpbiBhXG4gKiBgU29tZWAuXG4gKlxuICogU2VlIGFsc28gW2B0cnlDYXRjaEtgXSgjdHJ5Y2F0Y2hrKS5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgbm9uZSwgc29tZSwgdHJ5Q2F0Y2ggfSBmcm9tICdmcC10cy9PcHRpb24nXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChcbiAqICAgdHJ5Q2F0Y2goKCkgPT4ge1xuICogICAgIHRocm93IG5ldyBFcnJvcigpXG4gKiAgIH0pLFxuICogICBub25lXG4gKiApXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKHRyeUNhdGNoKCgpID0+IDEpLCBzb21lKDEpKVxuICpcbiAqIEBjYXRlZ29yeSBpbnRlcm9wXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciB0cnlDYXRjaCA9IGZ1bmN0aW9uIChmKSB7XG4gICAgdHJ5IHtcbiAgICAgICAgcmV0dXJuIHNvbWUoZigpKTtcbiAgICB9XG4gICAgY2F0Y2ggKGUpIHtcbiAgICAgICAgcmV0dXJuIG5vbmU7XG4gICAgfVxufTtcbi8qKlxuICogQ29udmVydHMgYSBmdW5jdGlvbiB0aGF0IG1heSB0aHJvdyB0byBvbmUgcmV0dXJuaW5nIGEgYE9wdGlvbmAuXG4gKlxuICogQGNhdGVnb3J5IGludGVyb3BcbiAqIEBzaW5jZSAyLjEwLjBcbiAqL1xuZXhwb3J0IHZhciB0cnlDYXRjaEsgPSBmdW5jdGlvbiAoZikge1xuICAgIHJldHVybiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBhID0gW107XG4gICAgICAgIGZvciAodmFyIF9pID0gMDsgX2kgPCBhcmd1bWVudHMubGVuZ3RoOyBfaSsrKSB7XG4gICAgICAgICAgICBhW19pXSA9IGFyZ3VtZW50c1tfaV07XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRyeUNhdGNoKGZ1bmN0aW9uICgpIHsgcmV0dXJuIGYuYXBwbHkodm9pZCAwLCBhKTsgfSk7XG4gICAgfTtcbn07XG4vKipcbiAqIFJldHVybnMgYSAqc21hcnQgY29uc3RydWN0b3IqIGZyb20gYSBmdW5jdGlvbiB0aGF0IHJldHVybnMgYSBudWxsYWJsZSB2YWx1ZS5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgZnJvbU51bGxhYmxlSywgbm9uZSwgc29tZSB9IGZyb20gJ2ZwLXRzL09wdGlvbidcbiAqXG4gKiBjb25zdCBmID0gKHM6IHN0cmluZyk6IG51bWJlciB8IHVuZGVmaW5lZCA9PiB7XG4gKiAgIGNvbnN0IG4gPSBwYXJzZUZsb2F0KHMpXG4gKiAgIHJldHVybiBpc05hTihuKSA/IHVuZGVmaW5lZCA6IG5cbiAqIH1cbiAqXG4gKiBjb25zdCBnID0gZnJvbU51bGxhYmxlSyhmKVxuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoZygnMScpLCBzb21lKDEpKVxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChnKCdhJyksIG5vbmUpXG4gKlxuICogQGNhdGVnb3J5IGxpZnRpbmdcbiAqIEBzaW5jZSAyLjkuMFxuICovXG5leHBvcnQgdmFyIGZyb21OdWxsYWJsZUsgPSBmdW5jdGlvbiAoZikgeyByZXR1cm4gZmxvdyhmLCBmcm9tTnVsbGFibGUpOyB9O1xuLyoqXG4gKiBUaGlzIGlzIGBjaGFpbmAgKyBgZnJvbU51bGxhYmxlYCwgdXNlZnVsIHdoZW4gd29ya2luZyB3aXRoIG9wdGlvbmFsIHZhbHVlcy5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgc29tZSwgbm9uZSwgZnJvbU51bGxhYmxlLCBjaGFpbk51bGxhYmxlSyB9IGZyb20gJ2ZwLXRzL09wdGlvbidcbiAqIGltcG9ydCB7IHBpcGUgfSBmcm9tICdmcC10cy9mdW5jdGlvbidcbiAqXG4gKiBpbnRlcmZhY2UgRW1wbG95ZWUge1xuICogICByZWFkb25seSBjb21wYW55Pzoge1xuICogICAgIHJlYWRvbmx5IGFkZHJlc3M/OiB7XG4gKiAgICAgICByZWFkb25seSBzdHJlZXQ/OiB7XG4gKiAgICAgICAgIHJlYWRvbmx5IG5hbWU/OiBzdHJpbmdcbiAqICAgICAgIH1cbiAqICAgICB9XG4gKiAgIH1cbiAqIH1cbiAqXG4gKiBjb25zdCBlbXBsb3llZTE6IEVtcGxveWVlID0geyBjb21wYW55OiB7IGFkZHJlc3M6IHsgc3RyZWV0OiB7IG5hbWU6ICdoaWdoIHN0cmVldCcgfSB9IH0gfVxuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoXG4gKiAgIHBpcGUoXG4gKiAgICAgZnJvbU51bGxhYmxlKGVtcGxveWVlMS5jb21wYW55KSxcbiAqICAgICBjaGFpbk51bGxhYmxlSyhjb21wYW55ID0+IGNvbXBhbnkuYWRkcmVzcyksXG4gKiAgICAgY2hhaW5OdWxsYWJsZUsoYWRkcmVzcyA9PiBhZGRyZXNzLnN0cmVldCksXG4gKiAgICAgY2hhaW5OdWxsYWJsZUsoc3RyZWV0ID0+IHN0cmVldC5uYW1lKVxuICogICApLFxuICogICBzb21lKCdoaWdoIHN0cmVldCcpXG4gKiApXG4gKlxuICogY29uc3QgZW1wbG95ZWUyOiBFbXBsb3llZSA9IHsgY29tcGFueTogeyBhZGRyZXNzOiB7IHN0cmVldDoge30gfSB9IH1cbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKFxuICogICBwaXBlKFxuICogICAgIGZyb21OdWxsYWJsZShlbXBsb3llZTIuY29tcGFueSksXG4gKiAgICAgY2hhaW5OdWxsYWJsZUsoY29tcGFueSA9PiBjb21wYW55LmFkZHJlc3MpLFxuICogICAgIGNoYWluTnVsbGFibGVLKGFkZHJlc3MgPT4gYWRkcmVzcy5zdHJlZXQpLFxuICogICAgIGNoYWluTnVsbGFibGVLKHN0cmVldCA9PiBzdHJlZXQubmFtZSlcbiAqICAgKSxcbiAqICAgbm9uZVxuICogKVxuICpcbiAqIEBjYXRlZ29yeSBzZXF1ZW5jaW5nXG4gKiBAc2luY2UgMi45LjBcbiAqL1xuZXhwb3J0IHZhciBjaGFpbk51bGxhYmxlSyA9IGZ1bmN0aW9uIChmKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChtYSkge1xuICAgICAgICByZXR1cm4gaXNOb25lKG1hKSA/IG5vbmUgOiBmcm9tTnVsbGFibGUoZihtYS52YWx1ZSkpO1xuICAgIH07XG59O1xuLyoqXG4gKiBFeHRyYWN0cyB0aGUgdmFsdWUgb3V0IG9mIHRoZSBzdHJ1Y3R1cmUsIGlmIGl0IGV4aXN0cy4gT3RoZXJ3aXNlIHJldHVybnMgYG51bGxgLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBzb21lLCBub25lLCB0b051bGxhYmxlIH0gZnJvbSAnZnAtdHMvT3B0aW9uJ1xuICogaW1wb3J0IHsgcGlwZSB9IGZyb20gJ2ZwLXRzL2Z1bmN0aW9uJ1xuICpcbiAqIGFzc2VydC5zdHJpY3RFcXVhbChcbiAqICAgcGlwZShcbiAqICAgICBzb21lKDEpLFxuICogICAgIHRvTnVsbGFibGVcbiAqICAgKSxcbiAqICAgMVxuICogKVxuICogYXNzZXJ0LnN0cmljdEVxdWFsKFxuICogICBwaXBlKFxuICogICAgIG5vbmUsXG4gKiAgICAgdG9OdWxsYWJsZVxuICogICApLFxuICogICBudWxsXG4gKiApXG4gKlxuICogQGNhdGVnb3J5IGNvbnZlcnNpb25zXG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciB0b051bGxhYmxlID0gLyojX19QVVJFX18qLyBtYXRjaChjb25zdE51bGwsIGlkZW50aXR5KTtcbi8qKlxuICogRXh0cmFjdHMgdGhlIHZhbHVlIG91dCBvZiB0aGUgc3RydWN0dXJlLCBpZiBpdCBleGlzdHMuIE90aGVyd2lzZSByZXR1cm5zIGB1bmRlZmluZWRgLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgeyBzb21lLCBub25lLCB0b1VuZGVmaW5lZCB9IGZyb20gJ2ZwLXRzL09wdGlvbidcbiAqIGltcG9ydCB7IHBpcGUgfSBmcm9tICdmcC10cy9mdW5jdGlvbidcbiAqXG4gKiBhc3NlcnQuc3RyaWN0RXF1YWwoXG4gKiAgIHBpcGUoXG4gKiAgICAgc29tZSgxKSxcbiAqICAgICB0b1VuZGVmaW5lZFxuICogICApLFxuICogICAxXG4gKiApXG4gKiBhc3NlcnQuc3RyaWN0RXF1YWwoXG4gKiAgIHBpcGUoXG4gKiAgICAgbm9uZSxcbiAqICAgICB0b1VuZGVmaW5lZFxuICogICApLFxuICogICB1bmRlZmluZWRcbiAqIClcbiAqXG4gKiBAY2F0ZWdvcnkgY29udmVyc2lvbnNcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIHRvVW5kZWZpbmVkID0gLyojX19QVVJFX18qLyBtYXRjaChjb25zdFVuZGVmaW5lZCwgaWRlbnRpdHkpO1xuZXhwb3J0IGZ1bmN0aW9uIGVsZW0oRSkge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYSwgbWEpIHtcbiAgICAgICAgaWYgKG1hID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIHZhciBlbGVtRV8xID0gZWxlbShFKTtcbiAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbiAobWEpIHsgcmV0dXJuIGVsZW1FXzEoYSwgbWEpOyB9O1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBpc05vbmUobWEpID8gZmFsc2UgOiBFLmVxdWFscyhhLCBtYS52YWx1ZSk7XG4gICAgfTtcbn1cbi8qKlxuICogUmV0dXJucyBgdHJ1ZWAgaWYgdGhlIHByZWRpY2F0ZSBpcyBzYXRpc2ZpZWQgYnkgdGhlIHdyYXBwZWQgdmFsdWVcbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgc29tZSwgbm9uZSwgZXhpc3RzIH0gZnJvbSAnZnAtdHMvT3B0aW9uJ1xuICogaW1wb3J0IHsgcGlwZSB9IGZyb20gJ2ZwLXRzL2Z1bmN0aW9uJ1xuICpcbiAqIGFzc2VydC5zdHJpY3RFcXVhbChcbiAqICAgcGlwZShcbiAqICAgICBzb21lKDEpLFxuICogICAgIGV4aXN0cyhuID0+IG4gPiAwKVxuICogICApLFxuICogICB0cnVlXG4gKiApXG4gKiBhc3NlcnQuc3RyaWN0RXF1YWwoXG4gKiAgIHBpcGUoXG4gKiAgICAgc29tZSgxKSxcbiAqICAgICBleGlzdHMobiA9PiBuID4gMSlcbiAqICAgKSxcbiAqICAgZmFsc2VcbiAqIClcbiAqIGFzc2VydC5zdHJpY3RFcXVhbChcbiAqICAgcGlwZShcbiAqICAgICBub25lLFxuICogICAgIGV4aXN0cyhuID0+IG4gPiAwKVxuICogICApLFxuICogICBmYWxzZVxuICogKVxuICpcbiAqIEBzaW5jZSAyLjAuMFxuICovXG5leHBvcnQgdmFyIGV4aXN0cyA9IGZ1bmN0aW9uIChwcmVkaWNhdGUpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKG1hKSB7XG4gICAgICAgIHJldHVybiBpc05vbmUobWEpID8gZmFsc2UgOiBwcmVkaWNhdGUobWEudmFsdWUpO1xuICAgIH07XG59O1xuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLy8gZG8gbm90YXRpb25cbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8qKlxuICogQGNhdGVnb3J5IGRvIG5vdGF0aW9uXG4gKiBAc2luY2UgMi45LjBcbiAqL1xuZXhwb3J0IHZhciBEbyA9IC8qI19fUFVSRV9fKi8gb2YoXy5lbXB0eVJlY29yZCk7XG4vKipcbiAqIEBjYXRlZ29yeSBkbyBub3RhdGlvblxuICogQHNpbmNlIDIuOC4wXG4gKi9cbmV4cG9ydCB2YXIgYmluZFRvID0gLyojX19QVVJFX18qLyBiaW5kVG9fKEZ1bmN0b3IpO1xudmFyIGxldF8gPSAvKiNfX1BVUkVfXyovIGxldF9fKEZ1bmN0b3IpO1xuZXhwb3J0IHsgXG4vKipcbiAqIEBjYXRlZ29yeSBkbyBub3RhdGlvblxuICogQHNpbmNlIDIuMTMuMFxuICovXG5sZXRfIGFzIGxldCB9O1xuLyoqXG4gKiBAY2F0ZWdvcnkgZG8gbm90YXRpb25cbiAqIEBzaW5jZSAyLjguMFxuICovXG5leHBvcnQgdmFyIGJpbmQgPSAvKiNfX1BVUkVfXyovIGNoYWluYWJsZS5iaW5kKENoYWluKTtcbi8qKlxuICogQGNhdGVnb3J5IGRvIG5vdGF0aW9uXG4gKiBAc2luY2UgMi44LjBcbiAqL1xuZXhwb3J0IHZhciBhcFMgPSAvKiNfX1BVUkVfXyovIGFwU18oQXBwbHkpO1xuLyoqXG4gKiBAc2luY2UgMi4xMS4wXG4gKi9cbmV4cG9ydCB2YXIgQXBUID0gLyojX19QVVJFX18qLyBvZihfLmVtcHR5UmVhZG9ubHlBcnJheSk7XG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vLyBhcnJheSB1dGlsc1xuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLyoqXG4gKiBFcXVpdmFsZW50IHRvIGBSZWFkb25seU5vbkVtcHR5QXJyYXkjdHJhdmVyc2VXaXRoSW5kZXgoQXBwbGljYXRpdmUpYC5cbiAqXG4gKiBAY2F0ZWdvcnkgdHJhdmVyc2luZ1xuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIHRyYXZlcnNlUmVhZG9ubHlOb25FbXB0eUFycmF5V2l0aEluZGV4ID0gZnVuY3Rpb24gKGYpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7XG4gICAgICAgIHZhciBvID0gZigwLCBfLmhlYWQoYXMpKTtcbiAgICAgICAgaWYgKGlzTm9uZShvKSkge1xuICAgICAgICAgICAgcmV0dXJuIG5vbmU7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIG91dCA9IFtvLnZhbHVlXTtcbiAgICAgICAgZm9yICh2YXIgaSA9IDE7IGkgPCBhcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgdmFyIG9fMSA9IGYoaSwgYXNbaV0pO1xuICAgICAgICAgICAgaWYgKGlzTm9uZShvXzEpKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG5vbmU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBvdXQucHVzaChvXzEudmFsdWUpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBzb21lKG91dCk7XG4gICAgfTtcbn07XG4vKipcbiAqIEVxdWl2YWxlbnQgdG8gYFJlYWRvbmx5QXJyYXkjdHJhdmVyc2VXaXRoSW5kZXgoQXBwbGljYXRpdmUpYC5cbiAqXG4gKiBAY2F0ZWdvcnkgdHJhdmVyc2luZ1xuICogQHNpbmNlIDIuMTEuMFxuICovXG5leHBvcnQgdmFyIHRyYXZlcnNlUmVhZG9ubHlBcnJheVdpdGhJbmRleCA9IGZ1bmN0aW9uIChmKSB7XG4gICAgdmFyIGcgPSB0cmF2ZXJzZVJlYWRvbmx5Tm9uRW1wdHlBcnJheVdpdGhJbmRleChmKTtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFzKSB7IHJldHVybiAoXy5pc05vbkVtcHR5KGFzKSA/IGcoYXMpIDogQXBUKTsgfTtcbn07XG4vKipcbiAqIEVxdWl2YWxlbnQgdG8gYFJlYWRvbmx5QXJyYXkjdHJhdmVyc2VXaXRoSW5kZXgoQXBwbGljYXRpdmUpYC5cbiAqXG4gKiBAY2F0ZWdvcnkgdHJhdmVyc2luZ1xuICogQHNpbmNlIDIuOS4wXG4gKi9cbmV4cG9ydCB2YXIgdHJhdmVyc2VBcnJheVdpdGhJbmRleCA9IHRyYXZlcnNlUmVhZG9ubHlBcnJheVdpdGhJbmRleDtcbi8qKlxuICogRXF1aXZhbGVudCB0byBgUmVhZG9ubHlBcnJheSN0cmF2ZXJzZShBcHBsaWNhdGl2ZSlgLlxuICpcbiAqIEBjYXRlZ29yeSB0cmF2ZXJzaW5nXG4gKiBAc2luY2UgMi45LjBcbiAqL1xuZXhwb3J0IHZhciB0cmF2ZXJzZUFycmF5ID0gZnVuY3Rpb24gKGYpIHtcbiAgICByZXR1cm4gdHJhdmVyc2VSZWFkb25seUFycmF5V2l0aEluZGV4KGZ1bmN0aW9uIChfLCBhKSB7IHJldHVybiBmKGEpOyB9KTtcbn07XG4vKipcbiAqIEVxdWl2YWxlbnQgdG8gYFJlYWRvbmx5QXJyYXkjc2VxdWVuY2UoQXBwbGljYXRpdmUpYC5cbiAqXG4gKiBAY2F0ZWdvcnkgdHJhdmVyc2luZ1xuICogQHNpbmNlIDIuOS4wXG4gKi9cbmV4cG9ydCB2YXIgc2VxdWVuY2VBcnJheSA9IFxuLyojX19QVVJFX18qLyB0cmF2ZXJzZUFycmF5KGlkZW50aXR5KTtcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8vIGxlZ2FjeVxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLyoqXG4gKiBBbGlhcyBvZiBgZmxhdE1hcGAuXG4gKlxuICogQGNhdGVnb3J5IGxlZ2FjeVxuICogQHNpbmNlIDIuMC4wXG4gKi9cbmV4cG9ydCB2YXIgY2hhaW4gPSBmbGF0TWFwO1xuLyoqXG4gKiBBbGlhcyBvZiBgdGFwYC5cbiAqXG4gKiBAY2F0ZWdvcnkgbGVnYWN5XG4gKiBAc2luY2UgMi4wLjBcbiAqL1xuZXhwb3J0IHZhciBjaGFpbkZpcnN0ID0gdGFwO1xuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLy8gZGVwcmVjYXRlZFxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLyoqXG4gKiBVc2UgYFJlZmluZW1lbnRgIG1vZHVsZSBpbnN0ZWFkLlxuICpcbiAqIEBjYXRlZ29yeSB6b25lIG9mIGRlYXRoXG4gKiBAc2luY2UgMi4wLjBcbiAqIEBkZXByZWNhdGVkXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBnZXRSZWZpbmVtZW50KGdldE9wdGlvbikge1xuICAgIHJldHVybiBmdW5jdGlvbiAoYSkgeyByZXR1cm4gaXNTb21lKGdldE9wdGlvbihhKSk7IH07XG59XG4vKipcbiAqIFVzZSBbYGNoYWluTnVsbGFibGVLYF0oI2NoYWlubnVsbGFibGVrKSBpbnN0ZWFkLlxuICpcbiAqIEBjYXRlZ29yeSB6b25lIG9mIGRlYXRoXG4gKiBAc2luY2UgMi4wLjBcbiAqIEBkZXByZWNhdGVkXG4gKi9cbmV4cG9ydCB2YXIgbWFwTnVsbGFibGUgPSBjaGFpbk51bGxhYmxlSztcbi8qKlxuICogVGhpcyBpbnN0YW5jZSBpcyBkZXByZWNhdGVkLCB1c2Ugc21hbGwsIHNwZWNpZmljIGluc3RhbmNlcyBpbnN0ZWFkLlxuICogRm9yIGV4YW1wbGUgaWYgYSBmdW5jdGlvbiBuZWVkcyBhIGBGdW5jdG9yYCBpbnN0YW5jZSwgcGFzcyBgTy5GdW5jdG9yYCBpbnN0ZWFkIG9mIGBPLm9wdGlvbmBcbiAqICh3aGVyZSBgT2AgaXMgZnJvbSBgaW1wb3J0IE8gZnJvbSAnZnAtdHMvT3B0aW9uJ2ApXG4gKlxuICogQGNhdGVnb3J5IHpvbmUgb2YgZGVhdGhcbiAqIEBzaW5jZSAyLjAuMFxuICogQGRlcHJlY2F0ZWRcbiAqL1xuZXhwb3J0IHZhciBvcHRpb24gPSB7XG4gICAgVVJJOiBVUkksXG4gICAgbWFwOiBfbWFwLFxuICAgIG9mOiBvZixcbiAgICBhcDogX2FwLFxuICAgIGNoYWluOiBmbGF0TWFwLFxuICAgIHJlZHVjZTogX3JlZHVjZSxcbiAgICBmb2xkTWFwOiBfZm9sZE1hcCxcbiAgICByZWR1Y2VSaWdodDogX3JlZHVjZVJpZ2h0LFxuICAgIHRyYXZlcnNlOiBfdHJhdmVyc2UsXG4gICAgc2VxdWVuY2U6IHNlcXVlbmNlLFxuICAgIHplcm86IHplcm8sXG4gICAgYWx0OiBfYWx0LFxuICAgIGV4dGVuZDogX2V4dGVuZCxcbiAgICBjb21wYWN0OiBjb21wYWN0LFxuICAgIHNlcGFyYXRlOiBzZXBhcmF0ZSxcbiAgICBmaWx0ZXI6IF9maWx0ZXIsXG4gICAgZmlsdGVyTWFwOiBfZmlsdGVyTWFwLFxuICAgIHBhcnRpdGlvbjogX3BhcnRpdGlvbixcbiAgICBwYXJ0aXRpb25NYXA6IF9wYXJ0aXRpb25NYXAsXG4gICAgd2l0aGVyOiBfd2l0aGVyLFxuICAgIHdpbHQ6IF93aWx0LFxuICAgIHRocm93RXJyb3I6IHRocm93RXJyb3Jcbn07XG4vKipcbiAqIFVzZSBbYGdldEFwcGx5U2VtaWdyb3VwYF0oLi9BcHBseS50cy5odG1sI2dldGFwcGx5c2VtaWdyb3VwKSBpbnN0ZWFkLlxuICpcbiAqIEBjYXRlZ29yeSB6b25lIG9mIGRlYXRoXG4gKiBAc2luY2UgMi4wLjBcbiAqIEBkZXByZWNhdGVkXG4gKi9cbmV4cG9ydCB2YXIgZ2V0QXBwbHlTZW1pZ3JvdXAgPSAvKiNfX1BVUkVfXyovIGdldEFwcGx5U2VtaWdyb3VwXyhBcHBseSk7XG4vKipcbiAqIFVzZSBbYGdldEFwcGxpY2F0aXZlTW9ub2lkYF0oLi9BcHBsaWNhdGl2ZS50cy5odG1sI2dldGFwcGxpY2F0aXZlbW9ub2lkKSBpbnN0ZWFkLlxuICpcbiAqIEBjYXRlZ29yeSB6b25lIG9mIGRlYXRoXG4gKiBAc2luY2UgMi4wLjBcbiAqIEBkZXByZWNhdGVkXG4gKi9cbmV4cG9ydCB2YXIgZ2V0QXBwbHlNb25vaWQgPSAvKiNfX1BVUkVfXyovIGdldEFwcGxpY2F0aXZlTW9ub2lkKEFwcGxpY2F0aXZlKTtcbi8qKlxuICogVXNlXG4gKlxuICogYGBgdHNcbiAqIGltcG9ydCB7IGZpcnN0IH0gZnJvbSAnZnAtdHMvU2VtaWdyb3VwJ1xuICogaW1wb3J0IHsgZ2V0TW9ub2lkIH0gZnJvbSAnZnAtdHMvT3B0aW9uJ1xuICpcbiAqIGdldE1vbm9pZChmaXJzdCgpKVxuICogYGBgXG4gKlxuICogaW5zdGVhZC5cbiAqXG4gKiBNb25vaWQgcmV0dXJuaW5nIHRoZSBsZWZ0LW1vc3Qgbm9uLWBOb25lYCB2YWx1ZVxuICpcbiAqIHwgeCAgICAgICB8IHkgICAgICAgfCBjb25jYXQoeCwgeSkgfFxuICogfCAtLS0tLS0tIHwgLS0tLS0tLSB8IC0tLS0tLS0tLS0tLSB8XG4gKiB8IG5vbmUgICAgfCBub25lICAgIHwgbm9uZSAgICAgICAgIHxcbiAqIHwgc29tZShhKSB8IG5vbmUgICAgfCBzb21lKGEpICAgICAgfFxuICogfCBub25lICAgIHwgc29tZShiKSB8IHNvbWUoYikgICAgICB8XG4gKiB8IHNvbWUoYSkgfCBzb21lKGIpIHwgc29tZShhKSAgICAgIHxcbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgZ2V0Rmlyc3RNb25vaWQsIHNvbWUsIG5vbmUgfSBmcm9tICdmcC10cy9PcHRpb24nXG4gKlxuICogY29uc3QgTSA9IGdldEZpcnN0TW9ub2lkPG51bWJlcj4oKVxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChNLmNvbmNhdChub25lLCBub25lKSwgbm9uZSlcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoTS5jb25jYXQoc29tZSgxKSwgbm9uZSksIHNvbWUoMSkpXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKE0uY29uY2F0KG5vbmUsIHNvbWUoMikpLCBzb21lKDIpKVxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChNLmNvbmNhdChzb21lKDEpLCBzb21lKDIpKSwgc29tZSgxKSlcbiAqXG4gKiBAY2F0ZWdvcnkgem9uZSBvZiBkZWF0aFxuICogQHNpbmNlIDIuMC4wXG4gKiBAZGVwcmVjYXRlZFxuICovXG5leHBvcnQgdmFyIGdldEZpcnN0TW9ub2lkID0gZnVuY3Rpb24gKCkgeyByZXR1cm4gZ2V0TW9ub2lkKGZpcnN0KCkpOyB9O1xuLyoqXG4gKiBVc2VcbiAqXG4gKiBgYGB0c1xuICogaW1wb3J0IHsgbGFzdCB9IGZyb20gJ2ZwLXRzL1NlbWlncm91cCdcbiAqIGltcG9ydCB7IGdldE1vbm9pZCB9IGZyb20gJ2ZwLXRzL09wdGlvbidcbiAqXG4gKiBnZXRNb25vaWQobGFzdCgpKVxuICogYGBgXG4gKlxuICogaW5zdGVhZC5cbiAqXG4gKiBNb25vaWQgcmV0dXJuaW5nIHRoZSByaWdodC1tb3N0IG5vbi1gTm9uZWAgdmFsdWVcbiAqXG4gKiB8IHggICAgICAgfCB5ICAgICAgIHwgY29uY2F0KHgsIHkpIHxcbiAqIHwgLS0tLS0tLSB8IC0tLS0tLS0gfCAtLS0tLS0tLS0tLS0gfFxuICogfCBub25lICAgIHwgbm9uZSAgICB8IG5vbmUgICAgICAgICB8XG4gKiB8IHNvbWUoYSkgfCBub25lICAgIHwgc29tZShhKSAgICAgIHxcbiAqIHwgbm9uZSAgICB8IHNvbWUoYikgfCBzb21lKGIpICAgICAgfFxuICogfCBzb21lKGEpIHwgc29tZShiKSB8IHNvbWUoYikgICAgICB8XG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IGdldExhc3RNb25vaWQsIHNvbWUsIG5vbmUgfSBmcm9tICdmcC10cy9PcHRpb24nXG4gKlxuICogY29uc3QgTSA9IGdldExhc3RNb25vaWQ8bnVtYmVyPigpXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKE0uY29uY2F0KG5vbmUsIG5vbmUpLCBub25lKVxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChNLmNvbmNhdChzb21lKDEpLCBub25lKSwgc29tZSgxKSlcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoTS5jb25jYXQobm9uZSwgc29tZSgyKSksIHNvbWUoMikpXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKE0uY29uY2F0KHNvbWUoMSksIHNvbWUoMikpLCBzb21lKDIpKVxuICpcbiAqIEBjYXRlZ29yeSB6b25lIG9mIGRlYXRoXG4gKiBAc2luY2UgMi4wLjBcbiAqIEBkZXByZWNhdGVkXG4gKi9cbmV4cG9ydCB2YXIgZ2V0TGFzdE1vbm9pZCA9IGZ1bmN0aW9uICgpIHsgcmV0dXJuIGdldE1vbm9pZChsYXN0KCkpOyB9O1xuIiwKICAiLyoqXG4gKiBAc2luY2UgMi4xMS4wXG4gKi9cbmltcG9ydCB7IGZsb3csIGlkZW50aXR5IH0gZnJvbSAnLi9mdW5jdGlvbic7XG4vKipcbiAqIEBjYXRlZ29yeSB0eXBlIGxhbWJkYXNcbiAqIEBzaW5jZSAyLjExLjBcbiAqL1xuZXhwb3J0IHZhciBVUkkgPSAnRW5kb21vcnBoaXNtJztcbi8qKlxuICogRW5kb21vcnBoaXNtIGZvcm0gYSBgU2VtaWdyb3VwYCB3aGVyZSB0aGUgYGNvbmNhdGAgb3BlcmF0aW9uIGlzIHRoZSB1c3VhbCBmdW5jdGlvbiBjb21wb3NpdGlvbi5cbiAqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi4xMS4wXG4gKi9cbmV4cG9ydCB2YXIgZ2V0U2VtaWdyb3VwID0gZnVuY3Rpb24gKCkgeyByZXR1cm4gKHtcbiAgICBjb25jYXQ6IGZ1bmN0aW9uIChmaXJzdCwgc2Vjb25kKSB7IHJldHVybiBmbG93KGZpcnN0LCBzZWNvbmQpOyB9XG59KTsgfTtcbi8qKlxuICogRW5kb21vcnBoaXNtIGZvcm0gYSBgTW9ub2lkYCB3aGVyZSB0aGUgYGVtcHR5YCB2YWx1ZSBpcyB0aGUgYGlkZW50aXR5YCBmdW5jdGlvbi5cbiAqXG4gKiBAY2F0ZWdvcnkgaW5zdGFuY2VzXG4gKiBAc2luY2UgMi4xMS4wXG4gKi9cbmV4cG9ydCB2YXIgZ2V0TW9ub2lkID0gZnVuY3Rpb24gKCkgeyByZXR1cm4gKHtcbiAgICBjb25jYXQ6IGdldFNlbWlncm91cCgpLmNvbmNhdCxcbiAgICBlbXB0eTogaWRlbnRpdHlcbn0pOyB9O1xuIiwKICAiaW1wb3J0IHsgZ2V0TW9ub2lkIGFzIGdldEVNIH0gZnJvbSAnLi9FbmRvbW9ycGhpc20nO1xuaW1wb3J0IHsgZ2V0TW9ub2lkIGFzIGdldEZNIH0gZnJvbSAnLi9mdW5jdGlvbic7XG5pbXBvcnQgKiBhcyBfIGZyb20gJy4vaW50ZXJuYWwnO1xuaW1wb3J0ICogYXMgU2UgZnJvbSAnLi9TZW1pZ3JvdXAnO1xuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLy8gY29uc3RydWN0b3JzXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vKipcbiAqIEdldCBhIG1vbm9pZCB3aGVyZSBgY29uY2F0YCB3aWxsIHJldHVybiB0aGUgbWluaW11bSwgYmFzZWQgb24gdGhlIHByb3ZpZGVkIGJvdW5kZWQgb3JkZXIuXG4gKlxuICogVGhlIGBlbXB0eWAgdmFsdWUgaXMgdGhlIGB0b3BgIHZhbHVlLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgKiBhcyBOIGZyb20gJ2ZwLXRzL251bWJlcidcbiAqIGltcG9ydCAqIGFzIE0gZnJvbSAnZnAtdHMvTW9ub2lkJ1xuICpcbiAqIGNvbnN0IE0xID0gTS5taW4oTi5Cb3VuZGVkKVxuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoTTEuY29uY2F0KDEsIDIpLCAxKVxuICpcbiAqIEBjYXRlZ29yeSBjb25zdHJ1Y3RvcnNcbiAqIEBzaW5jZSAyLjEwLjBcbiAqL1xuZXhwb3J0IHZhciBtaW4gPSBmdW5jdGlvbiAoQikgeyByZXR1cm4gKHtcbiAgICBjb25jYXQ6IFNlLm1pbihCKS5jb25jYXQsXG4gICAgZW1wdHk6IEIudG9wXG59KTsgfTtcbi8qKlxuICogR2V0IGEgbW9ub2lkIHdoZXJlIGBjb25jYXRgIHdpbGwgcmV0dXJuIHRoZSBtYXhpbXVtLCBiYXNlZCBvbiB0aGUgcHJvdmlkZWQgYm91bmRlZCBvcmRlci5cbiAqXG4gKiBUaGUgYGVtcHR5YCB2YWx1ZSBpcyB0aGUgYGJvdHRvbWAgdmFsdWUuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCAqIGFzIE4gZnJvbSAnZnAtdHMvbnVtYmVyJ1xuICogaW1wb3J0ICogYXMgTSBmcm9tICdmcC10cy9Nb25vaWQnXG4gKlxuICogY29uc3QgTTEgPSBNLm1heChOLkJvdW5kZWQpXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChNMS5jb25jYXQoMSwgMiksIDIpXG4gKlxuICogQGNhdGVnb3J5IGNvbnN0cnVjdG9yc1xuICogQHNpbmNlIDIuMTAuMFxuICovXG5leHBvcnQgdmFyIG1heCA9IGZ1bmN0aW9uIChCKSB7IHJldHVybiAoe1xuICAgIGNvbmNhdDogU2UubWF4KEIpLmNvbmNhdCxcbiAgICBlbXB0eTogQi5ib3R0b21cbn0pOyB9O1xuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLy8gY29tYmluYXRvcnNcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8qKlxuICogVGhlIGR1YWwgb2YgYSBgTW9ub2lkYCwgb2J0YWluZWQgYnkgc3dhcHBpbmcgdGhlIGFyZ3VtZW50cyBvZiBgY29uY2F0YC5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgcmV2ZXJzZSB9IGZyb20gJ2ZwLXRzL01vbm9pZCdcbiAqIGltcG9ydCAqIGFzIFMgZnJvbSAnZnAtdHMvc3RyaW5nJ1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwocmV2ZXJzZShTLk1vbm9pZCkuY29uY2F0KCdhJywgJ2InKSwgJ2JhJylcbiAqXG4gKiBAc2luY2UgMi4xMC4wXG4gKi9cbmV4cG9ydCB2YXIgcmV2ZXJzZSA9IGZ1bmN0aW9uIChNKSB7IHJldHVybiAoe1xuICAgIGNvbmNhdDogU2UucmV2ZXJzZShNKS5jb25jYXQsXG4gICAgZW1wdHk6IE0uZW1wdHlcbn0pOyB9O1xuLyoqXG4gKiBHaXZlbiBhIHN0cnVjdCBvZiBtb25vaWRzIHJldHVybnMgYSBtb25vaWQgZm9yIHRoZSBzdHJ1Y3QuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IHN0cnVjdCB9IGZyb20gJ2ZwLXRzL01vbm9pZCdcbiAqIGltcG9ydCAqIGFzIE4gZnJvbSAnZnAtdHMvbnVtYmVyJ1xuICpcbiAqIGludGVyZmFjZSBQb2ludCB7XG4gKiAgIHJlYWRvbmx5IHg6IG51bWJlclxuICogICByZWFkb25seSB5OiBudW1iZXJcbiAqIH1cbiAqXG4gKiBjb25zdCBNID0gc3RydWN0PFBvaW50Pih7XG4gKiAgIHg6IE4uTW9ub2lkU3VtLFxuICogICB5OiBOLk1vbm9pZFN1bVxuICogfSlcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKE0uY29uY2F0KHsgeDogMSwgeTogMiB9LCB7IHg6IDMsIHk6IDQgfSksIHsgeDogNCwgeTogNiB9KVxuICpcbiAqIEBzaW5jZSAyLjEwLjBcbiAqL1xuZXhwb3J0IHZhciBzdHJ1Y3QgPSBmdW5jdGlvbiAobW9ub2lkcykge1xuICAgIHZhciBlbXB0eSA9IHt9O1xuICAgIGZvciAodmFyIGsgaW4gbW9ub2lkcykge1xuICAgICAgICBpZiAoXy5oYXMuY2FsbChtb25vaWRzLCBrKSkge1xuICAgICAgICAgICAgZW1wdHlba10gPSBtb25vaWRzW2tdLmVtcHR5O1xuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiB7XG4gICAgICAgIGNvbmNhdDogU2Uuc3RydWN0KG1vbm9pZHMpLmNvbmNhdCxcbiAgICAgICAgZW1wdHk6IGVtcHR5XG4gICAgfTtcbn07XG4vKipcbiAqIEdpdmVuIGEgdHVwbGUgb2YgbW9ub2lkcyByZXR1cm5zIGEgbW9ub2lkIGZvciB0aGUgdHVwbGUuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IHR1cGxlIH0gZnJvbSAnZnAtdHMvTW9ub2lkJ1xuICogaW1wb3J0ICogYXMgQiBmcm9tICdmcC10cy9ib29sZWFuJ1xuICogaW1wb3J0ICogYXMgTiBmcm9tICdmcC10cy9udW1iZXInXG4gKiBpbXBvcnQgKiBhcyBTIGZyb20gJ2ZwLXRzL3N0cmluZydcbiAqXG4gKiBjb25zdCBNMSA9IHR1cGxlKFMuTW9ub2lkLCBOLk1vbm9pZFN1bSlcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoTTEuY29uY2F0KFsnYScsIDFdLCBbJ2InLCAyXSksIFsnYWInLCAzXSlcbiAqXG4gKiBjb25zdCBNMiA9IHR1cGxlKFMuTW9ub2lkLCBOLk1vbm9pZFN1bSwgQi5Nb25vaWRBbGwpXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKE0yLmNvbmNhdChbJ2EnLCAxLCB0cnVlXSwgWydiJywgMiwgZmFsc2VdKSwgWydhYicsIDMsIGZhbHNlXSlcbiAqXG4gKiBAc2luY2UgMi4xMC4wXG4gKi9cbmV4cG9ydCB2YXIgdHVwbGUgPSBmdW5jdGlvbiAoKSB7XG4gICAgdmFyIG1vbm9pZHMgPSBbXTtcbiAgICBmb3IgKHZhciBfaSA9IDA7IF9pIDwgYXJndW1lbnRzLmxlbmd0aDsgX2krKykge1xuICAgICAgICBtb25vaWRzW19pXSA9IGFyZ3VtZW50c1tfaV07XG4gICAgfVxuICAgIHJldHVybiAoe1xuICAgICAgICBjb25jYXQ6IFNlLnR1cGxlLmFwcGx5KFNlLCBtb25vaWRzKS5jb25jYXQsXG4gICAgICAgIGVtcHR5OiBtb25vaWRzLm1hcChmdW5jdGlvbiAobSkgeyByZXR1cm4gbS5lbXB0eTsgfSlcbiAgICB9KTtcbn07XG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vLyB1dGlsc1xuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLyoqXG4gKiBHaXZlbiBhIHNlcXVlbmNlIG9mIGBhc2AsIGNvbmNhdCB0aGVtIGFuZCByZXR1cm4gdGhlIHRvdGFsLlxuICpcbiAqIElmIGBhc2AgaXMgZW1wdHksIHJldHVybiB0aGUgbW9ub2lkIGBlbXB0eWAgdmFsdWUuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IGNvbmNhdEFsbCB9IGZyb20gJ2ZwLXRzL01vbm9pZCdcbiAqIGltcG9ydCAqIGFzIE4gZnJvbSAnZnAtdHMvbnVtYmVyJ1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoY29uY2F0QWxsKE4uTW9ub2lkU3VtKShbMSwgMiwgM10pLCA2KVxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChjb25jYXRBbGwoTi5Nb25vaWRTdW0pKFtdKSwgMClcbiAqXG4gKiBAc2luY2UgMi4xMC4wXG4gKi9cbmV4cG9ydCB2YXIgY29uY2F0QWxsID0gZnVuY3Rpb24gKE0pIHsgcmV0dXJuIFNlLmNvbmNhdEFsbChNKShNLmVtcHR5KTsgfTtcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8vIGRlcHJlY2F0ZWRcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8qKlxuICogVXNlIFtgTW9ub2lkYF0oLi92b2lkLnRzLmh0bWwjbW9ub2lkKSBpbnN0ZWFkLlxuICpcbiAqIEBjYXRlZ29yeSB6b25lIG9mIGRlYXRoXG4gKiBAc2luY2UgMi4wLjBcbiAqIEBkZXByZWNhdGVkXG4gKi9cbmV4cG9ydCB2YXIgbW9ub2lkVm9pZCA9IHtcbiAgICBjb25jYXQ6IFNlLnNlbWlncm91cFZvaWQuY29uY2F0LFxuICAgIGVtcHR5OiB1bmRlZmluZWRcbn07XG4vKipcbiAqIFVzZSBbYHR1cGxlYF0oI3R1cGxlKSBpbnN0ZWFkLlxuICpcbiAqIEBjYXRlZ29yeSB6b25lIG9mIGRlYXRoXG4gKiBAc2luY2UgMi4wLjBcbiAqIEBkZXByZWNhdGVkXG4gKi9cbmV4cG9ydCB2YXIgZ2V0VHVwbGVNb25vaWQgPSB0dXBsZTtcbi8qKlxuICogVXNlIFtgc3RydWN0YF0oI3N0cnVjdCkgaW5zdGVhZC5cbiAqXG4gKiBAY2F0ZWdvcnkgem9uZSBvZiBkZWF0aFxuICogQHNpbmNlIDIuMC4wXG4gKiBAZGVwcmVjYXRlZFxuICovXG5leHBvcnQgdmFyIGdldFN0cnVjdE1vbm9pZCA9IHN0cnVjdDtcbi8qKlxuICogVXNlIFtgcmV2ZXJzZWBdKCNyZXZlcnNlKSBpbnN0ZWFkLlxuICpcbiAqIEBjYXRlZ29yeSB6b25lIG9mIGRlYXRoXG4gKiBAc2luY2UgMi4wLjBcbiAqIEBkZXByZWNhdGVkXG4gKi9cbmV4cG9ydCB2YXIgZ2V0RHVhbE1vbm9pZCA9IHJldmVyc2U7XG4vKipcbiAqIFVzZSBbYG1heGBdKCNtYXgpIGluc3RlYWQuXG4gKlxuICogQGNhdGVnb3J5IHpvbmUgb2YgZGVhdGhcbiAqIEBzaW5jZSAyLjAuMFxuICogQGRlcHJlY2F0ZWRcbiAqL1xuZXhwb3J0IHZhciBnZXRKb2luTW9ub2lkID0gbWF4O1xuLyoqXG4gKiBVc2UgW2BtaW5gXSgjbWluKSBpbnN0ZWFkLlxuICpcbiAqIEBjYXRlZ29yeSB6b25lIG9mIGRlYXRoXG4gKiBAc2luY2UgMi4wLjBcbiAqIEBkZXByZWNhdGVkXG4gKi9cbmV4cG9ydCB2YXIgZ2V0TWVldE1vbm9pZCA9IG1pbjtcbi8qKlxuICogVXNlIFtgY29uY2F0QWxsYF0oI2NvbmNhdGFsbCkgaW5zdGVhZC5cbiAqXG4gKiBAY2F0ZWdvcnkgem9uZSBvZiBkZWF0aFxuICogQHNpbmNlIDIuMC4wXG4gKiBAZGVwcmVjYXRlZFxuICovXG5leHBvcnQgdmFyIGZvbGQgPSBjb25jYXRBbGw7XG4vKipcbiAqIFVzZSBbYE1vbm9pZEFsbGBdKC4vYm9vbGVhbi50cy5odG1sI21vbm9pZGFsbCkgaW5zdGVhZC5cbiAqXG4gKiBAY2F0ZWdvcnkgem9uZSBvZiBkZWF0aFxuICogQHNpbmNlIDIuMC4wXG4gKiBAZGVwcmVjYXRlZFxuICovXG5leHBvcnQgdmFyIG1vbm9pZEFsbCA9IHtcbiAgICBjb25jYXQ6IFNlLnNlbWlncm91cEFsbC5jb25jYXQsXG4gICAgZW1wdHk6IHRydWVcbn07XG4vKipcbiAqIFVzZSBbYE1vbm9pZEFueWBdKC4vYm9vbGVhbi50cy5odG1sI21vbm9pZGFueSkgaW5zdGVhZC5cbiAqXG4gKiBAY2F0ZWdvcnkgem9uZSBvZiBkZWF0aFxuICogQHNpbmNlIDIuMC4wXG4gKiBAZGVwcmVjYXRlZFxuICovXG5leHBvcnQgdmFyIG1vbm9pZEFueSA9IHtcbiAgICBjb25jYXQ6IFNlLnNlbWlncm91cEFueS5jb25jYXQsXG4gICAgZW1wdHk6IGZhbHNlXG59O1xuLyoqXG4gKiBVc2UgW2BnZXRNb25vaWRgXSguL2Z1bmN0aW9uLnRzLmh0bWwjZ2V0bW9ub2lkKSBpbnN0ZWFkLlxuICpcbiAqIEBjYXRlZ29yeSB6b25lIG9mIGRlYXRoXG4gKiBAc2luY2UgMi4wLjBcbiAqIEBkZXByZWNhdGVkXG4gKi9cbmV4cG9ydCB2YXIgZ2V0RnVuY3Rpb25Nb25vaWQgPSBnZXRGTTtcbi8qKlxuICogVXNlIFtgZ2V0RW5kb21vcnBoaXNtTW9ub2lkYF0oLi9mdW5jdGlvbi50cy5odG1sI2dldGVuZG9tb3JwaGlzbW1vbm9pZCkgaW5zdGVhZC5cbiAqXG4gKiAqKk5vdGUqKi4gVGhlIGV4ZWN1dGlvbiBvcmRlciBpbiBbYGdldEVuZG9tb3JwaGlzbU1vbm9pZGBdKC4vZnVuY3Rpb24udHMuaHRtbCNnZXRlbmRvbW9ycGhpc21tb25vaWQpIGlzIHJldmVyc2VkLlxuICpcbiAqIEBjYXRlZ29yeSB6b25lIG9mIGRlYXRoXG4gKiBAc2luY2UgMi4wLjBcbiAqIEBkZXByZWNhdGVkXG4gKi9cbmV4cG9ydCB2YXIgZ2V0RW5kb21vcnBoaXNtTW9ub2lkID0gZnVuY3Rpb24gKCkgeyByZXR1cm4gcmV2ZXJzZShnZXRFTSgpKTsgfTtcbi8qKlxuICogVXNlIFtgTW9ub2lkYF0oLi9zdHJpbmcudHMuaHRtbCNtb25vaWQpIGluc3RlYWQuXG4gKlxuICogQGNhdGVnb3J5IHpvbmUgb2YgZGVhdGhcbiAqIEBzaW5jZSAyLjAuMFxuICogQGRlcHJlY2F0ZWRcbiAqL1xuZXhwb3J0IHZhciBtb25vaWRTdHJpbmcgPSB7XG4gICAgY29uY2F0OiBTZS5zZW1pZ3JvdXBTdHJpbmcuY29uY2F0LFxuICAgIGVtcHR5OiAnJ1xufTtcbi8qKlxuICogVXNlIFtgTW9ub2lkU3VtYF0oLi9udW1iZXIudHMuaHRtbCNtb25vaWRzdW0pIGluc3RlYWQuXG4gKlxuICogQGNhdGVnb3J5IHpvbmUgb2YgZGVhdGhcbiAqIEBzaW5jZSAyLjAuMFxuICogQGRlcHJlY2F0ZWRcbiAqL1xuZXhwb3J0IHZhciBtb25vaWRTdW0gPSB7XG4gICAgY29uY2F0OiBTZS5zZW1pZ3JvdXBTdW0uY29uY2F0LFxuICAgIGVtcHR5OiAwXG59O1xuLyoqXG4gKiBVc2UgW2BNb25vaWRQcm9kdWN0YF0oLi9udW1iZXIudHMuaHRtbCNtb25vaWRwcm9kdWN0KSBpbnN0ZWFkLlxuICpcbiAqIEBjYXRlZ29yeSB6b25lIG9mIGRlYXRoXG4gKiBAc2luY2UgMi4wLjBcbiAqIEBkZXByZWNhdGVkXG4gKi9cbmV4cG9ydCB2YXIgbW9ub2lkUHJvZHVjdCA9IHtcbiAgICBjb25jYXQ6IFNlLnNlbWlncm91cFByb2R1Y3QuY29uY2F0LFxuICAgIGVtcHR5OiAxXG59O1xuIiwKICAiaW1wb3J0IHsgZ2V0TW9ub2lkIGFzIGdldEVNIH0gZnJvbSAnLi9FbmRvbW9ycGhpc20nO1xuaW1wb3J0IHsgZ2V0TW9ub2lkIGFzIGdldEZNIH0gZnJvbSAnLi9mdW5jdGlvbic7XG5pbXBvcnQgKiBhcyBfIGZyb20gJy4vaW50ZXJuYWwnO1xuaW1wb3J0ICogYXMgU2UgZnJvbSAnLi9TZW1pZ3JvdXAnO1xuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLy8gY29uc3RydWN0b3JzXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vKipcbiAqIEdldCBhIG1vbm9pZCB3aGVyZSBgY29uY2F0YCB3aWxsIHJldHVybiB0aGUgbWluaW11bSwgYmFzZWQgb24gdGhlIHByb3ZpZGVkIGJvdW5kZWQgb3JkZXIuXG4gKlxuICogVGhlIGBlbXB0eWAgdmFsdWUgaXMgdGhlIGB0b3BgIHZhbHVlLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgKiBhcyBOIGZyb20gJ2ZwLXRzL251bWJlcidcbiAqIGltcG9ydCAqIGFzIE0gZnJvbSAnZnAtdHMvTW9ub2lkJ1xuICpcbiAqIGNvbnN0IE0xID0gTS5taW4oTi5Cb3VuZGVkKVxuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoTTEuY29uY2F0KDEsIDIpLCAxKVxuICpcbiAqIEBjYXRlZ29yeSBjb25zdHJ1Y3RvcnNcbiAqIEBzaW5jZSAyLjEwLjBcbiAqL1xuZXhwb3J0IHZhciBtaW4gPSBmdW5jdGlvbiAoQikgeyByZXR1cm4gKHtcbiAgICBjb25jYXQ6IFNlLm1pbihCKS5jb25jYXQsXG4gICAgZW1wdHk6IEIudG9wXG59KTsgfTtcbi8qKlxuICogR2V0IGEgbW9ub2lkIHdoZXJlIGBjb25jYXRgIHdpbGwgcmV0dXJuIHRoZSBtYXhpbXVtLCBiYXNlZCBvbiB0aGUgcHJvdmlkZWQgYm91bmRlZCBvcmRlci5cbiAqXG4gKiBUaGUgYGVtcHR5YCB2YWx1ZSBpcyB0aGUgYGJvdHRvbWAgdmFsdWUuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCAqIGFzIE4gZnJvbSAnZnAtdHMvbnVtYmVyJ1xuICogaW1wb3J0ICogYXMgTSBmcm9tICdmcC10cy9Nb25vaWQnXG4gKlxuICogY29uc3QgTTEgPSBNLm1heChOLkJvdW5kZWQpXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChNMS5jb25jYXQoMSwgMiksIDIpXG4gKlxuICogQGNhdGVnb3J5IGNvbnN0cnVjdG9yc1xuICogQHNpbmNlIDIuMTAuMFxuICovXG5leHBvcnQgdmFyIG1heCA9IGZ1bmN0aW9uIChCKSB7IHJldHVybiAoe1xuICAgIGNvbmNhdDogU2UubWF4KEIpLmNvbmNhdCxcbiAgICBlbXB0eTogQi5ib3R0b21cbn0pOyB9O1xuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLy8gY29tYmluYXRvcnNcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8qKlxuICogVGhlIGR1YWwgb2YgYSBgTW9ub2lkYCwgb2J0YWluZWQgYnkgc3dhcHBpbmcgdGhlIGFyZ3VtZW50cyBvZiBgY29uY2F0YC5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgcmV2ZXJzZSB9IGZyb20gJ2ZwLXRzL01vbm9pZCdcbiAqIGltcG9ydCAqIGFzIFMgZnJvbSAnZnAtdHMvc3RyaW5nJ1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwocmV2ZXJzZShTLk1vbm9pZCkuY29uY2F0KCdhJywgJ2InKSwgJ2JhJylcbiAqXG4gKiBAc2luY2UgMi4xMC4wXG4gKi9cbmV4cG9ydCB2YXIgcmV2ZXJzZSA9IGZ1bmN0aW9uIChNKSB7IHJldHVybiAoe1xuICAgIGNvbmNhdDogU2UucmV2ZXJzZShNKS5jb25jYXQsXG4gICAgZW1wdHk6IE0uZW1wdHlcbn0pOyB9O1xuLyoqXG4gKiBHaXZlbiBhIHN0cnVjdCBvZiBtb25vaWRzIHJldHVybnMgYSBtb25vaWQgZm9yIHRoZSBzdHJ1Y3QuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IHN0cnVjdCB9IGZyb20gJ2ZwLXRzL01vbm9pZCdcbiAqIGltcG9ydCAqIGFzIE4gZnJvbSAnZnAtdHMvbnVtYmVyJ1xuICpcbiAqIGludGVyZmFjZSBQb2ludCB7XG4gKiAgIHJlYWRvbmx5IHg6IG51bWJlclxuICogICByZWFkb25seSB5OiBudW1iZXJcbiAqIH1cbiAqXG4gKiBjb25zdCBNID0gc3RydWN0PFBvaW50Pih7XG4gKiAgIHg6IE4uTW9ub2lkU3VtLFxuICogICB5OiBOLk1vbm9pZFN1bVxuICogfSlcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKE0uY29uY2F0KHsgeDogMSwgeTogMiB9LCB7IHg6IDMsIHk6IDQgfSksIHsgeDogNCwgeTogNiB9KVxuICpcbiAqIEBzaW5jZSAyLjEwLjBcbiAqL1xuZXhwb3J0IHZhciBzdHJ1Y3QgPSBmdW5jdGlvbiAobW9ub2lkcykge1xuICAgIHZhciBlbXB0eSA9IHt9O1xuICAgIGZvciAodmFyIGsgaW4gbW9ub2lkcykge1xuICAgICAgICBpZiAoXy5oYXMuY2FsbChtb25vaWRzLCBrKSkge1xuICAgICAgICAgICAgZW1wdHlba10gPSBtb25vaWRzW2tdLmVtcHR5O1xuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiB7XG4gICAgICAgIGNvbmNhdDogU2Uuc3RydWN0KG1vbm9pZHMpLmNvbmNhdCxcbiAgICAgICAgZW1wdHk6IGVtcHR5XG4gICAgfTtcbn07XG4vKipcbiAqIEdpdmVuIGEgdHVwbGUgb2YgbW9ub2lkcyByZXR1cm5zIGEgbW9ub2lkIGZvciB0aGUgdHVwbGUuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IHR1cGxlIH0gZnJvbSAnZnAtdHMvTW9ub2lkJ1xuICogaW1wb3J0ICogYXMgQiBmcm9tICdmcC10cy9ib29sZWFuJ1xuICogaW1wb3J0ICogYXMgTiBmcm9tICdmcC10cy9udW1iZXInXG4gKiBpbXBvcnQgKiBhcyBTIGZyb20gJ2ZwLXRzL3N0cmluZydcbiAqXG4gKiBjb25zdCBNMSA9IHR1cGxlKFMuTW9ub2lkLCBOLk1vbm9pZFN1bSlcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoTTEuY29uY2F0KFsnYScsIDFdLCBbJ2InLCAyXSksIFsnYWInLCAzXSlcbiAqXG4gKiBjb25zdCBNMiA9IHR1cGxlKFMuTW9ub2lkLCBOLk1vbm9pZFN1bSwgQi5Nb25vaWRBbGwpXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKE0yLmNvbmNhdChbJ2EnLCAxLCB0cnVlXSwgWydiJywgMiwgZmFsc2VdKSwgWydhYicsIDMsIGZhbHNlXSlcbiAqXG4gKiBAc2luY2UgMi4xMC4wXG4gKi9cbmV4cG9ydCB2YXIgdHVwbGUgPSBmdW5jdGlvbiAoKSB7XG4gICAgdmFyIG1vbm9pZHMgPSBbXTtcbiAgICBmb3IgKHZhciBfaSA9IDA7IF9pIDwgYXJndW1lbnRzLmxlbmd0aDsgX2krKykge1xuICAgICAgICBtb25vaWRzW19pXSA9IGFyZ3VtZW50c1tfaV07XG4gICAgfVxuICAgIHJldHVybiAoe1xuICAgICAgICBjb25jYXQ6IFNlLnR1cGxlLmFwcGx5KFNlLCBtb25vaWRzKS5jb25jYXQsXG4gICAgICAgIGVtcHR5OiBtb25vaWRzLm1hcChmdW5jdGlvbiAobSkgeyByZXR1cm4gbS5lbXB0eTsgfSlcbiAgICB9KTtcbn07XG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vLyB1dGlsc1xuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLyoqXG4gKiBHaXZlbiBhIHNlcXVlbmNlIG9mIGBhc2AsIGNvbmNhdCB0aGVtIGFuZCByZXR1cm4gdGhlIHRvdGFsLlxuICpcbiAqIElmIGBhc2AgaXMgZW1wdHksIHJldHVybiB0aGUgbW9ub2lkIGBlbXB0eWAgdmFsdWUuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IGNvbmNhdEFsbCB9IGZyb20gJ2ZwLXRzL01vbm9pZCdcbiAqIGltcG9ydCAqIGFzIE4gZnJvbSAnZnAtdHMvbnVtYmVyJ1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoY29uY2F0QWxsKE4uTW9ub2lkU3VtKShbMSwgMiwgM10pLCA2KVxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChjb25jYXRBbGwoTi5Nb25vaWRTdW0pKFtdKSwgMClcbiAqXG4gKiBAc2luY2UgMi4xMC4wXG4gKi9cbmV4cG9ydCB2YXIgY29uY2F0QWxsID0gZnVuY3Rpb24gKE0pIHsgcmV0dXJuIFNlLmNvbmNhdEFsbChNKShNLmVtcHR5KTsgfTtcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8vIGRlcHJlY2F0ZWRcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8qKlxuICogVXNlIFtgTW9ub2lkYF0oLi92b2lkLnRzLmh0bWwjbW9ub2lkKSBpbnN0ZWFkLlxuICpcbiAqIEBjYXRlZ29yeSB6b25lIG9mIGRlYXRoXG4gKiBAc2luY2UgMi4wLjBcbiAqIEBkZXByZWNhdGVkXG4gKi9cbmV4cG9ydCB2YXIgbW9ub2lkVm9pZCA9IHtcbiAgICBjb25jYXQ6IFNlLnNlbWlncm91cFZvaWQuY29uY2F0LFxuICAgIGVtcHR5OiB1bmRlZmluZWRcbn07XG4vKipcbiAqIFVzZSBbYHR1cGxlYF0oI3R1cGxlKSBpbnN0ZWFkLlxuICpcbiAqIEBjYXRlZ29yeSB6b25lIG9mIGRlYXRoXG4gKiBAc2luY2UgMi4wLjBcbiAqIEBkZXByZWNhdGVkXG4gKi9cbmV4cG9ydCB2YXIgZ2V0VHVwbGVNb25vaWQgPSB0dXBsZTtcbi8qKlxuICogVXNlIFtgc3RydWN0YF0oI3N0cnVjdCkgaW5zdGVhZC5cbiAqXG4gKiBAY2F0ZWdvcnkgem9uZSBvZiBkZWF0aFxuICogQHNpbmNlIDIuMC4wXG4gKiBAZGVwcmVjYXRlZFxuICovXG5leHBvcnQgdmFyIGdldFN0cnVjdE1vbm9pZCA9IHN0cnVjdDtcbi8qKlxuICogVXNlIFtgcmV2ZXJzZWBdKCNyZXZlcnNlKSBpbnN0ZWFkLlxuICpcbiAqIEBjYXRlZ29yeSB6b25lIG9mIGRlYXRoXG4gKiBAc2luY2UgMi4wLjBcbiAqIEBkZXByZWNhdGVkXG4gKi9cbmV4cG9ydCB2YXIgZ2V0RHVhbE1vbm9pZCA9IHJldmVyc2U7XG4vKipcbiAqIFVzZSBbYG1heGBdKCNtYXgpIGluc3RlYWQuXG4gKlxuICogQGNhdGVnb3J5IHpvbmUgb2YgZGVhdGhcbiAqIEBzaW5jZSAyLjAuMFxuICogQGRlcHJlY2F0ZWRcbiAqL1xuZXhwb3J0IHZhciBnZXRKb2luTW9ub2lkID0gbWF4O1xuLyoqXG4gKiBVc2UgW2BtaW5gXSgjbWluKSBpbnN0ZWFkLlxuICpcbiAqIEBjYXRlZ29yeSB6b25lIG9mIGRlYXRoXG4gKiBAc2luY2UgMi4wLjBcbiAqIEBkZXByZWNhdGVkXG4gKi9cbmV4cG9ydCB2YXIgZ2V0TWVldE1vbm9pZCA9IG1pbjtcbi8qKlxuICogVXNlIFtgY29uY2F0QWxsYF0oI2NvbmNhdGFsbCkgaW5zdGVhZC5cbiAqXG4gKiBAY2F0ZWdvcnkgem9uZSBvZiBkZWF0aFxuICogQHNpbmNlIDIuMC4wXG4gKiBAZGVwcmVjYXRlZFxuICovXG5leHBvcnQgdmFyIGZvbGQgPSBjb25jYXRBbGw7XG4vKipcbiAqIFVzZSBbYE1vbm9pZEFsbGBdKC4vYm9vbGVhbi50cy5odG1sI21vbm9pZGFsbCkgaW5zdGVhZC5cbiAqXG4gKiBAY2F0ZWdvcnkgem9uZSBvZiBkZWF0aFxuICogQHNpbmNlIDIuMC4wXG4gKiBAZGVwcmVjYXRlZFxuICovXG5leHBvcnQgdmFyIG1vbm9pZEFsbCA9IHtcbiAgICBjb25jYXQ6IFNlLnNlbWlncm91cEFsbC5jb25jYXQsXG4gICAgZW1wdHk6IHRydWVcbn07XG4vKipcbiAqIFVzZSBbYE1vbm9pZEFueWBdKC4vYm9vbGVhbi50cy5odG1sI21vbm9pZGFueSkgaW5zdGVhZC5cbiAqXG4gKiBAY2F0ZWdvcnkgem9uZSBvZiBkZWF0aFxuICogQHNpbmNlIDIuMC4wXG4gKiBAZGVwcmVjYXRlZFxuICovXG5leHBvcnQgdmFyIG1vbm9pZEFueSA9IHtcbiAgICBjb25jYXQ6IFNlLnNlbWlncm91cEFueS5jb25jYXQsXG4gICAgZW1wdHk6IGZhbHNlXG59O1xuLyoqXG4gKiBVc2UgW2BnZXRNb25vaWRgXSguL2Z1bmN0aW9uLnRzLmh0bWwjZ2V0bW9ub2lkKSBpbnN0ZWFkLlxuICpcbiAqIEBjYXRlZ29yeSB6b25lIG9mIGRlYXRoXG4gKiBAc2luY2UgMi4wLjBcbiAqIEBkZXByZWNhdGVkXG4gKi9cbmV4cG9ydCB2YXIgZ2V0RnVuY3Rpb25Nb25vaWQgPSBnZXRGTTtcbi8qKlxuICogVXNlIFtgZ2V0RW5kb21vcnBoaXNtTW9ub2lkYF0oLi9mdW5jdGlvbi50cy5odG1sI2dldGVuZG9tb3JwaGlzbW1vbm9pZCkgaW5zdGVhZC5cbiAqXG4gKiAqKk5vdGUqKi4gVGhlIGV4ZWN1dGlvbiBvcmRlciBpbiBbYGdldEVuZG9tb3JwaGlzbU1vbm9pZGBdKC4vZnVuY3Rpb24udHMuaHRtbCNnZXRlbmRvbW9ycGhpc21tb25vaWQpIGlzIHJldmVyc2VkLlxuICpcbiAqIEBjYXRlZ29yeSB6b25lIG9mIGRlYXRoXG4gKiBAc2luY2UgMi4wLjBcbiAqIEBkZXByZWNhdGVkXG4gKi9cbmV4cG9ydCB2YXIgZ2V0RW5kb21vcnBoaXNtTW9ub2lkID0gZnVuY3Rpb24gKCkgeyByZXR1cm4gcmV2ZXJzZShnZXRFTSgpKTsgfTtcbi8qKlxuICogVXNlIFtgTW9ub2lkYF0oLi9zdHJpbmcudHMuaHRtbCNtb25vaWQpIGluc3RlYWQuXG4gKlxuICogQGNhdGVnb3J5IHpvbmUgb2YgZGVhdGhcbiAqIEBzaW5jZSAyLjAuMFxuICogQGRlcHJlY2F0ZWRcbiAqL1xuZXhwb3J0IHZhciBtb25vaWRTdHJpbmcgPSB7XG4gICAgY29uY2F0OiBTZS5zZW1pZ3JvdXBTdHJpbmcuY29uY2F0LFxuICAgIGVtcHR5OiAnJ1xufTtcbi8qKlxuICogVXNlIFtgTW9ub2lkU3VtYF0oLi9udW1iZXIudHMuaHRtbCNtb25vaWRzdW0pIGluc3RlYWQuXG4gKlxuICogQGNhdGVnb3J5IHpvbmUgb2YgZGVhdGhcbiAqIEBzaW5jZSAyLjAuMFxuICogQGRlcHJlY2F0ZWRcbiAqL1xuZXhwb3J0IHZhciBtb25vaWRTdW0gPSB7XG4gICAgY29uY2F0OiBTZS5zZW1pZ3JvdXBTdW0uY29uY2F0LFxuICAgIGVtcHR5OiAwXG59O1xuLyoqXG4gKiBVc2UgW2BNb25vaWRQcm9kdWN0YF0oLi9udW1iZXIudHMuaHRtbCNtb25vaWRwcm9kdWN0KSBpbnN0ZWFkLlxuICpcbiAqIEBjYXRlZ29yeSB6b25lIG9mIGRlYXRoXG4gKiBAc2luY2UgMi4wLjBcbiAqIEBkZXByZWNhdGVkXG4gKi9cbmV4cG9ydCB2YXIgbW9ub2lkUHJvZHVjdCA9IHtcbiAgICBjb25jYXQ6IFNlLnNlbWlncm91cFByb2R1Y3QuY29uY2F0LFxuICAgIGVtcHR5OiAxXG59O1xuIiwKICAiaW1wb3J0IHsgZ2V0TW9ub2lkIGFzIGdldEVNIH0gZnJvbSAnLi9FbmRvbW9ycGhpc20nO1xuaW1wb3J0IHsgZ2V0TW9ub2lkIGFzIGdldEZNIH0gZnJvbSAnLi9mdW5jdGlvbic7XG5pbXBvcnQgKiBhcyBfIGZyb20gJy4vaW50ZXJuYWwnO1xuaW1wb3J0ICogYXMgU2UgZnJvbSAnLi9TZW1pZ3JvdXAnO1xuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLy8gY29uc3RydWN0b3JzXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vKipcbiAqIEdldCBhIG1vbm9pZCB3aGVyZSBgY29uY2F0YCB3aWxsIHJldHVybiB0aGUgbWluaW11bSwgYmFzZWQgb24gdGhlIHByb3ZpZGVkIGJvdW5kZWQgb3JkZXIuXG4gKlxuICogVGhlIGBlbXB0eWAgdmFsdWUgaXMgdGhlIGB0b3BgIHZhbHVlLlxuICpcbiAqIEBleGFtcGxlXG4gKiBpbXBvcnQgKiBhcyBOIGZyb20gJ2ZwLXRzL251bWJlcidcbiAqIGltcG9ydCAqIGFzIE0gZnJvbSAnZnAtdHMvTW9ub2lkJ1xuICpcbiAqIGNvbnN0IE0xID0gTS5taW4oTi5Cb3VuZGVkKVxuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoTTEuY29uY2F0KDEsIDIpLCAxKVxuICpcbiAqIEBjYXRlZ29yeSBjb25zdHJ1Y3RvcnNcbiAqIEBzaW5jZSAyLjEwLjBcbiAqL1xuZXhwb3J0IHZhciBtaW4gPSBmdW5jdGlvbiAoQikgeyByZXR1cm4gKHtcbiAgICBjb25jYXQ6IFNlLm1pbihCKS5jb25jYXQsXG4gICAgZW1wdHk6IEIudG9wXG59KTsgfTtcbi8qKlxuICogR2V0IGEgbW9ub2lkIHdoZXJlIGBjb25jYXRgIHdpbGwgcmV0dXJuIHRoZSBtYXhpbXVtLCBiYXNlZCBvbiB0aGUgcHJvdmlkZWQgYm91bmRlZCBvcmRlci5cbiAqXG4gKiBUaGUgYGVtcHR5YCB2YWx1ZSBpcyB0aGUgYGJvdHRvbWAgdmFsdWUuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCAqIGFzIE4gZnJvbSAnZnAtdHMvbnVtYmVyJ1xuICogaW1wb3J0ICogYXMgTSBmcm9tICdmcC10cy9Nb25vaWQnXG4gKlxuICogY29uc3QgTTEgPSBNLm1heChOLkJvdW5kZWQpXG4gKlxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChNMS5jb25jYXQoMSwgMiksIDIpXG4gKlxuICogQGNhdGVnb3J5IGNvbnN0cnVjdG9yc1xuICogQHNpbmNlIDIuMTAuMFxuICovXG5leHBvcnQgdmFyIG1heCA9IGZ1bmN0aW9uIChCKSB7IHJldHVybiAoe1xuICAgIGNvbmNhdDogU2UubWF4KEIpLmNvbmNhdCxcbiAgICBlbXB0eTogQi5ib3R0b21cbn0pOyB9O1xuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLy8gY29tYmluYXRvcnNcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8qKlxuICogVGhlIGR1YWwgb2YgYSBgTW9ub2lkYCwgb2J0YWluZWQgYnkgc3dhcHBpbmcgdGhlIGFyZ3VtZW50cyBvZiBgY29uY2F0YC5cbiAqXG4gKiBAZXhhbXBsZVxuICogaW1wb3J0IHsgcmV2ZXJzZSB9IGZyb20gJ2ZwLXRzL01vbm9pZCdcbiAqIGltcG9ydCAqIGFzIFMgZnJvbSAnZnAtdHMvc3RyaW5nJ1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwocmV2ZXJzZShTLk1vbm9pZCkuY29uY2F0KCdhJywgJ2InKSwgJ2JhJylcbiAqXG4gKiBAc2luY2UgMi4xMC4wXG4gKi9cbmV4cG9ydCB2YXIgcmV2ZXJzZSA9IGZ1bmN0aW9uIChNKSB7IHJldHVybiAoe1xuICAgIGNvbmNhdDogU2UucmV2ZXJzZShNKS5jb25jYXQsXG4gICAgZW1wdHk6IE0uZW1wdHlcbn0pOyB9O1xuLyoqXG4gKiBHaXZlbiBhIHN0cnVjdCBvZiBtb25vaWRzIHJldHVybnMgYSBtb25vaWQgZm9yIHRoZSBzdHJ1Y3QuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IHN0cnVjdCB9IGZyb20gJ2ZwLXRzL01vbm9pZCdcbiAqIGltcG9ydCAqIGFzIE4gZnJvbSAnZnAtdHMvbnVtYmVyJ1xuICpcbiAqIGludGVyZmFjZSBQb2ludCB7XG4gKiAgIHJlYWRvbmx5IHg6IG51bWJlclxuICogICByZWFkb25seSB5OiBudW1iZXJcbiAqIH1cbiAqXG4gKiBjb25zdCBNID0gc3RydWN0PFBvaW50Pih7XG4gKiAgIHg6IE4uTW9ub2lkU3VtLFxuICogICB5OiBOLk1vbm9pZFN1bVxuICogfSlcbiAqXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKE0uY29uY2F0KHsgeDogMSwgeTogMiB9LCB7IHg6IDMsIHk6IDQgfSksIHsgeDogNCwgeTogNiB9KVxuICpcbiAqIEBzaW5jZSAyLjEwLjBcbiAqL1xuZXhwb3J0IHZhciBzdHJ1Y3QgPSBmdW5jdGlvbiAobW9ub2lkcykge1xuICAgIHZhciBlbXB0eSA9IHt9O1xuICAgIGZvciAodmFyIGsgaW4gbW9ub2lkcykge1xuICAgICAgICBpZiAoXy5oYXMuY2FsbChtb25vaWRzLCBrKSkge1xuICAgICAgICAgICAgZW1wdHlba10gPSBtb25vaWRzW2tdLmVtcHR5O1xuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiB7XG4gICAgICAgIGNvbmNhdDogU2Uuc3RydWN0KG1vbm9pZHMpLmNvbmNhdCxcbiAgICAgICAgZW1wdHk6IGVtcHR5XG4gICAgfTtcbn07XG4vKipcbiAqIEdpdmVuIGEgdHVwbGUgb2YgbW9ub2lkcyByZXR1cm5zIGEgbW9ub2lkIGZvciB0aGUgdHVwbGUuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IHR1cGxlIH0gZnJvbSAnZnAtdHMvTW9ub2lkJ1xuICogaW1wb3J0ICogYXMgQiBmcm9tICdmcC10cy9ib29sZWFuJ1xuICogaW1wb3J0ICogYXMgTiBmcm9tICdmcC10cy9udW1iZXInXG4gKiBpbXBvcnQgKiBhcyBTIGZyb20gJ2ZwLXRzL3N0cmluZydcbiAqXG4gKiBjb25zdCBNMSA9IHR1cGxlKFMuTW9ub2lkLCBOLk1vbm9pZFN1bSlcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoTTEuY29uY2F0KFsnYScsIDFdLCBbJ2InLCAyXSksIFsnYWInLCAzXSlcbiAqXG4gKiBjb25zdCBNMiA9IHR1cGxlKFMuTW9ub2lkLCBOLk1vbm9pZFN1bSwgQi5Nb25vaWRBbGwpXG4gKiBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKE0yLmNvbmNhdChbJ2EnLCAxLCB0cnVlXSwgWydiJywgMiwgZmFsc2VdKSwgWydhYicsIDMsIGZhbHNlXSlcbiAqXG4gKiBAc2luY2UgMi4xMC4wXG4gKi9cbmV4cG9ydCB2YXIgdHVwbGUgPSBmdW5jdGlvbiAoKSB7XG4gICAgdmFyIG1vbm9pZHMgPSBbXTtcbiAgICBmb3IgKHZhciBfaSA9IDA7IF9pIDwgYXJndW1lbnRzLmxlbmd0aDsgX2krKykge1xuICAgICAgICBtb25vaWRzW19pXSA9IGFyZ3VtZW50c1tfaV07XG4gICAgfVxuICAgIHJldHVybiAoe1xuICAgICAgICBjb25jYXQ6IFNlLnR1cGxlLmFwcGx5KFNlLCBtb25vaWRzKS5jb25jYXQsXG4gICAgICAgIGVtcHR5OiBtb25vaWRzLm1hcChmdW5jdGlvbiAobSkgeyByZXR1cm4gbS5lbXB0eTsgfSlcbiAgICB9KTtcbn07XG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vLyB1dGlsc1xuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLyoqXG4gKiBHaXZlbiBhIHNlcXVlbmNlIG9mIGBhc2AsIGNvbmNhdCB0aGVtIGFuZCByZXR1cm4gdGhlIHRvdGFsLlxuICpcbiAqIElmIGBhc2AgaXMgZW1wdHksIHJldHVybiB0aGUgbW9ub2lkIGBlbXB0eWAgdmFsdWUuXG4gKlxuICogQGV4YW1wbGVcbiAqIGltcG9ydCB7IGNvbmNhdEFsbCB9IGZyb20gJ2ZwLXRzL01vbm9pZCdcbiAqIGltcG9ydCAqIGFzIE4gZnJvbSAnZnAtdHMvbnVtYmVyJ1xuICpcbiAqIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoY29uY2F0QWxsKE4uTW9ub2lkU3VtKShbMSwgMiwgM10pLCA2KVxuICogYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChjb25jYXRBbGwoTi5Nb25vaWRTdW0pKFtdKSwgMClcbiAqXG4gKiBAc2luY2UgMi4xMC4wXG4gKi9cbmV4cG9ydCB2YXIgY29uY2F0QWxsID0gZnVuY3Rpb24gKE0pIHsgcmV0dXJuIFNlLmNvbmNhdEFsbChNKShNLmVtcHR5KTsgfTtcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8vIGRlcHJlY2F0ZWRcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8qKlxuICogVXNlIFtgTW9ub2lkYF0oLi92b2lkLnRzLmh0bWwjbW9ub2lkKSBpbnN0ZWFkLlxuICpcbiAqIEBjYXRlZ29yeSB6b25lIG9mIGRlYXRoXG4gKiBAc2luY2UgMi4wLjBcbiAqIEBkZXByZWNhdGVkXG4gKi9cbmV4cG9ydCB2YXIgbW9ub2lkVm9pZCA9IHtcbiAgICBjb25jYXQ6IFNlLnNlbWlncm91cFZvaWQuY29uY2F0LFxuICAgIGVtcHR5OiB1bmRlZmluZWRcbn07XG4vKipcbiAqIFVzZSBbYHR1cGxlYF0oI3R1cGxlKSBpbnN0ZWFkLlxuICpcbiAqIEBjYXRlZ29yeSB6b25lIG9mIGRlYXRoXG4gKiBAc2luY2UgMi4wLjBcbiAqIEBkZXByZWNhdGVkXG4gKi9cbmV4cG9ydCB2YXIgZ2V0VHVwbGVNb25vaWQgPSB0dXBsZTtcbi8qKlxuICogVXNlIFtgc3RydWN0YF0oI3N0cnVjdCkgaW5zdGVhZC5cbiAqXG4gKiBAY2F0ZWdvcnkgem9uZSBvZiBkZWF0aFxuICogQHNpbmNlIDIuMC4wXG4gKiBAZGVwcmVjYXRlZFxuICovXG5leHBvcnQgdmFyIGdldFN0cnVjdE1vbm9pZCA9IHN0cnVjdDtcbi8qKlxuICogVXNlIFtgcmV2ZXJzZWBdKCNyZXZlcnNlKSBpbnN0ZWFkLlxuICpcbiAqIEBjYXRlZ29yeSB6b25lIG9mIGRlYXRoXG4gKiBAc2luY2UgMi4wLjBcbiAqIEBkZXByZWNhdGVkXG4gKi9cbmV4cG9ydCB2YXIgZ2V0RHVhbE1vbm9pZCA9IHJldmVyc2U7XG4vKipcbiAqIFVzZSBbYG1heGBdKCNtYXgpIGluc3RlYWQuXG4gKlxuICogQGNhdGVnb3J5IHpvbmUgb2YgZGVhdGhcbiAqIEBzaW5jZSAyLjAuMFxuICogQGRlcHJlY2F0ZWRcbiAqL1xuZXhwb3J0IHZhciBnZXRKb2luTW9ub2lkID0gbWF4O1xuLyoqXG4gKiBVc2UgW2BtaW5gXSgjbWluKSBpbnN0ZWFkLlxuICpcbiAqIEBjYXRlZ29yeSB6b25lIG9mIGRlYXRoXG4gKiBAc2luY2UgMi4wLjBcbiAqIEBkZXByZWNhdGVkXG4gKi9cbmV4cG9ydCB2YXIgZ2V0TWVldE1vbm9pZCA9IG1pbjtcbi8qKlxuICogVXNlIFtgY29uY2F0QWxsYF0oI2NvbmNhdGFsbCkgaW5zdGVhZC5cbiAqXG4gKiBAY2F0ZWdvcnkgem9uZSBvZiBkZWF0aFxuICogQHNpbmNlIDIuMC4wXG4gKiBAZGVwcmVjYXRlZFxuICovXG5leHBvcnQgdmFyIGZvbGQgPSBjb25jYXRBbGw7XG4vKipcbiAqIFVzZSBbYE1vbm9pZEFsbGBdKC4vYm9vbGVhbi50cy5odG1sI21vbm9pZGFsbCkgaW5zdGVhZC5cbiAqXG4gKiBAY2F0ZWdvcnkgem9uZSBvZiBkZWF0aFxuICogQHNpbmNlIDIuMC4wXG4gKiBAZGVwcmVjYXRlZFxuICovXG5leHBvcnQgdmFyIG1vbm9pZEFsbCA9IHtcbiAgICBjb25jYXQ6IFNlLnNlbWlncm91cEFsbC5jb25jYXQsXG4gICAgZW1wdHk6IHRydWVcbn07XG4vKipcbiAqIFVzZSBbYE1vbm9pZEFueWBdKC4vYm9vbGVhbi50cy5odG1sI21vbm9pZGFueSkgaW5zdGVhZC5cbiAqXG4gKiBAY2F0ZWdvcnkgem9uZSBvZiBkZWF0aFxuICogQHNpbmNlIDIuMC4wXG4gKiBAZGVwcmVjYXRlZFxuICovXG5leHBvcnQgdmFyIG1vbm9pZEFueSA9IHtcbiAgICBjb25jYXQ6IFNlLnNlbWlncm91cEFueS5jb25jYXQsXG4gICAgZW1wdHk6IGZhbHNlXG59O1xuLyoqXG4gKiBVc2UgW2BnZXRNb25vaWRgXSguL2Z1bmN0aW9uLnRzLmh0bWwjZ2V0bW9ub2lkKSBpbnN0ZWFkLlxuICpcbiAqIEBjYXRlZ29yeSB6b25lIG9mIGRlYXRoXG4gKiBAc2luY2UgMi4wLjBcbiAqIEBkZXByZWNhdGVkXG4gKi9cbmV4cG9ydCB2YXIgZ2V0RnVuY3Rpb25Nb25vaWQgPSBnZXRGTTtcbi8qKlxuICogVXNlIFtgZ2V0RW5kb21vcnBoaXNtTW9ub2lkYF0oLi9mdW5jdGlvbi50cy5odG1sI2dldGVuZG9tb3JwaGlzbW1vbm9pZCkgaW5zdGVhZC5cbiAqXG4gKiAqKk5vdGUqKi4gVGhlIGV4ZWN1dGlvbiBvcmRlciBpbiBbYGdldEVuZG9tb3JwaGlzbU1vbm9pZGBdKC4vZnVuY3Rpb24udHMuaHRtbCNnZXRlbmRvbW9ycGhpc21tb25vaWQpIGlzIHJldmVyc2VkLlxuICpcbiAqIEBjYXRlZ29yeSB6b25lIG9mIGRlYXRoXG4gKiBAc2luY2UgMi4wLjBcbiAqIEBkZXByZWNhdGVkXG4gKi9cbmV4cG9ydCB2YXIgZ2V0RW5kb21vcnBoaXNtTW9ub2lkID0gZnVuY3Rpb24gKCkgeyByZXR1cm4gcmV2ZXJzZShnZXRFTSgpKTsgfTtcbi8qKlxuICogVXNlIFtgTW9ub2lkYF0oLi9zdHJpbmcudHMuaHRtbCNtb25vaWQpIGluc3RlYWQuXG4gKlxuICogQGNhdGVnb3J5IHpvbmUgb2YgZGVhdGhcbiAqIEBzaW5jZSAyLjAuMFxuICogQGRlcHJlY2F0ZWRcbiAqL1xuZXhwb3J0IHZhciBtb25vaWRTdHJpbmcgPSB7XG4gICAgY29uY2F0OiBTZS5zZW1pZ3JvdXBTdHJpbmcuY29uY2F0LFxuICAgIGVtcHR5OiAnJ1xufTtcbi8qKlxuICogVXNlIFtgTW9ub2lkU3VtYF0oLi9udW1iZXIudHMuaHRtbCNtb25vaWRzdW0pIGluc3RlYWQuXG4gKlxuICogQGNhdGVnb3J5IHpvbmUgb2YgZGVhdGhcbiAqIEBzaW5jZSAyLjAuMFxuICogQGRlcHJlY2F0ZWRcbiAqL1xuZXhwb3J0IHZhciBtb25vaWRTdW0gPSB7XG4gICAgY29uY2F0OiBTZS5zZW1pZ3JvdXBTdW0uY29uY2F0LFxuICAgIGVtcHR5OiAwXG59O1xuLyoqXG4gKiBVc2UgW2BNb25vaWRQcm9kdWN0YF0oLi9udW1iZXIudHMuaHRtbCNtb25vaWRwcm9kdWN0KSBpbnN0ZWFkLlxuICpcbiAqIEBjYXRlZ29yeSB6b25lIG9mIGRlYXRoXG4gKiBAc2luY2UgMi4wLjBcbiAqIEBkZXByZWNhdGVkXG4gKi9cbmV4cG9ydCB2YXIgbW9ub2lkUHJvZHVjdCA9IHtcbiAgICBjb25jYXQ6IFNlLnNlbWlncm91cFByb2R1Y3QuY29uY2F0LFxuICAgIGVtcHR5OiAxXG59O1xuIiwKICAiaW1wb3J0ICogYXMgTyBmcm9tIFwiZnAtdHMvT3B0aW9uXCI7XG5pbXBvcnQgKiBhcyBNIGZyb20gXCJmcC10cy9NYXBcIjtcbmltcG9ydCAqIGFzIEEgZnJvbSBcImZwLXRzL0FycmF5XCI7XG5pbXBvcnQgeyBmbG93LCBwaXBlLCBnZXRNb25vaWQgYXMgZ2V0RnVuY3Rpb25Nb25vaWQsIGFwcGx5LCBjb25zdGFudCwgZmxpcCwgdHVwbGVkLCB9IGZyb20gXCJmcC10cy9mdW5jdGlvblwiO1xuaW1wb3J0IHsgbm90IH0gZnJvbSBcImZwLXRzL1ByZWRpY2F0ZVwiO1xuaW1wb3J0IHsgZ2V0TW9ub2lkIGFzIGdldEVuZG9Nb25vaWQgfSBmcm9tIFwiZnAtdHMvRW5kb21vcnBoaXNtXCI7XG5pbXBvcnQgeyBjb25jYXRBbGwgfSBmcm9tIFwiZnAtdHMvTW9ub2lkXCI7XG5pbXBvcnQgeyBmaXJzdCB9IGZyb20gXCJmcC10cy9TZW1pZ3JvdXBcIjtcbmltcG9ydCB7IGJpbmRUbyBhcyBiaW5kVG9fLCBsZXQgYXMgbGV0X18gfSBmcm9tIFwiZnAtdHMvRnVuY3RvclwiO1xuaW1wb3J0IHsgYXBGaXJzdCBhcyBhcEZpcnN0XywgYXBTZWNvbmQgYXMgYXBTZWNvbmRfLCBhcFMgYXMgYXBTXywgfSBmcm9tIFwiZnAtdHMvQXBwbHlcIjtcbmltcG9ydCB7IGJpbmQgYXMgYmluZF8gfSBmcm9tIFwiZnAtdHMvQ2hhaW5cIjtcbmV4cG9ydCBjb25zdCBVUkkgPSBcIkZ1bmN0aW9uXCI7XG5leHBvcnQgY29uc3QgbWFwID0gZiA9PiBnID0+IGZsb3coZywgZik7XG5leHBvcnQgY29uc3QgRnVuY3RvciA9IHtcbiAgICBVUkksXG4gICAgbWFwOiAoZiwgZykgPT4gbWFwKGcpKGYpLFxufTtcbmV4cG9ydCBjb25zdCBvZiA9IGNvbnN0YW50O1xuZXhwb3J0IGNvbnN0IGFwID0gZiA9PiBnID0+IHggPT4gZyh4KShmKHgpKTtcbmV4cG9ydCBjb25zdCBBcHBsaWNhdGl2ZSA9IHtcbiAgICAuLi5GdW5jdG9yLFxuICAgIG9mLFxuICAgIGFwOiAoZiwgZykgPT4gYXAoZykoZiksXG59O1xuZXhwb3J0IGNvbnN0IGFwRmlyc3QgPSBhcEZpcnN0XyhBcHBsaWNhdGl2ZSk7XG5leHBvcnQgY29uc3QgYXBTZWNvbmQgPSBhcFNlY29uZF8oQXBwbGljYXRpdmUpO1xuZXhwb3J0IGNvbnN0IGNoYWluID0gZiA9PiBnID0+IHggPT4gZihnKHgpKSh4KTtcbmV4cG9ydCBjb25zdCBmbGF0TWFwID0gY2hhaW47XG5leHBvcnQgY29uc3QgTW9uYWQgPSB7XG4gICAgLi4uQXBwbGljYXRpdmUsXG4gICAgY2hhaW46IChmLCBnKSA9PiBjaGFpbihnKShmKSxcbn07XG5leHBvcnQgY29uc3QgRG8gPSBvZih7fSk7XG5leHBvcnQgY29uc3QgYmluZFRvID0gYmluZFRvXyhGdW5jdG9yKTtcbmV4cG9ydCBjb25zdCBiaW5kID0gYmluZF8oTW9uYWQpO1xuZXhwb3J0IGNvbnN0IGFwUyA9IGFwU18oQXBwbGljYXRpdmUpO1xuY29uc3QgbGV0XyA9IGxldF9fKEZ1bmN0b3IpO1xuZXhwb3J0IHsgbGV0XyBhcyBsZXQsIH07XG5leHBvcnQgY29uc3Qgd2l0aEluZGV4ID0gZiA9PiBnID0+IHhzID0+IHtcbiAgICBsZXQgaSA9IDA7XG4gICAgcmV0dXJuIGYoeSA9PiBnKGkrKykoeSkpKHhzKTtcbn07XG5leHBvcnQgY29uc3QgdW5hcnkgPSB0dXBsZWQ7XG5leHBvcnQgY29uc3QgZ3VhcmQgPSAoYnJhbmNoZXMpID0+IChmYWxsYmFjaykgPT4gKGlucHV0KSA9PiBwaXBlKGJyYW5jaGVzLCBBLm1hcCgoW2YsIGddKSA9PiBmbG93KE8uZnJvbVByZWRpY2F0ZShmKSwgTy5tYXAoZykpKSwgY29uY2F0QWxsKGdldEZ1bmN0aW9uTW9ub2lkKE8uZ2V0TW9ub2lkKGZpcnN0KCkpKSgpKSwgYXBwbHkoaW5wdXQpLCBPLmdldE9yRWxzZSgoKSA9PiBmYWxsYmFjayhpbnB1dCkpKTtcbmV4cG9ydCBjb25zdCBpZkVsc2UgPSAob25UcnVlKSA9PiAob25GYWxzZSkgPT4gKGYpID0+ICh4KSA9PiBmKHgpID8gb25UcnVlKHgpIDogb25GYWxzZSh4KTtcbmV4cG9ydCBjb25zdCB1bmxlc3MgPSAoZikgPT4gKG9uRmFsc2UpID0+IHggPT4gZih4KSA/IHggOiBvbkZhbHNlKHgpO1xuZXhwb3J0IGNvbnN0IHdoZW4gPSBmbG93KG5vdCwgdW5sZXNzKTtcbmV4cG9ydCBjb25zdCB1bnRpbCA9IChmKSA9PiAoZykgPT4ge1xuICAgIGNvbnN0IGggPSB4ID0+IChmKHgpID8geCA6IGgoZyh4KSkpO1xuICAgIHJldHVybiBoO1xufTtcbmV4cG9ydCBjb25zdCBjb25zdHJ1Y3QgPSAoeCkgPT4gKHhzKSA9PiBuZXcgeCguLi54cyk7XG5leHBvcnQgY29uc3QgaW52b2tlID0gKHgpID0+ICh5cykgPT4gKHopID0+IHpbeF0oLi4ueXMpO1xuZXhwb3J0IGNvbnN0IGludm9rZU51bGxhcnkgPSBmbGlwKGludm9rZSkoW10pO1xuZXhwb3J0IGNvbnN0IGludm9rZU9uID0gKCkgPT4gKHgpID0+IHlzID0+IHogPT4gelt4XSguLi55cyk7XG5leHBvcnQgY29uc3QgbWVtb2l6ZSA9IChlcSkgPT4gKGYpID0+IHtcbiAgICBjb25zdCBjYWNoZSA9IG5ldyBNYXAoKTtcbiAgICByZXR1cm4gayA9PiB7XG4gICAgICAgIGNvbnN0IGNhY2hlZCA9IE0ubG9va3VwKGVxKShrKShjYWNoZSk7XG4gICAgICAgIGlmIChPLmlzU29tZShjYWNoZWQpKVxuICAgICAgICAgICAgcmV0dXJuIGNhY2hlZC52YWx1ZTtcbiAgICAgICAgY29uc3QgdmFsID0gZihrKTtcbiAgICAgICAgY2FjaGUuc2V0KGssIHZhbCk7XG4gICAgICAgIHJldHVybiB2YWw7XG4gICAgfTtcbn07XG5leHBvcnQgY29uc3QgY3VycnkyVCA9IChmKSA9PiAoYSkgPT4gKGIpID0+IGYoW2EsIGJdKTtcbmV4cG9ydCBjb25zdCBjdXJyeTIgPSBmbG93KHVuYXJ5LCBjdXJyeTJUKTtcbmV4cG9ydCBjb25zdCBjdXJyeTNUID0gKGYpID0+IChhKSA9PiAoYikgPT4gKGMpID0+IGYoW2EsIGIsIGNdKTtcbmV4cG9ydCBjb25zdCBjdXJyeTMgPSBmbG93KHVuYXJ5LCBjdXJyeTNUKTtcbmV4cG9ydCBjb25zdCBjdXJyeTRUID0gKGYpID0+IChhKSA9PiAoYikgPT4gKGMpID0+IChkKSA9PiBmKFthLCBiLCBjLCBkXSk7XG5leHBvcnQgY29uc3QgY3Vycnk0ID0gZmxvdyh1bmFyeSwgY3Vycnk0VCk7XG5leHBvcnQgY29uc3QgY3Vycnk1VCA9IChmKSA9PiAoYSkgPT4gKGIpID0+IChjKSA9PiAoZCkgPT4gKGUpID0+IGYoW2EsIGIsIGMsIGQsIGVdKTtcbmV4cG9ydCBjb25zdCBjdXJyeTUgPSBmbG93KHVuYXJ5LCBjdXJyeTVUKTtcbmV4cG9ydCBjb25zdCB1bmN1cnJ5MiA9IChmKSA9PiAoW2EsIGJdKSA9PiBmKGEpKGIpO1xuZXhwb3J0IGNvbnN0IHVuY3VycnkzID0gKGYpID0+IChbYSwgYiwgY10pID0+IGYoYSkoYikoYyk7XG5leHBvcnQgY29uc3QgdW5jdXJyeTQgPSAoZikgPT4gKFthLCBiLCBjLCBkXSkgPT4gZihhKShiKShjKShkKTtcbmV4cG9ydCBjb25zdCB1bmN1cnJ5NSA9IChmKSA9PiAoW2EsIGIsIGMsIGQsIGVdKSA9PiBmKGEpKGIpKGMpKGQpKGUpO1xuZXhwb3J0IGZ1bmN0aW9uIGZvcmsoZnMpIHtcbiAgICByZXR1cm4gKHgpID0+IGZzLm1hcChmID0+IGYoeCkpO1xufVxuZXhwb3J0IGNvbnN0IGNvbnZlcmdlID0gKGYpID0+IChncykgPT4gZmxvdyh4ID0+IGZvcmsoZ3MpKHgpLCBmKTtcbmV4cG9ydCBjb25zdCBpc0luc3RhbmNlT2YgPSAoeCkgPT4gKHkpID0+IHkgaW5zdGFuY2VvZiB4O1xuZXhwb3J0IGNvbnN0IGFwcGx5RXZlcnkgPSBjb25jYXRBbGwoZ2V0RW5kb01vbm9pZCgpKTtcbmV4cG9ydCBjb25zdCBhcHBseVNvbWVzID0gKGZzKSA9PiB4ID0+IHBpcGUoZnMsIEEucmVkdWNlKHgsICh5LCBtZikgPT4gcGlwZShtZiwgTy5tYXRjaChjb25zdGFudCh5KSwgYXBwbHkoeSkpKSkpO1xuZXhwb3J0IGNvbnN0IGFwcGx5TiA9IChuKSA9PiAoZikgPT4gcGlwZShBLnJlcGxpY2F0ZShuLCBmKSwgYXBwbHlFdmVyeSk7XG4iLAogICJpbXBvcnQgKiBhcyBPIGZyb20gXCJmcC10cy9PcHRpb25cIjtcbmltcG9ydCAqIGFzIE0gZnJvbSBcImZwLXRzL01hcFwiO1xuaW1wb3J0ICogYXMgQSBmcm9tIFwiZnAtdHMvQXJyYXlcIjtcbmltcG9ydCB7IGZsb3csIHBpcGUsIGdldE1vbm9pZCBhcyBnZXRGdW5jdGlvbk1vbm9pZCwgYXBwbHksIGNvbnN0YW50LCBmbGlwLCB0dXBsZWQsIH0gZnJvbSBcImZwLXRzL2Z1bmN0aW9uXCI7XG5pbXBvcnQgeyBub3QgfSBmcm9tIFwiZnAtdHMvUHJlZGljYXRlXCI7XG5pbXBvcnQgeyBnZXRNb25vaWQgYXMgZ2V0RW5kb01vbm9pZCB9IGZyb20gXCJmcC10cy9FbmRvbW9ycGhpc21cIjtcbmltcG9ydCB7IGNvbmNhdEFsbCB9IGZyb20gXCJmcC10cy9Nb25vaWRcIjtcbmltcG9ydCB7IGZpcnN0IH0gZnJvbSBcImZwLXRzL1NlbWlncm91cFwiO1xuaW1wb3J0IHsgYmluZFRvIGFzIGJpbmRUb18sIGxldCBhcyBsZXRfXyB9IGZyb20gXCJmcC10cy9GdW5jdG9yXCI7XG5pbXBvcnQgeyBhcEZpcnN0IGFzIGFwRmlyc3RfLCBhcFNlY29uZCBhcyBhcFNlY29uZF8sIGFwUyBhcyBhcFNfLCB9IGZyb20gXCJmcC10cy9BcHBseVwiO1xuaW1wb3J0IHsgYmluZCBhcyBiaW5kXyB9IGZyb20gXCJmcC10cy9DaGFpblwiO1xuZXhwb3J0IGNvbnN0IFVSSSA9IFwiRnVuY3Rpb25cIjtcbmV4cG9ydCBjb25zdCBtYXAgPSBmID0+IGcgPT4gZmxvdyhnLCBmKTtcbmV4cG9ydCBjb25zdCBGdW5jdG9yID0ge1xuICAgIFVSSSxcbiAgICBtYXA6IChmLCBnKSA9PiBtYXAoZykoZiksXG59O1xuZXhwb3J0IGNvbnN0IG9mID0gY29uc3RhbnQ7XG5leHBvcnQgY29uc3QgYXAgPSBmID0+IGcgPT4geCA9PiBnKHgpKGYoeCkpO1xuZXhwb3J0IGNvbnN0IEFwcGxpY2F0aXZlID0ge1xuICAgIC4uLkZ1bmN0b3IsXG4gICAgb2YsXG4gICAgYXA6IChmLCBnKSA9PiBhcChnKShmKSxcbn07XG5leHBvcnQgY29uc3QgYXBGaXJzdCA9IGFwRmlyc3RfKEFwcGxpY2F0aXZlKTtcbmV4cG9ydCBjb25zdCBhcFNlY29uZCA9IGFwU2Vjb25kXyhBcHBsaWNhdGl2ZSk7XG5leHBvcnQgY29uc3QgY2hhaW4gPSBmID0+IGcgPT4geCA9PiBmKGcoeCkpKHgpO1xuZXhwb3J0IGNvbnN0IGZsYXRNYXAgPSBjaGFpbjtcbmV4cG9ydCBjb25zdCBNb25hZCA9IHtcbiAgICAuLi5BcHBsaWNhdGl2ZSxcbiAgICBjaGFpbjogKGYsIGcpID0+IGNoYWluKGcpKGYpLFxufTtcbmV4cG9ydCBjb25zdCBEbyA9IG9mKHt9KTtcbmV4cG9ydCBjb25zdCBiaW5kVG8gPSBiaW5kVG9fKEZ1bmN0b3IpO1xuZXhwb3J0IGNvbnN0IGJpbmQgPSBiaW5kXyhNb25hZCk7XG5leHBvcnQgY29uc3QgYXBTID0gYXBTXyhBcHBsaWNhdGl2ZSk7XG5jb25zdCBsZXRfID0gbGV0X18oRnVuY3Rvcik7XG5leHBvcnQgeyBsZXRfIGFzIGxldCwgfTtcbmV4cG9ydCBjb25zdCB3aXRoSW5kZXggPSBmID0+IGcgPT4geHMgPT4ge1xuICAgIGxldCBpID0gMDtcbiAgICByZXR1cm4gZih5ID0+IGcoaSsrKSh5KSkoeHMpO1xufTtcbmV4cG9ydCBjb25zdCB1bmFyeSA9IHR1cGxlZDtcbmV4cG9ydCBjb25zdCBndWFyZCA9IChicmFuY2hlcykgPT4gKGZhbGxiYWNrKSA9PiAoaW5wdXQpID0+IHBpcGUoYnJhbmNoZXMsIEEubWFwKChbZiwgZ10pID0+IGZsb3coTy5mcm9tUHJlZGljYXRlKGYpLCBPLm1hcChnKSkpLCBjb25jYXRBbGwoZ2V0RnVuY3Rpb25Nb25vaWQoTy5nZXRNb25vaWQoZmlyc3QoKSkpKCkpLCBhcHBseShpbnB1dCksIE8uZ2V0T3JFbHNlKCgpID0+IGZhbGxiYWNrKGlucHV0KSkpO1xuZXhwb3J0IGNvbnN0IGlmRWxzZSA9IChvblRydWUpID0+IChvbkZhbHNlKSA9PiAoZikgPT4gKHgpID0+IGYoeCkgPyBvblRydWUoeCkgOiBvbkZhbHNlKHgpO1xuZXhwb3J0IGNvbnN0IHVubGVzcyA9IChmKSA9PiAob25GYWxzZSkgPT4geCA9PiBmKHgpID8geCA6IG9uRmFsc2UoeCk7XG5leHBvcnQgY29uc3Qgd2hlbiA9IGZsb3cobm90LCB1bmxlc3MpO1xuZXhwb3J0IGNvbnN0IHVudGlsID0gKGYpID0+IChnKSA9PiB7XG4gICAgY29uc3QgaCA9IHggPT4gKGYoeCkgPyB4IDogaChnKHgpKSk7XG4gICAgcmV0dXJuIGg7XG59O1xuZXhwb3J0IGNvbnN0IGNvbnN0cnVjdCA9ICh4KSA9PiAoeHMpID0+IG5ldyB4KC4uLnhzKTtcbmV4cG9ydCBjb25zdCBpbnZva2UgPSAoeCkgPT4gKHlzKSA9PiAoeikgPT4gelt4XSguLi55cyk7XG5leHBvcnQgY29uc3QgaW52b2tlTnVsbGFyeSA9IGZsaXAoaW52b2tlKShbXSk7XG5leHBvcnQgY29uc3QgaW52b2tlT24gPSAoKSA9PiAoeCkgPT4geXMgPT4geiA9PiB6W3hdKC4uLnlzKTtcbmV4cG9ydCBjb25zdCBtZW1vaXplID0gKGVxKSA9PiAoZikgPT4ge1xuICAgIGNvbnN0IGNhY2hlID0gbmV3IE1hcCgpO1xuICAgIHJldHVybiBrID0+IHtcbiAgICAgICAgY29uc3QgY2FjaGVkID0gTS5sb29rdXAoZXEpKGspKGNhY2hlKTtcbiAgICAgICAgaWYgKE8uaXNTb21lKGNhY2hlZCkpXG4gICAgICAgICAgICByZXR1cm4gY2FjaGVkLnZhbHVlO1xuICAgICAgICBjb25zdCB2YWwgPSBmKGspO1xuICAgICAgICBjYWNoZS5zZXQoaywgdmFsKTtcbiAgICAgICAgcmV0dXJuIHZhbDtcbiAgICB9O1xufTtcbmV4cG9ydCBjb25zdCBjdXJyeTJUID0gKGYpID0+IChhKSA9PiAoYikgPT4gZihbYSwgYl0pO1xuZXhwb3J0IGNvbnN0IGN1cnJ5MiA9IGZsb3codW5hcnksIGN1cnJ5MlQpO1xuZXhwb3J0IGNvbnN0IGN1cnJ5M1QgPSAoZikgPT4gKGEpID0+IChiKSA9PiAoYykgPT4gZihbYSwgYiwgY10pO1xuZXhwb3J0IGNvbnN0IGN1cnJ5MyA9IGZsb3codW5hcnksIGN1cnJ5M1QpO1xuZXhwb3J0IGNvbnN0IGN1cnJ5NFQgPSAoZikgPT4gKGEpID0+IChiKSA9PiAoYykgPT4gKGQpID0+IGYoW2EsIGIsIGMsIGRdKTtcbmV4cG9ydCBjb25zdCBjdXJyeTQgPSBmbG93KHVuYXJ5LCBjdXJyeTRUKTtcbmV4cG9ydCBjb25zdCBjdXJyeTVUID0gKGYpID0+IChhKSA9PiAoYikgPT4gKGMpID0+IChkKSA9PiAoZSkgPT4gZihbYSwgYiwgYywgZCwgZV0pO1xuZXhwb3J0IGNvbnN0IGN1cnJ5NSA9IGZsb3codW5hcnksIGN1cnJ5NVQpO1xuZXhwb3J0IGNvbnN0IHVuY3VycnkyID0gKGYpID0+IChbYSwgYl0pID0+IGYoYSkoYik7XG5leHBvcnQgY29uc3QgdW5jdXJyeTMgPSAoZikgPT4gKFthLCBiLCBjXSkgPT4gZihhKShiKShjKTtcbmV4cG9ydCBjb25zdCB1bmN1cnJ5NCA9IChmKSA9PiAoW2EsIGIsIGMsIGRdKSA9PiBmKGEpKGIpKGMpKGQpO1xuZXhwb3J0IGNvbnN0IHVuY3Vycnk1ID0gKGYpID0+IChbYSwgYiwgYywgZCwgZV0pID0+IGYoYSkoYikoYykoZCkoZSk7XG5leHBvcnQgZnVuY3Rpb24gZm9yayhmcykge1xuICAgIHJldHVybiAoeCkgPT4gZnMubWFwKGYgPT4gZih4KSk7XG59XG5leHBvcnQgY29uc3QgY29udmVyZ2UgPSAoZikgPT4gKGdzKSA9PiBmbG93KHggPT4gZm9yayhncykoeCksIGYpO1xuZXhwb3J0IGNvbnN0IGlzSW5zdGFuY2VPZiA9ICh4KSA9PiAoeSkgPT4geSBpbnN0YW5jZW9mIHg7XG5leHBvcnQgY29uc3QgYXBwbHlFdmVyeSA9IGNvbmNhdEFsbChnZXRFbmRvTW9ub2lkKCkpO1xuZXhwb3J0IGNvbnN0IGFwcGx5U29tZXMgPSAoZnMpID0+IHggPT4gcGlwZShmcywgQS5yZWR1Y2UoeCwgKHksIG1mKSA9PiBwaXBlKG1mLCBPLm1hdGNoKGNvbnN0YW50KHkpLCBhcHBseSh5KSkpKSk7XG5leHBvcnQgY29uc3QgYXBwbHlOID0gKG4pID0+IChmKSA9PiBwaXBlKEEucmVwbGljYXRlKG4sIGYpLCBhcHBseUV2ZXJ5KTtcbiIsCiAgImltcG9ydCAqIGFzIE8gZnJvbSBcImZwLXRzL09wdGlvblwiO1xuaW1wb3J0ICogYXMgTSBmcm9tIFwiZnAtdHMvTWFwXCI7XG5pbXBvcnQgKiBhcyBBIGZyb20gXCJmcC10cy9BcnJheVwiO1xuaW1wb3J0IHsgZmxvdywgcGlwZSwgZ2V0TW9ub2lkIGFzIGdldEZ1bmN0aW9uTW9ub2lkLCBhcHBseSwgY29uc3RhbnQsIGZsaXAsIHR1cGxlZCwgfSBmcm9tIFwiZnAtdHMvZnVuY3Rpb25cIjtcbmltcG9ydCB7IG5vdCB9IGZyb20gXCJmcC10cy9QcmVkaWNhdGVcIjtcbmltcG9ydCB7IGdldE1vbm9pZCBhcyBnZXRFbmRvTW9ub2lkIH0gZnJvbSBcImZwLXRzL0VuZG9tb3JwaGlzbVwiO1xuaW1wb3J0IHsgY29uY2F0QWxsIH0gZnJvbSBcImZwLXRzL01vbm9pZFwiO1xuaW1wb3J0IHsgZmlyc3QgfSBmcm9tIFwiZnAtdHMvU2VtaWdyb3VwXCI7XG5pbXBvcnQgeyBiaW5kVG8gYXMgYmluZFRvXywgbGV0IGFzIGxldF9fIH0gZnJvbSBcImZwLXRzL0Z1bmN0b3JcIjtcbmltcG9ydCB7IGFwRmlyc3QgYXMgYXBGaXJzdF8sIGFwU2Vjb25kIGFzIGFwU2Vjb25kXywgYXBTIGFzIGFwU18sIH0gZnJvbSBcImZwLXRzL0FwcGx5XCI7XG5pbXBvcnQgeyBiaW5kIGFzIGJpbmRfIH0gZnJvbSBcImZwLXRzL0NoYWluXCI7XG5leHBvcnQgY29uc3QgVVJJID0gXCJGdW5jdGlvblwiO1xuZXhwb3J0IGNvbnN0IG1hcCA9IGYgPT4gZyA9PiBmbG93KGcsIGYpO1xuZXhwb3J0IGNvbnN0IEZ1bmN0b3IgPSB7XG4gICAgVVJJLFxuICAgIG1hcDogKGYsIGcpID0+IG1hcChnKShmKSxcbn07XG5leHBvcnQgY29uc3Qgb2YgPSBjb25zdGFudDtcbmV4cG9ydCBjb25zdCBhcCA9IGYgPT4gZyA9PiB4ID0+IGcoeCkoZih4KSk7XG5leHBvcnQgY29uc3QgQXBwbGljYXRpdmUgPSB7XG4gICAgLi4uRnVuY3RvcixcbiAgICBvZixcbiAgICBhcDogKGYsIGcpID0+IGFwKGcpKGYpLFxufTtcbmV4cG9ydCBjb25zdCBhcEZpcnN0ID0gYXBGaXJzdF8oQXBwbGljYXRpdmUpO1xuZXhwb3J0IGNvbnN0IGFwU2Vjb25kID0gYXBTZWNvbmRfKEFwcGxpY2F0aXZlKTtcbmV4cG9ydCBjb25zdCBjaGFpbiA9IGYgPT4gZyA9PiB4ID0+IGYoZyh4KSkoeCk7XG5leHBvcnQgY29uc3QgZmxhdE1hcCA9IGNoYWluO1xuZXhwb3J0IGNvbnN0IE1vbmFkID0ge1xuICAgIC4uLkFwcGxpY2F0aXZlLFxuICAgIGNoYWluOiAoZiwgZykgPT4gY2hhaW4oZykoZiksXG59O1xuZXhwb3J0IGNvbnN0IERvID0gb2Yoe30pO1xuZXhwb3J0IGNvbnN0IGJpbmRUbyA9IGJpbmRUb18oRnVuY3Rvcik7XG5leHBvcnQgY29uc3QgYmluZCA9IGJpbmRfKE1vbmFkKTtcbmV4cG9ydCBjb25zdCBhcFMgPSBhcFNfKEFwcGxpY2F0aXZlKTtcbmNvbnN0IGxldF8gPSBsZXRfXyhGdW5jdG9yKTtcbmV4cG9ydCB7IGxldF8gYXMgbGV0LCB9O1xuZXhwb3J0IGNvbnN0IHdpdGhJbmRleCA9IGYgPT4gZyA9PiB4cyA9PiB7XG4gICAgbGV0IGkgPSAwO1xuICAgIHJldHVybiBmKHkgPT4gZyhpKyspKHkpKSh4cyk7XG59O1xuZXhwb3J0IGNvbnN0IHVuYXJ5ID0gdHVwbGVkO1xuZXhwb3J0IGNvbnN0IGd1YXJkID0gKGJyYW5jaGVzKSA9PiAoZmFsbGJhY2spID0+IChpbnB1dCkgPT4gcGlwZShicmFuY2hlcywgQS5tYXAoKFtmLCBnXSkgPT4gZmxvdyhPLmZyb21QcmVkaWNhdGUoZiksIE8ubWFwKGcpKSksIGNvbmNhdEFsbChnZXRGdW5jdGlvbk1vbm9pZChPLmdldE1vbm9pZChmaXJzdCgpKSkoKSksIGFwcGx5KGlucHV0KSwgTy5nZXRPckVsc2UoKCkgPT4gZmFsbGJhY2soaW5wdXQpKSk7XG5leHBvcnQgY29uc3QgaWZFbHNlID0gKG9uVHJ1ZSkgPT4gKG9uRmFsc2UpID0+IChmKSA9PiAoeCkgPT4gZih4KSA/IG9uVHJ1ZSh4KSA6IG9uRmFsc2UoeCk7XG5leHBvcnQgY29uc3QgdW5sZXNzID0gKGYpID0+IChvbkZhbHNlKSA9PiB4ID0+IGYoeCkgPyB4IDogb25GYWxzZSh4KTtcbmV4cG9ydCBjb25zdCB3aGVuID0gZmxvdyhub3QsIHVubGVzcyk7XG5leHBvcnQgY29uc3QgdW50aWwgPSAoZikgPT4gKGcpID0+IHtcbiAgICBjb25zdCBoID0geCA9PiAoZih4KSA/IHggOiBoKGcoeCkpKTtcbiAgICByZXR1cm4gaDtcbn07XG5leHBvcnQgY29uc3QgY29uc3RydWN0ID0gKHgpID0+ICh4cykgPT4gbmV3IHgoLi4ueHMpO1xuZXhwb3J0IGNvbnN0IGludm9rZSA9ICh4KSA9PiAoeXMpID0+ICh6KSA9PiB6W3hdKC4uLnlzKTtcbmV4cG9ydCBjb25zdCBpbnZva2VOdWxsYXJ5ID0gZmxpcChpbnZva2UpKFtdKTtcbmV4cG9ydCBjb25zdCBpbnZva2VPbiA9ICgpID0+ICh4KSA9PiB5cyA9PiB6ID0+IHpbeF0oLi4ueXMpO1xuZXhwb3J0IGNvbnN0IG1lbW9pemUgPSAoZXEpID0+IChmKSA9PiB7XG4gICAgY29uc3QgY2FjaGUgPSBuZXcgTWFwKCk7XG4gICAgcmV0dXJuIGsgPT4ge1xuICAgICAgICBjb25zdCBjYWNoZWQgPSBNLmxvb2t1cChlcSkoaykoY2FjaGUpO1xuICAgICAgICBpZiAoTy5pc1NvbWUoY2FjaGVkKSlcbiAgICAgICAgICAgIHJldHVybiBjYWNoZWQudmFsdWU7XG4gICAgICAgIGNvbnN0IHZhbCA9IGYoayk7XG4gICAgICAgIGNhY2hlLnNldChrLCB2YWwpO1xuICAgICAgICByZXR1cm4gdmFsO1xuICAgIH07XG59O1xuZXhwb3J0IGNvbnN0IGN1cnJ5MlQgPSAoZikgPT4gKGEpID0+IChiKSA9PiBmKFthLCBiXSk7XG5leHBvcnQgY29uc3QgY3VycnkyID0gZmxvdyh1bmFyeSwgY3VycnkyVCk7XG5leHBvcnQgY29uc3QgY3VycnkzVCA9IChmKSA9PiAoYSkgPT4gKGIpID0+IChjKSA9PiBmKFthLCBiLCBjXSk7XG5leHBvcnQgY29uc3QgY3VycnkzID0gZmxvdyh1bmFyeSwgY3VycnkzVCk7XG5leHBvcnQgY29uc3QgY3Vycnk0VCA9IChmKSA9PiAoYSkgPT4gKGIpID0+IChjKSA9PiAoZCkgPT4gZihbYSwgYiwgYywgZF0pO1xuZXhwb3J0IGNvbnN0IGN1cnJ5NCA9IGZsb3codW5hcnksIGN1cnJ5NFQpO1xuZXhwb3J0IGNvbnN0IGN1cnJ5NVQgPSAoZikgPT4gKGEpID0+IChiKSA9PiAoYykgPT4gKGQpID0+IChlKSA9PiBmKFthLCBiLCBjLCBkLCBlXSk7XG5leHBvcnQgY29uc3QgY3Vycnk1ID0gZmxvdyh1bmFyeSwgY3Vycnk1VCk7XG5leHBvcnQgY29uc3QgdW5jdXJyeTIgPSAoZikgPT4gKFthLCBiXSkgPT4gZihhKShiKTtcbmV4cG9ydCBjb25zdCB1bmN1cnJ5MyA9IChmKSA9PiAoW2EsIGIsIGNdKSA9PiBmKGEpKGIpKGMpO1xuZXhwb3J0IGNvbnN0IHVuY3Vycnk0ID0gKGYpID0+IChbYSwgYiwgYywgZF0pID0+IGYoYSkoYikoYykoZCk7XG5leHBvcnQgY29uc3QgdW5jdXJyeTUgPSAoZikgPT4gKFthLCBiLCBjLCBkLCBlXSkgPT4gZihhKShiKShjKShkKShlKTtcbmV4cG9ydCBmdW5jdGlvbiBmb3JrKGZzKSB7XG4gICAgcmV0dXJuICh4KSA9PiBmcy5tYXAoZiA9PiBmKHgpKTtcbn1cbmV4cG9ydCBjb25zdCBjb252ZXJnZSA9IChmKSA9PiAoZ3MpID0+IGZsb3coeCA9PiBmb3JrKGdzKSh4KSwgZik7XG5leHBvcnQgY29uc3QgaXNJbnN0YW5jZU9mID0gKHgpID0+ICh5KSA9PiB5IGluc3RhbmNlb2YgeDtcbmV4cG9ydCBjb25zdCBhcHBseUV2ZXJ5ID0gY29uY2F0QWxsKGdldEVuZG9Nb25vaWQoKSk7XG5leHBvcnQgY29uc3QgYXBwbHlTb21lcyA9IChmcykgPT4geCA9PiBwaXBlKGZzLCBBLnJlZHVjZSh4LCAoeSwgbWYpID0+IHBpcGUobWYsIE8ubWF0Y2goY29uc3RhbnQoeSksIGFwcGx5KHkpKSkpKTtcbmV4cG9ydCBjb25zdCBhcHBseU4gPSAobikgPT4gKGYpID0+IHBpcGUoQS5yZXBsaWNhdGUobiwgZiksIGFwcGx5RXZlcnkpO1xuIiwKICAiaW1wb3J0ICogYXMgTyBmcm9tIFwiZnAtdHMvT3B0aW9uXCI7XG5pbXBvcnQgKiBhcyBNIGZyb20gXCJmcC10cy9NYXBcIjtcbmltcG9ydCAqIGFzIEEgZnJvbSBcImZwLXRzL0FycmF5XCI7XG5pbXBvcnQgeyBmbG93LCBwaXBlLCBnZXRNb25vaWQgYXMgZ2V0RnVuY3Rpb25Nb25vaWQsIGFwcGx5LCBjb25zdGFudCwgZmxpcCwgdHVwbGVkLCB9IGZyb20gXCJmcC10cy9mdW5jdGlvblwiO1xuaW1wb3J0IHsgbm90IH0gZnJvbSBcImZwLXRzL1ByZWRpY2F0ZVwiO1xuaW1wb3J0IHsgZ2V0TW9ub2lkIGFzIGdldEVuZG9Nb25vaWQgfSBmcm9tIFwiZnAtdHMvRW5kb21vcnBoaXNtXCI7XG5pbXBvcnQgeyBjb25jYXRBbGwgfSBmcm9tIFwiZnAtdHMvTW9ub2lkXCI7XG5pbXBvcnQgeyBmaXJzdCB9IGZyb20gXCJmcC10cy9TZW1pZ3JvdXBcIjtcbmltcG9ydCB7IGJpbmRUbyBhcyBiaW5kVG9fLCBsZXQgYXMgbGV0X18gfSBmcm9tIFwiZnAtdHMvRnVuY3RvclwiO1xuaW1wb3J0IHsgYXBGaXJzdCBhcyBhcEZpcnN0XywgYXBTZWNvbmQgYXMgYXBTZWNvbmRfLCBhcFMgYXMgYXBTXywgfSBmcm9tIFwiZnAtdHMvQXBwbHlcIjtcbmltcG9ydCB7IGJpbmQgYXMgYmluZF8gfSBmcm9tIFwiZnAtdHMvQ2hhaW5cIjtcbmV4cG9ydCBjb25zdCBVUkkgPSBcIkZ1bmN0aW9uXCI7XG5leHBvcnQgY29uc3QgbWFwID0gZiA9PiBnID0+IGZsb3coZywgZik7XG5leHBvcnQgY29uc3QgRnVuY3RvciA9IHtcbiAgICBVUkksXG4gICAgbWFwOiAoZiwgZykgPT4gbWFwKGcpKGYpLFxufTtcbmV4cG9ydCBjb25zdCBvZiA9IGNvbnN0YW50O1xuZXhwb3J0IGNvbnN0IGFwID0gZiA9PiBnID0+IHggPT4gZyh4KShmKHgpKTtcbmV4cG9ydCBjb25zdCBBcHBsaWNhdGl2ZSA9IHtcbiAgICAuLi5GdW5jdG9yLFxuICAgIG9mLFxuICAgIGFwOiAoZiwgZykgPT4gYXAoZykoZiksXG59O1xuZXhwb3J0IGNvbnN0IGFwRmlyc3QgPSBhcEZpcnN0XyhBcHBsaWNhdGl2ZSk7XG5leHBvcnQgY29uc3QgYXBTZWNvbmQgPSBhcFNlY29uZF8oQXBwbGljYXRpdmUpO1xuZXhwb3J0IGNvbnN0IGNoYWluID0gZiA9PiBnID0+IHggPT4gZihnKHgpKSh4KTtcbmV4cG9ydCBjb25zdCBmbGF0TWFwID0gY2hhaW47XG5leHBvcnQgY29uc3QgTW9uYWQgPSB7XG4gICAgLi4uQXBwbGljYXRpdmUsXG4gICAgY2hhaW46IChmLCBnKSA9PiBjaGFpbihnKShmKSxcbn07XG5leHBvcnQgY29uc3QgRG8gPSBvZih7fSk7XG5leHBvcnQgY29uc3QgYmluZFRvID0gYmluZFRvXyhGdW5jdG9yKTtcbmV4cG9ydCBjb25zdCBiaW5kID0gYmluZF8oTW9uYWQpO1xuZXhwb3J0IGNvbnN0IGFwUyA9IGFwU18oQXBwbGljYXRpdmUpO1xuY29uc3QgbGV0XyA9IGxldF9fKEZ1bmN0b3IpO1xuZXhwb3J0IHsgbGV0XyBhcyBsZXQsIH07XG5leHBvcnQgY29uc3Qgd2l0aEluZGV4ID0gZiA9PiBnID0+IHhzID0+IHtcbiAgICBsZXQgaSA9IDA7XG4gICAgcmV0dXJuIGYoeSA9PiBnKGkrKykoeSkpKHhzKTtcbn07XG5leHBvcnQgY29uc3QgdW5hcnkgPSB0dXBsZWQ7XG5leHBvcnQgY29uc3QgZ3VhcmQgPSAoYnJhbmNoZXMpID0+IChmYWxsYmFjaykgPT4gKGlucHV0KSA9PiBwaXBlKGJyYW5jaGVzLCBBLm1hcCgoW2YsIGddKSA9PiBmbG93KE8uZnJvbVByZWRpY2F0ZShmKSwgTy5tYXAoZykpKSwgY29uY2F0QWxsKGdldEZ1bmN0aW9uTW9ub2lkKE8uZ2V0TW9ub2lkKGZpcnN0KCkpKSgpKSwgYXBwbHkoaW5wdXQpLCBPLmdldE9yRWxzZSgoKSA9PiBmYWxsYmFjayhpbnB1dCkpKTtcbmV4cG9ydCBjb25zdCBpZkVsc2UgPSAob25UcnVlKSA9PiAob25GYWxzZSkgPT4gKGYpID0+ICh4KSA9PiBmKHgpID8gb25UcnVlKHgpIDogb25GYWxzZSh4KTtcbmV4cG9ydCBjb25zdCB1bmxlc3MgPSAoZikgPT4gKG9uRmFsc2UpID0+IHggPT4gZih4KSA/IHggOiBvbkZhbHNlKHgpO1xuZXhwb3J0IGNvbnN0IHdoZW4gPSBmbG93KG5vdCwgdW5sZXNzKTtcbmV4cG9ydCBjb25zdCB1bnRpbCA9IChmKSA9PiAoZykgPT4ge1xuICAgIGNvbnN0IGggPSB4ID0+IChmKHgpID8geCA6IGgoZyh4KSkpO1xuICAgIHJldHVybiBoO1xufTtcbmV4cG9ydCBjb25zdCBjb25zdHJ1Y3QgPSAoeCkgPT4gKHhzKSA9PiBuZXcgeCguLi54cyk7XG5leHBvcnQgY29uc3QgaW52b2tlID0gKHgpID0+ICh5cykgPT4gKHopID0+IHpbeF0oLi4ueXMpO1xuZXhwb3J0IGNvbnN0IGludm9rZU51bGxhcnkgPSBmbGlwKGludm9rZSkoW10pO1xuZXhwb3J0IGNvbnN0IGludm9rZU9uID0gKCkgPT4gKHgpID0+IHlzID0+IHogPT4gelt4XSguLi55cyk7XG5leHBvcnQgY29uc3QgbWVtb2l6ZSA9IChlcSkgPT4gKGYpID0+IHtcbiAgICBjb25zdCBjYWNoZSA9IG5ldyBNYXAoKTtcbiAgICByZXR1cm4gayA9PiB7XG4gICAgICAgIGNvbnN0IGNhY2hlZCA9IE0ubG9va3VwKGVxKShrKShjYWNoZSk7XG4gICAgICAgIGlmIChPLmlzU29tZShjYWNoZWQpKVxuICAgICAgICAgICAgcmV0dXJuIGNhY2hlZC52YWx1ZTtcbiAgICAgICAgY29uc3QgdmFsID0gZihrKTtcbiAgICAgICAgY2FjaGUuc2V0KGssIHZhbCk7XG4gICAgICAgIHJldHVybiB2YWw7XG4gICAgfTtcbn07XG5leHBvcnQgY29uc3QgY3VycnkyVCA9IChmKSA9PiAoYSkgPT4gKGIpID0+IGYoW2EsIGJdKTtcbmV4cG9ydCBjb25zdCBjdXJyeTIgPSBmbG93KHVuYXJ5LCBjdXJyeTJUKTtcbmV4cG9ydCBjb25zdCBjdXJyeTNUID0gKGYpID0+IChhKSA9PiAoYikgPT4gKGMpID0+IGYoW2EsIGIsIGNdKTtcbmV4cG9ydCBjb25zdCBjdXJyeTMgPSBmbG93KHVuYXJ5LCBjdXJyeTNUKTtcbmV4cG9ydCBjb25zdCBjdXJyeTRUID0gKGYpID0+IChhKSA9PiAoYikgPT4gKGMpID0+IChkKSA9PiBmKFthLCBiLCBjLCBkXSk7XG5leHBvcnQgY29uc3QgY3Vycnk0ID0gZmxvdyh1bmFyeSwgY3Vycnk0VCk7XG5leHBvcnQgY29uc3QgY3Vycnk1VCA9IChmKSA9PiAoYSkgPT4gKGIpID0+IChjKSA9PiAoZCkgPT4gKGUpID0+IGYoW2EsIGIsIGMsIGQsIGVdKTtcbmV4cG9ydCBjb25zdCBjdXJyeTUgPSBmbG93KHVuYXJ5LCBjdXJyeTVUKTtcbmV4cG9ydCBjb25zdCB1bmN1cnJ5MiA9IChmKSA9PiAoW2EsIGJdKSA9PiBmKGEpKGIpO1xuZXhwb3J0IGNvbnN0IHVuY3VycnkzID0gKGYpID0+IChbYSwgYiwgY10pID0+IGYoYSkoYikoYyk7XG5leHBvcnQgY29uc3QgdW5jdXJyeTQgPSAoZikgPT4gKFthLCBiLCBjLCBkXSkgPT4gZihhKShiKShjKShkKTtcbmV4cG9ydCBjb25zdCB1bmN1cnJ5NSA9IChmKSA9PiAoW2EsIGIsIGMsIGQsIGVdKSA9PiBmKGEpKGIpKGMpKGQpKGUpO1xuZXhwb3J0IGZ1bmN0aW9uIGZvcmsoZnMpIHtcbiAgICByZXR1cm4gKHgpID0+IGZzLm1hcChmID0+IGYoeCkpO1xufVxuZXhwb3J0IGNvbnN0IGNvbnZlcmdlID0gKGYpID0+IChncykgPT4gZmxvdyh4ID0+IGZvcmsoZ3MpKHgpLCBmKTtcbmV4cG9ydCBjb25zdCBpc0luc3RhbmNlT2YgPSAoeCkgPT4gKHkpID0+IHkgaW5zdGFuY2VvZiB4O1xuZXhwb3J0IGNvbnN0IGFwcGx5RXZlcnkgPSBjb25jYXRBbGwoZ2V0RW5kb01vbm9pZCgpKTtcbmV4cG9ydCBjb25zdCBhcHBseVNvbWVzID0gKGZzKSA9PiB4ID0+IHBpcGUoZnMsIEEucmVkdWNlKHgsICh5LCBtZikgPT4gcGlwZShtZiwgTy5tYXRjaChjb25zdGFudCh5KSwgYXBwbHkoeSkpKSkpO1xuZXhwb3J0IGNvbnN0IGFwcGx5TiA9IChuKSA9PiAoZikgPT4gcGlwZShBLnJlcGxpY2F0ZShuLCBmKSwgYXBwbHlFdmVyeSk7XG4iLAogICJpbXBvcnQgKiBhcyBPIGZyb20gXCJmcC10cy9PcHRpb25cIjtcbmltcG9ydCAqIGFzIE0gZnJvbSBcImZwLXRzL01hcFwiO1xuaW1wb3J0ICogYXMgQSBmcm9tIFwiZnAtdHMvQXJyYXlcIjtcbmltcG9ydCB7IGZsb3csIHBpcGUsIGdldE1vbm9pZCBhcyBnZXRGdW5jdGlvbk1vbm9pZCwgYXBwbHksIGNvbnN0YW50LCBmbGlwLCB0dXBsZWQsIH0gZnJvbSBcImZwLXRzL2Z1bmN0aW9uXCI7XG5pbXBvcnQgeyBub3QgfSBmcm9tIFwiZnAtdHMvUHJlZGljYXRlXCI7XG5pbXBvcnQgeyBnZXRNb25vaWQgYXMgZ2V0RW5kb01vbm9pZCB9IGZyb20gXCJmcC10cy9FbmRvbW9ycGhpc21cIjtcbmltcG9ydCB7IGNvbmNhdEFsbCB9IGZyb20gXCJmcC10cy9Nb25vaWRcIjtcbmltcG9ydCB7IGZpcnN0IH0gZnJvbSBcImZwLXRzL1NlbWlncm91cFwiO1xuaW1wb3J0IHsgYmluZFRvIGFzIGJpbmRUb18sIGxldCBhcyBsZXRfXyB9IGZyb20gXCJmcC10cy9GdW5jdG9yXCI7XG5pbXBvcnQgeyBhcEZpcnN0IGFzIGFwRmlyc3RfLCBhcFNlY29uZCBhcyBhcFNlY29uZF8sIGFwUyBhcyBhcFNfLCB9IGZyb20gXCJmcC10cy9BcHBseVwiO1xuaW1wb3J0IHsgYmluZCBhcyBiaW5kXyB9IGZyb20gXCJmcC10cy9DaGFpblwiO1xuZXhwb3J0IGNvbnN0IFVSSSA9IFwiRnVuY3Rpb25cIjtcbmV4cG9ydCBjb25zdCBtYXAgPSBmID0+IGcgPT4gZmxvdyhnLCBmKTtcbmV4cG9ydCBjb25zdCBGdW5jdG9yID0ge1xuICAgIFVSSSxcbiAgICBtYXA6IChmLCBnKSA9PiBtYXAoZykoZiksXG59O1xuZXhwb3J0IGNvbnN0IG9mID0gY29uc3RhbnQ7XG5leHBvcnQgY29uc3QgYXAgPSBmID0+IGcgPT4geCA9PiBnKHgpKGYoeCkpO1xuZXhwb3J0IGNvbnN0IEFwcGxpY2F0aXZlID0ge1xuICAgIC4uLkZ1bmN0b3IsXG4gICAgb2YsXG4gICAgYXA6IChmLCBnKSA9PiBhcChnKShmKSxcbn07XG5leHBvcnQgY29uc3QgYXBGaXJzdCA9IGFwRmlyc3RfKEFwcGxpY2F0aXZlKTtcbmV4cG9ydCBjb25zdCBhcFNlY29uZCA9IGFwU2Vjb25kXyhBcHBsaWNhdGl2ZSk7XG5leHBvcnQgY29uc3QgY2hhaW4gPSBmID0+IGcgPT4geCA9PiBmKGcoeCkpKHgpO1xuZXhwb3J0IGNvbnN0IGZsYXRNYXAgPSBjaGFpbjtcbmV4cG9ydCBjb25zdCBNb25hZCA9IHtcbiAgICAuLi5BcHBsaWNhdGl2ZSxcbiAgICBjaGFpbjogKGYsIGcpID0+IGNoYWluKGcpKGYpLFxufTtcbmV4cG9ydCBjb25zdCBEbyA9IG9mKHt9KTtcbmV4cG9ydCBjb25zdCBiaW5kVG8gPSBiaW5kVG9fKEZ1bmN0b3IpO1xuZXhwb3J0IGNvbnN0IGJpbmQgPSBiaW5kXyhNb25hZCk7XG5leHBvcnQgY29uc3QgYXBTID0gYXBTXyhBcHBsaWNhdGl2ZSk7XG5jb25zdCBsZXRfID0gbGV0X18oRnVuY3Rvcik7XG5leHBvcnQgeyBsZXRfIGFzIGxldCwgfTtcbmV4cG9ydCBjb25zdCB3aXRoSW5kZXggPSBmID0+IGcgPT4geHMgPT4ge1xuICAgIGxldCBpID0gMDtcbiAgICByZXR1cm4gZih5ID0+IGcoaSsrKSh5KSkoeHMpO1xufTtcbmV4cG9ydCBjb25zdCB1bmFyeSA9IHR1cGxlZDtcbmV4cG9ydCBjb25zdCBndWFyZCA9IChicmFuY2hlcykgPT4gKGZhbGxiYWNrKSA9PiAoaW5wdXQpID0+IHBpcGUoYnJhbmNoZXMsIEEubWFwKChbZiwgZ10pID0+IGZsb3coTy5mcm9tUHJlZGljYXRlKGYpLCBPLm1hcChnKSkpLCBjb25jYXRBbGwoZ2V0RnVuY3Rpb25Nb25vaWQoTy5nZXRNb25vaWQoZmlyc3QoKSkpKCkpLCBhcHBseShpbnB1dCksIE8uZ2V0T3JFbHNlKCgpID0+IGZhbGxiYWNrKGlucHV0KSkpO1xuZXhwb3J0IGNvbnN0IGlmRWxzZSA9IChvblRydWUpID0+IChvbkZhbHNlKSA9PiAoZikgPT4gKHgpID0+IGYoeCkgPyBvblRydWUoeCkgOiBvbkZhbHNlKHgpO1xuZXhwb3J0IGNvbnN0IHVubGVzcyA9IChmKSA9PiAob25GYWxzZSkgPT4geCA9PiBmKHgpID8geCA6IG9uRmFsc2UoeCk7XG5leHBvcnQgY29uc3Qgd2hlbiA9IGZsb3cobm90LCB1bmxlc3MpO1xuZXhwb3J0IGNvbnN0IHVudGlsID0gKGYpID0+IChnKSA9PiB7XG4gICAgY29uc3QgaCA9IHggPT4gKGYoeCkgPyB4IDogaChnKHgpKSk7XG4gICAgcmV0dXJuIGg7XG59O1xuZXhwb3J0IGNvbnN0IGNvbnN0cnVjdCA9ICh4KSA9PiAoeHMpID0+IG5ldyB4KC4uLnhzKTtcbmV4cG9ydCBjb25zdCBpbnZva2UgPSAoeCkgPT4gKHlzKSA9PiAoeikgPT4gelt4XSguLi55cyk7XG5leHBvcnQgY29uc3QgaW52b2tlTnVsbGFyeSA9IGZsaXAoaW52b2tlKShbXSk7XG5leHBvcnQgY29uc3QgaW52b2tlT24gPSAoKSA9PiAoeCkgPT4geXMgPT4geiA9PiB6W3hdKC4uLnlzKTtcbmV4cG9ydCBjb25zdCBtZW1vaXplID0gKGVxKSA9PiAoZikgPT4ge1xuICAgIGNvbnN0IGNhY2hlID0gbmV3IE1hcCgpO1xuICAgIHJldHVybiBrID0+IHtcbiAgICAgICAgY29uc3QgY2FjaGVkID0gTS5sb29rdXAoZXEpKGspKGNhY2hlKTtcbiAgICAgICAgaWYgKE8uaXNTb21lKGNhY2hlZCkpXG4gICAgICAgICAgICByZXR1cm4gY2FjaGVkLnZhbHVlO1xuICAgICAgICBjb25zdCB2YWwgPSBmKGspO1xuICAgICAgICBjYWNoZS5zZXQoaywgdmFsKTtcbiAgICAgICAgcmV0dXJuIHZhbDtcbiAgICB9O1xufTtcbmV4cG9ydCBjb25zdCBjdXJyeTJUID0gKGYpID0+IChhKSA9PiAoYikgPT4gZihbYSwgYl0pO1xuZXhwb3J0IGNvbnN0IGN1cnJ5MiA9IGZsb3codW5hcnksIGN1cnJ5MlQpO1xuZXhwb3J0IGNvbnN0IGN1cnJ5M1QgPSAoZikgPT4gKGEpID0+IChiKSA9PiAoYykgPT4gZihbYSwgYiwgY10pO1xuZXhwb3J0IGNvbnN0IGN1cnJ5MyA9IGZsb3codW5hcnksIGN1cnJ5M1QpO1xuZXhwb3J0IGNvbnN0IGN1cnJ5NFQgPSAoZikgPT4gKGEpID0+IChiKSA9PiAoYykgPT4gKGQpID0+IGYoW2EsIGIsIGMsIGRdKTtcbmV4cG9ydCBjb25zdCBjdXJyeTQgPSBmbG93KHVuYXJ5LCBjdXJyeTRUKTtcbmV4cG9ydCBjb25zdCBjdXJyeTVUID0gKGYpID0+IChhKSA9PiAoYikgPT4gKGMpID0+IChkKSA9PiAoZSkgPT4gZihbYSwgYiwgYywgZCwgZV0pO1xuZXhwb3J0IGNvbnN0IGN1cnJ5NSA9IGZsb3codW5hcnksIGN1cnJ5NVQpO1xuZXhwb3J0IGNvbnN0IHVuY3VycnkyID0gKGYpID0+IChbYSwgYl0pID0+IGYoYSkoYik7XG5leHBvcnQgY29uc3QgdW5jdXJyeTMgPSAoZikgPT4gKFthLCBiLCBjXSkgPT4gZihhKShiKShjKTtcbmV4cG9ydCBjb25zdCB1bmN1cnJ5NCA9IChmKSA9PiAoW2EsIGIsIGMsIGRdKSA9PiBmKGEpKGIpKGMpKGQpO1xuZXhwb3J0IGNvbnN0IHVuY3Vycnk1ID0gKGYpID0+IChbYSwgYiwgYywgZCwgZV0pID0+IGYoYSkoYikoYykoZCkoZSk7XG5leHBvcnQgZnVuY3Rpb24gZm9yayhmcykge1xuICAgIHJldHVybiAoeCkgPT4gZnMubWFwKGYgPT4gZih4KSk7XG59XG5leHBvcnQgY29uc3QgY29udmVyZ2UgPSAoZikgPT4gKGdzKSA9PiBmbG93KHggPT4gZm9yayhncykoeCksIGYpO1xuZXhwb3J0IGNvbnN0IGlzSW5zdGFuY2VPZiA9ICh4KSA9PiAoeSkgPT4geSBpbnN0YW5jZW9mIHg7XG5leHBvcnQgY29uc3QgYXBwbHlFdmVyeSA9IGNvbmNhdEFsbChnZXRFbmRvTW9ub2lkKCkpO1xuZXhwb3J0IGNvbnN0IGFwcGx5U29tZXMgPSAoZnMpID0+IHggPT4gcGlwZShmcywgQS5yZWR1Y2UoeCwgKHksIG1mKSA9PiBwaXBlKG1mLCBPLm1hdGNoKGNvbnN0YW50KHkpLCBhcHBseSh5KSkpKSk7XG5leHBvcnQgY29uc3QgYXBwbHlOID0gKG4pID0+IChmKSA9PiBwaXBlKEEucmVwbGljYXRlKG4sIGYpLCBhcHBseUV2ZXJ5KTtcbiIsCiAgImltcG9ydCAqIGFzIE8gZnJvbSBcImZwLXRzL09wdGlvblwiO1xuaW1wb3J0ICogYXMgTSBmcm9tIFwiZnAtdHMvTWFwXCI7XG5pbXBvcnQgKiBhcyBBIGZyb20gXCJmcC10cy9BcnJheVwiO1xuaW1wb3J0IHsgZmxvdywgcGlwZSwgZ2V0TW9ub2lkIGFzIGdldEZ1bmN0aW9uTW9ub2lkLCBhcHBseSwgY29uc3RhbnQsIGZsaXAsIHR1cGxlZCwgfSBmcm9tIFwiZnAtdHMvZnVuY3Rpb25cIjtcbmltcG9ydCB7IG5vdCB9IGZyb20gXCJmcC10cy9QcmVkaWNhdGVcIjtcbmltcG9ydCB7IGdldE1vbm9pZCBhcyBnZXRFbmRvTW9ub2lkIH0gZnJvbSBcImZwLXRzL0VuZG9tb3JwaGlzbVwiO1xuaW1wb3J0IHsgY29uY2F0QWxsIH0gZnJvbSBcImZwLXRzL01vbm9pZFwiO1xuaW1wb3J0IHsgZmlyc3QgfSBmcm9tIFwiZnAtdHMvU2VtaWdyb3VwXCI7XG5pbXBvcnQgeyBiaW5kVG8gYXMgYmluZFRvXywgbGV0IGFzIGxldF9fIH0gZnJvbSBcImZwLXRzL0Z1bmN0b3JcIjtcbmltcG9ydCB7IGFwRmlyc3QgYXMgYXBGaXJzdF8sIGFwU2Vjb25kIGFzIGFwU2Vjb25kXywgYXBTIGFzIGFwU18sIH0gZnJvbSBcImZwLXRzL0FwcGx5XCI7XG5pbXBvcnQgeyBiaW5kIGFzIGJpbmRfIH0gZnJvbSBcImZwLXRzL0NoYWluXCI7XG5leHBvcnQgY29uc3QgVVJJID0gXCJGdW5jdGlvblwiO1xuZXhwb3J0IGNvbnN0IG1hcCA9IGYgPT4gZyA9PiBmbG93KGcsIGYpO1xuZXhwb3J0IGNvbnN0IEZ1bmN0b3IgPSB7XG4gICAgVVJJLFxuICAgIG1hcDogKGYsIGcpID0+IG1hcChnKShmKSxcbn07XG5leHBvcnQgY29uc3Qgb2YgPSBjb25zdGFudDtcbmV4cG9ydCBjb25zdCBhcCA9IGYgPT4gZyA9PiB4ID0+IGcoeCkoZih4KSk7XG5leHBvcnQgY29uc3QgQXBwbGljYXRpdmUgPSB7XG4gICAgLi4uRnVuY3RvcixcbiAgICBvZixcbiAgICBhcDogKGYsIGcpID0+IGFwKGcpKGYpLFxufTtcbmV4cG9ydCBjb25zdCBhcEZpcnN0ID0gYXBGaXJzdF8oQXBwbGljYXRpdmUpO1xuZXhwb3J0IGNvbnN0IGFwU2Vjb25kID0gYXBTZWNvbmRfKEFwcGxpY2F0aXZlKTtcbmV4cG9ydCBjb25zdCBjaGFpbiA9IGYgPT4gZyA9PiB4ID0+IGYoZyh4KSkoeCk7XG5leHBvcnQgY29uc3QgZmxhdE1hcCA9IGNoYWluO1xuZXhwb3J0IGNvbnN0IE1vbmFkID0ge1xuICAgIC4uLkFwcGxpY2F0aXZlLFxuICAgIGNoYWluOiAoZiwgZykgPT4gY2hhaW4oZykoZiksXG59O1xuZXhwb3J0IGNvbnN0IERvID0gb2Yoe30pO1xuZXhwb3J0IGNvbnN0IGJpbmRUbyA9IGJpbmRUb18oRnVuY3Rvcik7XG5leHBvcnQgY29uc3QgYmluZCA9IGJpbmRfKE1vbmFkKTtcbmV4cG9ydCBjb25zdCBhcFMgPSBhcFNfKEFwcGxpY2F0aXZlKTtcbmNvbnN0IGxldF8gPSBsZXRfXyhGdW5jdG9yKTtcbmV4cG9ydCB7IGxldF8gYXMgbGV0LCB9O1xuZXhwb3J0IGNvbnN0IHdpdGhJbmRleCA9IGYgPT4gZyA9PiB4cyA9PiB7XG4gICAgbGV0IGkgPSAwO1xuICAgIHJldHVybiBmKHkgPT4gZyhpKyspKHkpKSh4cyk7XG59O1xuZXhwb3J0IGNvbnN0IHVuYXJ5ID0gdHVwbGVkO1xuZXhwb3J0IGNvbnN0IGd1YXJkID0gKGJyYW5jaGVzKSA9PiAoZmFsbGJhY2spID0+IChpbnB1dCkgPT4gcGlwZShicmFuY2hlcywgQS5tYXAoKFtmLCBnXSkgPT4gZmxvdyhPLmZyb21QcmVkaWNhdGUoZiksIE8ubWFwKGcpKSksIGNvbmNhdEFsbChnZXRGdW5jdGlvbk1vbm9pZChPLmdldE1vbm9pZChmaXJzdCgpKSkoKSksIGFwcGx5KGlucHV0KSwgTy5nZXRPckVsc2UoKCkgPT4gZmFsbGJhY2soaW5wdXQpKSk7XG5leHBvcnQgY29uc3QgaWZFbHNlID0gKG9uVHJ1ZSkgPT4gKG9uRmFsc2UpID0+IChmKSA9PiAoeCkgPT4gZih4KSA/IG9uVHJ1ZSh4KSA6IG9uRmFsc2UoeCk7XG5leHBvcnQgY29uc3QgdW5sZXNzID0gKGYpID0+IChvbkZhbHNlKSA9PiB4ID0+IGYoeCkgPyB4IDogb25GYWxzZSh4KTtcbmV4cG9ydCBjb25zdCB3aGVuID0gZmxvdyhub3QsIHVubGVzcyk7XG5leHBvcnQgY29uc3QgdW50aWwgPSAoZikgPT4gKGcpID0+IHtcbiAgICBjb25zdCBoID0geCA9PiAoZih4KSA/IHggOiBoKGcoeCkpKTtcbiAgICByZXR1cm4gaDtcbn07XG5leHBvcnQgY29uc3QgY29uc3RydWN0ID0gKHgpID0+ICh4cykgPT4gbmV3IHgoLi4ueHMpO1xuZXhwb3J0IGNvbnN0IGludm9rZSA9ICh4KSA9PiAoeXMpID0+ICh6KSA9PiB6W3hdKC4uLnlzKTtcbmV4cG9ydCBjb25zdCBpbnZva2VOdWxsYXJ5ID0gZmxpcChpbnZva2UpKFtdKTtcbmV4cG9ydCBjb25zdCBpbnZva2VPbiA9ICgpID0+ICh4KSA9PiB5cyA9PiB6ID0+IHpbeF0oLi4ueXMpO1xuZXhwb3J0IGNvbnN0IG1lbW9pemUgPSAoZXEpID0+IChmKSA9PiB7XG4gICAgY29uc3QgY2FjaGUgPSBuZXcgTWFwKCk7XG4gICAgcmV0dXJuIGsgPT4ge1xuICAgICAgICBjb25zdCBjYWNoZWQgPSBNLmxvb2t1cChlcSkoaykoY2FjaGUpO1xuICAgICAgICBpZiAoTy5pc1NvbWUoY2FjaGVkKSlcbiAgICAgICAgICAgIHJldHVybiBjYWNoZWQudmFsdWU7XG4gICAgICAgIGNvbnN0IHZhbCA9IGYoayk7XG4gICAgICAgIGNhY2hlLnNldChrLCB2YWwpO1xuICAgICAgICByZXR1cm4gdmFsO1xuICAgIH07XG59O1xuZXhwb3J0IGNvbnN0IGN1cnJ5MlQgPSAoZikgPT4gKGEpID0+IChiKSA9PiBmKFthLCBiXSk7XG5leHBvcnQgY29uc3QgY3VycnkyID0gZmxvdyh1bmFyeSwgY3VycnkyVCk7XG5leHBvcnQgY29uc3QgY3VycnkzVCA9IChmKSA9PiAoYSkgPT4gKGIpID0+IChjKSA9PiBmKFthLCBiLCBjXSk7XG5leHBvcnQgY29uc3QgY3VycnkzID0gZmxvdyh1bmFyeSwgY3VycnkzVCk7XG5leHBvcnQgY29uc3QgY3Vycnk0VCA9IChmKSA9PiAoYSkgPT4gKGIpID0+IChjKSA9PiAoZCkgPT4gZihbYSwgYiwgYywgZF0pO1xuZXhwb3J0IGNvbnN0IGN1cnJ5NCA9IGZsb3codW5hcnksIGN1cnJ5NFQpO1xuZXhwb3J0IGNvbnN0IGN1cnJ5NVQgPSAoZikgPT4gKGEpID0+IChiKSA9PiAoYykgPT4gKGQpID0+IChlKSA9PiBmKFthLCBiLCBjLCBkLCBlXSk7XG5leHBvcnQgY29uc3QgY3Vycnk1ID0gZmxvdyh1bmFyeSwgY3Vycnk1VCk7XG5leHBvcnQgY29uc3QgdW5jdXJyeTIgPSAoZikgPT4gKFthLCBiXSkgPT4gZihhKShiKTtcbmV4cG9ydCBjb25zdCB1bmN1cnJ5MyA9IChmKSA9PiAoW2EsIGIsIGNdKSA9PiBmKGEpKGIpKGMpO1xuZXhwb3J0IGNvbnN0IHVuY3Vycnk0ID0gKGYpID0+IChbYSwgYiwgYywgZF0pID0+IGYoYSkoYikoYykoZCk7XG5leHBvcnQgY29uc3QgdW5jdXJyeTUgPSAoZikgPT4gKFthLCBiLCBjLCBkLCBlXSkgPT4gZihhKShiKShjKShkKShlKTtcbmV4cG9ydCBmdW5jdGlvbiBmb3JrKGZzKSB7XG4gICAgcmV0dXJuICh4KSA9PiBmcy5tYXAoZiA9PiBmKHgpKTtcbn1cbmV4cG9ydCBjb25zdCBjb252ZXJnZSA9IChmKSA9PiAoZ3MpID0+IGZsb3coeCA9PiBmb3JrKGdzKSh4KSwgZik7XG5leHBvcnQgY29uc3QgaXNJbnN0YW5jZU9mID0gKHgpID0+ICh5KSA9PiB5IGluc3RhbmNlb2YgeDtcbmV4cG9ydCBjb25zdCBhcHBseUV2ZXJ5ID0gY29uY2F0QWxsKGdldEVuZG9Nb25vaWQoKSk7XG5leHBvcnQgY29uc3QgYXBwbHlTb21lcyA9IChmcykgPT4geCA9PiBwaXBlKGZzLCBBLnJlZHVjZSh4LCAoeSwgbWYpID0+IHBpcGUobWYsIE8ubWF0Y2goY29uc3RhbnQoeSksIGFwcGx5KHkpKSkpKTtcbmV4cG9ydCBjb25zdCBhcHBseU4gPSAobikgPT4gKGYpID0+IHBpcGUoQS5yZXBsaWNhdGUobiwgZiksIGFwcGx5RXZlcnkpO1xuIiwKICAiaW1wb3J0ICogYXMgTyBmcm9tIFwiZnAtdHMvT3B0aW9uXCI7XG5pbXBvcnQgKiBhcyBNIGZyb20gXCJmcC10cy9NYXBcIjtcbmltcG9ydCAqIGFzIEEgZnJvbSBcImZwLXRzL0FycmF5XCI7XG5pbXBvcnQgeyBmbG93LCBwaXBlLCBnZXRNb25vaWQgYXMgZ2V0RnVuY3Rpb25Nb25vaWQsIGFwcGx5LCBjb25zdGFudCwgZmxpcCwgdHVwbGVkLCB9IGZyb20gXCJmcC10cy9mdW5jdGlvblwiO1xuaW1wb3J0IHsgbm90IH0gZnJvbSBcImZwLXRzL1ByZWRpY2F0ZVwiO1xuaW1wb3J0IHsgZ2V0TW9ub2lkIGFzIGdldEVuZG9Nb25vaWQgfSBmcm9tIFwiZnAtdHMvRW5kb21vcnBoaXNtXCI7XG5pbXBvcnQgeyBjb25jYXRBbGwgfSBmcm9tIFwiZnAtdHMvTW9ub2lkXCI7XG5pbXBvcnQgeyBmaXJzdCB9IGZyb20gXCJmcC10cy9TZW1pZ3JvdXBcIjtcbmltcG9ydCB7IGJpbmRUbyBhcyBiaW5kVG9fLCBsZXQgYXMgbGV0X18gfSBmcm9tIFwiZnAtdHMvRnVuY3RvclwiO1xuaW1wb3J0IHsgYXBGaXJzdCBhcyBhcEZpcnN0XywgYXBTZWNvbmQgYXMgYXBTZWNvbmRfLCBhcFMgYXMgYXBTXywgfSBmcm9tIFwiZnAtdHMvQXBwbHlcIjtcbmltcG9ydCB7IGJpbmQgYXMgYmluZF8gfSBmcm9tIFwiZnAtdHMvQ2hhaW5cIjtcbmV4cG9ydCBjb25zdCBVUkkgPSBcIkZ1bmN0aW9uXCI7XG5leHBvcnQgY29uc3QgbWFwID0gZiA9PiBnID0+IGZsb3coZywgZik7XG5leHBvcnQgY29uc3QgRnVuY3RvciA9IHtcbiAgICBVUkksXG4gICAgbWFwOiAoZiwgZykgPT4gbWFwKGcpKGYpLFxufTtcbmV4cG9ydCBjb25zdCBvZiA9IGNvbnN0YW50O1xuZXhwb3J0IGNvbnN0IGFwID0gZiA9PiBnID0+IHggPT4gZyh4KShmKHgpKTtcbmV4cG9ydCBjb25zdCBBcHBsaWNhdGl2ZSA9IHtcbiAgICAuLi5GdW5jdG9yLFxuICAgIG9mLFxuICAgIGFwOiAoZiwgZykgPT4gYXAoZykoZiksXG59O1xuZXhwb3J0IGNvbnN0IGFwRmlyc3QgPSBhcEZpcnN0XyhBcHBsaWNhdGl2ZSk7XG5leHBvcnQgY29uc3QgYXBTZWNvbmQgPSBhcFNlY29uZF8oQXBwbGljYXRpdmUpO1xuZXhwb3J0IGNvbnN0IGNoYWluID0gZiA9PiBnID0+IHggPT4gZihnKHgpKSh4KTtcbmV4cG9ydCBjb25zdCBmbGF0TWFwID0gY2hhaW47XG5leHBvcnQgY29uc3QgTW9uYWQgPSB7XG4gICAgLi4uQXBwbGljYXRpdmUsXG4gICAgY2hhaW46IChmLCBnKSA9PiBjaGFpbihnKShmKSxcbn07XG5leHBvcnQgY29uc3QgRG8gPSBvZih7fSk7XG5leHBvcnQgY29uc3QgYmluZFRvID0gYmluZFRvXyhGdW5jdG9yKTtcbmV4cG9ydCBjb25zdCBiaW5kID0gYmluZF8oTW9uYWQpO1xuZXhwb3J0IGNvbnN0IGFwUyA9IGFwU18oQXBwbGljYXRpdmUpO1xuY29uc3QgbGV0XyA9IGxldF9fKEZ1bmN0b3IpO1xuZXhwb3J0IHsgbGV0XyBhcyBsZXQsIH07XG5leHBvcnQgY29uc3Qgd2l0aEluZGV4ID0gZiA9PiBnID0+IHhzID0+IHtcbiAgICBsZXQgaSA9IDA7XG4gICAgcmV0dXJuIGYoeSA9PiBnKGkrKykoeSkpKHhzKTtcbn07XG5leHBvcnQgY29uc3QgdW5hcnkgPSB0dXBsZWQ7XG5leHBvcnQgY29uc3QgZ3VhcmQgPSAoYnJhbmNoZXMpID0+IChmYWxsYmFjaykgPT4gKGlucHV0KSA9PiBwaXBlKGJyYW5jaGVzLCBBLm1hcCgoW2YsIGddKSA9PiBmbG93KE8uZnJvbVByZWRpY2F0ZShmKSwgTy5tYXAoZykpKSwgY29uY2F0QWxsKGdldEZ1bmN0aW9uTW9ub2lkKE8uZ2V0TW9ub2lkKGZpcnN0KCkpKSgpKSwgYXBwbHkoaW5wdXQpLCBPLmdldE9yRWxzZSgoKSA9PiBmYWxsYmFjayhpbnB1dCkpKTtcbmV4cG9ydCBjb25zdCBpZkVsc2UgPSAob25UcnVlKSA9PiAob25GYWxzZSkgPT4gKGYpID0+ICh4KSA9PiBmKHgpID8gb25UcnVlKHgpIDogb25GYWxzZSh4KTtcbmV4cG9ydCBjb25zdCB1bmxlc3MgPSAoZikgPT4gKG9uRmFsc2UpID0+IHggPT4gZih4KSA/IHggOiBvbkZhbHNlKHgpO1xuZXhwb3J0IGNvbnN0IHdoZW4gPSBmbG93KG5vdCwgdW5sZXNzKTtcbmV4cG9ydCBjb25zdCB1bnRpbCA9IChmKSA9PiAoZykgPT4ge1xuICAgIGNvbnN0IGggPSB4ID0+IChmKHgpID8geCA6IGgoZyh4KSkpO1xuICAgIHJldHVybiBoO1xufTtcbmV4cG9ydCBjb25zdCBjb25zdHJ1Y3QgPSAoeCkgPT4gKHhzKSA9PiBuZXcgeCguLi54cyk7XG5leHBvcnQgY29uc3QgaW52b2tlID0gKHgpID0+ICh5cykgPT4gKHopID0+IHpbeF0oLi4ueXMpO1xuZXhwb3J0IGNvbnN0IGludm9rZU51bGxhcnkgPSBmbGlwKGludm9rZSkoW10pO1xuZXhwb3J0IGNvbnN0IGludm9rZU9uID0gKCkgPT4gKHgpID0+IHlzID0+IHogPT4gelt4XSguLi55cyk7XG5leHBvcnQgY29uc3QgbWVtb2l6ZSA9IChlcSkgPT4gKGYpID0+IHtcbiAgICBjb25zdCBjYWNoZSA9IG5ldyBNYXAoKTtcbiAgICByZXR1cm4gayA9PiB7XG4gICAgICAgIGNvbnN0IGNhY2hlZCA9IE0ubG9va3VwKGVxKShrKShjYWNoZSk7XG4gICAgICAgIGlmIChPLmlzU29tZShjYWNoZWQpKVxuICAgICAgICAgICAgcmV0dXJuIGNhY2hlZC52YWx1ZTtcbiAgICAgICAgY29uc3QgdmFsID0gZihrKTtcbiAgICAgICAgY2FjaGUuc2V0KGssIHZhbCk7XG4gICAgICAgIHJldHVybiB2YWw7XG4gICAgfTtcbn07XG5leHBvcnQgY29uc3QgY3VycnkyVCA9IChmKSA9PiAoYSkgPT4gKGIpID0+IGYoW2EsIGJdKTtcbmV4cG9ydCBjb25zdCBjdXJyeTIgPSBmbG93KHVuYXJ5LCBjdXJyeTJUKTtcbmV4cG9ydCBjb25zdCBjdXJyeTNUID0gKGYpID0+IChhKSA9PiAoYikgPT4gKGMpID0+IGYoW2EsIGIsIGNdKTtcbmV4cG9ydCBjb25zdCBjdXJyeTMgPSBmbG93KHVuYXJ5LCBjdXJyeTNUKTtcbmV4cG9ydCBjb25zdCBjdXJyeTRUID0gKGYpID0+IChhKSA9PiAoYikgPT4gKGMpID0+IChkKSA9PiBmKFthLCBiLCBjLCBkXSk7XG5leHBvcnQgY29uc3QgY3Vycnk0ID0gZmxvdyh1bmFyeSwgY3Vycnk0VCk7XG5leHBvcnQgY29uc3QgY3Vycnk1VCA9IChmKSA9PiAoYSkgPT4gKGIpID0+IChjKSA9PiAoZCkgPT4gKGUpID0+IGYoW2EsIGIsIGMsIGQsIGVdKTtcbmV4cG9ydCBjb25zdCBjdXJyeTUgPSBmbG93KHVuYXJ5LCBjdXJyeTVUKTtcbmV4cG9ydCBjb25zdCB1bmN1cnJ5MiA9IChmKSA9PiAoW2EsIGJdKSA9PiBmKGEpKGIpO1xuZXhwb3J0IGNvbnN0IHVuY3VycnkzID0gKGYpID0+IChbYSwgYiwgY10pID0+IGYoYSkoYikoYyk7XG5leHBvcnQgY29uc3QgdW5jdXJyeTQgPSAoZikgPT4gKFthLCBiLCBjLCBkXSkgPT4gZihhKShiKShjKShkKTtcbmV4cG9ydCBjb25zdCB1bmN1cnJ5NSA9IChmKSA9PiAoW2EsIGIsIGMsIGQsIGVdKSA9PiBmKGEpKGIpKGMpKGQpKGUpO1xuZXhwb3J0IGZ1bmN0aW9uIGZvcmsoZnMpIHtcbiAgICByZXR1cm4gKHgpID0+IGZzLm1hcChmID0+IGYoeCkpO1xufVxuZXhwb3J0IGNvbnN0IGNvbnZlcmdlID0gKGYpID0+IChncykgPT4gZmxvdyh4ID0+IGZvcmsoZ3MpKHgpLCBmKTtcbmV4cG9ydCBjb25zdCBpc0luc3RhbmNlT2YgPSAoeCkgPT4gKHkpID0+IHkgaW5zdGFuY2VvZiB4O1xuZXhwb3J0IGNvbnN0IGFwcGx5RXZlcnkgPSBjb25jYXRBbGwoZ2V0RW5kb01vbm9pZCgpKTtcbmV4cG9ydCBjb25zdCBhcHBseVNvbWVzID0gKGZzKSA9PiB4ID0+IHBpcGUoZnMsIEEucmVkdWNlKHgsICh5LCBtZikgPT4gcGlwZShtZiwgTy5tYXRjaChjb25zdGFudCh5KSwgYXBwbHkoeSkpKSkpO1xuZXhwb3J0IGNvbnN0IGFwcGx5TiA9IChuKSA9PiAoZikgPT4gcGlwZShBLnJlcGxpY2F0ZShuLCBmKSwgYXBwbHlFdmVyeSk7XG4iLAogICJpbXBvcnQgeyBjb25zdGFudCwgcGlwZSwgZmxvdywgZmxpcCB9IGZyb20gXCJmcC10cy9mdW5jdGlvblwiO1xuaW1wb3J0IHsgbm90IH0gZnJvbSBcImZwLXRzL1ByZWRpY2F0ZVwiO1xuaW1wb3J0IHsgbWF0Y2ggYXMgb3JkZXJpbmdNYXRjaCB9IGZyb20gXCJmcC10cy9PcmRlcmluZ1wiO1xuaW1wb3J0IHsgT3JkIGFzIG9yZE51bWJlciwgTW9ub2lkUHJvZHVjdCwgTW9ub2lkU3VtIH0gZnJvbSBcImZwLXRzL251bWJlclwiO1xuaW1wb3J0ICogYXMgTkVBIGZyb20gXCJmcC10cy9Ob25FbXB0eUFycmF5XCI7XG5pbXBvcnQgKiBhcyBSQSBmcm9tIFwiZnAtdHMvUmVhZG9ubHlBcnJheVwiO1xuaW1wb3J0ICogYXMgQSBmcm9tIFwiZnAtdHMvQXJyYXlcIjtcbmltcG9ydCAqIGFzIFIgZnJvbSBcImZwLXRzL1JlY29yZFwiO1xuaW1wb3J0ICogYXMgTyBmcm9tIFwiZnAtdHMvT3B0aW9uXCI7XG5pbXBvcnQgKiBhcyBCIGZyb20gXCJmcC10cy9ib29sZWFuXCI7XG5pbXBvcnQgeyByZWR1Y2VNIH0gZnJvbSBcImZwLXRzL0ZvbGRhYmxlXCI7XG5pbXBvcnQgeyBjb25jYXRBbGwgfSBmcm9tIFwiZnAtdHMvTW9ub2lkXCI7XG5pbXBvcnQgeyBtYXgsIG1pbiB9IGZyb20gXCJmcC10cy9TZW1pZ3JvdXBcIjtcbmltcG9ydCB7IGludm9rZSB9IGZyb20gXCIuL0Z1bmN0aW9uXCI7XG5pbXBvcnQgKiBhcyBUIGZyb20gXCJmcC10cy9UaGVzZVwiO1xuZXhwb3J0IGNvbnN0IGVsZW1WID0gKGVxKSA9PiAoeHMpID0+IHkgPT4gQS5lbGVtKGVxKSh5KSh4cyk7XG5leHBvcnQgY29uc3Qgbm9uZSA9IGZsb3cobm90LCBwID0+IEEuZXZlcnkocCkpO1xuZXhwb3J0IGNvbnN0IGpvaW4gPSAoeCkgPT4gaW52b2tlKFwiam9pblwiKShbeF0pO1xuZXhwb3J0IGNvbnN0IGdldERpc29yZGVyZWRFcSA9IChvcmRBKSA9PiAoe1xuICAgIGVxdWFsczogKHhzLCB5cykgPT4ge1xuICAgICAgICBjb25zdCBzb3J0ID0gQS5zb3J0KG9yZEEpO1xuICAgICAgICByZXR1cm4gQS5nZXRFcShvcmRBKS5lcXVhbHMoc29ydCh4cyksIHNvcnQoeXMpKTtcbiAgICB9LFxufSk7XG5leHBvcnQgY29uc3QgcGx1Y2tGaXJzdCA9IChwKSA9PiAoeHMpID0+IHBpcGUoQS5maW5kSW5kZXgocCkoeHMpLCBPLmZvbGQoY29uc3RhbnQoW08ubm9uZSwgeHNdKSwgaSA9PiBbXG4gICAgTy5zb21lKHhzW2ldKSxcbiAgICBBLnVuc2FmZURlbGV0ZUF0KGksIHhzKSxcbl0pKTtcbmV4cG9ydCBjb25zdCB1cHNlcnQgPSAoZXFBKSA9PiAoeCkgPT4gKHlzKSA9PiBwaXBlKEEuZmluZEluZGV4KHkgPT4gZXFBLmVxdWFscyh4LCB5KSkoeXMpLCBPLm1hcChpID0+IEEudW5zYWZlVXBkYXRlQXQoaSwgeCwgeXMpKSwgTy5jaGFpbihORUEuZnJvbUFycmF5KSwgTy5nZXRPckVsc2UoKCkgPT4gQS5hcHBlbmQoeCkoeXMpKSk7XG5leHBvcnQgY29uc3QgaW5zZXJ0TWFueSA9IChpKSA9PiAoeHMpID0+ICh5cykgPT4gcGlwZSh4cywgQS5yZXZlcnNlLCByZWR1Y2VNKE8uTW9uYWQsIEEuRm9sZGFibGUpKHlzLCAoenMsIHgpID0+IHBpcGUoenMsIEEuaW5zZXJ0QXQoaSwgeCkpKSwgTy5jaGFpbihORUEuZnJvbUFycmF5KSk7XG5leHBvcnQgY29uc3QgZHJvcFJlcGVhdHMgPSBlcSA9PiB4cyA9PiBwaXBlKHhzLCBBLmZpbHRlcldpdGhJbmRleCgoaSwgeCkgPT4gaSA9PT0gMCB8fCAhZXEuZXF1YWxzKHgsIHhzW2kgLSAxXSkpKTtcbmV4cG9ydCBjb25zdCBzdGFydHNXaXRoID0gKGVxKSA9PiAoc3RhcnQpID0+IGZsb3coQS50YWtlTGVmdChzdGFydC5sZW5ndGgpLCB4cyA9PiBBLmdldEVxKGVxKS5lcXVhbHMoeHMsIHN0YXJ0KSk7XG5leHBvcnQgY29uc3QgZW5kc1dpdGggPSAoZXEpID0+IChlbmQpID0+IGZsb3coQS50YWtlUmlnaHQoZW5kLmxlbmd0aCksIHhzID0+IEEuZ2V0RXEoZXEpLmVxdWFscyh4cywgZW5kKSk7XG5leHBvcnQgY29uc3Qgd2l0aG91dCA9IChlcSkgPT4gKHhzKSA9PiBBLmZpbHRlcih5ID0+ICFBLmVsZW0oZXEpKHkpKHhzKSk7XG5leHBvcnQgY29uc3QgY2FydGVzaWFuID0gKHhzKSA9PiAoeXMpID0+IHBpcGUoeHMsIEEuY2hhaW4oeCA9PiBwaXBlKHlzLCBBLm1hcCh5ID0+IFt4LCB5XSkpKSk7XG5leHBvcnQgY29uc3Qgc3VtID0gY29uY2F0QWxsKE1vbm9pZFN1bSk7XG5leHBvcnQgY29uc3QgcHJvZHVjdCA9IGNvbmNhdEFsbChNb25vaWRQcm9kdWN0KTtcbmV4cG9ydCBjb25zdCBtZWFuID0gKHhzKSA9PiBzdW0oeHMpIC8geHMubGVuZ3RoO1xuZXhwb3J0IGNvbnN0IG1lZGlhbiA9IGZsb3coTkVBLnNvcnQob3JkTnVtYmVyKSwgeHMgPT4ge1xuICAgIGNvbnN0IGkgPSB4cy5sZW5ndGggLyAyO1xuICAgIHJldHVybiBpICUgMSA9PT0gMCA/ICh4c1tpIC0gMV0gKyB4c1tpXSkgLyAyIDogeHNbTWF0aC5mbG9vcihpKV07XG59KTtcbmV4cG9ydCBjb25zdCBhcGVydHVyZSA9IChuKSA9PiAoeHMpID0+IHtcbiAgICBjb25zdCBnbyA9IChpKSA9PiAoeXMpID0+IGkgKyBuID4geHMubGVuZ3RoID8geXMgOiBnbyhpICsgMSkoQS5hcHBlbmQoc2xpY2UoaSkobiArIGkpKHhzKSkoeXMpKTtcbiAgICByZXR1cm4gbiA8IDEgPyBbXSA6IGdvKDApKFtdKTtcbn07XG5leHBvcnQgY29uc3Qgc2xpY2UgPSAoc3RhcnQpID0+IChlbmQpID0+IGludm9rZShcInNsaWNlXCIpKFtzdGFydCwgZW5kXSk7XG5leHBvcnQgY29uc3QgcmVqZWN0ID0gKGYpID0+IEEuZmlsdGVyKG5vdChmKSk7XG5leHBvcnQgY29uc3QgbW92ZUZyb20gPSAoZnJvbSkgPT4gKHRvKSA9PiAoeHMpID0+IGZyb20gPj0geHMubGVuZ3RoIHx8IHRvID49IHhzLmxlbmd0aFxuICAgID8gTy5ub25lXG4gICAgOiBmcm9tID09PSB0b1xuICAgICAgICA/IE8uc29tZSh4cylcbiAgICAgICAgOiBwaXBlKHhzLCBBLmxvb2t1cChmcm9tKSwgTy5jaGFpbih4ID0+IHBpcGUoQS5kZWxldGVBdChmcm9tKSh4cyksIE8uY2hhaW4oQS5pbnNlcnRBdCh0bywgeCkpKSkpO1xuZXhwb3J0IGNvbnN0IG1vdmVUbyA9IGZsaXAobW92ZUZyb20pO1xuZXhwb3J0IGNvbnN0IGNvdW50QnkgPSAoZikgPT4gKHhzKSA9PiBSLmZyb21Gb2xkYWJsZU1hcChNb25vaWRTdW0sIEEuRm9sZGFibGUpKHhzLCB4ID0+IFtmKHgpLCAxXSk7XG5leHBvcnQgY29uc3QgZHJvcFJpZ2h0V2hpbGUgPSAoZikgPT4gZmxvdyhBLnJldmVyc2UsIEEuZHJvcExlZnRXaGlsZShmKSwgQS5yZXZlcnNlKTtcbmV4cG9ydCBjb25zdCBkcm9wQXQgPSAoaSkgPT4gKG4pID0+ICh4cykgPT4gcGlwZShBLmlzT3V0T2ZCb3VuZChpLCB4cyksIEIuZm9sZCgoKSA9PiBwaXBlKEEuY29weSh4cyksIHlzID0+IHtcbiAgICB5cy5zcGxpY2UoaSwgbik7XG4gICAgcmV0dXJuIHlzO1xufSwgTy5zb21lKSwgY29uc3RhbnQoTy5ub25lKSkpO1xuZXhwb3J0IGNvbnN0IHRyYW5zcG9zZSA9ICh4cykgPT4ge1xuICAgIGlmIChBLmlzRW1wdHkoeHMpKVxuICAgICAgICByZXR1cm4gW107XG4gICAgaWYgKEEuaXNFbXB0eSh4c1swXSkpXG4gICAgICAgIHJldHVybiB0cmFuc3Bvc2UoQS5kcm9wTGVmdCgxKSh4cykpO1xuICAgIGNvbnN0IFtbeSwgLi4ueXNdLCAuLi55c3NdID0geHM7XG4gICAgY29uc3QgenMgPSBbeSwgLi4uQS5maWx0ZXJNYXAoQS5oZWFkKSh5c3MpXTtcbiAgICBjb25zdCB6c3MgPSBbeXMsIC4uLkEubWFwKEEuZHJvcExlZnQoMSkpKHlzcyldO1xuICAgIHJldHVybiBbenMsIC4uLnRyYW5zcG9zZSh6c3MpXTtcbn07XG5leHBvcnQgY29uc3QgdGFrZVJpZ2h0V2hpbGUgPSAoZikgPT4gZmxvdyhBLnJldmVyc2UsIEEudGFrZUxlZnRXaGlsZShmKSwgQS5yZXZlcnNlKTtcbmV4cG9ydCBjb25zdCBzeW1tZXRyaWNEaWZmZXJlbmNlID0gKGVxKSA9PiAoeHMpID0+IHlzID0+IEEuZ2V0TW9ub2lkKCkuY29uY2F0KEEuZGlmZmVyZW5jZShlcSkoeXMpKHhzKSwgQS5kaWZmZXJlbmNlKGVxKSh4cykoeXMpKTtcbmV4cG9ydCBjb25zdCByZWR1Y2VXaGlsZSA9IChwKSA9PiAoZikgPT4ge1xuICAgIGNvbnN0IGdvID0gKGFjYykgPT4gKHlzKSA9PiBwaXBlKE5FQS5mcm9tQXJyYXkoeXMpLCBPLmZpbHRlcihmbG93KE5FQS5oZWFkLCBwKSksIE8uZm9sZChjb25zdGFudChhY2MpLCBmbG93KE5FQS51bnByZXBlbmQsIChbeiwgenNdKSA9PiBnbyhmKHopKGFjYykpKHpzKSkpKTtcbiAgICByZXR1cm4gZ287XG59O1xuZXhwb3J0IGNvbnN0IHJlZHVjZVJpZ2h0V2hpbGUgPSAocCkgPT4gKGYpID0+ICh4KSA9PiBmbG93KEEucmV2ZXJzZSwgcmVkdWNlV2hpbGUocCkoZikoeCkpO1xuZXhwb3J0IGNvbnN0IG1pbmltdW0gPSBmbG93KG1pbiwgTkVBLmNvbmNhdEFsbCk7XG5leHBvcnQgY29uc3QgbWF4aW11bSA9IGZsb3cobWF4LCBORUEuY29uY2F0QWxsKTtcbmV4cG9ydCBjb25zdCB6aXBBbGwgPSAoeHMpID0+ICh5cykgPT4ge1xuICAgIGNvbnN0IHpzID0gQS56aXAoeXMsIHhzKTtcbiAgICBjb25zdCBnZXRSZW0gPSBzbGljZShBLnNpemUoenMpKShJbmZpbml0eSk7XG4gICAgY29uc3QgcmVzdCA9IHBpcGUob3JkTnVtYmVyLmNvbXBhcmUoQS5zaXplKHlzKSwgQS5zaXplKHhzKSksIG9yZGVyaW5nTWF0Y2goKCkgPT4gcGlwZSh4cywgZ2V0UmVtLCBBLm1hcChULnJpZ2h0KSksIGNvbnN0YW50KEEuZW1wdHkpLCAoKSA9PiBwaXBlKHlzLCBnZXRSZW0sIEEubWFwKFQubGVmdCkpKSk7XG4gICAgcmV0dXJuIHBpcGUoenMsIEEubWFwKChbemEsIHpiXSkgPT4gVC5ib3RoKHphLCB6YikpLCBBLmNvbmNhdChyZXN0KSk7XG59O1xuZXhwb3J0IGZ1bmN0aW9uIGZpbHRlckEoRikge1xuICAgIHJldHVybiBwID0+IHhzID0+IEEuV2l0aGVyYWJsZS53aXRoZXIoRikoeHMsIHggPT4gRi5tYXAocCh4KSwgeSA9PiAoeSA/IE8uc29tZSh4KSA6IE8ubm9uZSkpKTtcbn1cbmV4cG9ydCBjb25zdCBleHRyYWN0QXQgPSAoaSkgPT4gKHhzKSA9PiBwaXBlKHhzLCBBLmxvb2t1cChpKSwgTy5tYXAoeCA9PiBbeCwgQS51bnNhZmVEZWxldGVBdChpLCB4cyldKSk7XG5leHBvcnQgY29uc3QgZnJvbUl0ZXJhYmxlID0gQXJyYXkuZnJvbTtcbmV4cG9ydCBjb25zdCBmcm9tUmVhZG9ubHkgPSBSQS50b0FycmF5O1xuZXhwb3J0IGNvbnN0IHRvUmVhZG9ubHkgPSBSQS5mcm9tQXJyYXk7XG5leHBvcnQgZnVuY3Rpb24gYWxsTShNKSB7XG4gICAgcmV0dXJuIEEucmVkdWNlKE0ub2YodHJ1ZSksICh4LCB5KSA9PiBNLmNoYWluKHgsIGIgPT4gKGIgPyB5IDogTS5vZihmYWxzZSkpKSk7XG59XG5leHBvcnQgZnVuY3Rpb24gYW55TShNKSB7XG4gICAgcmV0dXJuIEEucmVkdWNlKE0ub2YoZmFsc2UpLCAoeCwgeSkgPT4gTS5jaGFpbih4LCBiID0+IChiID8gTS5vZih0cnVlKSA6IHkpKSk7XG59XG5leHBvcnQgY29uc3Qgc2VwYXJhdGVORSA9ICh4cykgPT4gcGlwZSh4cywgQS5zZXBhcmF0ZSwgKHsgbGVmdCwgcmlnaHQgfSkgPT4ge1xuICAgIGlmIChBLmlzRW1wdHkobGVmdCkpXG4gICAgICAgIHJldHVybiBULnJpZ2h0KHJpZ2h0KTtcbiAgICBlbHNlIGlmIChBLmlzRW1wdHkocmlnaHQpKVxuICAgICAgICByZXR1cm4gVC5sZWZ0KGxlZnQpO1xuICAgIGVsc2VcbiAgICAgICAgcmV0dXJuIFQuYm90aChsZWZ0LCByaWdodCk7XG59KTtcbiIsCiAgImltcG9ydCB7IGNvbnN0YW50LCBwaXBlLCBmbG93LCBmbGlwIH0gZnJvbSBcImZwLXRzL2Z1bmN0aW9uXCI7XG5pbXBvcnQgeyBub3QgfSBmcm9tIFwiZnAtdHMvUHJlZGljYXRlXCI7XG5pbXBvcnQgeyBtYXRjaCBhcyBvcmRlcmluZ01hdGNoIH0gZnJvbSBcImZwLXRzL09yZGVyaW5nXCI7XG5pbXBvcnQgeyBPcmQgYXMgb3JkTnVtYmVyLCBNb25vaWRQcm9kdWN0LCBNb25vaWRTdW0gfSBmcm9tIFwiZnAtdHMvbnVtYmVyXCI7XG5pbXBvcnQgKiBhcyBORUEgZnJvbSBcImZwLXRzL05vbkVtcHR5QXJyYXlcIjtcbmltcG9ydCAqIGFzIFJBIGZyb20gXCJmcC10cy9SZWFkb25seUFycmF5XCI7XG5pbXBvcnQgKiBhcyBBIGZyb20gXCJmcC10cy9BcnJheVwiO1xuaW1wb3J0ICogYXMgUiBmcm9tIFwiZnAtdHMvUmVjb3JkXCI7XG5pbXBvcnQgKiBhcyBPIGZyb20gXCJmcC10cy9PcHRpb25cIjtcbmltcG9ydCAqIGFzIEIgZnJvbSBcImZwLXRzL2Jvb2xlYW5cIjtcbmltcG9ydCB7IHJlZHVjZU0gfSBmcm9tIFwiZnAtdHMvRm9sZGFibGVcIjtcbmltcG9ydCB7IGNvbmNhdEFsbCB9IGZyb20gXCJmcC10cy9Nb25vaWRcIjtcbmltcG9ydCB7IG1heCwgbWluIH0gZnJvbSBcImZwLXRzL1NlbWlncm91cFwiO1xuaW1wb3J0IHsgaW52b2tlIH0gZnJvbSBcIi4vRnVuY3Rpb25cIjtcbmltcG9ydCAqIGFzIFQgZnJvbSBcImZwLXRzL1RoZXNlXCI7XG5leHBvcnQgY29uc3QgZWxlbVYgPSAoZXEpID0+ICh4cykgPT4geSA9PiBBLmVsZW0oZXEpKHkpKHhzKTtcbmV4cG9ydCBjb25zdCBub25lID0gZmxvdyhub3QsIHAgPT4gQS5ldmVyeShwKSk7XG5leHBvcnQgY29uc3Qgam9pbiA9ICh4KSA9PiBpbnZva2UoXCJqb2luXCIpKFt4XSk7XG5leHBvcnQgY29uc3QgZ2V0RGlzb3JkZXJlZEVxID0gKG9yZEEpID0+ICh7XG4gICAgZXF1YWxzOiAoeHMsIHlzKSA9PiB7XG4gICAgICAgIGNvbnN0IHNvcnQgPSBBLnNvcnQob3JkQSk7XG4gICAgICAgIHJldHVybiBBLmdldEVxKG9yZEEpLmVxdWFscyhzb3J0KHhzKSwgc29ydCh5cykpO1xuICAgIH0sXG59KTtcbmV4cG9ydCBjb25zdCBwbHVja0ZpcnN0ID0gKHApID0+ICh4cykgPT4gcGlwZShBLmZpbmRJbmRleChwKSh4cyksIE8uZm9sZChjb25zdGFudChbTy5ub25lLCB4c10pLCBpID0+IFtcbiAgICBPLnNvbWUoeHNbaV0pLFxuICAgIEEudW5zYWZlRGVsZXRlQXQoaSwgeHMpLFxuXSkpO1xuZXhwb3J0IGNvbnN0IHVwc2VydCA9IChlcUEpID0+ICh4KSA9PiAoeXMpID0+IHBpcGUoQS5maW5kSW5kZXgoeSA9PiBlcUEuZXF1YWxzKHgsIHkpKSh5cyksIE8ubWFwKGkgPT4gQS51bnNhZmVVcGRhdGVBdChpLCB4LCB5cykpLCBPLmNoYWluKE5FQS5mcm9tQXJyYXkpLCBPLmdldE9yRWxzZSgoKSA9PiBBLmFwcGVuZCh4KSh5cykpKTtcbmV4cG9ydCBjb25zdCBpbnNlcnRNYW55ID0gKGkpID0+ICh4cykgPT4gKHlzKSA9PiBwaXBlKHhzLCBBLnJldmVyc2UsIHJlZHVjZU0oTy5Nb25hZCwgQS5Gb2xkYWJsZSkoeXMsICh6cywgeCkgPT4gcGlwZSh6cywgQS5pbnNlcnRBdChpLCB4KSkpLCBPLmNoYWluKE5FQS5mcm9tQXJyYXkpKTtcbmV4cG9ydCBjb25zdCBkcm9wUmVwZWF0cyA9IGVxID0+IHhzID0+IHBpcGUoeHMsIEEuZmlsdGVyV2l0aEluZGV4KChpLCB4KSA9PiBpID09PSAwIHx8ICFlcS5lcXVhbHMoeCwgeHNbaSAtIDFdKSkpO1xuZXhwb3J0IGNvbnN0IHN0YXJ0c1dpdGggPSAoZXEpID0+IChzdGFydCkgPT4gZmxvdyhBLnRha2VMZWZ0KHN0YXJ0Lmxlbmd0aCksIHhzID0+IEEuZ2V0RXEoZXEpLmVxdWFscyh4cywgc3RhcnQpKTtcbmV4cG9ydCBjb25zdCBlbmRzV2l0aCA9IChlcSkgPT4gKGVuZCkgPT4gZmxvdyhBLnRha2VSaWdodChlbmQubGVuZ3RoKSwgeHMgPT4gQS5nZXRFcShlcSkuZXF1YWxzKHhzLCBlbmQpKTtcbmV4cG9ydCBjb25zdCB3aXRob3V0ID0gKGVxKSA9PiAoeHMpID0+IEEuZmlsdGVyKHkgPT4gIUEuZWxlbShlcSkoeSkoeHMpKTtcbmV4cG9ydCBjb25zdCBjYXJ0ZXNpYW4gPSAoeHMpID0+ICh5cykgPT4gcGlwZSh4cywgQS5jaGFpbih4ID0+IHBpcGUoeXMsIEEubWFwKHkgPT4gW3gsIHldKSkpKTtcbmV4cG9ydCBjb25zdCBzdW0gPSBjb25jYXRBbGwoTW9ub2lkU3VtKTtcbmV4cG9ydCBjb25zdCBwcm9kdWN0ID0gY29uY2F0QWxsKE1vbm9pZFByb2R1Y3QpO1xuZXhwb3J0IGNvbnN0IG1lYW4gPSAoeHMpID0+IHN1bSh4cykgLyB4cy5sZW5ndGg7XG5leHBvcnQgY29uc3QgbWVkaWFuID0gZmxvdyhORUEuc29ydChvcmROdW1iZXIpLCB4cyA9PiB7XG4gICAgY29uc3QgaSA9IHhzLmxlbmd0aCAvIDI7XG4gICAgcmV0dXJuIGkgJSAxID09PSAwID8gKHhzW2kgLSAxXSArIHhzW2ldKSAvIDIgOiB4c1tNYXRoLmZsb29yKGkpXTtcbn0pO1xuZXhwb3J0IGNvbnN0IGFwZXJ0dXJlID0gKG4pID0+ICh4cykgPT4ge1xuICAgIGNvbnN0IGdvID0gKGkpID0+ICh5cykgPT4gaSArIG4gPiB4cy5sZW5ndGggPyB5cyA6IGdvKGkgKyAxKShBLmFwcGVuZChzbGljZShpKShuICsgaSkoeHMpKSh5cykpO1xuICAgIHJldHVybiBuIDwgMSA/IFtdIDogZ28oMCkoW10pO1xufTtcbmV4cG9ydCBjb25zdCBzbGljZSA9IChzdGFydCkgPT4gKGVuZCkgPT4gaW52b2tlKFwic2xpY2VcIikoW3N0YXJ0LCBlbmRdKTtcbmV4cG9ydCBjb25zdCByZWplY3QgPSAoZikgPT4gQS5maWx0ZXIobm90KGYpKTtcbmV4cG9ydCBjb25zdCBtb3ZlRnJvbSA9IChmcm9tKSA9PiAodG8pID0+ICh4cykgPT4gZnJvbSA+PSB4cy5sZW5ndGggfHwgdG8gPj0geHMubGVuZ3RoXG4gICAgPyBPLm5vbmVcbiAgICA6IGZyb20gPT09IHRvXG4gICAgICAgID8gTy5zb21lKHhzKVxuICAgICAgICA6IHBpcGUoeHMsIEEubG9va3VwKGZyb20pLCBPLmNoYWluKHggPT4gcGlwZShBLmRlbGV0ZUF0KGZyb20pKHhzKSwgTy5jaGFpbihBLmluc2VydEF0KHRvLCB4KSkpKSk7XG5leHBvcnQgY29uc3QgbW92ZVRvID0gZmxpcChtb3ZlRnJvbSk7XG5leHBvcnQgY29uc3QgY291bnRCeSA9IChmKSA9PiAoeHMpID0+IFIuZnJvbUZvbGRhYmxlTWFwKE1vbm9pZFN1bSwgQS5Gb2xkYWJsZSkoeHMsIHggPT4gW2YoeCksIDFdKTtcbmV4cG9ydCBjb25zdCBkcm9wUmlnaHRXaGlsZSA9IChmKSA9PiBmbG93KEEucmV2ZXJzZSwgQS5kcm9wTGVmdFdoaWxlKGYpLCBBLnJldmVyc2UpO1xuZXhwb3J0IGNvbnN0IGRyb3BBdCA9IChpKSA9PiAobikgPT4gKHhzKSA9PiBwaXBlKEEuaXNPdXRPZkJvdW5kKGksIHhzKSwgQi5mb2xkKCgpID0+IHBpcGUoQS5jb3B5KHhzKSwgeXMgPT4ge1xuICAgIHlzLnNwbGljZShpLCBuKTtcbiAgICByZXR1cm4geXM7XG59LCBPLnNvbWUpLCBjb25zdGFudChPLm5vbmUpKSk7XG5leHBvcnQgY29uc3QgdHJhbnNwb3NlID0gKHhzKSA9PiB7XG4gICAgaWYgKEEuaXNFbXB0eSh4cykpXG4gICAgICAgIHJldHVybiBbXTtcbiAgICBpZiAoQS5pc0VtcHR5KHhzWzBdKSlcbiAgICAgICAgcmV0dXJuIHRyYW5zcG9zZShBLmRyb3BMZWZ0KDEpKHhzKSk7XG4gICAgY29uc3QgW1t5LCAuLi55c10sIC4uLnlzc10gPSB4cztcbiAgICBjb25zdCB6cyA9IFt5LCAuLi5BLmZpbHRlck1hcChBLmhlYWQpKHlzcyldO1xuICAgIGNvbnN0IHpzcyA9IFt5cywgLi4uQS5tYXAoQS5kcm9wTGVmdCgxKSkoeXNzKV07XG4gICAgcmV0dXJuIFt6cywgLi4udHJhbnNwb3NlKHpzcyldO1xufTtcbmV4cG9ydCBjb25zdCB0YWtlUmlnaHRXaGlsZSA9IChmKSA9PiBmbG93KEEucmV2ZXJzZSwgQS50YWtlTGVmdFdoaWxlKGYpLCBBLnJldmVyc2UpO1xuZXhwb3J0IGNvbnN0IHN5bW1ldHJpY0RpZmZlcmVuY2UgPSAoZXEpID0+ICh4cykgPT4geXMgPT4gQS5nZXRNb25vaWQoKS5jb25jYXQoQS5kaWZmZXJlbmNlKGVxKSh5cykoeHMpLCBBLmRpZmZlcmVuY2UoZXEpKHhzKSh5cykpO1xuZXhwb3J0IGNvbnN0IHJlZHVjZVdoaWxlID0gKHApID0+IChmKSA9PiB7XG4gICAgY29uc3QgZ28gPSAoYWNjKSA9PiAoeXMpID0+IHBpcGUoTkVBLmZyb21BcnJheSh5cyksIE8uZmlsdGVyKGZsb3coTkVBLmhlYWQsIHApKSwgTy5mb2xkKGNvbnN0YW50KGFjYyksIGZsb3coTkVBLnVucHJlcGVuZCwgKFt6LCB6c10pID0+IGdvKGYoeikoYWNjKSkoenMpKSkpO1xuICAgIHJldHVybiBnbztcbn07XG5leHBvcnQgY29uc3QgcmVkdWNlUmlnaHRXaGlsZSA9IChwKSA9PiAoZikgPT4gKHgpID0+IGZsb3coQS5yZXZlcnNlLCByZWR1Y2VXaGlsZShwKShmKSh4KSk7XG5leHBvcnQgY29uc3QgbWluaW11bSA9IGZsb3cobWluLCBORUEuY29uY2F0QWxsKTtcbmV4cG9ydCBjb25zdCBtYXhpbXVtID0gZmxvdyhtYXgsIE5FQS5jb25jYXRBbGwpO1xuZXhwb3J0IGNvbnN0IHppcEFsbCA9ICh4cykgPT4gKHlzKSA9PiB7XG4gICAgY29uc3QgenMgPSBBLnppcCh5cywgeHMpO1xuICAgIGNvbnN0IGdldFJlbSA9IHNsaWNlKEEuc2l6ZSh6cykpKEluZmluaXR5KTtcbiAgICBjb25zdCByZXN0ID0gcGlwZShvcmROdW1iZXIuY29tcGFyZShBLnNpemUoeXMpLCBBLnNpemUoeHMpKSwgb3JkZXJpbmdNYXRjaCgoKSA9PiBwaXBlKHhzLCBnZXRSZW0sIEEubWFwKFQucmlnaHQpKSwgY29uc3RhbnQoQS5lbXB0eSksICgpID0+IHBpcGUoeXMsIGdldFJlbSwgQS5tYXAoVC5sZWZ0KSkpKTtcbiAgICByZXR1cm4gcGlwZSh6cywgQS5tYXAoKFt6YSwgemJdKSA9PiBULmJvdGgoemEsIHpiKSksIEEuY29uY2F0KHJlc3QpKTtcbn07XG5leHBvcnQgZnVuY3Rpb24gZmlsdGVyQShGKSB7XG4gICAgcmV0dXJuIHAgPT4geHMgPT4gQS5XaXRoZXJhYmxlLndpdGhlcihGKSh4cywgeCA9PiBGLm1hcChwKHgpLCB5ID0+ICh5ID8gTy5zb21lKHgpIDogTy5ub25lKSkpO1xufVxuZXhwb3J0IGNvbnN0IGV4dHJhY3RBdCA9IChpKSA9PiAoeHMpID0+IHBpcGUoeHMsIEEubG9va3VwKGkpLCBPLm1hcCh4ID0+IFt4LCBBLnVuc2FmZURlbGV0ZUF0KGksIHhzKV0pKTtcbmV4cG9ydCBjb25zdCBmcm9tSXRlcmFibGUgPSBBcnJheS5mcm9tO1xuZXhwb3J0IGNvbnN0IGZyb21SZWFkb25seSA9IFJBLnRvQXJyYXk7XG5leHBvcnQgY29uc3QgdG9SZWFkb25seSA9IFJBLmZyb21BcnJheTtcbmV4cG9ydCBmdW5jdGlvbiBhbGxNKE0pIHtcbiAgICByZXR1cm4gQS5yZWR1Y2UoTS5vZih0cnVlKSwgKHgsIHkpID0+IE0uY2hhaW4oeCwgYiA9PiAoYiA/IHkgOiBNLm9mKGZhbHNlKSkpKTtcbn1cbmV4cG9ydCBmdW5jdGlvbiBhbnlNKE0pIHtcbiAgICByZXR1cm4gQS5yZWR1Y2UoTS5vZihmYWxzZSksICh4LCB5KSA9PiBNLmNoYWluKHgsIGIgPT4gKGIgPyBNLm9mKHRydWUpIDogeSkpKTtcbn1cbmV4cG9ydCBjb25zdCBzZXBhcmF0ZU5FID0gKHhzKSA9PiBwaXBlKHhzLCBBLnNlcGFyYXRlLCAoeyBsZWZ0LCByaWdodCB9KSA9PiB7XG4gICAgaWYgKEEuaXNFbXB0eShsZWZ0KSlcbiAgICAgICAgcmV0dXJuIFQucmlnaHQocmlnaHQpO1xuICAgIGVsc2UgaWYgKEEuaXNFbXB0eShyaWdodCkpXG4gICAgICAgIHJldHVybiBULmxlZnQobGVmdCk7XG4gICAgZWxzZVxuICAgICAgICByZXR1cm4gVC5ib3RoKGxlZnQsIHJpZ2h0KTtcbn0pO1xuIiwKICAiaW1wb3J0IHsgY29uc3RhbnQsIHBpcGUsIGZsb3csIGZsaXAgfSBmcm9tIFwiZnAtdHMvZnVuY3Rpb25cIjtcbmltcG9ydCB7IG5vdCB9IGZyb20gXCJmcC10cy9QcmVkaWNhdGVcIjtcbmltcG9ydCB7IG1hdGNoIGFzIG9yZGVyaW5nTWF0Y2ggfSBmcm9tIFwiZnAtdHMvT3JkZXJpbmdcIjtcbmltcG9ydCB7IE9yZCBhcyBvcmROdW1iZXIsIE1vbm9pZFByb2R1Y3QsIE1vbm9pZFN1bSB9IGZyb20gXCJmcC10cy9udW1iZXJcIjtcbmltcG9ydCAqIGFzIE5FQSBmcm9tIFwiZnAtdHMvTm9uRW1wdHlBcnJheVwiO1xuaW1wb3J0ICogYXMgUkEgZnJvbSBcImZwLXRzL1JlYWRvbmx5QXJyYXlcIjtcbmltcG9ydCAqIGFzIEEgZnJvbSBcImZwLXRzL0FycmF5XCI7XG5pbXBvcnQgKiBhcyBSIGZyb20gXCJmcC10cy9SZWNvcmRcIjtcbmltcG9ydCAqIGFzIE8gZnJvbSBcImZwLXRzL09wdGlvblwiO1xuaW1wb3J0ICogYXMgQiBmcm9tIFwiZnAtdHMvYm9vbGVhblwiO1xuaW1wb3J0IHsgcmVkdWNlTSB9IGZyb20gXCJmcC10cy9Gb2xkYWJsZVwiO1xuaW1wb3J0IHsgY29uY2F0QWxsIH0gZnJvbSBcImZwLXRzL01vbm9pZFwiO1xuaW1wb3J0IHsgbWF4LCBtaW4gfSBmcm9tIFwiZnAtdHMvU2VtaWdyb3VwXCI7XG5pbXBvcnQgeyBpbnZva2UgfSBmcm9tIFwiLi9GdW5jdGlvblwiO1xuaW1wb3J0ICogYXMgVCBmcm9tIFwiZnAtdHMvVGhlc2VcIjtcbmV4cG9ydCBjb25zdCBlbGVtViA9IChlcSkgPT4gKHhzKSA9PiB5ID0+IEEuZWxlbShlcSkoeSkoeHMpO1xuZXhwb3J0IGNvbnN0IG5vbmUgPSBmbG93KG5vdCwgcCA9PiBBLmV2ZXJ5KHApKTtcbmV4cG9ydCBjb25zdCBqb2luID0gKHgpID0+IGludm9rZShcImpvaW5cIikoW3hdKTtcbmV4cG9ydCBjb25zdCBnZXREaXNvcmRlcmVkRXEgPSAob3JkQSkgPT4gKHtcbiAgICBlcXVhbHM6ICh4cywgeXMpID0+IHtcbiAgICAgICAgY29uc3Qgc29ydCA9IEEuc29ydChvcmRBKTtcbiAgICAgICAgcmV0dXJuIEEuZ2V0RXEob3JkQSkuZXF1YWxzKHNvcnQoeHMpLCBzb3J0KHlzKSk7XG4gICAgfSxcbn0pO1xuZXhwb3J0IGNvbnN0IHBsdWNrRmlyc3QgPSAocCkgPT4gKHhzKSA9PiBwaXBlKEEuZmluZEluZGV4KHApKHhzKSwgTy5mb2xkKGNvbnN0YW50KFtPLm5vbmUsIHhzXSksIGkgPT4gW1xuICAgIE8uc29tZSh4c1tpXSksXG4gICAgQS51bnNhZmVEZWxldGVBdChpLCB4cyksXG5dKSk7XG5leHBvcnQgY29uc3QgdXBzZXJ0ID0gKGVxQSkgPT4gKHgpID0+ICh5cykgPT4gcGlwZShBLmZpbmRJbmRleCh5ID0+IGVxQS5lcXVhbHMoeCwgeSkpKHlzKSwgTy5tYXAoaSA9PiBBLnVuc2FmZVVwZGF0ZUF0KGksIHgsIHlzKSksIE8uY2hhaW4oTkVBLmZyb21BcnJheSksIE8uZ2V0T3JFbHNlKCgpID0+IEEuYXBwZW5kKHgpKHlzKSkpO1xuZXhwb3J0IGNvbnN0IGluc2VydE1hbnkgPSAoaSkgPT4gKHhzKSA9PiAoeXMpID0+IHBpcGUoeHMsIEEucmV2ZXJzZSwgcmVkdWNlTShPLk1vbmFkLCBBLkZvbGRhYmxlKSh5cywgKHpzLCB4KSA9PiBwaXBlKHpzLCBBLmluc2VydEF0KGksIHgpKSksIE8uY2hhaW4oTkVBLmZyb21BcnJheSkpO1xuZXhwb3J0IGNvbnN0IGRyb3BSZXBlYXRzID0gZXEgPT4geHMgPT4gcGlwZSh4cywgQS5maWx0ZXJXaXRoSW5kZXgoKGksIHgpID0+IGkgPT09IDAgfHwgIWVxLmVxdWFscyh4LCB4c1tpIC0gMV0pKSk7XG5leHBvcnQgY29uc3Qgc3RhcnRzV2l0aCA9IChlcSkgPT4gKHN0YXJ0KSA9PiBmbG93KEEudGFrZUxlZnQoc3RhcnQubGVuZ3RoKSwgeHMgPT4gQS5nZXRFcShlcSkuZXF1YWxzKHhzLCBzdGFydCkpO1xuZXhwb3J0IGNvbnN0IGVuZHNXaXRoID0gKGVxKSA9PiAoZW5kKSA9PiBmbG93KEEudGFrZVJpZ2h0KGVuZC5sZW5ndGgpLCB4cyA9PiBBLmdldEVxKGVxKS5lcXVhbHMoeHMsIGVuZCkpO1xuZXhwb3J0IGNvbnN0IHdpdGhvdXQgPSAoZXEpID0+ICh4cykgPT4gQS5maWx0ZXIoeSA9PiAhQS5lbGVtKGVxKSh5KSh4cykpO1xuZXhwb3J0IGNvbnN0IGNhcnRlc2lhbiA9ICh4cykgPT4gKHlzKSA9PiBwaXBlKHhzLCBBLmNoYWluKHggPT4gcGlwZSh5cywgQS5tYXAoeSA9PiBbeCwgeV0pKSkpO1xuZXhwb3J0IGNvbnN0IHN1bSA9IGNvbmNhdEFsbChNb25vaWRTdW0pO1xuZXhwb3J0IGNvbnN0IHByb2R1Y3QgPSBjb25jYXRBbGwoTW9ub2lkUHJvZHVjdCk7XG5leHBvcnQgY29uc3QgbWVhbiA9ICh4cykgPT4gc3VtKHhzKSAvIHhzLmxlbmd0aDtcbmV4cG9ydCBjb25zdCBtZWRpYW4gPSBmbG93KE5FQS5zb3J0KG9yZE51bWJlciksIHhzID0+IHtcbiAgICBjb25zdCBpID0geHMubGVuZ3RoIC8gMjtcbiAgICByZXR1cm4gaSAlIDEgPT09IDAgPyAoeHNbaSAtIDFdICsgeHNbaV0pIC8gMiA6IHhzW01hdGguZmxvb3IoaSldO1xufSk7XG5leHBvcnQgY29uc3QgYXBlcnR1cmUgPSAobikgPT4gKHhzKSA9PiB7XG4gICAgY29uc3QgZ28gPSAoaSkgPT4gKHlzKSA9PiBpICsgbiA+IHhzLmxlbmd0aCA/IHlzIDogZ28oaSArIDEpKEEuYXBwZW5kKHNsaWNlKGkpKG4gKyBpKSh4cykpKHlzKSk7XG4gICAgcmV0dXJuIG4gPCAxID8gW10gOiBnbygwKShbXSk7XG59O1xuZXhwb3J0IGNvbnN0IHNsaWNlID0gKHN0YXJ0KSA9PiAoZW5kKSA9PiBpbnZva2UoXCJzbGljZVwiKShbc3RhcnQsIGVuZF0pO1xuZXhwb3J0IGNvbnN0IHJlamVjdCA9IChmKSA9PiBBLmZpbHRlcihub3QoZikpO1xuZXhwb3J0IGNvbnN0IG1vdmVGcm9tID0gKGZyb20pID0+ICh0bykgPT4gKHhzKSA9PiBmcm9tID49IHhzLmxlbmd0aCB8fCB0byA+PSB4cy5sZW5ndGhcbiAgICA/IE8ubm9uZVxuICAgIDogZnJvbSA9PT0gdG9cbiAgICAgICAgPyBPLnNvbWUoeHMpXG4gICAgICAgIDogcGlwZSh4cywgQS5sb29rdXAoZnJvbSksIE8uY2hhaW4oeCA9PiBwaXBlKEEuZGVsZXRlQXQoZnJvbSkoeHMpLCBPLmNoYWluKEEuaW5zZXJ0QXQodG8sIHgpKSkpKTtcbmV4cG9ydCBjb25zdCBtb3ZlVG8gPSBmbGlwKG1vdmVGcm9tKTtcbmV4cG9ydCBjb25zdCBjb3VudEJ5ID0gKGYpID0+ICh4cykgPT4gUi5mcm9tRm9sZGFibGVNYXAoTW9ub2lkU3VtLCBBLkZvbGRhYmxlKSh4cywgeCA9PiBbZih4KSwgMV0pO1xuZXhwb3J0IGNvbnN0IGRyb3BSaWdodFdoaWxlID0gKGYpID0+IGZsb3coQS5yZXZlcnNlLCBBLmRyb3BMZWZ0V2hpbGUoZiksIEEucmV2ZXJzZSk7XG5leHBvcnQgY29uc3QgZHJvcEF0ID0gKGkpID0+IChuKSA9PiAoeHMpID0+IHBpcGUoQS5pc091dE9mQm91bmQoaSwgeHMpLCBCLmZvbGQoKCkgPT4gcGlwZShBLmNvcHkoeHMpLCB5cyA9PiB7XG4gICAgeXMuc3BsaWNlKGksIG4pO1xuICAgIHJldHVybiB5cztcbn0sIE8uc29tZSksIGNvbnN0YW50KE8ubm9uZSkpKTtcbmV4cG9ydCBjb25zdCB0cmFuc3Bvc2UgPSAoeHMpID0+IHtcbiAgICBpZiAoQS5pc0VtcHR5KHhzKSlcbiAgICAgICAgcmV0dXJuIFtdO1xuICAgIGlmIChBLmlzRW1wdHkoeHNbMF0pKVxuICAgICAgICByZXR1cm4gdHJhbnNwb3NlKEEuZHJvcExlZnQoMSkoeHMpKTtcbiAgICBjb25zdCBbW3ksIC4uLnlzXSwgLi4ueXNzXSA9IHhzO1xuICAgIGNvbnN0IHpzID0gW3ksIC4uLkEuZmlsdGVyTWFwKEEuaGVhZCkoeXNzKV07XG4gICAgY29uc3QgenNzID0gW3lzLCAuLi5BLm1hcChBLmRyb3BMZWZ0KDEpKSh5c3MpXTtcbiAgICByZXR1cm4gW3pzLCAuLi50cmFuc3Bvc2UoenNzKV07XG59O1xuZXhwb3J0IGNvbnN0IHRha2VSaWdodFdoaWxlID0gKGYpID0+IGZsb3coQS5yZXZlcnNlLCBBLnRha2VMZWZ0V2hpbGUoZiksIEEucmV2ZXJzZSk7XG5leHBvcnQgY29uc3Qgc3ltbWV0cmljRGlmZmVyZW5jZSA9IChlcSkgPT4gKHhzKSA9PiB5cyA9PiBBLmdldE1vbm9pZCgpLmNvbmNhdChBLmRpZmZlcmVuY2UoZXEpKHlzKSh4cyksIEEuZGlmZmVyZW5jZShlcSkoeHMpKHlzKSk7XG5leHBvcnQgY29uc3QgcmVkdWNlV2hpbGUgPSAocCkgPT4gKGYpID0+IHtcbiAgICBjb25zdCBnbyA9IChhY2MpID0+ICh5cykgPT4gcGlwZShORUEuZnJvbUFycmF5KHlzKSwgTy5maWx0ZXIoZmxvdyhORUEuaGVhZCwgcCkpLCBPLmZvbGQoY29uc3RhbnQoYWNjKSwgZmxvdyhORUEudW5wcmVwZW5kLCAoW3osIHpzXSkgPT4gZ28oZih6KShhY2MpKSh6cykpKSk7XG4gICAgcmV0dXJuIGdvO1xufTtcbmV4cG9ydCBjb25zdCByZWR1Y2VSaWdodFdoaWxlID0gKHApID0+IChmKSA9PiAoeCkgPT4gZmxvdyhBLnJldmVyc2UsIHJlZHVjZVdoaWxlKHApKGYpKHgpKTtcbmV4cG9ydCBjb25zdCBtaW5pbXVtID0gZmxvdyhtaW4sIE5FQS5jb25jYXRBbGwpO1xuZXhwb3J0IGNvbnN0IG1heGltdW0gPSBmbG93KG1heCwgTkVBLmNvbmNhdEFsbCk7XG5leHBvcnQgY29uc3QgemlwQWxsID0gKHhzKSA9PiAoeXMpID0+IHtcbiAgICBjb25zdCB6cyA9IEEuemlwKHlzLCB4cyk7XG4gICAgY29uc3QgZ2V0UmVtID0gc2xpY2UoQS5zaXplKHpzKSkoSW5maW5pdHkpO1xuICAgIGNvbnN0IHJlc3QgPSBwaXBlKG9yZE51bWJlci5jb21wYXJlKEEuc2l6ZSh5cyksIEEuc2l6ZSh4cykpLCBvcmRlcmluZ01hdGNoKCgpID0+IHBpcGUoeHMsIGdldFJlbSwgQS5tYXAoVC5yaWdodCkpLCBjb25zdGFudChBLmVtcHR5KSwgKCkgPT4gcGlwZSh5cywgZ2V0UmVtLCBBLm1hcChULmxlZnQpKSkpO1xuICAgIHJldHVybiBwaXBlKHpzLCBBLm1hcCgoW3phLCB6Yl0pID0+IFQuYm90aCh6YSwgemIpKSwgQS5jb25jYXQocmVzdCkpO1xufTtcbmV4cG9ydCBmdW5jdGlvbiBmaWx0ZXJBKEYpIHtcbiAgICByZXR1cm4gcCA9PiB4cyA9PiBBLldpdGhlcmFibGUud2l0aGVyKEYpKHhzLCB4ID0+IEYubWFwKHAoeCksIHkgPT4gKHkgPyBPLnNvbWUoeCkgOiBPLm5vbmUpKSk7XG59XG5leHBvcnQgY29uc3QgZXh0cmFjdEF0ID0gKGkpID0+ICh4cykgPT4gcGlwZSh4cywgQS5sb29rdXAoaSksIE8ubWFwKHggPT4gW3gsIEEudW5zYWZlRGVsZXRlQXQoaSwgeHMpXSkpO1xuZXhwb3J0IGNvbnN0IGZyb21JdGVyYWJsZSA9IEFycmF5LmZyb207XG5leHBvcnQgY29uc3QgZnJvbVJlYWRvbmx5ID0gUkEudG9BcnJheTtcbmV4cG9ydCBjb25zdCB0b1JlYWRvbmx5ID0gUkEuZnJvbUFycmF5O1xuZXhwb3J0IGZ1bmN0aW9uIGFsbE0oTSkge1xuICAgIHJldHVybiBBLnJlZHVjZShNLm9mKHRydWUpLCAoeCwgeSkgPT4gTS5jaGFpbih4LCBiID0+IChiID8geSA6IE0ub2YoZmFsc2UpKSkpO1xufVxuZXhwb3J0IGZ1bmN0aW9uIGFueU0oTSkge1xuICAgIHJldHVybiBBLnJlZHVjZShNLm9mKGZhbHNlKSwgKHgsIHkpID0+IE0uY2hhaW4oeCwgYiA9PiAoYiA/IE0ub2YodHJ1ZSkgOiB5KSkpO1xufVxuZXhwb3J0IGNvbnN0IHNlcGFyYXRlTkUgPSAoeHMpID0+IHBpcGUoeHMsIEEuc2VwYXJhdGUsICh7IGxlZnQsIHJpZ2h0IH0pID0+IHtcbiAgICBpZiAoQS5pc0VtcHR5KGxlZnQpKVxuICAgICAgICByZXR1cm4gVC5yaWdodChyaWdodCk7XG4gICAgZWxzZSBpZiAoQS5pc0VtcHR5KHJpZ2h0KSlcbiAgICAgICAgcmV0dXJuIFQubGVmdChsZWZ0KTtcbiAgICBlbHNlXG4gICAgICAgIHJldHVybiBULmJvdGgobGVmdCwgcmlnaHQpO1xufSk7XG4iLAogICJpbXBvcnQgeyBjb25zdGFudCwgcGlwZSwgZmxvdywgZmxpcCB9IGZyb20gXCJmcC10cy9mdW5jdGlvblwiO1xuaW1wb3J0IHsgbm90IH0gZnJvbSBcImZwLXRzL1ByZWRpY2F0ZVwiO1xuaW1wb3J0IHsgbWF0Y2ggYXMgb3JkZXJpbmdNYXRjaCB9IGZyb20gXCJmcC10cy9PcmRlcmluZ1wiO1xuaW1wb3J0IHsgT3JkIGFzIG9yZE51bWJlciwgTW9ub2lkUHJvZHVjdCwgTW9ub2lkU3VtIH0gZnJvbSBcImZwLXRzL251bWJlclwiO1xuaW1wb3J0ICogYXMgTkVBIGZyb20gXCJmcC10cy9Ob25FbXB0eUFycmF5XCI7XG5pbXBvcnQgKiBhcyBSQSBmcm9tIFwiZnAtdHMvUmVhZG9ubHlBcnJheVwiO1xuaW1wb3J0ICogYXMgQSBmcm9tIFwiZnAtdHMvQXJyYXlcIjtcbmltcG9ydCAqIGFzIFIgZnJvbSBcImZwLXRzL1JlY29yZFwiO1xuaW1wb3J0ICogYXMgTyBmcm9tIFwiZnAtdHMvT3B0aW9uXCI7XG5pbXBvcnQgKiBhcyBCIGZyb20gXCJmcC10cy9ib29sZWFuXCI7XG5pbXBvcnQgeyByZWR1Y2VNIH0gZnJvbSBcImZwLXRzL0ZvbGRhYmxlXCI7XG5pbXBvcnQgeyBjb25jYXRBbGwgfSBmcm9tIFwiZnAtdHMvTW9ub2lkXCI7XG5pbXBvcnQgeyBtYXgsIG1pbiB9IGZyb20gXCJmcC10cy9TZW1pZ3JvdXBcIjtcbmltcG9ydCB7IGludm9rZSB9IGZyb20gXCIuL0Z1bmN0aW9uXCI7XG5pbXBvcnQgKiBhcyBUIGZyb20gXCJmcC10cy9UaGVzZVwiO1xuZXhwb3J0IGNvbnN0IGVsZW1WID0gKGVxKSA9PiAoeHMpID0+IHkgPT4gQS5lbGVtKGVxKSh5KSh4cyk7XG5leHBvcnQgY29uc3Qgbm9uZSA9IGZsb3cobm90LCBwID0+IEEuZXZlcnkocCkpO1xuZXhwb3J0IGNvbnN0IGpvaW4gPSAoeCkgPT4gaW52b2tlKFwiam9pblwiKShbeF0pO1xuZXhwb3J0IGNvbnN0IGdldERpc29yZGVyZWRFcSA9IChvcmRBKSA9PiAoe1xuICAgIGVxdWFsczogKHhzLCB5cykgPT4ge1xuICAgICAgICBjb25zdCBzb3J0ID0gQS5zb3J0KG9yZEEpO1xuICAgICAgICByZXR1cm4gQS5nZXRFcShvcmRBKS5lcXVhbHMoc29ydCh4cyksIHNvcnQoeXMpKTtcbiAgICB9LFxufSk7XG5leHBvcnQgY29uc3QgcGx1Y2tGaXJzdCA9IChwKSA9PiAoeHMpID0+IHBpcGUoQS5maW5kSW5kZXgocCkoeHMpLCBPLmZvbGQoY29uc3RhbnQoW08ubm9uZSwgeHNdKSwgaSA9PiBbXG4gICAgTy5zb21lKHhzW2ldKSxcbiAgICBBLnVuc2FmZURlbGV0ZUF0KGksIHhzKSxcbl0pKTtcbmV4cG9ydCBjb25zdCB1cHNlcnQgPSAoZXFBKSA9PiAoeCkgPT4gKHlzKSA9PiBwaXBlKEEuZmluZEluZGV4KHkgPT4gZXFBLmVxdWFscyh4LCB5KSkoeXMpLCBPLm1hcChpID0+IEEudW5zYWZlVXBkYXRlQXQoaSwgeCwgeXMpKSwgTy5jaGFpbihORUEuZnJvbUFycmF5KSwgTy5nZXRPckVsc2UoKCkgPT4gQS5hcHBlbmQoeCkoeXMpKSk7XG5leHBvcnQgY29uc3QgaW5zZXJ0TWFueSA9IChpKSA9PiAoeHMpID0+ICh5cykgPT4gcGlwZSh4cywgQS5yZXZlcnNlLCByZWR1Y2VNKE8uTW9uYWQsIEEuRm9sZGFibGUpKHlzLCAoenMsIHgpID0+IHBpcGUoenMsIEEuaW5zZXJ0QXQoaSwgeCkpKSwgTy5jaGFpbihORUEuZnJvbUFycmF5KSk7XG5leHBvcnQgY29uc3QgZHJvcFJlcGVhdHMgPSBlcSA9PiB4cyA9PiBwaXBlKHhzLCBBLmZpbHRlcldpdGhJbmRleCgoaSwgeCkgPT4gaSA9PT0gMCB8fCAhZXEuZXF1YWxzKHgsIHhzW2kgLSAxXSkpKTtcbmV4cG9ydCBjb25zdCBzdGFydHNXaXRoID0gKGVxKSA9PiAoc3RhcnQpID0+IGZsb3coQS50YWtlTGVmdChzdGFydC5sZW5ndGgpLCB4cyA9PiBBLmdldEVxKGVxKS5lcXVhbHMoeHMsIHN0YXJ0KSk7XG5leHBvcnQgY29uc3QgZW5kc1dpdGggPSAoZXEpID0+IChlbmQpID0+IGZsb3coQS50YWtlUmlnaHQoZW5kLmxlbmd0aCksIHhzID0+IEEuZ2V0RXEoZXEpLmVxdWFscyh4cywgZW5kKSk7XG5leHBvcnQgY29uc3Qgd2l0aG91dCA9IChlcSkgPT4gKHhzKSA9PiBBLmZpbHRlcih5ID0+ICFBLmVsZW0oZXEpKHkpKHhzKSk7XG5leHBvcnQgY29uc3QgY2FydGVzaWFuID0gKHhzKSA9PiAoeXMpID0+IHBpcGUoeHMsIEEuY2hhaW4oeCA9PiBwaXBlKHlzLCBBLm1hcCh5ID0+IFt4LCB5XSkpKSk7XG5leHBvcnQgY29uc3Qgc3VtID0gY29uY2F0QWxsKE1vbm9pZFN1bSk7XG5leHBvcnQgY29uc3QgcHJvZHVjdCA9IGNvbmNhdEFsbChNb25vaWRQcm9kdWN0KTtcbmV4cG9ydCBjb25zdCBtZWFuID0gKHhzKSA9PiBzdW0oeHMpIC8geHMubGVuZ3RoO1xuZXhwb3J0IGNvbnN0IG1lZGlhbiA9IGZsb3coTkVBLnNvcnQob3JkTnVtYmVyKSwgeHMgPT4ge1xuICAgIGNvbnN0IGkgPSB4cy5sZW5ndGggLyAyO1xuICAgIHJldHVybiBpICUgMSA9PT0gMCA/ICh4c1tpIC0gMV0gKyB4c1tpXSkgLyAyIDogeHNbTWF0aC5mbG9vcihpKV07XG59KTtcbmV4cG9ydCBjb25zdCBhcGVydHVyZSA9IChuKSA9PiAoeHMpID0+IHtcbiAgICBjb25zdCBnbyA9IChpKSA9PiAoeXMpID0+IGkgKyBuID4geHMubGVuZ3RoID8geXMgOiBnbyhpICsgMSkoQS5hcHBlbmQoc2xpY2UoaSkobiArIGkpKHhzKSkoeXMpKTtcbiAgICByZXR1cm4gbiA8IDEgPyBbXSA6IGdvKDApKFtdKTtcbn07XG5leHBvcnQgY29uc3Qgc2xpY2UgPSAoc3RhcnQpID0+IChlbmQpID0+IGludm9rZShcInNsaWNlXCIpKFtzdGFydCwgZW5kXSk7XG5leHBvcnQgY29uc3QgcmVqZWN0ID0gKGYpID0+IEEuZmlsdGVyKG5vdChmKSk7XG5leHBvcnQgY29uc3QgbW92ZUZyb20gPSAoZnJvbSkgPT4gKHRvKSA9PiAoeHMpID0+IGZyb20gPj0geHMubGVuZ3RoIHx8IHRvID49IHhzLmxlbmd0aFxuICAgID8gTy5ub25lXG4gICAgOiBmcm9tID09PSB0b1xuICAgICAgICA/IE8uc29tZSh4cylcbiAgICAgICAgOiBwaXBlKHhzLCBBLmxvb2t1cChmcm9tKSwgTy5jaGFpbih4ID0+IHBpcGUoQS5kZWxldGVBdChmcm9tKSh4cyksIE8uY2hhaW4oQS5pbnNlcnRBdCh0bywgeCkpKSkpO1xuZXhwb3J0IGNvbnN0IG1vdmVUbyA9IGZsaXAobW92ZUZyb20pO1xuZXhwb3J0IGNvbnN0IGNvdW50QnkgPSAoZikgPT4gKHhzKSA9PiBSLmZyb21Gb2xkYWJsZU1hcChNb25vaWRTdW0sIEEuRm9sZGFibGUpKHhzLCB4ID0+IFtmKHgpLCAxXSk7XG5leHBvcnQgY29uc3QgZHJvcFJpZ2h0V2hpbGUgPSAoZikgPT4gZmxvdyhBLnJldmVyc2UsIEEuZHJvcExlZnRXaGlsZShmKSwgQS5yZXZlcnNlKTtcbmV4cG9ydCBjb25zdCBkcm9wQXQgPSAoaSkgPT4gKG4pID0+ICh4cykgPT4gcGlwZShBLmlzT3V0T2ZCb3VuZChpLCB4cyksIEIuZm9sZCgoKSA9PiBwaXBlKEEuY29weSh4cyksIHlzID0+IHtcbiAgICB5cy5zcGxpY2UoaSwgbik7XG4gICAgcmV0dXJuIHlzO1xufSwgTy5zb21lKSwgY29uc3RhbnQoTy5ub25lKSkpO1xuZXhwb3J0IGNvbnN0IHRyYW5zcG9zZSA9ICh4cykgPT4ge1xuICAgIGlmIChBLmlzRW1wdHkoeHMpKVxuICAgICAgICByZXR1cm4gW107XG4gICAgaWYgKEEuaXNFbXB0eSh4c1swXSkpXG4gICAgICAgIHJldHVybiB0cmFuc3Bvc2UoQS5kcm9wTGVmdCgxKSh4cykpO1xuICAgIGNvbnN0IFtbeSwgLi4ueXNdLCAuLi55c3NdID0geHM7XG4gICAgY29uc3QgenMgPSBbeSwgLi4uQS5maWx0ZXJNYXAoQS5oZWFkKSh5c3MpXTtcbiAgICBjb25zdCB6c3MgPSBbeXMsIC4uLkEubWFwKEEuZHJvcExlZnQoMSkpKHlzcyldO1xuICAgIHJldHVybiBbenMsIC4uLnRyYW5zcG9zZSh6c3MpXTtcbn07XG5leHBvcnQgY29uc3QgdGFrZVJpZ2h0V2hpbGUgPSAoZikgPT4gZmxvdyhBLnJldmVyc2UsIEEudGFrZUxlZnRXaGlsZShmKSwgQS5yZXZlcnNlKTtcbmV4cG9ydCBjb25zdCBzeW1tZXRyaWNEaWZmZXJlbmNlID0gKGVxKSA9PiAoeHMpID0+IHlzID0+IEEuZ2V0TW9ub2lkKCkuY29uY2F0KEEuZGlmZmVyZW5jZShlcSkoeXMpKHhzKSwgQS5kaWZmZXJlbmNlKGVxKSh4cykoeXMpKTtcbmV4cG9ydCBjb25zdCByZWR1Y2VXaGlsZSA9IChwKSA9PiAoZikgPT4ge1xuICAgIGNvbnN0IGdvID0gKGFjYykgPT4gKHlzKSA9PiBwaXBlKE5FQS5mcm9tQXJyYXkoeXMpLCBPLmZpbHRlcihmbG93KE5FQS5oZWFkLCBwKSksIE8uZm9sZChjb25zdGFudChhY2MpLCBmbG93KE5FQS51bnByZXBlbmQsIChbeiwgenNdKSA9PiBnbyhmKHopKGFjYykpKHpzKSkpKTtcbiAgICByZXR1cm4gZ287XG59O1xuZXhwb3J0IGNvbnN0IHJlZHVjZVJpZ2h0V2hpbGUgPSAocCkgPT4gKGYpID0+ICh4KSA9PiBmbG93KEEucmV2ZXJzZSwgcmVkdWNlV2hpbGUocCkoZikoeCkpO1xuZXhwb3J0IGNvbnN0IG1pbmltdW0gPSBmbG93KG1pbiwgTkVBLmNvbmNhdEFsbCk7XG5leHBvcnQgY29uc3QgbWF4aW11bSA9IGZsb3cobWF4LCBORUEuY29uY2F0QWxsKTtcbmV4cG9ydCBjb25zdCB6aXBBbGwgPSAoeHMpID0+ICh5cykgPT4ge1xuICAgIGNvbnN0IHpzID0gQS56aXAoeXMsIHhzKTtcbiAgICBjb25zdCBnZXRSZW0gPSBzbGljZShBLnNpemUoenMpKShJbmZpbml0eSk7XG4gICAgY29uc3QgcmVzdCA9IHBpcGUob3JkTnVtYmVyLmNvbXBhcmUoQS5zaXplKHlzKSwgQS5zaXplKHhzKSksIG9yZGVyaW5nTWF0Y2goKCkgPT4gcGlwZSh4cywgZ2V0UmVtLCBBLm1hcChULnJpZ2h0KSksIGNvbnN0YW50KEEuZW1wdHkpLCAoKSA9PiBwaXBlKHlzLCBnZXRSZW0sIEEubWFwKFQubGVmdCkpKSk7XG4gICAgcmV0dXJuIHBpcGUoenMsIEEubWFwKChbemEsIHpiXSkgPT4gVC5ib3RoKHphLCB6YikpLCBBLmNvbmNhdChyZXN0KSk7XG59O1xuZXhwb3J0IGZ1bmN0aW9uIGZpbHRlckEoRikge1xuICAgIHJldHVybiBwID0+IHhzID0+IEEuV2l0aGVyYWJsZS53aXRoZXIoRikoeHMsIHggPT4gRi5tYXAocCh4KSwgeSA9PiAoeSA/IE8uc29tZSh4KSA6IE8ubm9uZSkpKTtcbn1cbmV4cG9ydCBjb25zdCBleHRyYWN0QXQgPSAoaSkgPT4gKHhzKSA9PiBwaXBlKHhzLCBBLmxvb2t1cChpKSwgTy5tYXAoeCA9PiBbeCwgQS51bnNhZmVEZWxldGVBdChpLCB4cyldKSk7XG5leHBvcnQgY29uc3QgZnJvbUl0ZXJhYmxlID0gQXJyYXkuZnJvbTtcbmV4cG9ydCBjb25zdCBmcm9tUmVhZG9ubHkgPSBSQS50b0FycmF5O1xuZXhwb3J0IGNvbnN0IHRvUmVhZG9ubHkgPSBSQS5mcm9tQXJyYXk7XG5leHBvcnQgZnVuY3Rpb24gYWxsTShNKSB7XG4gICAgcmV0dXJuIEEucmVkdWNlKE0ub2YodHJ1ZSksICh4LCB5KSA9PiBNLmNoYWluKHgsIGIgPT4gKGIgPyB5IDogTS5vZihmYWxzZSkpKSk7XG59XG5leHBvcnQgZnVuY3Rpb24gYW55TShNKSB7XG4gICAgcmV0dXJuIEEucmVkdWNlKE0ub2YoZmFsc2UpLCAoeCwgeSkgPT4gTS5jaGFpbih4LCBiID0+IChiID8gTS5vZih0cnVlKSA6IHkpKSk7XG59XG5leHBvcnQgY29uc3Qgc2VwYXJhdGVORSA9ICh4cykgPT4gcGlwZSh4cywgQS5zZXBhcmF0ZSwgKHsgbGVmdCwgcmlnaHQgfSkgPT4ge1xuICAgIGlmIChBLmlzRW1wdHkobGVmdCkpXG4gICAgICAgIHJldHVybiBULnJpZ2h0KHJpZ2h0KTtcbiAgICBlbHNlIGlmIChBLmlzRW1wdHkocmlnaHQpKVxuICAgICAgICByZXR1cm4gVC5sZWZ0KGxlZnQpO1xuICAgIGVsc2VcbiAgICAgICAgcmV0dXJuIFQuYm90aChsZWZ0LCByaWdodCk7XG59KTtcbiIsCiAgImltcG9ydCB7IGNvbnN0YW50LCBwaXBlLCBmbG93LCBmbGlwIH0gZnJvbSBcImZwLXRzL2Z1bmN0aW9uXCI7XG5pbXBvcnQgeyBub3QgfSBmcm9tIFwiZnAtdHMvUHJlZGljYXRlXCI7XG5pbXBvcnQgeyBtYXRjaCBhcyBvcmRlcmluZ01hdGNoIH0gZnJvbSBcImZwLXRzL09yZGVyaW5nXCI7XG5pbXBvcnQgeyBPcmQgYXMgb3JkTnVtYmVyLCBNb25vaWRQcm9kdWN0LCBNb25vaWRTdW0gfSBmcm9tIFwiZnAtdHMvbnVtYmVyXCI7XG5pbXBvcnQgKiBhcyBORUEgZnJvbSBcImZwLXRzL05vbkVtcHR5QXJyYXlcIjtcbmltcG9ydCAqIGFzIFJBIGZyb20gXCJmcC10cy9SZWFkb25seUFycmF5XCI7XG5pbXBvcnQgKiBhcyBBIGZyb20gXCJmcC10cy9BcnJheVwiO1xuaW1wb3J0ICogYXMgUiBmcm9tIFwiZnAtdHMvUmVjb3JkXCI7XG5pbXBvcnQgKiBhcyBPIGZyb20gXCJmcC10cy9PcHRpb25cIjtcbmltcG9ydCAqIGFzIEIgZnJvbSBcImZwLXRzL2Jvb2xlYW5cIjtcbmltcG9ydCB7IHJlZHVjZU0gfSBmcm9tIFwiZnAtdHMvRm9sZGFibGVcIjtcbmltcG9ydCB7IGNvbmNhdEFsbCB9IGZyb20gXCJmcC10cy9Nb25vaWRcIjtcbmltcG9ydCB7IG1heCwgbWluIH0gZnJvbSBcImZwLXRzL1NlbWlncm91cFwiO1xuaW1wb3J0IHsgaW52b2tlIH0gZnJvbSBcIi4vRnVuY3Rpb25cIjtcbmltcG9ydCAqIGFzIFQgZnJvbSBcImZwLXRzL1RoZXNlXCI7XG5leHBvcnQgY29uc3QgZWxlbVYgPSAoZXEpID0+ICh4cykgPT4geSA9PiBBLmVsZW0oZXEpKHkpKHhzKTtcbmV4cG9ydCBjb25zdCBub25lID0gZmxvdyhub3QsIHAgPT4gQS5ldmVyeShwKSk7XG5leHBvcnQgY29uc3Qgam9pbiA9ICh4KSA9PiBpbnZva2UoXCJqb2luXCIpKFt4XSk7XG5leHBvcnQgY29uc3QgZ2V0RGlzb3JkZXJlZEVxID0gKG9yZEEpID0+ICh7XG4gICAgZXF1YWxzOiAoeHMsIHlzKSA9PiB7XG4gICAgICAgIGNvbnN0IHNvcnQgPSBBLnNvcnQob3JkQSk7XG4gICAgICAgIHJldHVybiBBLmdldEVxKG9yZEEpLmVxdWFscyhzb3J0KHhzKSwgc29ydCh5cykpO1xuICAgIH0sXG59KTtcbmV4cG9ydCBjb25zdCBwbHVja0ZpcnN0ID0gKHApID0+ICh4cykgPT4gcGlwZShBLmZpbmRJbmRleChwKSh4cyksIE8uZm9sZChjb25zdGFudChbTy5ub25lLCB4c10pLCBpID0+IFtcbiAgICBPLnNvbWUoeHNbaV0pLFxuICAgIEEudW5zYWZlRGVsZXRlQXQoaSwgeHMpLFxuXSkpO1xuZXhwb3J0IGNvbnN0IHVwc2VydCA9IChlcUEpID0+ICh4KSA9PiAoeXMpID0+IHBpcGUoQS5maW5kSW5kZXgoeSA9PiBlcUEuZXF1YWxzKHgsIHkpKSh5cyksIE8ubWFwKGkgPT4gQS51bnNhZmVVcGRhdGVBdChpLCB4LCB5cykpLCBPLmNoYWluKE5FQS5mcm9tQXJyYXkpLCBPLmdldE9yRWxzZSgoKSA9PiBBLmFwcGVuZCh4KSh5cykpKTtcbmV4cG9ydCBjb25zdCBpbnNlcnRNYW55ID0gKGkpID0+ICh4cykgPT4gKHlzKSA9PiBwaXBlKHhzLCBBLnJldmVyc2UsIHJlZHVjZU0oTy5Nb25hZCwgQS5Gb2xkYWJsZSkoeXMsICh6cywgeCkgPT4gcGlwZSh6cywgQS5pbnNlcnRBdChpLCB4KSkpLCBPLmNoYWluKE5FQS5mcm9tQXJyYXkpKTtcbmV4cG9ydCBjb25zdCBkcm9wUmVwZWF0cyA9IGVxID0+IHhzID0+IHBpcGUoeHMsIEEuZmlsdGVyV2l0aEluZGV4KChpLCB4KSA9PiBpID09PSAwIHx8ICFlcS5lcXVhbHMoeCwgeHNbaSAtIDFdKSkpO1xuZXhwb3J0IGNvbnN0IHN0YXJ0c1dpdGggPSAoZXEpID0+IChzdGFydCkgPT4gZmxvdyhBLnRha2VMZWZ0KHN0YXJ0Lmxlbmd0aCksIHhzID0+IEEuZ2V0RXEoZXEpLmVxdWFscyh4cywgc3RhcnQpKTtcbmV4cG9ydCBjb25zdCBlbmRzV2l0aCA9IChlcSkgPT4gKGVuZCkgPT4gZmxvdyhBLnRha2VSaWdodChlbmQubGVuZ3RoKSwgeHMgPT4gQS5nZXRFcShlcSkuZXF1YWxzKHhzLCBlbmQpKTtcbmV4cG9ydCBjb25zdCB3aXRob3V0ID0gKGVxKSA9PiAoeHMpID0+IEEuZmlsdGVyKHkgPT4gIUEuZWxlbShlcSkoeSkoeHMpKTtcbmV4cG9ydCBjb25zdCBjYXJ0ZXNpYW4gPSAoeHMpID0+ICh5cykgPT4gcGlwZSh4cywgQS5jaGFpbih4ID0+IHBpcGUoeXMsIEEubWFwKHkgPT4gW3gsIHldKSkpKTtcbmV4cG9ydCBjb25zdCBzdW0gPSBjb25jYXRBbGwoTW9ub2lkU3VtKTtcbmV4cG9ydCBjb25zdCBwcm9kdWN0ID0gY29uY2F0QWxsKE1vbm9pZFByb2R1Y3QpO1xuZXhwb3J0IGNvbnN0IG1lYW4gPSAoeHMpID0+IHN1bSh4cykgLyB4cy5sZW5ndGg7XG5leHBvcnQgY29uc3QgbWVkaWFuID0gZmxvdyhORUEuc29ydChvcmROdW1iZXIpLCB4cyA9PiB7XG4gICAgY29uc3QgaSA9IHhzLmxlbmd0aCAvIDI7XG4gICAgcmV0dXJuIGkgJSAxID09PSAwID8gKHhzW2kgLSAxXSArIHhzW2ldKSAvIDIgOiB4c1tNYXRoLmZsb29yKGkpXTtcbn0pO1xuZXhwb3J0IGNvbnN0IGFwZXJ0dXJlID0gKG4pID0+ICh4cykgPT4ge1xuICAgIGNvbnN0IGdvID0gKGkpID0+ICh5cykgPT4gaSArIG4gPiB4cy5sZW5ndGggPyB5cyA6IGdvKGkgKyAxKShBLmFwcGVuZChzbGljZShpKShuICsgaSkoeHMpKSh5cykpO1xuICAgIHJldHVybiBuIDwgMSA/IFtdIDogZ28oMCkoW10pO1xufTtcbmV4cG9ydCBjb25zdCBzbGljZSA9IChzdGFydCkgPT4gKGVuZCkgPT4gaW52b2tlKFwic2xpY2VcIikoW3N0YXJ0LCBlbmRdKTtcbmV4cG9ydCBjb25zdCByZWplY3QgPSAoZikgPT4gQS5maWx0ZXIobm90KGYpKTtcbmV4cG9ydCBjb25zdCBtb3ZlRnJvbSA9IChmcm9tKSA9PiAodG8pID0+ICh4cykgPT4gZnJvbSA+PSB4cy5sZW5ndGggfHwgdG8gPj0geHMubGVuZ3RoXG4gICAgPyBPLm5vbmVcbiAgICA6IGZyb20gPT09IHRvXG4gICAgICAgID8gTy5zb21lKHhzKVxuICAgICAgICA6IHBpcGUoeHMsIEEubG9va3VwKGZyb20pLCBPLmNoYWluKHggPT4gcGlwZShBLmRlbGV0ZUF0KGZyb20pKHhzKSwgTy5jaGFpbihBLmluc2VydEF0KHRvLCB4KSkpKSk7XG5leHBvcnQgY29uc3QgbW92ZVRvID0gZmxpcChtb3ZlRnJvbSk7XG5leHBvcnQgY29uc3QgY291bnRCeSA9IChmKSA9PiAoeHMpID0+IFIuZnJvbUZvbGRhYmxlTWFwKE1vbm9pZFN1bSwgQS5Gb2xkYWJsZSkoeHMsIHggPT4gW2YoeCksIDFdKTtcbmV4cG9ydCBjb25zdCBkcm9wUmlnaHRXaGlsZSA9IChmKSA9PiBmbG93KEEucmV2ZXJzZSwgQS5kcm9wTGVmdFdoaWxlKGYpLCBBLnJldmVyc2UpO1xuZXhwb3J0IGNvbnN0IGRyb3BBdCA9IChpKSA9PiAobikgPT4gKHhzKSA9PiBwaXBlKEEuaXNPdXRPZkJvdW5kKGksIHhzKSwgQi5mb2xkKCgpID0+IHBpcGUoQS5jb3B5KHhzKSwgeXMgPT4ge1xuICAgIHlzLnNwbGljZShpLCBuKTtcbiAgICByZXR1cm4geXM7XG59LCBPLnNvbWUpLCBjb25zdGFudChPLm5vbmUpKSk7XG5leHBvcnQgY29uc3QgdHJhbnNwb3NlID0gKHhzKSA9PiB7XG4gICAgaWYgKEEuaXNFbXB0eSh4cykpXG4gICAgICAgIHJldHVybiBbXTtcbiAgICBpZiAoQS5pc0VtcHR5KHhzWzBdKSlcbiAgICAgICAgcmV0dXJuIHRyYW5zcG9zZShBLmRyb3BMZWZ0KDEpKHhzKSk7XG4gICAgY29uc3QgW1t5LCAuLi55c10sIC4uLnlzc10gPSB4cztcbiAgICBjb25zdCB6cyA9IFt5LCAuLi5BLmZpbHRlck1hcChBLmhlYWQpKHlzcyldO1xuICAgIGNvbnN0IHpzcyA9IFt5cywgLi4uQS5tYXAoQS5kcm9wTGVmdCgxKSkoeXNzKV07XG4gICAgcmV0dXJuIFt6cywgLi4udHJhbnNwb3NlKHpzcyldO1xufTtcbmV4cG9ydCBjb25zdCB0YWtlUmlnaHRXaGlsZSA9IChmKSA9PiBmbG93KEEucmV2ZXJzZSwgQS50YWtlTGVmdFdoaWxlKGYpLCBBLnJldmVyc2UpO1xuZXhwb3J0IGNvbnN0IHN5bW1ldHJpY0RpZmZlcmVuY2UgPSAoZXEpID0+ICh4cykgPT4geXMgPT4gQS5nZXRNb25vaWQoKS5jb25jYXQoQS5kaWZmZXJlbmNlKGVxKSh5cykoeHMpLCBBLmRpZmZlcmVuY2UoZXEpKHhzKSh5cykpO1xuZXhwb3J0IGNvbnN0IHJlZHVjZVdoaWxlID0gKHApID0+IChmKSA9PiB7XG4gICAgY29uc3QgZ28gPSAoYWNjKSA9PiAoeXMpID0+IHBpcGUoTkVBLmZyb21BcnJheSh5cyksIE8uZmlsdGVyKGZsb3coTkVBLmhlYWQsIHApKSwgTy5mb2xkKGNvbnN0YW50KGFjYyksIGZsb3coTkVBLnVucHJlcGVuZCwgKFt6LCB6c10pID0+IGdvKGYoeikoYWNjKSkoenMpKSkpO1xuICAgIHJldHVybiBnbztcbn07XG5leHBvcnQgY29uc3QgcmVkdWNlUmlnaHRXaGlsZSA9IChwKSA9PiAoZikgPT4gKHgpID0+IGZsb3coQS5yZXZlcnNlLCByZWR1Y2VXaGlsZShwKShmKSh4KSk7XG5leHBvcnQgY29uc3QgbWluaW11bSA9IGZsb3cobWluLCBORUEuY29uY2F0QWxsKTtcbmV4cG9ydCBjb25zdCBtYXhpbXVtID0gZmxvdyhtYXgsIE5FQS5jb25jYXRBbGwpO1xuZXhwb3J0IGNvbnN0IHppcEFsbCA9ICh4cykgPT4gKHlzKSA9PiB7XG4gICAgY29uc3QgenMgPSBBLnppcCh5cywgeHMpO1xuICAgIGNvbnN0IGdldFJlbSA9IHNsaWNlKEEuc2l6ZSh6cykpKEluZmluaXR5KTtcbiAgICBjb25zdCByZXN0ID0gcGlwZShvcmROdW1iZXIuY29tcGFyZShBLnNpemUoeXMpLCBBLnNpemUoeHMpKSwgb3JkZXJpbmdNYXRjaCgoKSA9PiBwaXBlKHhzLCBnZXRSZW0sIEEubWFwKFQucmlnaHQpKSwgY29uc3RhbnQoQS5lbXB0eSksICgpID0+IHBpcGUoeXMsIGdldFJlbSwgQS5tYXAoVC5sZWZ0KSkpKTtcbiAgICByZXR1cm4gcGlwZSh6cywgQS5tYXAoKFt6YSwgemJdKSA9PiBULmJvdGgoemEsIHpiKSksIEEuY29uY2F0KHJlc3QpKTtcbn07XG5leHBvcnQgZnVuY3Rpb24gZmlsdGVyQShGKSB7XG4gICAgcmV0dXJuIHAgPT4geHMgPT4gQS5XaXRoZXJhYmxlLndpdGhlcihGKSh4cywgeCA9PiBGLm1hcChwKHgpLCB5ID0+ICh5ID8gTy5zb21lKHgpIDogTy5ub25lKSkpO1xufVxuZXhwb3J0IGNvbnN0IGV4dHJhY3RBdCA9IChpKSA9PiAoeHMpID0+IHBpcGUoeHMsIEEubG9va3VwKGkpLCBPLm1hcCh4ID0+IFt4LCBBLnVuc2FmZURlbGV0ZUF0KGksIHhzKV0pKTtcbmV4cG9ydCBjb25zdCBmcm9tSXRlcmFibGUgPSBBcnJheS5mcm9tO1xuZXhwb3J0IGNvbnN0IGZyb21SZWFkb25seSA9IFJBLnRvQXJyYXk7XG5leHBvcnQgY29uc3QgdG9SZWFkb25seSA9IFJBLmZyb21BcnJheTtcbmV4cG9ydCBmdW5jdGlvbiBhbGxNKE0pIHtcbiAgICByZXR1cm4gQS5yZWR1Y2UoTS5vZih0cnVlKSwgKHgsIHkpID0+IE0uY2hhaW4oeCwgYiA9PiAoYiA/IHkgOiBNLm9mKGZhbHNlKSkpKTtcbn1cbmV4cG9ydCBmdW5jdGlvbiBhbnlNKE0pIHtcbiAgICByZXR1cm4gQS5yZWR1Y2UoTS5vZihmYWxzZSksICh4LCB5KSA9PiBNLmNoYWluKHgsIGIgPT4gKGIgPyBNLm9mKHRydWUpIDogeSkpKTtcbn1cbmV4cG9ydCBjb25zdCBzZXBhcmF0ZU5FID0gKHhzKSA9PiBwaXBlKHhzLCBBLnNlcGFyYXRlLCAoeyBsZWZ0LCByaWdodCB9KSA9PiB7XG4gICAgaWYgKEEuaXNFbXB0eShsZWZ0KSlcbiAgICAgICAgcmV0dXJuIFQucmlnaHQocmlnaHQpO1xuICAgIGVsc2UgaWYgKEEuaXNFbXB0eShyaWdodCkpXG4gICAgICAgIHJldHVybiBULmxlZnQobGVmdCk7XG4gICAgZWxzZVxuICAgICAgICByZXR1cm4gVC5ib3RoKGxlZnQsIHJpZ2h0KTtcbn0pO1xuIiwKICAiaW1wb3J0IHsgYXJyYXkgYXMgYSwgbnVtYmVyIH0gZnJvbSBcImZwLXRzXCJcclxuaW1wb3J0IHsgZmxvdywgcGlwZSB9IGZyb20gXCJmcC10cy9mdW5jdGlvblwiXHJcbmltcG9ydCB7IE1vdXNldHJhcEluc3RhbmNlIH0gZnJvbSBcIm1vdXNldHJhcFwiXHJcbmltcG9ydCB7IG1lYW4gfSBmcm9tIFwiZnAtdHMtc3RkL0FycmF5XCJcclxuaW1wb3J0IHsgY2xhbXAgfSBmcm9tIFwiZnAtdHMvT3JkXCJcclxuXHJcbnR5cGUgU25lYWtLZXkgPSBIVE1MU3BhbkVsZW1lbnQgJiB7IHRhcmdldDogSFRNTEVsZW1lbnQgfVxyXG5cclxuZXhwb3J0IGNvbnN0IG1vdXNldHJhcDogTW91c2V0cmFwSW5zdGFuY2UgPSBTcGljZXRpZnkuTW91c2V0cmFwKCkgYXMgYW55XHJcblxyXG5leHBvcnQgY29uc3Qga2V5TGlzdCA9IFwiYWJjZGVmZ2hpamtsbW5vcHFyc3R1dnd4eXpcIi5zcGxpdChcIlwiKVxyXG5cclxuY29uc3QgZ2V0U25lYWtLZXlzID0gKCkgPT4gQXJyYXkuZnJvbShzbmVha092ZXJsYXkuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZShcInNuZWFrLWtleVwiKSkgYXMgU25lYWtLZXlbXVxyXG5cclxuY29uc3QgY2xlYXJTb21lU25lYWtLZXlzID0gKHNuZWFrS2V5czogU25lYWtLZXlbXSkgPT4ge1xyXG4gICAgaWYgKHNuZWFrS2V5cy5sZW5ndGggPT09IDApIHJldHVybiBmYWxzZVxyXG5cclxuICAgIHNuZWFrT3ZlcmxheS5yZW1vdmUoKVxyXG4gICAgcGlwZShcclxuICAgICAgICBzbmVha0tleXMsXHJcbiAgICAgICAgYS5tYXAoZSA9PiBlLnJlbW92ZSgpKSxcclxuICAgIClcclxuICAgIGRvY3VtZW50LmJvZHkuYXBwZW5kKHNuZWFrT3ZlcmxheSlcclxuICAgIHJldHVybiB0cnVlXHJcbn1cclxuY29uc3QgY2xlYXJTbmVha0tleXMgPSBmbG93KGdldFNuZWFrS2V5cywgY2xlYXJTb21lU25lYWtLZXlzKVxyXG5cclxuZXhwb3J0IGNvbnN0IGVudGVyU25lYWsgPSAoKSA9PiB7XHJcbiAgICBzbmVha092ZXJsYXkuc3R5bGUuZGlzcGxheSA9IFwiYmxvY2tcIlxyXG5cclxuICAgIGlmIChjbGVhclNuZWFrS2V5cygpKSByZXR1cm5cclxuXHJcbiAgICBjb25zdCBpc0VsZW1lbnRWaXNpYmxlID0gKGU6IEhUTUxFbGVtZW50KSA9PiBlLmNoZWNrVmlzaWJpbGl0eSh7IGNoZWNrT3BhY2l0eTogdHJ1ZSwgY2hlY2tWaXNpYmlsaXR5Q1NTOiB0cnVlIH0pXHJcbiAgICBjb25zdCBpc0VsZW1lbnRJblZpZXdQb3J0ID0gKGU6IEhUTUxFbGVtZW50KSA9PiB7XHJcbiAgICAgICAgY29uc3QgYyA9IGRvY3VtZW50LmJvZHlcclxuICAgICAgICBjb25zdCBib3VuZCA9IGUuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KClcclxuICAgICAgICBjb25zdCB3aXRoaW4gPSAobTogbnVtYmVyLCBNOiBudW1iZXIpID0+ICh4OiBudW1iZXIpID0+IHggPT09IGNsYW1wKG51bWJlci5PcmQpKG0sIE0pKHgpXHJcbiAgICAgICAgcmV0dXJuIChcclxuICAgICAgICAgICAgcGlwZShtZWFuKFtib3VuZC50b3AsIGJvdW5kLmJvdHRvbV0pLCB3aXRoaW4oMCwgYy5jbGllbnRIZWlnaHQpKSAmJlxyXG4gICAgICAgICAgICBwaXBlKG1lYW4oW2JvdW5kLmxlZnQsIGJvdW5kLnJpZ2h0XSksIHdpdGhpbigwLCBjLmNsaWVudFdpZHRoKSlcclxuICAgICAgICApXHJcbiAgICB9XHJcblxyXG4gICAgY29uc3QgY3JlYXRlU25lYWtLZXkgPSAodGFyZ2V0OiBIVE1MRWxlbWVudCwga2V5OiBzdHJpbmcsIHRvcDogc3RyaW5nIHwgbnVtYmVyLCBsZWZ0OiBzdHJpbmcgfCBudW1iZXIpID0+IHtcclxuICAgICAgICBjb25zdCBzbmVha0tleSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJzcGFuXCIpIGFzIFNuZWFrS2V5XHJcbiAgICAgICAgc25lYWtLZXkuY2xhc3NMaXN0LmFkZChcInNuZWFrLWtleVwiKVxyXG4gICAgICAgIHNuZWFrS2V5LmlubmVyVGV4dCA9IGtleVxyXG4gICAgICAgIHNuZWFrS2V5LnN0eWxlLnRvcCA9IHRvcCArIFwicHhcIlxyXG4gICAgICAgIHNuZWFrS2V5LnN0eWxlLmxlZnQgPSBsZWZ0ICsgXCJweFwiXHJcbiAgICAgICAgc25lYWtLZXkudGFyZ2V0ID0gdGFyZ2V0XHJcbiAgICAgICAgcmV0dXJuIHNuZWFrS2V5XHJcbiAgICB9XHJcblxyXG4gICAgY29uc3Qgc25lYWtLZXlzRnJhZ21lbnQgPSBkb2N1bWVudC5jcmVhdGVEb2N1bWVudEZyYWdtZW50KClcclxuICAgIGNvbnN0IGxpbmtTZWxlY3RvciA9IGAuUm9vdF9fdG9wLWNvbnRhaW5lciBbaHJlZl06bm90KGxpbmspLC5Sb290X190b3AtY29udGFpbmVyIGJ1dHRvbiwuUm9vdF9fdG9wLWNvbnRhaW5lciBbcm9sZT1cImJ1dHRvblwiXWBcclxuXHJcbiAgICBzaG91bGRMaXN0ZW5Ub1NuZWFrQmluZHMgPSBwaXBlKFxyXG4gICAgICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwobGlua1NlbGVjdG9yKSxcclxuICAgICAgICB4ID0+IEFycmF5LmZyb20oeCkgYXMgSFRNTEVsZW1lbnRbXSxcclxuICAgICAgICBhLmZpbHRlcihpc0VsZW1lbnRWaXNpYmxlKSxcclxuICAgICAgICBhLmZpbHRlcihpc0VsZW1lbnRJblZpZXdQb3J0KSxcclxuICAgICAgICBhLnJlZHVjZTxIVE1MRWxlbWVudCwgW251bWJlciwgbnVtYmVyXT4oWzAsIDBdLCAoW2sxLCBrMl0sIGUpID0+IHtcclxuICAgICAgICAgICAgY29uc3QgeyB4LCB5IH0gPSBlLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpXHJcbiAgICAgICAgICAgIHNuZWFrS2V5c0ZyYWdtZW50LmFwcGVuZChjcmVhdGVTbmVha0tleShlLCBrZXlMaXN0W2sxXSArIGtleUxpc3RbazIrK10sIHksIHgpKVxyXG4gICAgICAgICAgICByZXR1cm4gazIgPj0ga2V5TGlzdC5sZW5ndGggPyBbKytrMSwgMF0gOiBbazEsIGsyXVxyXG4gICAgICAgIH0pLFxyXG4gICAgICAgIChbazEsIGsyXSkgPT4gazEgKyBrMiA+IDAsXHJcbiAgICApXHJcblxyXG4gICAgaWYgKHNob3VsZExpc3RlblRvU25lYWtCaW5kcykgc25lYWtPdmVybGF5LmFwcGVuZChzbmVha0tleXNGcmFnbWVudClcclxufVxyXG5cclxuZXhwb3J0IGNvbnN0IHF1aXRTbmVhayA9ICgpID0+IHtcclxuICAgIHNuZWFrT3ZlcmxheS5zdHlsZS5kaXNwbGF5ID0gXCJub25lXCJcclxuICAgIGNsZWFyU25lYWtLZXlzKClcclxuICAgIGxpc3RlbmluZ1RvU25lYWtCaW5kcyA9IGZhbHNlXHJcbn1cclxuXHJcbmV4cG9ydCBjb25zdCBsaXN0ZW5TbmVha0tleXMgPSAoeyBrZXkgfTogS2V5Ym9hcmRFdmVudCkgPT4ge1xyXG4gICAgaWYgKCFsaXN0ZW5pbmdUb1NuZWFrQmluZHMpIHtcclxuICAgICAgICBpZiAoc2hvdWxkTGlzdGVuVG9TbmVha0JpbmRzKSB7XHJcbiAgICAgICAgICAgIHNob3VsZExpc3RlblRvU25lYWtCaW5kcyA9IGZhbHNlXHJcbiAgICAgICAgICAgIGxpc3RlbmluZ1RvU25lYWtCaW5kcyA9IHRydWVcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuXHJcbiAgICB9XHJcbiAgICBjb25zdCBzbmVha0tleXMgPSBnZXRTbmVha0tleXMoKVxyXG5cclxuICAgIGlmIChzbmVha0tleXMubGVuZ3RoID09PSAwKSByZXR1cm4gdm9pZCBxdWl0U25lYWsoKVxyXG5cclxuICAgIHtcclxuICAgICAgICBzbmVha092ZXJsYXkucmVtb3ZlKClcclxuXHJcbiAgICAgICAgc25lYWtLZXlzLm1hcChzbmVha0tleSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IFtrMSwgLi4ua3NdID0gc25lYWtLZXkuaW5uZXJUZXh0LnRvTG93ZXJDYXNlKClcclxuICAgICAgICAgICAgaWYgKGsxICE9PSBrZXkpIHJldHVybiB2b2lkIHNuZWFrS2V5LnJlbW92ZSgpXHJcblxyXG4gICAgICAgICAgICBpZiAoa3MubGVuZ3RoID09PSAwKSB7XHJcbiAgICAgICAgICAgICAgICBzbmVha0tleS50YXJnZXQuY2xpY2soKVxyXG4gICAgICAgICAgICAgICAgcXVpdFNuZWFrKClcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHNuZWFrS2V5LmlubmVyVGV4dCA9IGtzLmpvaW4oXCJcIilcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pXHJcblxyXG4gICAgICAgIGRvY3VtZW50LmJvZHkuYXBwZW5kKHNuZWFrT3ZlcmxheSlcclxuICAgIH1cclxuXHJcbiAgICBpZiAoc25lYWtPdmVybGF5LmNoaWxkTm9kZXMubGVuZ3RoID09PSAxKSBxdWl0U25lYWsoKVxyXG59XHJcblxyXG5sZXQgc2hvdWxkTGlzdGVuVG9TbmVha0JpbmRzID0gZmFsc2VcclxuZXhwb3J0IGxldCBsaXN0ZW5pbmdUb1NuZWFrQmluZHMgPSBmYWxzZVxyXG5cclxuY29uc3Qgc25lYWtPdmVybGF5ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKVxyXG5zbmVha092ZXJsYXkuaWQgPSBcInNuZWFrLW92ZXJsYXlcIlxyXG5kb2N1bWVudC5ib2R5LmFwcGVuZChzbmVha092ZXJsYXkpXHJcbiIsCiAgImltcG9ydCB7IGNvbnN0YW50LCBpZGVudGl0eSB9IGZyb20gXCJmcC10cy9mdW5jdGlvblwiO1xuaW1wb3J0IHsgZmxhcCBhcyBmbGFwXywgYmluZFRvIGFzIGJpbmRUb18sIGxldCBhcyBsZXRfXywgfSBmcm9tIFwiZnAtdHMvRnVuY3RvclwiO1xuaW1wb3J0IHsgYXBGaXJzdCBhcyBhcEZpcnN0XywgYXBTIGFzIGFwU18sIGFwU2Vjb25kIGFzIGFwU2Vjb25kXywgfSBmcm9tIFwiZnAtdHMvQXBwbHlcIjtcbmltcG9ydCB7IGJpbmQgYXMgYmluZF8sIGNoYWluRmlyc3QgYXMgY2hhaW5GaXJzdF8gfSBmcm9tIFwiZnAtdHMvQ2hhaW5cIjtcbmltcG9ydCAqIGFzIFJORUEgZnJvbSBcImZwLXRzL1JlYWRvbmx5Tm9uRW1wdHlBcnJheVwiO1xuaW1wb3J0ICogYXMgUkEgZnJvbSBcImZwLXRzL1JlYWRvbmx5QXJyYXlcIjtcbmV4cG9ydCBjb25zdCBVUkkgPSBcIkxhenlcIjtcbmNvbnN0IF9tYXAgPSAoZiwgZykgPT4gKCkgPT4gZyhmKCkpO1xuY29uc3QgX2FwID0gKGYsIGcpID0+ICgpID0+IGYoKShnKCkpO1xuY29uc3QgX2NoYWluID0gKGYsIGcpID0+IGcoZigpKTtcbmNvbnN0IF9jaGFpblJlYyA9IChhLCBmKSA9PiAoKSA9PiB7XG4gICAgbGV0IGUgPSBmKGEpKCk7XG4gICAgd2hpbGUgKGUuX3RhZyA9PT0gXCJMZWZ0XCIpIHtcbiAgICAgICAgZSA9IGYoZS5sZWZ0KSgpO1xuICAgIH1cbiAgICByZXR1cm4gZS5yaWdodDtcbn07XG5leHBvcnQgY29uc3QgbWFwID0gKGYpID0+IChmYSkgPT4gX21hcChmYSwgZik7XG5leHBvcnQgY29uc3QgYXAgPSBmYSA9PiBmYWIgPT4gX2FwKGZhYiwgZmEpO1xuZXhwb3J0IGNvbnN0IG9mID0gY29uc3RhbnQ7XG5leHBvcnQgY29uc3QgY2hhaW4gPSBmID0+IG1hID0+IF9jaGFpbihtYSwgZik7XG5leHBvcnQgY29uc3QgZmxhdE1hcCA9IGNoYWluO1xuZXhwb3J0IGNvbnN0IGZsYXR0ZW4gPSBjaGFpbihpZGVudGl0eSk7XG5leHBvcnQgY29uc3QgRnVuY3RvciA9IHtcbiAgICBVUkksXG4gICAgbWFwOiBfbWFwLFxufTtcbmV4cG9ydCBjb25zdCBmbGFwID0gZmxhcF8oRnVuY3Rvcik7XG5leHBvcnQgY29uc3QgUG9pbnRlZCA9IHtcbiAgICBVUkksXG4gICAgb2YsXG59O1xuZXhwb3J0IGNvbnN0IEFwcGx5ID0ge1xuICAgIFVSSSxcbiAgICBtYXA6IF9tYXAsXG4gICAgYXA6IF9hcCxcbn07XG5leHBvcnQgY29uc3QgYXBGaXJzdCA9IGFwRmlyc3RfKEFwcGx5KTtcbmV4cG9ydCBjb25zdCBhcFNlY29uZCA9IGFwU2Vjb25kXyhBcHBseSk7XG5leHBvcnQgY29uc3QgQXBwbGljYXRpdmUgPSB7XG4gICAgVVJJLFxuICAgIG1hcDogX21hcCxcbiAgICBhcDogX2FwLFxuICAgIG9mLFxufTtcbmV4cG9ydCBjb25zdCBDaGFpbiA9IHtcbiAgICBVUkksXG4gICAgbWFwOiBfbWFwLFxuICAgIGFwOiBfYXAsXG4gICAgY2hhaW46IF9jaGFpbixcbn07XG5leHBvcnQgY29uc3QgTW9uYWQgPSB7XG4gICAgVVJJLFxuICAgIG1hcDogX21hcCxcbiAgICBhcDogX2FwLFxuICAgIG9mLFxuICAgIGNoYWluOiBfY2hhaW4sXG59O1xuZXhwb3J0IGNvbnN0IGNoYWluRmlyc3QgPSBjaGFpbkZpcnN0XyhDaGFpbik7XG5leHBvcnQgY29uc3QgQ2hhaW5SZWMgPSB7XG4gICAgVVJJLFxuICAgIG1hcDogX21hcCxcbiAgICBhcDogX2FwLFxuICAgIGNoYWluOiBfY2hhaW4sXG4gICAgY2hhaW5SZWM6IF9jaGFpblJlYyxcbn07XG5leHBvcnQgY29uc3QgRG8gPSBvZih7fSk7XG5leHBvcnQgY29uc3QgYmluZFRvID0gYmluZFRvXyhGdW5jdG9yKTtcbmV4cG9ydCBjb25zdCBiaW5kID0gYmluZF8oQ2hhaW4pO1xuZXhwb3J0IGNvbnN0IGFwUyA9IGFwU18oQXBwbHkpO1xuY29uc3QgbGV0XyA9IGxldF9fKEZ1bmN0b3IpO1xuZXhwb3J0IHsgbGV0XyBhcyBsZXQsIH07XG5leHBvcnQgY29uc3QgQXBUID0gb2YoW10pO1xuZXhwb3J0IGNvbnN0IHRyYXZlcnNlUmVhZG9ubHlOb25FbXB0eUFycmF5V2l0aEluZGV4ID0gKGYpID0+IChhcykgPT4gKCkgPT4ge1xuICAgIGNvbnN0IG91dCA9IFtmKDAsIFJORUEuaGVhZChhcykpKCldO1xuICAgIGZvciAobGV0IGkgPSAxOyBpIDwgYXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgb3V0LnB1c2goZihpLCBhc1tpXSkoKSk7XG4gICAgfVxuICAgIHJldHVybiBvdXQ7XG59O1xuZXhwb3J0IGNvbnN0IHRyYXZlcnNlUmVhZG9ubHlBcnJheVdpdGhJbmRleCA9IChmKSA9PiB7XG4gICAgY29uc3QgZyA9IHRyYXZlcnNlUmVhZG9ubHlOb25FbXB0eUFycmF5V2l0aEluZGV4KGYpO1xuICAgIHJldHVybiBhcyA9PiAoUkEuaXNOb25FbXB0eShhcykgPyBnKGFzKSA6IEFwVCk7XG59O1xuZXhwb3J0IGNvbnN0IHRyYXZlcnNlQXJyYXlXaXRoSW5kZXggPSB0cmF2ZXJzZVJlYWRvbmx5QXJyYXlXaXRoSW5kZXg7XG5leHBvcnQgY29uc3QgdHJhdmVyc2VBcnJheSA9IChmKSA9PiB0cmF2ZXJzZVJlYWRvbmx5QXJyYXlXaXRoSW5kZXgoKF8sIGEpID0+IGYoYSkpO1xuZXhwb3J0IGNvbnN0IHNlcXVlbmNlQXJyYXkgPSB0cmF2ZXJzZUFycmF5KGlkZW50aXR5KTtcbmV4cG9ydCBjb25zdCBleGVjdXRlID0gKHgpID0+IHgoKTtcbmV4cG9ydCBjb25zdCBsYXp5ID0gaWRlbnRpdHk7XG5leHBvcnQgY29uc3QgbWVtb2l6ZSA9IChmKSA9PiB7XG4gICAgY29uc3QgZW1wdHkgPSBTeW1ib2woKTtcbiAgICBsZXQgcmVzID0gZW1wdHk7XG4gICAgcmV0dXJuICgpID0+IChyZXMgPT09IGVtcHR5ID8gKHJlcyA9IGYoKSkgOiByZXMpO1xufTtcbiIsCiAgImltcG9ydCB7IGNvbnN0YW50LCBpZGVudGl0eSB9IGZyb20gXCJmcC10cy9mdW5jdGlvblwiO1xuaW1wb3J0IHsgZmxhcCBhcyBmbGFwXywgYmluZFRvIGFzIGJpbmRUb18sIGxldCBhcyBsZXRfXywgfSBmcm9tIFwiZnAtdHMvRnVuY3RvclwiO1xuaW1wb3J0IHsgYXBGaXJzdCBhcyBhcEZpcnN0XywgYXBTIGFzIGFwU18sIGFwU2Vjb25kIGFzIGFwU2Vjb25kXywgfSBmcm9tIFwiZnAtdHMvQXBwbHlcIjtcbmltcG9ydCB7IGJpbmQgYXMgYmluZF8sIGNoYWluRmlyc3QgYXMgY2hhaW5GaXJzdF8gfSBmcm9tIFwiZnAtdHMvQ2hhaW5cIjtcbmltcG9ydCAqIGFzIFJORUEgZnJvbSBcImZwLXRzL1JlYWRvbmx5Tm9uRW1wdHlBcnJheVwiO1xuaW1wb3J0ICogYXMgUkEgZnJvbSBcImZwLXRzL1JlYWRvbmx5QXJyYXlcIjtcbmV4cG9ydCBjb25zdCBVUkkgPSBcIkxhenlcIjtcbmNvbnN0IF9tYXAgPSAoZiwgZykgPT4gKCkgPT4gZyhmKCkpO1xuY29uc3QgX2FwID0gKGYsIGcpID0+ICgpID0+IGYoKShnKCkpO1xuY29uc3QgX2NoYWluID0gKGYsIGcpID0+IGcoZigpKTtcbmNvbnN0IF9jaGFpblJlYyA9IChhLCBmKSA9PiAoKSA9PiB7XG4gICAgbGV0IGUgPSBmKGEpKCk7XG4gICAgd2hpbGUgKGUuX3RhZyA9PT0gXCJMZWZ0XCIpIHtcbiAgICAgICAgZSA9IGYoZS5sZWZ0KSgpO1xuICAgIH1cbiAgICByZXR1cm4gZS5yaWdodDtcbn07XG5leHBvcnQgY29uc3QgbWFwID0gKGYpID0+IChmYSkgPT4gX21hcChmYSwgZik7XG5leHBvcnQgY29uc3QgYXAgPSBmYSA9PiBmYWIgPT4gX2FwKGZhYiwgZmEpO1xuZXhwb3J0IGNvbnN0IG9mID0gY29uc3RhbnQ7XG5leHBvcnQgY29uc3QgY2hhaW4gPSBmID0+IG1hID0+IF9jaGFpbihtYSwgZik7XG5leHBvcnQgY29uc3QgZmxhdE1hcCA9IGNoYWluO1xuZXhwb3J0IGNvbnN0IGZsYXR0ZW4gPSBjaGFpbihpZGVudGl0eSk7XG5leHBvcnQgY29uc3QgRnVuY3RvciA9IHtcbiAgICBVUkksXG4gICAgbWFwOiBfbWFwLFxufTtcbmV4cG9ydCBjb25zdCBmbGFwID0gZmxhcF8oRnVuY3Rvcik7XG5leHBvcnQgY29uc3QgUG9pbnRlZCA9IHtcbiAgICBVUkksXG4gICAgb2YsXG59O1xuZXhwb3J0IGNvbnN0IEFwcGx5ID0ge1xuICAgIFVSSSxcbiAgICBtYXA6IF9tYXAsXG4gICAgYXA6IF9hcCxcbn07XG5leHBvcnQgY29uc3QgYXBGaXJzdCA9IGFwRmlyc3RfKEFwcGx5KTtcbmV4cG9ydCBjb25zdCBhcFNlY29uZCA9IGFwU2Vjb25kXyhBcHBseSk7XG5leHBvcnQgY29uc3QgQXBwbGljYXRpdmUgPSB7XG4gICAgVVJJLFxuICAgIG1hcDogX21hcCxcbiAgICBhcDogX2FwLFxuICAgIG9mLFxufTtcbmV4cG9ydCBjb25zdCBDaGFpbiA9IHtcbiAgICBVUkksXG4gICAgbWFwOiBfbWFwLFxuICAgIGFwOiBfYXAsXG4gICAgY2hhaW46IF9jaGFpbixcbn07XG5leHBvcnQgY29uc3QgTW9uYWQgPSB7XG4gICAgVVJJLFxuICAgIG1hcDogX21hcCxcbiAgICBhcDogX2FwLFxuICAgIG9mLFxuICAgIGNoYWluOiBfY2hhaW4sXG59O1xuZXhwb3J0IGNvbnN0IGNoYWluRmlyc3QgPSBjaGFpbkZpcnN0XyhDaGFpbik7XG5leHBvcnQgY29uc3QgQ2hhaW5SZWMgPSB7XG4gICAgVVJJLFxuICAgIG1hcDogX21hcCxcbiAgICBhcDogX2FwLFxuICAgIGNoYWluOiBfY2hhaW4sXG4gICAgY2hhaW5SZWM6IF9jaGFpblJlYyxcbn07XG5leHBvcnQgY29uc3QgRG8gPSBvZih7fSk7XG5leHBvcnQgY29uc3QgYmluZFRvID0gYmluZFRvXyhGdW5jdG9yKTtcbmV4cG9ydCBjb25zdCBiaW5kID0gYmluZF8oQ2hhaW4pO1xuZXhwb3J0IGNvbnN0IGFwUyA9IGFwU18oQXBwbHkpO1xuY29uc3QgbGV0XyA9IGxldF9fKEZ1bmN0b3IpO1xuZXhwb3J0IHsgbGV0XyBhcyBsZXQsIH07XG5leHBvcnQgY29uc3QgQXBUID0gb2YoW10pO1xuZXhwb3J0IGNvbnN0IHRyYXZlcnNlUmVhZG9ubHlOb25FbXB0eUFycmF5V2l0aEluZGV4ID0gKGYpID0+IChhcykgPT4gKCkgPT4ge1xuICAgIGNvbnN0IG91dCA9IFtmKDAsIFJORUEuaGVhZChhcykpKCldO1xuICAgIGZvciAobGV0IGkgPSAxOyBpIDwgYXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgb3V0LnB1c2goZihpLCBhc1tpXSkoKSk7XG4gICAgfVxuICAgIHJldHVybiBvdXQ7XG59O1xuZXhwb3J0IGNvbnN0IHRyYXZlcnNlUmVhZG9ubHlBcnJheVdpdGhJbmRleCA9IChmKSA9PiB7XG4gICAgY29uc3QgZyA9IHRyYXZlcnNlUmVhZG9ubHlOb25FbXB0eUFycmF5V2l0aEluZGV4KGYpO1xuICAgIHJldHVybiBhcyA9PiAoUkEuaXNOb25FbXB0eShhcykgPyBnKGFzKSA6IEFwVCk7XG59O1xuZXhwb3J0IGNvbnN0IHRyYXZlcnNlQXJyYXlXaXRoSW5kZXggPSB0cmF2ZXJzZVJlYWRvbmx5QXJyYXlXaXRoSW5kZXg7XG5leHBvcnQgY29uc3QgdHJhdmVyc2VBcnJheSA9IChmKSA9PiB0cmF2ZXJzZVJlYWRvbmx5QXJyYXlXaXRoSW5kZXgoKF8sIGEpID0+IGYoYSkpO1xuZXhwb3J0IGNvbnN0IHNlcXVlbmNlQXJyYXkgPSB0cmF2ZXJzZUFycmF5KGlkZW50aXR5KTtcbmV4cG9ydCBjb25zdCBleGVjdXRlID0gKHgpID0+IHgoKTtcbmV4cG9ydCBjb25zdCBsYXp5ID0gaWRlbnRpdHk7XG5leHBvcnQgY29uc3QgbWVtb2l6ZSA9IChmKSA9PiB7XG4gICAgY29uc3QgZW1wdHkgPSBTeW1ib2woKTtcbiAgICBsZXQgcmVzID0gZW1wdHk7XG4gICAgcmV0dXJuICgpID0+IChyZXMgPT09IGVtcHR5ID8gKHJlcyA9IGYoKSkgOiByZXMpO1xufTtcbiIsCiAgImltcG9ydCB7IGNvbnN0YW50LCBpZGVudGl0eSB9IGZyb20gXCJmcC10cy9mdW5jdGlvblwiO1xuaW1wb3J0IHsgZmxhcCBhcyBmbGFwXywgYmluZFRvIGFzIGJpbmRUb18sIGxldCBhcyBsZXRfXywgfSBmcm9tIFwiZnAtdHMvRnVuY3RvclwiO1xuaW1wb3J0IHsgYXBGaXJzdCBhcyBhcEZpcnN0XywgYXBTIGFzIGFwU18sIGFwU2Vjb25kIGFzIGFwU2Vjb25kXywgfSBmcm9tIFwiZnAtdHMvQXBwbHlcIjtcbmltcG9ydCB7IGJpbmQgYXMgYmluZF8sIGNoYWluRmlyc3QgYXMgY2hhaW5GaXJzdF8gfSBmcm9tIFwiZnAtdHMvQ2hhaW5cIjtcbmltcG9ydCAqIGFzIFJORUEgZnJvbSBcImZwLXRzL1JlYWRvbmx5Tm9uRW1wdHlBcnJheVwiO1xuaW1wb3J0ICogYXMgUkEgZnJvbSBcImZwLXRzL1JlYWRvbmx5QXJyYXlcIjtcbmV4cG9ydCBjb25zdCBVUkkgPSBcIkxhenlcIjtcbmNvbnN0IF9tYXAgPSAoZiwgZykgPT4gKCkgPT4gZyhmKCkpO1xuY29uc3QgX2FwID0gKGYsIGcpID0+ICgpID0+IGYoKShnKCkpO1xuY29uc3QgX2NoYWluID0gKGYsIGcpID0+IGcoZigpKTtcbmNvbnN0IF9jaGFpblJlYyA9IChhLCBmKSA9PiAoKSA9PiB7XG4gICAgbGV0IGUgPSBmKGEpKCk7XG4gICAgd2hpbGUgKGUuX3RhZyA9PT0gXCJMZWZ0XCIpIHtcbiAgICAgICAgZSA9IGYoZS5sZWZ0KSgpO1xuICAgIH1cbiAgICByZXR1cm4gZS5yaWdodDtcbn07XG5leHBvcnQgY29uc3QgbWFwID0gKGYpID0+IChmYSkgPT4gX21hcChmYSwgZik7XG5leHBvcnQgY29uc3QgYXAgPSBmYSA9PiBmYWIgPT4gX2FwKGZhYiwgZmEpO1xuZXhwb3J0IGNvbnN0IG9mID0gY29uc3RhbnQ7XG5leHBvcnQgY29uc3QgY2hhaW4gPSBmID0+IG1hID0+IF9jaGFpbihtYSwgZik7XG5leHBvcnQgY29uc3QgZmxhdE1hcCA9IGNoYWluO1xuZXhwb3J0IGNvbnN0IGZsYXR0ZW4gPSBjaGFpbihpZGVudGl0eSk7XG5leHBvcnQgY29uc3QgRnVuY3RvciA9IHtcbiAgICBVUkksXG4gICAgbWFwOiBfbWFwLFxufTtcbmV4cG9ydCBjb25zdCBmbGFwID0gZmxhcF8oRnVuY3Rvcik7XG5leHBvcnQgY29uc3QgUG9pbnRlZCA9IHtcbiAgICBVUkksXG4gICAgb2YsXG59O1xuZXhwb3J0IGNvbnN0IEFwcGx5ID0ge1xuICAgIFVSSSxcbiAgICBtYXA6IF9tYXAsXG4gICAgYXA6IF9hcCxcbn07XG5leHBvcnQgY29uc3QgYXBGaXJzdCA9IGFwRmlyc3RfKEFwcGx5KTtcbmV4cG9ydCBjb25zdCBhcFNlY29uZCA9IGFwU2Vjb25kXyhBcHBseSk7XG5leHBvcnQgY29uc3QgQXBwbGljYXRpdmUgPSB7XG4gICAgVVJJLFxuICAgIG1hcDogX21hcCxcbiAgICBhcDogX2FwLFxuICAgIG9mLFxufTtcbmV4cG9ydCBjb25zdCBDaGFpbiA9IHtcbiAgICBVUkksXG4gICAgbWFwOiBfbWFwLFxuICAgIGFwOiBfYXAsXG4gICAgY2hhaW46IF9jaGFpbixcbn07XG5leHBvcnQgY29uc3QgTW9uYWQgPSB7XG4gICAgVVJJLFxuICAgIG1hcDogX21hcCxcbiAgICBhcDogX2FwLFxuICAgIG9mLFxuICAgIGNoYWluOiBfY2hhaW4sXG59O1xuZXhwb3J0IGNvbnN0IGNoYWluRmlyc3QgPSBjaGFpbkZpcnN0XyhDaGFpbik7XG5leHBvcnQgY29uc3QgQ2hhaW5SZWMgPSB7XG4gICAgVVJJLFxuICAgIG1hcDogX21hcCxcbiAgICBhcDogX2FwLFxuICAgIGNoYWluOiBfY2hhaW4sXG4gICAgY2hhaW5SZWM6IF9jaGFpblJlYyxcbn07XG5leHBvcnQgY29uc3QgRG8gPSBvZih7fSk7XG5leHBvcnQgY29uc3QgYmluZFRvID0gYmluZFRvXyhGdW5jdG9yKTtcbmV4cG9ydCBjb25zdCBiaW5kID0gYmluZF8oQ2hhaW4pO1xuZXhwb3J0IGNvbnN0IGFwUyA9IGFwU18oQXBwbHkpO1xuY29uc3QgbGV0XyA9IGxldF9fKEZ1bmN0b3IpO1xuZXhwb3J0IHsgbGV0XyBhcyBsZXQsIH07XG5leHBvcnQgY29uc3QgQXBUID0gb2YoW10pO1xuZXhwb3J0IGNvbnN0IHRyYXZlcnNlUmVhZG9ubHlOb25FbXB0eUFycmF5V2l0aEluZGV4ID0gKGYpID0+IChhcykgPT4gKCkgPT4ge1xuICAgIGNvbnN0IG91dCA9IFtmKDAsIFJORUEuaGVhZChhcykpKCldO1xuICAgIGZvciAobGV0IGkgPSAxOyBpIDwgYXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgb3V0LnB1c2goZihpLCBhc1tpXSkoKSk7XG4gICAgfVxuICAgIHJldHVybiBvdXQ7XG59O1xuZXhwb3J0IGNvbnN0IHRyYXZlcnNlUmVhZG9ubHlBcnJheVdpdGhJbmRleCA9IChmKSA9PiB7XG4gICAgY29uc3QgZyA9IHRyYXZlcnNlUmVhZG9ubHlOb25FbXB0eUFycmF5V2l0aEluZGV4KGYpO1xuICAgIHJldHVybiBhcyA9PiAoUkEuaXNOb25FbXB0eShhcykgPyBnKGFzKSA6IEFwVCk7XG59O1xuZXhwb3J0IGNvbnN0IHRyYXZlcnNlQXJyYXlXaXRoSW5kZXggPSB0cmF2ZXJzZVJlYWRvbmx5QXJyYXlXaXRoSW5kZXg7XG5leHBvcnQgY29uc3QgdHJhdmVyc2VBcnJheSA9IChmKSA9PiB0cmF2ZXJzZVJlYWRvbmx5QXJyYXlXaXRoSW5kZXgoKF8sIGEpID0+IGYoYSkpO1xuZXhwb3J0IGNvbnN0IHNlcXVlbmNlQXJyYXkgPSB0cmF2ZXJzZUFycmF5KGlkZW50aXR5KTtcbmV4cG9ydCBjb25zdCBleGVjdXRlID0gKHgpID0+IHgoKTtcbmV4cG9ydCBjb25zdCBsYXp5ID0gaWRlbnRpdHk7XG5leHBvcnQgY29uc3QgbWVtb2l6ZSA9IChmKSA9PiB7XG4gICAgY29uc3QgZW1wdHkgPSBTeW1ib2woKTtcbiAgICBsZXQgcmVzID0gZW1wdHk7XG4gICAgcmV0dXJuICgpID0+IChyZXMgPT09IGVtcHR5ID8gKHJlcyA9IGYoKSkgOiByZXMpO1xufTtcbiIsCiAgImltcG9ydCB7IGNvbnN0YW50LCBpZGVudGl0eSB9IGZyb20gXCJmcC10cy9mdW5jdGlvblwiO1xuaW1wb3J0IHsgZmxhcCBhcyBmbGFwXywgYmluZFRvIGFzIGJpbmRUb18sIGxldCBhcyBsZXRfXywgfSBmcm9tIFwiZnAtdHMvRnVuY3RvclwiO1xuaW1wb3J0IHsgYXBGaXJzdCBhcyBhcEZpcnN0XywgYXBTIGFzIGFwU18sIGFwU2Vjb25kIGFzIGFwU2Vjb25kXywgfSBmcm9tIFwiZnAtdHMvQXBwbHlcIjtcbmltcG9ydCB7IGJpbmQgYXMgYmluZF8sIGNoYWluRmlyc3QgYXMgY2hhaW5GaXJzdF8gfSBmcm9tIFwiZnAtdHMvQ2hhaW5cIjtcbmltcG9ydCAqIGFzIFJORUEgZnJvbSBcImZwLXRzL1JlYWRvbmx5Tm9uRW1wdHlBcnJheVwiO1xuaW1wb3J0ICogYXMgUkEgZnJvbSBcImZwLXRzL1JlYWRvbmx5QXJyYXlcIjtcbmV4cG9ydCBjb25zdCBVUkkgPSBcIkxhenlcIjtcbmNvbnN0IF9tYXAgPSAoZiwgZykgPT4gKCkgPT4gZyhmKCkpO1xuY29uc3QgX2FwID0gKGYsIGcpID0+ICgpID0+IGYoKShnKCkpO1xuY29uc3QgX2NoYWluID0gKGYsIGcpID0+IGcoZigpKTtcbmNvbnN0IF9jaGFpblJlYyA9IChhLCBmKSA9PiAoKSA9PiB7XG4gICAgbGV0IGUgPSBmKGEpKCk7XG4gICAgd2hpbGUgKGUuX3RhZyA9PT0gXCJMZWZ0XCIpIHtcbiAgICAgICAgZSA9IGYoZS5sZWZ0KSgpO1xuICAgIH1cbiAgICByZXR1cm4gZS5yaWdodDtcbn07XG5leHBvcnQgY29uc3QgbWFwID0gKGYpID0+IChmYSkgPT4gX21hcChmYSwgZik7XG5leHBvcnQgY29uc3QgYXAgPSBmYSA9PiBmYWIgPT4gX2FwKGZhYiwgZmEpO1xuZXhwb3J0IGNvbnN0IG9mID0gY29uc3RhbnQ7XG5leHBvcnQgY29uc3QgY2hhaW4gPSBmID0+IG1hID0+IF9jaGFpbihtYSwgZik7XG5leHBvcnQgY29uc3QgZmxhdE1hcCA9IGNoYWluO1xuZXhwb3J0IGNvbnN0IGZsYXR0ZW4gPSBjaGFpbihpZGVudGl0eSk7XG5leHBvcnQgY29uc3QgRnVuY3RvciA9IHtcbiAgICBVUkksXG4gICAgbWFwOiBfbWFwLFxufTtcbmV4cG9ydCBjb25zdCBmbGFwID0gZmxhcF8oRnVuY3Rvcik7XG5leHBvcnQgY29uc3QgUG9pbnRlZCA9IHtcbiAgICBVUkksXG4gICAgb2YsXG59O1xuZXhwb3J0IGNvbnN0IEFwcGx5ID0ge1xuICAgIFVSSSxcbiAgICBtYXA6IF9tYXAsXG4gICAgYXA6IF9hcCxcbn07XG5leHBvcnQgY29uc3QgYXBGaXJzdCA9IGFwRmlyc3RfKEFwcGx5KTtcbmV4cG9ydCBjb25zdCBhcFNlY29uZCA9IGFwU2Vjb25kXyhBcHBseSk7XG5leHBvcnQgY29uc3QgQXBwbGljYXRpdmUgPSB7XG4gICAgVVJJLFxuICAgIG1hcDogX21hcCxcbiAgICBhcDogX2FwLFxuICAgIG9mLFxufTtcbmV4cG9ydCBjb25zdCBDaGFpbiA9IHtcbiAgICBVUkksXG4gICAgbWFwOiBfbWFwLFxuICAgIGFwOiBfYXAsXG4gICAgY2hhaW46IF9jaGFpbixcbn07XG5leHBvcnQgY29uc3QgTW9uYWQgPSB7XG4gICAgVVJJLFxuICAgIG1hcDogX21hcCxcbiAgICBhcDogX2FwLFxuICAgIG9mLFxuICAgIGNoYWluOiBfY2hhaW4sXG59O1xuZXhwb3J0IGNvbnN0IGNoYWluRmlyc3QgPSBjaGFpbkZpcnN0XyhDaGFpbik7XG5leHBvcnQgY29uc3QgQ2hhaW5SZWMgPSB7XG4gICAgVVJJLFxuICAgIG1hcDogX21hcCxcbiAgICBhcDogX2FwLFxuICAgIGNoYWluOiBfY2hhaW4sXG4gICAgY2hhaW5SZWM6IF9jaGFpblJlYyxcbn07XG5leHBvcnQgY29uc3QgRG8gPSBvZih7fSk7XG5leHBvcnQgY29uc3QgYmluZFRvID0gYmluZFRvXyhGdW5jdG9yKTtcbmV4cG9ydCBjb25zdCBiaW5kID0gYmluZF8oQ2hhaW4pO1xuZXhwb3J0IGNvbnN0IGFwUyA9IGFwU18oQXBwbHkpO1xuY29uc3QgbGV0XyA9IGxldF9fKEZ1bmN0b3IpO1xuZXhwb3J0IHsgbGV0XyBhcyBsZXQsIH07XG5leHBvcnQgY29uc3QgQXBUID0gb2YoW10pO1xuZXhwb3J0IGNvbnN0IHRyYXZlcnNlUmVhZG9ubHlOb25FbXB0eUFycmF5V2l0aEluZGV4ID0gKGYpID0+IChhcykgPT4gKCkgPT4ge1xuICAgIGNvbnN0IG91dCA9IFtmKDAsIFJORUEuaGVhZChhcykpKCldO1xuICAgIGZvciAobGV0IGkgPSAxOyBpIDwgYXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgb3V0LnB1c2goZihpLCBhc1tpXSkoKSk7XG4gICAgfVxuICAgIHJldHVybiBvdXQ7XG59O1xuZXhwb3J0IGNvbnN0IHRyYXZlcnNlUmVhZG9ubHlBcnJheVdpdGhJbmRleCA9IChmKSA9PiB7XG4gICAgY29uc3QgZyA9IHRyYXZlcnNlUmVhZG9ubHlOb25FbXB0eUFycmF5V2l0aEluZGV4KGYpO1xuICAgIHJldHVybiBhcyA9PiAoUkEuaXNOb25FbXB0eShhcykgPyBnKGFzKSA6IEFwVCk7XG59O1xuZXhwb3J0IGNvbnN0IHRyYXZlcnNlQXJyYXlXaXRoSW5kZXggPSB0cmF2ZXJzZVJlYWRvbmx5QXJyYXlXaXRoSW5kZXg7XG5leHBvcnQgY29uc3QgdHJhdmVyc2VBcnJheSA9IChmKSA9PiB0cmF2ZXJzZVJlYWRvbmx5QXJyYXlXaXRoSW5kZXgoKF8sIGEpID0+IGYoYSkpO1xuZXhwb3J0IGNvbnN0IHNlcXVlbmNlQXJyYXkgPSB0cmF2ZXJzZUFycmF5KGlkZW50aXR5KTtcbmV4cG9ydCBjb25zdCBleGVjdXRlID0gKHgpID0+IHgoKTtcbmV4cG9ydCBjb25zdCBsYXp5ID0gaWRlbnRpdHk7XG5leHBvcnQgY29uc3QgbWVtb2l6ZSA9IChmKSA9PiB7XG4gICAgY29uc3QgZW1wdHkgPSBTeW1ib2woKTtcbiAgICBsZXQgcmVzID0gZW1wdHk7XG4gICAgcmV0dXJuICgpID0+IChyZXMgPT09IGVtcHR5ID8gKHJlcyA9IGYoKSkgOiByZXMpO1xufTtcbiIsCiAgImltcG9ydCB7IGNvbnN0YW50LCBpZGVudGl0eSB9IGZyb20gXCJmcC10cy9mdW5jdGlvblwiO1xuaW1wb3J0IHsgZmxhcCBhcyBmbGFwXywgYmluZFRvIGFzIGJpbmRUb18sIGxldCBhcyBsZXRfXywgfSBmcm9tIFwiZnAtdHMvRnVuY3RvclwiO1xuaW1wb3J0IHsgYXBGaXJzdCBhcyBhcEZpcnN0XywgYXBTIGFzIGFwU18sIGFwU2Vjb25kIGFzIGFwU2Vjb25kXywgfSBmcm9tIFwiZnAtdHMvQXBwbHlcIjtcbmltcG9ydCB7IGJpbmQgYXMgYmluZF8sIGNoYWluRmlyc3QgYXMgY2hhaW5GaXJzdF8gfSBmcm9tIFwiZnAtdHMvQ2hhaW5cIjtcbmltcG9ydCAqIGFzIFJORUEgZnJvbSBcImZwLXRzL1JlYWRvbmx5Tm9uRW1wdHlBcnJheVwiO1xuaW1wb3J0ICogYXMgUkEgZnJvbSBcImZwLXRzL1JlYWRvbmx5QXJyYXlcIjtcbmV4cG9ydCBjb25zdCBVUkkgPSBcIkxhenlcIjtcbmNvbnN0IF9tYXAgPSAoZiwgZykgPT4gKCkgPT4gZyhmKCkpO1xuY29uc3QgX2FwID0gKGYsIGcpID0+ICgpID0+IGYoKShnKCkpO1xuY29uc3QgX2NoYWluID0gKGYsIGcpID0+IGcoZigpKTtcbmNvbnN0IF9jaGFpblJlYyA9IChhLCBmKSA9PiAoKSA9PiB7XG4gICAgbGV0IGUgPSBmKGEpKCk7XG4gICAgd2hpbGUgKGUuX3RhZyA9PT0gXCJMZWZ0XCIpIHtcbiAgICAgICAgZSA9IGYoZS5sZWZ0KSgpO1xuICAgIH1cbiAgICByZXR1cm4gZS5yaWdodDtcbn07XG5leHBvcnQgY29uc3QgbWFwID0gKGYpID0+IChmYSkgPT4gX21hcChmYSwgZik7XG5leHBvcnQgY29uc3QgYXAgPSBmYSA9PiBmYWIgPT4gX2FwKGZhYiwgZmEpO1xuZXhwb3J0IGNvbnN0IG9mID0gY29uc3RhbnQ7XG5leHBvcnQgY29uc3QgY2hhaW4gPSBmID0+IG1hID0+IF9jaGFpbihtYSwgZik7XG5leHBvcnQgY29uc3QgZmxhdE1hcCA9IGNoYWluO1xuZXhwb3J0IGNvbnN0IGZsYXR0ZW4gPSBjaGFpbihpZGVudGl0eSk7XG5leHBvcnQgY29uc3QgRnVuY3RvciA9IHtcbiAgICBVUkksXG4gICAgbWFwOiBfbWFwLFxufTtcbmV4cG9ydCBjb25zdCBmbGFwID0gZmxhcF8oRnVuY3Rvcik7XG5leHBvcnQgY29uc3QgUG9pbnRlZCA9IHtcbiAgICBVUkksXG4gICAgb2YsXG59O1xuZXhwb3J0IGNvbnN0IEFwcGx5ID0ge1xuICAgIFVSSSxcbiAgICBtYXA6IF9tYXAsXG4gICAgYXA6IF9hcCxcbn07XG5leHBvcnQgY29uc3QgYXBGaXJzdCA9IGFwRmlyc3RfKEFwcGx5KTtcbmV4cG9ydCBjb25zdCBhcFNlY29uZCA9IGFwU2Vjb25kXyhBcHBseSk7XG5leHBvcnQgY29uc3QgQXBwbGljYXRpdmUgPSB7XG4gICAgVVJJLFxuICAgIG1hcDogX21hcCxcbiAgICBhcDogX2FwLFxuICAgIG9mLFxufTtcbmV4cG9ydCBjb25zdCBDaGFpbiA9IHtcbiAgICBVUkksXG4gICAgbWFwOiBfbWFwLFxuICAgIGFwOiBfYXAsXG4gICAgY2hhaW46IF9jaGFpbixcbn07XG5leHBvcnQgY29uc3QgTW9uYWQgPSB7XG4gICAgVVJJLFxuICAgIG1hcDogX21hcCxcbiAgICBhcDogX2FwLFxuICAgIG9mLFxuICAgIGNoYWluOiBfY2hhaW4sXG59O1xuZXhwb3J0IGNvbnN0IGNoYWluRmlyc3QgPSBjaGFpbkZpcnN0XyhDaGFpbik7XG5leHBvcnQgY29uc3QgQ2hhaW5SZWMgPSB7XG4gICAgVVJJLFxuICAgIG1hcDogX21hcCxcbiAgICBhcDogX2FwLFxuICAgIGNoYWluOiBfY2hhaW4sXG4gICAgY2hhaW5SZWM6IF9jaGFpblJlYyxcbn07XG5leHBvcnQgY29uc3QgRG8gPSBvZih7fSk7XG5leHBvcnQgY29uc3QgYmluZFRvID0gYmluZFRvXyhGdW5jdG9yKTtcbmV4cG9ydCBjb25zdCBiaW5kID0gYmluZF8oQ2hhaW4pO1xuZXhwb3J0IGNvbnN0IGFwUyA9IGFwU18oQXBwbHkpO1xuY29uc3QgbGV0XyA9IGxldF9fKEZ1bmN0b3IpO1xuZXhwb3J0IHsgbGV0XyBhcyBsZXQsIH07XG5leHBvcnQgY29uc3QgQXBUID0gb2YoW10pO1xuZXhwb3J0IGNvbnN0IHRyYXZlcnNlUmVhZG9ubHlOb25FbXB0eUFycmF5V2l0aEluZGV4ID0gKGYpID0+IChhcykgPT4gKCkgPT4ge1xuICAgIGNvbnN0IG91dCA9IFtmKDAsIFJORUEuaGVhZChhcykpKCldO1xuICAgIGZvciAobGV0IGkgPSAxOyBpIDwgYXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgb3V0LnB1c2goZihpLCBhc1tpXSkoKSk7XG4gICAgfVxuICAgIHJldHVybiBvdXQ7XG59O1xuZXhwb3J0IGNvbnN0IHRyYXZlcnNlUmVhZG9ubHlBcnJheVdpdGhJbmRleCA9IChmKSA9PiB7XG4gICAgY29uc3QgZyA9IHRyYXZlcnNlUmVhZG9ubHlOb25FbXB0eUFycmF5V2l0aEluZGV4KGYpO1xuICAgIHJldHVybiBhcyA9PiAoUkEuaXNOb25FbXB0eShhcykgPyBnKGFzKSA6IEFwVCk7XG59O1xuZXhwb3J0IGNvbnN0IHRyYXZlcnNlQXJyYXlXaXRoSW5kZXggPSB0cmF2ZXJzZVJlYWRvbmx5QXJyYXlXaXRoSW5kZXg7XG5leHBvcnQgY29uc3QgdHJhdmVyc2VBcnJheSA9IChmKSA9PiB0cmF2ZXJzZVJlYWRvbmx5QXJyYXlXaXRoSW5kZXgoKF8sIGEpID0+IGYoYSkpO1xuZXhwb3J0IGNvbnN0IHNlcXVlbmNlQXJyYXkgPSB0cmF2ZXJzZUFycmF5KGlkZW50aXR5KTtcbmV4cG9ydCBjb25zdCBleGVjdXRlID0gKHgpID0+IHgoKTtcbmV4cG9ydCBjb25zdCBsYXp5ID0gaWRlbnRpdHk7XG5leHBvcnQgY29uc3QgbWVtb2l6ZSA9IChmKSA9PiB7XG4gICAgY29uc3QgZW1wdHkgPSBTeW1ib2woKTtcbiAgICBsZXQgcmVzID0gZW1wdHk7XG4gICAgcmV0dXJuICgpID0+IChyZXMgPT09IGVtcHR5ID8gKHJlcyA9IGYoKSkgOiByZXMpO1xufTtcbiIsCiAgImltcG9ydCB7IGNvbnN0YW50LCBpZGVudGl0eSB9IGZyb20gXCJmcC10cy9mdW5jdGlvblwiO1xuaW1wb3J0IHsgZmxhcCBhcyBmbGFwXywgYmluZFRvIGFzIGJpbmRUb18sIGxldCBhcyBsZXRfXywgfSBmcm9tIFwiZnAtdHMvRnVuY3RvclwiO1xuaW1wb3J0IHsgYXBGaXJzdCBhcyBhcEZpcnN0XywgYXBTIGFzIGFwU18sIGFwU2Vjb25kIGFzIGFwU2Vjb25kXywgfSBmcm9tIFwiZnAtdHMvQXBwbHlcIjtcbmltcG9ydCB7IGJpbmQgYXMgYmluZF8sIGNoYWluRmlyc3QgYXMgY2hhaW5GaXJzdF8gfSBmcm9tIFwiZnAtdHMvQ2hhaW5cIjtcbmltcG9ydCAqIGFzIFJORUEgZnJvbSBcImZwLXRzL1JlYWRvbmx5Tm9uRW1wdHlBcnJheVwiO1xuaW1wb3J0ICogYXMgUkEgZnJvbSBcImZwLXRzL1JlYWRvbmx5QXJyYXlcIjtcbmV4cG9ydCBjb25zdCBVUkkgPSBcIkxhenlcIjtcbmNvbnN0IF9tYXAgPSAoZiwgZykgPT4gKCkgPT4gZyhmKCkpO1xuY29uc3QgX2FwID0gKGYsIGcpID0+ICgpID0+IGYoKShnKCkpO1xuY29uc3QgX2NoYWluID0gKGYsIGcpID0+IGcoZigpKTtcbmNvbnN0IF9jaGFpblJlYyA9IChhLCBmKSA9PiAoKSA9PiB7XG4gICAgbGV0IGUgPSBmKGEpKCk7XG4gICAgd2hpbGUgKGUuX3RhZyA9PT0gXCJMZWZ0XCIpIHtcbiAgICAgICAgZSA9IGYoZS5sZWZ0KSgpO1xuICAgIH1cbiAgICByZXR1cm4gZS5yaWdodDtcbn07XG5leHBvcnQgY29uc3QgbWFwID0gKGYpID0+IChmYSkgPT4gX21hcChmYSwgZik7XG5leHBvcnQgY29uc3QgYXAgPSBmYSA9PiBmYWIgPT4gX2FwKGZhYiwgZmEpO1xuZXhwb3J0IGNvbnN0IG9mID0gY29uc3RhbnQ7XG5leHBvcnQgY29uc3QgY2hhaW4gPSBmID0+IG1hID0+IF9jaGFpbihtYSwgZik7XG5leHBvcnQgY29uc3QgZmxhdE1hcCA9IGNoYWluO1xuZXhwb3J0IGNvbnN0IGZsYXR0ZW4gPSBjaGFpbihpZGVudGl0eSk7XG5leHBvcnQgY29uc3QgRnVuY3RvciA9IHtcbiAgICBVUkksXG4gICAgbWFwOiBfbWFwLFxufTtcbmV4cG9ydCBjb25zdCBmbGFwID0gZmxhcF8oRnVuY3Rvcik7XG5leHBvcnQgY29uc3QgUG9pbnRlZCA9IHtcbiAgICBVUkksXG4gICAgb2YsXG59O1xuZXhwb3J0IGNvbnN0IEFwcGx5ID0ge1xuICAgIFVSSSxcbiAgICBtYXA6IF9tYXAsXG4gICAgYXA6IF9hcCxcbn07XG5leHBvcnQgY29uc3QgYXBGaXJzdCA9IGFwRmlyc3RfKEFwcGx5KTtcbmV4cG9ydCBjb25zdCBhcFNlY29uZCA9IGFwU2Vjb25kXyhBcHBseSk7XG5leHBvcnQgY29uc3QgQXBwbGljYXRpdmUgPSB7XG4gICAgVVJJLFxuICAgIG1hcDogX21hcCxcbiAgICBhcDogX2FwLFxuICAgIG9mLFxufTtcbmV4cG9ydCBjb25zdCBDaGFpbiA9IHtcbiAgICBVUkksXG4gICAgbWFwOiBfbWFwLFxuICAgIGFwOiBfYXAsXG4gICAgY2hhaW46IF9jaGFpbixcbn07XG5leHBvcnQgY29uc3QgTW9uYWQgPSB7XG4gICAgVVJJLFxuICAgIG1hcDogX21hcCxcbiAgICBhcDogX2FwLFxuICAgIG9mLFxuICAgIGNoYWluOiBfY2hhaW4sXG59O1xuZXhwb3J0IGNvbnN0IGNoYWluRmlyc3QgPSBjaGFpbkZpcnN0XyhDaGFpbik7XG5leHBvcnQgY29uc3QgQ2hhaW5SZWMgPSB7XG4gICAgVVJJLFxuICAgIG1hcDogX21hcCxcbiAgICBhcDogX2FwLFxuICAgIGNoYWluOiBfY2hhaW4sXG4gICAgY2hhaW5SZWM6IF9jaGFpblJlYyxcbn07XG5leHBvcnQgY29uc3QgRG8gPSBvZih7fSk7XG5leHBvcnQgY29uc3QgYmluZFRvID0gYmluZFRvXyhGdW5jdG9yKTtcbmV4cG9ydCBjb25zdCBiaW5kID0gYmluZF8oQ2hhaW4pO1xuZXhwb3J0IGNvbnN0IGFwUyA9IGFwU18oQXBwbHkpO1xuY29uc3QgbGV0XyA9IGxldF9fKEZ1bmN0b3IpO1xuZXhwb3J0IHsgbGV0XyBhcyBsZXQsIH07XG5leHBvcnQgY29uc3QgQXBUID0gb2YoW10pO1xuZXhwb3J0IGNvbnN0IHRyYXZlcnNlUmVhZG9ubHlOb25FbXB0eUFycmF5V2l0aEluZGV4ID0gKGYpID0+IChhcykgPT4gKCkgPT4ge1xuICAgIGNvbnN0IG91dCA9IFtmKDAsIFJORUEuaGVhZChhcykpKCldO1xuICAgIGZvciAobGV0IGkgPSAxOyBpIDwgYXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgb3V0LnB1c2goZihpLCBhc1tpXSkoKSk7XG4gICAgfVxuICAgIHJldHVybiBvdXQ7XG59O1xuZXhwb3J0IGNvbnN0IHRyYXZlcnNlUmVhZG9ubHlBcnJheVdpdGhJbmRleCA9IChmKSA9PiB7XG4gICAgY29uc3QgZyA9IHRyYXZlcnNlUmVhZG9ubHlOb25FbXB0eUFycmF5V2l0aEluZGV4KGYpO1xuICAgIHJldHVybiBhcyA9PiAoUkEuaXNOb25FbXB0eShhcykgPyBnKGFzKSA6IEFwVCk7XG59O1xuZXhwb3J0IGNvbnN0IHRyYXZlcnNlQXJyYXlXaXRoSW5kZXggPSB0cmF2ZXJzZVJlYWRvbmx5QXJyYXlXaXRoSW5kZXg7XG5leHBvcnQgY29uc3QgdHJhdmVyc2VBcnJheSA9IChmKSA9PiB0cmF2ZXJzZVJlYWRvbmx5QXJyYXlXaXRoSW5kZXgoKF8sIGEpID0+IGYoYSkpO1xuZXhwb3J0IGNvbnN0IHNlcXVlbmNlQXJyYXkgPSB0cmF2ZXJzZUFycmF5KGlkZW50aXR5KTtcbmV4cG9ydCBjb25zdCBleGVjdXRlID0gKHgpID0+IHgoKTtcbmV4cG9ydCBjb25zdCBsYXp5ID0gaWRlbnRpdHk7XG5leHBvcnQgY29uc3QgbWVtb2l6ZSA9IChmKSA9PiB7XG4gICAgY29uc3QgZW1wdHkgPSBTeW1ib2woKTtcbiAgICBsZXQgcmVzID0gZW1wdHk7XG4gICAgcmV0dXJuICgpID0+IChyZXMgPT09IGVtcHR5ID8gKHJlcyA9IGYoKSkgOiByZXMpO1xufTtcbiIsCiAgImltcG9ydCB7IGNvbnN0YW50LCBpZGVudGl0eSB9IGZyb20gXCJmcC10cy9mdW5jdGlvblwiO1xuaW1wb3J0IHsgZmxhcCBhcyBmbGFwXywgYmluZFRvIGFzIGJpbmRUb18sIGxldCBhcyBsZXRfXywgfSBmcm9tIFwiZnAtdHMvRnVuY3RvclwiO1xuaW1wb3J0IHsgYXBGaXJzdCBhcyBhcEZpcnN0XywgYXBTIGFzIGFwU18sIGFwU2Vjb25kIGFzIGFwU2Vjb25kXywgfSBmcm9tIFwiZnAtdHMvQXBwbHlcIjtcbmltcG9ydCB7IGJpbmQgYXMgYmluZF8sIGNoYWluRmlyc3QgYXMgY2hhaW5GaXJzdF8gfSBmcm9tIFwiZnAtdHMvQ2hhaW5cIjtcbmltcG9ydCAqIGFzIFJORUEgZnJvbSBcImZwLXRzL1JlYWRvbmx5Tm9uRW1wdHlBcnJheVwiO1xuaW1wb3J0ICogYXMgUkEgZnJvbSBcImZwLXRzL1JlYWRvbmx5QXJyYXlcIjtcbmV4cG9ydCBjb25zdCBVUkkgPSBcIkxhenlcIjtcbmNvbnN0IF9tYXAgPSAoZiwgZykgPT4gKCkgPT4gZyhmKCkpO1xuY29uc3QgX2FwID0gKGYsIGcpID0+ICgpID0+IGYoKShnKCkpO1xuY29uc3QgX2NoYWluID0gKGYsIGcpID0+IGcoZigpKTtcbmNvbnN0IF9jaGFpblJlYyA9IChhLCBmKSA9PiAoKSA9PiB7XG4gICAgbGV0IGUgPSBmKGEpKCk7XG4gICAgd2hpbGUgKGUuX3RhZyA9PT0gXCJMZWZ0XCIpIHtcbiAgICAgICAgZSA9IGYoZS5sZWZ0KSgpO1xuICAgIH1cbiAgICByZXR1cm4gZS5yaWdodDtcbn07XG5leHBvcnQgY29uc3QgbWFwID0gKGYpID0+IChmYSkgPT4gX21hcChmYSwgZik7XG5leHBvcnQgY29uc3QgYXAgPSBmYSA9PiBmYWIgPT4gX2FwKGZhYiwgZmEpO1xuZXhwb3J0IGNvbnN0IG9mID0gY29uc3RhbnQ7XG5leHBvcnQgY29uc3QgY2hhaW4gPSBmID0+IG1hID0+IF9jaGFpbihtYSwgZik7XG5leHBvcnQgY29uc3QgZmxhdE1hcCA9IGNoYWluO1xuZXhwb3J0IGNvbnN0IGZsYXR0ZW4gPSBjaGFpbihpZGVudGl0eSk7XG5leHBvcnQgY29uc3QgRnVuY3RvciA9IHtcbiAgICBVUkksXG4gICAgbWFwOiBfbWFwLFxufTtcbmV4cG9ydCBjb25zdCBmbGFwID0gZmxhcF8oRnVuY3Rvcik7XG5leHBvcnQgY29uc3QgUG9pbnRlZCA9IHtcbiAgICBVUkksXG4gICAgb2YsXG59O1xuZXhwb3J0IGNvbnN0IEFwcGx5ID0ge1xuICAgIFVSSSxcbiAgICBtYXA6IF9tYXAsXG4gICAgYXA6IF9hcCxcbn07XG5leHBvcnQgY29uc3QgYXBGaXJzdCA9IGFwRmlyc3RfKEFwcGx5KTtcbmV4cG9ydCBjb25zdCBhcFNlY29uZCA9IGFwU2Vjb25kXyhBcHBseSk7XG5leHBvcnQgY29uc3QgQXBwbGljYXRpdmUgPSB7XG4gICAgVVJJLFxuICAgIG1hcDogX21hcCxcbiAgICBhcDogX2FwLFxuICAgIG9mLFxufTtcbmV4cG9ydCBjb25zdCBDaGFpbiA9IHtcbiAgICBVUkksXG4gICAgbWFwOiBfbWFwLFxuICAgIGFwOiBfYXAsXG4gICAgY2hhaW46IF9jaGFpbixcbn07XG5leHBvcnQgY29uc3QgTW9uYWQgPSB7XG4gICAgVVJJLFxuICAgIG1hcDogX21hcCxcbiAgICBhcDogX2FwLFxuICAgIG9mLFxuICAgIGNoYWluOiBfY2hhaW4sXG59O1xuZXhwb3J0IGNvbnN0IGNoYWluRmlyc3QgPSBjaGFpbkZpcnN0XyhDaGFpbik7XG5leHBvcnQgY29uc3QgQ2hhaW5SZWMgPSB7XG4gICAgVVJJLFxuICAgIG1hcDogX21hcCxcbiAgICBhcDogX2FwLFxuICAgIGNoYWluOiBfY2hhaW4sXG4gICAgY2hhaW5SZWM6IF9jaGFpblJlYyxcbn07XG5leHBvcnQgY29uc3QgRG8gPSBvZih7fSk7XG5leHBvcnQgY29uc3QgYmluZFRvID0gYmluZFRvXyhGdW5jdG9yKTtcbmV4cG9ydCBjb25zdCBiaW5kID0gYmluZF8oQ2hhaW4pO1xuZXhwb3J0IGNvbnN0IGFwUyA9IGFwU18oQXBwbHkpO1xuY29uc3QgbGV0XyA9IGxldF9fKEZ1bmN0b3IpO1xuZXhwb3J0IHsgbGV0XyBhcyBsZXQsIH07XG5leHBvcnQgY29uc3QgQXBUID0gb2YoW10pO1xuZXhwb3J0IGNvbnN0IHRyYXZlcnNlUmVhZG9ubHlOb25FbXB0eUFycmF5V2l0aEluZGV4ID0gKGYpID0+IChhcykgPT4gKCkgPT4ge1xuICAgIGNvbnN0IG91dCA9IFtmKDAsIFJORUEuaGVhZChhcykpKCldO1xuICAgIGZvciAobGV0IGkgPSAxOyBpIDwgYXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgb3V0LnB1c2goZihpLCBhc1tpXSkoKSk7XG4gICAgfVxuICAgIHJldHVybiBvdXQ7XG59O1xuZXhwb3J0IGNvbnN0IHRyYXZlcnNlUmVhZG9ubHlBcnJheVdpdGhJbmRleCA9IChmKSA9PiB7XG4gICAgY29uc3QgZyA9IHRyYXZlcnNlUmVhZG9ubHlOb25FbXB0eUFycmF5V2l0aEluZGV4KGYpO1xuICAgIHJldHVybiBhcyA9PiAoUkEuaXNOb25FbXB0eShhcykgPyBnKGFzKSA6IEFwVCk7XG59O1xuZXhwb3J0IGNvbnN0IHRyYXZlcnNlQXJyYXlXaXRoSW5kZXggPSB0cmF2ZXJzZVJlYWRvbmx5QXJyYXlXaXRoSW5kZXg7XG5leHBvcnQgY29uc3QgdHJhdmVyc2VBcnJheSA9IChmKSA9PiB0cmF2ZXJzZVJlYWRvbmx5QXJyYXlXaXRoSW5kZXgoKF8sIGEpID0+IGYoYSkpO1xuZXhwb3J0IGNvbnN0IHNlcXVlbmNlQXJyYXkgPSB0cmF2ZXJzZUFycmF5KGlkZW50aXR5KTtcbmV4cG9ydCBjb25zdCBleGVjdXRlID0gKHgpID0+IHgoKTtcbmV4cG9ydCBjb25zdCBsYXp5ID0gaWRlbnRpdHk7XG5leHBvcnQgY29uc3QgbWVtb2l6ZSA9IChmKSA9PiB7XG4gICAgY29uc3QgZW1wdHkgPSBTeW1ib2woKTtcbiAgICBsZXQgcmVzID0gZW1wdHk7XG4gICAgcmV0dXJuICgpID0+IChyZXMgPT09IGVtcHR5ID8gKHJlcyA9IGYoKSkgOiByZXMpO1xufTtcbiIsCiAgImltcG9ydCB7IGNvbnN0YW50LCBpZGVudGl0eSB9IGZyb20gXCJmcC10cy9mdW5jdGlvblwiO1xuaW1wb3J0IHsgZmxhcCBhcyBmbGFwXywgYmluZFRvIGFzIGJpbmRUb18sIGxldCBhcyBsZXRfXywgfSBmcm9tIFwiZnAtdHMvRnVuY3RvclwiO1xuaW1wb3J0IHsgYXBGaXJzdCBhcyBhcEZpcnN0XywgYXBTIGFzIGFwU18sIGFwU2Vjb25kIGFzIGFwU2Vjb25kXywgfSBmcm9tIFwiZnAtdHMvQXBwbHlcIjtcbmltcG9ydCB7IGJpbmQgYXMgYmluZF8sIGNoYWluRmlyc3QgYXMgY2hhaW5GaXJzdF8gfSBmcm9tIFwiZnAtdHMvQ2hhaW5cIjtcbmltcG9ydCAqIGFzIFJORUEgZnJvbSBcImZwLXRzL1JlYWRvbmx5Tm9uRW1wdHlBcnJheVwiO1xuaW1wb3J0ICogYXMgUkEgZnJvbSBcImZwLXRzL1JlYWRvbmx5QXJyYXlcIjtcbmV4cG9ydCBjb25zdCBVUkkgPSBcIkxhenlcIjtcbmNvbnN0IF9tYXAgPSAoZiwgZykgPT4gKCkgPT4gZyhmKCkpO1xuY29uc3QgX2FwID0gKGYsIGcpID0+ICgpID0+IGYoKShnKCkpO1xuY29uc3QgX2NoYWluID0gKGYsIGcpID0+IGcoZigpKTtcbmNvbnN0IF9jaGFpblJlYyA9IChhLCBmKSA9PiAoKSA9PiB7XG4gICAgbGV0IGUgPSBmKGEpKCk7XG4gICAgd2hpbGUgKGUuX3RhZyA9PT0gXCJMZWZ0XCIpIHtcbiAgICAgICAgZSA9IGYoZS5sZWZ0KSgpO1xuICAgIH1cbiAgICByZXR1cm4gZS5yaWdodDtcbn07XG5leHBvcnQgY29uc3QgbWFwID0gKGYpID0+IChmYSkgPT4gX21hcChmYSwgZik7XG5leHBvcnQgY29uc3QgYXAgPSBmYSA9PiBmYWIgPT4gX2FwKGZhYiwgZmEpO1xuZXhwb3J0IGNvbnN0IG9mID0gY29uc3RhbnQ7XG5leHBvcnQgY29uc3QgY2hhaW4gPSBmID0+IG1hID0+IF9jaGFpbihtYSwgZik7XG5leHBvcnQgY29uc3QgZmxhdE1hcCA9IGNoYWluO1xuZXhwb3J0IGNvbnN0IGZsYXR0ZW4gPSBjaGFpbihpZGVudGl0eSk7XG5leHBvcnQgY29uc3QgRnVuY3RvciA9IHtcbiAgICBVUkksXG4gICAgbWFwOiBfbWFwLFxufTtcbmV4cG9ydCBjb25zdCBmbGFwID0gZmxhcF8oRnVuY3Rvcik7XG5leHBvcnQgY29uc3QgUG9pbnRlZCA9IHtcbiAgICBVUkksXG4gICAgb2YsXG59O1xuZXhwb3J0IGNvbnN0IEFwcGx5ID0ge1xuICAgIFVSSSxcbiAgICBtYXA6IF9tYXAsXG4gICAgYXA6IF9hcCxcbn07XG5leHBvcnQgY29uc3QgYXBGaXJzdCA9IGFwRmlyc3RfKEFwcGx5KTtcbmV4cG9ydCBjb25zdCBhcFNlY29uZCA9IGFwU2Vjb25kXyhBcHBseSk7XG5leHBvcnQgY29uc3QgQXBwbGljYXRpdmUgPSB7XG4gICAgVVJJLFxuICAgIG1hcDogX21hcCxcbiAgICBhcDogX2FwLFxuICAgIG9mLFxufTtcbmV4cG9ydCBjb25zdCBDaGFpbiA9IHtcbiAgICBVUkksXG4gICAgbWFwOiBfbWFwLFxuICAgIGFwOiBfYXAsXG4gICAgY2hhaW46IF9jaGFpbixcbn07XG5leHBvcnQgY29uc3QgTW9uYWQgPSB7XG4gICAgVVJJLFxuICAgIG1hcDogX21hcCxcbiAgICBhcDogX2FwLFxuICAgIG9mLFxuICAgIGNoYWluOiBfY2hhaW4sXG59O1xuZXhwb3J0IGNvbnN0IGNoYWluRmlyc3QgPSBjaGFpbkZpcnN0XyhDaGFpbik7XG5leHBvcnQgY29uc3QgQ2hhaW5SZWMgPSB7XG4gICAgVVJJLFxuICAgIG1hcDogX21hcCxcbiAgICBhcDogX2FwLFxuICAgIGNoYWluOiBfY2hhaW4sXG4gICAgY2hhaW5SZWM6IF9jaGFpblJlYyxcbn07XG5leHBvcnQgY29uc3QgRG8gPSBvZih7fSk7XG5leHBvcnQgY29uc3QgYmluZFRvID0gYmluZFRvXyhGdW5jdG9yKTtcbmV4cG9ydCBjb25zdCBiaW5kID0gYmluZF8oQ2hhaW4pO1xuZXhwb3J0IGNvbnN0IGFwUyA9IGFwU18oQXBwbHkpO1xuY29uc3QgbGV0XyA9IGxldF9fKEZ1bmN0b3IpO1xuZXhwb3J0IHsgbGV0XyBhcyBsZXQsIH07XG5leHBvcnQgY29uc3QgQXBUID0gb2YoW10pO1xuZXhwb3J0IGNvbnN0IHRyYXZlcnNlUmVhZG9ubHlOb25FbXB0eUFycmF5V2l0aEluZGV4ID0gKGYpID0+IChhcykgPT4gKCkgPT4ge1xuICAgIGNvbnN0IG91dCA9IFtmKDAsIFJORUEuaGVhZChhcykpKCldO1xuICAgIGZvciAobGV0IGkgPSAxOyBpIDwgYXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgb3V0LnB1c2goZihpLCBhc1tpXSkoKSk7XG4gICAgfVxuICAgIHJldHVybiBvdXQ7XG59O1xuZXhwb3J0IGNvbnN0IHRyYXZlcnNlUmVhZG9ubHlBcnJheVdpdGhJbmRleCA9IChmKSA9PiB7XG4gICAgY29uc3QgZyA9IHRyYXZlcnNlUmVhZG9ubHlOb25FbXB0eUFycmF5V2l0aEluZGV4KGYpO1xuICAgIHJldHVybiBhcyA9PiAoUkEuaXNOb25FbXB0eShhcykgPyBnKGFzKSA6IEFwVCk7XG59O1xuZXhwb3J0IGNvbnN0IHRyYXZlcnNlQXJyYXlXaXRoSW5kZXggPSB0cmF2ZXJzZVJlYWRvbmx5QXJyYXlXaXRoSW5kZXg7XG5leHBvcnQgY29uc3QgdHJhdmVyc2VBcnJheSA9IChmKSA9PiB0cmF2ZXJzZVJlYWRvbmx5QXJyYXlXaXRoSW5kZXgoKF8sIGEpID0+IGYoYSkpO1xuZXhwb3J0IGNvbnN0IHNlcXVlbmNlQXJyYXkgPSB0cmF2ZXJzZUFycmF5KGlkZW50aXR5KTtcbmV4cG9ydCBjb25zdCBleGVjdXRlID0gKHgpID0+IHgoKTtcbmV4cG9ydCBjb25zdCBsYXp5ID0gaWRlbnRpdHk7XG5leHBvcnQgY29uc3QgbWVtb2l6ZSA9IChmKSA9PiB7XG4gICAgY29uc3QgZW1wdHkgPSBTeW1ib2woKTtcbiAgICBsZXQgcmVzID0gZW1wdHk7XG4gICAgcmV0dXJuICgpID0+IChyZXMgPT09IGVtcHR5ID8gKHJlcyA9IGYoKSkgOiByZXMpO1xufTtcbiIsCiAgImltcG9ydCB7IGNvbnN0YW50LCBpZGVudGl0eSB9IGZyb20gXCJmcC10cy9mdW5jdGlvblwiO1xuaW1wb3J0IHsgZmxhcCBhcyBmbGFwXywgYmluZFRvIGFzIGJpbmRUb18sIGxldCBhcyBsZXRfXywgfSBmcm9tIFwiZnAtdHMvRnVuY3RvclwiO1xuaW1wb3J0IHsgYXBGaXJzdCBhcyBhcEZpcnN0XywgYXBTIGFzIGFwU18sIGFwU2Vjb25kIGFzIGFwU2Vjb25kXywgfSBmcm9tIFwiZnAtdHMvQXBwbHlcIjtcbmltcG9ydCB7IGJpbmQgYXMgYmluZF8sIGNoYWluRmlyc3QgYXMgY2hhaW5GaXJzdF8gfSBmcm9tIFwiZnAtdHMvQ2hhaW5cIjtcbmltcG9ydCAqIGFzIFJORUEgZnJvbSBcImZwLXRzL1JlYWRvbmx5Tm9uRW1wdHlBcnJheVwiO1xuaW1wb3J0ICogYXMgUkEgZnJvbSBcImZwLXRzL1JlYWRvbmx5QXJyYXlcIjtcbmV4cG9ydCBjb25zdCBVUkkgPSBcIkxhenlcIjtcbmNvbnN0IF9tYXAgPSAoZiwgZykgPT4gKCkgPT4gZyhmKCkpO1xuY29uc3QgX2FwID0gKGYsIGcpID0+ICgpID0+IGYoKShnKCkpO1xuY29uc3QgX2NoYWluID0gKGYsIGcpID0+IGcoZigpKTtcbmNvbnN0IF9jaGFpblJlYyA9IChhLCBmKSA9PiAoKSA9PiB7XG4gICAgbGV0IGUgPSBmKGEpKCk7XG4gICAgd2hpbGUgKGUuX3RhZyA9PT0gXCJMZWZ0XCIpIHtcbiAgICAgICAgZSA9IGYoZS5sZWZ0KSgpO1xuICAgIH1cbiAgICByZXR1cm4gZS5yaWdodDtcbn07XG5leHBvcnQgY29uc3QgbWFwID0gKGYpID0+IChmYSkgPT4gX21hcChmYSwgZik7XG5leHBvcnQgY29uc3QgYXAgPSBmYSA9PiBmYWIgPT4gX2FwKGZhYiwgZmEpO1xuZXhwb3J0IGNvbnN0IG9mID0gY29uc3RhbnQ7XG5leHBvcnQgY29uc3QgY2hhaW4gPSBmID0+IG1hID0+IF9jaGFpbihtYSwgZik7XG5leHBvcnQgY29uc3QgZmxhdE1hcCA9IGNoYWluO1xuZXhwb3J0IGNvbnN0IGZsYXR0ZW4gPSBjaGFpbihpZGVudGl0eSk7XG5leHBvcnQgY29uc3QgRnVuY3RvciA9IHtcbiAgICBVUkksXG4gICAgbWFwOiBfbWFwLFxufTtcbmV4cG9ydCBjb25zdCBmbGFwID0gZmxhcF8oRnVuY3Rvcik7XG5leHBvcnQgY29uc3QgUG9pbnRlZCA9IHtcbiAgICBVUkksXG4gICAgb2YsXG59O1xuZXhwb3J0IGNvbnN0IEFwcGx5ID0ge1xuICAgIFVSSSxcbiAgICBtYXA6IF9tYXAsXG4gICAgYXA6IF9hcCxcbn07XG5leHBvcnQgY29uc3QgYXBGaXJzdCA9IGFwRmlyc3RfKEFwcGx5KTtcbmV4cG9ydCBjb25zdCBhcFNlY29uZCA9IGFwU2Vjb25kXyhBcHBseSk7XG5leHBvcnQgY29uc3QgQXBwbGljYXRpdmUgPSB7XG4gICAgVVJJLFxuICAgIG1hcDogX21hcCxcbiAgICBhcDogX2FwLFxuICAgIG9mLFxufTtcbmV4cG9ydCBjb25zdCBDaGFpbiA9IHtcbiAgICBVUkksXG4gICAgbWFwOiBfbWFwLFxuICAgIGFwOiBfYXAsXG4gICAgY2hhaW46IF9jaGFpbixcbn07XG5leHBvcnQgY29uc3QgTW9uYWQgPSB7XG4gICAgVVJJLFxuICAgIG1hcDogX21hcCxcbiAgICBhcDogX2FwLFxuICAgIG9mLFxuICAgIGNoYWluOiBfY2hhaW4sXG59O1xuZXhwb3J0IGNvbnN0IGNoYWluRmlyc3QgPSBjaGFpbkZpcnN0XyhDaGFpbik7XG5leHBvcnQgY29uc3QgQ2hhaW5SZWMgPSB7XG4gICAgVVJJLFxuICAgIG1hcDogX21hcCxcbiAgICBhcDogX2FwLFxuICAgIGNoYWluOiBfY2hhaW4sXG4gICAgY2hhaW5SZWM6IF9jaGFpblJlYyxcbn07XG5leHBvcnQgY29uc3QgRG8gPSBvZih7fSk7XG5leHBvcnQgY29uc3QgYmluZFRvID0gYmluZFRvXyhGdW5jdG9yKTtcbmV4cG9ydCBjb25zdCBiaW5kID0gYmluZF8oQ2hhaW4pO1xuZXhwb3J0IGNvbnN0IGFwUyA9IGFwU18oQXBwbHkpO1xuY29uc3QgbGV0XyA9IGxldF9fKEZ1bmN0b3IpO1xuZXhwb3J0IHsgbGV0XyBhcyBsZXQsIH07XG5leHBvcnQgY29uc3QgQXBUID0gb2YoW10pO1xuZXhwb3J0IGNvbnN0IHRyYXZlcnNlUmVhZG9ubHlOb25FbXB0eUFycmF5V2l0aEluZGV4ID0gKGYpID0+IChhcykgPT4gKCkgPT4ge1xuICAgIGNvbnN0IG91dCA9IFtmKDAsIFJORUEuaGVhZChhcykpKCldO1xuICAgIGZvciAobGV0IGkgPSAxOyBpIDwgYXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgb3V0LnB1c2goZihpLCBhc1tpXSkoKSk7XG4gICAgfVxuICAgIHJldHVybiBvdXQ7XG59O1xuZXhwb3J0IGNvbnN0IHRyYXZlcnNlUmVhZG9ubHlBcnJheVdpdGhJbmRleCA9IChmKSA9PiB7XG4gICAgY29uc3QgZyA9IHRyYXZlcnNlUmVhZG9ubHlOb25FbXB0eUFycmF5V2l0aEluZGV4KGYpO1xuICAgIHJldHVybiBhcyA9PiAoUkEuaXNOb25FbXB0eShhcykgPyBnKGFzKSA6IEFwVCk7XG59O1xuZXhwb3J0IGNvbnN0IHRyYXZlcnNlQXJyYXlXaXRoSW5kZXggPSB0cmF2ZXJzZVJlYWRvbmx5QXJyYXlXaXRoSW5kZXg7XG5leHBvcnQgY29uc3QgdHJhdmVyc2VBcnJheSA9IChmKSA9PiB0cmF2ZXJzZVJlYWRvbmx5QXJyYXlXaXRoSW5kZXgoKF8sIGEpID0+IGYoYSkpO1xuZXhwb3J0IGNvbnN0IHNlcXVlbmNlQXJyYXkgPSB0cmF2ZXJzZUFycmF5KGlkZW50aXR5KTtcbmV4cG9ydCBjb25zdCBleGVjdXRlID0gKHgpID0+IHgoKTtcbmV4cG9ydCBjb25zdCBsYXp5ID0gaWRlbnRpdHk7XG5leHBvcnQgY29uc3QgbWVtb2l6ZSA9IChmKSA9PiB7XG4gICAgY29uc3QgZW1wdHkgPSBTeW1ib2woKTtcbiAgICBsZXQgcmVzID0gZW1wdHk7XG4gICAgcmV0dXJuICgpID0+IChyZXMgPT09IGVtcHR5ID8gKHJlcyA9IGYoKSkgOiByZXMpO1xufTtcbiIsCiAgImltcG9ydCB7IGZsb3csIGlkZW50aXR5LCBwaXBlIH0gZnJvbSBcImZwLXRzL2Z1bmN0aW9uXCI7XG5pbXBvcnQgeyBub3QsIGFuZCB9IGZyb20gXCJmcC10cy9QcmVkaWNhdGVcIjtcbmltcG9ydCAqIGFzIE8gZnJvbSBcImZwLXRzL09wdGlvblwiO1xuaW1wb3J0IHsgdW5sZXNzIH0gZnJvbSBcIi4vRnVuY3Rpb25cIjtcbmltcG9ydCB7IEJvdW5kZWQgYXMgQm91bmRlZEluZmluaXR5IH0gZnJvbSBcImZwLXRzL251bWJlclwiO1xuaW1wb3J0ICogYXMgQSBmcm9tIFwiZnAtdHMvQXJyYXlcIjtcbmltcG9ydCAqIGFzIEwgZnJvbSBcIi4vTGF6eVwiO1xuZXhwb3J0IGNvbnN0IGlzVmFsaWQgPSBub3QoTnVtYmVyLmlzTmFOKTtcbmV4cG9ydCBjb25zdCBmcm9tU3RyaW5nV2l0aFJhZGl4ID0gKHJhZGl4KSA9PiAoc3RyaW5nKSA9PiBwaXBlKE51bWJlci5wYXJzZUludChzdHJpbmcsIHJhZGl4KSwgTy5mcm9tUHJlZGljYXRlKGlzVmFsaWQpKTtcbmV4cG9ydCBjb25zdCBmcm9tU3RyaW5nID0gZnJvbVN0cmluZ1dpdGhSYWRpeCgxMCk7XG5leHBvcnQgY29uc3QgZmxvYXRGcm9tU3RyaW5nID0gZmxvdyhOdW1iZXIucGFyc2VGbG9hdCwgTy5mcm9tUHJlZGljYXRlKGlzVmFsaWQpKTtcbmV4cG9ydCBjb25zdCBpbmNyZW1lbnQgPSB4ID0+IHggKyAxO1xuZXhwb3J0IGNvbnN0IGRlY3JlbWVudCA9IHggPT4geCAtIDE7XG5leHBvcnQgY29uc3QgYWRkID0gKHgpID0+IHkgPT4geCArIHk7XG5leHBvcnQgY29uc3QgbXVsdGlwbHkgPSAoeCkgPT4geSA9PiB4ICogeTtcbmV4cG9ydCBjb25zdCBzdWJ0cmFjdCA9IChzdWJ0cmFoZW5kKSA9PiBtaW51ZW5kID0+IG1pbnVlbmQgLSBzdWJ0cmFoZW5kO1xuZXhwb3J0IGNvbnN0IGRpdmlkZSA9IChkaXZpc29yKSA9PiBkaXZpZGVuZCA9PiBkaXZpZGVuZCAvIGRpdmlzb3I7XG5leHBvcnQgY29uc3QgcmVtID0gKGRpdmlzb3IpID0+IGRpdmlkZW5kID0+IGRpdmlkZW5kICUgZGl2aXNvcjtcbmV4cG9ydCBjb25zdCBtb2QgPSAoZGl2aXNvcikgPT4gZGl2aWRlbmQgPT4gKChkaXZpZGVuZCAlIGRpdmlzb3IpICsgZGl2aXNvcikgJSBkaXZpc29yO1xuZXhwb3J0IGNvbnN0IG5lZ2F0ZSA9IG4gPT4gLW47XG5leHBvcnQgY29uc3QgaXNGaW5pdGUgPSBuID0+IE1hdGguYWJzKG4pICE9PSBJbmZpbml0eTtcbmV4cG9ydCBjb25zdCB0b0Zpbml0ZSA9IHVubGVzcyhpc0Zpbml0ZSkobiA9PiBNYXRoLnNpZ24obikgKiBOdW1iZXIuTUFYX1NBRkVfSU5URUdFUik7XG5leHBvcnQgY29uc3QgaXNQb3NpdGl2ZSA9IG4gPT4gTWF0aC5zaWduKG4pID09PSAxO1xuZXhwb3J0IGNvbnN0IGlzTmVnYXRpdmUgPSBuID0+IE1hdGguc2lnbihuKSA9PT0gLTE7XG5leHBvcnQgY29uc3QgaXNOb25OZWdhdGl2ZSA9IG4gPT4gTWF0aC5zaWduKG4pICE9PSAtMTtcbmV4cG9ydCBjb25zdCBpc05vblBvc2l0aXZlID0gbiA9PiBNYXRoLnNpZ24obikgIT09IDE7XG5leHBvcnQgY29uc3QgQm91bmRlZFNhZmUgPSB7XG4gICAgLi4uQm91bmRlZEluZmluaXR5LFxuICAgIHRvcDogTnVtYmVyLk1BWF9TQUZFX0lOVEVHRVIsXG4gICAgYm90dG9tOiBOdW1iZXIuTUlOX1NBRkVfSU5URUdFUixcbn07XG5leHBvcnQgY29uc3QgRW51bUludCA9IHtcbiAgICAuLi5Cb3VuZGVkU2FmZSxcbiAgICBzdWNjOiBmbG93KE8uZnJvbVByZWRpY2F0ZShhbmQoKG4pID0+IG4gPCBOdW1iZXIuTUFYX1NBRkVfSU5URUdFUikoTnVtYmVyLmlzSW50ZWdlcikpLCBPLm1hcChpbmNyZW1lbnQpKSxcbiAgICBwcmVkOiBmbG93KE8uZnJvbVByZWRpY2F0ZShhbmQoKG4pID0+IG4gPiBOdW1iZXIuTUlOX1NBRkVfSU5URUdFUikoTnVtYmVyLmlzSW50ZWdlcikpLCBPLm1hcChkZWNyZW1lbnQpKSxcbiAgICB0b0VudW06IE8uc29tZSxcbiAgICBmcm9tRW51bTogaWRlbnRpdHksXG4gICAgY2FyZGluYWxpdHk6IEwub2YoSW5maW5pdHkpLFxufTtcbmV4cG9ydCBjb25zdCBkaWdpdHMgPSAobikgPT4gcGlwZShbLi4uKG4gKyBcIlwiKV0sIEEuZmlsdGVyTWFwKGZyb21TdHJpbmcpKTtcbiIsCiAgImltcG9ydCB7IGZsb3csIGlkZW50aXR5LCBwaXBlIH0gZnJvbSBcImZwLXRzL2Z1bmN0aW9uXCI7XG5pbXBvcnQgeyBub3QsIGFuZCB9IGZyb20gXCJmcC10cy9QcmVkaWNhdGVcIjtcbmltcG9ydCAqIGFzIE8gZnJvbSBcImZwLXRzL09wdGlvblwiO1xuaW1wb3J0IHsgdW5sZXNzIH0gZnJvbSBcIi4vRnVuY3Rpb25cIjtcbmltcG9ydCB7IEJvdW5kZWQgYXMgQm91bmRlZEluZmluaXR5IH0gZnJvbSBcImZwLXRzL251bWJlclwiO1xuaW1wb3J0ICogYXMgQSBmcm9tIFwiZnAtdHMvQXJyYXlcIjtcbmltcG9ydCAqIGFzIEwgZnJvbSBcIi4vTGF6eVwiO1xuZXhwb3J0IGNvbnN0IGlzVmFsaWQgPSBub3QoTnVtYmVyLmlzTmFOKTtcbmV4cG9ydCBjb25zdCBmcm9tU3RyaW5nV2l0aFJhZGl4ID0gKHJhZGl4KSA9PiAoc3RyaW5nKSA9PiBwaXBlKE51bWJlci5wYXJzZUludChzdHJpbmcsIHJhZGl4KSwgTy5mcm9tUHJlZGljYXRlKGlzVmFsaWQpKTtcbmV4cG9ydCBjb25zdCBmcm9tU3RyaW5nID0gZnJvbVN0cmluZ1dpdGhSYWRpeCgxMCk7XG5leHBvcnQgY29uc3QgZmxvYXRGcm9tU3RyaW5nID0gZmxvdyhOdW1iZXIucGFyc2VGbG9hdCwgTy5mcm9tUHJlZGljYXRlKGlzVmFsaWQpKTtcbmV4cG9ydCBjb25zdCBpbmNyZW1lbnQgPSB4ID0+IHggKyAxO1xuZXhwb3J0IGNvbnN0IGRlY3JlbWVudCA9IHggPT4geCAtIDE7XG5leHBvcnQgY29uc3QgYWRkID0gKHgpID0+IHkgPT4geCArIHk7XG5leHBvcnQgY29uc3QgbXVsdGlwbHkgPSAoeCkgPT4geSA9PiB4ICogeTtcbmV4cG9ydCBjb25zdCBzdWJ0cmFjdCA9IChzdWJ0cmFoZW5kKSA9PiBtaW51ZW5kID0+IG1pbnVlbmQgLSBzdWJ0cmFoZW5kO1xuZXhwb3J0IGNvbnN0IGRpdmlkZSA9IChkaXZpc29yKSA9PiBkaXZpZGVuZCA9PiBkaXZpZGVuZCAvIGRpdmlzb3I7XG5leHBvcnQgY29uc3QgcmVtID0gKGRpdmlzb3IpID0+IGRpdmlkZW5kID0+IGRpdmlkZW5kICUgZGl2aXNvcjtcbmV4cG9ydCBjb25zdCBtb2QgPSAoZGl2aXNvcikgPT4gZGl2aWRlbmQgPT4gKChkaXZpZGVuZCAlIGRpdmlzb3IpICsgZGl2aXNvcikgJSBkaXZpc29yO1xuZXhwb3J0IGNvbnN0IG5lZ2F0ZSA9IG4gPT4gLW47XG5leHBvcnQgY29uc3QgaXNGaW5pdGUgPSBuID0+IE1hdGguYWJzKG4pICE9PSBJbmZpbml0eTtcbmV4cG9ydCBjb25zdCB0b0Zpbml0ZSA9IHVubGVzcyhpc0Zpbml0ZSkobiA9PiBNYXRoLnNpZ24obikgKiBOdW1iZXIuTUFYX1NBRkVfSU5URUdFUik7XG5leHBvcnQgY29uc3QgaXNQb3NpdGl2ZSA9IG4gPT4gTWF0aC5zaWduKG4pID09PSAxO1xuZXhwb3J0IGNvbnN0IGlzTmVnYXRpdmUgPSBuID0+IE1hdGguc2lnbihuKSA9PT0gLTE7XG5leHBvcnQgY29uc3QgaXNOb25OZWdhdGl2ZSA9IG4gPT4gTWF0aC5zaWduKG4pICE9PSAtMTtcbmV4cG9ydCBjb25zdCBpc05vblBvc2l0aXZlID0gbiA9PiBNYXRoLnNpZ24obikgIT09IDE7XG5leHBvcnQgY29uc3QgQm91bmRlZFNhZmUgPSB7XG4gICAgLi4uQm91bmRlZEluZmluaXR5LFxuICAgIHRvcDogTnVtYmVyLk1BWF9TQUZFX0lOVEVHRVIsXG4gICAgYm90dG9tOiBOdW1iZXIuTUlOX1NBRkVfSU5URUdFUixcbn07XG5leHBvcnQgY29uc3QgRW51bUludCA9IHtcbiAgICAuLi5Cb3VuZGVkU2FmZSxcbiAgICBzdWNjOiBmbG93KE8uZnJvbVByZWRpY2F0ZShhbmQoKG4pID0+IG4gPCBOdW1iZXIuTUFYX1NBRkVfSU5URUdFUikoTnVtYmVyLmlzSW50ZWdlcikpLCBPLm1hcChpbmNyZW1lbnQpKSxcbiAgICBwcmVkOiBmbG93KE8uZnJvbVByZWRpY2F0ZShhbmQoKG4pID0+IG4gPiBOdW1iZXIuTUlOX1NBRkVfSU5URUdFUikoTnVtYmVyLmlzSW50ZWdlcikpLCBPLm1hcChkZWNyZW1lbnQpKSxcbiAgICB0b0VudW06IE8uc29tZSxcbiAgICBmcm9tRW51bTogaWRlbnRpdHksXG4gICAgY2FyZGluYWxpdHk6IEwub2YoSW5maW5pdHkpLFxufTtcbmV4cG9ydCBjb25zdCBkaWdpdHMgPSAobikgPT4gcGlwZShbLi4uKG4gKyBcIlwiKV0sIEEuZmlsdGVyTWFwKGZyb21TdHJpbmcpKTtcbiIsCiAgImltcG9ydCB7IGZsb3csIGlkZW50aXR5LCBwaXBlIH0gZnJvbSBcImZwLXRzL2Z1bmN0aW9uXCI7XG5pbXBvcnQgeyBub3QsIGFuZCB9IGZyb20gXCJmcC10cy9QcmVkaWNhdGVcIjtcbmltcG9ydCAqIGFzIE8gZnJvbSBcImZwLXRzL09wdGlvblwiO1xuaW1wb3J0IHsgdW5sZXNzIH0gZnJvbSBcIi4vRnVuY3Rpb25cIjtcbmltcG9ydCB7IEJvdW5kZWQgYXMgQm91bmRlZEluZmluaXR5IH0gZnJvbSBcImZwLXRzL251bWJlclwiO1xuaW1wb3J0ICogYXMgQSBmcm9tIFwiZnAtdHMvQXJyYXlcIjtcbmltcG9ydCAqIGFzIEwgZnJvbSBcIi4vTGF6eVwiO1xuZXhwb3J0IGNvbnN0IGlzVmFsaWQgPSBub3QoTnVtYmVyLmlzTmFOKTtcbmV4cG9ydCBjb25zdCBmcm9tU3RyaW5nV2l0aFJhZGl4ID0gKHJhZGl4KSA9PiAoc3RyaW5nKSA9PiBwaXBlKE51bWJlci5wYXJzZUludChzdHJpbmcsIHJhZGl4KSwgTy5mcm9tUHJlZGljYXRlKGlzVmFsaWQpKTtcbmV4cG9ydCBjb25zdCBmcm9tU3RyaW5nID0gZnJvbVN0cmluZ1dpdGhSYWRpeCgxMCk7XG5leHBvcnQgY29uc3QgZmxvYXRGcm9tU3RyaW5nID0gZmxvdyhOdW1iZXIucGFyc2VGbG9hdCwgTy5mcm9tUHJlZGljYXRlKGlzVmFsaWQpKTtcbmV4cG9ydCBjb25zdCBpbmNyZW1lbnQgPSB4ID0+IHggKyAxO1xuZXhwb3J0IGNvbnN0IGRlY3JlbWVudCA9IHggPT4geCAtIDE7XG5leHBvcnQgY29uc3QgYWRkID0gKHgpID0+IHkgPT4geCArIHk7XG5leHBvcnQgY29uc3QgbXVsdGlwbHkgPSAoeCkgPT4geSA9PiB4ICogeTtcbmV4cG9ydCBjb25zdCBzdWJ0cmFjdCA9IChzdWJ0cmFoZW5kKSA9PiBtaW51ZW5kID0+IG1pbnVlbmQgLSBzdWJ0cmFoZW5kO1xuZXhwb3J0IGNvbnN0IGRpdmlkZSA9IChkaXZpc29yKSA9PiBkaXZpZGVuZCA9PiBkaXZpZGVuZCAvIGRpdmlzb3I7XG5leHBvcnQgY29uc3QgcmVtID0gKGRpdmlzb3IpID0+IGRpdmlkZW5kID0+IGRpdmlkZW5kICUgZGl2aXNvcjtcbmV4cG9ydCBjb25zdCBtb2QgPSAoZGl2aXNvcikgPT4gZGl2aWRlbmQgPT4gKChkaXZpZGVuZCAlIGRpdmlzb3IpICsgZGl2aXNvcikgJSBkaXZpc29yO1xuZXhwb3J0IGNvbnN0IG5lZ2F0ZSA9IG4gPT4gLW47XG5leHBvcnQgY29uc3QgaXNGaW5pdGUgPSBuID0+IE1hdGguYWJzKG4pICE9PSBJbmZpbml0eTtcbmV4cG9ydCBjb25zdCB0b0Zpbml0ZSA9IHVubGVzcyhpc0Zpbml0ZSkobiA9PiBNYXRoLnNpZ24obikgKiBOdW1iZXIuTUFYX1NBRkVfSU5URUdFUik7XG5leHBvcnQgY29uc3QgaXNQb3NpdGl2ZSA9IG4gPT4gTWF0aC5zaWduKG4pID09PSAxO1xuZXhwb3J0IGNvbnN0IGlzTmVnYXRpdmUgPSBuID0+IE1hdGguc2lnbihuKSA9PT0gLTE7XG5leHBvcnQgY29uc3QgaXNOb25OZWdhdGl2ZSA9IG4gPT4gTWF0aC5zaWduKG4pICE9PSAtMTtcbmV4cG9ydCBjb25zdCBpc05vblBvc2l0aXZlID0gbiA9PiBNYXRoLnNpZ24obikgIT09IDE7XG5leHBvcnQgY29uc3QgQm91bmRlZFNhZmUgPSB7XG4gICAgLi4uQm91bmRlZEluZmluaXR5LFxuICAgIHRvcDogTnVtYmVyLk1BWF9TQUZFX0lOVEVHRVIsXG4gICAgYm90dG9tOiBOdW1iZXIuTUlOX1NBRkVfSU5URUdFUixcbn07XG5leHBvcnQgY29uc3QgRW51bUludCA9IHtcbiAgICAuLi5Cb3VuZGVkU2FmZSxcbiAgICBzdWNjOiBmbG93KE8uZnJvbVByZWRpY2F0ZShhbmQoKG4pID0+IG4gPCBOdW1iZXIuTUFYX1NBRkVfSU5URUdFUikoTnVtYmVyLmlzSW50ZWdlcikpLCBPLm1hcChpbmNyZW1lbnQpKSxcbiAgICBwcmVkOiBmbG93KE8uZnJvbVByZWRpY2F0ZShhbmQoKG4pID0+IG4gPiBOdW1iZXIuTUlOX1NBRkVfSU5URUdFUikoTnVtYmVyLmlzSW50ZWdlcikpLCBPLm1hcChkZWNyZW1lbnQpKSxcbiAgICB0b0VudW06IE8uc29tZSxcbiAgICBmcm9tRW51bTogaWRlbnRpdHksXG4gICAgY2FyZGluYWxpdHk6IEwub2YoSW5maW5pdHkpLFxufTtcbmV4cG9ydCBjb25zdCBkaWdpdHMgPSAobikgPT4gcGlwZShbLi4uKG4gKyBcIlwiKV0sIEEuZmlsdGVyTWFwKGZyb21TdHJpbmcpKTtcbiIsCiAgImltcG9ydCB7IGZsb3csIGlkZW50aXR5LCBwaXBlIH0gZnJvbSBcImZwLXRzL2Z1bmN0aW9uXCI7XG5pbXBvcnQgeyBub3QsIGFuZCB9IGZyb20gXCJmcC10cy9QcmVkaWNhdGVcIjtcbmltcG9ydCAqIGFzIE8gZnJvbSBcImZwLXRzL09wdGlvblwiO1xuaW1wb3J0IHsgdW5sZXNzIH0gZnJvbSBcIi4vRnVuY3Rpb25cIjtcbmltcG9ydCB7IEJvdW5kZWQgYXMgQm91bmRlZEluZmluaXR5IH0gZnJvbSBcImZwLXRzL251bWJlclwiO1xuaW1wb3J0ICogYXMgQSBmcm9tIFwiZnAtdHMvQXJyYXlcIjtcbmltcG9ydCAqIGFzIEwgZnJvbSBcIi4vTGF6eVwiO1xuZXhwb3J0IGNvbnN0IGlzVmFsaWQgPSBub3QoTnVtYmVyLmlzTmFOKTtcbmV4cG9ydCBjb25zdCBmcm9tU3RyaW5nV2l0aFJhZGl4ID0gKHJhZGl4KSA9PiAoc3RyaW5nKSA9PiBwaXBlKE51bWJlci5wYXJzZUludChzdHJpbmcsIHJhZGl4KSwgTy5mcm9tUHJlZGljYXRlKGlzVmFsaWQpKTtcbmV4cG9ydCBjb25zdCBmcm9tU3RyaW5nID0gZnJvbVN0cmluZ1dpdGhSYWRpeCgxMCk7XG5leHBvcnQgY29uc3QgZmxvYXRGcm9tU3RyaW5nID0gZmxvdyhOdW1iZXIucGFyc2VGbG9hdCwgTy5mcm9tUHJlZGljYXRlKGlzVmFsaWQpKTtcbmV4cG9ydCBjb25zdCBpbmNyZW1lbnQgPSB4ID0+IHggKyAxO1xuZXhwb3J0IGNvbnN0IGRlY3JlbWVudCA9IHggPT4geCAtIDE7XG5leHBvcnQgY29uc3QgYWRkID0gKHgpID0+IHkgPT4geCArIHk7XG5leHBvcnQgY29uc3QgbXVsdGlwbHkgPSAoeCkgPT4geSA9PiB4ICogeTtcbmV4cG9ydCBjb25zdCBzdWJ0cmFjdCA9IChzdWJ0cmFoZW5kKSA9PiBtaW51ZW5kID0+IG1pbnVlbmQgLSBzdWJ0cmFoZW5kO1xuZXhwb3J0IGNvbnN0IGRpdmlkZSA9IChkaXZpc29yKSA9PiBkaXZpZGVuZCA9PiBkaXZpZGVuZCAvIGRpdmlzb3I7XG5leHBvcnQgY29uc3QgcmVtID0gKGRpdmlzb3IpID0+IGRpdmlkZW5kID0+IGRpdmlkZW5kICUgZGl2aXNvcjtcbmV4cG9ydCBjb25zdCBtb2QgPSAoZGl2aXNvcikgPT4gZGl2aWRlbmQgPT4gKChkaXZpZGVuZCAlIGRpdmlzb3IpICsgZGl2aXNvcikgJSBkaXZpc29yO1xuZXhwb3J0IGNvbnN0IG5lZ2F0ZSA9IG4gPT4gLW47XG5leHBvcnQgY29uc3QgaXNGaW5pdGUgPSBuID0+IE1hdGguYWJzKG4pICE9PSBJbmZpbml0eTtcbmV4cG9ydCBjb25zdCB0b0Zpbml0ZSA9IHVubGVzcyhpc0Zpbml0ZSkobiA9PiBNYXRoLnNpZ24obikgKiBOdW1iZXIuTUFYX1NBRkVfSU5URUdFUik7XG5leHBvcnQgY29uc3QgaXNQb3NpdGl2ZSA9IG4gPT4gTWF0aC5zaWduKG4pID09PSAxO1xuZXhwb3J0IGNvbnN0IGlzTmVnYXRpdmUgPSBuID0+IE1hdGguc2lnbihuKSA9PT0gLTE7XG5leHBvcnQgY29uc3QgaXNOb25OZWdhdGl2ZSA9IG4gPT4gTWF0aC5zaWduKG4pICE9PSAtMTtcbmV4cG9ydCBjb25zdCBpc05vblBvc2l0aXZlID0gbiA9PiBNYXRoLnNpZ24obikgIT09IDE7XG5leHBvcnQgY29uc3QgQm91bmRlZFNhZmUgPSB7XG4gICAgLi4uQm91bmRlZEluZmluaXR5LFxuICAgIHRvcDogTnVtYmVyLk1BWF9TQUZFX0lOVEVHRVIsXG4gICAgYm90dG9tOiBOdW1iZXIuTUlOX1NBRkVfSU5URUdFUixcbn07XG5leHBvcnQgY29uc3QgRW51bUludCA9IHtcbiAgICAuLi5Cb3VuZGVkU2FmZSxcbiAgICBzdWNjOiBmbG93KE8uZnJvbVByZWRpY2F0ZShhbmQoKG4pID0+IG4gPCBOdW1iZXIuTUFYX1NBRkVfSU5URUdFUikoTnVtYmVyLmlzSW50ZWdlcikpLCBPLm1hcChpbmNyZW1lbnQpKSxcbiAgICBwcmVkOiBmbG93KE8uZnJvbVByZWRpY2F0ZShhbmQoKG4pID0+IG4gPiBOdW1iZXIuTUlOX1NBRkVfSU5URUdFUikoTnVtYmVyLmlzSW50ZWdlcikpLCBPLm1hcChkZWNyZW1lbnQpKSxcbiAgICB0b0VudW06IE8uc29tZSxcbiAgICBmcm9tRW51bTogaWRlbnRpdHksXG4gICAgY2FyZGluYWxpdHk6IEwub2YoSW5maW5pdHkpLFxufTtcbmV4cG9ydCBjb25zdCBkaWdpdHMgPSAobikgPT4gcGlwZShbLi4uKG4gKyBcIlwiKV0sIEEuZmlsdGVyTWFwKGZyb21TdHJpbmcpKTtcbiIsCiAgImltcG9ydCB7IHBpcGUgfSBmcm9tIFwiZnAtdHMvZnVuY3Rpb25cIlxyXG5pbXBvcnQgeyBsaXN0ZW5pbmdUb1NuZWFrQmluZHMgfSBmcm9tIFwiLi9zbmVha1wiXHJcbmltcG9ydCAqIGFzIE51bSBmcm9tIFwiZnAtdHMtc3RkL051bWJlclwiXHJcblxyXG5jb25zdCBTQ1JPTExfU1RFUCA9IDI1XHJcblxyXG5jb25zdCBmb2N1c09uQXBwID0gKCkgPT4gZG9jdW1lbnQucXVlcnlTZWxlY3RvcjxFbGVtZW50PihcIi5Sb290X19tYWluLXZpZXcgLm9zLXZpZXdwb3J0XCIpIVxyXG5cclxuZXhwb3J0IGNvbnN0IGFwcFNjcm9sbCA9IChzOiBudW1iZXIpID0+IHtcclxuICAgIGNvbnN0IGFwcCA9IGZvY3VzT25BcHAoKVxyXG4gICAgY29uc3Qgc2Nyb2xsSW50ZXJ2YWxJZCA9IHNldEludGVydmFsKCgpID0+IChhcHAuc2Nyb2xsVG9wICs9IHMgKiBTQ1JPTExfU1RFUCksIDEwKVxyXG4gICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImtleXVwXCIsICgpID0+IGNsZWFySW50ZXJ2YWwoc2Nyb2xsSW50ZXJ2YWxJZCkpXHJcbn1cclxuXHJcbmV4cG9ydCBjb25zdCBhcHBTY3JvbGxZID0gKHk6IG51bWJlcikgPT4gZm9jdXNPbkFwcCgpLnNjcm9sbCgwLCB5KVxyXG5cclxuZXhwb3J0IGNvbnN0IG9wZW5QYWdlID0gKHBhZ2U6IHN0cmluZykgPT4gU3BpY2V0aWZ5LlBsYXRmb3JtLkhpc3RvcnkucHVzaCh7IHBhdGhuYW1lOiBwYWdlIH0pXHJcblxyXG5leHBvcnQgY29uc3Qgcm90YXRlU2lkZWJhciA9IChvZmZzZXQ6IG51bWJlcikgPT4ge1xyXG4gICAgY29uc3QgbmF2TGlua3MgPSBBcnJheS5mcm9tKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGw8RWxlbWVudD4oXCIubWFpbi15b3VyTGlicmFyeVgtbmF2TGlua1wiKS52YWx1ZXMoKSlcclxuXHJcbiAgICBwaXBlKFxyXG4gICAgICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3I8SFRNTEVsZW1lbnQ+KFwiLm1haW4teW91ckxpYnJhcnlYLW5hdkxpbmtBY3RpdmVcIiksXHJcbiAgICAgICAgYWN0aXZlID0+IG5hdkxpbmtzLmZpbmRJbmRleChlID0+IGUgPT09IGFjdGl2ZSksXHJcbiAgICAgICAgeCA9PiBwaXBlKHggPT09IC0xICYmIG9mZnNldCA8PSAwID8gb2Zmc2V0IDogeCArIG9mZnNldCwgTnVtLm1vZChuYXZMaW5rcy5sZW5ndGgpKSxcclxuICAgICAgICB4ID0+IChuYXZMaW5rc1t4XSBhcyBIVE1MRWxlbWVudCkuY2xpY2soKSxcclxuICAgIClcclxufVxyXG5cclxuZXhwb3J0IGNvbnN0IHJlc2l6ZUxlZnRTaWRlYmFyID0gKHB4czogbnVtYmVyKSA9PiB7XHJcbiAgICBjb25zdCBodG1sID0gZG9jdW1lbnQuZmlyc3RFbGVtZW50Q2hpbGQhIGFzIEhUTUxIdG1sRWxlbWVudCxcclxuICAgICAgICBodG1sU3R5bGUgPSBodG1sLnN0eWxlXHJcbiAgICBodG1sU3R5bGUuY3NzVGV4dCA9IGh0bWxTdHlsZS5jc3NUZXh0LnJlcGxhY2UoLygtLWxlZnQtc2lkZWJhci13aWR0aDogKVteO10rLywgYCQxJHtweHN9cHhgKVxyXG59XHJcblxyXG5leHBvcnQgY2xhc3MgQmluZCB7XHJcbiAgICBwcml2YXRlIGN0cmwgPSBmYWxzZVxyXG4gICAgcHJpdmF0ZSBzaGlmdCA9IGZhbHNlXHJcbiAgICBwcml2YXRlIGFsdCA9IGZhbHNlXHJcbiAgICBjb25zdHJ1Y3Rvcihwcml2YXRlIGtleTogc3RyaW5nLCBwcml2YXRlIGNhbGxiYWNrOiAoZXZlbnQ6IEtleWJvYXJkRXZlbnQpID0+IHZvaWQpIHt9XHJcblxyXG4gICAgc2V0Q3RybCA9IChyZXF1aXJlZDogYm9vbGVhbikgPT4gKCh0aGlzLmN0cmwgPSByZXF1aXJlZCksIHRoaXMpXHJcbiAgICBzZXRTaGlmdCA9IChyZXF1aXJlZDogYm9vbGVhbikgPT4gKCh0aGlzLnNoaWZ0ID0gcmVxdWlyZWQpLCB0aGlzKVxyXG4gICAgc2V0QWx0ID0gKHJlcXVpcmVkOiBib29sZWFuKSA9PiAoKHRoaXMuYWx0ID0gcmVxdWlyZWQpLCB0aGlzKVxyXG5cclxuICAgIHJlZ2lzdGVyID0gKCkgPT5cclxuICAgICAgICBTcGljZXRpZnkuS2V5Ym9hcmQucmVnaXN0ZXJTaG9ydGN1dChcclxuICAgICAgICAgICAgeyBrZXk6IHRoaXMua2V5LCBjdHJsOiB0aGlzLmN0cmwsIHNoaWZ0OiB0aGlzLnNoaWZ0LCBhbHQ6IHRoaXMuYWx0IH0sXHJcbiAgICAgICAgICAgIGV2ZW50ID0+IHZvaWQgKCFsaXN0ZW5pbmdUb1NuZWFrQmluZHMgJiYgdGhpcy5jYWxsYmFjayhldmVudCkpLFxyXG4gICAgICAgIClcclxufVxyXG4iLAogICJpbXBvcnQgeyBwaXBlIH0gZnJvbSBcImZwLXRzL2Z1bmN0aW9uXCJcclxuaW1wb3J0IHsgbGlzdGVuaW5nVG9TbmVha0JpbmRzIH0gZnJvbSBcIi4vc25lYWtcIlxyXG5pbXBvcnQgKiBhcyBOdW0gZnJvbSBcImZwLXRzLXN0ZC9OdW1iZXJcIlxyXG5cclxuY29uc3QgU0NST0xMX1NURVAgPSAyNVxyXG5cclxuY29uc3QgZm9jdXNPbkFwcCA9ICgpID0+IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3I8RWxlbWVudD4oXCIuUm9vdF9fbWFpbi12aWV3IC5vcy12aWV3cG9ydFwiKSFcclxuXHJcbmV4cG9ydCBjb25zdCBhcHBTY3JvbGwgPSAoczogbnVtYmVyKSA9PiB7XHJcbiAgICBjb25zdCBhcHAgPSBmb2N1c09uQXBwKClcclxuICAgIGNvbnN0IHNjcm9sbEludGVydmFsSWQgPSBzZXRJbnRlcnZhbCgoKSA9PiAoYXBwLnNjcm9sbFRvcCArPSBzICogU0NST0xMX1NURVApLCAxMClcclxuICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJrZXl1cFwiLCAoKSA9PiBjbGVhckludGVydmFsKHNjcm9sbEludGVydmFsSWQpKVxyXG59XHJcblxyXG5leHBvcnQgY29uc3QgYXBwU2Nyb2xsWSA9ICh5OiBudW1iZXIpID0+IGZvY3VzT25BcHAoKS5zY3JvbGwoMCwgeSlcclxuXHJcbmV4cG9ydCBjb25zdCBvcGVuUGFnZSA9IChwYWdlOiBzdHJpbmcpID0+IFNwaWNldGlmeS5QbGF0Zm9ybS5IaXN0b3J5LnB1c2goeyBwYXRobmFtZTogcGFnZSB9KVxyXG5cclxuZXhwb3J0IGNvbnN0IHJvdGF0ZVNpZGViYXIgPSAob2Zmc2V0OiBudW1iZXIpID0+IHtcclxuICAgIGNvbnN0IG5hdkxpbmtzID0gQXJyYXkuZnJvbShkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsPEVsZW1lbnQ+KFwiLm1haW4teW91ckxpYnJhcnlYLW5hdkxpbmtcIikudmFsdWVzKCkpXHJcblxyXG4gICAgcGlwZShcclxuICAgICAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yPEhUTUxFbGVtZW50PihcIi5tYWluLXlvdXJMaWJyYXJ5WC1uYXZMaW5rQWN0aXZlXCIpLFxyXG4gICAgICAgIGFjdGl2ZSA9PiBuYXZMaW5rcy5maW5kSW5kZXgoZSA9PiBlID09PSBhY3RpdmUpLFxyXG4gICAgICAgIHggPT4gcGlwZSh4ID09PSAtMSAmJiBvZmZzZXQgPD0gMCA/IG9mZnNldCA6IHggKyBvZmZzZXQsIE51bS5tb2QobmF2TGlua3MubGVuZ3RoKSksXHJcbiAgICAgICAgeCA9PiAobmF2TGlua3NbeF0gYXMgSFRNTEVsZW1lbnQpLmNsaWNrKCksXHJcbiAgICApXHJcbn1cclxuXHJcbmV4cG9ydCBjb25zdCByZXNpemVMZWZ0U2lkZWJhciA9IChweHM6IG51bWJlcikgPT4ge1xyXG4gICAgY29uc3QgaHRtbCA9IGRvY3VtZW50LmZpcnN0RWxlbWVudENoaWxkISBhcyBIVE1MSHRtbEVsZW1lbnQsXHJcbiAgICAgICAgaHRtbFN0eWxlID0gaHRtbC5zdHlsZVxyXG4gICAgaHRtbFN0eWxlLmNzc1RleHQgPSBodG1sU3R5bGUuY3NzVGV4dC5yZXBsYWNlKC8oLS1sZWZ0LXNpZGViYXItd2lkdGg6IClbXjtdKy8sIGAkMSR7cHhzfXB4YClcclxufVxyXG5cclxuZXhwb3J0IGNsYXNzIEJpbmQge1xyXG4gICAgcHJpdmF0ZSBjdHJsID0gZmFsc2VcclxuICAgIHByaXZhdGUgc2hpZnQgPSBmYWxzZVxyXG4gICAgcHJpdmF0ZSBhbHQgPSBmYWxzZVxyXG4gICAgY29uc3RydWN0b3IocHJpdmF0ZSBrZXk6IHN0cmluZywgcHJpdmF0ZSBjYWxsYmFjazogKGV2ZW50OiBLZXlib2FyZEV2ZW50KSA9PiB2b2lkKSB7fVxyXG5cclxuICAgIHNldEN0cmwgPSAocmVxdWlyZWQ6IGJvb2xlYW4pID0+ICgodGhpcy5jdHJsID0gcmVxdWlyZWQpLCB0aGlzKVxyXG4gICAgc2V0U2hpZnQgPSAocmVxdWlyZWQ6IGJvb2xlYW4pID0+ICgodGhpcy5zaGlmdCA9IHJlcXVpcmVkKSwgdGhpcylcclxuICAgIHNldEFsdCA9IChyZXF1aXJlZDogYm9vbGVhbikgPT4gKCh0aGlzLmFsdCA9IHJlcXVpcmVkKSwgdGhpcylcclxuXHJcbiAgICByZWdpc3RlciA9ICgpID0+XHJcbiAgICAgICAgU3BpY2V0aWZ5LktleWJvYXJkLnJlZ2lzdGVyU2hvcnRjdXQoXHJcbiAgICAgICAgICAgIHsga2V5OiB0aGlzLmtleSwgY3RybDogdGhpcy5jdHJsLCBzaGlmdDogdGhpcy5zaGlmdCwgYWx0OiB0aGlzLmFsdCB9LFxyXG4gICAgICAgICAgICBldmVudCA9PiB2b2lkICghbGlzdGVuaW5nVG9TbmVha0JpbmRzICYmIHRoaXMuY2FsbGJhY2soZXZlbnQpKSxcclxuICAgICAgICApXHJcbn1cclxuIiwKICAiLy8gZXhwb3J0IGludGVyZmFjZSBTcG90aWZ5SURcclxuLy8gICAgIGV4dGVuZHMgTmV3dHlwZTx7IHJlYWRvbmx5IFNwb3RpZnlJRDogdW5pcXVlIHN5bWJvbCB9LCBzdHJpbmc+IHt9XHJcbi8vIGV4cG9ydCBpbnRlcmZhY2UgU3BvdGlmeVVSSVxyXG4vLyAgICAgZXh0ZW5kcyBOZXd0eXBlPHsgcmVhZG9ubHkgU3BvdGlmeVVSSTogdW5pcXVlIHN5bWJvbCB9LCBzdHJpbmc+IHt9XHJcblxyXG5pbXBvcnQgeyBhcnJheSBhcyBhIH0gZnJvbSBcImZwLXRzXCJcclxuaW1wb3J0IHsgY29uc3RhbnQsIHBpcGUgYXMgcCB9IGZyb20gXCJmcC10cy9mdW5jdGlvblwiXHJcblxyXG5leHBvcnQgY29uc3QgbXVzdExvYWRGb3JBcGkgPSBbXCJDb3Ntb3NBc3luY1wiLCBcIkdyYXBoUUxcIiwgXCJQbGF0Zm9ybVwiXVxyXG5leHBvcnQgY29uc3QgbXVzdExvYWRGb3JVdGlsID0gW1wiVVJJXCJdXHJcbmV4cG9ydCBjb25zdCBtdXN0TG9hZEZvclNldHRpbmdzID0gW1wiUmVhY3RcIiwgXCJSZWFjdERPTVwiXVxyXG5cclxuZXhwb3J0IHR5cGUgU3BvdGlmeUlEID0gc3RyaW5nXHJcbmV4cG9ydCB0eXBlIFNwb3RpZnlVUkkgPSBzdHJpbmdcclxuXHJcbmV4cG9ydCB0eXBlIFNwb3RpZnlMb2MgPSB7XHJcbiAgICBiZWZvcmU/OiBcInN0YXJ0XCIgfCB7IHVyaTogU3BvdGlmeVVSSSB9IHwgeyB1aWQ6IHN0cmluZyB9XHJcbiAgICBhZnRlcj86IFwiZW5kXCIgfCB7IHVyaTogU3BvdGlmeVVSSSB9IHwgeyB1aWQ6IHN0cmluZyB9XHJcbn1cclxuXHJcbmV4cG9ydCBuYW1lc3BhY2UgU3BvdGlmeUxvYyB7XHJcbiAgICBleHBvcnQgbmFtZXNwYWNlIGJlZm9yZSB7XHJcbiAgICAgICAgZXhwb3J0IGNvbnN0IHN0YXJ0ID0gY29uc3RhbnQoeyBiZWZvcmU6IFwic3RhcnRcIiB9IGFzIFNwb3RpZnlMb2MpXHJcblxyXG4gICAgICAgIGV4cG9ydCBjb25zdCBmcm9tVXJpID0gKHVyaTogU3BvdGlmeVVSSSkgPT4gKHtcclxuICAgICAgICAgICAgYmVmb3JlOiB7IHVyaSB9LFxyXG4gICAgICAgIH0pXHJcblxyXG4gICAgICAgIGV4cG9ydCBjb25zdCBmcm9tVWlkID0gKHVpZDogc3RyaW5nKSA9PiAoe1xyXG4gICAgICAgICAgICBiZWZvcmU6IHsgdWlkIH0sXHJcbiAgICAgICAgfSlcclxuICAgIH1cclxuXHJcbiAgICBleHBvcnQgbmFtZXNwYWNlIGFmdGVyIHtcclxuICAgICAgICBleHBvcnQgY29uc3QgZW5kID0gY29uc3RhbnQoeyBhZnRlcjogXCJlbmRcIiB9IGFzIFNwb3RpZnlMb2MpXHJcblxyXG4gICAgICAgIGV4cG9ydCBjb25zdCBmcm9tVXJpID0gKHVyaTogU3BvdGlmeVVSSSkgPT4gKHtcclxuICAgICAgICAgICAgYmVmb3JlOiB7IHVyaSB9LFxyXG4gICAgICAgIH0pXHJcblxyXG4gICAgICAgIGV4cG9ydCBjb25zdCBmcm9tVWlkID0gKHVpZDogc3RyaW5nKSA9PiAoe1xyXG4gICAgICAgICAgICBiZWZvcmU6IHsgdWlkIH0sXHJcbiAgICAgICAgfSlcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGNvbnN0IGVzY2FwZVJlZ2V4ID0gKHN0cjogc3RyaW5nKSA9PiBzdHIucmVwbGFjZSgvWy4qKz9eJHt9KCl8W1xcXVxcXFxdL2csIGBcXFxcJCZgKVxyXG5cclxuZXhwb3J0IGNvbnN0IHRpdGxlQ2FzZSA9IChzdHI6IHN0cmluZykgPT4gc3RyLnJlcGxhY2UoL1xcYlxcdy9nLCBsID0+IGwudG9VcHBlckNhc2UoKSlcclxuXHJcbmV4cG9ydCBjb25zdCBub3JtYWxpemVTdHIgPSAoc3RyOiBzdHJpbmcpID0+XHJcbiAgICBzdHJcclxuICAgICAgICAubm9ybWFsaXplKFwiTkZLRFwiKVxyXG4gICAgICAgIC5yZXBsYWNlKC9cXCguKlxcKS9nLCBcIlwiKVxyXG4gICAgICAgIC5yZXBsYWNlKC9cXFsuKlxcXS9nLCBcIlwiKVxyXG4gICAgICAgIC5yZXBsYWNlKC8tXywvZywgXCIgXCIpXHJcbiAgICAgICAgLnJlcGxhY2UoL1teYS16QS1aMC05IF0vZywgXCJcIilcclxuICAgICAgICAucmVwbGFjZSgvXFxzKy9nLCBcIiBcIilcclxuICAgICAgICAudG9Mb3dlckNhc2UoKVxyXG4gICAgICAgIC50cmltKClcclxuXHJcbi8vISBEb2VzIGxvY2F0aW9uIGFjdHVhbGx5IHBvaW50IHRvIGRvY3VtZW50LmJvZHk/XHJcbmV4cG9ydCBjb25zdCB3YWl0Rm9yRWxlbWVudCA9IDxFIGV4dGVuZHMgRWxlbWVudD4oXHJcbiAgICBzZWxlY3Rvcjogc3RyaW5nLFxyXG4gICAgdGltZW91dCA9IDEwMDAsXHJcbiAgICBsb2NhdGlvbiA9IGRvY3VtZW50LmJvZHksXHJcbiAgICBub3RFbD86IEUsXHJcbikgPT5cclxuICAgIG5ldyBQcm9taXNlKChyZXNvbHZlOiAodmFsdWU6IEVsZW1lbnQgfCBudWxsKSA9PiB2b2lkKSA9PiB7XHJcbiAgICAgICAgY29uc3QgcmVzID0gKHY6IGFueSkgPT4ge1xyXG4gICAgICAgICAgICBvYnNlcnZlci5kaXNjb25uZWN0KClcclxuICAgICAgICAgICAgcmVzb2x2ZSh2KVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgY29uc3Qgb2JzZXJ2ZXIgPSBuZXcgTXV0YXRpb25PYnNlcnZlcigoKSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IGVsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcjxFPihzZWxlY3RvcilcclxuICAgICAgICAgICAgaWYgKGVsICYmICghbm90RWwgfHwgZWwgIT09IG5vdEVsKSkgcmV0dXJuIHJlcyhlbClcclxuICAgICAgICB9KVxyXG5cclxuICAgICAgICBvYnNlcnZlci5vYnNlcnZlKGxvY2F0aW9uLCB7XHJcbiAgICAgICAgICAgIGNoaWxkTGlzdDogdHJ1ZSxcclxuICAgICAgICAgICAgc3VidHJlZTogdHJ1ZSxcclxuICAgICAgICB9KVxyXG5cclxuICAgICAgICBpZiAodGltZW91dCkgc2V0VGltZW91dCgoKSA9PiByZXMobnVsbCksIHRpbWVvdXQpXHJcbiAgICB9KVxyXG5cclxuZXhwb3J0IGNvbnN0IHRyYXBFbGVtZW50ID0gPEUgZXh0ZW5kcyBFbGVtZW50PihcclxuICAgIHNlbGVjdG9yOiBzdHJpbmcsXHJcbiAgICBjYWxsYmFjazogKGVsOiBFIHwgbnVsbCwgbGFzdEVsOiBFIHwgbnVsbCkgPT4gdm9pZCxcclxuICAgIGxvY2F0aW9uID0gZG9jdW1lbnQuYm9keSxcclxuKSA9PiB7XHJcbiAgICBsZXQgbGFzdEVsOiBFIHwgbnVsbCA9IG51bGxcclxuXHJcbiAgICBjb25zdCBvYnNlcnZlciA9IG5ldyBNdXRhdGlvbk9ic2VydmVyKCgpID0+IHtcclxuICAgICAgICBjb25zdCBlbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3I8RT4oc2VsZWN0b3IpXHJcbiAgICAgICAgaWYgKGVsICE9PSBsYXN0RWwpIGNhbGxiYWNrKGVsLCBsYXN0RWwpXHJcbiAgICAgICAgbGFzdEVsID0gZWxcclxuICAgIH0pXHJcblxyXG4gICAgb2JzZXJ2ZXIub2JzZXJ2ZShsb2NhdGlvbiwge1xyXG4gICAgICAgIGNoaWxkTGlzdDogdHJ1ZSxcclxuICAgICAgICBzdWJ0cmVlOiB0cnVlLFxyXG4gICAgfSlcclxufVxyXG5cclxuZXhwb3J0IGNvbnN0IHNsZWVwID0gKG1zOiBudW1iZXIpID0+IG5ldyBQcm9taXNlKHJlc29sdmUgPT4gc2V0VGltZW91dChyZXNvbHZlLCBtcykpXHJcblxyXG5leHBvcnQgY29uc3QgZ2V0UmVhY3RQcm9wcyA9IChlbGVtZW50OiBFbGVtZW50KSA9PlxyXG4gICAgZWxlbWVudFtPYmplY3Qua2V5cyhlbGVtZW50KS5maW5kKGsgPT4gay5zdGFydHNXaXRoKFwiX19yZWFjdFByb3BzJFwiKSkgYXMga2V5b2YgdHlwZW9mIGVsZW1lbnRdXHJcblxyXG5leHBvcnQgY29uc3QgaXNMaWtlZCA9ICh1cmlzOiBTcG90aWZ5VVJJW10pID0+IFNwaWNldGlmeS5QbGF0Zm9ybS5MaWJyYXJ5QVBJLmNvbnRhaW5zKC4uLnVyaXMpIGFzIFByb21pc2U8Ym9vbGVhbltdPlxyXG5cclxuZXhwb3J0IGNvbnN0IHNldExpa2VkID0gKHVyaXM6IFNwb3RpZnlVUklbXSwgbGlrZWQ6IGJvb2xlYW4pID0+XHJcbiAgICBTcGljZXRpZnkuUGxhdGZvcm0uTGlicmFyeUFQSVtsaWtlZCA/IFwiYWRkXCIgOiBcInJlbW92ZVwiXSguLi51cmlzKVxyXG5cclxuZXhwb3J0IGNvbnN0IHRvZ2dsZUxpa2VkID0gYXN5bmMgKHVyaXM6IFNwb3RpZnlVUklbXSkgPT4ge1xyXG4gICAgY29uc3QgbGlrZWQgPSBhd2FpdCBpc0xpa2VkKHVyaXMpXHJcblxyXG4gICAgcmV0dXJuIGF3YWl0IHAoXHJcbiAgICAgICAgdXJpcyxcclxuICAgICAgICBhLnJlZHVjZVdpdGhJbmRleChcclxuICAgICAgICAgICAgW1tdIGFzIFNwb3RpZnlVUklbXSwgW10gYXMgU3BvdGlmeVVSSVtdXSBhcyBjb25zdCxcclxuICAgICAgICAgICAgKGksIGFjYywgdXJpKSA9PiAoYWNjW051bWJlcihsaWtlZFtpXSldLnB1c2godXJpKSwgYWNjKSxcclxuICAgICAgICApLFxyXG4gICAgICAgIChbdG9BZGQsIHRvUmVtXSkgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBwcyA9IFtdXHJcbiAgICAgICAgICAgIGlmICh0b0FkZC5sZW5ndGgpIHBzLnB1c2goc2V0TGlrZWQodG9BZGQsIHRydWUpKVxyXG4gICAgICAgICAgICBpZiAodG9SZW0ubGVuZ3RoKSBwcy5wdXNoKHNldExpa2VkKHRvUmVtLCBmYWxzZSkpXHJcbiAgICAgICAgICAgIHJldHVybiBQcm9taXNlLmFsbChwcylcclxuICAgICAgICB9LFxyXG4gICAgKVxyXG59XHJcblxyXG5leHBvcnQgY29uc3QgY3JlYXRlUXVldWVJdGVtID0gKHF1ZXVlZDogYm9vbGVhbikgPT4gKHVyaTogU3BvdGlmeVVSSSkgPT4gKHtcclxuICAgIGNvbnRleHRUcmFjazoge1xyXG4gICAgICAgIHVyaSxcclxuICAgICAgICB1aWQ6IFwiXCIsXHJcbiAgICAgICAgbWV0YWRhdGE6IHtcclxuICAgICAgICAgICAgaXNfcXVldWVkOiBxdWV1ZWQudG9TdHJpbmcoKSxcclxuICAgICAgICB9LFxyXG4gICAgfSxcclxuICAgIHJlbW92ZWQ6IFtdLFxyXG4gICAgYmxvY2tlZDogW10sXHJcbiAgICBwcm92aWRlcjogcXVldWVkID8gXCJxdWV1ZVwiIDogXCJjb250ZXh0XCIsXHJcbn0pXHJcblxyXG5leHBvcnQgY29uc3Qgc2V0UXVldWUgPSBhc3luYyAobmV4dFRyYWNrczogQXJyYXk8UmV0dXJuVHlwZTxSZXR1cm5UeXBlPHR5cGVvZiBjcmVhdGVRdWV1ZUl0ZW0+Pj4pID0+IHtcclxuICAgIGNvbnN0IHsgX3F1ZXVlLCBfY2xpZW50IH0gPSBTcGljZXRpZnkuUGxhdGZvcm0uUGxheWVyQVBJLl9xdWV1ZVxyXG4gICAgY29uc3QgeyBwcmV2VHJhY2tzLCBxdWV1ZVJldmlzaW9uIH0gPSBfcXVldWVcclxuXHJcbiAgICByZXR1cm4gX2NsaWVudC5zZXRRdWV1ZSh7XHJcbiAgICAgICAgbmV4dFRyYWNrcyxcclxuICAgICAgICBwcmV2VHJhY2tzLFxyXG4gICAgICAgIHF1ZXVlUmV2aXNpb24sXHJcbiAgICB9KSBhcyBQcm9taXNlPHsgZXJyb3I6IG51bWJlcjsgcmVhc29uczogc3RyaW5nIH0+XHJcbn1cclxuXHJcbmV4cG9ydCBjb25zdCBzZXRQbGF5aW5nQ29udGV4dCA9ICh1cmk6IFNwb3RpZnlVUkkpID0+IHtcclxuICAgIGNvbnN0IHsgc2Vzc2lvbklkIH0gPSBTcGljZXRpZnkuUGxhdGZvcm0uUGxheWVyQVBJLmdldFN0YXRlKClcclxuICAgIHJldHVybiBTcGljZXRpZnkuUGxhdGZvcm0uUGxheWVyQVBJLnVwZGF0ZUNvbnRleHQoc2Vzc2lvbklkLCB7IHVyaSwgdXJsOiBcImNvbnRleHQ6Ly9cIiArIHVyaSB9KSBhcyBQcm9taXNlPHVuZGVmaW5lZD5cclxufVxyXG4iLAogICIvLyBleHBvcnQgaW50ZXJmYWNlIFNwb3RpZnlJRFxyXG4vLyAgICAgZXh0ZW5kcyBOZXd0eXBlPHsgcmVhZG9ubHkgU3BvdGlmeUlEOiB1bmlxdWUgc3ltYm9sIH0sIHN0cmluZz4ge31cclxuLy8gZXhwb3J0IGludGVyZmFjZSBTcG90aWZ5VVJJXHJcbi8vICAgICBleHRlbmRzIE5ld3R5cGU8eyByZWFkb25seSBTcG90aWZ5VVJJOiB1bmlxdWUgc3ltYm9sIH0sIHN0cmluZz4ge31cclxuXHJcbmltcG9ydCB7IGFycmF5IGFzIGEgfSBmcm9tIFwiZnAtdHNcIlxyXG5pbXBvcnQgeyBjb25zdGFudCwgcGlwZSBhcyBwIH0gZnJvbSBcImZwLXRzL2Z1bmN0aW9uXCJcclxuXHJcbmV4cG9ydCBjb25zdCBtdXN0TG9hZEZvckFwaSA9IFtcIkNvc21vc0FzeW5jXCIsIFwiR3JhcGhRTFwiLCBcIlBsYXRmb3JtXCJdXHJcbmV4cG9ydCBjb25zdCBtdXN0TG9hZEZvclV0aWwgPSBbXCJVUklcIl1cclxuZXhwb3J0IGNvbnN0IG11c3RMb2FkRm9yU2V0dGluZ3MgPSBbXCJSZWFjdFwiLCBcIlJlYWN0RE9NXCJdXHJcblxyXG5leHBvcnQgdHlwZSBTcG90aWZ5SUQgPSBzdHJpbmdcclxuZXhwb3J0IHR5cGUgU3BvdGlmeVVSSSA9IHN0cmluZ1xyXG5cclxuZXhwb3J0IHR5cGUgU3BvdGlmeUxvYyA9IHtcclxuICAgIGJlZm9yZT86IFwic3RhcnRcIiB8IHsgdXJpOiBTcG90aWZ5VVJJIH0gfCB7IHVpZDogc3RyaW5nIH1cclxuICAgIGFmdGVyPzogXCJlbmRcIiB8IHsgdXJpOiBTcG90aWZ5VVJJIH0gfCB7IHVpZDogc3RyaW5nIH1cclxufVxyXG5cclxuZXhwb3J0IG5hbWVzcGFjZSBTcG90aWZ5TG9jIHtcclxuICAgIGV4cG9ydCBuYW1lc3BhY2UgYmVmb3JlIHtcclxuICAgICAgICBleHBvcnQgY29uc3Qgc3RhcnQgPSBjb25zdGFudCh7IGJlZm9yZTogXCJzdGFydFwiIH0gYXMgU3BvdGlmeUxvYylcclxuXHJcbiAgICAgICAgZXhwb3J0IGNvbnN0IGZyb21VcmkgPSAodXJpOiBTcG90aWZ5VVJJKSA9PiAoe1xyXG4gICAgICAgICAgICBiZWZvcmU6IHsgdXJpIH0sXHJcbiAgICAgICAgfSlcclxuXHJcbiAgICAgICAgZXhwb3J0IGNvbnN0IGZyb21VaWQgPSAodWlkOiBzdHJpbmcpID0+ICh7XHJcbiAgICAgICAgICAgIGJlZm9yZTogeyB1aWQgfSxcclxuICAgICAgICB9KVxyXG4gICAgfVxyXG5cclxuICAgIGV4cG9ydCBuYW1lc3BhY2UgYWZ0ZXIge1xyXG4gICAgICAgIGV4cG9ydCBjb25zdCBlbmQgPSBjb25zdGFudCh7IGFmdGVyOiBcImVuZFwiIH0gYXMgU3BvdGlmeUxvYylcclxuXHJcbiAgICAgICAgZXhwb3J0IGNvbnN0IGZyb21VcmkgPSAodXJpOiBTcG90aWZ5VVJJKSA9PiAoe1xyXG4gICAgICAgICAgICBiZWZvcmU6IHsgdXJpIH0sXHJcbiAgICAgICAgfSlcclxuXHJcbiAgICAgICAgZXhwb3J0IGNvbnN0IGZyb21VaWQgPSAodWlkOiBzdHJpbmcpID0+ICh7XHJcbiAgICAgICAgICAgIGJlZm9yZTogeyB1aWQgfSxcclxuICAgICAgICB9KVxyXG4gICAgfVxyXG59XHJcblxyXG5leHBvcnQgY29uc3QgZXNjYXBlUmVnZXggPSAoc3RyOiBzdHJpbmcpID0+IHN0ci5yZXBsYWNlKC9bLiorP14ke30oKXxbXFxdXFxcXF0vZywgYFxcXFwkJmApXHJcblxyXG5leHBvcnQgY29uc3QgdGl0bGVDYXNlID0gKHN0cjogc3RyaW5nKSA9PiBzdHIucmVwbGFjZSgvXFxiXFx3L2csIGwgPT4gbC50b1VwcGVyQ2FzZSgpKVxyXG5cclxuZXhwb3J0IGNvbnN0IG5vcm1hbGl6ZVN0ciA9IChzdHI6IHN0cmluZykgPT5cclxuICAgIHN0clxyXG4gICAgICAgIC5ub3JtYWxpemUoXCJORktEXCIpXHJcbiAgICAgICAgLnJlcGxhY2UoL1xcKC4qXFwpL2csIFwiXCIpXHJcbiAgICAgICAgLnJlcGxhY2UoL1xcWy4qXFxdL2csIFwiXCIpXHJcbiAgICAgICAgLnJlcGxhY2UoLy1fLC9nLCBcIiBcIilcclxuICAgICAgICAucmVwbGFjZSgvW15hLXpBLVowLTkgXS9nLCBcIlwiKVxyXG4gICAgICAgIC5yZXBsYWNlKC9cXHMrL2csIFwiIFwiKVxyXG4gICAgICAgIC50b0xvd2VyQ2FzZSgpXHJcbiAgICAgICAgLnRyaW0oKVxyXG5cclxuLy8hIERvZXMgbG9jYXRpb24gYWN0dWFsbHkgcG9pbnQgdG8gZG9jdW1lbnQuYm9keT9cclxuZXhwb3J0IGNvbnN0IHdhaXRGb3JFbGVtZW50ID0gPEUgZXh0ZW5kcyBFbGVtZW50PihcclxuICAgIHNlbGVjdG9yOiBzdHJpbmcsXHJcbiAgICB0aW1lb3V0ID0gMTAwMCxcclxuICAgIGxvY2F0aW9uID0gZG9jdW1lbnQuYm9keSxcclxuICAgIG5vdEVsPzogRSxcclxuKSA9PlxyXG4gICAgbmV3IFByb21pc2UoKHJlc29sdmU6ICh2YWx1ZTogRWxlbWVudCB8IG51bGwpID0+IHZvaWQpID0+IHtcclxuICAgICAgICBjb25zdCByZXMgPSAodjogYW55KSA9PiB7XHJcbiAgICAgICAgICAgIG9ic2VydmVyLmRpc2Nvbm5lY3QoKVxyXG4gICAgICAgICAgICByZXNvbHZlKHYpXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBjb25zdCBvYnNlcnZlciA9IG5ldyBNdXRhdGlvbk9ic2VydmVyKCgpID0+IHtcclxuICAgICAgICAgICAgY29uc3QgZWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yPEU+KHNlbGVjdG9yKVxyXG4gICAgICAgICAgICBpZiAoZWwgJiYgKCFub3RFbCB8fCBlbCAhPT0gbm90RWwpKSByZXR1cm4gcmVzKGVsKVxyXG4gICAgICAgIH0pXHJcblxyXG4gICAgICAgIG9ic2VydmVyLm9ic2VydmUobG9jYXRpb24sIHtcclxuICAgICAgICAgICAgY2hpbGRMaXN0OiB0cnVlLFxyXG4gICAgICAgICAgICBzdWJ0cmVlOiB0cnVlLFxyXG4gICAgICAgIH0pXHJcblxyXG4gICAgICAgIGlmICh0aW1lb3V0KSBzZXRUaW1lb3V0KCgpID0+IHJlcyhudWxsKSwgdGltZW91dClcclxuICAgIH0pXHJcblxyXG5leHBvcnQgY29uc3QgdHJhcEVsZW1lbnQgPSA8RSBleHRlbmRzIEVsZW1lbnQ+KFxyXG4gICAgc2VsZWN0b3I6IHN0cmluZyxcclxuICAgIGNhbGxiYWNrOiAoZWw6IEUgfCBudWxsLCBsYXN0RWw6IEUgfCBudWxsKSA9PiB2b2lkLFxyXG4gICAgbG9jYXRpb24gPSBkb2N1bWVudC5ib2R5LFxyXG4pID0+IHtcclxuICAgIGxldCBsYXN0RWw6IEUgfCBudWxsID0gbnVsbFxyXG5cclxuICAgIGNvbnN0IG9ic2VydmVyID0gbmV3IE11dGF0aW9uT2JzZXJ2ZXIoKCkgPT4ge1xyXG4gICAgICAgIGNvbnN0IGVsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcjxFPihzZWxlY3RvcilcclxuICAgICAgICBpZiAoZWwgIT09IGxhc3RFbCkgY2FsbGJhY2soZWwsIGxhc3RFbClcclxuICAgICAgICBsYXN0RWwgPSBlbFxyXG4gICAgfSlcclxuXHJcbiAgICBvYnNlcnZlci5vYnNlcnZlKGxvY2F0aW9uLCB7XHJcbiAgICAgICAgY2hpbGRMaXN0OiB0cnVlLFxyXG4gICAgICAgIHN1YnRyZWU6IHRydWUsXHJcbiAgICB9KVxyXG59XHJcblxyXG5leHBvcnQgY29uc3Qgc2xlZXAgPSAobXM6IG51bWJlcikgPT4gbmV3IFByb21pc2UocmVzb2x2ZSA9PiBzZXRUaW1lb3V0KHJlc29sdmUsIG1zKSlcclxuXHJcbmV4cG9ydCBjb25zdCBnZXRSZWFjdFByb3BzID0gKGVsZW1lbnQ6IEVsZW1lbnQpID0+XHJcbiAgICBlbGVtZW50W09iamVjdC5rZXlzKGVsZW1lbnQpLmZpbmQoayA9PiBrLnN0YXJ0c1dpdGgoXCJfX3JlYWN0UHJvcHMkXCIpKSBhcyBrZXlvZiB0eXBlb2YgZWxlbWVudF1cclxuXHJcbmV4cG9ydCBjb25zdCBpc0xpa2VkID0gKHVyaXM6IFNwb3RpZnlVUklbXSkgPT4gU3BpY2V0aWZ5LlBsYXRmb3JtLkxpYnJhcnlBUEkuY29udGFpbnMoLi4udXJpcykgYXMgUHJvbWlzZTxib29sZWFuW10+XHJcblxyXG5leHBvcnQgY29uc3Qgc2V0TGlrZWQgPSAodXJpczogU3BvdGlmeVVSSVtdLCBsaWtlZDogYm9vbGVhbikgPT5cclxuICAgIFNwaWNldGlmeS5QbGF0Zm9ybS5MaWJyYXJ5QVBJW2xpa2VkID8gXCJhZGRcIiA6IFwicmVtb3ZlXCJdKC4uLnVyaXMpXHJcblxyXG5leHBvcnQgY29uc3QgdG9nZ2xlTGlrZWQgPSBhc3luYyAodXJpczogU3BvdGlmeVVSSVtdKSA9PiB7XHJcbiAgICBjb25zdCBsaWtlZCA9IGF3YWl0IGlzTGlrZWQodXJpcylcclxuXHJcbiAgICByZXR1cm4gYXdhaXQgcChcclxuICAgICAgICB1cmlzLFxyXG4gICAgICAgIGEucmVkdWNlV2l0aEluZGV4KFxyXG4gICAgICAgICAgICBbW10gYXMgU3BvdGlmeVVSSVtdLCBbXSBhcyBTcG90aWZ5VVJJW11dIGFzIGNvbnN0LFxyXG4gICAgICAgICAgICAoaSwgYWNjLCB1cmkpID0+IChhY2NbTnVtYmVyKGxpa2VkW2ldKV0ucHVzaCh1cmkpLCBhY2MpLFxyXG4gICAgICAgICksXHJcbiAgICAgICAgKFt0b0FkZCwgdG9SZW1dKSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IHBzID0gW11cclxuICAgICAgICAgICAgaWYgKHRvQWRkLmxlbmd0aCkgcHMucHVzaChzZXRMaWtlZCh0b0FkZCwgdHJ1ZSkpXHJcbiAgICAgICAgICAgIGlmICh0b1JlbS5sZW5ndGgpIHBzLnB1c2goc2V0TGlrZWQodG9SZW0sIGZhbHNlKSlcclxuICAgICAgICAgICAgcmV0dXJuIFByb21pc2UuYWxsKHBzKVxyXG4gICAgICAgIH0sXHJcbiAgICApXHJcbn1cclxuXHJcbmV4cG9ydCBjb25zdCBjcmVhdGVRdWV1ZUl0ZW0gPSAocXVldWVkOiBib29sZWFuKSA9PiAodXJpOiBTcG90aWZ5VVJJKSA9PiAoe1xyXG4gICAgY29udGV4dFRyYWNrOiB7XHJcbiAgICAgICAgdXJpLFxyXG4gICAgICAgIHVpZDogXCJcIixcclxuICAgICAgICBtZXRhZGF0YToge1xyXG4gICAgICAgICAgICBpc19xdWV1ZWQ6IHF1ZXVlZC50b1N0cmluZygpLFxyXG4gICAgICAgIH0sXHJcbiAgICB9LFxyXG4gICAgcmVtb3ZlZDogW10sXHJcbiAgICBibG9ja2VkOiBbXSxcclxuICAgIHByb3ZpZGVyOiBxdWV1ZWQgPyBcInF1ZXVlXCIgOiBcImNvbnRleHRcIixcclxufSlcclxuXHJcbmV4cG9ydCBjb25zdCBzZXRRdWV1ZSA9IGFzeW5jIChuZXh0VHJhY2tzOiBBcnJheTxSZXR1cm5UeXBlPFJldHVyblR5cGU8dHlwZW9mIGNyZWF0ZVF1ZXVlSXRlbT4+PikgPT4ge1xyXG4gICAgY29uc3QgeyBfcXVldWUsIF9jbGllbnQgfSA9IFNwaWNldGlmeS5QbGF0Zm9ybS5QbGF5ZXJBUEkuX3F1ZXVlXHJcbiAgICBjb25zdCB7IHByZXZUcmFja3MsIHF1ZXVlUmV2aXNpb24gfSA9IF9xdWV1ZVxyXG5cclxuICAgIHJldHVybiBfY2xpZW50LnNldFF1ZXVlKHtcclxuICAgICAgICBuZXh0VHJhY2tzLFxyXG4gICAgICAgIHByZXZUcmFja3MsXHJcbiAgICAgICAgcXVldWVSZXZpc2lvbixcclxuICAgIH0pIGFzIFByb21pc2U8eyBlcnJvcjogbnVtYmVyOyByZWFzb25zOiBzdHJpbmcgfT5cclxufVxyXG5cclxuZXhwb3J0IGNvbnN0IHNldFBsYXlpbmdDb250ZXh0ID0gKHVyaTogU3BvdGlmeVVSSSkgPT4ge1xyXG4gICAgY29uc3QgeyBzZXNzaW9uSWQgfSA9IFNwaWNldGlmeS5QbGF0Zm9ybS5QbGF5ZXJBUEkuZ2V0U3RhdGUoKVxyXG4gICAgcmV0dXJuIFNwaWNldGlmeS5QbGF0Zm9ybS5QbGF5ZXJBUEkudXBkYXRlQ29udGV4dChzZXNzaW9uSWQsIHsgdXJpLCB1cmw6IFwiY29udGV4dDovL1wiICsgdXJpIH0pIGFzIFByb21pc2U8dW5kZWZpbmVkPlxyXG59XHJcbiIsCiAgIi8vIGV4cG9ydCBpbnRlcmZhY2UgU3BvdGlmeUlEXHJcbi8vICAgICBleHRlbmRzIE5ld3R5cGU8eyByZWFkb25seSBTcG90aWZ5SUQ6IHVuaXF1ZSBzeW1ib2wgfSwgc3RyaW5nPiB7fVxyXG4vLyBleHBvcnQgaW50ZXJmYWNlIFNwb3RpZnlVUklcclxuLy8gICAgIGV4dGVuZHMgTmV3dHlwZTx7IHJlYWRvbmx5IFNwb3RpZnlVUkk6IHVuaXF1ZSBzeW1ib2wgfSwgc3RyaW5nPiB7fVxyXG5cclxuaW1wb3J0IHsgYXJyYXkgYXMgYSB9IGZyb20gXCJmcC10c1wiXHJcbmltcG9ydCB7IGNvbnN0YW50LCBwaXBlIGFzIHAgfSBmcm9tIFwiZnAtdHMvZnVuY3Rpb25cIlxyXG5cclxuZXhwb3J0IGNvbnN0IG11c3RMb2FkRm9yQXBpID0gW1wiQ29zbW9zQXN5bmNcIiwgXCJHcmFwaFFMXCIsIFwiUGxhdGZvcm1cIl1cclxuZXhwb3J0IGNvbnN0IG11c3RMb2FkRm9yVXRpbCA9IFtcIlVSSVwiXVxyXG5leHBvcnQgY29uc3QgbXVzdExvYWRGb3JTZXR0aW5ncyA9IFtcIlJlYWN0XCIsIFwiUmVhY3RET01cIl1cclxuXHJcbmV4cG9ydCB0eXBlIFNwb3RpZnlJRCA9IHN0cmluZ1xyXG5leHBvcnQgdHlwZSBTcG90aWZ5VVJJID0gc3RyaW5nXHJcblxyXG5leHBvcnQgdHlwZSBTcG90aWZ5TG9jID0ge1xyXG4gICAgYmVmb3JlPzogXCJzdGFydFwiIHwgeyB1cmk6IFNwb3RpZnlVUkkgfSB8IHsgdWlkOiBzdHJpbmcgfVxyXG4gICAgYWZ0ZXI/OiBcImVuZFwiIHwgeyB1cmk6IFNwb3RpZnlVUkkgfSB8IHsgdWlkOiBzdHJpbmcgfVxyXG59XHJcblxyXG5leHBvcnQgbmFtZXNwYWNlIFNwb3RpZnlMb2Mge1xyXG4gICAgZXhwb3J0IG5hbWVzcGFjZSBiZWZvcmUge1xyXG4gICAgICAgIGV4cG9ydCBjb25zdCBzdGFydCA9IGNvbnN0YW50KHsgYmVmb3JlOiBcInN0YXJ0XCIgfSBhcyBTcG90aWZ5TG9jKVxyXG5cclxuICAgICAgICBleHBvcnQgY29uc3QgZnJvbVVyaSA9ICh1cmk6IFNwb3RpZnlVUkkpID0+ICh7XHJcbiAgICAgICAgICAgIGJlZm9yZTogeyB1cmkgfSxcclxuICAgICAgICB9KVxyXG5cclxuICAgICAgICBleHBvcnQgY29uc3QgZnJvbVVpZCA9ICh1aWQ6IHN0cmluZykgPT4gKHtcclxuICAgICAgICAgICAgYmVmb3JlOiB7IHVpZCB9LFxyXG4gICAgICAgIH0pXHJcbiAgICB9XHJcblxyXG4gICAgZXhwb3J0IG5hbWVzcGFjZSBhZnRlciB7XHJcbiAgICAgICAgZXhwb3J0IGNvbnN0IGVuZCA9IGNvbnN0YW50KHsgYWZ0ZXI6IFwiZW5kXCIgfSBhcyBTcG90aWZ5TG9jKVxyXG5cclxuICAgICAgICBleHBvcnQgY29uc3QgZnJvbVVyaSA9ICh1cmk6IFNwb3RpZnlVUkkpID0+ICh7XHJcbiAgICAgICAgICAgIGJlZm9yZTogeyB1cmkgfSxcclxuICAgICAgICB9KVxyXG5cclxuICAgICAgICBleHBvcnQgY29uc3QgZnJvbVVpZCA9ICh1aWQ6IHN0cmluZykgPT4gKHtcclxuICAgICAgICAgICAgYmVmb3JlOiB7IHVpZCB9LFxyXG4gICAgICAgIH0pXHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBjb25zdCBlc2NhcGVSZWdleCA9IChzdHI6IHN0cmluZykgPT4gc3RyLnJlcGxhY2UoL1suKis/XiR7fSgpfFtcXF1cXFxcXS9nLCBgXFxcXCQmYClcclxuXHJcbmV4cG9ydCBjb25zdCB0aXRsZUNhc2UgPSAoc3RyOiBzdHJpbmcpID0+IHN0ci5yZXBsYWNlKC9cXGJcXHcvZywgbCA9PiBsLnRvVXBwZXJDYXNlKCkpXHJcblxyXG5leHBvcnQgY29uc3Qgbm9ybWFsaXplU3RyID0gKHN0cjogc3RyaW5nKSA9PlxyXG4gICAgc3RyXHJcbiAgICAgICAgLm5vcm1hbGl6ZShcIk5GS0RcIilcclxuICAgICAgICAucmVwbGFjZSgvXFwoLipcXCkvZywgXCJcIilcclxuICAgICAgICAucmVwbGFjZSgvXFxbLipcXF0vZywgXCJcIilcclxuICAgICAgICAucmVwbGFjZSgvLV8sL2csIFwiIFwiKVxyXG4gICAgICAgIC5yZXBsYWNlKC9bXmEtekEtWjAtOSBdL2csIFwiXCIpXHJcbiAgICAgICAgLnJlcGxhY2UoL1xccysvZywgXCIgXCIpXHJcbiAgICAgICAgLnRvTG93ZXJDYXNlKClcclxuICAgICAgICAudHJpbSgpXHJcblxyXG4vLyEgRG9lcyBsb2NhdGlvbiBhY3R1YWxseSBwb2ludCB0byBkb2N1bWVudC5ib2R5P1xyXG5leHBvcnQgY29uc3Qgd2FpdEZvckVsZW1lbnQgPSA8RSBleHRlbmRzIEVsZW1lbnQ+KFxyXG4gICAgc2VsZWN0b3I6IHN0cmluZyxcclxuICAgIHRpbWVvdXQgPSAxMDAwLFxyXG4gICAgbG9jYXRpb24gPSBkb2N1bWVudC5ib2R5LFxyXG4gICAgbm90RWw/OiBFLFxyXG4pID0+XHJcbiAgICBuZXcgUHJvbWlzZSgocmVzb2x2ZTogKHZhbHVlOiBFbGVtZW50IHwgbnVsbCkgPT4gdm9pZCkgPT4ge1xyXG4gICAgICAgIGNvbnN0IHJlcyA9ICh2OiBhbnkpID0+IHtcclxuICAgICAgICAgICAgb2JzZXJ2ZXIuZGlzY29ubmVjdCgpXHJcbiAgICAgICAgICAgIHJlc29sdmUodilcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGNvbnN0IG9ic2VydmVyID0gbmV3IE11dGF0aW9uT2JzZXJ2ZXIoKCkgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBlbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3I8RT4oc2VsZWN0b3IpXHJcbiAgICAgICAgICAgIGlmIChlbCAmJiAoIW5vdEVsIHx8IGVsICE9PSBub3RFbCkpIHJldHVybiByZXMoZWwpXHJcbiAgICAgICAgfSlcclxuXHJcbiAgICAgICAgb2JzZXJ2ZXIub2JzZXJ2ZShsb2NhdGlvbiwge1xyXG4gICAgICAgICAgICBjaGlsZExpc3Q6IHRydWUsXHJcbiAgICAgICAgICAgIHN1YnRyZWU6IHRydWUsXHJcbiAgICAgICAgfSlcclxuXHJcbiAgICAgICAgaWYgKHRpbWVvdXQpIHNldFRpbWVvdXQoKCkgPT4gcmVzKG51bGwpLCB0aW1lb3V0KVxyXG4gICAgfSlcclxuXHJcbmV4cG9ydCBjb25zdCB0cmFwRWxlbWVudCA9IDxFIGV4dGVuZHMgRWxlbWVudD4oXHJcbiAgICBzZWxlY3Rvcjogc3RyaW5nLFxyXG4gICAgY2FsbGJhY2s6IChlbDogRSB8IG51bGwsIGxhc3RFbDogRSB8IG51bGwpID0+IHZvaWQsXHJcbiAgICBsb2NhdGlvbiA9IGRvY3VtZW50LmJvZHksXHJcbikgPT4ge1xyXG4gICAgbGV0IGxhc3RFbDogRSB8IG51bGwgPSBudWxsXHJcblxyXG4gICAgY29uc3Qgb2JzZXJ2ZXIgPSBuZXcgTXV0YXRpb25PYnNlcnZlcigoKSA9PiB7XHJcbiAgICAgICAgY29uc3QgZWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yPEU+KHNlbGVjdG9yKVxyXG4gICAgICAgIGlmIChlbCAhPT0gbGFzdEVsKSBjYWxsYmFjayhlbCwgbGFzdEVsKVxyXG4gICAgICAgIGxhc3RFbCA9IGVsXHJcbiAgICB9KVxyXG5cclxuICAgIG9ic2VydmVyLm9ic2VydmUobG9jYXRpb24sIHtcclxuICAgICAgICBjaGlsZExpc3Q6IHRydWUsXHJcbiAgICAgICAgc3VidHJlZTogdHJ1ZSxcclxuICAgIH0pXHJcbn1cclxuXHJcbmV4cG9ydCBjb25zdCBzbGVlcCA9IChtczogbnVtYmVyKSA9PiBuZXcgUHJvbWlzZShyZXNvbHZlID0+IHNldFRpbWVvdXQocmVzb2x2ZSwgbXMpKVxyXG5cclxuZXhwb3J0IGNvbnN0IGdldFJlYWN0UHJvcHMgPSAoZWxlbWVudDogRWxlbWVudCkgPT5cclxuICAgIGVsZW1lbnRbT2JqZWN0LmtleXMoZWxlbWVudCkuZmluZChrID0+IGsuc3RhcnRzV2l0aChcIl9fcmVhY3RQcm9wcyRcIikpIGFzIGtleW9mIHR5cGVvZiBlbGVtZW50XVxyXG5cclxuZXhwb3J0IGNvbnN0IGlzTGlrZWQgPSAodXJpczogU3BvdGlmeVVSSVtdKSA9PiBTcGljZXRpZnkuUGxhdGZvcm0uTGlicmFyeUFQSS5jb250YWlucyguLi51cmlzKSBhcyBQcm9taXNlPGJvb2xlYW5bXT5cclxuXHJcbmV4cG9ydCBjb25zdCBzZXRMaWtlZCA9ICh1cmlzOiBTcG90aWZ5VVJJW10sIGxpa2VkOiBib29sZWFuKSA9PlxyXG4gICAgU3BpY2V0aWZ5LlBsYXRmb3JtLkxpYnJhcnlBUElbbGlrZWQgPyBcImFkZFwiIDogXCJyZW1vdmVcIl0oLi4udXJpcylcclxuXHJcbmV4cG9ydCBjb25zdCB0b2dnbGVMaWtlZCA9IGFzeW5jICh1cmlzOiBTcG90aWZ5VVJJW10pID0+IHtcclxuICAgIGNvbnN0IGxpa2VkID0gYXdhaXQgaXNMaWtlZCh1cmlzKVxyXG5cclxuICAgIHJldHVybiBhd2FpdCBwKFxyXG4gICAgICAgIHVyaXMsXHJcbiAgICAgICAgYS5yZWR1Y2VXaXRoSW5kZXgoXHJcbiAgICAgICAgICAgIFtbXSBhcyBTcG90aWZ5VVJJW10sIFtdIGFzIFNwb3RpZnlVUklbXV0gYXMgY29uc3QsXHJcbiAgICAgICAgICAgIChpLCBhY2MsIHVyaSkgPT4gKGFjY1tOdW1iZXIobGlrZWRbaV0pXS5wdXNoKHVyaSksIGFjYyksXHJcbiAgICAgICAgKSxcclxuICAgICAgICAoW3RvQWRkLCB0b1JlbV0pID0+IHtcclxuICAgICAgICAgICAgY29uc3QgcHMgPSBbXVxyXG4gICAgICAgICAgICBpZiAodG9BZGQubGVuZ3RoKSBwcy5wdXNoKHNldExpa2VkKHRvQWRkLCB0cnVlKSlcclxuICAgICAgICAgICAgaWYgKHRvUmVtLmxlbmd0aCkgcHMucHVzaChzZXRMaWtlZCh0b1JlbSwgZmFsc2UpKVxyXG4gICAgICAgICAgICByZXR1cm4gUHJvbWlzZS5hbGwocHMpXHJcbiAgICAgICAgfSxcclxuICAgIClcclxufVxyXG5cclxuZXhwb3J0IGNvbnN0IGNyZWF0ZVF1ZXVlSXRlbSA9IChxdWV1ZWQ6IGJvb2xlYW4pID0+ICh1cmk6IFNwb3RpZnlVUkkpID0+ICh7XHJcbiAgICBjb250ZXh0VHJhY2s6IHtcclxuICAgICAgICB1cmksXHJcbiAgICAgICAgdWlkOiBcIlwiLFxyXG4gICAgICAgIG1ldGFkYXRhOiB7XHJcbiAgICAgICAgICAgIGlzX3F1ZXVlZDogcXVldWVkLnRvU3RyaW5nKCksXHJcbiAgICAgICAgfSxcclxuICAgIH0sXHJcbiAgICByZW1vdmVkOiBbXSxcclxuICAgIGJsb2NrZWQ6IFtdLFxyXG4gICAgcHJvdmlkZXI6IHF1ZXVlZCA/IFwicXVldWVcIiA6IFwiY29udGV4dFwiLFxyXG59KVxyXG5cclxuZXhwb3J0IGNvbnN0IHNldFF1ZXVlID0gYXN5bmMgKG5leHRUcmFja3M6IEFycmF5PFJldHVyblR5cGU8UmV0dXJuVHlwZTx0eXBlb2YgY3JlYXRlUXVldWVJdGVtPj4+KSA9PiB7XHJcbiAgICBjb25zdCB7IF9xdWV1ZSwgX2NsaWVudCB9ID0gU3BpY2V0aWZ5LlBsYXRmb3JtLlBsYXllckFQSS5fcXVldWVcclxuICAgIGNvbnN0IHsgcHJldlRyYWNrcywgcXVldWVSZXZpc2lvbiB9ID0gX3F1ZXVlXHJcblxyXG4gICAgcmV0dXJuIF9jbGllbnQuc2V0UXVldWUoe1xyXG4gICAgICAgIG5leHRUcmFja3MsXHJcbiAgICAgICAgcHJldlRyYWNrcyxcclxuICAgICAgICBxdWV1ZVJldmlzaW9uLFxyXG4gICAgfSkgYXMgUHJvbWlzZTx7IGVycm9yOiBudW1iZXI7IHJlYXNvbnM6IHN0cmluZyB9PlxyXG59XHJcblxyXG5leHBvcnQgY29uc3Qgc2V0UGxheWluZ0NvbnRleHQgPSAodXJpOiBTcG90aWZ5VVJJKSA9PiB7XHJcbiAgICBjb25zdCB7IHNlc3Npb25JZCB9ID0gU3BpY2V0aWZ5LlBsYXRmb3JtLlBsYXllckFQSS5nZXRTdGF0ZSgpXHJcbiAgICByZXR1cm4gU3BpY2V0aWZ5LlBsYXRmb3JtLlBsYXllckFQSS51cGRhdGVDb250ZXh0KHNlc3Npb25JZCwgeyB1cmksIHVybDogXCJjb250ZXh0Oi8vXCIgKyB1cmkgfSkgYXMgUHJvbWlzZTx1bmRlZmluZWQ+XHJcbn1cclxuIiwKICAiKGFzeW5jICgpID0+IHtcbiAgICBjb25zdCBpZCA9IFwiUUw5RERrN1c0Q3ZkM1NaeFlWZnRDRlVZSjM0T09PTVlKaHEzUExBdS1MQVwiXG4gICAgaWYgKCFkb2N1bWVudC5nZXRFbGVtZW50QnlJZChpZCkpIHtcbiAgICAgICAgY29uc3QgZWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwic3R5bGVcIilcbiAgICAgICAgZWwuaWQgPSBpZFxuICAgICAgICBlbC50ZXh0Q29udGVudCA9IFwiI3NuZWFrLW92ZXJsYXkge1xcbiAgei1pbmRleDogMTAwMDAwO1xcbiAgcG9zaXRpb246IGFic29sdXRlO1xcbiAgd2lkdGg6IDEwMCU7XFxuICBoZWlnaHQ6IDEwMCU7XFxuICBkaXNwbGF5OiBub25lO1xcbn1cXG4jc25lYWstb3ZlcmxheSA+IC5zbmVhay1rZXkge1xcbiAgcG9zaXRpb246IGZpeGVkO1xcbiAgcGFkZGluZzogM3B4IDZweDtcXG4gIGJhY2tncm91bmQtY29sb3I6IGJsYWNrO1xcbiAgYm9yZGVyLXJhZGl1czogM3B4O1xcbiAgYm9yZGVyOiBzb2xpZCAycHggd2hpdGU7XFxuICBjb2xvcjogd2hpdGU7XFxuICB0ZXh0LXRyYW5zZm9ybTogbG93ZXJjYXNlO1xcbiAgbGluZS1oZWlnaHQ6IG5vcm1hbDtcXG4gIGZvbnQtc2l6ZTogMTRweDtcXG4gIGZvbnQtd2VpZ2h0OiA1MDA7XFxufVwiXG4gICAgICAgIGRvY3VtZW50LmhlYWQuYXBwZW5kQ2hpbGQoZWwpXG4gICAgfVxufSkoKSIsCiAgImltcG9ydCB7IGVudGVyU25lYWssIGtleUxpc3QsIGxpc3RlblNuZWFrS2V5cywgbW91c2V0cmFwLCBxdWl0U25lYWsgfSBmcm9tIFwiLi9zbmVha1wiXHJcbmltcG9ydCB7IEJpbmQsIGFwcFNjcm9sbCwgYXBwU2Nyb2xsWSwgb3BlblBhZ2UsIHJvdGF0ZVNpZGViYXIgfSBmcm9tIFwiLi91dGlsXCJcclxuaW1wb3J0IHsgdG9nZ2xlTGlrZWQgfSBmcm9tIFwiLi4vLi4vc2hhcmVkL3V0aWxcIlxyXG5cclxuaW1wb3J0IFwiLi9hc3NldHMvc3R5bGVzLnNjc3NcIlxyXG5cclxuY29uc3QgeyBLRVlTIH0gPSBTcGljZXRpZnkuS2V5Ym9hcmRcclxuXHJcbmNvbnN0IGJpbmRzID0gW1xyXG4gICAgbmV3IEJpbmQoXCJzXCIsIGVudGVyU25lYWspLFxyXG4gICAgbmV3IEJpbmQoXCJzXCIsIGFzeW5jICgpID0+IHtcclxuICAgICAgICAvLyBwcm9kdWN0X3N0YXRlIHdhcyByZW5hbWVkIHRvIHByb2R1Y3Rfc3RhdGVfc2VydmljZSBpbiBTcG90aWZ5IDEuMi4yMVxyXG4gICAgICAgIGNvbnN0IHByb2R1Y3RTdGF0ZSA9XHJcbiAgICAgICAgICAgIFNwaWNldGlmeS5QbGF0Zm9ybS5Vc2VyQVBJLl9wcm9kdWN0X3N0YXRlIHx8IFNwaWNldGlmeS5QbGF0Zm9ybS5Vc2VyQVBJLl9wcm9kdWN0X3N0YXRlX3NlcnZpY2VcclxuICAgICAgICBhd2FpdCBwcm9kdWN0U3RhdGUucHV0VmFsdWVzKHsgcGFpcnM6IHsgXCJhcHAtZGV2ZWxvcGVyXCI6IFwiMlwiIH0gfSlcclxuICAgICAgICBTcGljZXRpZnkuUGxhdGZvcm0uVXBkYXRlQVBJLmFwcGx5VXBkYXRlKClcclxuICAgIH0pLnNldFNoaWZ0KHRydWUpLFxyXG4gICAgbmV3IEJpbmQoXCJ0YWJcIiwgKCkgPT4gcm90YXRlU2lkZWJhcigxKSksXHJcbiAgICBuZXcgQmluZChcInRhYlwiLCAoKSA9PiByb3RhdGVTaWRlYmFyKC0xKSkuc2V0U2hpZnQodHJ1ZSksXHJcbiAgICBuZXcgQmluZChcImhcIiwgU3BpY2V0aWZ5LlBsYXRmb3JtLkhpc3RvcnkuZ29CYWNrKS5zZXRTaGlmdCh0cnVlKSxcclxuICAgIG5ldyBCaW5kKFwibFwiLCBTcGljZXRpZnkuUGxhdGZvcm0uSGlzdG9yeS5nb0ZvcndhcmQpLnNldFNoaWZ0KHRydWUpLFxyXG4gICAgbmV3IEJpbmQoXCJqXCIsICgpID0+IGFwcFNjcm9sbCgxKSksXHJcbiAgICBuZXcgQmluZChcImtcIiwgKCkgPT4gYXBwU2Nyb2xsKC0xKSksXHJcbiAgICBuZXcgQmluZChcImdcIiwgKCkgPT4gYXBwU2Nyb2xsWSgwKSksXHJcbiAgICBuZXcgQmluZChcImdcIiwgKCkgPT4gYXBwU2Nyb2xsWShOdW1iZXIuTUFYX1NBRkVfSU5URUdFUikpLnNldFNoaWZ0KHRydWUpLFxyXG4gICAgbmV3IEJpbmQoXCJtXCIsICgpID0+IHRvZ2dsZUxpa2VkKFtTcGljZXRpZnkuUGxheWVyLmRhdGEuaXRlbS51cmldKSksXHJcbiAgICBuZXcgQmluZChcIi9cIiwgZSA9PiB7XHJcbiAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpXHJcbiAgICAgICAgb3BlblBhZ2UoXCIvc2VhcmNoXCIpXHJcbiAgICB9KSxcclxuXVxyXG5cclxuYmluZHMubWFwKGJpbmQgPT4gYmluZC5yZWdpc3RlcigpKVxyXG5cclxubW91c2V0cmFwLmJpbmQoa2V5TGlzdCwgbGlzdGVuU25lYWtLZXlzLCBcImtleXByZXNzXCIpXHJcbm1vdXNldHJhcC5iaW5kKEtFWVMuRVNDQVBFLCBxdWl0U25lYWspXHJcbiIKICBdLAogICJtYXBwaW5ncyI6ICJBQTJITyxTQUFTLENBQVEsQ0FBQyxFQUFHLENBQ3hCLE9BQU8sRUFTSixTQUFTLENBQVEsQ0FBQyxFQUFHLENBQ3hCLGVBQWdCLEVBQUcsQ0FBRSxPQUFPLEdBZ0N6QixTQUFTLEVBQUksQ0FBQyxFQUFHLENBQ3BCLGVBQWdCLEVBQUcsQ0FDZixJQUFJLEVBQU8sQ0FBQyxFQUNaLFFBQVMsRUFBSyxFQUFHLEVBQUssVUFBVSxPQUFRLElBQ3BDLEVBQUssR0FBTSxVQUFVLEdBRXpCLEdBQUksRUFBSyxPQUFTLEVBQ2QsT0FBTyxFQUFFLEVBQUssR0FBSSxFQUFLLEVBQUUsRUFFN0IsZUFBZ0IsQ0FBQyxFQUFHLENBQUUsT0FBTyxFQUFFLENBQUMsRUFBRSxFQUFLLEVBQUUsSUFHMUMsU0FBUyxDQUFJLENBQUMsRUFBSSxFQUFJLEVBQUksRUFBSSxFQUFJLEVBQUksRUFBSSxFQUFJLEVBQUksQ0FDckQsT0FBUSxVQUFVLGFBQ1QsRUFDRCxPQUFPLE9BQ04sRUFDRCxlQUFnQixFQUFHLENBQ2YsT0FBTyxFQUFHLEVBQUcsTUFBTSxLQUFNLFNBQVMsQ0FBQyxRQUV0QyxFQUNELGVBQWdCLEVBQUcsQ0FDZixPQUFPLEVBQUcsRUFBRyxFQUFHLE1BQU0sS0FBTSxTQUFTLENBQUMsQ0FBQyxRQUUxQyxFQUNELGVBQWdCLEVBQUcsQ0FDZixPQUFPLEVBQUcsRUFBRyxFQUFHLEVBQUcsTUFBTSxLQUFNLFNBQVMsQ0FBQyxDQUFDLENBQUMsUUFFOUMsRUFDRCxlQUFnQixFQUFHLENBQ2YsT0FBTyxFQUFHLEVBQUcsRUFBRyxFQUFHLEVBQUcsTUFBTSxLQUFNLFNBQVMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxRQUVsRCxFQUNELGVBQWdCLEVBQUcsQ0FDZixPQUFPLEVBQUcsRUFBRyxFQUFHLEVBQUcsRUFBRyxFQUFHLE1BQU0sS0FBTSxTQUFTLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxRQUV0RCxFQUNELGVBQWdCLEVBQUcsQ0FDZixPQUFPLEVBQUcsRUFBRyxFQUFHLEVBQUcsRUFBRyxFQUFHLEVBQUcsTUFBTSxLQUFNLFNBQVMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsUUFFMUQsRUFDRCxlQUFnQixFQUFHLENBQ2YsT0FBTyxFQUFHLEVBQUcsRUFBRyxFQUFHLEVBQUcsRUFBRyxFQUFHLEVBQUcsTUFBTSxLQUFNLFNBQVMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxRQUU5RCxFQUNELGVBQWdCLEVBQUcsQ0FDZixPQUFPLEVBQUcsRUFBRyxFQUFHLEVBQUcsRUFBRyxFQUFHLEVBQUcsRUFBRyxFQUFHLE1BQU0sS0FBTSxTQUFTLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxHQUczRUFDdk5KLElBQUksV0FBeUQsQ0FBQyxFQUFJLEVBQU0sRUFBTSxDQUMxRSxHQUFJLEdBQVEsVUFBVSxTQUFXLEdBQUcsUUFBUyxFQUFJLEVBQUcsRUFBSSxFQUFLLE9BQVEsRUFBSSxFQUFJLEVBQUcsSUFDNUUsR0FBSSxLQUFRLEtBQUssR0FBTyxDQUNwQixJQUFLLEVBQUksRUFBSyxNQUFNLFVBQVUsTUFBTSxLQUFLLEVBQU0sRUFBRyxDQUFDLEVBQ25ELEVBQUcsR0FBSyxFQUFLLElBR3JCLE9BQU8sRUFBRyxPQUFPLEdBQU0sTUFBTSxVQUFVLE1BQU0sS0FBSyxDQUFJLENBQUMsR0FPaEQsV0FBa0IsQ0FBQyxFQUFJLENBQUUsT0FBTyxFQUFHLE9BQVMsUUFFNUMsVUFBa0IsQ0FBQyxFQUFJLENBQUUsT0FBTyxFQUFHLE9BQVMsUUFFNUMsRUFBTyxDQUFFLEtBQU0sTUFBTyxFQUV0QixVQUFnQixDQUFDLEVBQUcsQ0FBRSxNQUFRLENBQUUsS0FBTSxPQUFRLE1BQU8sQ0FBRSxHQUt2RCxXQUFrQixDQUFDLEVBQUksQ0FBRSxPQUFPLEVBQUcsT0FBU0FDcUJoRCxTQUFTLENBQU8sQ0FBQyxFQUFHLENBQ3ZCLGVBQWdCLENBQUMsRUFBUSxDQUFFLGVBQWdCLENBQUMsRUFBTyxDQUMvQyxPQUFPLEVBQUUsR0FBRyxFQUFFLElBQUksVUFBZ0IsQ0FBQyxFQUFHLENBQUUsZUFBZ0IsRUFBRyxDQUFFLE9BQU8sR0FBTyxFQUFHLENBQU0sSUFHckYsU0FBUyxDQUFRLENBQUMsRUFBRyxDQUN4QixlQUFnQixDQUFDLEVBQVEsQ0FDckIsZUFBZ0IsQ0FBQyxFQUFPLENBQ3BCLE9BQU8sRUFBRSxHQUFHLEVBQUUsSUFBSSxVQUFnQixFQUFHLENBQUUsZUFBZ0IsQ0FBQyxFQUFHLENBQUUsT0FBTyxHQUFPLEVBQUcsQ0FBTSxJQUl6RixTQUFTLENBQUcsQ0FBQyxFQUFHLENBQ25CLGVBQWdCLENBQUMsRUFBTSxFQUFJLENBQ3ZCLGVBQWdCLENBQUMsRUFBSSxDQUNqQixPQUFPLEVBQUUsR0FBRyxFQUFFLElBQUksVUFBYSxDQUFDLEVBQUcsQ0FBRSxlQUFnQixDQUFDLEVBQUcsQ0FDckQsSUFBSSxFQUNKLE9BQU8sT0FBTyxPQUFPLENBQUMsRUFBRyxHQUFJLEVBQUssQ0FBQyxFQUFHLEVBQUcsR0FBUSxFQUFHLEVBQUcsR0FDdkQsRUFBRyxDQUFFQUMvQ2QsU0FBUyxFQUFJLENBQUMsRUFBRyxDQUNwQixlQUFnQixDQUFDLEVBQUcsQ0FBRSxlQUFnQixDQUFDLEVBQUssQ0FBRSxPQUFPLEVBQUUsSUFBSSxVQUFjLENBQUMsRUFBRyxDQUFFLE9BQU8sRUFBRSxDQUFDLEVBQUksSUFFMUYsU0FBUyxDQUFNLENBQUMsRUFBRyxDQUN0QixlQUFnQixDQUFDLEVBQU0sQ0FBRSxlQUFnQixDQUFDLEVBQUksQ0FBRSxPQUFPLEVBQUUsSUFBSSxVQUFhLENBQUMsRUFBRyxDQUMxRSxJQUFJLEVBQ0osT0FBUSxFQUFLLENBQUMsRUFBRyxFQUFHLEdBQVEsRUFBRyxFQUNsQyxJQUVMLElBQVMsVUFBSSxDQUFDLEVBQUcsQ0FDYixlQUFnQixDQUFDLEVBQU0sRUFBRyxDQUFFLGVBQWdCLENBQUMsRUFBSSxDQUFFLE9BQU8sRUFBRSxJQUFJLFVBQWEsQ0FBQyxFQUFHLENBQzdFLElBQUksRUFDSixPQUFPLE9BQU8sT0FBTyxDQUFDLEVBQUcsR0FBSSxFQUFLLENBQUMsRUFBRyxFQUFHLEdBQVEsRUFBRSxDQUFDLEVBQUcsRUFBRyxFQUM3REFDOUJFLFNBQVMsRUFBVSxDQUFDLEVBQUcsQ0FDMUIsSUFBSSxFQUFPLEdBQUksQ0FBQyxFQUNoQixlQUFnQixDQUFDLEVBQUcsQ0FBRSxlQUFnQixDQUFDLEVBQU8sQ0FBRSxPQUFPLEVBQUssRUFBTyxDQUFDLElBR2pFLFNBQVMsRUFBRyxDQUFDLEVBQUcsQ0FDbkIsZUFBZ0IsQ0FBQyxFQUFPLEVBQUcsQ0FBRSxPQUFPLEVBQUUsTUFBTSxVQUFnQixDQUFDLEVBQUcsQ0FBRSxPQUFPLEVBQUUsSUFBSSxFQUFFLENBQUMsVUFBWSxFQUFHLENBQUUsT0FBTyxFQUFJLEVBQUksR0FFL0csU0FBUyxDQUFJLENBQUMsRUFBRyxDQUNwQixlQUFnQixDQUFDLEVBQU0sRUFBRyxDQUFFLGVBQWdCLENBQUMsRUFBSSxDQUFFLE9BQU8sRUFBRSxNQUFNLFVBQWEsQ0FBQyxFQUFHLENBQUUsT0FBTyxFQUFFLElBQUksRUFBRSxDQUFDLFVBQVksQ0FBQyxFQUFHLENBQ2pILElBQUksRUFDSixPQUFPLE9BQU8sT0FBTyxDQUFDLEVBQUcsR0FBSSxFQUFLLENBQUMsRUFBRyxFQUFHLEdBQVEsRUFBRyxFQUFHLEVBQzFELEVBQUlBQ29CRixTQUFTLEVBQVcsQ0FBQyxFQUFHLENBQzNCLGVBQWdCLENBQUMsRUFBRyxDQUFFLE9BQU8sRUFBSyxFQUFHLEVBQUUsVUFBVUFDekI5QyxJQUFJLFdBQXNCLENBQUMsRUFBUSxDQUFFLE1BQVEsQ0FDaEQsZUFBaUIsQ0FBQyxFQUFHLEVBQUcsQ0FBRSxPQUFPLElBQU0sR0FBSyxFQUFPLEVBQUcsQ0FBQyxFQUMzREFDMFhBLElBQVMsV0FBTyxDQUFDLEVBQU8sRUFBUSxDQUM1QixPQUFPLEVBQVEsR0FBUyxFQUFLLEVBQVEsRUFBUyxFQUFJLEdBNVgzQyxXQUF5QixDQUFDLEVBQVMsQ0FDMUMsZUFBZ0IsQ0FBQyxFQUFPLEVBQVEsQ0FDNUIsT0FBTyxJQUFVLEdBQVUsRUFBUSxFQUFPLENBQU0sSUFBTSxJQVVuRCxXQUF1QixDQUFDLEVBQVMsQ0FBRSxNQUFRLENBQ2xELE9BQVEsR0FBYyxDQUFPLEVBQzdCLGdCQUFrQixDQUFDLEVBQU8sRUFBUSxDQUFFLE9BQVEsSUFBVSxFQUFTLEVBQUksRUFBUSxFQUFPLENBQU0sRUFDNUZBQzRDTyxJQUFJLFdBQXFCLENBQUMsRUFBRyxDQUNoQyxlQUFnQixDQUFDLEVBQVcsQ0FDeEIsZUFBZ0IsQ0FBQyxFQUFJLENBQ2pCLE9BQU8sRUFBRyxlQUFnQixDQUFDLEVBQUcsRUFBSyxDQUFFLE9BQU8sRUFBRSxPQUFPLEVBQUcsQ0FBRyxHQUFNLENBQVNBQ1gvRSxJQUFJLFdBQWUsQ0FBQyxFQUFHLENBQUUsTUFBUSxDQUNwQyxPQUFXLEdBQUksQ0FBQyxDQUNwQixHQWVXLFdBQWUsQ0FBQyxFQUFHLENBQUUsTUFBUSxDQUNwQyxPQUFXLEdBQUksQ0FBQyxDQUNwQixHQUtXLFdBQW9CLENBQUMsRUFBRyxDQUFFLE1BQVEsQ0FDekMsZUFBaUIsRUFBRyxDQUFFLE9BQU8sRUFDakNBQ3RGQSxJQUFJLFdBQXlELENBQUMsRUFBSSxFQUFNLEVBQU0sQ0FDMUUsR0FBSSxHQUFRLFVBQVUsU0FBVyxHQUFHLFFBQVMsRUFBSSxFQUFHLEVBQUksRUFBSyxPQUFRLEVBQUksRUFBSSxFQUFHLElBQzVFLEdBQUksS0FBUSxLQUFLLEdBQU8sQ0FDcEIsSUFBSyxFQUFJLEVBQUssTUFBTSxVQUFVLE1BQU0sS0FBSyxFQUFNLEVBQUcsQ0FBQyxFQUNuRCxFQUFHLEdBQUssRUFBSyxJQUdyQixPQUFPLEVBQUcsT0FBTyxHQUFNLE1BQU0sVUFBVSxNQUFNLEtBQUssQ0FBSSxDQUFDQUMwUXBELFNBQVMsRUFBTSxDQUFDLEVBQUcsRUFBRyxDQUN6QixPQUFPLEVBQUksRUFBRSxPQUFPLENBQUMsVUFBYSxDQUFDLEVBQUcsQ0FBRSxPQUFPLEVBQUUsT0FBTyxDQUFDMFRDM1F0RCxJQUFJLFdBQW9CLENBQUMsRUFBRyxDQUFFLGNBQWMsSUFBTSxVQVE5QyxHQUFLLENBQ1osZUFBaUIsQ0FBQyxFQUFPLEVBQVEsQ0FBRSxPQUFPLElBQVUsRUFDeEQsRUFLVyxFQUFNLENBQ2IsT0FBUSxHQUFHLE9BQ1gsZ0JBQWtCLENBQUMsRUFBTyxFQUFRLENBQUUsT0FBUSxFQUFRLEdBQVMsRUFBSyxFQUFRLEVBQVMsRUFBSSxFQUMzRixFQUtXLEdBQVUsQ0FDakIsT0FBUSxHQUFHLE9BQ1gsUUFBUyxFQUFJLFFBQ2IsSUFBSyxTQUNMLE9BQVEsV0FDWixFQUtXLEdBQU8sQ0FDZCxhQUFlLENBQUMsRUFBRyxDQUFFLE9BQU8sS0FBSyxVQUFVLENBQUMsRUFDaEQsRUFLVyxHQUFXLENBQ2xCLGVBQWlCLENBQUMsRUFBTyxFQUFRLENBQUUsT0FBTyxFQUFRLEVBQ3RELEVBWVcsR0FBZSxDQUN0QixlQUFpQixDQUFDLEVBQU8sRUFBUSxDQUFFLE9BQU8sRUFBUSxFQUN0RCxFQVlXLEdBQW1CLENBQzFCLGVBQWlCLENBQUMsRUFBTyxFQUFRLENBQUUsT0FBTyxFQUFRLEVBQ3RELEVBY1csR0FBWSxDQUNuQixPQUFRLEdBQWEsT0FDckIsTUFBTyxDQUNYLEVBY1csR0FBZ0IsQ0FDdkIsT0FBUSxHQUFpQixPQUN6QixNQUFPLENBQ1gsRUFLVyxHQUFRLENBQ2YsSUFBSyxHQUFhLE9BQ2xCLEtBQU0sRUFDTixJQUFLLEdBQWlCLE9BQ3RCLElBQUssRUFDTCxJQUFLLEdBQVMsT0FDZCxlQUFpQixDQUFDLEVBQUcsQ0FBRSxPQUFPLEdBQzlCLFlBQWMsQ0FBQyxFQUFPLEVBQVEsQ0FBRSxPQUFPLEVBQVEsR0FDL0MsWUFBYyxDQUFDLEVBQU8sRUFBUSxDQUFFLE9BQU8sRUFBUSxFQUNuREFDeEdPLElBQUksV0FBcUIsQ0FBQyxFQUFNLEVBQU8sQ0FBRSxNQUFRLENBQUUsS0FBTSxFQUFNLE1BQU8sQ0FBTUFDcEI1RSxTQUFTLEVBQVcsQ0FBQyxFQUFHLEVBQUcsQ0FDOUIsZUFBZ0IsQ0FBQyxFQUFHLENBQ2hCLElBQUksRUFBWSxFQUFFLFNBQVMsQ0FBQyxFQUM1QixlQUFnQixDQUFDLEVBQUksRUFBRyxDQUFFLE9BQU8sRUFBRSxJQUFJLEVBQVUsRUFBSSxDQUFDLEVBQUcsRUFBRSxRQUFRLElBR3BFLFNBQVMsRUFBYSxDQUFDLEVBQUcsRUFBRyxDQUNoQyxlQUFnQixDQUFDLEVBQUcsQ0FDaEIsSUFBSSxFQUFZLEVBQUUsU0FBUyxDQUFDLEVBQzVCLGVBQWdCLENBQUMsRUFBSSxFQUFHLENBQUUsT0FBTyxFQUFFLElBQUksRUFBVSxFQUFJLENBQUMsRUFBRyxFQUFFLE9BQU8sSUFHbkUsU0FBUyxFQUFPLENBQUMsRUFBRyxDQUN2QixlQUFnQixDQUFDLEVBQUcsQ0FDaEIsSUFBSSxFQUFVLEVBQUUsT0FBTyxDQUFDLEVBQ3hCLGVBQWdCLENBQUMsRUFBVyxDQUFFLGVBQWdCLENBQUMsRUFBSSxDQUFFLE9BQU8sRUFBUSxVQUFhLENBQUMsRUFBRyxDQUFFLE9BQU8sRUFBRSxJQUFJLEVBQVUsQ0FBQyxVQUFZLENBQUMsRUFBRyxDQUFFLE9BQVEsRUFBTSxFQUFLLENBQUMsRUFBTSxFQUFRLEVBQUlBQ2hCeEssU0FBUyxFQUFLLENBQUMsRUFBRyxFQUFHLENBQ3hCLGVBQWdCLENBQUMsRUFBRyxDQUFFLE9BQVEsRUFBSSxFQUFFLEdBQUcsTUFBUyxFQUFJLEVBQUUsS0FBS0FDb1J4RCxTQUFTLEVBQU0sQ0FBQyxFQUFHLEVBQUksQ0FDMUIsT0FBTyxJQUFPLGVBQXFCLENBQUMsRUFBSSxDQUFFLE9BQU8sR0FBTyxFQUFHLENBQUUsR0FBTyxHQUFhLEVBQUcsQ0FBRSxFQUFNLEVBQVMsRUFBSyxFQUFHLEVBQUVBQzFKNUcsU0FBUyxFQUFhLENBQUMsRUFBVyxDQUNyQyxlQUFnQixDQUFDLEVBQUcsQ0FBRSxPQUFRLEVBQVUsQ0FBQyxFQUFJLENBQUMsQ0FBQyxFQUFJLENBQUMsR0FpWGpELFNBQVMsRUFBYSxDQUFDLEVBQVcsQ0FDckMsZUFBZ0IsQ0FBQyxFQUFJLENBQ2pCLElBQUksRUFBTSxDQUFDLEVBQ1gsUUFBUyxFQUFLLEVBQUcsRUFBTyxFQUFJLEVBQUssRUFBSyxPQUFRLElBQU0sQ0FDaEQsSUFBSSxFQUFJLEVBQUssR0FDYixJQUFLLEVBQVUsQ0FBQyxFQUNaLE1BRUosRUFBSSxLQUFLLENBQUMsRUFFZCxPQUFPLEdBYVIsU0FBUyxFQUFRLENBQUMsRUFBVyxDQUNoQyxlQUFnQixDQUFDLEVBQUksQ0FDakIsSUFBSSxFQUFLLEdBQVEsR0FBYyxFQUFJLENBQVMsQ0FBQyxFQUFFLENBQUUsRUFBRyxFQUFPLEVBQUcsR0FBSSxFQUFPLEVBQUcsR0FDNUUsTUFBTyxDQUFFLEtBQU0sRUFBTSxLQUFNLENBQUssR0EyQ2pDLFNBQVMsRUFBYSxDQUFDLEVBQVcsQ0FDckMsZUFBZ0IsQ0FBQyxFQUFJLENBQUUsT0FBTyxFQUFHLE1BQU0sR0FBYyxFQUFJLENBQVMsQ0FBQyxHQWlCaEUsU0FBUyxFQUFTLENBQUMsRUFBVyxDQUNqQyxPQUFVLEdBQVUsQ0FBUyxFQThCMUIsU0FBUyxFQUFRLENBQUMsRUFBVyxDQUNoQyxPQUFVLEdBQVMsQ0FBUyxFQW9OekIsU0FBUyxFQUFHLENBQUMsRUFBSSxFQUFJLENBQ3hCLEdBQUksSUFBTyxPQUNQLGVBQWdCLENBQUMsRUFBSSxDQUFFLE9BQU8sR0FBSSxFQUFJLENBQUUsR0FFNUMsT0FBTyxHQUFRLEVBQUksVUFBYSxDQUFDLEVBQUcsRUFBRyxDQUFFLE1BQU8sQ0FBQyxFQUFHLENBQUMsRUFBSSxFQTZNdEQsU0FBUyxFQUFhLENBQUMsRUFBTyxFQUFHLEVBQUcsQ0FDdkMsR0FBSSxJQUFXLE9BQUssVUFBYSxFQUFHLENBQUUsTUFBTyxJQUM3QyxJQUFJLFVBQWMsQ0FBQyxFQUFPLEVBQU8sQ0FDN0IsT0FBTyxFQUFXLENBQUssRUFDakIsRUFBWSxFQUFLLENBQUssVUFBWSxDQUFDLEVBQUcsQ0FBRSxPQUFPLEVBQUcsRUFBSyxFQUFPLEdBQU8sQ0FBQyxDQUFDLEVBQU8sRUFBSyxDQUFLLENBQUMsRUFBSSxFQUM3RixFQUFFLE1BQVcsT0FBRyxDQUFLLEVBQUksQ0FBQyxFQUFFLE1BQVcsT0FBRyxDQUFLLENBQUMsRUFDNUMsQ0FBQyxHQUVmLE9BQU8sRUFBRyxDQUFDLEVBQUcsQ0FBSyxFQWNoQixTQUFTLEVBQUssQ0FBQyxFQUFHLENBQ3JCLElBQUksRUFBYSxHQUFNLENBQUMsRUFDeEIsZUFBZ0IsQ0FBQyxFQUFPLEVBQVEsQ0FDNUIsR0FBSSxJQUFXLE9BQVcsQ0FDdEIsSUFBSSxFQUFXLEdBQU0sQ0FBQyxFQUN0QixlQUFnQixDQUFDLEVBQVEsQ0FBRSxPQUFPLEVBQVMsRUFBUSxDQUFLLEdBRTVELE9BQU8sRUFBVyxDQUFLLEdBQUssRUFBVyxDQUFNLEVBQ3ZDLEVBQU8sQ0FBTSxFQUFFLENBQUssRUFDcEIsRUFBVyxDQUFLLEVBQ1osRUFBSyxDQUFLLEVBQ1YsRUFBSyxDQUFNLEdBR3RCLFNBQVMsRUFBWSxDQUFDLEVBQUcsQ0FDNUIsSUFBSSxFQUFRLEdBQUssQ0FBQyxFQUNsQixlQUFnQixDQUFDLEVBQUksRUFBSSxDQUNyQixHQUFJLElBQU8sT0FBVyxDQUNsQixJQUFJLEVBQWtCLEdBQWEsQ0FBQyxFQUNwQyxlQUFnQixDQUFDLEVBQUksQ0FBRSxPQUFPLEVBQWdCLEVBQUksQ0FBRSxHQUV4RCxPQUFPLEVBQUcsZUFBZ0IsQ0FBQyxFQUFHLENBQUUsT0FBTyxFQUFNLEVBQUcsQ0FBRSxFQUFJLEdBR3ZELFNBQVMsRUFBVSxDQUFDLEVBQUcsQ0FDMUIsSUFBSSxFQUFRLEdBQUssQ0FBQyxFQUNsQixlQUFnQixDQUFDLEVBQUksRUFBSSxDQUNyQixHQUFJLElBQU8sT0FBVyxDQUNsQixJQUFJLEVBQWdCLEdBQVcsQ0FBQyxFQUNoQyxlQUFnQixDQUFDLEVBQUksQ0FBRSxPQUFPLEVBQWMsRUFBSSxDQUFFLEdBRXRELE9BQU8sRUFBRyxlQUFnQixDQUFDLEVBQUcsQ0FBRSxPQUFRLEVBQU0sRUFBRyxDQUFFLEVBQUksR0FyaUN4RCxJQUFJLFVBQW1CLENBQUMsRUFBSSxDQUFFLE9BQU8sRUFBRyxTQUFXLEdBYS9DLEVBQWlCLEVBZWpCLEdBQWMsRUFZZCxHQUFlLEdBWWYsR0FBYSxHQVliLEdBQWMsR0FpQmQsV0FBa0IsQ0FBQyxFQUFHLEVBQUcsQ0FBRSxPQUFRLEdBQUssRUFBSSxDQUFDLEVBQVEsR0FBTyxDQUFDLEVBQUUsQ0FBQyxHQWdCaEUsV0FBcUIsQ0FBQyxFQUFHLEVBQUcsQ0FBRSxPQUFPLEdBQU8sVUFBWSxFQUFHLENBQUUsT0FBTyxFQUFJLEdBc0J4RSxXQUFzQixDQUFDLEVBQUksQ0FBRSxPQUFVLEdBQU8sQ0FBRSxFQUFJLENBQUMsRUFBSSxDQUFDLEVBQUcsS0FBSyxHQWdCbEUsV0FBc0IsQ0FBQyxFQUFHLENBQUUsT0FBVSxHQUFPLENBQUMsRUFBSSxDQUFDLEVBQUksQ0FBQyxFQUFFLEtBQUssR0FvQi9ELFdBQWtCLENBQUMsRUFBUyxFQUFZLENBQy9DLGVBQWdCLENBQUMsRUFBSSxDQUNqQixPQUFPLEVBQVcsQ0FBRSxFQUFJLEVBQVcsQ0FBRSxFQUFJLEVBQVEsSUFxQjlDLEdBQVEsR0FrQlIsV0FBc0IsQ0FBQyxFQUFTLEVBQVksQ0FDbkQsZUFBZ0IsQ0FBQyxFQUFJLENBQ2pCLE9BQU8sRUFBVyxDQUFFLEVBQUksRUFBZSxFQUFLLENBQUUsRUFBTyxFQUFLLENBQUUsQ0FBQyxFQUFJLEVBQVEsSUFnQnRFLEdBQVksR0FPWixHQUFXLEdBa0JYLFdBQXVCLENBQUMsRUFBUyxFQUFZLENBQ3BELGVBQWdCLENBQUMsRUFBSSxDQUNqQixPQUFPLEVBQVcsQ0FBRSxFQUFJLEVBQWUsR0FBSyxDQUFFLEVBQU8sR0FBSyxDQUFFLENBQUMsRUFBSSxFQUFRLElBbUJ0RSxHQUFhLEdBT2IsR0FBWSxHQWlCWixXQUEwQixDQUFDLEVBQUcsQ0FDckMsZUFBZ0IsQ0FBQyxFQUFJLENBQ2pCLElBQUksRUFBTSxDQUFDLEVBQ1gsUUFBUyxFQUFJLEVBQUcsRUFBSSxFQUFHLE9BQVEsSUFDM0IsRUFBSSxLQUFLLE1BQU0sRUFBSyxFQUFFLEVBQUcsRUFBRyxFQUFFLENBQUMsRUFFbkMsT0FBTyxJQWFKLFdBQW9CLENBQUMsRUFBRyxFQUFHLENBQ2xDLGVBQWdCLENBQUMsRUFBSSxDQUNqQixJQUFJLEVBQU0sRUFBRyxPQUNULEVBQU0sSUFBSSxNQUFNLEVBQU0sQ0FBQyxFQUMzQixFQUFJLEdBQUssRUFDVCxRQUFTLEVBQUksRUFBRyxFQUFJLEVBQUssSUFDckIsRUFBSSxFQUFJLEdBQUssRUFBRSxFQUFJLEdBQUksRUFBRyxFQUFFLEVBRWhDLE9BQU8sSUFhSixXQUFxQixDQUFDLEVBQUcsRUFBRyxDQUNuQyxlQUFnQixDQUFDLEVBQUksQ0FDakIsSUFBSSxFQUFNLEVBQUcsT0FDVCxFQUFNLElBQUksTUFBTSxFQUFNLENBQUMsRUFDM0IsRUFBSSxHQUFPLEVBQ1gsUUFBUyxFQUFJLEVBQU0sRUFBRyxHQUFLLEVBQUcsSUFDMUIsRUFBSSxHQUFLLEVBQUUsRUFBRyxHQUFJLEVBQUksRUFBSSxFQUFFLEVBRWhDLE9BQU8sSUFhSixXQUFnQixDQUFDLEVBQUksQ0FBRSxPQUFPLEVBQUcsUUFhakMsRUFBbUIsR0FpQm5CLEdBQVksR0FhWixHQUFVLEdBYVYsR0FBVSxHQWFWLFdBQWdCLENBQUMsRUFBSSxDQUFFLE9BQVEsRUFBVyxDQUFFLEVBQU0sRUFBUyxFQUFLLENBQUUsQ0FBQyxFQUFNLEdBYXpFLFdBQWdCLENBQUMsRUFBSSxDQUFFLE9BQVEsRUFBVyxDQUFFLEVBQU0sRUFBUyxHQUFLLENBQUUsQ0FBQyxFQUFNLEdBZ0J6RSxXQUFvQixDQUFDLEVBQUcsQ0FDL0IsZUFBZ0IsQ0FBQyxFQUFJLENBQ2pCLE9BQU8sRUFBYSxFQUFHLENBQUUsRUFBSSxFQUFLLENBQUUsRUFBSSxFQUFHLE1BQU0sRUFBRyxDQUFDLElBa0JsRCxXQUFxQixDQUFDLEVBQUcsQ0FDaEMsZUFBZ0IsQ0FBQyxFQUFJLENBQ2pCLE9BQU8sRUFBYSxFQUFHLENBQUUsRUFBSSxFQUFLLENBQUUsRUFBSSxJQUFNLEVBQUksQ0FBQyxFQUFJLEVBQUcsT0FBTyxDQUFDLElBZ0J0RSxXQUF5QixDQUFDLEVBQUksRUFBVyxDQUN6QyxJQUFJLEVBQUksRUFBRyxPQUNQLEVBQUksRUFDUixLQUFPLEVBQUksRUFBRyxJQUNWLElBQUssRUFBVSxFQUFHLEVBQUUsRUFDaEIsTUFHUixPQUFPLEdBdUJBLFdBQW9CLENBQUMsRUFBRyxDQUMvQixlQUFnQixDQUFDLEVBQUksQ0FDakIsT0FBTyxHQUFLLEdBQUssRUFBUSxDQUFFLEVBQUksRUFBSyxDQUFFLEVBQUksR0FBSyxFQUFHLE9BQVMsQ0FBQyxFQUFJLEVBQUcsTUFBTSxFQUFHLEVBQUcsTUFBTSxJQWtCbEYsV0FBcUIsQ0FBQyxFQUFHLENBQ2hDLGVBQWdCLENBQUMsRUFBSSxDQUNqQixPQUFPLEdBQUssR0FBSyxFQUFRLENBQUUsRUFBSSxFQUFLLENBQUUsRUFBSSxHQUFLLEVBQUcsT0FBUyxDQUFDLEVBQUksRUFBRyxNQUFNLEVBQUcsRUFBRyxPQUFTLENBQUMsSUFvQnRGLEdBQWUsR0ErQmYsR0FBa0IsR0ErQmxCLEdBQWlCLEdBbUJqQixHQUFtQixHQU1uQixVQUFnQixDQUFDLEVBQUksQ0FBRSxPQUFPLEVBQUcsTUFBTSxHQWF2QyxXQUFvQixDQUFDLEVBQUcsRUFBRyxDQUNsQyxlQUFnQixDQUFDLEVBQUksQ0FDakIsT0FBTyxFQUFJLEdBQUssRUFBSSxFQUFHLE9BQVcsRUFBUyxFQUFLLEdBQWUsRUFBRyxFQUFHLENBQUUsQ0FBQyxJQWdCckUsV0FBb0IsQ0FBQyxFQUFHLEVBQUcsQ0FBRSxPQUFPLEdBQVMsVUFBWSxFQUFHLENBQUUsT0FBTyxFQUFJLEdBYXpFLFdBQW9CLENBQUMsRUFBRyxDQUMvQixlQUFnQixDQUFDLEVBQUksQ0FDakIsT0FBTyxFQUFhLEVBQUcsQ0FBRSxFQUFNLEVBQVMsRUFBSyxHQUFlLEVBQUcsQ0FBRSxDQUFDLElBaUIvRCxXQUFvQixDQUFDLEVBQUcsRUFBRyxDQUNsQyxlQUFnQixDQUFDLEVBQUksQ0FDakIsT0FBTyxFQUFhLEVBQUcsQ0FBRSxFQUFNLEVBQVMsRUFBSyxHQUFlLEVBQUcsRUFBRSxFQUFHLEVBQUUsRUFBRyxDQUFFLENBQUMsSUFhekUsV0FBbUIsQ0FBQyxFQUFJLENBQUUsT0FBUSxFQUFRLENBQUUsRUFBSSxDQUFDLEVBQUksRUFBRyxNQUFNLEVBQUUsUUFBUSxHQWF4RSxXQUFrQixDQUFDLEVBQUksQ0FDOUIsSUFBSSxFQUFJLENBQUMsRUFDVCxRQUFTLEVBQUksRUFBRyxFQUFJLEVBQUcsT0FBUSxJQUFLLENBQ2hDLElBQUksRUFBSSxFQUFHLEdBQ1gsR0FBSSxFQUFFLE9BQVMsUUFDWCxFQUFFLEtBQUssRUFBRSxLQUFLLEVBR3RCLE9BQU8sR0FjQSxXQUFpQixDQUFDLEVBQUksQ0FDN0IsSUFBSSxFQUFJLENBQUMsRUFDVCxRQUFTLEVBQUksRUFBRyxFQUFJLEVBQUcsT0FBUSxJQUFLLENBQ2hDLElBQUksRUFBSSxFQUFHLEdBQ1gsR0FBSSxFQUFFLE9BQVMsT0FDWCxFQUFFLEtBQUssRUFBRSxJQUFJLEVBR3JCLE9BQU8sR0FhQSxXQUFnQixDQUFDLEVBQUcsQ0FDM0IsZUFBZ0IsQ0FBQyxFQUFJLENBQ2pCLE9BQU8sRUFBRyxRQUFVLEVBQUksRUFBSyxDQUFFLEVBQUksRUFBRyxNQUFNLEVBQUUsS0FBSyxFQUFFLE9BQU8sSUFjekQsV0FBbUIsQ0FBQyxFQUFJLEVBQUksRUFBRyxDQUN0QyxJQUFJLEVBQUssQ0FBQyxFQUNOLEVBQU0sS0FBSyxJQUFJLEVBQUcsT0FBUSxFQUFHLE1BQU0sRUFDdkMsUUFBUyxFQUFJLEVBQUcsRUFBSSxFQUFLLElBQ3JCLEVBQUcsR0FBSyxFQUFFLEVBQUcsR0FBSSxFQUFHLEVBQUUsRUFFMUIsT0FBTyxHQWtCQSxXQUFpQixDQUFDLEVBQUksQ0FDN0IsSUFBSSxFQUFLLENBQUMsRUFDTixFQUFLLENBQUMsRUFDVixRQUFTLEVBQUksRUFBRyxFQUFJLEVBQUcsT0FBUSxJQUMzQixFQUFHLEdBQUssRUFBRyxHQUFHLEdBQ2QsRUFBRyxHQUFLLEVBQUcsR0FBRyxHQUVsQixNQUFPLENBQUMsRUFBSSxDQUFFLEdBWVAsV0FBc0IsQ0FBQyxFQUFRLENBQ3RDLElBQUksRUFBUSxHQUFXLENBQU0sRUFDN0IsZUFBZ0IsQ0FBQyxFQUFJLENBQUUsT0FBUSxFQUFXLENBQUUsRUFBSSxFQUFFLENBQUUsRUFBSSxDQUFDLElBWWxELFdBQXVCLENBQUMsRUFBUSxDQUN2QyxJQUFJLEVBQVEsR0FBWSxDQUFNLEVBQzlCLGVBQWdCLENBQUMsRUFBSSxDQUFFLE9BQVEsRUFBVyxDQUFFLEVBQUksRUFBRSxDQUFFLEVBQUksRUFBSyxDQUFFLElBWXhELFdBQWtCLENBQUMsRUFBRyxDQUM3QixJQUFJLEVBQVEsR0FBTyxDQUFDLEVBQ3BCLGVBQWdCLENBQUMsRUFBSSxDQUFFLE9BQVEsRUFBVyxDQUFFLEVBQUksRUFBRSxDQUFFLEVBQUksRUFBSyxDQUFFLElBa0J4RCxHQUFVLEdBYVYsV0FBZ0IsQ0FBQyxFQUFHLENBQzNCLElBQUksRUFBUSxHQUFLLENBQUMsRUFDbEIsZUFBZ0IsQ0FBQyxFQUFJLENBQUUsT0FBUSxFQUFXLENBQUUsRUFBSSxFQUFFLENBQUUsRUFBSSxFQUFLLENBQUUsSUFnQ3hELFdBQWtCLENBQUMsRUFBTSxDQUNoQyxJQUFJLEVBQVEsR0FBTyxDQUFJLEVBQ3ZCLGVBQWdCLENBQUMsRUFBSSxDQUFFLE9BQVEsRUFBVyxDQUFFLEVBQUksRUFBRSxDQUFFLEVBQUksRUFBSyxDQUFFLElBdUJ4RCxXQUFnQixDQUFDLEVBQUcsQ0FDM0IsSUFBSSxFQUFRLEdBQUssQ0FBQyxFQUNsQixlQUFnQixDQUFDLEVBQUksQ0FBRSxPQUFRLEVBQVcsQ0FBRSxFQUFJLEVBQUUsQ0FBRSxFQUFJLENBQUMsSUFZbEQsV0FBbUIsQ0FBQyxFQUFHLENBQzlCLGVBQWdCLENBQUMsRUFBSSxDQUNqQixPQUFPLEdBQUssR0FBSyxFQUFXLENBQUUsRUFBUSxHQUFRLENBQUMsRUFBRSxDQUFFLEVBQUksRUFBUSxDQUFFLEVBQUksQ0FBQyxFQUFLLENBQUUsRUFBRyxDQUFDLENBQUMsRUFBSSxDQUFDLENBQUMsRUFBRyxFQUFLLENBQUUsQ0FBQyxJQXFCaEcsV0FBb0IsQ0FBQyxFQUFHLENBQy9CLElBQUksRUFBUSxHQUFTLENBQUMsRUFDdEIsZUFBZ0IsQ0FBQyxFQUFJLENBQUUsT0FBUSxFQUFXLENBQUUsRUFBSSxFQUFFLENBQUUsRUFBSSxDQUFDLElBTWxELFdBQXVCLENBQUMsRUFBRyxDQUNsQyxlQUFnQixFQUFHLENBQ2YsSUFBSSxFQUFJLENBQUMsRUFDVCxRQUFTLEVBQUssRUFBRyxFQUFLLFVBQVUsT0FBUSxJQUNwQyxFQUFFLEdBQU0sVUFBVSxHQUV0QixPQUFPLEdBQVcsRUFBRSxNQUFXLE9BQUcsQ0FBQyxDQUFDLElBZ0JqQyxXQUFtQixDQUFDLEVBQVEsQ0FDbkMsZUFBZ0IsQ0FBQyxFQUFPLENBQ3BCLE9BQU8sRUFBUSxDQUFLLEVBQUksRUFBSyxDQUFNLEVBQUksRUFBUSxDQUFNLEVBQUksRUFBSyxDQUFLLEVBQUksRUFBTSxPQUFPLENBQU0sSUFNdkYsR0FBUyxHQW1DaEIsVUFBZ0IsQ0FBQyxFQUFJLEVBQUcsQ0FBRSxPQUFPLEVBQUssRUFBSSxHQUFJLENBQUMsQ0FBQyxHQUVoRCxXQUF5QixDQUFDLEVBQUksRUFBRyxDQUFFLE9BQU8sRUFBSyxFQUFJLEdBQWEsQ0FBQyxDQUFDLEdBQ2xFLFVBQWUsQ0FBQyxFQUFLLEVBQUksQ0FBRSxPQUFPLEVBQUssRUFBSyxHQUFHLENBQUUsQ0FBQyxHQUVsRCxXQUFtQixDQUFDLEVBQUksRUFBVyxDQUFFLE9BQU8sRUFBSyxFQUFJLEdBQU8sQ0FBUyxDQUFDLEdBRXRFLFdBQXNCLENBQUMsRUFBSSxFQUFHLENBQUUsT0FBTyxFQUFLLEVBQUksR0FBVSxDQUFDLENBQUMsR0FFNUQsV0FBc0IsQ0FBQyxFQUFJLEVBQVcsQ0FDdEMsT0FBTyxFQUFLLEVBQUksR0FBVSxDQUFTLENBQUMsR0FHcEMsV0FBeUIsQ0FBQyxFQUFJLEVBQUcsQ0FBRSxPQUFPLEVBQUssRUFBSSxHQUFhLENBQUMsQ0FBQyxHQUVsRSxXQUErQixDQUFDLEVBQUksRUFBb0IsQ0FBRSxPQUFPLEVBQUssRUFBSSxHQUFtQixDQUFrQixDQUFDLEdBRWhILFdBQWtDLENBQUMsRUFBSSxFQUFHLENBQUUsT0FBTyxFQUFLLEVBQUksR0FBc0IsQ0FBQyxDQUFDLEdBRXBGLFdBQWdCLENBQUMsRUFBSSxFQUFNLENBQUUsT0FBTyxFQUFLLEVBQUksR0FBSSxDQUFJLENBQUMsR0FDdEQsVUFBbUIsQ0FBQyxFQUFJLEVBQUcsRUFBRyxDQUFFLE9BQU8sRUFBSyxFQUFJLEdBQU8sRUFBRyxDQUFDLENBQUMsR0FFNUQsVUFBb0IsQ0FBQyxFQUFHLENBQ3hCLElBQUksRUFBVyxHQUFRLENBQUMsRUFDeEIsZUFBZ0IsQ0FBQyxFQUFJLEVBQUcsQ0FBRSxPQUFPLEVBQUssRUFBSSxFQUFTLENBQUMsQ0FBQyxJQUdyRCxVQUF3QixDQUFDLEVBQUksRUFBRyxFQUFHLENBQUUsT0FBTyxFQUFLLEVBQUksR0FBWSxFQUFHLENBQUMsQ0FBQyxHQUV0RSxXQUE0QixDQUFDLEVBQUksRUFBRyxFQUFHLENBQ3ZDLE9BQU8sRUFBSyxFQUFJLEdBQWdCLEVBQUcsQ0FBQyxDQUFDLEdBR3JDLFdBQTZCLENBQUMsRUFBRyxDQUNqQyxJQUFJLEVBQW9CLEdBQWlCLENBQUMsRUFDMUMsZUFBZ0IsQ0FBQyxFQUFJLEVBQUcsQ0FBRSxPQUFPLEVBQUssRUFBSSxFQUFrQixDQUFDLENBQUMsSUFHOUQsV0FBaUMsQ0FBQyxFQUFJLEVBQUcsRUFBRyxDQUM1QyxPQUFPLEVBQUssRUFBSSxHQUFxQixFQUFHLENBQUMsQ0FBQyxHQUcxQyxXQUErQixDQUFDLEVBQUksRUFBRyxDQUFFLE9BQU8sRUFBSyxFQUFJLEdBQW1CLENBQUMsQ0FBQyxHQUU5RSxXQUE0QixDQUFDLEVBQUksRUFBb0IsQ0FBRSxPQUFPLEVBQUssRUFBSSxHQUFnQixDQUFrQixDQUFDLEdBRTFHLFdBQW1CLENBQUMsRUFBSSxFQUFHLENBQUUsT0FBTyxFQUFLLEVBQUksR0FBTyxDQUFDLENBQUMsR0FFdEQsV0FBcUIsQ0FBQyxFQUFHLENBQ3pCLElBQUksRUFBWSxHQUFTLENBQUMsRUFDMUIsZUFBZ0IsQ0FBQyxFQUFJLEVBQUcsQ0FBRSxPQUFPLEVBQUssRUFBSSxFQUFVLENBQUMsQ0FBQyxJQUd0RCxXQUE4QixDQUFDLEVBQUcsQ0FDbEMsSUFBSSxFQUFxQixHQUFrQixDQUFDLEVBQzVDLGVBQWdCLENBQUMsRUFBSSxFQUFHLENBQUUsT0FBTyxFQUFLLEVBQUksRUFBbUIsQ0FBQyxDQUFDLElBRS9ELEdBQXlCLEdBQ3pCLEdBQTJCLEdBYXBCLEVBQVMsR0FNVCxVQUFnQixFQUFHLENBQUUsTUFBTyxDQUFDLEdBZ0I3QixXQUFlLENBQUMsRUFBRyxDQUFFLGVBQWdCLENBQUMsRUFBSSxDQUFFLE9BQU8sRUFBRyxZQUFhLENBQUMsRUFBRyxDQUFFLE9BQU8sRUFBRSxDQUFDLEVBQUksSUEyQnZGLFdBQWMsQ0FBQyxFQUFJLENBQzFCLE9BQU8sVUFBaUIsQ0FBQyxFQUFHLENBQUUsT0FBTyxFQUFLLEVBQUksR0FBSSxDQUFDLENBQUMsRUFBSSxHQXNCakQsRUFBd0IsRUFBSyxVQUFZLENBQUMsRUFBSSxFQUFHLENBQ3hELE9BQU8sRUFBSyxFQUFJLFdBQXdCLENBQUMsRUFBRyxFQUFHLENBQUUsT0FBTyxFQUFFLEVBQUcsQ0FBQyxFQUFJLENBQUMsRUFDdEUsRUFhVSxHQUF3QixFQUFRLENBQVEsRUFleEMsV0FBd0IsQ0FBQyxFQUFHLENBQUUsZUFBZ0IsQ0FBQyxFQUFJLENBQzFELE9BQU8sRUFBRyxZQUFhLENBQUMsRUFBRyxFQUFHLENBQUUsT0FBTyxFQUFFLEVBQUcsQ0FBQyxFQUFJLElBcUIxQyxXQUE4QixDQUFDLEVBQUcsQ0FDekMsZUFBZ0IsQ0FBQyxFQUFJLENBQ2pCLElBQUksRUFBTSxDQUFDLEVBQ1gsUUFBUyxFQUFJLEVBQUcsRUFBSSxFQUFHLE9BQVEsSUFBSyxDQUNoQyxJQUFJLEVBQVUsRUFBRSxFQUFHLEVBQUcsRUFBRSxFQUN4QixHQUFNLEVBQU8sQ0FBTyxFQUNoQixFQUFJLEtBQUssRUFBUSxLQUFLLEVBRzlCLE9BQU8sSUFrQkosV0FBcUIsQ0FBQyxFQUFHLENBQ2hDLE9BQU8sV0FBNEIsQ0FBQyxFQUFHLEVBQUcsQ0FBRSxPQUFPLEVBQUUsQ0FBQyxFQUFJLEdBZ0JuRCxFQUF3QixHQUFVLENBQVEsRUFpQjFDLFVBQW9CLENBQUMsRUFBSSxDQUNoQyxJQUFJLEVBQU8sQ0FBQyxFQUNSLEVBQVEsQ0FBQyxFQUNiLFFBQVMsRUFBSyxFQUFHLEVBQU8sRUFBSSxFQUFLLEVBQUssT0FBUSxJQUFNLENBQ2hELElBQUksRUFBSSxFQUFLLEdBQ2IsR0FBSSxFQUFFLE9BQVMsT0FDWCxFQUFLLEtBQUssRUFBRSxJQUFJLE1BR2hCLEdBQU0sS0FBSyxFQUFFLEtBQUssRUFHMUIsT0FBTyxHQUFVLEVBQU0sQ0FBSyxHQWlCckIsV0FBa0IsQ0FBQyxFQUFXLENBQ3JDLGVBQWdCLENBQUMsRUFBSSxDQUNqQixPQUFPLEVBQUcsT0FBTyxDQUFTLElBbUJ2QixXQUFxQixDQUFDLEVBQVcsQ0FDeEMsT0FBTyxXQUE0QixDQUFDLEVBQUcsRUFBRyxDQUFFLE9BQU8sRUFBVSxDQUFDLEVBQUksR0FnQjNELFdBQThCLENBQUMsRUFBb0IsQ0FDMUQsZUFBZ0IsQ0FBQyxFQUFJLENBQ2pCLElBQUksRUFBTyxDQUFDLEVBQ1IsRUFBUSxDQUFDLEVBQ2IsUUFBUyxFQUFJLEVBQUcsRUFBSSxFQUFHLE9BQVEsSUFBSyxDQUNoQyxJQUFJLEVBQUksRUFBRyxHQUNYLEdBQUksRUFBbUIsRUFBRyxDQUFDLEVBQ3ZCLEVBQU0sS0FBSyxDQUFDLE1BR1osR0FBSyxLQUFLLENBQUMsRUFHbkIsT0FBTyxHQUFVLEVBQU0sQ0FBSyxJQXNCekIsV0FBd0IsQ0FBQyxFQUFHLENBQUUsT0FBTyxXQUErQixDQUFDLEVBQUcsRUFBRyxDQUFFLE9BQU8sRUFBRSxDQUFDLEVBQUksR0FrQjNGLFdBQWlDLENBQUMsRUFBRyxDQUM1QyxlQUFnQixDQUFDLEVBQUksQ0FDakIsSUFBSSxFQUFPLENBQUMsRUFDUixFQUFRLENBQUMsRUFDYixRQUFTLEVBQUksRUFBRyxFQUFJLEVBQUcsT0FBUSxJQUFLLENBQ2hDLElBQUksRUFBSSxFQUFFLEVBQUcsRUFBRyxFQUFFLEVBQ2xCLEdBQUksRUFBRSxPQUFTLE9BQ1gsRUFBSyxLQUFLLEVBQUUsSUFBSSxNQUdoQixHQUFNLEtBQUssRUFBRSxLQUFLLEVBRzFCLE9BQU8sR0FBVSxFQUFNLENBQUssSUF1QnpCLFdBQWdCLENBQUMsRUFBTSxDQUM5QixlQUFnQixDQUFDLEVBQUksQ0FDakIsT0FBTyxFQUFHLE9BQU8sRUFBSyxDQUFDLElBd0JwQixHQUFNLEdBYU4sV0FBMkIsQ0FBQyxFQUFvQixDQUN2RCxlQUFnQixDQUFDLEVBQUksQ0FDakIsT0FBTyxFQUFHLGVBQWdCLENBQUMsRUFBRyxFQUFHLENBQUUsT0FBTyxFQUFtQixFQUFHLENBQUMsRUFBSSxJQWlCbEUsV0FBa0IsQ0FBQyxFQUFHLENBQUUsZUFBZ0IsQ0FBQyxFQUFJLENBQ3BELE9BQU8sRUFBRyxZQUFhLENBQUMsRUFBRyxFQUFHLENBQUUsT0FBTyxFQUFFLEVBQUcsTUFBTSxDQUFDLENBQUMsRUFBSSxJQWNqRCxHQUEwQixHQUFPLENBQVEsRUFnQnpDLEdBQWEsR0FjYixHQUFzQixHQWtCdEIsR0FBWSxHQWNaLEdBQXFCLEdBY3JCLEdBQWlCLEdBY2pCLEdBQTBCLEdBd0IxQixXQUFvQixDQUFDLEVBQUcsQ0FDL0IsSUFBSSxFQUFxQixHQUFrQixDQUFDLEVBQzVDLGVBQWdCLENBQUMsRUFBRyxDQUFFLE9BQU8sVUFBNEIsQ0FBQyxFQUFHLEVBQUcsQ0FBRSxPQUFPLEVBQUUsQ0FBQyxFQUFJLElBeUJ6RSxXQUFvQixDQUFDLEVBQUcsQ0FDL0IsZUFBZ0IsQ0FBQyxFQUFJLENBQ2pCLE9BQU8sRUFBUSxFQUFJLEVBQUUsR0FBRyxFQUFLLENBQUMsVUFBWSxDQUFDLEVBQUssRUFBSSxDQUNoRCxPQUFPLEVBQUUsR0FBRyxFQUFFLElBQUksVUFBYyxDQUFDLEVBQUksQ0FBRSxlQUFnQixDQUFDLEVBQUcsQ0FBRSxPQUFPLEVBQUssRUFBSSxHQUFPLENBQUMsQ0FBQyxHQUFPLEVBQUcsQ0FBRSxFQUNyRyxJQWtCRSxXQUE2QixDQUFDLEVBQUcsQ0FDeEMsZUFBZ0IsQ0FBQyxFQUFHLENBQ2hCLE9BQU8sR0FBZ0IsRUFBRSxHQUFHLEVBQUssQ0FBQyxVQUFZLENBQUMsRUFBRyxFQUFLLEVBQUcsQ0FDdEQsT0FBTyxFQUFFLEdBQUcsRUFBRSxJQUFJLFVBQWMsQ0FBQyxFQUFJLENBQUUsZUFBZ0IsQ0FBQyxFQUFHLENBQUUsT0FBTyxFQUFLLEVBQUksR0FBTyxDQUFDLENBQUMsR0FBTyxFQUFHLEVBQUUsRUFBRyxDQUFDLENBQUMsRUFDMUcsSUFPRSxXQUFrQixDQUFDLEVBQUcsQ0FDN0IsSUFBSSxFQUFXLEdBQVEsQ0FBQyxFQUN4QixlQUFnQixDQUFDLEVBQUcsQ0FBRSxlQUFnQixDQUFDLEVBQUksQ0FBRSxPQUFPLEVBQVMsRUFBSSxDQUFDLEtBTTNELFdBQWdCLENBQUMsRUFBRyxDQUMzQixJQUFJLEVBQVMsR0FBTSxDQUFDLEVBQ3BCLGVBQWdCLENBQUMsRUFBRyxDQUFFLGVBQWdCLENBQUMsRUFBSSxDQUFFLE9BQU8sRUFBTyxFQUFJLENBQUMsS0F1QnpELFdBQWtCLENBQUMsRUFBRyxFQUFHLENBQ2hDLElBQUksRUFBTSxDQUFDLEVBQ1AsRUFBSyxFQUVULE1BQU8sR0FBTSxDQUNULElBQUksRUFBSyxFQUFFLENBQUUsRUFDYixHQUFNLEVBQU8sQ0FBRSxFQUFHLENBQ2QsSUFBSSxFQUFLLEVBQUcsTUFBTyxFQUFJLEVBQUcsR0FBSSxFQUFNLEVBQUcsR0FDdkMsRUFBSSxLQUFLLENBQUMsRUFDVixFQUFLLE1BR0wsT0FHUixPQUFPLEdBTUEsRUFBTSxRQWNOLEdBQWEsR0FjYixXQUF3QixFQUFHLENBQUUsTUFBUSxDQUM1QyxlQUFpQixDQUFDLEVBQU8sRUFBUSxDQUFFLE9BQU8sRUFBTSxPQUFPLENBQU0sRUFDakUsR0FhVyxXQUFxQixFQUFHLENBQUUsTUFBUSxDQUN6QyxPQUFRLEdBQWEsRUFBRSxPQUN2QixNQUFPLENBQUMsQ0FDWixHQWlCVyxHQUFXLEdBbUJYLEdBQVksR0FpQlosV0FBNkIsQ0FBQyxFQUFHLENBQ3hDLElBQUksRUFBUyxHQUFNLENBQUMsRUFDcEIsTUFBTyxDQUNILGVBQWlCLENBQUMsRUFBTyxFQUFRLENBQUUsT0FBTyxFQUFPLENBQU0sRUFBRSxDQUFLLEVBQ2xFLEdBa0JPLFdBQTBCLENBQUMsRUFBRyxDQUFFLE1BQVEsQ0FDL0MsT0FBUSxHQUFrQixDQUFDLEVBQUUsT0FDN0IsTUFBTyxDQUFDLENBQ1osR0FnQlcsV0FBb0MsQ0FBQyxFQUFHLENBQy9DLElBQUksRUFBZ0IsR0FBYSxDQUFDLEVBQ2xDLE1BQU8sQ0FDSCxlQUFpQixDQUFDLEVBQU8sRUFBUSxDQUFFLE9BQU8sRUFBYyxDQUFNLEVBQUUsQ0FBSyxFQUN6RSxHQW1CTyxXQUE4QixDQUFDLEVBQUcsQ0FDekMsSUFBSSxFQUFjLEdBQVcsQ0FBQyxFQUM5QixNQUFPLENBQ0gsZUFBaUIsQ0FBQyxFQUFPLEVBQVEsQ0FBRSxPQUFPLEVBQVksQ0FBTSxFQUFFLENBQUssRUFDdkUsR0FNTyxHQUFVLENBQ2pCLElBQUssRUFDTCxJQUFLLENBQ1QsRUFrQlcsR0FBcUIsR0FBTSxFQUFPLEVBS2xDLEdBQVUsQ0FDakIsSUFBSyxFQUNMLEdBQUksQ0FDUixFQUtXLEdBQW1CLENBQzFCLElBQUssRUFDTCxJQUFLLEVBQ0wsYUFBYyxFQUNsQixFQUtXLEdBQVEsQ0FDZixJQUFLLEVBQ0wsSUFBSyxFQUNMLEdBQUksQ0FDUixFQU1XLEdBQXdCLEVBQVMsRUFBSyxFQU10QyxHQUF5QixFQUFVLEVBQUssRUFLeEMsR0FBYyxDQUNyQixJQUFLLEVBQ0wsSUFBSyxFQUNMLEdBQUksRUFDSixHQUFJLENBQ1IsRUFLVyxHQUFRLENBQ2YsSUFBSyxFQUNMLElBQUssRUFDTCxHQUFJLEVBQ0osTUFBTyxDQUNYLEVBMkJXLEdBQ0csR0FBWSxFQUFLLEVBS3BCLEdBQVEsQ0FDZixJQUFLLEVBQ0wsSUFBSyxFQUNMLEdBQUksRUFDSixHQUFJLEVBQ0osTUFBTyxDQUNYLEVBS1csR0FBYSxDQUNwQixJQUFLLEVBQ0wsT0FBUSxFQUNaLEVBS1csR0FBTSxDQUNiLElBQUssRUFDTCxJQUFLLEVBQ0wsSUFBSyxFQUNULEVBS1csR0FBTyxDQUNkLElBQUssRUFDTCxLQUFNLENBQ1YsRUFLVyxHQUFzQixHQUFPLEdBQU0sRUFBTyxFQUsxQyxHQUFjLENBQ3JCLElBQUssRUFDTCxJQUFLLEVBQ0wsR0FBSSxFQUNKLEdBQUksRUFDSixJQUFLLEdBQ0wsS0FBTSxDQUNWLEVBS1csR0FBUyxDQUNoQixJQUFLLEVBQ0wsSUFBSyxFQUNMLE9BQVEsRUFDWixFQUtXLEdBQWMsQ0FDckIsSUFBSyxFQUNMLFFBQVMsRUFDVCxTQUFVLENBQ2QsRUFLVyxHQUFhLENBQ3BCLElBQUssRUFDTCxJQUFLLEVBQ0wsUUFBUyxFQUNULFNBQVUsRUFDVixPQUFRLEdBQ1IsVUFBVyxHQUNYLFVBQVcsR0FDWCxhQUFjLEVBQ2xCLEVBS1csR0FBc0IsQ0FDN0IsSUFBSyxFQUNMLElBQUssRUFDTCxhQUFjLEdBQ2QsUUFBUyxFQUNULFNBQVUsRUFDVixPQUFRLEdBQ1IsVUFBVyxHQUNYLFVBQVcsR0FDWCxhQUFjLEdBQ2Qsc0JBQXVCLEdBQ3ZCLG1CQUFvQixHQUNwQixtQkFBb0IsR0FDcEIsZ0JBQWlCLEVBQ3JCLEVBS1csR0FBVyxDQUNsQixJQUFLLEVBQ0wsT0FBUSxFQUNSLFFBQVMsRUFDVCxZQUFhLENBQ2pCLEVBS1csR0FBb0IsQ0FDM0IsSUFBSyxFQUNMLE9BQVEsRUFDUixRQUFTLEVBQ1QsWUFBYSxFQUNiLGdCQUFpQixHQUNqQixpQkFBa0IsR0FDbEIscUJBQXNCLEVBQzFCLEVBS1csR0FBYyxDQUNyQixJQUFLLEVBQ0wsSUFBSyxFQUNMLE9BQVEsRUFDUixRQUFTLEVBQ1QsWUFBYSxFQUNiLFNBQVUsR0FDVixTQUFVLEVBQ2QsRUFLVyxHQUF1QixDQUM5QixJQUFLLEVBQ0wsSUFBSyxFQUNMLGFBQWMsR0FDZCxPQUFRLEVBQ1IsUUFBUyxFQUNULFlBQWEsRUFDYixnQkFBaUIsR0FDakIsaUJBQWtCLEdBQ2xCLHFCQUFzQixHQUN0QixTQUFVLEdBQ1YsU0FBVSxHQUNWLGtCQUFtQixFQUN2QixFQUNJLEdBQXdCLEdBQWMsR0FBYSxFQUFXLEVBQzlELEdBQXNCLEdBQVksR0FBYSxFQUFXLEVBS25ELEdBQWEsQ0FDcEIsSUFBSyxFQUNMLElBQUssRUFDTCxRQUFTLEVBQ1QsU0FBVSxFQUNWLE9BQVEsR0FDUixVQUFXLEdBQ1gsVUFBVyxHQUNYLGFBQWMsR0FDZCxPQUFRLEVBQ1IsUUFBUyxFQUNULFlBQWEsRUFDYixTQUFVLEdBQ1YsU0FBVSxHQUNWLE9BQVEsR0FDUixLQUFNLEVBQ1YsRUFLVyxHQUF3QixHQUt4QixHQUFxQixDQUM1QixJQUFLLEVBQ0wsSUFBSyxFQUNMLEdBQUksRUFDSixNQUFPLEVBQ1AsU0FBVSxFQUNkLEVBS1csR0FBMEIsR0FLMUIsR0FBdUIsQ0FDOUIsSUFBSyxFQUNMLElBQUssRUFDTCxHQUFJLEVBQ0osTUFBTyxFQUNQLFNBQVUsRUFDZCxFQU1XLEdBQXdCLEdBQVMsRUFBVSxFQUszQyxHQUFhLENBQ3BCLElBQUssRUFDTCxXQUFZLEVBQ2hCLEVBS1csR0FBNEIsR0FBYSxFQUFVLEVBUW5ELEdBQXFCLEdBS3JCLFdBQTBCLENBQUMsRUFBRyxFQUFHLEVBQUksQ0FDNUMsT0FBTyxFQUFXLENBQUUsRUFBUSxHQUFlLEVBQUcsRUFBRyxDQUFFLEVBQUksQ0FBQyxHQU1qRCxXQUEwQixDQUFDLEVBQUcsRUFBSSxDQUN6QyxJQUFJLEVBQUssRUFBRyxNQUFNLEVBRWxCLE9BREEsRUFBRyxPQUFPLEVBQUcsQ0FBQyxFQUNQLEdBZ0JBLEdBQVcsR0FZWCxXQUFnQixDQUFDLEVBQVcsQ0FDbkMsZUFBZ0IsQ0FBQyxFQUFJLENBQ2pCLE9BQU8sRUFBRyxLQUFLLENBQVMsSUFRckIsR0FBUyxHQVlULEdBQWlCLEdBUWpCLEdBQW1CLEVBQUssQ0FBVyxFQUtuQyxHQUF1QixFQUFRLEVBQU8sRUFDN0MsR0FBcUIsRUFBTSxFQUFPQUN2eUUvQixJQUFJLFVBQWUsQ0FBQyxFQUFXLENBQ2xDLGVBQWdCLENBQUMsRUFBRyxDQUNoQixPQUFRLEVBQVUsQ0FBQ0FDaENwQixTQUFTLEVBQWEsQ0FBQyxFQUFXLENBQ3JDLGVBQWdCLENBQUMsRUFBRyxDQUFFLE9BQVEsRUFBVSxDQUFDLEVBQUksRUFBSyxDQUFDLEVBQUlBQ2ZwRCxJQUFJLFdBQXdCLEVBQUcsQ0FBRSxNQUFRLENBQzVDLGVBQWlCLENBQUMsRUFBTyxFQUFRLENBQUUsT0FBTyxFQUFLLEVBQU8sQ0FBTSxFQUNoRSxHQU9XLFdBQXFCLEVBQUcsQ0FBRSxNQUFRLENBQ3pDLE9BQVEsR0FBYSxFQUFFLE9BQ3ZCLE1BQU8sQ0FDWEFDbUhPLElBQUksV0FBcUIsQ0FBQyxFQUFHLENBQUUsT0FBVSxHQUFVLENBQUMsRUFBRSxFQUFFLEtBQUssR0FXekQsR0FBYSxDQUNwQixPQUFXLEdBQWMsT0FDekIsTUFBTyxNQUNYQUNqSk8sSUFBTSxHQUFNLFdBQ04sR0FBTSxLQUFLLEtBQUssRUFBSyxFQUFHLENBQUMsRUFDekIsR0FBVSxDQUNuQixPQUNBLElBQUssQ0FBQyxFQUFHLElBQU0sR0FBSSxDQUFDLEVBQUUsQ0FBQyxDQUMzQixFQUNhLEdBQUssRUFDTCxHQUFLLEtBQUssS0FBSyxLQUFLLEVBQUUsQ0FBQyxFQUFFLEVBQUUsQ0FBQyxDQUFDLEVBQzdCLEdBQWMsSUFDcEIsR0FDSCxNQUNBLEdBQUksQ0FBQyxFQUFHLElBQU0sR0FBRyxDQUFDLEVBQUUsQ0FBQyxDQUN6QixFQUNhLEdBQVUsRUFBUyxFQUFXLEVBQzlCLEdBQVcsRUFBVSxFQUFXLEVBQ2hDLEdBQVEsS0FBSyxLQUFLLEtBQUssRUFBRSxFQUFFLENBQUMsQ0FBQyxFQUFFLENBQUNBQ1Z0QyxJQUFNLEdBQU8sRUFBSyxFQUFLLEtBQU8sR0FBTSxDQUFDLENBQUNBQ1J0QyxJQUFNLEdBQStCLFVBQVUsVUFBVSxFQUVuRCxHQUFVLDZCQUE2QixNQUFNLEVBQUUsRUFFdEQsR0FBZSxJQUFNLE1BQU0sS0FBSyxFQUFhLHVCQUF1QixXQUFXLENBQUMsRUFFaEYsR0FBcUIsQ0FBQyxJQUEwQixDQUNsRCxHQUFJLEVBQVUsU0FBVyxFQUFHLE1BQU8sR0FRbkMsT0FOQSxFQUFhLE9BQU8sRUFDcEIsRUFDSSxFQUNBLEVBQUUsSUFBSSxLQUFLLEVBQUUsT0FBTyxDQUFDLENBQ3pCLEVBQ0EsU0FBUyxLQUFLLE9BQU8sQ0FBWSxFQUMxQixJQUVMLEdBQWlCLEVBQUssR0FBYyxFQUFrQixFQUUvQyxHQUFhLElBQU0sQ0FHNUIsR0FGQSxFQUFhLE1BQU0sUUFBVSxRQUV6QixHQUFlLEVBQUcsT0FFdEIsTUFBTSxFQUFtQixDQUFDLElBQW1CLEVBQUUsZ0JBQWdCLENBQUUsYUFBYyxHQUFNLG1CQUFvQixFQUFLLENBQUMsRUFDekcsRUFBc0IsQ0FBQyxJQUFtQixDQUM1QyxNQUFNLEVBQUksU0FBUyxLQUNiLEVBQVEsRUFBRSxzQkFBc0IsRUFDaEMsRUFBUyxDQUFDLEVBQVcsSUFBYyxDQUFDLEtBQWMsS0FBTSxHQUFNLEdBQU8sR0FBRyxFQUFFLEVBQUcsQ0FBQyxFQUFFLEVBQUMsRUFDdkYsT0FDSSxFQUFLLEdBQUssQ0FBQyxFQUFNLElBQUssRUFBTSxNQUFNLENBQUMsRUFBRyxFQUFPLEVBQUcsRUFBRSxZQUFZLENBQUMsR0FDL0QsRUFBSyxHQUFLLENBQUMsRUFBTSxLQUFNLEVBQU0sS0FBSyxDQUFDLEVBQUcsRUFBTyxFQUFHLEVBQUUsV0FBVyxDQUFDLEdBSWhFLEVBQWlCLENBQUMsRUFBcUIsRUFBYSxFQUFzQixJQUEwQixDQUN0RyxNQUFNLEVBQVcsU0FBUyxjQUFjLE1BQU0sRUFNOUMsT0FMQSxFQUFTLFVBQVUsSUFBSSxXQUFXLEVBQ2xDLEVBQVMsVUFBWSxFQUNyQixFQUFTLE1BQU0sSUFBTSxFQUFNLEtBQzNCLEVBQVMsTUFBTSxLQUFPLEVBQU8sS0FDN0IsRUFBUyxPQUFTLEVBQ1gsR0FHTCxFQUFvQixTQUFTLHVCQUF1QixFQUNwRCxFQUFlLHlHQWVyQixHQWJBLEdBQTJCLEVBQ3ZCLFNBQVMsaUJBQWlCLENBQVksRUFDdEMsS0FBSyxNQUFNLEtBQUssQ0FBQyxFQUNqQixFQUFFLE9BQU8sQ0FBZ0IsRUFDekIsRUFBRSxPQUFPLENBQW1CLEVBQzVCLEVBQUUsT0FBc0MsQ0FBQyxFQUFHLENBQUMsRUFBRyxFQUFFLEVBQUksR0FBSyxJQUFNLENBQzdELE1BQVEsSUFBRyxLQUFNLEVBQUUsc0JBQXNCLEVBRXpDLE9BREEsRUFBa0IsT0FBTyxFQUFlLEVBQUcsR0FBUSxHQUFNLEdBQVEsS0FBTyxFQUFHLENBQUMsQ0FBQyxFQUN0RSxHQUFNLEdBQVEsT0FBUyxHQUFHLEVBQUksQ0FBQyxFQUFJLENBQUMsRUFBSSxDQUFFLEVBQ3BELEVBQ0QsRUFBRSxFQUFJLEtBQVEsRUFBSyxFQUFLLENBQzVCLEVBRUksR0FBMEIsRUFBYSxPQUFPLENBQWlCLEdBRzFELEdBQVksSUFBTSxDQUMzQixFQUFhLE1BQU0sUUFBVSxPQUM3QixHQUFlLEVBQ2YsR0FBd0IsSUFHZixHQUFrQixFQUFHLFNBQXlCLENBQ3ZELElBQUssR0FBdUIsQ0FDeEIsR0FBSSxHQUNBLEdBQTJCLEdBQzNCLEdBQXdCLEdBRTVCLE9BRUosTUFBTSxFQUFZLEdBQWEsRUFFL0IsR0FBSSxFQUFVLFNBQVcsRUFBRyxZQUFZLEdBQVUsRUFvQmxELEdBakJJLEVBQWEsT0FBTyxFQUVwQixFQUFVLElBQUksS0FBWSxDQUN0QixNQUFPLEtBQU8sR0FBTSxFQUFTLFVBQVUsWUFBWSxFQUNuRCxHQUFJLElBQU8sRUFBSyxZQUFZLEVBQVMsT0FBTyxFQUU1QyxHQUFJLEVBQUcsU0FBVyxFQUNkLEVBQVMsT0FBTyxNQUFNLEVBQ3RCLEdBQVUsTUFFVixHQUFTLFVBQVksRUFBRyxLQUFLLEVBQUUsRUFFdEMsRUFFRCxTQUFTLEtBQUssT0FBTyxDQUFZLEVBR2pDLEVBQWEsV0FBVyxTQUFXLEVBQUcsR0FBVSxHQUdwRCxHQUEyQixHQUNwQixHQUF3QixHQUU3QixFQUFlLFNBQVMsY0FBYyxLQUFLLEVBQ2pELEVBQWEsR0FBSyxnQkFDbEIsU0FBUyxLQUFLLE9BQU8sQ0FBWUFDOUcxQixJQUFNLEdBQU0sT0FDYixHQUFPLENBQUMsRUFBRyxJQUFNLElBQU0sRUFBRSxFQUFFLENBQUMsRUFDNUIsR0FBTSxDQUFDLEVBQUcsSUFBTSxJQUFNLEVBQUUsRUFBRSxFQUFFLENBQUMsRUFDN0IsR0FBUyxDQUFDLEVBQUcsSUFBTSxFQUFFLEVBQUUsQ0FBQ0FDRnZCLElBQU0sR0FBVSxFQUFJLE9BQU8sS0FBSyxFQUMxQixHQUFzQixDQUFDLElBQVUsQ0FBQyxJQUFXLEVBQUssT0FBTyxTQUFTLEVBQVEsQ0FBSyxFQUFLLEdBQWMsRUFBTyxDQUFDLEVBQzFHLEdBQWEsR0FBb0IsRUFBRSxFQUNuQyxHQUFrQixFQUFLLE9BQU8sV0FBYyxHQUFjLEVBQU8sQ0FBQyxFQUNsRSxHQUFZLEtBQUssRUFBSSxFQUNyQixHQUFZLEtBQUssRUFBSUFDUmxDLElBQU0sR0FBYyxHQUVkLEdBQWEsSUFBTSxTQUFTLGNBQXVCLCtCQUErQixFQUUzRSxHQUFZLENBQUMsSUFBYyxDQUNwQyxNQUFNLEVBQU0sR0FBVyxFQUNqQixFQUFtQixZQUFZLElBQU8sRUFBSSxXQUFhLEVBQUksR0FBYyxFQUFFLEVBQ2pGLFNBQVMsaUJBQWlCLFFBQVMsSUFBTSxjQUFjLENBQWdCLENBQUMsR0FHL0QsR0FBYSxDQUFDLElBQWMsR0FBVyxFQUFFLE9BQU8sRUFBRyxDQUFDLEVBRXBELEdBQVcsQ0FBQyxJQUFpQixVQUFVLFNBQVMsUUFBUSxLQUFLLENBQUUsU0FBVSxDQUFLLENBQUMsRUFFL0UsR0FBZ0IsQ0FBQyxJQUFtQixDQUM3QyxNQUFNLEVBQVcsTUFBTSxLQUFLLFNBQVMsaUJBQTBCLDRCQUE0QixFQUFFLE9BQU8sQ0FBQyxFQUVyRyxFQUNJLFNBQVMsY0FBMkIsa0NBQWtDLEVBQ3RFLEtBQVUsRUFBUyxVQUFVLEtBQUssSUFBTSxDQUFNLEVBQzlDLEtBQUssRUFBSyxLQUFNLEdBQU0sR0FBVSxFQUFJLEVBQVMsRUFBSSxFQUFZLEdBQUksRUFBUyxNQUFNLENBQUMsRUFDakYsS0FBTSxFQUFTLEdBQW1CLE1BQU0sQ0FDNUNBQ05HLElBQVUsR0FBVixVQUFVLEdBQVYsQ0FDSSxJQUFVLEVBQVYsVUFBVSxHQUFWLENBQ0ksQUFBTSxTQUFRLEVBQVMsQ0FBRSxPQUFRLE9BQVEsQ0FBZSxFQUVsRCxXQUFVLENBQUMsS0FBcUIsQ0FDekMsT0FBUSxDQUFFLEtBQUksQ0FDbEIsR0FFYSxXQUFVLENBQUMsS0FBaUIsQ0FDckMsT0FBUSxDQUFFLEtBQUksQ0FDbEIsS0FUYSw2QkFZVixJQUFVLEVBQVYsVUFBVSxHQUFWLENBQ0ksQUFBTSxPQUFNLEVBQVMsQ0FBRSxNQUFPLEtBQU0sQ0FBZSxFQUU3QyxXQUFVLENBQUMsS0FBcUIsQ0FDekMsT0FBUSxDQUFFLEtBQUksQ0FDbEIsR0FFYSxXQUFVLENBQUMsS0FBaUIsQ0FDckMsT0FBUSxDQUFFLEtBQUksQ0FDbEIsS0FUYSw2QkFiSkFDcEJqQixDQUFDLFNBQVksQ0FFVCxJQUFLLFNBQVMsZUFESCw2Q0FDb0IsRUFBRyxDQUM5QixNQUFNLEVBQUssU0FBUyxjQUFjLE9BQU8sRUFDekMsRUFBRyxHQUhJLDhDQUlQLEVBQUcsWUFBYyw4WEFDakIsU0FBUyxLQUFLLFlBQVksQ0FBRSxLQUVqQ0FDRkgsSUFBUSxTQUFTLFVBQVUsU0FFckIsR0FBUSxDQUNWLElBQUksRUFBSyxJQUFLLEVBQVUsRUFDeEIsSUFBSSxFQUFLLElBQUssU0FBWSxDQUl0QixNQURJLFVBQVUsU0FBUyxRQUFRLGdCQUFrQixVQUFVLFNBQVMsUUFBUSx3QkFDekQsVUFBVSxDQUFFLE1BQU8sQ0FBRSxnQkFBaUIsR0FBSSxDQUFFLENBQUMsRUFDaEUsVUFBVSxTQUFTLFVBQVUsWUFBWSxFQUM1QyxFQUFFLFNBQVMsRUFBSSxFQUNoQixJQUFJLEVBQUssTUFBTyxJQUFNLEdBQWMsQ0FBQyxDQUFDLEVBQ3RDLElBQUksRUFBSyxNQUFPLElBQU0sSUFBYyxDQUFFLENBQUMsRUFBRSxTQUFTLEVBQUksRUFDdEQsSUFBSSxFQUFLLElBQUssVUFBVSxTQUFTLFFBQVEsTUFBTSxFQUFFLFNBQVMsRUFBSSxFQUM5RCxJQUFJLEVBQUssSUFBSyxVQUFVLFNBQVMsUUFBUSxTQUFTLEVBQUUsU0FBUyxFQUFJLEVBQ2pFLElBQUksRUFBSyxJQUFLLElBQU0sR0FBVSxDQUFDLENBQUMsRUFDaEMsSUFBSSxFQUFLLElBQUssSUFBTSxJQUFVLENBQUUsQ0FBQyxFQUNqQyxJQUFJLEVBQUssSUFBSyxJQUFNLEdBQVcsQ0FBQyxDQUFDLEVBQ2pDLElBQUksRUFBSyxJQUFLLElBQU0sR0FBVyxPQUFPLGdCQUFnQixDQUFDLEVBQUUsU0FBUyxFQUFJLEVBQ3RFLElBQUksRUFBSyxJQUFLLElBQU0sR0FBWSxDQUFDLFVBQVUsT0FBTyxLQUFLLEtBQUssR0FBRyxDQUFDLENBQUMsRUFDakUsSUFBSSxFQUFLLElBQUssS0FBSyxDQUNmLEVBQUUsZUFBZSxFQUNqQixHQUFTLFNBQVMsRUFDckIsQ0FDTCxFQUVBLEdBQU0sSUFBSSxLQUFRLEVBQUssU0FBUyxDQUFDLEVBRWpDLEdBQVUsS0FBSyxHQUFTLEdBQWlCLFVBQVUsRUFDbkQsR0FBVSxLQUFLLEdBQUssT0FBUSxFQUFTIiwKICAiZGVidWdJZCI6ICI5QTYzNDJEMTVEQjFGQkVDNjQ3NTZlMjE2NDc1NmUyMSIsCiAgIm5hbWVzIjogW10KfQ==
