{
  "version": 3,
  "sources": ["../../extensions/redacted/app.ts", "../../shared/util.ts", "../../shared/deps.ts", "../../extensions/redacted/Services/LyricsProvider.ts", "../../extensions/redacted/Services/Song.ts", "../../extensions/star-ratings-2/util.ts", "../../shared/listeners.ts", "../../extensions/redacted/Services/PlayerW.ts", "../../extensions/redacted/components.ts", "../../extensions/redacted/Packages/Spring.ts", "../../extensions/redacted/Packages/Sprine.ts"],
  "sourcesContent": ["import { render } from \"https://esm.sh/lit\"\r\nimport { PermanentMutationObserver } from \"../../shared/util.ts\"\r\nimport { PlayerW } from \"./Services/PlayerW.ts\"\r\nimport { LyricsContainer } from \"./components.ts\"\r\n\r\ndebugger\r\nnew PermanentMutationObserver(\"main\", () => {\r\n    const lyricsContainer = document.querySelector<HTMLDivElement>(\".main-nowPlayingView-lyricsContent\")\r\n    if (!lyricsContainer || lyricsContainer.classList.contains(\"injected\")) return\r\n    lyricsContainer.classList.add(\"injected\")\r\n    const ourLyricsContainer = new LyricsContainer()\r\n    ourLyricsContainer.song = PlayerW.GetSong() ?? null\r\n    PlayerW.songChangedSubject.subscribe(song => (ourLyricsContainer.song = song ?? null))\r\n    PlayerW.scaledProgressChangedSubject.subscribe(\r\n        scaledProgress => (ourLyricsContainer.scaledProgress = scaledProgress),\r\n    )\r\n    lyricsContainer.innerHTML = \"\"\r\n    render(ourLyricsContainer, lyricsContainer)\r\n})\r\ndebugger\r\n", "export type SpotifyID = string\r\nexport type SpotifyURI = string\r\n\r\nconst { URI } = Spicetify\r\nconst { PlayerAPI } = Spicetify.Platform\r\n\r\nexport const SpotifyLoc = {\r\n    before: {\r\n        start: () => ({ before: \"start\" as const }),\r\n        fromUri: (uri: SpotifyURI) => ({ before: { uri } }),\r\n        fromUid: (uid: string) => ({ before: { uid } }),\r\n    },\r\n    after: {\r\n        end: () => ({ after: \"end\" as const }),\r\n        fromUri: (uri: SpotifyURI) => ({ after: { uri } }),\r\n        fromUid: (uid: string) => ({ after: { uid } }),\r\n    },\r\n}\r\n\r\nexport const normalizeStr = (str: string) =>\r\n    str\r\n        .normalize(\"NFKD\")\r\n        .replace(/\\(.*\\)/g, \"\")\r\n        .replace(/\\[.*\\]/g, \"\")\r\n        .replace(/-_,/g, \" \")\r\n        .replace(/[^a-zA-Z0-9 ]/g, \"\")\r\n        .replace(/\\s+/g, \" \")\r\n        .toLowerCase()\r\n        .trim()\r\n\r\nexport class PermanentMutationObserver extends MutationObserver {\r\n    target: HTMLElement | null = null\r\n\r\n    constructor(\r\n        targetSelector: string,\r\n        callback: MutationCallback,\r\n        opts: MutationObserverInit = {\r\n            childList: true,\r\n            subtree: true,\r\n        },\r\n    ) {\r\n        super(callback)\r\n        new MutationObserver(() => {\r\n            const nextTarget = document.querySelector<HTMLElement>(targetSelector)\r\n            if (nextTarget && !nextTarget.isEqualNode(this.target)) {\r\n                console.log(\"nextTarget:\", nextTarget)\r\n                this.target && this.disconnect()\r\n                this.target = nextTarget\r\n                this.observe(this.target, opts)\r\n            }\r\n        }).observe(document.body, {\r\n            childList: true,\r\n            subtree: true,\r\n        })\r\n    }\r\n}\r\n\r\nexport const waitForElement = <E extends Element>(\r\n    selector: string,\r\n    timeout = 1000,\r\n    location = document.body,\r\n    notEl?: E | null,\r\n) =>\r\n    new Promise((resolve: (value: Element) => void, reject) => {\r\n        const onMutation = () => {\r\n            const el = document.querySelector<E>(selector)\r\n            if (el) {\r\n                if (notEl && el === notEl) {\r\n                } else {\r\n                    observer.disconnect()\r\n                    return resolve(el)\r\n                }\r\n            }\r\n        }\r\n\r\n        const observer = new MutationObserver(onMutation)\r\n        onMutation()\r\n\r\n        observer.observe(location, {\r\n            childList: true,\r\n            subtree: true,\r\n        })\r\n\r\n        if (timeout)\r\n            setTimeout(() => {\r\n                observer.disconnect()\r\n                reject()\r\n            }, timeout)\r\n    })\r\n\r\nexport const formatUri = (uri: string) => URI.fromString(uri).toURI()\r\n\r\nexport const sleep = (ms: number) => new Promise(resolve => setTimeout(resolve, ms))\r\n\r\nexport const mainElement = document.querySelector(\"main\")!\r\nexport const [REACT_FIBER, REACT_PROPS] = Object.keys(mainElement)\r\n\r\nexport const createQueueItem =\r\n    (queued: boolean) =>\r\n    ({ uri, uid = \"\" }: { uri: string; uid?: string }) => ({\r\n        contextTrack: {\r\n            uri,\r\n            uid,\r\n            metadata: {\r\n                is_queued: queued.toString(),\r\n            },\r\n        },\r\n        removed: [],\r\n        blocked: [],\r\n        provider: queued ? (\"queue\" as const) : (\"context\" as const),\r\n    })\r\n\r\nexport const setQueue = async (\r\n    nextTracks: Array<ReturnType<ReturnType<typeof createQueueItem>>>,\r\n    contextUri?: string,\r\n) => {\r\n    const { _queue, _client } = PlayerAPI._queue\r\n    const { prevTracks, queueRevision } = _queue\r\n\r\n    const res = await _client.setQueue({\r\n        nextTracks,\r\n        prevTracks,\r\n        queueRevision,\r\n    })\r\n\r\n    await PlayerAPI.skipToNext()\r\n\r\n    if (contextUri) {\r\n        await new Promise<void>(resolve => {\r\n            PlayerAPI._events.addListener(\"queue_update\", () => resolve(), { once: true })\r\n        })\r\n        await setPlayingContext(contextUri)\r\n    }\r\n\r\n    return res\r\n}\r\n\r\nexport const setPlayingContext = (uri: string) => {\r\n    const { sessionId } = PlayerAPI._state\r\n    return PlayerAPI.updateContext(sessionId, { uri, url: \"context://\" + uri })\r\n}\r\n", "// @deno-types=\"npm:@types/lodash\"\r\nimport { default as ld } from \"https://esm.sh/lodash\"\r\nexport const _ = ld\r\n\r\n// @deno-types=\"npm:@types/lodash/fp\"\r\nimport { default as ld_fp } from \"https://esm.sh/lodash/fp\"\r\nexport const fp = ld_fp\r\n", "import { _ } from \"../../../shared/deps.ts\"\r\n\r\nconst headers = {\r\n    authority: \"apic-desktop.musixmatch.com\",\r\n    cookie: \"x-mxm-token-guid=\",\r\n}\r\n\r\nconst CONFIG = {\r\n    musixmatchToken: \"\",\r\n}\r\n\r\n{\r\n    const url = new URL(\"https://apic-desktop.musixmatch.com/ws/1.1/token.get\")\r\n    url.searchParams.append(\"app_id\", \"web-desktop-app-v1.0\")\r\n    Spicetify.CosmosAsync.get(url.toString(), undefined, _.omit(headers, \"cookie\")).then(res => {\r\n        if (res.message.header.status_code === 200 && res.message.body.user_token) {\r\n            CONFIG.musixmatchToken = res.message.body.user_token\r\n        } else {\r\n            debugger\r\n        }\r\n    })\r\n}\r\n\r\nexport type Lyrics = {\r\n    wordSynced?: WordSynced\r\n    lineSynced?: LineSynced\r\n    nonSynced?: NonSynced\r\n}\r\n\r\nexport type SyncedPart = {\r\n    tsr: number\r\n    ter: number\r\n    part: Array<SyncedPart> | string\r\n}\r\n\r\nexport type Synced<A> = {\r\n    tsr: number\r\n    ter: number\r\n    part: A\r\n}\r\n\r\nexport type NonSynced = Synced<Array<{ part: string }>> & { __type: \"NonSynced\" }\r\nexport type LineSynced = Synced<Array<Synced<string>>> & { __type: \"LineSynced\" }\r\nexport type WordSynced = Synced<Array<Synced<Array<Synced<string>>>>> & { __type: \"WordSynced\" }\r\n\r\nexport const findLyrics = async (info: {\r\n    uri: string\r\n    title: string\r\n    artist: string\r\n    album: string\r\n    durationS: number\r\n}) => {\r\n    const { lyrics, subtitles, track } = await fetchMxmMacroSubtitlesGet(\r\n        info.uri,\r\n        info.title,\r\n        info.artist,\r\n        info.album,\r\n        info.durationS,\r\n    )\r\n\r\n    const l: Lyrics = {}\r\n\r\n    const w = <T extends string, P>(s: T, a: P) => ({\r\n        __type: s,\r\n        tsr: 0,\r\n        ter: 1,\r\n        part: a,\r\n    })\r\n\r\n    if (track.has_richsync) {\r\n        const richSync = await fetchMxmTrackRichSyncGet(track.commontrack_id, track.track_length)\r\n        l.wordSynced = w(\r\n            \"WordSynced\",\r\n            richSync.map(rsLine => {\r\n                const tsr = rsLine.ts / track.track_length\r\n                const ter = rsLine.te / track.track_length\r\n                const duration = rsLine.te - rsLine.ts\r\n\r\n                const part = rsLine.l.map((word, index, words) => {\r\n                    const part = word.c\r\n                    const tsr = word.o / duration\r\n                    const ter = words[index + 1]?.o / 1000 ?? 1\r\n\r\n                    return { tsr, ter, part }\r\n                })\r\n\r\n                return { tsr, ter, part }\r\n            }),\r\n        )\r\n    }\r\n\r\n    if (track.has_subtitles) {\r\n        const subtitle = JSON.parse(subtitles[0].subtitle_body) as Array<{\r\n            text: string\r\n            time: { total: number; minutes: number; seconds: number; hundredths: number }\r\n        }>\r\n        l.lineSynced = w(\r\n            \"LineSynced\",\r\n            subtitle.map((sLine, index, subtitle) => {\r\n                const tsr = sLine.time.total / track.track_length\r\n                const ter = subtitle[index + 1]?.time.total / track.track_length ?? 1\r\n                return { tsr, ter, part: sLine.text }\r\n            }),\r\n        )\r\n    }\r\n\r\n    if (track.has_lyrics || track.has_lyrics_crowd) {\r\n        l.nonSynced = w(\r\n            \"NonSynced\",\r\n            lyrics.lyrics_body.split(\"\\n\").map(lLine => ({ part: lLine })),\r\n        )\r\n    }\r\n\r\n    return l\r\n}\r\n\r\nconst getTranslation = async (trackId: string, lang = \"en\") => {\r\n    const res = await fetchMxmCrowdTrackTranslationsGet(trackId, lang)\r\n    return res.map(translation => ({\r\n        translation: translation.description,\r\n        matchedLine: translation.matched_line,\r\n    }))\r\n}\r\n\r\ntype MusicGenreList = Array<{\r\n    music_genre: {\r\n        music_genre_id: number\r\n        music_genre_parent_id: number\r\n        music_genre_name: string\r\n        music_genre_name_extended: string\r\n        music_genre_vanity: string\r\n    }\r\n}>\r\nconst fetchMxmMacroSubtitlesGet = async (\r\n    uri: string,\r\n    title: string,\r\n    artist: string,\r\n    album: string,\r\n    durationS: number,\r\n) => {\r\n    const url = new URL(\"https://apic-desktop.musixmatch.com/ws/1.1/macro.subtitles.get\")\r\n    url.searchParams.append(\"format\", \"json\")\r\n    url.searchParams.append(\"namespace\", \"lyrics_richsynched\")\r\n    url.searchParams.append(\"subtitle_format\", \"mxm\")\r\n    url.searchParams.append(\"app_id\", \"web-desktop-app-v1.0\")\r\n    url.searchParams.append(\"q_album\", album)\r\n    url.searchParams.append(\"q_artist\", artist)\r\n    url.searchParams.append(\"q_artists\", artist)\r\n    url.searchParams.append(\"q_track\", title)\r\n    url.searchParams.append(\"track_spotify_id\", uri)\r\n    url.searchParams.append(\"q_duration\", encodeURIComponent(durationS))\r\n    url.searchParams.append(\"f_subtitle_length\", encodeURIComponent(Math.floor(durationS)))\r\n    url.searchParams.append(\"usertoken\", CONFIG.musixmatchToken)\r\n\r\n    const res = await Spicetify.CosmosAsync.get(url.toString(), undefined, headers)\r\n    const {\r\n        \"track.lyrics.get\": trackLyricsGet,\r\n        \"track.snippet.get\": trackSnippetGet,\r\n        \"track.subtitles.get\": trackSubtitlesGet,\r\n        \"userblob.get\": userblobGet,\r\n        \"matcher.track.get\": matcherTrackGet,\r\n    } = res.message.body.macro_calls\r\n\r\n    return {\r\n        lyrics: trackLyricsGet.message.body.lyrics as {\r\n            lyrics_id: number\r\n            can_edit: 0 | 1\r\n            locked: 0 | 1\r\n            published_status: 0 | 1\r\n            action_requested: string\r\n            verified: 0 | 1\r\n            restricted: 0 | 1\r\n            instrumental: 0 | 1\r\n            explicit: 0 | 1\r\n            lyrics_body: string\r\n            lyrics_language: string\r\n            lyrics_language_description: string\r\n            script_tracking_url: string\r\n            pixel_tracking_url: string\r\n            html_tracking_url: string\r\n            lyrics_copyright: string\r\n            writer_list: string[]\r\n            publisher_list: string[]\r\n            backlink_url: string\r\n            updated_time: string\r\n        },\r\n        snippet: trackSnippetGet.message.body.snippet as {\r\n            snippet_id: number\r\n            snippet_language: string\r\n            restricted: 0 | 1\r\n            instrumental: 0 | 1\r\n            snippet_body: string\r\n            script_tracking_url: string\r\n            pixel_tracking_url: string\r\n            html_tracking_url: string\r\n            updated_time: string\r\n        },\r\n        subtitles: trackSubtitlesGet.message.body.subtitle_list.map(\r\n            (subtitle_element: any) => subtitle_element.subtitle,\r\n        ) as Array<{\r\n            subtitle_id: number\r\n            restricted: 0 | 1\r\n            published_status: number\r\n            subtitle_body: string\r\n            subtitle_avg_count: number\r\n            lyrics_copyright: string\r\n            subtitle_length: number\r\n            subtitle_language: string\r\n            subtitle_language_description: string\r\n            script_tracking_url: string\r\n            pixel_tracking_url: string\r\n            html_tracking_url: string\r\n            writer_list: string[]\r\n            publisher_list: string[]\r\n            updated_time: string\r\n        }>,\r\n        track: matcherTrackGet.message.body.track as {\r\n            track_id: number\r\n            track_mbid: string\r\n            track_isrc: string\r\n            commontrack_isrcs: Array<string[]>\r\n            track_spotify_id: string\r\n            commontrack_spotify_ids: string[]\r\n            commontrack_itunes_ids: number[]\r\n            track_soundcloud_id: number\r\n            track_xboxmusic_id: string\r\n            track_name: string\r\n            track_name_translation_list: any[]\r\n            track_rating: number\r\n            track_length: number\r\n            commontrack_id: number\r\n            instrumental: 0 | 1\r\n            explicit: 0 | 1\r\n            has_lyrics: 0 | 1\r\n            has_lyrics_crowd: 0 | 1\r\n            has_subtitles: 0 | 1\r\n            has_richsync: 0 | 1\r\n            has_track_structure: 0 | 1\r\n            num_favorite: number\r\n            lyrics_id: number\r\n            subtitle_id: number\r\n            album_id: number\r\n            album_name: string\r\n            album_vanity_id: string\r\n            artist_id: number\r\n            artist_mbid: string\r\n            artist_name: string\r\n            album_coverart_100x100: string\r\n            album_coverart_350x350: string\r\n            album_coverart_500x500: string\r\n            album_coverart_800x800: string\r\n            track_share_url: string\r\n            track_edit_url: string\r\n            commontrack_vanity_id: string\r\n            restricted: 0 | 1\r\n            first_release_date: string\r\n            updated_time: string\r\n            primary_genres: {\r\n                music_genre_list: MusicGenreList\r\n            }\r\n            secondary_genres: {\r\n                music_genre_list: MusicGenreList\r\n            }\r\n        },\r\n    }\r\n}\r\n\r\nconst fetchMxmTrackRichSyncGet = async (commonTrackId: number, trackLength: number) => {\r\n    const url = new URL(\"https://apic-desktop.musixmatch.com/ws/1.1/track.richsync.get\")\r\n    url.searchParams.append(\"format\", \"json\")\r\n    url.searchParams.append(\"subtitle_format\", \"mxm\")\r\n    url.searchParams.append(\"app_id\", \"web-desktop-app-v1.0\")\r\n    url.searchParams.append(\"f_subtitle_length\", encodeURIComponent(trackLength))\r\n    url.searchParams.append(\"q_duration\", encodeURIComponent(trackLength))\r\n    url.searchParams.append(\"commontrack_id\", encodeURIComponent(commonTrackId))\r\n    url.searchParams.append(\"usertoken\", CONFIG.musixmatchToken)\r\n\r\n    const res = await Spicetify.CosmosAsync.get(url.toString(), undefined, headers)\r\n\r\n    return JSON.parse(res.message.body.richsync.richsync_body) as Array<{\r\n        ts: number\r\n        te: number\r\n        l: Array<{\r\n            c: string\r\n            o: number\r\n        }>\r\n        x: string\r\n    }>\r\n}\r\n\r\nconst fetchMxmCrowdTrackTranslationsGet = async (trackId: string, lang = \"en\") => {\r\n    const url = new URL(\"https://apic-desktop.musixmatch.com/ws/1.1/crowd.track.translations.get\")\r\n    url.searchParams.append(\"translation_fields_set\", \"minimal\")\r\n    url.searchParams.append(\"selected_language\", lang)\r\n    url.searchParams.append(\"comment_format\", \"text\")\r\n    url.searchParams.append(\"format\", \"json\")\r\n    url.searchParams.append(\"app_id\", \"web-desktop-app-v1.0\")\r\n    url.searchParams.append(\"track_id\", trackId)\r\n    url.searchParams.append(\"usertoken\", CONFIG.musixmatchToken)\r\n\r\n    const res = await Spicetify.CosmosAsync.get(url.toString(), undefined, headers)\r\n\r\n    return res.message.body.translations_list.map(\r\n        (translation_element: any) => translation_element.translation,\r\n    ) as Array<any>\r\n}\r\n", "import { Track } from \"https://esm.sh/v135/@fostertheweb/spotify-web-api-ts-sdk@1.2.1/dist/mjs/types.js\"\r\nimport { Lyrics, findLyrics } from \"./LyricsProvider.ts\"\r\n\r\nexport type SpotifyTrackInformation = Track\r\n\r\nexport class Song {\r\n    readonly uri: string\r\n    readonly name: string\r\n    readonly artist: string\r\n    readonly album: string\r\n    readonly duration: number\r\n    readonly isLocal: boolean\r\n    readonly lyrics: Promise<Lyrics>\r\n\r\n    isPaused: boolean\r\n    private timestamp = 0\r\n\r\n    constructor(opts: {\r\n        uri: string\r\n        name: string\r\n        artist: string\r\n        album: string\r\n        duration: number\r\n        isPaused: boolean\r\n        metadata: Spicetify.Platform.PlayerAPI.TrackMetadata\r\n    }) {\r\n        this.uri = opts.uri\r\n        this.name = opts.name\r\n        this.artist = opts.artist\r\n        this.album = opts.album\r\n        this.duration = opts.duration\r\n        this.isLocal = opts.metadata.is_local === \"true\"\r\n        this.isPaused = opts.isPaused\r\n\r\n        this.lyrics = findLyrics({\r\n            uri: this.uri,\r\n            title: this.name,\r\n            artist: this.artist,\r\n            album: this.album,\r\n            durationS: this.duration / 1000,\r\n        })\r\n    }\r\n\r\n    getTimestamp = () => this.timestamp\r\n\r\n    setTimestamp = (timestampMs: number) => Spicetify.Player.seek(timestampMs)\r\n}\r\n", "import { REACT_PROPS } from \"../../shared/util.ts\"\r\n\r\nexport const RATINGS_FOLDER_NAME = \"Ratings\"\r\n\r\nexport const getTrackLists = () =>\r\n    Array.from(document.querySelectorAll<HTMLDivElement>(\".main-trackList-trackList.main-trackList-indexable\"))\r\nexport const getTrackListTracks = (trackList: HTMLDivElement) =>\r\n    Array.from(trackList.querySelectorAll<HTMLDivElement>(\".main-trackList-trackListRow\"))\r\n\r\nexport const getTrackListTrackUri = (track: HTMLDivElement) => {\r\n    const rowSectionEnd = track.querySelector<HTMLDivElement>(\".main-trackList-rowSectionEnd\")!\r\n    const reactProps = rowSectionEnd[REACT_PROPS]\r\n    const { props } =\r\n        // artist & local tracks & albums\r\n        reactProps.children.at?.(-1).props.menu ??\r\n        // playlists\r\n        reactProps.children.props.children.at(-1).props.menu\r\n\r\n    return props.uri\r\n}\r\n\r\nexport const getNowPlayingBar = () => document.querySelector<HTMLDivElement>(\"div.main-nowPlayingBar-nowPlayingBar\")!\r\nexport const getCollectionActionBarRow = () => document.querySelector<HTMLDivElement>(`div.main-actionBar-ActionBarRow`)\r\n\r\nexport const playlistButtonSelector = `button[aria-label=\"Add to Liked Songs\"], button[aria-label=\"Add to playlist\"], button[aria-label=\"Remove recommendation\"]`\r\nexport const getPlaylistButton = (parent: HTMLElement) =>\r\n    parent.querySelector<HTMLButtonElement>(playlistButtonSelector)!\r\nexport const getCollectionPlaylistButton = () => {\r\n    const ab = getCollectionActionBarRow()\r\n    return ab?.querySelector<HTMLButtonElement>(\r\n        `button[aria-label=\"Remove from Your Library\"], button[aria-label=\"Save to Your Library\"]`,\r\n    )\r\n}\r\n", "import { getTrackListTracks, getTrackLists } from \"../extensions/star-ratings-2/util.ts\"\r\n\r\nimport { PermanentMutationObserver, REACT_FIBER } from \"./util.ts\"\r\n\r\nconst { Player, URI } = Spicetify\r\nconst { PlayerAPI, History } = Spicetify.Platform\r\n\r\nexport const onHistoryChanged = (\r\n    toMatchTo: string | RegExp | ((location: string) => boolean),\r\n    callback: (uri: string) => void,\r\n    dropDuplicates = true,\r\n) => {\r\n    const createMatchFn = (toMatchTo: string | RegExp | ((input: string) => boolean)) => {\r\n        switch (typeof toMatchTo) {\r\n            case \"string\":\r\n                return (input: string) => input?.startsWith(toMatchTo) ?? false\r\n\r\n            case \"function\":\r\n                return toMatchTo\r\n\r\n            default:\r\n                return (input: string) => toMatchTo.test(input)\r\n        }\r\n    }\r\n\r\n    let lastPathname = \"\"\r\n    const matchFn = createMatchFn(toMatchTo)\r\n\r\n    const historyChanged = ({ pathname }: any) => {\r\n        if (matchFn(pathname)) {\r\n            if (dropDuplicates && lastPathname === pathname) {\r\n            } else callback(URI.fromString(pathname).toURI())\r\n        }\r\n        lastPathname = pathname\r\n    }\r\n\r\n    historyChanged(History.location ?? {})\r\n    return History.listen(historyChanged)\r\n}\r\n\r\nexport const onSongChanged = (callback: (state: Spicetify.Platform.PlayerAPI.PlayerState) => void) => {\r\n    callback(PlayerAPI._state)\r\n    Player.addEventListener(\"songchange\", event => callback(event!.data))\r\n}\r\n\r\ntype TrackListElement = HTMLDivElement & { presentation?: HTMLDivElement }\r\ntype TrackElement = HTMLDivElement & { props?: Record<string, any> }\r\n\r\ntype TrackListMutationListener = (trackList: Required<TrackListElement>, tracks: Array<Required<TrackElement>>) => void\r\nexport const onTrackListMutationListeners = new Array<TrackListMutationListener>()\r\n\r\nconst _onTrackListMutation = (\r\n    trackList: Required<TrackListElement>,\r\n    record: MutationRecord[],\r\n    observer: MutationObserver,\r\n) => {\r\n    const tracks = getTrackListTracks(trackList.presentation) as Array<Required<TrackElement>>\r\n\r\n    const reactFiber = trackList.presentation[REACT_FIBER].alternate\r\n    const reactTracks = reactFiber.pendingProps.children as any[]\r\n    const tracksProps = reactTracks.map((child: any) => child.props as Record<string, any>)\r\n\r\n    tracks.forEach((track, i) => (track.props = tracksProps[i]))\r\n\r\n    const fullyRenderedTracks = tracks.filter(track => track.props.uri)\r\n\r\n    onTrackListMutationListeners.map(listener => listener(trackList, fullyRenderedTracks))\r\n}\r\n\r\nnew PermanentMutationObserver(\"main\", () => {\r\n    const trackLists = getTrackLists() as Array<TrackListElement>\r\n    trackLists\r\n        .filter(trackList => !trackList.presentation)\r\n        .forEach(trackList => {\r\n            trackList.presentation = trackList.lastElementChild!.firstElementChild!\r\n                .nextElementSibling! as HTMLDivElement\r\n\r\n            new MutationObserver((record, observer) =>\r\n                _onTrackListMutation(trackList as Required<TrackListElement>, record, observer),\r\n            ).observe(trackList.presentation, { childList: true })\r\n        })\r\n})\r\n", "import { Song } from \"./Song.ts\"\r\nimport { onSongChanged } from \"../../../shared/listeners.ts\"\r\nimport { Subject, animationFrameScheduler, asyncScheduler } from \"https://esm.sh/rxjs\"\r\n\r\nconst { Player } = Spicetify\r\nconst { PlayerAPI } = Spicetify.Platform\r\n\r\nexport const PlayerW = new (class {\r\n    private Song?: Song\r\n    isPaused = PlayerAPI._state.isPaused\r\n    scaledProgress = 0\r\n\r\n    songChangedSubject = new Subject<Song | void>()\r\n    isPausedChangedSubject = new Subject<boolean>()\r\n    scaledProgressChangedSubject = new Subject<number>()\r\n\r\n    GetSong = () => this.Song\r\n\r\n    constructor() {\r\n        {\r\n            const callback = (state: Spicetify.Platform.PlayerAPI.PlayerState) => {\r\n                const { item } = state\r\n\r\n                if (item && item.type === \"track\") {\r\n                    const uri = item.uri\r\n                    const name = item.name\r\n                    const artist = item.metadata.artist_name\r\n                    const album = item.album.name\r\n                    const duration = item.duration.milliseconds\r\n                    const isPaused = state.isPaused\r\n                    const metadata = item.metadata\r\n                    this.Song = new Song({ uri, name, artist, album, duration, isPaused, metadata })\r\n                } else {\r\n                    this.Song = undefined\r\n                }\r\n\r\n                this.songChangedSubject.next(this.Song)\r\n            }\r\n            onSongChanged(callback)\r\n        }\r\n\r\n        {\r\n            const callback = () => {\r\n                const isPausedNext = Player.data?.isPaused ?? true\r\n                if (this.isPaused !== isPausedNext) {\r\n                    if (!isPausedNext) {\r\n                        this.startTimestepping()\r\n                    }\r\n                    this.isPaused = !this.isPaused\r\n                    this.isPausedChangedSubject.next(this.isPaused)\r\n                }\r\n            }\r\n            Player.addEventListener(\"onplaypause\", callback)\r\n        }\r\n    }\r\n\r\n    private triggerTimestampSync() {\r\n        let autoSyncs = 1\r\n        asyncScheduler.schedule(\r\n            function (self) {\r\n                if (self!.isPaused) return\r\n\r\n                if (!PlayerAPI._events.emitResumeSync()) {\r\n                    PlayerAPI._contextPlayer.resume({})\r\n                }\r\n\r\n                autoSyncs++\r\n\r\n                const timeout = Math.expm1((Math.LN2 / 2) * autoSyncs)\r\n\r\n                this.schedule(self, timeout)\r\n            },\r\n            Math.SQRT2 - 1,\r\n            this,\r\n        )\r\n    }\r\n\r\n    private startTimestepping() {\r\n        animationFrameScheduler.schedule(\r\n            function (self) {\r\n                self!.scaledProgress = Spicetify.Player.getProgressPercent()\r\n                self!.scaledProgressChangedSubject.next(self!.scaledProgress)\r\n                this.schedule(self)\r\n            },\r\n            undefined,\r\n            this,\r\n        )\r\n\r\n        this.triggerTimestampSync()\r\n    }\r\n})()\r\n", "import { LitElement, PropertyValueMap, html } from \"https://esm.sh/lit\"\r\nimport { customElement, property, state } from \"https://esm.sh/lit/decorators.js\"\r\nimport { PlayerW } from \"./Services/PlayerW.ts\"\r\nimport { Interpolator, Sprine } from \"./Packages/Sprine.ts\"\r\nimport { Song } from \"./Services/Song.ts\"\r\nimport { Task } from \"https://esm.sh/@lit/task\"\r\nimport { map } from \"https://esm.sh/lit/directives/map.js\"\r\nimport { when } from \"https://esm.sh/lit/directives/when.js\"\r\nimport { SyncedPart } from \"./Services/LyricsProvider.ts\"\r\n\r\ndeclare global {\r\n    interface HTMLElementTagNameMap {\r\n        \"lyrics-container\": LyricsContainer\r\n        \"animated-text-container\": AnimatedTextContainer\r\n        \"animated-text\": AnimatedText\r\n    }\r\n}\r\n\r\nconst sprineState = { hasChanged: (s: Sprine) => !s.isInEquilibrium() }\r\n\r\nimport UnitBezier from \"https://esm.sh/@mapbox/unitbezier\"\r\n\r\nconst DefaultInterpolators = {\r\n    scale: new UnitBezier(0.37, 0, 0.47, 1.4).solve as Interpolator,\r\n    opacity: new UnitBezier(0.37, 0, 0.47, 1.4).solve as Interpolator,\r\n    yOffset: new UnitBezier(0.37, 0, 0.47, 1.4).solve as Interpolator,\r\n    glow: new UnitBezier(0, 1.7, 0.07, 1).solve as Interpolator,\r\n}\r\n\r\n@customElement(\"lyrics-container\")\r\nexport class LyricsContainer extends LitElement {\r\n    @property({ attribute: false })\r\n    song: Song | null = null\r\n\r\n    private lyricsTask = new Task(this, {\r\n        task: ([song]) => song?.lyrics,\r\n        args: () => [this.song],\r\n    })\r\n\r\n    @state()\r\n    scaledProgress = 0\r\n\r\n    @state()\r\n    hasLyrics = false\r\n\r\n    render() {\r\n        return this.lyricsTask.render({\r\n            pending: () => {\r\n                this.hasLyrics = false\r\n                return html`<div class=\"lyrics_++-container-fetching\">Fetching Lyrics...</div>`\r\n            },\r\n            complete: lyrics => {\r\n                const wordSynced = lyrics?.wordSynced\r\n                if (!wordSynced) {\r\n                    this.hasLyrics = false\r\n                    return html`<div class=\"lyrics_++-container-no_lyrics\">No Lyrics</div>`\r\n                }\r\n                this.hasLyrics = true\r\n\r\n                return html`<div class=\"lyrics_++-container\">\r\n                    <animated-text-container\r\n                        relativeScaledProgress=${this.scaledProgress}\r\n                        .text=${wordSynced.part}\r\n                    ></animated-text-container>\r\n                </div>`\r\n            },\r\n        })\r\n    }\r\n}\r\n\r\n@customElement(\"animated-text-container\")\r\nexport class AnimatedTextContainer extends LitElement {\r\n    @property({ type: Number })\r\n    relativeScaledProgress = 0\r\n\r\n    @property({ type: Array })\r\n    text = [] as Array<SyncedPart>\r\n    @property({ type: Number })\r\n    tsr = 0\r\n    @property({ type: Number })\r\n    ter = 1\r\n\r\n    render() {\r\n        return html`<div class=\"animated-text-container\">\r\n            ${map(this.text, part =>\r\n                when(\r\n                    Array.isArray(part.part),\r\n                    () =>\r\n                        html`<animated-text-container\r\n                            relativeScaledProgress=${this.relativeScaledProgress / (part.ter - part.tsr)}\r\n                            .text=${part.part}\r\n                            tsr=${part.tsr}\r\n                            ter=${part.ter}\r\n                        />`,\r\n                    () =>\r\n                        html`<animated-text\r\n                            relativeScaledProgress=${this.relativeScaledProgress / (part.ter - part.tsr)}\r\n                            text=${part.part}\r\n                            tsr=${part.tsr}\r\n                            ter=${part.ter}\r\n                        />`,\r\n                ),\r\n            )}\r\n        </div>`\r\n    }\r\n}\r\n\r\n@customElement(\"animated-text\")\r\nexport class AnimatedText extends LitElement {\r\n    @state(sprineState)\r\n    scaleSprine\r\n    @state(sprineState)\r\n    opacitySprine\r\n    @state(sprineState)\r\n    yOffsetSprine\r\n    @state(sprineState)\r\n    glowSprine\r\n\r\n    @property({ type: Number })\r\n    relativeScaledProgress = 0\r\n\r\n    @property()\r\n    text = \"\"\r\n    @property({ type: Number })\r\n    tsr = 0\r\n    @property({ type: Number })\r\n    ter = 1\r\n\r\n    constructor(interpolators = DefaultInterpolators) {\r\n        super()\r\n        this.scaleSprine = new Sprine(0, 0.6, 0.7, interpolators.scale)\r\n        this.opacitySprine = new Sprine(0, 0.5, 1, interpolators.opacity)\r\n        this.yOffsetSprine = new Sprine(0, 0.4, 1.25, interpolators.yOffset)\r\n        this.glowSprine = new Sprine(0, 0.5, 1, interpolators.glow)\r\n    }\r\n\r\n    shouldUpdate(changedProperties: PropertyValueMap<this>) {\r\n        if (changedProperties.has(\"relativeScaledProgress\")) {\r\n            const relativeTime = this.relativeScaledProgress\r\n            this.scaleSprine.updateEquilibrium(relativeTime)\r\n            this.opacitySprine.updateEquilibrium(relativeTime)\r\n            this.yOffsetSprine.updateEquilibrium(relativeTime)\r\n            this.glowSprine.updateEquilibrium(relativeTime)\r\n            this.style.setProperty(\"--gradient-progress\", `${100 * relativeTime}%`)\r\n            changedProperties.delete(\"relativeScaledProgress\")\r\n        }\r\n        if (changedProperties.has(\"scaleSprine\")) {\r\n            const scale = this.scaleSprine.current\r\n            this.style.scale = scale.toString()\r\n            changedProperties.delete(\"scaleSprine\")\r\n        }\r\n        if (changedProperties.has(\"opacitySprine\")) {\r\n            const opacity = this.opacitySprine.current\r\n            this.style.opacity = opacity.toString()\r\n            changedProperties.delete(\"opacitySprine\")\r\n        }\r\n        if (changedProperties.has(\"yOffsetSprine\")) {\r\n            const yOffset = this.yOffsetSprine.current\r\n            this.style.transform = `translateY(calc(0.25rem *${yOffset}))`\r\n            changedProperties.delete(\"yOffsetSprine\")\r\n        }\r\n        if (changedProperties.has(\"glowSprine\")) {\r\n            const glow = this.glowSprine.current\r\n            this.style.setProperty(\"--text-shadow-opacity\", `${100 * glow}%`)\r\n            this.style.setProperty(\"--text-shadow-blur-radius\", `${glow}px`)\r\n            changedProperties.delete(\"glowSprine\")\r\n        }\r\n        return Boolean(changedProperties.size)\r\n    }\r\n\r\n    render() {\r\n        return html`<span class=\"animated-text\" role=\"button\" @click=${() => PlayerW.GetSong()?.setTimestamp(this.tsr)}\r\n            >${this.text}</span\r\n        >`\r\n    }\r\n}\r\n", "const TAU = Math.PI * 2\r\n\r\nconst SLEEPING_EPSILON = 1e-3\r\n\r\nexport default class Spring {\r\n    private W0: number\r\n    private v: number\r\n\r\n    private sleeping = true\r\n\r\n    private p_e: number\r\n\r\n    constructor(private p: number, private dampingRatio: number, frequency: number) {\r\n        if (dampingRatio * frequency < 0) {\r\n            throw new Error(\"Spring does not converge.\")\r\n        }\r\n\r\n        this.v = 0\r\n        this.p_e = p\r\n        this.W0 = frequency * TAU\r\n    }\r\n\r\n    update(dt: number): number {\r\n        const offset = this.p - this.p_e\r\n        const dp = this.v * dt\r\n        const A = this.dampingRatio * this.W0\r\n        const Adt = A * dt\r\n        const decay = Math.exp(-Adt)\r\n\r\n        let newPosition, newVelocity\r\n\r\n        if (this.dampingRatio == 1) {\r\n            newPosition = this.p_e + (offset * (1 + Adt) + dp) * decay\r\n            newVelocity = (this.v * (1 - Adt) - offset * (A * Adt)) * decay\r\n        } else if (this.dampingRatio < 1) {\r\n            const W_W0 = Math.sqrt(1 - this.dampingRatio * this.dampingRatio)\r\n            const W = this.W0 * W_W0\r\n\r\n            const i = Math.cos(W * dt)\r\n            const j = Math.sin(W * dt)\r\n\r\n            newPosition = this.p_e + (offset * i + (dp + Adt * offset) * (j / (W * dt))) * decay\r\n            newVelocity = (this.v * (i - (A / W) * j) - offset * j * (this.W0 / W_W0)) * decay\r\n        } else if (this.dampingRatio > 1) {\r\n            const W_W0 = Math.sqrt(this.dampingRatio ** 2 - 1)\r\n            const W = this.W0 * W_W0\r\n\r\n            const r_average = -this.W0 * this.dampingRatio\r\n\r\n            const r_1 = r_average + W\r\n            const r_2 = r_average - W\r\n\r\n            const c_2 = (offset * r_1 - this.v) / (r_1 - r_2)\r\n            const c_1 = offset - c_2\r\n\r\n            const e_1 = c_1 * Math.exp(r_1 * dt)\r\n            const e_2 = c_2 * Math.exp(r_2 * dt)\r\n\r\n            newPosition = this.p_e + e_1 + e_2\r\n            newVelocity = r_1 * e_1 + r_2 * e_2\r\n        } else {\r\n            throw \"Solar flare detected.\"\r\n        }\r\n\r\n        this.p = newPosition\r\n        this.v = newVelocity\r\n\r\n        this.sleeping = Math.abs(this.v) <= SLEEPING_EPSILON\r\n\r\n        return newPosition\r\n    }\r\n\r\n    setEquilibrium(position: number) {\r\n        if (this.p_e != position) {\r\n            this.p_e = position\r\n            this.sleeping = false\r\n        }\r\n        return this.p_e\r\n    }\r\n\r\n    reset(position: number) {\r\n        this.v = 0\r\n        this.p = this.p_e = position\r\n        this.sleeping = true\r\n    }\r\n\r\n    isInEquilibrium = () => this.sleeping\r\n}\r\n", "import Spring from \"./Spring.ts\"\r\n\r\nexport type Interpolator = (relativeTime: number) => number\r\n\r\nexport class Sprine extends Spring {\r\n    private updatedTime = Date.now()\r\n\r\n    constructor(position: number, dampingRatio: number, frequency: number, private interpolate: Interpolator) {\r\n        super(position, dampingRatio, frequency)\r\n    }\r\n\r\n    updateEquilibrium(relativeTime: number) {\r\n        const interpolatedPosition = this.interpolate(relativeTime)\r\n        this.setEquilibrium(interpolatedPosition)\r\n    }\r\n\r\n    get current() {\r\n        const nextUpdatedTime = Date.now()\r\n        const current = this.update(nextUpdatedTime - this.updatedTime)\r\n        this.updatedTime = nextUpdatedTime\r\n        return current\r\n    }\r\n}\r\n"],
  "mappings": "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",
  "names": ["part", "tsr", "ter", "subtitle", "URI", "PlayerAPI", "PlayerAPI", "Player", "PlayerAPI", "state"]
}
